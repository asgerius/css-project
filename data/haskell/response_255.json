[{"tags": ["list", "haskell", "list-comprehension", "nested-lists", "haskell-platform"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1574888576, "post_id": 59078361, "comment_id": 104393873, "body": "Hint: <code>length [cs]</code> is always <code>1</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574888923, "post_id": 59078361, "comment_id": 104394014, "body": "And <code>[[cs]]</code> is always a list containing a list containing a single value; it doesn&#39;t match an arbitrary nested list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1574888938, "post_id": 59078361, "comment_id": 104394027, "body": "<code>[cs]</code> is a list of length1, and <code>[[cs]]</code> is a light of length 1 whose single element is a list of length 1. Don&#39;t use <code>[[cs]]</code> as a pattern. Use <code>cs</code>, and do the appropriate checks later on. You can use <code>all predicate list</code> to check some condition on all the elements."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574889010, "post_id": 59078361, "comment_id": 104394050, "body": "Record syntax would simplify this as well: <code>data Sudoku = Sudoku { rows: [Row] }</code> defines your data type and the <code>rows</code> accessor at the same time."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1574889904, "last_edit_date": 1574889904, "creation_date": 1574889101, "answer_id": 59078494, "question_id": 59078361, "link": "https://stackoverflow.com/questions/59078361/how-can-i-check-that-the-length-of-a-list-of-custom-data-types-in-haskell/59078494#59078494", "title": "How can I check that the length of a list of custom data types in Haskell?", "body": "<p><code>[x]</code> as a pattern will only match a singleton list (list with exactly one element in it).</p>\n\n<p>To perform the nested lists check, do</p>\n\n<pre><code>isSudokuList cs  =  length cs == ...    &amp;&amp;\n                      and [length c == ... | c &lt;- cs]\n</code></pre>\n\n<p>You will have to tweak it to fit your types of course.</p>\n\n<p>You could also define</p>\n\n<pre><code>niner [a,b,c,d,e,f,g,h,i] = True\n.......\n</code></pre>\n\n<p>and use <em>it</em>.</p>\n"}], "owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 59078494, "answer_count": 1, "score": 2, "last_activity_date": 1574889904, "creation_date": 1574888432, "question_id": 59078361, "link": "https://stackoverflow.com/questions/59078361/how-can-i-check-that-the-length-of-a-list-of-custom-data-types-in-haskell", "title": "How can I check that the length of a list of custom data types in Haskell?", "body": "<p>I'm making a simple sudoku program that only utilises a 9 x 9 grid. To that end, I have a function to check it is 9 x 9 and also checks to make sure the inputted values are <code>Just Num</code>'s.</p>\n\n<p>Here's the closest solution I've come to, I'm thinking the issue is in the pattern match I think (correct me if I'm wrong), this is because it compiles but has the logical error of returning False not True when given a perfectly fine test case. Anyways, here's the code dump :D</p>\n\n<pre><code>type Cell = Maybe Int\ntype Row  = [Cell]\n\ndata Sudoku = Sudoku [Row]\n deriving ( Show, Eq )\n\nrows :: Sudoku -&gt; [Row]\nrows (Sudoku ms) = ms\n\nisSudoku :: Sudoku -&gt; Bool\nisSudoku (Sudoku [[cs]]) = length [cs] == 9 &amp;&amp; length cs == 9\nisSudoku (Sudoku _)      = False\n</code></pre>\n\n<p>Many thanks in advance for any advice given!</p>\n"}, {"tags": ["haskell", "parser-combinators"], "owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574872826, "creation_date": 1574872826, "question_id": 59074808, "link": "https://stackoverflow.com/questions/59074808/use-custom-data-types-as-tokens-in-parser", "title": "Use custom data types as Tokens in Parser", "body": "<p>I'm trying to write a Parser using Parser Combinators and using my own Tokens defined by a custom data type instead of using <code>languageDef</code> like in <a href=\"https://wiki.haskell.org/Parsing_a_simple_imperative_language\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Parsing_a_simple_imperative_language</a></p>\n\n<p>So far I've got a basic parser for testing parsers from here <a href=\"https://jakewheat.github.io/intro_to_parsing/#very-simple-expression-parsing\" rel=\"nofollow noreferrer\">https://jakewheat.github.io/intro_to_parsing/#very-simple-expression-parsing</a></p>\n\n<pre><code>import Data.Char (isLetter, isDigit)\nimport Control.Monad\nimport Text.ParserCombinators.Parsec\nimport Text.ParserCombinators.Parsec.Char (digit)\n\nregularParse :: Parser a -&gt; String -&gt; Either ParseError a\nregularParse p = parse p \"\"\n\n-- regularParse num \"143\"\nnum :: Parser Integer\nnum = do\n    n &lt;- many1 digit\n    return (read n)\n\n-- regularParse var \"hello, world!\"\nvar :: Parser String\nvar = do\n    fc &lt;- firstChar\n    rest &lt;- many nonFirstChar\n    return (fc:rest)\n  where\n    firstChar = satisfy (\\a -&gt; isLetter a || a == '_')\n    nonFirstChar = satisfy (\\a -&gt; isDigit a || isLetter a || a == '_')\n</code></pre>\n\n<p>In the first example from the wiki.haskell.org, the language and tokens are defined using <code>emptyDef</code> from <code>Text.ParserCombinators.Parsec.Language</code>. This allows them to write the language like</p>\n\n<pre><code>languageDef =\n    emptyDef { Token.commentStart    = \"/*\"\n             , ...\n             , Token.reservedNames   = [ \"if\"\n                                       , \"while\"\n                                       , ...\n\nlexer = Token.makeTokenParser languageDef\nreserved = Token.reserved lexer\n\nwhileStmt :: Parser Stmt\nwhileStmt =\n  do reserved \"while\"\n     cond &lt;- bExpression\n     reserved \"do\"\n     stmt &lt;- statement\n     return $ While cond stmt\n</code></pre>\n\n<p>How could I do this if I wanted to write my own custom data types and use my own tokens such as</p>\n\n<pre><code>data Token = Zero\n           | One [Char]\n           | Two [Char] [Char]\n\ntoken :: Parser Token\ntoken = twoParser\n     &lt;|&gt; oneParser\n     &lt;|&gt; zeroParser\n\ntwoParser :: Parser Token\ntwoParser = do\n  two &lt;- tExpression\n  a &lt;- var\n  b &lt;- var\n  return $ two a b\n\ntExpression :: Parser Token\ntExpression = do\n  ...\n\nvar :: Parser String\nvar = do\n    fc &lt;- firstChar\n    rest &lt;- many nonFirstChar\n    return (fc:rest)\n  where\n    firstChar = satisfy (\\a -&gt; isLetter a || a == '_')\n    nonFirstChar = satisfy (\\a -&gt; isDigit a || isLetter a || a == '_')\n</code></pre>\n\n<p>I'm not sure if this is the correct way to approach this, and as the tExpression function relies on many things from the language definition. Thanks</p>\n"}, {"tags": ["haskell", "nix"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1574872226, "post_id": 59073912, "comment_id": 104386728, "body": "Does the file <code>&#47;build&#47;env-vars</code> exist?"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1574873007, "post_id": 59073912, "comment_id": 104387150, "body": "where? in the folder where I launch the command? Shouldn&#39;t this command be completely independent from where I launch it?"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1574879602, "post_id": 59073912, "comment_id": 104390279, "body": "No -- <code>&#47;build&#47;env-vars</code> should exist. You can check its existence by typing <code>ls &#47;build&#47;env-vars</code>"}, {"owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "edited": false, "score": 0, "creation_date": 1574879886, "post_id": 59073912, "comment_id": 104390401, "body": "This looks like a bug where build instructions are executed as part of the shellHook or a bug where some derivation is broken. Could you post the full log and the versions of Nix and Nixpkgs?"}, {"owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "edited": false, "score": 0, "creation_date": 1574879944, "post_id": 59073912, "comment_id": 104390425, "body": "Your command should work. I wrongly assumed it was wrong at first and came up with an alternative. It should be equivalent, but perhaps you could try <code>nix-shell --expr &#39;with import &lt;nixpkgs&gt; {}; mkShell { buildInputs = [ (haskellPackages.ghcWithPackages (p: [p.brick])) ]; }&#39;</code>"}, {"owner": {"reputation": 73, "user_id": 2642653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb9f03b81aa3f176d809f1b1f71feeb2?s=128&d=identicon&r=PG", "display_name": "jjwatt", "link": "https://stackoverflow.com/users/2642653/jjwatt"}, "edited": false, "score": 1, "creation_date": 1574906350, "post_id": 59073912, "comment_id": 104398273, "body": "That command works for me. I looked through all my /nix/store/*stdenv-linux*/setup files and the only mentions of env-vars are in a dumpVars() shell fn. What you install in the nix-env should not/won&#39;t effect what you do in the nix-shell, anyway. I think something else is failing--it looks like it&#39;s in the &quot;unpackPhase()&quot; That&#39;s where that error message about &quot;$src or $srcs&quot; is."}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "edited": false, "score": 0, "creation_date": 1574926826, "post_id": 59073912, "comment_id": 104403669, "body": "@RobertHensing I&#39;m vorking with nix 2.3 and nixpkgs-unstable. The other command you suggested produces the same error. I&#39;ll update the question with the full error in a second"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574932942, "post_id": 59073912, "comment_id": 104406578, "body": "@marcosh As the user owning the nix-store (root for multiple user installs), install <code>nix-info</code> and call it. Tells us the names listed in the channels, they usually contain part of the commit sha of nixpkgs git repo, what commit you are using. With this commit, we can try to reproduce that. Also, what you install with <code>nix-env</code> is separate from the environment used in <code>nix-shell</code>. Did you call <code>nix-shell</code> from inside another <code>nix-shell</code>?"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574949464, "post_id": 59073912, "comment_id": 104415547, "body": "@typetetris the output of <code>nix-info</code> is <code>system: &quot;x86_64-linux&quot;, multi-user?: no, version: nix-env (Nix) 2.3, channels(marcosh): &quot;nixpkgs-20.03pre192821.b425012fdf4&quot;, nixpkgs: &#47;home&#47;marcosh&#47;.nix-defexpr&#47;channels&#47;nixpkgs</code>. I&#39;m not calling <code>nix-shell</code> inside another <code>nix-shell</code>; just launching the command in my terminal"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574952377, "post_id": 59073912, "comment_id": 104417143, "body": "@marcosh This works for me, even with that special commit."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574954921, "post_id": 59073912, "comment_id": 104418469, "body": "@marcosh This turns into a chat, let&#39;s talk in <a href=\"https://chat.stackoverflow.com/rooms/203255/question-59073912\">chat.stackoverflow.com/rooms/203255/question-59073912</a>"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1574926860, "creation_date": 1574869787, "last_edit_date": 1574926860, "question_id": 59073912, "link": "https://stackoverflow.com/questions/59073912/nix-unable-to-build-haskell-with-packages", "title": "Nix unable to build Haskell with packages", "body": "<p>When I try to run</p>\n\n<pre><code>nix-shell -p \"haskellPackages.ghcWithPackages (p: [p.brick])\"\n</code></pre>\n\n<p>I receive the following error</p>\n\n<pre><code>these derivations will be built:\n  /nix/store/14r35fzyw3y7mqzdzifbm9sd0599b1cl-ghc-8.6.5-with-packages.drv\nbuilding '/nix/store/14r35fzyw3y7mqzdzifbm9sd0599b1cl-ghc-8.6.5-with-packages.drv'...\n/nix/store/k7yalpjh53xra535xaip1pfq6q4jgsc0-stdenv-linux/setup: line 822: /build/env-vars: No such file or directory\nunpacking sources\n/nix/store/k7yalpjh53xra535xaip1pfq6q4jgsc0-stdenv-linux/setup: line 822: /build/env-vars: No such file or directory\nvariable $src or $srcs should point to the source\nbuilder for '/nix/store/14r35fzyw3y7mqzdzifbm9sd0599b1cl-ghc-8.6.5-with-packages.drv' failed with exit code 1\n</code></pre>\n\n<p>Notice that this does not happen if I pass an empty list of packages, so <code>nix-shell</code> itself works.</p>\n\n<p>I tried to reinstall <code>nix-env -i ghc</code> but the error persists</p>\n"}, {"tags": ["function", "haskell", "recursion", "map-function"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574871466, "post_id": 59073962, "comment_id": 104386347, "body": "@osobennyj Yes, or using <code>map ... (zip ...)</code> as mentioned above, which is <code>zipWith</code> in disguise."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1574888630, "post_id": 59073962, "comment_id": 104393895, "body": "or with list comprehension, <code>[ foo x | (i,x) &lt;- zip [0..] xs, elem i is]</code>. this raises interesting concern, as it&#39;s unnecessarily quadratic, so the question becomes how to make it linear (in the indexes). one way is with a <a href=\"https://stackoverflow.com/a/59075309/849891\">stateful foldr</a>, with the indexes as the state."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575065918, "post_id": 59073962, "comment_id": 104454119, "body": "turns out, zipping and left-biased union was the way to go. :)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1574869954, "creation_date": 1574869954, "answer_id": 59073962, "question_id": 59073781, "link": "https://stackoverflow.com/questions/59073781/map-function-applied-to-specific-elements-of-the-list/59073962#59073962", "title": "Map function applied to specific elements of the list", "body": "<p><code>map</code> doesn't know \u201cwhere in the list\u201d it is. So you first need to encode that information into the elements themselves. This can be done with <code>zip [0..]</code>, which basically annotates each element with position at which it occurs.</p>\n\n<p>Then, in the function you <code>map</code>, you just need to pattern-match on the annotation-tuple, and use an <code>if</code> to decide whether or not to apply the manipulator function to the other tuple element.</p>\n\n<p>Note that the combination of <code>zip</code> and <code>map</code> is always equivalent to a single pass <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zipWith\" rel=\"noreferrer\"><code>zipWith</code></a>, so that's what you should preferrably use.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575065257, "post_id": 59092535, "comment_id": 104453964, "body": "great idea, to stretch the index list so it matches up with the xs."}], "tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 2, "last_activity_date": 1575319361, "last_edit_date": 1575319361, "creation_date": 1574956555, "answer_id": 59092535, "question_id": 59073781, "link": "https://stackoverflow.com/questions/59073781/map-function-applied-to-specific-elements-of-the-list/59092535#59092535", "title": "Map function applied to specific elements of the list", "body": "<p>If you insist on using <code>map</code> to solve this problem, a possible route consists in making use of an auxiliary list of type <code>[(a, Bool)]</code>, where only the indexed elements are paired with a <code>True</code> boolean value.</p>\n\n<p>The function producing this auxiliary list could be declared like this:</p>\n\n<pre><code>markIndexedElements :: [Int] -&gt; [a] -&gt; [(a, Bool)]\n</code></pre>\n\n<p>If we have such a function, the rest of our problem becomes easy:</p>\n\n<pre><code> \u03bb&gt; auxList = markIndexedElements [0,3] [1,2,3,4]\n \u03bb&gt; auxList\n [(1,True),(2,False),(3,False),(4,True)]\n \u03bb&gt; \n \u03bb&gt; map  (\\(x, b) -&gt; if b then (2*x) else x)  auxList\n [2,2,3,8]\n \u03bb&gt; \n</code></pre>\n\n<p>The <code>markIndexedElements</code> function makes a second list out of the first list, while maintaining some <em>state</em> information. So if we prefer a ready-made recursion scheme, it seems to be a job for the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\">scanl :: (b -> a -> b) -> b -> [a] -> [b]</a> function.</p>\n\n<p>The <em>state</em> to be maintained consists mostly of the current position in the original list plus the list of so far unused indices. If the current position is equal to the next index, we drop that index and output an (x, True) pair. This gives the following code:</p>\n\n<pre><code>-- only indexed elements to get paired with a True value\nmarkIndexedElements :: [Int] -&gt; [a] -&gt; [(a, Bool)]\nmarkIndexedElements indices xs =\n    let  sfn ((_,p),(pos,ind)) y =  -- stepping function for scanl\n             if (null ind)\n               then ((y, False), (pos+1,[]))\n               else ((y, pos==head ind),\n                     (pos+1, if (pos==head ind)  then  tail ind  else  ind))\n         scanRes = scanl  sfn  ((undefined,False), (0,indices))  xs\n    in   map fst  $  drop 1 scanRes\n</code></pre>\n\n<p>The rest of the code is not difficult to write:</p>\n\n<pre><code>mapAtOriginal :: (a -&gt; a) -&gt; [Int] -&gt; [a] -&gt; [a]\nmapAtOriginal fn indices xs =\n    let  pairList  = markIndexedElements indices xs   -- auxiliary list\n         pfn (x,b) = if b then (fn x) else x          -- auxiliary function\n    in   map pfn pairList\n\n\nmain = do\n    let  xs      = [1,2,3,4]\n         indices = [0,3]\n         result  = mapAtOriginal (*2) indices xs\n    putStrLn $ show (markIndexedElements indices xs)\n    putStrLn $ show result\n</code></pre>\n\n<h2>Program output:</h2>\n\n<pre><code>[(1,True),(2,False),(3,False),(4,True)]\n[2,2,3,8]\n</code></pre>\n\n<h2>Similar solutions:</h2>\n\n<p>If we try to apply just one more step of Cartesian reductionism to this problem, we can note that argument <code>xs</code> plays only a minor role in the <code>markIndexedElements</code> function. A possibility is to eliminate it completely, and have instead a function that returns just an unlimited list of boolean values:</p>\n\n<pre><code>booleansFromIndices :: [Int] -&gt; [Bool]\nbooleansFromIndices indices =\n    let  sfn (pos,ind) =  Just $  -- stepping function for unfoldr\n             if (null ind)\n               then ( False, (pos+1, []) )\n               else ( pos==head ind,\n                      (pos+1, if (pos==head ind)  then  tail ind  else  ind))\n    in   unfoldr  sfn  (0,indices)\n</code></pre>\n\n<p>The resulting list ends with an unlimited sequence of <code>False</code> values after the last index:</p>\n\n<pre><code> \u03bb&gt; take 10 $ booleansFromIndices [0,3]\n [True,False,False,True,False,False,False,False,False,False]\n \u03bb&gt; \n</code></pre>\n\n<p>The target <code>mapAtOriginal</code> function can then be rewritten using <code>booleansFromIndices</code>:</p>\n\n<pre><code>mapAtOriginal :: (a -&gt; a) -&gt; [Int] -&gt; [a] -&gt; [a]\nmapAtOriginal fn indices xs =\n    let  pairList   = zip xs $ booleansFromIndices indices\n         pfn (x, b) = if b  then  (fn x)  else  x\n    in   map pfn pairList\n</code></pre>\n\n<p>Last but not least, as already noted by other answerers/commenters, the map+zip scheme can generally be replaced by one based on the <a href=\"https://hoogle.haskell.org/?hoogle=zipWith\" rel=\"nofollow noreferrer\">zipWith</a> function.\nLike this, in our case:</p>\n\n<pre><code>mapAtOriginal :: (a -&gt; a) -&gt; [Int] -&gt; [a] -&gt; [a]\nmapAtOriginal fn indices xs =\n    let  booleans = booleansFromIndices indices\n    in   zipWith  (\\x b -&gt; if b  then  (fn x)  else  x)  xs  booleans\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1575065793, "post_id": 59111451, "comment_id": 104454092, "body": "it&#39;s like <code>getZipList $ (f `_at` is) `_or` (id `_at` [0..]) &lt;*&gt; ZipList xs</code> with some ad-hoc definitions for <code>_at</code> and <code>_or</code>."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1575321793, "post_id": 59111451, "comment_id": 104519594, "body": "Great ! I have to admit that one is impressive. I was not aware of the possibility to use <code>unionBy</code> like this. And still working on the   <code>getZipList</code> thing ... BTW on the side of pedestrian code, I have added the  <code>zipWith</code>- based solution."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1575358242, "post_id": 59111451, "comment_id": 104529052, "body": "<code>ZipList</code> is just a tag we slap on our regular lists to convey the intent of <i>zipping</i> application: that <code>ZipList fs &lt;*&gt; ZipList xs == ZipList (zipWith ($) fs xs)</code> (a.o.t. the usual nested loop application, <code>fs &lt;*&gt; xs == [f x | f &lt;- fs, x &lt;- xs]</code>). the tag is still there on the result, so we need to remove it: <code>getZipList (ZipList xs) == xs</code>. as usual in Haskell the naming is messed up: we do not get the ZipList, we get the regular list <i>inside</i> it. what I called tagging is usually referred to as wrapping. the wrap--unrwap thing is idiomatic."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1575359179, "post_id": 59111451, "comment_id": 104529408, "body": "btw I used the same idea of &quot;looking from above&quot; on two lists arranged &quot;horizontally&quot; one atop another,  in <a href=\"https://stackoverflow.com/a/54970785/849891\">this answer</a>. (or vertically, and from the side, whatever feels right). :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1575359400, "last_edit_date": 1575359400, "creation_date": 1575065225, "answer_id": 59111451, "question_id": 59073781, "link": "https://stackoverflow.com/questions/59073781/map-function-applied-to-specific-elements-of-the-list/59111451#59111451", "title": "Map function applied to specific elements of the list", "body": "<p>Starting from the idea from <a href=\"https://stackoverflow.com/users/11282404/jpmarinier\">jpmarinier</a>'s <a href=\"https://stackoverflow.com/a/59092535/849891\">answer</a> of filling up the empty spaces in the indices list; using package <code>data-ordlist</code>, </p>\n\n<pre><code>{-# LANGUAGE TupleSections #-}\n\nimport qualified Data.List.Ordered    as   O\nimport           Data.Ord  (comparing)\n\nmapAtOriginal :: (a -&gt; a) -&gt; [Int] -&gt; [a] -&gt; [a]\nmapAtOriginal f is xs = \n  zipWith (flip ($))                        -- apply zippily\n    xs\n    (map fst $                              -- recover the functions, `f` or `id`\n          O.unionBy (comparing snd)         -- `is` is assumed subset of [0..]\n                    (map (f  ,) is   )      -- tag with\n                    (map (id ,) [0..]) )    --      indices\n</code></pre>\n\n<p>It's like <code>getZipList $ (f `_at` is) `_or` (id `_at` [0..]) &lt;*&gt; ZipList xs</code> with some ad-hoc definitions for <code>_at</code> and <code>_or</code>.</p>\n\n<p>This uses the fact that <code>data-ordlist</code>'s <code>union</code> is left-biased, i.e. it picks the elements from its first argument list over those from its second, on collisions.</p>\n"}], "owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 59073962, "answer_count": 3, "score": 1, "last_activity_date": 1575359400, "creation_date": 1574869355, "last_edit_date": 1574887897, "question_id": 59073781, "link": "https://stackoverflow.com/questions/59073781/map-function-applied-to-specific-elements-of-the-list", "title": "Map function applied to specific elements of the list", "body": "<p>I have a function:</p>\n\n<pre><code>mapAtOriginal :: (a -&gt; a) -&gt; [Int] -&gt; [a] -&gt; [a]\nmapAtOriginal f is xs = helper 0 is xs\n  where\n    helper _ [] xs = xs\n    helper c (i:is) (x:xs)\n      | c &lt; i     =   x : helper (c+1) (i:is) xs\n      | otherwise = f x : helper (c+1)    is  xs\n</code></pre>\n\n<p>It works like this:</p>\n\n<pre><code>mapAtOriginal (*2) [0,3] [1,2,3,4]   -- == [2,2,3,8]\n</code></pre>\n\n<p>So I want to rewrite it but using a <strong><code>map</code></strong> function. I understand that <em><code>map</code></em> applies to every element of the list, however, I need it applied only for specific indices.</p>\n\n<p>How can I do it? </p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574868412, "post_id": 59073152, "comment_id": 104384684, "body": "Base case goes first"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574868423, "post_id": 59073152, "comment_id": 104384694, "body": "Don&#39;t use indexing, use pattern matching instead for that case. You&#39;ll have to separately define what you want to happen for a singleton list."}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574869209, "post_id": 59073152, "comment_id": 104385073, "body": "@MichaelLitchard I edited the question, still gives me the error."}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574869251, "post_id": 59073152, "comment_id": 104385100, "body": "@RobinZigmond how would I use pattern matching in this case? (sorry, I&#39;m a beginner) How can I tell GHCI that I&#39;m defining a case for a singleton list?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1574869290, "post_id": 59073152, "comment_id": 104385125, "body": "<code>[x]</code>&lt;-- will pattern match against a singleton list."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574869388, "post_id": 59073152, "comment_id": 104385170, "body": "I mean your three cases should be <code>[]</code>, <code>[x]</code> and <code>(x:y:xs)</code> - for lists of 0, 1 and 2+ elements respectively."}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574870182, "post_id": 59073152, "comment_id": 104385619, "body": "@RobinZigmond greaters [] = [] greaters [x] = [x] greaters (x:y:xs) = max x y : greaters xs  I made this, but this is not working correctly. For example, If i run it with [1,2,3,4,5] it only outputs [2,4,5] because it doesn&#39;t matches the 3. This is why I was trying to use head or !! 0"}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "edited": false, "score": 0, "creation_date": 1574870452, "post_id": 59073152, "comment_id": 104385782, "body": "Updated the original question for readability"}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "edited": false, "score": 0, "creation_date": 1574871819, "post_id": 59074127, "comment_id": 104386518, "body": "Thanks for the tip! I made some changes to the code, which you can see edited in the original question. The only problem is that it outputs the last number twice. Why is this?"}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "edited": false, "score": 0, "creation_date": 1574872084, "post_id": 59074127, "comment_id": 104386649, "body": "got it, I just wrote f [x] = [] !"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1574870505, "creation_date": 1574870505, "answer_id": 59074127, "question_id": 59073152, "link": "https://stackoverflow.com/questions/59073152/how-to-define-a-correct-edge-definition-for-this-recursive-function/59074127#59074127", "title": "How to define a correct edge definition for this recursive function?", "body": "<p>You aren't always going to add a new element to the result; sometimes you'll add nothing.</p>\n\n<pre><code>f :: Ord a =&gt; [a] -&gt; [a]\nf [] = []\nf [x] = [x]\nf (x:y:xs) = _  -- what goes here?\n</code></pre>\n\n<p>For your recursive case, there are two possibilities:</p>\n\n<ol>\n<li>If <code>x &lt; y</code>,  you'll add <code>y</code> to the result.</li>\n<li>Otherwise, you won't add <code>y</code> to the result. In fact, you won't add <em>anything</em>.</li>\n</ol>\n\n<p>In either case, you need to include <code>y</code> in the recursive call, not just <code>xs</code>, so that on the next iteration, <code>y</code> will be the first element to be compared to the one after <em>it</em>.</p>\n\n<p>I leave it as an exercise to implement the above logic as your recursive case.</p>\n"}], "owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 59074127, "answer_count": 1, "score": -1, "last_activity_date": 1574882100, "creation_date": 1574867314, "last_edit_date": 1574882100, "question_id": 59073152, "link": "https://stackoverflow.com/questions/59073152/how-to-define-a-correct-edge-definition-for-this-recursive-function", "title": "How to define a correct edge definition for this recursive function?", "body": "<p>Solution if anyone is interested:</p>\n\n<pre><code>f :: Ord a =&gt; [a] -&gt; [a]\nf [] = []\nf [x] = []\nf (x:y:xs)\n | x &lt; y = max x y : f (y:xs)\n | otherwise = f (y:xs)\n</code></pre>\n\n<p>sample input: </p>\n\n<pre><code>f [1,3,2,4,3,4,5] == [3,4,4,5]\nf [5,10,6,11,7,12] == [10,11,12]\n</code></pre>\n\n<p>Updated code:</p>\n\n<pre><code>f [] = []\nf [x] = [x]\nf (x:y:xs)\n | x &lt; y = max x y : f (y:xs)\n | otherwise = f (y:xs)\n</code></pre>\n\n<p>The problem is that it outputs the last number twice:</p>\n\n<pre><code>f [5,10,6,11,7,12] == [10,11,12,12]\n</code></pre>\n\n<blockquote>\n  <p>Old content below</p>\n</blockquote>\n\n<p>I am writing a function that takes a list and returns the elements that are larger than the previous one. I came up with this, but the problem is that when it reaches the last element, xs !! 0 doesn't exist, thus the error. How can I define a correct exit point in this case?</p>\n\n<p>my code:</p>\n\n<pre><code>f :: Ord a =&gt; [a] -&gt; [a]\nf [] = []\nf (x:xs) = max x (xs !! 0) : f xs\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>[3,3,4,4,4,5,*** Exception: Prelude.!!: index too large\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1574867016, "post_id": 59072997, "comment_id": 104383908, "body": "please include all relevant code. see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1574868345, "post_id": 59072997, "comment_id": 104384650, "body": "Also, what do you think the type of <code>:</code> is?"}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 3, "creation_date": 1574870017, "post_id": 59072997, "comment_id": 104385530, "body": "Your code compile if no type signature is in <code>add</code>. Probably is doesn&#39;t do what you expect. Plase tell us whats the expected behaviour and we&#39;ll try to explain for beginners"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574871165, "post_id": 59072997, "comment_id": 104386178, "body": "Namely, what is <code>add [1,2,3]</code> supposed to produce?"}, {"owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "edited": false, "score": 1, "creation_date": 1574874503, "post_id": 59072997, "comment_id": 104387964, "body": "The code you give compiles without issue, but you&#39;ll have trouble running it on a finite list. (<code>Prelude.head: empty list</code>). Is this the error you&#39;re getting?"}], "answers": [{"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 1, "last_activity_date": 1574898379, "creation_date": 1574898379, "answer_id": 59079924, "question_id": 59072997, "link": "https://stackoverflow.com/questions/59072997/adding-a-list-as-an-element-in-another-list/59079924#59079924", "title": "Adding a list as an element in another list", "body": "<p>I\u2019m not sure what error your actually getting but your code doesn\u2019t do what you want it to. My best theory is that you\u2019re typing it into ghci (where one needs to do weird things to send multiple lines together).</p>\n\n<p>Let\u2019s look at your code. I think this is it:</p>\n\n<pre><code>add (z:zs) = [z, head zs] : add zs\n</code></pre>\n\n<p>Lets break it up. On the left hand side of the <code>=</code>, you are partially declaring the function <code>add</code> (partially because you are allowed to declare another case which matches the arguments differently on another line). The case you define is for a non-empty list <code>z:zs</code>. The first element is bound to <code>z</code> and the rest of the list is <code>zs</code>. If the function is given an empty list, this pattern won\u2019t match. As the function has no definition with a pattern which will match <code>[]</code>, you would get an error.</p>\n\n<p>On the right hand side, we construct a list using the <code>:</code> constructor. Again on the left hand side we have the first element and on the right hand side we have the rest. The first element is constructed to be a list of whatever type <code>z</code> is. The types work out ok so far because <code>head zs</code> has the same type as <code>z</code> (but note it will fail if <code>zs</code> is <code>[]</code>. The rest of the lists comes from recursively calling <code>add</code>. The compiler can deduce the type of <code>add</code> is therefore:</p>\n\n<pre><code>add :: [a] -&gt; [[a]]\n</code></pre>\n\n<p>That is, it takes a list of something of type and returns a list of lists of things of that type.</p>\n\n<p>We can imagine evaluating it on the start of a list (fake syntax below):</p>\n\n<pre><code>add [1, 2, 3, ...]\n  -&gt; [1,2] : add [2, 3, ...]\n  -&gt; [1,2] : [2,3] : ...\n  == [[1,2],[2,3], ...]\n</code></pre>\n\n<p>Your function was nearly right but as soon as you give it a finite list it will blow up at the end. Also you used square brackets to make a list when you meant to make a tuple.</p>\n\n<p>Here is a simple way to do it:</p>\n\n<pre><code>add :: [a] -&gt; [(a,a)]\nadd [] = []\nadd [ _ ] = []\nadd (x1:x2:xs) = (x1,x2) : add (x2:xs)\n</code></pre>\n\n<p>And here is another way using functions from prelude:</p>\n\n<pre><code>add :: [a] -&gt; [(a,a)]\nadd [] = []\nadd xs@(_:tail) = zip xs tail\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12446515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2308f5e7ac97d49de116c73e32bdf080?s=128&d=identicon&r=PG&f=1", "display_name": "The_Dc5", "link": "https://stackoverflow.com/users/12446515/the-dc5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 59079924, "answer_count": 1, "score": 0, "last_activity_date": 1574898379, "creation_date": 1574866759, "last_edit_date": 1574897066, "question_id": 59072997, "link": "https://stackoverflow.com/questions/59072997/adding-a-list-as-an-element-in-another-list", "title": "Adding a list as an element in another list", "body": "<p>Hi I'm just starting to learn haskell but I need some help with a part of a function that I'm building. The code won't even compile as it is and I don't understand what's wrong. I'm trying to add a list as an element to another list. </p>\n\n<pre><code>add (z:zs) = [z, head zs] : add zs\n</code></pre>\n\n<p>All elements are strings. <code>z:zs = [String]</code>\nI think the type is</p>\n\n<pre><code>add :: [String] -&gt; [(String, String)]\n</code></pre>\n\n<p>but the error messeage I get is: \"The type of signature for 'add` lacks an accompanying binding.</p>\n\n<p>I want it to create pairs: <code>[1,2,3,4] -&gt; [(1,2), (2,3), (3,4)]</code></p>\n"}, {"tags": ["haskell", "haskell-stack", "hakyll"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574868531, "post_id": 59072921, "comment_id": 104384747, "body": "Selected resolver: lts-14.16 Resolver &#39;lts-14.16&#39; does not have all the packages to match your requirements.     hakyll not found         - ourblog-com requires ==4.13.*"}], "answers": [{"comments": [{"owner": {"reputation": 2966, "user_id": 3014199, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/72332b0ac6ee78bc829c378c6c747e0e?s=128&d=identicon&r=PG", "display_name": "peer", "link": "https://stackoverflow.com/users/3014199/peer"}, "edited": false, "score": 0, "creation_date": 1587574914, "post_id": 59082978, "comment_id": 108567519, "body": "I just tried this and got <code>hakyll-4.13.0.1 from stack configuration does not match ==4.12.*  (latest matching version is 4.12.5.2)</code>"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 2966, "user_id": 3014199, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/72332b0ac6ee78bc829c378c6c747e0e?s=128&d=identicon&r=PG", "display_name": "peer", "link": "https://stackoverflow.com/users/3014199/peer"}, "edited": false, "score": 0, "creation_date": 1587588887, "post_id": 59082978, "comment_id": 108574788, "body": "This suggests your <code>my-site.cabal</code> file contains the dependency <code>hakyll == 4.12.*</code>, but when I create a fresh site with the current version of <code>hakyll-init</code>, my copy of <code>my-site.cabal</code> contains the up-to-date dependency <code>hakyll == 4.13.*</code>.  Maybe try to re-run <code>stack install hakyll</code> to make sure you have the most recent version and then double-check that you&#39;re running the newly installed <code>hakyll-init</code> to create your site, and not some stale copy."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 5, "last_activity_date": 1574922807, "creation_date": 1574922807, "answer_id": 59082978, "question_id": 59072921, "link": "https://stackoverflow.com/questions/59072921/hakyll-tutorial-goes-wrong/59082978#59082978", "title": "Hakyll tutorial goes wrong", "body": "<p>It looks like the Hakyll maintainers haven't kept it up to date in the Stack respository.  After creating the <code>my-site</code> directory, instead of running <code>stack init</code>, create a <code>stack.yaml</code> file manually that contains the lines:</p>\n\n<pre><code>resolver: lts-14.16\npackages:\n- .\nextra-deps:\n- hakyll-4.13.0.1\n</code></pre>\n\n<p>Then run <code>stack build</code>, etc. as directed.  That seems to work.</p>\n"}], "owner": {"reputation": 47, "user_id": 5606563, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063409395927/picture?type=large", "display_name": "Josh Cho", "link": "https://stackoverflow.com/users/5606563/josh-cho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1574922807, "creation_date": 1574866538, "question_id": 59072921, "link": "https://stackoverflow.com/questions/59072921/hakyll-tutorial-goes-wrong", "title": "Hakyll tutorial goes wrong", "body": "<p>I am following the Hakyll tutorial as in this <a href=\"https://jaspervdj.be/hakyll/tutorials/01-installation.html\" rel=\"nofollow noreferrer\">https://jaspervdj.be/hakyll/tutorials/01-installation.html</a>.</p>\n\n<p>But it seems that something is wrong and I can't tell what it is. When I run 'stack init' I get this message.</p>\n\n<pre><code>Looking for .cabal or package.yaml files to use to init the project.\nUsing cabal packages:\n- ./\n\nSelecting the best among 16 snapshots...\n\n* Partially matches lts-14.16\n    hakyll not found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches nightly-2019-11-25\n    hakyll not found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-13.30\n    hakyll not found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-12.26\n    hakyll version 4.12.4.0 found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-11.22\n    hakyll version 4.12.3.0 found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-10.10\n    hakyll version 4.10.0.0 found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-9.21\n    hakyll version 4.9.8.0 found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-8.24\n    hakyll version 4.9.7.0 found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-7.24\n    hakyll not found\n        - ourblog-com requires ==4.13.*\n\n* Partially matches lts-6.35\n    hakyll version 4.8.3.2 found\n        - ourblog-com requires ==4.13.*\n\n...\n\n* Partially matches lts-0.7\n    hakyll not found\n        - ourblog-com requires ==4.13.*\n\nSelected resolver: lts-14.16\nResolver 'lts-14.16' does not have all the packages to match your requirements.\n    hakyll not found\n        - ourblog-com requires ==4.13.*\n\nThis may be resolved by:\n    - Using '--omit-packages' to exclude mismatching package(s).\n    - Using '--resolver' to specify a matching snapshot/resolver\n</code></pre>\n\n<p>My path seems correctly included. Why is this happening?</p>\n"}, {"tags": ["haskell", "language-lawyer", "lazy-evaluation", "semantics", "unit-type"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574862810, "post_id": 59071644, "comment_id": 104381341, "body": "This is laziness at work. Unless the result of a function is demanded (e.g. by pattern matching against a constructor), the body of the function is not evaluated. To observe the difference, try comparing <code>h1::()-&gt;() ; h1 () = ()</code> and <code>h2::()-&gt;() ; h2 _ = ()</code>. Run both <code>h1 (f 1)</code> and <code>h2 (f 1)</code>, and see that only the first one demands <code>(f 1)</code>."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574863057, "post_id": 59071644, "comment_id": 104381489, "body": "Sure, but my question is mapped to your example as follows: why does f 1 get called at all in either case? Laziness would seem to dictate that it gets replaced with () without any sort of evaluation happening. ETA: actually, why do h1 and h2 get called, while we are at it?"}, {"owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "edited": false, "score": 2, "creation_date": 1574863544, "post_id": 59071644, "comment_id": 104381794, "body": "&quot;Laziness would seem to dictate that it gets replaced with () without any sort of evaluation happening.&quot; What does that mean? <code>f 1</code> is &quot;replaced&quot; by <code>undefined</code> in all cases."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1574863801, "post_id": 59071644, "comment_id": 104381950, "body": "A function <code>... -&gt; ()</code> can 1) terminate and return <code>()</code>, 2) terminate with an exception/runtime error and fail to return anything, or 3) diverge (infinite recursion). GHC does not optimize the code assuming only 1) can happen: if <code>f 1</code> is demanded, it does not skip its evaluation and return <code>()</code>. The Haskell semantics is to evaluate it and see what happens among 1,2,3."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1574869759, "post_id": 59071644, "comment_id": 104385373, "body": "There&#39;s really nothing special about <code>()</code> (either the type or the value) in this question. All the same observations happen if you replace <code>() :: ()</code> with, say, <code>0 :: Int</code> everywhere. These are all just boring old consequences of lazy evaluation."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "edited": false, "score": 0, "creation_date": 1574869855, "post_id": 59071644, "comment_id": 104385440, "body": "It would appear that Haskell semantics is to avoid returning bottom if avoidable, by means of laziness. Examples abound where a &#39;strict Haskell&#39; would return bottom and the actual, lazy Haskell just avoids the trap if it is not necessary to evaluate all subexpressions, i.e. Haskell absolutely does not try to figure out if there&#39;s a way to return bottom instead of some regular value. Therefore it could be argued that it should not do so here but return immediately the only regular value that could be the result of this computation."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574870419, "post_id": 59071644, "comment_id": 104385765, "body": "@DanielWagner: how is it a consequence of lazy evaluation that the evaluation of f 1 is not lazy enough?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1574870657, "post_id": 59071644, "comment_id": 104385887, "body": "no, &quot;avoiding&quot; etc. is not the Haskell semantics. and there are <i>two</i> possible values of <code>()</code> type, <code>()</code> and <code>undefined</code>."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574870964, "post_id": 59071644, "comment_id": 104386066, "body": "@WillNess: laziness implies avoiding returning bottom if avoidable. Not trying to evaluate that which is not needed means returning a regular value in situations where strict evaluation would return bottom. ETA: and <code>f 1</code> does not need to evaluate anything to return a regular value."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574949342, "post_id": 59071644, "comment_id": 104415472, "body": "@WillNess: I thought a bit more about laziness vs. bottom, and came to the conclusion that not only is avoiding returning bottom a crucial part of lazy evaluation, but that the <i>only</i> clear reason for laziness, indeed its raison d&#39;etre is to avoid some cases when in a strict semantics bottom would be returned. My main reason for this is that I know of no other semantic difference between laziness and strictness but that some expressions that would run into bottom in a strict semantics will return a regular value in lazy semantics, while the opposite never happens."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1579591927, "post_id": 59071644, "comment_id": 105807184, "body": "does the new evidence from the Report in my answer leaves something still in doubt? discovering whether a value is <code>\u22a5</code> or not means actually evaluating it to WHNF."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1579610518, "post_id": 59071644, "comment_id": 105816718, "body": "@WillNess: of course if pattern matching commences, the <code>_|_</code> will get a chance to shine through, and that&#39;s what your Report chapter and verse supports. The question however is why does pattern matching start at all in this case instead of ignoring the equation and promptly returning <code>()</code>. The closest I saw in the Report was the Translation section in 4.4.3.1 Function bindings (not quoted bc of length), but even that feels like falling short from mandating the evaluation of pattern matching, describing instead how it should proceed, if at all."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1579619460, "post_id": 59071644, "comment_id": 105822099, "body": "<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch7.html#x14-1430007.1\" rel=\"nofollow noreferrer\"><code>putStrLn :: String -&gt; IO ()</code></a> in <code>putStrLn (case (undefined :: ()) of () -&gt; &quot;()&quot;)</code> demands the <b><code>String</code></b> value from the <code>case</code> expression, the evaluation of which is governed by what I quoted in the answer. No expression has no <code>()</code> to return into any context here. You want/expect/fear the <code>case (undefined :: ()) of () -&gt; &quot;()&quot;</code> expression returning <code>&quot;()&quot;</code> string on its own, but that&#39;s not what the rules which I quoted are saying. Chapter 4 just says that clausal definitions are equivalent to case expressions."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1585322025, "post_id": 59071644, "comment_id": 107726707, "body": "here&#39;s another example for you. <code>foo a = ((\\x -&gt; a) y)</code> is an invalid function definition because it contains a reference to an undefined variable <code>y</code> (assuming this definition does not appear inside a scope where <code>y</code> happens to be defined). Trying to define it produces an error <i><code>&quot;Not in scope: `y&#39; &quot;</code></i>. One could say, why should that be the case? <code>y</code>&#39;s value isn&#39;t used anyway, why should it being undefined impede the workings of this lambda function? but, it&#39;s - not - how - the - Haskell - language - happens - to - be - defined. /end of example/"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574866281, "post_id": 59072644, "comment_id": 104383458, "body": "@DanielWagner I had in mind the <code>case</code> from Core actually, and was ignoring the gaping hole. :) I&#39;ve edited to mention the Core."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1574867420, "post_id": 59072644, "comment_id": 104384138, "body": "Wouldn&#39;t the forcing be in <code>show</code> invoked by <code>print</code>? Something like <code>show x = case x of () -&gt; &quot;()&quot;</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574867557, "post_id": 59072644, "comment_id": 104384217, "body": "@user253751 seems likely that it is so. I guess I treated <code>print</code> as a given, with its semantics being &quot;show the value&quot;. my &quot;Core translation&quot; is just an illustration. wherever specifically this forcing happens, it <i>happens</i>. that&#39;s the point I&#39;m making."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574867992, "post_id": 59072644, "comment_id": 104384449, "body": "@user253751 if we think in terms of <code>putStr . show $ f 1</code>, we could still say it is <code>putStr</code> that <i>really</i> demands the value of <code>show</code>."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "edited": false, "score": 0, "creation_date": 1574869382, "post_id": 59072644, "comment_id": 104385165, "body": "case cannot be forcing in general, as you seem to imply, or <code>case undefined of ~x -&gt; ()</code> would fail but it doesn&#39;t. If you mean that this particular <code>case</code> is forcing because of the refutable pattern, then we are back to the question of why the notion of &#39;forced&#39; does not include the shortcut &#39;replace f _ with (), no questions asked&#39;. And the Haskell literature is choke-full of examples where returning bottom is avoided due to laziness; I guess I don&#39;t understand, then, why did you bring it up."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574870362, "post_id": 59072644, "comment_id": 104385722, "body": "I refer to <code>case</code> in Core, not in Haskell itself. Haskell is translated into Core, which has a forcing <code>case</code>, AFAIK. You are correct that <code>case</code> in Haskell isn&#39;t forcing by itself. I could write something in Scheme or ML (if I could write ML that is), or pseudocode."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "edited": false, "score": 0, "creation_date": 1574870747, "post_id": 59072644, "comment_id": 104385949, "body": "@WillNess: okay, I did not know that. So if I wrote a program - I&#39;m not going to, because it would be ugly Haskell, but assuming I did - that relied upon calls to unit-returning functions not being optimized away, I&#39;d be safe from rogue compiler writers introducing this kind of optimization in a later version because the standard is implicitly/cumulatively against it?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574871598, "post_id": 59072644, "comment_id": 104386409, "body": "The authoritative answer to all of this is probably somewhere in the Report. All I know is there&#39;s no &quot;optimization&quot; going on here, and &quot;regular value&quot; is not a meaningful term in this context. Whatever is forced, forced. <code>print</code> forces as much as needed to print. it doesn&#39;t look at the type, the types are gone, erased, by the time the program runs, the correct printing subroutine is already chosen and compiled in, according to the type, at compile time; that subroutine is still going to force its input value to WHNF at run time, and if it was undefined, it&#39;ll cause an error."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "edited": false, "score": 0, "creation_date": 1574872871, "post_id": 59072644, "comment_id": 104387073, "body": "@Kryptozoon, if you are writing to the standard alone, then you are absolutely <i>not</i> safe.  The standard only gives a denotational semantics -- it could be run on a room of mathematicians if we could find the funding."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574873337, "post_id": 59072644, "comment_id": 104387329, "body": "@luqui do you mean the Report? I could only find <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-880004.5\" rel=\"nofollow noreferrer\">one appearance</a> of the word &quot;semantics&quot; in the Report&#39;s <a href=\"https://www.haskell.org/onlinereport/haskell2010/\" rel=\"nofollow noreferrer\">TOC</a>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574878958, "post_id": 59072644, "comment_id": 104389990, "body": "@WillNess yes, one of these days I should at least skim the thing so I don&#39;t go around parroting things I have heard about it like this lol"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574884477, "post_id": 59072644, "comment_id": 104392266, "body": "@luqui though that was only in reference to the TOC. <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html\" rel=\"nofollow noreferrer\">Chapter 3</a> has lots of occurrences of the word. :) I&#39;ve also hit on <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/informal-semantics.html\" rel=\"nofollow noreferrer\">this page</a> talking about Core."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1574896832, "post_id": 59072644, "comment_id": 104396459, "body": "I feel like the translation to Core is confusing here because it implies semantics which are different from some that the question asks about. It seems to imply that <code>(f 1)</code> would be forced to WHNF before being passed to <code>print</code> but I don\u2019t think that happens. The last part of the question has <code>h _ = ()</code> and points out that <code>h (f 1)</code> is not undefined, so surely it wouldn\u2019t look like <code>case f 1 of x -&gt; h x</code> in Core (I\u2019m assuming here you want to imply that x is forced to WHNF). I think the reason <code>print (f 1)</code> fails is that the implementation of <code>show</code> for <code>()</code> forces its argument."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1574926313, "post_id": 59072644, "comment_id": 104403454, "body": "@DanRobertson <code>print $ h (f 1) == _Case (h (f 1)) _Of () -&gt; print ()</code> would be the translation. I&#39;m not saying it <i>is</i>, I&#39;m saying it is equivalent to what is. If we&#39;re unclear about Haskell&#39;s semantics, surely a code in Haskell won&#39;t clarify much, will be subject to the same uncertainties! I could use &quot;<code>FORCE</code>&quot; as a pseudocode: <code>{print} (FORCE {h (f 1)})</code> is what I intend, where <code>{g}</code> means &quot;a compiled <code>g</code>&quot;. yes <code>print == putStr . show</code> and <code>{print} == {putStr . show}</code> most probably, but that&#39;s a detail. <code>show</code> doesn&#39;t force it on its own, that is driven by <code>putStr</code> which is driven by RTS."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574926663, "post_id": 59072644, "comment_id": 104403599, "body": "(contd.) maybe it&#39;s all compiled away, who knows. Most probably it is; I&#39;m practically sure there&#39;s no full <code>show</code> implementation in there, but rather the specific subroutine already expecting the <code>()</code> argument! but as an illustration I feel it&#39;s equivalent. Perhaps I ought to change <code>case</code> to <code>_Case</code> in the answer. (another answer could compile to Core and explore the output, but then, another version of compiler could compile the code differently)."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1574932793, "post_id": 59072644, "comment_id": 104406507, "body": "Consider two classes for printing: <code>class P1 a where { p1 :: a -&gt; IO () }</code> and <code>class P2 a where { p2 :: a -&gt; IO () }</code> and different implementations for unit: <code>instance P1 () where p1 _ = putStr &quot;()&quot;</code> and <code>instance P2 () where p2 () = putStr &quot;()&quot;</code>. We should find that <code>main = p1 (f 1)</code> runs fine but with <code>p2</code> it will fail with undefined. The key difference is that the forcing of the unit value (ie the case in Core) happens only inside <code>p2 :: () -&gt; IO ()</code>. No forcing happens in <code>main</code> between creating the think for <code>f 1</code> and calling <code>p1</code> or <code>p2</code>. Your answer implies it always happens."}, {"owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574948868, "post_id": 59072644, "comment_id": 104415193, "body": "@luqui: I&#39;m tending towards agreeing with you on this. The Report leaves this issue open, or the relevant chapter and verse would already have been quoted ITT (not to mention I&#39;d probably have found it before/instead of posting the question), so the implementers are apparently free to do away with all calls to functions returning unit types, including e.g. <code>data MyUnit = MyUnitValue</code>, except so far they didn&#39;t. I&#39;d start at least throwing warnings for functions returning unit types (= terminal objects in the Hask category) if I was the GHC developer team."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1574959485, "post_id": 59072644, "comment_id": 104420707, "body": "@DanRobertson I&#39;ve edited to say it is &quot;equivalent&quot;. i.e. it doesn&#39;t say that&#39;s what happens, just that it&#39;s equivalent to what happens. I&#39;ve also added another possible variant, <code>main = _Case (f 1) _Of x -&gt; putStr &quot;()&quot;</code>, which is a valid translation and has the same semantics as the original <code>print (f 1)</code>, so serves as a valid illustration. In no way have I claimed that it is what is actually happening. the snippet only serves to illustrate the overall process: the value of <code>(f 1)</code> is forced to WHNF, and <code>&quot;()&quot;</code> is slated to be printed after that."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 10, "last_activity_date": 1579341119, "last_edit_date": 1579341119, "creation_date": 1574865655, "answer_id": 59072644, "question_id": 59071644, "link": "https://stackoverflow.com/questions/59071644/what-rules-are-there-about-a-function-a-being-evaluated-in-haskell/59072644#59072644", "title": "What rules are there about a function a -&gt; () being evaluated in Haskell?", "body": "<p>You appear to come from the assumption that the type <code>()</code> has only one possible value, <code>()</code>, and thus expect that <em>any</em> function call returning a value of type <code>()</code> should automatically be assumed to indeed produce the value <code>()</code>.</p>\n\n<p>This is not how Haskell works. Every type has one more value in Haskell, namely <em>no</em> value, error, or so called \"bottom\", encoded by <code>undefined</code>. Thus an evaluation is actually taking place:</p>\n\n<pre><code>main = print (f 1)\n</code></pre>\n\n<p>is equivalent to the Core language's</p>\n\n<pre><code>main = _Case (f 1) _Of x -&gt; print x   -- pseudocode illustration\n</code></pre>\n\n<p>or even<sup>(*)</sup></p>\n\n<pre><code>main = _Case (f 1) _Of x -&gt; putStr \"()\"\n</code></pre>\n\n<p>and Core's <code>_Case</code> is <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/informal-semantics.html\" rel=\"nofollow noreferrer\"><em>forcing</em></a>: </p>\n\n<blockquote>\n  <p>\"Evaluating a <code>%case</code> [expression] forces the evaluation of the expression being tested (the \u201cscrutinee\u201d). The value of the scrutinee is bound to the variable following the <code>%of</code> keyword, ...\". </p>\n</blockquote>\n\n<p>The value is forced to weak head normal form. This is part of the language definition.</p>\n\n<p>Haskell is <em>not</em> a <em>declarative</em> programming language.</p>\n\n<hr>\n\n<p><sup>(*)</sup> <code>print x = putStr (show x)</code> and <code>show () = \"()\"</code>, so the <code>show</code> call can be compiled away altogether. </p>\n\n<p>The value is indeed known in advance as <code>()</code>, and even the value of <code>show ()</code> is known in advance as <code>\"()\"</code>. Still the accepted Haskell semantics demand that the value of <code>(f 1)</code> is forced to weak head normal form before proceeding to print that known in advance string, <code>\"()\"</code>.</p>\n\n<hr>\n\n<p><em>edit:</em> Consider <code>concat (repeat [])</code>. Should it be <code>[]</code>, or should it be an infinite loop? </p>\n\n<p>A \"declarative language\"'s answer to this is most probably <code>[]</code>. Haskell's answer is, <em>the infinite loop</em>. </p>\n\n<p>Laziness <em>is</em> \"poor man's declarative programming\", but it still isn't <em>the real thing</em>.</p>\n\n<p><em>edit2</em>: <code>print $ h (f 1) == _Case (h (f 1)) _Of () -&gt; print ()</code> and only <code>h</code> is forced, not <code>f</code>; and to produce <em>its</em> answer <code>h</code> doesn't have to force anything, according to its definition <code>h _ = ()</code>. </p>\n\n<p><em>parting remarks:</em> Laziness may have raison d'etre but it's not its definition. Laziness is what it is. It is defined as all values being initially thunks which are forced to WHNF according to the demands coming from <code>main</code>. If it helps avoid bottom in a certain specific case according to its specific circumstances, then it does. If not, not. That is all. </p>\n\n<p>It helps to implement it yourself, in your favorite language, to get a feel for it. But we can also trace evaluation of any expression by carefully <a href=\"https://stackoverflow.com/a/56515822/849891\">naming all interim values</a> as they come into being.</p>\n\n<hr>\n\n<p>Going by <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html\" rel=\"nofollow noreferrer\">the Report</a>, we have</p>\n\n<pre><code>f :: a -&gt; ()\nf = \\_ -&gt; (undefined :: ())\n</code></pre>\n\n<p>then</p>\n\n<pre><code>print (f 1)\n = print ((\\ _ -&gt;  undefined :: ()) 1)\n = print          (undefined :: ())\n = putStrLn (show (undefined :: ()))\n</code></pre>\n\n<p>and with</p>\n\n<pre><code>instance Show () where\n    show :: () -&gt; String\n    show x = case x of () -&gt; \"()\"\n</code></pre>\n\n<p>it continues</p>\n\n<pre><code> = putStrLn (case (undefined :: ()) of () -&gt; \"()\")\n</code></pre>\n\n<p>Now, section <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-610003.17.3\" rel=\"nofollow noreferrer\">3.17.3 Formal Semantics of Pattern Matching</a> of the Report says</p>\n\n<blockquote>\n  <p>The semantics of <code>case</code> expressions [are given] in Figures 3.1\u20133.3. Any implementation should behave so that these identities hold [...]. </p>\n</blockquote>\n\n<p>and case <code>(r)</code> in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-610003.17.3\" rel=\"nofollow noreferrer\">Figure 3.2</a> states</p>\n\n<pre><code>(r)     case \u22a5 of { K x1 \u2026 xn -&gt; e; _ -&gt; e\u2032 } =  \u22a5\n        where K is a data constructor of arity n \n</code></pre>\n\n<p><code>()</code> is data constructor of arity 0, so it is the same as</p>\n\n<pre><code>(r)     case \u22a5 of { () -&gt; e; _ -&gt; e\u2032 } =  \u22a5\n</code></pre>\n\n<p>and the overall result of the evaluation is thus <code>\u22a5</code>.</p>\n"}], "owner": {"reputation": 143, "user_id": 3994996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb35d257393c28994b4569319b2f407?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptozoon", "link": "https://stackoverflow.com/users/3994996/kryptozoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 1, "answer_count": 1, "score": 12, "last_activity_date": 1579618722, "creation_date": 1574862411, "last_edit_date": 1579618722, "question_id": 59071644, "link": "https://stackoverflow.com/questions/59071644/what-rules-are-there-about-a-function-a-being-evaluated-in-haskell", "title": "What rules are there about a function a -&gt; () being evaluated in Haskell?", "body": "<p>Just as the title says: what guarantees are there for a Haskell function returning unit to be evaluated? One would think that there is no need to run any kind of evaluation in such a case, the compiler could replace all such calls with an immediate <code>()</code> value unless explicit requests for strictness are present, in which case the code might have to decide whether it should return <code>()</code> or bottom.<br>\nI have experimented with this in GHCi, and it seems like the opposite happens, that is, such a function appears to be evaluated. A very primitive example would be</p>\n\n<pre><code>f :: a -&gt; ()\nf _ = undefined\n</code></pre>\n\n<p>Evaluating <code>f 1</code> throws an error due to the presence of <code>undefined</code>, so some evaluation definitely happens. It is not clear how deep the evaluation goes, though; sometimes it appears to go as deep as it is necessary to evaluate all calls to functions returning <code>()</code>. Example:</p>\n\n<pre><code>g :: [a] -&gt; ()\ng [] = ()\ng (_:xs) = g xs\n</code></pre>\n\n<p>This code loops indefinitely if presented with <code>g (let x = 1:x in x)</code>. But then</p>\n\n<pre><code>f :: a -&gt; ()\nf _ = undefined\nh :: a -&gt; ()\nh _ = ()\n</code></pre>\n\n<p>can be used to show that <code>h (f 1)</code> returns <code>()</code>, so in this case not all unit-valued subexpressions are evaluated. What is the general rule here?</p>\n\n<p>ETA: of course I know about laziness. I'm asking what prevents compiler writers from making this particular case even lazier than usually possible.</p>\n\n<p>ETA2: summary of the examples: GHC appears to treat <code>()</code> exactly as any other type, i.e. as if there was a question about which regular value inhabiting the type should be returned from a function. The fact that there's only one such value does not seem to be (ab)used by the optimization algorithms.</p>\n\n<p>ETA3: when I say Haskell, I mean Haskell-as-defined-by-the-Report, not Haskell-the-H-in-GHC. Seems to be an assumption not shared as widely as I imagined (which was 'by 100% of the readers'), or I would probably have been able to formulate a clearer question. Even so, I regret changing the title of the question, as it originally asked what <em>guarantees</em> are there for such a function being called.</p>\n\n<p>ETA4: it would seem that this question has run its course, and I'm considering it unanswered. (I was looking for a 'close question' function but only found 'answer your own question' and as it cannot be answered, I did not go down that route.) No one brought up anything from the Report that would decide it either way, which I'm tempted to interpret as a strong but not definite 'no guarantee for the language as such' answer. All we know is that the current GHC implementation will not skip the evaluation of such a function.</p>\n\n<p>I've run into the actual problem when porting an OCaml app to Haskell. The original app had a mutually recursive structure of many types, and the code declared a number of functions called <code>assert_structureN_is_correct</code> for N in 1..6 or 7, each of which returned unit if the structure was indeed correct and threw an exception if it was not. In addition, these functions called each other as they decomposed the correctness conditions. In Haskell this is better handled using the <code>Either String</code> monad, so I transcribed it that way, but the question as a theoretical issue remained. Thanks for all the inputs and replies.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574851511, "post_id": 59068318, "comment_id": 104374974, "body": "This is quite an interesting problem. I don&#39;t have time to write an answer but, as a hint, my first thought is to use <code>zip</code> to pair up elements of the list with their predecessors, and work from there. Doubtless there are other approaches though."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 1, "creation_date": 1574851835, "post_id": 59068318, "comment_id": 104375140, "body": "Just roll your own recursive function, that should not be that hard. Is that a homework assignment?"}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1574855712, "post_id": 59068318, "comment_id": 104377302, "body": "<code>zip</code> the list with its <code>tail</code> to get a list of pairs like <code>[(elem, prev_elem)]</code>, then filter by the condition and lastly retrive the first elem of each pair. Be carefull! the tail of a list is not a total function"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1574859561, "post_id": 59068318, "comment_id": 104379496, "body": "This looks quite similar to <a href=\"https://stackoverflow.com/questions/58687161/how-to-filter-list-elements-in-haskell-based-on-previous-value-in-the-list/58691485#58691485\">SO question 58687161</a>. Title of question: How to filter list elements in Haskell based on previous value in the list?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1574867243, "post_id": 59068318, "comment_id": 104384058, "body": "@lsmor <code>zip [] (tail [])</code> works. :) of course you&#39;re right, it&#39;s cleaner to write  <code>zip xs (drop 1 xs)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 3, "last_activity_date": 1574869261, "last_edit_date": 1574869261, "creation_date": 1574852133, "answer_id": 59068584, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define/59068584#59068584", "title": "Greaters function define", "body": "<p>I would start from here:</p>\n\n<pre><code>greaters :: Ord a =&gt; [a] -&gt; [a]\ngreaters [] = []\ngreaters (x:xs) = greatersImpl x xs\n    where\n        greatersImpl last [] = &lt;fill this out&gt;\n        greatersImpl last (x:xs) = &lt;fill this out&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574868441, "post_id": 59068865, "comment_id": 104384706, "body": "why shouldn&#39;t it work for infinite lists? nothing inherently demands <code>take 3 . greaters $ [1..]</code> to diverge."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574875075, "post_id": 59068865, "comment_id": 104388213, "body": "<code>foldr</code> can do this. the hand-rolled recursion in the accepted answer fits the <code>foldr</code> pattern, just needs <a href=\"https://stackoverflow.com/a/59075309/849891\">some arguments flipping</a> in the worker."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574878334, "post_id": 59068865, "comment_id": 104389700, "body": "Yeah, this seems much more like a <code>foldr</code> problem than a <code>foldl</code> one."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1574853597, "last_edit_date": 1574853597, "creation_date": 1574853054, "answer_id": 59068865, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define/59068865#59068865", "title": "Greaters function define", "body": "<p>\"Roll your own recursive function\" is certainly an option here, but it can also be accomplished with a <code>fold</code>. <code>filter</code> can't do it because we need some sort of state being passed, but <code>fold</code> can nicely accumulate the result while keeping that state at the same time.</p>\n\n<p>Of course the key idea is that we keep track of last element add the next one to the result set if it's greater than the last one.</p>\n\n<pre><code>greaters :: [Int] -&gt; [Int]\ngreaters [] = []\ngreaters (h:t) = reverse . snd $ foldl (\\(a, r) x -&gt; (x, if x &gt; a then x:r else r)) (h, []) t\n</code></pre>\n\n<p>I'd really love to eta-reduce it but since we're dropping the first element and seeding the accumulator with it it kinda becomes awkward with the empty list; still, this is effectively an one-liner.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2927484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051331b227eab5420d3f27d22109b4ad?s=128&d=identicon&r=PG&f=1", "display_name": "parkerbrads", "link": "https://stackoverflow.com/users/2927484/parkerbrads"}, "is_accepted": false, "score": 2, "last_activity_date": 1574857607, "creation_date": 1574857607, "answer_id": 59070222, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define/59070222#59070222", "title": "Greaters function define", "body": "<p>The following functions are everything you\u2019d need for one possible solution :)</p>\n\n<pre><code>zip :: [a] -&gt; [b] -&gt; [(a, b)]\ndrop 1 :: [a] -&gt; [a]\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n(&lt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\nuncurry :: (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nsnd :: (a, b) -&gt; b\n</code></pre>\n\n<p>Note: <code>drop 1</code> can be used when you\u2019d prefer a \u201csafe\u201d version of <code>tail</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574885236, "post_id": 59075309, "comment_id": 104392572, "body": "@dfeuer thanks for the edit, w/ guards it&#39;s much cleaner of course. would you mind terribly if I flattened and sparsed it up a bit and aligned vertically? it&#39;s much easier to &quot;see&quot; the code that way, I think. if you much prefer your version we&#39;d revert."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574885577, "post_id": 59075309, "comment_id": 104392693, "body": "I&#39;ll offer a compromise: make it more horizontal  but reduce all tabs to two spaces. Also, have a look at my answer."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574893147, "post_id": 59075309, "comment_id": 104395465, "body": "Very nice deduction!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574929227, "post_id": 59075309, "comment_id": 104404684, "body": "@typetetris it&#39;s a bit tricky (not to say trickster-y) because some intermediate steps are of course not exactly valid Haskell  and it&#39;s all very handwavy and approximate but could be made more rigorous, perhaps. :)"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574972010, "post_id": 59075309, "comment_id": 104424786, "body": "That&#39;s cool but then still requires a check for <code>[]</code> i suppose."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1575014736, "post_id": 59075309, "comment_id": 104434125, "body": "@Redu have you missed it at the top of the definition? the re-writes are applied only to the second clause. I&#39;ve added a clarifying comment."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1575014793, "last_edit_date": 1575014793, "creation_date": 1574874685, "answer_id": 59075309, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define/59075309#59075309", "title": "Greaters function define", "body": "<p>We can derive a <code>foldr</code>-based solution by a series of re-writes starting from the hand-rolled recursive solution in the <a href=\"https://stackoverflow.com/a/59068584/849891\">accepted answer</a>:</p>\n\n<pre><code>greaters :: Ord a =&gt; [a] -&gt; [a]\ngreaters [] = []\ngreaters (x:xs) = go x xs          -- let's re-write this clause\n  where\n    go _ [] = []\n    go last (act:xs)\n      | last &lt; act  =  act : go act xs\n      | otherwise   =        go act xs\n\ngreaters (x:xs) = go xs x          -- swap the arguments\n  where\n    go [] _ = []\n    go (act:xs) last\n      | last &lt; act  =  act : go xs act \n      | otherwise   =        go xs act \n\ngreaters (x:xs) = foldr g z xs x   -- go ==&gt; foldr g z\n  where\n    foldr g z [] _ = []\n    foldr g z (act:xs) last\n      | last &lt; act  =  act : foldr g z xs act \n      | otherwise   =        foldr g z xs act \n\ngreaters (x:xs) = foldr g z xs x\n  where                          -- simplify according to\n    z _ = []                     --   foldr's definition\n    g act (foldr g z xs) last \n      | last &lt; act  =  act : foldr g z xs act \n      | otherwise   =        foldr g z xs act \n</code></pre>\n\n<p>Thus, with one last re-write of <code>foldr g z xs ==&gt; r</code>,</p>\n\n<pre><code>greaters (x:xs) = foldr g z xs x\n  where\n    z = const []\n    g act r last\n      | last &lt; act  =  act : r act \n      | otherwise   =        r act \n</code></pre>\n\n<p>The extra parameter serves as a <em>state</em> being passed forward as we go along the input list, the state being the previous element; thus avoiding the construction by <code>zip</code> of the shifted-pairs list serving the same purpose.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1575934757, "last_edit_date": 1575934757, "creation_date": 1574880784, "answer_id": 59076810, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define/59076810#59076810", "title": "Greaters function define", "body": "<p>If you like over-generalization like me, you can use the <code>witherable</code> package.</p>\n\n<pre><code>{-# language ScopedTypeVariables #-}\n\nimport Control.Monad.State.Lazy\nimport Data.Witherable\n\n{-\nclass (Traversable t, Filterable t) =&gt; Witherable t where\n  -- `wither` is an effectful version of mapMaybe. \n  wither :: Applicative f =&gt; (a -&gt; f (Maybe b)) -&gt; t a -&gt; f (t b)\n-}\n\ngreaters\n  :: forall t a. (Ord a, Witherable t)\n  =&gt; t a -&gt; t a\ngreaters xs = evalState (wither go xs) Nothing\n  where\n    go :: a -&gt; State (Maybe a) (Maybe a)\n    go curr = do\n      st &lt;- get\n      put (Just curr)\n      pure $ case st of\n        Nothing -&gt; Nothing\n        Just prev -&gt;\n          if curr &gt; prev\n            then Just curr\n            else Nothing\n</code></pre>\n\n<p>The state is the previous element, if there is one. Everything is about as lazy as it can be. In particular:</p>\n\n<ol>\n<li><p>If the container is a Haskell list, then it can be an infinite one and everything will still work. The beginning of the list can be produced without withering the rest.</p></li>\n<li><p>If the container extends infinitely to the left (e.g., an infinite snoc list), then everything will still work. How can that be? We only need to know what was in the previous element to work out the state for the current element.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1575137567, "post_id": 59117483, "comment_id": 104467611, "body": "I&#39;d much prefer it as <code>greaters = foldr g (const []) &lt;*&gt; head where g c r p | c&gt;p = c:r c | otherwise = r c</code>. (personally, I always use <code>r</code> there, as a mnemonic for &quot;recursive result&quot;; that it is used as a function is self-evident, I don&#39;t need it to be called <code>f</code> to remind me of that; I need much more the reminder of the role it plays in the overall <code>foldr</code> scheme). but I doubt it&#39;d be considered good style, it is too clever for its own good, with the head, and the const, etc.. too fragile. just imagine requirements change from <code>&lt;</code> to <code>&lt;=</code>, and suddenly it breaks."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575137727, "post_id": 59117483, "comment_id": 104467651, "body": "there&#39;s no reason for <code>go</code> to be globally visible. also the name, <code>go</code> is usually used for recursive functions. --- the standard way to avoid the <code>[]</code> clause is with the <code>Maybe</code>, like in dfeuer&#39;s answer."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575143670, "post_id": 59117483, "comment_id": 104469105, "body": "@WillNess So yes. i have to agree that head is hackish here and i hope to fix that. I think, as you had already mentioned somewhere, before, a <b>stateful fold</b> could be quite handy to solve problems where <code>foldl1</code> falls in short. I mean a <code>foldS :: Foldable t =&gt; (a -&gt; a -&gt; b) -&gt; t a -&gt; b</code> could be reasonable in general. As per your second comment; <code>go</code> being globally visible, that&#39;s just a matchstick code what i have displayed... <code>go</code> can easily be moved down under a where clause within greaters. I would really aprreciate if you could drop me an email so that i could consult things privately."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1575489253, "last_edit_date": 1575489253, "creation_date": 1575127061, "answer_id": 59117483, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define/59117483#59117483", "title": "Greaters function define", "body": "<p>So i have come up with a <code>foldr</code> solution. It should be similar to what @Will Ness has demonstrated but not quite i suppose as we don't need a separate empty list check in this one.</p>\n\n<p>The thing is, while folding we need to encapsulate the previous element and also the state (the result) in a function type. So in the <code>go</code> helper function <code>f</code> is the state (the result) <code>c</code> is the current element of interest and <code>p</code> is the previous one (next since we are folding right). While folding from right to left we are nesting up these functions only to run it by applyying the <code>head</code> of the input list to it.</p>\n\n<pre><code>go :: Ord a =&gt; a -&gt; (a -&gt; [a]) -&gt; (a -&gt; [a])\ngo c f = \\p -&gt; let r = f c \n               in if c &gt; p then c:r else r\n\ngreaters :: Ord a =&gt; [a] -&gt; [a]\ngreaters = foldr go (const []) &lt;*&gt; head\n\n*Main&gt; greaters [1,3,2,4,3,4,5]\n[3,4,4,5]\n*Main&gt; greaters [5,10,6,11,7,12]\n[10,11,12]\n*Main&gt; greaters [651,151,1651,21,651,1231,4,1,16,135,87]\n[1651,651,1231,16,135]\n*Main&gt; greaters [1]\n[]\n*Main&gt; greaters []\n[]\n</code></pre>\n\n<p>As per rightful comments of @Will Ness here is a modified slightly more general code which hopefully doesn't break suddenly when the comparison changes. Note that <code>const [] :: b -&gt; [a]</code> is the initial function and <code>[]</code> is the terminator applied to the result of <code>foldr</code>. We don't need <code>Maybe</code> since <code>[]</code> can easily do the job of <code>Nothing</code> here.</p>\n\n<pre><code>gs :: Ord a =&gt; [a] -&gt; [a]\ngs xs = foldr go (const []) xs $ []\n        where\n        go :: Ord a =&gt; a -&gt; ([a] -&gt; [a]) -&gt; ([a] -&gt; [a])\n        go c f = \\ps -&gt; let r = f [c]\n                        in case ps of\n                           []  -&gt; r\n                           [p] -&gt; if c &gt; p then c:r else r\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 12118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1672f667ef2e09d09ff3f4d20079fce?s=128&d=identicon&r=PG&f=1", "display_name": "Beszteri", "link": "https://stackoverflow.com/users/12118780/beszteri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 59068584, "answer_count": 6, "score": 3, "last_activity_date": 1575934757, "creation_date": 1574851334, "question_id": 59068318, "link": "https://stackoverflow.com/questions/59068318/greaters-function-define", "title": "Greaters function define", "body": "<p>I would like to define a greaters function, which selects from a list items that are larger than the one before it.</p>\n\n<p>For instance:</p>\n\n<pre><code>greaters [1,3,2,4,3,4,5] == [3,4,4,5]\ngreaters [5,10,6,11,7,12] == [10,11,12]\n</code></pre>\n\n<p>The definition I came up with is this :</p>\n\n<pre><code>greaters :: Ord a =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Things I tried so far:</p>\n\n<pre><code>greaters (x:xs) = group [ d | d &lt;- xs, x &lt; xs ]\n</code></pre>\n\n<p>Any tips?</p>\n"}, {"tags": ["haskell", "compilation"], "comments": [{"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1574845789, "post_id": 59066454, "comment_id": 104371620, "body": "According to the <a href=\"https://wiki.haskell.org/Introduction_to_Haskell_IO/Actions\" rel=\"nofollow noreferrer\">relevant section of the Haskell Wiki</a> it should be <code>putStrLn</code> and not <code>printStrLn</code>."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574846046, "post_id": 59066454, "comment_id": 104371752, "body": "After changing the file ending, that&#39;s their next error message."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 11, "last_activity_date": 1574869034, "last_edit_date": 1574869034, "creation_date": 1574845527, "answer_id": 59066557, "question_id": 59066454, "link": "https://stackoverflow.com/questions/59066454/cant-compile-a-hello-world-in-haskell/59066557#59066557", "title": "Can&#39;t compile a hello world in haskell", "body": "<p>Rename <code>hello.hc</code> to <code>hello.hs</code> and try</p>\n\n<pre><code>ghc hello.hs\n</code></pre>\n\n<p>again.</p>\n\n<p>Calling</p>\n\n<pre><code>ghc --help\n</code></pre>\n\n<p>on my compiler explains (parts of usage omitted):</p>\n\n<pre><code>For each input file, the phase to START with is determined by the\nfile's suffix:\n\n    - .lhs  literate Haskell         unlit\n    - .hs   plain Haskell            ghc\n    - .hc   C from the Haskell compiler  gcc\n    - .c    C not from the Haskell compiler  gcc\n    - .s    assembly language        as\n    - other passed directly to the linker    ld\n\nThe phase at which to STOP processing is determined by a command-line\noption:\n\n    -E      stop after generating preprocessed, de-litted Haskell\n             (used in conjunction with -cpp)\n    -C      stop after generating C (.hc output)\n    -S      stop after generating assembler (.s output)\n    -c      stop after generating object files (.o output)\n</code></pre>\n\n<p>If you try to compile your <code>test.hc</code> with <code>gcc</code> that is just the error message you get from the <code>C</code> compiler.</p>\n\n<pre><code>[nix-shell:~]$ gcc -x c -std=c99 -o test test.hc\ntest.hc:1:1: warning: data definition has no type or storage class\n main = do\n ^~~~\ntest.hc:1:1: warning: type defaults to \u2018int\u2019 in declaration of \u2018main\u2019 [-Wimplicit-int]\ntest.hc:1:8: error: expected expression before \u2018do\u2019\n main = do\n        ^~\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 2151409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/208b7885897601e9683a8e087672ff81?s=128&d=identicon&r=PG", "display_name": "judent", "link": "https://stackoverflow.com/users/2151409/judent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 59066557, "answer_count": 1, "score": -1, "last_activity_date": 1574869034, "creation_date": 1574845135, "question_id": 59066454, "link": "https://stackoverflow.com/questions/59066454/cant-compile-a-hello-world-in-haskell", "title": "Can&#39;t compile a hello world in haskell", "body": "<p>I just started to learn haskell using book \"Get Programming with Haskell\". The first think I am trying to do is simply compile hello world example from this book.\nMy code in file hello.hc is:</p>\n\n<pre><code>main = do\n    printStrLn \"Hello!\"\n</code></pre>\n\n<p>I run ghc using command </p>\n\n<pre><code>ghc hello.hc\n</code></pre>\n\n<p>But all I got is an error!</p>\n\n<pre><code>hello.hc:1:1: error:\n     warning: data definition has no type or storage class\n     main = do\n     ^\n\nhello.hc:1:1: error:\n     warning: type defaults to 'int' in declaration of 'main' [-Wimplicit-int]\n\nhello.hc:1:8: error:\n     error: expected expression before 'do'\n     main = do\n            ^\n`gcc.exe' failed in phase `C Compiler'. (Exit code: 1)\n</code></pre>\n\n<p>My Haskell Platform version is 8.01, </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 6, "last_activity_date": 1574816301, "creation_date": 1574816301, "answer_id": 59061556, "question_id": 59061537, "link": "https://stackoverflow.com/questions/59061537/set-options-in-ghci/59061556#59061556", "title": "Set options in ghci", "body": "<p>Language features enabled in the individual modules don't propagate to <code>ghci</code> session. You have to re-enable them, i.e. do <code>:set -XQuasiQuotes</code>.</p>\n\n<hr>\n\n<p>By the way, you should enable language features using</p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\n</code></pre>\n\n<p>syntax in the Haskell source files.</p>\n"}], "owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 59061556, "answer_count": 1, "score": 4, "last_activity_date": 1574816301, "creation_date": 1574816156, "question_id": 59061537, "link": "https://stackoverflow.com/questions/59061537/set-options-in-ghci", "title": "Set options in ghci", "body": "<p>I'm trying to use string interpolations like here <a href=\"http://hackage.haskell.org/package/interpolate-0.2.0/docs/Data-String-Interpolate.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/interpolate-0.2.0/docs/Data-String-Interpolate.html</a></p>\n\n<p>Specifically, </p>\n\n<pre><code>&gt;&gt;&gt; :set -XQuasiQuotes\n&gt;&gt;&gt; import Data.String.Interpolate\n\n&gt;&gt;&gt; let name = \"Marvin\"\n&gt;&gt;&gt; putStrLn [i|name: #{name}|]\nname: Marvin\n</code></pre>\n\n<p>If I run this in ghci it works fine. Also if i write  a file like shown here, this also works <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/ch04s02.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/ch04s02.html</a></p>\n\n<pre><code>{-# OPTIONS_GHC -XQuasiQuotes #-}\nimport Data.String.Interpolate\n\nmain = do\n  let name = \"Marvin\"\n  putStrLn [i|name: #{name}|]\n</code></pre>\n\n<p>But if I just use the options and import in the file, and run the commands in ghci i get an error <code>parse error on input'#'</code></p>\n\n<pre><code>-- in file example.hs\n{-# OPTIONS_GHC -XQuasiQuotes #-}    \nimport Data.String.Interpolate\n\n-- in GHCi, ghci example.hs, then run\n&gt; let name = \"Marvin\"\n&gt; putStrLn [i|name: #{name}|]\n`parse error on input'#'`\n\nwhat's happening here and why can't i run the command in ghci?\nthanks\n</code></pre>\n"}, {"tags": ["haskell", "emacs", "haskell-stack", "intero"], "comments": [{"owner": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1574801393, "post_id": 59058854, "comment_id": 104357713, "body": "You can try stepping through  <code>flycheck-buffer</code> by instrumenting it with <code>edebug-defun</code> (see <a href=\"https://www.gnu.org/software/emacs/manual/html_node/elisp/Edebug.html#Edebug\" rel=\"nofollow noreferrer\">Edebug</a>). Looking at the code of <code>flycheck-buffer</code>, it&#39;s not clear to me where the error happens: if you are unable to use Edebug, you might at least try loading the uncompiled version of flycheck.el with <code>(load-library &quot;flycheck.el&quot;)</code> and posting a more detailed backtrace."}, {"owner": {"reputation": 183, "user_id": 10020420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fc6395be2407d2edc5cb0d6325eb96?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10020420/maxim"}, "reply_to_user": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1574802266, "post_id": 59058854, "comment_id": 104358083, "body": "Using edebug reveals that in <code>flycheck-buffer</code> the call to <code>(flycheck-start-current-syntax-check checker)</code> returns <code>nil</code>. Does this mean that it can&#39;t find the <code>intero</code> binary (<code>checker</code> is set to <code>&quot;intero&quot;</code>)?"}, {"owner": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1574805147, "post_id": 59058854, "comment_id": 104359218, "body": "Returning nil is not a problem: does it signal an error? If so, try again and step into it with <code>i</code> instead of executing the call with SPACE, and then continue drilling down until you find the culprit."}, {"owner": {"reputation": 183, "user_id": 10020420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fc6395be2407d2edc5cb0d6325eb96?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10020420/maxim"}, "reply_to_user": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1574972726, "post_id": 59058854, "comment_id": 104424992, "body": "So it&#39;s somewhere below <code>flycheck-syntax-check-start</code>, the subexpression <code>(funcall (flycheck-checker-get checker &#39;start) checker callback)</code> does not return. I can&#39;t seem to get inside it with <code>i</code>, it says &quot;funcall is a builtin function&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 3424369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4049bdc8eba3a01985c97ea40f1dd599?s=128&d=identicon&r=PG", "display_name": "mikake", "link": "https://stackoverflow.com/users/3424369/mikake"}, "is_accepted": false, "score": 6, "last_activity_date": 1577099070, "last_edit_date": 1577099070, "creation_date": 1577050270, "answer_id": 59448178, "question_id": 59058854, "link": "https://stackoverflow.com/questions/59058854/intero-error-wrong-type-argument-stringp-nil/59448178#59448178", "title": "intero error: wrong-type-argument stringp nil", "body": "<p><strong>TL;DR</strong></p>\n\n<p>I found two issues and a (at least temporary) fix for each of them.\nI am submitting pull requests for both of them, but in the mean time you can fix the issue for yourself either by editing the intero.el file directly, or (recommended way) by using the great <a href=\"https://github.com/raxod502/el-patch\" rel=\"noreferrer\">el-patch</a> package.</p>\n\n<h3>1) <code>intero-ghc-version</code> not set</h3>\n\n<p>This is due to the fact of using the <code>intero-ghc-version</code> local variable instead of calling the function <code>(intero-ghc-version)</code> in the <code>intero-ghci-output-flags</code> function (L.2668) <a href=\"https://github.com/chrisdone/intero/blob/master/elisp/intero.el\" rel=\"noreferrer\">intero.el</a></p>\n\n<p><strong>Fix:</strong> patch the function <code>intero-ghci-output-flags</code> :\nreplace </p>\n\n<pre><code>(split-string intero-ghc-version \"\\\\.\"))))\n</code></pre>\n\n<p>by </p>\n\n<pre><code>(split-string (intero-ghc-version) \"\\\\.\"))))\n</code></pre>\n\n<p>(notice the added parentheses)</p>\n\n<h3>2) misuse of <code>append</code> for string concatenation in <code>intero-start-process-in-buffer</code></h3>\n\n<p><code>append</code> is for lists, <code>concat</code> is for strings, an easy mistake, especially when in Haskell <code>String</code> is equivalent to <code>[Char]</code> (so technically... a list!)</p>\n\n<p><strong>fix:</strong> patch the function <code>intero-start-process-in-buffer</code>, L.2335 of the <a href=\"https://github.com/chrisdone/intero/blob/master/elisp/intero.el\" rel=\"noreferrer\">intero.el</a>:\nreplace</p>\n\n<pre><code> (process-send-string process (append \":set \" flag \"\\n\")))\n</code></pre>\n\n<p>by</p>\n\n<pre><code> (process-send-string process (concat \":set \" flag \"\\n\")))\n</code></pre>\n\n<p>line 2335 of the current version of the <a href=\"https://github.com/chrisdone/intero/blob/master/elisp/intero.el\" rel=\"noreferrer\">source code</a>, using <a href=\"https://github.com/raxod502/el-patch\" rel=\"noreferrer\">el-patch</a>)</p>\n\n<p>Once these modifications are made, you should be up and running!</p>\n\n<hr>\n\n<h3><strong>Initial answer</strong></h3>\n\n<hr>\n\n<p>Same issue here.</p>\n\n<p>Not a definitive answer, but I have the same issue and might have pinned down the issue to the function <code>intero-ghci-output-flags</code> being run as the <code>intero-ghc-version</code> variable is not set properly.\nFeel free to correct me as I might have missed some things.</p>\n\n<p>By following the error messages, I confirm it happens in <code>(flycheck-start-current-syntax-check checker)</code> in the <code>flycheck-buffer</code> function.<br>\nRunning this directly from the haskell buffer shows that the error happens when calling <code>(split-string intero-ghc-version \"\\\\.\")</code> from the <code>intero-ghci-output-flags</code> function in the <a href=\"https://github.com/chrisdone/intero/blob/master/elisp/intero.el\" rel=\"noreferrer\">intero.el</a> file (Line 2671). </p>\n\n<p>This tries to split the intero version (as set by the <code>intero-ghc-version</code> function above in the file).<br>\nIt seems the variable's value is <code>nil</code>, as confirmed by running <code>M-x describe-variable -&gt; intero-ghc-version</code>.</p>\n\n<p>During my tests I got seemingly imprevisible results from <code>(intero-ghc-version)</code>.\nSometimes (at least on the first run?) it returns \"8.4.4\",<br>\nsometimes it fails with <code>\"Wrong type argument: stringp, (58 115 101 116 32 45 102 111 98 106 ...)</code></p>\n\n<p>I am able to manually run the function <code>intero-ghci-output-flags</code> and get the proper output without error, once, and it fails if I run it a second time.</p>\n\n<p>the function <code>(intero-ghc-version-raw)</code> consistently returns \"8.4.4\" however.</p>\n\n<p>After experimenting the error message that spontaneously appears is transformed to:</p>\n\n<pre><code>Debugger entered--Lisp error: (wrong-type-argument stringp (58 115 101 116 32 45 102 111 98 106 101 99 116 45 99 111 100 101 . \"\\n\"))\n  process-send-string(#&lt;process stack&gt; (58 115 101 116 32 45 102 111 98 106 101 99 116 45 99 111 100 101 . \"\\n\"))\n  #f(compiled-function (flag) #&lt;bytecode 0x1785fe9&gt;)(\"-fobject-code\")\n  mapc(#f(compiled-function (flag) #&lt;bytecode 0x1785fe9&gt;) (\"-fobject-code\"))\n  intero-start-process-in-buffer(#&lt;buffer  intero:backend:pubiber /home/mika/programmation/haskell/pubiber&gt; nil #&lt;buffer Lib.hs&gt; nil)\n  intero-get-worker-create(backend nil #&lt;buffer Lib.hs&gt; nil)\n  intero-buffer(backend)\n  intero-eldoc()\n</code></pre>\n\n<p>The ASCII char sequence in the error message is \":set -fobject-code\".\nThe \"-fobject-code\" in the message is the result of the <code>intero-ghci-output-flags</code> function, so it seems it finally worked properly but the rest of the code failed.</p>\n\n<p><strong>Note:</strong>\nThe fact that the file gets re-evaluated whenever intero tries to start a session might to explain why I get inconsistent results when running the functions several times.</p>\n\n<p><strong>PS</strong> running arch linux, system updated a few minutes ago, all emacs package updated.</p>\n\n<p><strong>---- EDIT ----</strong></p>\n\n<p>So after looking a bit more, in the function <code>intero-start-process-in-buffer</code>, that uses the flags to start the intero process in the lines 2334-2337:</p>\n\n<pre><code>      (set-process-query-on-exit-flag process nil)\n      (mapc\n       (lambda (flag)\n         (process-send-string process (append \":set \" flag \"\\n\")))\n       (intero-ghci-output-flags))\n      (process-send-string process \":set -fdefer-type-errors\\n\")\n</code></pre>\n\n<p>they use <code>append</code> instead of <code>concat</code> to create the command.<br>\nreplacing <code>append</code> by <code>concat</code> fixes this second error, and intero boots normally and seems to work properly (after setting <code>intero-ghc-version</code>).</p>\n\n<p><strong>---- EDIT 2 ----</strong></p>\n\n<p>Just figured out the original issue:\nThe function uses the variable <code>intero-ghc-version</code> instead of calling the function with the same name. The function is supposed to act as a lazy loader of the value, calling <code>intero-ghc-version-raw</code> the first time, and returning the cached value the subsequent times.</p>\n\n<p>Calling the variable directly didn't allow the value to be set initially.\nSee the TL;DR for the temporary fix.</p>\n"}], "owner": {"reputation": 183, "user_id": 10020420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fc6395be2407d2edc5cb0d6325eb96?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10020420/maxim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1577099070, "creation_date": 1574799973, "question_id": 59058854, "link": "https://stackoverflow.com/questions/59058854/intero-error-wrong-type-argument-stringp-nil", "title": "intero error: wrong-type-argument stringp nil", "body": "<p>I'm trying to get  <a href=\"https://haskell-lang.org/intero\" rel=\"noreferrer\">intero</a> running. After install, opening a Haskell file from an existing stack project results in:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>Debugger entered--Lisp error: (wrong-type-argument stringp nil)\n  signal(wrong-type-argument (stringp nil))\n  flycheck-buffer()\n  flycheck-buffer-automatically()\n  flycheck-perform-deferred-syntax-check()\n  set-window-buffer(#&lt;window 1 on Lib.hs&gt; #&lt;buffer Lib.hs&gt;)\n  window--display-buffer(#&lt;buffer Lib.hs&gt; #&lt;window 1 on Lib.hs&gt; reuse ((inhibit-same-window)))\n  display-buffer-same-window(#&lt;buffer Lib.hs&gt; ((inhibit-same-window)))\n  display-buffer(#&lt;buffer Lib.hs&gt; (display-buffer-same-window (inhibit-same-window)))\n  pop-to-buffer(#&lt;buffer Lib.hs&gt; (display-buffer-same-window (inhibit-same-window)) nil)\n  pop-to-buffer-same-window(#&lt;buffer Lib.hs&gt;)\n  find-file(\"~/test/src/Lib.hs\" t)\n  funcall-interactively(find-file \"~/test/src/Lib.hs\" t)\n  call-interactively(find-file nil nil)\n  command-execute(find-file)\n</code></pre>\n\n<p>When I run <code>flycheck-buffer</code> in the same buffer, nothing happens, even when there are errors in the source code.</p>\n\n<p>Here are the contents of my <code>.emacs</code> file:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(setq debug-on-error t)\n\n(require 'package)\n(add-to-list 'package-archives '(\"melpa\" . \"http://melpa.org/packages/\") t)\n(package-initialize)\n(package-refresh-contents)\n\n(package-install 'intero)\n(add-hook 'haskell-mode-hook 'intero-mode)\n</code></pre>\n\n<p>Since I'm on Mac Os I also tried adding (as suggested on the flycheck page):</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(package-install 'exec-path-from-shell)\n(exec-path-from-shell-initialize)\n</code></pre>\n\n<p>But it makes no difference.</p>\n\n<p>Here are the installed package versions:</p>\n\n<pre><code>$ ls ~/.emacs.d/elpa/\narchives/\ncompany-20191114.1356/\ndash-20191109.1327/\nepl-20180205.2049/\nflycheck-20191126.1329/\nhaskell-mode-20191120.1923/\nintero-20191103.1239/\npkg-info-20150517.1143/\n</code></pre>\n\n<p>This is using GNU Emacs 26.3.</p>\n"}, {"tags": ["sql", "haskell", "servant", "data-kinds"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1574805552, "post_id": 59058789, "comment_id": 104359363, "body": "I couldn&#39;t find a question. Could you point out what it is?"}, {"owner": {"reputation": 158, "user_id": 9829124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7d1c0d0730d3f3617f337ea602c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hopia", "link": "https://stackoverflow.com/users/9829124/hopia"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574805853, "post_id": 59058789, "comment_id": 104359489, "body": "Thanks for pointing that out. I added a question at the end. The problem is types/kinds, mainly with Schema vs Schemas and how to write the type signatures of functions accordingly."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1574805890, "post_id": 59058789, "comment_id": 104359496, "body": "Please include your question into the section above. It makes it easier for future readers."}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 9829124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7d1c0d0730d3f3617f337ea602c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hopia", "link": "https://stackoverflow.com/users/9829124/hopia"}, "edited": false, "score": 0, "creation_date": 1574806343, "post_id": 59060048, "comment_id": 104359676, "body": "Thanks! My problem is more accurately that I can&#39;t derive a <code>MonadReader</code> instance from my <code>AppT</code> if I use <code>Schemas</code> instead of <code>Schema</code> in <code>type SquealPool</code> (<code>type PoolDB</code> in yours). Since <code>Schemas</code> is a type family"}, {"owner": {"reputation": 46, "user_id": 2052597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7ff6bdd6904bb74c5e233242582baa0?s=128&d=identicon&r=PG", "display_name": "user2052597", "link": "https://stackoverflow.com/users/2052597/user2052597"}, "reply_to_user": {"reputation": 158, "user_id": 9829124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7d1c0d0730d3f3617f337ea602c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hopia", "link": "https://stackoverflow.com/users/9829124/hopia"}, "edited": false, "score": 2, "creation_date": 1574806589, "post_id": 59060048, "comment_id": 104359761, "body": "You can probably evaluate the type family to <code>&#39;[&quot;public&quot; ::: Schema]</code>"}], "tags": [], "owner": {"reputation": 46, "user_id": 2052597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7ff6bdd6904bb74c5e233242582baa0?s=128&d=identicon&r=PG", "display_name": "user2052597", "link": "https://stackoverflow.com/users/2052597/user2052597"}, "is_accepted": true, "score": 3, "last_activity_date": 1574805897, "creation_date": 1574805897, "answer_id": 59060048, "question_id": 59058789, "link": "https://stackoverflow.com/questions/59058789/haskell-squeal-sql-library-type-error-with-monadreader/59060048#59060048", "title": "Haskell Squeal SQL library - Type error with MonadReader", "body": "<p>Here's a skeleton of how I combine Squeal &amp; Servant.</p>\n\n<pre><code>{-# LANGUAGE\n    DataKinds\n  , OverloadedLabels\n  , OverloadedStrings\n  , PolyKinds\n#-}\n\nmodule SquealServant where\n\nimport Control.Monad.IO.Class\nimport Data.String\nimport Servant\nimport Squeal.PostgreSQL\nimport Data.Pool\n\ntype DB = Public Schema\n\ntype Schema = '[] -- your schema here\n\ntype API = Get '[JSON] String -- your api here\n\ntype PoolDB = Pool (K Connection DB)\n\napplication :: PoolDB -&gt; Application\napplication pool = serve api (server pool)\n\nserver :: PoolDB -&gt; Server API\nserver pool = hoistServer api (handler pool) serverT\n\nhandler :: PoolDB -&gt; PQ DB DB IO x -&gt; Handler x\nhandler pool session = do\n  errOrResult &lt;- liftIO . usingConnectionPool pool $\n    trySqueal (transactionally_ session)\n  case errOrResult of\n    Left err -&gt; throwError (sqlErr err)\n    Right result -&gt; return result\n\nsqlErr :: SquealException -&gt; ServerError\nsqlErr err = err500 { errBody = fromString (show err) }\n\napi :: Proxy API\napi = Proxy\n\nserverT :: ServerT API (PQ DB DB IO)\nserverT = hello\n\nhello :: PQ DB DB IO String\nhello = do\n  Only greeting &lt;- getRow 0 =&lt;&lt; runQuery helloQ\n  return greeting\n\nhelloQ :: Query_ DB () (Only String)\nhelloQ = values_ (\"hello world\" `as` #fromOnly)\n\nusingConnectionPool :: PoolDB -&gt; PQ DB DB IO x -&gt; IO x\nusingConnectionPool pool (PQ session) = unK &lt;$&gt; withResource pool session\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 9829124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7d1c0d0730d3f3617f337ea602c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hopia", "link": "https://stackoverflow.com/users/9829124/hopia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 59060048, "answer_count": 1, "score": 2, "last_activity_date": 1574807134, "creation_date": 1574799649, "last_edit_date": 1574807134, "question_id": 59058789, "link": "https://stackoverflow.com/questions/59058789/haskell-squeal-sql-library-type-error-with-monadreader", "title": "Haskell Squeal SQL library - Type error with MonadReader", "body": "<p>I'm building a Haskell <code>Servant</code> API using an SQL library called <code>Squeal</code>:\n<a href=\"https://github.com/morphismtech/squeal\" rel=\"nofollow noreferrer\">https://github.com/morphismtech/squeal</a></p>\n\n<p><strong>I need help getting the types correct so the app compiles.</strong></p>\n\n<p>My <strong>Schema</strong> is of type\n</p>\n\n<pre><code>type Schema = '[\"users\" ::: UsersTable, ...]\ntype Schemas = Public Schema\n</code></pre>\n\n<p>Where <code>Public</code> is a type family for a single schema database. It's from:\n<a href=\"http://hackage.haskell.org/package/squeal-postgresql-0.5.1.0/docs/Squeal-PostgreSQL-Schema.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/squeal-postgresql-0.5.1.0/docs/Squeal-PostgreSQL-Schema.html</a></p>\n\n<p>I'm trying to pass the Connection Pool in a Reader like this:\n</p>\n\n<pre><code>import qualified Squeal.PostgreSQL             as S\nimport qualified Squeal.PostgreSQL.Pool        as SPG\n\nnewtype AppT m a\n    = AppT\n    { runApp :: ReaderT SquealPool (ExceptT ServerError m) a\n    } deriving\n    ( Functor, Applicative, Monad, MonadReader SquealPool, MonadError ServerError\n    , MonadIO\n    )\n\ntype App = AppT IO\n\ntype SquealPool = SPG.Pool (SQ.K S.Connection Schema)\n</code></pre>\n\n<p>My SQL query &amp; session are something like this:\n</p>\n\n<pre><code>emailQuery :: Query_ Schemas (Only Text) UserEmail\nemailQuery = select (#email `as` #email)\n                    (from (table #users) &amp; where_ (#email .== param @1))\n\nemailTakenSession\n    :: (MonadReader SquealPool m, MonadPQ Schemas m, MonadIO m)\n    =&gt; Text\n    -&gt; m UserEmail\nemailTakenSession email = do\n    result &lt;- runQueryParams emailQuery (Only email)\n    email  &lt;- getRow 1 result\n    return email\n</code></pre>\n\n<p>Finally, I'm using them in the <code>Servant</code> handlers like this:\n</p>\n\n<pre><code>emailTaken :: MonadIO m =&gt; Text -&gt; AppT m APIEmail\nemailTaken emailStr = do\n    pool   &lt;- ask -- this produces error\n    result &lt;- liftIO $ runPoolPQ (Q.emailTakenSession emailStr) pool\n    return $ APIEmail result True\n</code></pre>\n\n<h2>Problem</h2>\n\n<p>The compiler reports an error in <code>ask</code> in <code>emailTaken</code>:</p>\n\n<pre><code> * Couldn't match kind `[(ghc-prim-0.5.3:GHC.Types.Symbol,\n                         Squeal.PostgreSQL.Schema.SchemumType)]'\n                 with `Squeal.PostgreSQL.Schema.SchemumType' \n</code></pre>\n\n<p>From what I understand, it's trying to match type family <code>Schemas</code> with type <code>Schema</code>.</p>\n\n<h2>Question</h2>\n\n<p><strong>How do I need to edit the type signatures to get this to compile and work?</strong>\nParticularly <code>emailTakenSession</code> is probably off at least.</p>\n\n<hr>\n\n<h2>Solution</h2>\n\n<p>In the interest of completeness for other readers, I needed to change\n</p>\n\n<pre><code>type SquealPool = SPG.Pool (SQ.K S.Connection Schema)\n</code></pre>\n\n<p>into\n</p>\n\n<pre><code>type SquealPool = SPG.Pool (S.K S.Connection '[\"public\" ::: Schema])\n</code></pre>\n\n<p>The type family would resolve to this anyway, and this way I'm not providing an  illegal construct (a type family) to MonadReader derivation in <code>AppT</code>.</p>\n"}, {"tags": ["multithreading", "haskell", "ghc", "child-process"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1574804622, "post_id": 59057716, "comment_id": 104359030, "body": "Pretty sure those are the thread pool for <code>safe</code> ffi calls."}], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 3, "last_activity_date": 1574849835, "last_edit_date": 1574849835, "creation_date": 1574849292, "answer_id": 59067681, "question_id": 59057716, "link": "https://stackoverflow.com/questions/59057716/understanding-the-child-process-of-a-threaded-ghc-haskell-program/59067681#59067681", "title": "Understanding the child process of a threaded GHC haskell program", "body": "<p>The <code>ghc_ticker</code> in <a href=\"https://github.com/ghc/ghc/blob/6aaa0655a721605740f23e49c5b4bf6165bfe865/rts/posix/itimer/Pthread.c#L167\" rel=\"nofollow noreferrer\">spawned</a> at startup, it runs <a href=\"https://github.com/ghc/ghc/blob/1c2c2d3dfd4c36884b22163872feb87122b4528d/rts/Timer.c#L42\" rel=\"nofollow noreferrer\">this function</a>. It's purpose is described as</p>\n\n<blockquote>\n  <p>The interval timer is used for profiling and for context switching in\n  the threaded build.</p>\n</blockquote>\n\n<p>The other <code>*:w</code> threads are workers, they are <a href=\"https://github.com/ghc/ghc/blob/64ef4d7fb131f04769c6cab331af335bd87103ec/rts/Task.c#L497\" rel=\"nofollow noreferrer\">created</a> whenever there is more work to do (aka <a href=\"https://github.com/ghc/ghc/blob/c2290596f10ce732be85503d3ef0f0b50b7e925a/rts/Task.h#L19\" rel=\"nofollow noreferrer\">Task</a>), but there are no more spare workers, see <a href=\"https://github.com/ghc/ghc/blob/7f72b540288bbdb32a6750dd64b9d366501ed10c/rts/Capability.c#L569\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>On startup ghc creates one worker per capability, then they are created as needed and reused when possible. It's hard to say why you have 14 workers in <code>-N4</code> case. I can only guess that they are serving IO manager threads: see <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Event.Thread.html#ensureIOManagerIsRunning\" rel=\"nofollow noreferrer\">here</a>. Let's not forget about FFI also - FFI call may block worker. You can try to put a breakpoint in <code>createOSThread</code> to see why workers are created.</p>\n\n<p>You can read more about scheduler <a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/commentary/rts/scheduler\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>ADDED:\nHmm, I think I can explain the <code>N*2+1</code> workers: <code>N</code> workers per capability are created at startup; <code>N</code> more - IO manager event loops, one per capability; plus one IO manager timer thread. Though I'm not sure why the first <code>N</code> workers (created at startup) where not reused for IO manager threads.</p>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 59067681, "answer_count": 1, "score": 7, "last_activity_date": 1574849835, "creation_date": 1574794728, "question_id": 59057716, "link": "https://stackoverflow.com/questions/59057716/understanding-the-child-process-of-a-threaded-ghc-haskell-program", "title": "Understanding the child process of a threaded GHC haskell program", "body": "<p>I'm trying to understand how the parent and various child OS threads work in a haskell program compiled with GHC <code>-threaded</code>. </p>\n\n<p>Using</p>\n\n<pre><code>module Main where\nimport Control.Concurrent\nmain = do\n    threadDelay 9999999999\n</code></pre>\n\n<p>Compiling with <code>-threaded</code> on ghc 8.6.5, and running with <code>+RTS -N3</code> for instance,  I can see</p>\n\n<pre><code>$ pstree -p 6615 \nhello(6615)\u2500\u252c\u2500{ghc_ticker}(6618)\n            \u251c\u2500{hello:w}(6616)\n            \u251c\u2500{hello:w}(6617)\n            \u251c\u2500{hello:w}(6619)\n            \u251c\u2500{hello:w}(6620)\n            \u251c\u2500{hello:w}(6621)\n            \u251c\u2500{hello:w}(6622)\n            \u2514\u2500{hello:w}(6623)\n</code></pre>\n\n<p>It looks like I get <code>N*2 + 1</code> of these \"hello:w\" threads as I vary <code>+RTS -N</code>.</p>\n\n<p><strong>What are these \"hello:w\" threads, and why are there apparently two per HEC + 1?</strong></p>\n\n<p><strong>And what does <code>ghc_ticker</code> do?</strong></p>\n\n<p>I also noticed on a large real service I'm testing with <code>+RTS -N4</code> I'm getting e.g. 14 of these \"my-service:w\" threads, and when under load these process IDs seem to churn (half of them stay alive until I kill the service).</p>\n\n<p><strong>Why 14, and why are half of them spawned and die?</strong></p>\n\n<p>I'd also accept an answer that helped guide me to instrumenting my code to figure out these latter two questions.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1574796786, "post_id": 59057620, "comment_id": 104355697, "body": "Possibly related: We see <code>not . f</code> way more often in ordinary code than we see <code>f . not</code>, which may bias expectations when trying to quickly derive the type for <code>(. not)</code>. I certainly got it wrong at first glance."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1574794280, "creation_date": 1574794280, "answer_id": 59057620, "question_id": 59057340, "link": "https://stackoverflow.com/questions/59057340/the-most-general-type-of-the-following-function-in-haskell/59057620#59057620", "title": "The most general type of the following function in Haskell", "body": "<pre><code>g = (. not)\n</code></pre>\n\n<p>is equivalent, by definition of the section, to</p>\n\n<pre><code>g = \\f -&gt; f . not\n</code></pre>\n\n<p>or to</p>\n\n<pre><code>g f = f . not\n</code></pre>\n\n<p>Since <code>f</code> takes as input the output of <code>not</code>, it must accept a boolean as input, hence it must have type <code>Bool -&gt; something</code>.</p>\n\n<p>From this, I think you can figure out the rest.</p>\n\n<p>Note that <code>(. not)</code> is very different from <code>(.) not</code> which would be written as a section as <code>(not .)</code> (or, as a lambda, as <code>\\f -&gt; not . f</code>). I think your confusion originates from this.</p>\n"}], "owner": {"reputation": 61, "user_id": 12112804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6iIP.jpg?s=128&g=1", "display_name": "dasogom", "link": "https://stackoverflow.com/users/12112804/dasogom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59057620, "answer_count": 1, "score": 3, "last_activity_date": 1574794280, "creation_date": 1574793034, "last_edit_date": 1574794149, "question_id": 59057340, "link": "https://stackoverflow.com/questions/59057340/the-most-general-type-of-the-following-function-in-haskell", "title": "The most general type of the following function in Haskell", "body": "<p>There is <code>g = (. not)</code>. </p>\n\n<p>And the most general type of the function <code>g</code> is </p>\n\n<pre><code>g :: (Bool -&gt; a) -&gt; Bool -&gt; a\n</code></pre>\n\n<p>But I cannot get how to think the  composition <code>(.)</code> function.</p>\n\n<p>Why is it not  <code>h :: (a -&gt; Bool) -&gt; a -&gt; Bool</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 2966, "user_id": 3014199, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/72332b0ac6ee78bc829c378c6c747e0e?s=128&d=identicon&r=PG", "display_name": "peer", "link": "https://stackoverflow.com/users/3014199/peer"}, "is_accepted": false, "score": 2, "last_activity_date": 1574785590, "creation_date": 1574785590, "answer_id": 59055348, "question_id": 59055270, "link": "https://stackoverflow.com/questions/59055270/variable-not-in-scope-x-picture-haskell/59055348#59055348", "title": "Variable not in scope: x :: Picture (Haskell)", "body": "<p>You don't give a line number, I think it happens here:</p>\n\n<pre><code>estadoInicial = (Estado [] [],0,(option,(600,400)))\n</code></pre>\n\n<p>You declare <code>option</code> in the main block, but then you never pass it to <code>estadoInicial</code>. If you want to use it there you need to pass it as a parameter as you do in your declaration for <code>desenhaEstado</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1574785749, "creation_date": 1574785749, "answer_id": 59055402, "question_id": 59055270, "link": "https://stackoverflow.com/questions/59055270/variable-not-in-scope-x-picture-haskell/59055402#59055402", "title": "Variable not in scope: x :: Picture (Haskell)", "body": "<p>Just because you wrote <code>option &lt;- loadBMP \"option.bmp\"</code> in your main action doesn't mean it's automatically in scope everywhere in your program. It <em>can't</em> be, because the value can only exist after you've performed the IO of reading it from the file, so particularly not in pure functions / values like <code>estadoInicial</code>!</p>\n\n<p>What you need to do is, pass it on explicitly as a parameter.</p>\n\n<pre><code>estadoInicial :: Picture -&gt; EstadoGloss\nestadoInicial option = (Estado [] [],0,(option,(600,400)))\n\n...\n\nmain :: IO ()\nmain = do\n      menu &lt;- loadBMP \"menu.bmp\"\n      option &lt;- loadBMP \"option.bmp\"\n      bike &lt;- loadBMP \"bike.bmp\"\n\n      play janela         \n           aquamarine      \n           fps            \n           (estadoInicial option)\n           desenhaEstado   \n           reageEvento    \n           reageTempo\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12439302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e620fdac07279b820987389a11dbdf5?s=128&d=identicon&r=PG&f=1", "display_name": "Karlofsky", "link": "https://stackoverflow.com/users/12439302/karlofsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 59055402, "answer_count": 2, "score": -1, "last_activity_date": 1574786112, "creation_date": 1574785334, "last_edit_date": 1574786112, "question_id": 59055270, "link": "https://stackoverflow.com/questions/59055270/variable-not-in-scope-x-picture-haskell", "title": "Variable not in scope: x :: Picture (Haskell)", "body": "<p>So i'm in the beginning of creating a menu for a game for haskell.</p>\n\n<p>Problem is it does not recognize my BMP files as it gives me this error:</p>\n\n<p><strong>Variable not in scope: option :: Picture</strong></p>\n\n<pre><code>module Main where\n\nimport Graphics.Gloss\nimport Graphics.Gloss.Juicy\nimport Graphics.Gloss.Interface.Pure.Game\n\nEstado = Estado {mapaEstado:: Mapa,jogadoresEstado :: [Jogador]}\ntype EstadoGloss = (Estado,Int,(Picture,(Float,Float)))\n\njanela :: Display\njanela = InWindow \"Motorbike Race\" (1200,700) (0,0)\n\nfps :: Int\nfps = 60\n\nestadoInicial :: EstadoGloss\nestadoInicial = (Estado [] [],0,(option,(600,400)))\n\ndesenhaEstado :: EstadoGloss -&gt; Picture\ndesenhaEstado (Estado [] [],0,(option,(x,y))) = Translate 600 y option\ndesenhaEstado (Estado [] [],0,(menu,(x,y))) = Translate 0 0 menu\n\nreageEvento :: Event -&gt; EstadoGloss -&gt; EstadoGloss\nreageEvento (EventKey (SpecialKey KeyUp)    Down _ _) (Estado [] [],0,(option,(x,y))) = (Estado [] [],0,(option,(600,y+50)))\nreageEvento (EventKey (SpecialKey KeyDown)  Down _ _) (Estado [] [],0,(option,(x,y))) = (Estado [] [],0,(option,(600,y-50))) \nreageEvento _ s = s \n\nreageTempo :: Float -&gt; EstadoGloss -&gt; EstadoGloss\nreageTempo tempo estg = estg\n\nmain :: IO ()\nmain = do\n          menu &lt;- loadBMP \"menu.bmp\"\n          option &lt;- loadBMP \"option.bmp\"\n          bike &lt;- loadBMP \"bike.bmp\"\n\n          play janela         \n               aquamarine      \n               fps            \n               estadoInicial   \n               desenhaEstado   \n               reageEvento    \n               reageTempo      \n</code></pre>\n"}, {"tags": ["haskell", "cross-platform", "travis-ci", "executable", "haskell-stack"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1574762189, "post_id": 59047782, "comment_id": 104337040, "body": "I don&#39;t know about this too much, but there are some question regarding this. Give it a look. It might help <a href=\"https://stackoverflow.com/questions/12719207/why-are-haskell-ghc-executables-so-large-in-filesize\" title=\"why are haskell ghc executables so large in filesize\">stackoverflow.com/questions/12719207/&hellip;</a>"}, {"owner": {"reputation": 3695, "user_id": 6213048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fcf68f42b160a352e7fa157dba36392?s=128&d=identicon&r=PG", "display_name": "soywod", "link": "https://stackoverflow.com/users/6213048/soywod"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1574774869, "post_id": 59047782, "comment_id": 104343999, "body": "Thanks for the link, I will check, but it seems to solve more the question &quot;why is it so big&quot;. My point is more about &quot;why size so different between OS&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1574906447, "creation_date": 1574906447, "answer_id": 59080759, "question_id": 59047782, "link": "https://stackoverflow.com/questions/59047782/haskell-tool-stack-and-executable-size/59080759#59080759", "title": "Haskell Tool Stack and executable size", "body": "<p>The difference between the Linux and MacOS builds is probably due to something called \"<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html?highlight=split%20sections#ghc-flag--split-sections\" rel=\"nofollow noreferrer\">split sections</a>\".</p>\n\n<p>Enabling the <code>-split-sections</code> GHC flag on Linux puts each compiled function into its own linker section (instead of the historical approach of placing all functions into a single \".text\" section).  This allows the linker to drop code that isn't used with a granularity that isn't really possible otherwise.</p>\n\n<p>Unfortunately, <strong>all</strong> dependencies need to be built with this flag in order to benefit.  You can force Stack to rebuild everything properly by adding the following lines to your project's <code>stack.yaml</code> file:</p>\n\n<pre><code>ghc-options:\n    \"$everything\": -split-sections\n</code></pre>\n\n<p>This method of specifying GHC options for dependencies is documented <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#ghc-options\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>If you rebuild your <code>unfog</code> with this change, it'll actually rebuild \"base\" and \"vector\" and everything else from scratch, so it might take a while.  But, the resulting binary makes it worth it.  Unstripped, its size drops from about 11Meg to 4Meg, and if you strip it, it's only:</p>\n\n<pre><code>-rwxr-xr-x 1 buhr buhr 1494696 Nov 27 19:40 unfog\n</code></pre>\n\n<p>which is even smaller than the MacOS version you posted.</p>\n\n<p>Now, as I understand it, the reason the original MacOS version is only 2Meg is that the MacOS linker already implements something similar to split sections.  I'm not sure if <em>also</em> enabling <code>-split-sections</code> for the MacOS build might give a additional gain, or if <code>-split-sections</code> is an automatic default under MacOS.  Anyway, it can't hurt to try it out.</p>\n\n<p>For Windows, the main reason it's so gigantic is that the MinGW GCC toolchain is used to compile Windows binaries, so there's an entire compatibility layer of GNU-ish libraries (libc, libm, libpthread, libgmp, etc.), and -- unlike with the Linux and MacOS builds -- they all get statically linked into the Windows binary.  The only dynamic linking for Windows is to standard Windows DLLs.</p>\n\n<p>Note that <code>-split-sections</code> might or might not work on Windows.  There are some comments on the bug tracker that make it unclear.  Anyway, it might be worth trying out to see if it makes a difference.</p>\n\n<p>Some additional references:</p>\n\n<ul>\n<li>A GHC bug tracker for <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/11445\" rel=\"nofollow noreferrer\">turning on <code>-split-sections</code> by default</a></li>\n<li>A feature request to <a href=\"https://github.com/commercialhaskell/stack/issues/3467\" rel=\"nofollow noreferrer\">support <code>-split-sections</code> in Stack</a></li>\n</ul>\n"}], "owner": {"reputation": 3695, "user_id": 6213048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fcf68f42b160a352e7fa157dba36392?s=128&d=identicon&r=PG", "display_name": "soywod", "link": "https://stackoverflow.com/users/6213048/soywod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1574906447, "creation_date": 1574760848, "last_edit_date": 1574856364, "question_id": 59047782, "link": "https://stackoverflow.com/questions/59047782/haskell-tool-stack-and-executable-size", "title": "Haskell Tool Stack and executable size", "body": "<p>I created a Haskell CLI with the <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">Stack tool</a>. I've just successfully set up cross-compilation thanks to Travis, but I don't understand why the executable size is so different between linux (6MB), osx (2MB) and windows (18MB!). How come?</p>\n\n<p>Release: <a href=\"https://github.com/unfog-io/unfog-cli/releases/tag/v0.1.2\" rel=\"nofollow noreferrer\">https://github.com/unfog-io/unfog-cli/releases/tag/v0.1.2</a></p>\n\n<p>Travis conf: <a href=\"https://github.com/unfog-io/unfog-cli/blob/master/.travis.yml\" rel=\"nofollow noreferrer\">https://github.com/unfog-io/unfog-cli/blob/master/.travis.yml</a></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>When I compress executables with tar.gz, I reduce the difference, but still! I have now linux (1.35MB), osx (0.61MB), windows (3.93MB) (see <a href=\"https://github.com/unfog-io/unfog-cli/releases/tag/v0.1.4\" rel=\"nofollow noreferrer\">release</a>)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1574756651, "post_id": 59046487, "comment_id": 104334148, "body": "Could you define a little bit better the behaviour you want? It seems you are looking for filter or similar"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12435966"}, "edited": false, "score": 0, "creation_date": 1574756770, "post_id": 59046487, "comment_id": 104334215, "body": "@Ismor I just want to be able to filter with a given f and split each list value at f being true - so separate odd [1,2,2,3,3] = [[2,2]]. Does that hep?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12435966"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1574756830, "post_id": 59046487, "comment_id": 104334240, "body": "@SimonShine my apologies. Are you able to identify what I need to modify to fix this so I can accept an answer on here?"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1574757724, "post_id": 59046487, "comment_id": 104334638, "body": "@KiraLe: You say that something needs to be fixed, but it&#39;s a little unclear what that is. It seems to me that this is a homework question and that you&#39;re stuck. Normally you either go back and try and solve a simpler exercise first, or try and split this problem into simpler sub-problems that can be solved more easily one at a time."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1574759535, "post_id": 59046487, "comment_id": 104335589, "body": "@KiraLe It is <i>not</i> clear at all what you mean. Up to your comment <code>separate odd [1,2,2,3,3] = [[2,2]]</code> meaning that odd numbers should be considered tokens and what remains are the parts of the list that are not tokens. Whereas in the question <code>separate even [1,2,3,4] = [[2],[4]]</code> behaves exactly the opposite. ???"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 2, "creation_date": 1574761193, "post_id": 59046487, "comment_id": 104336434, "body": "@SimonShine that duplicate was deleted by the asker. I voted to undelete, and flagged asking for undeletion as well. (both Qs have nothing to do with nested loops, incidentally)."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574761480, "post_id": 59046487, "comment_id": 104336604, "body": "I would advise you to consider folding."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1574762522, "post_id": 59046487, "comment_id": 104337245, "body": "@SimonShine maybe <a href=\"https://stackoverflow.com/questions/59044765/nested-loop-formatting\">it&#39;ll</a> get undeleted yet."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1574774898, "post_id": 59046487, "comment_id": 104344016, "body": "@SimonShine that post&#39;s author has again deleted it (complete with their &quot;thank you&quot; to you in the comments). I invite you to flag it so it gets more attention and they are explained by a mod that this is unacceptable behavior."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1574775411, "post_id": 59046487, "comment_id": 104344308, "body": "@WillNess: I suspect this is because the author uses their full name to ask for help on a homework assignment."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574782197, "post_id": 59046487, "comment_id": 104348308, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/59044765/nested-loop-formatting\">Nested Loop Formatting</a>"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574782258, "post_id": 59046487, "comment_id": 104348343, "body": "@WillNess It&#39;s re-undeleted now, and I also upvoted the answer, so he can&#39;t unilaterally delete it again."}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 2, "last_activity_date": 1574757355, "creation_date": 1574757355, "answer_id": 59046754, "question_id": 59046487, "link": "https://stackoverflow.com/questions/59046487/haskell-nested-loops/59046754#59046754", "title": "Haskell Nested Loops", "body": "<p>You could divide your problem into the following sub-problems:</p>\n\n<ol>\n<li><p>Split a list in two where the first sequence is equivalent when applying <code>f</code> to each element:</p>\n\n<pre><code>splitOn :: Eq b =&gt; (a -&gt; b) -&gt; [a] -&gt; ([a], [a])\nsplitOn f [] = ...\nsplitOn f (x:xs) = ...\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>&gt; splitOn odd [1,3,3,4,5]\n([1,3,3], [4,5])\n</code></pre></li>\n<li><p>Group each element in the list by what <code>f</code> returns:</p>\n\n<pre><code>groupOn :: Eq b =&gt; (a -&gt; b) -&gt; [a] -&gt; [[a]]\ngroupOn f [] = ...\ngroupOn f xs = ...\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>&gt; groupOn odd [1,3,3,4,5,6,8]\n[[1,3,3],[4],[5],[6,8]]\n</code></pre>\n\n<p>You can do this by applying <code>splitOn</code> recursively. Think <em>case-of</em>.</p></li>\n<li><p>Filter out sub-lists in which the first element satisfies <code>f</code>:</p>\n\n<pre><code>separate :: (a -&gt; Bool) -&gt; [a] -&gt; [[a]]\nseparate f xs = filter (\\ys -&gt; ...) (groupOn f xs)\n</code></pre>\n\n<p>where <code>ys</code> would be <code>[1,3,3]</code>, <code>[4]</code>, <code>[5]</code> and <code>[6,8]</code> in the above example.</p></li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12435966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574757355, "creation_date": 1574756355, "last_edit_date": 1574756496, "question_id": 59046487, "link": "https://stackoverflow.com/questions/59046487/haskell-nested-loops", "title": "Haskell Nested Loops", "body": "<p>I am trying to split a list whenever <code>f</code> returns true, for example:</p>\n\n<pre><code>separate even [1,2,3,4] = [[2],[4]]\n</code></pre>\n\n<p>Current code:</p>\n\n<pre><code>separate f (x:xs) currentstr finalstr\n  | f x = (finalstr ++ currentstr) : separate  f xs [] finalstr\n  | otherwise = (currentstr ++ x) : separate  f xs (currentstr + x) finalstr\nseparate  f [] currentstr finalstr = []\n</code></pre>\n\n<p>Can anyone provide some insight on how to fix this? Values for <code>currentstr</code> and <code>finalstr</code> will be provided as <code>[]</code> in another function always, so this is not a concern.</p>\n"}, {"tags": ["haskell", "functor", "haskell-streaming"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1574750807, "post_id": 59044882, "comment_id": 104331777, "body": "When you say &quot;stream of streams&quot;, do you mean something like <code>Stream (Of (Stream (Of a) IO ()) IO ()</code> ?"}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1574752961, "post_id": 59044882, "comment_id": 104332596, "body": "Yes, precisely that."}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1574755718, "post_id": 59046305, "comment_id": 104333722, "body": "Also, note that the <code>separate</code> <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:separate\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/streaming-0.2.3.0/docs/&hellip;</a> and <code>unseparate</code> functions from <code>Streaming.Prelude</code> use the <code>Sum</code> functor."}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 0, "creation_date": 1574757960, "post_id": 59046305, "comment_id": 104334773, "body": "What I don&#39;t get is why I can&#39;t repeat that argument with <code>Of a</code> replaced by just <code>a</code>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 0, "creation_date": 1574758430, "post_id": 59046305, "comment_id": 104335010, "body": "@mcmayer In the simple non-grouped case, there&#39;s no problem in going directly to the rest of the stream, because yielded values already have been &quot;materialized&quot; so to speak. There&#39;s nothing left to read in order to advance. But with groups, we actually perform effects when going through the group. The inner stream lives in <code>IO</code> after all! We can&#39;t simply jump to the next group directly. Streaming libraries that fully materialize groups before sending them downstream don&#39;t have this distinction."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 0, "creation_date": 1574774731, "post_id": 59046305, "comment_id": 104343928, "body": "@mcmayer &quot;repeat that argument with Of a replaced by just a&quot;. If you remove <code>Of</code> and bake the yielded element into the <code>Step</code> constructor, then you need to define different <code>Stream</code> types for the grouped and ungrouped case, and no functions can be reused between the two. There are packages like &quot;streaming-bytestring&quot; <a href=\"http://hackage.haskell.org/package/streaming-bytestring\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/streaming-bytestring</a> that actually do this for performance reasons, as it reduces indirections."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1574770751, "last_edit_date": 1574770751, "creation_date": 1574755584, "answer_id": 59046305, "question_id": 59044882, "link": "https://stackoverflow.com/questions/59044882/intuition-behind-the-functor-in-stream-f-m-r-of-the-streaming-library/59046305#59046305", "title": "Intuition behind the functor in Stream f m r of the streaming library", "body": "<p>A key feature of <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0\" rel=\"nofollow noreferrer\">streaming</a>'s <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:groupBy\" rel=\"nofollow noreferrer\">grouping functions</a> is that they don't force you to keep entire groups in memory at any point. They perform grouping in an \"streaming\" fashion. The moment the start of a new group is detected, you can begin processing the group \"downstream\".</p>\n\n<p>For example, imagine a function like <code>lines :: Stream (Of Text) IO r -&gt; Stream (Stream (Of Text) IO) IO r</code>. That function will start a new group whenever it detects a newline in the stream, <em>even if the end of the new line hasn't materialized yet</em>.</p>\n\n<p>The type <code>Stream (Stream (Of</code>Text<code>) IO) IO r</code> has the advantage that, to reach the line that comes after the current one, we must consume the current line completely. This is because the \"rest of the stream\" lies in the result value of the functor parameter. And <code>Stream</code>s only give up their results once they have been exhausted.</p>\n\n<p>A type like <code>Stream (Of (Stream (Of a) IO ()) IO ()</code> would not force us to exhaust the current line before moving to the next one. We could simply ignore the inner <code>Stream</code> that was yielded advance the outer <code>Stream</code>. But that \"next line\" might not even exist yet, as we haven't actually read what came before! Perhaps this scheme could be made to work somehow, but the semantics would be less clear and require more knowledge from the user.</p>\n\n<hr>\n\n<p>Functions like <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:mapped\" rel=\"nofollow noreferrer\"><code>mapped</code></a> let us consume \"downstream\" groups which are defined \"upstream\". For example, this code reads strings form <em>stdin</em>, where the string \"-\" is a group separator. The downstream code parses the strings into <code>Int</code>s and shows a message whenever a <code>5</code> is encountered. Notice that messages are shown <em>before</em> the group is closed upstream.</p>\n\n<pre><code>    import Streaming\n    import qualified Streaming.Prelude as S\n\n    example :: Stream (Of ()) IO () \n    example = \n        let upstream :: Stream (Stream (Of String) IO) IO ()\n            upstream = S.breaks (==\"-\") S.stdinLn\n            downstream :: Stream (Stream (Of String) IO) IO () \n                       -&gt; Stream (Of ()) IO ()\n            downstream = S.mapped handleGroup\n            handleGroup :: Stream (Of String) IO r -&gt;\n                           IO (Of () r)\n            handleGroup stream = do\n                print \"group began\" \n                r &lt;- S.effects\n                   . S.chain (\\_ -&gt; putStrLn \"found!\") \n                   . S.filter (==5) \n                   . S.map (read @Int) \n                   $ stream \n                print \"group ended\"\n                return (() :&gt; r)\n         in downstream upstream\n\n    main :: IO ()\n    main = S.effects example\n</code></pre>\n"}], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1574770751, "creation_date": 1574749331, "question_id": 59044882, "link": "https://stackoverflow.com/questions/59044882/intuition-behind-the-functor-in-stream-f-m-r-of-the-streaming-library", "title": "Intuition behind the functor in Stream f m r of the streaming library", "body": "<p>A simplified (non-effectful) definition of <code>Stream</code> from the <a href=\"https://hackage.haskell.org/package/streaming\" rel=\"nofollow noreferrer\">streaming</a> library reads like this:</p>\n\n<pre><code>data Stream f = Step (f (Stream f))\n              | Return\n</code></pre>\n\n<p>I'm trying to understand what the motivation for introducing this functor <code>f</code> is.</p>\n\n<p>A typical such <code>f</code> is <code>Of a</code>, with <code>Of</code> defined as</p>\n\n<pre><code>data Of a b = !a :&gt; b\n    deriving Functor\n</code></pre>\n\n<p>When I read <code>f</code> as <code>Of a</code> in the definition of <code>Stream</code> this sort of makes sense, <code>Of a b</code> is something like an <code>a</code> followed by more that is obtainable from <code>b</code>. With this interpretation, the <code>f (Stream f)</code> in the definition of <code>Stream</code> reads something like <code>Of a (Stream (Of a))</code>. But in this case a simpler version would have been</p>\n\n<pre><code>data Stream a = Step a (Stream a)\n              | Return\n</code></pre>\n\n<p>I struggle to understand why the generalization with this functor <code>f</code> is used. In the introduction the author says that <code>Stream</code></p>\n\n<blockquote>\n  <p>... can be used to stream successive distinct steps characterized by any functor <code>f</code></p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>the general type <code>Stream f m r</code> expresses a succession of steps ... with a shape determined by the 'functor' parameter <code>f</code>.</p>\n</blockquote>\n\n<p>But in <a href=\"https://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html\" rel=\"nofollow noreferrer\">Streaming.Prelude</a> the only functors I can find are <code>Or a</code>, <code>Stream (Of a) m</code> and <code>Identity</code>. The first one  makes a stream of <code>a</code>s, the second a stream of streams, the third achieves <a href=\"https://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:erase\" rel=\"nofollow noreferrer\">'erasure'</a>.</p>\n\n<p>I really don't get it. I can achieve all of these things, i.e. simple stream of <code>a</code>s, stream of streams, and erasure, without using this <code>f</code> in <code>Stream</code>.</p>\n\n<p>What does this functor <code>f</code> do that can't be done otherwise?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574749039, "post_id": 59044765, "comment_id": 104331192, "body": "In the first case, you call <code>separate</code> and add an element to the resulting list and put that in a list again. So if <code>separate</code> was something like <code>[[2]]</code> the result would be something like <code>[[[3],[2]]]</code> or so and that is not, what you wanted. Also <code>sublist</code> never grows, separate is always called with the same <code>sublist</code> from the first call."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906462"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574750116, "post_id": 59044765, "comment_id": 104331544, "body": "@typetetris I&#39;m sort of following you. I updated the code a bit, however not quite sure where to go from there/if that made any difference"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574750879, "post_id": 59044765, "comment_id": 104331800, "body": "I suggest, you try to evaluate <code>separate odd [1,2,3,4] [] []</code> with pencil and paper and see where it leads you."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6906462"}, "edited": false, "score": 0, "creation_date": 1574752260, "post_id": 59045421, "comment_id": 104332311, "body": "thank you, this is very helpful. How are you getting sublists from groupOn? I have: f x = x : groupOn f xs   | otherwise = groupOn f xs and this only returns a single list"}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 1, "last_activity_date": 1574751789, "creation_date": 1574751789, "answer_id": 59045421, "question_id": 59044765, "link": "https://stackoverflow.com/questions/59044765/nested-loop-formatting/59045421#59045421", "title": "Nested Loop Formatting", "body": "<p>You could divide your problem into the following sub-problems:</p>\n\n<ol>\n<li><p>Group each element in the list by what <code>f</code> returns:</p>\n\n<pre><code>groupOn :: Eq b =&gt; (a -&gt; b) -&gt; [a] -&gt; [[a]]\ngroupOn f = ...\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>&gt; groupOn odd [1,3,3,4,5,6,8]\n[[1,3,3],[4],[5],[6,8]]\n</code></pre></li>\n<li><p>Filter out sub-lists in which the first element satisfies <code>f</code>:</p>\n\n<pre><code>separate :: (a -&gt; Bool) -&gt; [a] -&gt; [[a]]\nseparate f xs = filter (\\ys -&gt; ...) (groupOn f xs)\n</code></pre>\n\n<p>where <code>ys</code> would be <code>[1,3,3]</code>, <code>[4]</code>, <code>[5]</code> and <code>[6,8]</code> in the above example.</p></li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6906462"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574751789, "creation_date": 1574748653, "last_edit_date": 1574750080, "question_id": 59044765, "link": "https://stackoverflow.com/questions/59044765/nested-loop-formatting", "title": "Nested Loop Formatting", "body": "<p>I am trying to produce an output where the input list is split each time f x is true. I use two variables to keep track of the substring and the final list, and this function will be called by another that provides empty lists for two tracking variables. Example desired output:</p>\n\n<pre><code>separate odd [1,2,3,4] = [[2],[4]]\n</code></pre>\n\n<p>Below is what I have so far - although I keep running into type errors because lists all have to be of the same type - can anyone advise what changes need to be made to produce the desired output?</p>\n\n<pre><code>separate f (x:xs) sublist finalstr\n  | f x = (finalstr ++ sublist) : separate f xs sublist finalstr\n  | otherwise = (sublist ++ x) : separate f xs sublist finalstr\nseparate f [] sublist finalstr = []\n\n</code></pre>\n"}, {"tags": ["haskell", "types", "composition"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 2, "creation_date": 1574746986, "post_id": 59044451, "comment_id": 104330556, "body": "The type constraint <code>Num (t1 a)</code> should give you a hint."}], "answers": [{"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 6, "last_activity_date": 1574747928, "creation_date": 1574747928, "answer_id": 59044632, "question_id": 59044451, "link": "https://stackoverflow.com/questions/59044451/what-does-the-composition-length-of-sum-mean/59044632#59044632", "title": "What does the composition &quot;length of sum&quot; mean?", "body": "<p>Here's a trivial example.</p>\n\n\n\n<pre><code>import Data.Functor.Identity\n\nxs :: [Identity Int]\nxs = map Identity [0..9]\n\nresult :: Int\nresult = length . sum $ xs\n\nmain :: IO ()\nmain = print result -- 1\n</code></pre>\n\n<p>Let's understand what's happening.</p>\n\n<ol>\n<li>First, we sum all elements of <code>xs</code>. Therefore, <code>sum xs</code> is <code>Identity 0 + ... + Identity 9</code> which evaluates to <code>Identity 45</code>. Note that <code>Num a =&gt; Identity a</code> is an instance of <code>Num</code>.</li>\n<li>Next, we find the length of <code>sum xs</code>. Therefore, <code>length . sum $ xs</code> is <code>length $ Identity 45</code> which evaluates to <code>1</code> because there is exactly one element in any <code>Identity</code> data structure.</li>\n</ol>\n\n<p>This makes sense if you look at the signature of <code>length . sum</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>length . sum :: (Foldable g, Foldable f, Num (f a)) =&gt; g (f a) -&gt; Int\n</code></pre>\n\n<p>First, we traverse <code>g</code> and find the <code>sum</code> of all the <code>f a</code> within <code>g</code>. The definition of <code>sum</code> depends upon the type <code>f a</code>. The result is an <code>f a</code>. Then, we find the <code>length</code> of the resulting <code>f a</code>.</p>\n"}], "owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 59044632, "answer_count": 1, "score": 2, "last_activity_date": 1574747928, "creation_date": 1574746896, "question_id": 59044451, "link": "https://stackoverflow.com/questions/59044451/what-does-the-composition-length-of-sum-mean", "title": "What does the composition &quot;length of sum&quot; mean?", "body": "<p>I was playing with types in Haskell and accidentally discovered <code>length . sum</code> is valid. Is there some semantic meaning that should allow this to work, or is this merely a wart of the type definitions? I've written each of the type definitions below.</p>\n\n<pre><code>length :: Foldable t =&gt; t a -&gt; Int\nsum :: (Foldable t, Num a) =&gt; t a -&gt; a\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nlength . sum :: (Foldable t1, Foldable t2, Num (t1 a)) =&gt; t2 (t1 a) -&gt; Int\n</code></pre>\n\n<p>The only scenario where I can make sense of it would be summing chars into a string, and then you'd be able to get the length of that string. However, sum is only able to take in a foldable type of numbers, so that couldn't work.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1574744468, "post_id": 59043187, "comment_id": 104329842, "body": "Good start. Can you improve the error message? Alternatively, can you think of something reasonable to return when the list is empty?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1574744494, "post_id": 59043187, "comment_id": 104329849, "body": "Did you mean to call the function <code>tail&#39;</code>? This only gets one tail."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 3, "creation_date": 1574745282, "post_id": 59043187, "comment_id": 104330087, "body": "@AwaisHussain: dfeuer is hinting that there is a built-in function called <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:tails\" rel=\"nofollow noreferrer\"><code>tails</code></a> that returns a list of lists, whereas your function should just be called <code>tail&#39;</code> since it resembles the built-in function called <code>tail</code>."}, {"owner": {"reputation": 192, "user_id": 4127946, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ced73549243855d19d942378e870f451?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Hussain", "link": "https://stackoverflow.com/users/4127946/awais-hussain"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574834910, "post_id": 59043187, "comment_id": 104366670, "body": "@dfeuer Updated error message. And I wanted only one tail so it just returns one tail only."}], "tags": [], "owner": {"reputation": 192, "user_id": 4127946, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ced73549243855d19d942378e870f451?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Hussain", "link": "https://stackoverflow.com/users/4127946/awais-hussain"}, "is_accepted": false, "score": 4, "last_activity_date": 1574834833, "last_edit_date": 1574834833, "creation_date": 1574737867, "answer_id": 59043187, "question_id": 59043120, "link": "https://stackoverflow.com/questions/59043120/how-to-get-only-first-member-of-tail-instead-of-all-lists/59043187#59043187", "title": "How to get only first member of tail instead of all lists?", "body": "<p>I just finished by doing this:</p>\n\n<pre><code>tails' :: [a] -&gt; [a]\ntails' [] = error \"List is empty\"\ntails' (x:xs) = xs \n</code></pre>\n"}], "owner": {"reputation": 192, "user_id": 4127946, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ced73549243855d19d942378e870f451?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Hussain", "link": "https://stackoverflow.com/users/4127946/awais-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574834833, "creation_date": 1574737449, "question_id": 59043120, "link": "https://stackoverflow.com/questions/59043120/how-to-get-only-first-member-of-tail-instead-of-all-lists", "title": "How to get only first member of tail instead of all lists?", "body": "<p>I am trying to implement tail function by myself. I took some help from online because I am totally new to Haskell so I found this:</p>\n\n<pre><code>tails' :: [a] -&gt; [[a]]\ntails' [] = []\ntails' (x:xs) = xs : tails' xs\n</code></pre>\n\n<p>For <code>tails' [1,2,3]</code>, this will return <code>[[2,3],[3],[]]</code>. I am trying to get only <code>[2,3]</code>.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1574775054, "last_edit_date": 1574775054, "creation_date": 1574757912, "answer_id": 59046885, "question_id": 59043093, "link": "https://stackoverflow.com/questions/59043093/i-do-not-understand-how-a-natural-valueparameter-works/59046885#59046885", "title": "I do not understand how a Natural value(parameter) works", "body": "<p>This is partial application at work.</p>\n\n<ul>\n<li><code>logistic</code> is a function that takes three arguments.</li>\n<li><code>logistic 3.741</code> is a function that takes two arguments, since the first one was provided.</li>\n<li><code>logistic 3.741 0.00079</code> is a function that takes one argument, since the first and second ones were provided.</li>\n</ul>\n\n<p>In other words, the definition</p>\n\n<pre><code>logistic0 = logistic 3.741 0.00079\n</code></pre>\n\n<p>is equivalent, by eta-equivalence, to</p>\n\n<pre><code>logistic0 x = logistic 3.741 0.00079 x\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10728388, "user_type": "registered", "profile_image": "https://graph.facebook.com/2102364663164338/picture?type=large", "display_name": "Andu M&#238;ndrescu", "link": "https://stackoverflow.com/users/10728388/andu-m%c3%aendrescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574788665, "creation_date": 1574737286, "last_edit_date": 1574788665, "question_id": 59043093, "link": "https://stackoverflow.com/questions/59043093/i-do-not-understand-how-a-natural-valueparameter-works", "title": "I do not understand how a Natural value(parameter) works", "body": "<p>I do not understand why \"logistic0\" function doesn't need an argument when implemented, and why a Natural value is not necessary to be passed as an argument at \"logistic\" function. Also, it's time to be calculated depends on the ex1 value, why ? </p>\n\n<pre><code>logistic :: Num a =&gt; a -&gt; a -&gt; Natural -&gt; a\nlogistic rate start = f\n  where\n    f 0 = start\n    f n = rate * f (n - 1) * (1 - f (n - 1)) \n\nlogistic0 :: Fractional a =&gt; Natural -&gt; a\nlogistic0 = logistic 3.741 0.00079\n\nex1 :: Natural\nex1 = 10000\n\nlogistic0 ex1\n```\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1574722518, "post_id": 59041246, "comment_id": 104324942, "body": "As the error message says, <code>b</code> in that expression is of type <code>Zinf</code>, while <code>i</code> is an <code>Integer</code>. You can&#39;t use the <code>(+)</code> function on two different types. (It only appeared to work with integer literals because, due to your <code>Num</code> instance for <code>Zinf</code>, the &quot;integer&quot; literals could be interpreted as <code>Zinf</code> values. But you can&#39;t convert an actual integer to a <code>Zinf</code>, or vice versa, without an explicit conversion function.)"}, {"owner": {"reputation": 576, "user_id": 7095230, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/587a776a5fb87ac8844b188fa4076f39?s=128&d=identicon&r=PG&f=1", "display_name": "SlowerPhoton", "link": "https://stackoverflow.com/users/7095230/slowerphoton"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574722710, "post_id": 59041246, "comment_id": 104324999, "body": "What do you suggest then, please? This confuses me a lot."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574722947, "post_id": 59041246, "comment_id": 104325063, "body": "Since it appears that you need a <code>Zinf</code> here, you can just make the <code>Integer</code> a <code>Zinf</code> by using the <code>Z</code> constructor: <code>Complicated (a + Z i) (b + Z i)</code> (apologies if I&#39;ve made a silly mistake, I&#39;ve not tried it to see if it compiles)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1574723334, "post_id": 59041246, "comment_id": 104325160, "body": "@RobinZigmond These sentences should probably live in an answer, not as comments!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574723555, "post_id": 59041246, "comment_id": 104325216, "body": "@DanielWagner true, and I did consider it, I&#39;m definitely guilty of too often writing in a comment what could be an answer. In my defence, often, as here, I&#39;m not totally certain what the OP is asking or what they are confused by, and I prefer not to write an answer unless I&#39;m sure it will shed light on the OP&#39;s actual question. (But on reflection it&#39;s a poor excuse in this case.)"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1574722971, "creation_date": 1574722971, "answer_id": 59041373, "question_id": 59041246, "link": "https://stackoverflow.com/questions/59041246/data-type-doesnt-work-inside-function-argument/59041373#59041373", "title": "Data type doesn&#39;t work inside function argument", "body": "<blockquote>\n  <p>Now, since Zinf is also Num, I can write down the following:<pre><code>(Z 3) + 4</code></pre></p>\n</blockquote>\n\n<p>Yes, but it's important that <code>(+)</code> has in this case <em>not</em> the type <code>Zinf -&gt; Integer -&gt; Zinf</code>, as it may seem. You may be thinking <code>4</code> has type integer there, but it doesn't: it actually has type <code>Zinf</code>. This is surprising since <code>3</code> <em>does</em> have type integer!</p>\n\n<p>What's going on: Haskell number literals are polymorphic.</p>\n\n<pre><code>Prelude&gt; :t 1\n1 :: Num p =&gt; p\n</code></pre>\n\n<p>So, a number literal can have type <code>Integer</code> or <code>Float</code> or indeed <code>Zinf</code>, depending on what the context demands. In <code>(Z 3) + 4</code> this is <code>Zinf</code> for <code>4</code>, so <code>4</code> has type <code>Zinf</code> there. Great!</p>\n\n<p>However, this does not work in <code>Simple (a+i)</code>, because there the type of <code>i</code> is fixed by the signature / context to be <code>Integer</code>. Therefore you can't add it to a <code>Zinf</code>.</p>\n\n<p>What you can do however: any <code>Integer</code> value can be \u201cupgraded\u201d into a polymorphic number (like number literals) by wrapping it<sup>\u2020</sup> in <code>fromInteger</code>. So, what you want there is</p>\n\n<pre><code>moveBy (...) i = (Node (Simple (a + fromInteger i)) (...) (...)\n</code></pre>\n\n<p>or equivalently <code>Simple (a + Z i)</code>.</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>Actually what's going on with number literals is that they also just wrap the \u201cplain\u201d integer literal in <code>fromInteger</code>, to make it polymorphic.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1574723127, "creation_date": 1574723127, "answer_id": 59041394, "question_id": 59041246, "link": "https://stackoverflow.com/questions/59041246/data-type-doesnt-work-inside-function-argument/59041394#59041394", "title": "Data type doesn&#39;t work inside function argument", "body": "<p>When you write</p>\n\n<pre><code>Z 3 + 4\n</code></pre>\n\n<p>it does not mean</p>\n\n<pre><code>Z 3 + (4 :: Integer)\n</code></pre>\n\n<p>but</p>\n\n<pre><code>Z 3 + (4 :: Zinf)\n</code></pre>\n\n<p>and uses <code>fromInteger :: Integer -&gt; Zinf</code> (implemented by you in your <code>Num</code> instance) to interpret the <code>4</code> as a <code>Zinf</code>. Indeed, addition must always be between two values of the same type -- say, two <code>Zinf</code>s, or two <code>Integer</code>s -- never between a <code>Zinf</code> and an <code>Integer</code>.</p>\n\n<p>You may modify your <code>moveBy</code> to take a <code>Zinf</code> argument, so that addition is fine:</p>\n\n<pre><code>moveBy :: ITree -&gt; Zinf -&gt; ITree\n-- implementation as in the question\n</code></pre>\n\n<p>Or you may convert the <code>Integer</code> given to <code>moveBy</code> to a <code>Zinf</code> in the same way as is being implicitly done when you write <code>Z 3 + 4</code>:</p>\n\n<pre><code>moveBy :: -- as in the question\nmoveBy (Node (Simple a) l r) i = Node (Simple (a+fromInteger i)) (moveBy l i) (moveBy r i)\n-- and similarly for the Complicated case\n</code></pre>\n"}], "owner": {"reputation": 576, "user_id": 7095230, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/587a776a5fb87ac8844b188fa4076f39?s=128&d=identicon&r=PG&f=1", "display_name": "SlowerPhoton", "link": "https://stackoverflow.com/users/7095230/slowerphoton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59041373, "answer_count": 2, "score": 2, "last_activity_date": 1574723127, "creation_date": 1574722203, "question_id": 59041246, "link": "https://stackoverflow.com/questions/59041246/data-type-doesnt-work-inside-function-argument", "title": "Data type doesn&#39;t work inside function argument", "body": "<p>Suppose I have this data type:</p>\n\n<pre><code>data Zinf = NegInf | Z Integer | PosInf deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>It is also <code>Num</code>, since all necessary operations are defined. When I type for example <code>PosInf + 1</code>, the interpret returns <code>PosInf</code>.</p>\n\n<p>Now I derive yet another data type:</p>\n\n<pre><code>data Interval = Simple Integer | Complicated Zinf Zinf deriving (Eq, Show)\n</code></pre>\n\n<p>Now, since Zinf is also <code>Num</code>, I can write down the following:</p>\n\n<pre><code>(Z 3) + 4\n</code></pre>\n\n<p>and I get </p>\n\n<pre><code>(Z 7)\n</code></pre>\n\n<p>I can also test </p>\n\n<pre><code>(Z 3) + 6 == 9\n</code></pre>\n\n<p>and the interpret returns <code>True</code>.</p>\n\n<p>I can also write <code>Complicated 3 (6*7)</code> to get <code>Complicated (Z 3) (Z 42)</code>.</p>\n\n<p>Finally, I create a tree with these \"Interval\" data types:</p>\n\n<pre><code>data BinTree a = Empty | Node a (BinTree a) (BinTree a) deriving (Eq, Show)\ntype ITree = BinTree Interval\n</code></pre>\n\n<p>Now, when I try to write this function:</p>\n\n<pre><code>moveBy :: ITree -&gt; Integer -&gt; ITree\nmoveBy Empty _ = Empty\nmoveBy (Node (Simple a) l r) i = (Node (Simple (a+i)) (moveBy l i) (moveBy r i))\nmoveBy (Node (Complicated a b) l r) i = (Node ( Complicated (a + i) (b + i) ) (moveBy l i) (moveBy r i)) \n</code></pre>\n\n<p>it produces the following error:</p>\n\n<pre><code>* Couldn't match expected type `Zinf' with actual type `Integer'                                                         \n* In the second argument of `(+)', namely `i'                                                                             \nIn the second argument of `Complicated', namely `(b + i)'                                                                     \nIn the first argument of `Node', namely `(Complicated (a + i) (b + i))'\n</code></pre>\n\n<p>How come? <code>b</code> should be of type <code>Zinf</code>, <code>b+i</code> again of type <code>Zinf</code>, since <code>i</code> is <code>Integer</code>. And <code>Complicated</code> expects exactly this kind of argument.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1574721955, "post_id": 59041189, "comment_id": 104324785, "body": "You want this to return a tuple of two lists? Note how you aren&#39;t adding to any list in the first case in the guard."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574722078, "post_id": 59041189, "comment_id": 104324821, "body": "Are you asking for an explanation of the observed output? <code>odd 1</code> is <code>True</code> so your function will output <code>filter odd [2,3,4]</code>, which is <code>[3]</code>"}, {"owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1574722139, "post_id": 59041189, "comment_id": 104324837, "body": "@carcigenicate Ideally, I would like to return a list within a list, a new sublist each time f x is true. I thought that excluding the addition to the list in the first guard would allow me to remove anything where f x is true, which is what was desired"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1574722211, "post_id": 59041189, "comment_id": 104324858, "body": "@kirency You might want to take a step back and try a simpler function first to get a good grasp of recursion and list iteration. Try writing your own versions of <code>map</code> and <code>filter</code> and <code>foldl</code>."}, {"owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574722232, "post_id": 59041189, "comment_id": 104324862, "body": "@Robin Zigmond that makes sense. How then can I continue to filter the rest of the list at each case of f x being true if I do not add anything to my list because I want to ignore anything where f z is true? Thanks!"}, {"owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1574722268, "post_id": 59041189, "comment_id": 104324874, "body": "@carcigenicate will do, thanks!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1574722325, "post_id": 59041189, "comment_id": 104324890, "body": "I&#39;m afraid I don&#39;t really understand what you&#39;re trying to do. What do you want the output of <code>separate odd [1,2,3,4]</code> to be? Note that, as @Carcigenicate, if you want to return 2 lists the return type needs to be a tuple."}, {"owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574722423, "post_id": 59041189, "comment_id": 104324916, "body": "@robin zigmond I would want to return [[2],[4]]]. Thanks for your patience! I didn&#39;t know it needed to be in tuple form, that may be why!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574722608, "post_id": 59041189, "comment_id": 104324966, "body": "Oh hang on, I think I misread your OP. Do you want to return just a single list, of the elements that <i>don&#39;t</i> satisfy <code>f</code>? (That would be <code>[2,4]</code> here, not a nested list.) In that case you just want <code>separate f = filter (not . f)</code>"}, {"owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574723040, "post_id": 59041189, "comment_id": 104325090, "body": "@RobinZigmond that was my OP, yes. I was actually trying to do so with a nested list eventually, however. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "edited": false, "score": 0, "creation_date": 1574723594, "post_id": 59041448, "comment_id": 104325223, "body": "Thank you so much - exactly what I was looking for!"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "edited": false, "score": 0, "creation_date": 1574737546, "post_id": 59041448, "comment_id": 104328248, "body": "@kirency if the answer worked for you, you have to accept it."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1574723487, "creation_date": 1574723487, "answer_id": 59041448, "question_id": 59041189, "link": "https://stackoverflow.com/questions/59041189/understanding-simple-haskell/59041448#59041448", "title": "Understanding simple Haskell", "body": "<p>In your two cases, you call <code>filter</code>; you almost certainly intended to (recursively) call <code>separate</code> instead.</p>\n\n<pre><code>separate f (x:xs)\n  | f x = separate f xs\n  | otherwise = x : separate f xs\n</code></pre>\n\n<p>This will get you to the next bug.</p>\n"}], "owner": {"reputation": 3, "user_id": 12110043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fdb61be2508be8ad3dd9161b9d779f?s=128&d=identicon&r=PG&f=1", "display_name": "kirency", "link": "https://stackoverflow.com/users/12110043/kirency"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59041448, "answer_count": 1, "score": -2, "last_activity_date": 1574730374, "creation_date": 1574721848, "question_id": 59041189, "link": "https://stackoverflow.com/questions/59041189/understanding-simple-haskell", "title": "Understanding simple Haskell", "body": "<p>I am trying to write a program where I can input a function, odd and even for example, and it would give me everything that <strong>doesn't</strong> apply to that function. Say, separate odd [1,2,3,4] - this should return [2,4] and [1,3] if we ran the function even. Below is what I have written:</p>\n\n<pre><code>separate f (x:xs)\n  | f x = filter f xs\n  | otherwise = x : filter f xs\n</code></pre>\n\n<p>Why does this occur as shown below? It appears that if f x is true, it will filter the rest and ignore x, otherwise, it will take x and filter the rest using the same guidelines. Am I missing something here?</p>\n\n<pre><code>separate odd [1,2,3,4]\n=&gt; [3]\n</code></pre>\n"}, {"tags": ["list", "haskell", "list-comprehension", "verbose"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574718754, "post_id": 59040617, "comment_id": 104323753, "body": "you can&#39;t make the list comprehension &quot;verbose&quot; in the way you suggest. You could get this information a totally different way though, by making an <code>IO</code> action that loops through all the numbers form 1 to 10000, checks each against <code>isSpecial</code> and prints out its progress to the terminal. Is that the kind of thing you&#39;re talking about?"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574718905, "post_id": 59040617, "comment_id": 104323813, "body": "Hmm.. you mean I&#39;ll have to write a <code>isSpecial_Verbose</code> which says something everytime it is called?"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574719018, "post_id": 59040617, "comment_id": 104323858, "body": "<code>isSpecial</code> is a function from <code>Int</code> to <code>Bool</code>. How do I make its output to be both <code>Bool</code> and <code>IO()</code>? @RobinZigmond"}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 1, "creation_date": 1574719256, "post_id": 59040617, "comment_id": 104323944, "body": "I wonder if you do Project Euler tasks. In there, you usually have two choices: first, generate and filter -- exactly what you show in the post; second, generate only numbers satisfying the property in the first place. The second approach is trickier but perform much better than the first one."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574719267, "post_id": 59040617, "comment_id": 104323950, "body": "No, I mean write a totally new value of type <code>IO ()</code> which uses <code>isSpecial</code> (and loop through the relevant numbers)"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1574719355, "post_id": 59040617, "comment_id": 104323978, "body": "@ArtemPelenitsyn some problems in math are just too hard that no one knows how to generate exactly the set of desired numbers."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574719529, "post_id": 59040617, "comment_id": 104324034, "body": "@RobinZigmond I still don&#39;t quite get it.. do you mean to write a function <code>verbosified :: (a-&gt;b) -&gt; IO()</code>, and apply it to <code>isSpecial</code>? My question is still there: I need the function <code>isSpecial</code> to report its boolean results. How can I keep this while making it verbose?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574720006, "post_id": 59040617, "comment_id": 104324181, "body": "well I can show you if you want, just didn&#39;t want to write an answer yet without knowing if this was what you were looking for. But what I mean is you can do, for example <code>tellMeResult :: Int -&gt; IO (); tellMeResult n = putStrLn $ &quot;Testing &quot; ++ show n ++ &quot; - it&#39;s &quot; ++ (if isSpecial n then &quot;special&quot; else &quot;not special&quot;)</code>. Then run that over all the numbers 1 to 1000 (eg with <code>mapM</code>)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574720053, "post_id": 59040617, "comment_id": 104324195, "body": "What I&#39;m suggesting isn&#39;t particularly sophisticated, but it will give you a crude view of how long the calculation is taking for each number, and where you&#39;re up to"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574720229, "post_id": 59040617, "comment_id": 104324255, "body": "Yes, then I get it! However, I asked this because I still need the comprehension list there. Usually comprehension list is great.. but sometimes the system hang because there is one list that takes so much time. If I could make all list verbose, I can spot what eats up time the most and fix it more efficiently!"}, {"owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 0, "creation_date": 1574731744, "post_id": 59040617, "comment_id": 104327123, "body": "You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Debug-Trace.html#v:trace\" rel=\"nofollow noreferrer\">trace</a> to print current state to console while it is evaluated"}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574721351, "post_id": 59040905, "comment_id": 104324601, "body": "I&#39;m still understanding this code. I haven&#39;t seen <code>IO [Int]</code>, and are not familiar with <code>pure</code>. I will get back to this after learning them.."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 1, "creation_date": 1574722189, "post_id": 59040905, "comment_id": 104324849, "body": "@Student I expect you&#39;ve seen <code>return</code>; if you have, <code>pure</code> is the same (it applies on more types, but don&#39;t worry about that for now). As for <code>IO [Int]</code>, <code>IO</code> is a type constructor, and <code>IO a</code> basically means &quot;this is an action that performs some input/output and returns a value of type <code>a</code>&quot;. <code>a</code> can be anything, including a list as here."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1574721597, "last_edit_date": 1574721597, "creation_date": 1574720230, "answer_id": 59040905, "question_id": 59040617, "link": "https://stackoverflow.com/questions/59040617/verbose-list-comprehension-in-haskell/59040905#59040905", "title": "Verbose List Comprehension in Haskell", "body": "<p>This is more or less what Robin Zigmond meant:</p>\n\n<pre><code>checkNumbers :: IO [Int]\ncheckNumbers = filterM check [1..10000]\n    where\n        check number = do\n            print $ \"Checking number\" &lt;&gt; show number\n            pure $ isSpecial number\n</code></pre>\n\n<p>This will print \"Checking number x\" before checking every number. Feel free to experiment with any other effects (or, in your words, \"verbosity\") within the <code>check</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1574722599, "creation_date": 1574722599, "answer_id": 59041315, "question_id": 59040617, "link": "https://stackoverflow.com/questions/59040617/verbose-list-comprehension-in-haskell/59041315#59041315", "title": "Verbose List Comprehension in Haskell", "body": "<p>Here is a way that requires no IO, instead relying on laziness and your programmer guess about which \"side\" of the condition happens more often. Just to have something to play with, here's a slightly slow function that checks if a number is a multiple of 10. The details of this function aren't important, feel free to skip it if anything doesn't make sense. I'm also going to turn on timing reporting; you'll see why later.</p>\n\n<pre><code>&gt; isSpecial :: Int -&gt; Bool; isSpecial n = last [1..10000000] `seq` (n `mod` 10 == 0)\n&gt; :set +s\n</code></pre>\n\n<p>(Add one <code>0</code> every five years.)</p>\n\n<p>Now the idea will be this: instead of your list comprehension, we'll use <code>partition</code> to split the list into two chunks, the elements that match the predicate and the ones that don't. We'll print the one of those that has more elements, so we can keep an eye on progress; by the time it's fully printed, the other one will be fully evaluated and we can inspect it however we like.</p>\n\n<pre><code>&gt; :m + Data.List\n&gt; (matches, nonMatches) = partition isSpecial [1..20]\n(0.00 secs, 0 bytes)\n&gt; nonMatches\n[1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,18,19]\n(12.40 secs, 14,400,099,848 bytes)\n</code></pre>\n\n<p>Obviously I can't portray this over StackOverflow, but when I did the above thing, the numbers in the <code>nonMatches</code> list slowly appeared on my terminal one-by-one, giving a pretty good indicator of where in the list it was currently thinking. And now, when you print <code>matches</code>, the full list is available more or less instantly, as you can see by the timing report (i.e. not another 12-second wait):</p>\n\n<pre><code>&gt; matches\n[10,20]\n(0.01 secs, 64,112 bytes)\n</code></pre>\n\n<p>But beware!</p>\n\n<ol>\n<li><p>It's important that <code>matches</code> and <code>nonMatches</code> have types which are <em>not</em> typeclass polymorphic (i.e. don't have types that start with <code>Num a =&gt; ...</code> or some other constraint). In the above example, I achieved this by making <code>isSpecial</code> monomorphic, which forces <code>matches</code> and <code>nonMatches</code> to be, too, but if your <code>isSpecial</code> is polymorphic, you should give a type signature for <code>matches</code> or <code>nonMatches</code> to prevent this problem.</p></li>\n<li><p>Doing it this way will cause the entire <code>nonMatches</code> and <code>matches</code> lists to be realized in memory. This could be expensive if the original list being partitioned is very long. (But up to, say, a couple hundred thousand <code>Int</code>s is not particularly long for modern computers.)</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574802044, "post_id": 59058306, "comment_id": 104357992, "body": "It&#39;s nice, but <code>second concat . unzip</code> won&#39;t quite recapture what my answer does: none of the calls to <code>isSpecial</code> will be forced by the printing of the <code>fst</code> part of the result, so the <code>fst</code> part doesn&#39;t actually give a good indicator of how much progress has been made. That&#39;s fine -- this is just a <i>different thing</i>, and there&#39;s no need to exactly reproduce what I did with it. But I&#39;d recommend just dropping that part of the answer to avoid confusing things."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574846346, "post_id": 59058306, "comment_id": 104371926, "body": "I&#39;ve edited that part. repeating your idea was not the goal of what I wrote of course, this chunking trick is something that I often do myself, probably with some seq in the middle (as you point out -- will edit that in shortly). I mostly just print the results as is, so everything <i>is</i> forced. I even initially wrote &quot;what I often do in such situations is ...&quot; but then edited for neutrality. it just occurred to me that it is the same thing so I mentioned it."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1574848137, "last_edit_date": 1574848137, "creation_date": 1574797315, "answer_id": 59058306, "question_id": 59040617, "link": "https://stackoverflow.com/questions/59040617/verbose-list-comprehension-in-haskell/59058306#59058306", "title": "Verbose List Comprehension in Haskell", "body": "<p>We would usually want to see both the tried and the discovered numbers as the calculation goes on.</p>\n\n<p>What I usually do is break up the input list into chunks of <code>n</code> elements, filter each chunk as you would the whole list, and convert each chunk into a pair of its head element and the filtered chunk:</p>\n\n<pre><code>chunked_result = [ (h, [n | n &lt;- chunk, isSpecial n])\n                   | chunk@(h:_) &lt;- chunksOf n input]\n</code></pre>\n\n<p>Putting such result list through <code>concatMap snd</code> gives the original non-\"verbose\" option. </p>\n\n<p>Adjusting the <code>n</code> value will influence the frequency with which the progress will be \"reported\" when the result list is simply printed, showing both the tried and the <em>discovered</em> numbers, with some inconsequential \"noise\" around them.</p>\n\n<p>Using <code>second concat . unzip</code> on the chunks results list is somewhat similar to  Daniel Wagner's partitioning idea (with caveats),<sup>(*)</sup> but with <em>your</em> set value of <code>n</code>, not just <code>1</code>.</p>\n\n<p>If there is an algorithmic slowdown innate to your specific problem, apply the <a href=\"http://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth\" rel=\"nofollow noreferrer\">orders of growth run time estimation</a> <a href=\"https://stackoverflow.com/questions/24202687/painter-puzzle-estimation\">analysis</a>.</p>\n\n<hr>\n\n<p><sup>(*)</sup> to make it compatible we need to stick some <code>seq</code> in the middle somewhere, like</p>\n\n<pre><code>chunked_result = [ (last s `seq` last chunk, s)\n                   | chunk &lt;- chunksOf n input\n                     let s = [n | n &lt;- chunk, isSpecial n] ]\n</code></pre>\n\n<p>or something. </p>\n"}, {"tags": [], "owner": {"reputation": 26323, "user_id": 108915, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a00512b12118ebd20d2043802b38bd02?s=128&d=identicon&r=PG", "display_name": "ziggystar", "link": "https://stackoverflow.com/users/108915/ziggystar"}, "is_accepted": false, "score": 1, "last_activity_date": 1574846688, "last_edit_date": 1592644375, "creation_date": 1574846688, "answer_id": 59066894, "question_id": 59040617, "link": "https://stackoverflow.com/questions/59040617/verbose-list-comprehension-in-haskell/59066894#59066894", "title": "Verbose List Comprehension in Haskell", "body": "<h1><code>Debug.Trace</code></h1>\n<p>You can have a look at <code>Debug.Trace</code>. It allows printing messages to the console. But as Haskell is lazy, controlling when printing happens is not so easy. And this is also not recommended for production:</p>\n<pre><code>Prelude Debug.Trace&gt; import Debug.Trace\nPrelude Debug.Trace&gt; [x | x &lt;- [1..10], traceShow (x, odd x) $ odd x]\n(1,True)\n[1(2,False)\n(3,True)\n,3(4,False)\n(5,True)\n,5(6,False)\n(7,True)\n,7(8,False)\n(9,True)\n,9(10,False)\n]\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1574848137, "creation_date": 1574718624, "question_id": 59040617, "link": "https://stackoverflow.com/questions/59040617/verbose-list-comprehension-in-haskell", "title": "Verbose List Comprehension in Haskell", "body": "<p>I'm using Haskell to find a list of integers from 1 to 10000 that have a special property. I do the following</p>\n\n<p><code>[ number | number &lt;- [1..10000], (isSpecial number)]</code></p>\n\n<p>However, every now and then I came up with some special properties that are</p>\n\n<ol>\n<li><p>hard to be satisfied</p></li>\n<li><p>take a long time to be verified</p></li>\n</ol>\n\n<p>As a result, it hangs there after some first few examples.</p>\n\n<p>I wonder how I can make the list comprehension in Haskell verbose, so I have a good update about how much Haskell has progressed.</p>\n"}, {"tags": ["haskell", "data-structures", "tree"], "answers": [{"comments": [{"owner": {"reputation": 281, "user_id": 1578446, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XeFnw.jpg?s=128&g=1", "display_name": "Paul Clavier", "link": "https://stackoverflow.com/users/1578446/paul-clavier"}, "edited": false, "score": 0, "creation_date": 1574715580, "post_id": 59039891, "comment_id": 104322594, "body": "So my intuition was correct I guess. Thanks for clearing it up!"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 11, "last_activity_date": 1574718254, "last_edit_date": 1574718254, "creation_date": 1574714951, "answer_id": 59039891, "question_id": 59039754, "link": "https://stackoverflow.com/questions/59039754/how-does-this-binary-tree-code-represent-a-tree/59039891#59039891", "title": "How does this binary tree code represent a tree?", "body": "<p>It is a tree with data stored only in the leaves. There is no requirement that a tree have data in the interior nodes, although of course many algorithms can only operate on a tree with data in its interior nodes (e.g. BST search).</p>\n\n<p>You might ask in what situation such a structure is useful. Consider Huffman decoding, where no data is needed in the interior nodes. You simply traverse down the tree, moving left on 0 and right on 1, until you reach a leaf node, at which point you have decoded a character.</p>\n"}], "owner": {"reputation": 281, "user_id": 1578446, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XeFnw.jpg?s=128&g=1", "display_name": "Paul Clavier", "link": "https://stackoverflow.com/users/1578446/paul-clavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 59039891, "answer_count": 1, "score": 4, "last_activity_date": 1574718254, "creation_date": 1574714349, "question_id": 59039754, "link": "https://stackoverflow.com/questions/59039754/how-does-this-binary-tree-code-represent-a-tree", "title": "How does this binary tree code represent a tree?", "body": "<p>I was reading through past papers for my University's Haskell exam and came across a question involving trees where the tree type was implemented as such:</p>\n\n<pre><code>data Tree a = Lf a                  -- leaf\n            | Tree a :+: Tree a     -- branch\n</code></pre>\n\n<p>It then goes on to outline an example tree that could be used with various functions, for example:</p>\n\n<pre><code>((Lf 1 :+: Lf 2) :+: (Lf 3 :+: Lf 4))\n</code></pre>\n\n<p>My confusion with this code is how it can represent a tree without having some notion of a root element. My intuition would suggest the tree being represented here would look like this:</p>\n\n<pre><code>  / \\\n/ \\ / \\\n1 2 3 4\n</code></pre>\n\n<p>but such a tree would possess no root elements, only leaves, which certainly seems wrong to me. How is a tree actually expressed in this code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1574716970, "post_id": 59039737, "comment_id": 104323124, "body": "I think this package can take care of your use case very well. No need to reinvent the wheel: <a href=\"https://www.stackage.org/package/cache\" rel=\"nofollow noreferrer\">stackage.org/package/cache</a>"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574754182, "post_id": 59039737, "comment_id": 104333081, "body": "There is no general answer to the question: &quot;When to call <code>invalidateCache</code>?&quot; It depends on the resource which actions invalidate the cache and wether you even notice invalidation across a network. (Even if you could check &quot;fast&quot; if your cache is still valid, will the result of this check still hold after 1ms, hence when you receive the result of this check across the network?)"}, {"owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "reply_to_user": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1574762147, "post_id": 59039737, "comment_id": 104337014, "body": "@lehins: yes good idea, it would be cleaner. However the real problem was that I cannot distinguish from the type which function is using cache of not."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1574771837, "post_id": 59039737, "comment_id": 104342247, "body": "@cdupont A function that doesn&#39;t use the cache would live directly in <code>IO</code>, or perhaps it would  be polymorphic in the type of the state. If your state were a record with separate &quot;read&quot; and &quot;invalidate&quot; actions as fields, functions which read the value but never invalidate it should not see the latter action. There are several ways of accomplishing this: polymorphism over a field, classy lenses, something like <code>zoom</code> from lens... <a href=\"https://stackoverflow.com/questions/43230520/is-state-monad-needed-useful-in-a-language-with-mutable-local-variables-such/43241679#43241679\" title=\"is state monad needed useful in a language with mutable local variables such\">stackoverflow.com/questions/43230520/&hellip;</a>"}], "owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574726739, "creation_date": 1574714267, "question_id": 59039737, "link": "https://stackoverflow.com/questions/59039737/design-question-cache-mechanism-in-haskell", "title": "Design question: cache mechanism in Haskell", "body": "<p>I have a design pattern that comes back often.\nSay I have an application that retrieves resources from the network:</p>\n\n<pre><code>getResource :: IO MyResource\ngetResource = getFromNetwork ...\n</code></pre>\n\n<p>All is clear. The type and the name of the function conveys well the meaning. But often time comes where the network is too slow, so I need to cache the result locally:</p>\n\n<pre><code>data Cache = Cache MyResource ...\ndata App = StateT (TVar Cache) IO\n\n-- get the resource from the cache, if invalid/outdated, take from network and update cache.\ngetResource' ::\u00a0 App MyResource\ngetResource' = do\n\u00a0 cache &lt;- getCachedResource\n\u00a0 if isValid cache\n\u00a0\u00a0\u00a0 then $ return cache\n\u00a0\u00a0\u00a0 else $ do\n\u00a0\u00a0\u00a0\u00a0\u00a0 resource &lt;- getResource\n\u00a0\u00a0\u00a0\u00a0\u00a0 updateCache resource\n\u00a0\u00a0\u00a0\u00a0\u00a0 return resource\n\nupdateCache :: MyResource -&gt; App ()\nupdateCache = ...\n\n-- call this function for any operation that compromises the cache, such as write operations on the network.\ninvalidateCache :: App ()\ninvalidateCache = ...\n</code></pre>\n\n<p>But now it's more confused. Which function are using the cache? Which doesn't? When to call invalidateCache?\nThe application has become stateful...</p>\n\n<p>How can my types reflects better the workings of the cache?\nShould I use smart constructors?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1574700756, "post_id": 59036444, "comment_id": 104316094, "body": "How are you executing these? Are you typing them into GHCi by any chance?"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 3, "creation_date": 1574700770, "post_id": 59036444, "comment_id": 104316104, "body": "Your line <code>aplicalist a [] = []</code> should be <code>aplicaList a [] = []</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574700900, "post_id": 59036444, "comment_id": 104316186, "body": "Function names are case-sensitive, and you have a typo of <code>compunelist</code> for <code>compuneList</code>, which means you are defining two separate partial functions rather than a single total function. (Same for the second function, as pointed out by Simon Shine.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574701045, "post_id": 59036444, "comment_id": 104316255, "body": "There&#39;s no need for explicit recursion here anyway; <code>compuneList f = map (f .)</code> and <code>aplicaList a = map ($ a)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10728388, "user_type": "registered", "profile_image": "https://graph.facebook.com/2102364663164338/picture?type=large", "display_name": "Andu M&#238;ndrescu", "link": "https://stackoverflow.com/users/10728388/andu-m%c3%aendrescu"}, "edited": false, "score": 0, "creation_date": 1574701311, "post_id": 59036717, "comment_id": 104316393, "body": "It was because the small and big letters, thank you"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 43, "user_id": 10728388, "user_type": "registered", "profile_image": "https://graph.facebook.com/2102364663164338/picture?type=large", "display_name": "Andu M&#238;ndrescu", "link": "https://stackoverflow.com/users/10728388/andu-m%c3%aendrescu"}, "edited": false, "score": 3, "creation_date": 1574701611, "post_id": 59036717, "comment_id": 104316547, "body": "@AnduM&#238;ndrescu: If you turn on compiler warnings and linting in your editor, you will receive meaningful messages that will suggest this. For example, a giveaway is that the first definition after your type signatures is for something other than what&#39;s in your type signatures."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 2, "last_activity_date": 1574701166, "creation_date": 1574701166, "answer_id": 59036717, "question_id": 59036444, "link": "https://stackoverflow.com/questions/59036444/why-do-i-receive-non-exhaustive-patterns-in-function-compunelist/59036717#59036717", "title": "Why do I receive Non-exhaustive patterns in function compuneList", "body": "<p>The cause of your warnings are two typos:</p>\n\n<ul>\n<li><code>aplicalist a [] = []</code> should be <code>aplicaList a [] = []</code>.</li>\n<li><code>compunelist f (ff : xs)</code> should be <code>compuneList f (ff : xs)</code>.</li>\n</ul>\n\n<p>Be aware of big and small letters when you code.</p>\n\n<hr>\n\n<p>If you run your code through HLint, it will suggest that you can eliminate a bunch of parentheses.</p>\n\n<p>You can also reduce explicit recursion using <code>map</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>compuneList :: (b -&gt; c) -&gt; [a -&gt; b] -&gt; [a -&gt; c]\ncompuneList f = map (f .)\n\naplicaList :: a -&gt; [a -&gt; b] -&gt; [b]\naplicaList a = map (\\f -&gt; f a)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10728388, "user_type": "registered", "profile_image": "https://graph.facebook.com/2102364663164338/picture?type=large", "display_name": "Andu M&#238;ndrescu", "link": "https://stackoverflow.com/users/10728388/andu-m%c3%aendrescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574701166, "creation_date": 1574700182, "question_id": 59036444, "link": "https://stackoverflow.com/questions/59036444/why-do-i-receive-non-exhaustive-patterns-in-function-compunelist", "title": "Why do I receive Non-exhaustive patterns in function compuneList", "body": "<p>I am new to Haskell. I am trying to write a function called aplicaList which receives a number and list of functions [(a -> b)] , I want to return a list containing all the results [f(a)]</p>\n\n<p>Function compuneList is a function which receives a function f and a list of other functions [(g)] and results a list of functions [f(g())].</p>\n\n<pre><code>compuneList :: (b -&gt; c) -&gt; [(a -&gt; b)] -&gt; [(a -&gt; c)] \ncompuneList f [] = []\ncompunelist f (ff : xs) = (f . ff : compuneList f xs)\n\naplicaList :: a -&gt; [(a -&gt; b)] -&gt; [b]\naplicalist a [] = []\naplicaList a (f : xs) = (f(a) : aplicaList a xs)\n</code></pre>\n\n<p>The program compiles, but when I try to interpret aplicatList 9 [(+1), (+3)] I get:</p>\n\n<p><strong>[10,12  Exception: Lab4.hs:59:1-48: Non-exhaustive patterns in function aplicaList</strong></p>\n\n<p>and when I try aplicaList 9 (compuneList (+1) [sqrt, (^2), (/2)]) I get: </p>\n\n<p><strong>Exception: Lab4.hs:54:1-21: Non-exhaustive patterns in function compuneList</strong></p>\n\n<p>I do not know why in both cases. Thank you.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 2, "creation_date": 1574697396, "post_id": 59035420, "comment_id": 104314201, "body": "Think of <code>helloWorld</code> being constant such as a field or variable in C#. There&#39;s no parameter that is being applied to <code>helloWorld</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574699983, "post_id": 59035420, "comment_id": 104315669, "body": "<code>putStrLn</code> <i>doesn&#39;t</i> have a side effect; it simply returns an IO action, the <i>same</i> IO action for the argument <code>&quot;Hello World&quot;</code> no matter how many times you call <code>putStrLn</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574700081, "post_id": 59035420, "comment_id": 104315717, "body": "If it did, <code>helloworld</code> wouldn&#39;t be an action that prints <code>Hello world</code>; it would be the value returned by <code>putStrLn</code> <i>after</i> <i>it</i> printed <code>Hello World</code> (namely, <code>()</code>)."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1574704903, "post_id": 59035420, "comment_id": 104318091, "body": "I think to understand this example you would already have to understand how side effects work in Haskell. It&#39;s not a good example."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574706770, "post_id": 59035420, "comment_id": 104318965, "body": "In your C# snippet you don&#39;t do like <code>helloWorld = Console.WriteLine(&quot;Hello World&quot;);</code>. You just contain the <code>Console.WriteLine(&quot;Hello World&quot;);</code> in the <code>HelloWorld</code> function to be executed everytime <code>HelloWorld</code> is invoked. Now think about what <code>helloWorld = putStrLn &quot;Hello World&quot;</code> makes <code>helloWorld</code>. It gets assigned to an IO monad which contains <code>()</code>. Once you bind it by <code>&gt;&gt;=</code> it will only then perform it&#39;s activity (printing something) and will give you <code>()</code> on the right side of the bind operator."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574798851, "post_id": 59035420, "comment_id": 104356643, "body": "the reason it confuses you is that it gives a C-like reading to the Haskell code. <code>hi = putStrLn(&quot;Hi!&quot;)</code> <i>in C</i> would print <code>&quot;Hi!&quot;</code> and return some value, to be stored in the <code>hi</code> variable. In Haskell though that line is not a function call, but a <i>definition</i>. It&#39;s good that it seems natural to you that it prints three times -- it means you&#39;re a <i>natural</i> Haskeller!  :) (or FP programmer, in general)"}, {"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1602893086, "post_id": 59035420, "comment_id": 113873291, "body": "Philip Wadler provides a smaller example and explanation in section 2.2 of <a href=\"https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.91.3579&amp;rep=rep1&amp;type=pdf\" rel=\"nofollow noreferrer\">How to Declare an Imperative</a> (pages 4-5)."}], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 8, "last_activity_date": 1574698272, "creation_date": 1574698272, "answer_id": 59035887, "question_id": 59035420, "link": "https://stackoverflow.com/questions/59035420/understanding-pure-functions-and-side-effects-in-haskell-putstrln/59035887#59035887", "title": "Understanding pure functions and side effects in Haskell - putStrLn", "body": "<p>It\u2019d probably be easier to understand what the author means if we define <code>helloWorld</code> as a local variable:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let helloWorld = putStrLn \"Hello World!\"\n  helloWorld\n  helloWorld\n  helloWorld\n</code></pre>\n\n<p>which you could compare to this C#-like pseudocode:</p>\n\n<pre><code>void Main() {\n  var helloWorld = {\n    WriteLine(\"Hello World!\")\n  }\n  helloWorld;\n  helloWorld;\n  helloWorld;\n}\n</code></pre>\n\n<p>I.e. in C# <code>WriteLine</code> is a procedure that prints its argument and returns nothing. In Haskell, <code>putStrLn</code> is a function that takes a string and gives you an action that would print that string were it to be executed. It means that there is absolutely no difference between writing</p>\n\n<pre><code>do\n  let hello = putStrLn \"Hello World\"\n  hello\n  hello\n</code></pre>\n\n<p>and</p>\n\n<pre><code>do\n  putStrLn \"Hello World\"\n  putStrLn \"Hello World\"\n</code></pre>\n\n<p>That being said, in this example the difference isn\u2019t particularly profound, so it\u2019s fine if you don\u2019t quite get what the author is trying to get at in this section and just move on for now. </p>\n\n<p>it works a bit better if you compare it to python</p>\n\n<pre><code>hello_world = print('hello world')\nhello_world\nhello_world\nhello_world\n</code></pre>\n\n<p>The point here being that IO actions in Haskell are \u201creal\u201d values that don\u2019t need to be wrapped in further \u201ccallbacks\u201d or anything of the sort to prevent them from executing - rather, the only way to <em>do</em> get them to execute is to put them in a particular place (i.e. somewhere inside <code>main</code> or a thread spawned off <code>main</code>).</p>\n\n<p>This isn\u2019t just a parlour trick either, this does end up having some interesting effects on how you write code (for example, it\u2019s part of the reason why Haskell doesn\u2019t really need any of the common control structures you\u2019d be familiar with from imperative languages and can get away with doing everything in terms of functions instead), but again I wouldn\u2019t worry too much about this (analogies like these don\u2019t always immediately click)</p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1574698458, "creation_date": 1574698458, "answer_id": 59035941, "question_id": 59035420, "link": "https://stackoverflow.com/questions/59035420/understanding-pure-functions-and-side-effects-in-haskell-putstrln/59035941#59035941", "title": "Understanding pure functions and side effects in Haskell - putStrLn", "body": "<p>There is one detail to notice: you call <code>putStrLn</code> function only once, while defining <code>helloWorld</code>. In <code>main</code> function you just use the return value of that <code>putStrLn \"Hello, World\"</code> three times.</p>\n\n<p>The lecturer says that <code>putStrLn</code> call has no side effects and it's true. But look at the type of <code>helloWorld</code> - it is an IO action. <code>putStrLn</code> just creates it for you. Later, you chain 3 of them with the <code>do</code> block to create another IO action - <code>main</code>. Later, when you execute your program, that action will be run, that's where side effects lie.</p>\n\n<p>The mechanism that lies in base of this - <a href=\"https://stackoverflow.com/questions/44965/what-is-a-monad\">monads</a>. This powerful concept allows you to use some side effects like printing in a language that doesn't support side effects directly. You just chain some actions, and that chain will be run on start of your program. You will need to understand that concept deeply if you want to use Haskell seriously.</p>\n"}, {"comments": [{"owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "edited": false, "score": 1, "creation_date": 1574714230, "post_id": 59036209, "comment_id": 104322065, "body": "It&#39;s worth noting that you should absolutely not be using <code>unsafePerformIO</code> at this stage of learning Haskell. It has &quot;unsafe&quot; in the name for a reason, and you shouldn&#39;t be using it unless you can (and did) carefully consider the implications of its usage in context. The code that danidiaz put in the answer perfectly captures the sort of unintuitive behavior that can result from <code>unsafePerformIO</code>."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1574700037, "last_edit_date": 1574700037, "creation_date": 1574699363, "answer_id": 59036209, "question_id": 59035420, "link": "https://stackoverflow.com/questions/59035420/understanding-pure-functions-and-side-effects-in-haskell-putstrln/59036209#59036209", "title": "Understanding pure functions and side effects in Haskell - putStrLn", "body": "<p>If the evaluation of <code>putStrLn \"Hello World\"</code> had side effects, then then message would only be printed once.</p>\n\n<p>We can approximate that scenario with the following code:</p>\n\n<pre><code>import System.IO.Unsafe (unsafePerformIO)\nimport Control.Exception (evaluate)\n\nhelloWorld :: ()\nhelloWorld = unsafePerformIO $ putStrLn \"Hello World\"\n\nmain :: IO ()\nmain = do\n    evaluate helloWorld\n    evaluate helloWorld\n    evaluate helloWorld\n</code></pre>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO-Unsafe.html#v:unsafePerformIO\" rel=\"nofollow noreferrer\"><code>unsafePerformIO</code></a> takes an <code>IO</code> action and \"forgets\" it's an <code>IO</code> action, unmooring it from the usual sequencing imposed by the composition of <code>IO</code> actions and letting the effect take place (or not) according to the vagaries of lazy evaluation.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:evaluate\" rel=\"nofollow noreferrer\"><code>evaluate</code></a> takes a pure value and ensures that the value is evaluated whenever the resulting <code>IO</code> action is evaluated\u2014which for us it will be, because it lies in the path of <code>main</code>. We are using it here to connect the evaluation of some values to the exection of the program.</p>\n\n<p>This code only prints \"Hello World\" one time. We treat <code>helloWorld</code> as a pure value. But that means it will be shared between all <code>evaluate helloWorld</code> calls. And why not? It's a pure value after all, why recalculate it needlessly? The first <code>evaluate</code> action \"pops\" the \"hidden\" effect and the later actions just evaluate the resulting <code>()</code>, which doesn't cause any further effects.</p>\n"}, {"tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 4, "last_activity_date": 1574699428, "creation_date": 1574699428, "answer_id": 59036225, "question_id": 59035420, "link": "https://stackoverflow.com/questions/59035420/understanding-pure-functions-and-side-effects-in-haskell-putstrln/59036225#59036225", "title": "Understanding pure functions and side effects in Haskell - putStrLn", "body": "<p>It might be easier to see the difference as described if you use a function that actually does something, rather than <code>helloWorld</code>. Think of the following:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>add :: Int -&gt; Int -&gt; IO Int\nadd x y = do\n  putStrLn (\"I am adding \" ++ show x ++ \" and \" ++ show y)\n  return (x + y)\n\nplus23 :: IO Int\nplus23 = add 2 3\n\nmain :: IO ()\nmain = do\n  _ &lt;- plus23\n  _ &lt;- plus23\n  _ &lt;- plus23\n  return ()\n</code></pre>\n\n<p>This will print out \"I am adding 2 and 3\" 3 times.</p>\n\n<p>In C#, you might write the following:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\n\npublic class Program\n{\n    public static int add(int x, int y)\n    {\n        Console.WriteLine(\"I am adding {0} and {1}\", x, y);\n        return x + y;\n    }\n\n    public static void Main()\n    {\n        int x;\n        int plus23 = add(2, 3);\n        x = plus23;\n        x = plus23;\n        x = plus23;\n        return;\n    }\n}\n</code></pre>\n\n<p>Which would print only once.</p>\n"}], "owner": {"reputation": 945, "user_id": 4602441, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/122a113afb9b3f018b80e47e63d1fa4d?s=128&d=identicon&r=PG&f=1", "display_name": "Fluous", "link": "https://stackoverflow.com/users/4602441/fluous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 59035887, "answer_count": 4, "score": 10, "last_activity_date": 1574760043, "creation_date": 1574696604, "last_edit_date": 1574760043, "question_id": 59035420, "link": "https://stackoverflow.com/questions/59035420/understanding-pure-functions-and-side-effects-in-haskell-putstrln", "title": "Understanding pure functions and side effects in Haskell - putStrLn", "body": "<p>Recently, I started learning Haskell because I wanted to broaden my knowledge on functional programming and I must say I am really loving it so far. The resource I am currently using is the course 'Haskell Fundamentals Part 1' on Pluralsight. Unfortunately I have some difficulty understanding one particular quote of the lecturer about the following code and was hoping you guys could shed some light on the topic.</p>\n\n<p><strong>Accompanying Code</strong></p>\n\n<pre><code>helloWorld :: IO ()\nhelloWorld = putStrLn \"Hello World\"\n\nmain :: IO ()\nmain = do\n    helloWorld\n    helloWorld\n    helloWorld\n</code></pre>\n\n<p><strong>The Quote</strong></p>\n\n<p><em>If you have the same IO action multiple times in a do-block, it will be run multiple times. So this program prints out the string 'Hello World' three times. This example helps illustrate that <code>putStrLn</code> is not a function with side effects. We call the <code>putStrLn</code> function once to define the <code>helloWorld</code> variable. If <code>putStrLn</code> had a side effect of printing the string, it would only print once and the <code>helloWorld</code> variable repeated in the main do-block wouldn't have any effect.</em></p>\n\n<p><em>In most other programming languages, a program like this would print 'Hello World' only once, since the printing would happen when the <code>putStrLn</code> function was called. This subtle distinction would often trip up beginners, so think about this a bit, and make sure you understand why this program prints 'Hello World' three times and why it would print it only once if the <code>putStrLn</code> function did the printing as a side effect.</em></p>\n\n<p><strong>What I don't understand</strong></p>\n\n<p>For me it seems almost natural that the string 'Hello World' is printed three times. I perceive the <code>helloWorld</code> variable (or function?) as a sort of callback which is invoked later. What I don't understand is, how if <code>putStrLn</code> had a side effect, it would result in the string being printed only once. Or why it would only be printed once in other programming languages.</p>\n\n<p>Let's say in C# code, I would presume it would look like this:</p>\n\n<p><strong>C#</strong> <a href=\"https://dotnetfiddle.net/1Tl4h2\" rel=\"noreferrer\">(Fiddle)</a></p>\n\n<pre><code>using System;\n\npublic class Program\n{\n    public static void HelloWorld()\n    {\n        Console.WriteLine(\"Hello World\");\n    }\n\n    public static void Main()\n    {\n        HelloWorld();\n        HelloWorld();\n        HelloWorld();\n    }\n}\n</code></pre>\n\n<p>I am sure I am overlooking something quite simple or misinterpret his terminology. Any help would be greatly appreciated.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thank you all for your answers! Your answers helped me get a better understanding of these concepts. I don't think it fully clicked yet, but I will revisit the topic in the future, thank you!</p>\n"}, {"tags": ["haskell", "yaml", "ghc", "haskell-stack", "hpack"], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 1, "last_activity_date": 1574696727, "creation_date": 1574696727, "answer_id": 59035447, "question_id": 59035162, "link": "https://stackoverflow.com/questions/59035162/hpack-or-pre-processor-platform-info/59035447#59035447", "title": "Hpack or pre-processor platform info", "body": "<p><code>hpack</code> does support this: <a href=\"https://github.com/sol/hpack#conditionals\" rel=\"nofollow noreferrer\">hpack conditionals</a>. It looks something like this:</p>\n\n<pre><code>when:\n  - condition: os(darwin)\n  then:\n    extra-lib-dirs: lib/darwin\n  else:\n    extra-lib-dirs: lib/linux\n</code></pre>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 59035447, "answer_count": 1, "score": 1, "last_activity_date": 1574696727, "creation_date": 1574695718, "question_id": 59035162, "link": "https://stackoverflow.com/questions/59035162/hpack-or-pre-processor-platform-info", "title": "Hpack or pre-processor platform info", "body": "<p>I am using hpack+stack for a project and there is a hardcoded path (used for debugging, I don't want to do this properly) which are differs for mac os x and linux. Right now I have it on a gitignored file on it's own and that file differs between my workstations but I would much rather have the pre-processor deal with it. </p>\n\n<p>Ideally I would like something equivalent to<code>#ifdef __linux__</code>, which dosnt work. I would even be happy with manipulating <code>package.yaml</code> to come up with <code>-D</code> compiler flags. Does hpack (which I think uses <code>Data.Yaml</code>) have this capability?</p>\n"}, {"tags": ["haskell", "computer-science", "haskell-platform"], "comments": [{"owner": {"reputation": 105, "user_id": 12429061, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LPeFpqCo8pQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pvhFkdewt5Pm1XY2MTnIgr6USr8A/mo/photo.jpg?sz=128", "display_name": "German student 99", "link": "https://stackoverflow.com/users/12429061/german-student-99"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1574682461, "post_id": 59030915, "comment_id": 104305986, "body": "A description of what the code did: numberisIntger is function that check if a number integer or not and it gives back true or false, one is function its parameter if its integer then it put it in a list if not it gives an empty one, two function is like one but as a comprehension, toint function covert a list of float to int."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1574682906, "post_id": 59030915, "comment_id": 104306253, "body": "Erm, that doesn&#39;t explain where <i>the problem</i> is."}, {"owner": {"reputation": 533, "user_id": 3847023, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mUqNl.jpg?s=128&g=1", "display_name": "Nick Tchayka", "link": "https://stackoverflow.com/users/3847023/nick-tchayka"}, "edited": false, "score": 1, "creation_date": 1574684677, "post_id": 59030915, "comment_id": 104307215, "body": "There is some information missing, what is the behaviour you expect? \ud83d\ude00  I mean, could you please write something like: * When I run the program, it does .... * But instead of that, I expect it to do..."}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 2, "last_activity_date": 1574685405, "last_edit_date": 1574685405, "creation_date": 1574684871, "answer_id": 59031843, "question_id": 59030915, "link": "https://stackoverflow.com/questions/59030915/a-programm-that-check-if-a-list-of-number-is-integer-or-not-and-then-put-it-in/59031843#59031843", "title": "A Programm that check if a list of number is Integer or not, and then put it in a a list", "body": "<p>Given your function (with <code>truncate</code> rather than <code>round</code>), it seems that all you need is <code>filter</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isInteger :: RealFrac a =&gt; a -&gt; Bool\nisInteger x = fromIntegral (truncate x) == x\n\nintegers :: RealFrac a =&gt; [a] -&gt; [a]\nintegers = filter isInteger\n</code></pre>\n\n<p><code>RealFrac a =&gt; a</code> could be <code>Float</code> or <code>Double</code>. Since <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:RealFrac\" rel=\"nofollow noreferrer\">the rounding functions of <code>RealFrac</code></a> don't make further restrictions, neither does this function need to: <code>a</code> is some <code>RealFrac</code> and <code>b</code> is some <code>Integral</code>.</p>\n\n<p>Note that if you were using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html\" rel=\"nofollow noreferrer\"><code>Data.Ratio</code> / <code>Rational</code></a> to express lossless fractional numbers, you'd know that something is an integer when <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#v:denominator\" rel=\"nofollow noreferrer\"><code>denominator</code></a> is 1.</p>\n"}], "owner": {"reputation": 105, "user_id": 12429061, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LPeFpqCo8pQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pvhFkdewt5Pm1XY2MTnIgr6USr8A/mo/photo.jpg?sz=128", "display_name": "German student 99", "link": "https://stackoverflow.com/users/12429061/german-student-99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574685405, "creation_date": 1574681792, "last_edit_date": 1574682791, "question_id": 59030915, "link": "https://stackoverflow.com/questions/59030915/a-programm-that-check-if-a-list-of-number-is-integer-or-not-and-then-put-it-in", "title": "A Programm that check if a list of number is Integer or not, and then put it in a a list", "body": "<p>So I am trying to build a program that receives a list of numbers and checks if they're integer. If the numbers are, put them in a result list. \nI tried something like that but did not work (all the functions works only <code>mylist</code>)</p>\n\n<pre><code>numberisInteger number = number == fromInteger(round number)\n\none :: Float -&gt; [Float] \none x = if numberisInteger x then [x] else [] \n\ntwo xs = [one x | x &lt;- xs] \n\ntoint :: [Float] -&gt; [Int] \ntoint = roundd\n\nroundd xs = [round x | x &lt;- xs]\n\nmylist xs = [toint x | x &lt;- xs]\n\n\nmain :: IO ()\nmain = return () \n</code></pre>\n\n<p>A description of what the code did: <code>numberisIntger</code> is function that check if a number integer or not and it gives back true or false, one is function its parameter if its integer then it put it in a list if not it gives an empty one, two function is like one but as a comprehension, <code>toint</code> function covert a list of float to int. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45645, "user_id": 1056563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc888aa658ab0e0d2a4d305ad7f69123?s=128&d=identicon&r=PG", "display_name": "StephenBoesch", "link": "https://stackoverflow.com/users/1056563/stephenboesch"}, "edited": false, "score": 0, "creation_date": 1585971177, "post_id": 59030132, "comment_id": 107959731, "body": "This is a v clear questoin and I have the same issue. This should not be downvoted imo."}], "answers": [{"tags": [], "owner": {"reputation": 533, "user_id": 3847023, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mUqNl.jpg?s=128&g=1", "display_name": "Nick Tchayka", "link": "https://stackoverflow.com/users/3847023/nick-tchayka"}, "is_accepted": false, "score": 1, "last_activity_date": 1574684847, "creation_date": 1574684847, "answer_id": 59031835, "question_id": 59030132, "link": "https://stackoverflow.com/questions/59030132/how-do-i-install-haskell-stack-on-mac/59031835#59031835", "title": "How do I install Haskell Stack on Mac?", "body": "<p><code>stack</code> and <code>ghcup</code> are two different tools.</p>\n\n<p>You can get <code>stack</code> from <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">this website</a>, which involves running the following command:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl -sSL https://get.haskellstack.org/ | sh\n</code></pre>\n\n<p>On the other hand, <code>ghcup</code> is a tool that only installs the Haskell compiler (GHC), which means that you won't be able to build a project using Stack. Note that this last installation comes with a build tool called <code>cabal</code>. You can learn the differences between <code>stack</code> and <code>cabal</code> <a href=\"https://stackoverflow.com/questions/30913145/what-is-the-difference-between-cabal-and-stack\">in this other question</a>.</p>\n\n<p>Regarding your error with <code>ghcup</code>, I'd try to use the instructions from <a href=\"https://gitlab.haskell.org/haskell/ghcup\" rel=\"nofollow noreferrer\">https://gitlab.haskell.org/haskell/ghcup</a>. It is the main repo from the project, and probably updated faster. Note that you can use the \"simple bootstrap\" process, and if that doesn't work, try the manual one.</p>\n"}, {"comments": [{"owner": {"reputation": 45645, "user_id": 1056563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc888aa658ab0e0d2a4d305ad7f69123?s=128&d=identicon&r=PG", "display_name": "StephenBoesch", "link": "https://stackoverflow.com/users/1056563/stephenboesch"}, "edited": false, "score": 0, "creation_date": 1585971216, "post_id": 59040807, "comment_id": 107959741, "body": "<code>stack build</code> does not work from <code>brew</code> for me - and apparently not for the asker."}], "tags": [], "owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1574719642, "creation_date": 1574719642, "answer_id": 59040807, "question_id": 59030132, "link": "https://stackoverflow.com/questions/59030132/how-do-i-install-haskell-stack-on-mac/59040807#59040807", "title": "How do I install Haskell Stack on Mac?", "body": "<p>If you have brew installed, you can use : <code>brew install stack</code></p>\n"}], "owner": {"reputation": 21, "user_id": 12428852, "user_type": "registered", "profile_image": "https://graph.facebook.com/2480180185383533/picture?type=large", "display_name": "\u30cf\u30c3 \u30c1", "link": "https://stackoverflow.com/users/12428852/%e3%83%8f%e3%83%83-%e3%83%81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574719642, "creation_date": 1574679211, "last_edit_date": 1574684764, "question_id": 59030132, "link": "https://stackoverflow.com/questions/59030132/how-do-i-install-haskell-stack-on-mac", "title": "How do I install Haskell Stack on Mac?", "body": "<p>I have followed the instructions to install ghcup on my MacOS by following command: </p>\n\n<pre><code>curl https://get-ghcup.haskell.org -sSf | sh \n</code></pre>\n\n<p>But I couldn't install it, it prompted errors like these: </p>\n\n<blockquote>\n  <p>Failed to install, consider updating this script via: ghcup upgrade\n  \"ghcup --cache install\" failed!</p>\n</blockquote>\n"}, {"tags": ["list", "haskell", "zero-padding"], "comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 1, "creation_date": 1574678558, "post_id": 59029656, "comment_id": 104303908, "body": "Look at the implementation of <code>zip</code> at <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6351755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64960c0b1e96532883d72025d19c16a5?s=128&d=identicon&r=PG&f=1", "display_name": "user6351755", "link": "https://stackoverflow.com/users/6351755/user6351755"}, "edited": false, "score": 0, "creation_date": 1574683510, "post_id": 59030230, "comment_id": 104306603, "body": "That answers it. Thank you!"}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1574684895, "last_edit_date": 1574684895, "creation_date": 1574679545, "answer_id": 59030230, "question_id": 59029656, "link": "https://stackoverflow.com/questions/59029656/haskell-merging-a-list-where-even-indices-are-from-list-1-and-odd-are-from-list/59030230#59030230", "title": "Haskell: Merging a list where even indices are from list 1 and odd are from list 2. Fill with 0&#39;s if not the same size", "body": "<p>There is a <code>interleave</code> function, that does something similar, however, not exactly that. It 'merges' lists until one of them ends.</p>\n\n<p>So you can write that function by yourself:</p>\n\n<pre><code>merge :: [Int] -&gt; [Int] -&gt; [Int]\nmerge (x:xs) (y:ys) = x : y : merge xs ys\nmerge (x:xs) [] = x : 0 : merge xs []\nmerge [] (y:ys) = 0 : y : merge [] ys\nmerge _ _ = []\n</code></pre>\n\n<p>When we have some elements on both sides, we take both of them. When one of elements is absent, we take 0 instead of it. In all other cases (it is the <code>merge [] []</code> case) we end up with our recursion and return an empty list.</p>\n\n<p>We can also slightly generalize our function to support any number-like type:</p>\n\n<pre><code>merge :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge (x:xs) (y:ys) = x : y : merge xs ys\nmerge (x:xs) [] = x : 0 : merge xs []\nmerge [] (y:ys) = 0 : y : merge [] ys\nmerge _ _ = []\n</code></pre>\n\n<p>Also, we can go further and use <code>def</code> from <a href=\"http://hackage.haskell.org/package/data-default\" rel=\"nofollow noreferrer\">Data.Default</a> package to get the default value for our type, so we can use this function with not only lists of numbers:</p>\n\n<pre><code>import Data.Default\n\nmerge :: Default a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge (x:xs) (y:ys) = x : y : merge xs ys\nmerge (x:xs) [] = x : def : merge xs []\nmerge [] (y:ys) = def : y : merge [] ys\nmerge _ _ = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1575394035, "creation_date": 1575394035, "answer_id": 59162414, "question_id": 59029656, "link": "https://stackoverflow.com/questions/59029656/haskell-merging-a-list-where-even-indices-are-from-list-1-and-odd-are-from-list/59162414#59162414", "title": "Haskell: Merging a list where even indices are from list 1 and odd are from list 2. Fill with 0&#39;s if not the same size", "body": "<p>Using the idea from <a href=\"https://stackoverflow.com/a/54970785/849891\">this answer</a> of mine, using the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:transpose\" rel=\"nofollow noreferrer\"><code>transpose :: [[a]] -&gt; [[a]]</code></a> function,</p>\n\n<pre><code>interweaveWith :: a -&gt; [a] -&gt; [a] -&gt; [a]\ninterweaveWith def xs ys =\n   -- 0 [1] [10,15,20] =&gt; [1,10,0,15,0,20] \n   concat $\n      zipWith const\n         (transpose [ xs ++ repeat def,      -- no limit, padded with def\n                      ys ++ repeat def ])\n         (transpose [xs, ys])                -- as long as the longest\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6351755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64960c0b1e96532883d72025d19c16a5?s=128&d=identicon&r=PG&f=1", "display_name": "user6351755", "link": "https://stackoverflow.com/users/6351755/user6351755"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 59030230, "answer_count": 2, "score": 0, "last_activity_date": 1575550527, "creation_date": 1574677437, "last_edit_date": 1575550527, "question_id": 59029656, "link": "https://stackoverflow.com/questions/59029656/haskell-merging-a-list-where-even-indices-are-from-list-1-and-odd-are-from-list", "title": "Haskell: Merging a list where even indices are from list 1 and odd are from list 2. Fill with 0&#39;s if not the same size", "body": "<p>i've tried to create a Haskell function that is merging 2 lists into a single list, where even indices in the new list are from list 1 and the odd are from list 2. Fill with 0's if not the same size.</p>\n\n<p>For example: </p>\n\n<pre><code>[1] [10,15,20] =&gt; [1,10,0,15,0,20] \n[2,3] [4,5] =&gt; [2,4,3,5]\n</code></pre>\n\n<p>I've tried to create a couple of versions but with no luck.</p>\n\n<p>How can I create such a thing? </p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "servant"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 1, "last_activity_date": 1574678730, "last_edit_date": 1574678730, "creation_date": 1574677611, "answer_id": 59029704, "question_id": 59028967, "link": "https://stackoverflow.com/questions/59028967/handler-and-monads/59029704#59029704", "title": "Handler and Monads", "body": "<p>This is only a sketch of a solution, but perhaps you'll find these hints useful. <code>Handler</code> is a <code>newtype</code> wrapper around <code>ExceptT ServerError IO a</code>, but sometimes, you may not be able to produce such a type directly.</p>\n\n<p>However, if you have another <code>Monad</code> (like your <code>Persist</code>) you may be able to first define your API using that <code>Monad</code>, and then use <code>hoistServer</code> to translate to <code>ExceptT ServerError IO a</code>.</p>\n\n<p>So, imagine, for example, that you define <code>server</code> with this type:</p>\n\n<pre><code>server :: ServerT API P.Persist\n</code></pre>\n\n<p>You should be able to transform it into a <code>Server</code> and run it like this:</p>\n\n<pre><code>run port $ serve api $ hoistServer api (Handler . trans) $ server\n</code></pre>\n\n<p>where <code>trans</code> is your transformation from <code>P.Persist</code> to <code>ExceptT ServerError IO</code>.</p>\n\n<p>As <a href=\"http://hackage.haskell.org/package/servant-server/docs/Servant-Server.html\" rel=\"nofollow noreferrer\">the documentation</a> of <code>hoistServer</code> says:</p>\n\n<blockquote>\n  <p>Sometimes our cherished Handler monad isn't quite the type you'd like for your handlers.</p>\n</blockquote>\n\n<p>I haven't tried to compile any of my code sketches, so there could be type errors. I don't know what <code>P.Persist</code> is, so I can't repro the issue.</p>\n\n<p>You may alternatively want to define <code>server</code> as</p>\n\n<pre><code>server :: ServerT API (ExceptT ServantErr P.Persist)\n</code></pre>\n\n<p>so that you can use <code>throwError</code> to communicate HTTP (error) status codes. That might also make it easier to write the transformation from <code>ExceptT ServantErr P.Persist</code> to <code>ExceptT ServerError IO</code>, because now you just need to figure out how to transform <code>P.Persist</code> to <code>IO</code>.</p>\n"}], "owner": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 59029704, "answer_count": 1, "score": 2, "last_activity_date": 1574759099, "creation_date": 1574675125, "last_edit_date": 1574759099, "question_id": 59028967, "link": "https://stackoverflow.com/questions/59028967/handler-and-monads", "title": "Handler and Monads", "body": "<p>I'm struggling to compose <a href=\"https://www.servant.dev/\" rel=\"nofollow noreferrer\"><code>Servant</code></a>'s <a href=\"https://hackage.haskell.org/package/servant-server-0.16.2/docs/Servant-Server.html#t:Handler\" rel=\"nofollow noreferrer\"><code>Handler</code></a> and <code>Monad</code>:</p>\n\n<pre><code>class Monad p =&gt; Persist p where\n  data Configuration p :: *\n  runPersistance       :: Configuration p -&gt; p a -&gt; IO a\n  initPersistence      :: p ()\n  newKind              :: Kind -&gt; p NewKindStatus\n  -- ...\n\nkind :: P.Persist p =&gt; KindUid -&gt; KindBody -&gt; p (Handler ())\nkind (KindUid uid) (KindBody actions) = undefined\n\nsubject :: P.Persist p =&gt; KindUid -&gt; SubjectUid -&gt; EventData -&gt; p (Handler EventUid)\nsubject kind subject body = undefined\n\nevent = post :&lt;|&gt; get\nwhere post :: P.Persist p =&gt; KindUid -&gt; SubjectUid -&gt; Action -&gt; EventData -&gt; p (Handler EventUid)\n        post kind subject action body = undefined\n        get :: P.Persist p =&gt; KindUid -&gt; SubjectUid -&gt; p (Handler [Event])\n        get kind subject = undefined\n\nserver :: P.Persist p =&gt; p (Server HermesAPI)\nserver = do\n    k &lt;- kind\n    s &lt;- subject\n    e &lt;- event\n    return $ k :&lt;|&gt; s :&lt;|&gt; e\n\napp :: P.Persist p =&gt; p (Application)\napp = serve hermesAPI server\n</code></pre>\n\n<p>In order to answer to a route I have to use <code>P.Persist</code>, which is <code>Monad</code> doing <code>IO</code>.</p>\n\n<p>I did not found a way to make <code>server</code> compile:</p>\n\n<pre><code>/app/Main.hs:55:3: error:\n    \u2022 Couldn't match type \u2018KindUid\n                        -&gt; SubjectUid -&gt; p0 (Handler [Event])\u2019\n                    with \u2018(KindUid\n                            -&gt; SubjectUid -&gt; Action -&gt; EventData -&gt; Handler EventUid)\n                        :&lt;|&gt; (KindUid -&gt; SubjectUid -&gt; Handler [Event])\u2019\n    Expected type: p (Server HermesAPI)\n        Actual type: p ((KindUid -&gt; KindBody -&gt; Handler ())\n                        :&lt;|&gt; ((KindUid -&gt; SubjectUid -&gt; EventData -&gt; Handler EventUid)\n                            :&lt;|&gt; (KindUid -&gt; SubjectUid -&gt; p0 (Handler [Event]))))\n    \u2022 In a stmt of a 'do' block: k &lt;- kind\n    In the expression:\n        do k &lt;- kind\n        s &lt;- subject\n        e &lt;- event\n        return $ k :&lt;|&gt; s :&lt;|&gt; e\n    In an equation for \u2018server\u2019:\n        server\n            = do k &lt;- kind\n                s &lt;- subject\n                e &lt;- event\n                ....\n   |\n55 |   k &lt;- kind\n   |   ^^^^^^^^^\n\napp/Main.hs:55:8: error:\n    \u2022 Couldn't match type \u2018KindBody\u2019 with \u2018KindUid\u2019\n    Expected type: p (KindUid -&gt; KindBody -&gt; Handler ())\n        Actual type: KindUid -&gt; KindBody -&gt; KindBody -&gt; Handler ()\n    \u2022 In a stmt of a 'do' block: k &lt;- kind\n    In the expression:\n        do k &lt;- kind\n        s &lt;- subject\n        e &lt;- event\n        return $ k :&lt;|&gt; s :&lt;|&gt; e\n    In an equation for \u2018server\u2019:\n        server\n            = do k &lt;- kind\n                s &lt;- subject\n                e &lt;- event\n                ....\n   |\n55 |   k &lt;- kind\n   |        ^^^^\n</code></pre>\n\n<p>Since <code>Handler</code> is already a <code>newtype</code>, I'm stuck.\nHow can I compose <code>Handler</code> and my <code>Monad</code> in order to run it in Servant?</p>\n\n<p><em>Edit:</em></p>\n\n<p>I did a step thanks to <em>Mark Seemann</em>, lifting the <code>Handler</code> in order to leverage <code>ServerT</code>:</p>\n\n<pre><code>newtype LiftHandler p a = LiftHandler (p (Handler a))\nserver :: P.Persist p =&gt; ServerT HermesAPI (LiftHandler p)\nserver = LiftHandler kind :&lt;|&gt; LiftHandler subject :&lt;|&gt; LiftHandler event\n</code></pre>\n\n<p>Leading to:</p>\n\n<pre><code>app/Main.hs:55:22: error:\n    \u2022 Couldn't match type \u2018KindBody -&gt; p2 (Handler ())\u2019\n                    with \u2018Handler a2\u2019\n    Expected type: KindUid -&gt; Handler a2\n        Actual type: KindUid -&gt; KindBody -&gt; p2 (Handler ())\n    \u2022 Probable cause: \u2018kind\u2019 is applied to too few arguments\n        In the first argument of \u2018LiftHandler\u2019, namely \u2018kind\u2019\n        In the first argument of \u2018(:&lt;|&gt;)\u2019, namely \u2018LiftHandler kind\u2019\n        In the expression:\n            LiftHandler kind :&lt;|&gt; LiftHandler subject :&lt;|&gt; LiftHandler event\n   |\n55 | server = LiftHandler kind :&lt;|&gt; LiftHandler subject :&lt;|&gt; LiftHandler event\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["scala", "haskell", "scala-cats"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574661199, "post_id": 59023827, "comment_id": 104296446, "body": "They are pretty much equivalent.  Look at a small state monad example and expand the definitions away until you can&#39;t see any of the State monad vocabulary -- it will look familiar after a little massaging.  It&#39;s mainly a matter of style."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574690776, "post_id": 59023827, "comment_id": 104310611, "body": "The <code>State</code> monad, rather than return a copy of a list, just packages the <i>actions</i> you&#39;ll take on a value. Once you have the entire chain of actions in one place, you provide an initial stack to get back the final stack. <code>State</code> simplifies the type signatures <code>pop :: Stack -&gt; (Int, Stack)</code> and <code>push :: Int -&gt; Stack -&gt; (Stack, ())</code> and takes care of making sure the same stack returned by one action is pass as an argument to the next action."}], "answers": [{"tags": [], "owner": {"reputation": 135502, "user_id": 334519, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf774a4e24c33e4bb6d19ea1939f01a2?s=128&d=identicon&r=PG", "display_name": "Travis Brown", "link": "https://stackoverflow.com/users/334519/travis-brown"}, "is_accepted": false, "score": 11, "last_activity_date": 1574674551, "creation_date": 1574674551, "answer_id": 59028787, "question_id": 59023827, "link": "https://stackoverflow.com/questions/59023827/when-exactly-i-have-to-use-state-monad-or-copy/59028787#59028787", "title": "When exactly I have to use State Monad or .copy?", "body": "<p>You never <em>have</em> to return a <code>State</code> value\u2014it just makes certain kinds of composition possible, which makes certain ways of building your program cleaner.</p>\n\n<p>For topics like this I think starting from a concrete, clearly motivated example is best, and the <a href=\"https://github.com/circe/circe\" rel=\"noreferrer\">Circe JSON library</a> includes some <code>State</code>-based convenience methods for decoding that I think can help to show how <code>State</code> can be useful. For example, suppose we have a Scala case class:</p>\n\n<pre><code>case class User(id: Long, name: String, posts: List[Long])\n</code></pre>\n\n<p>We want to be able to decode JSON documents like this:</p>\n\n<pre><code>val goodDocument = \"\"\"{\"id\": 12345, \"name\": \"Foo McBar\", \"posts\": []}\"\"\"\n</code></pre>\n\n<p>But not ones like this:</p>\n\n<pre><code>val badDocument =\n  \"\"\"{\"id\": 12345, \"name\": \"Foo McBar\", \"posts\": [], \"bad-stuff\": null}\"\"\"\n</code></pre>\n\n<p>If we write out a Circe decoder for <code>User</code> by hand, it will probably look something like this:</p>\n\n<pre><code>implicit val decodeUser: Decoder[User] = Decoder.instance { c =&gt;\n  for {\n    id    &lt;- c.downField(\"id\").as[Long]\n    name  &lt;- c.downField(\"name\").as[String]\n    posts &lt;- c.downField(\"posts\").as[List[Long]]\n  } yield User(id, name, posts)\n}\n</code></pre>\n\n<p>Unfortunately this doesn't meet our requirements\u2014it accepts both documents, because it doesn't keep track of what fields have been decoded already and what fields are left over.</p>\n\n<pre><code>scala&gt; decode[User](goodDocument)\nres0: Either[io.circe.Error,User] = Right(User(12345,Foo McBar,List()))\n\nscala&gt; decode[User](badDocument)\nres1: Either[io.circe.Error,User] = Right(User(12345,Foo McBar,List()))\n</code></pre>\n\n<p>We can fix this by keeping track ourselves and \"deleting\" fields after we see them:</p>\n\n<pre><code>import io.circe.{DecodingFailure, Json}\n\nimplicit val decodeUser: Decoder[User] = Decoder.instance { c =&gt;\n  val idC = c.downField(\"id\")\n\n  def isEmptyObject(json: Json): Boolean = json.asObject.exists(_.isEmpty)\n\n  for {\n    id          &lt;- idC.as[Long]\n    afterIdC     = idC.delete\n    nameC        = afterIdC.downField(\"name\")\n    name        &lt;- nameC.as[String]\n    afterNameC   = nameC.delete\n    postsC       = afterNameC.downField(\"posts\")\n    posts       &lt;- postsC.as[List[Long]]\n    afterPostsC  = postsC.delete\n    _           &lt;- if (afterPostsC.focus.exists(isEmptyObject)) Right(()) else {\n      Left(DecodingFailure(\"Bad fields\", c.history))\n    }\n  } yield User(id, name, posts)\n}\n</code></pre>\n\n<p>Which works great!</p>\n\n<pre><code>scala&gt; decode[User](goodDocument)\nres2: Either[io.circe.Error,User] = Right(User(12345,Foo McBar,List()))\n\nscala&gt; decode[User](badDocument)\nres3: Either[io.circe.Error,User] = Left(DecodingFailure(Bad fields, List()))\n</code></pre>\n\n<p>But the code is a mess, since we have to interleave our logic for keeping track of what's been used through our nice clean <code>Decoder.Result</code>-based <code>for</code>-comprehension.</p>\n\n<p>The way Circe supports decoders that keep track of what fields have been used is based on Cats's <code>StateT</code>. Using these helper methods, you can write the following:</p>\n\n<pre><code>import cats.instances.either._\n\nimplicit val decodeUser: Decoder[User] = Decoder.fromState(\n  for {\n    id    &lt;- Decoder.state.decodeField[Long](\"id\")\n    name  &lt;- Decoder.state.decodeField[String](\"name\")\n    posts &lt;- Decoder.state.decodeField[List[Long]](\"posts\")\n    _     &lt;- Decoder.state.requireEmpty\n  } yield User(id, name, posts)\n)\n</code></pre>\n\n<p>This looks a lot like our original (non-used-field-tracking) implementation, but it works exactly the same way as our second implementation.</p>\n\n<p>We can look at the type of a single operation:</p>\n\n<pre><code>scala&gt; Decoder.state.decodeField[String](\"name\")\nres4: StateT[Decoder.Result,ACursor,String] = ...\n</code></pre>\n\n<p>Which is a kind of wrapper for the following:</p>\n\n<pre><code>ACursor =&gt; Decoder.Result[(ACursor, Long)]\n</code></pre>\n\n<p>This is basically combining the <code>afterIdC.downField(\"name\")</code>, <code>nameC.delete</code>, and <code>nameC.as[String]</code> lines from our verbose implementation above, but encapsulating them in a single operation that we can use in a <code>for</code>-comprehension.</p>\n\n<p>Calling <code>copy</code> on a case class to get an updated value is of course perfectly fine, and most of the time it's exactly what you want. You shouldn't complicate your code with <code>State</code> unless you're sure it's adding value, and it's most likely to add value when you find yourself threading calls to <code>copy</code> and assignments through some other kind of operation, like we saw with field-use tracking and decoding above.</p>\n"}], "owner": {"reputation": 1334, "user_id": 1447456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/606d9f69e64fa4eddea4bada8802f7f2?s=128&d=identicon&r=PG", "display_name": "Francisco Albert", "link": "https://stackoverflow.com/users/1447456/francisco-albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1574674551, "creation_date": 1574642151, "question_id": 59023827, "link": "https://stackoverflow.com/questions/59023827/when-exactly-i-have-to-use-state-monad-or-copy", "title": "When exactly I have to use State Monad or .copy?", "body": "<p>I saw an example in a book of haskell in which is created a simple stack (push, pop) and return monad states all the time they update the stack using .put(..) or .pop(). </p>\n\n<p>As a reminder the example looks similar to this:</p>\n\n<pre><code>pop :: State Stack Int  \npop = State $ \\(x:xs) -&gt; (x,xs)  \n\npush :: Int -&gt; State Stack ()  \npush a = State $ \\xs -&gt; ((),a:xs) \n</code></pre>\n\n<p>It makes sense, but after seeing this example I started to wonder about my domain entities (let's say Customer). For now i'm just using .copy() to return a new updated-Customer everytime i want to update something on it (like the age) like is pointed in many docs, not using any State monad. The way I use .copy() has nothing special:</p>\n\n<pre><code>case class Customer(age: Int, name: String) {\n   def updateAge(newAge: Int): Customer = {\n       this.copy(age = newAge)\n   }\n}\n</code></pre>\n\n<p>However I'm staring to think that rather than returning just an updated-copy i have to return an State Monad, but I didn't see any example like this so far (I'm learning on my own), and because of that I feel confuse. <strong>I have the impression that .copy() is used sometimes and State Monad is used in other different cases, however both manage State.....</strong></p>\n\n<p>Should I return an State Monad everytime I update the age of a Customer?</p>\n"}, {"tags": ["function", "variables", "haskell", "testing", "compiler-errors"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574637501, "post_id": 59023293, "comment_id": 104291770, "body": "Unrelated to the problem at hand, but testing <code>length _ &gt;= 0</code> is pointless."}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574637835, "post_id": 59023293, "comment_id": 104291833, "body": "yeah, i understand, that`s just a sample"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "is_accepted": true, "score": 0, "last_activity_date": 1574637928, "creation_date": 1574637928, "answer_id": 59023429, "question_id": 59023293, "link": "https://stackoverflow.com/questions/59023293/compiler-aborts-tests/59023429#59023429", "title": "Compiler aborts tests", "body": "<p>The problem is solved by defining certain functions as Int instead of any type of functions 'a'.</p>\n\n<pre><code>&gt; prop_unzip_check :: [(Int,Int)] -&gt; Bool\n&gt; prop_unzip_check xs = length (unzip (xs::[(Int,Int)])) &gt;= 0\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 59023429, "answer_count": 1, "score": 0, "last_activity_date": 1574674272, "creation_date": 1574636589, "last_edit_date": 1574674272, "question_id": 59023293, "link": "https://stackoverflow.com/questions/59023293/compiler-aborts-tests", "title": "Compiler aborts tests", "body": "<p>I have tried to specify variables in functions, but it didn't help.</p>\n\n<p>functions: </p>\n\n<pre><code>prop_unzip_check :: forall a b. Ord a =&gt; [(a,b)] -&gt; Bool\nprop_unzip_check xs = length (unzip (xs::[(a,b)])) &gt;= 0\n\nprop_merge_check :: forall a. Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nprop_merge_check xs ys = length (merge (xs::[a]) (ys::[a]))\n                           == length (sort ((xs::[a]) ++ (ys::[a])))\n</code></pre>\n\n<p>And after compiling I receive this confusing error:</p>\n\n<pre><code>&gt; Test property \"prop_merge_check\" ... aborted.\nReason: Ambiguous type variable `a0' arising from a use of `quickCheckBool'\nprevents the constraint `(Arbitrary a0)' from being solved.\nProbable fix: use a type annotation to specify what `a0' should be.\nThese potential instances exist:\n  instance Arbitrary QCGen -- Defined in `Test.QuickCheck.Arbitrary'\n  instance Arbitrary (a b c) =&gt; Arbitrary (WrappedArrow a b c)\n    -- Defined in `Test.QuickCheck.Arbitrary'\n  instance Arbitrary (m a) =&gt; Arbitrary (WrappedMonad m a)\n    -- Defined in `Test.QuickCheck.Arbitrary'\n  ...plus 80 others\n  (use -fprint-potential-instances to see them all)\nAmbiguous type variable `a0' arising from a use of `prop_merge_check'\nprevents the constraint `(Ord a0)' from being solved.\nProbable fix: use a type annotation to specify what `a0' should be.\nThese potential instances exist:\n  instance Ord (Encoding' a)\n    -- Defined in `Data.Aeson.Encoding.Internal'\n  instance Ord DotNetTime -- Defined in `Data.Aeson.Types.Internal'\n  instance Ord JSONPathElement\n    -- Defined in `Data.Aeson.Types.Internal'\n  ...plus 310 others\n  (use -fprint-potential-instances to see them all)\n</code></pre>\n"}, {"tags": ["function", "haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574633775, "post_id": 59022885, "comment_id": 104290975, "body": "We can quantify multiple variables at a time; I added that solution to my answer now as well."}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574633934, "post_id": 59022885, "comment_id": 104291004, "body": "deleted previous comment by a mistake ;c"}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574634614, "post_id": 59022885, "comment_id": 104291178, "body": "but I am still receiving one kind of error from compiler, I am going to create another question, will you take a look please ?"}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574635954, "post_id": 59022885, "comment_id": 104291456, "body": "I&#39;m not seeing any other questions from you at the moment; are you sure you submitted it?"}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574636082, "post_id": 59022885, "comment_id": 104291480, "body": "it says only one post per 1.30h is alowed, so im waiting :c . maybe i can somehow write directly to you here? im really new in here"}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574636249, "post_id": 59022885, "comment_id": 104291521, "body": "If it&#39;s really a different topic, best to just wait it out. You can ping me in the comments here when it&#39;s up."}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "reply_to_user": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1574636289, "post_id": 59022885, "comment_id": 104291535, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/202993/discussion-between-osobennyj-and-chris-penner\">continue this discussion in chat</a>."}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574636670, "post_id": 59022885, "comment_id": 104291612, "body": "Now you can check it out!"}], "tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": true, "score": 6, "last_activity_date": 1574633733, "last_edit_date": 1574633733, "creation_date": 1574633075, "answer_id": 59022885, "question_id": 59022609, "link": "https://stackoverflow.com/questions/59022609/declare-type-of-function-in-a-function/59022885#59022885", "title": "Declare type of function in a function", "body": "<p>This is a side-effect of Haskell's implicit forall's. Haskell automatically adds 'forall's to all type signatures as necessary, these act as \"scoping\" rules which limit the names to a particular area. Haskell interprets your signature as:</p>\n\n<pre><code>prop_merge_check :: forall a. Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nprop_merge_check xs ys =\n    length (merge (xs::forall a. [a]) (ys:: forall a. [a])) == (length (sort ((xs:: forall a. [a]) ++ (ys:: forall a. [a]))))\n</code></pre>\n\n<p>That is; it sees every <code>a</code> in every signature as a completely different variable! That's why it can't make the types work properly. This is an annoying and unobvious quirk, but there's a way around it.</p>\n\n<p>If we enable the <code>ScopedTypeVariables</code> and provide an <em>explicit</em> forall in the type signature we tell Haskell that we want the scope of the type variables to span the whole function body:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n-- ^ Put that at the top of your module\n\nprop_merge_check :: forall a. Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nprop_merge_check xs ys =\n    length (merge (xs::[a]) (ys::[a])) == (length (sort ((xs::[a]) ++ (ys::[a]))))\n</code></pre>\n\n<p>This version should compile, because now the <code>a</code> in all signatures is considered the <em>same</em>. We can quantify more than one type variable at a time:</p>\n\n<pre><code>prop_unzip_check :: forall a b. Ord a =&gt; [(a,b)] -&gt; Bool\nprop_unzip_check xs = length (unzip (xs::[(a,b)])) &gt;= 0\n</code></pre>\n\n<p>Unfortunately there's not currently an easy way to do this sort of thing without adding the explicit forall in the top-level signature, but there are a few proposals for changes to this behaviour. They likely won't be coming any time soon though; so I wouldn't hold your breath.</p>\n\n<p>Good luck! You can look up the docs on ScopedTypeVariables and ExistentialQuantification to learn more about this quirk.</p>\n"}], "owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 59022885, "answer_count": 1, "score": 3, "last_activity_date": 1574674398, "creation_date": 1574631001, "last_edit_date": 1574674398, "question_id": 59022609, "link": "https://stackoverflow.com/questions/59022609/declare-type-of-function-in-a-function", "title": "Declare type of function in a function", "body": "<p>I have two functions:</p>\n\n<pre><code>prop_merge_check :: Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nprop_merge_check xs ys = length (merge xs ys) == length (sort (xs ++ ys))\n\nprop_unzip_check :: Ord a =&gt; [(a,b)] -&gt; Bool\nprop_unzip_check xs = length (unzip xs) &gt;= 0\n</code></pre>\n\n<p>How can I declare the types of function in a function itself? </p>\n\n<p>I tried this way, but it didn't work out for me.</p>\n\n<pre><code>prop_merge_check xs ys = length (merge (xs::[a]) (ys::[a])) \n                           == length (sort ( (xs::[a]) ++ (ys::[a]) ))\n\nprop_unzip_check xs = length (unzip (xs::[(a,b)])) &gt;= 0\n</code></pre>\n"}, {"tags": ["list", "haskell", "replace", "find", "tuples"], "comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1574628513, "post_id": 59022000, "comment_id": 104289675, "body": "I would guess you are allowed to assume that the outer edges of the area are outside all of the shapes and proceed from there.  (It will need a more complicated algorithm than just a map.)"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1574675756, "post_id": 59022000, "comment_id": 104302294, "body": "You are asking for a kind of flood fill algorithm. It might be wise to convert the List into a Matrix or 2D Vector or Array type first... If you google Haskell flood fill you can find a few articles."}], "answers": [{"comments": [{"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1574630050, "post_id": 59022461, "comment_id": 104290040, "body": "@NonAlcoholicVodka Let me if the foldl example makes sense and if you need more resources to understand fold."}, {"owner": {"reputation": 41, "user_id": 10685445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b97ae9fdce5e2da55e4968c3925fa0c?s=128&d=identicon&r=PG&f=1", "display_name": "NonAlcoholicVodka", "link": "https://stackoverflow.com/users/10685445/nonalcoholicvodka"}, "edited": false, "score": 0, "creation_date": 1574664607, "post_id": 59022461, "comment_id": 104297517, "body": "Thank you, foldl definitely enriched me in Haskell, but I couldn&#39;t think of a way to use it in my final solution :/"}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1574630017, "creation_date": 1574630017, "answer_id": 59022461, "question_id": 59022000, "link": "https://stackoverflow.com/questions/59022000/haskell-how-to-know-if-point-is-inside-shape/59022461#59022461", "title": "Haskell: How to &quot;know&quot; if point is inside shape?", "body": "<p>The <code>map</code> function probably won't be enough because the function does not know anything about the previous values it has iterated over.</p>\n\n<p>Think about how you would do this in a language like Python. You would probably have some variable that keeps track of the state of whether or not you are in a shape, then decide whether it should convert <code>.</code> to <code>*</code> or leave it as is.</p>\n\n<p>I think the function <code>foldl</code> will help you. It gives you access to an initial value which you can change over time.</p>\n\n<p>I'll make a slightly related example. Add one to everything in a list as long as you have not seen a zero yet or it is zero.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; snd $ foldl (\\(seenZero,xs) a -&gt; (if seenZero then True else a == 0, if seenZero || a == 0 then xs++[a] else xs++[a+1])) (False,[]) [1,2,3,4,0,1,2]\n[2,3,4,5,0,1,2]\n</code></pre>\n\n<p>Here are some references.</p>\n\n<ul>\n<li><a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl&#39;\" rel=\"nofollow noreferrer\">Haskell Wiki - Foldr Foldl Foldl'</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Fold_%28higher-order_function%29\" rel=\"nofollow noreferrer\">Wikipedia - Fold</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 10685445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b97ae9fdce5e2da55e4968c3925fa0c?s=128&d=identicon&r=PG&f=1", "display_name": "NonAlcoholicVodka", "link": "https://stackoverflow.com/users/10685445/nonalcoholicvodka"}, "edited": false, "score": 0, "creation_date": 1574664677, "post_id": 59023149, "comment_id": 104297537, "body": "The homeworks specifies only one input, so I could technically just create a list of points that have to be inside that shape by hand, but I don&#39;t think that&#39;s the proper solution :D"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1574635584, "last_edit_date": 1574635584, "creation_date": 1574635279, "answer_id": 59023149, "question_id": 59022000, "link": "https://stackoverflow.com/questions/59022000/haskell-how-to-know-if-point-is-inside-shape/59023149#59023149", "title": "Haskell: How to &quot;know&quot; if point is inside shape?", "body": "<p>I don't think this can be done in general, at least not without more information or assumptions about the shapes that are present.  If the shapes are allowed to be arbitrary, how do you know you are looking at overlapping</p>\n\n<pre><code>      #####      ############\n     ##   ##     #          #\n    ##     ##    #          #\n    #       #    #          #\n    #       #    #          #\n    ##     ##    #          #\n     ##   ##     ############\n      #####\n</code></pre>\n\n<p>Rather than non-overlapping</p>\n\n<pre><code>      #####          ########\n     ##   ##         #      #\n    ##     ##       ##      #\n    #   #####      ##       #\n    #   #        ###        #\n    ##  #        #          #\n     ## #        ############\n      ###\n</code></pre>\n\n<p>These two interpretations will lead to different colorings of the intersection.  But, it seems, we have no rule about which interpretation we should choose.</p>\n\n<p>Does the homework specify that there will always be two shapes, one square and one circle, or something like that? </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10685445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b97ae9fdce5e2da55e4968c3925fa0c?s=128&d=identicon&r=PG&f=1", "display_name": "NonAlcoholicVodka", "link": "https://stackoverflow.com/users/10685445/nonalcoholicvodka"}, "is_accepted": true, "score": 3, "last_activity_date": 1574664522, "creation_date": 1574664522, "answer_id": 59026539, "question_id": 59022000, "link": "https://stackoverflow.com/questions/59022000/haskell-how-to-know-if-point-is-inside-shape/59026539#59026539", "title": "Haskell: How to &quot;know&quot; if point is inside shape?", "body": "<p>Thank you all for your time, I've gone to sleep yesterday and right before I fell asleep I thought of solution, today I tried it and it works.<br>\nIt doesn't account for two shapes having gap between them, but input will remain same, so I won't bother with that.<br>\nI created new function, that returns list of tuples (row,col) -> those points are inside some shape.<br>\nI use these points in fillTuple instead of notCharInShape function, which I deleted.  </p>\n\n<p>I will paste that function's code here for anyone that might encounter similar issue. <code>calculateNotFilledPositions _ [] = []\ncalculateNotFilledPositions row (xs:input) = [(row, col) | col &lt;- [(fromMaybe (-1) (elemIndex '#' xs))..(length xs - (fromMaybe (-1) (elemIndex '#' (reverse xs)))) - 1], elem '#' xs] ++ calculateNotFilledPositions (row + 1) input</code>  </p>\n\n<p>What this function does is it basically goes over every line of input and find first index of '#' and last index of '#' and says that everything between must not be filled.<br>\nThis may not be ideal, I am beginner in Haskell and functional programming in general, so if anyone wants to point out anything, feel free, I am always striving to be better :)</p>\n"}, {"comments": [{"owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "edited": false, "score": 0, "creation_date": 1574694543, "post_id": 59034743, "comment_id": 104312645, "body": "Ok there are possible shapes where this solution does not work."}], "tags": [], "owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1574714345, "last_edit_date": 1574714345, "creation_date": 1574694390, "answer_id": 59034743, "question_id": 59022000, "link": "https://stackoverflow.com/questions/59022000/haskell-how-to-know-if-point-is-inside-shape/59034743#59034743", "title": "Haskell: How to &quot;know&quot; if point is inside shape?", "body": "<p>When you walk up, down, left and right from a given point and you meet a <code>#</code> on every side... the point is in a shape.</p>\n\n<pre><code>[ \"                    \",\n  \"                    \",\n  \"    #####           \",\n  \"   ##   ##          \",\n  \"  ##     ##         \",\n  \"  #       #         \",\n  \"  #   X   #         \",\n  \"  #       #         \",\n  \"  ##     ##         \",\n  \"   ##   ##          \",\n  \"    #####           \",\n  \"                    \",\n</code></pre>\n\n<p>you know now the x and y coordinate of a given point and so you can check all lines before and after to check if the y is \"inside\" the shape. And every char before and after to check the x is \"inside\" the shape. If all conditions are true your point is in the shape.</p>\n\n<pre><code>[ \"                    \",\n  \"                    \",\n  \"    #(#)#           \",\n  \"   ##   ##          \",\n  \"  ##     ##         \",\n  \"  #       #         \",\n  \" (#)  X  (#)        \",\n  \"  #       #         \",\n  \"  ##     ##         \",\n  \"   ##   ##          \",\n  \"    #(#)#           \",\n  \"                    \",\n</code></pre>\n\n<p>or </p>\n\n<pre><code>[\"                    \",\n\"                    \",\n\"    #####           \",\n\"   ##   ##          \",\n\"  ##     ##         \",\n\"  #       #         \",\n\"  #   #(#)########  \",\n\"  #  (#)X(#)     #  \",\n\"  ##  #  ##      #  \",\n\"   ## #(#)       #  \",\n\"    #####        #  \",\n\"      #          #  \",\n\"      ############  \",\n\"                    \",\n\"                    \"]\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10685445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b97ae9fdce5e2da55e4968c3925fa0c?s=128&d=identicon&r=PG&f=1", "display_name": "NonAlcoholicVodka", "link": "https://stackoverflow.com/users/10685445/nonalcoholicvodka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 59026539, "answer_count": 4, "score": 0, "last_activity_date": 1574714345, "creation_date": 1574626842, "last_edit_date": 1574675321, "question_id": 59022000, "link": "https://stackoverflow.com/questions/59022000/haskell-how-to-know-if-point-is-inside-shape", "title": "Haskell: How to &quot;know&quot; if point is inside shape?", "body": "<p>I am currently working on a h<strong>omework</strong> for my Haskell class and I seem to have hit a dead-end.<br>\nI have this List of Strings<br>\n<code>[\"....................\",\n  \"....................\",\n  \"....#####...........\",\n  \"...##...##..........\",\n  \"..##.....##.........\",\n  \"..#.......#.........\",\n  \"..#...############..\",\n  \"..#...#...#......#..\",\n  \"..##..#..##......#..\",\n  \"...##.#.##.......#..\",\n  \"....#####........#..\",\n  \"......#..........#..\",\n  \"......############..\",\n  \"....................\",\n  \"....................\"]</code></p>\n\n<p>And I have to <strong>replace</strong> every '.' with '*' and ignore '.', that are inside shapes.<br>\nI currently do this:</p>\n\n<ol>\n<li>Convert that List of String to a <strong>List of tuples</strong> in this format - (Row, Col, Char)</li>\n<li>Apply <strong>map</strong> to this new List and create new List with succesfully replaced chars</li>\n</ol>\n\n<p><strong>Map function</strong> looks like this<br>\n  <code>fillTuple tupleList = map(\\(row, col, char) -&gt; if notCharInShape tupleList (row,col) &amp;&amp; char /= '#' then (row,col,'*') else (row,col,char)) tupleList\n</code><br>\n<strong>notCharInShape</strong> (for the time being) looks like this<br>\n<code>notCharInShape tupleList (row,col) = True\n</code><br>\nI now struggle to find a way to \"know\" if given point is inside the shape. I tried googling for mathematical equations that tell if given point is inside circle, or rectangle, but I would first have to know x,y points of center and radius of the circle, which I don't.</p>\n\n<p>Am I missing something, or is there really no way to tell if point is inside shape, if the shapes center, radius is unknown?</p>\n"}, {"tags": ["c#", "scala", "haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 14798, "user_id": 4111404, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-kzPWJe4orps/AAAAAAAAAAI/AAAAAAAAABE/L-IQwWBiNJU/photo.jpg?sz=128", "display_name": "Luis Miguel Mej&#237;a Su&#225;rez", "link": "https://stackoverflow.com/users/4111404/luis-miguel-mej%c3%ada-su%c3%a1rez"}, "edited": false, "score": 9, "creation_date": 1574618108, "post_id": 59020587, "comment_id": 104286811, "body": "Yes it is a common transformation it is called <code>sequence</code> it has the following signature <code>sequence[F[_] : Traverse, G[_] : Applicative, A](fga: F[G[A]]): G[F[A]]</code> <i>(signature provided in <b>Scala</b>)</i>. It seems you need it in <b>C#</b>, I do not know if it has it, but at least you already know what to search for."}, {"owner": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "reply_to_user": {"reputation": 14798, "user_id": 4111404, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-kzPWJe4orps/AAAAAAAAAAI/AAAAAAAAABE/L-IQwWBiNJU/photo.jpg?sz=128", "display_name": "Luis Miguel Mej&#237;a Su&#225;rez", "link": "https://stackoverflow.com/users/4111404/luis-miguel-mej%c3%ada-su%c3%a1rez"}, "edited": false, "score": 0, "creation_date": 1574618360, "post_id": 59020587, "comment_id": 104286887, "body": "Thanks @LuisMiguelMej&#237;aSu&#225;rez! Very interesting. I&#39;ve done some Scala so will investigate."}, {"owner": {"reputation": 14798, "user_id": 4111404, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-kzPWJe4orps/AAAAAAAAAAI/AAAAAAAAABE/L-IQwWBiNJU/photo.jpg?sz=128", "display_name": "Luis Miguel Mej&#237;a Su&#225;rez", "link": "https://stackoverflow.com/users/4111404/luis-miguel-mej%c3%ada-su%c3%a1rez"}, "edited": false, "score": 3, "creation_date": 1574618436, "post_id": 59020587, "comment_id": 104286909, "body": "Note, if you end up with that collection of options after a <code>map</code>, instead of calling <code>map</code> and then <code>sequence</code> you can use <code>traverse</code> instead. <code>traverse[F[_] : Traverse, G[_] : Applicative, A, B](fa: F[A])(f: A =&gt; G[B]): G[F[B]]</code> it follows the following equality <code>sequence(fga) === traverse(fga)(identity)</code> Thus, you can conclude that <code>sequence(map(fa)(f)) === traverse(fa)(f)</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1574618510, "post_id": 59020587, "comment_id": 104286942, "body": "I&#39;m not familiar with the other languages tagged here, but this is also called <code>sequence</code> in Haskell - or <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sequenceA\" rel=\"nofollow noreferrer\">sequenceA</a> for the most general form which works over any <code>Traversable</code> holding <code>Applicative</code> values."}, {"owner": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 0, "creation_date": 1574618591, "post_id": 59020587, "comment_id": 104286968, "body": "Cool, <code>sequence</code> and <code>traverse</code>. Looks like I have a good starting point for my investigations. Thanks guys!"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 0, "creation_date": 1574618255, "post_id": 59020709, "comment_id": 104286854, "body": "Yes, i&#39;m using that exact library! My question still stands, is there an existing named method in the language-ext library which does this transformation?"}, {"owner": {"reputation": 1771, "user_id": 3602352, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b39efbf02bc03904e95ced949e0bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Aly Elhaddad", "link": "https://stackoverflow.com/users/3602352/aly-elhaddad"}, "reply_to_user": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 0, "creation_date": 1574618430, "post_id": 59020709, "comment_id": 104286907, "body": "I cannot tell for sure; but these transformations, I guess, could easily be implemented using <code>System.Linq</code>&#39;s <code>Select</code>, <code>All</code>, and <code>Any</code>."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1574670027, "post_id": 59020709, "comment_id": 104299497, "body": "It does have <code>Somes</code> (<a href=\"https://louthy.github.io/language-ext/LanguageExt.Core/OptionExtensions_.htm#Somes%3CA%3E\" rel=\"nofollow noreferrer\">louthy.github.io/language-ext/LanguageExt.Core/&hellip;</a>), which is the other way around and could technically be used to implement what you want but inefficiently."}], "tags": [], "owner": {"reputation": 1771, "user_id": 3602352, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b39efbf02bc03904e95ced949e0bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Aly Elhaddad", "link": "https://stackoverflow.com/users/3602352/aly-elhaddad"}, "is_accepted": false, "score": 2, "last_activity_date": 1574618157, "creation_date": 1574618157, "answer_id": 59020709, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont/59020709#59020709", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>These language constructs are <em>not</em> initially presented in C#; however, there're multiple functional programming libraries out there for such purposes. My choice would be Paul Louth's <a href=\"https://github.com/louthy/language-ext\" rel=\"nofollow noreferrer\">language-ext</a>; the richest FP library I've found for C# so far.</p>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 0, "creation_date": 1574619896, "post_id": 59020758, "comment_id": 104287358, "body": "I&#39;m fine with F# too :) From your example, you say that from <code>[Some 1; Some 2; None]</code> I would end up with <code>Some {1;2}</code>, but this is not want I wanted. I would want in this example a <code>None</code> as there is at least 1 None in the collection."}, {"owner": {"reputation": 4969, "user_id": 2225808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0741ac4ae6202ca572d49d64395db?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/2225808/stuart"}, "reply_to_user": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 0, "creation_date": 1574620024, "post_id": 59020758, "comment_id": 104287401, "body": "D&#39;oh, pretty important misread! Do you mind if the source is enumerated more than once?"}, {"owner": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 2, "creation_date": 1574620171, "post_id": 59020758, "comment_id": 104287444, "body": "Well I could implement the method myself without too much issue. I was mainly trying to find out if this was a standard functional construct and would be available in core libraries, and what it&#39;s name would be. From the answers above it seems to be <code>sequence</code> and <code>traverse</code>. Now just need to check if the equivalents are available in F# etc and if I have to write my own implementation, what to name it."}, {"owner": {"reputation": 4969, "user_id": 2225808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0741ac4ae6202ca572d49d64395db?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/2225808/stuart"}, "reply_to_user": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "edited": false, "score": 0, "creation_date": 1574620439, "post_id": 59020758, "comment_id": 104287531, "body": "Ah, I get you. I&#39;ve updated my answer, but no, I don&#39;t know of a standard function to do this, so cannot help with naming (naming is hard by the way!)"}], "tags": [], "owner": {"reputation": 4969, "user_id": 2225808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0741ac4ae6202ca572d49d64395db?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/2225808/stuart"}, "is_accepted": false, "score": 1, "last_activity_date": 1574620848, "last_edit_date": 1574620848, "creation_date": 1574618465, "answer_id": 59020758, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont/59020758#59020758", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>As you say you don't mind the language, I have an example here using F#, which has <code>Option&lt;T&gt;</code> out of the box:</p>\n\n<pre><code>let chooseAll source =\n    let anyNone = source |&gt; Seq.exists Option.isNone\n    if anyNone then None else Some source\n\nlet s = [Some 1; Some 2; None]\nlet result1 = s |&gt; chooseAll // None\nlet s = [Some 4; Some 5]\nlet result2 = s |&gt; chooseAll // Some {4;5}\n</code></pre>\n\n<p>If you are unfamiliar with F#, <code>Seq</code> is a type alias for <code>IEnumerable&lt;T&gt;</code>. Here <code>chooseAll</code> has the signature <code>seq&lt;'a option&gt; -&gt; seq&lt;'a&gt; option</code>, which translating to a C# friendly syntax is <code>IEnumerable&lt;Option&lt;T&gt;&gt; -&gt; Option&lt;IEnumerable&lt;T&gt;&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1574621025, "creation_date": 1574621025, "answer_id": 59021141, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont/59021141#59021141", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>There's more than one 'language family' of functional programming concepts.</p>\n\n<p>In Haskell (and, apparently, Scala) this is called <code>sequence</code> and is part of an abstraction or type class called <a href=\"http://hackage.haskell.org/package/base/docs/Data-Traversable.html\" rel=\"nofollow noreferrer\">Traversable</a>; <code>sequence</code> is a special case of a traversal.</p>\n\n<p>Other language famiilies exist, most notably ML. This is the where the term <code>Option</code> comes from (which in Haskell is called <code>Maybe</code>). While I'm well-versed in F# (which is one ML dialect), I'm not aware that <em>traverse/sequence</em> has an established terminology there.</p>\n"}, {"comments": [{"owner": {"reputation": 4969, "user_id": 2225808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0741ac4ae6202ca572d49d64395db?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/2225808/stuart"}, "edited": false, "score": 0, "creation_date": 1574644552, "post_id": 59022873, "comment_id": 104293051, "body": "That looks allsome \ud83d\ude09"}], "tags": [], "owner": {"reputation": 727, "user_id": 2841855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9ccba423214dfd8055b5f8685ee0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Cosmin Sontu", "link": "https://stackoverflow.com/users/2841855/cosmin-sontu"}, "is_accepted": false, "score": 0, "last_activity_date": 1574632977, "creation_date": 1574632977, "answer_id": 59022873, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont/59022873#59022873", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>You can roll your own extension method that relies on available primitives from System.Linq namespace: </p>\n\n<pre><code>public static Option&lt;IEnumerable&lt;T&gt;&gt; AllSome&lt;T&gt;(this IEnumerable&lt;Option&lt;T&gt;&gt; input)\n            where T : class\n            =&gt; (input.All(o =&gt; o.IsSome)) ?\n                new Some&lt;IEnumerable&lt;T&gt;&gt;(input.Select(o =&gt; (o as Some&lt;T&gt;).Value)) :\n                new None&lt;IEnumerable&lt;T&gt;&gt;() as Option&lt;IEnumerable&lt;T&gt;&gt;;\n</code></pre>\n\n<p>This is based on a throwaway implementation of Option type that I wrote to support this example, feel free to adjust to your flavour of Option:</p>\n\n<pre><code>public class Option&lt;T&gt;\n    where T: class\n{\n    protected T value;\n    public bool IsSome =&gt; value != default(T);\n}\n\npublic class Some&lt;T&gt; : Option&lt;T&gt;\n    where T: class\n{\n    public Some(T value) =&gt; base.value = value;\n    public T Value =&gt; base.value;\n}\n\npublic class None&lt;T&gt; : Option&lt;T&gt;\n    where T: class\n{\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1530, "user_id": 227606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3ce007486db68908d145951bef649a?s=128&d=identicon&r=PG", "display_name": "Piotr Rodak", "link": "https://stackoverflow.com/users/227606/piotr-rodak"}, "is_accepted": false, "score": 0, "last_activity_date": 1574702316, "creation_date": 1574702316, "answer_id": 59037018, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont/59037018#59037018", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>I played with this a bit and it seems like f# fold and foldBack might be of use in this case. Here are some samples:</p>\n\n<pre><code>let l1 = [Some 1; Some 2; None]\nlet l2 = [Some 3; Some 4; Some 5]\n\n\nlet acc (ac: int list option) le = \n    match ac, le with\n    | Some ac, Some le -&gt; Some (le::ac)\n    | _, _ -&gt; None\n\n//this will reverse the order of elements if all present\nlet r1 = l1 |&gt; List.fold acc (Some [])\nlet r2 = l2 |&gt; List.fold acc (Some [])\n\n//the order of elements preserved\nlet acc2 le (ac: int list option) = acc ac le\nlet r3 = List.foldBack acc2 l1 (Some [])\nlet r4 = List.foldBack acc2 l2 (Some [])\n\n//or...\nlet r3b = l1 |&gt; List.foldBack acc2 &lt;| (Some [])\nlet r4b = l2 |&gt; List.foldBack acc2 &lt;| (Some [])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1240, "user_id": 3384830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oOUj.jpg?s=128&g=1", "display_name": "louthster", "link": "https://stackoverflow.com/users/3384830/louthster"}, "is_accepted": false, "score": 2, "last_activity_date": 1576105816, "creation_date": 1576105816, "answer_id": 59295508, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont/59295508#59295508", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>Language-ext author here, you simply need to call <code>.Sequence()</code> to reverse the inner and outer monads:</p>\n\n<pre><code>IEnumerable&lt;Option&lt;int&gt;&gt; items = ...;\n\nOption&lt;IEnumerable&lt;int&gt;&gt; result = items.Sequence();\n</code></pre>\n\n<p>It has the exact behaviour you're looking for of returning <code>None</code> if any item in the sequence is <code>None</code>, and <code>Some</code> otherwise.</p>\n\n<p>You can also use <code>.Traverse(...)</code> to map the results as you go.</p>\n"}], "owner": {"reputation": 429, "user_id": 2080351, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5478c5cdb80383ed0c33f09e53b800ed?s=128&d=identicon&r=PG", "display_name": "Martin Cooper", "link": "https://stackoverflow.com/users/2080351/martin-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 6, "score": 3, "last_activity_date": 1576105816, "creation_date": 1574617434, "last_edit_date": 1574621092, "question_id": 59020587, "link": "https://stackoverflow.com/questions/59020587/functional-transformation-of-a-collection-of-optiont", "title": "Functional Transformation of a collection of Option&lt;T&gt;", "body": "<p>I have a collection of <code>Option&lt;T&gt;</code> instances and want to transform from <code>IEnumerable&lt;Option&lt;T&gt;&gt;</code> to <code>Option&lt;IEnumerable&lt;T&gt;&gt;</code></p>\n\n<p>If <strong>ALL</strong> the options have a value, then I want a <code>Some&lt;IEnumerable&lt;T&gt;&gt;</code> with the collected values, if <strong>ANY</strong> of the items in the collection are <code>None</code>, then I want a <code>None&lt;IEnumerable&lt;T&gt;&gt;</code></p>\n\n<p>This seems like it would be quite a common functional transformation, but i'm not sure if it exists in mainstream functional libraries, or what it would be called. Seems similar to <code>FlatMap</code>, but not quite, as I don't want to just filter out the <code>None</code> values.</p>\n\n<p>I could implement it myself, but would like to find out if it exists already as a functional construct. Don't mind what language, C#, Scala, Haskell etc.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574615837, "post_id": 59020267, "comment_id": 104286145, "body": "You are treating <code>if</code> as a statement; just because it is in a <code>do</code> block doesn&#39;t mean the expression following <code>then</code> can consist of a sequence of expressions."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574615887, "post_id": 59020267, "comment_id": 104286162, "body": "You also can&#39;t use <code>rotatespecific</code> to &quot;update&quot; the value of <code>result</code>."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 2, "creation_date": 1574615895, "post_id": 59020267, "comment_id": 104286168, "body": "There&#39;s several things wrong besides your parse error. What do you think <code>()</code> is?"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1574625713, "post_id": 59020603, "comment_id": 104288996, "body": "I changed that, but now it says that with a lot functions the input parameters aren&#39;t of the right type, for example: Couldn&#39;t match expected type <code>[Char]&#39; with actual type </code>Char -&gt; [Char]&#39;. I don&#39;t know what went wrong there because I thought they were the right ones.  And it said my input couldnt be tranformed into a Int when I used x &lt;- read getLine :: Int now i use xr &lt;- getLine let x = read xr :: Int, but i don&#39;t know why that does work"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1574628626, "post_id": 59020603, "comment_id": 104289693, "body": "@JoesdeJonge that error message is usually because you have called a function with the wrong number of arguments.  The other question has to do with the way Haskell models I/O; when you start reading about monads this will be discussed.  To whet your curiosity, to do it a single line you would say <code>x &lt;- read &lt;$&gt; getLine</code>."}, {"owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1574630341, "post_id": 59020603, "comment_id": 104290116, "body": "I&#39;ve now added my current version to the main text above. If I try to run it now, I get error messages from line 15 till the end, but I do not understand why. It even says it can&#39;t do text !! place even though text is a string and place is a integer. And the functions after that aren&#39;t accepted as well."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1574631075, "post_id": 59020603, "comment_id": 104290315, "body": "@JoesdeJonge you might want to make a new question about this if it&#39;s a new issue (it&#39;s a matter of taste, but keep in mind that SO is 50% is for your problem, and 50% is for others with a similar problem in the future).  In any case, &quot;it doesn&#39;t work&quot; is never helpful -- always include the specific error message so we know what we&#39;re looking at."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1574631335, "post_id": 59020603, "comment_id": 104290380, "body": "@JoesdeJonge but the short answer is that <code>do</code>, <code>&lt;-</code> and <code>return</code> do not belong in a non-monadic function like <code>rotatespecific</code>.  Use <code>let .. in</code> or <code>where</code> to make local bindings, and do not use <code>return</code> (just say what you would like to return without the keyword, e.g. <code>if place == length text then rotate moving (text !! place) else ...</code>).  <code>return</code> is about monads in Haskell, it doesn&#39;t work like in other languages (and this is lamented in the community; nowadays the equivalent <code>pure</code> is used instead and <code>return</code> will probably be removed soon)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1574618240, "last_edit_date": 1574618240, "creation_date": 1574617592, "answer_id": 59020603, "question_id": 59020267, "link": "https://stackoverflow.com/questions/59020267/how-can-you-use-the-result-of-a-function-as-a-variable-in-another-function-in-ha/59020603#59020603", "title": "How can you use the result of a function as a variable in another function in Haskell?", "body": "<p>The immediate problem is that <em>every <code>if</code> must have an <code>else</code></em>.  You got a parse error at the end because the parser is expecting more, namely an <code>else</code> for that <code>if place == length text</code>.</p>\n\n<p>When you fix this you will have more problems, because you are treating Haskell like an imperative language, and that's not how she likes to be treated.  It seems like you think</p>\n\n<pre><code>result ++ newstuff\n</code></pre>\n\n<p>will mutate <code>result</code>, adding <code>newstuff</code> to the end of it.  But Haskell doesn't mutate.  Instead, this expression <code>result ++ newstuff</code> is the list that results when you concatenate <code>result</code> and <code>newstuff</code>, but <code>result</code> itself remains unchanged.</p>\n\n<pre><code>ghci&gt; let result = [1,2,3]\nghci&gt; result ++ [4,5,6]\n[1,2,3,4,5,6]\nghci&gt; result\n[1,2,3]\n</code></pre>\n\n<p><code>rotatespecific</code> must <em>return</em> the rotated string, rather than trying to mutate it into existence.  The only way functions may communicate is by returning results computed from their arguments -\u2013 they may not manipulate any \"global\" state like <code>result</code>.  A function that returns <code>()</code> is guaranteed to be useless. </p>\n\n<pre><code>rotatespecific :: Int -&gt; String -&gt; Int -&gt; String\n</code></pre>\n\n<p>Delete the <code>result</code> \"global variable\" (which does not mean what you think it means) and focus on defining <code>rotatespecific</code> in a way that it returns the rotated string.</p>\n\n<p>I would also recommend commenting out <code>main</code> and <code>caesar</code> for now until you have <code>rotatespecific</code> compiling and working when you test it in <code>ghci</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1574632738, "last_edit_date": 1574632738, "creation_date": 1574632128, "answer_id": 59022770, "question_id": 59020267, "link": "https://stackoverflow.com/questions/59020267/how-can-you-use-the-result-of-a-function-as-a-variable-in-another-function-in-ha/59022770#59022770", "title": "How can you use the result of a function as a variable in another function in Haskell?", "body": "<p>I feel like this is an appropriate time to just show an example, because there are a lot of little problems.  I'm not going to fix logic bugs, but I've fixed your syntax.  Hopefully this gets you unstuck.</p>\n\n<pre><code>rotatespecific :: Int -&gt; String -&gt; Int -&gt; String\nrotatespecific moving text place =\n    if place &lt; length text then\n        -- use let .. in instead of do/bind (&lt;-) in pure functions. \n        let help = text !! place\n\n            -- multiple arguments are given after the function, no parentheses\n            h = rotate moving help\n\n            -- use parentheses around an argument if it is a complex expression\n            -- (anything more than a variable name)\n            a = rotatespecific moving text (place+1)\n\n            b = h ++ a\n        in b\n    else\n        if place == length text then\n            rotate moving (text !! place)\n        else\n            undefined -- you must decide what String to return in this case.\n</code></pre>\n\n<p>After you have this function working as intended, and only then, open this sealed envelope. \u2665\ufe0f</p>\n\n<blockquote class=\"spoiler\">\n  <p> <pre>\n rotatespecific :: Int -> String -> String\n rotatespecific moving text = concatMap (rotate moving) text</pre></p>\n</blockquote>\n"}], "owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 59020603, "answer_count": 2, "score": 0, "last_activity_date": 1574632738, "creation_date": 1574615406, "last_edit_date": 1574630022, "question_id": 59020267, "link": "https://stackoverflow.com/questions/59020267/how-can-you-use-the-result-of-a-function-as-a-variable-in-another-function-in-ha", "title": "How can you use the result of a function as a variable in another function in Haskell?", "body": "<p>I'm trying to learn how to use Haskell and now I have to make a program that takes a integer n and a string k and every letter of that string will be moved n places to the right in the alphabet. At this moment I've got the next code:</p>\n\n<pre><code>import Data.Char\n\nmain = do\n    x &lt;- read getLine :: Int\n    y &lt;- getLine\n    caesar x y\n\nresult :: String\n\nrotate :: Int -&gt; Char -&gt; [Char]\nrotate a b = [chr ((a + ord b) `mod` ord 'z' + ord 'a')]\n\ncaesar :: Int -&gt; String -&gt; ()\ncaesar moving text= do\n    rotatespecific moving text 0\n    putStrLn result\n\n\nrotatespecific :: Int -&gt; String -&gt; Int -&gt; ()\nrotatespecific moving text place = do\n    if place &lt; length text\n        then\n            result ++ rotate (moving (text !! place))\n            rotatespecific (moving text (place + 1))\n        else\n            if place == length text\n                then\n                    result ++ rotate (moving (text !! place))\n</code></pre>\n\n<p>But I can't compile it because it still gives me the same error message: </p>\n\n<pre><code>parse error (possibly incorrect indentation or mismatched brackets)\n   |\n28 |                     result ++ rotate (moving (text !! place))\n   |                                                              ^\n</code></pre>\n\n<p>But I can't see what's wrong with my syntax. I first thought it had something to do with using a Char as parameter for my function but I was wrong because text !! place should give a char and not a [char]. So what's wrong with what I'm doing?</p>\n\n<p>After some edit I got this, but it still doesn't work:</p>\n\n<pre><code>import Data.Char\n\nmain = do\n    xr &lt;- getLine\n    let x = read xr :: Int\n    y &lt;- getLine\n    putStrLn (rotatespecific (x y 0))\n\nrotate :: Int -&gt; Char -&gt; [Char]\nrotate a b = [chr ((a + ord b) `mod` ord 'z' + ord 'a')]\n\nrotatespecific :: Int -&gt; String -&gt; Int -&gt; String\nrotatespecific moving text place = do\n    if place &lt; length text\n        then do\n            help &lt;- text !! place\n            h &lt;- rotate (moving help)\n            a &lt;- rotatespecific (moving text (place + 1))\n            b &lt;- h ++ a\n            return b\n\n        else\n            if place == length text\n                then do\n                    return rotate (moving (text !! place))\n                else\n                    return ()\n</code></pre>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 1, "creation_date": 1574616234, "post_id": 59020266, "comment_id": 104286285, "body": "What&#39;s the error message you&#39;re getting?"}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "reply_to_user": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1574616816, "post_id": 59020266, "comment_id": 104286435, "body": "@DevNebulae it says couldn`t match expected type."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1574616916, "post_id": 59020266, "comment_id": 104286463, "body": "Please post the whole error message. Then we can check what it should be."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1574617050, "post_id": 59020266, "comment_id": 104286507, "body": "Looks ok to me.  Post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MVCE</a> and the error message please"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574617115, "post_id": 59020266, "comment_id": 104286526, "body": "test run your full code at tio.run or repl.it. your 2nd line goes above your first, then it&#39;s OK (you don&#39;t need the third line). you probably use it with incompatible argument."}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "reply_to_user": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1574617214, "post_id": 59020266, "comment_id": 104286547, "body": "@DevNebulae Ive added the errors."}, {"owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "edited": false, "score": 0, "creation_date": 1574617778, "post_id": 59020266, "comment_id": 104286720, "body": "thanks guys! Found answer below :)"}], "answers": [{"tags": [], "owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "is_accepted": true, "score": 3, "last_activity_date": 1574617323, "creation_date": 1574617323, "answer_id": 59020571, "question_id": 59020266, "link": "https://stackoverflow.com/questions/59020266/declare-type-of-function-in-contract/59020571#59020571", "title": "Declare type of function in contract", "body": "<p>As I suspected, the type is not part of the <code>Eq</code> type class, but is part of the <code>Ord</code> type class. <code>Eq</code> specifies how to equal two things and <code>Ord</code> specifies whether something is less than (<code>LT</code>), greater than (<code>GT</code>) or equal to (<code>Eq</code>) something.</p>\n\n<p>Changing your type to: <code>prop_merge_check :: Ord a =&gt; [a] -&gt; [a] -&gt; Bool</code> should work.</p>\n"}], "owner": {"reputation": 67, "user_id": 12425185, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hM3rBjfNTCM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3s0GhoUFQ_2x3kAwI_wOB71hBkA/photo.jpg?sz=128", "display_name": "osobennyj", "link": "https://stackoverflow.com/users/12425185/osobennyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 59020571, "answer_count": 1, "score": -1, "last_activity_date": 1574617323, "creation_date": 1574615387, "last_edit_date": 1574617168, "question_id": 59020266, "link": "https://stackoverflow.com/questions/59020266/declare-type-of-function-in-contract", "title": "Declare type of function in contract", "body": "<p>so i am struggling a bit with type of functions.</p>\n\n<p>I have a function </p>\n\n<pre><code>prop_merge_check xs ys = length (merge xs ys) == length (sort (xs ++ ys))\n</code></pre>\n\n<p>how can i assign type for each element of the function? </p>\n\n<p>I tried this way</p>\n\n<pre><code>prop_merge_check :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>and also this way</p>\n\n<pre><code>prop_merge_check xs ys = length (merge (xs::[a]) (ys::[a])) == length (sort ((xs::[a]) ++ (ys::[a])))\n</code></pre>\n\n<p>But it doesn't seem to work out for me. </p>\n\n<p>Need help pls</p>\n\n<p>Errors are </p>\n\n<blockquote>\n<pre><code>\u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018merge\u2019\n  prevents the constraint \u2018(Ord a0)\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n  These potential instances exist:\n    instance (Ord a, Ord b) =&gt; Ord (Either a b)\n      -- Defined in \u2018Data.Either\u2019\n    instance Ord Ordering -- Defined in \u2018GHC.Classes\u2019\n    instance Ord Integer\n      -- Defined in \u2018integer-gmp-1.0.2.0:GHC.Integer.Type\u2019\n    ...plus 23 others\n    ...plus 98 instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In the first argument of \u2018length\u2019, namely\n    \u2018(merge (xs :: [a]) (ys :: [a]))\u2019\n  In the first argument of \u2018(==)\u2019, namely\n    \u2018length (merge (xs :: [a]) (ys :: [a]))\u2019\n  In the expression:\n    length (merge (xs :: [a]) (ys :: [a]))\n      == length (sort ((xs :: [a]) ++ (ys :: [a])))\n</code></pre>\n</blockquote>\n\n<p>And </p>\n\n<pre><code>\u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018merge\u2019\n  prevents the constraint \u2018(Ord a0)\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n  These potential instances exist:\n    instance (Ord a, Ord b) =&gt; Ord (Either a b)\n      -- Defined in \u2018Data.Either\u2019\n    instance Ord Ordering -- Defined in \u2018GHC.Classes\u2019\n    instance Ord Integer\n      -- Defined in \u2018integer-gmp-1.0.2.0:GHC.Integer.Type\u2019\n    ...plus 23 others\n    ...plus 98 instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In the first argument of \u2018length\u2019, namely\n    \u2018(merge (xs :: [a]) (ys :: [a]))\u2019\n  In the first argument of \u2018(==)\u2019, namely\n    \u2018length (merge (xs :: [a]) (ys :: [a]))\u2019\n  In the expression:\n    length (merge (xs :: [a]) (ys :: [a]))\n      == length (sort ((xs :: [a]) ++ (ys :: [a])))\n</code></pre>\n"}, {"tags": ["haskell", "types", "applicative", "traversable"], "comments": [{"owner": {"reputation": 317, "user_id": 4594041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db3ea5590de7376bf2b0542f438a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "user4132", "link": "https://stackoverflow.com/users/4594041/user4132"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574615747, "post_id": 59020198, "comment_id": 104286128, "body": "Fixed the type of t in th LHS deduction. Still not sure how the law follows."}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 6, "last_activity_date": 1574616726, "creation_date": 1574616726, "answer_id": 59020480, "question_id": 59020198, "link": "https://stackoverflow.com/questions/59020198/what-does-the-naturality-law-for-traversables-mean/59020480#59020480", "title": "What does the Naturality law for Traversables mean?", "body": "<p>I think what you have missed is that <code>t</code> is supposed to be a natural transformation (which also probably must have some structure-preserving properties).  Natural transformations are quantified, like so:</p>\n\n<pre><code>t :: forall z. a z -&gt; b z   -- \"t is an N.T. from a ~&gt; b\"\n</code></pre>\n\n<p>On the right we instantiate it at <code>y</code>, to get <code>t :: a y -&gt; b y</code>; on the left we instantiate it at <code>c y</code> to get <code>a (c y) -&gt; b (c y)</code>. The way I think of it is that a natural transformation changes the outer layer, no matter what is inside.  Naturality laws always talk about relationships between the different ways something is instantiated.</p>\n\n<pre><code>t                :: forall z. a z -&gt; b z\n\nf                :: x -&gt; a y\nt                :: a y -&gt; b y           -- instantiated at y\nt . f            :: x -&gt; b y\ntraverse (t . f) :: c x -&gt; b (c y)\n\ntraverse f       :: c x -&gt; a (c y)\nt                :: a (c y) -&gt; b (c y)   -- instantiated at (c y)\nt . traverse f   :: c x -&gt; b (c y)\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 4594041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db3ea5590de7376bf2b0542f438a9ba?s=128&d=identicon&r=PG&f=1", "display_name": "user4132", "link": "https://stackoverflow.com/users/4594041/user4132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1574616726, "creation_date": 1574614937, "last_edit_date": 1574615692, "question_id": 59020198, "link": "https://stackoverflow.com/questions/59020198/what-does-the-naturality-law-for-traversables-mean", "title": "What does the Naturality law for Traversables mean?", "body": "<p>The Naturality law states that:</p>\n\n<pre><code>t . traverse f == traverse (t . f) -- for every applicative transformer t\n</code></pre>\n\n<p>Now for the RHS of the law, if f has the type <code>Applicative a =&gt; x -&gt; a y</code>, then t has to be of the type <code>(Applicative a, Applicative b) =&gt; a y -&gt; b y</code>, due to the function composition.</p>\n\n<p>For the LHS, traverse f has the type <code>(Applicative a, Traversable c) =&gt; c x -&gt; a (c y)</code>. But since traverse f is composed with t . traverse f, t has to be of the type (c x -> a (c y)) -> b y.</p>\n\n<p>Now, for the LHS, t has the type a (c y) -> b y, but from the RHS it has the type a y -> b y. How is the law sound from a type perspective?</p>\n\n<p>Edit: Fixed the type t in LHS</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 1, "last_activity_date": 1574616983, "creation_date": 1574616983, "answer_id": 59020522, "question_id": 59020172, "link": "https://stackoverflow.com/questions/59020172/haskell-list-duplicates-if-possible-with-map-elem-and-foldr/59020522#59020522", "title": "Haskell List Duplicates (if possible with map, elem and foldr)", "body": "<p>Before you can solve this problem, you need to have a good understanding of the functions <code>elem</code>, <code>map</code> and <code>foldr</code>. (Edit: maybe you won't need <code>filter</code>. I originally read <code>foldr</code> as <code>filter</code>, but there are some useful details in that section that will help so I left it.</p>\n\n<h2>elem</h2>\n\n<p>If you have some prior programming experience, <code>elem</code> should not be hard. When learning new functions in Haskell, we usually start with the type signature because it can give us a lot of information. For <code>elem</code> it is <code>a -&gt; [a] -&gt; Bool</code>. This means it takes two parameters, a value of type <code>a</code> and a list of values of type <code>a</code>, then it returns a <code>Bool</code>. If the value is in the list than it returns <code>True</code> otherwise it returns <code>False</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; elem 1 [1,2,3]\nTrue\n&gt; elem \"car\" [\"boat\",\"bus\",\"airplane\"]\nFalse\n</code></pre>\n\n<p>In a lot of Haskell code you will probably see <code>elem</code> used in infix style by wrapping it in backticks.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; 1 `elem` [1,2,3]\nTrue\n&gt; \"car\" `elem` [\"boat\",\"bus\",\"airplane\"]\nFalse\n</code></pre>\n\n<h2>filter</h2>\n\n<p>Again we will start with the type signature. For <code>filter</code> it is <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code>. <code>filter</code> takes two parameters, <code>(a -&gt; Bool)</code> is a function <code>f</code> that takes one parameter of type <code>a</code> and returns a <code>Bool</code>, and <code>[a]</code> is a list of values of type <code>a</code>. It will evaluate function <code>f</code> on each value on the list. When <code>f</code> returns <code>False</code> it will ignore that item, when <code>f</code> returns <code>True</code>, it will collect it and add it to a new list that it returns. Here some examples.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; even [1,2,3,4,5,6]\n[2,4,6]\n&gt; odd [1,2,3,4,5,6]\n[1,3,5]\n</code></pre>\n\n<p>Before we go any further it will be helpful to understand what lambda functions are (also called anonymous functions). They are a way to define a function without giving a name to the function. It also let's us define a function in line. The syntax looks like this <code>(\\x -&gt; ...)</code> where <code>x</code> is the name of the parameter we pass in and <code>...</code> should be replaced with a function body. Now let's try to define some lambda functions for <code>filter</code> (remember that they have to return <code>Bool</code>). </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- keep numbers greater than zero\n&gt; filter (\\x -&gt; x &gt; 0) [-1,-2,3,5,0,-4,100] \n[3,5,100]\n-- keep lists (Strings) longer than 3\n&gt; filter (\\x -&gt; length x &gt; 3) [\"the\", \"a\", \"hello\", \"goodnight\", \"bye\"]\n[\"hello\", \"goodnight\"]\n</code></pre>\n\n<h2>map</h2>\n\n<p>Finally <code>map</code> has a type signature that looks like this <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>. <code>(a -&gt; b)</code> is a function <code>f</code> that takes a value of type <code>a</code> and returns a value of type <code>b</code>, <code>[a]</code> is a list of values of types <code>a</code>, then it returns <code>[b]</code> which is a list of values of type <code>[b]</code>. It evaluates the function <code>f</code> on each value in the list and returns a list with the same number of elements, but the values might be altered. Here are a few examples.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- here type a is Int and type b is also Int\n-- add one to every element in the list\n&gt; map (\\x -&gt; x + 1) [1,2,3,4]\n[2,3,4,5]\n\n-- here type a is String and type b is also String\n-- append a \".\" to every String in the list\n&gt; map (\\x -&gt; x ++ \".\") [\"hello\", \"goodbye\"]\n[\"hello.\", \"goodbye.\"]\n\n-- here type a is String and type b is Int\n&gt; map (\\x -&gt; length x) [\"hello\", \"goodbye\"]\n\n-- here type a is Int and type b is String\n&gt; map (\\x -&gt; show x) [1,2,3,4]\n[\"1\",\"2\",\"3\",\"4\"]\n</code></pre>\n\n<h2>foldr</h2>\n\n<p><code>foldr</code> is a bit more complicated. Its type signature for a list is \n<code>(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>. After you are comfortable with <code>map</code>, I would\ntake a look at this <a href=\"https://stackoverflow.com/questions/1757740/how-does-foldr-work\">Stack Overlow question on foldr</a>.</p>\n\n<h2>pattern matching</h2>\n\n<p>You may also need to understand also understand pattern matching on tuples.\n<a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching\" rel=\"nofollow noreferrer\">Haskell Pattern Matching</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 12378942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2fdcb31304c39d0893ad99cc2ed528?s=128&d=identicon&r=PG&f=1", "display_name": "devFox", "link": "https://stackoverflow.com/users/12378942/devfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 59020522, "answer_count": 1, "score": -1, "last_activity_date": 1574616983, "creation_date": 1574614759, "question_id": 59020172, "link": "https://stackoverflow.com/questions/59020172/haskell-list-duplicates-if-possible-with-map-elem-and-foldr", "title": "Haskell List Duplicates (if possible with map, elem and foldr)", "body": "<p>My Task is to take in Data and \"filter\" out every duplicate like in the example down below. If possible, I have to use the functions map, elem and foldr\nI honestly don't know how to do it, if anyone can give me a hint on how to solve the problem, I'd be grateful.</p>\n\n<pre><code>type StudentName = String\ntype CourseName  = String\ntype ExamScore   = (CourseName, Float)\ntype StudentData = [(StudentName, [ExamScore])]\n\nstudents :: StudentData\nstudents = [\n (\"Tim Berners-Lee\", [(\"Maths\", 1.3), (\"Algorithm\", 2.0)]), \n (\"Ada Lovelace\",[(\"Info 1\", 3.0), (\"Lambda-Maths\", 1.7), (\"Science\", 2.3), (\"Data Mining\", 2.7)]),\n (\"Alan Turing\", [(\"Maths\", 1.7), (\"operatingSystems\", 2.0), (\"Lambda-Maths\", 1.7)]),\n (\"Alonzo Church\", [(\"Info 2\", 2.7), (\"Systems\", 2.3), (\"Lambda-Maths\", 1.0), (\"Algorithm\", 3.0)]),\n (\"Bjarne Stroustrup\", [(\"Info 1\", 2.7), (\"Info 2\", 1.3), (\"operatingSystems\", 2.0), (\"Topology\", 2.3)]),(\"Bjarne Stroustrup\", [(\"Info 1\", 2.7), (\"Info 2\", 1.3), (\"operatingSystems\", 2.0), (\"Topology\", 2.3)]),\n (\"Donald E. Knuth\", [(\"Maths\", 3.3), (\"Info 2\", 1.7), (\"Lambda-Maths\", 2.0), (\"Science\", 4.0)]),\n (\"Grace Hopper\", [(\"Info 3\", 1.0), (\"operatingSystems\", 2.3), (\"Systems\", 1.7)]),\n (\"Annie Easley\", [(\"Maths\", 1.0), (\"Info 2\", 1.7)]),\n (\"Edsger W. Dijkstra\", [(\"Topology\", 3.3), (\"Algorithm\", 2.7), (\"Systems\", 4.0)]),\n (\"John von Neumann\", [(\"Maths\", 3.3), (\"Algoritmische Topologie\", 1.0), (\"operatingSystems\", 1.3), (\"Systems\", 5.3)])\n ]\n\ncourses :: [CourseName]\ncourses = [\"Maths\", \"Info 1\", \"Info 2\", \"Algorithm\", \"operatingSystems\", \"Topology\", \"Lambda-Maths\", \"Systems\", \"Science\", \"Data Mining\"]\n\nexamResults :: [ExamScore]\nexamResults = [(\"Maths\", 3.3), (\"Topology\", 1.0), (\"operatingSystems\", 1.3), (\"Systems\", 5.3), (\"Info 1\", 1.7), (\"Info 2\", 1.7), (\"Data Mining\", 0.3)]\n\n\n\n\n\nfilterDuplicates :: StudentData -&gt; StudentData\nfilterDuplicates\n\n\n\n--e.g.\n-- filterDuplicates [(\"Tom\", [(\"Course A\", 1.3), (\"Course B\", 2.0)]), (\"Tom\", [(\"Course A\", 1.3), (\"Course B\", 2.0)])]\n-- output: [(\"Tom\", [(\"Course A\", 1.3), (\"Course B\", 2.0)])]\n</code></pre>\n"}, {"tags": ["haskell", "map-function"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1574605216, "creation_date": 1574605216, "answer_id": 59018634, "question_id": 59018532, "link": "https://stackoverflow.com/questions/59018532/using-map-in-haskell/59018634#59018634", "title": "Using map in Haskell", "body": "<p>Once you have the average, you just need to define a function that subtracts that average from its argument. A straightforward example:</p>\n\n<pre><code>modifyList :: [Float] -&gt; [Float]\nmodifyList xs = let avg = averageOfList xs\n                in map (\\x -&gt; x - avg) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 5, "last_activity_date": 1574606650, "creation_date": 1574606650, "answer_id": 59018858, "question_id": 59018532, "link": "https://stackoverflow.com/questions/59018532/using-map-in-haskell/59018858#59018858", "title": "Using map in Haskell", "body": "<p>For people new to functional programming <code>map</code> may be one of the first concepts that they struggle with. <code>map</code> is a function that takes two parameters: a function and a list of elements. </p>\n\n<p>The type signature of <code>map</code> is <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>. The <code>(a -&gt; b)</code> part is the function you pass to <code>map</code>, we will call it <code>f</code>. <code>f</code> takes one value and returns another that may be of a different type. The <code>[a]</code> part is the list of elements you want to apply <code>f</code> to, we will call it <code>xs</code>. Notice how the type signature of <code>f</code> takes an <code>a</code> and the type signature of <code>xs</code> is <code>[a]</code>, the type that <code>f</code> takes must match the type of elements in <code>xs</code>. The other thing to notice is the return type of <code>map</code> is <code>[b]</code>. This matches the return type of <code>f</code>. </p>\n\n<p>Here is a simple example of using map.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>plusOne :: Int -&gt; Int\nplusOne x = x + 1\n\nxs = [1,2,3,4,5,6]\nys = map plusOne xs\n</code></pre>\n\n<p>In this case the <code>a</code> type in <code>map</code> will be <code>Int</code> and the <code>b</code> type in <code>map</code> will also be <code>Int</code>. Let's look at a case where <code>a</code> and <code>b</code> types are different.</p>\n\n<pre><code>-- show :: a -&gt; String\nzs = map show ys\n</code></pre>\n\n<p>In this case <code>a</code> is <code>Int</code> and <code>b</code> is <code>String</code>. We get back a list of <code>String</code>. If you are familiar with a language like Python or C, you have probably made a for loop that starts at 0 and goes to the end of the array's length and changed the elements inside. This is the same concept.</p>\n\n<p>Finally, to answer your main question, you need to first apply <code>averageOfList</code> to a <code>[Float]</code>, then subtract the resulting <code>average</code> from each element in a list.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>avg = averageOfList [1.3,1.7,3.3,1.0,3.3]\n\nsubAvg x = x - avg\n\nmap subAvg [0.0,2.0,3.4,5.6]\n</code></pre>\n\n<p>In this example above I have written out the name and definition of a function we want to map over a list of floats. Another strategy is define a function inline without using a name (this is called a lambda function or anonymous function).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map (\\x -&gt; x - avg) [0.0,2.0,3.4,5.6]\n</code></pre>\n\n<p>The syntax <code>(\\x -&gt; )</code> means define a function that takes one parameter and we will call it <code>x</code>, then we define a body for the function. This is a way to define a function in line and without giving it a name. </p>\n"}], "owner": {"reputation": 31, "user_id": 12424548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UM3c9md4-Dc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdKl2A7iBViZBf7R2Q6kgFc5ybYsw/photo.jpg?sz=128", "display_name": "K Choe", "link": "https://stackoverflow.com/users/12424548/k-choe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3324, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1574614243, "creation_date": 1574604562, "last_edit_date": 1574614243, "question_id": 59018532, "link": "https://stackoverflow.com/questions/59018532/using-map-in-haskell", "title": "Using map in Haskell", "body": "<p>I want to use <code>map</code> to substract the average of a list from each element of a list using <code>map</code>. So far I got this function for calculating the average:</p>\n\n<pre><code>averageOfList :: [Float] -&gt; Float\naverageOfList [] = 0\naverageOfList a = ((foldl (+) 0 a) / fromIntegral(length a))\n</code></pre>\n\n<p>The list is <code>[1.3,1.7,3.3,1.0,3.3]</code>. How exactly do I use the function for the average in <code>map</code> to subtract from each element?</p>\n"}, {"tags": ["haskell", "random", "random-seed"], "comments": [{"owner": {"reputation": 14257, "user_id": 820127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8fffeec4f2ba3e75aebe941e4e5dd?s=128&d=identicon&r=PG", "display_name": "rossum", "link": "https://stackoverflow.com/users/820127/rossum"}, "edited": false, "score": 2, "creation_date": 1574604120, "post_id": 59018330, "comment_id": 104282909, "body": "For a long list of unique random numbers use encryption and encrypt 0, 1, 2, ... with the same key.  Use 64 bit encryption for 64 bit numbers, 128 bit encryption for 128 bit numbers.  When you have a big list of unique random numbers then assign the numbers from the big list to your various sub-lists."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1574607944, "post_id": 59018330, "comment_id": 104284011, "body": "Just make your list like <code>[start..end]</code> and then <a href=\"https://codereview.stackexchange.com/q/232894/105433\">shuffle</a>."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 2, "creation_date": 1574613023, "post_id": 59018330, "comment_id": 104285387, "body": "What is your reason for using Test.QuickCheck rather than <a href=\"http://hackage.haskell.org/package/random-1.1/docs/System-Random.html\" rel=\"nofollow noreferrer\">System.Random</a> , if I may ask ?"}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574685758, "post_id": 59018330, "comment_id": 104307774, "body": "@Redu That was useful for generating unique solutions but it gives the values as <code>IO [Int]</code>. Is there a way to avoid this?"}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1574685837, "post_id": 59018330, "comment_id": 104307820, "body": "@jpmarinier It was just one of the ways that I found online to generate the solutions, I have looked at other ways using <code>System.Random</code> but I cannot get them to work as I need either."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1574686352, "post_id": 59018330, "comment_id": 104308116, "body": "@You can generate ramdom numbers purely but then you need a <code>StdGen</code> and to make one you will use <code>mkStdGen</code> function which will ask for a seed value... Now i can imagine you are asking &quot;from where i will get a random seed?&quot;. Honestly for whatever purpose you need the shuffled array, please perform that task in IO monad like <code>shuffledList &gt;&gt;= return . doSomeFunkyStuff </code>. Now the <code>doSomeFunkyStuff</code> function is pure just like you have asked for. Where s the problem..?"}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574686652, "post_id": 59018330, "comment_id": 104308302, "body": "@Redu I&#39;m not sure I follow. Are you saying that I should do <b>everything</b> that I want to do with the shuffled array inside IO monad? My whole program is based on the data that I am trying to generate."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1574687219, "post_id": 59018330, "comment_id": 104308602, "body": "I would like to remind.. many Haskell programs start like <code>main :: IO ()</code>. But from another point of view... this resembles some JavaScript coders asking if they can I return a value from asynchgronous code. Yes, you have to perform your task within the IO monad like taking inputs from users, getting random values and returning results to display but all of the bits and pieces inside that. like <code>doSomeFunkyStuff</code> will be pure function code, possibly living in another module etc..."}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "edited": false, "score": 1, "creation_date": 1574687665, "post_id": 59018330, "comment_id": 104308830, "body": "Okay, that makes sense. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1574685276, "post_id": 59031908, "comment_id": 104307537, "body": "All of the solutions are going to return <code>IO</code>. Let me know if you need help running these functions multiple times and going from <code>IO [IO Int]</code> to <code>IO [Int]</code>."}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1574685442, "post_id": 59031908, "comment_id": 104307624, "body": "If you need something that is cryptographyically secure take a look at the package <a href=\"https://hackage.haskell.org/package/cryptonite\" rel=\"nofollow noreferrer\">cryptonite</a>."}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "edited": false, "score": 0, "creation_date": 1574685665, "post_id": 59031908, "comment_id": 104307723, "body": "Is there any way to generate <code>[Int]</code>? I have found a way that generates what I want, however, it gives <code>IO [Int]</code>"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "edited": false, "score": 1, "creation_date": 1574686054, "post_id": 59031908, "comment_id": 104307933, "body": "There is not a way a way to randomly generate <code>[Int]</code> without having <code>IO</code> involved. A random number generator needs to get a random seed by either reading the time or generating one created by a special hardware device. Reading time or data from a hardware device are both <code>IO</code> actions."}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "edited": false, "score": 0, "creation_date": 1574686259, "post_id": 59031908, "comment_id": 104308066, "body": "Oh, okay I see. Would I be able to convert <code>IO [Int]</code> to <code>[Int]</code>? Or is there a way to work with the data as if it is <code>[Int]</code>?"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "edited": false, "score": 1, "creation_date": 1574687004, "post_id": 59031908, "comment_id": 104308497, "body": "You can work with data like <code>IO [Int]</code> as if it were <code>[Int]</code> inside a function that is <code>IO a</code>, but that function must be <code>IO</code> at the end. Once you are in <code>IO</code> you cannot escape. For example <code>main :: IO ()</code>, ``` main  = do   x &lt;- generate $ choose (0,100)   -- now you can use x as if it were just [Int] ```"}, {"owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "edited": false, "score": 0, "creation_date": 1574687725, "post_id": 59031908, "comment_id": 104308864, "body": "That&#39;s great. Thanks."}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 1, "last_activity_date": 1574685067, "creation_date": 1574685067, "answer_id": 59031908, "question_id": 59018330, "link": "https://stackoverflow.com/questions/59018330/generate-unique-lists-of-random-integers-within-range/59031908#59031908", "title": "Generate unique lists of random integers within range", "body": "<p>You can do this with just <a href=\"http://hackage.haskell.org/package/random-1.1/docs/System-Random.html\" rel=\"nofollow noreferrer\">System.Random</a>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getStdRandom (randomR (0, 100))\n</code></pre>\n\n<p>But you can also do it with <a href=\"https://hackage.haskell.org/package/QuickCheck-2.13.2/docs/Test-QuickCheck.html\" rel=\"nofollow noreferrer\">QuickCheck</a>. You can use <code>choose :: Random a =&gt; (a, a) -&gt; Gen a</code> which can be used for any type that has a <code>Random</code> instance. You provide a range. Or with <code>elements :: [a] -&gt; Gen a</code>. It takes a list of pure values (not in <code>Gen</code> yet), picks one and returns it in <code>Gen</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>generate $ choose (0,100)\ngenerate $ elements [0..100]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 0, "last_activity_date": 1574853439, "last_edit_date": 1574853439, "creation_date": 1574792844, "answer_id": 59057299, "question_id": 59018330, "link": "https://stackoverflow.com/questions/59018330/generate-unique-lists-of-random-integers-within-range/59057299#59057299", "title": "Generate unique lists of random integers within range", "body": "<blockquote>\n  <p>I have looked at various StackOverflow answers although I still cannot\n  find a solution.\n  Many of the answers can only generate one random list with the same seed using System.Random.</p>\n</blockquote>\n\n<p>You can always reuse the new state of the random number generator to generate more samples, unless you use one of those functions that happen to \"drop the ball\", that is fail to return the new state along with the actual random sample.</p>\n\n<p>I suggest using the <code>runRand</code> function as defined in <a href=\"https://hackage.haskell.org/package/MonadRandom-0.1.3/docs/Control-Monad-Random.html\" rel=\"nofollow noreferrer\">Control.Monad.Random</a>:</p>\n\n<pre><code>-- Run a random computation using the generator g, returning the result\n-- and the updated generator.\nrunRand :: RandomGen g =&gt; Rand g a -&gt; g -&gt; (a, g)\n</code></pre>\n\n<p>This function takes a monadic <em>action</em> and a generator as parameters.</p>\n\n<p>You mention you don't want any repetitions in the output list. This means you want a subset of a random <em>permutation</em> (a.k.a. a <em>shuffle</em>) of the input list. There is code for this in the <a href=\"https://wiki.haskell.org/Random_shuffle\" rel=\"nofollow noreferrer\">suitable page of the Haskell Wiki</a>. This answer borrows shamelessly from that code, especially near the end of the page where it says \"<em>Drawing without replacement</em>\", hence no repetitions.</p>\n\n<p>Below, I will use the example of a (bridge/poker) card game where the input list is <code>[0..51]</code> which models a standard ordered card deck with 52 cards. Definitely you do not want any repetitions in the output list, as having say two Kings of Diamonds in your hand is seriously frowned upon in that sort of things.</p>\n\n<p>The general purpose code below consists mainly of 2 functions:</p>\n\n<p>Function <code>swapElems</code> comes straight from the Wiki page. It has nothing to do with randomness and its purpose is just to \"execute\" a given permutation. Note that it is not absolutely necessary to use arrays for such a purpose. The code in <a href=\"http://hackage.haskell.org/package/random-shuffle-0.0.4/docs/System-Random-Shuffle.html\" rel=\"nofollow noreferrer\">System.Random.Shuffle</a> uses an ad hoc tree structure for the same task.</p>\n\n<p>Function <code>partShuffle</code> generates the required monadic action, given an input list and a sample size (13 for a regular bridge hand of 13 cards out of 52).</p>\n\n<pre><code>import  Data.List    (sort, mapAccumL)\nimport  Data.Tuple   (swap)\nimport  Text.Printf  (printf)\nimport  Data.Array\nimport  Data.Array.MArray\nimport  Data.Array.ST\nimport  System.Random\nimport  Control.Monad.Random\n\n\nswapElems  :: [a] -&gt; [(Int, Int)] -&gt; [a]\nswapElems xs swaps = elems $ runSTArray (do\n    arr &lt;- newListArray (0, maxIx) xs\n    mapM_ (swap arr) swaps\n    return arr)\n    where\n        maxIx   = length xs - 1\n        swap arr (i,j) = do\n            vi &lt;- readArray arr i\n            vj &lt;- readArray arr j\n            writeArray arr i vj\n            writeArray arr j vi\n\n\npartShuffle :: MonadRandom mr =&gt; [a] -&gt; Int -&gt; mr [a]\npartShuffle xs sampleSize =\n  do\n    let  maxIx     = length xs - 1\n         ranStep i = do\n                       j &lt;- getRandomR (i, maxIx)\n                       return (i, j)\n    swapList  &lt;- forM  [0 .. (min (maxIx - 1) sampleSize)]  ranStep\n    let  xs2  =  swapElems xs swapList\n    return $ take sampleSize xs2\n</code></pre>\n\n<p>Function <code>stUnfold</code> is not mentioned in the Wiki page, but it can be useful to automate the task of passing the generator state from one sample generation to the next, should you want the ability to generate an arbitrary number of samples:</p>\n\n<pre><code>stUnfold :: (s -&gt; (a,s)) -&gt; s -&gt; Int -&gt; ([a], s)\nstUnfold go s0 count = let  auxList     =  replicate count ()\n                            xgo state _ =  swap $ go state\n                       in  swap  $  mapAccumL xgo s0 auxList\n</code></pre>\n\n<p>Type <strong>s</strong> in the signature stands for the type of the random number generator state.\n</p>\n\n<pre><code> \u03bb&gt; stUnfold  (\\n -&gt; (n*n, n+1))  0  10\n ([0,1,4,9,16,25,36,49,64,81],10)\n \u03bb&gt; \n</code></pre>\n\n<p>We can now use these functions to generate say 10 random \"hands\" of 13 cards each. For illustration purposes, the first two ones are generated by passing the state of the generator around manually, and the next 8 ones are generated in one strike using the <code>stUnfold</code> utility function.</p>\n\n<pre><code>-- for prettyprinting purposes:\nmyShow :: [Int] -&gt; String\nmyShow = concatMap  (printf \"%02d \")\n\n\nmain = do\n    let  -- setup random number generator:\n         seed = 4242\n         rng0 = mkStdGen seed\n         -- standard bridge/poker card deck of 52 cards\n         -- 13 cards out of 52, no replacement, 10 samples:\n         itemCount   = 52\n         deck        = [0 .. (itemCount-1)]\n         sampleSize  = 13\n         sampleCount = 10\n    -- type of action1 is: Rand StdGen [Int]\n    let action1          = partShuffle deck sampleSize\n\n    -- passing random generator manually:\n    let  (sample1, rng1a) = runRand action1 rng0\n    putStrLn  $  myShow $ sample1\n    let  (sample2, rng1b) = runRand action1 rng1a\n    putStrLn  $  myShow $ sample2\n\n    -- automated random generator passing:\n    let  (samples, rng2) = stUnfold (runRand action1) rng1b (sampleCount - 2)\n    mapM_  (\\ls -&gt; putStrLn  $  myShow ls)  samples\n</code></pre>\n\n<h2>Program output:</h2>\n\n<pre><code>$ cards\n49 38 15 14 03 24 22 02 37 43 44 31 39 \n48 34 46 07 21 29 28 01 50 08 14 12 51 \n27 31 48 19 20 01 16 04 15 35 30 50 46 \n02 42 29 48 35 05 19 45 18 34 44 09 51 \n37 47 49 05 19 16 50 21 02 22 39 11 12 \n04 13 07 23 16 36 27 22 20 21 11 49 38 \n45 02 27 36 13 04 14 12 11 26 09 38 00 \n03 14 13 40 32 05 06 29 30 27 43 15 38 \n48 15 00 04 11 10 13 07 21 36 09 38 37 \n14 48 33 10 05 07 50 03 51 41 29 44 12 \n$\n</code></pre>\n\n<p>Note that alternatively you can use a single monadic action that returns N samples. Such a monadic action is returned for example by the <code>grabble</code> function in the Wiki page.</p>\n\n<p>It is also possible,once you have a monadic action generating one sample, to obtain an action generating N samples using the <a href=\"https://hoogle.haskell.org/?hoogle=replicateM\" rel=\"nofollow noreferrer\">replicateM</a> function. The following code obscures a little bit what happens under the hood, but it does produce exactly the same output as above.</p>\n\n<pre><code>    let action1   =  partShuffle deck sampleSize\n        action10  =  replicateM 10 action1\n    let (samples, rng3) = runRand action10 rng0\n    mapM_  (\\ls -&gt; putStrLn  $  myShow ls)  samples\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1574853439, "creation_date": 1574603367, "question_id": 59018330, "link": "https://stackoverflow.com/questions/59018330/generate-unique-lists-of-random-integers-within-range", "title": "Generate unique lists of random integers within range", "body": "<p>I am trying to write a function that will take two parameters, one that is the upper bound on the range that the random integer should be in. The other parameter is the number of lists of random numbers to be generated. Right now I am just trying to be able to generate lists of unique random numbers in a given range.</p>\n\n<p>Using the following code, I can generate a random list of numbers, however, the numbers are of type <code>randomList 5 (0,10) :: IO [Int]</code> and not <code>[Int]</code>. The code also does not ensure that an integer is not repeated in a list.</p>\n\n<pre><code>import Test.QuickCheck\n\nt :: Int -&gt; (Int,Int) -&gt; Gen [Int]\nt n r = vectorOf n (choose r)\n\nrandomList n r = head `fmap` (sample' $ t n r)\n</code></pre>\n\n<p>I have looked at various StackOverflow answers although I still cannot find a solution. Many of the answers can only generate one random list with the same seed using <code>System.Random</code></p>\n"}, {"tags": ["haskell", "lambda", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1574600553, "post_id": 59017735, "comment_id": 104282021, "body": "Are you asking to decide whether a function terminates? This is the halting problem, and it is known to be undecidable -- there is no algorithm that can achieve that. <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Halting_problem</a>"}, {"owner": {"reputation": 420, "user_id": 9687872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8Nva.jpg?s=128&g=1", "display_name": "Dreana", "link": "https://stackoverflow.com/users/9687872/dreana"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574602072, "post_id": 59017735, "comment_id": 104282394, "body": "I get that. I&#39;m just wondering how I can check whether or not two functions are equal. As in, does it make a difference, if I use a lambda abstraction - for example regarding how the compiler treats the function for inputs which don&#39;t terminate?"}, {"owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 0, "creation_date": 1574661081, "post_id": 59017735, "comment_id": 104296420, "body": "The equivalence of two arbitrary functions can be <a href=\"https://stackoverflow.com/q/1132051/394253\">reduced to halting problem</a>, so it is also undecidable"}], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 9687872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8Nva.jpg?s=128&g=1", "display_name": "Dreana", "link": "https://stackoverflow.com/users/9687872/dreana"}, "edited": false, "score": 0, "creation_date": 1574618459, "post_id": 59018337, "comment_id": 104286917, "body": "Thank you very much. So if I got this right, in the above case none of the functions would even run with either input being undefined, so I could say they are equal? (Considering that they always return the same result given the same, valid input)"}, {"owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "reply_to_user": {"reputation": 420, "user_id": 9687872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8Nva.jpg?s=128&g=1", "display_name": "Dreana", "link": "https://stackoverflow.com/users/9687872/dreana"}, "edited": false, "score": 0, "creation_date": 1574618858, "post_id": 59018337, "comment_id": 104287052, "body": "Not really. The two functions are equal, but not for the reason you&#39;ve stated. If <code>f</code> didn&#39;t inspect its input, then both functions would return <code>True</code> for an input of <code>(undefined, undefined)</code>."}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 2, "last_activity_date": 1574603399, "creation_date": 1574603399, "answer_id": 59018337, "question_id": 59017735, "link": "https://stackoverflow.com/questions/59017735/check-if-two-haskell-functions-are-equal-with-regards-to-non-termination-or-erro/59018337#59018337", "title": "Check if two Haskell functions are equal with regards to non-termination or errors", "body": "<p>If you're looking to see how the two functions behave on partial inputs, you can supply the partial inputs yourself. For a pair, (let's say of type <code>(Int,Int)</code>), there are four different possibilities with regards to partiality.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>( 1   , 1   ) -- Total\n( _|_ , 1   ) -- Left bottom\n( 1   , _|_ ) -- Right bottom\n_|_           -- Bottom\n</code></pre>\n\n<p>You can use <code>undefined</code> as a bottom value, and test functions as you normally would in ghci. We'll test the <code>fst</code> function here as an example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;&gt;&gt; fst (1,1)\n1\n&gt;&gt;&gt; fst (undefined,1)\nundefined\n&gt;&gt;&gt; fst (1,undefined)\n1\n&gt;&gt;&gt; fst undefined\nundefined\n</code></pre>\n\n<p>All of those are pretty obvious, so here's a slightly more interesting example.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mapFst :: (a -&gt; b) -&gt; (a, c) -&gt; (b, c)\nmapFst f (x, y) = (f x, y)\n\nmapFst' :: (a -&gt; b) -&gt; (a, c) -&gt; (b, c)\nmapFst' f xy = (f (fst xy), snd xy)\n\n&gt;&gt;&gt; fst (mapFst (const 1) undefined)\nundefined\n&gt;&gt;&gt; fst (mapFst' (const 1) undefined)\n1\n</code></pre>\n\n<p>You could also have written <code>mapFst'</code> with an irrefutable pattern (<code>~(x,y)</code>).</p>\n\n<p>Finally, if you want to test this as part of an automated testing framework, or you just want to do it more systematically, you can use the package <a href=\"https://hackage.haskell.org/package/ChasingBottoms\" rel=\"nofollow noreferrer\">Chasing Bottoms</a>.</p>\n"}], "owner": {"reputation": 420, "user_id": 9687872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8Nva.jpg?s=128&g=1", "display_name": "Dreana", "link": "https://stackoverflow.com/users/9687872/dreana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574618839, "creation_date": 1574599222, "last_edit_date": 1574618839, "question_id": 59017735, "link": "https://stackoverflow.com/questions/59017735/check-if-two-haskell-functions-are-equal-with-regards-to-non-termination-or-erro", "title": "Check if two Haskell functions are equal with regards to non-termination or errors", "body": "<p>I'd like to know, i two Haskell functions are equal, also considering the case that the execution results in an error or does not terminate at all.</p>\n\n<p>Example (these functions both take a function and a pair as arguments, apply the function to both members of the pair, and then return True if their results are the same, otherwise False):</p>\n\n<pre><code>tupleEqual, tupleEqual' :: Eq b =&gt; (a -&gt; b) -&gt; (a, a) -&gt; Bool\ntupleEqual f = (\\(x,y) -&gt; f x == f y)\n\ntupleEqual' f (x, y) = f x == f y\n</code></pre>\n\n<p>My question is: how do I find out, how they functions would behave in case of non-termination or errors?</p>\n\n<p>I know that the first function could be translated into</p>\n\n<pre><code>tupleEqual f = let fun (x,y) = f x == f y in fun\n</code></pre>\n\n<p>Could this be relevant?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack", "ghci", "hoogle"], "answers": [{"tags": [], "owner": {"reputation": 425, "user_id": 7487299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1336164836458976/picture?type=large", "display_name": "kkiermasz", "link": "https://stackoverflow.com/users/7487299/kkiermasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1574616265, "creation_date": 1574616265, "answer_id": 59020400, "question_id": 59017570, "link": "https://stackoverflow.com/questions/59017570/how-to-run-brick-application/59020400#59020400", "title": "How to run brick application?", "body": "<p>The key was to run it using the following command: <code>stack App/Main.hs</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3127, "user_id": 7096763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1843972ea822c36c0c024d2ddcc8d7?s=128&d=identicon&r=PG&f=1", "display_name": "MikaelF", "link": "https://stackoverflow.com/users/7096763/mikaelf"}, "is_accepted": true, "score": 1, "last_activity_date": 1583554386, "creation_date": 1583554386, "answer_id": 60574312, "question_id": 59017570, "link": "https://stackoverflow.com/questions/59017570/how-to-run-brick-application/60574312#60574312", "title": "How to run brick application?", "body": "<p>Although your solution works, I don't think it's ideal, since the point of having entrypoints defined in a .cabal file is so that you can let stack do the grunt work (navigating the directories to the main <code>hs</code> file).</p>\n\n<p>If you want to install <code>bhoogle</code> system-wide, as its purpose suggests, then you can <code>stack install bhoogle</code> from anywhere outside of a stack directory.</p>\n\n<p>If, however, you want to compile and run it without installing it, <code>bhoogle</code> uses <code>make</code>, so you can build it with <code>make</code> and then fetch the executable from the <code>.stack-work</code> directory. Alternatively, from stack 1.9.1, you can use <code>stack run</code>, an analog to <code>cabal run</code>. For earlier versions of stack, you can use <code>stack build --exec bhoogle</code>.</p>\n"}], "owner": {"reputation": 425, "user_id": 7487299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1336164836458976/picture?type=large", "display_name": "kkiermasz", "link": "https://stackoverflow.com/users/7487299/kkiermasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 60574312, "answer_count": 2, "score": 0, "last_activity_date": 1583554419, "creation_date": 1574597917, "last_edit_date": 1583554419, "question_id": 59017570, "link": "https://stackoverflow.com/questions/59017570/how-to-run-brick-application", "title": "How to run brick application?", "body": "<p>I need to install <a href=\"https://github.com/andrevdm/bhoogle\" rel=\"nofollow noreferrer\">bhoogle</a>. I've already installed cabal by <code>stack install hoogle</code> command and I've created default database.\nI don't know how to run application with the GUI. I have bhoogle repo downloaded on my Mac and  <code>stack ghci Setup</code> nor  <code>stack ghci App/Main</code> doesn't work. No GUI is being displayed. \nI think that all the requirements are satisfied, but the method of running the app is wrong.   </p>\n"}, {"tags": ["haskell", "functional-programming", "expression-evaluation", "continuation-passing"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574590600, "post_id": 59016396, "comment_id": 104279762, "body": "I think you need some kind of &quot;environment&quot; parameter, e.g. <code>rho :: a -&gt; Int</code> to evaluate variables. You can also use a <code>Map</code> or association list, if you restrict <code>a</code> a little with a typeclass constraint."}, {"owner": {"reputation": 121, "user_id": 12423880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35bf3010c781b6820765a7f342f24be?s=128&d=identicon&r=PG&f=1", "display_name": "gehirndienst", "link": "https://stackoverflow.com/users/12423880/gehirndienst"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574594026, "post_id": 59016396, "comment_id": 104280529, "body": "Thanks for reply! Was thinking of something like this, but I don&#39;t get where I should define this <code>rho :: a -&gt; Int t</code> I mean should it be something like: <code>evalCPS (Var v) k = k . (env v) where  env :: a -&gt; Int</code> or i misunderstood? I&#39;m not able to change evalCPS function&#39;s type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574594495, "post_id": 59016396, "comment_id": 104280645, "body": "Without changing the type is more difficult. Perhaps you only need to handle closed terms, which define all the variables they use? If so, you could state <code>evalCPS (Let x n e) k = evalCPS (subst x n e) k</code> where <code>subst</code> is a kind of syntactic substitution helper. I&#39;m unsure about what is the expected solution here."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 1, "last_activity_date": 1584720519, "last_edit_date": 1584720519, "creation_date": 1574651553, "answer_id": 59024774, "question_id": 59016396, "link": "https://stackoverflow.com/questions/59016396/evaluation-with-continuation-passing-style-without-the-cont-monad/59024774#59024774", "title": "Evaluation with Continuation Passing Style without the Cont Monad", "body": "<p>You need to get yourself some sort of storage to store values for variables that get defined via <code>Let</code>. In the general interpreter/compiler terminology, such storage is usually called \"environment\". Let's define it this way:</p>\n\n<pre><code>type Env a = ...\n</code></pre>\n\n<p>Whenever you encounter a <code>Let</code>, you need to add a variable to the storage. Whenever you encounter a <code>Var</code>, you need to lookup the variable in the storage. Also, the whole computation should start out with an empty storage. This means that there should be three operations on storage:</p>\n\n<pre><code>emptyEnv :: Env a\nlookupVar :: a -&gt; Env a -&gt; Int\ninsertVar :: (a, Int) -&gt; Env a -&gt; Env a\n</code></pre>\n\n<p>Now, your <code>evalCPS</code> function needs to take an <code>Env</code> as argument (otherwise how would it lookup variables?). This would be the environment in whose context the expression should be evaluated:</p>\n\n<pre><code>evalCPS :: Env a -&gt; Expr a -&gt; (Int -&gt; r) -&gt; r\n</code></pre>\n\n<p>The <code>:+:</code> case doesn't need to look at the environment, so it should just tunnel it through to the recursive <code>evalCPS</code> calls:</p>\n\n<pre><code>evalCPS env (e1 :+: e2) k =\n   evalCPS env e1 $ \\n1 -&gt;\n   evalCPS env e2 $ \\n2 -&gt;\n   k (n1 + n2)\n</code></pre>\n\n<p>And similarly for the <code>:/:</code> case.</p>\n\n<p>The <code>Var</code> case would lookup the variable value in the environment and just return it (by calling the continuation):</p>\n\n<pre><code>evalCPS env (Var a) k =\n   k $ lookupVar a env\n</code></pre>\n\n<p>Simple enough.</p>\n\n<p>The <code>Let</code> case has to construct a new environment by adding the new variable to the old one, and then evaluate the expression in the context of this new environment:</p>\n\n<pre><code>evalCPS env (Let a value e) k =\n    let newEnv = insertVar (a, value) env\n    in evalCPS newEnv e k\n</code></pre>\n\n<p>Still simple enough.</p>\n\n<hr>\n\n<p>Now, how might we implement the environment itself? What should the bodies of <code>lookupVar</code>, <code>insertVar</code>, and <code>emptyEnv</code> look like?</p>\n\n<p>Conceptually, the environment could be seen as just a function: you give it a variable identifier, it gives you back its <code>Int</code> value. From this understanding, the simplest possible implementation of the environment falls out:</p>\n\n<pre><code>type Env a = a -&gt; Int\n</code></pre>\n\n<p>And from this, it is trivial to define <code>lookupVar</code>:</p>\n\n<pre><code>lookupVar :: a -&gt; Env a -&gt; Int\nlookupVar a env = env a\n</code></pre>\n\n<p><code>emptyEnv</code> is a bit trickier. Let's think: what should happen when the program tries to reference a variable that hasn't been defined? There is a wide range of possible answers to this question, but I will follow your lead and handle this error condition the same way you handle division by zero: simply call <code>error</code>:</p>\n\n<pre><code>emptyEnv :: Env a\nemptyEnv _ = error \"Undefined variable\"\n</code></pre>\n\n<p><code>insertVar</code> is trickier still. Let's think again: when I add a variable <code>a</code> with value <code>v</code> to an existing environment <code>e</code>, the result should be a new environment, such that if somebody tries to lookup variable <code>a</code>, the result should be value <code>v</code>. Let write that down:</p>\n\n<pre><code>insertVar :: Eq a =&gt; (a, Int) -&gt; Env a -&gt; Env a\ninsertVar (a, v) oldEnv = \n    \\x -&gt; if x == a then v else ???\n</code></pre>\n\n<p>And otherwise? Well, if somebody tries to lookup any variable <em>other</em> than <code>a</code>, the result should be the same as whatever <code>oldEnv</code> would give. Let's write that down too:</p>\n\n<pre><code>insertVar :: Eq a =&gt; (a, Int) -&gt; Env a -&gt; Env a\ninsertVar (a, v) oldEnv = \n    \\x -&gt; if x == a then v else oldEnv x\n</code></pre>\n\n<p>Simple enough. Note that, because I am using the comparison operator <code>==</code>, I had to add an <code>Eq a</code> constraint to the type signature. And since <code>evalCPS</code> tries to call <code>insertVar</code> at some point, the constraint would bleed into <code>evalCPS</code> as well:</p>\n\n<pre><code>evalCPS :: Eq a =&gt; Env a -&gt; Expr a -&gt; (Int -&gt; r) -&gt; r\n</code></pre>\n\n<p>This is only reasonable: if we want to be able to lookup variables in our variable storage, there has to be <em>some</em> way of telling which variable is which.</p>\n\n<hr>\n\n<p>Of course, this implementation of <code>Env</code> has one crucial drawback: it effectively performs a linear search on every lookup, resulting in poor performance when there are a lot of variables. While this is ok for a toy exercise, this won't do for any serious compiler or interpreter.</p>\n\n<p>If better performance is desired, feel free to experiment with other ways of storing the variable -> value mapping. For example, you might want to implement your storage as a <code>Map</code> (which offers logarithmic lookup times):</p>\n\n<pre><code>type Env a = Map a Int\n</code></pre>\n\n<p>I will leave the implementations of <code>emptyEnv</code>, <code>lookupVar</code>, and <code>insertVar</code> as an exercise.</p>\n"}], "owner": {"reputation": 121, "user_id": 12423880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35bf3010c781b6820765a7f342f24be?s=128&d=identicon&r=PG&f=1", "display_name": "gehirndienst", "link": "https://stackoverflow.com/users/12423880/gehirndienst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 59024774, "answer_count": 1, "score": 3, "last_activity_date": 1584720519, "creation_date": 1574588658, "last_edit_date": 1574599158, "question_id": 59016396, "link": "https://stackoverflow.com/questions/59016396/evaluation-with-continuation-passing-style-without-the-cont-monad", "title": "Evaluation with Continuation Passing Style without the Cont Monad", "body": "<p>I have a task: to write a function <code>evalCPS</code> which evaluates expressions formalized by the ADT below, using Continuation Passing Style but without Cont Monad or similar stuff. </p>\n\n<pre><code>data Expr a = Expr a :+: Expr a\n            | Expr a :/: Expr a\n            | Num Int\n            | Var a\n            | Let a Int (Expr a)\n</code></pre>\n\n<p>I did it for the first three constructors, that's not so hard:</p>\n\n<pre><code>evalCPS :: Expr a -&gt; (Int -&gt; r) -&gt; r\n\nevalCPS (Num n) k = k n\n\nevalCPS (e1 :+: e2) k =\n   evalCPS e1 $ \\n1 -&gt;\n   evalCPS e2 $ \\n2 -&gt;\n   k (n1 + n2)\n\nevalCPS (e1 :/: e2) k =\n  evalCPS e2 $ \\n2 -&gt;\n  if n2 == 0 then error \"division by zero\" else evalCPS e1 $ \\n1 -&gt;\n  k (n1 `div` n2)\n</code></pre>\n\n<p>But now I'm stuck with <code>Var</code> and <code>Let</code> constructors. I think I kinda understand how to do this with monad, since I have bind operator in it, but I need an advice how to solve it directly, without using monads. Will be very thankful for help! </p>\n"}, {"tags": ["string", "haskell", "switch-statement", "show"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574557357, "post_id": 59013710, "comment_id": 104274970, "body": "Please use a reasonable indentation standard that doesn&#39;t require us to horizontally scroll to read your code."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574557886, "post_id": 59013710, "comment_id": 104275043, "body": "Also, stop treating <code>case</code> expressions like  a more verbose version of <code>if</code> expressions. Either <i>use</i> <code>if</code>, or better yet, replace the <code>case</code> expressions with guards to simplify the amount of nesting."}, {"owner": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "edited": false, "score": 0, "creation_date": 1574559174, "post_id": 59013710, "comment_id": 104275248, "body": "Yes, i have been told that it doesnt looks good, but i have been teach to do it this way, and i have to do it like this right now, if you guys could help me anyways would be great!."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1574562001, "post_id": 59013710, "comment_id": 104275619, "body": "If this is for a class with a teacher, then you should ask said teacher for help with their requirements instead of us."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 2, "creation_date": 1574585197, "post_id": 59013710, "comment_id": 104278702, "body": "If this was the style of Haskell your teacher is enforcing, I would seriously question that class. It&#39;s very un-Haskell-like to write code in this fashion."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1574590364, "post_id": 59013710, "comment_id": 104279708, "body": "I would also recommend Learn You A Haskell (have the hard copy myself). In your case, I would recommend chapters 1 through 5. It takes about 2 hours to read all it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1574591131, "post_id": 59013710, "comment_id": 104279850, "body": "@DevNebulae Personally, I&#39;m fine with making beginners use <code>case .. of True -&gt; .. ; False ..</code> at the very beginning, and move to <code>if</code> later on, since that stresses that pattern matching is the real primitive which should be learned, and the rest is only syntactic sugar. I am instead not ok with the absurd indentation style -- I am guessing that might not be a requirement from the teacher."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574622079, "post_id": 59013710, "comment_id": 104287960, "body": "@chi Even if you wanted to go that route, wouldn&#39;t <code>case fst m of 0 -&gt; foo; _ -&gt; bar</code> be way better than <code>case fst m == 0 of True -&gt; foo; False -&gt; bar</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574627371, "post_id": 59013710, "comment_id": 104289379, "body": "@JosephSible Indeed, that&#39;s what I suggested in my answer below."}, {"owner": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "edited": false, "score": 0, "creation_date": 1574641240, "post_id": 59013710, "comment_id": 104292439, "body": "Thanks for the ones who tried to help, the main problem was that i tried to do ;}} instead of }};"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1574559265, "creation_date": 1574559265, "answer_id": 59013909, "question_id": 59013710, "link": "https://stackoverflow.com/questions/59013710/i-think-i-have-a-problem-with-the-parenthesces/59013909#59013909", "title": "I think i have a problem with the parenthesces", "body": "<p>As far as I can tell, you can reduce this entire function down to a few simple cases.</p>\n\n<pre><code>showMon (m, n) | m &lt; 0 = \"-\" ++ showMon (negate m, n)  -- negative terms\nshowMon (0, _) = \" \"  -- empty term\nshowMon (m, 0) = show m -- terms with x^0\nshowMon (m, n) = let coeff = if m == 1 then \"\" else (show m)\n                     exp = if n == 1 then \"\" else (\"^\" ++ show n)\n                 in coeff ++ \"x\" ++ exp -- other terms, with coefficients and exponents of 1 dropped\n</code></pre>\n\n<hr>\n\n<p>A <code>case</code> expression can handle multiple different values. If you <em>do</em> need to match against a Boolean value, that's what the <code>if</code> expression is for.</p>\n\n<pre><code>if x then y else z\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>case x of\n  True -&gt; y\n  otherwise -&gt; z\n</code></pre>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "edited": false, "score": 0, "creation_date": 1574626554, "post_id": 59016788, "comment_id": 104289185, "body": "Thanks i changed fst m and snd m to m1 and m2 , but still doesnt work, thanks for taking the time to do it anyways."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1574591965, "creation_date": 1574591965, "answer_id": 59016788, "question_id": 59013710, "link": "https://stackoverflow.com/questions/59013710/i-think-i-have-a-problem-with-the-parenthesces/59016788#59016788", "title": "I think i have a problem with the parenthesces", "body": "<p>Here's your code, re-indented for clarity. It is still quite hard to read.</p>\n\n<pre><code>showMon :: Monomio -&gt; String\nshowMon = \\m -&gt; case (fst m) == 0 of\n  { True -&gt; \" \";\n    False -&gt; case (fst m) == 1 of\n      { True -&gt; case (snd m) == 0 of\n          { True -&gt; \"1\";\n            False -&gt; case (snd m) == 1 of\n              { True-&gt; \"x\";\n                False -&gt; \"x^\" ++ (show (snd m));\n              }\n          } -- **\n        False -&gt; case (fst m) &lt; 0 of\n          { True -&gt; case (snd m) == 0 of\n              { True -&gt; show 1;\n                False -&gt; case (snd m) == 1 of\n                  { True -&gt; \"-x\";\n                    False -&gt; \"-x^\" ++ show (snd m);\n                  }\n              } -- **\n            False -&gt; case snd m == 0 of\n              { True -&gt; show 1;\n                False -&gt; case snd m == 1 of\n                  { True-&gt; (show fst m) ++ \"x\";\n                    False-&gt; (show fst m) ++ \"x^\" ++ show (snd m);\n                  }\n              }\n          }\n      }\n  }\n</code></pre>\n\n<p>In the points marked with <code>-- **</code> above a semicolon is missing, making the compiler produce a weird error message, since we are essentially trying to apply a <code>case</code> expression to some arguments in this way.</p>\n\n<p>Some suggestions to improve this:</p>\n\n<p>You don't have to use <code>fst,snd</code>, you can pattern match on the input argument. Instead of <code>\\m -&gt; ...</code>, you can use <code>\\(m1,m2) -&gt; ...</code> and then use the two components directly.</p>\n\n<p>You don't have to check <code>fst m == 0</code>, <code>fst m == 1</code> in that way. You can instead use (trying to mimic your style)</p>\n\n<pre><code>case m1 of  -- recall m1 is (fst m)\n  { 0 -&gt; .... ;  -- it is 0\n    1 -&gt; .... ;  -- it is 1\n    _ -&gt; ....    -- it is something else\n  }\n</code></pre>\n\n<p>In principle, with guards you can even incorporate checks like your <code>fst m &lt; 0</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59016788, "answer_count": 2, "score": -5, "last_activity_date": 1574591965, "creation_date": 1574556457, "question_id": 59013710, "link": "https://stackoverflow.com/questions/59013710/i-think-i-have-a-problem-with-the-parenthesces", "title": "I think i have a problem with the parenthesces", "body": "<p>Im sorry i have posted codes the entire day, now i have this one and i have no idea why its not working. I have an error that doesnt tells me exactly what my problem is, someone told me to turn on the warnings so it could be easier but i dont know how do to that. If you give this code a monomian, it should give you the monomian as a string. The monomian is a (a,b), so thats why the code is full of fst and snd.</p>\n\n<pre><code>showMon :: Monomio -&gt; String\nshowMon = \\m -&gt; case (fst m) == 0 of{ True -&gt; \" \";\n                                    False -&gt; case (fst m) == 1 of{ True -&gt; case (snd m) == 0 of{ True -&gt; \"1\";\n                                                                                               False -&gt; case (snd m) == 1 of{ True-&gt; \"x\";\n                                                                                                                            False -&gt; \"x^\" ++ (show (snd m));}}\n                                                                   False -&gt; case (fst m) &lt; 0 of{ True -&gt; case (snd m) == 0 of{ True -&gt; show 1;\n                                                                                                                     False -&gt; case (snd m) == 1 of { True -&gt; \"-x\";\n                                                                                                                                                     False -&gt; \"-x^\" ++ show (snd m);}}                                                                                        \n                                                                                          False -&gt; case snd m == 0 of{ True -&gt; show 1;\n                                                                                                                       False -&gt; case snd m == 1 of{ True-&gt; (show fst m) ++ \"x\";\n                                                                                                                                                    False-&gt; (show fst m) ++ \"x^\" ++ show (snd m);}}}}}\n</code></pre>\n\n<pre><code>Polinomios.hs:146:108: error:\n    Unexpected case expression in function application:\n        case (snd m) == 0 of\n          True -&gt; \"1\"\n          False\n            -&gt; case (snd m) == 1 of\n                 True -&gt; \"x\"\n                 False -&gt; \"x^\" ++ (show (snd m))\n    You could write it with parentheses\n    Or perhaps you meant to enable BlockArguments?\n    |\n146 |                                                                     False -&gt; case (fst m) == 1 of{ True -&gt; case (snd m) == 0 of{ True -&gt; \"1\";     | \n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1574548757, "post_id": 59012714, "comment_id": 104273429, "body": "It looks like they are mainly using <code>Monad</code> for <code>fail</code> (which is being moved to its own class anyhow). My personal preference would be to use the signature <code>stringToTree :: String -&gt; Maybe (Tree Char)</code> which I find more informative in its concreteness.  Thankfully <code>Maybe</code> is a monad so there is no change to the code necessary."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1574549319, "post_id": 59012714, "comment_id": 104273538, "body": "@luqui Is <code>fail</code> even meant to be used explicitly? I thought it was primarily use in desugaring <code>do</code> blocks to handle pattern-match failures. Are <code>Except</code> (and/or <code>Lift</code>?) preferred for reporting errors?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1574549848, "post_id": 59012714, "comment_id": 104273626, "body": "This is a bad example for monads. <code>fail</code> isn&#39;t actually in the monad class anymore. The correct class-constrained signature would be <code>Alternative m =&gt; String -&gt; m (Tree Char)</code> (but then you need to either turn on the <code>-XApplicativeDo</code> extension or reformulate the <code>do</code> block to applicative operators yourself). But I agree with Luke that concrete <code>Maybe</code> makes more sense as the result monad."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574550893, "post_id": 59012929, "comment_id": 104273819, "body": "The answer is .. still overwhelming. I&#39;m actually following <a href=\"https://stackoverflow.com/questions/1012573/getting-started-with-haskell?rq=1\">this post</a>. Maybe I should get back after I finish reading the 14th chapter of &quot;Real World Haskell&quot;. That being said, at least I understood something in your answer: the use of monads here is to return an error if needed."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574550984, "post_id": 59012929, "comment_id": 104273834, "body": "Wait.. probably not exactly. I remembered doing lots of exercise where I included a function e.g. <code>factorial :: Int -&gt; Int</code> and something like <code>factorial (-1) = error &quot;input number should be positive&quot;</code> works! I did not use any monads here.."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 3, "creation_date": 1574553520, "post_id": 59012929, "comment_id": 104274315, "body": "<code>error</code> produces a run-time error, rather than signaling in your code that the operation failed. We call a function that can raise a run-time error a <i>partial</i> function, since it isn&#39;t really defined for all its arguments; <code>factorial (-1)</code> isn&#39;t defined, since it doesn&#39;t actually return an <code>Int</code>. <code>factorial&#39; :: Int -&gt; Maybe Int</code>, however, <i>can</i> be defined for all <code>Int</code> values; e.g., <code>factorial&#39; 5 == Just 120</code>, and <code>factorial&#39; (-1) == Nothing</code>. This forces you, the programmer to acknowledge and deal with possible errors, rather than letting your program fail when run."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1574548700, "creation_date": 1574548700, "answer_id": 59012929, "question_id": 59012714, "link": "https://stackoverflow.com/questions/59012714/first-experience-with-monads-haskell/59012929#59012929", "title": "First experience with monads (Haskell)", "body": "<p>In short, the definition lets the caller choose which monad to use. This lets us customize how we deal with failure. For example, we can use <code>Maybe</code>:</p>\n\n<pre><code>&gt;&gt;&gt; stringToTree \"\" :: Maybe (Tree Char)\nJust Empty\n&gt;&gt;&gt; stringToTree \"9 +\" :: Maybe (Tree Char)\nNothing\n</code></pre>\n\n<p>or <code>[]</code>:</p>\n\n<pre><code>&gt;&gt;&gt; stringToTree \"\" :: [Tree Char]\n[Empty]\n&gt;&gt;&gt; stringToTree \"9 +\" :: [Tree Char]\n[]\n</code></pre>\n\n<p>The code itself makes no assumptions about <em>which</em> monad is used; it only uses <code>&gt;&gt;=</code>, <code>return</code>, and <code>fail</code> for working with the results of recursive calls.</p>\n\n<p>Making the type <code>String -&gt; Tree Char</code> would indicate that failure simply cannot happen; <em>every</em> string has to produce a valid <code>Tree Char</code> value (or we raise a runtime error, which is something you should strive to avoid in Haskell).</p>\n\n<p>Note, though, that not all monads provide a definition of <code>fail</code> that avoids runtime errors.</p>\n\n<pre><code>&gt;&gt;&gt; stringToTree \"\" :: Either () (Tree Char)\nRight Empty\n&gt;&gt;&gt; stringToTree \"9 +\" :: Either () (Tree Char)\n*** Exception: bad parse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574606066, "post_id": 59016507, "comment_id": 104283486, "body": "Thank you so much! I am very excited to get there (to be able to fully understand and appreciate) soon."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1574589625, "creation_date": 1574589625, "answer_id": 59016507, "question_id": 59012714, "link": "https://stackoverflow.com/questions/59012714/first-experience-with-monads-haskell/59016507#59016507", "title": "First experience with monads (Haskell)", "body": "<p>Why monads are useful? Some broader context.</p>\n\n<p>Monads are a <em>unification</em> of several things that traditionally have been handled by different language mechanisms. Among them are</p>\n\n<ul>\n<li><p>Sequencing (like in IO or State)</p></li>\n<li><p>Non-determinism (like in the list monad)</p></li>\n<li><p>Failure and exceptions (like in Maybe)</p></li>\n<li><p>Saving and resuming computations (the Cont monad, which you will encounter in the future)</p></li>\n<li><p>Atomic transactions (the STM monad)</p></li>\n<li><p>Parsing (Parsec and its relatives)</p></li>\n</ul>\n\n<p>By \"unification\" I mean the kind of thing that Newton did when he unified the laws of physics for things on Earth and things in the sky, or when Maxwell unified electricity and magnetism into the electromagnetic field; its a deeper underlying theory which yields all of the above as special cases and shows how you can create new things along the same lines.</p>\n\n<p>In monads the type of the \"bind\" function <code>(&gt;&gt;=)</code> is the central equation in the theory; it describes how one step in the computation can be daisy-chained on to the next. <code>return</code> is the primitive null step. This is something you get used to in Haskell; everything has some kind of zero or null or identity value. <code>fail</code> is a step that doesn't work, which (as @chepner says in a comment elsewhere) is needed for partial functions.</p>\n"}], "owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 59012929, "answer_count": 2, "score": 3, "last_activity_date": 1574589625, "creation_date": 1574546819, "last_edit_date": 1574547184, "question_id": 59012714, "link": "https://stackoverflow.com/questions/59012714/first-experience-with-monads-haskell", "title": "First experience with monads (Haskell)", "body": "<p>I apologize for the subject being unclear. I'm doing Haskell 99 as a beginner, and have encountered the concept of monad first time in my life in <a href=\"https://wiki.haskell.org/99_questions/Solutions/67A\" rel=\"nofollow noreferrer\">the solution to 67A</a>. The part of the problem I'm struggling with is to define a function <code>stringToTree</code> that translates sequences like <code>a(b,c)</code> to a <code>Tree</code>: <code>Branch a (Branch b Empty Empty) (Branch c Empty Empty)</code>.</p>\n\n<p>I have tried several \"soft\" introductions to monads, and failed like many others. I hope by understanding this solution will finally lead me in-door, so I decided to give it a shot here.</p>\n\n<h3>Questions</h3>\n\n<ol>\n<li>Would anyone briefly explain what the function <code>stringToTree :: (Monad m) =&gt; String -&gt; m (Tree Char)</code> defined in the solution? To make this question self-contained, I copied the code from there</li>\n</ol>\n\n<pre><code>stringToTree :: (Monad m) =&gt; String -&gt; m (Tree Char)\nstringToTree \"\" = return Empty\nstringToTree [x] = return $ Branch x Empty Empty\nstringToTree str = tfs str &gt;&gt;= \\ (\"\", t) -&gt; return t\n    where tfs a@(x:xs) | x == ',' || x == ')' = return (a, Empty)\n          tfs (x:y:xs)\n                | y == ',' || y == ')' = return (y:xs, Branch x Empty Empty)\n                | y == '(' = do (',':xs', l) &lt;- tfs xs\n                                (')':xs'', r) &lt;- tfs xs'\n                                return $ (xs'', Branch x l r)\n          tfs _ = fail \"bad parse\"\n</code></pre>\n\n<ol start=\"2\">\n<li>Why is <code>monad</code> useful here? I hope to see how monads largely reduce the difficulties, of course only after one understands it, while defining this function.</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574550515, "post_id": 59012579, "comment_id": 104273739, "body": "How does it help to pass a <code>Nat1</code> to <code>getAllVectors</code>? Also, <code>getAllVectors</code> is confusing. Could you try to explain what it&#39;s supposed to do?"}, {"owner": {"reputation": 3190, "user_id": 303795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d4527273eaa0e045a245b71e0a004d?s=128&d=identicon&r=PG", "display_name": "Joe the Person", "link": "https://stackoverflow.com/users/303795/joe-the-person"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574552426, "post_id": 59012579, "comment_id": 104274121, "body": "GHC.TypeNats has a kind <code>Nat</code> which is defined as <code>data Nat</code> with no constructors (using <code>DataKinds</code>). So in order to get actual values represented as peano numbers we have to create our own concrete type.  <code>getAllVectors s n</code> returns every possible vector of size <code>n</code> with elements in <code>s</code>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1574582537, "post_id": 59012579, "comment_id": 104278217, "body": "What connects the <code>Nat1</code> argument to the variable <code>n</code>?"}, {"owner": {"reputation": 3190, "user_id": 303795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d4527273eaa0e045a245b71e0a004d?s=128&d=identicon&r=PG", "display_name": "Joe the Person", "link": "https://stackoverflow.com/users/303795/joe-the-person"}, "edited": false, "score": 0, "creation_date": 1574612531, "post_id": 59012579, "comment_id": 104285272, "body": "That&#39;s the part I wasn&#39;t really sure how to do. I came up with a &quot;workaround&quot; using singleton instances (<code>SNat</code>) but I couldn&#39;t figure out how to make this work with <code>vector-sized</code>, so right now I&#39;m just using a regular datatype"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1574621709, "creation_date": 1574621709, "answer_id": 59021250, "question_id": 59012579, "link": "https://stackoverflow.com/questions/59012579/injective-type-family-for-natural-numbers/59021250#59021250", "title": "Injective type family for natural numbers", "body": "<p>It's usually better to start with \"real\" things, and then translate them to the \"fakes\". Here's how you'd do it for real:</p>\n\n<pre><code>data Nat = Z | S Nat\n\ndata SNat n where\n  SZ :: SNat 'Z\n  SS :: SNat n -&gt; SNat ('S n)\n\ndata Vec n a where\n  Nil :: Vec 'Z a\n  Cons :: a -&gt; Vec n a -&gt; Vec ('S n) a\n\ngetAllVectors :: forall s n. [s] -&gt; SNat n -&gt; [Vec n s]\ngetAllVectors s SZ = [Nil]\ngetAllVectors s (SS x) = Cons &lt;$&gt; s &lt;*&gt; getAllVectors s x\n</code></pre>\n\n<p>Using a singleton ties the size of the natural number argument to that of the vectors in the result.</p>\n\n<p>To make this sort of thing work with the fake types, you're likely to want type families going both ways. Don't be afraid of constraints that look like</p>\n\n<pre><code>(ToTL n ~ n', FromTL n' ~ n)\n</code></pre>\n\n<p>if those turn out to make sense.</p>\n\n<p>Notice something else: the implementation using <code>Data.Vector.Sized</code> will be pretty inefficient, since consing vectors is slow. Do you really need that?</p>\n"}], "owner": {"reputation": 3190, "user_id": 303795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d4527273eaa0e045a245b71e0a004d?s=128&d=identicon&r=PG", "display_name": "Joe the Person", "link": "https://stackoverflow.com/users/303795/joe-the-person"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574621709, "creation_date": 1574545682, "question_id": 59012579, "link": "https://stackoverflow.com/questions/59012579/injective-type-family-for-natural-numbers", "title": "Injective type family for natural numbers", "body": "<p>I am trying to write some functions to operate on fixed-size vectors (using the <code>vector-sized</code> package). These use <code>GHC.TypeNats</code> to encode the length in the type itself. However I'm running into some problems when I want to repeat an operation (<code>getAllVectors</code> in this case) a certain amount of times. Since the 2nd argument of <code>getAllVectors</code> affects the result type, it seems I need to go through something like what's described <a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/type-nats/matching-on-nats\" rel=\"nofollow noreferrer\">in this page</a>. But this doesn't compile - Haskell complains <code>FromNat1</code> is not injective even though I'm pretty sure it is. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeFamilyDependencies #-}\n{-# LANGUAGE GADTs #-}\n\nimport GHC.TypeNats \nimport Data.Vector.Sized (Vector)\nimport qualified Data.Vector.Sized as Vec \n\ndata Nat1 = Zero | Succ Nat1\n\ntype family FromNat1 (n :: Nat1) = (c :: Nat) | c -&gt; n \ntype instance FromNat1 Zero     = 0\ntype instance FromNat1 (Succ n) = 1 + FromNat1 n\n\ngetAllVectors :: forall s n. [s] -&gt; Nat1 -&gt; [Vector (FromNat1 n) s]\ngetAllVectors s Zero = [Vec.empty]\ngetAllVectors s (Succ x) = Vec.cons &lt;$&gt; s &lt;*&gt; getAllVectors s x\n</code></pre>\n\n<p>Is there a better way to do this? I'm not strictly tied to using <code>vector-sized</code> if there's a better option</p>\n"}, {"tags": ["haskell", "routing", "servant", "haskell-lucid"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1574637628, "post_id": 59011326, "comment_id": 104291793, "body": "Perhaps the <code>safeLink</code> function could help. <a href=\"http://hackage.haskell.org/package/servant-0.16.2/docs/Servant-Links.html#v:safeLink\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/servant-0.16.2/docs/&hellip;</a> Code that uses <code>safeLink</code> will only compile if the endpoint is an actual part of the api. This SO answer contains an example <a href=\"https://stackoverflow.com/a/41566105/1364288\">stackoverflow.com/a/41566105/1364288</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1574706949, "creation_date": 1574706949, "answer_id": 59038151, "question_id": 59011326, "link": "https://stackoverflow.com/questions/59011326/navigating-haskell-servant-api-with-lucid-webui/59038151#59038151", "title": "Navigating Haskell Servant API with Lucid WebUI", "body": "<p>If you just want to abstract over the string <code>\"user\"</code>, you can do this with a type alias, and then use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-TypeLits.html#v:symbolVal\" rel=\"nofollow noreferrer\"><code>GHC.TypeLits.symbolVal</code></a> to get the string at the value level:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n\nimport Data.Proxy\nimport GHC.TypeLits\n\ntype UserSite = \"user\"\n\nhtml = ... href_ (symbolVal (Proxy :: Proxy UserSite)) ...\n</code></pre>\n\n<p>You can also make the <code>symbolVal</code> call a bit shorter by defining a helper with <code>AllowAmbiguousTypes</code>:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n\nurlpath :: forall s . KnownSymbol s =&gt; String\nurlpath = symbolVal (Proxy :: Proxy s)\n\nhtml = ... href_ (urlpath @UserSite) ...\n</code></pre>\n\n<p>(I actually thought something like it was in the standard library somewhere but I can't find it.)</p>\n"}], "owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 2, "accepted_answer_id": 59038151, "answer_count": 1, "score": 2, "last_activity_date": 1574706949, "creation_date": 1574536952, "question_id": 59011326, "link": "https://stackoverflow.com/questions/59011326/navigating-haskell-servant-api-with-lucid-webui", "title": "Navigating Haskell Servant API with Lucid WebUI", "body": "<p>I've learnt that I can define my API with servant and Lucid in the following way:</p>\n\n<pre><code>type ClientAPI = \n    \"users\" :&gt; Get '[HTML] (Html ()) \n    :&lt;|&gt; \"userdata\" :&gt; Get '[HTML] (Html ())\n</code></pre>\n\n<p>Then if I want to add a link to one of the endpoints in my HTML, I can use \"a_\" function provided by Lucid, e.g.</p>\n\n<pre><code>a_ [href_ \"users\"] \"Show users\"\n</code></pre>\n\n<p>The problem I have with this approach is that I need to repeat the endpoint's name twice. \"users\" occurs both in API definition and a_ tag. As a result if I change it in one place, the other one stops working immediately.</p>\n\n<p>Is there a way to define a single symbol that could be used in both places instead ? Something like:</p>\n\n<pre><code>data MySites = UserSite | UserDataSite -- potentially more\n\ntype ClientAPI' =\n    UserSite :&gt; Get '[HTML] (Html ())\n    -- ......\n\nlet html =\n...\n   a_ [href_ UserSite] \"Show users\"\n...\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574521560, "post_id": 59008960, "comment_id": 104266086, "body": "did you mean for that to just apply to singleton lists? Or did you mean it to apply to all lists: ie. <code>luhn xs = myMap (*2) (+0) xs</code> Which in turn can be simplified as <code>luhn = myMap (*2) (+0)</code> (and I would prefer to write <code>id</code> instead of <code>(+0)</code>, but that makes no difference)."}], "answers": [{"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 0, "last_activity_date": 1574521451, "creation_date": 1574521451, "answer_id": 59008975, "question_id": 59008960, "link": "https://stackoverflow.com/questions/59008960/haskell-non-exhaustive-patterns-in-function-no-idea-why/59008975#59008975", "title": "Haskell: Non-exhaustive patterns in function. No idea why", "body": "<p>What would <code>luhn []</code> be, for example?</p>\n\n<p>Your function is currently defined for a list of <em>one element</em>. What about other lists?</p>\n\n<p>It can be:</p>\n\n<pre><code>luhn [x] = your code\nluhn whatever_else = error \"That's an error!\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574542374, "post_id": 59009024, "comment_id": 104271915, "body": "Not sure it&#39;s the mistake you made, but a common misunderstanding is that the pattern <code>[x]</code> would match a list (as opposed to some other type of value) and bind it to <code>x</code>, rather than match a list containing a single element."}], "tags": [], "owner": {"reputation": 975, "user_id": 10729355, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcfosD7MGZ0/AAAAAAAAAAI/AAAAAAAAC5M/2gNNiG83ubY/photo.jpg?sz=128", "display_name": "Otavio Bonder", "link": "https://stackoverflow.com/users/10729355/otavio-bonder"}, "is_accepted": false, "score": 1, "last_activity_date": 1574521818, "creation_date": 1574521818, "answer_id": 59009024, "question_id": 59008960, "link": "https://stackoverflow.com/questions/59008960/haskell-non-exhaustive-patterns-in-function-no-idea-why/59009024#59009024", "title": "Haskell: Non-exhaustive patterns in function. No idea why", "body": "<p>Thanks everybody, really dumb mistake.</p>\n\n<pre><code>luhn :: [Int] -&gt; [Int]\nluhn x = myMap (*2) (+0) x\n</code></pre>\n\n<p>This was the correct form to implement the function. I don't know why I put <code>luhn [x] = myMap (*2) (+0) [x]</code>.</p>\n\n<p>This way it's working now.</p>\n"}], "owner": {"reputation": 975, "user_id": 10729355, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcfosD7MGZ0/AAAAAAAAAAI/AAAAAAAAC5M/2gNNiG83ubY/photo.jpg?sz=128", "display_name": "Otavio Bonder", "link": "https://stackoverflow.com/users/10729355/otavio-bonder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574521818, "creation_date": 1574521301, "question_id": 59008960, "link": "https://stackoverflow.com/questions/59008960/haskell-non-exhaustive-patterns-in-function-no-idea-why", "title": "Haskell: Non-exhaustive patterns in function. No idea why", "body": "<p>I'm learning Haskell and I'm trying to implement the luhn algorithm.</p>\n\n<p>I've created a helper function:</p>\n\n<pre><code>myMap :: (a -&gt; b) -&gt; (a -&gt; b) -&gt; [a] -&gt; [b]\nmyMap p q [] = []\nmyMap p q [x] = [p x]\nmyMap p q (x : y : xs) = p x : q y : myMap p q xs\n</code></pre>\n\n<p>This function works fine. If I try to run it as <code>myMap (*2) (+0) [1,2,3,4]</code> it returns <code>[2,2,6,4]</code> which is the expected result.</p>\n\n<p>Than I'm trying to implement the luhn algorithm:</p>\n\n<pre><code>luhn :: [Int] -&gt; [Int]\nluhn [x] = myMap (*2) (+0) [x]\n</code></pre>\n\n<p>This is part of the algorithm, I'll change it to return a <code>Bool</code>, but I'm trying to run as this is and it gives me: </p>\n\n<blockquote>\n  <p>*** Exception: main.hs:92:1-30: Non-exhaustive patterns in function luhn</p>\n</blockquote>\n\n<p>Why is this happening?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574521542, "post_id": 59008886, "comment_id": 104266083, "body": "Can you show your code? What do you have do far? What specific problem are you facing?"}, {"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1574521568, "post_id": 59008886, "comment_id": 104266088, "body": "Welcome to Stack Overflow! Show us the code you have made so far."}, {"owner": {"reputation": 1, "user_id": 4181795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUUMv-7QctMS_NjzLFwcwcaP7JmD_zJui-pZC39g=k-s128", "display_name": "Jorge Federico Kleinman", "link": "https://stackoverflow.com/users/4181795/jorge-federico-kleinman"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574522228, "post_id": 59008886, "comment_id": 104266247, "body": "Thanks! I have added the code that i have, and also what i am not able to do @FyodorSoikin"}, {"owner": {"reputation": 1, "user_id": 4181795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUUMv-7QctMS_NjzLFwcwcaP7JmD_zJui-pZC39g=k-s128", "display_name": "Jorge Federico Kleinman", "link": "https://stackoverflow.com/users/4181795/jorge-federico-kleinman"}, "reply_to_user": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1574522253, "post_id": 59008886, "comment_id": 104266261, "body": "Added @JeroenHeier"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574533443, "post_id": 59008886, "comment_id": 104269511, "body": "When the compile attempt fails, what does the error say?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4181795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUUMv-7QctMS_NjzLFwcwcaP7JmD_zJui-pZC39g=k-s128", "display_name": "Jorge Federico Kleinman", "link": "https://stackoverflow.com/users/4181795/jorge-federico-kleinman"}, "edited": false, "score": 0, "creation_date": 1574523454, "post_id": 59009075, "comment_id": 104266572, "body": "Thanks @ymg, the thing is that on my problemm the xmlList is like this instead &quot;resourceA,3-resourceB,1-,...,resourceN,x&quot;, so this code works, but i dont know how to change the numner 1 that you put as double for the number that comes in the list that i mention"}, {"owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "reply_to_user": {"reputation": 1, "user_id": 4181795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUUMv-7QctMS_NjzLFwcwcaP7JmD_zJui-pZC39g=k-s128", "display_name": "Jorge Federico Kleinman", "link": "https://stackoverflow.com/users/4181795/jorge-federico-kleinman"}, "edited": false, "score": 0, "creation_date": 1574524687, "post_id": 59009075, "comment_id": 104266930, "body": "you&#39;re welcome @JorgeFedericoKleinmanQuepfe, I just realized my mistake and updated the code, hopefully it&#39;s helpful now"}, {"owner": {"reputation": 1, "user_id": 4181795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUUMv-7QctMS_NjzLFwcwcaP7JmD_zJui-pZC39g=k-s128", "display_name": "Jorge Federico Kleinman", "link": "https://stackoverflow.com/users/4181795/jorge-federico-kleinman"}, "edited": false, "score": 0, "creation_date": 1574525245, "post_id": 59009075, "comment_id": 104267063, "body": "Thanks! it is really helpfull for me"}], "tags": [], "owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "is_accepted": false, "score": 0, "last_activity_date": 1574524712, "last_edit_date": 1574524712, "creation_date": 1574522257, "answer_id": 59009075, "question_id": 59008886, "link": "https://stackoverflow.com/questions/59008886/haskell-convert-string-to-string-double/59009075#59009075", "title": "Haskell: Convert String to [(String,Double)]", "body": "<p>So in Haskell you dont really mutate any value, instead you'll create a new list of pairs from the string you've described, so the solution would look something similar to the following:</p>\n\n<pre><code>import Data.List.Split\n\n\nxmlList = splitOn \"-\" \"resourceA,3-resourceB,4-resourceC,6\"\n\ncommaSplit :: String -&gt; [String]\ncommaSplit = splitOn \",\"\n\nxmlPair :: [String] -&gt; [(String, Double)] -- might be more efficient to use Text instead of String\nxmlPair [x]    = [(\\x' -&gt; ((head x') :: String, (read (last x')) :: Double )) (commaSplit x)]\nxmlPair (x:xs) = xmlPair [x] ++ xmlPair xs\n\nmain :: IO ()\nmain = mapM_ (\\(a,b) -&gt; putStrLn (show a++\" = \"++ show b)) (xmlPair $ xmlList)\n</code></pre>\n\n<p>This is my quick and dirty way of showing things but I'm sure someone can always add a more detailed answer.</p>\n"}], "owner": {"reputation": 1, "user_id": 4181795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUUMv-7QctMS_NjzLFwcwcaP7JmD_zJui-pZC39g=k-s128", "display_name": "Jorge Federico Kleinman", "link": "https://stackoverflow.com/users/4181795/jorge-federico-kleinman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574533388, "creation_date": 1574520755, "last_edit_date": 1574533388, "question_id": 59008886, "link": "https://stackoverflow.com/questions/59008886/haskell-convert-string-to-string-double", "title": "Haskell: Convert String to [(String,Double)]", "body": "<p>I parse an XML and get an String like this:</p>\n\n<blockquote>\n  <p>\"resourceA,3-resourceB,1-,...,resourceN,x\"</p>\n</blockquote>\n\n<p>I want to map that String into a list of tuples (String,Double), like this:</p>\n\n<blockquote>\n  <p>[(resourceA,3),(resourceB,1),...,(resourceN,x)]</p>\n</blockquote>\n\n<p>How is it possible to do this? I ve looked into the map function and also the split one. I am able to split the string by \"-\" but anything else...</p>\n\n<p>This is the code i have so far:</p>\n\n<pre><code>split :: Eq a =&gt; a -&gt; [a] -&gt; [[a]]\nsplit d [] = []\nsplit d s = x : split d (drop 1 y) where (x,y) = span (/= d) s\n</code></pre>\n\n<p>it is just a function to split my string into a list of Stirng, but then i dont know how to continue.\nWhat I want to do know is to loop over that new list that i have created with the split method and for each element create a tuple. I hace tried with the map function but i dont get it to compile even</p>\n"}, {"tags": ["haskell", "code-cleanup"], "comments": [{"owner": {"reputation": 9895, "user_id": 452775, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/88963e7cc58eabf150447e7b78a24793?s=128&d=identicon&r=PG", "display_name": "Lii", "link": "https://stackoverflow.com/users/452775/lii"}, "edited": false, "score": 1, "creation_date": 1574522113, "post_id": 59007553, "comment_id": 104266221, "body": "When you test if a value is inside a range there is a way to format it to make it a little clearer: <code>min &lt;= n &amp;&amp; n &lt;= max</code>. This formatting indicates a little bit better that <code>n</code> lies between <code>min</code> and <code>max</code>."}, {"owner": {"reputation": 133, "user_id": 10807159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122278407941453/picture?type=large", "display_name": "Patrik Ba\u0161o", "link": "https://stackoverflow.com/users/10807159/patrik-ba%c5%a1o"}, "reply_to_user": {"reputation": 9895, "user_id": 452775, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/88963e7cc58eabf150447e7b78a24793?s=128&d=identicon&r=PG", "display_name": "Lii", "link": "https://stackoverflow.com/users/452775/lii"}, "edited": false, "score": 0, "creation_date": 1574523544, "post_id": 59007553, "comment_id": 104266601, "body": "Yeah right.. this is the best i can do I think"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 10807159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122278407941453/picture?type=large", "display_name": "Patrik Ba\u0161o", "link": "https://stackoverflow.com/users/10807159/patrik-ba%c5%a1o"}, "edited": false, "score": 0, "creation_date": 1574512254, "post_id": 59007616, "comment_id": 104263788, "body": "Thank you, I was thinking if there is some function like inRange in Prelude."}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "reply_to_user": {"reputation": 133, "user_id": 10807159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122278407941453/picture?type=large", "display_name": "Patrik Ba\u0161o", "link": "https://stackoverflow.com/users/10807159/patrik-ba%c5%a1o"}, "edited": false, "score": 1, "creation_date": 1574512431, "post_id": 59007616, "comment_id": 104263835, "body": "Oh, actually, not in Prelude, but <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ix.html#v:inRange\" rel=\"nofollow noreferrer\">there is</a>!"}, {"owner": {"reputation": 133, "user_id": 10807159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122278407941453/picture?type=large", "display_name": "Patrik Ba\u0161o", "link": "https://stackoverflow.com/users/10807159/patrik-ba%c5%a1o"}, "edited": false, "score": 0, "creation_date": 1574512600, "post_id": 59007616, "comment_id": 104263868, "body": "What a pity that we can use in homework only Prelude and Data.List ... But thank you for tip"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574518748, "post_id": 59007616, "comment_id": 104265293, "body": "<code>inRange</code> does require a stronger constraint on <code>a</code>, though."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574528975, "post_id": 59007616, "comment_id": 104268214, "body": "And there is no instance for <code>Double</code>, for example"}], "tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": false, "score": 2, "last_activity_date": 1574512506, "last_edit_date": 1574512506, "creation_date": 1574512130, "answer_id": 59007616, "question_id": 59007553, "link": "https://stackoverflow.com/questions/59007553/haskell-elegant-code-for-detecting-if-number-is-in-range/59007616#59007616", "title": "Haskell - Elegant code for detecting if number is in range", "body": "<p>I think this is as short as it can get out of the box. If this problem appears too often in your code to become annoying, you can extract it to a function, as suggested <a href=\"https://wiki.haskell.org/Comparison_chain\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>(&lt;?) :: Ord a =&gt; a -&gt; (a,a) -&gt; Bool\n(&lt;?) x (min, max) = x &gt;= min &amp;&amp; x &lt;= max\n</code></pre>\n\n<p>And then use as:</p>\n\n<pre><code>if x &lt;? (min, max) \n    then ... \n    else...\n</code></pre>\n\n<p><strong>Update</strong>: it turns out, there's also a function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ix.html#v:inRange\" rel=\"nofollow noreferrer\"><code>inRange</code></a> in the base package.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 10807159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122278407941453/picture?type=large", "display_name": "Patrik Ba\u0161o", "link": "https://stackoverflow.com/users/10807159/patrik-ba%c5%a1o"}, "edited": false, "score": 0, "creation_date": 1574529508, "post_id": 59010187, "comment_id": 104268374, "body": "Really interesting approach. Definitely will try to code some &#39;ternary&#39; operations with this method"}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": true, "score": 1, "last_activity_date": 1574529308, "creation_date": 1574529308, "answer_id": 59010187, "question_id": 59007553, "link": "https://stackoverflow.com/questions/59007553/haskell-elegant-code-for-detecting-if-number-is-in-range/59010187#59010187", "title": "Haskell - Elegant code for detecting if number is in range", "body": "<p>(The answer below is just a cute trick, I wouldn't actually recommend using it!)</p>\n\n<p>With some tricks, you can actually make operators that act kind of like ternary operators, so you get nice code to say \"in range\". Here's the operators in question:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>infixr 4 &lt;=!\ninfixr 4 !&lt;=\n(&lt;=!) :: Ord a =&gt; a -&gt; (Bool,a) -&gt; Bool\nlb &lt;=! (iub, x) = iub &amp;&amp; (lb &lt;= x)\n\n(!&lt;=) :: Ord a =&gt; a -&gt; a -&gt; (Bool,a)\nx !&lt;= ub = (x &lt;= ub, x)\n</code></pre>\n\n<p>You can use them like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;&gt;&gt; 1 &lt;=! 3 !&lt;= 5\nTrue\n&gt;&gt;&gt; 1 &lt;=! 0 !&lt;= 5\nFalse\n</code></pre>\n\n<p>You can even add strict relation operators:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>infixr 4 &lt;!\ninfixr 4 !&lt;\n(&lt;!) :: Ord a =&gt; a -&gt; (Bool,a) -&gt; Bool\nlb &lt;! (iub, x) = iub &amp;&amp; (lb &lt; x)\n\n(!&lt;) :: Ord a =&gt; a -&gt; a -&gt; (Bool,a)\nx !&lt; ub = (x &lt; ub, x)\n</code></pre>\n\n<p>And mix and match:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;&gt;&gt; 0 &lt;=! 2 !&lt;= 2\nTrue\n&gt;&gt;&gt; 0 &lt;=! 2 !&lt;  2\nFalse\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10807159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122278407941453/picture?type=large", "display_name": "Patrik Ba\u0161o", "link": "https://stackoverflow.com/users/10807159/patrik-ba%c5%a1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 59010187, "answer_count": 2, "score": 3, "last_activity_date": 1574529308, "creation_date": 1574511697, "question_id": 59007553, "link": "https://stackoverflow.com/questions/59007553/haskell-elegant-code-for-detecting-if-number-is-in-range", "title": "Haskell - Elegant code for detecting if number is in range", "body": "<p>I'm writing my homework and I found piece of code I don't think is elegant enought.. </p>\n\n<p>Exactly :</p>\n\n<pre><code>if n &gt;= min &amp;&amp; n &lt;= max \n    then ...\n    else ...\n</code></pre>\n\n<p>I want to ask if there is any more elegant way to write this code for checking if number is in range (min, max)</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1574508721, "post_id": 59007104, "comment_id": 104263084, "body": "please show an example call and its desired result."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574511262, "post_id": 59007194, "comment_id": 104263587, "body": "The inner parentheses in the second definition are unneeded."}], "tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": false, "score": 1, "last_activity_date": 1574511691, "last_edit_date": 1574511691, "creation_date": 1574509082, "answer_id": 59007194, "question_id": 59007104, "link": "https://stackoverflow.com/questions/59007104/haskell-filter-list-for-elements-of-second-list/59007194#59007194", "title": "Haskell : Filter list for elements of second list", "body": "<p>It's almost the same, just another filter function using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#g:14\" rel=\"nofollow noreferrer\"><code>elem</code></a>:</p>\n\n<pre><code>test a b :: [ExamScore] -&gt; [String] -&gt; [ExamScore]\ntest a b = filter (\\(s, _) -&gt; elem s b) a\n</code></pre>\n\n<p>Or, if you're more into the composition style:</p>\n\n<pre><code>test a b = filter (flip elem b . fst) a\n</code></pre>\n\n<p>(It's worth noting that it's not the most efficient way, since <code>elem</code> is <code>O(N)</code> for lists, so depending on your case you may want to find a better structure for storing the keys.)</p>\n"}], "owner": {"reputation": 13, "user_id": 12420495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14df1ecdc3d688561191fe9fa35c04b1?s=128&d=identicon&r=PG&f=1", "display_name": "mahjong", "link": "https://stackoverflow.com/users/12420495/mahjong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574511691, "creation_date": 1574508372, "question_id": 59007104, "link": "https://stackoverflow.com/questions/59007104/haskell-filter-list-for-elements-of-second-list", "title": "Haskell : Filter list for elements of second list", "body": "<p>I am currently trying to filter a list , that consist of tuples of the form (String , Double), for a List that consists of Strings. If the tuple doesn't contain a String of the second list, it should be removed from the list of tuples. So far I came up with this:</p>\n\n<pre><code>test :: [ExamScore] -&gt; String -&gt; [ExamScore]\ntest a b = filter ((== b).fst) a\n</code></pre>\n\n<p>My current problem is to replace the String that is filtered for by a list of Strings. Thanks for your help! Please go easy on me, I'm a first year informatics student that hasn't coded anytime before.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 7, "creation_date": 1574466831, "post_id": 59003241, "comment_id": 104256714, "body": "try <code>ordonata [1,2,3,4] (&lt;)</code> - the key part being the parentheses around the <code>&lt;</code> operator. When passing an operator to a higher-order function you always need the parentheses."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1574467359, "post_id": 59003241, "comment_id": 104256813, "body": "@RobinZigmond More accurately, when trying to use an operator as a function. This could be passing it, or it could be returning it; or it could simply be using it infix for some reason, e.g. <code>(&lt;) 2 3</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1574467681, "post_id": 59003241, "comment_id": 104256882, "body": "Apart from <code>(&lt;)</code>, some minor comments: <code>(tail(list))</code> can be written as <code>(tail list)</code>. <code>and (map predicate) list</code> can be written <code>all predicate list</code>. Tricky point: you do not need the empty case, since <code>zip [] (tail [])</code> will return the empty list without triggering the error on <code>tail []</code>. Hence, <code>ordonata list f = all (uncurry f) (zip list (tail list))</code> should work."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1574468359, "post_id": 59003241, "comment_id": 104256991, "body": "or <code>and (zipWith (uncurry f) list (tail list))</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574474875, "post_id": 59003241, "comment_id": 104257827, "body": "Small fix: <code>zipWith</code> doesn&#39;t need an uncurried function, so it&#39;s just <code>and (zipWith f list (tail list))</code>, or using the <code>Applicative</code> instance for functions, <code>and (zipWith f &lt;*&gt; tail $ list)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": false, "score": 0, "last_activity_date": 1574543658, "creation_date": 1574543658, "answer_id": 59012319, "question_id": 59003241, "link": "https://stackoverflow.com/questions/59003241/how-can-i-change-the-x-y-pair-with-a-generic-relation-between-them/59012319#59012319", "title": "How can I change the (x, y) pair with a generic relation between them?", "body": "<p>Your implementation is correct!</p>\n\n<p>When passing operators like <code>&gt;</code> as a function Haskell requires brackets around the operator: <code>(&gt;)</code>.</p>\n\n<p>You can use your function like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>ordonata [1, 2, 3, 4] (&lt;)\n</code></pre>\n\n<p>Looks like you're getting the hang of things!</p>\n\n<p>A few notes on style; firstly, most Haskell developers would swap the argument order of the function to:</p>\n\n<pre><code>ordonata :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>because it's more amenable to currying; with this version we can easily define partially applied functions:</p>\n\n<pre><code>ascending = ordanata (&lt;)\ndescending = ordanata (&gt;)\nallEq = ordanata (==)\n</code></pre>\n\n<p>Also you might want to check out <code>zipWith</code>; we can use it to clean things up a little:</p>\n\n<pre><code>ordonata :: [a] -&gt; (a -&gt; a -&gt; Bool) -&gt; Bool\nordonata [] f    = True\nordonata list f  = and (zipWith f list (tail list))\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10728388, "user_type": "registered", "profile_image": "https://graph.facebook.com/2102364663164338/picture?type=large", "display_name": "Andu M&#238;ndrescu", "link": "https://stackoverflow.com/users/10728388/andu-m%c3%aendrescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574543658, "creation_date": 1574466733, "question_id": 59003241, "link": "https://stackoverflow.com/questions/59003241/how-can-i-change-the-x-y-pair-with-a-generic-relation-between-them", "title": "How can I change the (x, y) pair with a generic relation between them?", "body": "<p>I am new to Haskell. I want to create a generic function to check if every 2 consecutive elements in a list are in a relation given by the user as input (eg: &lt;, >, ==)</p>\n\n<pre><code>ordonata :: [a] -&gt; (a -&gt; a -&gt; Bool) -&gt; Bool\nordonata [] f    = True\nordonata list f  = and (map (\\(x, y) -&gt; f x y ) (zip list (tail(list))))\n</code></pre>\n\n<p>The program compiles, but when I try the input \"ordonata[1, 2, 3, 4] &lt; \" I get this error: </p>\n\n<p>\"parse error (possibly incorrect indentation or mismatched brackets)\"</p>\n"}, {"tags": ["haskell", "higher-order-functions", "head"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1574460952, "post_id": 59002449, "comment_id": 104255217, "body": "You need to use proper brackets here, so <code>encryptOne (head t) [d1, d2, d3]</code>."}, {"owner": {"reputation": 68, "user_id": 8764068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052c2f3b7f9554cc83ab356144d67b09?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Willem", "link": "https://stackoverflow.com/users/8764068/jan-willem"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574461574, "post_id": 59002449, "comment_id": 104255393, "body": "That did solve it partially. I also found the solution, because I was returning a Char, while the encrypt should return a String"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1574463368, "post_id": 59002449, "comment_id": 104255876, "body": "So <code>encryptOne</code> returns <code>Char</code> type but you try to concatenate like <code>encryptOne (head t) [d1, d2, d3] ++ ...</code>. You should use cons <code>(:)</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 8764068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052c2f3b7f9554cc83ab356144d67b09?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Willem", "link": "https://stackoverflow.com/users/8764068/jan-willem"}, "is_accepted": false, "score": 0, "last_activity_date": 1574463258, "creation_date": 1574463258, "answer_id": 59002808, "question_id": 59002449, "link": "https://stackoverflow.com/questions/59002449/haskell-function-head-of-string-as-input-of-a-function/59002808#59002808", "title": "Haskell function head of string as input of a function", "body": "<p>Thanks to Willem I found the first problem, using parenthesis. </p>\n\n<p>The second problem was a type-problem regarding <code>encryptOne</code> . I added it to the question now, and it shows that it is returning a Char, while the encrypt function returns a String. I had to transform the result of <code>encryptOne</code> from Char to String to solve it:</p>\n\n<pre><code>charToString :: Char -&gt; String\ncharToString c = [c]\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 8764068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052c2f3b7f9554cc83ab356144d67b09?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Willem", "link": "https://stackoverflow.com/users/8764068/jan-willem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574463258, "creation_date": 1574460894, "last_edit_date": 1574463048, "question_id": 59002449, "link": "https://stackoverflow.com/questions/59002449/haskell-function-head-of-string-as-input-of-a-function", "title": "Haskell function head of string as input of a function", "body": "<p>I'm creating an Enigma Machine in Haskell and I have trouble with the following code:</p>\n\n<pre><code>encrypt :: String -&gt; [String] -&gt; String\nencrypt t [d1, d2, d3]\n  | length t &gt; 1 = encryptOne head t [d1, d2, d3] ++ encrypt (tail t) [d1, d2, rotateF d3]\n  | length t == 1 = encryptOne head t [d1, d2, d3]\n  | otherwise = \"\"\n</code></pre>\n\n<p>The encrypt-function takes a String, and recursively solves for each Char using the <code>encryptOne</code> function. Each iteration, the rotors are turned using a <code>rotateF</code> function (early stage, still working this out). The <code>encryptOne</code> function looks like this:</p>\n\n<pre><code>encryptOne :: Char -&gt; [String] -&gt; Char\n</code></pre>\n\n<p>The problem is the <code>encryptOne</code> head <code>t [d1, d2, d3]</code> section, where head <code>t</code> can't be solved, and the following error occurres</p>\n\n<pre><code>    length t == 1 = encryptOne head t [d1, d2, d3]\n                               ^^^^\n    * Couldn't match type `Char' with `[Char]'\n      Expected type: [String]\n        Actual type: String\n</code></pre>\n\n<p>Does anyone know how to refactor this section, so that head <code>t</code> returns the Char to use in <code>encryptOne</code>?</p>\n"}, {"tags": ["haskell", "optimization", "functional-programming", "recurrence"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 12, "creation_date": 1574444946, "post_id": 58999296, "comment_id": 104248995, "body": "This is not a simple refactoring. It completely changes the algorithm. At best, it is a form of advanced memoization: using memoization we would remember all the previously computed results, while in this case we only remember the last two since that&#39;s what we need. You can also see &quot;dynamic programming&quot; for a similar technique in algorithms."}, {"owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574449469, "post_id": 58999296, "comment_id": 104250847, "body": "@chi Yes, I agree this is not simple refactoring."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1574452737, "post_id": 58999296, "comment_id": 104252256, "body": "Are you familiar with memoization?"}], "answers": [{"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1574479973, "post_id": 58999970, "comment_id": 104258489, "body": "It&#39;s a bit of a stretch to say that this is closely related to <a href=\"https://stackoverflow.com/questions/tagged/monoids\">monoids</a>, <a href=\"https://stackoverflow.com/questions/tagged/tailrecursion-modulo-cons\">tailrecursion-modulo-cons</a>, <a href=\"https://stackoverflow.com/questions/tagged/corecusion\">corecusion</a>, or hylomorphisms."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1574503952, "post_id": 58999970, "comment_id": 104262128, "body": "@AaditMShah I disagree. I&#39;ve expanded my answer with the explanations. Thanks for commenting!"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1574504581, "last_edit_date": 1574504581, "creation_date": 1574447908, "answer_id": 58999970, "question_id": 58999296, "link": "https://stackoverflow.com/questions/58999296/what-is-this-functional-programming-optimization-called/58999970#58999970", "title": "What is this functional programming optimization called?", "body": "<p>Yes, it's called <a href=\"https://www.google.com/search?q=accumulating+parameter\" rel=\"nofollow noreferrer\">accumulating parameter</a> technique. (Here's <a href=\"https://stackoverflow.com/questions/19944969/prolog-accumulators-are-they-really-a-different-concept/19951540#19951540\">one of my answers</a>, about it). </p>\n\n<p>It's closely related to <a href=\"/questions/tagged/monoids\" class=\"post-tag\" title=\"show questions tagged &#39;monoids&#39;\" rel=\"tag\">monoids</a>, <a href=\"https://stackoverflow.com/tags/tailrecursion-modulo-cons/info\">tail-recursion-modulo-cons</a> (\"TRMC\"), <a href=\"/questions/tagged/corecursion\" class=\"post-tag\" title=\"show questions tagged &#39;corecursion&#39;\" rel=\"tag\">corecursion</a>, <a href=\"https://en.wikipedia.org/wiki/Hylomorphism_(computer_science)\" rel=\"nofollow noreferrer\">hylomorphism</a>s, <a href=\"https://stackoverflow.com/questions/tagged/fold\">folding</a>, etc.</p>\n\n<p>Monoids enable the re-parenthesization </p>\n\n<pre><code>a+(b+(c+...)) == (a+b)+(c+...) == ((a+b)+c)+...\n</code></pre>\n\n<p>which enables the accumulation. <a href=\"http://en.wikipedia.org/wiki/Tail_call#Tail_recursion_modulo_cons\" rel=\"nofollow noreferrer\">TRMC</a> (which came to be explicitly known in the context of Prolog) is the same, just with lists; </p>\n\n<pre><code>[a]++([b]++([c]++...)) == ([a]++[b])++([c]++...) == (([a]++[b])++[c])++...\n</code></pre>\n\n<p>and <a href=\"https://en.wikipedia.org/wiki/Corecursion\" rel=\"nofollow noreferrer\">corecursion</a> builds lists in top-down manner just like TRMC does. </p>\n\n<p>The answer linked above contains a link to the <a href=\"http://www.cs.indiana.edu/cgi-bin/techreports/TRNNN.cgi?trnum=TR19\" rel=\"nofollow noreferrer\">technical report from 1974</a> by Friedman and Wise, which essentially talks about accumulation in the context of the <code>+</code> monoid, as an example.</p>\n\n<p>There's no monoids in the Fibonacci example, but there's an accumulation of \"knowledge\" so to speak, as we go along from one Fibonacci number to the next. </p>\n"}], "owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574504581, "creation_date": 1574444697, "last_edit_date": 1574447963, "question_id": 58999296, "link": "https://stackoverflow.com/questions/58999296/what-is-this-functional-programming-optimization-called", "title": "What is this functional programming optimization called?", "body": "<p>Consider the following Haskell code for computing the nth Fibonacci number.</p>\n\n<pre><code>fib :: Int -&gt; Int\nfib 0 = 0\nfib 1 = 1\nfib n = fib (n - 1) + fib (n - 2)\n</code></pre>\n\n<p>This code is slow. We can optimize it by refactoring to a helper function that computes \"iteratively\", by \"storing\" all the relevant data to compute the recurrence with in its arguments, along with a \"counter\" that tells us how long to compute for.</p>\n\n<pre><code>fastfib :: Int -&gt; Int\nfastfib n = helper 1 0 n\n  where\n    helper a _ 1 = a\n    helper a b i = helper (a + b) a (i - 1)\n</code></pre>\n\n<p>It seems like this optimization could apply more broadly as well. Does it have a name, in the functional programming community or elsewhere?</p>\n"}, {"tags": ["haskell", "state-monad", "imperative"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1574445361, "post_id": 58999272, "comment_id": 104249187, "body": "I disagree with the downvotes, and I think this is a nice exercise on how to model imperative constructs (well, at long as you don&#39;t then use this style for everyday code :-)). Anyway, <code>State Integer</code> is not an appropriate monad for this unless your imperative programs will use only a single variable. You probably need <code>State (VariableName -&gt; Integer)</code>, or the <code>Map</code> analogous for more efficiency. For top efficiency, I&#39;d use <code>ST s</code> instead."}, {"owner": {"reputation": 313, "user_id": 12047827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/465cdede6feeb53d122d87d7ccd42c5e?s=128&d=identicon&r=PG&f=1", "display_name": "arryn", "link": "https://stackoverflow.com/users/12047827/arryn"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574446968, "post_id": 58999272, "comment_id": 104249869, "body": "@chi, what is <code>VariableName</code> here?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574450606, "post_id": 58999272, "comment_id": 104251310, "body": "It can be <code>String</code>, or whatever type you want to use for variable names. One can also use <code>Int</code>, in principle. If you want, there can be called &quot;locations&quot; or &quot;references&quot; instead, since you seem to create them with <code>var</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": true, "score": 6, "last_activity_date": 1574448847, "creation_date": 1574448847, "answer_id": 59000154, "question_id": 58999272, "link": "https://stackoverflow.com/questions/58999272/make-haskell-imperative/59000154#59000154", "title": "Make Haskell Imperative", "body": "<p>It goes without saying that this is a silly thing to do in Haskell; but I'm all for trying silly things if it helps you learn something.</p>\n\n<p>I think you should probably back off to a simpler problem and experiment with the State monad a bit more before trying something complex like this; from the code snippets you posted I suspect your intuition is a bit off.</p>\n\n<p>You CAN do this sort of thing of course, but it's tricky to handle variables of \"arbitrary\" type in a State monad (which must have a fixed type for the state). You can do it in a relatively type-safe way using <code>Dynamic</code> and <code>Proxy</code>; but I think that might still be a bit out of reach.</p>\n\n<p>We'll start by storing variables of just type Int. I'm not sure which <code>State</code> monad you're using, but I'll use the one from <code>mtl</code> instead.</p>\n\n<pre><code>import Control.Monad.State\nimport qualified Data.Map as M\nimport Data.Maybe\n\ndata Var = Var Int\n  deriving (Show, Eq, Ord)\n\ndata Env = Env {freshVar :: Int, vars :: M.Map Var Int}\n  deriving Show\n\ntype Imperative a = State Env a\n</code></pre>\n\n<p>I've defined the <code>Env</code> type which keeps track of all the variables we've \"created\", as well as a \"fresh name\" generator, which is just an Int that keeps counting upwards as we define variables.</p>\n\n<pre><code>lit :: Int -&gt; Imperative Var\nlit n = do\n    varID &lt;- gets freshVar\n    let newVar = Var varID\n    modify (\\s -&gt; s{freshVar=n+1, vars=(M.insert newVar n (vars s))})\n    return newVar\n</code></pre>\n\n<p>This code creates a new \"variable\" from a literal number, it does so by getting a fresh variable name from the environment, wrapping it in a constructor, then storing it in the environment with the provided value. Note that we bump the freshVar number so we'll get a different variable id for the next literal.</p>\n\n<pre><code>getVar :: Var -&gt; Imperative Int\ngetVar v = gets (fromJust . M.lookup v . vars)\n\nsetVar :: Var -&gt; Int -&gt; Imperative ()\nsetVar v n = modify (\\s -&gt; s{vars=M.insert v n (vars s)})\n</code></pre>\n\n<p>These are some helpers which look up variable or set variables in our Map of variables. <code>getVar</code> uses <code>fromJust</code> which is unsafe in general; but if you only define new variables with \"lit\" then it works fine.</p>\n\n<pre><code>op :: (Int -&gt; Int -&gt; Int) -&gt; Var -&gt; Var -&gt; Imperative ()\nop f aVar bVar = do\n    a &lt;- getVar aVar\n    b &lt;- getVar bVar\n    setVar aVar (f a b)\n\n(+=) = op (+)\n(-=) = op (-)\n(*=) = op (*)\n</code></pre>\n\n<p>To perform your version of a mutation operation we take two variables, look up their current values, perform the operation, then store the result into the variable on the left.</p>\n\n<p>Now we can define <code>while</code></p>\n\n<pre><code>while :: Imperative Bool -&gt; Imperative () -&gt; Imperative ()\nwhile cond act = do\n    continue &lt;- cond\n    if continue then act &gt;&gt; while cond act\n                else return ()\n</code></pre>\n\n<p>We can accept any imperative statement which returns a boolean as the condition; the user can look up the state of variables within the statement if they need to. We simply run the statement, if we want to continue we <code>act</code> and then recurse, otherwise we return.</p>\n\n<pre><code>f :: Int -&gt; Int\nf n = run $ do\n  i &lt;- lit n\n  while ((&gt;0) &lt;$&gt; getVar i) $ do\n    one &lt;- lit 1\n    i -= one\n  getVar i\n</code></pre>\n\n<p>It's a bit wordy (we could simplify it down, but it would make the combinators more complex). We define our <code>i</code> as a new variable with the value <code>n</code>, then check whether it's greater than <code>0</code> in the condition. In the loop body we define a variable with the value <code>1</code>, then subtract it from the variable <code>i</code>.</p>\n\n<p>After the loop terminates we check the value of <code>i</code></p>\n\n<pre><code>run :: Imperative a -&gt; a\nrun m = evalState m (Env 0 M.empty)\n</code></pre>\n\n<p>Here's the <code>run</code> function we used above, which simply runs state with no variables defined.</p>\n\n<p>If you try it out you'll see it successfully hits zero; and you can add a trace statement to see which values it hits:</p>\n\n<pre><code>import Debug.Trace\nf :: Int -&gt; Int\nf n = run $ do\n  i &lt;- lit n\n  while ((&gt;0) &lt;$&gt; getVar i) $ do\n    getVar i &gt;&gt;= traceShowM\n    one &lt;- lit 1\n    i -= one\n  getVar i\n\n&gt;&gt;&gt; f 10\n10\n9\n8\n7\n6\n5\n4\n3\n2\n1\n0\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 12047827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/465cdede6feeb53d122d87d7ccd42c5e?s=128&d=identicon&r=PG&f=1", "display_name": "arryn", "link": "https://stackoverflow.com/users/12047827/arryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 59000154, "answer_count": 1, "score": 1, "last_activity_date": 1574448847, "creation_date": 1574444563, "last_edit_date": 1574447800, "question_id": 58999272, "link": "https://stackoverflow.com/questions/58999272/make-haskell-imperative", "title": "Make Haskell Imperative", "body": "<p>Note: this is an exercise, and I'm trying to understand how things work.</p>\n\n<p>I am trying to make it possible to do something like this in Haskell:</p>\n\n<pre><code>f :: Integer -&gt; Integer\nf n = def $ do\n  i      &lt;- var n\n  while i (&gt;0) $ do\n    i      -= lit 1\n  return i\n-- for now, my program returns n \n</code></pre>\n\n<p>Below is my program. At this point, I cannot understand why it doesn't work, but for some reason, the variables are not changing.</p>\n\n<pre><code>import Control.Monad.State\n\n\ndata Lit a = Lit a\ntype Variable a = State Integer a\n\n\ndef :: Variable (Lit a) -&gt; a\ndef (State f) = fromLit . fst . f $ 0 \n\nfromLit :: Lit a -&gt; a\nfromLit (Lit a) = a\n\nlit :: a -&gt; Lit a\nlit l = Lit l\n\nvar :: a -&gt; Variable (Lit a)\nvar v = State $ \\x -&gt; (lit v, x)\n\nwhile :: Lit a -&gt; (a -&gt; Bool) -&gt; Variable () -&gt; Variable ()\nwhile (Lit r) cond act = do\n                 if cond r then do\n                          _ &lt;- act\n                          while (Lit r) cond act\n                    -- or act &gt;&gt; while (Lit r) cond act\n                 else return ()\n\n\nop :: (Integer -&gt; Integer -&gt; Integer) -&gt; Lit Integer -&gt; Lit Integer -&gt; Variable ()\nop f (Lit a) (Lit b) = State $ \\n -&gt; ((), if n == a then f a b else n)\n-- that is, if the state is (a) change it to (f a b), else don't change it\n\n(+=) = op (+)\n(-=) = op (-)\n(*=) = op (*)\n</code></pre>\n\n<p>Please, help me to understand what is wrong here and how to improve the code. Thank you.</p>\n"}, {"tags": ["list", "haskell", "split", "fold"], "answers": [{"comments": [{"owner": {"reputation": 525, "user_id": 1651361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b933ade78a3db95c560fdf309daf56?s=128&d=identicon&r=PG", "display_name": "GreenhouseVeg", "link": "https://stackoverflow.com/users/1651361/greenhouseveg"}, "edited": false, "score": 3, "creation_date": 1574424991, "post_id": 58994050, "comment_id": 104238537, "body": "could you also comment on why lazy pattern matching is used in this example?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574430990, "post_id": 58994050, "comment_id": 104241723, "body": "<a href=\"https://wiki.haskell.org/Lazy_pattern_match\" rel=\"nofollow noreferrer\">wiki.haskell.org/Lazy_pattern_match</a> discusses the difference between <code>~(a, b)</code> and <code>(a, b)</code> using <code>splitAt :: Int -&gt; [a] -&gt; ([a], [a])</code> as an example. I think the same (or at least a similar) argument will apply to <code>split</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574431162, "post_id": 58994050, "comment_id": 104241824, "body": "Basically, if the fold function uses a strict pattern match, it would have to recurse all the way to the end of the list to reach <code>([], [])</code> to ensure that there <i>is</i> a pair to unpatch. The function with lazy pattern matching is equivalent to <code>(\\a p -&gt; (a:fst p, snd p))</code>, which doesn&#39;t care if <code>p</code> is a pair until later."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 5, "last_activity_date": 1574595998, "last_edit_date": 1574595998, "creation_date": 1574424672, "answer_id": 58994050, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell/58994050#58994050", "title": "Walk through a list split function in Haskell", "body": "<p>Let\u2019s try running this function on a sample input list, say <code>[1,2,3,4,5]</code>:</p>\n\n<ol>\n<li>We start with <code>foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [1,2,3,4,5]</code>. Here <code>a</code> is the first element of the list, and <code>(x,y)</code> start out as <code>([],[])</code>, so <code>(a:y,x)</code> returns <code>([1],[])</code>.</li>\n<li>The next element of the input list is <code>a = 2</code>, and <code>(x,y) = ([1],[])</code>, so <code>(a:y,x) = ([2],[1])</code>. Note that the order of the lists has swapped. Each iteration will swap the lists again; however, the next element of the input list will always be added to the first list, which is how the splitting works.</li>\n<li>The next element of the input list is <code>a = 3</code>, and <code>(x,y) = ([2],[1])</code>, so <code>(a:y,x) = ([3,1],[2])</code>.</li>\n<li>The next element of the input list is <code>a = 4</code>, and <code>(x,y) = ([3,1],[2])</code>, so <code>(a:y,x) = ([4,2],[3,1])</code>.</li>\n<li>The next element of the input list is <code>a = 4</code>, and <code>(x,y) = ([4,2],[3,1])</code>, so <code>(a:y,x) = ([5,3,1],[4,2])</code>.</li>\n<li>There are no more elements left, so the return value is <code>([5,3,1],[4,2])</code>.</li>\n</ol>\n\n<p>As the walkthrough shows, the split function works by maintaining two lists, swapping them on each iteration, and appending each element of the input to a different list.</p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574426133, "post_id": 58994121, "comment_id": 104239182, "body": "The result should be <code>([1,2],[4,5])</code> i suppose."}, {"owner": {"reputation": 37091, "user_id": 521070, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6e5c24c66968738e5afe3a694cb11570?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/521070/michael"}, "edited": false, "score": 0, "creation_date": 1574427263, "post_id": 58994121, "comment_id": 104239787, "body": "Thanks. One more question: Does this code work with <code>foldl</code> instead of <code>foldr</code> ? Why ?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 37091, "user_id": 521070, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6e5c24c66968738e5afe3a694cb11570?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/521070/michael"}, "edited": false, "score": 0, "creation_date": 1574427422, "post_id": 58994121, "comment_id": 104239871, "body": "@Michael: the items will be in reversed order, and furthermore depending on the length of the function the first item of the list will be in the first or second item of the 2-tuple."}, {"owner": {"reputation": 37091, "user_id": 521070, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6e5c24c66968738e5afe3a694cb11570?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/521070/michael"}, "edited": false, "score": 0, "creation_date": 1574427993, "post_id": 58994121, "comment_id": 104240182, "body": "Got it. Thank you."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1574426189, "last_edit_date": 1574426189, "creation_date": 1574424989, "answer_id": 58994121, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell/58994121#58994121", "title": "Walk through a list split function in Haskell", "body": "<p>We can take a look at an example. For example if we have a list <code>[1, 4, 2, 5]</code>. If we thus process the list, then we see that <code>foldr</code> will be calculated as:</p>\n\n<pre><code>foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [1,4,2,5]</code></pre>\n\n<p>So here <code>a</code> is first the first item of the list, and then it will tus return something like:</p>\n\n<pre><code>(1:<b>y</b>, <b>x</b>)\n    where (<b>x</b>, <b>y</b>) = foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [4,2,5]</code></pre>\n\n<p>Notice that here the <code>(x, y)</code> tuple is <em>swapped</em> when we prepend <code>a</code> to the first item of the 2-tuple.</p>\n\n<pre><code>(1:y, x)\n    where (x, y) = (4:<b>y'</b>, <b>x'</b>)\n          (<b>x'</b>, <b>y'</b>) = foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [2,5]</code></pre>\n\n<p>and if we keep doing that, we thus obtain:</p>\n\n<pre><code>(1:y, x)\n    where (x, y) = (4:y', x')\n          (x', y') = (2:<b>y''</b>, <b>x''</b>)\n          (x'', y'') = (5:<b>y'''</b>, <b>x'''</b>)\n          (x''', y''') = foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) []</code></pre>\n\n<p>Since we reached the end of the list, we thus obtain for the <code>foldr &hellip; ([], []) []</code>, the 2-tuple <code>([], [])</code>:</p>\n\n<pre><code>(1:y, x)\n    where (x, y) = (4:y', x')\n          (x', y') = (2:y'', x'')\n          (x'', y'') = (5:y''', x''')\n          (x''', y''') = ([],[])</code></pre>\n\n<p>So <code>x''' = []</code> and <code>y''' = []</code>, so thus this is resolved to:</p>\n\n<pre><code>(1:y, x)\n    where (x, y) = (4:y', x')\n          (x', y') = (2:y'', x'')\n          (x'', y'') = (5:[], [])\n          (x''', y''') = ([],[])</code></pre>\n\n<p>so <code>x'' = [5]</code> and <code>y'' = []</code>:</p>\n\n<pre><code>(1:y, x)\n    where (x, y) = (4:y', x')\n          (x', y') = (2:[], [5])\n          (x'', y'') = (5:[], [])\n          (x''', y''') = ([],[])</code></pre>\n\n<p>so <code>x' = [5]</code> and <code>y' = [2]</code>:</p>\n\n<pre><code>(1:y, x)\n    where (x, y) = (4:[5], [2])\n          (x', y') = (2:[], [5])\n          (x'', y'') = (5:[], [])\n          (x''', y''') = ([],[])</code></pre>\n\n<p>so <code>x = [4, 5]</code> and <code>y = [2]</code> so eventually we obtain:</p>\n\n<pre><code>(1:[2], [4,5])\n    where (x, y) = (4:[5], [2])\n          (x', y') = (2:[], [5])\n          (x'', y'') = (5:[], [])\n          (x''', y''') = ([],[])</code></pre>\n\n<p>so the result is the expected <code>([1,2], [4,5])</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574441074, "post_id": 58994593, "comment_id": 104247159, "body": "This doesn&#39;t explain why the code in question uses a lazy pattern, though. It&#39;s not trying to protect against a pattern-match failure."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574441537, "post_id": 58994593, "comment_id": 104247407, "body": "@chepner Your comment under one of the answers explains it well so people should not overlook that. Then i can not make sure if this has an effect on the performance since either way you have to process the list all the way, right..?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1574444324, "post_id": 58994593, "comment_id": 104248714, "body": "no, we don&#39;t have to process all the list, all the way. if we call <code>take 2 . fst $ foldr ...</code>, only the first two elements of the first split will be returned, i.e. only the first <i>three</i> positions in the input list&#39;s spine will be accessed. but without the <code>~</code>, yes, the <i>whole</i> list would be accessed, regardless."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574466226, "post_id": 58994593, "comment_id": 104256579, "body": "@WillNess <code>take 2 . fst</code> is a good point but i can not make sure since the workflow is right to left. Doesn&#39;t it have to process all the list all the way in order to find what eventually ends up at the first two positions of the first list in the tuple?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574502510, "post_id": 58994593, "comment_id": 104261853, "body": "no. see my answer, under &quot;But truly&quot;. e.g. <code>take 1 . fst</code> causes just one reduction: <code>(a:y,x)</code> is already known after it (with <code>y</code>, <code>x</code> still unknown) and it is all we need for <code>take 1</code> to complete."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1574443779, "last_edit_date": 1574443779, "creation_date": 1574426800, "answer_id": 58994593, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell/58994593#58994593", "title": "Walk through a list split function in Haskell", "body": "<p>So everything happens in the <code>\\a ~(x,y) -&gt; (a:y,x)</code> function where in first turn <code>a</code> is the last item from of the provided list and <code>(x,y)</code> is an alternating tuple accumulator that starts with <code>([],[])</code>. The current element gets prepended to <code>y</code> by <code>a:y</code> but then the <code>x</code> and <code>y</code> lists in tuple gets swapped.</p>\n\n<p>However it's worth to mention that, all new appendings are returned on the first side of the tuple which guarantees the first side eventually starts with the first item of the list since it gets appended the last.</p>\n\n<p>So for a list of <code>[1,2,3,4,5,6]</code> the steps are follows</p>\n\n<pre><code>a          (x   ,   y)      return\n----------------------------------\n6       ([]     , []     ) (6:y, x)\n5       ([6]    , []     ) (5:y, x)\n4       ([5]    , [6]    ) (4:y, x)\n3       ([4,6]  , [5]    ) (3:y, x)\n2       ([3,5]  , [4,6]  ) (2:y, x)\n1       ([2,4,6], [3,5]  ) (1:y, x)\n[]      ([1,3,5], [2,4,6]) no return\n</code></pre>\n\n<p>Regarding the tilde <code>~</code> operator it is best described in the <a href=\"https://en.wikibooks.org/wiki/Haskell/Laziness\" rel=\"nofollow noreferrer\">Haskell/Laziness</a> topic of Haskell guide as follows</p>\n\n<blockquote>\n  <p>Prepending a pattern with a tilde sign delays the evaluation of the\n  value until the component parts are actually used. But you run the\n  risk that the value might not match the pattern \u2014 you're telling the\n  compiler 'Trust me, I know it'll work out'. (If it turns out it\n  doesn't match the pattern, you get a runtime error.) To illustrate the\n  difference:</p>\n</blockquote>\n\n<pre><code>Prelude&gt; let f (x,y) = 1\nPrelude&gt; f undefined\n*** Exception: Prelude.undefined\n\nPrelude&gt; let f ~(x,y) = 1\nPrelude&gt; f undefined\n1\n</code></pre>\n\n<blockquote>\n  <p>In the first example, the value is evaluated because it has to match\n  the tuple pattern. You evaluate undefined and get undefined, which\n  stops the proceedings. In the latter example, you don't bother\n  evaluating the parameter until it's needed, which turns out to be\n  never, so it doesn't matter you passed it undefined.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1574598727, "last_edit_date": 1574598727, "creation_date": 1574439059, "answer_id": 58997960, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell/58997960#58997960", "title": "Walk through a list split function in Haskell", "body": "<p>Approximately,</p>\n\n<pre><code>foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [a,b,c,d,e]\n=\nlet g a ~(x,y) = (a:y,x) in\ng a $ g b $ g c $ g d $ g e ([],[])\n=\ng a $ g b $ g c $ g d $ ([e],[])\n=\ng a $ g b $ g c $ ([d],[e])\n=\ng a $ g b $ ([c,e],[d])\n=\ng a $ ([b,d],[c,e])\n=\n([a,c,e],[b,d])\n</code></pre>\n\n<p>But truly,</p>\n\n<pre><code>foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [a,b,c,d,e]\n=\nlet g a ~(x,y) = (a:y,x) in\ng a $ foldr g ([],[]) [b,c,d,e]\n=\n(a:y,x) where \n    (x,y) = foldr g ([],[]) [b,c,d,e]\n=\n(a:y,x) where \n    (x,y) = (b:y2,x2) where\n                 (x2,y2) = foldr g ([],[]) [c,d,e]\n=\n(a:y,x) where \n    (x,y) = (b:y2,x2) where\n                 (x2,y2) = (c:y3,x3) where\n                                (x3,y3) = (d:y4,x4) where\n                                               (x4,y4) = (e:y5,x5) where\n                                                              (x5,y5) = ([],[])\n</code></pre>\n\n<p>which is forced in the <em>top-down</em> manner by access (if and when), being progressively fleshed-out as, e.g.,</p>\n\n<pre><code>=\n(a:x2,b:y2) where \n                 (x2,y2) = (c:y3,x3) where\n                                (x3,y3) = (d:y4,x4) where\n                                               (x4,y4) = (e:y5,x5) where\n                                                              (x5,y5) = ([],[])\n=\n(a:c:y3,b:x3) where \n                                (x3,y3) = (d:y4,x4) where\n                                               (x4,y4) = (e:y5,x5) where\n                                                              (x5,y5) = ([],[])\n=\n(a:c:x4,b:d:y4) where \n                                               (x4,y4) = (e:y5,x5) where\n                                                              (x5,y5) = ([],[])\n=\n(a:c:e:y5,b:d:x5) where \n                                                              (x5,y5) = ([],[])\n=\n(a:c:e:[],b:d:[]) \n</code></pre>\n\n<p>but it could be that the forcing will be done in a different order, depending on how it is called, e.g.</p>\n\n<pre><code>print . (!!1) . snd $ foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [a,b,c,d,e]\nprint . (!!2) . fst $ foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) [a,b,c,d,e]\n</code></pre>\n\n<p>etc. </p>\n\n<hr>\n\n<p><em>edit:</em> to address the questions about the lazy pattern, it is done for proper laziness of the resulting function:</p>\n\n<ul>\n<li><p><strong><code>foldr</code></strong> with the combining function which is <strong>strict</strong> in its second argument, encodes <em>recursion</em>, which is <em>bottom-up</em>. The result of recursively processing the rest of the list is constructed first, and the head portion of the result is combined with that, afterwards.</p></li>\n<li><p><strong><code>foldr</code></strong> with the combining function which is <strong>lazy</strong> in its second argument, encodes <em>corecursion</em>, which is <em>top-down</em>. The head portion of the resulting value is constructed first, and the rest is filled out later. It is very reminiscent of <em>tail recursion modulo cons</em>, in Prolog and elsewhere. Lazy evaluation as a concept came from \"<code>CONS</code> should not evaluate its arguments\"; TRMC does not evaluate the <em>second</em> argument to the constructor until later, which is what really matters.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1574446748, "last_edit_date": 1574446748, "creation_date": 1574445209, "answer_id": 58999408, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell/58999408#58999408", "title": "Walk through a list split function in Haskell", "body": "<p>Effectively, the fold function alternates which list the next item from the input list is added to. A similar function in a language like Python would be</p>\n\n<pre><code>def split(xs):\n    a0 = a = []\n    b0 = b = []\n    for x in xs:\n        a.append(x)\n        a, b = b, a\n    return a0, b0\n</code></pre>\n\n<hr>\n\n<p>A lazy pattern is used for two reasons:</p>\n\n<ol>\n<li>To allow consuming the resulting lists immediately, without waiting for <code>foldr</code> to consume all the input</li>\n<li>To allow splitting of infinite lists.</li>\n</ol>\n\n<p>Consider this example:</p>\n\n<pre><code>let (odds, evens) = foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[]) $ [1..]\nin take 5 odds\n</code></pre>\n\n<p>The result is <code>[1,3,5,7,9]</code>.</p>\n\n<p>If you dropped the lazy pattern and used</p>\n\n<pre><code>let (odds, evens) = foldr (\\a (x,y) -&gt; (a:y,x)) ([],[]) $ [1..]\nin take 10 odds\n</code></pre>\n\n<p>the code would never terminate, because <code>take</code> couldn't get the first element (let alone the first five) without first computing the entire list of odd values.</p>\n\n<p>Why is that? Consider the definition of <code>Data.List.foldr</code>:</p>\n\n<pre><code>foldr k z = go\n  where\n    go [] = z\n    go (y:ys) = y `k` go ys\n</code></pre>\n\n<p>If <code>k = \\a (x,y) -&gt; (a:y, x)</code> is strict in both arguments, then the evaluation of <code>y `k` go ys</code> doesn't terminate until the base case of <code>go</code> is reached.</p>\n\n<p>Using a lazy pattern, the function is equivalent to</p>\n\n<pre><code>\\a p -&gt; (a:snd p, fst p)\n</code></pre>\n\n<p>meaning we never have to match on <code>p</code> until <code>fst</code> or <code>snd</code> does so; the function is now lazy in its second argument. That means that</p>\n\n<pre><code>go (y:ys) = y `k` go ys\n          = (\\a p -&gt; (a:snd p, fst p)) y (go ys)\n          = let p = go ys in (y:snd p, fst p)\n</code></pre>\n\n<p>returns immediately without further evaluating <code>go</code>. Only once we try to get the second element of either list do we need to call <code>go</code> again, but once again we only have to progress one step.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1574445215, "creation_date": 1574445215, "answer_id": 58999410, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell/58999410#58999410", "title": "Walk through a list split function in Haskell", "body": "<p>Let's translate the fold away.</p>\n\n<pre><code>splatter :: [a] -&gt; ([a], [a])\nsplatter = foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[])\n</code></pre>\n\n<p>What's this mean? <code>foldr</code> for lists is defined</p>\n\n<pre><code>foldr :: (a -&gt; r -&gt; r) -&gt; r -&gt; [a] -&gt; r\nfoldr k z = go\n  where\n    go [] = z\n    go (p : ps) = p `k` go ps\n</code></pre>\n\n<p>Let's inline it and simplify:</p>\n\n<pre><code>splatter = go\n  where\n    go [] = ([], [])\n    go (p : ps) =\n      (\\a ~(x,y) -&gt; (a:y,x)) p (go ps)\n\nsplatter = go\n  where\n    go [] = ([], [])\n    go (p : ps) =\n      (\\ ~(x,y) -&gt; (p:y,x)) (go ps)\n\nsplatter = go\n  where\n    go [] = ([], [])\n    go (p : ps) =\n      let (x, y) = go ps\n      in (p : y, x)\n</code></pre>\n\n<p>The lazy-by-default pattern match in the <code>let</code> means that we don't actually actually make the recursive call until someone forces <code>x</code> or <code>y</code>.</p>\n\n<p>The key thing to notice is that <code>x</code> and <code>y</code> swap places on each recursive call. This leads to the alternating pattern.</p>\n"}], "owner": {"reputation": 37091, "user_id": 521070, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6e5c24c66968738e5afe3a694cb11570?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/521070/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 58994050, "answer_count": 6, "score": 6, "last_activity_date": 1574598727, "creation_date": 1574422843, "last_edit_date": 1574440533, "question_id": 58993547, "link": "https://stackoverflow.com/questions/58993547/walk-through-a-list-split-function-in-haskell", "title": "Walk through a list split function in Haskell", "body": "<p>This is a follow up to my previous <a href=\"https://stackoverflow.com/questions/58974560/split-a-sequence-into-two-alternating-sequences\">question</a>.</p>\n\n<p>I am trying to understand the list splitting example in Haskell from <a href=\"https://wiki.haskell.org/Blow_your_mind\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>foldr (\\a ~(x,y) -&gt; (a:y,x)) ([],[])\n</code></pre>\n\n<p>I can read Haskell and know what <code>foldr</code> is but don't understand this code. Could you walk me through this code and explain it in more details ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10400620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84713199bc4b8f53e84569854c49dde5?s=128&d=identicon&r=PG&f=1", "display_name": "clickedok", "link": "https://stackoverflow.com/users/10400620/clickedok"}, "edited": false, "score": 0, "creation_date": 1574422290, "post_id": 58993212, "comment_id": 104237225, "body": "&quot;if you use the two generators, you will iterate over all possible combinations..&quot;, Thanks for the enlightenment."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1574421653, "creation_date": 1574421653, "answer_id": 58993212, "question_id": 58993130, "link": "https://stackoverflow.com/questions/58993130/haskell-create-list-by-adding-element-from-one-list-only-if-its-equal-to-eleme/58993212#58993212", "title": "Haskell - Create list by adding element from one list only if its equal to element at same index in another list", "body": "<p>If you use the two generators, you will iterate over all possible combinations of the elements in the first list (<code>a</code>) and second list (<code>b</code>).</p>\n\n<p>You probably want to use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\"><strong><code>zip :: [a] -&gt; [b] -&gt; [(a, b)]</code></strong></a> here where we iterate over the two lists <em>concurrently</em>:</p>\n\n<pre><code>test a b = [x | (x, y) &lt;- <b>zip</b> a b, x == y]</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10400620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84713199bc4b8f53e84569854c49dde5?s=128&d=identicon&r=PG&f=1", "display_name": "clickedok", "link": "https://stackoverflow.com/users/10400620/clickedok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 58993212, "answer_count": 1, "score": 1, "last_activity_date": 1574421653, "creation_date": 1574421378, "question_id": 58993130, "link": "https://stackoverflow.com/questions/58993130/haskell-create-list-by-adding-element-from-one-list-only-if-its-equal-to-eleme", "title": "Haskell - Create list by adding element from one list only if its equal to element at same index in another list", "body": "<p>Here is the problem I want to solve: </p>\n\n<p>The two lists <code>[1,2,3,4] [2,2,3,4]</code> is to become <code>[2,3,4]</code> , because elements at index position zero are not equal. So elements are compared for equality with respect to their index. You can assume equal length lists as input. </p>\n\n<p>So I created a function that solved this with recursion:</p>\n\n<pre><code>oneHelper :: (Eq t) =&gt; [t] -&gt; [t] -&gt; [t]\noneHelper [] [] = [] \noneHelper (x:xs) (y:ys) = if x == y then [x] ++ oneHelper xs ys\n                          else oneHelper xs ys\n</code></pre>\n\n<p>Then I tried to solve it with list comprehension like this:</p>\n\n<pre><code>test a b = [x | x &lt;- a, y &lt;- b, x == y]\n</code></pre>\n\n<p>which just gives me <code>[2,2,3,4]</code> with example input above used. I feel like there is a neat way of solving this with a list comprehension, or just a more neat way than the solution I came up with in general, but I am struggling to reach that solution. Does anyone see something better than what I did for the problem?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "binary-search-tree"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 3, "creation_date": 1574409890, "post_id": 58989866, "comment_id": 104230994, "body": "<code>makeUnhollow</code> currently doesn&#39;t recurse into the tree. Make it recursive."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574441476, "post_id": 58991394, "comment_id": 104247383, "body": "or even &quot;unhollowed&quot;, for a more <i>declarative</i> feel to it. :)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574452873, "post_id": 58991394, "comment_id": 104252298, "body": "What if <code>left</code> and <code>right</code> both unhollow to <code>Empty</code> in the recursive case?"}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 3, "last_activity_date": 1574415621, "creation_date": 1574415621, "answer_id": 58991394, "question_id": 58989866, "link": "https://stackoverflow.com/questions/58989866/delete-empty-nodes-from-tree/58991394#58991394", "title": "delete empty nodes from tree", "body": "<p>Deleting <em>all</em> <code>Empty</code> children in a tree seems a little difficult:</p>\n\n<ul>\n<li><code>Node a Empty Empty</code> can become <code>Leaf a</code></li>\n<li>What if your root node is <code>Empty</code>?</li>\n<li>What will <code>Node a Empty (Leaf b)</code> be?</li>\n</ul>\n\n<p>I understand from your test that your goal is just to turn <code>Node a Empty Empty</code> into <code>Leaf a</code>, and not care when only one child is <code>Empty</code>. Mark Seemann's suggestion to turn <code>makeUnhollow</code> into a recursive function means you have to make it call itself in the last case of:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>makeUnhollow :: Tree a -&gt; Tree a\nmakeUnhollow (Node a Empty Empty) = Leaf a\nmakeUnhollow (Leaf a) = Leaf a\nmakeUnhollow Empty = ?                --  don't forget to match Empty\nmakeUnhollow (Node a left right) = ?  --  recurse on left, right :: Tree a\n</code></pre>\n\n<p>I might just call the function <code>unhollow</code> since that's an imperative verb, too.</p>\n"}], "owner": {"reputation": 31, "user_id": 12379345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6e59356fbc90c386550e0b8e4b4a08?s=128&d=identicon&r=PG&f=1", "display_name": "Wornz94", "link": "https://stackoverflow.com/users/12379345/wornz94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574415621, "creation_date": 1574409537, "question_id": 58989866, "link": "https://stackoverflow.com/questions/58989866/delete-empty-nodes-from-tree", "title": "delete empty nodes from tree", "body": "<p>I want to implement a function which deletes any empty children in a tree:</p>\n\n<pre><code>makeUnhollow (Node 5 Empty Empty) =&gt; Leaf 5\nmakeUnhollow (Leaf 5) =&gt; Leaf 5\nmakeUnhollow (Node 5 (Leaf 4) Empty) =&gt; (Node 5 (Leaf 4) Empty)\n</code></pre>\n\n<p>This is my current code:</p>\n\n<pre><code>makeUnhollow :: Tree a -&gt; Tree a\nmakeUnhollow  (Node a Empty Empty)= Leaf a\nmakeUnhollow (Leaf a) = Leaf a\nmakeUnhollow a = a\n</code></pre>\n\n<p>But somehow I'm getting failures for this code:</p>\n\n<pre><code>Tests.hs:130:\nwrong result\nexpected: Node 6 (Leaf 5) (Leaf 7)\nbut got: Node 6 (Node 5 Empty Empty) (Node 7 Empty Empty)\n</code></pre>\n"}, {"tags": ["function", "haskell", "recursion", "switch-statement", "haskell-prelude"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1574397035, "post_id": 58986486, "comment_id": 104226910, "body": "Honestly the weird mix of layout-based formatting with manual curly braces / semicolons makes it hard for me to tell what the compiler thinks your code means. It would be easier to understand if you stripped all the <code>{};</code> characters and just laid things out normally."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574446088, "post_id": 58986486, "comment_id": 104249525, "body": "Warning: <code>true</code> is not <code>True</code>, it is a variable name like any other, and it will match with any boolean value including <code>False</code>! Enable warnings to help GHC to spot such mistakes."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574450875, "post_id": 58986486, "comment_id": 104251428, "body": "Everybody is whining about the formatting but @chi has noticed the real problem"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1574408158, "creation_date": 1574408158, "answer_id": 58989537, "question_id": 58986486, "link": "https://stackoverflow.com/questions/58986486/im-having-an-error-with-haskell-with-cases-that-i-cant-find/58989537#58989537", "title": "Im having an error with Haskell with cases that i cant find", "body": "<p>While you can, in a pinch, use curly brackets and semicolons, Haskell isn't a C-based language. It <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation\" rel=\"nofollow noreferrer\">idiomatically uses indentation</a> to indicate function scope.</p>\n\n<p>Something like this would be more idiomatic:</p>\n\n<pre><code>agregarMon :: Monomio -&gt; Polinomio -&gt; Polinomio\nagregarMon = \\m p -&gt; case m of\n                      (0,0) -&gt; p\n                      x -&gt; case p of\n                            [] -&gt; [x]\n                            y:ys -&gt; case (snd x == snd y) of\n                                      true -&gt; case ((fst x + fst y)==0) of\n                                                true -&gt; ys\n                                                false -&gt; (fst x + fst y , snd x):ys\n                                      false -&gt; case snd x &lt; snd y of\n                                                true -&gt; y: agregarMon x ys\n                                                false -&gt; x:y:ys\n</code></pre>\n\n<p>This compiles (although with warnings, see below), but I don't know if it does what you want it to do. The OP code doesn't compile, so clearly something that <em>does</em> compile isn't equivalent.</p>\n\n<p>All I did, however, was to remove all the curly brackets and semicolons, and instead 'fix' the indentation.</p>\n\n<p>The code is still, in my opinion, too indented, but at least (with one exception) it stays left of 80 characters. Wide code could force people to scroll horizontally, which isn't going to make you many friends.</p>\n\n<p>The above code loads in GHCi, but with warnings:</p>\n\n<pre><code>[1 of 1] Compiling Q58986486        ( 58986486.hs, interpreted )\n\n58986486.hs:14:49: warning: [-Woverlapping-patterns]\n    Pattern match is redundant\n    In a case alternative: false -&gt; ...\n   |\n14 |                                                 false -&gt; (fst x + fst y , snd x):ys\n   |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n58986486.hs:15:39: warning: [-Woverlapping-patterns]\n    Pattern match is redundant\n    In a case alternative: false -&gt; ...\n   |\n15 |                                       false -&gt; case snd x &lt; snd y of\n   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^...\n\n58986486.hs:17:49: warning: [-Woverlapping-patterns]\n    Pattern match is redundant\n    In a case alternative: false -&gt; ...\n   |\n17 |                                                 false -&gt; x:y:ys\n   |                                                 ^^^^^^^^^^^^^^^\nOk, one module loaded.\n</code></pre>\n\n<p>Thus, I'm not sure that it works as intended.</p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1574419725, "creation_date": 1574419725, "answer_id": 58992635, "question_id": 58986486, "link": "https://stackoverflow.com/questions/58986486/im-having-an-error-with-haskell-with-cases-that-i-cant-find/58992635#58992635", "title": "Im having an error with Haskell with cases that i cant find", "body": "<p>The version of Mark Seemann can be improved though.</p>\n\n<p>Firstly, let's make <code>m</code> and <code>p</code> actual arguments of <code>agregarMon</code>:</p>\n\n<pre><code>agregarMon :: Monomio -&gt; Polinomio -&gt; Polinomio\nagregarMon m p = case m of\n                      (0,0) -&gt; p\n                      x -&gt; case p of\n                            [] -&gt; [x]\n                            y:ys -&gt; case (snd x == snd y) of\n                                      true -&gt; case ((fst x + fst y)==0) of\n                                                true -&gt; ys\n                                                false -&gt; (fst x + fst y , snd x):ys\n                                      false -&gt; case snd x &lt; snd y of\n                                                true -&gt; y: agregarMon x ys\n                                                false -&gt; x:y:ys\n</code></pre>\n\n<p>Now we can use pattern matching on agruments to simplify code:</p>\n\n<pre><code>agregarMon :: Monomio -&gt; Polinomio -&gt; Polinomio\nagregarMon (0, 0) p = p\nagregarMon x [] = [x]\nagregarMon (f, s) (y:ys) = case (snd x == snd y) of\n                            true -&gt; case ((fst x + fst y)==0) of\n                                         true -&gt; ys\n                                         false -&gt; (fst x + fst y , snd x):ys\n                            false -&gt; case snd x &lt; snd y of\n                                          true -&gt; y: agregarMon x ys\n                                          false -&gt; x:y:ys\n</code></pre>\n\n<p>It is not so idiomatic to pattern-match with <code>case</code> a result of condition check, better use <code>if</code> or guards:</p>\n\n<pre><code>agregarMon :: Monomio -&gt; Polinomio -&gt; Polinomio\nagregarMon (0, 0) p = p\nagregarMon x [] = [x]\nagregarMon x@(coefx, powx) (y@(coefy, powy):ys)\n  | powx == powy = if coefx + coefy == 0\n                   then ys\n                   else (coefx + coefy, powx):ys\n  | powx &lt; powy = y:agregarMon x ys\n  | otherwise = x:y:ys\n</code></pre>\n\n<p>Now we have some simple cases and a complex one, but even the complex one is not so hard to read and understand (I even made an assumption that you're working with polynomials, coefficients and powers).</p>\n\n<p>You can run it there: <a href=\"https://repl.it/@Yuri12358/so-monomio-polinomio\" rel=\"nofollow noreferrer\">https://repl.it/@Yuri12358/so-monomio-polinomio</a></p>\n\n<p>Maybe this link will help you to improve your understanding of different ways to make branching in your code: <a href=\"http://learnyouahaskell.com/syntax-in-functions#pattern-matching\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/syntax-in-functions#pattern-matching</a></p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "edited": false, "score": 0, "creation_date": 1574466005, "post_id": 59000674, "comment_id": 104256520, "body": "Thank you so much! i cant believe i wasted so much time in something that simple, i will try to put warnings on. I write it like that because thats how im being teach to do it, i have seen all over the internet that everyone writes it like you do, and probably its for a good reason,  but i have to do it this way right now. Thanks again!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "edited": false, "score": 0, "creation_date": 1574467186, "post_id": 59000674, "comment_id": 104256780, "body": "@Jackal Even if <code>if</code> is more common, using <code>case .. of True -&gt; ... ; False -&gt; ...</code> is a good learning exercise. Booleans are not so important in Haskell as they are in other languages, and beginners tend to overuse <code>if</code> and partial functions when a <code>case</code> would have been much better. So, learning <code>case</code> is very important."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1574451263, "creation_date": 1574451263, "answer_id": 59000674, "question_id": 58986486, "link": "https://stackoverflow.com/questions/58986486/im-having-an-error-with-haskell-with-cases-that-i-cant-find/59000674#59000674", "title": "Im having an error with Haskell with cases that i cant find", "body": "<pre><code>case (snd x == snd y) of { true -&gt;\n</code></pre>\n\n<p>is wrong: <code>true</code> here is just a variable name, unrelated to the constructor <code>True</code> (with a capital <code>T</code>!). The snippet above is therefore equivalent to</p>\n\n<pre><code>case (snd x == snd y) of { x -&gt;\n</code></pre>\n\n<p>Hence, the pattern matches any boolean value, <code>True</code> and <code>False</code>. For that reason the other branch <code>false -&gt; ...</code> will never be considered.</p>\n\n<p>I recommend you turn on warnings, since doing so makes GHC report the second branch as redundant code. The fact that the compiler considers a branch useless signals that something is very wrong with the code.</p>\n\n<p>As a final note, in my experience code like</p>\n\n<pre><code>case something of\n  True  -&gt; a\n  False -&gt; b\n</code></pre>\n\n<p>is not common, since we can write it as</p>\n\n<pre><code>if something\nthen a\nelse b\n</code></pre>\n\n<p>which is easier to read, in my view.</p>\n"}], "owner": {"reputation": 35, "user_id": 12207317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d750d11e16b16a3549b791f90c365ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/12207317/jackal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 59000674, "answer_count": 3, "score": 2, "last_activity_date": 1574451263, "creation_date": 1574388823, "last_edit_date": 1574408207, "question_id": 58986486, "link": "https://stackoverflow.com/questions/58986486/im-having-an-error-with-haskell-with-cases-that-i-cant-find", "title": "Im having an error with Haskell with cases that i cant find", "body": "<p>So im trying to create this function AgregarMon that basically adds a \"Monomio\" to \"Polinomio\"\nMonomio would end up being an element inside Polinomio which is a list. You are going to understand better in a little bit</p>\n\n<pre><code>type Monomio = (Int, Int)\ntype Polinomio = [Monomio]\n\nagregarMon :: Monomio -&gt; Polinomio -&gt; Polinomio\nagregarMon = \\m p -&gt; case m of{ (0,0) -&gt; p;\n                                 x -&gt; case p of{[] -&gt; [x];\n                                                y:ys -&gt; case (snd x == snd y) of { true -&gt; case ((fst x + fst y)==0) of { true -&gt; ys;\n                                                                                                                          false -&gt; (fst x + fst y , snd x):ys;}\n                                                                                   false -&gt; case snd x &lt; snd y of{true -&gt; y: agregarMon x ys;\n                                                                                                                  false -&gt; x:y:ys;}}}}\n</code></pre>\n\n<p>I've been looking at my code like an hour, and i cant find the problem. The error says:</p>\n\n<pre><code>Polinomios.hs:45:140: error:\n    Unexpected case expression in function application:\n        case ((fst x + fst y) == 0) of\n          true -&gt; ys\n          false -&gt; (fst x + fst y, snd x) : ys\n    You could write it with parentheses\n    Or perhaps you meant to enable BlockArguments?\n   |\n45 |                                                                                                 y:ys -&gt; case (snd x == snd y) of { true -&gt; case ((fst x + fst y)==0) of { true -&gt; ys;    |                                                                                                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^...\n\n</code></pre>\n\n<p>Line 45 is the fourth line on the code from above. Im sorry if im missing info, please let me now.\nJust in case, someone doesnt knows, fst and snd are on the Prelude. fst takes the first element from a \"Monomio\" snd the second one. fst = (a,b)->a snd (a,b) -> b</p>\n"}, {"tags": ["haskell", "try-catch", "maybe", "either"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1574383500, "post_id": 58985827, "comment_id": 104224068, "body": "What do you think the type of <code>readFile</code> is?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574383569, "post_id": 58985827, "comment_id": 104224087, "body": "Similarly, what do you think the type of <code>try</code> is? what does ghci say when you check?"}, {"owner": {"reputation": 179, "user_id": 5557062, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0158252d65d5ea6e497f59045b1eaf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5557062/guillaume"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574383708, "post_id": 58985827, "comment_id": 104224114, "body": "Ghci return &quot;IO (Either e a)&quot;, Either is composed of two constuctors Left and Right. That&#39;s what I do"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574386136, "post_id": 58985827, "comment_id": 104224690, "body": "<code>Just &quot;help&quot;</code>, not <code>Just help</code>."}, {"owner": {"reputation": 179, "user_id": 5557062, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0158252d65d5ea6e497f59045b1eaf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5557062/guillaume"}, "edited": false, "score": 0, "creation_date": 1574386303, "post_id": 58985827, "comment_id": 104224730, "body": "help is a function that return a String (help :: String)"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574441256, "post_id": 58985827, "comment_id": 104247264, "body": "If it doesn&#39;t have input, <code>help</code> is not a function."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1574398835, "creation_date": 1574398835, "answer_id": 58987799, "question_id": 58985827, "link": "https://stackoverflow.com/questions/58985827/haskell-i-can-not-get-exception-readfile-with-try/58987799#58987799", "title": "Haskell I can not get exception ReadFile with try", "body": "<p>There are several problems</p>\n\n<p><strong>Function application (<code>$</code>) is lower precedence than bind (<code>&gt;&gt;=</code>)</strong></p>\n\n<p>You said:</p>\n\n<pre><code>try $ readFile file &gt;&gt;= \\res...\n</code></pre>\n\n<p>Which means</p>\n\n<pre><code>try ( readFile file &gt;&gt;= \\res... )\n</code></pre>\n\n<p>But you wanted:</p>\n\n<pre><code>try ( readFile file ) &gt;&gt;= \\res...\n</code></pre>\n\n<p><strong><code>IO (Maybe a)</code> and <code>Maybe a</code> are distinct</strong></p>\n\n<p>You have a function using IO (via <code>readFile</code> and <code>try</code>) but many of the cases do not return an IO result (<code>Nothing</code> and <code>Just content</code>).</p>\n\n<p>Solution: Return via <code>return Nothing</code> or <code>pure Nothing</code> to lift a value into the IO monad.</p>\n\n<p><strong>The exception type was ambiguous</strong></p>\n\n<p>The <code>try</code> function can catch any exception type, just look at the signature:</p>\n\n<pre><code>try :: Exception e =&gt; IO a -&gt; IO (Either e a)\n</code></pre>\n\n<p>When you totally ignore the exception you leave the type checker with no information to decide what <code>e</code> should be.  In these situations an explicit type signature is useful, such as:</p>\n\n<pre><code>  Left (e::SomeException) -&gt; pure Nothing\n</code></pre>\n\n<p><strong><code>managagment</code> is partial</strong></p>\n\n<p><code>managagment [\"a\",\"b\"]</code> is undefined as is any input list of length over one.  Consider a final equational definition of:</p>\n\n<pre><code>managagment _ = managagment [\"-h\"]\n</code></pre>\n\n<p>Or more directly:</p>\n\n<pre><code>managagment _ = pure $ Just help\n</code></pre>\n\n<p><strong>Style and other notes</strong></p>\n\n<ul>\n<li><code>managagment</code> should probably <code>management</code></li>\n<li><code>Just (foo)</code> is generally <code>Just foo</code></li>\n<li><code>help</code> is not a function that returns a String.  It is a value of type String.</li>\n<li>The example was not complete, missing imports and <code>help</code>.</li>\n</ul>\n\n<p><strong>Fixed Code</strong></p>\n\n<p>Consider instead:</p>\n\n<pre><code>#!/usr/bin/env cabal\n{- cabal:\n    build-depends: base\n-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE LambdaCase          #-}\nimport Control.Exception (try, SomeException)\n\nmain :: IO ()\nmain = print =&lt;&lt; management []\n\nhelp :: String\nhelp = \"so helpful\"\n\nmanagement :: [String] -&gt; IO (Maybe String)\nmanagement [] = pure Nothing\nmanagement [\"-h\"] = pure $ Just help\nmanagement [file] =\n    try (readFile file) &gt;&gt;=\n      \\case\n         Left (e::SomeException) -&gt; pure Nothing\n         Right content -&gt; pure $ Just content\nmanagement _ = pure $ Just help\n</code></pre>\n\n<p>And test as such:</p>\n\n<pre><code>% chmod +x x.hs\n% ./x.hs\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 5557062, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0158252d65d5ea6e497f59045b1eaf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5557062/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 58987799, "answer_count": 1, "score": 0, "last_activity_date": 1574398835, "creation_date": 1574383060, "question_id": 58985827, "link": "https://stackoverflow.com/questions/58985827/haskell-i-can-not-get-exception-readfile-with-try", "title": "Haskell I can not get exception ReadFile with try", "body": "<p>I have a function \"management\" that checks parameters and return a Maybe (String):</p>\n\n<ul>\n<li>If there are not parameter -> return Nothing</li>\n<li>If my parameter is equal to \"-h\" -> Return a string help</li>\n</ul>\n\n<p>My problem arrived when I get a file and check if this file exists.</p>\n\n<blockquote>\n  <p>Couldn't match expected type \u2018Maybe String\u2019\n                    with actual type \u2018IO (Either e0 a2)\u2019</p>\n</blockquote>\n\n<pre><code>managagment :: [String] -&gt; Maybe (String)\nmanagagment [] = Nothing\nmanagagment [\"-h\"] = Just (help)\nmanagagment [file] = try $ readFile file &gt;&gt;= \\result -&gt; case result of\n                                                        Left e -&gt; Nothing\n                                                        Right content -&gt; Just (content)\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck", "servant"], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574461637, "post_id": 59002068, "comment_id": 104255408, "body": "Thanks, I&#39;ll give it a try when I get a chance"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574604316, "post_id": 59002068, "comment_id": 104282967, "body": "I&#39;ve now tried with this approach and I&#39;m still not getting the information you are. What&#39;s being printed in your example is in a <code>Just</code>, whereas I am getting <code>Nothing</code>. (And was even with the normal predicate - see the output in my question.) As far as I can make out from line 146 of <a href=\"https://github.com/haskell-servant/servant-quickcheck/blob/master/src/Servant/QuickCheck/Internal/QuickCheck.hs\" rel=\"nofollow noreferrer\">github.com/haskell-servant/servant-quickcheck/blob/master/sr&zwnj;&#8203;c/&hellip;</a>, the <code>x</code> held in the <code>MVar</code> must be of a <code>Maybe</code> type, and for some reason in my case it&#39;s <code>Nothing</code>. I&#39;m quite unsure what this means though."}, {"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574842719, "post_id": 59002068, "comment_id": 104370031, "body": "Even if this was a bug, it might be a good idea to have some logging in your application. Does the fact that it fails on the 4th example tell you something?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574845174, "post_id": 59002068, "comment_id": 104371317, "body": "Not really, there are 3 unit tests before it (definitely intend to add more, but I&#39;ve been busy elsewhere lately and also want this quickcheck issue sorted) so I think it&#39;s just the summary that it&#39;s passing those but failing the quickcheck test. Agree about logging, will look into that when I have time (still relatively new to &quot;production level&quot; Haskell so I&#39;ll have to look up how logging is handled)."}], "tags": [], "owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "is_accepted": false, "score": 0, "last_activity_date": 1574458646, "creation_date": 1574458646, "answer_id": 59002068, "question_id": 58984852, "link": "https://stackoverflow.com/questions/58984852/servant-quickcheck-how-do-you-see-which-route-caused-the-test-failure/59002068#59002068", "title": "Servant Quickcheck - how do you see which route caused the test failure?", "body": "<p>From what I see, you could write a RequestPredicate as in <a href=\"https://github.com/haskell-servant/servant-quickcheck/blob/master/src/Servant/QuickCheck/Internal/Predicates.hs\" rel=\"nofollow noreferrer\">https://github.com/haskell-servant/servant-quickcheck/blob/master/src/Servant/QuickCheck/Internal/Predicates.hs</a> \nfor example notLongerThan.</p>\n\n<p>I tested it with </p>\n\n<pre><code>not200b :: RequestPredicate\nnot200b = RequestPredicate $ \\req mgr -&gt; do\n     resp &lt;- httpLbs req mgr\n     when (responseStatus resp == status200) $ throw $ PredicateFailure \"not200b\" (Just req) resp\n     return []\n</code></pre>\n\n<p>yielding a response of </p>\n\n<blockquote>\n  <p>Failures:</p>\n  \n  <p>src/Servant/QuickCheck/Internal/QuickCheck.hs:146:11:    1)\n  QuickCheck global tests for public API - API never gives 200\n         Failed:\n         Just Predicate failed\n              Predicate: not200b\n              Request:\n                   Method: \"GET\"\n                   Path: /users\n                   Headers:\n                   Body: \n              Response:\n                   Status code: 200\n                   Headers:  \"Transfer-Encoding\": \"chunked\"\n                             \"Date\": \"Fri, 22 Nov 2019 21:32:07 GMT\"\n                             \"Server\": \"Warp/3.2.28\"\n                             \"Content-Type\": \"application/json;charset=utf-8\"\n                   Body: [{\"userId\":1,\"userFirstName\":\"Isaac\",\"userLastName\":\"Newton\"},{\"userId\":2,\"userFirstName\":\"Albert\",\"userLastName\":\"Einstein\"}]</p>\n  \n  <p>To rerun use: --match \"/QuickCheck global tests for public API -/API\n  never gives 200/\"</p>\n  \n  <p>Randomized with seed 1026627332</p>\n  \n  <p>Finished in 0.0226 seconds 1 example, 1 failure</p>\n</blockquote>\n"}], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1574718016, "creation_date": 1574376145, "last_edit_date": 1574717915, "question_id": 58984852, "link": "https://stackoverflow.com/questions/58984852/servant-quickcheck-how-do-you-see-which-route-caused-the-test-failure", "title": "Servant Quickcheck - how do you see which route caused the test failure?", "body": "<p>I'm building an API with Servant, and it seems to work pretty well. And in line with best practices I am writing some tests for it, following the official guide <a href=\"https://haskell-servant.readthedocs.io/en/stable/cookbook/testing/Testing.html\" rel=\"nofollow noreferrer\">here</a>. But I'm struggling with the part using Servant-Quickcheck.</p>\n\n<p>I'm trying to use it to test that my API doesn't give any 500 errors, like this:</p>\n\n<pre><code>quickCheckSpec :: Spec\nquickCheckSpec = describe \"QuickCheck global tests for public API -\" $ do\n  it \"API never gives 500 error\" $\n    withServantServer publicAPI (return server) $ \\burl -&gt;\n      serverSatisfies publicAPI burl args (not500 &lt;%&gt; mempty)\n</code></pre>\n\n<p>but unfortunately the test is failing. This is a surprise to me, given that I've not encountered such an error when testing manually - but hey, this is why we have automated tests, right? Especially with tools like QuickCheck which, as far as I understand, is supposed to zero in on \"edge cases\" that you might not think to test manually. (This is actually my first time using QuickCheck in any form.)</p>\n\n<p>The problem is though that a test failure is useless unless you know what it failed on. And this is what Servant-QuickCheck does not seem to want to tell me. The only output I get regarding the test failure is this:</p>\n\n<pre><code>  API never gives 500 error FAILED [1]\n\nFailures:\n\n  src\\\\Servant\\\\QuickCheck\\\\Internal\\\\QuickCheck.hs:146:11: \n  1) QuickCheck global tests for public API - API never gives 500 error\n       Nothing\n\n  To rerun use: --match \"/QuickCheck global tests for public API -/API never gives 500 error/\"\n\nRandomized with seed 1712537046\n\nFinished in 10.8513 seconds\n4 examples, 1 failure\n</code></pre>\n\n<p>(There are some unit tests run before, which all pass - the 10 seconds isn't all on the above test!)</p>\n\n<p>This is rather bemusing, because as you can see there's nothing which indicates how the failure occurred. Since it's testing an API and, as far as I understand it, choosing valid routes at random to test with, it ought to tell me at which route it encountered the 500 error. Yet, as you can see, there is precisely nothing there.</p>\n\n<p>(I'm developing the project with Stack btw, and a little bit below the above it says <code>Logs printed to console</code>, so I don't believe I'm missing any log files buried somewhere which could enlighten me. I haven't been able to find any in my <code>.stack-work</code> folder either.)</p>\n\n<p>I've even changed my <code>args</code> so that it has the <code>chatty</code> field set to <code>True</code>, but I still only get the above.</p>\n\n<p>The only clue I get, which isn't related to QuickCheck, is that my API uses Persistent and logs the database queries to the terminal, so I can see the queries that have been run - which I can in turn relate back to the route. However I don't particularly trust this, because the route that runs the query shown is definitely working in manual tests. (And it's not always the same query when it fails.) There are also a couple of simple routes that don't query the database, so the failure isn't necessarily related to the last database query printed (although needless to say, I've manually tested those routes too and they're fine).</p>\n\n<p>I've even wondered if the problem might not be that QuickCheck hits my localhost server so many times in a row that it simply can't cope and errors out, but in that case I would expect this to be a common problem, remarked upon in the tutorial. (And the database logging output suggests that it in fact always fails on the very first \"hit\".)</p>\n\n<p>Anyway, that's just speculation, and I realise that it's up to me to figure out why my API might be failing the tests, given that I didn't think it relevant to share any details of my actual API.</p>\n\n<p>What I'm really asking is: why am I not told which routes were tested, and which ones passed/failed, so that I at least know exactly which route(s) to investigate? And is there any way to make Servant-Quickcheck show me that information?</p>\n\n<p>Any answer to that would be much appreciated.</p>\n\n<p>FURTHER INFORMATION: I've tried with @MarkusBarthlen's suggestion below, but it didn't give me any more information. However, it did point up that the <code>Nothing</code> which you can see in my console output is probably somehow key to this, because in Markus's example he gets a <code>Just</code> value holding the request information. Looking at line 146 of <a href=\"https://github.com/haskell-servant/servant-quickcheck/blob/master/src/Servant/QuickCheck/Internal/QuickCheck.hs\" rel=\"nofollow noreferrer\">the source file referenced in the failure message</a>, it's clearly the <code>x</code> there that apparently is a <code>Maybe</code> value. But I can't figure out what type it actually is, and what the significance is of it being <code>Nothing</code> in my case. Unfortunately the code is beyond my own Haskell experience/ability to make much sense of - I can see the <code>x</code> is read out of an <code>MVar</code>, which is populated somehow with the result of the test, but as I said I'm not able to make sense of the details. But I really need to know, not only why my test is failing, but why this particular <code>x</code> value is <code>Nothing</code> for me, and what that means in terms of the test. I would really appreciate an answer that explains this in a way I can understand.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574371489, "post_id": 58983734, "comment_id": 104220503, "body": "Not only is there only one reasonable implementation, it&#39;s already implemented by a standard function. Hint: <code>State.State s</code> is a monad, and <code>[]</code> is a traversable."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1574371706, "post_id": 58983734, "comment_id": 104220587, "body": "Note that this will use exactly 0 details from the <code>State</code> type. This is just a special case of  <code>Monad m =&gt; [m a] -&gt; m [a]</code>. It exists in the standard libraries already, but you definitely should be aware of how to do it yourself."}, {"owner": {"reputation": 1972, "user_id": 5695018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lkHBu.jpg?s=128&g=1", "display_name": "Ziyad Edher", "link": "https://stackoverflow.com/users/5695018/ziyad-edher"}, "edited": false, "score": 1, "creation_date": 1574371912, "post_id": 58983734, "comment_id": 104220677, "body": "I wasn&#39;t able to wrap my head around the bind operation and how it passes through the value, it makes a lot more sense now especially when abstracting away <code>State</code> and just thinking about <code>Monad</code>. Thanks!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574372294, "post_id": 58983734, "comment_id": 104220830, "body": "The Monad instance for <code>State</code> does look pretty scary on paper - the key is to realise that all it&#39;s doing is manually threading the state through to ensure that the successive actions will always &quot;see&quot; the most recently updated state value."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1574376435, "post_id": 58983734, "comment_id": 104222292, "body": "@ZiyadEdher If you&#39;ve got a handle on this now, you should write up an answer yourself."}, {"owner": {"reputation": 1972, "user_id": 5695018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lkHBu.jpg?s=128&g=1", "display_name": "Ziyad Edher", "link": "https://stackoverflow.com/users/5695018/ziyad-edher"}, "edited": false, "score": 0, "creation_date": 1574378771, "post_id": 58983734, "comment_id": 104222984, "body": "Was planning on doing that tonight :)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1574384440, "post_id": 58983734, "comment_id": 104224260, "body": "Is it really <i>unreasonable</i> to run the computations in reverse order? Clearly it&#39;s less obvious than the normal implementation, but I don&#39;t know if I would go so far as to say there&#39;s only one reasonable implementation."}], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1574461836, "creation_date": 1574461836, "answer_id": 59002594, "question_id": 58983734, "link": "https://stackoverflow.com/questions/58983734/processing-a-list-of-states-to-a-state-with-a-list-value/59002594#59002594", "title": "Processing a list of states to a state with a list value", "body": "<p>So you have a function that takes a list of states. Normally, you pattern match on lists, so let's do that.</p>\n\n<pre><code>f [] = ???\nf (x:xs) = ???\n</code></pre>\n\n<p>If we get the empty list, then we probably want to return the empty list, but wrapped in the <code>State</code> monad. That's what the <code>return</code> function does.</p>\n\n<pre><code>f [] = return []\nf (x:xs) = ???\n</code></pre>\n\n<p>Now, we need to return a <code>State</code> monad for the other case. The way you usually work with monads is with <code>do</code> notation.</p>\n\n<pre><code>f [] = return []\nf (x:xs) = do\n  ???\n</code></pre>\n\n<p>Now, <code>x</code> is a <code>State</code> monad, and xs is a list of <code>State</code> monads. Because we're writing a pattern-matching list function, we probably want to recurse somewhere in the <code>do</code> block. </p>\n\n<p>I think it should be fairly straightforward from here.</p>\n"}], "owner": {"reputation": 1972, "user_id": 5695018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lkHBu.jpg?s=128&g=1", "display_name": "Ziyad Edher", "link": "https://stackoverflow.com/users/5695018/ziyad-edher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574461836, "creation_date": 1574370328, "question_id": 58983734, "link": "https://stackoverflow.com/questions/58983734/processing-a-list-of-states-to-a-state-with-a-list-value", "title": "Processing a list of states to a state with a list value", "body": "<p>I am new to Haskell and I am trying to understand Monads and States right now.</p>\n\n<p>I have been tasked with writing a function with the following signature, with the only implementation details supplied being \"there is only one reasonable implementation of this function\":</p>\n\n<pre><code>f :: [State.State s a] -&gt; State.State s [a]\n</code></pre>\n\n<p>I do not fully understand States but what I understand from this question is that beginning with a list of states I want to chain their calling such that I end up with one final state and a list of results along the way.</p>\n\n<p>Trying that chaining idea, I have no idea how to even begin with that concept. I am very likely missing something conceptually that maybe someone can shed some light on?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 2773933, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-wD8zUbBMBVI/AAAAAAAAAAI/AAAAAAAAIGs/njtrAvsaRVk/photo.jpg?sz=128", "display_name": "presci", "link": "https://stackoverflow.com/users/2773933/presci"}, "edited": false, "score": 0, "creation_date": 1574371768, "post_id": 58983419, "comment_id": 104220610, "body": "Sorry I think I wasn&#39;t clear enough. What I want to do is split at the number."}], "tags": [], "owner": {"reputation": 212, "user_id": 6500489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-V4ZlLB9qjbE/AAAAAAAAAAI/AAAAAAAABPc/DPGoAr399R8/photo.jpg?sz=128", "display_name": "umnikos", "link": "https://stackoverflow.com/users/6500489/umnikos"}, "is_accepted": false, "score": 0, "last_activity_date": 1574368950, "creation_date": 1574368950, "answer_id": 58983419, "question_id": 58983130, "link": "https://stackoverflow.com/questions/58983130/having-trouble-with-groupby-function/58983419#58983419", "title": "Having trouble with groupBy function", "body": "<p>I don't know what you're trying to do, but you could achieve the same output with <code>chunksOf</code></p>\n\n<pre><code>import Data.List.Split\nchunksOf 3 \"aba3ac4d\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1574429364, "last_edit_date": 1574429364, "creation_date": 1574375255, "answer_id": 58984701, "question_id": 58983130, "link": "https://stackoverflow.com/questions/58983130/having-trouble-with-groupby-function/58984701#58984701", "title": "Having trouble with groupBy function", "body": "<p>From the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:groupBy\" rel=\"nofollow noreferrer\">docs</a>: </p>\n\n<blockquote>\n  <h1>The \"By\" operations</h1>\n  \n  <p>By convention, overloaded functions have a non-overloaded counterpart\n  whose name is suffixed with <code>By</code>.</p>\n  \n  <p>It is often convenient to use these functions together with <code>on</code>, for\n  instance <code>sortBy (compare `on` fst)</code>.</p>\n  \n  <h3>User-supplied equality (replacing an Eq context)</h3>\n  \n  <p>The predicate is assumed to define an equivalence.</p>\n</blockquote>\n\n<p>So, <code>groupBy pred</code> expects that <code>pred</code> is an equivalence relation, but yours is not, breaking the contract, so the result can not be relied upon. In particular, <code>groupBy groupBy0' \"aba3dac4d\"</code> is likely to perform these tests:</p>\n\n<ul>\n<li><code>groupBy0' 'a' 'b'</code> is true, <code>'b'</code> in same group</li>\n<li><code>groupBy0' 'a' 'a'</code> is true, <code>'a'</code> in same group</li>\n<li><code>groupBy0' 'a' '3'</code> is false, <code>'3'</code> in <em>other</em> group</li>\n<li><code>groupBy0' '3' 'd'</code> is true, <code>'d'</code> in same group</li>\n<li><code>groupBy0' '3' 'a'</code> is true, <code>'a'</code> in same group</li>\n<li><code>groupBy0' '3' 'c'</code> is true, <code>'c'</code> in same group</li>\n<li><code>groupBy0' '3' '4'</code> is true, <code>'4'</code> in same group</li>\n<li><code>groupBy0' '3' 'd'</code> is true, <code>'d'</code> in same group</li>\n</ul>\n\n<p>As you can see, the above implementation of <code>groupBy</code>, we always compare with the first element in the group, not with the last one as you expect. Since <code>pred</code> is assumed to be an equivalence, it does not matter which element in the group we compare with. If we break this assumption, it matters.</p>\n\n<p>You can't use <code>groupBy</code> to perform your particular function.</p>\n"}, {"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 1, "last_activity_date": 1574375529, "creation_date": 1574375529, "answer_id": 58984742, "question_id": 58983130, "link": "https://stackoverflow.com/questions/58983130/having-trouble-with-groupby-function/58984742#58984742", "title": "Having trouble with groupBy function", "body": "<p>As @chi clearly explains, you are not using <code>groupBy</code> correctly. In fact, I don't think <code>groupBy</code> is the correct function to use here. I would instead look at <code>takeWhile</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": false, "score": 1, "last_activity_date": 1574449025, "creation_date": 1574449025, "answer_id": 59000184, "question_id": 58983130, "link": "https://stackoverflow.com/questions/58983130/having-trouble-with-groupby-function/59000184#59000184", "title": "Having trouble with groupBy function", "body": "<p>As @chi stated, you probably don't want <code>groupBy</code>; but here's something to get you started :)</p>\n\n<pre><code>import Data.Char (isDigit)\nimport Data.List (span)\n&gt;&gt;&gt; span (not . isDigit) \"ab2de4\"\n(\"ab\",\"2de4\")\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 2773933, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-wD8zUbBMBVI/AAAAAAAAAAI/AAAAAAAAIGs/njtrAvsaRVk/photo.jpg?sz=128", "display_name": "presci", "link": "https://stackoverflow.com/users/2773933/presci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58984701, "answer_count": 4, "score": -2, "last_activity_date": 1574449025, "creation_date": 1574367675, "last_edit_date": 1574371722, "question_id": 58983130, "link": "https://stackoverflow.com/questions/58983130/having-trouble-with-groupby-function", "title": "Having trouble with groupBy function", "body": "<p>I am having trouble with the groupBy function I want to split at the number. Helpful if someone can point out  where I am going wrong</p>\n\n<blockquote>\n  <p>Input \"aba3dac4d\"</p>\n  \n  <p>Desired Output [\"aba\", \"3dac\", \"4d\"]</p>\n</blockquote>\n\n<p>But I get the output when I execute code</p>\n\n<pre><code>groupBy groupBy0' \"aba3dac4d\"\n</code></pre>\n\n<blockquote>\n  <p>[\"aba\", \"3dac4d\"]\n  Here is the code</p>\n</blockquote>\n\n<pre><code>import Data.List\n\ngroupBy0'::Char-&gt;Char-&gt;Bool\ngroupBy0' x y\n  | x `elem` ['a'..'z'] &amp;&amp; y `elem` ['0'..'9'] = False\n  | x `elem` ['0'..'9'] &amp;&amp; y `elem` ['a'..'z'] = True\n  | x `elem` ['a'..'z'] &amp;&amp; y `elem` ['a'..'z'] = True\n  | x `elem` ['0'..'9'] &amp;&amp; y `elem` ['0'..'9'] = True\n  | otherwise = False\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574367835, "post_id": 58982906, "comment_id": 104218856, "body": "Hint: first make a function that takes a single list like <code>[&quot;Jane&quot;,&quot;Doe&quot;,&quot;35\\r&quot;]</code> and turns that into a <code>Person</code>."}], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 6500489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-V4ZlLB9qjbE/AAAAAAAAAAI/AAAAAAAABPc/DPGoAr399R8/photo.jpg?sz=128", "display_name": "umnikos", "link": "https://stackoverflow.com/users/6500489/umnikos"}, "edited": false, "score": 0, "creation_date": 1574368846, "post_id": 58983149, "comment_id": 104219314, "body": "Since <code>Student</code> takes precisely an Int, Haskell will infer the type of <code>read</code> automatically, and so you don&#39;t need to specify it."}], "tags": [], "owner": {"reputation": 212, "user_id": 6500489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-V4ZlLB9qjbE/AAAAAAAAAAI/AAAAAAAABPc/DPGoAr399R8/photo.jpg?sz=128", "display_name": "umnikos", "link": "https://stackoverflow.com/users/6500489/umnikos"}, "is_accepted": false, "score": 0, "last_activity_date": 1574368441, "last_edit_date": 1574368441, "creation_date": 1574367774, "answer_id": 58983149, "question_id": 58982906, "link": "https://stackoverflow.com/questions/58982906/haskell-produce-a-list-of-people-from-a-list-of-lists/58983149#58983149", "title": "Haskell - Produce a List of People from a list of lists", "body": "<p>So we need a function of this type:</p>\n\n<pre><code>f :: [[String]] -&gt; [Person]\n</code></pre>\n\n<p>And there's a function which can help us - <code>map</code></p>\n\n<pre><code>stringsToPerson :: [String] -&gt; Person\nf = map stringsToPerson\n</code></pre>\n\n<p>Now, a fundamental problem becomes clear(er) - <code>stringsToPerson</code> is not type-safe. A user could give it an empty list and the function has no choice but to return an error. Better types would be:</p>\n\n<pre><code>stringsToPerson :: (String, String, Int) -&gt; Person\nstringsToPerson :: [String] -&gt; Maybe Person\n</code></pre>\n\n<p>Buuut assuming you want to stick with the type you chose, you can do it with pattern matching:</p>\n\n<pre><code>stringsToPerson [firstName, lastName, age] = Person firstName lastName (read age)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1574372961, "creation_date": 1574372961, "answer_id": 58984289, "question_id": 58982906, "link": "https://stackoverflow.com/questions/58982906/haskell-produce-a-list-of-people-from-a-list-of-lists/58984289#58984289", "title": "Haskell - Produce a List of People from a list of lists", "body": "<p>Your may do as follows;</p>\n\n<pre><code>data Person = Person { firstName :: String\n                     , lastName :: String\n                     , age :: Int\n                     } deriving (Show)\n\n\nmapper :: [[String]] -&gt; [Person]\nmapper = map makePerson\n         where makePerson [f,l,a] = Person f l $ read a\n\n*Main&gt; mapper [[\"John\",\"Doe\",\"38\\r\"], [\"Jane\",\"Doe\",\"35\\r\"]]\n[Person {firstName = \"John\", lastName = \"Doe\", age = 38},Person {firstName = \"Jane\", lastName = \"Doe\", age = 35}]\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12412621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "IsraelCodes", "link": "https://stackoverflow.com/users/12412621/israelcodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1574372961, "creation_date": 1574366618, "last_edit_date": 1574366984, "question_id": 58982906, "link": "https://stackoverflow.com/questions/58982906/haskell-produce-a-list-of-people-from-a-list-of-lists", "title": "Haskell - Produce a List of People from a list of lists", "body": "<p>The List of Lists contains the following entries. </p>\n\n<pre><code>[\n  [\"John\",\"Doe\",\"38\\r\"],\n  [\"Jane\",\"Doe\",\"35\\r\"]\n]\n</code></pre>\n\n<p>The Person data type is constructed as follows:</p>\n\n<pre><code>data Person = Person { firstName :: String\n                     , lastName :: String   \n                     , age :: Int  \n                     } deriving (Show)\n</code></pre>\n\n<p>I am trying to make a list of Persons in Haskell such that the final Person list will look as follows:</p>\n\n<pre><code>[\nPerson {firstName = \"John\", lastName = \"Doe\", age = 38},\nPerson {firstName = \"Jane\", lastName = \"Doe\", age = 35}\n]\n</code></pre>\n\n<p>Any help is appreciated! Please and thank you!</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1574366315, "post_id": 58982179, "comment_id": 104218204, "body": "You have <code>version: 0.0.0.1</code> and <code>build-depends: my-pkg &gt;= 0.1.0.1</code>. Seems wrong. After fixing that and putting blank-ish files in place for the three modules described by this cabal file (just a module header and either <code>NoImplicitPrelude</code> or <code>main = return ()</code> as appropriate), I cannot reproduce your problem: I get no warning about <code>other-modules</code> when I run <code>cabal v2-build all</code>. So you need to include the full details of what&#39;s in those files, what command you run, and possibly also what versions of the tools you have installed."}], "answers": [{"comments": [{"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 1, "creation_date": 1574564514, "post_id": 59007602, "comment_id": 104275937, "body": "Yes! this is perfect. I couldn&#39;t make a small example but I moved my .cabal to hpack and now everything works perfectly"}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 1, "last_activity_date": 1574512025, "creation_date": 1574512025, "answer_id": 59007602, "question_id": 58982179, "link": "https://stackoverflow.com/questions/58982179/in-a-cabal-package-why-should-i-have-almost-identical-other-modules-fields/59007602#59007602", "title": "In a cabal package why should I have almost identical `other-modules` fields", "body": "<p>Without knowing the full contents of <code>tools/Tools</code> directory, we can only speculate as to why you are getting that error, but my guess would be that there are other haskell files in that directory.</p>\n\n<p><code>other-modules</code> indicates files/modules that are used in your project but are not publicly exposed. They are private files/modules. Details from the cabal page: <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#modules-included-in-the-package\" rel=\"nofollow noreferrer\">cabal - quickstart - 3.1.3. Modules included in the package</a>.</p>\n\n<p>There is also a tool called <a href=\"https://github.com/sol/hpack\" rel=\"nofollow noreferrer\">hpack</a> which automates the creation of a <code>cabal</code> file from an <code>hpack</code> <code>yaml</code> file and it can automatically populate the <code>other-modules</code> field for you. You can also use it via <a href=\"https://docs.haskellstack.org/en/stable/faq/#does-stack-support-the-hpack-specification\" rel=\"nofollow noreferrer\">stack</a>.</p>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 59007602, "answer_count": 1, "score": 1, "last_activity_date": 1574512025, "creation_date": 1574363623, "last_edit_date": 1574365373, "question_id": 58982179, "link": "https://stackoverflow.com/questions/58982179/in-a-cabal-package-why-should-i-have-almost-identical-other-modules-fields", "title": "In a cabal package why should I have almost identical `other-modules` fields", "body": "<p>In my cabal I have a <code>library</code> and a few <code>executable</code> fields. I can sort of understand why cabal wants to know about all the various files in the <code>.cabal</code> manifest, even the ones that are not <code>exposed-modules</code>. My executables only use modules in the <code>exposed-modules</code> of my library. Why then does cabal complain about missing <code>other-modules</code>?</p>\n\n<pre><code>version:             0.0.0.1\nname:                my-pkg\nsynopsis:            A package\ndescription:         Please see README.md\nhomepage:            https://homepage.com\nlicense:             BSD3\nlicense-file:        LICENSE\nauthor:              Me\nmaintainer:          example@example.com\ncopyright:           MIT\ncategory:            \nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nlibrary\n  hs-source-dirs:      src\n  default-language:    Haskell2010\n  ghc-options:         -Wall -g -Wno-simplifiable-class-constraints -O2\n  exposed-modules:     MyLib.Exposed.ImportedByExec\n  other-modules:       MyLib.NotExposed.ExecShouldntCare\n\nexecutable tool\n  hs-source-dirs:      tools/Tool\n  default-language:    Haskell2010\n  ghc-options:         -Wall -g -Wsimplifiable-class-constraints\n  main-is:             Main.hs\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                     , my-pkg &gt;= 0.1.0.1\n  other-modules:     &lt;why should anything be here to avoid a warning??&gt;\n</code></pre>\n\n<p>EDIT: Maybe the question is equivalent to \"why does my-pkg not show up in <code>stack exec -- ghc-pkg list</code> after I <code>stack build</code> or even <code>stack install</code>?\"</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1574361987, "post_id": 58981396, "comment_id": 104216231, "body": "You can think <code>&#39;</code> suffix as a second version notation by a general convention among Haskell coders just like <code>reverse_v2</code>. In the book that you read there must have been a mention of the original <code>reverse</code> and <code>reverse&#39;</code> is just indicating another (or the <i>next</i>) version showing how else it could be or is implemented"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1574363246, "post_id": 58981396, "comment_id": 104216799, "body": "It doesn&#39;t &quot;mean&quot; anything, it&#39;s just a character that is legal to use in the names of values. It is indeed convention to use a &quot;tick&quot; at the end of a function name to denote a slightly modified version of a previously defined function, but this is nothing other than convention - the apostrophe character has no intrinsic meaning in the Haskell language."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574366588, "post_id": 58981396, "comment_id": 104218312, "body": "Almost: <code>&#39;</code> cannot be the <i>first</i> character in name, as <code>Char</code> literals are indicated by a single character in single quotes. <code>&#39;c&#39;</code>"}], "owner": {"reputation": 115, "user_id": 7298643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2D13T.png?s=128&g=1", "display_name": "jengels", "link": "https://stackoverflow.com/users/7298643/jengels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "closed_date": 1574360853, "answer_count": 0, "score": 2, "last_activity_date": 1574709789, "creation_date": 1574360503, "last_edit_date": 1574709789, "question_id": 58981396, "link": "https://stackoverflow.com/questions/58981396/what-does-single-quote-apostrophe-mean-after-function-names-in-haskell", "closed_reason": "Duplicate", "title": "What does single quote / apostrophe (&#39;) mean after function names in Haskell?", "body": "<p>In my functional programming class, the lecturer created the function <code>reverse</code> to take a list and return a list with the same elements but in reverse order:</p>\n\n<pre><code>reverse :: [a] -&gt; [a]\nreverse [] = []\nreverse (x:xs) = reverse xs ++ [x]\n</code></pre>\n\n<p>However, in the book I am learning from the define they create the same function with ' after the function's name:</p>\n\n<pre><code>reverse' :: [a] -&gt; [a]\nreverse' [] = []\nreverse' (x:xs) = reverse' xs ++ [x]\n</code></pre>\n\n<p>I was wondering if these two functions behave in the same way, or if the ' alters their behavior? Furthermore, are there cases where one notation is better than the other? Any help would be appreciated!  </p>\n"}, {"tags": ["haskell", "yesod", "haskell-persistent"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574363687, "post_id": 58981205, "comment_id": 104216984, "body": "Since your function returns a list, the <code>do</code> block is interpreted in terms of the list Monad, and therefore <code>return</code> wraps its argument in a singleton list. I&#39;m not particularly <i>au fait</i> with Yesod so I&#39;m not sure what <code>liftHandler</code> does and whether using it to get a list will do what you want - but in terms of simply fixing the compile error then just omitting the <code>return $</code> will do it."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574365220, "post_id": 58981205, "comment_id": 104217740, "body": "Actually, having researched the functions and types a little, it doesn&#39;t look like it should be possible to use <code>liftHandler</code> to get a list at all. The monad you get from it has to be an instance of <code>MonadResource</code>, which is a subclass of <code>MonadIO</code>, and there&#39;s definitely no sensible instance of that for lists. Database queries fundamentally require <code>IO</code> (since the results can be different each time you run them), so it&#39;s impossible to get a pure value from it such as a list of numbers."}, {"owner": {"reputation": 3, "user_id": 12400421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7298994b4c4694f5767e392d845b508a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Judy", "link": "https://stackoverflow.com/users/12400421/mark-judy"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574366397, "post_id": 58981205, "comment_id": 104218247, "body": "@RobinZigmond That seemed to work, but now I get the type error &quot;Couldn&#39;t match type &#39;BaseBackend (YesodPersistBackend (HandlerSite [])) with SqlBackend&#39; arising from a use of &#39;selectList&#39;&quot;"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574372136, "post_id": 58981205, "comment_id": 104220760, "body": "urrrgh, that&#39;s the kind of type error it takes me ages to debug, which I&#39;m not particularly inclined to do for someone else I&#39;m afraid (hopefully someone who knows Yesod/Persistent much better than me will be able to chime in). Note that I still think what you&#39;re trying to do will fundamentally not work for the reason I gave in my second comment - but it doesn&#39;t look to me like this latest error is related to that."}], "answers": [{"tags": [], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1579436375, "last_edit_date": 1579436375, "creation_date": 1579435283, "answer_id": 59809817, "question_id": 58981205, "link": "https://stackoverflow.com/questions/58981205/how-to-create-a-list-of-a-single-column-with-yesod-persistent/59809817#59809817", "title": "How to create a list of a single column with yesod-persistent?", "body": "<p>It's a good start, but I see a number of things wrong with this.</p>\n\n<pre><code>getEventR :: Handler Html\ngetEventsR = do\n</code></pre>\n\n<p>These function names don't match.</p>\n\n<pre><code>    muser &lt;- maybeAuth\n    eventList &lt;- runDB $ \n        case muser of\n            Nothing -&gt; []\n            (Just euser) -&gt; selectList [ EventOrgId &lt;-. (userOrgIds $ entityKey euser) ] []\n</code></pre>\n\n<p>I'm not sure this will work; you probably want your <code>Nothing</code> branch to provide <code>pure []</code>.</p>\n\n<pre><code>    defaultLayout $ do\n        setTitle \"Events\"\n        $(widgetFile \"events\")\n</code></pre>\n\n<p>This looks fine.</p>\n\n<pre><code>userOrgIds :: UserId -&gt; [OrgId]\nuserOrgIds userid = do\n    rows &lt;- liftHandler $ runDB $ selectList [ UserOrgUserId ==. userid ] []\n    return $ [ userOrgOrgId $ entityVal $ erow | erow &lt;- rows ]\n</code></pre>\n\n<p>This definitely won't work. In your type signature, you've said that it's a pure function; it takes a <code>UserId</code> (which is a synonym for <code>Key User</code>), and returns a list of <code>OrgId</code> (again, synonymous with <code>Key Org</code>) values. However in your implementation, you're using <code>liftHandler</code>, <code>runDB</code>, and <code>selectList</code>. These are all effectful things!</p>\n\n<p>Here's how I would write your Handler.</p>\n\n<pre><code>getEventsR :: Handler Html\ngetEventsR = do\n  mUser &lt;- maybeAuth\n  eventList &lt;- case mUser of\n    Nothing -&gt; pure []\n    Just user -&gt; runDB $ do\n      orgs &lt;- selectList [ UserOrgUserId ==. entityKey user ] []\n      selectList [ EventOrgId &lt;-. map entityKey orgs ] []\n  defaultLayout $ do\n    setTitle \"Events\"\n    $(widgetFile \"events\")\n</code></pre>\n\n<p>I'm writing that without a compiler, but it <em>should</em> be correct.</p>\n"}], "owner": {"reputation": 3, "user_id": 12400421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7298994b4c4694f5767e392d845b508a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Judy", "link": "https://stackoverflow.com/users/12400421/mark-judy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 59809817, "answer_count": 1, "score": 0, "last_activity_date": 1579436375, "creation_date": 1574359751, "question_id": 58981205, "link": "https://stackoverflow.com/questions/58981205/how-to-create-a-list-of-a-single-column-with-yesod-persistent", "title": "How to create a list of a single column with yesod-persistent?", "body": "<p>Given a user, I am trying to select a list of events that are affiliated with organizations that the user is in. The UserOrg table describes which OrgIds correspond to a given UserId.</p>\n\n<p>I have these tables:</p>\n\n<pre><code>User\n    email Text\n    name Text\n    UniqueUser email\n    deriving Typeable\nEvent\n    name Text\n    description Text\n    dateTime UTCTime\n    userId UserId\n    orgId OrgId\n    deriving Show\nOrg\n    name Text\n    description Text\n    deriving Show\nUserOrg\n    userId UserId\n    orgId OrgId\n</code></pre>\n\n<p>Currently I am trying this:</p>\n\n<pre><code>getEventR :: Handler Html\ngetEventsR = do\n    muser &lt;- maybeAuth\n    eventList &lt;- runDB $ \n        case muser of\n            Nothing -&gt; []\n            (Just euser) -&gt; selectList [ EventOrgId &lt;-. (userOrgIds $ entityKey euser) ] []\n    defaultLayout $ do\n        setTitle \"Events\"\n        $(widgetFile \"events\")\n\nuserOrgIds :: UserId -&gt; [OrgId]\nuserOrgIds userid = do\n    rows &lt;- liftHandler $ runDB $ selectList [ UserOrgUserId ==. userid ] []\n    return $ [ userOrgOrgId $ entityVal $ erow | erow &lt;- rows ]\n</code></pre>\n\n<p>But I get a type error saying that the return of userOrgIds returns a <code>[[OrgId]]</code> rather than <code>[OrgId]</code>, and concat doesn't work here</p>\n\n<p>Am I going about this wrong? Should I just use <code>rawQuery</code> in this case?</p>\n"}, {"tags": ["haskell", "bind", "composition"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 4, "creation_date": 1574357222, "post_id": 58980103, "comment_id": 104213972, "body": "<code>(.)</code> is an operator which works with function types whereas <code>(&gt;&gt;=)</code> is an overloaded operator. It works with all types which are instances of Monad type class including the function type <code>(-&gt;) r</code>. Even with function type they are not exactly the same. However I would advise you to check <code>fmap</code> and <code>(.)</code> first."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574358487, "post_id": 58980103, "comment_id": 104214585, "body": "Roughly put, <code>(.)</code> composes <code>a -&gt; b</code> and <code>b -&gt; c</code>, while <code>&gt;&gt;=</code> sort-of <i>applies</i> <code>M b</code> to <code>b -&gt; M c</code>. Types are completely different, especially because of the monad <code>M</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1574360144, "post_id": 58980103, "comment_id": 104215338, "body": "On the other hand <code>(.)</code> and <code>(&lt;=&lt;)</code> (&quot;kleisli composition&quot;) are quite similar and the difference/analogy between them is worth thinking about"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574363997, "post_id": 58980103, "comment_id": 104217145, "body": "@luqui indeed, and the <code>Category</code> class unifies this general concept of &quot;things that can be composed&quot;. (And <code>Arrow</code> and its subclasses take it further.) (Note I&#39;m mentioning these in case the OP is interested, not because I think you&#39;re unaware of them :-) )"}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574407040, "post_id": 58980991, "comment_id": 104229862, "body": "Bind with monads is a much more powerful concept, allowing you, for example, to implement backtracking, coroutines, continuations, exceptions, undoable actions, transactional memory.  Mutable state is the most boring example ever."}, {"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574416215, "post_id": 58980991, "comment_id": 104234011, "body": "@luqui Whoa. I&#39;m not so experienced in Haskell, so didn&#39;t know that monads are that powerful."}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": false, "score": 6, "last_activity_date": 1574359314, "last_edit_date": 1574359314, "creation_date": 1574358945, "answer_id": 58980991, "question_id": 58980103, "link": "https://stackoverflow.com/questions/58980103/haskell-difference-between-function-composition-and-bind/58980991#58980991", "title": "Haskell difference between function composition and bind", "body": "<p>They are pretty different. Let's look at their signatures:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\n(&gt;&gt;=) :: (Monad m) =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>As you said, the function composition is just a way to pass a result of one function as an argument to another one like this:</p>\n\n<pre><code>f = g . h\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>f x = g (h x)\n</code></pre>\n\n<p>You can think about is as some kind of a \"conveyor\", where your value goes through several processing steps.</p>\n\n<p>But <code>(&gt;&gt;=)</code> is quite different. It is related to such context as <a href=\"https://stackoverflow.com/questions/44965/what-is-a-monad\">monad</a> which is something like some value in some context (it's highly recommended to read the previous link if you aren't familiar with it).</p>\n\n<p>So let <code>x</code> be some value in a context. Our context will be nullability (<a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Maybe.html\" rel=\"noreferrer\"><code>Maybe</code></a> monad), and the value is <code>2</code>. So, <code>x = Just 2</code>. We could, for example, get it as a result of a lookup from some associative container (such operation might fail, that's the reason why it is <code>Maybe Int</code>, but not <code>Int</code>).</p>\n\n<p>Now we want to pass our <code>x</code> to some arithmetic function <code>f</code> that accepts just <code>Int</code> and may fail, so its signature looks like:</p>\n\n<pre><code>f :: Int -&gt; Maybe Int\n</code></pre>\n\n<p>We can't just pass our value because of type mismatch. We could unpack <code>x</code> and handle some cases with <code>if</code>, but we could do that in almost all other languages. In haskell, we can use <code>(&gt;&gt;=)</code>:</p>\n\n<pre><code>x &gt;&gt;= f\n</code></pre>\n\n<p>This allows as to chain the effects:</p>\n\n<ul>\n<li>if <code>x</code> is <code>Nothing</code>, then the result is <code>Nothing</code> immediately</li>\n<li>else <code>x</code> is unpacked and passed to <code>f</code></li>\n</ul>\n\n<p>This is a generalization of the <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#safe-calls\" rel=\"noreferrer\">operator <code>?.</code></a>, that you could see in some languages:</p>\n\n<pre><code>x = a?.func1()?.func2();\n</code></pre>\n\n<p>which checks for <code>null</code> at each \"step\" and stops immediately if hits <code>null</code> or returns the value in case of success. In haskell it looks like:</p>\n\n<pre><code>x = a &gt;&gt;= func1 &gt;&gt;= func2\n</code></pre>\n\n<p>However, bind with monads is a much more powerful concept, allowing you, for example, to emulate stateful computations in a language without mutability like haskell.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1574361089, "last_edit_date": 1574361089, "creation_date": 1574360663, "answer_id": 58981429, "question_id": 58980103, "link": "https://stackoverflow.com/questions/58980103/haskell-difference-between-function-composition-and-bind/58981429#58981429", "title": "Haskell difference between function composition and bind", "body": "<p><code>(&gt;&gt;=)</code> is a form of function <em>application</em>.</p>\n\n<pre><code>(&gt;&gt;=)          :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\nflip ($)       ::              a -&gt; (a -&gt;   b) -&gt;   b\n</code></pre>\n\n<p>It takes a value, but \"extracts\" part of it in order to apply the given function. Chaining two functions, like <code>x &gt;&gt;= f &gt;&gt;= g</code> requires the argument type of <code>g</code> to be <em>different</em> from (but at the same type <em>similar</em> to) the return type of <code>f</code>, unlike composition, which requires the types to match <em>exactly</em>.</p>\n\n<p>Composed with <code>return</code>, it\nreally <em>is</em> just function application, but restricted to certain kinds of functions.</p>\n\n<pre><code>flip ($)       ::              a -&gt; (a -&gt;   b) -&gt;   b\n(&gt;&gt;=) . return :: Monad m =&gt;   a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p><code>(.)</code> is more like <code>(&lt;=&lt;)</code> (from <code>Control.Monad</code>).</p>\n\n<pre><code>(.)   ::            (b -&gt;   c) -&gt; (a -&gt;   b) -&gt; a -&gt;   c\n(&lt;=&lt;) :: Monad m =&gt; (b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c\n</code></pre>\n\n<p>But again, instead of simply passing the result of one function to another, it first \"extracts\" a value before doing application.</p>\n"}], "owner": {"reputation": 179, "user_id": 5557062, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0158252d65d5ea6e497f59045b1eaf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5557062/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1574361089, "creation_date": 1574355743, "question_id": 58980103, "link": "https://stackoverflow.com/questions/58980103/haskell-difference-between-function-composition-and-bind", "title": "Haskell difference between function composition and bind", "body": "<p>I can't understand the difference between Dot (function composition) and bind (>>=) .</p>\n\n<p>If I understand, these two ways take the previous result of a function for a new function.</p>\n\n<p>So what is the difference ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574356012, "post_id": 58979671, "comment_id": 104213349, "body": "Why exactly do you need indices? Just do like <code>foldl (\\r c -&gt; delete c r) &quot;FOOOTBALL&quot; &quot;OREO&quot;</code> which would give <code>&quot;FOTBALL&quot;</code>. Or simply <code>foldl (flip delete)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 1, "last_activity_date": 1574437916, "last_edit_date": 1574437916, "creation_date": 1574355224, "answer_id": 58979964, "question_id": 58979671, "link": "https://stackoverflow.com/questions/58979671/removing-items-from-list-given-a-list-of-indices-where-items-occur-haskell/58979964#58979964", "title": "Removing items from list given a list of indices where items occur - Haskell", "body": "<p>Since the indices to be removed are sorted, you can run down the list, keeping track of the current index, removing elements when the head of the indices list matches the current index.  If they match, you discard the head of both the list of indices and the list of elements.  If they do not match, you emit the element, and process the remainder of the list.  If you run out of indices before you reach the end of the list of elements, you simply return the remainder of the list of elements.</p>\n\n<pre><code>removeIndices :: [Int] -&gt; [a] -&gt; [a]\nremoveIndices = go 0 where\n    go j (i:is) (a:as) | i == j = go (j+1) is as\n                       | otherwise = a : go (j+1) (i:is) as\n    go _ _ as = as\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1574440997, "creation_date": 1574440997, "answer_id": 58998440, "question_id": 58979671, "link": "https://stackoverflow.com/questions/58979671/removing-items-from-list-given-a-list-of-indices-where-items-occur-haskell/58998440#58998440", "title": "Removing items from list given a list of indices where items occur - Haskell", "body": "<p>With package <code>data-ordlist</code>'s <a href=\"https://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html#v:minusBy\" rel=\"nofollow noreferrer\"><code>minusBy :: (a -&gt; b -&gt; Ordering) -&gt; [a] -&gt; [b] -&gt; [a]</code></a>,</p>\n\n<pre><code>&gt; import qualified Data.List.Ordered as O\n\n&gt; map fst $ O.minusBy (\\(_,i) j -&gt; compare i j) (zip \"Hello, World!\" [1..]) [2,5,9]\n\"Hll, Wrld!\"\n</code></pre>\n\n<p>The comparing function can also be written as <code>(compare . snd)</code>, if you prefer.</p>\n"}], "owner": {"reputation": 21, "user_id": 12411568, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lUlXohmTqx8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwOAFhNMsVUNJD29S5YtxKSREl1A/photo.jpg?sz=128", "display_name": "mangoApple", "link": "https://stackoverflow.com/users/12411568/mangoapple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58979964, "answer_count": 2, "score": 1, "last_activity_date": 1574440997, "creation_date": 1574354250, "question_id": 58979671, "link": "https://stackoverflow.com/questions/58979671/removing-items-from-list-given-a-list-of-indices-where-items-occur-haskell", "title": "Removing items from list given a list of indices where items occur - Haskell", "body": "<p>I'm trying to remove items from a list given the indices they occur at. Heres what i've done so far:</p>\n\n<pre><code>count   :: Eq a =&gt; [a] -&gt; [a] -&gt; [Int]\ncount s1 s2 = findIndices(`elem` s1) s2\n</code></pre>\n\n<p>If called like this: count \"FOOOTBALL\" \"OREO\" it will return [1,2] since the intersection of the two strings is 'O' so it will return the list of indices where this character occurs but it wont count the extra 'O' because there's only two 'O' in \"OREO\", I'm just explaining this to give more context.\nSo what i want to do now is get this list of indices that is returned and then remove every character occurring at the indices from the list. But i have no idea how to do this since i just started learning Haskell. Any help would be appreciated Thanks!</p>\n"}, {"tags": ["list", "haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574352318, "post_id": 58979007, "comment_id": 104211224, "body": "Hint: a 2-tuple is not the same as a <i>list</i> of 2-tuples."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574353841, "post_id": 58979007, "comment_id": 104212124, "body": "Where is the data coming from in the first place that you need to remove duplicates? Are you building that list? You might want to use <code>Data.Map</code> to make it easier to update without adding duplicates to the collection in the first place."}, {"owner": {"reputation": 75, "user_id": 12302998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9c07fc4e19d0cafb3e3846b8f10398?s=128&d=identicon&r=PG&f=1", "display_name": "longroad", "link": "https://stackoverflow.com/users/12302998/longroad"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574356561, "post_id": 58979007, "comment_id": 104213627, "body": "I dont get it. filterValidEntries does require a list of ExamScores and the second argurment is such a list... Where is the problem? @Willem  It is my homework chepner. How do you mean I can use map?"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 12302998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9c07fc4e19d0cafb3e3846b8f10398?s=128&d=identicon&r=PG&f=1", "display_name": "longroad", "link": "https://stackoverflow.com/users/12302998/longroad"}, "edited": false, "score": 0, "creation_date": 1574367877, "post_id": 58981356, "comment_id": 104218880, "body": "Ahhh okay I got it. <code>(map (snd) (filterValidEntries (snd x) cn))</code> did it. Thank you for the hint."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1574360362, "creation_date": 1574360362, "answer_id": 58981356, "question_id": 58979007, "link": "https://stackoverflow.com/questions/58979007/haskell-couldnt-match-weird-expected-type/58981356#58981356", "title": "Haskell couldn&#39;t match weird expected type", "body": "<p>A minor, but important, comment on style.  Haskell function application is <em>never</em> written <code>f(x+y)</code> without space between the <code>f</code> and <code>(</code>.  It's always written <code>f (x+y)</code>.</p>\n\n<p>Anyway, here's how to figure out this error message.  The important bits are that GHC expected a type of the form <code>(a, t b)</code> -- the <code>a</code>, <code>t</code>, and <code>b</code> are less important than the fact that it expected a tuple (i.e., pair) type, but it was given an <code>[ExamScore]</code>, which is clearly a list and not the tuple it expected.</p>\n\n<p>Where did this happen?  Well, as the error message says, the problem occurred in trying to pass the first argument to <code>snd</code> -- namely <code>(filterValidEntries (snd x) cn)</code>.</p>\n\n<p>Note that <code>snd</code>, since it grabs the second element of a tuple, obviously <strong>expected</strong> a tuple.  Yet, the argument <code>filterValidEntries (snd x) cn</code> does not return a tuple, it <strong>actually</strong> returns a list <code>[ExamScore]</code>.</p>\n\n<p>That's your problem.  Did you really intend to pass the argument <code>filterValidEntries (snd x) cn</code>, which returns a list, to the function <code>snd</code>, which expects a tuple?  No, you did not.  What <em>were</em> you trying to do?  Maybe map <code>snd</code> to each element of the list?</p>\n"}], "owner": {"reputation": 75, "user_id": 12302998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9c07fc4e19d0cafb3e3846b8f10398?s=128&d=identicon&r=PG&f=1", "display_name": "longroad", "link": "https://stackoverflow.com/users/12302998/longroad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58981356, "answer_count": 1, "score": 0, "last_activity_date": 1574360362, "creation_date": 1574352006, "question_id": 58979007, "link": "https://stackoverflow.com/questions/58979007/haskell-couldnt-match-weird-expected-type", "title": "Haskell couldn&#39;t match weird expected type", "body": "<p>I have a List <code>[(String, [(String, Float)]</code> and want to calculate the average of the floats, so that I get as result <code>[(String, Float)]</code>. You'll understand reading the code.</p>\n\n<pre><code>type StudentName = String\ntype CourseName  = String\ntype ExamScore   = (CourseName, Float)\ntype StudentData = [(StudentName, [ExamScore])]\n\n--Delete duplicated entries\nfilterDuplicates :: StudentData -&gt; StudentData\nfilterDuplicates [] = []\nfilterDuplicates sd = [(head sd)] ++ filterDuplicates(filter (\\ x -&gt; x /= (head sd)) (tail sd))\n\n--Delete entries whose score is not in scope or whose are not listed the list of course names\nfilterValidEntries :: [ExamScore] -&gt; [CourseName] -&gt; [ExamScore]\nfilterValidEntries es cn = filter (\\ x -&gt; ((fst x) `elem` cn) &amp;&amp; ((snd x) &gt;= 1.0 &amp;&amp; (snd x) &lt;= 5.0)) es\n\n--Calulate the average of the cleared data\ncalculateAverages :: StudentData -&gt; [CourseName] -&gt; [(StudentName, Float)]\ncalculateAverages sd cn = map createTupel (filterDuplicates sd)\n    where createTupel x = ((fst x), ((foldr (+) 0 (snd(filterValidEntries(snd x) cn))) / fromIntegral(length (filterValidEntries(snd x) cn))))\n</code></pre>\n\n<p>Trying to compile this, I am getting the following error:</p>\n\n<pre><code>    * Couldn't match expected type `(a0, t0 b)'\n                  with actual type `[ExamScore]'\n    * In the first argument of `snd', namely\n        `(filterValidEntries (snd x) cn)'\n      In the third argument of `foldr', namely\n        `(snd (filterValidEntries (snd x) cn))'\n      In the first argument of `(/)', namely\n        `(foldr (+) 0 (snd (filterValidEntries (snd x) cn)))'\n    * Relevant bindings include\n        createTupel :: (a, [ExamScore]) -&gt; (a, b)\n          (bound at C:\\\\Users\\Lennart\\sciebo\\Semster 1\\Info\\\u00dcbungen\\\u00dcbung 06\\WI0\n4_B06_A04_G01.hs:72:15)\n   |\n72 |         where createTupel x = ((fst x), ((foldr (+) 0 (snd(filterValidEntri\nes(snd x) cn))) / fromIntegral(length (filterValidEntries(snd x) cn))))\n   |                                                            ^^^^^^^^^^^^^^^^\n^^^^^^^^^^^^\n</code></pre>\n\n<p>I hope you can help me, thank you.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1574347764, "post_id": 58977458, "comment_id": 104208387, "body": "What would be the type of <code>tailMay</code>?"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1574347806, "post_id": 58977458, "comment_id": 104208416, "body": "@MarkSeemann - I just realized I forgot to post that an added it while you added your comment!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574347864, "post_id": 58977458, "comment_id": 104208458, "body": "Can&#39;t be done. Make a new class for it, or use more monomorphic functions that just work on the types you actually care about."}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 7, "creation_date": 1574348448, "post_id": 58977458, "comment_id": 104208838, "body": "Suppose you have <code>data Three a = Three a a a</code> with <code>toList (Three x y z) = [x,y,z]</code>.  What should tailMay do, just return Nothing?"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1574356043, "post_id": 58977458, "comment_id": 104213369, "body": "@DavidFletcher Thanks, a counter example is great for understanding this; hadn&#39;t considered fixed-length structures"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574360777, "post_id": 58977458, "comment_id": 104215627, "body": "You can make something with a similar type (but using <code>Alternative</code> rather than <code>Applicative</code>). But to make that something that looks like a tail requires a certain relationship among <code>foldMap</code>, <code>pure</code>, and <code>&lt;|&gt;</code>. Specifically, for any monoid <code>m</code>, any type <code>s</code>, and any function <code>f :: s -&gt; m</code>, there exists a monoid morphism <code>p :: f s -&gt; m</code> (from the monoid induced by <code>&lt;|&gt;</code> and <code>empty</code>) such that <code>f = p . pure</code>. That ensures that <code>f s</code> is the free monoid over <code>s</code> with <code>pure</code> as the injection, which is to say that it&#39;s basically a list."}], "answers": [{"comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574356102, "post_id": 58978500, "comment_id": 104213408, "body": "I wonder if the <code>fromList</code> could be wrapped in a <code>try</code> and return a Nothing in the event of an exception; not ideal but I may give that a try in a bit."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574361043, "post_id": 58978500, "comment_id": 104215776, "body": "Ah, nevermind; I forgot that even though exceptions can be generated in pure code, they cannot be caught in pure code."}], "tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 4, "last_activity_date": 1574354526, "last_edit_date": 1574354526, "creation_date": 1574350506, "answer_id": 58978500, "question_id": 58977458, "link": "https://stackoverflow.com/questions/58977458/how-can-you-write-tailmay-in-haskell-for-foldable-without-using-unsafe-function/58978500#58978500", "title": "How can you write tailMay in Haskell for Foldable, without using unsafe functions?", "body": "<p>Tail only makes sense for list like structures, so it would be sensible to return a list, rather then the same container type <code>f</code>. Implementation is trivial and can be done in many ways, here is one.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad (guard)\nimport Data.Foldable (toList)\n\ntailMay :: Foldable f =&gt; f a -&gt; Maybe [a]\ntailMay xs = guard (not (null xs)) &gt;&gt; Just (drop 1 (toList xs))\n</code></pre>\n\n<p>But, since it works for all list like structures, we could be cool and define it for all things that have is <code>IsList</code>. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TypeFamilies #-}\nimport Control.Monad (guard)\nimport Data.Foldable (toList)\nimport GHC.Exts (IsList(Item, fromList))\n\ntailMay :: (IsList l, Item l ~ a, Foldable f) =&gt; f a -&gt; Maybe l\ntailMay xs = guard (not (null xs)) &gt;&gt; Just (fromList (drop 1 (toList xs)))\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>A nice benefit of the above solution is that you can change types from the argument to the result. For example you can start with a <code>Vector</code> and result with a <code>Set</code>. But that also has a down side, you need to specify the resulting type yourself:</p>\n\n<p>So running this will result in a compile error:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; tailMay [1 :: Int]\n&lt;interactive&gt;:24:1-18: error:\n    \u2022 Illegal equational constraint Item l ~ Int\n      (Use GADTs or TypeFamilies to permit this)\n    \u2022 When checking the inferred type\n        it :: forall l. (IsList l, Item l ~ Int) =&gt; Maybe l\n\u03bb&gt; tailMay [1 :: Int] :: Maybe [Int]\nJust []\n</code></pre>\n\n<p>We can easily restrict resulting type, if above is really a problem or simply an undesired effect for us:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>tailMay :: (IsList l, Item l ~ a, Foldable f, l ~ f a) =&gt; f a -&gt; Maybe l\n</code></pre>\n\n<p>After that it works great:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; import qualified Data.Vector as V\n\u03bb&gt; tailMay $ V.enumFromTo 'a' 'd'\nJust \"bcd\"\n\u03bb&gt; tailMay [1 :: Int]\nJust []\n\u03bb&gt; tailMay V.empty\nNothing\n\u03bb&gt; tailMay []\nNothing\n</code></pre>\n\n<p><em>Warning</em> - It all would be great, but unfortunately there is no guarantee that <code>fromList</code> will have a total implementation:</p>\n\n<pre><code>\u03bb&gt; import qualified Data.List.NonEmpty as NE\n\u03bb&gt; tailMay (5 NE.:| [] :: NE.NonEmpty Int)\nJust *** Exception: NonEmpty.fromList: empty list\n</code></pre>\n\n<p>There is no general way to protect yourself from it, except by creating your own <code>IsList</code> like class and providing your own instances for all such data structures.</p>\n"}, {"tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 0, "last_activity_date": 1574364501, "creation_date": 1574364501, "answer_id": 58982431, "question_id": 58977458, "link": "https://stackoverflow.com/questions/58977458/how-can-you-write-tailmay-in-haskell-for-foldable-without-using-unsafe-function/58982431#58982431", "title": "How can you write tailMay in Haskell for Foldable, without using unsafe functions?", "body": "<p>I'm not sure there is a right answer to this question, as things currently stand, though I wanted to expand on @DanielWagner's comment, as it is probably the most performant option, while also being safe:</p>\n\n<pre><code>-- | Law: (fromJust (length &lt;$&gt; tailMay l)) == (length tailMay) - 1,\n--   if tailMay returns Just\nclass TailMay l where\n  tailMay :: l a -&gt; Maybe (l a)\n\ninstance TailMay NonEmpty where\n  tailMay = LNE.nonEmpty . LNE.tail\n\ninstance TailMay [] where\n  tailMay = liftMay tail null -- &lt;- from 'safe' package\n\n-- from 'safe' package\nliftMay :: (a -&gt; b) -&gt; (a -&gt; Bool) -&gt; (a -&gt; Maybe b)\nliftMay func test val = if test val then Nothing else Just $ func val\n</code></pre>\n\n<p>That said, ideally I'll get around to exploring @dfeuer's comment more as well.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1574364501, "creation_date": 1574347118, "last_edit_date": 1574347779, "question_id": 58977458, "link": "https://stackoverflow.com/questions/58977458/how-can-you-write-tailmay-in-haskell-for-foldable-without-using-unsafe-function", "title": "How can you write tailMay in Haskell for Foldable, without using unsafe functions?", "body": "<p>The signature should be:</p>\n\n<pre><code>tailMay :: Foldable f =&gt; f a -&gt; Maybe (f a)\n</code></pre>\n\n<p>I was given this definition of <code>headMay</code>, which makes sense, and is (to me) rather clever:</p>\n\n<pre><code>headMay :: Foldable f =&gt; f a -&gt; Maybe a\nheadMay = foldr (const . Just) Nothing\n</code></pre>\n\n<p>Unfortunately, I haven't been able to think of anything similar for <code>tailMay</code>, and <a href=\"https://hackage.haskell.org/package/mono-traversable-1.0.13.0/docs/src/Data.Sequences.html#tailMay\" rel=\"noreferrer\">similar implementations</a> seem to use magic or unsafe functions.</p>\n\n<p>If this isn't possible, something that works for an <code>(Applicative t, Foldable t)</code> would also be fine for my purposes (which I gather would also imply <code>Traversable t</code>).</p>\n"}, {"tags": ["list", "haskell", "recursion"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1574346765, "creation_date": 1574346765, "answer_id": 58977357, "question_id": 58977250, "link": "https://stackoverflow.com/questions/58977250/how-does-recursion-work-in-haskell-example-merge-function/58977357#58977357", "title": "How does recursion work in Haskell? - Example merge function", "body": "<blockquote>\n  <p>I wonder how the compiler changes the second list.</p>\n</blockquote>\n\n<p>It does not. If we call <code>merge [2,3] [4,1]</code> then the clause you describe will fire, with: <code>x = 2</code>, <code>y = 4</code>, <code>xs = [3]</code> and <code>ys = [1]</code>. It will indeed check that <code>2 &lt;= 4</code>, which holds, and then call merge with:</p>\n\n<pre><code>x : merge xs (y:ys)\n</code></pre>\n\n<p>so that means that if we use the variables we just assigned, we get:</p>\n\n<pre><code>2 : merge [3] (4:[1])\n</code></pre>\n\n<p>or less verbose:</p>\n\n<pre><code>2 : merge [3] [4,1]\n</code></pre>\n\n<blockquote>\n  <p>I wonder how the compiler changes the second list: At first 4 was the head element but since it makes none sense to compare the 3 to the 4 again the indices has to be switched.</p>\n</blockquote>\n\n<p>Such <code>merge</code> function often has a <em>precondition</em> that the two lists it aims to merge, are sorted <em>individually</em> already. So normally <code>merge [2,3] [4,1]</code> will not be called with an algorithm like <em>MergeSort</em>, the two lists are first sorted, and then it is thus called with <code>merge [2,3] [1,4]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1574347527, "last_edit_date": 1574347527, "creation_date": 1574346783, "answer_id": 58977362, "question_id": 58977250, "link": "https://stackoverflow.com/questions/58977250/how-does-recursion-work-in-haskell-example-merge-function/58977362#58977362", "title": "How does recursion work in Haskell? - Example merge function", "body": "<p><code>3</code> <em>isn't</em> compared to <code>1</code> until it has been compared to <code>4</code> as well; <code>merge</code> preserves the relative order of each value within a single list.</p>\n\n<p>The recursion proceeds as follows:</p>\n\n<pre><code>merge [2,3] [4,1] == 2 : merge [3] [4,1]  -- 2 &lt; 4\n                  == 2 : 3 : merge [] [4, 1] -- 3 &lt; 4\n                  == 2 : 3 : [4, 1] -- assuming merge [] ys == ys\n</code></pre>\n\n<hr>\n\n<p>Don't confuse <code>merge</code> with <code>mergeSort</code>, which <em>uses</em> <code>merge</code> as a subroutine.</p>\n\n<pre><code>mergeSort [] = []\nmergeSort xs = merge (mergeSort first) (mergeSort second)\n   where (first, second) = split xs\n         split xs = ... -- some function to split a list roughly in half\n</code></pre>\n\n<p>The order-preserving behavior of <code>merge</code> is what makes <code>mergeSort</code> a <a href=\"https://en.wikipedia.org/wiki/Sorting_algorithm#Stability\" rel=\"nofollow noreferrer\">stable sorting algorithm</a>.</p>\n"}], "owner": {"reputation": 133, "user_id": 11737889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787e863ec85b815cd797b5d6e31811d1?s=128&d=identicon&r=PG&f=1", "display_name": "Cara", "link": "https://stackoverflow.com/users/11737889/cara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574347527, "creation_date": 1574346487, "question_id": 58977250, "link": "https://stackoverflow.com/questions/58977250/how-does-recursion-work-in-haskell-example-merge-function", "title": "How does recursion work in Haskell? - Example merge function", "body": "<p>if we look at the funtion definition of merge</p>\n\n<pre><code>merge (x:xs) (y:ys) | x &lt;= y    = x:merge xs (y:ys)\n                    | otherwise = y:merge (x:xs) ys\n</code></pre>\n\n<p>With the input [2,3] [4,1]</p>\n\n<p>the first step looks like this</p>\n\n<p><code>2&lt;=4 =&gt; 2:merge [3] (1:[4])</code></p>\n\n<p>Here my question lies: The first head element of the second list was 4 but since 2&lt;=4 nothing was done with 4 so the 4 has to be still in the second list but the 4 needs to be the last element in the list now so 3 can be compared to the 1. I wonder how the compiler changes the second list: At first 4 was the head element but since it makes none sense to compare the 3 to the 4 again the indices has to be switched.</p>\n\n<p>So the compiler just put the head element to the end of the list after the first comparison? Or what does the compiler do here?</p>\n"}, {"tags": ["haskell", "parser-combinators"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574346096, "post_id": 58977095, "comment_id": 104207303, "body": "The indentation looks wrong at the end. <code>var</code> should be as indented as <code>reserved</code> and so must be the other lines below. I am also not sure about the <code>print var</code> line, that looks weird: we are parsing the code, not executing it at this stage."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574347658, "post_id": 58977095, "comment_id": 104208317, "body": "The parser shouldn&#39;t be printing anything; it just has to produce a correct <code>Write</code> value. It&#39;s the job of your <i>evaluator</i> to process a <code>Write</code> value into a call to <code>print</code> or the like."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574347739, "post_id": 58977095, "comment_id": 104208373, "body": "Something like <code>writeStmt = do { reserved &quot;write&quot;; Write &lt;$&gt; identifier }</code>."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1574715622, "creation_date": 1574715622, "answer_id": 59040025, "question_id": 58977095, "link": "https://stackoverflow.com/questions/58977095/add-io-functionality-to-imperative-language-parser/59040025#59040025", "title": "Add IO functionality to imperative language parser", "body": "<p>As was noted in the comments, you need to fix the indentation so all of the statements in your <code>do</code>-block line up:</p>\n\n<pre><code>writeStmt :: Parser Stmt\nwriteStmt =\n  do reserved \"write\"\n     var &lt;- identifier\n     print var\n     return $ Write var\n</code></pre>\n\n<p>and then, you need to delete that <code>print var</code> statement.  During <em>parsing</em>, you just want to identify write statements and store them in your abstract syntax tree (AST) (i.e., in your <code>Stmt</code> tree).  The actual printing will take place in a separate function that executes the program represented by the AST.</p>\n\n<p>Unfortunately, the wiki page you're working from only shows you how to perform the parsing, not how to actually execute the parsed representation.</p>\n"}], "owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574715622, "creation_date": 1574345994, "question_id": 58977095, "link": "https://stackoverflow.com/questions/58977095/add-io-functionality-to-imperative-language-parser", "title": "Add IO functionality to imperative language parser", "body": "<p>I'm trying to add IO functionality such as <code>read</code> and <code>write</code> statements to a parser for an imperative language like shown here <a href=\"https://wiki.haskell.org/Parsing_a_simple_imperative_language\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Parsing_a_simple_imperative_language</a></p>\n\n<p>I want to add statements such as <code>write \"example\"</code> which will write \"example\" to stdout with something like <code>putStrLn</code> or <code>print</code>.</p>\n\n<p>So far I've made the following changes</p>\n\n<pre><code>-- Add Write data type so that a statement such as `write \"test\"` can be represented as a statement\ndata Stmt = Seq [Stmt]\n          | ... (same as before)\n          | Write String\n            deriving (Show)\n\n-- write needs to be added to reservedNames as it has a function in the language\nlanguageDef =\n  emptyDef { Token...\n           , ...\n           , Token.reservedNames  = [ \"if\"\n                                    , ...\n                                    , \"write\"\n                                    ...\n\n-- whenever a statement is parsed, writeStmt function now needs to be called to parse a write statement\nstatement' :: Parser Stmt\nstatement' =  ifStmt\n          &lt;|&gt; whileStmt\n          &lt;|&gt; skipStmt\n          &lt;|&gt; assignStmt\n          &lt;|&gt; writeStmt\n\n-- do reserved write, get the identifier, print it to stdout and return the Write statement\nwriteStmt :: Parser Stmt\nwriteStmt =\n  do reserved \"write\"\n    var &lt;- identifier\n    print var\n    return $ Write var\n</code></pre>\n\n<p>I'm getting errors on <code>var &lt;- identifier</code> in <code>whileStmt</code> and i'm not sure what else needs to be added or changed to get this to work. thanks</p>\n"}, {"tags": ["haskell", "space-leak"], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1574338624, "creation_date": 1574338624, "answer_id": 58974852, "question_id": 58974359, "link": "https://stackoverflow.com/questions/58974359/avoiding-space-leaks-with-mapm-and-foldm-over-state-monad/58974852#58974852", "title": "Avoiding space leaks with `mapM` and `foldM` over `State` monad", "body": "<p>Space leaks can be very hard to detect in Haskell. I am no expert, but I have heard there are many problems with the State monad and space leaks. I generally avoid <code>State</code>/<code>StateT</code> and use <code>IORef</code>, <code>MVar</code> or <code>TVar</code> instead, but that would change it to <code>IO</code>. The first thing you can try is adding <code>!</code> in various let bindings and type definitions. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Door = Door !Coord !Coord\ndata Maze = Path ![Coord] | Junction ![Maze]\n</code></pre>\n\n<p>If that doesn't resolve it, there are some tools that may help you pinpoint where it occurs in this <a href=\"https://ro-che.info/articles/2017-01-10-nested-loop-space-leak\" rel=\"nofollow noreferrer\">article</a>.</p>\n\n<h2>Other resources</h2>\n\n<p>Here are some other resources that might help.</p>\n\n<ul>\n<li><a href=\"https://github.com/ndmitchell/spaceleak\" rel=\"nofollow noreferrer\">ndmithcell on space leak detection</a></li>\n<li><a href=\"https://www.reddit.com/r/haskell/comments/7xqfy8/space_leak_with_nested_strict_statet/\" rel=\"nofollow noreferrer\">Space leak with nested strict StateT</a></li>\n<li><a href=\"http://blog.ezyang.com/2011/06/pinpointing-space-leaks-in-big-programs/\" rel=\"nofollow noreferrer\">Pinpointing space leaks in big programs</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 2070405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fb99aeccbf72102b1ce5a8df88b62b?s=128&d=identicon&r=PG", "display_name": "Neil Smith", "link": "https://stackoverflow.com/users/2070405/neil-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1574353524, "creation_date": 1574353524, "answer_id": 58979459, "question_id": 58974359, "link": "https://stackoverflow.com/questions/58974359/avoiding-space-leaks-with-mapm-and-foldm-over-state-monad/58979459#58979459", "title": "Avoiding space leaks with `mapM` and `foldM` over `State` monad", "body": "<p>Turns out, it wasn't a space leak! It was me failing to deal with some pathological input. Once I sorted out how to handle that, it worked, and very quickly.</p>\n"}], "owner": {"reputation": 183, "user_id": 2070405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fb99aeccbf72102b1ce5a8df88b62b?s=128&d=identicon&r=PG", "display_name": "Neil Smith", "link": "https://stackoverflow.com/users/2070405/neil-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 58979459, "answer_count": 2, "score": 0, "last_activity_date": 1574353524, "creation_date": 1574337045, "question_id": 58974359, "link": "https://stackoverflow.com/questions/58974359/avoiding-space-leaks-with-mapm-and-foldm-over-state-monad", "title": "Avoiding space leaks with `mapM` and `foldM` over `State` monad", "body": "<p>How do I avoid space leaks while using <code>foldM</code> and <code>mapM</code> over a <code>State</code> monad?</p>\n\n<p>Last year's <a href=\"https://adventofcode.com/2018/day/20\" rel=\"nofollow noreferrer\">Advent of Code day 20</a> has a puzzle of generating a map of a maze from instructions on how to walk across it. For instance, the instructions <code>NN</code> gives the maze </p>\n\n<pre><code>   |\n   |\n   *\n</code></pre>\n\n<p>(a straight corridor two steps northwards), and the instructions <code>NNN(EE|WW)S</code> gives the maze </p>\n\n<pre><code> +-+-+\n | | |\n   |\n   *\n</code></pre>\n\n<p>(go north a bit, then either go east then south or west then south).</p>\n\n<p>The way I'm trying to solve this involves having a <code>State</code> monad, where the state is the <code>Set</code> of all the corridor sections (termed <code>Door</code>s below), and the value is the list of positions you could be working from.</p>\n\n<p>If you're just following a corridor <code>Path</code>, I use <code>foldM</code> to walk along it, updating the current position. If you're at a junction, follow each branch of the junction and collect all the positions you end up. </p>\n\n<p>This code produces the correct results on small test inputs, but there's a huge space leak when working on the full example.</p>\n\n<p>Profiling indicates it's spending most of its time in <code>includeDoor</code>.</p>\n\n<h2>So, questions.</h2>\n\n<ol>\n<li>Is there a space leak? If so, where, and how can you tell.</li>\n<li>How do I fix it?</li>\n</ol>\n\n<p>(I think what's happening is that Haskell isn't strictly adding fully-evaluated <code>Door</code>s to the <code>Set</code> as soon as it can. In this case, I don't want any laziness anywhere.)</p>\n\n<p>(I parse the input into a bunch of two-element vectors that indicate the step to take for each instruction. That code works fine, and quickly.)</p>\n\n<pre><code>import qualified Data.Set as S\n\nimport Linear (V2(..))\n\nimport Control.Monad.State.Strict\nimport Control.Monad.Extra (concatMapM)\n\ntype Coord = V2 Integer -- x, y, with north and east incresing values (origin a bottom left)\ndata Door = Door Coord Coord deriving (Show, Eq, Ord)\ntype Doors = S.Set Door\n\ndata MazeSection = Path [Coord] | Junction [Maze] deriving (Show, Eq)\ntype Maze = [MazeSection]\n\ntype Mapper = State Doors [Coord]\n\nmakeDoor :: Coord -&gt; Coord -&gt; Door\nmakeDoor !a !b \n    | a &lt; b = Door a b\n    | otherwise = Door b a\n\nemptyMap = S.empty\n\npart1 maze = \n    do \n        let start = V2 0 0\n        let doors = execState (mapMaze [start] maze) emptyMap\n        print $ length doors\n\nmapMaze :: [Coord] -&gt; Maze -&gt; Mapper\nmapMaze !starts !sections =\n    foldM (\\heres section -&gt; mapMazeSection heres section) starts sections\n\nmapMazeSection :: [Coord] -&gt; MazeSection -&gt; Mapper\nmapMazeSection !starts (Junction mazes) = \n    concatMapM (\\maze -&gt; mapMaze starts maze) mazes\nmapMazeSection !starts (Path steps) = \n    mapM mapPath starts\n    where mapPath start = foldM (\\here step -&gt; includeDoor here step) start steps\n\nincludeDoor :: Coord -&gt; Coord -&gt; State Doors Coord\nincludeDoor !here !step = \n    do let there = (here + step)\n       let door = there `seq` makeDoor here there\n       modify' (door `seq` S.insert door)\n       return there\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1574324874, "post_id": 58965469, "comment_id": 104194517, "body": "If you define <code>instance Show V</code> as <code>show m = show a</code> you&#39;ll get the same behaviour."}, {"owner": {"reputation": 104, "user_id": 2984950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9624bfde96ece64e7474dc9583e15ec3?s=128&d=identicon&r=PG&f=1", "display_name": "curly_dev", "link": "https://stackoverflow.com/users/2984950/curly-dev"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1574332653, "post_id": 58965469, "comment_id": 104199302, "body": "Yes that was my problem with this. That it adds a show to the function but i didn&#39;t see anywhere specified.  I didn&#39;t find anything related to this so."}], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 7, "last_activity_date": 1574297121, "creation_date": 1574297121, "answer_id": 58965578, "question_id": 58965469, "link": "https://stackoverflow.com/questions/58965469/different-outputs-in-ghci/58965578#58965578", "title": "Different outputs in GHCI", "body": "<p>Whenever a value is displayed in GHCi, it uses the <code>Show</code> instance of that object to convert it to human-readable text by applying the <code>show</code> function, then printing the resulting <code>String</code>. In your case, what is happening is:</p>\n\n<ul>\n<li>You have defined the <code>Show</code> instance of <code>V</code> to be a constant <code>\"\\n\"</code>, or newline. Thus when GHCi tries to display a value of type <code>V</code> it outputs a newline.</li>\n<li>By contrast, the <code>Show</code> instance of <code>String</code> is defined in such a way that for any string <code>s</code>, <code>show s</code> will output the Haskell representation of <code>s</code>. For instance, <code>show \"\\n\"</code> will give a result of <code>\"\\\"\\\\n\\\"</code> (i.e. quotation mark, backslash, <code>n</code>, quotation mark). (Try running <code>show \"myString\"</code> in GHCi and seeing the result for different strings to get an idea of how this works.) Thus when GHCi displays a <code>String</code>, it takes the string (a newline, in your case), converts it to a human-readable format with escape characters using <code>show</code>, and then displays that new string.</li>\n</ul>\n\n<p>Why is <code>show</code> implemented in this convoluted way for strings? I\u2019m not quite sure, but one possibility is disambiguation: <code>show 1</code> is <code>\"1\"</code>, but <code>show \"1\"</code> is <code>\"\\\"1\\\"\"</code>. When printed to the console, the former is clearly a number, whereas the latter is clearly a string.</p>\n"}], "owner": {"reputation": 104, "user_id": 2984950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9624bfde96ece64e7474dc9583e15ec3?s=128&d=identicon&r=PG&f=1", "display_name": "curly_dev", "link": "https://stackoverflow.com/users/2984950/curly-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58965578, "answer_count": 1, "score": 3, "last_activity_date": 1574297121, "creation_date": 1574296246, "question_id": 58965469, "link": "https://stackoverflow.com/questions/58965469/different-outputs-in-ghci", "title": "Different outputs in GHCI", "body": "<p>Running this with <code>M 1</code> will show a new line and <code>a</code> will show the characters \"\\n\" in the ghci output.\nSince they are the same characters i would expect the same behaviour.</p>\n\n<p>Any reason why?</p>\n\n<pre><code>data V = M Int\ninstance Show V where\n  show m = a\n\na :: [Char]\na = \"\\n\"\n</code></pre>\n"}]