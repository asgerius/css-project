[{"tags": ["class", "haskell", "instance"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1429129483, "post_id": 29659866, "comment_id": 47459838, "body": "That <code>Square Float</code> instance should work just fine. What problem a you experiencing with it?"}, {"owner": {"reputation": 1056, "user_id": 1268085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff2b99da4e49f13c53b2f718649fc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Sajanikar", "link": "https://stackoverflow.com/users/1268085/yogesh-sajanikar"}, "edited": false, "score": 1, "creation_date": 1429130111, "post_id": 29659866, "comment_id": 47460200, "body": "The above code should work fine for Float. You should just call, for example area 10.0::Float to remove ambiguity."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1429129424, "last_edit_date": 1495540245, "creation_date": 1429129086, "answer_id": 29660077, "question_id": 29659866, "link": "https://stackoverflow.com/questions/29659866/haskell-using-constraint-to-define-an-instance-of-a-class/29660077#29660077", "title": "Haskell. Using constraint to define an instance of a class", "body": "<blockquote>\n  <p>I think it is better to make a single instance of the type <code>Num</code>...</p>\n</blockquote>\n\n<p>Not really, unless you want to define that class <em>only</em> for <code>Num</code> types (and then you don't need a class at all, just make it <code>area :: Num a =&gt; a-&gt;a</code> as a top-level function).</p>\n\n<p>Here's the way to make such a generic instance:</p>\n\n<pre><code>instance (Num a) =&gt; Square a where\n  area a = a*a\n</code></pre>\n\n<p>This is not Haskell98, but it does work with the widely used <code>-XFlexibleInstances</code> and <code>-XUndecidableInstances</code> extensions.</p>\n\n<p>Problem: if you then also want to add, say,</p>\n\n<pre><code>instance Square String where\n  area str = concat $ replicate (length str) str\n</code></pre>\n\n<p>you have two <em>overlapping instances</em>. And that's a problem: in general, the compiler can't decide which of two such instances is the right one. Again GHC has extensions to make the best guess (<code>-XOverlappingInstances</code> and <code>-XIncoherentInstances</code>), but unlike <code>Flexible/UndecidableInstances</code> these are <a href=\"https://stackoverflow.com/questions/10830757/is-there-a-list-of-ghc-extensions-that-are-considered-safe\">generally avoided</a>.</p>\n\n<p>Therefore I <em>would</em> recommend making individual instances <code>Square Int</code>, <code>Square Integer</code>, <code>Square Double</code>. They're not, like, hard to write, are they?</p>\n"}], "owner": {"reputation": 120, "user_id": 1233114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63130fc623ed53e64446d4cba094deed?s=128&d=identicon&r=PG", "display_name": "nyvaken", "link": "https://stackoverflow.com/users/1233114/nyvaken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 29660077, "answer_count": 1, "score": 4, "last_activity_date": 1429129424, "creation_date": 1429128379, "question_id": 29659866, "link": "https://stackoverflow.com/questions/29659866/haskell-using-constraint-to-define-an-instance-of-a-class", "title": "Haskell. Using constraint to define an instance of a class", "body": "<p>While trying to understand instances in Haskell I made this example. The Integer part works well but it does not work for the Float instance. I think it is better to make a single instance of the type Num (so that square works on all Num). I suppose I have to add Num as a constraint to my class declaration but I couldn't figure out what the instance would look like. As I understand it, the constraint on the class forces any instances to be of that type (according to the constraint).</p>\n\n<pre><code>class Square a where\n    area :: a -&gt; a\n\ninstance Square Integer where\n    area a = a*a\n\ninstance Square Float where\n    area a = a*a\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "edited": false, "score": 0, "creation_date": 1429128824, "post_id": 29659508, "comment_id": 47459444, "body": "I almost understood but can you please elaborate little more on how ((const flip 3) const 4) 5 became flip const 4 5."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "edited": false, "score": 0, "creation_date": 1429129062, "post_id": 29659508, "comment_id": 47459606, "body": "<code>const x y</code> is <code>x</code>, so <code>const flip 3</code> is <code>flip</code>."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "edited": false, "score": 0, "creation_date": 1429129184, "post_id": 29659508, "comment_id": 47459675, "body": "(And after that: do you know about how <code>(f x) y</code> and <code>f x y</code> are always the exact same thing in Haskell, because of currying? If we apply the substitution I just mentioned, we get <code>(flip const 4) 5</code>, which is just <code>flip const 4 5</code>.)"}], "tags": [], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "is_accepted": true, "score": 16, "last_activity_date": 1429127305, "creation_date": 1429127305, "answer_id": 29659508, "question_id": 29659397, "link": "https://stackoverflow.com/questions/29659397/how-is-this-haskell-expression-evaluated/29659508#29659508", "title": "how is this haskell expression evaluated", "body": "<p>By definition of <code>(.)</code>:</p>\n\n<pre><code>  flip const 1 $ ((const flip 3) const 4) 5\n</code></pre>\n\n<p>By definition of <code>const</code>:</p>\n\n<pre><code>= flip const 1 $ flip const 4 5\n</code></pre>\n\n<p>By definition of <code>flip</code>:</p>\n\n<pre><code>= flip const 1 $ const 5 4\n</code></pre>\n\n<p>By definition of <code>const</code>:</p>\n\n<pre><code>= flip const 1 5\n</code></pre>\n\n<p>By definition of <code>flip</code>:</p>\n\n<pre><code>= const 5 1\n</code></pre>\n\n<p>Which is <code>5</code>.</p>\n\n<p><em>(As a little bonus insight, can you find out why <code>flip const y</code> is just <code>id</code> for all <code>y</code>? This reduces your expression to <code>(id . id) 5</code>.)</em></p>\n"}, {"tags": [], "owner": {"reputation": 15620, "user_id": 596361, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b7219254970581e53d3b2b162f7f50f8?s=128&d=identicon&r=PG", "display_name": "Mirzhan Irkegulov", "link": "https://stackoverflow.com/users/596361/mirzhan-irkegulov"}, "is_accepted": false, "score": 2, "last_activity_date": 1441201825, "last_edit_date": 1592644375, "creation_date": 1437818720, "answer_id": 31625335, "question_id": 29659397, "link": "https://stackoverflow.com/questions/29659397/how-is-this-haskell-expression-evaluated/31625335#31625335", "title": "how is this haskell expression evaluated", "body": "<p>Every time you see some \u201cclever\u201d function invocation in Haskell, always check its types, then try to play with it in GHCi.</p>\n<p>The only way to learn Haskell is actually try it out, and you can't do it just by reading StackOverflow answers or online tutorials, you have to put expressions into GHCi, fail miserably, try to figure out the error for yourself, try to substitute different values in different places to make the error go away, try to divide the problem into chunks and comprehend them separately, and so on.</p>\n<p>It's impossible to code Haskell without understanding its type system (which, I promise, is not hard). If you don't understand what, for example, a \u201ctype variable\u201d means, read the chapter on <a href=\"http://learnyouahaskell.com/types-and-typeclasses\" rel=\"nofollow noreferrer\"><em>Types and Typeclasses</em></a>, and make sure you diligently try out every expression in GHCi.</p>\n<p>Your original expression is:</p>\n<pre><code>(flip const 1 . const flip 3 const 4) 5\n</code></pre>\n<p><code>(.)</code> is <a href=\"https://wiki.haskell.org/Function_composition\" rel=\"nofollow noreferrer\">function composition</a>, and if the expression typechecks (i.e. it doesn't throw a compile-time type error), then <code>flip const 1</code> and <code>const flip 3 const 4</code> got to be functions.</p>\n<blockquote>\n<p><strong>Exercise:</strong> Now open GHCi and enter the following one by one and inspect the types (<code>:t</code> GHCi command is to check a type of some value):</p>\n<pre><code>:t const\n:t flip\n</code></pre>\n</blockquote>\n<p>First of all, remember this fact about Haskell's type system. If there is a type variable, such as <code>a</code>, in a type declaration, then the function must accept any type. If there is a type variable bounded by a typeclass, e.g. <code>f :: Num a =&gt; a -&gt; a</code>, then the function must accept any type, that is instance of typeclass <code>Num</code> (i.e. any number). You can't have a function that returns <code>a</code>, but in whose body you make it return a <code>String</code>.</p>\n<p>Second, if there are more than 1 type variables in the type declaration, their type is always the same. So if you have a function has the type <code>f :: a -&gt; a</code>, and you gave it an <code>Int</code>, it must return <code>Int</code>. Because Haskell has no runtime type checking, you can't assume anything about the types, if you accept a type variable.</p>\n<p>These 2 facts restrict what a function can do, if it has a certain type. Thus:</p>\n<ul>\n<li><code>f :: a -&gt; a</code> always returns the argument; it can't reason about the argument, because it doesn't know its type, it can't apply any functions with more specific types, so it has to just return the argument</li>\n<li><code>f :: (a, b) -&gt; a</code> is <code>fst</code>, and nothing else, it doesn't know anything about the first element of a pair, so it has to just return it</li>\n<li><code>f :: (a, b) -&gt; b</code> is <code>snd</code>, for the same reason</li>\n<li><code>f :: a -&gt; b -&gt; a</code> takes 2 arguments and returns the first</li>\n<li><code>f :: b -&gt; a -&gt; a</code> takes 2 arguments and returns the second</li>\n</ul>\n<p>This restriction is a good thing, because just by looking at the type you can guess a lot about the function. Some types are just impossible, for example <code>f :: a -&gt; b</code>, there is no function of such type (because what would <code>b</code> be anyway?).</p>\n<p>Remember, <code>-&gt;</code> in type declaration is <a href=\"https://wiki.haskell.org/Partial_application\" rel=\"nofollow noreferrer\">right-associative</a>, so:</p>\n<pre><code>f :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c\nf :: (a -&gt; b -&gt; c) -&gt; b -&gt; (a -&gt; c)\nf :: (a -&gt; b -&gt; c) -&gt; (b -&gt; a -&gt; c)\nf :: (a -&gt; b -&gt; c) -&gt; (b -&gt; (a -&gt; c))\nf :: (a -&gt; (b -&gt; c)) -&gt; (b -&gt; (a -&gt; c))\n</code></pre>\n<p>are all equivalent. So you can treat a function of type <code>f :: a -&gt; b -&gt; c</code> as taking 2 arguments and returning a value, or you can treat it as taking 1 argument and returning a function of 1 argument.</p>\n<p>\u201cWait,\u201d you might say, \u201cyou said a function of type <code>a -&gt; b</code> is impossible, then how can <code>f</code> be of type <code>(a -&gt; b -&gt; c) -&gt; b -&gt; (a -&gt; c)</code>, that is, return a function of type <code>a -&gt; c</code>?\u201d Well, <code>f</code> actually never returns a function of type <code>a -&gt; c</code>, because you never pass a function of type <code>a -&gt; b -&gt; c</code> to it. Instead, you might pass a function of type <code>Int -&gt; a -&gt; [a]</code> and get a function of type <code>a -&gt; (Int -&gt; [a])</code>.</p>\n<p>Then you pass another value, let's say of type <code>String</code>, to this new function. You get a function of type <code>Int -&gt; [String]</code> as a result. Now <code>Int -&gt; [String]</code> is not an impossible function, is it?</p>\n<p>Technically speaking, you can return a function of type <code>a -&gt; b</code>, it's called <a href=\"https://stackoverflow.com/a/16750944/596361\"><code>undefined</code></a>. <code>undefined</code> is a value of type <code>a</code>, that is, it inhabits <em>any</em> type. But that's a topic for another time.</p>\n<blockquote>\n<p><strong>Exercise:</strong> So let's continue playing with types in GHCi:</p>\n<pre><code>:t const\n:t flip\n:t const flip\n:t flip const\n</code></pre>\n</blockquote>\n<p>What have you learned from the types? Which arguments will these functions ignore? Which values (or functions) will they return?</p>\n<blockquote>\n<p><strong>Exercise:</strong> If you still don't understand, where I'm heading, try to enter these into GHCi in that order, to see how partial application changes types:</p>\n<pre><code>:t flip\n:t flip const\n:t flip const 1\n:t const\n:t const flip\n:t const flip 3\n:t const flip 3 const\n:t const flip 3 const 4\n:t id\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 1, "accepted_answer_id": 29659508, "answer_count": 2, "score": 8, "last_activity_date": 1441201825, "creation_date": 1429126963, "last_edit_date": 1429127210, "question_id": 29659397, "link": "https://stackoverflow.com/questions/29659397/how-is-this-haskell-expression-evaluated", "title": "how is this haskell expression evaluated", "body": "<p>I am learning <code>haskell</code> and I came across this expression which I could not understand.</p>\n\n<pre><code>(flip const 1 . const flip 3 const 4) 5\n</code></pre>\n\n<p>The final result is 5 but I have no idea how it is evaluated.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 11, "creation_date": 1429126755, "post_id": 29659203, "comment_id": 47458287, "body": "The type given has no implementation.  For example, <code>IO (Maybe a) -&gt; Maybe (IO a)</code> would allow us to find out some information about what an <code>IO</code> action returned without running it. You need to assume more about <code>m</code> and <code>n</code>.  <a href=\"http://stackoverflow.com/questions/7040844/applicatives-compose-monads-dont\">This</a> might be an interesting thread."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1429127013, "post_id": 29659203, "comment_id": 47458419, "body": "Er wait I meant <a href=\"http://stackoverflow.com/questions/29453915/composing-monads-v-applicative-functors/29454112#29454112\">this thread</a>"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1429127547, "post_id": 29659203, "comment_id": 47458708, "body": "See <a href=\"http://stackoverflow.com/q/13034229/1333025\">Concrete example showing that monads are not closed under composition (with proof)?</a>."}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 8, "last_activity_date": 1429127048, "creation_date": 1429127048, "answer_id": 29659424, "question_id": 29659203, "link": "https://stackoverflow.com/questions/29659203/implementing-distrib-function/29659424#29659424", "title": "Implementing `distrib` Function", "body": "<p>This function can't be written for two arbitrary monads, but it does exist when the outer type is <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Traversable.html#v:sequence\" rel=\"noreferrer\">Traversable</a>, as some (but not all) Monad instances are:</p>\n\n<pre><code>sequence :: (Traversable t, Monad m) =&gt; t (m a) -&gt; m (t a)\n</code></pre>\n\n<p>You could then define</p>\n\n<pre><code>distrib :: (Monad m, Traversable m, Monad n) =&gt; m (n a) -&gt; n (m a)\ndistrib = sequence\n</code></pre>\n\n<p>but this doesn't buy you anything, so you might as well just use <code>sequence</code> when appropriate.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 29659424, "answer_count": 1, "score": 0, "last_activity_date": 1429127048, "creation_date": 1429126338, "last_edit_date": 1495539807, "question_id": 29659203, "link": "https://stackoverflow.com/questions/29659203/implementing-distrib-function", "title": "Implementing `distrib` Function", "body": "<p>After getting <a href=\"https://stackoverflow.com/questions/29640717/monad-transformer-distribute-function/29640792#29640792\">help</a> on an error where I used <code>=&gt;</code> rather than <code>-&gt;</code>, I'm trying to implement <code>distrib</code>:</p>\n\n<pre><code>distrib :: (Monad m, Monad n) =&gt; n (m a) -&gt; m (n a)\ndistrib x = do xx &lt;- x\n               return xx \n</code></pre>\n\n<p>But, this does not work given the compile-time error:</p>\n\n<pre><code>Expected type: m (m a)\n  Actual type: n (m a)\n</code></pre>\n\n<p>I realized that using <code>do</code> notation won't work since, when calling <code>xx &lt;- x</code>, the expected return type (of the <code>do</code> block) is <code>x</code>, i.e. <code>n (m a)</code> - that's not what I want.</p>\n\n<p>Please give me a hint on how to implement this function.</p>\n"}, {"tags": ["haskell", "state-monad"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429122207, "post_id": 29657782, "comment_id": 47455432, "body": "Can you include the definition for <code>buildQuotas</code>?  Or preferably you could reduce your code to a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1429122629, "post_id": 29657782, "comment_id": 47455680, "body": "Also, <code>allocatePizzasImpl</code> doesn&#39;t typecheck (trying to match <code>(flavor, _)</code> pattern with type <code>Int</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4793220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8eb0c69bfb2f2748855c0b30414404?s=128&d=identicon&r=PG", "display_name": "Sandy Maguire", "link": "https://stackoverflow.com/users/4793220/sandy-maguire"}, "edited": false, "score": 0, "creation_date": 1429133234, "post_id": 29658340, "comment_id": 47461992, "body": "This is a much nicer implementation than mine. Thanks!"}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 1, "last_activity_date": 1429123555, "creation_date": 1429123555, "answer_id": 29658340, "question_id": 29657782, "link": "https://stackoverflow.com/questions/29657782/haskell-put-in-state-monad-seems-to-be-elided/29658340#29658340", "title": "Haskell: put in State monad seems to be elided", "body": "<p>I think your function <code>replace</code> is broken:</p>\n\n<pre><code>replace (_:xs) (Just val) 0 = val:xs\n</code></pre>\n\n<p>This doesn't pay any attention to the value it's replacing.  Wasn't your intention to replace just the pair corresponding to <code>key</code>?</p>\n\n<p>I think you want</p>\n\n<pre><code>updateWith [] e k = []\nupdateWith ((k', v):kvs) e k\n    | k' == k = case e v of\n        Just v' -&gt; (k, v'):kvs\n        Nothing -&gt; kvs\n    | otherwise = (k', v) : updateWith kvs e k\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1429144195, "post_id": 29661097, "comment_id": 47466039, "body": "Just standard laziness. Why compute the resulting state if nobody cares what it is? (Note that you don&#39;t actually use <code>inventory</code> to make any decisions except what the next inventory should be!)"}, {"owner": {"reputation": 63, "user_id": 4793220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8eb0c69bfb2f2748855c0b30414404?s=128&d=identicon&r=PG", "display_name": "Sandy Maguire", "link": "https://stackoverflow.com/users/4793220/sandy-maguire"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1429160549, "post_id": 29661097, "comment_id": 47470371, "body": "Fantastic point. Not using inventory is the real bug. Cheers!"}], "tags": [], "owner": {"reputation": 63, "user_id": 4793220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8eb0c69bfb2f2748855c0b30414404?s=128&d=identicon&r=PG", "display_name": "Sandy Maguire", "link": "https://stackoverflow.com/users/4793220/sandy-maguire"}, "is_accepted": false, "score": 0, "last_activity_date": 1429160660, "last_edit_date": 1429160660, "creation_date": 1429132681, "answer_id": 29661097, "question_id": 29657782, "link": "https://stackoverflow.com/questions/29657782/haskell-put-in-state-monad-seems-to-be-elided/29661097#29661097", "title": "Haskell: put in State monad seems to be elided", "body": "<p>The issue (ignoring other conceptual things mentioned by the commenters) turned out to be using <code>fst</code> to extract the result from the State would for some reason not cause the State to actually be computed. Running the result through <code>seq</code> fixed it.</p>\n\n<p>I'd be interested in knowing <em>why</em> this is the case, though!</p>\n\n<p><strong>Edit</strong>: As Daniel Wagner pointed out in the comments, I wasn't actually using inventory, which turned out to be the real bug. Marking this as accepted.</p>\n"}], "owner": {"reputation": 63, "user_id": 4793220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8eb0c69bfb2f2748855c0b30414404?s=128&d=identicon&r=PG", "display_name": "Sandy Maguire", "link": "https://stackoverflow.com/users/4793220/sandy-maguire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 29658340, "answer_count": 2, "score": 2, "last_activity_date": 1429160660, "creation_date": 1429121799, "last_edit_date": 1429122116, "question_id": 29657782, "link": "https://stackoverflow.com/questions/29657782/haskell-put-in-state-monad-seems-to-be-elided", "title": "Haskell: put in State monad seems to be elided", "body": "<p>I'm writing a program to allocate pizzas to people; each person will get one pizza, ideally of their favorite type, unless stock has run out, in which case they are given their next favorite type recursively.</p>\n\n<p>My approach is to compute a <code>((User, Pizza), Int)</code> for the amount a person would like said pizza, sort those, and recurse through using a state monad to keep inventory counts.</p>\n\n<p>The program is written and type checks:</p>\n\n<pre><code>allocatePizzasImpl :: [((User, Pizza), Int)] \n                   -&gt; State [(Pizza, Int)] [(User, Pizza)]\nallocatePizzasImpl [] = return []\nallocatePizzasImpl ((user, (flavor, _)):ranks) =\n    do inventory &lt;- get\n       -- this line is never hit\n       put $ updateWith inventory (\\i -&gt; if i &lt;= 0\n                                         then Nothing\n                                         else Just $ i - 1) flavor\n       next &lt;- allocatePizzasImpl $ filter ((/= user) . fst) ranks\n       return $ (user, flavor) : next\n</code></pre>\n\n<p>and I have a helper function to extract the result:</p>\n\n<pre><code>allocatePizzas :: [Pizza] \n               -&gt; [((User, Pizza), Int)] \n               -&gt; [(User, Pizza)]\nallocatePizzas pizzas rank = fst \n                           . runState (allocatePizzasImpl rank) \n                           $ buildQuotas pizzas\n</code></pre>\n\n<p>but the line indicated by <code>-- this line is never hit</code> is... never hit by any GHCI breakpoints; furthermore, if I break on the return call, GHCI says <code>inventory</code> isn't in scope.</p>\n\n<p>When run, the result is assigning the same pizza (with one inventory count) to all users. Something is going wrong, but I have absolutely no idea how to proceed. I'm new to Haskell, so any comments on style would be appreciated as well =)</p>\n\n<p>Thanks!</p>\n\n<p>PS: For completeness, <code>updateWith</code> is defined as:</p>\n\n<pre><code>updateWith :: (Eq a, Eq b) \n           =&gt; [(a, b)]        -- inventory\n           -&gt; (b -&gt; Maybe b)  -- update function; Nothing removes it\n           -&gt; a               -- key to update\n           -&gt; [(a, b)]\nupdateWith set update key =\n    case lookup key set of\n      Just b -&gt; replace set\n                        (unwrapPair (key, update b))\n                        (fromMaybe 0 $ elemIndex (key, b) set)\n      Nothing -&gt; set\n  where replace :: [a] -&gt; Maybe a -&gt; Int -&gt; [a]\n        replace [] _ _ = []\n        replace (_:xs) (Just val) 0 = val:xs\n        replace (_:xs) Nothing 0 = xs\n        replace (x:xs) val i = x : (replace xs val $ i - 1)\n\n        unwrapPair :: Monad m =&gt; (a, m b) -&gt; m (a, b)\n        unwrapPair (a, mb) = do b &lt;- mb\n                                return (a, b)\n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 4, "last_activity_date": 1429117386, "creation_date": 1429117386, "answer_id": 29656396, "question_id": 29655874, "link": "https://stackoverflow.com/questions/29655874/convert-from-io-maybe-a-to-eithert-io-a/29656396#29656396", "title": "Convert from IO Maybe a to EitherT IO a", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/either-4.3.3.2/docs/Control-Monad-Trans-Either.html#v:hoistEither\" rel=\"nofollow\"><code>hoistEither :: Monad m =&gt; Either a b -&gt; EitherT a m b</code></a> to implement this:</p>\n\n<pre><code>maybeNotFoundT :: IO (Maybe a) -&gt; EitherT (Int, String) IO a\nmaybeNotFoundT maAct = do\n  ma &lt;- liftIO maAct -- get the Maybe a. Now ma :: Maybe a\n  hoistEither $ maybeNotFound ma\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429117430, "post_id": 29656403, "comment_id": 47452432, "body": "I suppose this won&#39;t work with <code>errors 2.0</code> since that switches to ExceptT instead of EitherT?"}, {"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 1, "creation_date": 1429117445, "post_id": 29656403, "comment_id": 47452446, "body": "Correct.  <code>errors-2.0</code> will use <code>ExceptT</code> instead of <code>EitherT</code>"}], "tags": [], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "is_accepted": false, "score": 4, "last_activity_date": 1429117395, "creation_date": 1429117395, "answer_id": 29656403, "question_id": 29655874, "link": "https://stackoverflow.com/questions/29655874/convert-from-io-maybe-a-to-eithert-io-a/29656403#29656403", "title": "Convert from IO Maybe a to EitherT IO a", "body": "<p>You can decompose this into two separate problems:</p>\n\n<ul>\n<li><p>Transform <code>IO (Maybe a)</code> into <code>MaybeT IO a</code></p></li>\n<li><p>Transform <code>MaybeT IO a</code> into <code>EitherT (Int, String) a</code></p></li>\n</ul>\n\n<p>The first one is solved by using the <code>MaybeT</code> constructor:</p>\n\n<pre><code>MaybeT :: IO (Maybe a) -&gt; MaybeT IO a\n</code></pre>\n\n<p>The second is solved by using <code>noteT</code> from the <code>errors</code> library:</p>\n\n<pre><code>noteT :: Monad m =&gt; a -&gt; MaybeT m b -&gt; EitherT a m b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "is_accepted": false, "score": 1, "last_activity_date": 1429118308, "creation_date": 1429118308, "answer_id": 29656677, "question_id": 29655874, "link": "https://stackoverflow.com/questions/29655874/convert-from-io-maybe-a-to-eithert-io-a/29656677#29656677", "title": "Convert from IO Maybe a to EitherT IO a", "body": "<p>Another answer thanks to mpickering on freenode: </p>\n\n<pre><code>sourcesGetOne = EitherT $ maybeNotFound &lt;$&gt; sourcesFind\n</code></pre>\n\n<blockquote>\n  <p>So the question is how to write a function.. <code>IO (Maybe a) -&gt; EitherT (Int, String) IO a</code>\n  Given a function <code>f :: Maybe a -&gt; Either (Int, String) a</code>, then one way is..</p>\n  \n  <p><code>myFunc action = EitherT (f &lt;$&gt; action)</code></p>\n  \n  <p>If you look at the docs for EitherT -- <a href=\"https://hackage.haskell.org/package/either-4.3.3.2/docs/Control-Monad-Trans-Either.html\" rel=\"nofollow\">https://hackage.haskell.org/package/either-4.3.3.2/docs/Control-Monad-Trans-Either.html</a>. Then you'll see that <code>EitherT (Int, String) IO a</code>, is actually just a wrapped up <code>IO (Either (Int, String) a)</code></p>\n</blockquote>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 29656396, "answer_count": 3, "score": 1, "last_activity_date": 1429118308, "creation_date": 1429115663, "last_edit_date": 1429116024, "question_id": 29655874, "link": "https://stackoverflow.com/questions/29655874/convert-from-io-maybe-a-to-eithert-io-a", "title": "Convert from IO Maybe a to EitherT IO a", "body": "<p>I'm working with the <a href=\"https://hackage.haskell.org/package/servant\" rel=\"nofollow\">servant</a> library for an API. It runs in the: <code>EitherT (Int, String) IO a</code> monad. I have a function with the type <code>IO Maybe a</code>, and would like to use it. </p>\n\n<p>Here's an example that works:</p>\n\n<pre><code>sourcesGetAll :: EitherT (Int, String) IO [Source]\nsourcesGetAll = liftIO $ sourcesList h\n\nsourcesList :: IO [Source]\n</code></pre>\n\n<p>But now I want to use these two functions together</p>\n\n<pre><code>sourcesFind :: IO (Maybe Source)\nsourcesGetOne :: EitherT (Int, String) IO Source\nsourcesGetOne = ???\n</code></pre>\n\n<p>I would like to do this:</p>\n\n<pre><code>maybeNotFound :: Maybe a -&gt; Either (Int, String) a\nmaybeNotFound Nothing = Left (404, \"Not Found\")\nmaybeNotFound Just a  = Right a\n</code></pre>\n\n<p>How do I do that with all the fancy monads? </p>\n"}, {"tags": ["haskell", "ffi", "c2hs"], "answers": [{"tags": [], "owner": {"reputation": 965, "user_id": 229255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588fe10267b620e1c0d0d188a8db2621?s=128&d=identicon&r=PG", "display_name": "Ian Ross", "link": "https://stackoverflow.com/users/229255/ian-ross"}, "is_accepted": true, "score": 2, "last_activity_date": 1429471771, "creation_date": 1429471771, "answer_id": 29734780, "question_id": 29654825, "link": "https://stackoverflow.com/questions/29654825/c2hs-in-and-out-type-marshalling/29734780#29734780", "title": "c2hs in- and out- type marshalling", "body": "<p>I find that the easiest way to understand what C2HS does is to look at the Haskell code it generates.  In this case, the function hook</p>\n\n<pre><code>{#fun unsafe Initialized as ^ {alloca- `Bool' peekBool*} -&gt; `()' discard*- #}\n</code></pre>\n\n<p>results in the following Haskell code (slightly tidied up):</p>\n\n<pre><code>initialized :: IO Bool\ninitialized =\n  alloca $ \\a -&gt; \n  initialized'_ a &gt;&gt;= \\res -&gt;\n  discard res &gt;&gt; \n  peekBool a\n\nforeign import ccall unsafe \"Control/Parallel/MPI/Internal.chs.h MPI_Initialized\"\n  initialized'_ :: Ptr CInt -&gt; IO CInt\n</code></pre>\n\n<p>Here, the \"<code>-</code>\" following the marshaller for the input argument in the function hook means that that argument doesn't actually appear as an argument to the resulting Haskell function -- in this case what happens is that some space is allocated for the argument to <code>MPI_Initialized</code> (using <code>alloca</code>), the C function is called using a pointer to that allocated space, and the output of the Haskell function is returned using <code>peekBool</code> to extract a value from the allocated space.</p>\n\n<p>The type of the Haskell function that C2HS produces is just <code>IO Bool</code>, i.e. the \"input\" parameter doesn't appear anywhere.  (The C2HS documentation does kind of say this, but it's quite hard to interpret what it means until you've seen an example!)</p>\n\n<p>The output marshaller just throws away the result of the call to the <code>MPI_Initialized</code> C function, which is a status code that isn't very interesting in this case.  The <em>real</em> return result from the Haskell code that C2HS produces is generated by the output marshaller for the pointer argument to the <code>MPI_Initialized</code> function.  The <code>peekBool</code> function reads an integer value from a C <code>int *</code> pointer and converts it to a Haskell <code>Bool</code>; the \"<code>*</code>\" in the output marshaller means that this value should be returned in the <code>IO</code> monad.</p>\n\n<p>This pattern of allocation with a \"<code>-</code>\" as input marshaller, some sort of \"peek\" function with an \"IO <code>*</code>\" as an output marshaller (and often discaring the C function's return value as well) is quite common.  A lot of C libraries use this pattern of assigning results via pointers, and keeping track of pointer allocations by hand in Haskell is annoying, so C2HS tries to help with managing that for you.  It takes a while to get used to where to put all the \"<code>-</code>\"s and \"<code>*</code>\"s, but looking at the Haskell code that C2HS generates is a really good way to understand what's going on.</p>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 29734780, "answer_count": 1, "score": 4, "last_activity_date": 1429471771, "creation_date": 1429112770, "last_edit_date": 1429113983, "question_id": 29654825, "link": "https://stackoverflow.com/questions/29654825/c2hs-in-and-out-type-marshalling", "title": "c2hs in- and out- type marshalling", "body": "<p>I'm looking at the <a href=\"https://hackage.haskell.org/package/haskell-mpi\" rel=\"nofollow\">haskell-mpi binding</a>, and we have e.g. this signature in <code>mpi.h</code>:</p>\n\n<pre><code>int MPI_Initialized (int *flag); \n</code></pre>\n\n<p>which in <code>Internal.chs</code> is represented as follows: </p>\n\n<pre><code>{#fun unsafe Initialized as ^ {alloca- `Bool' peekBool*} -&gt; `()' discard*- #}\n</code></pre>\n\n<p>Q: I have some trouble understanding what's going on around the input parameter:</p>\n\n<ul>\n<li><p>what's the <code>-</code> modifier doing? The c2hs wiki says \"the argument type of the Hs function is determined by the set of all marshalling specifications where the in marshaller is not followed by a minus sign\", but I still don't get it.</p></li>\n<li><p>the C function takes a pointer to <code>int</code>; what is the output marshaller doing? AFAICT, it dereferences the pointer and converts the result to Boolean. Is this correct?</p></li>\n</ul>\n\n<p>NB: the <code>MPI_</code> prefix is introduced in the function names by a <code>{# context prefix=\"MPI\"#}</code>.</p>\n\n<p>NB2: </p>\n\n<pre><code>peekBool :: (Storable a, Num a, Eq a) =&gt; Ptr a -&gt; IO Bool\npeekBool = liftM toBool . peek\n</code></pre>\n\n<p>NB3: <code>discard _ = return ()</code>, and the <code>*-</code> modifier serves to run a monadic action but discarding its result </p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1429110320, "post_id": 29653453, "comment_id": 47447458, "body": "Did you try to use <code>==</code> instead of <code>eqStableName</code>?"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1429110710, "post_id": 29653453, "comment_id": 47447763, "body": "I just tried and it makes no difference. I hadn&#39;t even noticed that <code>StablePointer a</code> had an <code>Eq</code> instance, but now that you&#39;ve pointed that out, I see that using <code>==</code> does seem more appropriate for my case, since I am doing equality checks on things of the same type."}], "answers": [{"comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1429114333, "post_id": 29655079, "comment_id": 47450576, "body": "Thank you. This answers my question, and I will definitely be reading the paper this evening."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 1, "creation_date": 1429188301, "post_id": 29655079, "comment_id": 47487836, "body": "For future interested people, page 7 explains the ideas in this answer pretty well."}], "tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 8, "last_activity_date": 1429113788, "last_edit_date": 1429113788, "creation_date": 1429113368, "answer_id": 29655079, "question_id": 29653453, "link": "https://stackoverflow.com/questions/29653453/ghc-stablepointer-equality-reasoning/29655079#29655079", "title": "GHC StablePointer equality reasoning", "body": "<p>The reason those return <code>False</code> is probably laziness. In GHC, <code>m</code> and <code>n</code> will refer to different thunks, since they are not evaluated yet. <code>makeStableName</code> does not force the value. If you manually force the thunk, they will be the same:</p>\n\n<pre><code>  let m = Wrapper myFunc\n  a &lt;- makeStableName $! getWrapper m\n  b &lt;- makeStableName $! getWrapper m\n  print (a `eqStableName` b)\n</code></pre>\n\n<p>This prints <code>True</code> (The <code>$!</code> will force the value returned by <code>getWrapper</code> to WHNF).</p>\n\n<p>Note that if you don't use <code>runhaskell</code> but instead compile with <code>-O1</code>, GHC will actually compile this code such that it prints <code>True</code>. From looking at the Core, it seems that what GHC has done is inlining <code>m</code> and <code>getWrapper</code> so that the code that is run is effectively this:</p>\n\n<pre><code>a &lt;- makeStableName myFunc\nb &lt;- makeStableName myFunc\n</code></pre>\n\n<p>Which then of course generates the same stable pointer. </p>\n\n<p>So if you want maximum equality, always force your values before making stable pointers to them. There is no guarrante though that if two values are equal that they are assigned equal stable pointers. </p>\n\n<p>If you haven't read it yet, I also recommend reading <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/Papers/weak.ps.gz\">Stretching the storage manager</a> which explains the implementation of stable pointers.</p>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 29655079, "answer_count": 1, "score": 7, "last_activity_date": 1429113788, "creation_date": 1429109331, "last_edit_date": 1429112829, "question_id": 29653453, "link": "https://stackoverflow.com/questions/29653453/ghc-stablepointer-equality-reasoning", "title": "GHC StablePointer equality reasoning", "body": "<p>I just learned about GHC's <code>StablePointer</code> feature, which is really cool, but I can't figure out why it has won't show things as equal. Here is my test case:</p>\n\n<pre><code>-- Example 1\nimport System.Mem.StableName\n\ndata Wrapper = Wrapper { getWrapper :: Int -&gt; Bool }\n\nmyFunc :: Int -&gt; Bool\nmyFunc = (&gt; 4)\n\nmain :: IO ()\nmain = do\n  let m = Wrapper myFunc\n  a &lt;- makeStableName $ getWrapper m\n  b &lt;- makeStableName $ getWrapper m\n  print (a `eqStableName` b)\n  putStrLn \"Done\"\n</code></pre>\n\n<p>Pretty simple, but when I do <code>runhaskell</code> with GHC 7.8.4, I get a result of false. What about a simpler case? Let's try this: </p>\n\n<pre><code>-- Example 2\nimport System.Mem.StableName\n\nmain :: IO ()\nmain = do\n  let m = (+2) :: Int -&gt; Int\n      n = m\n  a &lt;- makeStableName m\n  b &lt;- makeStableName n\n  print (a `eqStableName` b)\n  putStrLn \"Done\"\n</code></pre>\n\n<p>I still get a result of False. The only way I can get <code>eqStableName</code> to return <code>True</code> is when I call <code>makeStableName</code> on the same exact bound variable. Like this:</p>\n\n<pre><code>  -- in this example, r can be anything\n  a &lt;- makeStableName r\n  b &lt;- makeStableName r\n  print (a `eqStableName` b)\n</code></pre>\n\n<p>But this is no longer helpful. I already know that every expression is equal to itself, so this doesn't give me any new information. My question is twofold:</p>\n\n<ol>\n<li>What use cases is <code>StablePointer</code> intended to satisfy?</li>\n<li>How can we reason about the equality of <code>StablePointer</code>. I know that it gives false negatives, but under what circumstances can I expect these to always occur?</li>\n</ol>\n\n<p>Thanks for any insights. They are much appreciated.</p>\n\n<p>-- EDIT --</p>\n\n<p>I discovered that if I build it with <code>ghc</code> instead of <code>runhaskell</code>, then Example 2 actually does show that they are equal. Example 1 still fails. The question still stands.</p>\n"}, {"tags": ["haskell", "typeclass", "functor", "monoids", "alternative-functor"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1429109407, "post_id": 29653287, "comment_id": 47446710, "body": "you can always add it (and there is probably some CT lib around that does if it can be reasonable defined) - my best guess: there where just no/not-enough use-cases"}, {"owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1429110724, "post_id": 29653287, "comment_id": 47447769, "body": "I would disagree that you can always add it as you cannot make it a superclass of Alternative. I also think that (almost) every use-case for Alternative/MonadPlus is actually a use-case for this missing class. But perhaps I&#39;m a bit too idealistic here."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 4, "creation_date": 1429122041, "post_id": 29653287, "comment_id": 47455332, "body": "Doesn&#39;t the <code>Monoid</code> class already cover this? Could you elaborate on what methods you think that class should have beyond those already offered by <code>Monoid</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1429125977, "post_id": 29658447, "comment_id": 47457775, "body": "I disagree with your premise that non-applicative functors aren&#39;t relevant. Even if an applicative instance is <i>possible</i>, it&#39;s often neither obvious nor really useful. Whereas a <code>Functor</code> instance is always canonical \u2013 if it&#39;s possible at all, then there can be no ambiguity how it behaves, and the instance can automatically be added by means of the <code>-XDeriveFunctor</code> instance."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1429129560, "post_id": 29658447, "comment_id": 47459889, "body": "@leftroundabout I agree with your disagreement. This is an answer in the sense of &quot;here are some reasons why it maybe hasn&#39;t been done yet,&quot; not, &quot;here is why it can&#39;t / shouldn&#39;t be done,&quot; so I am only saying &quot;you could usually use a monoid and usually the functor is applicative.&quot;"}, {"owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "edited": false, "score": 0, "creation_date": 1429131273, "post_id": 29658447, "comment_id": 47460834, "body": "I&#39;m tempted to say I&#39;d like to choose the axioms such that <code>FunctorPlus</code> adds as much to <code>Functor</code> as <code>Alternative</code> adds to <code>Applicative</code>. Whatever thats means precisely. But I&#39;ve just noticed that <code>Alternative</code> adds nothing more than being a <code>Monoid</code>. So, perhaps I should have asked for the actual use of <code>Alternative</code> over <code>Applicative</code> + <code>Monoid</code>. Anyways, thinking about my intended use-case once more made me realize that <code>FunctorPlus</code> wouldn&#39;t be of any help for it."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "edited": false, "score": 0, "creation_date": 1429132144, "post_id": 29658447, "comment_id": 47461367, "body": "@MartinHuschenbett see also <a href=\"http://stackoverflow.com/questions/10167879/distinction-between-typeclasses-monadplus-alternative-and-monoid\">this answer by Master Kmett</a> which insists that there is an implicit axiom to the effect of <code>empty &lt;*&gt; x = empty</code> (and probably also <code>f &lt;*&gt; empty = empty</code>?) that Alternatives should satisfy."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 7, "last_activity_date": 1429123888, "creation_date": 1429123888, "answer_id": 29658447, "question_id": 29653287, "link": "https://stackoverflow.com/questions/29653287/why-is-there-no-type-class-for-monoids-on-functors-in-haskell/29658447#29658447", "title": "Why is there no type class for monoids on functors in Haskell?", "body": "<p>One key factor to think about here is, \"What does the arrow from <code>Functor</code> really mean?\" If there are no <em>axioms</em> that unify <code>Functor</code> with <code>FunctorPlus</code> then you might as well just define <code>instance Monoid (F t) where ...</code> and be done with it. So what axioms are you looking for -- just <code>fmap f fempty = fempty</code> or also <code>fmap f x &lt;|&gt; fmap f y == fmap f (x &lt;|&gt; y)</code>...?</p>\n\n<p>Another key factor will be the dearth of interesting structures which are functors but not applicatives. There's probably an argument having to do with generic-programming (metaprogramming the <code>deriving</code> keyword) where everything is a sum of products and therefore we can derive <code>Applicative</code> for anything of kind <code>* -&gt; *</code>, but I don't know the details. The only value <code>FunctorPlus</code> could possibly have is \"doing the same thing that Alternative does for Functors which are not Applicative,\" and so if that set is really small then there's obviously not much value added.</p>\n"}], "owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 29658447, "answer_count": 1, "score": 4, "last_activity_date": 1613970612, "creation_date": 1429108862, "last_edit_date": 1613970612, "question_id": 29653287, "link": "https://stackoverflow.com/questions/29653287/why-is-there-no-type-class-for-monoids-on-functors-in-haskell", "title": "Why is there no type class for monoids on functors in Haskell?", "body": "<p>I admit that this question is a bit unspecific, but I was wondering why I never stumbled upon a type class for monoids on functors in Haskell. Did I just miss it, is there good reason for this absence or is it entirely due to historic causes? IMHO, the following inheritance chart looks a bit odd without a top right corner:</p>\n\n<pre><code>  Functor\n     |\n     V\nApplicative \u2013\u2013&gt; Alternative\n     |               |\n     V               V\n   Monad    \u2013\u2013&gt;  MonadPlus\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "type-inference", "applicative"], "comments": [{"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429102337, "post_id": 29650659, "comment_id": 47441216, "body": "Is this solved if you put <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code> at the top of the file?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429102530, "post_id": 29650659, "comment_id": 47441335, "body": "@bennofs Yes it is.  I just checked with GHC 7.10.1.  Martin, mind if I close this as a duplicate of <a href=\"http://stackoverflow.com/a/7055932/1651941\">this</a> question?  I&#39;m starting a new effort to point all questions where the answer is the dreaded monomorphism restriction to the same post so hopefully people can find the solution to this problem without needing to ask a question."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429102591, "post_id": 29650659, "comment_id": 47441387, "body": "However, I would still consider it a bug that the PartialTypeSignatures version does not work."}, {"owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429102994, "post_id": 29650659, "comment_id": 47441640, "body": "The PartialTypeSignatures version works in combination with the NoMonomorphismRestriction, so everything seems fine. Thanks for your answers. @bheklilr: I don&#39;t mind if you close it now."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429103123, "post_id": 29650659, "comment_id": 47441744, "body": "@bennofs You think that the type inference should be able to pick up the <code>Alternative</code> constraint without <code>NoMonormorphismRestriction</code>?  Possibly, but judging from <a href=\"https://www.fpcomplete.com/user/thomasw/new-in-ghc-7-10-partial-type-signatures\" rel=\"nofollow noreferrer\">this</a> post holes in constraints get a little iffy.  My guess is that partial type signatures are there just to give hints to the compiler, but it can&#39;t the right types without the extensions turned on that allow it to infer the right types.  I wouldn&#39;t expect it to infer types that need <code>ScopedTypeVariables</code> without that extension enabled."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429103257, "post_id": 29650659, "comment_id": 47441849, "body": "@bheklilr there is no problem inferring types, the compiler is able to do that just fine. In fact, with NoMonomorphismRestriction, it does infer the type. Also, there is no hole in the constraints in this case (the constraints don&#39;t have a hole, only the result type). The inferred type signature also does not need NoMonomorphismRestriction enabled."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429103338, "post_id": 29650659, "comment_id": 47441914, "body": "In fact, the reason for the monomorphism restriction is that it might duplicate work. But in this case, the programmer has explicitly specified that there the type should be generic, therefore the type signature already shows that it will duplicate work if used for different types."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1429103453, "post_id": 29650659, "comment_id": 47442001, "body": "@bennofs Good point.  Maybe there&#39;s already a bug open for this, or possibly it was designed this way for simplicity."}], "owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1429103138, "answer_count": 0, "score": 3, "last_activity_date": 1429102105, "creation_date": 1429102105, "last_edit_date": 1495542490, "question_id": 29650659, "link": "https://stackoverflow.com/questions/29650659/why-cant-ghc-infer-type-when-using-asum", "closed_reason": "Duplicate", "title": "Why can&#39;t ghc infer type when using `asum`?", "body": "<p>In the solution to <a href=\"https://stackoverflow.com/questions/29648319/haskell-break-a-loop-conditionally/29650080#29650080\">another question</a>, I came up with the following code, which type checks nicely:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Foldable\n\ntryCombination :: Alternative f =&gt; Int -&gt; Int -&gt; f (Int,Int)\ntryCombination x y \n    | x * y == 20 = pure (x,y)\n    | otherwise   = empty\n\nresult :: Alternative f =&gt; f (Int,Int)\nresult = asum [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n</code></pre>\n\n<p>However, when I remove the type signature from <code>result</code>, ghc tells me about ambiguous type variables:</p>\n\n<pre><code>No instance for (Alternative f0) arising from a use of \u2018asum\u2019\nThe type variable \u2018f0\u2019 is ambiguous\nRelevant bindings include\n  result :: f0 (Int, Int) (bound at BreakLoop.hs:12:1)\nNote: there are several potential instances:\n  ...\n</code></pre>\n\n<p>It looks like ghc has almost completely inferred the correct type. So, why is it that this inference cannot be entirely completed?</p>\n\n<p>What appears even stranger is the error message I get when I use the following partial type signature:</p>\n\n<pre><code>result :: Alternative f =&gt; f _\n</code></pre>\n\n<p>The message is:</p>\n\n<pre><code>No instance for (Alternative f) arising from a use of \u2018asum\u2019\nPossible fix:\n  add (Alternative f) to the context of\n    the inferred type of result :: f (Int, Int)\n...\n</code></pre>\n\n<p>Is there any reasonable explanation for this behavior or is it just a bug?</p>\n"}, {"tags": ["loops", "haskell", "break"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1429104206, "post_id": 29648319, "comment_id": 47442601, "body": "BTW, <code>map fromJust . filter isJust</code> is <code>catMaybes</code> from <code>Data.Maybe</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1429096178, "post_id": 29648463, "comment_id": 47437110, "body": "Thanks a lot. Works great !"}, {"owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "reply_to_user": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1429098623, "post_id": 29648463, "comment_id": 47438612, "body": "@Hennes Added a second half with an alternative (heh, get the pun?) solution. Maybe you don&#39;t want to use it right away if it&#39;s over your head, but it might be a fun (or torturous) read anyway. :)"}], "tags": [], "owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "is_accepted": true, "score": 7, "last_activity_date": 1429098730, "last_edit_date": 1429098730, "creation_date": 1429095645, "answer_id": 29648463, "question_id": 29648319, "link": "https://stackoverflow.com/questions/29648319/haskell-break-a-loop-conditionally/29648463#29648463", "title": "Haskell: Break a loop conditionally", "body": "<h1>Simple solution: <code>find</code> and <code>join</code></h1>\n\n<p>It looks like you're looking for <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-List.html#v:find\" rel=\"nofollow\"><code>Data.List.find</code></a>. <code>find</code> has the type signature</p>\n\n<pre><code>find :: (a -&gt; Bool) -&gt; [a] -&gt; Maybe a\n</code></pre>\n\n<p>So you'd do something like</p>\n\n<pre><code>result :: Maybe (Maybe String)\nresult = find isJust [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n</code></pre>\n\n<p>Or, if you don't want a <code>Maybe (Maybe String)</code> (why would you?), you can fold them together with <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:join\" rel=\"nofollow\"><code>Control.Monad.join</code></a>, which has the signature</p>\n\n<pre><code>join :: Maybe (Maybe a) -&gt; Maybe a\n</code></pre>\n\n<p>so that you have</p>\n\n<pre><code>result :: Maybe String\nresult = join $ find isJust [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n</code></pre>\n\n<hr>\n\n<h1>More advanced solution: <code>asum</code></h1>\n\n<p>If you wanted a slightly more advanced solution, you could use <a href=\"https://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Foldable.html\" rel=\"nofollow\"><code>Data.Foldable.asum</code></a>, which has the signature</p>\n\n<pre><code>asum :: [Maybe a] -&gt; Maybe a\n</code></pre>\n\n<p>What it does is pick out the first <code>Just</code> value from a list of many. It does this by using the <code>Alternative</code> instance of <code>Maybe</code>. The <code>Alternative</code> instance of <code>Maybe</code> works like this: (import <code>Control.Applicative</code> to get access to the <code>&lt;|&gt;</code> operator)</p>\n\n<pre><code>\u03bb&gt; Nothing &lt;|&gt; Nothing\nNothing\n\u03bb&gt; Nothing &lt;|&gt; Just \"world\"\nJust \"world\"\n\u03bb&gt; Just \"hello\" &lt;|&gt; Just \"world\"\nJust \"hello\"\n</code></pre>\n\n<p>In other words, it picks the first <code>Just</code> value from two alternatives. Imagine putting <code>&lt;|&gt;</code> between every element of your list, so that</p>\n\n<pre><code>[Nothing, Nothing, Just \"okay\", Nothing, Nothing, Nothing, Just \"okay\"]\n</code></pre>\n\n<p>gets turned to</p>\n\n<pre><code>Nothing &lt;|&gt; Nothing &lt;|&gt; Just \"okay\" &lt;|&gt; Nothing &lt;|&gt; Nothing &lt;|&gt; Nothing &lt;|&gt; Just \"okay\"\n</code></pre>\n\n<p>This is exactly what the <code>asum</code> function does! Since <code>&lt;|&gt;</code> is short-circuiting, it will only evaluate up to the first <code>Just</code> value. With that, your function would be as simple as</p>\n\n<pre><code>result :: Maybe String\nresult = asum [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n</code></pre>\n\n<p>Why would you want this more advanced solution? Not only is it shorter; once you know the idiom (i.e. when you are familiar with <code>Alternative</code> and <code>asum</code>) it is much more clear what the function does, just by reading the first few characters of the code.</p>\n"}, {"tags": [], "owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "is_accepted": false, "score": 4, "last_activity_date": 1429095803, "creation_date": 1429095803, "answer_id": 29648504, "question_id": 29648319, "link": "https://stackoverflow.com/questions/29648319/haskell-break-a-loop-conditionally/29648504#29648504", "title": "Haskell: Break a loop conditionally", "body": "<p>To answer your question, <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/base/Data-List.html#v:find\" rel=\"nofollow\">find</a> function is what you need. After you get <code>Maybe (Maybe String)</code> you can transform it into <code>Maybe String</code> with <code>join</code></p>\n\n<p>While <code>find</code> is nicer, more readable and surely does only what's needed, I wouldn't be so sure about inefficiency of the code that you have in a question. The lazy evaluation would probably take care of that and compute only what's needed, (extra memory can still be consumed). If you are interested, try to benchmark.</p>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "is_accepted": false, "score": 1, "last_activity_date": 1429100508, "creation_date": 1429100508, "answer_id": 29650080, "question_id": 29648319, "link": "https://stackoverflow.com/questions/29648319/haskell-break-a-loop-conditionally/29650080#29650080", "title": "Haskell: Break a loop conditionally", "body": "<p>The evaluation strategy you are looking for is exactly the purpose of the <code>Maybe</code> instance of <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#t:MonadPlus\" rel=\"nofollow\"><code>MonadPlus</code></a>. In particular, there is the function <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Foldable.html#v:msum\" rel=\"nofollow\"><code>msum</code></a> whose type specializes in this case to</p>\n\n<pre><code>msum :: [Maybe a] -&gt; Maybe a\n</code></pre>\n\n<p>Intuitively, this version of <code>msum</code> takes a list of potentially failing computations, executes them one after another until the first computations succeeds and returns the according result. So, <code>result</code> would become</p>\n\n<pre><code>result :: Maybe String\nresult = msum [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n</code></pre>\n\n<p>On top of that, you could make your code in some sense agnostic to the exact evaluation strategy by generalizing from <code>Maybe</code> to any instance of <code>MonadPlus</code>:</p>\n\n<pre><code>tryCombination :: MonadPlus m =&gt; Int -&gt; Int -&gt; m (Int,Int)\n-- For the sake of illustration I changed to a more verbose result than \"Okay\".\ntryCombination x y \n    | x * y == 20 = return (x,y) -- `return` specializes to `Just`.\n    | otherwise   = mzero        -- `mzero` specializes to `Nothing`.\n\nresult :: MonadPlus m =&gt; m (Int,Int)\nresult = msum [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n</code></pre>\n\n<p>To get your desired behavior, just run the following:</p>\n\n<pre><code>*Main&gt; result :: Maybe (Int,Int)\nJust (4,5)\n</code></pre>\n\n<p>However, if you decide you need not only the first combination but all of them, just use the <code>[]</code> instance of <code>MonadPlus</code>:</p>\n\n<pre><code>*Main&gt; result :: [(Int,Int)]\n[(4,5),(5,4)]\n</code></pre>\n\n<p>I hope this helps more on a conceptual level than just providing a solution.</p>\n\n<p>PS: I just noticed that <code>MonadPlus</code> and <code>msum</code> are indeed a bit too restrictive for this purpose, <code>Alternative</code> and <code>asum</code> would have been enough.</p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1429104333, "post_id": 29650226, "comment_id": 47442700, "body": "This is the most basic and important answer, OP should start here."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 3, "last_activity_date": 1429100909, "creation_date": 1429100909, "answer_id": 29650226, "question_id": 29648319, "link": "https://stackoverflow.com/questions/29648319/haskell-break-a-loop-conditionally/29650226#29650226", "title": "Haskell: Break a loop conditionally", "body": "<p>Laziness can actually take care of that in this situation.</p>\n\n<p>By calling <code>unlines</code> you are requesting <em>all</em> of the output of your \"loop\"<sup>1</sup>, so obviously it can't stop after the first successful <code>tryCombination</code>. But if you only need one match, just use <code>listToMaybe</code> (from <code>Data.Maybe</code>); it will convert your list to <code>Nothing</code> if there are no matches at all, or <code>Just</code> the first match found.</p>\n\n<p>Laziness means that the results in the list will only be evaluated on demand; if you never demand any more elements of the list, the computations necessary to produce them (or even see whether there <em>are</em> any more elements in the list) will never be run!</p>\n\n<p>This means you often don't have to \"break loops\" the way you do in imperative languages. You can write the full \"loop\" as a list generator, and the consumer(s) can decide independently how much of the they want. The extreme case of this idea is that Haskell is perfectly happy to generate and even filter <em>infinite</em> lists; it will only run the generation code just enough to produce exactly as many elements as you later end up examining.</p>\n\n<hr>\n\n<p><sup>1</sup> Actually even <code>unlines</code> produces a lazy string, so if you e.g. only read the first line of the resulting joined string you could <em>still</em> \"break the loop\" early! But you print the whole thing here.</p>\n"}], "owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 1, "accepted_answer_id": 29648463, "answer_count": 4, "score": 5, "last_activity_date": 1429100909, "creation_date": 1429095215, "question_id": 29648319, "link": "https://stackoverflow.com/questions/29648319/haskell-break-a-loop-conditionally", "title": "Haskell: Break a loop conditionally", "body": "<p>I want to break a loop in a situation like this:</p>\n\n<pre><code>import Data.Maybe (fromJust, isJust, Maybe(Just))\n\ntryCombination :: Int -&gt; Int -&gt; Maybe String\ntryCombination x y \n               | x * y == 20 = Just \"Okay\"\n               | otherwise = Nothing\n\nresult :: [String]\nresult = map (fromJust) $ \n    filter (isJust) [tryCombination x y | x &lt;- [1..5], y &lt;- [1..5]]\n\nmain = putStrLn $ unlines $result\n</code></pre>\n\n<p>Imagine, that \"tryCombination\" is a lot more complicated like in this example. And it's consuming a lot of cpu power. And it's not a evalutation of 25 possibilities, but 26^3. </p>\n\n<p>So when \"tryCombination\" finds a solution for a given combination, it returns a Just, otherwise a Nothing. How can I break the loop instantly on the first found solution?</p>\n"}, {"tags": ["haskell", "happstack"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1429093934, "post_id": 29647571, "comment_id": 47435664, "body": "did you include the <code>OverloadedStrings</code> extension (add this on top of your file <code>{-# LANGUAGE OverloadedStrings #-}</code> or use the command-line argument <code>-XOverloadedStrings</code>)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4201880"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1429094251, "post_id": 29647571, "comment_id": 47435880, "body": "{-# LANGUAGE OverloadedStrings #-}"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4201880"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1429094270, "post_id": 29647571, "comment_id": 47435899, "body": "Exactly that? Before or after module Main where?"}], "answers": [{"tags": [], "owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "is_accepted": true, "score": 1, "last_activity_date": 1429094270, "creation_date": 1429094270, "answer_id": 29647991, "question_id": 29647571, "link": "https://stackoverflow.com/questions/29647571/haskell-happstack/29647991#29647991", "title": "Haskell Happstack", "body": "<p>In the lines like this:</p>\n\n<pre><code>Couldn't match expected type \u2018H.AttributeValue\u2019\n        with actual type \u2018[Char]\u2019\n</code></pre>\n\n<p>compiler complains that it expected to receive <code>H.AttributeValue</code> but got <code>[Char]</code>.</p>\n\n<p><code>AttributeValue</code> is defined <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/blaze-markup/Text-Blaze-Internal.html#t:AttributeValue\" rel=\"nofollow\">here</a>. As you can see, it is an instance of <code>IsString</code>, that means that you can make use of <code>OverloadedStrings</code> which is a language extension. To enable it put</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n</code></pre>\n\n<p>at the top of your file.</p>\n\n<p>This will rewrite fragments like this:</p>\n\n<pre><code>A.httpEquiv \"Content-Type\"\n</code></pre>\n\n<p>to something like this:</p>\n\n<pre><code>A.httpEquiv (fromString \"Content-Type\")\n</code></pre>\n\n<p>and <code>fromString</code> comes from <code>IsString</code> class which is defined <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/GHC-Exts.html#t:IsString\" rel=\"nofollow\">here</a>, as:</p>\n\n<pre><code>class IsString a where\n    fromString :: String -&gt; a\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4201880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 29647991, "answer_count": 1, "score": 0, "last_activity_date": 1429094270, "creation_date": 1429092929, "question_id": 29647571, "link": "https://stackoverflow.com/questions/29647571/haskell-happstack", "title": "Haskell Happstack", "body": "<p>trying to use happstack, got it to install correctly on windows but now it's chucking out some errors when I compile my test class any input would be appreciated.</p>\n\n<pre><code>module Main where\n\nimport Happstack.Server\nimport           Text.Blaze ((!))\nimport qualified Text.Blaze.Html4.Strict as H\nimport qualified Text.Blaze.Html4.Strict.Attributes as A\n\nappTemplate :: String -&gt; [H.Html] -&gt; H.Html -&gt; H.Html\nappTemplate title headers body =\nH.html $ do\n  H.head $ do\n    H.title (H.toHtml title)\n    H.meta ! A.httpEquiv \"Content-Type\"\n           ! A.content \"text/html;charset=utf-8\"\n    sequence_ headers\n  H.body $ do\n    body\n\nhelloBlaze :: ServerPart Response\nhelloBlaze =\nok $ toResponse $\nappTemplate \"Hello, Blaze!\"\n            [H.meta ! A.name \"keywords\"\n                    ! A.content \"happstack, blaze, html\"\n            ]\n            (H.p $ do \"Hello, \"\n                      H.b \"blaze-html!\")\n\nmain :: IO ()\nmain = simpleHTTP nullConf $ helloBlaze\n</code></pre>\n\n<p>I created a happstack folder and used cabal to install the required files to this folder, but when I compile the code I get the errors below.</p>\n\n<pre><code>Main.hs:13:30:\nCouldn't match expected type \u2018H.AttributeValue\u2019\n            with actual type \u2018[Char]\u2019\nIn the first argument of \u2018A.httpEquiv\u2019, namely \u2018\"Content-Type\"\u2019\nIn the second argument of \u2018(!)\u2019, namely\n  \u2018A.httpEquiv \"Content-Type\"\u2019\nIn the first argument of \u2018(!)\u2019, namely\n  \u2018H.meta ! A.httpEquiv \"Content-Type\"\u2019\n\nMain.hs:14:28:\nCouldn't match expected type \u2018H.AttributeValue\u2019\n            with actual type \u2018[Char]\u2019\nIn the first argument of \u2018A.content\u2019, namely\n  \u2018\"text/html;charset=utf-8\"\u2019\nIn the second argument of \u2018(!)\u2019, namely\n  \u2018A.content \"text/html;charset=utf-8\"\u2019\nIn a stmt of a 'do' block:\n  H.meta ! A.httpEquiv \"Content-Type\"\n  ! A.content \"text/html;charset=utf-8\"\n\nMain.hs:23:34:\nCouldn't match expected type \u2018H.AttributeValue\u2019\n            with actual type \u2018[Char]\u2019\nIn the first argument of \u2018A.name\u2019, namely \u2018\"keywords\"\u2019\nIn the second argument of \u2018(!)\u2019, namely \u2018A.name \"keywords\"\u2019\nIn the first argument of \u2018(!)\u2019, namely \u2018H.meta ! A.name \"keywords\"\u2019\n\nMain.hs:24:37:\nCouldn't match expected type \u2018H.AttributeValue\u2019\n            with actual type \u2018[Char]\u2019\nIn the first argument of \u2018A.content\u2019, namely\n  \u2018\"happstack, blaze, html\"\u2019\nIn the second argument of \u2018(!)\u2019, namely\n  \u2018A.content \"happstack, blaze, html\"\u2019\nIn the expression:\n  H.meta ! A.name \"keywords\" ! A.content \"happstack, blaze, html\"\n\nMain.hs:26:27:\n Couldn't match type \u2018[]\u2019 with \u2018Text.Blaze.Internal.MarkupM\u2019\n\n Expected type: Text.Blaze.Internal.MarkupM Char\n   Actual type: [Char]\n In a stmt of a 'do' block: \"Hello, \"\n In the second argument of \u2018($)\u2019, namely\n   \u2018do { \"Hello, \";\n         H.b \"blaze-html!\" }\u2019\n In the third argument of \u2018appTemplate\u2019, namely\n   \u2018(H.p\n     $ do { \"Hello, \";\n            H.b \"blaze-html!\" })\u2019\n\nMain.hs:27:31:\nCouldn't match type \u2018[Char]\u2019 with \u2018Text.Blaze.Internal.MarkupM ()\u2019\nExpected type: H.Html\n  Actual type: [Char]\nIn the first argument of \u2018H.b\u2019, namely \u2018\"blaze-html!\"\u2019\nIn a stmt of a 'do' block: H.b \"blaze-html!\"\nIn the second argument of \u2018($)\u2019, namely\n  \u2018do { \"Hello, \";\n        H.b \"blaze-html!\" }\u2019\n</code></pre>\n"}, {"tags": ["java", "haskell", "groovy", "gradle"], "comments": [{"owner": {"reputation": 11605, "user_id": 135294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n0HtP.jpg?s=128&g=1", "display_name": "cjstehno", "link": "https://stackoverflow.com/users/135294/cjstehno"}, "edited": false, "score": 0, "creation_date": 1429108244, "post_id": 29647152, "comment_id": 47445821, "body": "Some searching seems to suggest that there is not a good Haskell plugin for Gradle yet... writing Gradle plugins can be fun, you should write one for Haskell. :-)"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 243042, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd43b96731b58a671a4ca5c1401cd950?s=128&d=identicon&r=PG", "display_name": "vigoo", "link": "https://stackoverflow.com/users/243042/vigoo"}, "is_accepted": true, "score": 3, "last_activity_date": 1458584473, "last_edit_date": 1458584473, "creation_date": 1429717284, "answer_id": 29802520, "question_id": 29647152, "link": "https://stackoverflow.com/questions/29647152/is-there-a-way-to-integrate-java-groovy-with-haskell-using-gradle/29802520#29802520", "title": "Is there a way to integrate Java/Groovy with Haskell using Gradle?", "body": "<p>We've released a <a href=\"https://github.com/prezi/gradle-haskell-plugin\" rel=\"nofollow\">Gradle Haskell plugin</a> last week which may be what you want. The announcement for the release can be found <a href=\"http://vigoo.github.io/posts/2015-04-22-gradle-haskell-plugin.html\" rel=\"nofollow\">here</a>.</p>\n\n<p>We have been using it the last ~2 months for multiple Haskell projects successfully.</p>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 29802520, "answer_count": 1, "score": 2, "last_activity_date": 1458584473, "creation_date": 1429091853, "question_id": 29647152, "link": "https://stackoverflow.com/questions/29647152/is-there-a-way-to-integrate-java-groovy-with-haskell-using-gradle", "title": "Is there a way to integrate Java/Groovy with Haskell using Gradle?", "body": "<p>I usually work on projects based on Java/Groovy along with Gradle. \nNow I would like to start introducing in these projects Haskell (at the beginning just as one-off spike scripts only). Initially I can manage them with Cabal but if its usage get more \"integrated\" with the remaining core base, I would like to be able to manage compiling/test/deployment phases with Gradle.</p>\n\n<p>Is there any plugin/way to manage Haskell with Gradle? I am not talking about Frege (as the only solution I have found googling) but Haskell.</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "happy", "alex"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1429091017, "post_id": 29646667, "comment_id": 47433814, "body": "Did you <code>cabal install alex</code> ?"}, {"owner": {"reputation": 142, "user_id": 4718903, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bSjBU.jpg?s=128&g=1", "display_name": "Yiyue Wang", "link": "https://stackoverflow.com/users/4718903/yiyue-wang"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1429091399, "post_id": 29646667, "comment_id": 47434046, "body": "@Sibi Oops... Have to say I didn&#39;t... Sorry this question is so dumb.."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1429091455, "post_id": 29646667, "comment_id": 47434083, "body": "That&#39;s fine. Happens with everyone. :)"}, {"owner": {"reputation": 142, "user_id": 4718903, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bSjBU.jpg?s=128&g=1", "display_name": "Yiyue Wang", "link": "https://stackoverflow.com/users/4718903/yiyue-wang"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1429091675, "post_id": 29646667, "comment_id": 47434197, "body": "@Sibi Thank you so much!! Sorry quite new to Haskell and everything.."}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 4718903, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bSjBU.jpg?s=128&g=1", "display_name": "Yiyue Wang", "link": "https://stackoverflow.com/users/4718903/yiyue-wang"}, "edited": false, "score": 0, "creation_date": 1429092233, "post_id": 29647264, "comment_id": 47434566, "body": "Thank you so much!! Solved everything :D"}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "reply_to_user": {"reputation": 142, "user_id": 4718903, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bSjBU.jpg?s=128&g=1", "display_name": "Yiyue Wang", "link": "https://stackoverflow.com/users/4718903/yiyue-wang"}, "edited": false, "score": 0, "creation_date": 1429092976, "post_id": 29647264, "comment_id": 47435082, "body": "@YiyueWang Happy to be of help."}], "tags": [], "owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "is_accepted": true, "score": 3, "last_activity_date": 1429092127, "creation_date": 1429092127, "answer_id": 29647264, "question_id": 29646667, "link": "https://stackoverflow.com/questions/29646667/did-i-install-cabal-correctly/29647264#29647264", "title": "Did I install cabal correctly?", "body": "<p>Once you install <code>cabal</code> you can <em>install other packages</em>.</p>\n\n<p>So, to install the Alex package, you'll do <code>cabal install alex</code>. Then I see that you tried to invoke Alex in GHCi, but that's not correct, since <code>alex</code> is a program. You have to invoke it from the terminal.</p>\n"}], "owner": {"reputation": 142, "user_id": 4718903, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bSjBU.jpg?s=128&g=1", "display_name": "Yiyue Wang", "link": "https://stackoverflow.com/users/4718903/yiyue-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 29647264, "answer_count": 1, "score": 0, "last_activity_date": 1429092127, "creation_date": 1429090464, "last_edit_date": 1429091937, "question_id": 29646667, "link": "https://stackoverflow.com/questions/29646667/did-i-install-cabal-correctly", "title": "Did I install cabal correctly?", "body": "<p>Hi I've just updated cabal to the latest version by the command</p>\n\n<pre><code>cabal update\n</code></pre>\n\n<p>and</p>\n\n<pre><code>cabal install cabal-install\n</code></pre>\n\n<p>Then it returns </p>\n\n<pre><code>Installed cabal-install-1.22.2.0\nUpdating documentation index /MyPath\n</code></pre>\n\n<p>I want to use alex and happy. Sorry I'm very new to it.. When I tried to issue alex in ghci by the line</p>\n\n<pre><code>alex wordcount.x\n</code></pre>\n\n<p>It returns</p>\n\n<pre><code>Not in scope: \u2018alex\u2019\nPerhaps you meant \u2018lex\u2019 (imported from Prelude)\n</code></pre>\n\n<p>I searched online for this and I found a webpage saying that I should first check the version of them by </p>\n\n<pre><code> cabal configure -v | grep -e alex -e happy\n</code></pre>\n\n<p>But I got this line</p>\n\n<pre><code>cabal: No cabal file found.\nPlease create a package description file &lt;pkgname&gt;.cabal\n</code></pre>\n\n<p>Could anyone help me with this problem?</p>\n"}, {"tags": ["arrays", "haskell", "monads", "state-monad"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1429109589, "post_id": 29645868, "comment_id": 47446860, "body": "Note that this is the example in chapter 1 of <a href=\"https://rads.stackoverflow.com/amzn/click/com/0521513383\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Richard Bird&#39;s Pearls of Functional Algorithm Design</a>, and his results show that a divide-and-conquer approach using pure structures beats an <code>accumArray</code> based approach."}], "answers": [{"comments": [{"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1429089126, "post_id": 29646112, "comment_id": 47432598, "body": "Whoops. I feel a bit silly having overlooked that. The <code>Control.Applicative</code> solution is much cleaner, though -- thanks for pointing that out. I&#39;d be extra happy if <code>setTrues</code> could be rewritten to be point-free, but I suspect that can&#39;t be done sanely."}, {"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1429089340, "post_id": 29646112, "comment_id": 47432745, "body": "Actually, I don&#39;t think <code>&lt;*</code> does the trick -- I get <code>Couldn&#39;t match expected type </code>ST s b0&#39; with actual type <code>a0 Int Bool -&gt; m0 ()&#39;</code> --- <code>setTrues</code> isn&#39;t passed the STArray as an argument."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1429095678, "last_edit_date": 1429095678, "creation_date": 1429088935, "answer_id": 29646112, "question_id": 29645868, "link": "https://stackoverflow.com/questions/29645868/cleaning-up-mutable-array-code/29646112#29646112", "title": "Cleaning up mutable array code", "body": "<p>This should work:</p>\n\n<pre><code>setTrues arr = mapM_ (flip (writeArray arr) False) ns &gt;&gt; return arr\nseen = elems $ runSTArray $ newSTArray bound False &gt;&gt;= setTrues\n</code></pre>\n\n<p>The trick is letting <code>setTrues</code> return the array instead of <code>()</code>, as you already attempted.</p>\n"}, {"comments": [{"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1429094475, "post_id": 29647545, "comment_id": 47436026, "body": "This is a better solution, but I&#39;m interested in one using mutable arrays for my purpose here -- I have a reference solution with an <code>accumArray</code> that I&#39;m comparing against. Perhaps, though, the ugliness of ST is inevitable."}], "tags": [], "owner": {"reputation": 558, "user_id": 4751430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f424b8d7abc1bd4adaf69ca95412f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Huschenbett", "link": "https://stackoverflow.com/users/4751430/martin-huschenbett"}, "is_accepted": false, "score": 1, "last_activity_date": 1429092865, "creation_date": 1429092865, "answer_id": 29647545, "question_id": 29645868, "link": "https://stackoverflow.com/questions/29645868/cleaning-up-mutable-array-code/29647545#29647545", "title": "Cleaning up mutable array code", "body": "<p>To my understanding, one of the main purposes of the ST monad is to provide a loophole to imperative programming in purely functional code. So I guess, there is no nice solution using the ST monad which doesn't look too imperative. However, to get rid of the imperative style you could use the function</p>\n\n<pre><code>accumArray :: Ix i =&gt; (e -&gt; a -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(i, a)] -&gt; Array i e\n</code></pre>\n\n<p>from <code>Data.Array</code>. In fact, the actual implementation of this function looks somewhat similar to your code.</p>\n\n<p>Altogether, a more functional solution could look as follows:</p>\n\n<pre><code>minFree2 :: [Int] -&gt; Int\nminFree2 ns = fromMaybe 0 $ elemIndex False $ elems seen\n  where\n    bound = (1, length ns)\n    seen :: Array Int Bool\n    seen = accumArray (||) False bound $ map (,True) ns\n</code></pre>\n\n<p>PS: <code>True</code> and <code>False</code> seemed to be distributed slightly wrong. I silently fixed this.</p>\n"}], "owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429095678, "creation_date": 1429088240, "question_id": 29645868, "link": "https://stackoverflow.com/questions/29645868/cleaning-up-mutable-array-code", "title": "Cleaning up mutable array code", "body": "<p>I'm trying to solve the MINFREE problem in \"Pearls of Functional Algorithm Design\" using mutable arrays. The problem is as follows: given a list of <code>n</code> natural numbers, find the smallest natural number that does not appear in the list. I'm pretty sure that the following is a solution:</p>\n\n<pre><code>minFree2 :: [Int] -&gt; Int\nminFree2 ns =  (fromMaybe 0 $ elemIndex True seen)\n  where\n    bound = (1, length ns)\n    seen = elems $ runSTArray $ do\n      arr &lt;- newSTArray bound False\n      mapM_ (\\n -&gt; writeArray arr n False) ns\n      return arr\n</code></pre>\n\n<p>But the <code>do</code> block looks awfully imperative to me, and I'd like to simplify it to a more functional style in order to get a better grasp on monads. </p>\n\n<p>I can get as far as the following (rewriting only the <code>where</code> clause):</p>\n\n<pre><code> bound = (1, length ns)\n setTrues arr = mapM_ (flip (writeArray arr) False) ns\n seen = elems $ runSTArray $ newSTArray bound False &gt;&gt;= setTrues\n</code></pre>\n\n<p>But that doesn't work, because it returns <code>()</code> rather than <code>STArray s i e</code>. I'd like to write something like:</p>\n\n<pre><code>    setTrues arr = mapM_ (flip (writeArray arr) False) ns &gt;&gt; arr\n</code></pre>\n\n<p>the same way I might write <code>fn arr =&gt; map ....; arr</code> in SML, but that doesn't work here because <code>arr</code> is an <code>STArray s i e</code> rather than a <code>ST s (STarray s i e)</code>. I'd expect to be able to fix that by wrapping <code>arr</code> back up in an <code>ST</code>, but my attempt with:</p>\n\n<pre><code>    setTrues arr = mapM_ (flip (writeArray arr) False) ns &gt;&gt; arr\n    seen = elems $ runSTArray $ newSTArray bound False &gt;&gt;= return . setTrues\n</code></pre>\n\n<p>Yields the error:</p>\n\n<pre><code>No instance for (MArray (STArray s) Bool (STArray s Int))\n  arising from a use of `setTrues'\n</code></pre>\n\n<p>which I don't entirely understand. </p>\n\n<p>Is there a nice way to write this code, minimizing the use of <code>do</code>?</p>\n"}, {"tags": ["haskell", "functor", "applicative", "hackage"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1429088644, "post_id": 29645909, "comment_id": 47432308, "body": "A very nice consequence of the free theorem!"}, {"owner": {"reputation": 369, "user_id": 3577289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f1787220565591f5ecb6aba686abb6?s=128&d=identicon&r=PG&f=1", "display_name": "gksato", "link": "https://stackoverflow.com/users/3577289/gksato"}, "edited": false, "score": 0, "creation_date": 1429096494, "post_id": 29645909, "comment_id": 47437277, "body": "Thank you for your nice answer and reference! It seems that the free theorem is a good theorem, although I don&#39;t still understand it. Do you know whether the theorem holds under the GHC extensions (see my Edit in my questions)?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1429134570, "post_id": 29645909, "comment_id": 47462683, "body": "The only function of type <code>a -&gt; a</code> is <code>id</code>, so <code>transf_a</code> and <code>tinv_a</code> are both <code>id</code> and <code>transf_a . tinv_a = id</code> is trivially true. (Up to bottoms, but <a href=\"http://www.cs.ox.ac.uk/jeremy.gibbons/publications/fast+loose.pdf\" rel=\"nofollow noreferrer\">morally correct</a>.)"}], "tags": [], "owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "is_accepted": true, "score": 14, "last_activity_date": 1569197396, "last_edit_date": 1569197396, "creation_date": 1429088378, "answer_id": 29645909, "question_id": 29645729, "link": "https://stackoverflow.com/questions/29645729/haskell-flaw-in-the-description-of-applicative-functor-laws-in-the-hackage-cont/29645909#29645909", "title": "Haskell: Flaw in the description of applicative functor laws in the hackage Control.Applicative article?: it says Applicative determines Functor", "body": "<p>Any type in Haskell can have at most one instance of <code>Functor</code>, so your guess is not correct: For <em>no</em> type <code>t</code> (whether or not it's an instance of <code>Applicative</code>) can there exist two different implementations of <code>instance (Functor t)</code>. See: <a href=\"http://article.gmane.org/gmane.comp.lang.haskell.libraries/15384\" rel=\"nofollow noreferrer\">http://article.gmane.org/gmane.comp.lang.haskell.libraries/15384</a></p>\n"}, {"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1429134736, "post_id": 29660714, "comment_id": 47462764, "body": "With <code>fmap = undefined</code>, <code>fmap id x = _|_</code> but <code>id x = x</code>, so it doesn&#39;t abide the functor laws."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1429134953, "post_id": 29660714, "comment_id": 47462846, "body": "@ReinHenrichs Thanks for an important point that I missed. I was just taking gksato&#39;s proof for granted and thinking, &quot;well, there&#39;s only two values of that type,&quot; but it didn&#39;t occur to me that one of the values violated the axioms."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1429135048, "post_id": 29660714, "comment_id": 47462878, "body": "Your point is correct, though: any type constructor has at most one <i>legal</i> definition of <code>fmap</code>. As chi mentions in another comment, this follows from the functor laws and the free theorem for <code>fmap</code>."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 2, "last_activity_date": 1429131272, "creation_date": 1429131272, "answer_id": 29660714, "question_id": 29645729, "link": "https://stackoverflow.com/questions/29645729/haskell-flaw-in-the-description-of-applicative-functor-laws-in-the-hackage-cont/29660714#29660714", "title": "Haskell: Flaw in the description of applicative functor laws in the hackage Control.Applicative article?: it says Applicative determines Functor", "body": "<p>It is a property of the type <code>a -&gt; a</code> that there are only two inhabitants of it, namely <code>id :: a -&gt; a</code> (defined as <code>id x = x</code>) and <code>bottom :: a -&gt; a</code> defined as <code>bottom = error \"Infinite loop.\"</code>. </p>\n\n<p>If we restrict ourselves to only the first case as \"reasonable\", we come to an important mathematical theorem, which is that there is at most one function <code>fmap</code> of type <code>forall a. forall b. (a -&gt; b) -&gt; f a -&gt; f b</code> satisfying <code>fmap id = id</code> and <code>fmap f . fmap g = fmap (f . g)</code>. </p>\n\n<p>If we do not, then you are correct, we have one case where <code>fmap = undefined</code> and the other where <code>fmap = (&lt;*&gt;) . pure</code>. But that's a little cheesy.</p>\n"}], "owner": {"reputation": 369, "user_id": 3577289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f1787220565591f5ecb6aba686abb6?s=128&d=identicon&r=PG&f=1", "display_name": "gksato", "link": "https://stackoverflow.com/users/3577289/gksato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 29645909, "answer_count": 2, "score": 11, "last_activity_date": 1569197396, "creation_date": 1429087826, "last_edit_date": 1429095738, "question_id": 29645729, "link": "https://stackoverflow.com/questions/29645729/haskell-flaw-in-the-description-of-applicative-functor-laws-in-the-hackage-cont", "title": "Haskell: Flaw in the description of applicative functor laws in the hackage Control.Applicative article?: it says Applicative determines Functor", "body": "<p>I think I found a flaw in <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Applicative.html\">the hackage article for <code>Control.Applicative</code></a>.\nAs a description of the applicative functor laws, it says:</p>\n\n<blockquote>\n<pre><code>class Functor f =&gt; Applicative f where\n</code></pre>\n  \n  <p>A functor with application, providing operations to\n  embed pure expressions (<code>pure</code>), and sequence computations and combine their results (<code>&lt;*&gt;</code>).</p>\n  \n  <p>A minimal complete definition must include implementations of these functions satisfying the following laws:</p>\n  \n  <p><strong><em>identity</em></strong></p>\n\n<pre><code>pure id &lt;*&gt; v = v\n</code></pre>\n  \n  <p><strong><em>composition</em></strong></p>\n\n<pre><code>pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)\n</code></pre>\n  \n  <p><strong><em>homomorphism</em></strong></p>\n\n<pre><code>pure f &lt;*&gt; pure x = pure (f x)\n</code></pre>\n  \n  <p><strong><em>interchange</em></strong></p>\n\n<pre><code>u &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u\n</code></pre>\n</blockquote>\n\n<p>(note that this does not say anything about fmap) and it states that these laws determine the <code>Functor</code> instance:</p>\n\n<blockquote>\n  <p>As a consequence of these laws, the <code>Functor</code> instance for f will satisfy</p>\n\n<pre><code>fmap f x = pure f &lt;*&gt; x\n</code></pre>\n</blockquote>\n\n<p>I thought at first this was obviously wrong.  That is, I guessed there must exist a type constructor <code>t</code> satisfying the following two conditions:</p>\n\n<ol>\n<li><code>t</code> is an instance of <code>Applicative</code> fulfilling the rules above, and</li>\n<li>There are two different implementations of <code>instance (Functor t)</code>\n(i.e. there are two distinct functions <code>fmap1, fmap2 :: (a-&gt;b) -&gt; (t a-&gt;t b)</code>,\n satisfying the functor laws).</li>\n</ol>\n\n<p>If (and only if) the above is correct, the above statement <em>must</em> be rewritten to</p>\n\n<blockquote>\n  <p>The Functor instance for f must satisfy</p>\n\n<pre><code>fmap f x = pure f &lt;*&gt; x\n</code></pre>\n  \n  <p>As a consequence of these laws, this satisfies the <code>Functor</code> laws.</p>\n</blockquote>\n\n<p>which is clearly correct, <em>no matter whether my guess is right or not</em>.</p>\n\n<p><strong><em>My question is</em></strong>: <em>is my guess correct? Is there a <code>t</code> with the desired conditions?</em></p>\n\n<hr>\n\n<p>What follows is the explanation of what I thought during trying to answer this question by myself.</p>\n\n<p>If we were mere mathematicians <em>uninterested in actual Haskell programming</em>, we could easily answer this question affirmatively. In fact,</p>\n\n<pre><code>t = Identity\nnewtype Identity a = Identity {runIdentity :: a}\n</code></pre>\n\n<p>meets the requirements 1 and 2 above (in fact, almost anything will do). Indeed, <code>Identity</code> is trivially an instance of <code>Functor</code> and <code>Applicative</code>, as defined in <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Functor-Identity.html\"><code>Data.Functor.Identity</code></a>. (This satisfies <code>fmap f = (pure f &lt;*&gt;)</code>.)\nTo define another \"implementation\" of <code>instance (Functor f)</code>, Take, for each type <code>a</code>, two functions</p>\n\n<pre><code>transf_a, tinv_a :: a -&gt; a\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>tinv_a . transf_a = id\n</code></pre>\n\n<p>(This is, <em>set-theoretically</em>, easy). Now define</p>\n\n<pre><code>instance (Functor Identity) where\n fmap (f :: a-&gt;b) = Identity . transf_b . f . tinv_a . runIdentity\n</code></pre>\n\n<p>This satisfies the <code>Functor</code> laws and is a different implementation from the trivial one if there are</p>\n\n<pre><code>x :: a\nf :: a -&gt; b\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>f x /= transf_b $ f $ tinv_a x\n</code></pre>\n\n<p>But it is not at all obvious whether we can do it in Haskell. Is something like: </p>\n\n<pre><code>class (Isom a) where\n transf, tinv :: a -&gt; a\n\ninstance (Isom a) where\n transf = id\n tinv = id\n\nspecialized instance (Isom Bool) where\n transf = not\n tinv = not\n</code></pre>\n\n<p>possible in Haskell?</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>I forgot to write something very important. I recognize <code>Control.Applicative</code> as part of GHC base package, so I am also interested in whether the answer to my question changes with any GHC language extensions, such as <code>FlexibleInstances</code> or <code>OverlappingInstances</code>, which I don't understand yet.</p>\n"}, {"tags": ["haskell", "filter", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1429085962, "post_id": 29644943, "comment_id": 47430692, "body": "I&#39;m close, been playing with <code>ghci</code> for a few minutes now to try and work it out but I&#39;m not getting much. Have I made a mistake with the composition? I feel like I need a dollar-sign or a period somewhere.  EDIT: Yeah, put a period between isSquare and the lambda!"}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 1, "creation_date": 1429086293, "post_id": 29644943, "comment_id": 47430909, "body": "@capncoolio : Yes, that familiar feeling of needing <i>just</i> one more dollar-sign or a period (or maybe it is an <code>fmap</code> or <code>flip</code> or ...) somewhere in here ... . Jokes apart, you should sit and think <i>slowly</i> about the various <b>types</b> involved. That is the key to getting past this stage of uncertainty. Ask yourself what the type of each &quot;thing&quot; in your program is. Even better, ask ghci (<code>:t thing</code> gives the type of &quot;thing&quot;). Now ask, for each thing which fails to type-check (where ghci throws an error), <i>why</i> it fails. As Euclid said, &quot;There is no royal road to Haskell.&quot;."}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1429086448, "post_id": 29644943, "comment_id": 47431010, "body": "You won&#39;t do badly if you start with my first question. <i>Figure out</i> why <code>:t (isSquare (\\n -&gt; (8*n+1)))</code> results in an error message. It helps if you look at  the types of each of the two sub-expressions involved in this."}, {"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1429086558, "post_id": 29644943, "comment_id": 47431094, "body": "@G Philip I have to say, the type error it threw at me was about a billion lines long and quite hard to understand. I <i>kind of</i> get it, but I&#39;ll definitely do some reading. I have a couple of Haskell wizards at my disposal in real life, so I might use them too."}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1429086748, "post_id": 29644943, "comment_id": 47431213, "body": "@capncoolio: It&#39;s true that ghci type error messages are scary and need quite some getting used to. But it does point you to the expression which caused the error, and then you can try to manually look at the types of the different sub-expressions involved, and figure out the problem yourself."}, {"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1429086750, "post_id": 29644943, "comment_id": 47431214, "body": "<code>:t (\\n -&gt; (8*n+1))</code> gives me <code>(\\n -&gt; (8*n+1)) :: Num a =&gt; a -&gt; a</code>, which seems... fine? It gives back an a, and <code>isSquare</code> expects one..."}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1429086818, "post_id": 29644943, "comment_id": 47431255, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/75261/discussion-between-g-philip-and-capncoolio\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "is_accepted": true, "score": 3, "last_activity_date": 1429085515, "creation_date": 1429085515, "answer_id": 29644943, "question_id": 29644511, "link": "https://stackoverflow.com/questions/29644511/implementing-a-filter-whose-function-takes-an-argument/29644943#29644943", "title": "Implementing a filter whose function takes an argument", "body": "<ol>\n<li><p>Does the expression <code>(isSquare (\\n -&gt; (8*n+1)))</code> type-check? Why not?</p></li>\n<li><p><code>filter</code> has the type <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code>. So its first argument needs to be a function of type <code>(a -&gt; Bool)</code>. You are <em>almost</em> there with this; what function do you want here, and how can you construct it with what you have? Hint: It's a single-character change. </p></li>\n</ol>\n"}], "owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 29644943, "answer_count": 1, "score": 0, "last_activity_date": 1429085515, "creation_date": 1429084206, "question_id": 29644511, "link": "https://stackoverflow.com/questions/29644511/implementing-a-filter-whose-function-takes-an-argument", "title": "Implementing a filter whose function takes an argument", "body": "<p>I am writing some Haskell which aims to take a list of numbers and filter out any number that isn't triangular.</p>\n\n<pre><code>main :: IO()\nmain = do\n    interact tri\n\ntri :: String -&gt; String\ntri =   unwords . \n        map show .\n        filter (isSquare (\\n -&gt; (8*n+1))) . \n        map (read :: String -&gt; Int) . \n        words\n\nisSquare :: (Integral a) =&gt; a -&gt; Bool\nisSquare n = (round . sqrt $ fromIntegral n) ^ 2 == n\n</code></pre>\n\n<p>This is what I have so far. Where I am having trouble is the filter.</p>\n\n<p>I don't fully understand how I might go about actually <em>accessing</em> the value in that anonymous function (or, for that matter, if this is even possible in this manner). I need to test each number using this function in combination with <code>isSquare</code> to determine whether the number is triangular. I understand the exercise is purely academic, I'm just trying to learn about function composition and IO mostly.</p>\n"}, {"tags": ["haskell", "scotty", "haskell-wai"], "answers": [{"comments": [{"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 0, "creation_date": 1429095315, "post_id": 29647167, "comment_id": 47436556, "body": "Thanks Michael. I found other answers on SO about the body. My use case is about file upload which I think is using chunked encoding (not sure). but what about the headers? Is there a limit baked in WAI/Warp?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 1, "creation_date": 1429099356, "post_id": 29647167, "comment_id": 47439161, "body": "<code>requestBodyLength</code> is populated via the content-length and transfer-encoding headers. There is no baked in limit. Have you tried testing any of this?"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1457853320, "last_edit_date": 1457853320, "creation_date": 1429091888, "answer_id": 29647167, "question_id": 29644037, "link": "https://stackoverflow.com/questions/29644037/how-can-i-limit-size-of-request-body-and-headers-in-wai/29647167#29647167", "title": "How can I limit size of request body and headers in WAI?", "body": "<p>I don't know details of Scotty, but it's certainly possible to set up a WAI middleware that will look at the <a href=\"https://www.stackage.org/haddock/lts-2.3/wai-3.0.2.3/Network-Wai.html#v:requestBodyLength\" rel=\"nofollow\">requestBodyLength</a> and, if it's too large, return an appropriate 413 status code page. One thing you'd need to deal with is if the upload body is sent with chunked encoding, in which case no content-length is present. but that's uncommon. You have the option of either rejecting those requests, or adding code to wrap the request body and return an error if it turns out to be too large (<a href=\"https://github.com/yesodweb/yesod/blob/e7c6d06d3dca7710b6bad2caa074162170b82a78/yesod-core/Yesod/Core/Internal/Request.hs#L54\" rel=\"nofollow\">that's what Yesod does</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 546, "user_id": 7462764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44f1b2cf4c2b086555627a780419181?s=128&d=identicon&r=PG", "display_name": "instant", "link": "https://stackoverflow.com/users/7462764/instant"}, "is_accepted": false, "score": 0, "last_activity_date": 1568028947, "creation_date": 1568028947, "answer_id": 57853229, "question_id": 29644037, "link": "https://stackoverflow.com/questions/29644037/how-can-i-limit-size-of-request-body-and-headers-in-wai/57853229#57853229", "title": "How can I limit size of request body and headers in WAI?", "body": "<p>The marked solution points in the correct direction, but if you're like me you might still struggle to explicitely derive the full code needed. Here is an implementation (thanks to the help of an experienced Haskell friend):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import qualified Network.HTTP.Types as Http\nimport qualified Network.Wai as Wai\n\nlimitRequestSize :: Wai.Middleware\nlimitRequestSize app req respond = do\n    case Wai.requestBodyLength req of\n        Wai.KnownLength len -&gt; do\n            if len &gt; maxLen\n                then respond $ Wai.responseBuilder Http.status413 [] mempty\n                else app req respond\n\n        Wai.ChunkedBody -&gt;\n            respond $ Wai.responseBuilder Http.status411 [] mempty\n    where\n        maxLen = 50*1000 -- 50kB\n</code></pre>\n\n<p>The middleware then just runs in scotty's do block like this</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Network.Wai.Middleware.RequestLogger (logStdout)\n\nmain :: IO ()\nmain = do\n    scotty 3000 $ do\n        middleware logStdout\n        middleware limitRequestSize\n\n        get \"/alive\" $ do\n            status Http.status200\n\n        -- ...\n</code></pre>\n\n<p>If you're curious as to how to derive it (or why I found this not overly trivial), consider that <a href=\"http://hackage.haskell.org/package/wai/docs/Network-Wai.html#t:Middleware\" rel=\"nofollow noreferrer\"><code>Middleware</code></a> is an alias for</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Application -&gt; Application\n</code></pre>\n\n<p>where <a href=\"http://hackage.haskell.org/package/wai-3.2.2.1/docs/Network-Wai.html#t:Application\" rel=\"nofollow noreferrer\"><code>Application</code></a> itself is an alias for</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived\n</code></pre>\n\n<p>Hence there are quite a bunch of arguments to (mentally) unpack, even if the solution is pretty terse.</p>\n"}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 29647167, "answer_count": 2, "score": 5, "last_activity_date": 1568028947, "creation_date": 1429082754, "last_edit_date": 1457853439, "question_id": 29644037, "link": "https://stackoverflow.com/questions/29644037/how-can-i-limit-size-of-request-body-and-headers-in-wai", "title": "How can I limit size of request body and headers in WAI?", "body": "<p>I am developing an application using <a href=\"https://www.stackage.org/package/scotty\" rel=\"nofollow\">Scotty</a> and of course <a href=\"https://www.stackage.org/package/wai\" rel=\"nofollow\">WAI</a>. I would like to be able to limit the size of requests, both for body length and for headers. How can I do that? Is it possible to do it using a plain WAI middleware ?</p>\n"}, {"tags": ["unix", "haskell", "authentication", "login", "passwords"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1429083464, "post_id": 29641393, "comment_id": 47429288, "body": "Keep in mind that unix does not allow a process to <i>raise</i> its permissions. setuid/seteuid can change the uid of the current process only if (very roughly) the current uid is root, or if you are just &quot;moving&quot; uids between uid and euid. The OS itself never checks passwords, su does, and since su is run as root it can setuid to the right user."}], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 2155544, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/caae6ef08bc308aaa3c34324286bad6d?s=128&d=identicon&r=PG", "display_name": "Michael restore Monica Cellio", "link": "https://stackoverflow.com/users/2155544/michael-restore-monica-cellio"}, "edited": false, "score": 0, "creation_date": 1429136904, "post_id": 29643377, "comment_id": 47463627, "body": "That definitely won&#39;t do what I want because it doesn&#39;t take a password as parameter."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 2, "last_activity_date": 1429080580, "creation_date": 1429080580, "answer_id": 29643377, "question_id": 29641393, "link": "https://stackoverflow.com/questions/29641393/how-to-perform-an-su-in-a-haskell-web-application/29643377#29643377", "title": "How to perform an &#39;su&#39; in a Haskell (web) application", "body": "<p>The package <a href=\"https://hackage.haskell.org/package/unix-2.7.1.0/docs/System-Posix-User.html#v:setEffectiveUserID\" rel=\"nofollow\">unix</a> has a similar function related to what you want:</p>\n\n<pre><code>setEffectiveUserID :: UserID -&gt; IO () \n</code></pre>\n\n<p>The function seems to be implemented via FFI. That being said, I don't think it is a good idea to use <code>su</code> based thing from Yesod. Also, seeing the above API, I guess it will only work when invoked from a higher privilege. </p>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 0, "last_activity_date": 1429524607, "creation_date": 1429524607, "answer_id": 29744962, "question_id": 29641393, "link": "https://stackoverflow.com/questions/29641393/how-to-perform-an-su-in-a-haskell-web-application/29744962#29744962", "title": "How to perform an &#39;su&#39; in a Haskell (web) application", "body": "<p>The reason it doesn't make sense in Yesod is because Warp doesn't spawn a new process for every connection (at least not by default).</p>\n\n<p>In this situation: you should use a separate program that does all the per-user operations and call it with one of the functions from <code>System.Process</code></p>\n"}], "owner": {"reputation": 668, "user_id": 2155544, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/caae6ef08bc308aaa3c34324286bad6d?s=128&d=identicon&r=PG", "display_name": "Michael restore Monica Cellio", "link": "https://stackoverflow.com/users/2155544/michael-restore-monica-cellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429524607, "creation_date": 1429070662, "question_id": 29641393, "link": "https://stackoverflow.com/questions/29641393/how-to-perform-an-su-in-a-haskell-web-application", "title": "How to perform an &#39;su&#39; in a Haskell (web) application", "body": "<p>I'm writing a Yesod-based application and it would be useful to allow, as an option, authentication via the same means as a local 'su';  that is to say:  the user supplies the login name and password and the session effectively performs an 'su' with those credentials and runs with the same permissions as would the user logged-in locally on the machine.  This is because one deployment scenario has the web application accessing and manipulating files in the user's $HOME.  However, the lack of an API for the purpose leads me to conclude that what I want is infeasible or nonsensical for some reason.  The closest I could find was a crypt() function but (1) it requires a salt and (2) /etc/shadow is only readable by root.  I was expecting some function like:</p>\n\n<pre><code>setEffUId :: String -&gt; String -&gt; IO (Either SomeError Bool)\n</code></pre>\n\n<p>Presumably someone would have written this is if it were feasible to do so, so why isn't it ?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 4, "last_activity_date": 1429071577, "creation_date": 1429071577, "answer_id": 29641528, "question_id": 29641345, "link": "https://stackoverflow.com/questions/29641345/understanding-error-in-the-insertion-of-an-element-in-a-list/29641528#29641528", "title": "Understanding error in the insertion of an element in a list", "body": "<p>The <code>:</code> operation adds an element (the first argument) to a list (the second argument). Thus, it expects the first argument to be an element and the second to be a list, not the other way around. If you want to do it that way, you would do this:</p>\n\n<pre><code>insertElem x k l = take k l ++ [x] ++ drop k l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 7, "last_activity_date": 1429071660, "creation_date": 1429071660, "answer_id": 29641538, "question_id": 29641345, "link": "https://stackoverflow.com/questions/29641345/understanding-error-in-the-insertion-of-an-element-in-a-list/29641538#29641538", "title": "Understanding error in the insertion of an element in a list", "body": "<p>Your problem is (as Silvio already told you) the use of <code>:</code> but let's analyse the types to see where the error comes from and how you could see it yourself:</p>\n\n<h3>let's check the types</h3>\n\n<p>look at</p>\n\n<pre><code>(take k l : x) ++ drop k l\n</code></pre>\n\n<p><code>(++)</code> has type <code>[a] -&gt; [a] -&gt; [a]</code> so both parts <code>take k l : x</code> and <code>drop k l</code> need to be lists of the same type.</p>\n\n<p>looking at <code>drop</code> you get <code>Int -&gt; [a] -&gt; [a]</code> so you now know:</p>\n\n<ul>\n<li><code>k</code> has type <code>Int</code></li>\n<li><code>l</code> has type <code>[a]</code></li>\n<li>your result is the same type <code>[a]</code></li>\n<li><code>take k l : x</code> too needs to have type <code>[a]</code></li>\n</ul>\n\n<p>now look at <code>(:)</code> it has type <code>a -&gt; [a] -&gt; [a]</code> so for it to work out you now need <code>x</code> to have type <code>[a]</code> and <code>take k l</code> to have type <code>a</code>.</p>\n\n<p><code>take</code> has type <code>Int -&gt; [a] -&gt; [a]</code> and we already know that <code>l</code> has type <code>[a]</code> so you get:</p>\n\n<ul>\n<li><code>take k l</code> has type <code>[a]</code></li>\n<li>but you also need (see above at <code>(:)</code>) <code>take k l</code> to be of type <code>a</code></li>\n</ul>\n\n<p>So you need <code>a</code> to be somehow at the same time to be <code>[a]</code> that is what <code>a ~ [a]</code> means and is what the error says.</p>\n"}, {"tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 1, "last_activity_date": 1429082502, "last_edit_date": 1429082502, "creation_date": 1429076843, "answer_id": 29642436, "question_id": 29641345, "link": "https://stackoverflow.com/questions/29641345/understanding-error-in-the-insertion-of-an-element-in-a-list/29642436#29642436", "title": "Understanding error in the insertion of an element in a list", "body": "<p>A recursive definition of <code>insertElem</code> that illustrates the use of <code>(:)</code>,</p>\n\n<pre><code>insertElem :: a -&gt; Int -&gt; [a] -&gt; [a]\ninsertElem e 0 xs     = e : xs\ninsertElem e k []     = [e] -- k &gt; length xs\ninsertElem e k (x:xs) = x : insertElem e (k-1) xs\n</code></pre>\n\n<p>Here <code>insertElem</code> delivers a list of <code>a</code> to which we append either the current head of the list of else the actual element to be inserted. </p>\n\n<p>The appending of an element of type <code>a</code> to a list of <code>a</code> uses <code>(:)</code>. Note in the second case we append an element <code>e</code> to an empty list, namely <code>[e]</code>; this is equivalent to <code>e : []</code>. In the last case we extract the head of the list also with <code>(:)</code>.</p>\n"}], "owner": {"reputation": 145, "user_id": 1076739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08bc0fa0f62b72c6079a359db6ca70e?s=128&d=identicon&r=PG", "display_name": "Anubhaw Arya", "link": "https://stackoverflow.com/users/1076739/anubhaw-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 29641538, "answer_count": 3, "score": 1, "last_activity_date": 1429082502, "creation_date": 1429070327, "question_id": 29641345, "link": "https://stackoverflow.com/questions/29641345/understanding-error-in-the-insertion-of-an-element-in-a-list", "title": "Understanding error in the insertion of an element in a list", "body": "<p>So I'm learning haskell right now, and I'm having trouble understanding what I'm doing wrong for the following function that inserts an element <code>x</code> at index <code>k</code> in list <code>l</code></p>\n\n<p>1.<code>insertElem x k l = take k l ++ (x : drop k l)</code></p>\n\n<p>2.<code>insertElem x k l = (take k l : x) ++ drop k l</code></p>\n\n<p>Now, I know that the correct answer is number 1, but I don't understand why number 2 is wrong for the call <code>insertElem 2 5 [0,0,0,0,0,0]</code>.</p>\n\n<p>The error is \"Cannot construct the infinite type: a ~ [a]. Expected type: [[a]], Actual type: [a]\"</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 2, "creation_date": 1429066347, "post_id": 29640792, "comment_id": 47423299, "body": "I blame ~~Scala~~ (myself) for the <code>=&gt;</code>. Thanks"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1429066430, "post_id": 29640792, "comment_id": 47423314, "body": "Kevin Meredith: Yeah, I imagine it doesn&#39;t help that in Scala, constraints are (implicit) arguments."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1429108915, "post_id": 29640792, "comment_id": 47446342, "body": "Are constraints resolved as implicits in Haskell too?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1429155617, "post_id": 29640792, "comment_id": 47469045, "body": "sort of. type classes constraints are transformed by the compiler into dictionary arguments. which dictionary is used at call time is determined by type inference."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 3, "last_activity_date": 1429066164, "creation_date": 1429066164, "answer_id": 29640792, "question_id": 29640717, "link": "https://stackoverflow.com/questions/29640717/monad-transformer-distribute-function/29640792#29640792", "title": "Monad Transformer &#39;distribute&#39; Function", "body": "<p>That should be</p>\n\n<pre><code>distrib :: (Monad m, Monad n) =&gt; n (m a) -&gt; m (n a)\n</code></pre>\n\n<p><code>=&gt;</code> comes between the constraint and the rest of the type.</p>\n\n<p><code>-&gt;</code> is the infix type constructor for functions.</p>\n\n<p>For example</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n       -----     \\  /      \\\n        \\         arguments result\n         constraint\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 29640792, "answer_count": 1, "score": 1, "last_activity_date": 1429066164, "creation_date": 1429065690, "question_id": 29640717, "link": "https://stackoverflow.com/questions/29640717/monad-transformer-distribute-function", "title": "Monad Transformer &#39;distribute&#39; Function", "body": "<p>Given the following <a href=\"https://wiki.haskell.org/Typeclassopedia#Definition_and_laws\" rel=\"nofollow\">Typeclassopedia</a> exercise:</p>\n\n<pre><code>--Implement join :: M (N (M (N a))) -&gt; M (N a), \n--given distrib :: N (M a) -&gt; M (N a) and \n--assuming M and N are instances of Monad.\n\ndistrib :: (Monad m, Monad n) =&gt; n (m a) =&gt; m (n a)\ndistrib = undefined\n</code></pre>\n\n<p>I get the following compile-time error.</p>\n\n<pre><code>ghci&gt; :l MonadTransformers.hs\n[1 of 1] Compiling Main             ( MonadTransformers.hs, interpreted )\n\nMonadTransformers.hs:7:34:\n    Expected a constraint, but `n (m a)' has kind `*'\n    In the type signature for `distrib':\n      distrib :: (Monad m, Monad n) =&gt; n (m a) =&gt; m (n a)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>How can I resolve it?</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4781150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90f044ef6d1e3aebe4d85141f9a2f58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Kolly", "link": "https://stackoverflow.com/users/4781150/tim-kolly"}, "edited": false, "score": 0, "creation_date": 1429147325, "post_id": 29639931, "comment_id": 47466821, "body": "Thanks for the help! i just answered my own question again with a error that i got just by adding the guard bars."}, {"owner": {"reputation": 1, "user_id": 4781150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90f044ef6d1e3aebe4d85141f9a2f58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Kolly", "link": "https://stackoverflow.com/users/4781150/tim-kolly"}, "edited": false, "score": 0, "creation_date": 1429148583, "post_id": 29639931, "comment_id": 47467157, "body": "&amp; also i am running on linux through terminal so i am wondering when it says prelude&gt; what am i suppose to type in to initiate the number i wish to plug in"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1429060613, "last_edit_date": 1429060613, "creation_date": 1429060098, "answer_id": 29639931, "question_id": 29639914, "link": "https://stackoverflow.com/questions/29639914/what-is-the-parse-error-in-pattern-in-my-credit-card-validation-written-in-has/29639931#29639931", "title": "What is the &quot;Parse error in pattern&quot; in my Credit Card Validation written in Haskell?", "body": "<p>You forgot the guard bars:</p>\n\n<pre><code>sumNum (x:xs)\n    | x &lt; 10 = ...\n    | otherwise = ...\n</code></pre>\n\n<p>Without the pipe characters, the compiler sees it as <code>sumNum (x:xs) x &lt; 10 = x + sumNum xs</code>, which doesn't make sense as a pattern, since it seems to suggest you have 3 more arguments, namely <code>x</code>, <code>&lt;</code> and <code>10</code>, although <code>&lt;</code> does not make sense as a name by itself.  Alternatively you could just skip the guard altogether, since</p>\n\n<pre><code>&gt; map (`mod` 10) [0..9] == [0..9]\nTrue\n&gt; map (`div` 10) [0..9] == replicate 10 0\nTrue\n</code></pre>\n\n<p>So all you save is a little efficiency.  Since you're working with very small inputs you don't really need to worry about this, so you could just use <code>sumNum [] = 0; sumNum (x:xs) = (x `mod` 10) + (x `div` 10) + sum xs</code>, or more simply <code>sumNum = sum . map (\\x -&gt; (x `mod` 10) + (x `div` 10))</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4781150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90f044ef6d1e3aebe4d85141f9a2f58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Kolly", "link": "https://stackoverflow.com/users/4781150/tim-kolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439508616, "creation_date": 1429059921, "last_edit_date": 1439508616, "question_id": 29639914, "link": "https://stackoverflow.com/questions/29639914/what-is-the-parse-error-in-pattern-in-my-credit-card-validation-written-in-has", "title": "What is the &quot;Parse error in pattern&quot; in my Credit Card Validation written in Haskell?", "body": "<p>The goal is to validate a list of numbers (credit card number for example ) to first initiate it, reverse it, and then double it, and that would give the sum. Then it would tell if it is valid or in-valid. I have written the code but it wont compile right. It keeps saying this: test.hs:22:1: Parse error in pattern: sumNum. \nHere is my code: </p>\n\n<pre><code>main = do\ntoDigits    :: Integer -&gt; [Integer]\ntoDigitsRev :: Integer -&gt; [Integer]\n\ntoDigitsRev n\n        where\n         n &lt;= 0 = []\n         otherwise = n `mod` 10 : toDigitsRev (n `div` 10)\n\ntoDigits = reverse . toDigitsRev\n\ndouble :: [Integer] -&gt; [Integer]\n\ndouble [] = []\ndouble (x:[]) = [x]\ndouble (x:y:zs) = x : (2 * y) : double zs\ndoubleRev = reverse . double . reverse\n\nsumNum :: [Integer] -&gt; Integer \n\nsumNum [] = 0\nsumNum (x:xs)\n  x &lt; 10 = x + sumNum xs\n  otherwise = (x `mod` 10) + (x `div` 10) + sum xs\n\nvalidate :: Integer -&gt; Bool\nvalidate n = (mod (sumNum (doubleRev (toDigits n))) 10) == 0\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "edited": false, "score": 0, "creation_date": 1429221443, "post_id": 29645557, "comment_id": 47510459, "body": "thanks for the answer and the link, the problem was the imports,"}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 0, "last_activity_date": 1429087361, "creation_date": 1429087361, "answer_id": 29645557, "question_id": 29638444, "link": "https://stackoverflow.com/questions/29638444/use-bootstraphorizontalform-in-yesod/29645557#29645557", "title": "use BootstrapHorizontalForm in yesod", "body": "<p>This looks like a missing import. Check that you actually import <code>CpmSm</code> at the top of your file.</p>\n\n<p>This import could be of the form:</p>\n\n<pre><code>import Yesod.Form.Bootstrap3 (BootstrapGridOptions (ColSm))\n</code></pre>\n\n<p>or </p>\n\n<pre><code>import Yesod.Form.Bootstrap3 (BootstrapGridOptions (..))\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>import Yesod.Form.Bootstrap3\n</code></pre>\n\n<p>If that doesn't sound familiar, you can take a look at <a href=\"http://learnyouahaskell.com/modules\" rel=\"nofollow\">the modules chapter from <em>Learn Yourself a Haskell</em></a> to know more about imports.</p>\n"}], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 29645557, "answer_count": 1, "score": 0, "last_activity_date": 1429087361, "creation_date": 1429050320, "question_id": 29638444, "link": "https://stackoverflow.com/questions/29638444/use-bootstraphorizontalform-in-yesod", "title": "use BootstrapHorizontalForm in yesod", "body": "<p>I intend use a BootstrapHorizontalForm, use how example this <a href=\"http://hackage.haskell.org/package/yesod-form-1.4.3.1/docs/Yesod-Form-Bootstrap3.html#t:BootstrapFormLayout\" rel=\"nofollow\">guide</a>, my code:</p>\n\n<p>the form</p>\n\n<pre><code>churchForm :: Maybe Church -&gt; AForm Handler (Church,Maybe FileInfo)\nchurchForm mc = (,) &lt;$&gt;\n(Church\n &lt;$&gt; areq textField (bfs MsgName) (churchName &lt;$&gt; mc)\n &lt;*  bootstrapSubmit (BootstrapSubmit MsgCreateAction \"btn-default\" [(\"attribute-name\",\"attribute-value\")])\n</code></pre>\n\n<p>the GET method</p>\n\n<pre><code>getChurchNewR :: Handler Html\ngetChurchNewR = do\n(widget, enctype) &lt;- generateFormPost $\n                   renderBootstrap3 (BootstrapHorizontalForm (ColSm 0) (ColSm 4) (ColSm 0) (ColSm 6))\n                   (churchForm Nothing)\n  defaultLayout $ do\n    msgAction = MsgCreateAction\n    actionR = ChurchNewR\n    mPath = Nothing\n$(widgetFile \"church/church\")\n</code></pre>\n\n<p>but have this error:</p>\n\n<blockquote>\n  <p>Handler/Church.hs:63:67: Not in scope: data constructor \u2018ColSm\u2019</p>\n</blockquote>\n\n<p>thanks for you help</p>\n"}, {"tags": ["haskell", "parameters"], "answers": [{"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 0, "last_activity_date": 1429049953, "creation_date": 1429049953, "answer_id": 29638363, "question_id": 29638222, "link": "https://stackoverflow.com/questions/29638222/haskell-overwriting-parameters-causes-unexpected-behaviours/29638363#29638363", "title": "Haskell - Overwriting parameters causes unexpected behaviours", "body": "<p>You are (apparently accidentally) using the list monad. In Python, your snippet would be expressed as:</p>\n\n<pre><code>for list in [elem, elem, elem] + list:\n    yield elem\n</code></pre>\n\n<p>That is, you create a list containing one <code>elem</code> for each item in the list, plus three more. </p>\n\n<p>Here's what you probably intended:</p>\n\n<pre><code>someFunc list elem = do\n    list &lt;- return (elem:elem:elem:list)\n    return elem\n</code></pre>\n\n<p>This just creates a new <code>list</code> variable shadowing your old one, and completely ignores it to return <code>elem</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1429050111, "creation_date": 1429050111, "answer_id": 29638394, "question_id": 29638222, "link": "https://stackoverflow.com/questions/29638222/haskell-overwriting-parameters-causes-unexpected-behaviours/29638394#29638394", "title": "Haskell - Overwriting parameters causes unexpected behaviours", "body": "<p>You can't assign a new value to <code>list</code>, what's happening is the <code>list</code> on the left of the <code>&lt;-</code> is different than the <code>list</code> on the right of the <code>&lt;-</code>.  If you turn on warnings with <code>-Wall</code> you'll see</p>\n\n<pre><code>&lt;interactive&gt;:13:19: Warning:\n    This binding for `elem' shadows the existing binding\n      imported from `Prelude' (and originally defined in `GHC.List')\n\n&lt;interactive&gt;:14:7: Warning:\n    This binding for `list' shadows the existing binding\n      bound at &lt;interactive&gt;:13:14\n\n&lt;interactive&gt;:14:7: Warning: Defined but not used: `list'\n</code></pre>\n\n<p>You aren't using the name <code>list</code> defined by <code>list &lt;- ...</code>, just defining it so that it happens to shadow the existing binding.</p>\n\n<p>The reason <code>someFunc [] 'a'</code> returns <code>\"aaa\"</code> is due to how the list monad works.  This do notation would be equivalent to</p>\n\n<pre><code>someFunc list e = (e:e:e:list) &gt;&gt;= \\l -&gt; return e\n</code></pre>\n\n<p>And for lists, <code>&gt;&gt;=</code> is essentially <code>concatMap</code>, so you have</p>\n\n<pre><code>someFunc list e = concatMap (\\l -&gt; return e) (e:e:e:list)\n</code></pre>\n\n<p>So substituting in <code>[]</code> for <code>list</code> and <code>'a'</code> for <code>e</code> we get</p>\n\n<pre><code>someFunc [] 'a' = concatMap (\\l -&gt; return 'a') \"aaa\"\n                = concat $ map (\\l -&gt; return 'a') \"aaa\"\n                = concat [['a'], ['a'], ['a']]\n                = ['a', 'a', 'a']\n                = \"aaa\"\n</code></pre>\n\n<p>Your confusion probably comes from the use of <code>return</code>.  In most languages <code>return</code> is a keyword, but in Haskell it's just a function.  It does not exit a function call early, all it does is wrap a value in the context of the monad you're in.  For lists <code>return x = [x]</code>, that's the entire definition.  Additionally, in Haskell you can't reassign values, but you can shadow them with a new definition.  If you always compile with <code>-Wall</code> and <code>-Werror</code> though, you'll keep yourself from having this problem.</p>\n"}, {"comments": [{"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "edited": false, "score": 0, "creation_date": 1429077524, "post_id": 29638416, "comment_id": 47426344, "body": "The desugaring goes <code>someFunc list elem = (elem:elem:elem:list) &gt;&gt;= (\\list -&gt; return elem)</code> ; no new vairable <code>x</code> is introduced by the desugaring."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "edited": false, "score": 0, "creation_date": 1429079518, "post_id": 29638416, "comment_id": 47427178, "body": "@GPhilip Thanks, updated. I initially kept that as <code>x</code> to make sure that OP understands that is not the same <code>list</code> as the input value."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 4, "last_activity_date": 1429079457, "last_edit_date": 1429079457, "creation_date": 1429050214, "answer_id": 29638416, "question_id": 29638222, "link": "https://stackoverflow.com/questions/29638222/haskell-overwriting-parameters-causes-unexpected-behaviours/29638416#29638416", "title": "Haskell - Overwriting parameters causes unexpected behaviours", "body": "<p>Note that your function will be de-sugared into this:</p>\n\n<pre><code>someFunc :: [b] -&gt; b -&gt; [b]\nsomeFunc list elem = (elem:elem:elem:list) &gt;&gt;= \\list -&gt; return elem\n</code></pre>\n\n<p>Now note that the <code>list</code> in <code>\\list -&gt; return elem</code> is different from the input <code>list</code> you pass to the function.</p>\n\n<p>Now see how the Monad instance for list is defined:</p>\n\n<pre><code>instance Monad [] where  \n    return x = [x]  \n    xs &gt;&gt;= f = concat (map f xs)  \n    fail _ = []  \n</code></pre>\n\n<p>So, your code is translated to this form finally:</p>\n\n<pre><code>someFunc list elem = concat $ map (\\list -&gt; return elem) (elem:elem:elem:list)\n</code></pre>\n\n<p>Now can you understand why you are getting that output ? </p>\n\n<p><code>someFunc [] 'a'</code> will get be applied like this:</p>\n\n<pre><code>concat $ map (\\list -&gt; return 'a') ('a':'a':'a':[])\nconcat $ [['a'],['a'],['a']]\n'a':'a':'a':[]\n\"aaa\"\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 3387666, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/100005135101168/picture?type=large", "display_name": "user3387666", "link": "https://stackoverflow.com/users/3387666/user3387666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1429079457, "creation_date": 1429049340, "question_id": 29638222, "link": "https://stackoverflow.com/questions/29638222/haskell-overwriting-parameters-causes-unexpected-behaviours", "title": "Haskell - Overwriting parameters causes unexpected behaviours", "body": "<p>I wrote a simple function</p>\n\n<pre><code>someFunc list elem = do\n    list &lt;- elem:elem:elem:list\n    return elem\n</code></pre>\n\n<p>Now, when i'm using it, i'm getting output like this</p>\n\n<pre><code>*Main&gt; someFunc [] 'a'\n\"aaa\"\n</code></pre>\n\n<p>Despite the fact, that this function has no practical use, why does it happen? Why does editing list have any effect in <code>elem</code>? And how to assign new value to <code>list</code> avoiding this situation?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429051022, "post_id": 29638177, "comment_id": 47419270, "body": "I get the same output that you do, so it&#39;s at least reproducible.  I know there were changes made to how <code>Typeable</code> works in 7.10 (IIRC all types now implement <code>Typeable</code> automatically), but I don&#39;t know how this plays into it.  I don&#39;t think it&#39;s a change to <code>tyConPackage</code> since that&#39;s actually a record field, and <code>typeRepTyCon</code> is basically the same thing, just a field accessor.  That leaves <code>typeOf</code> as the culprit, but this calls a built-in <code>typeRep#</code> on a <code>Proxy# (Map Int Int)</code>, which means the culprit is further down."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429051155, "post_id": 29638177, "comment_id": 47419320, "body": "You could use <code>tyConModule</code>, but that only gets <code>Data.Map.Base</code>, which probably isn&#39;t enough to really build documentation on top of haddock.  The typeable stuff in the latest version of <code>containers</code> for the <code>Map</code> type looks like it&#39;s relying on C to build the actual <code>Typeable</code> instance.  Hopefully someone can come along who knows more than I do and can shed some light on what&#39;s actually going on, though."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429051447, "post_id": 29638177, "comment_id": 47419411, "body": "the garbled name is indeed the file name (&quot;cabal install&quot; prints it after &quot;Installing library in&quot;, and indeed, files are there) There must be a way to get to the package name? (&quot;ghc-pkg list&quot; can do this)."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429106295, "post_id": 29638177, "comment_id": 47444315, "body": "@bheklilr this &quot;containers&quot; is only an example - I actually need this for my own packages (several of them, documentation merged together by standalone-haddock), and I always use &quot;deriving Typeable&quot;, so it must be something inside ghc that changed. I&#39;ll add more info to the question."}], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1433348360, "creation_date": 1429049118, "last_edit_date": 1429110703, "question_id": 29638177, "link": "https://stackoverflow.com/questions/29638177/tyconpackage-changed-from-ghc-7-8-to-ghc-7-10", "title": "tyConPackage changed from ghc-7.8 to ghc-7.10?", "body": "<p>This ghci session</p>\n\n<pre><code>import Data.Map\nimport Data.Typeable\ntyConPackage $  typeRepTyCon $  typeOf $ fromList [(1,2)]\n</code></pre>\n\n<p>gives </p>\n\n<pre><code>in ghc-7.8.4: \"containers-0.5.5.1\"\nin ghc-7.10.1: \"conta_47ajk3tbda43DFWyeF3oHQ\"\n</code></pre>\n\n<p>the new behaviour breaks my application, as I use this string\nto programmatically construct documentation URLs (pointing to html built by standalone-haddock)</p>\n\n<p>Is there a way to get back the old behaviour? Some work-around?</p>\n\n<p>--</p>\n\n<p>I did some more research and found (ghc/compiler/basicTypes/Module.lhs):</p>\n\n<p>7.8.4 (compiler/typecheck/TcGenDeriv builds the instance and) uses</p>\n\n<pre><code>-- | Essentially just a string identifying a package, including the version: e.g. parsec-1.0\nnewtype PackageId = PId FastString deriving( Eq, Typeable )\n</code></pre>\n\n<p>7.10.1 (compiler/deSugar/DsBinds constructs the evidence(?) and) uses</p>\n\n<pre><code>-- | A string which uniquely identifies a package.  For wired-in packages,\n-- it is just the package name, but for user compiled packages, it is a hash.\nnewtype PackageKey = PId FastString deriving( Eq, Typeable )\n</code></pre>\n\n<p>Well, \"uniquely identify\" is nice, but ...</p>\n\n<p>--</p>\n\n<p>On the other hand, ghci somehow knows the (ungarbled) package name:</p>\n\n<pre><code>import Data.Map ; :i Map\ndata Map k a = containers-0.5.5.1:Data.Map.Base.Bin ...\n</code></pre>\n\n<p>but that's at compile time - I still hope this info is available at runtime someplace.</p>\n"}, {"tags": ["arrays", "haskell", "split", "aggregate"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2494447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c8db0fa0009e3fcebc192c929ca7d3?s=128&d=identicon&r=PG", "display_name": "Joss Steward", "link": "https://stackoverflow.com/users/2494447/joss-steward"}, "edited": false, "score": 0, "creation_date": 1429050609, "post_id": 29638258, "comment_id": 47419115, "body": "Thanks! I wound up doing (roughly): <code>isInChuck t1 t2 = 0.1 &gt; abs (t1 - t2)</code>, since I wanted to group with more granularity than that.  This definitely sent me down the right path though."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 27, "user_id": 2494447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c8db0fa0009e3fcebc192c929ca7d3?s=128&d=identicon&r=PG", "display_name": "Joss Steward", "link": "https://stackoverflow.com/users/2494447/joss-steward"}, "edited": false, "score": 0, "creation_date": 1429050685, "post_id": 29638258, "comment_id": 47419144, "body": "@user2494447 That&#39;s what I was aiming for.  I didn&#39;t think this solution would work directly out of the box for you since I wasn&#39;t quite sure how you were representing time, but I hoped seeing <code>groupBy</code> in action would push you in the right direction."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 2, "last_activity_date": 1429049514, "creation_date": 1429049514, "answer_id": 29638258, "question_id": 29637990, "link": "https://stackoverflow.com/questions/29637990/split-array-into-chunks-based-on-timestamp-in-haskell/29638258#29638258", "title": "Split array into chunks based on timestamp in Haskell", "body": "<p>If you have <code>[Record]</code> and you want to group them by a specific condition, you can use <code>Data.List.groupBy</code>.  I'm assuming that for your <code>time :: Double</code>, 1 second is the base unit, so <code>time = 1</code> is 1 second, <code>time = 100</code> is 100 seconds, etc, so adjust this to whatever system you're actually using:</p>\n\n<pre><code>import Data.List\nimport Data.Function (on)\n\nisInSameClockSecond :: Record -&gt; Record -&gt; Bool\nisInSameClockSecond = (==) `on` (floor . time :: Record -&gt; Integer)\n-- The type signature is given for floor . time to remove any ambiguity\n-- due to floor's polymorphic type signature.\n\ngroupBySameClockSecond :: [Record] -&gt; [[Record]]\ngroupBySameClockSecond = groupBy isInSameClockSecond\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 2494447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c8db0fa0009e3fcebc192c929ca7d3?s=128&d=identicon&r=PG", "display_name": "Joss Steward", "link": "https://stackoverflow.com/users/2494447/joss-steward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 1, "accepted_answer_id": 29638258, "answer_count": 1, "score": 2, "last_activity_date": 1429049514, "creation_date": 1429048124, "question_id": 29637990, "link": "https://stackoverflow.com/questions/29637990/split-array-into-chunks-based-on-timestamp-in-haskell", "title": "Split array into chunks based on timestamp in Haskell", "body": "<p>I have an array of records (custom data type) in Haskell which I want to aggregate based on a each records' timestamp.  In very general terms each record looks like this: </p>\n\n<pre><code>data Record = Record { event :: String, \n                       time :: Double, \n                       from :: Int, \n                       to :: Int \n                     } deriving (Show, Eq)\n</code></pre>\n\n<p>I used a Double for the timestamp since that is the same format used in the tracefile.</p>\n\n<p>And I parse them from a CSV file into an array of records: <code>[Record]</code></p>\n\n<p>Now I'm looking to get an approximation of instantaneous events / time.  So I want to split the array into several arrays based on the timestamp (say. every 1 seconds) and then fold across each smaller array.</p>\n\n<p>The problem is I can't figure out how to split an array based on the value of a record.  Looking on Hoogle I found several functions like <code>splitEvery</code> and <code>splitWhen</code>, but I'm lost.  I considered using <code>splitWhen</code> to break up the list when, say, <code>(mod time 0.1) == 0</code>, but even if that worked it would remove the elements it's splitting on (which I don't want to do).</p>\n\n<p>I should note that the records are NOT evenly spaced in time.  E.g. the timestamp on sequential records is not going to differ by a fixed amount.</p>\n\n<p>I am more than willing to store the data in a different format if you can suggest one that would make this sort of work easier.</p>\n\n<p>A quick sample of the data I'm parsing (from a ns2 simulation):</p>\n\n<pre><code>r 0.114 1 2 tcp 1000 ________ 2 1.0 5.0 0 2\nr 0.240 1 2 tcp 1000 ________ 2 1.0 5.0 0 2\nr 0.914 2 1 tcp 1000 ________ 2 5.0 1.0 0 3\n</code></pre>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1429027642, "post_id": 29632194, "comment_id": 47406972, "body": "Monomorphism restriction?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429027643, "post_id": 29632194, "comment_id": 47406974, "body": "Have you tried turning off the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">dreaded monomorphism restriction</a> with <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code> at the top of your file?"}, {"owner": {"reputation": 63, "user_id": 4075387, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A3PHcDX-Zlk/AAAAAAAAAAI/AAAAAAAAAKU/rsxiG8UMdQY/photo.jpg?sz=128", "display_name": "Richard Fergie", "link": "https://stackoverflow.com/users/4075387/richard-fergie"}, "edited": false, "score": 0, "creation_date": 1429027999, "post_id": 29632194, "comment_id": 47407193, "body": "That fixes it! Thank you both"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1429028294, "post_id": 29632194, "comment_id": 47407368, "body": "@MathematicalOrchid Do we have a &quot;canonical&quot; answer for the DMR?  We should close this as a duplicate to help funnel these questions to a single answer since this is such a hard problem to google when you don&#39;t know about the DMR already."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1429029125, "post_id": 29632194, "comment_id": 47407926, "body": "@bheklilr It&#39;s a VFAQ, but I&#39;m not sure about an actual canonical answer..."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1429029268, "post_id": 29632194, "comment_id": 47408012, "body": "@bheklilr, MathematicalOrchid Maybe this should be the canonical answer: <a href=\"http://stackoverflow.com/a/7055932/1651941\">stackoverflow.com/a/7055932/1651941</a>"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1429029384, "post_id": 29632194, "comment_id": 47408093, "body": "@Sibi That one looks good to me.  MathematicalOrchid, RichardFergie, do you agree that it looks acceptable?  If everyone agrees we can mark this question as a duplicate."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1429031800, "post_id": 29632194, "comment_id": 47409411, "body": "@Sibi It looks like your suggestion is popular, with at least 4 people agreeing with it (including yourself).  I&#39;ll go ahead and mark the duplicate, if someone disagrees then they can comment here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1429031807, "post_id": 29632194, "comment_id": 47409418, "body": "@bheklilr The problem with finding a canonical answer may also lie on being difficult to find a canonical question. From a quick search, no one ever asked exactly &quot;What is the DMR?&quot;. That being said, the answer suggested by Sibi looks as a great &quot;canonical&quot; answer to DMR questions."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1429032034, "post_id": 29632194, "comment_id": 47409547, "body": "@chi That is precisely why I attempted to have a short discussion about what would be a good answer to use.  The problem is that many questions that seem unrelated all have the same answer, and I think it would be best to start funneling all of those questions into a single good answer.  pigworker&#39;s answer on the linked post is thorough enough, old enough, and liked enough to be a good candidate.  I don&#39;t think we can necessarily stop people from asking the questions, but if we mark them all as a duplicate of the same question then it&#39;ll be better than the current state of affairs."}], "owner": {"reputation": 63, "user_id": 4075387, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A3PHcDX-Zlk/AAAAAAAAAAI/AAAAAAAAAKU/rsxiG8UMdQY/photo.jpg?sz=128", "display_name": "Richard Fergie", "link": "https://stackoverflow.com/users/4075387/richard-fergie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1429031841, "answer_count": 0, "score": 2, "last_activity_date": 1429027581, "creation_date": 1429027581, "question_id": 29632194, "link": "https://stackoverflow.com/questions/29632194/parsec-specifying-numeric-type-too-narrowly", "closed_reason": "Duplicate", "title": "Parsec specifying numeric type too narrowly", "body": "<p>I have the following haskell file:</p>\n\n<pre><code>import Text.ParserCombinators.Parsec\nimport Text.ParserCombinators.Parsec.Number\n\nparseF = floating\n</code></pre>\n\n<p>Loading up in ghci I get the following:</p>\n\n<pre><code>*Main&gt; :t floating\nfloating :: Floating f =&gt; CharParser st f\n*Main&gt; :t parseFloating\nparseFloating :: CharParser st Double\n</code></pre>\n\n<p>How can it be that the types are different?</p>\n\n<p>And how can I stop this from happening?</p>\n"}, {"tags": ["haskell", "functional-programming", "continuation-passing"], "answers": [{"comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 2, "creation_date": 1428996643, "post_id": 29619088, "comment_id": 47387046, "body": "I&#39;d rather use the type signature <code>index :: Eq a =&gt; a -&gt; [a] -&gt; (Int -&gt; r) -&gt; r</code>. By keeping the result type of the continuation unspecified, you have less freedom to make mistakes while letting the types guide you."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1428997005, "post_id": 29619088, "comment_id": 47387220, "body": "@kosmikus true, maybe I assumed the <code>Int</code> to early ;) - you think it would be clearer if I rewrite it?"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1428987540, "last_edit_date": 1428987540, "creation_date": 1428984956, "answer_id": 29619088, "question_id": 29618967, "link": "https://stackoverflow.com/questions/29618967/haskell-continuation-passing-style-index-of-element-in-list/29619088#29619088", "title": "Haskell Continuation passing style index of element in list", "body": "<p>first let me show you a possible implementation:</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; (Int -&gt; Int) -&gt; Int\nindex _ [] _  = error \"not found\"\nindex x (x':xs) cont\n  | x == x'   = cont 0\n  | otherwise = index x xs (\\ind -&gt; cont $ ind + 1)\n</code></pre>\n\n<p>if you prefer point-free style:</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; (Int -&gt; Int) -&gt; Int\nindex _ [] _  = error \"not found\"\nindex x (x':xs) cont\n  | x == x'   = cont 0\n  | otherwise = index x xs (cont . (+1))\n</code></pre>\n\n<h3>how it works</h3>\n\n<p>The <strong>trick</strong> is to use the <em>continuations</em> to <em>count up</em> the indices - those continuations will get the <em>index to the right</em> and just increment it.</p>\n\n<p>As you see this will cause an error if it cannot find the element.</p>\n\n<h3>examples:</h3>\n\n<pre><code>\u03bb&gt; index 1 [1,2,3] id\n0\n\u03bb&gt; index 2 [1,2,3] id\n1\n\u03bb&gt; index 3 [1,2,3] id\n2\n\u03bb&gt; index 4 [1,2,3] id\n*** Exception: not found\n</code></pre>\n\n<h3>how I figured it out</h3>\n\n<p>A good way to figure out stuff like this is by first writing down the recursive call with the continuation:</p>\n\n<pre><code>useCont a (x:xs) cont = useCont a xs (\\valFromXs -&gt; cont $ ??)\n</code></pre>\n\n<p>And now you have to think about what you want <code>valFromXs</code> to be (as a <em>type</em> and as a value) - but remember your typical <strong>start</strong> (as here) will be to make the first <em>continuation</em> <code>id</code>, so the <em>type</em> can only be <code>Int -&gt; Int</code>. So it should be clear that we are talking about of index-transformation here. As <code>useCont</code> will only know about the tail <code>xs</code> in the next call it seems natural to see this index as <strong>relative to <code>xs</code></strong> and from here the rest should follow rather quickly.</p>\n\n<p>IMO this is just another instance of </p>\n\n<blockquote>\n  <p>Let the types guide you Luke</p>\n</blockquote>\n\n<p>;)</p>\n\n<h3>remarks</h3>\n\n<p>I don't think that this is a typical use of <em>continuations</em> in Haskell.</p>\n\n<p>For once you can use an <strong>accumulator</strong> argument for this as well (which is conceptional simpler):</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; Int -&gt; Int\nindex _ [] _  = error \"not found\"\nindex x (x':xs) ind\n  | x == x'    = ind\n  | otherwise = index x xs (ind+1)\n</code></pre>\n\n<p>or (<a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/Data-OldList.html#elemIndex\">see List.elemIndex</a>) you can use Haskells laziness/list-comprehensions to make it look even nicer:</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; Int\nindex x xs = head [ i | (x',i) &lt;- zip xs [0..], x'== x ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1429019784, "post_id": 29626425, "comment_id": 47401362, "body": "As a one-liner: <code>index x xs s f = foldr (\\x&#39; r i -&gt; if x == x&#39; then s i else r (succ i)) (const f) xs 0</code>"}], "tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": false, "score": 4, "last_activity_date": 1429011836, "creation_date": 1429011836, "answer_id": 29626425, "question_id": 29618967, "link": "https://stackoverflow.com/questions/29618967/haskell-continuation-passing-style-index-of-element-in-list/29626425#29626425", "title": "Haskell Continuation passing style index of element in list", "body": "<p>If you have a value <code>a</code> then to convert it to CPS style you replace it with something like <code>(a -&gt; r) -&gt; r</code> for some unspecified <code>r</code>. In your case, the base function is <code>index :: Eq a =&gt; a -&gt; [a] -&gt; Maybe Int</code> and so the CPS form is</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; (Maybe Int -&gt; r) -&gt; r\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; (Int -&gt; r) -&gt; r -&gt; r\n</code></pre>\n\n<p>Let's implement the latter.</p>\n\n<pre><code>index x as success failure =\n</code></pre>\n\n<p>Notably, there are two continuations, one for the successful result and one for a failing one. We'll apply them as necessary and induct on the structure of the list just like usual. First, clearly, if the <code>as</code> list is empty then this is a failure</p>\n\n<pre><code>  case as of\n    []      -&gt; failure\n    (a:as') -&gt; ...\n</code></pre>\n\n<p>In the success case, we're, as normal, interested in whether <code>x == a</code>. When it is true we pass the success continuation the index <code>0</code>, since, after all, we found a match at the <code>0</code>th index of our input list.</p>\n\n<pre><code>  case as of\n    ...\n    (a:as') | x == a    -&gt; success 0\n            | otherwise -&gt; ...\n</code></pre>\n\n<p>So what happens when we don't yet have a match? If we were to pass the success continuation in unchanged then it would, assuming a match is found, eventually be called with <code>0</code> as an argument. This loses information about the fact that we've attempted to call it once already, though. We can rectify that by modifying the continuation</p>\n\n<pre><code>  case as of\n    ...\n    (a:as') ...\n            | otherwise -&gt; index x as' (fun idx -&gt; success (idx + 1)) failure\n</code></pre>\n\n<p>Another way to think about it is that we have the collect \"post\" actions in the continuation since ultimately the result of the computation will pass through that code</p>\n\n<pre><code>-- looking for the value 5, we begin by recursing\n1 :\n    2 :\n        3 :\n            4 :\n                5 : _ -- match at index 0; push it through the continuation\n                0     -- lines from here down live in the continuation\n            +1\n        +1\n    +1\n+1\n</code></pre>\n\n<p>This might be even more clear if we write the recursive branch in pointfree style</p>\n\n<pre><code>            | otherwise -&gt; index x as' (success . (+1)) failure\n</code></pre>\n\n<p>which shows how we're modifying the continuation to include one more increment for each recursive call. All together the code is</p>\n\n<pre><code>index :: Eq a =&gt; a -&gt; [a] -&gt; (Int -&gt; r) -&gt; r -&gt; r\nindex x as success failure\n  case as of\n    [] -&gt; failure\n    (a:as') | x == a    -&gt; success 0\n            | otherwise -&gt; index x as' (success . (+1)) failure\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 2752688, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/05086d0902f0913681f554f9e3e04110?s=128&d=identicon&r=PG&f=1", "display_name": "Teddy Black", "link": "https://stackoverflow.com/users/2752688/teddy-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 961, "favorite_count": 1, "accepted_answer_id": 29619088, "answer_count": 2, "score": 5, "last_activity_date": 1429011836, "creation_date": 1428984189, "last_edit_date": 1428985317, "question_id": 29618967, "link": "https://stackoverflow.com/questions/29618967/haskell-continuation-passing-style-index-of-element-in-list", "title": "Haskell Continuation passing style index of element in list", "body": "<p>There's a series of examples I'm trying to do to practice Haskell. I'm currently learning about continuation passing, but I'm a bit confused as to how to implement a function like <em>find index of element in list</em> that works like this:</p>\n\n<pre><code>index 3 [1,2,3] id = 2\n</code></pre>\n\n<p>Examples like factorial made sense since there wasn't really any processing of the data other than multiplication, but in the case of the index function, I need to compare the element I'm looking at with the element I'm looking for, and I just can't seem to figure out how to do that with the function parameter. </p>\n\n<p>Any help would be great.</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1428979847, "post_id": 29618031, "comment_id": 47381383, "body": "1) If all you&#39;re trying to read is numbers, and a large number of them, Parsec wouldn&#39;t be my first choice. Parsec is good for consuming human produced input of reasonable size. It&#39;s not a good fit (nor hugely beneficial) to consume huge amounts of completely uniform data 2) If you wanna stream, don&#39;t attempt to read the entire file at once using utility functions like parseFromFile. 3) Consider not putting all your 50 GB of data into a single file. Data of that magnitude is usually better kept in databases."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1428980856, "post_id": 29618031, "comment_id": 47381623, "body": "@Cubic, not wedded to <code>parseFromFile</code>. The question is about if there is any way of doing streaming within parsec - I just copied <code>parseFromFile</code> example to explain the problem. Also, regarding db thing - the parser is the loader to parse and generate data for the db :) Size is all relative, maybe :) I will split the file if it turns out parsec or attoparsec don&#39;t work well at that size."}], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1429020982, "post_id": 29625075, "comment_id": 47402227, "body": "so perhaps hand-roll the input for attoparsec as documented here, to limit the memory (instead of keeping all the data - makes sense to throw away the successfully parsed data): <a href=\"http://newartisans.com/2012/08/parsing-with-haskell-and-attoparsec/\" rel=\"nofollow noreferrer\">newartisans.com/2012/08/parsing-with-haskell-and-attoparsec</a> . Or may be it has been superseded by something else in attoparsec library like <code>takeWhile1</code> ?"}, {"owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1429042343, "post_id": 29625075, "comment_id": 47415301, "body": "@Sal No, I think you still have to do what they are writing about in that blog post. If you, for example, want to parse a log file, you can write a parser for a single line in the log file, and run that parser on just one line at a time. I might be able to write up an example tomorrow if you want."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 1, "creation_date": 1429053026, "post_id": 29625075, "comment_id": 47419877, "body": "yep, I got the gist. Basically, parse one chunk at a time. I will try out a solution myself. Since each unit of valid input is supposed to be small, say constant space, it should be fine, I guess."}], "tags": [], "owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "is_accepted": true, "score": 3, "last_activity_date": 1429162176, "last_edit_date": 1592644375, "creation_date": 1429007500, "answer_id": 29625075, "question_id": 29618031, "link": "https://stackoverflow.com/questions/29618031/streaming-reads-and-writes-in-parsec/29625075#29625075", "title": "Streaming reads and writes in Parsec", "body": "<p><a href=\"https://hackage.haskell.org/package/parsec\" rel=\"nofollow noreferrer\">Parsec</a> is generally focused on smaller amounts of complicated data. Think programming and markup languages, difficult binary formats and such. This has two effects:</p>\n<ol>\n<li>It is optimised for error messages (needed with complicated data) over performance (not needed with small amounts of data)</li>\n<li>It doesn't do streaming parsing (again, not needed with small amounts of data)</li>\n</ol>\n<p><a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow noreferrer\">Attoparsec</a> takes the opposite approach: it's focused on large amounts of (comparatively) simple data. Think mining log files, reading measurement values, collecting a stream of data from the internet and such. This has two effects:</p>\n<ol>\n<li>It is optimised for performance over error messages</li>\n<li>It is built around streaming</li>\n</ol>\n<p>The principle behind streaming parsing with Attoparsec is that you choose to parse something, and when it has consumed all your input, it will return a value which indicates it's expecting to be fed more input.</p>\n<blockquote>\n<p>Note well, however, a huge file might still take up huge amounts of memory even when you use Attoparsec to parse it. This is because Attoparsec (as opposed to Parsec) always backtracks when it fails to match a parser, so it can't throw away &quot;already parsed&quot; data because it might be needed later.</p>\n<p>The solution to this is, as hinted in the comments, to write a parser for only a single section of your data (something like a line of a log file) and then run that parser repeatedly from Haskell code for each line of your log file. This allows parsing to take constant space.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1429033829, "post_id": 29632177, "comment_id": 47410515, "body": "Hmm, that will make sense. Doesn&#39;t the current attoparsec library has that support through <code>Partial</code> continuation? If that is not the case, and if you know of a toy example somewhere, pointers will be very much appreciated."}, {"owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 1, "creation_date": 1429042246, "post_id": 29632177, "comment_id": 47415250, "body": "@Sal The <code>Partial</code> return value does not contain a partial parse, only the continuation function that you need to feed with more input. Only the <code>Done</code> return value contains actual output."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 0, "last_activity_date": 1429027520, "creation_date": 1429027520, "answer_id": 29632177, "question_id": 29618031, "link": "https://stackoverflow.com/questions/29618031/streaming-reads-and-writes-in-parsec/29632177#29632177", "title": "Streaming reads and writes in Parsec", "body": "<blockquote>\n  <p>Given parseFromFile signature, it doesn't seem we can stream lazily and pipe the output to an output file until we have seen all of the input. [...] So, it seems in order to determine whether there is an error or not, it will need the whole input. If I am not mistaken, the code can't write the output until it has seen all the input.</p>\n</blockquote>\n\n<p>This is all equally true of Attoparsec as of Parsec. While Attoparsec gives you more control over the incremental consumption of input, it still gives parsers no way to express incremental production of output. The parser has to run to completion before it can report success, and the only way to get at the parser's output is via the data constructor that represents the fact that the parser succeeded.</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 29625075, "answer_count": 2, "score": 0, "last_activity_date": 1429162176, "creation_date": 1428977197, "last_edit_date": 1428982765, "question_id": 29618031, "link": "https://stackoverflow.com/questions/29618031/streaming-reads-and-writes-in-parsec", "title": "Streaming reads and writes in Parsec", "body": "<p>Given a <code>Parser</code> in <code>parsec</code> library, what is a good way to do streaming read (from input file) and write (appending parsed blob/line to an output file). Below is an example from <code>Text.Parsec.ByteString</code>:</p>\n\n<pre><code>main    = do{ result &lt;- parseFromFile numbers \"digits.txt\"\n             ; case result of\n                 Left err  -&gt; print err\n                 Right xs  -&gt; print (sum xs)\n             }\n</code></pre>\n\n<p>The above example only reads from \"digits.txt\", and won't have the output until it has seen all the input. Let us assume that instead of collecting all the values and doing a reduction (<code>sum</code>) above, we want to write all <code>xs</code> out to \"digitsOut.txt\" in streaming way (read lines from digits.txt and write out to digitsOut.txt). Given <code>parseFromFile</code> signature, it doesn't seem we can stream lazily and pipe the output to an output file until we have seen all of the input. This is the type signature:</p>\n\n<pre><code>parseFromFile :: Parser a -&gt; String -&gt; IO (Either ParseError a)\n</code></pre>\n\n<p>So, it seems in order to determine whether there is an error or not, it will need the whole input. If I am not mistaken, the code can't write the output until it has seen all the input. Is there another way to do streaming input and output using <code>Parsec</code> (and not <code>AttoParsec</code> if it can be avoided - I will like to have access to error reporting of <code>Parsec</code>). The file that I am trying to parse is huge (50+GB). So, I need to hook up the parser code with streaming input and output. If there is a good example somewhere, pointers will be appreciated.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Just found from <code>AttoParsec</code> <a href=\"https://hackage.haskell.org/package/attoparsec-0.8.0.2/docs/Data-Attoparsec.html\" rel=\"nofollow\">documentation</a> that <code>Parsec</code> can't consume input incrementally. So, there is no way to do streaming in <code>Parsec</code>. I will now refactor the parser to <code>AttoParsec</code>.</p>\n"}, {"tags": ["haskell", "artificial-intelligence", "alpha-beta-pruning"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1428977775, "post_id": 29617817, "comment_id": 47380946, "body": "I can&#39;t look at this much longer :). It&#39;s getting late. Can you stop calling maxGame and tell me what the printout of <code>map (\\mv -&gt; ...</code> is? And perhaps give the definitions of <code>Move</code>, <code>Coord</code>, and <code>Game</code>."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1428981364, "post_id": 29617817, "comment_id": 47381754, "body": "It seems unlikely that <code>evalNaive</code> would return 0 everywhere, and that&#39;s the only place you assign a new value to <code>v</code>. Your <code>node</code> and <code>helper</code> functions look correct. Set the depth to 1, and try running like that. Print some <code>eval</code> results. It looks like it may be somewhere in the <code>alphaBeta</code> definition. I&#39;m not quite sure what this does: <code>map (\\mv -&gt; (abMinNode 4 (-100) 100 (move g mv), mv)) (nextMoves g)</code>. I&#39;m not a Haskell expert at all, but I&#39;m interested :)."}, {"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1428982491, "post_id": 29617817, "comment_id": 47382054, "body": "So basically my functions for a given max node / min node will only return an integer for the score that it found, since that&#39;s all you care about except for the very first move. So before I kick off the recursion, I do it differently at the top level. That lambda takes each move and gives you a tuple of its score and the move itself (so you can remember what the move was).  So actually the first level isn&#39;t doing any AB pruning."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1428982917, "post_id": 29617817, "comment_id": 47382139, "body": "I think something is missing. It&#39;s really odd that you&#39;re getting a 0 when only evalNaive sets it. Try printing the game and eval at each horizon node."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1428990377, "post_id": 29617817, "comment_id": 47384122, "body": "OK, man. By some madness, I have converted the above to only integers, and called alphaBeta (with an integer in place of a game): <a href=\"http://pastie.org/10091140\" rel=\"nofollow noreferrer\">pastie.org/10091140</a>. The result is as I would expect - I get a value back equal to what evalNaive returns. I simply returned 64 in evalNaive, and that is the answer I get. The recursion is fine. Please just have evalNaive return 64, and see if that actually gets returned instead of 0 in your code. The move function may also be a problem (perhaps it wipes the board)."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1428990501, "post_id": 29617817, "comment_id": 47384176, "body": "Another idea is to replace nextMoves with a simpler function that just returns an array of moves, though I doubt that the error lies in nextMoves."}, {"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429025553, "post_id": 29617817, "comment_id": 47405561, "body": "When I get home, I will do that with evalNaive function and also post some more code.  I am actually planning on putting the project on github, so that may be more useful for this purpose as well.  My move function returns a Maybe Game, where a Nothing means that the move was not legal.  I have tested it pretty thoroughly so I don&#39;t believe it can wipe the board."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429060470, "post_id": 29617817, "comment_id": 47421822, "body": "Did you get anywhere? Edit: Just saw your update to your post."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429060568, "post_id": 29617817, "comment_id": 47421851, "body": "I can&#39;t really tell much unless you post the rest of your code. The algorithm you gave works for me at any depth (try my code)."}, {"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429062020, "post_id": 29617817, "comment_id": 47422179, "body": "<a href=\"https://github.com/zcleghern/hchess\" rel=\"nofollow noreferrer\">github.com/zcleghern/hchess</a> Full code here"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429127459, "post_id": 29617817, "comment_id": 47458637, "body": "I can&#39;t seem to find the definition for <code>loop</code> anywhere, or a description about it in the standard library. Where is it defined?"}, {"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429131321, "post_id": 29617817, "comment_id": 47460871, "body": "It is a hacky way to write clean-looking &quot;loops&quot; with a fold. The code I pushed to github appears to not be up to date so it may not be there.  I&#39;ll get the latest version on there this afternoon."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429150417, "post_id": 29617817, "comment_id": 47467655, "body": "I see the updates, but I still don&#39;t see the loop definition."}], "owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1406, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1429055823, "creation_date": 1428975743, "last_edit_date": 1429055823, "question_id": 29617817, "link": "https://stackoverflow.com/questions/29617817/alpha-beta-prune-for-chess-always-returning-the-first-move-in-the-list", "title": "Alpha Beta prune for chess always returning the first move in the list", "body": "<p>I am writing a minimax algorithm with alpha-beta pruning for chess and cannot get the algorithm to return anything but the first move that it generates.  I have been knocking my head against but cannot figure out what is going wrong.  The code is a bit messy and in dire need of refactoring, but maybe you can see something that I am not.</p>\n\n<p>I have verified that my evalNaive' function works as expected (very simple, just evaluate the board based on material).</p>\n\n<pre><code>alphaBeta :: Game -&gt; Move\nalphaBeta g = maxGame $ map (\\mv -&gt; (abMinNode 4 (-100) 100 (move g mv), mv)) (nextMoves g)\n        where maxGame = snd . foldr foldingF (-100, Move (Coord 1 1) (Coord 1 1))\n              foldingF x y = if fst x &lt; fst y then y else x\n\nabMaxNode :: Int -&gt; Int -&gt; Int -&gt; Maybe Game -&gt; Int\nabMaxNode 0 a b (Just (Game brd _ trn)) = evalNaive' brd trn\nabMaxNode d a b (Just g) = abMaxHelper d (-100) a b g $ nextMoves g\n\nabMaxHelper :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Game -&gt; [Move] -&gt; Int\nabMaxHelper d v a b g [] = v\nabMaxHelper d v a b g (x:xs)\n        | b &lt;= newA = v\n        | otherwise = abMaxHelper d newV newA b g xs\n                where newV = max v (abMinNode (d - 1) a b (move g x))\n                      newA = max a newV\n\nabMinNode :: Int -&gt; Int -&gt; Int -&gt; Maybe Game -&gt; Int\nabMinNode 0 a b (Just (Game brd _ trn)) = evalNaive' brd trn\nabMinNode d a b (Just g) = abMinHelper d 100 a b g $ nextMoves g \n\nabMinHelper :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Game -&gt; [Move] -&gt; Int\nabMinHelper d v a b g [] = v\nabMinHelper d v a b g (x:xs)\n        | newB &lt;= a = v\n        | otherwise = abMinHelper d newV a newB g xs\n                where newV = min v (abMaxNode (d - 1) a b (move g x))\n                      newB = min b newV\n\n\nnextMoves :: Game -&gt; [Move]\nnextMoves g = filterLegal $ concatMap (possibleMoves g) allSpaces\n        where filterLegal = foldr (\\cur lst -&gt; case move g cur of\n                Nothing -&gt; lst\n                _ -&gt; cur:lst) []\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Definitions for some of my data types:</p>\n\n<pre><code>data Coord = Coord Int Int deriving (Eq)\ndata Move = Move Coord Coord deriving (Eq)\ndata Game = Game Board Flags Color deriving (Eq)\n</code></pre>\n\n<p>where Flags is a list of strings telling you things like for example white's queenside rook can castle, and Color is the color of whose turn it is.</p>\n\n<p>EDIT2:</p>\n\n<p>Here are the results of calling alphaBeta minus maxGame $, yielding the list of tuples containing scores and the moves that got them:</p>\n\n<p>(A coordinate (x,y) is the x file and y rank)</p>\n\n<pre><code>Just [(0,(1,7) =&gt; (1,6)),\n      (0,(1,7) =&gt; (1,5)),\n      (0,(2,7) =&gt; (2,6)),\n      (0,(2,7) =&gt; (2,5)),\n      (0,(2,8) =&gt; (1,6)),\n      (0,(2,8) =&gt; (3,6)),\n      (0,(3,7) =&gt; (3,6)),\n      (0,(3,7) =&gt; (3,5)),\n      (0,(4,7) =&gt; (4,6)),\n      (0,(4,7) =&gt; (4,5)),\n      (0,(5,7) =&gt; (5,6)),\n      (0,(5,7) =&gt; (5,5)),\n      (0,(6,7) =&gt; (6,6)),\n      (0,(6,7) =&gt; (6,5)),\n      (0,(7,7) =&gt; (7,6)),\n      (0,(7,7) =&gt; (7,5)),\n      (0,(7,8) =&gt; (6,6)),\n      (0,(7,8) =&gt; (8,6)),\n      (0,(8,7) =&gt; (8,6)),\n      (0,(8,7) =&gt; (8,5))]\n</code></pre>\n\n<p>As you can see, they are all coming back as 0. Knowing that evalNaive' works, the issue is somewhere in the recursive functions.</p>\n\n<p>EDIT3:\nRan the same code with a depth of 5 and got this list of potential moves:</p>\n\n<pre><code>[(-1,(1,7) =&gt; (1,6)),\n(-1,(1,7) =&gt; (1,5)),\n(-1,(2,7) =&gt; (2,6)),\n(-3,(2,7) =&gt; (2,5)),\n(-3,(2,8) =&gt; (1,6)),\n(-1,(2,8) =&gt; (3,6)),\n(-1,(3,7) =&gt; (3,6)),\n(-3,(3,7) =&gt; (3,5)),\n(-1,(4,7) =&gt; (4,6)),\n(-2,(4,7) =&gt; (4,5)),\n(-1,(5,7) =&gt; (5,6)),\n(-1,(5,7) =&gt; (5,5)),\n(-1,(6,7) =&gt; (6,6)),\n(-2,(6,7) =&gt; (6,5)),\n(-1,(7,7) =&gt; (7,6)),\n(-3,(7,7) =&gt; (7,5)),\n(-1,(7,8) =&gt; (6,6)),\n(-1,(7,8) =&gt; (8,6)),\n(-1,(8,7) =&gt; (8,6)),\n(-1,(8,7) =&gt; (8,5))]\n</code></pre>\n\n<p>so it appears that the first move it encounters is the best as far as my algorithm can tell.  Am I not going deep enough into the search tree to get anything meaningful?</p>\n"}, {"tags": ["haskell", "arrows"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428972115, "post_id": 29617075, "comment_id": 47379519, "body": "Have you looked at <code>ArrowApply</code>?"}, {"owner": {"reputation": 497, "user_id": 1061164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c356956ff982d6d9cf0dd6ebfcb33ecb?s=128&d=identicon&r=PG", "display_name": "Dr DR", "link": "https://stackoverflow.com/users/1061164/dr-dr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428972437, "post_id": 29617075, "comment_id": 47379601, "body": "ArrowApply does solve the problem of multiple arguments, however it brings the additional power of partial application / closures into the mix as well..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 7, "creation_date": 1428973404, "post_id": 29617075, "comment_id": 47379841, "body": "To be honest, I&#39;m not sure I understand the question. Since functions are in fact arrows (there is an <code>instance Arrow (-&gt;)</code>) it is clear that arrows generalize functions. So what does &quot;true generalization&quot; mean? What would have to be the case for arrows to be a &quot;true&quot; generalization of functions?"}, {"owner": {"reputation": 497, "user_id": 1061164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c356956ff982d6d9cf0dd6ebfcb33ecb?s=128&d=identicon&r=PG", "display_name": "Dr DR", "link": "https://stackoverflow.com/users/1061164/dr-dr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428973671, "post_id": 29617075, "comment_id": 47379915, "body": "I admit the question might not make sense and might reflect a misunderstanding on my part. I couldn&#39;t see how composition of arrows of multiple arguments was supported by the Arrow interface, but as the answers below point out, it&#39;s not a problem, just construct an arrow <code>Arrow (a,b) c</code>  and compose away. I thought this was cheating in a sense because it depends on lifting a certain kind of function (one that takes a tuple) into the Arrow but I guess that&#39;s not really a problem."}, {"owner": {"reputation": 497, "user_id": 1061164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c356956ff982d6d9cf0dd6ebfcb33ecb?s=128&d=identicon&r=PG", "display_name": "Dr DR", "link": "https://stackoverflow.com/users/1061164/dr-dr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1429152278, "post_id": 29617075, "comment_id": 47468162, "body": "@Daniel Wagner I meant &quot;true generalization&quot; in an informal sense of &quot;Does the generalization capture everything we want it to?&quot;. I know Haskell defines the function type as an instance of the Arrow type class. For whatever reason however, it didn&#39;t occur to me that explicitly defining an Arrow whose input type is a tuple is perfectly reasonable, just as declaring functions with a tuple as an argument (i.e. non-curried multi-argument functions) is valid. Do you think I should reword the question?"}], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 1061164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c356956ff982d6d9cf0dd6ebfcb33ecb?s=128&d=identicon&r=PG", "display_name": "Dr DR", "link": "https://stackoverflow.com/users/1061164/dr-dr"}, "edited": false, "score": 1, "creation_date": 1428973911, "post_id": 29617354, "comment_id": 47379964, "body": "The nested arrow approach requires ArrowApply but as you point out all I really need is an arrow accepting a tuple. I&#39;ve accepted Bergi&#39;s answer only because it was more explicit about the nested arrow requiring an apply function to evaluate."}], "tags": [], "owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "is_accepted": false, "score": 6, "last_activity_date": 1428972174, "last_edit_date": 1495540418, "creation_date": 1428972174, "answer_id": 29617354, "question_id": 29617075, "link": "https://stackoverflow.com/questions/29617075/are-arrows-a-true-generalization-of-functions/29617354#29617354", "title": "Are Arrows a true generalization of functions?", "body": "<p>You can think of the function with type</p>\n\n<pre><code>f :: a -&gt; b -&gt; c\n</code></pre>\n\n<p>as a function that takes a value of type <code>a</code> and produces another function of type <code>b -&gt; c</code>. In other words,</p>\n\n<pre><code>f :: a -&gt; (b -&gt; c)\n</code></pre>\n\n<p>The generalization to arrows is pretty straightforward:</p>\n\n<pre><code>f :: Arrow a (Arrow b c)\n</code></pre>\n\n<p>In order to do function composition with multiple variables, you have to do some crazy semantics-fu with the <code>(.)</code> operator, or <code>(&lt;&lt;&lt;)</code> for arrows. The same reason that <a href=\"https://stackoverflow.com/questions/13426417/how-do-i-re-write-a-haskell-function-of-two-argument-to-point-free-style\">makes functions with multiple arguments pointfree cumbersome</a> hinders the syntax from expressing arrows in this way, which is why there are so many combinators for using tuples. Also, nothing's stopping you from defining an arrow that maps a tuple to a value. The <code>arr</code> function turns arbitrary functions into arrows!</p>\n\n<pre><code>f :: (a, b) -&gt; c\naf :: Arrow (a, b) c\naf = arr f\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 497, "user_id": 1061164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c356956ff982d6d9cf0dd6ebfcb33ecb?s=128&d=identicon&r=PG", "display_name": "Dr DR", "link": "https://stackoverflow.com/users/1061164/dr-dr"}, "edited": false, "score": 1, "creation_date": 1428974534, "post_id": 29617510, "comment_id": 47380108, "body": "I had it stuck in my mind for some reason that constructing an arrow with an explicit tuple type as input was somehow cheating but I realize this is business as usual. As you point out, the curried approach requires ArrowApply which increases the power of the Arrow type significantly: they could now be constructed dyamically just like functions in lambda calculus."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 9, "last_activity_date": 1428973371, "creation_date": 1428973371, "answer_id": 29617510, "question_id": 29617075, "link": "https://stackoverflow.com/questions/29617075/are-arrows-a-true-generalization-of-functions/29617510#29617510", "title": "Are Arrows a true generalization of functions?", "body": "<blockquote>\n  <p>I can't see how they can generalize functions of multiple arguments that return a single result</p>\n</blockquote>\n\n<p>Just let the input type be a tuple, and the output a plain value. For example, take the arrow</p>\n\n<pre><code>plus :: a (num, num) num\nlet plus = arr (\\(a, b) -&gt; a + b) -- arr (uncurry (+))\n</code></pre>\n\n<p>Alternatively, you can take \"nested arrows\" - a curried function with multiple arguments is nothing but a function that returns a function. So we'd have an arrow whose result is another arrow:</p>\n\n<pre><code>plus :: a num (a num num)\nlet plus = arr (arr . (+))\n</code></pre>\n\n<p>and to use that, we need an <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Arrow.html#g:6\" rel=\"noreferrer\"><code>ArrowApply</code></a> instance. First, you'd combine the arrow with an other arrow that creates the second argument from your input</p>\n\n<pre><code>plusWithIncrement :: a num (a num num, num)\nlet plusWithIncrement = plus &amp;&amp;&amp; arr (+1)\n</code></pre>\n\n<p>and then you could run that</p>\n\n<pre><code>plusWithIncrement &gt;&gt;&gt; app :: a num num\n</code></pre>\n\n<p>(which is an overcomplicated way of writing <code>arr (\\x -&gt; x + (x+1))</code>)</p>\n"}], "owner": {"reputation": 497, "user_id": 1061164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c356956ff982d6d9cf0dd6ebfcb33ecb?s=128&d=identicon&r=PG", "display_name": "Dr DR", "link": "https://stackoverflow.com/users/1061164/dr-dr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 3, "accepted_answer_id": 29617510, "answer_count": 2, "score": 11, "last_activity_date": 1428973371, "creation_date": 1428970137, "question_id": 29617075, "link": "https://stackoverflow.com/questions/29617075/are-arrows-a-true-generalization-of-functions", "title": "Are Arrows a true generalization of functions?", "body": "<p>Arrows are often described as generalization of functions (statically generated functions only, i.e. there's no support for partial application / closures). However, at least looking at Arrows as they are modeled in Haskell, I can't see how they can generalize functions of multiple arguments that return a single result (a result that in general might not be a tuple). I'm trying to envision how using just the arrows interface one could arrive at a composition of arrows that produces a single result that in general might not be a tuple. Is there a way to do this or is this a deliberate limitation on the power of the Arrow type? </p>\n\n<p>From what I understand arrows provide the ability to compose static (possibly parallel) pipelines but they can't 'fold' the tuples of outputs into a single final result. Am wrong or I missing something?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1428970012, "post_id": 29616836, "comment_id": 47379017, "body": "Adding a functional dependency states that one type is <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow noreferrer\">uniquely determined by another</a>. I believe you need to either remove one of the instances of <code>Typical a Typ</code> or create specific instances for each possible variation of your combined instance."}, {"owner": {"reputation": 20544, "user_id": 1073695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dca512cb7914943d46461d0bbbacd5a?s=128&d=identicon&r=PG", "display_name": "Jo So", "link": "https://stackoverflow.com/users/1073695/jo-so"}, "reply_to_user": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 2, "creation_date": 1428970202, "post_id": 29616836, "comment_id": 47379066, "body": "@Mokosha: The functional dependency is <code>a -&gt; b</code>, not <code>b -&gt; a</code>, so I don&#39;t think instances must be removed. I don&#39;t think I got the second part of your last sentence."}], "answers": [{"comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 1, "creation_date": 1429022609, "post_id": 29617091, "comment_id": 47403439, "body": "<code>ScopedTypeVariables</code> is the right way to get what you want. Otherwise, variables in the local type annotations are all implicitly quantified. Independently, if you never need the actual value of the first argument of <code>typical</code>, it&#39;s probably better to use a proxy: <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Proxy.html#t:Proxy\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 20544, "user_id": 1073695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dca512cb7914943d46461d0bbbacd5a?s=128&d=identicon&r=PG", "display_name": "Jo So", "link": "https://stackoverflow.com/users/1073695/jo-so"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1429027603, "post_id": 29617091, "comment_id": 47406950, "body": "@kosmikus: Thanks. After following that reference I have the impression that <code>Data.Reflection</code> does what I tried to construct here."}], "tags": [], "owner": {"reputation": 20544, "user_id": 1073695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dca512cb7914943d46461d0bbbacd5a?s=128&d=identicon&r=PG", "display_name": "Jo So", "link": "https://stackoverflow.com/users/1073695/jo-so"}, "is_accepted": true, "score": 5, "last_activity_date": 1429019582, "last_edit_date": 1429019582, "creation_date": 1428970302, "answer_id": 29617091, "question_id": 29616836, "link": "https://stackoverflow.com/questions/29616836/haskell-ambiguous-type-variable/29617091#29617091", "title": "Haskell - Ambiguous type variable", "body": "<p>Ok, I have a solution, but I don't know if this is the cleanest workaround.</p>\n\n<p>Adding <code>{-# LANGUAGE ScopedTypeVariables #-}</code> makes the code compile. This makes it possible to identify <code>a0</code> with <code>a</code> from the error message (corresponding to the <code>a</code>s from the last two lines of the code).</p>\n\n<p>Please comment!</p>\n"}], "owner": {"reputation": 20544, "user_id": 1073695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dca512cb7914943d46461d0bbbacd5a?s=128&d=identicon&r=PG", "display_name": "Jo So", "link": "https://stackoverflow.com/users/1073695/jo-so"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 29617091, "answer_count": 1, "score": 8, "last_activity_date": 1429019582, "creation_date": 1428968555, "question_id": 29616836, "link": "https://stackoverflow.com/questions/29616836/haskell-ambiguous-type-variable", "title": "Haskell - Ambiguous type variable", "body": "<p>I couldn't find an answer to my question among several ambiguous type variable error questions.</p>\n\n<p>Basically I want to take type information to the value level. The last line in this example fails.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE TypeOperators #-}\n\nmodule Test where\n\ndata Typ = TInteger | TString deriving Show\n\ndata Empty = Empty\ndata a ## b = Cons a b\n\nclass Typical a b | a -&gt; b where\n    typical :: a -&gt; b\n\ninstance Typical Empty [Typ] where\n    typical _ = []\n\ninstance Typical Integer Typ where\n    typical _ = TInteger\n\ninstance Typical String Typ where\n    typical _ = TString\n\ninstance (Typical a Typ, Typical b [Typ]) =&gt; Typical (a ## b) [Typ] where\n    typical _ = typical (undefined :: a) : typical (undefined :: b)\n</code></pre>\n\n<p>Here is the first error message:</p>\n\n<pre><code>Test.hs:27:17:\nCould not deduce (Typical a0 Typ) arising from a use of `typical'\nfrom the context (Typical a Typ, Typical b [Typ])\n  bound by the instance declaration at Test.hs:26:10-67\nThe type variable `a0' is ambiguous\nPossible fix: add a type signature that fixes these type variable(s)\nNote: there are several potential instances:\n  instance Typical String Typ -- Defined at Test.hs:23:10\n  instance Typical Integer Typ -- Defined at Test.hs:20:10\nPossible fix: add an instance declaration for (Typical a0 Typ)\nIn the first argument of `(:)', namely `typical (undefined :: a)'\nIn the expression:\n  typical (undefined :: a) : typical (undefined :: b)\nIn an equation for `typical':\n    typical _ = typical (undefined :: a) : typical (undefined :: b)\n</code></pre>\n\n<p>I just don't get it.</p>\n\n<p>What is <code>a0</code> here? Could it be that the <code>a</code> from my last line is not identified with that from the 2nd last line?</p>\n\n<p>Where should I put a type signature and why?</p>\n\n<p>Please enlighten me!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1428959104, "post_id": 29614987, "comment_id": 47375427, "body": "<code>x &lt;- xs !! c</code> works only if <code>xs !! c</code> is a list."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 1076739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08bc0fa0f62b72c6079a359db6ca70e?s=128&d=identicon&r=PG", "display_name": "Anubhaw Arya", "link": "https://stackoverflow.com/users/1076739/anubhaw-arya"}, "edited": false, "score": 0, "creation_date": 1428971613, "post_id": 29615105, "comment_id": 47379395, "body": "So, I&#39;m still learning Haskell and I&#39;m not entirely familiar with the jargon yet (namely <code>::</code>).  From my understanding, you&#39;re saying that e needs to be a list of arbitrary elements, but since <code>ys!!c</code> is of type char, and not a list, it essentially won&#39;t work?  Therefore, by using <code>let</code>, we can force x and y to be variables.  Is my understanding correct?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 145, "user_id": 1076739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08bc0fa0f62b72c6079a359db6ca70e?s=128&d=identicon&r=PG", "display_name": "Anubhaw Arya", "link": "https://stackoverflow.com/users/1076739/anubhaw-arya"}, "edited": false, "score": 2, "creation_date": 1428971792, "post_id": 29615105, "comment_id": 47379434, "body": "@AnubhawArya You can pronounce <code>::</code> as &quot;has type&quot;. You are correct in your second sentence. <code>x</code> and <code>y</code> are variables whether you bind them with <code>let</code> or <code>&lt;-</code>; the difference is that <code>let</code> simply gives another name for an expression whereas <code>&lt;-</code> also has some less trivial meaning: <code>x &lt;- e</code> allows <code>x</code> to take on each of the values that are elements of the list <code>e</code> in sequence."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1428959228, "creation_date": 1428959228, "answer_id": 29615105, "question_id": 29614987, "link": "https://stackoverflow.com/questions/29614987/set-builder-notation-error-for-my-own-zip-implementation/29615105#29615105", "title": "Set builder notation error for my own zip implementation", "body": "<p>To a first approximation:  </p>\n\n<p>If <code>e::[a]</code>,<br>\nand <code>x &lt;- e</code> appears to the right of the <code>|</code> in a list comprehension,<br>\nthen <code>x :: a</code> wherever it is bound.</p>\n\n<p>This leads to a bit of a problem in your case. You have <code>ys :: [Char]</code> and <code>c :: Int</code>, so that <code>ys!!c :: Char</code>. Hence:</p>\n\n<p>We have <code>ys!!c :: Char</code><br>\nand <code>y &lt;- ys!!c</code> appears to the right of the <code>|</code> in a list comprehension,<br>\nso <code>y :: ???</code> wherever it is bound.</p>\n\n<p>But now we are stuck when trying to write the conclusion about what type <code>y</code> should have: <code>Char</code> is not a list of <code>a</code>s, no matter what <code>a</code> we pick.</p>\n\n<p>There are several possible fixes; one is to use <code>let</code> instead of <code>&lt;-</code>, as in</p>\n\n<pre><code>ziplike xs ys = [(x,y)|c&lt;-[0..min (length xs) (length ys)-1],let x=xs!!c; y=ys!!c]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 1076739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08bc0fa0f62b72c6079a359db6ca70e?s=128&d=identicon&r=PG", "display_name": "Anubhaw Arya", "link": "https://stackoverflow.com/users/1076739/anubhaw-arya"}, "edited": false, "score": 0, "creation_date": 1428971785, "post_id": 29615110, "comment_id": 47379432, "body": "Would you mind explaining that one paragraph about Cartesian products? I didn&#39;t really understand it :("}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 145, "user_id": 1076739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08bc0fa0f62b72c6079a359db6ca70e?s=128&d=identicon&r=PG", "display_name": "Anubhaw Arya", "link": "https://stackoverflow.com/users/1076739/anubhaw-arya"}, "edited": false, "score": 1, "creation_date": 1429116118, "post_id": 29615110, "comment_id": 47451625, "body": "The <a href=\"http://en.wikipedia.org/wiki/Cartesian_product\" rel=\"nofollow noreferrer\">Cartesian product</a> of [1,2,3] and [4,5,6] is the set of pairs [(1,4), (1,5), (1,6), (2,4), (2,5), (2,6), (3,4), (3,5), (3,6)]. You can obtain this Cartesian product in Haskell by writing <code>[(x, y) | x &lt;- [1,2,3], y &lt;- [4, 5, 6]]</code>. A Cartesian product of two sets, A and B, has cardinality <code>|A &#215; B| = |A| |B|</code>, the product of the cardinalities of A and B. If one of the sets contains only one element, like <code>{1, 2, 3} &#215; {4}</code>, then there will be 3 elements to the resulting list and you can think of the adjoined 4 as a &quot;local variable&quot;."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 4, "last_activity_date": 1429130067, "last_edit_date": 1429130067, "creation_date": 1428959238, "answer_id": 29615110, "question_id": 29614987, "link": "https://stackoverflow.com/questions/29614987/set-builder-notation-error-for-my-own-zip-implementation/29615110#29615110", "title": "Set builder notation error for my own zip implementation", "body": "<p>It's a type error.</p>\n\n<p>When you write \"x from xs get-index c\" (i.e. <code>x &lt;- xs !! c</code>) the thing that you are getting \"from\" <code>xs !! c</code> is not necessarily a list. It's a technical detail, but it's important. The \"from\" arrow comes from monad syntax/<code>do</code>-notation. A list comprehension is actually just a do-expression specialized to the List monad; so the right hand side of an arrow <code>&lt;-</code> needs to be a list in the List monad.</p>\n\n<p>You can fix this, first off, by \"cheating\" with singleton lists, a la:</p>\n\n<pre><code>ziplike xs ys = [ (x,y) | c &lt;- [0 .. min (length xs) (length ys) - 1], \n                          x &lt;- [xs !! c], \n                          y &lt;- [ys !! c]]\n</code></pre>\n\n<p>So these left-arrows are not \"let\" variable bindings, but they make Cartesian products: but the Cartesian product of n things with 1 thing with 1 thing is just <code>n * 1 * 1 == n</code> things. So this is great, if a little weird and possibly inefficient.</p>\n\n<p>To do what you were trying to do (bind x and y inside of the list comprehension) you could also write something like:</p>\n\n<pre><code>ziplike xs ys = [let x = xs !! c; y = ys !! c in (x, y) \n                | c &lt;- [0 .. min (length xs) (length ys) - 1]]\n-- or --\nziplike xs ys = [(x, y) \n                | c &lt;- [0 .. min (length xs) (length ys) - 1],\n                  let x = xs !! c, let y = ys !! c]\n-- or --\nziplike xs ys = [(x, y) \n                | c &lt;- [0 .. min (length xs) (length ys) - 1],\n                  let x = xs !! c; y = ys !! c]\n</code></pre>\n\n<p>Notice that these are all do-notation ideas tacked together with commas. Of course all of these look more clumsy than</p>\n\n<pre><code>ziplike xs ys = [(xs !! c, ys !! c) | c &lt;- [0..min (length xs) (length ys) - 1]\n</code></pre>\n\n<p>which does the exact same thing.</p>\n\n<p>With that said, all of this stuff is <strong>much</strong> more inefficient than the <code>zip</code> function's recursive character: if I double the size of the list, your implementations take 4 times as long to process the whole list; <code>zip</code> only takes twice as long. So be mindful of this \"hidden O(n<sup>2</sup>) factor\" in your programming.</p>\n"}], "owner": {"reputation": 145, "user_id": 1076739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08bc0fa0f62b72c6079a359db6ca70e?s=128&d=identicon&r=PG", "display_name": "Anubhaw Arya", "link": "https://stackoverflow.com/users/1076739/anubhaw-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 29615110, "answer_count": 2, "score": 1, "last_activity_date": 1429130067, "creation_date": 1428958744, "question_id": 29614987, "link": "https://stackoverflow.com/questions/29614987/set-builder-notation-error-for-my-own-zip-implementation", "title": "Set builder notation error for my own zip implementation", "body": "<p>So I'm learning haskell right now, and I'm having trouble understanding what I'm doing wrong for the following function that emulates <code>zip</code></p>\n\n<p>1.<code>ziplike xs ys = [(x,y)|c&lt;-[0..(min (length xs) (length ys))-1],x&lt;-xs!!c,y&lt;-ys!!c]</code></p>\n\n<p>2.<code>ziplike xs ys = [(xs!!c,ys!!c)|c&lt;-[0..(min (length xs) (length ys))-1]]\n</code></p>\n\n<p>Now, I know that the correct answer is number 2, but I don't understand why number 1 is wrong for the call <code>ziplike [1,2,3] ['a', 'b', 'c', 'd']</code>. I THINK it's because it's trying to select the index for an individual char, but I'm not sure why.</p>\n\n<p>The error is \"Couldn't match expected type \u2018[t1]\u2019 with actual type \u2018Char\u2019\"</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1428959091, "post_id": 29614416, "comment_id": 47375420, "body": "I&#39;ll note that using State is not the idiomatic way to memoize in Haskell, neither is it the way to get elegant DP. This question you&#39;re referring to as the &quot;easy/slow way&quot; does in fact have quite a few answers that use the idiomatic DP way to achieve very good performance... Do you want to use State to learn how to use it or are you more interested by efficient DP in Haskell ?"}, {"owner": {"reputation": 230, "user_id": 3892459, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca3ee1b7e4b9fdc61ca36496aa447618?s=128&d=identicon&r=PG&f=1", "display_name": "teryret", "link": "https://stackoverflow.com/users/3892459/teryret"}, "reply_to_user": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1428959530, "post_id": 29614416, "comment_id": 47375591, "body": "Both, but the other way was already covered pretty well.  Do you have a sense for why this isn&#39;t idiomatic?Edit: also, I wasn&#39;t referring that question as being the easy/slow way, I was referring to a naive non-DP implementation as the easy/slow way."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428960390, "post_id": 29614416, "comment_id": 47376035, "body": "just out of curiosity: what would be an acceptable speed for you? I simple (non-monadic) version where I am passing a strict Map around runs in 4.5sec on my rig - is this to slow for you?"}, {"owner": {"reputation": 230, "user_id": 3892459, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca3ee1b7e4b9fdc61ca36496aa447618?s=128&d=identicon&r=PG&f=1", "display_name": "teryret", "link": "https://stackoverflow.com/users/3892459/teryret"}, "edited": false, "score": 0, "creation_date": 1428960895, "post_id": 29614416, "comment_id": 47376265, "body": "My slow version doesn&#39;t even involve a map,  it&#39;s simply  collatzSlow :: Int -&gt; [Int]    and then  maximum $ map (\\a -&gt; (length $ collatzSlow a, a)) [1..999999].  Edit:  It seems the reason my naive code was slow was that I was running it in the repl.  cabal repl it took 128.5 seconds, but cabal run took merely 1.5 seconds"}, {"owner": {"reputation": 230, "user_id": 3892459, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca3ee1b7e4b9fdc61ca36496aa447618?s=128&d=identicon&r=PG&f=1", "display_name": "teryret", "link": "https://stackoverflow.com/users/3892459/teryret"}, "edited": false, "score": 0, "creation_date": 1428961319, "post_id": 29614416, "comment_id": 47376452, "body": "Woah, that&#39;s interesting, the fast version (as enabled by Daniel) takes 18 sec in the repl and 2.8 with a regular run!  Why the naive version is faster in run mode I don&#39;t even begin to understand."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1428957328, "creation_date": 1428957328, "answer_id": 29614585, "question_id": 29614416, "link": "https://stackoverflow.com/questions/29614416/project-euler-14-using-the-state-monad/29614585#29614585", "title": "project euler 14 using the state monad", "body": "<p>You might like</p>\n\n<pre><code>mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\n</code></pre>\n\n<p>In particular, <code>mapM collatzFast :: [Int] -&gt; State (Map Int Int) [Int]</code>.</p>\n"}], "owner": {"reputation": 230, "user_id": 3892459, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca3ee1b7e4b9fdc61ca36496aa447618?s=128&d=identicon&r=PG&f=1", "display_name": "teryret", "link": "https://stackoverflow.com/users/3892459/teryret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 29614585, "answer_count": 1, "score": 2, "last_activity_date": 1428957328, "creation_date": 1428956662, "last_edit_date": 1495542129, "question_id": 29614416, "link": "https://stackoverflow.com/questions/29614416/project-euler-14-using-the-state-monad", "title": "project euler 14 using the state monad", "body": "<p>I'm trying to teach myself Haskell (again) by working through Project Euler.  Question 14 (<a href=\"https://projecteuler.net/problem=14\" rel=\"nofollow noreferrer\">https://projecteuler.net/problem=14</a>) is begging for dynamic programming and historically I've been vehemently anti-monad (on account of repeatedly failing to learn to use them well enough to make life easier instead of harder) so I'm trying to bite the bullet and use the State monad to memoize my code... it's not going well.  I want to be clear, I've already solved the problem the easy/slow way, at this point I'm trying to learn something (ie <a href=\"https://stackoverflow.com/questions/18534989/project-euler-no-14-haskell\">Project Euler No. 14 Haskell</a> is not what I'm looking for).</p>\n\n<p>My code so far is:</p>\n\n<pre><code>collatzMemoCheck :: Int -&gt; State (Map Int Int) Int\ncollatzMemoCheck n = state $ \\s -&gt; maybe (let (a, s') = runState (collatzFast n) s\n                                          in (a+1, Map.insert n (a+1) s'))\n                                         (\\len -&gt; (len, s))\n                                         (Map.lookup n s)\n\ncollatzFast :: Int -&gt; State (Map Int Int) Int\ncollatzFast 1 = state $ \\_ -&gt; (1, Map.singleton 1 1)\ncollatzFast n\n  | even n    = collatzMemoCheck (n `quot` 2)\n  | otherwise = collatzMemoCheck (3 * n + 1)\n</code></pre>\n\n<p>which works for individual queries in cabal repl, but for the life of me I can't figure out how to chain up the state of repeated calls to collatzFast.  I want something like</p>\n\n<pre><code>-- DOES NOT WORK\nallCollatzLengths = scanl (&gt;&gt;= collatzFast) (return Map.empty) [1..999999]\n</code></pre>\n\n<p>but I think this is inside out.  Bind takes the result portion of the previous State computation and passes it to the next call, but I want it to take the state portion of the previous State computation and pass <em>it</em> to the next call.</p>\n\n<p>Is there a right way to do this or have I painted myself into a corner?  If I can't use >>=, what's the point of having a monad?  ... or is there no point because this is a stupid approach?  Help?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1428942250, "post_id": 29610242, "comment_id": 47366070, "body": "Functions are not an instance of <code>Show</code>, so they can&#39;t be printed for visualization."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 2, "creation_date": 1428950673, "post_id": 29610242, "comment_id": 47370880, "body": "I just wanted to add that: you&#39;ve got the right intuition that <code>compose</code> is just a domain-restriction of <code>flip map</code>. (As others have said, the problem is that if you write <code>(+3)</code> into the console you will generate the same error because GHC does not know a canonical way to print the function <code>\\x -&gt; x + 3</code>.)"}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "edited": false, "score": 1, "creation_date": 1428962388, "post_id": 29610242, "comment_id": 47376926, "body": "The type of your example and the declared type of <code>compose</code> do not match. In particular: in your example the second argument to compose is <code>(+1)</code>, while the second argument of <code>compose</code> has the declared type <code>((u -&gt; t) -&gt; (u -&gt; y))</code>. And <code>(+1)</code> definitely does not have this latter type. You should probably try to first get the type of compose to be what you want it to be."}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "edited": false, "score": 0, "creation_date": 1428962823, "post_id": 29610242, "comment_id": 47377091, "body": "The way the example is currently written, the primary problem is not that functions can&#39;t be printed. It is somewhat more basic. Namely, that there is no type which is both a <code>Num</code> <i>and</i> a function from <code>Num</code> to <code>Num</code> . As currently written, the type of <code>compose [(+2),(+3)] (+1)</code> is  <code>(Num (y -&gt; y), Num y) =&gt; [y -&gt; y]</code> !!"}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "edited": false, "score": 0, "creation_date": 1428963183, "post_id": 29610242, "comment_id": 47377216, "body": "This is a hint that merely <code>map</code>ping a function over a list of functions is <i>probably</i> not what you want to do."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 6, "last_activity_date": 1428952494, "last_edit_date": 1428952494, "creation_date": 1428942266, "answer_id": 29610300, "question_id": 29610242, "link": "https://stackoverflow.com/questions/29610242/trying-to-create-a-function-that-maps-another-function-into-a-function-list/29610300#29610300", "title": "Trying to create a function that maps another function into a function list", "body": "<p>There isn't a way to intelligently convert a function to a string, which is what the error message you see here is saying.  There isn't a <code>Show</code> instance for functions, and you need a <code>Show</code> instance to see output in GHCi.  When you create a function in Haskell the compiler turns it into low level commands, you don't have the original function definition preserved in metadata or anything.  You wouldn't be able to see <code>(+1) . (+2)</code> become <code>(+3)</code>, it just isn't how Haskell functions work.</p>\n\n<p>Instead you could assign it to a name:</p>\n\n<pre><code>&gt; let fs = compose [(+2)] (+1)\n</code></pre>\n\n<p>Then apply values to it</p>\n\n<pre><code>&gt; map ($ 10) fs\n[13]\n</code></pre>\n\n<p>If you want to be able to turn something like <code>(+2)</code> and <code>(+1)</code> into <code>(+3)</code>, you'll need to create your own data type.  This means that the functions you can represent are severely limited in what they can do unless you define very generic behavior.  For simple functions on <code>Int</code>s, you could do</p>\n\n<pre><code>data ArithFunc\n    = Add Int\n    | Subtract Int\n    | Multiply Int\n    | ModBy Int\n    | Abs\n    | Negate\n    | Compose ArithFunc ArithFunc\n    deriving (Eq, Show)\n</code></pre>\n\n<p>Then you could write a custom compose operator:</p>\n\n<pre><code>toFunction :: ArithFunc -&gt; (Int -&gt; Int)\ntoFunction (Add x) = (+x)\ntoFunction (Subtract x) = subtract x\ntoFunction (Multiply x) = (*x)\ntoFunction (ModBy x) = (`mod` x)\ntoFunction Abs = abs\ntoFunction Negate = negate\ntoFunction (Compose f1 f2) = toFunction f1 . toFunction f2\n\ninfixr 9 #\n(#) :: ArithFunc -&gt; ArithFunc -&gt; ArithFunc\nf1 # f2 = simplify $ Compose f1 f2\n\ninfixr 0 $$\n($$) :: ArithFunc -&gt; Int -&gt; Int\nf $$ x = toFunction f x\n\nsimplify (Compose (Add x) (Add y)) = Add (x + y)\nsimplify (Compose (Add x) (Subtract y)) = Add (x - y)\n-- Continue adding simplification rules as desired\n\ncompose :: [ArithFunc] -&gt; (ArithFunc -&gt; ArithFunc) -&gt; [ArithFunc]\ncompose l f = map (simplify . f) l\n</code></pre>\n\n<p>Then you could write</p>\n\n<pre><code>&gt; compose [Add 2] (Add 1)\n[Add 3]\n&gt; map ($$ 10) $ compose [Add 2] (Add 1)\n[13]\n</code></pre>\n\n<p>And this solution is of no where near complete, you would really need to define <code>simplify</code> in such a way that it continues to simplify nested <code>Compose</code> constructs until no change was made, there needs to be more rules for simplification, there are other operations that could be represented, resulting in a larger number of simplification rules needed, and more.  All of this work above is just to do this sort of thing with a limited set of numeric computations on <code>Int</code>s only, imagine expanding this to work for all types in general.  This is why Haskell chooses a simpler route of storing the function definition less literally, and why you therefore can't <code>show</code> a function.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4783821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1428952494, "creation_date": 1428942050, "question_id": 29610242, "link": "https://stackoverflow.com/questions/29610242/trying-to-create-a-function-that-maps-another-function-into-a-function-list", "title": "Trying to create a function that maps another function into a function list", "body": "<pre><code>compose :: [(u -&gt; t)] -&gt; ((u -&gt; t) -&gt; (u-&gt;y)) -&gt; [(u-&gt;y)] \ncompose [] _ = []\ncompose l f = map f l\n</code></pre>\n\n<p>Im trying to create a function that receive a list of functions and maps another function over the elements of this lists.</p>\n\n<p>Example:\ncompose [(+2),(+3)] (+1) = [(+3),(+4)]</p>\n\n<p>thats the message the console shows me when i try to run this code</p>\n\n<p>*Main>  (compose [(+2)] (+1))</p>\n\n<p>:77:2:\n    No instance for (Show (t0 -> t0)) arising from a use of `print'\n    In a stmt of an interactive GHCi command: print it\n*Main></p>\n"}, {"tags": ["json", "parsing", "haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 4, "last_activity_date": 1428944225, "creation_date": 1428944225, "answer_id": 29610886, "question_id": 29609315, "link": "https://stackoverflow.com/questions/29609315/parsing-an-options-object-to-a-list-of-options/29610886#29610886", "title": "Parsing an Options Object to a List of Options", "body": "<p>You can maybe use the parser monad to extract all the information, something like:</p>\n\n<pre><code>parseJSON (Object v) = do\n      maybeNotify &lt;- v .:? \"notify_no_data\"\n      maybeTimeFrame &lt;- v .:? \"no_data_timeframe\"\n      let nots = case (maybeNotify,maybeTimeFrame) of\n                   (Just True,Just stamp) -&gt; [NotifyNoData $ fromJsontime stamp]\n                   _ -&gt; []\n      return $ Options nots\n</code></pre>\n\n<p>(fromJsontime is just a helper function to convert from the JSON value to your NominalDiffTime, I suppose you have something for that).</p>\n\n<p>Do the same for the other types of options, concatenating the result.</p>\n"}, {"tags": [], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "is_accepted": false, "score": 1, "last_activity_date": 1429556913, "last_edit_date": 1429556913, "creation_date": 1429533836, "answer_id": 29748261, "question_id": 29609315, "link": "https://stackoverflow.com/questions/29609315/parsing-an-options-object-to-a-list-of-options/29748261#29748261", "title": "Parsing an Options Object to a List of Options", "body": "<p>Using the <a href=\"https://github.com/ondrap/json-stream\" rel=\"nofollow\">json-stream</a> parser (which I am the author of), it would look like this (from my head, untested):</p>\n\n<pre><code>option =     NotifyNoData      &lt;$&gt; \"no_data_timeframe\" .: value\n                               &lt;*  filterI id (\"notify_no_data\" .: bool)\n         &lt;|&gt; const NotifyAudit &lt;$&gt; filterI id (\"notify_audit\" .: bool)\n         &lt;|&gt; Silenced          &lt;$&gt; \"silenced\" .: \"*\" .:? value\n\noptionList = Options &lt;$&gt; toList option\n</code></pre>\n\n<p>The code expects you have FromJSON instance for UTCTime (or you could just use 'integer' and some kind of fromposixtime etc.). </p>\n"}], "owner": {"reputation": 2203, "user_id": 751628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a3204916936206c8b9c9d0064ff53ffa?s=128&d=identicon&r=PG", "display_name": "Tanaki", "link": "https://stackoverflow.com/users/751628/tanaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 29610886, "answer_count": 2, "score": 2, "last_activity_date": 1429556913, "creation_date": 1428939182, "question_id": 29609315, "link": "https://stackoverflow.com/questions/29609315/parsing-an-options-object-to-a-list-of-options", "title": "Parsing an Options Object to a List of Options", "body": "<p>I have been working on a small library against an JSON-based API.  This library makes use of an \"options\" object, a series of key-value pairs that specify advanced behaviour:</p>\n\n<pre><code>{\n  \"id\": 1234\n  ...\n  \"options\": {\n    \"notify_no_data\": True,\n    \"no_data_timeframe\": 20,\n    \"notify_audit\": False,\n    \"silenced\": {\"*\" :1428937807}\n  }\n}\n</code></pre>\n\n<p>I've represented the options concept in Haskell using a list of options:</p>\n\n<pre><code>data Option = NotifyNoData NominalDiffTime -- notify after xyz\n            | NotifyAudit -- notify on changes\n            | Silenced (Maybe UTCTime) -- silence all notifications (\"*\") until xyz (or indefinitely)\n\nnewtype Options = Options [Option]\n</code></pre>\n\n<p>Implementing <code>toJSON</code> was simple enough; I instantiated <code>toJSON</code> for the <code>Option</code> type, and then used those as helpers for the <code>Options</code> type.</p>\n\n<pre><code>instance ToJSON Option where\n  toJSON (Silenced mtime) =\n    Object $ Data.HashMap.fromList [(\"silenced\", mapping)]\n    where stamp = maybe Null (jsonTime . floor . utcTimeToPOSIXSeconds) mtime\n          mapping = Object $ Data.HashMap.singleton \"*\" stamp\n  toJSON (NotifyNoData difftime) =\n    Object $ Data.HashMap.fromList [(\"notify_no_data\", Bool True)\n                                   ,(\"no_data_timeframe\", stamp)]\n    where stamp = jsonTime $ floor (difftime / 60)\n  toJSON NotifyAudit =\n    Object $ Data.HashMap.fromList [(\"notify_audit\", Bool True)]\n\ninstance ToJSON Options where\n  toJSON (Options options) = Object $ Data.HashMap.unions $ reverse $ (opts:) $ map ((\\(Object o) -&gt; o) . toJSON) options\n    where opts = Data.HashMap.fromList [(\"silenced\", Object Data.HashMap.empty)\n                                       ,(\"notify_no_data\", Bool False)\n                                       ,(\"notify_audit\", Bool False)]\n</code></pre>\n\n<p>The problem I am running into is in the <code>fromJSON</code> implementation for <code>Options</code>.  All the use cases I've seen before supply a fairly simple json-object-representation to data-representation mapping.  What I need to do is convert an object to an object of options to a list of data (Option) representations.  For example, the sample JSON under \"options\" that I gave at the start would have to become:</p>\n\n<pre><code>Options [NotifyNoData 20, Silenced (Just (posixSecondsToUTCTime 1428937807))]\n</code></pre>\n\n<p><code>FromJSON</code> requires an implementation of <code>parseJSON :: FromJSON a =&gt; Value -&gt; Parser a</code>.  I am having trouble understanding how to build a Parser using this optional object structure given by the API.  Is there a standard approach to parsing a JSON object to a list like this?  It may be that I am failing to fully understand the <code>Parser</code> typeclass.</p>\n"}, {"tags": ["haskell", "generator", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": false, "score": 6, "last_activity_date": 1428935789, "creation_date": 1428935789, "answer_id": 29608051, "question_id": 29607950, "link": "https://stackoverflow.com/questions/29607950/generating-a-list-of-integers-that-isnt-equal-to-a-specified-integer-in-haskell/29608051#29608051", "title": "Generating a list of integers that isn&#39;t equal to a specified integer in Haskell?", "body": "<p>I assume that you actually meant <code>Gen [Int]</code> when you wrote <code>Gen [Integer]</code>. You can simply filter the generated list:</p>\n\n<pre><code>listofInts :: Int -&gt; Gen [Int]\nlistofInts x = filter (/= x) &lt;$&gt; arbitrary\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1428937081, "post_id": 29608180, "comment_id": 47362603, "body": "Good idea! I suppose <code>suchThat</code> also lends itself to infix notation, <code>arbitrary `suchThat` (&#47;= x)</code> is kinda nice."}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 9, "last_activity_date": 1428937521, "last_edit_date": 1428937521, "creation_date": 1428936128, "answer_id": 29608180, "question_id": 29607950, "link": "https://stackoverflow.com/questions/29607950/generating-a-list-of-integers-that-isnt-equal-to-a-specified-integer-in-haskell/29608180#29608180", "title": "Generating a list of integers that isn&#39;t equal to a specified integer in Haskell?", "body": "<p>The <code>listOf</code> and <code>suchThat</code> combinators from <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck-Gen.html\"><code>Test.QuickCheck.Gen</code></a> should enable you to do that.</p>\n\n<pre><code>listofInts :: Int -&gt; Gen [Integer]\nlistOfInts x = listOf (suchThat arbitrary (/=x))\n</code></pre>\n\n<p>This approach have the advantage to be more respectful of the size parameter for the generation: <code>suchThat</code> ensures that a generated value that doesn't match the predicate does not influence the size.</p>\n"}], "owner": {"reputation": 367, "user_id": 1270740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f4b6ad64c4ae8ba4c159016841634ec?s=128&d=identicon&r=PG&f=1", "display_name": "dfj328", "link": "https://stackoverflow.com/users/1270740/dfj328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 29608180, "answer_count": 2, "score": 3, "last_activity_date": 1428937521, "creation_date": 1428935479, "question_id": 29607950, "link": "https://stackoverflow.com/questions/29607950/generating-a-list-of-integers-that-isnt-equal-to-a-specified-integer-in-haskell", "title": "Generating a list of integers that isn&#39;t equal to a specified integer in Haskell?", "body": "<p>Is there a modifier that allows me to generate a list of integers that does not contain a specified integer?</p>\n\n<p>This is a function that does the same job:</p>\n\n<pre><code>listofInts :: Int -&gt; Gen [Integer]\nlistofInts  a = rmInt a [] arbitrary\n\nrmInt :: Int -&gt; [Int] -&gt; [Int] -&gt; [Int]\nrmInt a newList [] = newList\nrmInt a newList (x:xs)\n|a == x = newList : rmInt a xs\n|otherwise = newList : x : rmInt a xs\n</code></pre>\n"}, {"tags": ["haskell", "runtime-error", "ghc", "c-minus-minus"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1428955332, "post_id": 29607663, "comment_id": 47373529, "body": "What are you trying to achieve? Perhaps there is a different, simpler way."}, {"owner": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1428966124, "post_id": 29607663, "comment_id": 47378067, "body": "I want to carry around some extra information with each thread to record for instance the ids of parent threads and use it when making load balancing decisions"}], "answers": [{"comments": [{"owner": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "edited": false, "score": 0, "creation_date": 1436824232, "post_id": 31079157, "comment_id": 50764470, "body": "Thanks for the suggestion. I  wonder why do you think I should introduce a new closure type? I&#39;d like to keep the standard TSO closure type but add a field to the TSO object. To me it looks like some offsets are wrong an the info field get overwritten by accident."}, {"owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "reply_to_user": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "edited": false, "score": 0, "creation_date": 1436831436, "post_id": 31079157, "comment_id": 50766775, "body": "On second thought, you probably don&#39;t need to create a new heap object, especially if the new field you are adding isn&#39;t a pointer.  Did you try doing a clean build?  That has solved this problem for me in the past."}, {"owner": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "edited": false, "score": 0, "creation_date": 1438454353, "post_id": 31079157, "comment_id": 51461961, "body": "unfortunately a clean build didn&#39;t help (I can&#39;t assume to have working stage-2 compiler either)"}], "tags": [], "owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1435429560, "last_edit_date": 1435429560, "creation_date": 1435340655, "answer_id": 31079157, "question_id": 29607663, "link": "https://stackoverflow.com/questions/29607663/how-to-extend-ghcs-thread-state-object/31079157#31079157", "title": "How to extend GHC&#39;s Thread State Object", "body": "<p>The error that you are getting comes from: <code>ghc/rts/sm/Scav.c</code>.  Specifically at line 1917:</p>\n\n<p></p>\n\n<pre><code> default:\n    barf(\"scavenge_stack: weird activation record found on stack: %d\", (int)(info-&gt;i.type));\n</code></pre>\n\n<p>It looks like you need to also modify <code>ClosureTypes.h</code>, which you can find in <code>ghc/includes/rts/storage</code>.  This file seems to contain the different kinds of headers that can appear in a heap object.  I've also run into some strange bootstrapping errors, where if I try to rebuild using the stage-1 compiler, I get the error you mentioned, but if I do a clean build, then it compiles just fine.  </p>\n"}, {"tags": [], "owner": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "is_accepted": true, "score": 1, "last_activity_date": 1438455204, "creation_date": 1438455204, "answer_id": 31765074, "question_id": 29607663, "link": "https://stackoverflow.com/questions/29607663/how-to-extend-ghcs-thread-state-object/31765074#31765074", "title": "How to extend GHC&#39;s Thread State Object", "body": "<p>A workaround that turned out good enough for me was to introduce a separate data structure for each <code>Capability</code> that would hold the additional information for each lightweight thread. I have used a <code>HashTable</code> (see <code>rts/Hash.h</code> and <code>.c</code>) mapping from thread id to the custom info struct. The entries were added when the threads were created from sparks (in <code>schduleActiveteSpark</code>). </p>\n\n<p>Timing the creation, insertion, lookup and destruction of the entries and the table showed negligible overhead for small programs. The main overhead results from the actual usage of the information and should ideally be kept outside of the innermost scheduler loop. For the <code>THREADED_RTS</code> build one needs to ensure that other Capabilities don't access tables that are not their own (or use a <code>mutex</code> if such access is required, which is potential source of additional overhead). </p>\n"}], "owner": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 2, "accepted_answer_id": 31765074, "answer_count": 2, "score": 13, "last_activity_date": 1438455204, "creation_date": 1428934788, "question_id": 29607663, "link": "https://stackoverflow.com/questions/29607663/how-to-extend-ghcs-thread-state-object", "title": "How to extend GHC&#39;s Thread State Object", "body": "<p>I'd like to add two extra fields of type <code>StgWord32</code> to the <em>thread state object</em> (TSO). Based on the information I found on the GHC-Wiki and from looking at the source code, I have extended the struct in <code>/includes/rts/storage/TSO.h</code> and changed the program that creates different offsets (creating <code>DerivedConstants.h</code>). The compiler, the rts, and a simple application re-compile, but at the end of the execution (in <code>hs_exit_</code>) the garbage collector complains:</p>\n\n<pre><code> internal error: scavenge_stack: weird activation record found on stack: 45\n</code></pre>\n\n<p>I guess it has to to with <code>cmm</code> and/or the STG implementation details (the offsets are generated since the structs are not visible at <code>cmm</code> level, correct me if I'm wrong). Is the order of fields significant? Have I missed a file that should be changed? </p>\n\n<p>I use a <em>debug</em> build of the compiler and RTS and a rather dated <em>ghc 6.12.3</em> on a 64bit architecture. Any hints to relevant documentation and comments\non the difference between ghc 6 and 7 regarding TSO handling are welcome, too. </p>\n"}, {"tags": ["haskell", "equation", "brute-force"], "comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 3, "creation_date": 1428928119, "post_id": 29605186, "comment_id": 47356193, "body": "I imagine it&#39;s faster to find the prime factors of <code>c</code>, then find all the ways of grouping them into two groups."}, {"owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1428928165, "post_id": 29605186, "comment_id": 47356211, "body": "@ikegami, thank you, I try this solution."}, {"owner": {"reputation": 729, "user_id": 1838505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0012b91653dc7d12e75c5823bee3d8f2?s=128&d=identicon&r=PG", "display_name": "Shanthakumar", "link": "https://stackoverflow.com/users/1838505/shanthakumar"}, "edited": false, "score": 1, "creation_date": 1428930653, "post_id": 29605186, "comment_id": 47357904, "body": "\u03bb let f c = [(a,b) | a &lt;- [1..c], b &lt;- [1..c], a&lt;b, a*b==c]"}, {"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "reply_to_user": {"reputation": 729, "user_id": 1838505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0012b91653dc7d12e75c5823bee3d8f2?s=128&d=identicon&r=PG", "display_name": "Shanthakumar", "link": "https://stackoverflow.com/users/1838505/shanthakumar"}, "edited": false, "score": 2, "creation_date": 1428930983, "post_id": 29605186, "comment_id": 47358121, "body": "@Shanthakumar you can avoid creating a bunch of <code>b</code> values that would be filtered out: <code>let f c = [(a, b) | a &lt;- [1 .. c], b &lt;- [1 .. a - 1], a * b == c]</code>."}, {"owner": {"reputation": 729, "user_id": 1838505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0012b91653dc7d12e75c5823bee3d8f2?s=128&d=identicon&r=PG", "display_name": "Shanthakumar", "link": "https://stackoverflow.com/users/1838505/shanthakumar"}, "edited": false, "score": 0, "creation_date": 1428932371, "post_id": 29605186, "comment_id": 47359122, "body": "oh yeah xD <code>let f c = [(a, b) | b &lt;- [1 .. c], a &lt;- [1 .. b - 1], a * b == c]</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 729, "user_id": 1838505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0012b91653dc7d12e75c5823bee3d8f2?s=128&d=identicon&r=PG", "display_name": "Shanthakumar", "link": "https://stackoverflow.com/users/1838505/shanthakumar"}, "edited": false, "score": 3, "creation_date": 1428932492, "post_id": 29605186, "comment_id": 47359211, "body": "@Shanthakumar Once <code>b</code> is chosen, there is only one possible value for <code>a</code> that can satisfy <code>a*b==c</code>, that is <code>div c b</code>. I&#39;d check that single value rather than all the values in <code>[1..b-1]</code>."}, {"owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428934699, "post_id": 29605186, "comment_id": 47360737, "body": "@chi, it is clever idea, but It is slow too."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428943551, "post_id": 29605186, "comment_id": 47366863, "body": "You should consider using the approach @chi described, but instead of using <code>div</code>, use <code>quotRem</code>. This will let you check the result really quickly."}], "answers": [{"tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 4, "last_activity_date": 1428937276, "creation_date": 1428937276, "answer_id": 29608611, "question_id": 29605186, "link": "https://stackoverflow.com/questions/29605186/solve-the-equation-a-b-c-where-a-b-and-c-are-natural-numbers/29608611#29608611", "title": "Solve the equation a * b = c, where a, b and c are natural numbers", "body": "<p>There's one optimization you don't use: you don't have to try every value from <code>0</code> to <code>c</code>.</p>\n\n<p><code>a &lt; b</code> and <code>a * b = c</code>, so <code>a * a &lt; c</code>, meaning you only have to try numbers from <code>0</code> to <code>sqrt c</code>. Or, if you don't want to compute the square root of <code>c</code>, you can stop as soon as <code>a * a &gt;= c</code>.</p>\n\n<p>To do so, you can replace <code>[1..c]</code> by <code>(takeWhile (\\x -&gt; x * x &lt; c) [1..])</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1428947544, "creation_date": 1428947544, "answer_id": 29611818, "question_id": 29605186, "link": "https://stackoverflow.com/questions/29605186/solve-the-equation-a-b-c-where-a-b-and-c-are-natural-numbers/29611818#29611818", "title": "Solve the equation a * b = c, where a, b and c are natural numbers", "body": "<p>You can do much, much better. The basic idea is this: first, factorize the number; then enumerate the partitions of the factorization. The product of each partition is a solution. There are fast factorization algorithms out there, but even the naive one is quite an improvement on your code; so:</p>\n\n<pre><code>factorize :: Integer -&gt; [Integer]\nfactorize n\n    | n &lt; 1 = error \"no. =(\"\n    | otherwise = go 2 n\n    where\n    go p n | p * p &gt; n = [n]\n    go p n = case quotRem n p of\n        (q, 0) -&gt; p:go p q\n        _      -&gt; go (p+1) n\n</code></pre>\n\n<p>I will use the very nice <a href=\"http://hackage.haskell.org/package/multiset-comb-0.2.3/docs/Math-Combinatorics-Multiset.html\">multiset-comb</a> package to compute partitions of the set of factors. It doesn't support the usual <code>Foldable</code>/<code>Traversable</code> stuff out of the box, so we have to roll our own <code>product</code> operation -- but in fact this can be a bit more efficient than using the <code>product</code> that the standard interface would give us anyway.</p>\n\n<pre><code>import Math.Combinatorics.Multiset\n\nproductMS :: Multiset Integer -&gt; Integer\nproductMS (MS cs) = product [n^p | (n, p) &lt;- cs]\n\ndivisors :: Integer -&gt; [(Integer, Integer)]\ndivisors n =\n    [ (a, b)\n    | (aMS, bMS) &lt;- splits (fromList (factorize n))\n    , let a = productMS aMS; b = productMS bMS\n    , a &lt;= b\n    ]\n</code></pre>\n\n<p>For unfair timings, we can compare in ghci:</p>\n\n<pre><code>*Main&gt; :set +s\n*Main&gt; length $ solve (product [1..10])\n135\n(3.55 secs, 2,884,836,952 bytes)\n*Main&gt; length $ divisors (product [1..10])\n135\n(0.00 secs, 4,612,104 bytes)\n*Main&gt; length $ solve (product [1..15])\n^CInterrupted. [after several minutes, I gave up]\n*Main&gt; length $ divisors (product [1..15])\n2016\n(0.03 secs, 33,823,168 bytes)\n</code></pre>\n\n<p>Here <code>solve</code> is your solution, <code>divisors</code> is mine. For a fair comparison, we should compile; I used this program:</p>\n\n<pre><code>main = print . last . solve . product $ [1..11]\n</code></pre>\n\n<p>(And similar with <code>divisors</code> in place of <code>solve</code>.) I compiled with <code>-O2</code>; yours used 1.367s total, mine 0.002s total.</p>\n"}], "owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 2, "accepted_answer_id": 29608611, "answer_count": 2, "score": 2, "last_activity_date": 1428947544, "creation_date": 1428927666, "last_edit_date": 1428943378, "question_id": 29605186, "link": "https://stackoverflow.com/questions/29605186/solve-the-equation-a-b-c-where-a-b-and-c-are-natural-numbers", "title": "Solve the equation a * b = c, where a, b and c are natural numbers", "body": "<p>I have some natural number <code>c</code>. I want to find all pairs of natural numbers <code>a and b</code>, where <code>a &lt; b</code>, such as <code>a * b = c</code>. </p>\n\n<p>I have a solution:</p>\n\n<pre><code>solve c = do solveHelper [1..c] c where\n                   solveHelper xs c = do\n                       x &lt;- xs\n                       (division, modulo ) &lt;- return (c `divMod` x)\n                       True &lt;- return (modulo  == 0)\n                       True &lt;- return (x &lt;= division)\n                       return (x, division)\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>*Main&gt; solve 10\n[(1,10),(2,5)]\n</code></pre>\n\n<p>Is there a way to accelerate my code, or a better algorithm I should use?</p>\n"}, {"tags": ["haskell", "functional-programming", "generator", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": true, "score": 7, "last_activity_date": 1428925931, "creation_date": 1428925931, "answer_id": 29604633, "question_id": 29604461, "link": "https://stackoverflow.com/questions/29604461/creating-generators-from-user-defined-data-types-in-haskell/29604633#29604633", "title": "Creating generators from user defined data types in haskell", "body": "<p>You can use the <code>listOf1</code> function to get a generator which generates non-empty lists and use that for defining an appropriate <code>Arbitrary</code> instance, like:</p>\n\n<pre><code>import Test.QuickCheck\nimport Control.Applicative\n\ninstance Arbitrary Boo\n\ninstance Arbitrary Foo where\n  arbitrary = Foo &lt;$&gt; arbitrary &lt;*&gt; arbitrary &lt;*&gt; arbitrary &lt;*&gt; listOf1 arbitrary\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 1270740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f4b6ad64c4ae8ba4c159016841634ec?s=128&d=identicon&r=PG&f=1", "display_name": "dfj328", "link": "https://stackoverflow.com/users/1270740/dfj328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 29604633, "answer_count": 1, "score": 2, "last_activity_date": 1428926314, "creation_date": 1428925372, "last_edit_date": 1428926314, "question_id": 29604461, "link": "https://stackoverflow.com/questions/29604461/creating-generators-from-user-defined-data-types-in-haskell", "title": "Creating generators from user defined data types in haskell", "body": "<p>I need some suggestions on how I can go about creating a random generator for the Foo data type such that the list of Boo is never empty?</p>\n\n<pre><code>data Boo = Boo Float Float Float\ndata Foo = Foo Float Float Float [Boo]\n</code></pre>\n"}, {"tags": ["sockets", "haskell", "networking", "udp", "nonblocking"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1429031174, "post_id": 29602190, "comment_id": 47409078, "body": "See also <a href=\"http://stackoverflow.com/q/11744527/791604\">How can I watch multiple files/socket to become readable/writable in Haskell?</a>; though I understand that restructuring during a port can be quite disruptive and dangerous. Long-term, doing the receive on its own thread is the right solution, though. You could communicate with the separate thread in a non-blocking way, of course."}], "answers": [{"comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1549894094, "post_id": 29603919, "comment_id": 96056885, "body": "<a href=\"http://hackage.haskell.org/package/bytestring-0.10.0.2/docs/Data-ByteString.html#v:hGetNonBlocking\" rel=\"nofollow noreferrer\">Note</a>: on Windows and with Haskell implementation other than GHC, this function does not work correctly; it behaves identically to hGet."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1428923514, "creation_date": 1428923514, "answer_id": 29603919, "question_id": 29602190, "link": "https://stackoverflow.com/questions/29602190/non-blocking-udp-recv-in-haskell/29603919#29603919", "title": "Non-blocking UDP recv in Haskell", "body": "<p>You could use <a href=\"http://hackage.haskell.org/package/network-2.6.0.2/docs/Network-Socket.html#v:socketToHandle\" rel=\"nofollow\"><code>socketToHandle</code></a> together with <a href=\"http://hackage.haskell.org/package/bytestring-0.10.0.2/docs/Data-ByteString.html#v:hGetNonBlocking\" rel=\"nofollow\"><code>hGetNonBlocking</code></a>:</p>\n\n<pre><code>recvNonBlocking :: Socket -&gt; Int -&gt; IO ByteString\nrecvNonBlocking s n = do\n     hnd &lt;- socketToHandle s ReadMode \n     hGetNonBlocking hnd n\n</code></pre>\n\n<p>However, keep in mind that you cannot use the <code>Socket</code> after a call to <code>socketToHandle</code>, so this is only feasible if you would close the Socket either way afterwards.</p>\n"}], "owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1428923514, "creation_date": 1428917960, "question_id": 29602190, "link": "https://stackoverflow.com/questions/29602190/non-blocking-udp-recv-in-haskell", "title": "Non-blocking UDP recv in Haskell", "body": "<p>I'm still learning the basics of Haskell and currently working through porting some Java code to Haskell. My current problem is in UDP recvFrom using Network.Socket.ByteString.</p>\n\n<p>The problem is with <a href=\"http://docs.oracle.com/javase/7/docs/api/java/nio/channels/DatagramChannel.html#receive(java.nio.ByteBuffer)\" rel=\"noreferrer\">this method</a>:</p>\n\n<pre><code>public abstract SocketAddress receive(ByteBuffer dst) throws IOException\n\nReceives a datagram via this channel.\nIf a datagram is immediately available, or if this channel\nis in blocking mode and one eventually becomes available,\nthen the datagram is copied into the given byte buffer and\nits source address is returned. If this channel is in\nnon-blocking mode and a datagram is not immediately available\nthen this method immediately returns null.\n</code></pre>\n\n<p>The thing is that when I use <a href=\"http://hackage.haskell.org/package/network-2.6.0.2/docs/Network-Socket-ByteString.html#g:3\" rel=\"noreferrer\">Network.Socket.ByteString.recvFrom</a> my code blocks at this point waiting for the packet to come. It doesn't return something like Maybe to indicate if something was received or not (the same way in Java there is a null returned when no data was available)</p>\n\n<p>I found this thread: <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2010-August/082725.html\" rel=\"noreferrer\">https://mail.haskell.org/pipermail/haskell-cafe/2010-August/082725.html</a></p>\n\n<p>At the end of it there are a couple of ways suggested: 1) FFI 2) run recvFrom in its own thread</p>\n\n<p>I'm not sure I'm capable of using any of those approaches at this moment (not enough knowledge). What I want is to get something similar to Java way of non-blocking receive: get needed info if it is available or just nothing if there is no single UDP packet.  Anyone can point out what would be a better approach, any code snippets, someone already handled this problem?</p>\n"}, {"tags": ["haskell", "gtk2hs"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1428913597, "post_id": 29600416, "comment_id": 47347856, "body": "As I understand it, all GTK calls have to go in the same thread. Does wrapping your timer callback in <code>postInGuiThread</code> fix the problem?"}, {"owner": {"reputation": 219, "user_id": 4049452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/770a5cf1ff04825862a4cd39fcc3454e?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/4049452/anton"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1428957763, "post_id": 29600416, "comment_id": 47374757, "body": "I don&#39;t know what postInGuiThread is (can&#39;t find it in the docs), but replacing labelSetText labl &quot;00:00&quot; with postGUIAsync $ labelSetText labl &quot;00:00&quot; has no effect. Still threading issue is the only viable hypothesis right now, I&#39;ll look more into that. Thank you for your help!"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1428999019, "post_id": 29600416, "comment_id": 47388261, "body": "I wasn&#39;t sure of the precise function name off the top of my head, and I can&#39;t seem to lay my hands on the Gtk2hs documentation right now..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1429030904, "post_id": 29600416, "comment_id": 47408929, "body": "<code>timeoutAdd</code> is fine; the callback you hand it will run on the <code>mainGUI</code> thread, and assuming you use the <code>timeoutAdd</code> from the <code>gtk</code> package (and not the <code>timeoutAdd</code> from the <code>glib</code> package) will hold the GUI lock. This is a pretty bizarre problem -- you are not doing anything obviously weird, so it should Just Work. Haven&#39;t looked into it in detail yet, though."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1429053722, "post_id": 29600416, "comment_id": 47420058, "body": "I dunno. I can&#39;t reproduce your problem on my machine (also Linux, though different versions of everything). It&#39;s probably just a bug in gtk."}], "owner": {"reputation": 219, "user_id": 4049452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/770a5cf1ff04825862a4cd39fcc3454e?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/4049452/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1428911705, "creation_date": 1428911705, "question_id": 29600416, "link": "https://stackoverflow.com/questions/29600416/labelsettext-behaves-strange-when-executed-in-timeoutadd-handler", "title": "labelSetText behaves strange when executed in timeoutAdd handler", "body": "<p>I wrote a simple clock program that worked fine under winxp. When run under linux it behaves weirdly. The program draws a label with the text set to \"00:00\", and then updates it once per second with the same text. </p>\n\n<p>To run the program I specify a font size in the command line. If I set it really small (200.0 and lower for my screen, it may be different to yours) it works fine. If I set it too big and the text doesn't fit the screen (500.0 in my case), it works fine as well. However when I pick the size in the middle (say, 300.0 or 400.0) it displays \"00:00\", however once updateClock sets the text it becomes \"  :00\" on the screen (it's not shifted to the left, just the two leading zeroes are replaced with empty space)</p>\n\n<p>Here is the simplified code that demonstrates the problem:</p>\n\n<pre><code>import System.Environment\nimport System.Time\nimport System.Locale\nimport Data.Time\nimport Graphics.Rendering.Cairo\nimport Graphics.UI.Gtk hiding (fill)\nimport Graphics.UI.Gtk.Gdk.EventM\n\nparseArgs [str] = case reads str::[(Double, String)] of\n  [(number, \"\")] -&gt; Just number\n  _ -&gt; Nothing \n\nparseArgs _ = Nothing\n\nupdateClock labl = do\n  labelSetText labl \"00:00\"\n  return True\n\n\nmain = do\n  args &lt;- getArgs\n  case (parseArgs args) of\n    Just size -&gt; \n      showGui size\n    _ -&gt; putStrLn \"\\nUsage: test fontSize\"\n\n  where\n    showGui size = do\n      initGUI\n      window &lt;- windowNew\n      onDestroy window mainQuit\n\n      window `on` keyPressEvent $ tryEvent $ do\n        \"Escape\" &lt;- eventKeyName\n        liftIO mainQuit\n\n      labl &lt;- labelNew Nothing\n      fd &lt;- fontDescriptionNew\n\n      containerAdd window labl\n\n      windowFullscreen window\n\n      fontDescriptionSetSize fd size\n      widgetModifyFont labl $ Just fd\n\n      timeoutAdd (updateClock labl &gt;&gt; return True) 1000\n\n      widgetShowAll window\n      mainGUI\n</code></pre>\n\n<p>I use libghc-gtk-dev 0.12.4-3, </p>\n\n<p>ghc 7.6.3 </p>\n\n<p>and libgtk2.0-0 2.24.23-0ubuntu1.2.</p>\n\n<p>I compile with ghc --make --threaded </p>\n\n<p>I'm having trouble figuring out what's going on here.\nI would appreciate any help</p>\n"}, {"tags": ["haskell", "pointfree"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1428908936, "post_id": 29596285, "comment_id": 47345494, "body": "Beware that in some cases (like this) the point free version can be much less readable than the original code. Unless you are aiming for obfuscated code, use point free style with some care."}], "answers": [{"comments": [{"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 4, "creation_date": 1428900586, "post_id": 29596353, "comment_id": 47342543, "body": "If you don&#39;t want to fire up an IRC client, I wrote a web service that does these conversions for you. It&#39;s called Blunt: <a href=\"https://blunt.herokuapp.com/#input=bar%20f%20g%20xs%20%3D%20filter%20f%20(map%20g%20xs)\" rel=\"nofollow noreferrer\">blunt.herokuapp.com/&hellip;</a>"}, {"owner": {"reputation": 373, "user_id": 2487254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0287a6e43f477fca396ef20389bd316c?s=128&d=identicon&r=PG", "display_name": "Jxek", "link": "https://stackoverflow.com/users/2487254/jxek"}, "edited": false, "score": 3, "creation_date": 1428911512, "post_id": 29596353, "comment_id": 47346849, "body": "You can also install the command line version using <code>cabal install pointfree</code>. If you then give it its own ghci definition you could use it from ghci :) <a href=\"https://hackage.haskell.org/package/pointfree\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/pointfree</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 0, "creation_date": 1592345596, "post_id": 29596353, "comment_id": 110392222, "body": "@TaylorFausak, is Blunt dead, or just moved?"}, {"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1592437820, "post_id": 29596353, "comment_id": 110429095, "body": "@dfeuer it&#39;s dead."}], "tags": [], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "is_accepted": false, "score": 6, "last_activity_date": 1592455899, "last_edit_date": 1592455899, "creation_date": 1428885845, "answer_id": 29596353, "question_id": 29596285, "link": "https://stackoverflow.com/questions/29596285/point-free-problems-in-haskell/29596353#29596353", "title": "Point Free problems in Haskell", "body": "<p>I asked <em>lambdabot</em>, a robot who hangs out on various Haskell IRC channels, to automatically work out the point-free equivalent.  The command is <code>@pl</code> (<em>pointless</em>).</p>\n\n<pre><code>10:41 &lt;frase&gt; @pl bar f g xs = filter f (map g xs )\n10:41 &lt;lambdabot&gt; bar = (. map) . (.) . filter\n</code></pre>\n\n<p>The point free version of <code>bar</code> is:</p>\n\n<pre><code>bar = (. map) . (.) . filter\n</code></pre>\n\n<p>This is arguably less comprehensible than the original (non-point-free) code.  Use your good judgement when deciding whether to use point-free style on a case-by-case basis.</p>\n\n<p>Finally, if you don't care for IRC there are web-based point-free\nconverters such as <a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree.io</a>, the <a href=\"https://hackage.haskell.org/package/pointfree\" rel=\"nofollow noreferrer\"><code>pointfree</code></a> command line program, and other tools.</p>\n"}, {"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 12, "creation_date": 1428913762, "post_id": 29596461, "comment_id": 47347955, "body": "This is the first time I&#39;ve seen anybody post the actual <i>algorithm</i> for doing this. I knew there must be one, but I didn&#39;t know precisely what it is..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1435963722, "post_id": 29596461, "comment_id": 50431118, "body": "I&#39;ve seen several textbooks that struggled to present the conversion as clearly as you have done! (just a side note, the last expression is usually seen as <code>(flip foo .) . bar</code>)."}, {"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 4, "creation_date": 1456237221, "post_id": 29596461, "comment_id": 58846483, "body": "For reference, I&#39;d like to add that this is (mostly) <a href=\"https://en.wikipedia.org/wiki/Combinatory_logic#Conversion_of_a_lambda_term_to_an_equivalent_combinatorial_term\" rel=\"nofollow noreferrer\">converting from lambda calculus into SK calculus</a> (just in case someone wants to google more about it)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1592385082, "post_id": 29596461, "comment_id": 110403723, "body": "&quot;use any rule that applies&quot; if more than one were to apply, it&#39;d introduce nondeterminism and the &quot;cleverness&quot; of making the &quot;best&quot; choice. for instance you&#39;ve excluded <b>W</b>xy = xyy here."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 45, "last_activity_date": 1493612772, "last_edit_date": 1493612772, "creation_date": 1428886797, "answer_id": 29596461, "question_id": 29596285, "link": "https://stackoverflow.com/questions/29596285/point-free-problems-in-haskell/29596461#29596461", "title": "Point Free problems in Haskell", "body": "<p>Converting to pointfree style can be done entirely mechanically, though it's hard without being comfortable with the fundamentals of Haskell syntax like left-associative function application and <code>x + y</code> being the same as <code>(+) x y</code>.  I will assume you are comfortable with Haskell syntax; if not, I suggest going through the first few chapters of <a href=\"http://learnyouahaskell.com/\" rel=\"noreferrer\">LYAH</a> first. </p>\n\n<p>You need the following combinators, which are in the standard library.  I have also given their standard names from combinator calculus.</p>\n\n<pre><code>id :: a -&gt; a                                   -- I\nconst :: a -&gt; b -&gt; a                           -- K\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)        -- B\nflip :: (a -&gt; b -&gt; c) -&gt; (b -&gt; a -&gt; c)         -- C\n(&lt;*&gt;) :: (a -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c) -- S\n</code></pre>\n\n<p>Work with one parameter at a time.  Move parameters on the left to lambdas on the right, e.g.</p>\n\n<pre><code>f x y = Z\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>f = \\x -&gt; \\y -&gt; Z\n</code></pre>\n\n<p>I like to do this one argument at a time rather than all at once, it just looks cleaner.</p>\n\n<p>Then eliminate the lambda you just created according to the following rules. I will use lowercase letters for literal variables, uppercase letters to denote more complex expressions.</p>\n\n<ol>\n<li>If you have <code>\\x -&gt; x</code>, replace with <code>id</code></li>\n<li>If you have <code>\\x -&gt; A</code>, where <code>A</code> is any expression in which <code>x</code> does not occur, replace with <code>const A</code></li>\n<li>If you have <code>\\x -&gt; A x</code>, where <code>x</code> does not occur in <code>A</code>, replace with <code>A</code>. This is known as \"eta contraction\".</li>\n<li>If you have <code>\\x -&gt; A B</code>, then\n\n<ol>\n<li>If <code>x</code> occurs in both <code>A</code> and <code>B</code>, replace with <code>(\\x -&gt; A) &lt;*&gt; (\\x -&gt; B)</code>.</li>\n<li>If <code>x</code> occurs in just <code>A</code>, replace with <code>flip (\\x -&gt; A) B</code></li>\n<li>If <code>x</code> occurs in just <code>B</code>, replace with <code>A . (\\x -&gt; B)</code>,</li>\n<li>If <code>x</code> does not occur in either <code>A</code> or <code>B</code>, well, there's another rule we should have used already.</li>\n</ol></li>\n</ol>\n\n<p>And then work inward, eliminating the lambdas that you created.  Lets work with this example: </p>\n\n<pre><code>f x y z = foo z (bar x y)\n-- Move parameter to lambda:\nf x y = \\z -&gt; foo z (bar x y)\n-- Remember that application is left-associative, so this is the same as\nf x y = \\z -&gt; (foo z) (bar x y)\n-- z appears on the left and not on the right, use flip\nf x y = flip (\\z -&gt; foo z) (bar x y)\n-- Use rule (3) \nf x y = flip foo (bar x y)\n\n-- Next parameter\nf x = \\y -&gt; flip foo (bar x y)\n-- Application is left-associative\nf x = \\y -&gt; (flip foo) (bar x y)\n-- y occurs on the right but not the left, use (.)\nf x = flip foo . (\\y -&gt; bar x y)\n-- Use rule 3\nf x = flip foo . bar x\n\n-- Next parameter\nf = \\x -&gt; flip foo . bar x\n-- We need to rewrite this operator into normal application style\nf = \\x -&gt; (.) (flip foo) (bar x)\n-- Application is left-associative\nf = \\x -&gt; ((.) (flip foo)) (bar x)\n-- x appears on the right but not the left, use (.)\nf = ((.) (flip foo)) . (\\x -&gt; bar x)\n-- use rule (3)\nf = ((.) (flip foo)) . bar\n-- Redundant parentheses\nf = (.) (flip foo) . bar\n</code></pre>\n\n<p>There you go, now try it on yours!  There is not really any cleverness involved in deciding which rule to use: use any rule that applies and you will make progress. </p>\n"}, {"tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 7, "last_activity_date": 1509513468, "last_edit_date": 1509513468, "creation_date": 1428957900, "answer_id": 29614753, "question_id": 29596285, "link": "https://stackoverflow.com/questions/29596285/point-free-problems-in-haskell/29614753#29614753", "title": "Point Free problems in Haskell", "body": "<p>Both of the existing answers don't really answer your specific question in a way that's elucidating: one is \"here are the rules, work it out for yourself\" and the other is \"here is the answer, no information about how the rules generate it.\"</p>\n\n<p>The first three steps are really easy and consist in removing a common <code>x</code> from something of the form <code>h x = f (g x)</code> by writing <code>h = f . g</code>. Essentially it's saying \"if you can write the thing in the form <code>a $ b $ c $ ... $ y $ z</code> and you want to remove the <code>z</code>, change all the dollars to dots, <code>a . b . c . ... . y</code>:</p>\n\n<pre><code>bar f g xs = filter f (map g xs)\n           = filter f $ (map g xs)\n           = filter f $ map g $ xs -- because a $ b $ c == a $ (b $ c).\nbar f g    = filter f . map g\n           = (filter f .) (map g)\n           = (filter f .) $ map $ g\nbar f      = (filter f .) . map\n</code></pre>\n\n<p>So this last <code>f</code> is the only tricky part, and it's tricky because the <code>f</code> is not at the \"end\" of the expression. But looking at it, we see that this is a function section <code>(. map)</code> applied to the rest of the expression:</p>\n\n<pre><code>bar f = (.) (filter f) . map\nbar f = (. map) $ (.) $ filter $ f\nbar   = (. map) . (.) . filter\n</code></pre>\n\n<p>and that's how you reduce an expression when you don't have complicated things like <code>f x x</code> and the like appearing in it. In general there is a function <code>flip f x y = f y x</code> which \"flips arguments\"; you can always use that to move the <code>f</code> to the other side. Here we have <code>flip (.) map . (.) . filter</code> if you include the explicit flip call.</p>\n"}], "owner": {"reputation": 129, "user_id": 3000149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d87d026b01eb0f26da27210785f873?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/3000149/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 13, "accepted_answer_id": 29596461, "answer_count": 3, "score": 12, "last_activity_date": 1592455899, "creation_date": 1428885237, "last_edit_date": 1592383532, "question_id": 29596285, "link": "https://stackoverflow.com/questions/29596285/point-free-problems-in-haskell", "title": "Point Free problems in Haskell", "body": "<p>I am trying to convert the following Haskell code to point free style, to no avail.</p>\n\n<pre><code>bar f g xs = filter f (map g xs )\n</code></pre>\n\n<p>I'm new to Haskell and any help would be great.</p>\n"}, {"tags": ["haskell", "math"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428882647, "post_id": 29596012, "comment_id": 47338861, "body": "The right shift and <code>xor</code> approach is probably worth mentioning\u2014it&#39;s better in some contexts."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1428882978, "post_id": 29596012, "comment_id": 47338934, "body": "If you right-arithmetic-shift all the way (the usual right shift for <code>Int</code> is arithmetic), then you&#39;ll get all 0s if the number is positive or 0 and all 1s if the number is negative. <code>xor</code> was the wrong operator, though. I meant flip the bits and <code>.&amp;.</code> it."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1428884040, "post_id": 29596012, "comment_id": 47339122, "body": "@dfeuer OK, although that sounds very special-cased, something for LLVM or GCC to take care of, not to write in Haskell."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1428886894, "post_id": 29596012, "comment_id": 47339704, "body": "The LLVM backend will often try to be clever about such things; the native code generator will not. Bringing GCC into it will cost you a 5ns FFI call and throw a monkey wrench into the optimizer."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428888023, "post_id": 29596012, "comment_id": 47339926, "body": "@dfeuer Yeah I meant GCC in general, not from Haskell."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428897872, "post_id": 29596012, "comment_id": 47341928, "body": "@dfeuer why not make it an answer so that the OP can decide what fits his problem?"}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 10, "last_activity_date": 1428882590, "creation_date": 1428882590, "answer_id": 29596012, "question_id": 29595922, "link": "https://stackoverflow.com/questions/29595922/is-there-a-standard-haskell-function-that-does-numerical-clipping/29596012#29596012", "title": "Is there a standard Haskell function that does numerical clipping?", "body": "<p>Sure there is one:</p>\n\n<pre><code>clip = max 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1428899270, "post_id": 29597422, "comment_id": 47342235, "body": "<code>max</code> and <code>min</code> are both commutative operations, so that can just be <code>clip a b = max a . min b</code>."}, {"owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1428902519, "post_id": 29597422, "comment_id": 47343062, "body": "Thanks a heap for the comments / improvements."}], "tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 4, "last_activity_date": 1428898066, "last_edit_date": 1428898066, "creation_date": 1428895732, "answer_id": 29597422, "question_id": 29595922, "link": "https://stackoverflow.com/questions/29595922/is-there-a-standard-haskell-function-that-does-numerical-clipping/29597422#29597422", "title": "Is there a standard Haskell function that does numerical clipping?", "body": "<p>A side note, for clipping n within a closed interval [a,b], namely </p>\n\n<ul>\n<li>n if a &lt;= n &lt;= b </li>\n<li>a if n &lt; a </li>\n<li>b if n > b, </li>\n</ul>\n\n<p>consider </p>\n\n<pre><code>clip :: (Ord a) =&gt; a -&gt; a -&gt; a -&gt; a\nclip n a b = min b $ max n a\n</code></pre>\n\n<p>or if you like point-free-style:</p>\n\n<pre><code>clip :: Ord a =&gt; a -&gt; a -&gt; a -&gt; a\nclip a b = (a `max`) . (`min` b)\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 29596012, "answer_count": 2, "score": 2, "last_activity_date": 1428898066, "creation_date": 1428881732, "question_id": 29595922, "link": "https://stackoverflow.com/questions/29595922/is-there-a-standard-haskell-function-that-does-numerical-clipping", "title": "Is there a standard Haskell function that does numerical clipping?", "body": "<p>I have the following code:</p>\n\n<pre><code>clip n = if n &lt; 0 then 0 else n\n</code></pre>\n\n<p>It's in the same \"category\" as <code>abs</code>, <code>ceiling</code>, <code>floor</code>. I don't suppose there is a standard function that does this?</p>\n"}, {"tags": ["haskell", "emacs", "read-eval-print-loop"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1428875949, "post_id": 29594601, "comment_id": 47337122, "body": "&quot;it prompts you&quot; - where &quot;it&quot; = &quot;emacs&quot;? No. Certainly it&#39;s some kind of Haskell mode for emacs that you (your emacs) has (pre-)installed. Find out which one it is, check its documentation, etc."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1428880060, "post_id": 29594601, "comment_id": 47338219, "body": "this one? <a href=\"https://github.com/haskell/haskell-mode/wiki/Haskell-Interactive-Mode-Sessions\" rel=\"nofollow noreferrer\">github.com/haskell/haskell-mode/wiki/&hellip;</a> And you&#39;re saying that &quot;It figures out where the cabal directory is&quot; does not find your sandbox? It&#39;s a bug then, or a feature request ..."}, {"owner": {"reputation": 12253, "user_id": 2112489, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5f4ed4b573c4e38444c6fc54b28076c0?s=128&d=identicon&r=PG", "display_name": "lawlist", "link": "https://stackoverflow.com/users/2112489/lawlist"}, "edited": false, "score": 0, "creation_date": 1428903834, "post_id": 29594601, "comment_id": 47343482, "body": "I don&#39;t use the built-in customization utility for Emacs, but that would be one option -- i.e., navigate to the group for the particular library that interests you.  You could do it the old-fashioned way by opening up the source code and looking for entries that begin with <code>(defcustom . . .</code> and <code>(defvar . . .</code> -- all of those will be variables that can be set to your precise needs, within the guidelines of what the author has already established.  Those variables can generally be changed by having a <code>(require &#39;...)</code> library statement before your changes and then each reassignment uses <code>(setq</code>"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1428872483, "creation_date": 1428872483, "question_id": 29594601, "link": "https://stackoverflow.com/questions/29594601/how-to-set-default-cabal-directory-and-other-haskell-defaults-in-emacs", "title": "How to set default cabal directory and other haskell defaults in emacs?", "body": "<p>When I use C-c, C-l to load a haskell source file in emacs, it always prompts me for a cabal directory. I have a sandbox directory that I use for everything atm, is there a way to set that directory as the cabal directory by default so I don't get prompted?</p>\n\n<p>Also, when closing the GHCi repl, it asks me if I want to kill associated buffers. I'd like it to default to \"no\" without a prompt. How can I set that?</p>\n"}, {"tags": ["haskell", "unix-socket"], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": true, "score": 4, "last_activity_date": 1428908337, "creation_date": 1428908337, "answer_id": 29599527, "question_id": 29593116, "link": "https://stackoverflow.com/questions/29593116/simple-unix-domain-sockets-server/29599527#29599527", "title": "Simple unix domain sockets server", "body": "<p>Your code only runs \"accept\" once, so it can only handle one connection. If you want to handle multiple connections, the \"accept\" part has to be repeated, not just the \"recv\" part.</p>\n\n<pre><code>module Main where\n\nimport Network.Socket hiding (send, sendTo, recv, recvFrom)\nimport Network.Socket.ByteString\nimport qualified Data.ByteString.Char8 as C\nimport Control.Monad\n\nmain :: IO ()\nmain = withSocketsDo $ do\n       sock &lt;- socket AF_UNIX Stream 0 -- and try UDP?\n       bind sock (SockAddrUnix \"/tmp/test_sock.ipc\")\n       listen sock maxListenQueue -- TODO is maxListenQueue what we want?\n       go sock\n       close conn\n       close sock\n       putStrLn \"DONE\"\n\n    where\n      go sock = do\n        (conn,_) &lt;- accept sock\n        talk conn\n        go sock\n      talk :: Socket -&gt; IO ()\n      talk conn =\n          do msg &lt;- recv conn 1024\n             unless (C.null msg) $ do\n               C.putStrLn msg \n               talk conn\n</code></pre>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 29599527, "answer_count": 1, "score": 4, "last_activity_date": 1428908337, "creation_date": 1428863904, "last_edit_date": 1428864916, "question_id": 29593116, "link": "https://stackoverflow.com/questions/29593116/simple-unix-domain-sockets-server", "title": "Simple unix domain sockets server", "body": "<p>I'm new to trying to program with Unix sockets, and struggling to get a simple server working. I'd like this to stay running and print messages it receives, but instead it prints the first message and exits. Depends on <code>network</code>, and <code>bytestring</code>.</p>\n\n<pre><code>module Main where\n\nimport Network.Socket hiding (send, sendTo, recv, recvFrom)\nimport Network.Socket.ByteString\nimport qualified Data.ByteString.Char8 as C\nimport Control.Monad\n\nmain :: IO ()\nmain = withSocketsDo $ do\n       sock &lt;- socket AF_UNIX Stream 0 -- and try UDP?\n       bind sock (SockAddrUnix \"/tmp/test_sock.ipc\")\n       listen sock maxListenQueue -- TODO is maxListenQueue what we want?\n       (conn, _) &lt;- accept sock\n       talk conn\n       close conn\n       close sock\n       putStrLn \"DONE\"\n\n    where\n      talk :: Socket -&gt; IO ()\n      talk conn =\n          do msg &lt;- recv conn 1024\n             unless (C.null msg) $ do\n               C.putStrLn msg \n               talk conn\n</code></pre>\n\n<p>I'm testing with <code>socat</code>, which I also don't really know how to use:</p>\n\n<pre><code>echo \"FOOOOO\" | socat - UNIX-CONNECT:/tmp/test_sock.ipc\n</code></pre>\n\n<p>Any pointers on the haskell code, and what I might be misunderstanding about unix sockets would be helpful.</p>\n\n<p><strong>EDIT</strong> Using <code>Datagram</code> instead of <code>Stream</code> I'm able to get more or less what I want:</p>\n\n<p>main :: IO ()\nmain = withSocketsDo $ do\n       sock &lt;- socket AF_UNIX Datagram 0 -- and try UDP?\n       bind sock (SockAddrUnix \"/tmp/test_sock.ipc\")\n       -- for Datagram:\n       talk sock\n       close sock\n       putStrLn \"DONE\"</p>\n\n<pre><code>where\n  talk :: Socket -&gt; IO ()\n  talk conn =\n      do msg &lt;- recv conn 1024\n         unless (C.null msg) $ do\n           C.putStrLn msg \n           talk conn\n</code></pre>\n\n<p>And I can test successfully with:</p>\n\n<pre><code>echo \"FOOOOO\" | socat - UNIX-SENDTO:/tmp/test_sock.ipc\n</code></pre>\n\n<p>I think I'm interested in datagram sockets anyway, but I'll leave this open if anyone wants to explain things to me.</p>\n"}, {"tags": ["windows", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1428863953, "post_id": 29592739, "comment_id": 47332996, "body": "It would probably be through the win32api if anything. I would look up how to do it there then figure out how to talk to that library with haskell. There are win32 libraries already written, but I don&#39;t personally know how complete they are."}, {"owner": {"reputation": 145, "user_id": 4055842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvqE0.jpg?s=128&g=1", "display_name": "kp9r4d", "link": "https://stackoverflow.com/users/4055842/kp9r4d"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428864281, "post_id": 29592739, "comment_id": 47333103, "body": "Thank you! As I understand there are no documentation on win32 package (<a href=\"https://hackage.haskell.org/package/Win32\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/Win32</a>). Seems like thats libraries are very &quot;rough&quot; now."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1428878538, "post_id": 29592739, "comment_id": 47337838, "body": "The latest version that has working Haddock links on Hackage is <a href=\"https://hackage.haskell.org/package/Win32-2.2.2.0\" rel=\"nofollow noreferrer\">2.2.2.0</a> (I assume the documentation buildbots don&#39;t use Windows). It&#39;s still in that lovely &quot;automatic list of functions and their types with no comments&quot; style we&#39;re all so fond of. Although that may be because it&#39;s a heap of bindings to standard Windows API that&#39;s documented elsewhere."}], "answers": [{"tags": [], "owner": {"reputation": 2667, "user_id": 325725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3db095f94749aaedfea12b927b13cf74?s=128&d=identicon&r=PG", "display_name": "Phyx", "link": "https://stackoverflow.com/users/325725/phyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1470468044, "creation_date": 1470468044, "answer_id": 38801646, "question_id": 29592739, "link": "https://stackoverflow.com/questions/29592739/get-focused-window-name-on-haskell-windows/38801646#38801646", "title": "Get focused window name on haskell (Windows)", "body": "<p>You probably want to use the <code>Win32</code> package or call the Windows API directly.</p>\n\n<p>You can use <code>getForegroundWindow</code> to get the handle to the the focused window and then use <code>GetWindowText</code> or <code>GetWindowInfo</code> depending on what you want.</p>\n\n<p>The <code>Win32</code> is unlikely to get any documentation as you can enter the exact same functions on MSDN and get documentation. Only extra functionality written by us will be documented. The reason is that we'd have to keep up with the documentation on MSDN and there just isn't the man power.</p>\n\n<p>I have been looking into automation, so if that succeeds then maybe :)</p>\n"}], "owner": {"reputation": 145, "user_id": 4055842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvqE0.jpg?s=128&g=1", "display_name": "kp9r4d", "link": "https://stackoverflow.com/users/4055842/kp9r4d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 38801646, "answer_count": 1, "score": 2, "last_activity_date": 1470468044, "creation_date": 1428862043, "question_id": 29592739, "link": "https://stackoverflow.com/questions/29592739/get-focused-window-name-on-haskell-windows", "title": "Get focused window name on haskell (Windows)", "body": "<p>I want to write timetracker. There is exist any way to know focused window name on Haskell?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 0, "creation_date": 1428856847, "post_id": 29591787, "comment_id": 47330633, "body": "<a href=\"http://stackoverflow.com/questions/576213/efficient-string-implementation-in-haskell\">Related</a>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1428884650, "post_id": 29591787, "comment_id": 47339242, "body": "The <code>[Char]</code> versus <code>String</code> is just an artifact of how type checking operates; it&#39;s probably because <code>(++)</code> operates on a general type <code>[a]</code> while <code>shows</code> is specific to <code>String</code>. There is no difference at all between <code>[Char]</code> and <code>String</code>."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 9, "last_activity_date": 1428856990, "creation_date": 1428856990, "answer_id": 29591869, "question_id": 29591787, "link": "https://stackoverflow.com/questions/29591787/string-concatenation-in-haskell-and-unwanted-quotes/29591869#29591869", "title": "String concatenation in Haskell and unwanted quotes", "body": "<p>Note that <code>show \"a\"</code> is <code>\"\\\"a\\\"\"</code>.  The point of <code>show</code> is to print something that can be interpreted by Haskell as a literal value with <code>Read</code>.  So \"showing\" a string means including the quote characters.  Instead you can use the <code>showChar</code> to build up a list like this:</p>\n\n<pre><code>&gt; (showChar 'a' . showChar 'b' . showChar 'c') \"\"\n\"abc\"\n&gt; length it  -- `it` refers to the result of the last computation in GHCi\n3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1428857099, "creation_date": 1428857099, "answer_id": 29591894, "question_id": 29591787, "link": "https://stackoverflow.com/questions/29591787/string-concatenation-in-haskell-and-unwanted-quotes/29591894#29591894", "title": "String concatenation in Haskell and unwanted quotes", "body": "<p><code>\"a\"</code> is to <code>show \"a\"</code> as <code>(\"a\" ++)</code> is to <code>shows \"a\"</code>. So:</p>\n\n<pre><code>&gt; \"a\" ++ \"b\" ++ \"c\"\n\"abc\"\n&gt; show \"a\" ++ show \"b\" ++ show \"c\"\n\"\\\"a\\\"\\\"b\\\"\\\"c\\\"\"\n&gt; ((\"a\" ++) . (\"b\" ++) . (\"c\" ++)) \"\"\n\"abc\"\n&gt; (shows \"a\" . shows \"b\" . shows \"c\") \"\"\n\"\\\"a\\\"\\\"b\\\"\\\"c\\\"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1428857103, "creation_date": 1428857103, "answer_id": 29591896, "question_id": 29591787, "link": "https://stackoverflow.com/questions/29591787/string-concatenation-in-haskell-and-unwanted-quotes/29591896#29591896", "title": "String concatenation in Haskell and unwanted quotes", "body": "<p>Function <code>shows</code>, like <code>show</code>, converts any type of data (of class <code>Show</code>) to a Haskell expression notation. For strings, this involves adding quotes and escaping special characters inside the string. </p>\n\n<p>If you want to concatenate <em>difference strings</em>, use <code>(++)</code> for strings instead of <code>shows</code>. E.g.</p>\n\n<pre><code>shows 3 . (++) \" , \" . shows 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "is_accepted": false, "score": 0, "last_activity_date": 1428874833, "creation_date": 1428874833, "answer_id": 29594961, "question_id": 29591787, "link": "https://stackoverflow.com/questions/29591787/string-concatenation-in-haskell-and-unwanted-quotes/29594961#29594961", "title": "String concatenation in Haskell and unwanted quotes", "body": "<p>From practical point of view, if you are really worried about efficiency you might want to use blaze-builder. The code would be something like:</p>\n\n<pre><code>unpack $ toLazyByteString (fromString \"a\" &lt;&gt; fromString \"b\" &lt;&gt; fromString \"c\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1587, "user_id": 3271946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446c713f3dc5528707d32819146a9789?s=128&d=identicon&r=PG&f=1", "display_name": "ArunasR", "link": "https://stackoverflow.com/users/3271946/arunasr"}, "is_accepted": false, "score": -1, "last_activity_date": 1428930345, "creation_date": 1428930345, "answer_id": 29606077, "question_id": 29591787, "link": "https://stackoverflow.com/questions/29591787/string-concatenation-in-haskell-and-unwanted-quotes/29606077#29606077", "title": "String concatenation in Haskell and unwanted quotes", "body": "<p>Use <code>Data.Text.append</code> for efficient chunking of strings.</p>\n"}], "owner": {"reputation": 6581, "user_id": 461202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f780ff5bfdfea60bdc260664f00b574?s=128&d=identicon&r=PG", "display_name": "zegkljan", "link": "https://stackoverflow.com/users/461202/zegkljan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 29591896, "answer_count": 5, "score": 3, "last_activity_date": 1428930345, "creation_date": 1428856494, "question_id": 29591787, "link": "https://stackoverflow.com/questions/29591787/string-concatenation-in-haskell-and-unwanted-quotes", "title": "String concatenation in Haskell and unwanted quotes", "body": "<p>I would like to concatenate a bunch of strings using <code>shows</code> because of efficiency (there might be a lot of them). However, when I do this I get unwanted <code>\"</code> characters:</p>\n\n<pre><code>Prelude&gt; \"a\" ++ \"b\" ++ \"c\"\n\"abc\" -- ordinary concatenation - expected result\nPrelude&gt; (shows \"a\" . shows \"b\" . shows \"c\") \"\"\n\"\\\"a\\\"\\\"b\\\"\\\"c\\\"\" -- actual result\n</code></pre>\n\n<p>Could someone please explain why does this happen and what should I do to achieve the <code>++</code> behaviour using the <code>shows</code> function?</p>\n\n<p>When I looked at the types of those above (just out of curiosity), I got the following:</p>\n\n<pre><code>Prelude&gt; :t (\"a\" ++ \"b\" ++ \"c\")\n(\"a\" ++ \"b\" ++ \"c\") :: [Char]\nPrelude&gt; :t ((shows \"a\" . shows \"b\" . shows \"c\") \"\")\n((shows \"a\" . shows \"b\" . shows \"c\") \"\") :: String\n</code></pre>\n\n<p>Does the <code>[Char]</code> in one case and <code>String</code> in the other case have to do anything with the behaviour of <code>++</code> and <code>shows</code>, even if <code>String</code> is just an alias for <code>[Char]</code>?</p>\n"}, {"tags": ["haskell", "lenses"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1428856744, "post_id": 29591432, "comment_id": 47330600, "body": "Sort of off-topic, but I have ideological problems with this question: <code>_last</code> cannot be a lens, for essentially the same reason <code>last</code> cannot be a function."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1428884997, "post_id": 29591432, "comment_id": 47339311, "body": "FWIW Template Haskell is definitely &quot;available&quot; for 7.8.3; it comes with every GHC installation that supports it, which is all of them except possibly for unusual architectures (non-x86/x86_64)."}, {"owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428916602, "post_id": 29591432, "comment_id": 47349480, "body": "@ReidBarton Ok then, misunderstood the root cause of the dependency resolution problems. I felt it would be nicer to go without templates/keep deps to a minimum for this particular project though."}], "answers": [{"comments": [{"owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "edited": false, "score": 0, "creation_date": 1428857487, "post_id": 29591853, "comment_id": 47330852, "body": "Yes. All those things are things I already know but failed to think about. Guess that&#39;s what happens when I try to do haskell while also doing other stuff. :)"}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 6, "last_activity_date": 1428856909, "creation_date": 1428856909, "answer_id": 29591853, "question_id": 29591432, "link": "https://stackoverflow.com/questions/29591432/creating-a-lenslike-for-list/29591853#29591853", "title": "Creating a lens(like) for list", "body": "<p>You are missing square brackets around <code>el</code> (<code>(++)</code> takes a list for both arguments). Your first try should work if you put them in. Your type is also too general. Lists aren't heterogenous in Haskell, so they can only contain values of one type.</p>\n\n<p>Also, as Daniel Wagner says, this can't be a true lens because it is partial. The lens documentation you linked to is out of date. The current lens library has <a href=\"http://hackage.haskell.org/package/lens-4.9/docs/Control-Lens-Cons.html#v:_last\"><code>_last</code> as a <code>Traversal</code></a> which avoids this problem because a <code>Traversal</code> can have 0 or more targets, as opposed to a lens which must have exactly 1.</p>\n"}], "owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 29591853, "answer_count": 1, "score": 4, "last_activity_date": 1429187300, "creation_date": 1428854458, "last_edit_date": 1429187300, "question_id": 29591432, "link": "https://stackoverflow.com/questions/29591432/creating-a-lenslike-for-list", "title": "Creating a lens(like) for list", "body": "<p>I'm trying to create lenses for the following data structure. I'm using <a href=\"https://hackage.haskell.org/package/lens-family\" rel=\"nofollow\"><code>lens-family</code></a>.</p>\n\n<pre><code>data Tree = Tree {\n        _text :: String,\n        _subtrees :: [Tree]\n    } deriving (Show,Eq,Read,Generic)\n</code></pre>\n\n<p>I'd like to avoid using Template Haskell for various reasons. For one, it seems it's not available for my version of ghc (7.8.3), that's another (out of scope) problem.</p>\n\n<p>Creating lenses for the record wasn't to hard. </p>\n\n<pre><code>text :: Lens' Tree String\ntext f (Tree text' subtrees') =\n  (\\text'' -&gt; Tree text'' subtrees') `fmap` (f text')\n\nsubtrees :: Lens' Tree [Tree]\nsubtrees f (Tree text' subtrees') =\n  (\\subtrees'' -&gt; Tree text' subtrees'') `fmap` (f subtrees')\n</code></pre>\n\n<p>But it seems that lens-family doesn't have default lenses for lists. I assume this is possible. There are for the <a href=\"http://hackage.haskell.org/package/lens-1.3.1/docs/Data-List-Lens.html\" rel=\"nofollow\"><code>lens</code> package</a>. These are my failed attempts:</p>\n\n<pre><code>import Lens.Family2\nimport Lens.Family2.Unchecked\n-- List lenses\n_last :: Lens [a] [a'] a a'\n_last f l =\n  -- first try\n  --lens getter setter\n  -- second try\n  (\\el -&gt; (init l) ++ el) `fmap`(f (last l))\n  where\n    getter = last\n    setter l el = l ++ el\n</code></pre>\n\n<p>They both get an error akin to this one:</p>\n\n<pre><code>Could not deduce (a' ~ [a'])\n    from the context (Functor f)\n      bound by the type signature for\n                 _last :: Functor f =&gt; LensLike f [a] [a'] a a'\n      at editor.hs:22:10-27\n      \u2018a'\u2019 is a rigid type variable bound by\n           the type signature for\n             _last :: Functor f =&gt; LensLike f [a] [a'] a a'\n           at editor.hs:22:10\n    Expected type: f [a']\n      Actual type: f a'\n    Relevant bindings include\n      f :: a -&gt; f a' (bound at editor.hs:23:7)\n      _last :: LensLike f [a] [a'] a a' (bound at editor.hs:23:1)\n    In the second argument of \u2018fmap\u2019, namely \u2018(f (last l))\u2019\n    In the expression: (\\ el -&gt; (init l) ++ el) `fmap` (f (last l))\n</code></pre>\n\n<p><strong>How can I define the <code>_last</code> lens?</strong></p>\n\n<p><strong>Edit:</strong> Here's a version that builds:</p>\n\n<pre><code>_last f l = (\\el -&gt; (init l) ++ [el]) `fmap`(f (last l))\n</code></pre>\n\n<p>Although, as David/Daniel points out, <code>_last</code> should be a Traversal, not a lens.</p>\n"}, {"tags": ["haskell", "parsec", "maybe"], "comments": [{"owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "edited": false, "score": 0, "creation_date": 1428843953, "post_id": 29589759, "comment_id": 47326606, "body": "You say &quot;specific parser&quot;, do you mean that there is only one parser which should be applied to each file? In that case why do you need a list of parsers?"}, {"owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "reply_to_user": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "edited": false, "score": 0, "creation_date": 1428844007, "post_id": 29589759, "comment_id": 47326618, "body": "@zudov yes only one specific parser is tried. But it is tried for multiple files in a directory."}], "answers": [{"comments": [{"owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "edited": false, "score": 0, "creation_date": 1428845599, "post_id": 29589987, "comment_id": 47327083, "body": "Actually, just <code>rights</code> would suffice for me. Thank you for this tip, it&#39;s actually exactly what I&#39;m looking for, but I was thinking differently."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1428845240, "creation_date": 1428845240, "answer_id": 29589987, "question_id": 29589759, "link": "https://stackoverflow.com/questions/29589759/take-a-single-succeeding-value-out-of-a-list-of-optional-parsers/29589987#29589987", "title": "Take a single succeeding value out of a list of optional Parsers", "body": "<p>You can run the parsers with <a href=\"http://hackage.haskell.org/package/parsec-3.1.9/docs/Text-Parsec.html#v:runParser\"><code>runParser</code></a>. This will give you a list of type <code>[Either ParseError (Maybe a)]</code>; you can use <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Either.html#v:partitionEithers\"><code>partitionEithers</code></a> to extract just the successful parses.</p>\n"}], "owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 29589987, "answer_count": 1, "score": 4, "last_activity_date": 1428912724, "creation_date": 1428843757, "last_edit_date": 1428912724, "question_id": 29589759, "link": "https://stackoverflow.com/questions/29589759/take-a-single-succeeding-value-out-of-a-list-of-optional-parsers", "title": "Take a single succeeding value out of a list of optional Parsers", "body": "<p>I have a function that has a signature</p>\n\n<pre><code>tryParseAllFilesInDir :: FilePath -&gt; [Parsec ByteString () (Maybe a)]\n</code></pre>\n\n<p>It tries to parse all files in a directory with a specific <code>Parser</code>. <strong>It is a given that only one file will actually succeed</strong>, but I don't know which file at runtime.</p>\n\n<p>I want to take the list of optional Parsers, and take the only succeeding Parser value out. I don't know what functions I would use to achieve this.</p>\n\n<p>I somehow have to go from <code>[Parsec ByteString () (Maybe a)] -&gt; [Maybe a]</code>, and then <code>[Maybe a] -&gt; Just a</code>.</p>\n\n<p>If there is a better approach to doing this, I would appreciate those as well.</p>\n"}, {"tags": ["algorithm", "haskell", "functional-programming", "simulation", "particle-system"], "comments": [{"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 0, "creation_date": 1428848089, "post_id": 29588791, "comment_id": 47327778, "body": "Do you want to apply the velocity verlet algorithm or something similar? I mean, do you wan to integrate Newton&#39;s equations of motion using some analytical or numerical potential?"}, {"owner": {"reputation": 367, "user_id": 1270740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f4b6ad64c4ae8ba4c159016841634ec?s=128&d=identicon&r=PG&f=1", "display_name": "dfj328", "link": "https://stackoverflow.com/users/1270740/dfj328"}, "reply_to_user": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 0, "creation_date": 1428852517, "post_id": 29588791, "comment_id": 47329249, "body": "nothing really so specific, I was just looking for possible higher order functions in haskell that could get the job done quicker in applying the velocityCalculator function across the lists"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 3, "last_activity_date": 1428885194, "last_edit_date": 1428885194, "creation_date": 1428884774, "answer_id": 29596236, "question_id": 29588791, "link": "https://stackoverflow.com/questions/29588791/haskell-particle-simulation-calculating-velocities-of-particles/29596236#29596236", "title": "Haskell Particle simulation - calculating velocities of particles", "body": "<p>Seems like you are pretty set on using <code>foldl</code>.  For example</p>\n\n<ol start=\"3\">\n<li>iterate through the list of particle, applying <code>foldl</code> to each element and building the new list containing the particles with the updated velocities</li>\n</ol>\n\n<p>doesn't really make sense.  You apply <code>foldl</code> to a list to reduce it to a \"summary value\", according to some binary summarizing function. It doesn't really make sense to apply it to a single particle.</p>\n\n<p>I am answering this question assuming you are having trouble writing the program in the first place -- it's usually best to do this before worrying about efficiency.  Let me know if I have assumed wrong.</p>\n\n<p>I am not sure what rule you want to use to update the velocities, but I assume it's some sort of pairwise force simulation, for example gravity or electromagnetism.  If this is so, here are some hints that will guide you to a solution.</p>\n\n<pre><code>type Vector = (Float, Float)\n\n-- Finds the force exerted on one particle by the other.\n-- Your code will be simplified if this returns (0,0) when the two\n-- particles are the same. \nfindForce :: Particle -&gt; Particle -&gt; Vector\n\n-- Find the sum of all forces exerted on the particle\n-- by every particle in the list. \ntotalForce :: [Particle] -&gt; Particle -&gt; Vector\n\n-- Takes a force and a particle to update, returns the same particle with\n-- updated velocity. \nupdateVelocity :: Vector -&gt; Particle -&gt; Particle\n\n-- Calculate mutual forces and update all particles' velocities\nupdateParticles :: [Particle] -&gt; [Particle]\n</code></pre>\n\n<p>Each of these functions will be quite short, one or two lines.  If you need further hints for which higher-order functions to use, pay attention to the type of the function you are trying to write, and note</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]           -- takes a list, returns a list\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]     -- takes a list, returns a list\nfoldl :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a -- takes a list, returns something else\nfoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b -- takes a list, returns something else\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 2, "last_activity_date": 1428952141, "creation_date": 1428952141, "answer_id": 29613154, "question_id": 29588791, "link": "https://stackoverflow.com/questions/29588791/haskell-particle-simulation-calculating-velocities-of-particles/29613154#29613154", "title": "Haskell Particle simulation - calculating velocities of particles", "body": "<p>You might achieve a speed up by a factor of 2 by memoization, if you give every <code>Particle</code> a <code>particle_id :: Int</code> ID and then define that:</p>\n\n<pre><code>forceOf a b | particle_id a &gt; particle_id b = -(forceOf b a)\n            | otherwise = (pos a - pos b) *:. charge a * charge b / norm (pos a - pos b) ^ 3\n</code></pre>\n\n<p>where <code>(*:.) :: Vector -&gt; Double -&gt; Vector</code> is vector-scalar multiplication so the above is a <code>1/r^2</code> force law. Notice that here we memoize <code>pos a - pos b</code> and then we also memoize <code>forceOf a b</code> for use as <code>forceOf b a</code>. </p>\n\n<p>Then you want to use <code>dvs = [dt * sum (map (forceOf a) particles) / mass a | a &lt;- particles]</code> to get a list of changes in velocity, then <code>zipWith (+) (map velocity particles) dvs</code></p>\n\n<p>One problem is that this approach doesn't do so well with numerical uncertainty: everything for time $t+1$ is based on things that were true at time $t$. You can start to solve this problem by solving a matrix equation; instead of v<sub>+</sub> = v + dt * <b>M</b> v (where v = v(t) and v<sub>+</sub> = v(t + 1)), you can write v<sub>+</sub> = v + dt * <b>M</b> v<sub>+</sub>, so that you have v<sub>+</sub> = (<b>1</b> \u2212 dt * <b>M</b>)<sup>-1</sup> v. That can often be more numerically stable. It is potentially even better to mix the two solutions 50/50. v<sub>+</sub> = v + dt * <b>M</b> (v + v<sub>+</sub>) / 2.There are lots of options here.</p>\n"}], "owner": {"reputation": 367, "user_id": 1270740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f4b6ad64c4ae8ba4c159016841634ec?s=128&d=identicon&r=PG&f=1", "display_name": "dfj328", "link": "https://stackoverflow.com/users/1270740/dfj328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1428952141, "creation_date": 1428837328, "last_edit_date": 1428837811, "question_id": 29588791, "link": "https://stackoverflow.com/questions/29588791/haskell-particle-simulation-calculating-velocities-of-particles", "title": "Haskell Particle simulation - calculating velocities of particles", "body": "<p>I am working on a particle simulation program using Haskell. For one of the functions I am trying to determine the new velocities of all the particles in the simulation based on the mass and velocities of all the surrounding particles.</p>\n\n<p>The function is of this form:</p>\n\n<pre><code>accelerate :: Float -&gt; [Particle] -&gt; [Particle]\n</code></pre>\n\n<p>Particle is a data type that contains the mass, position vector and velocity vector, the 'Float' argument represents the delta time of the respective time step in the simulation</p>\n\n<p>I would like some suggestions on possible functions I can use to traverse the list while calculating the velocities of each of the particles with respect to the other particles in the list.</p>\n\n<p>One possible approach I can think of:</p>\n\n<ol>\n<li><p>assume there is another function 'velocityCalculator' which has the following definition:</p>\n\n<pre><code>velocityCalculator :: Particle -&gt; Particle -&gt; (Float,Float)\n</code></pre></li>\n</ol>\n\n<p>This takes two particles and returns the updated velocity vector for the first particle.</p>\n\n<ol start=\"2\">\n<li><p>apply foldl; using the above function as the binary operator, a particle and the list of particles as the arguments, i.e.</p>\n\n<pre><code>foldl velocityCalculator particle particleList\n</code></pre></li>\n<li><p>iterate through the list of particle, applying foldl to each element and building the new list containing the particles with the updated velocities</p></li>\n</ol>\n\n<p>I am not sure if this is the most efficient method so any suggestions and improvements are very much appreciated.</p>\n\n<p><strong>PLEASE NOTE -> as I have said I am only looking for suggestions not an answer!</strong></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "tuples", "monads", "functor", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 1, "creation_date": 1428835827, "post_id": 29588534, "comment_id": 47324457, "body": "Okay, thanks @AJFarmer.   I feared it couldn&#39;t be done,  but couldn&#39;t explicitly reason why; so figured it&#39;s worth asking,  if only to clarify why not.  The key seems to be that the fn passed as first arg is pinned down to a single specific a at instantiation time,  unless we use rankNTypes as you say."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1428837555, "post_id": 29588534, "comment_id": 47324918, "body": "@user3416536 that&#39;s right; type variables are carried across a function&#39;s type, and it&#39;s not implicit that two types with different variables are equal, but it&#39;s possible. <code>forall</code> just says that it can work on any type, which, of course, includes <code>m x</code> and <code>m y</code>!"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1428837371, "last_edit_date": 1428837371, "creation_date": 1428835485, "answer_id": 29588534, "question_id": 29588424, "link": "https://stackoverflow.com/questions/29588424/haskell-how-to-map-a-function-over-an-arbitrary-tuple-of-monads/29588534#29588534", "title": "Haskell: how to map a function over an arbitrary tuple of monads", "body": "<p>It's not possible in the way that you're saying.</p>\n\n<p>In your type signature, the initial function can only take an <code>m a</code>, but you expect to pass it an <code>m x</code> and an <code>m y</code>, so the types don't match.</p>\n\n<p>It's certainly possible to do it with <code>rankNTypes</code> enabled:</p>\n\n<pre><code>{-# LANGUAGE rankNTypes #-}\nf :: Monad m =&gt; (forall a. m a -&gt; m [a]) -&gt; (m x, m y) -&gt; (m [x], m [y])\nf fun (x, y) = (fun x, fun y)\n</code></pre>\n\n<p>This is because <code>forall a.</code> inside the brackets forces it to be polymorphic, rather than just for a type <code>a</code>.</p>\n\n<hr>\n\n<p>What you're probably wanting is something like this:</p>\n\n<pre><code>f :: Monad m =&gt; (a -&gt; m b) -&gt; (m a, m a) -&gt; (m b, m b)\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>f :: Monad m =&gt; (a -&gt; m c) -&gt; (b -&gt; m d) -&gt; (m a, m b) -&gt; (m c, m d)\n</code></pre>\n\n<p>Note that I changed the function type from <code>m a -&gt; m b</code> to <code>a -&gt; m b</code> because that allows us to sequence monadic actions, rather than transform the monad, which makes more sense when we want to manipulate them.</p>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1428838670, "creation_date": 1428834719, "last_edit_date": 1495542491, "question_id": 29588424, "link": "https://stackoverflow.com/questions/29588424/haskell-how-to-map-a-function-over-an-arbitrary-tuple-of-monads", "title": "Haskell: how to map a function over an arbitrary tuple of monads", "body": "<p>Is it possible to construct a function that will map of a tuple of monads of arbitrary arity? </p>\n\n<p>E.g.,</p>\n\n<pre><code>f :: (m a -&gt; m [a]) -&gt; (m x, m y) -&gt; (m [x], m [y])\n</code></pre>\n\n<p>(but for arbitrary arity). <a href=\"https://stackoverflow.com/questions/9722689/haskell-how-to-map-a-tuple\">This similar question</a>, has a number of promising suggestions; e.g., lens' <code>each</code> or <code>over both</code>, but each seem to require a tuple of homogenous types: I want to use a tuple of homogenous monads with differing inner types.</p>\n"}, {"tags": ["scala", "haskell", "compiler-construction", "f#", "functional-programming"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1428832950, "post_id": 29588141, "comment_id": 47323834, "body": "How does lacking assignment cause a problem, exactly? I&#39;m not sure I follow..."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 2, "creation_date": 1428871696, "post_id": 29588141, "comment_id": 47335839, "body": "The fact that it&#39;s an AST is nothing special; this &quot;problem&quot; is no different to any other situation where an imperative programmer would use mutation to update a structure."}, {"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1428872049, "post_id": 29588141, "comment_id": 47335969, "body": "@Ben Right, but the interesting twist is it&#39;s a recursive structure based on nodes."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1428882644, "post_id": 29588141, "comment_id": 47338860, "body": "The new C# and VB.NET compilers by Microsoft (codename Roslyn) are purely functional and open-source, in addition to being industrial-strength production-ready &quot;real-world&quot; compilers. They are also compilers for an imperative language written in an imperative language in a purely functional style. (Well, at least the data structures are immutable.)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1428887641, "post_id": 29588141, "comment_id": 47339850, "body": "@fredoverflow Yes, but I&#39;m afraid that&#39;s not actually a twist. Recursive data structures are <i>incredibly</i> common in in functional programming, and the need to &quot;update&quot; them is a problem functional programmers encounter very early in their learning, in almost any domain (not just compilers). So to a certain extent, this question is yet another iteration of &quot;how does pure functional programming work without mutation?&quot;."}, {"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 2, "creation_date": 1428916408, "post_id": 29588141, "comment_id": 47349374, "body": "@Ben Yes, adding a number to a tree of numbers is very common and well-understood. But how common is it that you need to add another field to the element type of the tree later? I&#39;d imagine there are lots of possible solutions to this problem, but I have no practical experience."}, {"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1428916528, "post_id": 29588141, "comment_id": 47349437, "body": "@J&#246;rgWMittag It would be awesome if you could finde the time to condense Roslyn&#39;s approach into an answer :)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1428987334, "post_id": 29588141, "comment_id": 47383220, "body": "@fredoverflow Ah, I misunderstood then! But in that case you&#39;re making a false comparison between imperative and functional; you can only assign the <code>type</code> field to <code>null</code> in the imperative compiler because you already prepared for the need to later add type annotation, and included a <code>type</code> field in your ADT to initially be <code>null</code>. You can do <i>exactly</i> the same thing in a pure functional approach, by adding a type field that can be set to a value that indicates &quot;not yet tagged with a type&quot; (probably <code>Maybe TypeInfo</code> initially set to <code>Nothing</code>, in Haskellish terms)."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1428987521, "post_id": 29588141, "comment_id": 47383277, "body": "@fredoverflow There are also lots of other ways (external tags, using generics to support an arbitrary &quot;extra&quot; field in your records). But those also have very little to do with imperative vs functional programming, and could be just as well used by an imperative compiler."}, {"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1429003219, "post_id": 29588141, "comment_id": 47390844, "body": "@Ben Sure, but the &quot;functional null&quot; approach seems super hacky to me. At least way more hacky than the &quot;imperative null&quot; approach :)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1429016946, "post_id": 29588141, "comment_id": 47399284, "body": "@fredoverflow Really? I find nulls <i>way</i> more hacky than than maybes! And imperative-ness has nothing to do with it. Anyway, I&#39;ve diverged quite a way from commenting on the original question. :)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1428837106, "last_edit_date": 1428837106, "creation_date": 1428834987, "answer_id": 29588453, "question_id": 29588141, "link": "https://stackoverflow.com/questions/29588141/how-do-purely-functional-compilers-annotate-the-ast-with-type-info/29588453#29588453", "title": "How do purely functional compilers annotate the AST with type info?", "body": "<p>There are several options to model this. You may use the same kind of nullable data fields as in your imperative case:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Exp = Var Name (Maybe Type) | ...\nparse :: String -&gt; Maybe Exp     -- types are Nothings here\ntypeCheck :: Exp -&gt; Maybe Exp    -- turns Nothings into Justs\n</code></pre>\n\n<p>or even, using a more precise type</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Exp ty = Var Name ty | ...\nparse :: String -&gt; Maybe (Exp ())\ntypeCheck :: Exp () -&gt; Maybe (Exp Type)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9089, "user_id": 293147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247ce1ecd6cce2377ff3194386362392?s=128&d=identicon&r=PG", "display_name": "SK-logic", "link": "https://stackoverflow.com/users/293147/sk-logic"}, "is_accepted": false, "score": 6, "last_activity_date": 1428839148, "creation_date": 1428839148, "answer_id": 29589083, "question_id": 29588141, "link": "https://stackoverflow.com/questions/29588141/how-do-purely-functional-compilers-annotate-the-ast-with-type-info/29589083#29589083", "title": "How do purely functional compilers annotate the AST with type info?", "body": "<p>I usually rewrite a source (or an already several steps lowered) AST into a new form, replacing each <code>expression</code> node with a pair <code>(tag, expression)</code>. </p>\n\n<p>Tags are unique numbers or symbols which are then used by the next pass which derives type equations from the AST. E.g., <code>a + b</code> will yield something like { <code>numeric(Tag_a).</code> <code>numeric(Tag_b).</code> <code>equals(Tag_a, Tag_b).</code> <code>equals(Tag_e, Tag_a).</code>}.</p>\n\n<p>Then types equations are solved (e.g., by simply running them as a Prolog program), and, if successful, all the tags (which are variables in this program) are now bound to concrete types, and if not, they're left as type parameters.</p>\n\n<p>In a next step, our previous AST is rewritten again, this time replacing tags with all the inferred type information.</p>\n\n<p>The whole process is a sequence of pure rewrites, no need to replace anything in your AST destructively. A typical compilation pipeline may take a couple of dozens of rewrites, some of them changing the AST datatype.</p>\n"}, {"tags": [], "owner": {"reputation": 1022, "user_id": 825320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed628ac0ac2c3b640b098fc4af7af5c?s=128&d=identicon&r=PG", "display_name": "neil danson", "link": "https://stackoverflow.com/users/825320/neil-danson"}, "is_accepted": false, "score": 3, "last_activity_date": 1428936498, "creation_date": 1428936498, "answer_id": 29608323, "question_id": 29588141, "link": "https://stackoverflow.com/questions/29588141/how-do-purely-functional-compilers-annotate-the-ast-with-type-info/29608323#29608323", "title": "How do purely functional compilers annotate the AST with type info?", "body": "<p>I cant speak for how it is <em>supposed</em> to be done, but I did do this in F# for a C# compiler <a href=\"https://github.com/neildanson/MicroCS\" rel=\"nofollow\">here</a></p>\n\n<p>The approach was basically - build an AST from the source, leaving things like type information unconstrained - So AST.fs basically is the AST which strings for the type names, function names, etc. </p>\n\n<p>As the AST starts to be compiled to (in this case) .NET IL, we end up with more type information (we create the types in the source - lets call these type-stubs). This then gives us the information needed to created method-stubs (the code may have signatures that include type-stubs as well as built in types). From here we now have enough type information to resolve any of the type names, or method signatures in the code. </p>\n\n<p>I store that in the file TypedAST.fs. I do this in a single pass, however the approach may be naive. </p>\n\n<p>Now we have a fully typed AST you could then do things like compile it, fully analyze it, or whatever you like with it. </p>\n\n<p>So in answer to the question \"<em>Does that mean I need to define two types per AST node, one for the syntax phase, and one for the semantic phase?</em>\", I cant say definitively that this is the case, but it is certainly what I did, and it appears to be what MS have done with Roslyn (although they have essentially decorated the original tree with type info IIRC)</p>\n\n<p>\"<em>Are there purely functional programming tricks that help the compiler writer with this problem?</em>\"\nGiven the ASTs are essentially mirrored in my case, it would be possible to make it generic and transform the tree, but the code <em>may</em> end up (more) horrendous. </p>\n\n<p>i.e.</p>\n\n<pre>\ntype 'type AST;\n| MethodInvoke of 'type * Name * 'type list\n| ....\n</pre>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 0, "last_activity_date": 1429442064, "creation_date": 1429442064, "answer_id": 29729097, "question_id": 29588141, "link": "https://stackoverflow.com/questions/29588141/how-do-purely-functional-compilers-annotate-the-ast-with-type-info/29729097#29729097", "title": "How do purely functional compilers annotate the AST with type info?", "body": "<p>Like in the case when dealing with relational databases, in functional programming it is often a good idea not to put everything in a single data structure.</p>\n\n<p>In particular, there may not be a data structure that is \"the AST\".</p>\n\n<p>Most probably, there will be data structures that represent parsed expressions. One possible way to deal with type information is to assign a unique identifier (like an integer) to each node of the tree already during parsing and have some suitable data structure (like a hash map) that associates those node-ids with types. The job of the type inference pass, then, would be just to create this map.</p>\n"}], "owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1244, "favorite_count": 2, "accepted_answer_id": 29729097, "answer_count": 4, "score": 8, "last_activity_date": 1429896196, "creation_date": 1428832522, "question_id": 29588141, "link": "https://stackoverflow.com/questions/29588141/how-do-purely-functional-compilers-annotate-the-ast-with-type-info", "title": "How do purely functional compilers annotate the AST with type info?", "body": "<p>In the syntax analysis phase, an imperative compiler can build an AST out of nodes that already contain a <code>type</code> field that is set to <code>null</code> during construction, and then later, in the semantic analysis phase, fill in the types by assigning the declared/inferred types into the <code>type</code> fields.</p>\n\n<p>How do purely functional languages handle this, where you do not have the luxury of assignment? Is the type-less AST mapped to a different <em>kind</em> of type-enriched AST? Does that mean I need to define two types per AST node, one for the syntax phase, and one for the semantic phase?</p>\n\n<p>Are there purely functional programming tricks that help the compiler writer with this problem?</p>\n"}, {"tags": ["haskell", "metaprogramming", "dsl"], "answers": [{"comments": [{"owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 0, "creation_date": 1428921957, "post_id": 29590229, "comment_id": 47352533, "body": "So that means I could have &#39;c&#39; be JsFunc, and say I had a javascript prelude which had a Maybe type (&#39;f&#39; becomes Maybe). It would allow me to make a monad instance of the javascript Maybe type for the code generator? I&#39;d have to use Js&#39;s &#39;lam&#39; instead of haskell&#39;s lambda, but still pretty cool."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1428847472, "last_edit_date": 1428847472, "creation_date": 1428847110, "answer_id": 29590229, "question_id": 29588127, "link": "https://stackoverflow.com/questions/29588127/changing-haskells-functor-for-metaprogramming/29590229#29590229", "title": "Changing Haskell&#39;s Functor for Metaprogramming", "body": "<p>According to <a href=\"https://mail.haskell.org/pipermail/haskell/2004-July/014315.html\" rel=\"nofollow\">this mailing list post</a>, applicative functors are known in the math literature as \"weakly symmetric lax monoidal functors\". A (brief, not careful) look at the nlab page for <a href=\"http://nlab.mathforge.org/nlab/show/monoidal+functor\" rel=\"nofollow\">lax monoidal</a> suggests that this concept is also parameterized by two categories, so you can probably extend this parametric functor class to a parametric applicative class with some work.</p>\n\n<p>As you say, monads are endofunctors, so they can't be parameterized by two categories. But the one category they have as a parameter need not be Hask; so one could give a parameterized monad as well, like</p>\n\n<pre><code>class Functor c c f =&gt; Monad c f where\n    return :: c a (f a)\n    join :: c (f (f a)) (f a)\n</code></pre>\n\n<p>Then we can use a sort of standard trick to define bind:</p>\n\n<pre><code>(=&lt;&lt;) :: Monad c m =&gt; c a (m b) -&gt; c (m a) (m b)\n(=&lt;&lt;) f = join . fmap f\n</code></pre>\n\n<p>The <code>(.)</code> operation here is the composition from the <code>Category</code> class, not function composition from <code>Prelude</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1428863159, "post_id": 29590282, "comment_id": 47332721, "body": "shouldn&#39;t that be <code>lam :: String -&gt; JsFunc () b -&gt; JsFunc a b</code>?"}, {"owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 0, "creation_date": 1428874256, "post_id": 29590282, "comment_id": 47336634, "body": "Would haskell&#39;s Arrow type class have to change to use arrow do-notation? The &#39;arr&#39; would lift arbitrary haskell functions into JsFunc that can not get translated to JavaScript."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 1, "creation_date": 1428875483, "post_id": 29590282, "comment_id": 47336987, "body": "@clinux: right, I&#39;d forgotten about that. It&#39;s actually a bit of a hack in the <code>Arrow</code> class to allow lifting arbitrary Haskell functions \u2013 the class is IMO <i>supposed</i> to represent well-pointed monoidal categories, but these require a whole lot of methods (<code>fst</code>, <code>const</code> etc.), which can be seven-in-a-swipe&#39;d with <code>arr</code>. That&#39;s also something I have different <a href=\"http://hackage.haskell.org/package/constrained-categories-0.2.0.0/docs/Control-Arrow-Constrained.html\" rel=\"nofollow noreferrer\">in my categories library</a>."}, {"owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 0, "creation_date": 1428922385, "post_id": 29590282, "comment_id": 47352772, "body": "Yeah, thats right. You can do without &#39;arr&#39; with a fist full of extra methods. Have you seen GArrow? <a href=\"http://www.megacz.com/berkeley/garrows/\" rel=\"nofollow noreferrer\">megacz.com/berkeley/garrows</a> . I was thinking, if you can generalise an arrow in this way, can you also generalise an applicative? Every arrow that has its first type held fixed (not the correct terminology) is an instance of an Applicative. Does there exist a GApplicative?"}, {"owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 0, "creation_date": 1428923271, "post_id": 29590282, "comment_id": 47353283, "body": "Actually your definition of Applicative is like the generalised applicative I&#39;m looking for? It just confuses me to read it :p"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 0, "creation_date": 1428931992, "post_id": 29590282, "comment_id": 47358848, "body": "@clinux: <code>Applicative</code> is actually <i>equivalent</i> to <code>Monoidal</code> \u2013 but <code>pure</code> only works for endofunctors, and <code>(&lt;*&gt;)</code> only in cartesian closed categories. So,..."}, {"owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428933216, "post_id": 29590282, "comment_id": 47359695, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/75124/discussion-between-clinux-and-leftaroundabout\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1428866828, "last_edit_date": 1428866828, "creation_date": 1428847465, "answer_id": 29590282, "question_id": 29588127, "link": "https://stackoverflow.com/questions/29588127/changing-haskells-functor-for-metaprogramming/29590282#29590282", "title": "Changing Haskell&#39;s Functor for Metaprogramming", "body": "<p>Well, first &ndash;</p>\n\n<blockquote>\n  <p>... if it used real Functors and not just Endofunctors ...</p>\n</blockquote>\n\n<p>Haskell functors <em>are</em> real functors. Only, the <code>Functor</code> class doesn't allow <em>any</em> kind of general functors, but only the specific ones that are endofunctors on <strong>Hask</strong>.</p>\n\n<p>Indeed, non-endo&ndash;functors are interesting; mathematicians use them all the time. And while as you say, there can't be non-endofunctor monads, an analogue to <code>Applicative</code> <em>is</em> possible: that class is really just a nice Haskell interface for <a href=\"https://en.wikipedia.org/wiki/Monoidal_functor\" rel=\"nofollow\">monoidal functors</a>, which can be defined between different categories. Looks about like this:</p>\n\n<pre><code>class (Functor r t f, Category r, Category t) =&gt; Monoidal r t f where\n  pureUnit :: () `t` f ()\n  fzipWith :: (a, b) `r` c -&gt; (f a, f b) `t` f c\n</code></pre>\n\n<p>To actually use this anywhere as conveniently as the standard <code>Applicative</code> class though, you'll need a bit more than just the <code>Monoidal</code> class. This has been tryied in a <a href=\"http://hackage.haskell.org/package/category-extras\" rel=\"nofollow\">couple</a> of <a href=\"http://hackage.haskell.org/package/data-category\" rel=\"nofollow\">libraries</a>. I also <a href=\"http://hackage.haskell.org/package/constrained-categories-0.2.0.0/docs/Control-Applicative-Constrained.html\" rel=\"nofollow\">wrote one</a>. But, well... it doesn't exactly look beautiful...</p>\n\n<pre><code>class (Functor f r t, Cartesian r, Cartesian t) =&gt; Monoidal f r t where\n  pureUnit :: UnitObject t `t` f (UnitObject r)\n  fzipWith :: (ObjectPair r a b, Object r c, ObjectPair t (f a) (f b), Object t (f c))\n              =&gt; r (a, b) c -&gt; t (f a, f b) (f c)\n\nclass (Monoidal f r t, Curry r, Curry t) =&gt; Applicative f r t where\n  -- ^ Note that this tends to make little sense for non-endofunctors. \n  --   Consider using 'constPure' instead.\n  pure :: (Object r a, Object t (f a)) =&gt; a `t` f a \n\n  (&lt;*&gt;) :: ( ObjectMorphism r a b\n           , ObjectMorphism t (f a) (f b), Object t (t (f a) (f b))\n           , ObjectPair r (r a b) a, ObjectPair t (f (r a b)) (f a)\n           , Object r a, Object r b )\n       =&gt; f (r a b) `t` t (f a) (f b)\n  (&lt;*&gt;) = curry (fzipWith $ uncurry id)\n</code></pre>\n\n<p>I don't know if any of these frameworks would allow you to write the applicative JS code you want in a practical way. Possibly, but actually I rather suspect it would get <em>very</em> messy. Also note that, while you now have applicatives floating around, this doesn't mean you can actually do what's normally done with <strong>Hask</strong> applicatives in Js code &ndash; on the contrary, you'd actually need to wrap those applicatives as transformers around the <code>Js</code> type.</p>\n\n<p>You might want to consider abandoning &ldquo;JS values&rdquo; as such completely, and <em>only</em> write in a category/arrow paradigm instead. I.e., turn the definition around:</p>\n\n<pre><code>data JsFunc a b where\n    litInt :: Integer -&gt; JsFunc () Integer\n    litString :: String -&gt; JsFunc () String\n    var :: String -&gt; JsFunc () a\n    lam :: String -&gt; JsFunc () b -&gt; JsFunc a b\n    let :: String -&gt; JsFunc () a -&gt; JsFunc () b -&gt; JsFunc () b\n    ap :: JsFunc a b -&gt; JsFunc () a -&gt; JsFunc () b\n\ntype Js = JsFunc ()\n</code></pre>\n\n<p>here, we use <code>()</code> as the <a href=\"https://en.wikipedia.org/wiki/Initial_and_terminal_objects\" rel=\"nofollow\">terminal object</a> of the <code>JsFunc</code> category &ndash; which makes the <code>Js a \u2261 JsFunc () a</code> arrows equivalent to what we normally call <em>values</em> (at least if we don't consider strictness semantics). If you go that route, pretty much everything needs to be written point-free, but there's <a href=\"https://downloads.haskell.org/~ghc/7.8.2/docs/html/users_guide/arrow-notation.html\" rel=\"nofollow\">syntax to pretend otherwise</a>, and you can nicely incorporate functors and even monads (as Kleisli arrows).</p>\n"}, {"comments": [{"owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "edited": false, "score": 0, "creation_date": 1428921170, "post_id": 29596164, "comment_id": 47352093, "body": "The Apply type-class is a subclass of Functor (Haskell&#39;s Endofunctor), so you really can not make it an instance of Apply."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1428884217, "creation_date": 1428884217, "answer_id": 29596164, "question_id": 29588127, "link": "https://stackoverflow.com/questions/29588127/changing-haskells-functor-for-metaprogramming/29596164#29596164", "title": "Changing Haskell&#39;s Functor for Metaprogramming", "body": "<blockquote>\n  <p>we can have c be JsFunc, d be Hask and have t be Js</p>\n</blockquote>\n\n<p>Well, no we can't exactly since <code>JsFunc</code> is an unsaturated type synonym, so we can't instantiate a variable (<code>c</code>) to it.</p>\n\n<p>You could create a newtype</p>\n\n<pre><code>newtype JsCat a b = JsCat (Js (a -&gt; b))\n</code></pre>\n\n<p>and then create a <code>Functor JsCat (-&gt;) Js</code> like you say.</p>\n\n<p>However, this doesn't give you anything new since if we expand what you wanted the type of <code>fmap</code> to be, it becomes</p>\n\n<pre><code>fmap :: JsFunc a b -&gt; (-&gt;) (Js a) (Js b) -- or\nfmap :: Js (a -&gt; b) -&gt; Js a -&gt; Js b\n</code></pre>\n\n<p>which is none other than an <code>Apply</code> instance for <code>Js</code>. So, I'm not sure why you want to make this into a functor when it already fits into an existing abstraction.</p>\n"}], "owner": {"reputation": 2662, "user_id": 377248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ff67f64a05a15eceb6de6a9421b15d8?s=128&d=identicon&r=PG", "display_name": "clinux", "link": "https://stackoverflow.com/users/377248/clinux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 29590282, "answer_count": 3, "score": 8, "last_activity_date": 1428884217, "creation_date": 1428832431, "last_edit_date": 1428844348, "question_id": 29588127, "link": "https://stackoverflow.com/questions/29588127/changing-haskells-functor-for-metaprogramming", "title": "Changing Haskell&#39;s Functor for Metaprogramming", "body": "<p>My knowledge of category theory isn\u2019t very good. So please bear with me.</p>\n\n<p>I\u2019ve been reading <a href=\"http://www.stephendiehl.com/posts/monads.html\">Monads Made Difficult</a></p>\n\n<p>and saw the following definition.</p>\n\n<pre><code>class (Category c, Category d) =&gt; Functor c d t where\n  fmap :: c a b -&gt; d (t a) (t b)\n</code></pre>\n\n<p>from that site I read that the Functor type in Haskell\u2019s prelude is really an Endofunctor. (where both category c and d in the above class are Hask)</p>\n\n<p>After reading through the page, I was wondering. Would Haskell be better suited for meta-programming if it used real Functors and not just Endofunctors?</p>\n\n<p>say we have the following (the Js stands for Javascript)</p>\n\n<pre><code>data Js a where\n  litInt :: Integer -&gt; Js Integer\n  litString :: String -&gt; Js String\n  var :: String -&gt; Js a\n  lam :: String -&gt; Js b -&gt; Js (a -&gt; b)\n  let :: String -&gt; Js a -&gt; Js b -&gt; Js b\n  ap :: JsFunc a b -&gt; Js a -&gt; Js b\n\ntype JsFunc a b = Js (a -&gt; b)\n</code></pre>\n\n<p>now back to the definition of Functor above</p>\n\n<pre><code>class (Category c, Category d) =&gt; Functor c d t where\n  fmap :: c a b -&gt; d (t a) (t b)\n</code></pre>\n\n<p>we can have c be JsFunc, d be Hask and have t be Js</p>\n\n<p>this will give us a Functor for Js. That I could not do using Haskell\u2019s Endofunctor.</p>\n\n<p>I could not find anything for the Apply or Applicative type-classes defined in the same way as this Functor. Could the same be done with those too?</p>\n\n<p>And correct me if I\u2019m wrong. But the same can not be done for Monad, because it really an instance of an Endofunctor?</p>\n"}, {"tags": ["haskell", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1428834593, "post_id": 29588189, "comment_id": 47324180, "body": "<i>It is</i> unsafe. Please, give me an example of a real world application, where <code>&quot;123456789012345678901234567890&quot;</code> should be parsed to <code>-4362896299872285998</code>? There is no such application. Exact same behavior in C#? This is absolutely not true. In C# <code>Convert.ToInt32</code> throws <code>OverflowException</code>. In Java <code>Integer.ParseInt</code> throws <code>NumberFormatException</code>."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1428835460, "post_id": 29588189, "comment_id": 47324371, "body": "@ZhekaKozlov 1. Nobody uses <code>&quot;12345678901234567890&quot;</code> with limited types such as <code>Int32</code> in C# or <code>Int</code> in Haskell (at least when dealing with code which requires security). 2. This behavior is absolutely and completely type safe because type safety does not automatically enforce semantic correctness. For example you can create instances of type classes which then type check but do not enforce the rules defined for instances of said class."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1428841798, "post_id": 29588189, "comment_id": 47326009, "body": "&quot;Incorrect&quot; and &quot;unsafe&quot; are not the same thing. Your code is incorrect if it gives you the wrong answer. It is only <i>unsafe</i> if it can actually crash the whole application, or corrupt main memory so that other unrelated parts of the application malfunction."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1428882964, "post_id": 29588189, "comment_id": 47338929, "body": "Incorrect is usually worse than <code>error</code>, since at least if you get an error you know that something went wrong. Real undefined behavior can in principle look like a successful execution if you are unlucky, but usually it just results in a crash."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1428927816, "post_id": 29588189, "comment_id": 47356015, "body": "@ZhekaKozlov In C#, calling <code>Convert.ToInt32()</code> throws an exception. However, <code>(int)myLong</code> does <i>not</i> throw any exception. (One is a method call, the other is a type conversion. The <i>method</i> does a range-check; the <i>typecast</i> does not.) You are right, however, that (for example) <code>int.TryParse()</code> does a range check. Perhaps it would be helpful for Haskell&#39;s <code>read</code> method (only) to add this check..."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1428832875, "creation_date": 1428832875, "answer_id": 29588189, "question_id": 29587201, "link": "https://stackoverflow.com/questions/29587201/convert-string-to-int-checking-for-overflow/29588189#29588189", "title": "Convert String to Int checking for overflow", "body": "<p>If isn't \"unsafe\", in that the behaviour of the problem isn't undefined. (It's perfectly <em>defined</em>, just probably not what you wanted.) For example, <code>unsafeWriteAray</code> is unsafe, in that if you make a mistake with it, it writes data into arbitrary memory locations, either causing your application to segfault, or merely making corrupt its own memory, causing it behave in arbitrary <em>undefined</em> ways.</p>\n\n<p>So much for splitting hairs. If you want to deal with such huge numbers, <code>Integer</code> is the only way to go. But you probably knew that already.</p>\n\n<p>As for why there's no overflow check... Sometimes you actually <em>want</em> a number to overflow. (E.g., you might convert to <code>Word8</code> without explicitly ANDing out the bottom 8 bits.) At any rate, every possible arithmetic operation can potentially overflow (e.g., <code>maxBound + 1 = minBound</code>, and that's just normal addition.) Do you really want every single arithmetic operation to have an overflow check, slowing your program down at every step?</p>\n\n<p>You get the exact same behaviour in C, C++ or C#. I guess the difference is, in C# we have the <code>checked</code> keyword, which allows you to automatically check for overflow. Maybe somebody has a Haskell package for doing checked arithmetic&hellip; For now, it's probably simpler to just implement this one check yourself.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1428856804, "post_id": 29591282, "comment_id": 47330621, "body": "Some minor comments: saying <code>read</code> needs to be fast is a bit odd, as <code>read</code> is generally considered quite slow. It is not easy to check whether an arbitrary multiplication has overflowed from within Haskell, but a multiplication by ten ought to be easy to check (just see if the sign changed)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428858160, "post_id": 29591282, "comment_id": 47331059, "body": "@DanielWagner, you&#39;re right; <code>read</code> is considered slow. Perhaps we should fix that. And I guess you&#39;re probably right about the multiplication by ten, in this context, but I need to think about that a bit more."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1428883299, "post_id": 29591282, "comment_id": 47338986, "body": "It&#39;s true that <code>Int</code> is a modular arithmetic type but usually people choose it as a more efficient Integer, or because it is the type used by List functions, not because they actually want modular arithmetic behavior."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428884034, "post_id": 29591282, "comment_id": 47339121, "body": "@ReidBarton, they want cheaper integers, yes, but I imagine they don&#39;t want to have to reassociate or distribute operations to avoid overflow exceptions!"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428884262, "post_id": 29591282, "comment_id": 47339168, "body": "They probably do want exceptions on overflow."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428884451, "post_id": 29591282, "comment_id": 47339204, "body": "Ada and a recent proposal to C (I think) have something interesting called &quot;as if infinitely ranged&quot; integers which seems to avoid some of the worries about exactly how you write expressions to avoid overflow, though I couldn&#39;t understand exactly what the semantics were supposed to be."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428885078, "post_id": 29591282, "comment_id": 47339332, "body": "@ReidBarton, I think &quot;I couldn&#39;t understand exactly what the semantics were supposed to be&quot; is a pretty serious indictment compared to the straightforward semantics of unchecked overflow. However, I <i>would</i> like to see good tools for finding out when overflow has occurred; doing so for multiplication in general (if not in this case) is quite horrible."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494516960, "post_id": 29591282, "comment_id": 74873097, "body": "@dfeuer I think that statement about <code>Int</code>/<code>Int16</code> is not true - I think you have to take the detour via <code>lnteger</code> (unless you already know your <code>String</code> is in the range of <code>Int</code>) - here an example <code>read (show $ 2 * (fromIntegral (maxBound :: Int) :: Integer)) :: Int</code> this is an Int overflow but  after flowing <code>-2</code> is in the range of <code>Int16</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494532874, "post_id": 29591282, "comment_id": 74882306, "body": "@epsilonhalbe, I guess what I wrote was pretty severely unclear. The actual point is that you can perform the read <i>manually</i> (digit by digit), accumulating an <code>Int</code> value, and check for overflow along the way. So you read a digit, multiply the accumulator by ten, add the digit, and then test whether the accumulator lies within the <code>Int16</code> bounds. Rinse and repeat. This avoids all the allocation involved in reading <code>Integer</code> values (and, blast, reminds me that I really need to put together a PR implementing Bertram Felgenhauer&#39;s improved <code>Integer</code>-reading technique)."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494573304, "post_id": 29591282, "comment_id": 74895594, "body": "Ahh now I get you! Though I&#39;ve never heard of felgenhauer ;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494598387, "post_id": 29591282, "comment_id": 74911926, "body": "@epsilonhalbe, he goes by &quot;int-e&quot; online."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1428853418, "last_edit_date": 1592644375, "creation_date": 1428853418, "answer_id": 29591282, "question_id": 29587201, "link": "https://stackoverflow.com/questions/29587201/convert-string-to-int-checking-for-overflow/29591282#29591282", "title": "Convert String to Int checking for overflow", "body": "<h3>Background: why unchecked overflow is actually wonderful</h3>\n<p>Haskell 98 leaves overflow behavior explicitly unspecified, which is good for implementers and bad for everyone else. Haskell 2010 discusses it in two sections\u2014in the section inherited from Haskell 98, it's left explicitly unspecified, whereas in the sections on <code>Data.Int</code> and <code>Data.Word</code>, it is specified. This inconsistency will hopefully be resolved eventually.</p>\n<p>GHC is kind enough to specify it explicitly:</p>\n<blockquote>\n<p>All arithmetic is performed modulo 2^n, where n is the number of bits in the type.</p>\n</blockquote>\n<p>This is an extremely useful specification. In particular, it guarantees that <code>Int</code>, <code>Word</code>, <code>Int64</code>, <code>Word32</code>, etc., form rings, and even <a href=\"http://en.m.wikipedia.org/wiki/Principal_ideal_ring\" rel=\"nofollow noreferrer\">principal ideal rings</a>, under addition and multiplication. This means that arithmetic will always work right\u2014you can transform expressions and equations in lots of different ways without breaking things. Throwing exceptions on overflow would break all these properties, making it much more difficult to write and reason about programs. The only times you really need to be careful are when you use comparison operators like <code>&lt;</code> and <code>compare</code>\u2014fixed width integers do not form ordered groups, so these operators are a bit touchy.</p>\n<h3>Why it makes sense not to check reads</h3>\n<p>Reading an integer involves many multiplications and additions. It also needs to be fast. Checking to make sure the read is &quot;valid&quot; is not so easy to do quickly. In particular, while it's easy to find out whether an addition has overflowed, it is <em>not</em> easy to find out whether a multiplication has. The only sensible ways I can think of to perform a checked read for <code>Int</code> are</p>\n<ol>\n<li><p>Read as an <code>Integer</code>, check, then convert. <code>Integer</code> arithmetic is significantly more expensive than <code>Int</code> arithmetic. For smaller things, like <code>Int16</code>, the read can be done with <code>Int</code>, checking for <code>Int16</code> overflow, then narrowed. This is cheaper, but still not free.</p>\n</li>\n<li><p>Compare the number <em>in decimal</em> to <code>maxBound</code> (or, for a negative number, <code>minBound</code>) while reading. This seems more likely to be reasonably efficient, but there will still be <em>some</em> cost. As the first section of this answer explains, there is nothing <em>inherently</em> wrong with overflow, so it's not clear that throwing an error is actually better than giving an answer modulo 2^n.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1428853418, "creation_date": 1428824714, "last_edit_date": 1428829738, "question_id": 29587201, "link": "https://stackoverflow.com/questions/29587201/convert-string-to-int-checking-for-overflow", "title": "Convert String to Int checking for overflow", "body": "<p>When I tried to convert a very long integer to <code>Int</code>, I was surprised that no error was thrown:</p>\n\n<pre><code>Prelude&gt; read \"123456789012345678901234567890\" :: Int\n-4362896299872285998\n</code></pre>\n\n<p><code>readMaybe</code> from <code>Text.Read</code> module gives the same result.</p>\n\n<p>Two questions:</p>\n\n<ul>\n<li>Which function should I call to perform a safe conversion?</li>\n<li>How can the most type safe language on Earth allow such unsafe things?</li>\n</ul>\n\n<p><strong>Update 1:</strong></p>\n\n<p>This is my attempt to write a version of <code>read</code> that checks bounds:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nparseIntegral :: forall a . (Integral a, Bounded a) =&gt; String -&gt; Maybe a\nparseIntegral s = integerToIntegral (read s :: Integer) where\n  integerToIntegral n | n &lt; fromIntegral (minBound :: a) = Nothing\n  integerToIntegral n | n &gt; fromIntegral (maxBound :: a) = Nothing\n  integerToIntegral n = Just $ fromInteger n\n</code></pre>\n\n<p>Is it the best I can do?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3120, "user_id": 4402721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WCNcL.jpg?s=128&g=1", "display_name": "drRobertz", "link": "https://stackoverflow.com/users/4402721/drrobertz"}, "edited": false, "score": 0, "creation_date": 1428827709, "post_id": 29587120, "comment_id": 47322608, "body": "Good explanation.  @Jeff Lins, the first step when you get problems like this is to add type declarations to your functions. (or even make a habit of always adding them) Then either you get more precise errors from the compiler,  or -- as in this case -- find the problem yourself."}, {"owner": {"reputation": 86, "user_id": 4778825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bd3e5500b773e806148abf6d46f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Lins", "link": "https://stackoverflow.com/users/4778825/jeff-lins"}, "edited": false, "score": 0, "creation_date": 1428869784, "post_id": 29587120, "comment_id": 47335072, "body": "I&#39;m not sure I understand this. Before I posted the question I tried to provide the following type annotation: fib1 :: Num a =&gt; [a] -&gt; [a]. But obviously that didn&#39;t work. I don&#39;t understand why it changes the right side to [[a]]. Because [a] : [a] should result in just [a]. Why does it wrap the list in another list?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 86, "user_id": 4778825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bd3e5500b773e806148abf6d46f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Lins", "link": "https://stackoverflow.com/users/4778825/jeff-lins"}, "edited": false, "score": 0, "creation_date": 1428879406, "post_id": 29587120, "comment_id": 47338044, "body": "@JeffLins You have the type of <code>(:)</code> wrong; it is not <code>[a] -&gt; [a] -&gt; [a]</code> but <code>a -&gt; [a] -&gt; [a]</code>. But even then you would have a problem, because <code>last</code> and <code>init</code> are not (obviously) going to return a list."}, {"owner": {"reputation": 86, "user_id": 4778825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bd3e5500b773e806148abf6d46f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Lins", "link": "https://stackoverflow.com/users/4778825/jeff-lins"}, "edited": false, "score": 0, "creation_date": 1428995964, "post_id": 29587120, "comment_id": 47386670, "body": "Thanks, Daniel. Now this answer makes perfect sense to me! The type mix-up seems to be where the problem started."}], "tags": [], "owner": {"reputation": 1510, "user_id": 1576064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47c868b652ffdc287498a8c604a30013?s=128&d=identicon&r=PG", "display_name": "Lubom&#237;r Sedl&#225;\u0159", "link": "https://stackoverflow.com/users/1576064/lubom%c3%adr-sedl%c3%a1%c5%99"}, "is_accepted": true, "score": 4, "last_activity_date": 1428824092, "creation_date": 1428824092, "answer_id": 29587120, "question_id": 29586838, "link": "https://stackoverflow.com/questions/29586838/haskell-fibonacci-cannot-construct-the-infinite-type-a0-a0/29587120#29587120", "title": "haskell fibonacci - cannot construct the infinite type: a0 = [a0]", "body": "<p>The problem with the first code sample is that there is no way you could write a type annotation for it. It would be infinite. Let's try it anyway:</p>\n\n<p><code>fib1 x = fib1 (x : (last $ init x) + (last x))\n</code></p>\n\n<p>First let's simplify it, because we can replicate the same problem without the <code>last</code> and <code>init</code> stuff:</p>\n\n<p><code>fib1 x = fib1 (x : undefined)\n</code></p>\n\n<p>What is the type of <code>fib1</code>'s argument. On the left, we only see <code>x</code> with no more information about it. We can assume it has some type <code>a</code>. On the right hand side, we try to call the function with argument which must be a list (because it is constructed by <code>:</code> operator). Elements of the list start with <code>x</code>, which has type <code>a</code>. Therefore, the type of <code>fib1</code>'s argument here is <code>[a]</code>. Since we can't call a function with arguments of two different types, even on left side <code>x</code> must have type <code>[a]</code>. But this forces us to update the type on the rigth side to <code>[[a]]</code>. And then again on the left. This process will never stop, the type will grow and grow, because there is no way to unify <code>a</code> with <code>[a]</code>. Therefore there is no valid type for the expression and GHC will reject it.</p>\n\n<p>On the other hand, the second snippet does not have the problem.</p>\n\n<p><code>fib2 x y = head y : fib2 y (zipWith (+) x y)\n</code></p>\n\n<p>We can easily ask GHCi the type of this function, and it will happily answer us:</p>\n\n<p><code>Prelude&gt; let fib2 x y = head y : fib2 y (zipWith (+) x y)\nPrelude&gt; :t fib2\nfib2 :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\n</code></p>\n\n<p>That type is perfectly finite.</p>\n"}], "owner": {"reputation": 86, "user_id": 4778825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bd3e5500b773e806148abf6d46f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Lins", "link": "https://stackoverflow.com/users/4778825/jeff-lins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 29587120, "answer_count": 1, "score": 0, "last_activity_date": 1428824092, "creation_date": 1428821538, "last_edit_date": 1428822280, "question_id": 29586838, "link": "https://stackoverflow.com/questions/29586838/haskell-fibonacci-cannot-construct-the-infinite-type-a0-a0", "title": "haskell fibonacci - cannot construct the infinite type: a0 = [a0]", "body": "<p>I was trying to get an infinite list of fibonacci numbers in haskell but the following code would not compile:</p>\n\n<pre><code>fib1 x = fib1 (x : (last $ init x) + (last x))\nresult1 = fib1 [1,2]\n</code></pre>\n\n<p>I eventually got it to work with this code:</p>\n\n<pre><code>fib2 x y = head y : fib2 y (zipWith (+) x y)\nresult2 = fib2 [0,1] [1,1]\n</code></pre>\n\n<p>Still, I do not understand why the first code snippet did not compile. The error is below. I am just looking for an answer as to why the first one doesn't compile but the second does.</p>\n\n<pre><code>p2.hs:3:16:\n    Occurs check: cannot construct the infinite type: a0 = [a0]\n    In the first argument of `(:)', namely `x'\n    In the first argument of `fib1', namely\n      `(x : (last $ init x) + (last x))'\n    In the expression: fib1 (x : (last $ init x) + (last x))\n\np2.hs:3:21:\n    Occurs check: cannot construct the infinite type: a0 = [a0]\n    In the first argument of `(+)', namely `(last $ init x)'\n    In the second argument of `(:)', namely\n      `(last $ init x) + (last x)'\n    In the first argument of `fib1', namely\n      `(x : (last $ init x) + (last x))'\n\np2.hs:3:44:\n    Occurs check: cannot construct the infinite type: a0 = [a0]\n    Expected type: [[a0]]\n      Actual type: [a0]\n    In the first argument of `last', namely `x'\n    In the second argument of `(+)', namely `(last x)'\n    In the second argument of `(:)', namely\n      `(last $ init x) + (last x)' Failed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["debugging", "haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1428834985, "post_id": 29587059, "comment_id": 47324257, "body": "ah, ok, this explains it. I thought it was <code>where</code> at first, but now I see I can&#39;t even see <code>originalCounts</code>, which makes sense given your explanation."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 4, "last_activity_date": 1428824571, "last_edit_date": 1428824571, "creation_date": 1428823521, "answer_id": 29587059, "question_id": 29585756, "link": "https://stackoverflow.com/questions/29585756/bringing-where-clause-into-scope-in-ghci-debugger/29587059#29587059", "title": "Bringing where clause into scope in GHCi debugger", "body": "<p>Unfortunately, the GHCi debugger does not make everything in scope available at a breakpoint. To quote <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci-debugger.html#idp6760624\" rel=\"nofollow\">from the user manual</a> (text identical in 7.8.2 and 7.10.1 (latest)):</p>\n\n<blockquote>\n  <p>GHCi has provided bindings for the free variables[6] of the expression on which the breakpoint was placed (<code>a</code>, <code>left</code>, <code>right</code>), and additionally a binding for the result of the expression (<code>_result</code>). [...]</p>\n</blockquote>\n\n<p>and the footnote:</p>\n\n<blockquote>\n  <p>[6] We originally provided bindings for all variables in scope, rather than just the free variables of the expression, but found that this affected performance considerably, hence the current restriction to just the free variables.</p>\n</blockquote>\n\n<p>Essentially, you can only see local variables if they are mentioned directly in the expression GHCi is currently stopped at. Which makes me think of a workaround, which although pretty silly does work. Replace the main line of the function by:</p>\n\n<pre><code>solve (Audience originalCounts) =\n    (friendAdded,alreadyStanding,modifiedCounts) `seq` numFriendsAdded\n</code></pre>\n\n<p>Now all the variables you're interested in are mentioned in the expression, so you can stop at it to see them all.</p>\n"}], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 29587059, "answer_count": 1, "score": 5, "last_activity_date": 1428824571, "creation_date": 1428810656, "question_id": 29585756, "link": "https://stackoverflow.com/questions/29585756/bringing-where-clause-into-scope-in-ghci-debugger", "title": "Bringing where clause into scope in GHCi debugger", "body": "<p>Earlier today, I was trying to debug a version of the below <code>solve</code> function that was giving me problems:</p>\n\n<pre><code>newtype Audience = Audience { byShyness :: [Int] }\n\nsolve :: Audience -&gt; Int\nsolve (Audience originalCounts) = numFriendsAdded\n  where numFriendsAdded = length $ filter id friendAdded\n        friendAdded     = zipWith3 (\\i c t -&gt; i &gt;= c + t) [0..] originalCounts alreadyStanding\n        alreadyStanding = scanl (+) 0 modifiedCounts\n        modifiedCounts  = zipWith (\\a c -&gt; if a then 1 else c) friendAdded originalCounts\n</code></pre>\n\n<p>In GHCi (7.8.2) I tried to break on <code>solve</code> by name, then by line/column, but it didn't seem to bring the names bound in the <code>where</code> clause into scope:</p>\n\n<pre><code>\u03bb :b solve \nBreakpoint 0 activated at StandingOvation.hs:(20,1)-(24,89)\n\u03bb :main StandingOvation.example-input \nCase #1: Stopped at StandingOvation.hs:(20,1)-(24,89)\n_result :: Int = _\n\u03bb numFriendsAdded\n&lt;interactive&gt;:5:1: Not in scope: \u2018numFriendsAdded\u2019\n\u03bb :delete 0\n\u03bb :b 20 35\nBreakpoint 1 activated at StandingOvation.hs:20:35-49\n\u03bb :main StandingOvation.example-input \nCase #1: Stopped at StandingOvation.hs:20:35-49\n_result :: Int = _\nnumFriendsAdded :: Int = _\n\u03bb numFriendsAdded                                                                                                     \n0\n\u03bb friendAdded\n&lt;interactive&gt;:10:1: Not in scope: \u2018friendAdded\u2019\n</code></pre>\n\n<p>Obviously, they're in mutual scope as far as Haskell is concerned, but what do I need to do to make them visible when debugging?</p>\n"}, {"tags": ["haskell", "yesod", "rawsql"], "comments": [{"owner": {"reputation": 1767, "user_id": 1280784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f879447ea8f119c9e0dfe3981fd11a46?s=128&d=identicon&r=PG", "display_name": "cms_mgr", "link": "https://stackoverflow.com/users/1280784/cms-mgr"}, "edited": false, "score": 1, "creation_date": 1429028422, "post_id": 29585143, "comment_id": 47407462, "body": "Not an answer to the question you&#39;re asking but I&#39;d want to do that conversion in the application layer rather than at the database. Specifically I&#39;d return the filename strings then prepend &#39;upload/&#39; to them with a Haskell function."}, {"owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "reply_to_user": {"reputation": 1767, "user_id": 1280784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f879447ea8f119c9e0dfe3981fd11a46?s=128&d=identicon&r=PG", "display_name": "cms_mgr", "link": "https://stackoverflow.com/users/1280784/cms-mgr"}, "edited": false, "score": 0, "creation_date": 1429064849, "post_id": 29585143, "comment_id": 47422902, "body": "thank you for you input :-)  i solve this today using the toJSON :)"}, {"owner": {"reputation": 1767, "user_id": 1280784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f879447ea8f119c9e0dfe3981fd11a46?s=128&d=identicon&r=PG", "display_name": "cms_mgr", "link": "https://stackoverflow.com/users/1280784/cms-mgr"}, "edited": false, "score": 1, "creation_date": 1429087208, "post_id": 29585143, "comment_id": 47431482, "body": "Cool, remember to stick your solution in as an answer for the benefit of future viewers. Answering your own question is actively encouraged on SO."}], "answers": [{"tags": [], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "is_accepted": false, "score": 1, "last_activity_date": 1429144371, "creation_date": 1429144371, "answer_id": 29663330, "question_id": 29585143, "link": "https://stackoverflow.com/questions/29585143/yesod-custom-rawsql/29663330#29663330", "title": "Yesod Custom RawSql", "body": "<p>I solve this problem using <code>toJSON</code> ,\nThis <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/persistent/Database-Persist-Class.html\" rel=\"nofollow\">Link</a> helps me alot also with the help of IRC #haskell, #yesod channel.</p>\n"}], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429144371, "creation_date": 1428803971, "last_edit_date": 1428876421, "question_id": 29585143, "link": "https://stackoverflow.com/questions/29585143/yesod-custom-rawsql", "title": "Yesod Custom RawSql", "body": "<p>Is it possible to create a custom rawSQL in yesod?</p>\n\n<p>for example i have a Model for images</p>\n\n<pre><code>Images\n    filename String\n    description Text Maybe\n    date UTCTime\n    deriving Show\n</code></pre>\n\n<p>and i have a rawSQL query of</p>\n\n<pre><code>selectImages :: Handler [Entity Images]\nselectImages = do\n      runDB $ rawSql s []\n      where s =  \"SELECT ?? from images;\"\n</code></pre>\n\n<p>but instead of this string query code <code>SELECT ?? from images;</code>. I would like to <code>SELECT id, CONCAT('upload/', filename) as path from images;</code>.</p>\n\n<p>Hope you help me thank you in advance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 3, "creation_date": 1428799545, "post_id": 29584660, "comment_id": 47317589, "body": "There are very many issues with this code. You shouldn&#39;t try to write large amounts of code at once like this; now you&#39;re getting errors and you don&#39;t know which part of the code you&#39;ve written is at fault!"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1428799603, "post_id": 29584660, "comment_id": 47317600, "body": "The error you&#39;re getting refers to the <code>instance Num Coord where</code> line: you probably want something like <code>instance (Num x, Num y, Num n) =&gt; Num (Coord x y n) where</code>. This is because <code>Num</code> expects a fully &quot;filled-out&quot; type as its argument: you can write an instance <code>Num Int</code> or <code>Num (Maybe Int)</code>, but not <code>Num Maybe</code> or <code>Num []</code>."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1428799788, "post_id": 29584660, "comment_id": 47317640, "body": "But really, your design looks very weird, and I wouldn&#39;t even bother fixing this; what are you actually trying to achieve, what kind of code do you want to write with this? You say you&#39;re &quot;creating a Coord function that has three parameters [...]&quot; but clearly you&#39;ve defined <code>Coord</code> as a type, not a function."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1428799896, "post_id": 29584660, "comment_id": 47317663, "body": "It is confusing to me too. A <code>Coord</code> has a <code>Position</code>, a <code>Vector</code> and a <code>Scalar</code> inside of it (which would add up to a five dimensional value)?"}, {"owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "edited": false, "score": 0, "creation_date": 1428800003, "post_id": 29584660, "comment_id": 47317678, "body": "Sorry, I&#39;m still getting used to the type system with Haskell. Coord is supposed to be its own type and I want to be able to do the operations that are seen in the apparently pseudo code above."}, {"owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "edited": false, "score": 0, "creation_date": 1428802575, "post_id": 29584660, "comment_id": 47318218, "body": "First of all try to express your types in plain English (in the way you think about it) and write it down. After that try to rewrite it in the way of a haskell type system. If you&#39;ll succeed with this two steps it would be easy to implement it in code."}, {"owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "edited": false, "score": 0, "creation_date": 1428802720, "post_id": 29584660, "comment_id": 47318246, "body": "For example: &quot;Position is a type which consists of two integers&quot; -&gt; &quot;Position is a type with a single constructor that accepts two integers&quot; -&gt; &quot;data Position = Position Int Int&quot;"}, {"owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "edited": false, "score": 2, "creation_date": 1428802944, "post_id": 29584660, "comment_id": 47318285, "body": "Don&#39;t get frustrated, but at the moment your problem is not with Num typeclass. Before getting there, you should create better types (Position,Vector,Scalar,Coord) as the currrent definitions clearly do not represent what you expect them to."}, {"owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "reply_to_user": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "edited": false, "score": 0, "creation_date": 1428803943, "post_id": 29584660, "comment_id": 47318473, "body": "@zudov thank you for the help. I will try your recommendations."}], "answers": [{"comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 1, "creation_date": 1428799526, "post_id": 29584683, "comment_id": 47317584, "body": "I don&#39;t think that&#39;s what the error says. To be an instance of <code>Num</code> your type needs a kind <code>*</code>, but his Coord has a kind <code>* -&gt; * -&gt; * -&gt; *</code>."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1428799620, "post_id": 29584683, "comment_id": 47317605, "body": "Mephy: whoops I didn&#39;t even read that far! I just saw the obvious parsing problem."}, {"owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "edited": false, "score": 0, "creation_date": 1428799840, "post_id": 29584683, "comment_id": 47317650, "body": "Thank you and I apologize if there are multiple issues. I am new to Haskell and it all seems so different than what I&#39;m used to."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1428800288, "post_id": 29584683, "comment_id": 47317730, "body": "no need to apologize - it was all new to everyone at one point"}, {"owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "edited": false, "score": 0, "creation_date": 1428800762, "post_id": 29584683, "comment_id": 47317834, "body": "@rampion I added the parenthesis that you pointed out and I&#39;m still getting the same error."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 0, "last_activity_date": 1428799347, "creation_date": 1428799347, "answer_id": 29584683, "question_id": 29584660, "link": "https://stackoverflow.com/questions/29584660/haskell-num-instance/29584683#29584683", "title": "Haskell Num Instance", "body": "<p>Your problem in a word: parentheses.</p>\n\n<p>instead of</p>\n\n<pre><code>negate Position (x, y) = Position (-x, -y)\n</code></pre>\n\n<p>do</p>\n\n<pre><code>negate (Position (x, y)) = Position (-x, -y)\n</code></pre>\n\n<p>The former implicitly implies that <code>negate</code> is a function which takes two arguments - the <code>Position</code> value constructor and <code>(x,y)</code>, rather than a single argument of type <code>Position</code>, since it parses it as</p>\n\n<pre><code>((negate Position) (x,y)) = ...\n</code></pre>\n\n<p>Your other function definitions have the same problem.</p>\n"}, {"tags": [], "owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "is_accepted": true, "score": 2, "last_activity_date": 1429014363, "creation_date": 1429014363, "answer_id": 29627295, "question_id": 29584660, "link": "https://stackoverflow.com/questions/29584660/haskell-num-instance/29627295#29627295", "title": "Haskell Num Instance", "body": "<p>After looking into the suggestions I finally cam up with a solution that works.</p>\n\n<pre><code>data Coord = Position (Double, Double) | Vector (Double, Double) | Scalar Double deriving (Show)\n\ninstance Num Coord where\n    negate (Position (x, y)) = Position (-x, -y)\n    negate (Vector (x, y)) = Vector (-x, -y)\n    (+) (Vector (a, b)) (Position (x, y)) = Position (x+a, y+b)\n    (+) (Position (x, y)) (Vector (a, b)) = Position (x+a, y+b)\n    (+) (Vector (a, b)) (Vector (c, d)) = Vector (c+a, d+b)\n    (+) (Scalar x) (Scalar y) = Scalar (x+y)\n    (*) (Vector (a, b)) (Scalar c) = Vector (a*c, b*c)\n    (*) (Scalar c) (Vector (a, b)) = Vector (a*c, b*c)\n    (*) (Position (x1, y1)) (Position (x2, y2)) = Scalar((x1*x2) + (y1*y2))\n    (*) (Scalar x) (Scalar y) = Scalar (x*y)\n    (-) (Vector (a, b)) (Position (x, y)) = Position (x-a, y-b)\n    (-) (Position (x, y)) (Vector (a, b)) = Position (a-x, b-y)\n    (-) (Position (x1, y1)) (Position (x2, y2)) = Vector (x2-x1, y2-y1)\n    (-) (Scalar x) (Scalar y) = Scalar (x-y)\n    abs (Position (x, y)) = Scalar (sqrt((x*x)+(y*y)))\n    abs (Vector (x, y)) = Scalar (sqrt((x*x)+(y*y)))\n    signum _ = error \"undefined\"\n    fromInteger _ = error \"undefined\"\n</code></pre>\n\n<p>Hopefully this helps anyone in the future that is making the same mistakes as me.</p>\n"}], "owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 29627295, "answer_count": 2, "score": 0, "last_activity_date": 1429014363, "creation_date": 1428799186, "last_edit_date": 1428801171, "question_id": 29584660, "link": "https://stackoverflow.com/questions/29584660/haskell-num-instance", "title": "Haskell Num Instance", "body": "<p>I am new to Haskell so I apologize if I am overlooking something basic, but I am creating a Coord type that has three parameters: Position, Vector, and Scalar. Coord must be an instance of Num and must have specific implemented methods in it. I believe I have what I need already, but I'm assuming I'm missing something basic because I get an error based on the Num instance.</p>\n\n<p>My code:</p>\n\n<pre><code>data Position x y = Position (x, y)\ndata Vector x y = Vector (x, y)\ndata Scalar n = Scalar n\ndata Coord x y n = Coord (Position x y, Vector x y, Scalar n)\n\ninstance Num Coord where\n    negate (Position (x, y)) = Position (-x, -y)\n    negate (Vector (x, y)) = Vector (-x, -y)\n    (+) (Vector (a, b) Position (x, y)) = Position (x+a, y+b)\n    (+) (Vector (a, b) Vector (c, d)) = Vector (c+a, d+b)\n    (+) (Scalar x Scalar y) = Scalar (x+y)\n    (*) (Vector (a, b) Scalar c) = Vector (a*c, b*c)\n    (*) (Position (x1, y1) Position (x2, y2)) = (x1*x2) + (y1*y2)\n    (*) (Scalar x Scalar y) = Scalar (x*y)\n    (-) (Vector (a, b) Position (x, y)) = Position (x-a, y-b)\n    (-) (Position (x1, y1) Position (x2, y2)) = Vector (x2-x1, y2-y1)\n    (-) (Scalar x Scalar y) = Scalar (x-y)\n    abs (Position (x, y)) = Scalar sqrt((x*x)+(y*y))\n    abs (Vector (x, y)) = Scalar sqrt((x*x)+(y*y))\n    signum _ = error \"undefined\"\n    fromInteger _ = error \"undefined\"\n</code></pre>\n\n<p>The error I get:</p>\n\n<pre><code>Expecting three more arguments to \u2018Coord\u2019\nThe first argument of \u2018Num\u2019 should have kind \u2018*\u2019,\n  but \u2018Coord\u2019 has kind \u2018* -&gt; * -&gt; * -&gt; *\u2019\nIn the instance declaration for \u2018Num Coord\u2019\n</code></pre>\n\n<p>Any clarification on how to use Num would be much appreciated (I'm assuming that is what's responsible for the error)</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "types", "compilation", "ghc"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1428804064, "post_id": 29584151, "comment_id": 47318495, "body": "Maybe <code>-fdefer-type-errors</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 7, "creation_date": 1428806268, "post_id": 29584151, "comment_id": 47318893, "body": "Note that GHC&#39;s performance has a bit to do with the type checking: it knows what stuff is, what types are equivalent, and can apply high-level optimisations accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1428806285, "post_id": 29585190, "comment_id": 47318895, "body": "Hey you again, thank you. If (and only if) you have the time, please consider illustrating your answer for completion! For example, I tried compiling <a href=\"http://lpaste.net/130568\" rel=\"nofollow noreferrer\">this</a> program by adding <code>unsafeCoerce</code> before <code>div</code>, but I guess that is not what you meant."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1428810482, "post_id": 29585190, "comment_id": 47319516, "body": "@Viclib, I&#39;m told the Agda compiler does this. It&#39;s rather poor form, I would say."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "edited": false, "score": 1, "creation_date": 1428818264, "post_id": 29585190, "comment_id": 47320760, "body": "Yes, this is what Agda&#39;s Haskell-targeting MAlonzo compiler backend does.  It&#39;s indeed not the cleanest approach."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1428824384, "post_id": 29585190, "comment_id": 47321922, "body": "Once you do this I guess you need to add an explicit annotation to each class member call. E.g. <code>show (unsafeCoerce x)</code> cannot possibly work as it is."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1428833246, "post_id": 29585190, "comment_id": 47323892, "body": "Note also that if you say &quot;I&#39;ve already checked this, trust me&quot;, and it turns out you were actually <i>wrong</i>... well, undefined behaviour awaits. But you knew that. ;-)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1428838284, "post_id": 29585190, "comment_id": 47325092, "body": "@MathematicalOrchid what do you mean?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428839091, "post_id": 29585190, "comment_id": 47325302, "body": "@dfeuer @DominiqueDevriese same - what do you mean? Is it about the <code>div</code> combinator? If you have a better one please let me know :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1428843687, "post_id": 29585190, "comment_id": 47326530, "body": "@Viclib Okay, so illustrated."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1439270290, "post_id": 29585190, "comment_id": 51778695, "body": "@DanielWagner, sorry for asking this so much later, but is there any performance weight in using <code>unsafeCoerce</code> everywhere, as opposed to only on where it is needed? I guess it is erased on runtime, right?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1439271912, "post_id": 29585190, "comment_id": 51779239, "body": "@Viclib It is probably erased provided it is applied to something; though it can certainly be passed around as an argument in which case it probably exists at runtime."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1428844316, "last_edit_date": 1428844316, "creation_date": 1428804596, "answer_id": 29585190, "question_id": 29584151, "link": "https://stackoverflow.com/questions/29584151/can-i-disable-type-checking-entirely-on-ghc-in-order-to-use-it-as-a-compile-tar/29585190#29585190", "title": "Can I disable type-checking entirely on GHC, in order to use it as a compile-target for functional languages?", "body": "<p>You can stick an <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Unsafe-Coerce.html#v:unsafeCoerce\" rel=\"nofollow\"><code>unsafeCoerce</code></a> in front of every subterm (or, if you're feeling ambitious, only the ones that actually need it).</p>\n\n<p>In the comments, you ask how to annotate this term to make it type-check:</p>\n\n<pre><code>div = (\\ v0 -&gt; (\\ v1 -&gt; (\\ v2 -&gt; (\\ v3 -&gt; ((v1 (\\ v4 -&gt; (v4 v3))) ((v0 (((v1 (\\ v4 -&gt; (\\ v5 -&gt; (\\ v6 -&gt; (v4 (\\ v7 -&gt; ((v5 v7) v6))))))) (\\ v4 -&gt; v4)) (\\ v4 -&gt; (\\ v5 -&gt; (v5 (v2 v4)))))) (((v1 (\\ v4 -&gt; (\\ v5 -&gt; v4))) (\\ v4 -&gt; v4)) (\\ v4 -&gt; v4))))))))\n</code></pre>\n\n<p>I ran <code>:s/(/unsafeCoerce (/g</code> in vim, resulting in this term:</p>\n\n<pre><code>div = unsafeCoerce (\\ v0 -&gt; unsafeCoerce (\\ v1 -&gt; unsafeCoerce (\\ v2 -&gt; unsafeCoerce (\\ v3 -&gt; unsafeCoerce (unsafeCoerce (v1 unsafeCoerce (\\ v4 -&gt; unsafeCoerce (v4 v3))) unsafeCoerce (unsafeCoerce (v0 unsafeCoerce (unsafeCoerce (unsafeCoerce (v1 unsafeCoerce (\\ v4 -&gt; unsafeCoerce (\\ v5 -&gt; unsafeCoerce (\\ v6 -&gt; unsafeCoerce (v4 unsafeCoerce (\\ v7 -&gt; unsafeCoerce (unsafeCoerce (v5 v7) v6))))))) unsafeCoerce (\\ v4 -&gt; v4)) unsafeCoerce (\\ v4 -&gt; unsafeCoerce (\\ v5 -&gt; unsafeCoerce (v5 unsafeCoerce (v2 v4)))))) unsafeCoerce (unsafeCoerce (unsafeCoerce (v1 unsafeCoerce (\\ v4 -&gt; unsafeCoerce (\\ v5 -&gt; v4))) unsafeCoerce (\\ v4 -&gt; v4)) unsafeCoerce (\\ v4 -&gt; v4))))))))\n</code></pre>\n\n<p>This loads in ghci, though I have no idea whether it works (or even if I should expect it to).</p>\n\n<p>Edit: after a bit of inspection, this probably isn't really a fair/correct way to throw in coercions. (In particular, it leads to subterms like <code>v1 unsafeCoerce (\\v4 -&gt; ...)</code> -- and we shouldn't be passing <code>unsafeCoerce</code> as an argument anywhere.) A more correct insertion is to insert an <code>unsafeCoerce</code> at each application point, like this:</p>\n\n<pre><code>div = (\\ v0 -&gt; (\\ v1 -&gt; (\\ v2 -&gt; (\\ v3 -&gt; (unsafeCoerce (v1 (\\ v4 -&gt; (unsafeCoerce v4 v3))) (unsafeCoerce (v0 (unsafeCoerce (unsafeCoerce (unsafeCoerce v1 (\\ v4 -&gt; (\\ v5 -&gt; (\\ v6 -&gt; (unsafeCoerce v4 (\\ v7 -&gt; (unsafeCoerce (unsafeCoerce v5 v7) v6))))))) (\\ v4 -&gt; v4)) (\\ v4 -&gt; (\\ v5 -&gt; (unsafeCoerce v5 (unsafeCoerce v2 v4)))))) (unsafeCoerce (unsafeCoerce (unsafeCoerce v1 (\\ v4 -&gt; (\\ v5 -&gt; v4))) (\\ v4 -&gt; v4)) (\\ v4 -&gt; v4))))))))\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 1, "accepted_answer_id": 29585190, "answer_count": 1, "score": 2, "last_activity_date": 1428844316, "creation_date": 1428794205, "question_id": 29584151, "link": "https://stackoverflow.com/questions/29584151/can-i-disable-type-checking-entirely-on-ghc-in-order-to-use-it-as-a-compile-tar", "title": "Can I disable type-checking entirely on GHC, in order to use it as a compile-target for functional languages?", "body": "<p>GHC is astonishingly fast at this point. I'm not happy with Haskell's type system, though, so I decided to implement my own as a DSL. Now, I would like to compile my language to Haskell by translating the post-checking untyped lambda calculus expressions, in order to use GHC's performance. The only problem is that some valid expressions on my system won't compile on GHC. How can I circumvent this problem - i.e., disabling the type system entirely by telling GHC \"I've already checked this, trust me\"?</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428793861, "post_id": 29583956, "comment_id": 47316389, "body": "Is the very first call <code>diagonalrug 2 2</code> or <code>crossedrug 2 2</code> in your answer? The OP posted the first, but maybe you are referring to the second?"}, {"owner": {"reputation": 2688, "user_id": 2820579, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/5d5c31bb271ef29d7c59c932a105b218?s=128&d=identicon&r=PG&f=1", "display_name": "user2820579", "link": "https://stackoverflow.com/users/2820579/user2820579"}, "edited": false, "score": 0, "creation_date": 1428794136, "post_id": 29583956, "comment_id": 47316479, "body": "I am tired and that&#39;s when one starts to do thrash XD. The thing is that I tried <code>diagonalrug 2 2</code> and this works ok, now I never noticed that I was using <code>crossedrug 2 2</code> and then uses <code>diagonalrug 0 0</code>, which then causes the problem as Benjamin pointed out."}], "tags": [], "owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "is_accepted": true, "score": 3, "last_activity_date": 1428792601, "creation_date": 1428792601, "answer_id": 29583956, "question_id": 29583920, "link": "https://stackoverflow.com/questions/29583920/recursive-haskell-function-hangs-forever-in-interactive-session/29583956#29583956", "title": "recursive haskell function hangs forever in interactive session", "body": "<p>Just follow execution.</p>\n\n<p>You're calling it with <code>2 2</code>, it goes to the otherwise and calls <code>diagonalrug 0 0</code> which in turn goes to the otherwise clause which never terminates since it calls <code>diagonalrug 0 -1</code> so <code>m</code> is never 1 (it keeps being negative).</p>\n\n<p><code>diagonalrug</code> is missing a stopping condition for that case.</p>\n"}], "owner": {"reputation": 2688, "user_id": 2820579, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/5d5c31bb271ef29d7c59c932a105b218?s=128&d=identicon&r=PG&f=1", "display_name": "user2820579", "link": "https://stackoverflow.com/users/2820579/user2820579"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 29583956, "answer_count": 1, "score": 1, "last_activity_date": 1428792601, "creation_date": 1428792273, "question_id": 29583920, "link": "https://stackoverflow.com/questions/29583920/recursive-haskell-function-hangs-forever-in-interactive-session", "title": "recursive haskell function hangs forever in interactive session", "body": "<p>I have a recursive function that plots some picture in ASCII art. It is quite simple being </p>\n\n<pre><code>type Picture = [[Char]]\nwhite :: Picture\nwhite = [\"......\",\n         \"......\",\n         \"......\",\n         \"......\",\n         \"......\",\n         \"......\"]\n\nblack = [\"######\",\n         \"######\",\n         \"######\",\n         \"######\",\n         \"######\",\n         \"######\"]\n\nprintPicture :: Picture -&gt; IO ()\nprintPicture = putStr . concat . map (++\"\\n\")\n</code></pre>\n\n<p>With these blocks I want to construct a game board. I have define some functions to do so, which are:</p>\n\n<pre><code>blackinWhite :: Integer -&gt; Integer -&gt; Picture\nblackinWhite n m | n==1 &amp;&amp; m==1 = black\n                 | n==1 = white\n                 | n==m = black `beside` blackinWhite (n-1) m\n                 | otherwise = white `beside` blackinWhite (n-1) m\n\nblackinWhite' :: Integer -&gt; Integer -&gt; Picture\nblackinWhite' n m | n==1 &amp;&amp; m==1 = black\n                  | n==1 = white\n                  | n==m = black `above` blackinWhite' (n-1) m\n                  | otherwise = white `above` blackinWhite' (n-1) m\n\ndiagonalrug :: Integer -&gt; Integer -&gt; Picture\ndiagonalrug n m | m==1 = blackinWhite n m\n                | otherwise = blackinWhite n m `above` diagonalrug n (m-1)\n\nantidiagrug :: Integer -&gt; Integer -&gt; Picture\nantidiagrug n m | m==1 = blackinWhite' n m\n                | otherwise = antidiagrug n (m-1) `beside` blackinWhite' n m\n\ncrossedrug :: Integer -&gt; Integer -&gt; Picture\ncrossedrug n m | dimn /= 0 || dimm /= 0= error(\"Come back later\")\n               | otherwise = diagonalrug dimn dimm --((diagonalrug dimn dimm) `beside` (antidiagrug dimn dimm)) `above` ((antidiagrug dimn dimm) `beside` (diagonalrug dimn dimm))                                                           \n               where\n                 dimn = mod n 2\n                 dimm = mod m 2\n</code></pre>\n\n<p>If I do in the interactive session:</p>\n\n<pre><code>*Main&gt; diagonalrug 2 2\n</code></pre>\n\n<p>The program hangs and my computer is freezed. If I execute directly the statement that comes after <code>otherwise</code>, the result is given without any problems. Why if I call the function crossedrug ghci crashes?</p>\n\n<p>(I am not providing the functions <code>above</code> and <code>beside</code>, since they simply concatenate two pictures that should be clear from the context.)</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "edited": false, "score": 0, "creation_date": 1428777133, "post_id": 29581430, "comment_id": 47311375, "body": "Thank you so much! The data type stuff is very confusing for me as I&#39;m coming from Java. It seems very different."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "edited": false, "score": 1, "creation_date": 1428777169, "post_id": 29581430, "comment_id": 47311393, "body": "@Jon Don&#39;t worry about it - it grows on you :)"}, {"owner": {"reputation": 64980, "user_id": 954986, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9bc332a4fccaf3e527fdc258b6990f2d?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/954986/nathan"}, "edited": false, "score": 0, "creation_date": 1428806083, "post_id": 29581430, "comment_id": 47318861, "body": "Indeed it does grow on you. :) After using Haskell for a while, you&#39;ll find Java more and more unwieldy."}, {"owner": {"reputation": 64980, "user_id": 954986, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9bc332a4fccaf3e527fdc258b6990f2d?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/954986/nathan"}, "reply_to_user": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "edited": false, "score": 0, "creation_date": 1428806321, "post_id": 29581430, "comment_id": 47318905, "body": "@Jon keep in mind that having numWords take a document and a page and a line might be triple-counting some lines depending on what you pass it. The simplest way is to <i>just</i> use the lenDoc function AJ gave, unless you have some specific need to do something else."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1428776378, "creation_date": 1428776378, "answer_id": 29581430, "question_id": 29581342, "link": "https://stackoverflow.com/questions/29581342/haskell-list-within-a-list-within-a-list/29581430#29581430", "title": "Haskell list within a list within a list", "body": "<p>This is quite a simple problem.</p>\n\n<p>If we have a look at the types, it becomes easy:</p>\n\n<pre><code>type Word = String\ntype Line = [String]\ntype Page = [[String]]\ntype Doc  = [[[String]]]\n</code></pre>\n\n<p>It's not too difficult to get the length of a <code>Line</code>:</p>\n\n<pre><code>lenLine x = length x\n</code></pre>\n\n<p>The <code>Page</code> is just the sum of all the inner lengths:</p>\n\n<pre><code>lenPage xs = sum $ map lenLine xs\n</code></pre>\n\n<p>And we can use the same kind of pattern for <code>Doc</code>:</p>\n\n<pre><code>lenDoc xs = sum $ map lenPage xs\n</code></pre>\n\n<p>As for your final function , just use all the others:</p>\n\n<pre><code>numWords :: Doc -&gt; Page -&gt; Line -&gt; Int\nnumWords dc pg ln = lenDoc dc + lenPage pg + lenLine ln\n</code></pre>\n\n<p>Remember that a type synonym doesn't mean that the type is actually different; you can use the same functions.</p>\n"}], "owner": {"reputation": 248, "user_id": 2913369, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/IkLSo.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2913369/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428776378, "creation_date": 1428775930, "question_id": 29581342, "link": "https://stackoverflow.com/questions/29581342/haskell-list-within-a-list-within-a-list", "title": "Haskell list within a list within a list", "body": "<p>I am learning Haskell and I have a problem where if given a list of a list of a list of Strings I have to find the total number of Strings in the entire initial list. My though process was to convert the entire initial list into a one dimensional list and get the length, however I can seem to figure it out.</p>\n\n<p>What I have so far:</p>\n\n<pre><code>type Word = String\ntype Line = [Word]\ntype Page = [Line]\ntype Doc = [Page]\nnumWords :: Doc -&gt; Line -&gt; Word -&gt; Int\n</code></pre>\n\n<p>I need to find the number of Words and I'm not sure if this is even the best way to go about this type of problem, but I am at a loss for ideas.</p>\n\n<p>Any help would be much appreciated.\nThank you.</p>\n"}, {"tags": ["haskell", "syntax"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1428912545, "post_id": 29580187, "comment_id": 47347345, "body": "Interestingly, it appears that StackOverflow doesn&#39;t consider <code>foreign</code> to be a keyword... (Mind you, I don&#39;t know which language it has auto-detected, so...)"}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1428771691, "post_id": 29580507, "comment_id": 47309521, "body": "I often find myself trying to use <code>if</code> and <code>of</code> for in-file and out-file. Obviously, that fails miserably... ;-)"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1428802149, "post_id": 29580507, "comment_id": 47318121, "body": "It&#39;s not so much that they can only appear in specific places, but that no <i>ordinary</i> identifier can appear in the same places. <code>module</code>, <code>deriving</code> and <code>foreign</code> all break that."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 8, "last_activity_date": 1428772119, "last_edit_date": 1428772119, "creation_date": 1428771272, "answer_id": 29580507, "question_id": 29580187, "link": "https://stackoverflow.com/questions/29580187/haskell-language-report-definition-of-reservedid/29580507#29580507", "title": "Haskell Language Report: definition of reservedid", "body": "<p><code>qualified</code>, <code>as</code> and <code>hiding</code> only occur in specific places as keywords, thus can be used as variable names.</p>\n\n<ul>\n<li><code>qualified</code> only occurs after <code>import</code>.</li>\n<li><code>as</code> only occurs after <code>import qualified PACKAGE</code></li>\n<li><code>hiding</code> only occurs after <code>import [qualified] PACKAGE [as NAME]</code></li>\n</ul>\n\n<p>I see what you mean when you point out that <code>module</code> could be one of these placement-specific keywords, but it seems counter-intuitive to name anything <code>module</code>. Maybe a previous version of Haskell allowed multiple modules in one file?</p>\n\n<p>One could say the same for <code>qualified</code> and <code>hiding</code>, but I've used <code>as</code> a lot, like so:</p>\n\n<pre><code>zip [] _  = []\nzip _  [] = []\nzip (a:as) (b:bs) = (a, b) : zip as bs\n</code></pre>\n\n<p>So, with that in mind, I think it is indeed a design decision, one that I think a lot of languages* could do with including.</p>\n\n<p>It might be worth pointing out that <code>deriving</code> could be one of these words, because it always follows a data declaration, as well as <code>foreign</code>, because it's only reserved with the FFI extension.</p>\n\n<hr>\n\n<p><em>*especially javascript, with it's <a href=\"http://www.w3schools.com/js/js_reserved.asp\" rel=\"noreferrer\">huge list of mainly pointless reserved words</a>!</em></p>\n"}, {"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1428912383, "post_id": 29595709, "comment_id": 47347272, "body": "Most particularly, <code>as</code> is the plural of <code>a</code>. I&#39;m sure somebody somewhere has used that."}], "tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": false, "score": 4, "last_activity_date": 1428880030, "creation_date": 1428880030, "answer_id": 29595709, "question_id": 29580187, "link": "https://stackoverflow.com/questions/29580187/haskell-language-report-definition-of-reservedid/29595709#29595709", "title": "Haskell Language Report: definition of reservedid", "body": "<p>First, the keywords \"as\", \"hiding\", and \"qualified\" were not in the original definition of Haskell.  When they were added they were not made into reserved words for the sake of backwards compatibility.  Adding reserved words is a sure way to break code.  It was a very deliberate decision. </p>\n\n<p>Second, as far as I know Haskell does not forbid multiple modules per file.  The specification simply does not talk about files.  (But I don't know of any implementation that allows it.)</p>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 29580507, "answer_count": 2, "score": 6, "last_activity_date": 1428880030, "creation_date": 1428769500, "question_id": 29580187, "link": "https://stackoverflow.com/questions/29580187/haskell-language-report-definition-of-reservedid", "title": "Haskell Language Report: definition of reservedid", "body": "<p>OK, so I've spent all day playing with the Haskell Language Report (2010), and finding all sorts of \"interesting\" edge-cases. Stuff that you'd <em>think</em> should be an error, but which is actually allowed.</p>\n\n<p>In particular, consider the following excerpt from the lexical syntax reference (section 10.2):</p>\n\n<pre><code>reservedid \u2192 case | class | data | default | deriving | do | else\n           | foreign | if | import | in | infix | infixl |\n           | infixr | instance | let | module | newtype | of\n           | then | type | where | _\n</code></pre>\n\n<p>You <em>might</em> expect to see <code>qualified</code> in that list&hellip; But it isn't there. (Nor is <code>as</code> or <code>hiding</code>, for that matter.)</p>\n\n<p>Now I'm wondering&hellip; Is this an accidental oversight in the Report? Or is this a deliberate design decision?</p>\n\n<p>It appears that GHC at least follows the letter of the specification, for it will cheerfully allow you to define a variable who's name is, in fact, <code>qualified</code>. Weird, but true. So it seems that this name is only \"special\" on one context. By contrast, you can <em>never</em> name a variable <code>module</code>. We could have made this word special only at the start of the file&hellip; but we didn't.</p>\n"}, {"tags": ["list", "haskell", "monads", "fold"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1428762003, "post_id": 29577855, "comment_id": 47306181, "body": "remarks on the code (independent of your question) 1. a list is not a set (use containers:Data.Set), 2. a state is not a String (make the automaton polymorphic in the <code>State</code> type  and in the <code>Symbol</code> type) 3. if you want to do anything with these automata (besides accepting some input), then you will need the transition function reified (e.g., with containers:Data.Map)"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428770599, "post_id": 29577855, "comment_id": 47309109, "body": "By the way, you don&#39;t have to indent all of your code by two spaces - it&#39;s valid without indentation."}], "answers": [{"comments": [{"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1428778661, "post_id": 29577949, "comment_id": 47311901, "body": "Still can&#39;t realize how to use foldM"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1428780780, "post_id": 29577949, "comment_id": 47312574, "body": "I wrote a small example. You can use <code>foldM</code> directly if you have only one initial state; I think otherwise you will need to write <code>foldM trans =&lt;&lt; init</code>."}], "tags": [], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "is_accepted": true, "score": 4, "last_activity_date": 1428780681, "last_edit_date": 1428780681, "creation_date": 1428755911, "answer_id": 29577949, "question_id": 29577855, "link": "https://stackoverflow.com/questions/29577855/how-to-use-foldm-with-a-list-of-strings-as-accumulator-programming-a-nfa/29577949#29577949", "title": "How to use foldM with a list of strings as accumulator? programming a NFA", "body": "<p>Rewrite your code so that <code>transition</code> has the type <code>State -&gt; Symbol -&gt; [State]</code>. This really is what NFAs have: to get your <code>[State] -&gt; Symbol -&gt; [State]</code> function you take the union of calls to this one. Then you will be able to use <code>foldM</code> easily.</p>\n\n<p>An example:</p>\n\n<pre><code>import Control.Monad\n\ntype Symbol = Char\ntype State  = String\n\ndata NFA = NFA { initialState :: State\n               , isAccepting  :: State -&gt; Bool\n               , transition   :: State -&gt; Symbol -&gt; [State] }\n\n-- https://en.wikipedia.org/wiki/Nondeterministic_finite_automaton#Example\nexampleNFA :: NFA\nexampleNFA = NFA { initialState = \"p\"\n                 , isAccepting  = (== \"q\")\n                 , transition   = exampleTransition }\n\nexampleTransition :: State -&gt; Symbol -&gt; [State]\nexampleTransition \"p\" '0' = [\"p\"]\nexampleTransition \"p\" '1' = [\"p\", \"q\"]\nexampleTransition \"q\" '0' = []\nexampleTransition \"q\" '1' = []\n\nrunNFA :: NFA -&gt; String -&gt; [State]\nrunNFA (NFA init _ trans) = foldM trans init\n\nmain = print $ runNFA exampleNFA \"01101\"\n</code></pre>\n"}], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 29577949, "answer_count": 1, "score": 0, "last_activity_date": 1428780681, "creation_date": 1428755155, "question_id": 29577855, "link": "https://stackoverflow.com/questions/29577855/how-to-use-foldm-with-a-list-of-strings-as-accumulator-programming-a-nfa", "title": "How to use foldM with a list of strings as accumulator? programming a NFA", "body": "<p>I'm trying to get this NFA working, now it does very well the transition between a set (list) of states to another set of states. But when I try to use <code>foldM</code> (I will accept any other method too), I cant't because the type of <code>foldM</code> is <code>(Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b</code> and I want something like <code>(Foldable t, Monad m) =&gt; ([b] -&gt; a -&gt; m [b]) -&gt; b -&gt; t a -&gt; m b</code>, if it's possible something like that. The main problem is in the function <code>testNFA</code>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>-- NFA file format\n-- 1st line: set of initial states\n-- last line: set of final states\n-- other lines: transitions table entries, each one is of the form:\n-- (state, char viewed, set of next states)\n\nmodule NFA where\n\n  import Control.Monad\n\n  leerFichero :: String -&gt; IO ()\n  leerFichero filename = do\n                            contenidos &lt;- readFile filename\n                            putStrLn contenidos\n\n  data NFA = NFA { intialStates :: [String]\n                 , isAccepting :: String -&gt; Bool\n                 , transition  :: [String] -&gt; Char -&gt; [String]\n                 }\n\n  strToRow :: [String] -&gt; [((String, Char), [String])]\n  strToRow str = map crea_tupla por_espacios\n    where\n      crea_tupla (x:y:xs) = ((x, head y), xs)\n      por_espacios = map words str\n\n  leerNFA :: String -&gt; IO ()\n  leerNFA filename = do\n                      contenidos &lt;- readFile filename\n                      --putStr \"Cadena:\"\n                      --cadena &lt;- getLine\n                      let lineas = lines $ contenidos\n                          i = words $ head lineas\n                          a = (`elem` last (map words lineas))\n                          nfa = NFA i a (t (strToRow (tail (init lineas))))\n                      print $ t (strToRow (tail (init lineas))) [\"Q0\",\"Q1\"] '#'\n\n  t :: [((String, Char), [String])] -&gt; [String] -&gt; Char -&gt; [String]\n  t tab n c = n &gt;&gt;= (\\st -&gt; case lookup (st,c) tab of\n                              Just x -&gt; x\n                              _      -&gt; error \"yo k se tio xdxd\")\n\n  --not working\n  --testNFA :: NFA -&gt; [Char] -&gt; [String]\n  --testNFA (NFA i a t) = foldM t i\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 7, "creation_date": 1428756226, "post_id": 29577850, "comment_id": 47304296, "body": "I would just wrap <code>Char</code> into a <code>newtype</code> like <code>newtype Digit = Digit Char</code> and make this into an instance"}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428756334, "post_id": 29577850, "comment_id": 47304320, "body": "@CarstenK&#246;nig, very good workaround. Also prevents me from using general chars where I should only be using digits. Do you know why that&#39;s not the approach the tutorial took?"}], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1448129412, "post_id": 29578642, "comment_id": 55458166, "body": "@raxacoricofallapatorius Could you give some details on what doesn&#39;t work?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1448129757, "post_id": 29578642, "comment_id": 55458295, "body": "I get: <code>Couldn&#39;t match expected type \u2018Gen DigitChar\u2019 with actual type \u2018DigitChar\u2019 In the expression: DigitChar $ choose (&#39;0&#39;, &#39;9&#39;)</code>"}, {"owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1448348425, "post_id": 29578642, "comment_id": 55538301, "body": "@raxacoricofallapatorius Oh, seems like I have a small mistake in that sniplet. You actually need to use <code>fmap</code> in order to apply <code>DigitChar</code> I&#39;ve updated the sniplet."}], "tags": [], "owner": {"reputation": 1066, "user_id": 2081046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a2d3a5da814dd0e29b233d40e37b5d?s=128&d=identicon&r=PG&f=1", "display_name": "zudov", "link": "https://stackoverflow.com/users/2081046/zudov"}, "is_accepted": true, "score": 11, "last_activity_date": 1454096788, "last_edit_date": 1495535278, "creation_date": 1428760324, "answer_id": 29578642, "question_id": 29577850, "link": "https://stackoverflow.com/questions/29577850/cant-define-custom-arbitrary-instance-for-char-since-it-already-exists/29578642#29578642", "title": "Can&#39;t define custom `Arbitrary` instance for `Char` since it already exists", "body": "<p>As @carsten-k\u00f6nig adviced, a solution would be to make a <code>newtype</code> wrapper for <code>Char</code>. This is not a workaround, but a proper and really nice way to escape a whole class of problems that are related to orphan instances (instances for typeclasses which are defined in another module), read more about such problems <a href=\"https://stackoverflow.com/questions/3079537/orphaned-instances-in-haskell\">here</a>.</p>\n\n<p>Moreover, this approach is widely used when there are several possible instances with different behaviour.</p>\n\n<p>For example, consider the <code>Monoid</code> typeclass which is defined in <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html\" rel=\"nofollow noreferrer\"><code>Data.Monoid</code></a> as:</p>\n\n<pre><code>class Monoid a where\n    mempty  :: a           -- ^ Identity of 'mappend'\n    mappend :: a -&gt; a -&gt; a -- ^ An associative operation\n</code></pre>\n\n<p>As you may already know Monoid is a type of values which can be appended to each other (using <code>mappend</code>) and for which there exists an 'identity' value <code>mempty</code> which satisfies a rule <code>mappend mempty a == a</code> (appending an identity to value <code>a</code> results in <code>a</code>). There is an obvious instance of Monoid for Lists:</p>\n\n<pre><code>class Monoid [a] where\n    mempty  = []\n    mappend = (++)\n</code></pre>\n\n<p>It's also easy to define <code>Int</code>s. Indeed integers with addition operation form a correct monoid.</p>\n\n<pre><code>class Monoid Int where\n    mempty  = 0\n    mappend = (+)\n</code></pre>\n\n<p>But is it the only possible monoid for integers? Of course it isn't, multiplication on integers would form another proper monoid:</p>\n\n<pre><code>class Monoid Int where\n    mempty  = 1\n    mappend = (*)\n</code></pre>\n\n<p>Both instances are correct, but now we have a problem: if you would try to evaluate <code>1 `mappend` 2</code>, there is no way to figure out which instance must be used.</p>\n\n<p>That's why <code>Data.Monoid</code> wraps the instances for numbers into newtype wrappers, namely <code>Sum</code> and <code>Product</code>.</p>\n\n<p>Going further, your statement</p>\n\n<pre><code>instance Arbitrary Char where\n    arbitrary = choose ('0', '9')\n</code></pre>\n\n<p>might be very confusing. It says \"I am an arbitrary character\" but produces only digit characters. In my opinion this would be much better:</p>\n\n<pre><code>newtype DigitChar = DigitChar Char deriving (Eq, Show)\n\ninstance Arbitrary DigitChar where\n    arbitrary = fmap DigitChar (choose ('0', '9'))\n</code></pre>\n\n<p>A piece of cake. You can go further and hide a <code>DigitChar</code> constructor, providing <code>digitChar</code> 'smart constructor', which wouldn't allow to create a <code>DigitChar</code> which is not actually a digit.</p>\n\n<p>As of your question \"Do you know why that's not the approach the tutorial took?\", I think the reason is simple, the tutorial seems to be written in 2006, and in <a href=\"https://hackage.haskell.org/package/QuickCheck-1.0/docs/Test-QuickCheck.html\" rel=\"nofollow noreferrer\">those days</a> quickcheck simply didn't define an <code>Arbitrary</code> instance for <code>Char</code>. So the code in tutorial was perfectly valid back in the days.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 0, "last_activity_date": 1454239601, "creation_date": 1454239601, "answer_id": 35113296, "question_id": 29577850, "link": "https://stackoverflow.com/questions/29577850/cant-define-custom-arbitrary-instance-for-char-since-it-already-exists/35113296#35113296", "title": "Can&#39;t define custom `Arbitrary` instance for `Char` since it already exists", "body": "<p>You do not need to create new <code>Arbitrary</code> instances for ad-hoc test input generation. You can use <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck.html#v:forAll\" rel=\"nofollow\">QuickCheck's <code>forAll</code> combinator</a> to explicitly pick a <code>Gen a</code> to a function:</p>\n\n<pre><code>digit :: Gen Char\ndigit = choose ('0', '9)\n\nprop_myFun = forAll digit $ \\x -&gt; isAwesome (myFun x)\n</code></pre>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 29578642, "answer_count": 2, "score": 6, "last_activity_date": 1454239601, "creation_date": 1428755115, "question_id": 29577850, "link": "https://stackoverflow.com/questions/29577850/cant-define-custom-arbitrary-instance-for-char-since-it-already-exists", "title": "Can&#39;t define custom `Arbitrary` instance for `Char` since it already exists", "body": "<p>I tried following the <a href=\"https://wiki.haskell.org/Introduction_to_QuickCheck\">Introduction to Quickcheck</a> and wanted to test my function which takes strings containing of digits. For that, I defined an <code>Arbitrary</code> instance for <code>Char</code>:</p>\n\n<pre><code>instance Arbitrary Char where\n    arbitrary = choose ('0', '9')\n</code></pre>\n\n<p>But ghc complains about that:</p>\n\n<pre><code>A.hs:16:10:\nDuplicate instance declarations:\n  instance Arbitrary Char -- Defined at A.hs:16:10\n  instance [overlap ok] [safe] Arbitrary Char\n    -- Defined in \u2018Test.QuickCheck.Arbitrary\u2019\n</code></pre>\n\n<p>How can I tell it to forget about the already defined instance and use my own instance? Or will it not work that way at all (which would be strange, since the tutorial takes that approach)?</p>\n"}, {"tags": ["eclipse", "haskell", "eclipse-fp"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 1, "creation_date": 1428748754, "post_id": 29576737, "comment_id": 47302175, "body": "In your log a lot of dependent packages have failed to install. For each failure a path to a log file is given. Check these to see what&#39;s wrong, maybe just a single dependent package is causing the issue."}, {"owner": {"reputation": 107303, "user_id": 572, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ct4o3.jpg?s=128&g=1", "display_name": "Thomas Owens", "link": "https://stackoverflow.com/users/572/thomas-owens"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1428751616, "post_id": 29576737, "comment_id": 47302983, "body": "@JPMoresmau I went through all of the logs instead of just a few at random and found two that reported errors. However, I&#39;m not sure how to resolve those errors, especially since the libraries reported as missing are on my path."}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1428764442, "post_id": 29576737, "comment_id": 47306956, "body": "It may be an issue with the PATH when the install is launched from EclipseFP. Try to install buildwrapper and scion-browser from the command line via cabal-install, then you can configure EclipseFP to use the executables you installed. Use a Cabal sandbox to not pollute your system package database."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1428767764, "post_id": 29576737, "comment_id": 47308117, "body": "<code>msvcrt</code> is Microsoft&#39;s Visual C runtime library, but i&#39;d think you&#39;d need a <code>.dll</code> rather than a <code>.a</code>. <code>kernel32</code> is also distributed by Microsoft. Are you running 32bit or 64bit? What version of windows?"}, {"owner": {"reputation": 107303, "user_id": 572, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ct4o3.jpg?s=128&g=1", "display_name": "Thomas Owens", "link": "https://stackoverflow.com/users/572/thomas-owens"}, "reply_to_user": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1428769701, "post_id": 29576737, "comment_id": 47308807, "body": "@ja. I&#39;m running Windows 7 64-bit, 64-bit Eclipse, a 64-bit JDK, 64-bit MinGW, and the 64-bit installer for Haskell Platform. I&#39;ll edit this into the question when I&#39;m not on mobile as well."}], "answers": [{"tags": [], "owner": {"reputation": 107303, "user_id": 572, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ct4o3.jpg?s=128&g=1", "display_name": "Thomas Owens", "link": "https://stackoverflow.com/users/572/thomas-owens"}, "is_accepted": true, "score": 0, "last_activity_date": 1428928201, "creation_date": 1428928201, "answer_id": 29605374, "question_id": 29576737, "link": "https://stackoverflow.com/questions/29576737/installation-errors-when-installing-executables-for-eclipsefp/29605374#29605374", "title": "Installation errors when installing executables for EclipseFP", "body": "<p>I'm not exactly sure why this works. I'm guessing it has to do with dependencies (perhaps down to a version), but the issue was in my PATH environment variables. Haskell Platform comes with MinGW. When I moved Haskell Platform's directories above my MinGW directories in my PATH environment variable, things started to work.</p>\n\n<p>My MinGW is fully installed and up-to-date (at least as far as I can tell), so it may be the Haskell Platform has a dependency that's not a standard part of MinGW or has a dependency on specific versions of tools. Either way, moving the Haskell Platform directories (including the MinGW that comes with Haskell Platform) up first in my PATH variables resolved the issues.</p>\n"}], "owner": {"reputation": 107303, "user_id": 572, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ct4o3.jpg?s=128&g=1", "display_name": "Thomas Owens", "link": "https://stackoverflow.com/users/572/thomas-owens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 29605374, "answer_count": 1, "score": 2, "last_activity_date": 1428928201, "creation_date": 1428747629, "last_edit_date": 1428786843, "question_id": 29576737, "link": "https://stackoverflow.com/questions/29576737/installation-errors-when-installing-executables-for-eclipsefp", "title": "Installation errors when installing executables for EclipseFP", "body": "<p>I installed the EclipseFP 2.6.4 plugin under Eclipse Luna, then restarted. When it started to attempt to install the executables for the first time, nothing was installed successfully. I went through all of the log files that were generated and found two that contained errors: ansi-terminal-0.6.2.1 and unix-compat-0.4.1.4.</p>\n\n<p>The log for unix-compat-0.4.1.4:</p>\n\n<pre><code>Configuring unix-compat-0.4.1.4...\nsetup-Cabal-1.18.1.3-x86_64-windows-ghc-7.8.3.exe: Missing dependency on a\nforeign library:\n* Missing C library: msvcrt\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.\n</code></pre>\n\n<p>The log for ansi-terminal-0.6.2.1:</p>\n\n<pre><code>Configuring ansi-terminal-0.6.2.1...\nsetup-Cabal-1.18.1.3-x86_64-windows-ghc-7.8.3.exe: Missing dependency on a\nforeign library:\n* Missing C library: kernel32\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.\n</code></pre>\n\n<p>I installed the <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow\">Haskell Platform</a> 2014.2.0.0 for Windows 64-bit. It is on my path. I read someplace about MinGW being necessary, and MinGW and MSYS are both installed and up-to-date as well and the bin and lib folders for them are on my path. I checked the locations on my path and found a <code>libmsvctr.a</code> and <code>libkernel32.a</code> in C:\\MinGW\\mingw32\\lib (which is on my path).</p>\n\n<p>I think I'm missing something, but I'm not seeing anything in the <a href=\"http://eclipsefp.github.io/faq.html\" rel=\"nofollow\">FAQ</a> or on <a href=\"http://sourceforge.net/p/eclipsefp/discussion/371922\" rel=\"nofollow\">the support forum</a>.</p>\n"}, {"tags": ["haskell", "list-comprehension", "where-clause"], "answers": [{"comments": [{"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 0, "creation_date": 1428752278, "post_id": 29576805, "comment_id": 47303183, "body": "Thanks for the nice answer :-)"}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 7, "last_activity_date": 1428749428, "last_edit_date": 1428749428, "creation_date": 1428748033, "answer_id": 29576805, "question_id": 29576695, "link": "https://stackoverflow.com/questions/29576695/why-where-produces-a-parse-error-inside-list-comprehension-but-let-doesnt/29576805#29576805", "title": "Why `where` produces a parse error inside list comprehension, but `let` doesn&#39;t?", "body": "<p>As you can see in the Haskell Report (<a href=\"https://www.haskell.org/onlinereport/exps.html#list-comprehensions\">https://www.haskell.org/onlinereport/exps.html#list-comprehensions</a>) list comprehensions take an expression in the left hand side. <code>let</code> is an expression, whereas <code>where</code> is part of top level declarations. Hence, it's not allowed there.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1428835928, "last_edit_date": 1428835928, "creation_date": 1428748144, "answer_id": 29576824, "question_id": 29576695, "link": "https://stackoverflow.com/questions/29576695/why-where-produces-a-parse-error-inside-list-comprehension-but-let-doesnt/29576824#29576824", "title": "Why `where` produces a parse error inside list comprehension, but `let` doesn&#39;t?", "body": "<p>This is because List comprehensions are equivalent to <code>do</code>-syntax.</p>\n\n<p>To be clear, this:</p>\n\n<pre><code>[f a b q | a &lt;- as, b &lt;- bs, let q = a + b]\n</code></pre>\n\n<p>Is equivalent to:</p>\n\n<pre><code>do a &lt;- as\n   b &lt;- bs\n   let q = a + b\n   return (f a b q)\n</code></pre>\n\n<p>And <code>let</code> expressions are permitted in <code>do</code>-blocks.</p>\n\n<p>As for why <code>where</code> clauses aren't permitted, they're intended to provide a temporary scope in a top-level declaration.</p>\n\n<p>Ie:</p>\n\n<pre><code>binding = la da fu gu\n    where la a b c = c a b\n          da = 6\n          ...\n</code></pre>\n\n<p>In other words, <code>where</code> is only permitted after a variable has been described, and therefore is not correct in list comprehensions.</p>\n"}], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 29576805, "answer_count": 2, "score": 2, "last_activity_date": 1428835928, "creation_date": 1428747377, "question_id": 29576695, "link": "https://stackoverflow.com/questions/29576695/why-where-produces-a-parse-error-inside-list-comprehension-but-let-doesnt", "title": "Why `where` produces a parse error inside list comprehension, but `let` doesn&#39;t?", "body": "<p>Let's define a simple function called <code>func</code>:</p>\n\n<pre><code>func :: [Int] -&gt; [Int]\n</code></pre>\n\n<p>I would like to use a <code>where</code> clause inside a list comprehension when defining this bogus function.</p>\n\n<pre><code>func xs = [ y where y = x + 1 | x &lt;- xs]\n</code></pre>\n\n<p>Unfortunately, while trying to compile I get the following message:</p>\n\n<pre><code>parse error on input `where'\n</code></pre>\n\n<p>If I decide to use the <code>let</code> clause, everything works just fine:</p>\n\n<pre><code>func xs = [ let y = x + 1 in x | x &lt;- xs] -- compilation successful\n</code></pre>\n\n<p>Why can't I use <code>where</code> like I originally intended to?</p>\n"}, {"tags": ["haskell", "binary-search-tree"], "answers": [{"comments": [{"owner": {"reputation": 1129, "user_id": 1800854, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qycfQ.png?s=128&g=1", "display_name": "Mo Beigi", "link": "https://stackoverflow.com/users/1800854/mo-beigi"}, "edited": false, "score": 0, "creation_date": 1428750731, "post_id": 29577018, "comment_id": 47302731, "body": "Thanks! And no we are told insertBST is correct. In addition we got given incorrect insert functions, one of which did not accept duplicates so I guess our &#39;correct&#39; insert function should actually accept and insert duplicates."}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 3, "last_activity_date": 1428764554, "last_edit_date": 1428764554, "creation_date": 1428749398, "answer_id": 29577018, "question_id": 29576573, "link": "https://stackoverflow.com/questions/29576573/what-do-these-properties-mean-for-an-insert-function-for-a-binary-search-tree/29577018#29577018", "title": "What do these properties mean for an insert function for a Binary Search Tree", "body": "<p>You should check with whoever gave you the exercise!</p>\n\n<p>But anyway, I think you're right for the first two. First one, you check that if isBST is true on a Leaf, it's still true after inserting the given integer. Second one, you check has you said the length and the presence of the inserted integer.</p>\n\n<p>For the third one, you insert the first integer, then newInteger and check integer is still present.</p>\n\n<p>For the fourth one, you need to insert the integer twice and check the results are expected. It does look like the current code does not check for duplicates, are you sure you shouldn't fix the insertBST function? If that's right, you need to check the side arguments, if not you need to check inserting twice produced the same tree as inserting once.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1129, "user_id": 1800854, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qycfQ.png?s=128&g=1", "display_name": "Mo Beigi", "link": "https://stackoverflow.com/users/1800854/mo-beigi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 29577018, "answer_count": 1, "score": 1, "last_activity_date": 1428764554, "creation_date": 1428746650, "question_id": 29576573, "link": "https://stackoverflow.com/questions/29576573/what-do-these-properties-mean-for-an-insert-function-for-a-binary-search-tree", "title": "What do these properties mean for an insert function for a Binary Search Tree", "body": "<p>So my task is to write some properties to check the correctness of an insert function for a BST.</p>\n\n<p>Here is the <a href=\"https://gist.github.com/mohammadg/e79506d3bfabc0bb2087\" rel=\"nofollow\">stub code</a>.</p>\n\n<p>My issue is determining what it is I actually need to do.\nI've deduced the correct way to insert into the BST is to insert at the proper place (to preserve BST property) and to allow duplicates to be inserted.</p>\n\n<p>Can you help me determine what each property means? Here are my current thoughts:</p>\n\n<p><code>prop_insert_preserves_bst insertFunction integer</code><br>\nThis means check that the structure of the BST is correct. That is, each element is in the proper place and all elements in the left branch have lower values and all elements in the right branch have higher values.</p>\n\n<p><code>prop_insert_adds_element insertFunction integer</code><br>\nI am confused about this one. Originally I just checked that the new tree (after insertion) container integer. Now I actually check that the new tree is 1 length longer and has 1 new element which is integer.</p>\n\n<p><code>prop_insert_does_not_change_other_elements insertFunction integer newInteger</code><br>\nFor this one I checked that every element in new tree is same as original tree. However I have no idea what newInteger is, I didn't use it in my implementation.</p>\n\n<p><code>prop_insert_duplicate_check insertFunction integer</code><br>\nThis was is even more confusing. Right now I have implemented it in the same way as <code>prop_insert_duplicate_check insertFunction integer</code>. Does it mean that duplicates are accepted and inserted into the tree? (Remember that <code>insertBST</code> function is correct and so must pass all of these properties).</p>\n"}, {"tags": ["haskell", "io", "monads", "state"], "comments": [{"owner": {"reputation": 623, "user_id": 1722055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vGZO2.jpg?s=128&g=1", "display_name": "bisserlis", "link": "https://stackoverflow.com/users/1722055/bisserlis"}, "edited": false, "score": 1, "creation_date": 1428748326, "post_id": 29581137, "comment_id": 47310613, "body": "Isn&#39;t this just a specialization of the <code>StateT</code> constructor?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 623, "user_id": 1722055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vGZO2.jpg?s=128&g=1", "display_name": "bisserlis", "link": "https://stackoverflow.com/users/1722055/bisserlis"}, "edited": false, "score": 0, "creation_date": 1428748459, "post_id": 29581137, "comment_id": 47310614, "body": "@bisserlis ahah, I think you&#39;re right"}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 2, "last_activity_date": 1428751909, "creation_date": 1428751909, "answer_id": 29581138, "question_id": 29581137, "link": "https://stackoverflow.com/questions/29581137/how-can-i-turn-a-monadic-function-into-a-monadic-state-transformer/29581138#29581138", "title": "How can I turn a monadic function into a monadic state transformer?", "body": "<p>Oh well. Thanks @bisserlis.</p>\n\n<pre><code>stateIO = StateT\n</code></pre>\n\n<p>(perhaps applied to avoid monomorphism restriction).</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1428774915, "question_id": 86582}, "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29581138, "answer_count": 1, "score": 0, "last_activity_date": 1444747553, "creation_date": 1428744067, "last_edit_date": 1444747553, "question_id": 29581137, "link": "https://stackoverflow.com/questions/29581137/how-can-i-turn-a-monadic-function-into-a-monadic-state-transformer", "title": "How can I turn a monadic function into a monadic state transformer?", "body": "<p>Basically, what I want is this:</p>\n\n<pre><code>stateIO :: (s -&gt; IO (a, s)) -&gt; StateT s IO a\nstateIO f = do\n    r &lt;- get\n    (a, r') &lt;- liftIO $ f r\n    put r'\n    return a\n</code></pre>\n\n<p>I tried to use <code>state</code>, but the inner <code>liftIO</code> is problematic. Is there another way to be more clever, without that manual tuple unpacking?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 122984, "user_id": 500104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ff1143d80ee378720a879e79fe6da68f?s=128&d=identicon&r=PG", "display_name": "Xeo", "link": "https://stackoverflow.com/users/500104/xeo"}, "edited": false, "score": 5, "creation_date": 1428736623, "post_id": 29575128, "comment_id": 47298965, "body": "The second <code>where</code> is scoped to <code>sndHalf</code> - just remove it and the indentation, and you&#39;re fine."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1428739866, "post_id": 29575128, "comment_id": 47299707, "body": "While we&#39;re at it, this function could be sooo much simpler: <code>isPlalin xs = reverse xs == xs</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1428741968, "post_id": 29575426, "comment_id": 47300193, "body": "Haskell most definitely grows on you! :-)"}], "tags": [], "owner": {"reputation": 64980, "user_id": 954986, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9bc332a4fccaf3e527fdc258b6990f2d?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/954986/nathan"}, "is_accepted": false, "score": 5, "last_activity_date": 1428738293, "creation_date": 1428738293, "answer_id": 29575426, "question_id": 29575128, "link": "https://stackoverflow.com/questions/29575128/haskell-nested-where-clause-and-let-in-syntax/29575426#29575426", "title": "Haskell nested where clause and &quot;let ... in&quot; syntax", "body": "<p>As was mentioned in the comments, for <code>isPalin1</code> the <code>where</code> is scoped to <code>sndHalf</code>, and not <code>fstHalf</code>. The way I would re-write the <code>isPalin1</code> example (syntactically) is as such:</p>\n\n<pre><code>isPalin1 xs = fstHalf == reverse sndHalf\n  where length' a = fromIntegral (length a)\n        halfLength = (length' xs) / 2\n        fstHalf = take halfLength xs\n        sndHalf = drop halfLength xs\n</code></pre>\n\n<p>That won't give you any parse errors, and the scope all works out. However, it won't compile, because your logic for it is off.</p>\n\n<p>The question is <em>why</em> do you need fromIntegral? The answer, from looking at the code, is that you're trying to split a list in a half, and possibly you got a compilation error earlier when trying to do something like <code>(length xs) / 2</code>. It looks like what you're trying to do is split the list in half, but that simply doesn't work for odd-length lists with the given logic. If a list is of length <code>11</code>, what should <code>fstHalf</code> and <code>sndHalf</code> be? <code>(fromIntrgral (length xs)) / 2</code> will make <code>halfLength</code> to be <code>5.5</code>, but you can't take <code>5.5</code> elements from a list, so Haskell's type system gets confused </p>\n\n<p>Instead of this, you can use  <code>(length xs) `div` 2</code> to do integer division, discarding the remainder. If <code>xs</code> is length <code>10</code>, it will return <code>5</code>. If <code>xs</code> is length <code>11</code>, it will return <code>5</code>. I don't want to give you a full solution in case this is a homework problem, but just think about how you can use integer division to make your program work. Think about how lists being even or odd in length would affect the algorithm that determines if they are palindrome, and make your code take that into account. </p>\n\n<p>As for  the second error your getting: the reason is because you have two functions, <code>fstHalf</code> and <code>sndHalf</code> that are located in the <code>in</code> clause of a let statement, causing a parse error. In general, I would advise avoiding nesting <code>where</code> and <code>if</code> statements unless you absolutely have to or you're a masochist. One you clear up the logic, try sticking to the format of the example <code>where</code> statement I gave at the start of this post, it makes things a lot simpler. </p>\n\n<p>And don't give up on Haskell, it grows on you. :)</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 6, "last_activity_date": 1428739770, "last_edit_date": 1428739770, "creation_date": 1428739250, "answer_id": 29575556, "question_id": 29575128, "link": "https://stackoverflow.com/questions/29575128/haskell-nested-where-clause-and-let-in-syntax/29575556#29575556", "title": "Haskell nested where clause and &quot;let ... in&quot; syntax", "body": "<p><code>where</code> only applies to one binding, so <code>halfLength</code> in your first snippet is only available to <code>sndHalf</code>. You should write this:</p>\n\n<pre><code>length' a = fromIntegral (length a)\n\nisPalin1 xs = fstHalf == reverse sndHalf\n    where\n        halfLength = (length' xs) / 2\n        fstHalf = take halfLength xs\n        sndHalf = drop halfLength xs\n</code></pre>\n\n<p>This is because <code>where</code> is a scope in itself, so bindings may refer to one another.</p>\n\n<p>As for your second snippet, that's altogether incorrect. A <code>let \u22ef in</code> statement is strictly an expression, and cannot be used in a the binding context of <code>where</code>.</p>\n\n<p>If you where to use <code>let \u22ef in</code>, you would use it like this:</p>\n\n<pre><code>length' a = fromIntegral (length a)\n\nisPalin1 xs =\n    let halfLength = (length' xs) / 2\n        fstHalf = take halfLength xs\n        sndHalf = drop halfLength xs\n    in  fstHalf == reverse sndHalf\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 843355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58db6d2d7be3a77dbfb2e03b85545c05?s=128&d=identicon&r=PG", "display_name": "user843355", "link": "https://stackoverflow.com/users/843355/user843355"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 0, "accepted_answer_id": 29575556, "answer_count": 2, "score": 3, "last_activity_date": 1428739770, "creation_date": 1428736118, "question_id": 29575128, "link": "https://stackoverflow.com/questions/29575128/haskell-nested-where-clause-and-let-in-syntax", "title": "Haskell nested where clause and &quot;let ... in&quot; syntax", "body": "<p>I'm just starting out with Haskell.</p>\n\n<p>What is the problem with this nested where clause?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>length' a = fromIntegral (length a)\n\nisPalin1 xs = fstHalf == reverse sndHalf\n    where\n        fstHalf = take halfLength xs\n        sndHalf = drop halfLength xs\n            where halfLength = (length' xs) / 2\n</code></pre>\n\n<p>The error I get: <code>isPalin1.hs:5:32: Not in scope: \u2018halfLength\u2019</code></p>\n\n<p>The below too is wrong, hopefully someone can tall me why:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>length' a = fromIntegral (length a)\n\nisPalin2 xs = fstHalf == reverse sndHalf\n    where\n        let\n            halfLength = (length' xs) / 2\n        in\n            fstHalf = take halfLength xs\n            sndHalf = drop halfLength xs\n</code></pre>\n\n<p>The error message:</p>\n\n<pre><code>isPalin2.hs:7:17:\n    parse error (possibly incorrect indentation or mismatched brackets)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428739440, "post_id": 29574302, "comment_id": 47299611, "body": "You could make this a whole lot simpler! <code>kElemFE n xs = reverse xs !! n</code>"}], "answers": [{"comments": [{"owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1428728961, "post_id": 29574331, "comment_id": 47297561, "body": "but I want to take the last elements, where as the pattern of (x:xs) keeps splitting it to heads and tail. I want last and head. How do I signal haskell that I&#39;m looking for a multiple element list?"}, {"owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1428729588, "post_id": 29574331, "comment_id": 47297699, "body": "Thanks! I must have misunderstood something though. say I were to write kElementFromEnd without first declaring it&#39;s signature (first line of code), how could haskell conclude that xs is a list? shouldn&#39;t I use the [x] notation to signal it&#39;s a list in the function&#39;s body?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1428730668, "post_id": 29574331, "comment_id": 47297893, "body": "@vondip <code>[x]</code> is a type, the <code>x</code> used here has nothing to do with what you name your function&#39;s arguments.  The type is completely equivalent to <code>Int -&gt; [a] -&gt; [a]</code> or <code>Int -&gt; [element] -&gt; [element]</code>.  When pattern matching on arguments, what you&#39;re actually doing is pattern matching on constructors of data types.  Lists have the constructors <code>[] :: [a]</code> and <code>(:) :: a -&gt; [a] -&gt; [a]</code>.  Haskell also has special syntax sugar for working with list literals as <code>[a, b, c, d]</code>, but the compiler turns this into <code>a:(b:(c:(d:[])))</code> internally.  Thus, <code>[x] == x:[]</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1428730688, "post_id": 29574331, "comment_id": 47297897, "body": "@vondip If you aren&#39;t matching on constructors, you&#39;re just using names by themselves, like <code>add x y = x + y</code> or <code>take5 xs = take 5 xs</code>.  The names used here of <code>x</code>, <code>y</code>, and <code>xs</code> just match whatever value is passed there, it&#39;s a named catch-all.  You can also use <code>_</code> syntax to match any value where you don&#39;t care to bind that value to a name, as in <code>const x _ = x</code>.  in this case Haskell can determine it&#39;s a list because you&#39;re calling <code>last :: [a] -&gt; a</code> and <code>init :: [a] -&gt; [a]</code> on it.  Haskell&#39;s smart enough to figure out that <code>xs</code> can only be a list."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1428735881, "post_id": 29574331, "comment_id": 47298818, "body": "@vondip &quot;How could Haskell conclude that <code>xs</code> is a list?&quot; Well, a couple ways: it&#39;s clearly a list in the first equation (since you use the pattern <code>[]</code>), and it&#39;s clearly a list in the second equation (since you pass it to <code>last</code> and <code>init</code>, which only work on lists)."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1428729409, "last_edit_date": 1428729409, "creation_date": 1428728724, "answer_id": 29574331, "question_id": 29574302, "link": "https://stackoverflow.com/questions/29574302/haskell-finding-kth-element-from-end-and-haskells-cant-match-the-pattern/29574331#29574331", "title": "Haskell - finding k&#39;th element from end, and haskell&#39;s can&#39;t match the pattern", "body": "<p>You've only matched empty lists (<code>[]</code>) and single element lists (<code>[x]</code>).  I think you mean to replace <code>[x]</code>, a pattern which matches a single element list and assign's that single value to <code>x</code>, with simply <code>xs</code>, a pattern which matches any list not already matched.  This would look like</p>\n\n<pre><code>kElementFromEnd :: Int -&gt; [x] -&gt; x\n-- This pattern matches the empty list\nkElementFromEnd _ [] = error \"cannot request k item from empty list\"\n-- This pattern is just a name, so it matches everything else\n-- i.e. non-empty lists\nkElementFromEnd k xs\n    | k &lt; 0 = error \"k must be non negative\"\n    | k == 0 = last xs\n    | otherwise = kElementFromEnd (k-1) (init xs)\n</code></pre>\n\n<p>And it would work as</p>\n\n<pre><code>&gt; kElementFromEnd 0 [1..5]\n5\n&gt; kElementFromEnd 4 [1..5]\n1\n&gt; map (\\i -&gt; kElementFromEnd i [1..10]) [0..9]\n[10,9,8,7,6,5,4,3,2,1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 4, "last_activity_date": 1428738822, "creation_date": 1428738822, "answer_id": 29575493, "question_id": 29574302, "link": "https://stackoverflow.com/questions/29574302/haskell-finding-kth-element-from-end-and-haskells-cant-match-the-pattern/29575493#29575493", "title": "Haskell - finding k&#39;th element from end, and haskell&#39;s can&#39;t match the pattern", "body": "<p>Writing such a function is definitely a good exercise. First, GHC can help you to catch errors like this. In particular <code>-fwarn-incomplete-patterns</code> will issue a warning if your patterns are incomplete, preventing nasty run-time errors. With <code>-Werror</code> you can also make it an error, to be sure you won't miss the warning. It's not a bad practice to compile with <code>-Wall -Werror</code> to eliminate all possible warnings.</p>\n\n<p>Second, to make the exercise harder: Since <code>init</code> is <em>O(n)</em>, your implementation of the function is <em>O(kn)</em> (or to be more precise <em>O(min(k,n) n)</em>. For very small <em>k</em> it doesn't matter that much, but if <em>k\u2248n</em>, you'll get quadratic performance. So I'd suggest you you to try to find an implementation that is</p>\n\n<ul>\n<li><em>O(n)</em> (independent of <em>k</em>),</li>\n<li>works well for large, lazy lists; that is, traverse a list in such a way that if nothing else keeps the list in memory, the elements at the beginning of the list are continuously discarded by the GC; in particular, the space complexity should be independent of <em>n</em>.</li>\n</ul>\n\n<p>Spoiler:</p>\n\n<blockquote class=\"spoiler\">\n  <p> <code>kElementFromEnd k xs = last $ zipWith const xs (drop k xs)</code></p>\n</blockquote>\n\n<p>Also, it's usually better to fail gracefully, as calling <code>error</code> means that your program exists immediately. So another improvement would be to make the type signature</p>\n\n<pre><code>kElementFromEnd :: Int -&gt; [x] -&gt; Maybe x\n</code></pre>\n"}], "owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 29574331, "answer_count": 2, "score": 1, "last_activity_date": 1428738822, "creation_date": 1428728387, "question_id": 29574302, "link": "https://stackoverflow.com/questions/29574302/haskell-finding-kth-element-from-end-and-haskells-cant-match-the-pattern", "title": "Haskell - finding k&#39;th element from end, and haskell&#39;s can&#39;t match the pattern", "body": "<p>I'm trying to implement a recursive function that returns the k's element from the end. </p>\n\n<p>This my attempt:</p>\n\n<pre><code>kElementFromEnd :: Int -&gt; [x] -&gt; x\n\nkElementFromEnd _ [] = error \"cannot request k item from empty list\"\nkElementFromEnd k [x]\n    | k &lt; 0 = error \"k must be non negative\"\n    | k == 0 = last [x]\n    | otherwise = kElementFromEnd (k-1) (init [x])\n</code></pre>\n\n<p>And this is the error I'm receiving:</p>\n\n<pre><code>*Main&gt; kElementFromEnd 2 [1,2,3]\n*** Exception: EX2.hs:(4,1)-(8,54): Non-exhaustive patterns in function kElementFromEnd\n</code></pre>\n\n<p>I really don't understand why haskell can't match the pattern. What's going on that I'm not understanding?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "optimization", "lazy-evaluation"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1428732527, "post_id": 29574156, "comment_id": 47298211, "body": "You might want to consider tries and related structures."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1428735475, "post_id": 29574156, "comment_id": 47298743, "body": "You might like the &quot;Better algorithm&quot; section of <a href=\"http://stackoverflow.com/a/27893057/791604\">this answer</a>, which discusses how to turn a function that produces a list of candidates into a function that produces a tree of candidates, which can then be more effectively pruned. You could take a similar route with your <code>paths</code> function: instead of returning a list of paths, return a tree, and then cut off subtrees of paths that don&#39;t lex early on."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1428735816, "post_id": 29574156, "comment_id": 47298801, "body": "The fastest solution here would be searching a <a href=\"http://en.wikipedia.org/wiki/Deterministic_acyclic_finite_state_automaton\" rel=\"nofollow noreferrer\">DAWG</a> of the dictionary."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1428737929, "post_id": 29574156, "comment_id": 47299259, "body": "As for the &quot;how do I know when I&#39;m in a prefix that can&#39;t be salvaged&quot; part: just use the regular language <code>(i|think|this|will|work)*</code> (where you include all words in the English language inside the parentheses). Just about everything about regular languages is decidable -- including whether the DFA for it is currently in a &quot;dead state&quot; that can never reach a final state."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1428752438, "post_id": 29574156, "comment_id": 47303226, "body": "Thanks for your comments so far. I was vaguely imagining some sort of mix between a DFA and a tree that could help me out, and the DAWG seems to be exactly that. I&#39;ll see if that helps me out."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428753344, "post_id": 29574156, "comment_id": 47303503, "body": "Oh, @DanielWagner mentioned <code>criterion</code> in his linked answer, which looks neat, too! I&#39;m going to give that a try (I was doing bad benchmarks with the Unix <code>time</code> command.)"}], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1428726858, "creation_date": 1428726858, "question_id": 29574156, "link": "https://stackoverflow.com/questions/29574156/haskell-can-i-use-laziness-to-abort-early-and-gain-performance", "title": "Haskell: can I use laziness to &quot;abort early&quot; and gain performance?", "body": "<p>I'm writing a Haskell program that reads a wordlist of the English language and a rectangular grid of letters such as:</p>\n\n<pre><code>I T O L\nI H W S\nN H I S\nK T S I\n</code></pre>\n\n<p>and then finds a <a href=\"https://en.wikipedia.org/wiki/Hamiltonian_path\" rel=\"nofollow\">Hamiltonian path</a> through the grid from the top-left corner that spells out a sequence of English words, such as:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>--&gt; $ runghc unpacking.hs &lt; 4x4grid.txt\nI THINK THIS IS SLOW\n</code></pre>\n\n<p>(If there are multiple solutions, it can just print any one it finds and stop looking.)</p>\n\n<p>The na\u00efve, strict approach is to generate a full path and then try to split it up into words. However, assuming that I'm doing this (and currently I am forcing myself to -- see below) I'm spending a lot of time finding paths like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>IINHHTOL...\nIINHHTOW...\nIINHHWOL...\n</code></pre>\n\n<p>These are obviously never going to turn out to be words, looking at the first few letters (<code>\"IINH\"</code> can't be split into words, and no English word contains <code>\"NHH\"</code>.) So, say, in the above grid, I don't want to look at the many<sup>[1]</sup> paths that begin with <code>IINHH</code>.</p>\n\n<p>Now, my functions look like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>paths :: Coord -&gt; Coord -&gt; [[Coord]]\npaths (w, h) (1, 1) = [[(1, 1), (1, 2), ... (x, y)], ...]\n\nlexes :: Set String -&gt; String -&gt; [[String]]\nlexes englishWordset \"ITHINKTHISWILLWORK\" = [[\"I\", \"THINK\", \"THIS\", ...], ...]\n</code></pre>\n\n<p><code>paths</code> just finds all the paths worth considering on a <code>(w, h)</code> grid. <code>lexes</code> finds all the ways to chop a phrase up, and is defined as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>lexes language [] = [[]]\nlexes language phrase = let\n  splits = tail $ zip (inits phrase) (tails phrase)\n  in concat [map (w:) (lexes language p') | (w, p') &lt;- splits,\n             w `S.member` language]\n</code></pre>\n\n<p>Given <code>\"SAMPLESTRING\"</code>, it looks at <code>\"S\"</code>, then <code>\"SA\"</code>, then <code>\"SAM\"</code>... as soon as it finds a valid word, it recurses and tries to \"lex\" the rest of the string. (First it will recurse on <code>\"PLESTRING\"</code> and try to make phrases with <code>\"SAM\"</code>, but find no way to chop \"plestring\" up into words, and fail; then it will find <code>[\"SAMPLE\", \"STRING\"]</code>.)</p>\n\n<p>Of course, for an invalid string above, any hope of being \"lazy\" is lost by following this approach: in the example from earlier we need to still search beyond a ridiculous phrase like <code>\"ITOLSHINHISIST\"</code>, because maybe <code>\"ITOLSHINHISISTK\"</code> (one letter longer) <em>might</em> form a valid single word.</p>\n\n<p>I feel like somehow I could use laziness here to improve performance throughout the entire program: if the first few characters of <code>phrase</code> aren't a prefix of <em>any</em> word, we can bail out entirely, stop evaluating the rest of <code>phrase</code>, and thus the rest of the path.<sup>[2]</sup> Does this make sense at all? Is there some tree-like data structure that will help me check not for set membership, but set \"prefix-ness\", thereby making checking validity lazier?</p>\n\n<p><sup>[1] Obviously, for a 4x4 grid there are very few of these, but this argument is about the general case: for bigger grids I could skip hundreds of thousands of paths the moment I see they start with \"JX\".\n<br>[2] <code>phrase</code> is just <code>map (grid M.!) path</code> for some <code>Map Coord Char</code> <code>grid</code> read from the input file.</sup></p>\n"}, {"tags": ["function", "haskell", "arguments"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428699861, "post_id": 29570388, "comment_id": 47290681, "body": "Functions in Haskell are called <code>fun arg1 arg2 ...</code>, not <code>fun(arg1, arg2 ...)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1428702320, "post_id": 29570550, "comment_id": 47291694, "body": "A nice idiom: <code>deleteif (x:xs) f = [x | not (f x)] ++ deleteif xs f</code>. Also, <code>deleteif xs f = filter (not . f) xs</code>"}], "tags": [], "owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "is_accepted": false, "score": 2, "last_activity_date": 1428700051, "last_edit_date": 1428700051, "creation_date": 1428699364, "answer_id": 29570550, "question_id": 29570388, "link": "https://stackoverflow.com/questions/29570388/haskell-too-many-arguments-error/29570550#29570550", "title": "Haskell too many arguments error", "body": "<p>the problem is in <code>deleteif((tail x) f)</code></p>\n\n<p>it becomes <code>deleteif (tail x f)</code></p>\n\n<p>so tail gets 2 arguments</p>\n\n<p>and then <code>deleteif a</code></p>\n\n<p>so deleteif gets 1 argument</p>\n\n<p>you want <code>deleteif (tail x) f</code></p>\n\n<p><code>head x == f</code> is wrong you want `f (head x)</p>\n\n<p>you can use pattern matching ,guards and make it more generic</p>\n\n<pre><code>deleteif :: [a] -&gt; (a -&gt; Bool) -&gt; [a]\ndeleteif [] _ = []\ndeleteif (x:xs) f\n    | f x       =     deleteif xs f \n    | otherwise = x : deleteif xs f\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1428699548, "post_id": 29570552, "comment_id": 47290545, "body": "I think <code>head x == f</code> will be a type error itself ?"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428699596, "post_id": 29570552, "comment_id": 47290565, "body": "Fixed with my best guess of what the OP wanted."}], "tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": true, "score": 4, "last_activity_date": 1428699589, "last_edit_date": 1428699589, "creation_date": 1428699366, "answer_id": 29570552, "question_id": 29570388, "link": "https://stackoverflow.com/questions/29570388/haskell-too-many-arguments-error/29570552#29570552", "title": "Haskell too many arguments error", "body": "<p>The issue is that you don't use parentheses to call a function in Haskell.  So you just need to use</p>\n\n<pre><code>if f (head x)\n   then deleteif (tail x) f\n   else [head x] ++ deleteif (tail x) f \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1428704783, "creation_date": 1428704783, "answer_id": 29571610, "question_id": 29570388, "link": "https://stackoverflow.com/questions/29570388/haskell-too-many-arguments-error/29571610#29571610", "title": "Haskell too many arguments error", "body": "<p>As already said, <code>deleteif((tail x) f)</code> is parsed as <code>deleteif (tail x f)</code>, which means <code>tail</code> is applied to the two arguments <code>x</code> and <code>f</code>, and the result would then be passed on as the single argument to <code>deleteif</code>. What you want is <code>deleteif (tail x) f</code>, which is equivalent to <code>(deleteif (tail x)) f</code> and what most languages<sup>1</sup> would write <code>deleteif(tail x, f)</code>.</p>\n\n<p>This parsing order may seem confusing initially, but it turns out to be really useful in practice. The general name for the technique is <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow\">Currying</a>.</p>\n\n<ul>\n<li>For one thing, it allows you to write dense statements without needing many parentheses &ndash; in fact <code>deleteif (tail x f)</code> could also be written <code>deleteif $ tail x f</code>.</li>\n<li>More importantly, because the arguments don't need to be &ldquo;encased&rdquo; in a single tuple, you don't need to supply them all at once but automatically get <em>partial application</em> when you apply to only one argument. For instance, you could use this function like that: <code>deleteif (&gt;4) [1,3,7,5,2,9,7]</code> to yield <code>[7,5,9,7]</code>. This works by partially applying the function<sup>2</sup> <code>&gt;</code> to <code>4</code>, leaving a single-argument function which can be used to filter the list.</li>\n</ul>\n\n<hr>\n\n<p><sup>1</sup><sub>Indeed, this style is <em>possible</em> in Haskell as well: just write the signatures of such multi-argument functions as <code>deleteif :: ([Int], Int-&gt;Bool) -&gt; [Int]</code>. Or write <code>uncurry deleteif (tail x, f)</code>. But it's definitely better you get used to the curried style!</sub></p>\n\n<p><sup>2</sup><sub>Actually, <code>&gt;</code> is an <em>infix</em> which behaves a bit different &ndash; you can partially apply it to either side, i.e. you can also write <code>deleteif (4&gt;) [1,3,7,5,2,9,7]</code> to get <code>[1,3,2]</code>.</sub></p>\n"}], "owner": {"reputation": 13, "user_id": 4775269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f8c58eb50aa6c947a17ed9ecf4e832?s=128&d=identicon&r=PG&f=1", "display_name": "atmosfir", "link": "https://stackoverflow.com/users/4775269/atmosfir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "accepted_answer_id": 29570552, "answer_count": 3, "score": 0, "last_activity_date": 1428754929, "creation_date": 1428698754, "last_edit_date": 1428754929, "question_id": 29570388, "link": "https://stackoverflow.com/questions/29570388/haskell-too-many-arguments-error", "title": "Haskell too many arguments error", "body": "<p>I am learning Haskell. I am trying to make a function that deletes integers out of a list when met with the parameters of a certain function f. </p>\n\n<pre><code>deleteif :: [Int] -&gt; (Int -&gt; Bool) -&gt; [Int]\ndeleteif x f = if x == [] \n                then [] \n                else if head x == f \n                       then deleteif((tail x) f)  \n                       else [head x] ++ deleteif((tail x) f)\n</code></pre>\n\n<p>I get the following errors :</p>\n\n<ul>\n<li><p>function tail is applied to two arguments</p></li>\n<li><p>'deleteif' is applied to too few arguments</p></li>\n</ul>\n"}, {"tags": ["haskell", "threepenny-gui"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1428695939, "post_id": 29569542, "comment_id": 47288875, "body": "The entire error is just saying &quot;You wrote <code>IO ()</code>, but you meant <code>UI ()</code>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "edited": false, "score": 0, "creation_date": 1428701328, "post_id": 29569683, "comment_id": 47291294, "body": "thanks a lot... i feel kind of stupid now. I should have seen that, but since i wrote it after a tutorial i was a little bit confused."}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": false, "score": 8, "last_activity_date": 1428695699, "creation_date": 1428695699, "answer_id": 29569683, "question_id": 29569542, "link": "https://stackoverflow.com/questions/29569542/getting-errors-when-trying-to-test-threepenny-gui/29569683#29569683", "title": "Getting Errors when trying to test threepenny-gui", "body": "<p>setup is in the UI monad, not IO, so change the type declaration:</p>\n\n<pre><code>setup :: Window -&gt; UI()\n</code></pre>\n\n<p>As for example in <a href=\"https://github.com/HeinrichApfelmus/threepenny-gui/blob/master/samples/BarTab.hs\">https://github.com/HeinrichApfelmus/threepenny-gui/blob/master/samples/BarTab.hs</a></p>\n"}], "owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428695699, "creation_date": 1428695069, "question_id": 29569542, "link": "https://stackoverflow.com/questions/29569542/getting-errors-when-trying-to-test-threepenny-gui", "title": "Getting Errors when trying to test threepenny-gui", "body": "<p>i want to try out the threepenny-gui package for haskell.\nSo i run</p>\n\n<pre><code>cabal install threepenny-gui\n</code></pre>\n\n<p>... without any problems</p>\n\n<p>So i tried the following example:</p>\n\n<pre><code>module Main where\n\nimport qualified Graphics.UI.Threepenny as UI\nimport                  Graphics.UI.Threepenny.Core\n\nmain :: IO ()\nmain = do\n    startGUI defaultConfig setup\n\nsetup :: Window -&gt; IO ()\nsetup window = do\n    return window # set UI.title \"Hello World!\" \n\n    button &lt;- UI.button # set UI.text \"Click me!\"\n    getBody window #+ [element button]\n\n    on UI.click button $ const $ do\n        element button # set UI.text \"I have been clicked!\"\n</code></pre>\n\n<p>but i get a Errors about the types:</p>\n\n<pre><code>threePennyHelloWorld.hs:8:28:\n    Couldn't match type `IO ()' with `UI ()'\n    Expected type: Window -&gt; UI ()\n      Actual type: Window -&gt; IO ()\n    In the second argument of `startGUI', namely `setup'\n    In a stmt of a 'do' block: startGUI defaultConfig setup\n\nthreePennyHelloWorld.hs:12:25:\n    Couldn't match type `UI Window' with `IO a0'\n    Expected type: UI Window -&gt; IO a0\n      Actual type: UI Window -&gt; UI Window\n    In the second argument of `(#)', namely `set title \"Hello World!\"'\n    In a stmt of a 'do' block: return window # set title \"Hello World!\"\n\nthreePennyHelloWorld.hs:14:31:\n    Couldn't match type `UI Element' with `IO Element'\n    Expected type: UI Element -&gt; IO Element\n      Actual type: UI Element -&gt; UI Element\n    In the second argument of `(#)', namely `set text \"Click me!\"'\n    In a stmt of a 'do' block:\n      button &lt;- UI.button # set text \"Click me!\"\n\nthreePennyHelloWorld.hs:15:9:\n    Couldn't match type `UI' with `IO'\n    Expected type: IO Element\n      Actual type: UI Element\n    In a stmt of a 'do' block: getBody window #+ [element button]\n    In the expression:\n      do { return window # set title \"Hello World!\";\n           button &lt;- UI.button # set text \"Click me!\";\n           getBody window #+ [element button];\n           on UI.click button\n           $ const $ do { element button # set text \"I have been clicked!\" } }\n    In an equation for `setup':\n        setup window\n          = do { return window # set title \"Hello World!\";\n                 button &lt;- UI.button # set text \"Click me!\";\n                 getBody window #+ [element button];\n                 .... }\n\nthreePennyHelloWorld.hs:17:9:\n    Couldn't match type `UI' with `IO'\n    Expected type: IO ()\n      Actual type: UI ()\n    In a stmt of a 'do' block:\n      on UI.click button\n      $ const $ do { element button # set text \"I have been clicked!\" }\n    In the expression:\n      do { return window # set title \"Hello World!\";\n           button &lt;- UI.button # set text \"Click me!\";\n           getBody window #+ [element button];\n           on UI.click button\n           $ const $ do { element button # set text \"I have been clicked!\" } }\n    In an equation for `setup':\n        setup window\n          = do { return window # set title \"Hello World!\";\n                 button &lt;- UI.button # set text \"Click me!\";\n                 getBody window #+ [element button];\n                 .... }\n</code></pre>\n\n<p>even when i try to run an example File, i get the same errors</p>\n\n<p>Does anyone have an idea what i'am doing wrong?</p>\n"}, {"tags": ["string", "list", "haskell"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1428695060, "post_id": 29569393, "comment_id": 47288429, "body": "Is <code>[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;A&quot;,&quot;B&quot;,&quot;N&quot;]</code> your string, i.e. <code>&quot;[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;A&quot;,&quot;B&quot;,&quot;N&quot;]&quot;</code>, or is it a list of strings? You&#39;re quite unclear."}, {"owner": {"reputation": 767, "user_id": 4576720, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/YsT74.jpg?s=128&g=1", "display_name": "Rain Man", "link": "https://stackoverflow.com/users/4576720/rain-man"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1428695276, "post_id": 29569393, "comment_id": 47288539, "body": "@gspr sorry it is a list of strings"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1428695447, "post_id": 29569393, "comment_id": 47288623, "body": "Right, so then it makes no sense to &quot;strip the []&quot;! That&#39;s just notation for the list. Do you, instead, want to turn a list of strings into a string with all the elements comma-separated?"}, {"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 1, "creation_date": 1428696939, "post_id": 29569393, "comment_id": 47289387, "body": "your <code>setofalph</code> takes a function call it like this <code>let example = setofalph unwords</code>, you probably wanted <code>let setofalph = createalphs $ words userinput</code> instead of <code>let setofalph = ($ createalphs $ words userinput)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 767, "user_id": 4576720, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/YsT74.jpg?s=128&g=1", "display_name": "Rain Man", "link": "https://stackoverflow.com/users/4576720/rain-man"}, "edited": false, "score": 0, "creation_date": 1428696180, "post_id": 29569647, "comment_id": 47288983, "body": "the problem is that I am getting a string from the user and will pass it to a function. So for example <code>print  $ createalphs $ words userinput</code> will print <code>[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;A&quot;,&quot;B&quot;,&quot;N&quot;]</code>. Now I want to remove the <code>&quot;&quot;[]</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 767, "user_id": 4576720, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/YsT74.jpg?s=128&g=1", "display_name": "Rain Man", "link": "https://stackoverflow.com/users/4576720/rain-man"}, "edited": false, "score": 0, "creation_date": 1428696334, "post_id": 29569647, "comment_id": 47289076, "body": "@RainMan I&#39;ve done exactly that. Just to make it clearer, I added the IO function at the end."}, {"owner": {"reputation": 767, "user_id": 4576720, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/YsT74.jpg?s=128&g=1", "display_name": "Rain Man", "link": "https://stackoverflow.com/users/4576720/rain-man"}, "edited": false, "score": 0, "creation_date": 1428696843, "post_id": 29569647, "comment_id": 47289338, "body": "great, thank you. One quick question, is it possible to have it like <code>let example = ($solution $ createalphs $ words x) putStrLn = &quot;String is&quot; ++ example </code> ? when doing so I get an error"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1428701429, "post_id": 29569647, "comment_id": 47291339, "body": "Why the first <code>$</code>? Do you know what that function does? If not, I recommend that you look at some introductory material (sorry, no link, on phone)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1428703531, "post_id": 29569647, "comment_id": 47292178, "body": "Just a note: <code>concat . intersperse x</code> == <code>intercalate x</code>."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 2, "last_activity_date": 1428696301, "last_edit_date": 1428696301, "creation_date": 1428695532, "answer_id": 29569647, "question_id": 29569393, "link": "https://stackoverflow.com/questions/29569393/string-and-add-special-characters-from-a-list-in-haskell/29569647#29569647", "title": "String and add special characters from a list in Haskell", "body": "<p><code>unwords</code> works fine:</p>\n\n<pre><code>\u03bb&gt; unwords [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"A\",\"B\",\"N\"]\n\"A B C D E F A B N\"\n</code></pre>\n\n<p>Additionally, <code>Data.List.intersperse</code> would help, along with <code>concat</code>.</p>\n\n<pre><code>import Data.List\n\nsolution :: [String] -&gt; String\nsolution =  concat . intersperse \" \"\n</code></pre>\n\n<p>What this does is separate each value in the list with <code>\" \"</code>, then join (concatenate) the lists together.</p>\n\n<p>If you want to separate with <code>\", \"</code>, you can easily change the above function:</p>\n\n<pre><code>solution :: [String] -&gt; String\nsolution =  concat . intersperse \", \"\n</code></pre>\n\n<p>so that:</p>\n\n<pre><code>\u03bb&gt; solution [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"A\",\"B\",\"N\"]\n\"A, B, C, D, E, F, A, B, N\"\n\u03bb&gt; putStrLn $ solution [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"A\",\"B\",\"N\"]\nA, B, C, D, E, F, A, B, N\n</code></pre>\n\n<p>To put this into the context of your IO:</p>\n\n<pre><code>main = do\n  x &lt;- getLine\n  putStrLn $ solution $ createalphs $ words x\n</code></pre>\n"}], "owner": {"reputation": 767, "user_id": 4576720, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/YsT74.jpg?s=128&g=1", "display_name": "Rain Man", "link": "https://stackoverflow.com/users/4576720/rain-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 29569647, "answer_count": 1, "score": 0, "last_activity_date": 1428696301, "creation_date": 1428694468, "last_edit_date": 1428695789, "question_id": 29569393, "link": "https://stackoverflow.com/questions/29569393/string-and-add-special-characters-from-a-list-in-haskell", "title": "String and add special characters from a list in Haskell", "body": "<p>In Haskell I used to use filter to strip set of numbers from a list. However, I have not been able to make it working with this particular case. </p>\n\n<p>I have a list of strings as follow: </p>\n\n<pre><code>[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"A\",\"B\",\"N\"]\n</code></pre>\n\n<p>I want to string the <code>[]</code> and <code>\"\"</code> so the final string is (with spaces): </p>\n\n<pre><code>A B C D E F A B N\n</code></pre>\n\n<p>shouldn't a simple filter like <code>print filter([) [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"A\",\"B\",\"N\"]</code> remove the <code>[</code>? </p>\n\n<p><strong>update:</strong> </p>\n\n<p>I read over <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-List.html\" rel=\"nofollow\">this document</a> and was able to get the following result: </p>\n\n<pre><code>let example = (concat (intersperse \" \" [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"A\",\"B\",\"N\"]))\nprint example\n-- this prints \"A B C D E F A B N\"\n</code></pre>\n\n<p>However, when I use this :</p>\n\n<pre><code>-- where createalphs create a list of strings\n-- and userinput is a string entered by the user \n\nlet setofalph = ($ createalphs $ words userinput)\nlet example = (concat (intersperse \" \" setofalph))\nprint example\n</code></pre>\n\n<p>I get this error </p>\n\n<pre><code>Couldn't match expected type `[[Char]]'\nIn the second argument of `intersperse', namely `setofalph'\nIn the first argument of `concat', namely\n  `(intersperse \" \" setofalph)'\nIn the expression: (concat (intersperse \" \" setofalph))\n</code></pre>\n"}, {"tags": ["haskell", "io-monad", "haskeline"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428692211, "post_id": 29568718, "comment_id": 47286939, "body": "Could you not just generate the settings inside <code>IO</code>, as in <code>addSettings env = do { homeDir &lt;- getHomeDirectory; return $ Settings { historyFile = Just (homeDir ++ &quot;&#47;.zepto_historY&quot;), ... }</code>?  Since you&#39;re new to Haskell I&#39;ll give the typical warning of <b>DON&#39;T USE <code>unsafePerformIO</code>!</b> It&#39;s unsafe (obviously) and can lead to very unexpected behavior.  It&#39;s not part of the Haskell language even, it&#39;s part of the GHC implementation and is useful mainly when interfacing with C libraries or when working with low level features."}, {"owner": {"reputation": 450, "user_id": 2366322, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HTXwQ.jpg?s=128&g=1", "display_name": "hellerve", "link": "https://stackoverflow.com/users/2366322/hellerve"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428692294, "post_id": 29568718, "comment_id": 47286985, "body": "I know that. That&#39;s why it makes me cringe."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428692326, "post_id": 29568718, "comment_id": 47287008, "body": "<b>Never ever perform unsafe IO!</b> Learn about the IO monad: <a href=\"http://learnyouahaskell.com/input-and-output\" rel=\"nofollow noreferrer\">learnyouahaskell.com/input-and-output</a>"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428692350, "post_id": 29568718, "comment_id": 47287025, "body": "Just trying to drive the point home.  There is almost always an alternative, such as the one i suggested above.  Would that approach work for you?"}, {"owner": {"reputation": 450, "user_id": 2366322, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HTXwQ.jpg?s=128&g=1", "display_name": "hellerve", "link": "https://stackoverflow.com/users/2366322/hellerve"}, "edited": false, "score": 1, "creation_date": 1428692662, "post_id": 29568718, "comment_id": 47287178, "body": "I just tried it out. I had to rewrite a few minor things, but it worked. Thanks, such a simple solution; I just had this: &quot;You could have found that out yourself&quot; moment which always comes with good answers. Would you add the answer, so I can accept it?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428706840, "post_id": 29568718, "comment_id": 47293261, "body": "@AJFarmar: I agree, but for the record, this doesn&#39;t mean it&#39;s a good idea to write everything in the <code>IO</code> monad. On the contrary, first consideration should be avoiding IO that isn&#39;t really necessary at all."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 1, "creation_date": 1429580465, "post_id": 29568718, "comment_id": 47654813, "body": "In general unsafe IO is a bad idea, but <code>unsafePerformIO getHomeDirectory</code> is pretty safe (unless your operating system likes to change your home directory while your process is still running)"}, {"owner": {"reputation": 450, "user_id": 2366322, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HTXwQ.jpg?s=128&g=1", "display_name": "hellerve", "link": "https://stackoverflow.com/users/2366322/hellerve"}, "edited": false, "score": 0, "creation_date": 1429601663, "post_id": 29568718, "comment_id": 47662725, "body": "I thought as much, but I wanted to avoid it if possible, because it is bad practice."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1428693037, "creation_date": 1428693037, "answer_id": 29569032, "question_id": 29568718, "link": "https://stackoverflow.com/questions/29568718/unsafe-io-or-haskeline-and-directories/29569032#29569032", "title": "Unsafe IO Or: Haskeline and Directories", "body": "<p>A better approach would be to generate the <code>Settings</code> object inside <code>IO</code>, instead of the other way around, so to speak:</p>\n\n<pre><code>addSettings :: Env -&gt; IO (Settings IO)\naddSettings = do\n    getDir &lt;- fmap (++ \"/.zepto_history\") getHomeDirectory\n    return $ Settings\n        { historyFile = Just getDir\n        , complete = completeWord Nothing \" \\t\" $ return . completionSearch env\n        , autoAddHistory = True\n        }\n</code></pre>\n\n<p>This will no doubt require some changes in your current software, but this would be considered the \"right\" way to go about this.</p>\n"}], "owner": {"reputation": 450, "user_id": 2366322, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HTXwQ.jpg?s=128&g=1", "display_name": "hellerve", "link": "https://stackoverflow.com/users/2366322/hellerve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 29569032, "answer_count": 1, "score": 3, "last_activity_date": 1608165002, "creation_date": 1428691892, "last_edit_date": 1608165002, "question_id": 29568718, "link": "https://stackoverflow.com/questions/29568718/unsafe-io-or-haskeline-and-directories", "title": "Unsafe IO Or: Haskeline and Directories", "body": "<p><strong>DISCLAIMER: I am somewhat new to Haskell.</strong></p>\n<p>I am writing an interpreter, or, in this context, a REPL. For that purpose I am using haskeline, which is nice for REPLs. It has the capability of storing the command line history within a file, which is also nice.</p>\n<p>One problem I came across while working with it, though, is that it does not seem to expand &quot;~&quot; to the home directory, which means that I have to retrieve the home directory manually.</p>\n<p>I could do it like this (and currently do):</p>\n<pre><code>-- | returns a fresh settings variable\naddSettings :: Env -&gt; Settings IO\naddSettings env = Settings { historyFile = Just getDir\n                           , complete = completeWord Nothing &quot; \\t&quot; $\n                                        return . completionSearch env\n                           , autoAddHistory = True\n                           }\n    where\n        getDir :: FilePath\n        getDir = unsafePerformIO getHomeDirectory ++ &quot;/.zepto_history&quot;\n</code></pre>\n<p>But that uses <code>unsafePerformIO</code>, which makes me cringe. Do you know of a good and clean workaround that does not involve rewriting the whole function? This can be a <code>haskeline</code> feature I do not know of or something I just did not see.</p>\n<p>Telling me there is no way around rewriting and rethinking it all is fine, too.</p>\n<p><strong>EDIT:</strong></p>\n<p>I know <code>unsafePerformIO</code> is bad, that's why it makes me cringe. If you are new to Haskell and reading this question right now: Just pretend it is not there.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 1079, "user_id": 2169083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b9a6bc867638193738460746f06a69?s=128&d=identicon&r=PG&f=1", "display_name": "uberwach", "link": "https://stackoverflow.com/users/2169083/uberwach"}, "edited": false, "score": 2, "creation_date": 1428690176, "post_id": 29568199, "comment_id": 47285936, "body": "What do you mean by &quot;proper antifunction&quot;? That composition with both orders result in the identity, i.e. the inverse? Your question is imho very interesting a starting point might be wadler&#39;s theorems for free (<a href=\"http://ttic.uchicago.edu/~dreyer/course/papers/wadler.pdf\" rel=\"nofollow noreferrer\">ttic.uchicago.edu/~dreyer/course/papers/wadler.pdf</a>) that derives rules that polymorphic functions must obey (as an implication of being polymorphic). Maybe these theorems could be in contradiction with the monad laws for specific signatures?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1079, "user_id": 2169083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b9a6bc867638193738460746f06a69?s=128&d=identicon&r=PG&f=1", "display_name": "uberwach", "link": "https://stackoverflow.com/users/2169083/uberwach"}, "edited": false, "score": 0, "creation_date": 1428690266, "post_id": 29568199, "comment_id": 47285986, "body": "@uberwach yes, exactly, inverse/antifunction are often used interchangeably in linear algebra. I&#39;ll make it clearer..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1428690770, "post_id": 29568199, "comment_id": 47286236, "body": "Sometimes the impossibility proof can be derived from logical considerations via Curry-Howard e.g. (shameless plugs) <a href=\"http://stackoverflow.com/questions/27267848/turning-a-mb-into-ma-b/27267992#27267992\" title=\"turning a mb into ma b\">stackoverflow.com/questions/27267848/turning-a-mb-into-ma-b/&zwnj;&#8203;&hellip;</a> and <a href=\"http://stackoverflow.com/questions/24141972/how-to-apply-higher-order-function-to-an-effectful-function-in-haskell/24142893#24142893\" title=\"how to apply higher order function to an effectful function in haskell\">stackoverflow.com/questions/24141972/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1428690966, "post_id": 29568199, "comment_id": 47286324, "body": "More on Curry-Howard: the logic related to monads is called Lax Logic, and is decidable (via e.g. cut-elimination of its sequent calculus). I think that you can only build functions whose type corresponds to a theorem of such logic. So, given a (mono)type you can decide whether it&#39;s a theorem in Lax Logic and know whether you can implement it for any monad."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 2, "creation_date": 1428692283, "post_id": 29568199, "comment_id": 47286982, "body": "You may want to read <a href=\"http://comonad.com/reader/2013/representing-applicatives/\" rel=\"nofollow noreferrer\">&quot;Representing Applicatives&quot;</a>, and Gershom Bazerman&#39;s other posts to the Comonad.Reader blog, which mentions that all representable functors are <i>distributive</i>: <code>distribute :: (Functor f, Representable g) =&gt; f (g a) -&gt; g (f a)</code>"}, {"owner": {"reputation": 378, "user_id": 1472770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8e4587a9f073c0c17d2f5c7a1217d5?s=128&d=identicon&r=PG", "display_name": "alancalvitti", "link": "https://stackoverflow.com/users/1472770/alancalvitti"}, "edited": false, "score": 1, "creation_date": 1564088056, "post_id": 29568199, "comment_id": 100926359, "body": "Beware that antifunction has a different definition, as the morphisms in Set* by Vaughn Pratt."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428692042, "post_id": 29568516, "comment_id": 47286855, "body": "I see what you mean by sequence, but how can I use that to determine, for instance, if a function of type <code>Monad m =&gt; (a -&gt; m b) -&gt; m (a -&gt; b)</code> is possible?"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428692680, "post_id": 29568516, "comment_id": 47287188, "body": "I&#39;m new to Haskell, and i didn&#39;t fully understand the Monads but i think it makes non-sense to can decompose a function and take out the action from it."}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 1, "last_activity_date": 1428691895, "last_edit_date": 1592644375, "creation_date": 1428691119, "answer_id": 29568516, "question_id": 29568199, "link": "https://stackoverflow.com/questions/29568199/monads-determining-if-an-arbitrary-transformation-is-possible/29568516#29568516", "title": "Monads: Determining if an arbitrary transformation is possible", "body": "<p>If you take a look at <a href=\"http://en.wikibooks.org/wiki/Haskell/Understanding_monads\" rel=\"nofollow noreferrer\">&quot;Monad laws&quot;</a>, monad only constrain you to define a composition function but not reverse function.</p>\n<p>In the first example you can compose the list elements.\nIn the second one <code>Monad m =&gt; m [a] -&gt; [m a]</code>, you cannot split an action into multiple actions ( action composition is not reversible).</p>\n<h3>Example:</h3>\n<p>Let's say you have to read 2 values.</p>\n<pre><code>s1 &lt;- action\ns2 &lt;- action\n</code></pre>\n<p>Doing so, action result s2 depends by the side effect made by s1.\nYou can bind these 2 actions in 1 action to be executed in the same order, but you cannot split them and execute action from s2 without s1 made the side effect needed by the second one.</p>\n"}, {"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428694026, "post_id": 29569241, "comment_id": 47287872, "body": "I&#39;m not asking for a specific reason for one example, I&#39;m asking for general rules for working this out, and for Monads specifically, not Applicatives."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428694341, "post_id": 29569241, "comment_id": 47288022, "body": "@AJFarmar: <code>Applicative</code> is a superclass of <code>Monad</code>, so statements about <code>Applicative</code> are certainly relevant to <code>Monad</code>.  And I don&#39;t think the right approach here is that you work this out directly from some general rules: rather, you use <a href=\"http://en.wikipedia.org/wiki/Lemma_%28mathematics%29\" rel=\"nofollow noreferrer\"><i>lemmas</i></a> that follow from general rules. Part of the process of learning to apply general rules is to learn a bunch of lemmas that allow you to recognize specific situations where the rules apply. And there&#39;s no shortcut there\u2014you have to read a lot."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1428694609, "last_edit_date": 1428694609, "creation_date": 1428693822, "answer_id": 29569241, "question_id": 29568199, "link": "https://stackoverflow.com/questions/29568199/monads-determining-if-an-arbitrary-transformation-is-possible/29569241#29569241", "title": "Monads: Determining if an arbitrary transformation is possible", "body": "<p>Not really an answer, and much too informal for my linking, but nevertheless I have a few interesting observations that won't fit into a comment. First, let's consider this function you refer to:</p>\n\n<pre><code>f :: Monad m =&gt; [m a] -&gt; m [a]\n</code></pre>\n\n<p>This signature is in fact stronger than it needs to be.  The current generalization of this is the <code>sequenceA</code> function from <code>Data.Traversable</code>:</p>\n\n<pre><code>sequenceA :: (Traversable t, Applicative f) -&gt; t (f a) -&gt; f (t a)\n</code></pre>\n\n<p>...which doesn't need the full power of <code>Monad</code>, and can work with any <code>Traversable</code> and not just lists.</p>\n\n<p>Second: the fact that <code>Traversable</code> only requires <code>Applicative</code> is I think really significant to this question, because applicative computations have a \"list-like\" structure.  Every applicative computation can be rewritten to have the form <code>f &lt;$&gt; a1 &lt;*&gt; ... &lt;*&gt; an</code> for some <code>f</code>.  Or, informally, every applicative computation can be seen as a list of actions <code>a1, ... an</code> (heterogeneous on the result type, homogeneous in the functor type), plus an n-place function to combine their results.</p>\n\n<p>If we look at <code>sequenceA</code> through this lens, all it does is choose an <code>f</code> built out of the appropriate nested number of list constructors:</p>\n\n<pre><code>sequenceA [a1, ..., an] == f &lt;$&gt; a1 &lt;*&gt; ... &lt;*&gt; an\n    where f v1 ... vn = v1 : ... : vn : []\n</code></pre>\n\n<p>Now, I haven't had the chance to try and prove this yet, but my conjectures would be the following: </p>\n\n<ol>\n<li>Mathematically speaking at least, <code>sequenceA</code> has a <a href=\"http://en.wikipedia.org/wiki/Inverse_function#Left_and_right_inverses\" rel=\"nofollow\"><em>left inverse</em></a> in <a href=\"http://www.paolocapriotti.com/assets/applicative.pdf\" rel=\"nofollow\">free applicative functors</a>.  If you have a <code>Functor f =&gt; [FreeA f a]</code> and you <code>sequenceA</code> it, what you get is a list-like structure that contains those computations and a combining function that makes a list out of their results.  I suspect however that it's not possible to write such a function in Haskell (<code>unSequenceFreeA :: (Traversable t, Functor f) =&gt; FreeA f (t a) -&gt; Maybe (t (Free f a))</code>), because you can't pattern match on the structure of the combining function in the <code>FreeA</code> to tell that it's of the form <code>f v1 ... vn = v1 : ... : vn : []</code>.</li>\n<li><code>sequenceA</code> doesn't have a right inverse in a free applicative, however, because the combining function that produces a list out of the results from the <code>a1, ... an</code> actions may do anything; for example, return a constant list of arbitrary length (unrelated to the computations that the free applicative value performs).</li>\n<li>Once you move to non-free applicative functors, there will no longer be a left inverse for <code>sequenceA</code>, because the non-free applicative functor's equations translate into cases where you can no longer tell apart which of two <code>t (f a)</code> \"action lists\" was the source for a given <code>f (t a)</code> \"list-producing action.\"</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1428705699, "post_id": 29570425, "comment_id": 47292919, "body": "<code>Monad m =&gt; (a -&gt; m b) -&gt; m (a -&gt; b)</code> can be done if you know something about <code>a</code> -- for example that it is finite. The <a href=\"http://hackage.haskell.org/package/universe-1.0/docs/Data-Universe-Instances-Reverse.html#t:Traversable\" rel=\"nofollow noreferrer\">universe</a> package provides <code>sequence :: (Finite a, Ord a, Monad m) =&gt; (a -&gt; m b) -&gt; m (a -&gt; b)</code> (via a <code>Traversable</code> instance for functions)."}, {"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1428707011, "post_id": 29570425, "comment_id": 47293295, "body": "Sure, it can also be done for monads for which you understand the environment, like <code>Reader</code>."}], "tags": [], "owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "is_accepted": true, "score": 5, "last_activity_date": 1428698883, "creation_date": 1428698883, "answer_id": 29570425, "question_id": 29568199, "link": "https://stackoverflow.com/questions/29568199/monads-determining-if-an-arbitrary-transformation-is-possible/29570425#29570425", "title": "Monads: Determining if an arbitrary transformation is possible", "body": "<p>The way that I've always thought about monads is that a value of type <code>Monad m =&gt; m a</code> is some program of type <code>m</code> that executes and produces an <code>a</code>. The <a href=\"https://wiki.haskell.org/Monad_laws\">monad laws</a> reinforce this notion by thinking of composition of these programs as \"do thing one then do thing two\", and produce some sort of combination of the results.</p>\n\n<ul>\n<li><p><strong>Right unit</strong> Taking a program and just returning its value should\nbe the same as just running the original program.</p>\n\n<pre>m >>= return = m</pre></li>\n<li><p><strong>Left unit</strong> If you create a simple program that just returns a value,\nand then pass that value to a function that creates a new program, then\nthe resulting program should just be as if you called the function on the\nvalue.</p>\n\n<pre>return x >>= f = f x</pre></li>\n<li><p><strong>Associativity</strong> If you execute a program <code>m</code>, feed its result into a function <code>f</code> that produces another program, and then feed that result into a third function <code>g</code> that also produces a program, then this is identical to creating a new function that returns a program based on feeding the result of <code>f</code> into <code>g</code>, and feeding the result of <code>m</code> into it.</p>\n\n<pre>(m >>= f) >>= g  =  m >>= (\\x -> f x >>= g)</pre></li>\n</ul>\n\n<p>Using this intuition about a \"program that creates a value\" can come to some conclusions about what it means for the functions that you've provided in your examples.</p>\n\n<ol>\n<li><code>Monad m =&gt; [m a] -&gt; m [a]</code> Deviating from the intuitive definition of what this function should do is hard: Execute each program in sequence and collect the results. This produces another program that produces a list of results.</li>\n<li><code>Monad m =&gt; m [a] -&gt; [m a]</code> This doesn't really have a clear intuitive definition, since it's a program that produces a list. You can't create a list without getting access to the resulting values which in this case means executing a program. Certain monads, that have a clear way to extract a value from a program, and provide some variant of <code>m a -&gt; a</code>, like the <code>State</code> monad, can have sane implementations of some function like this. It would have to be application specific though. Other monads, like <code>IO</code>, you cannot escape from.</li>\n<li><code>Monad m =&gt; (a -&gt; m b) -&gt; m (a -&gt; b)</code> This also doesn't really have a clear intuitive definition. Here you have a function <code>f</code> that produces a program of type <code>m b</code>, but you're trying to return a function of type <code>m (a -&gt; b)</code>. Based on the <code>a</code>, <code>f</code> creates completely different programs with different executing semantics. You cannot encompass these variations in a single program of type <code>m (a -&gt; b)</code>, even if you can provide a proper mapping of <code>a -&gt; b</code> in the programs resulting value.</li>\n</ol>\n\n<p>This intuition doesn't really encompass the idea behind monads completely. For example, the monadic context of a list doesn't really behave like a program.</p>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 2, "last_activity_date": 1428773843, "creation_date": 1428773843, "answer_id": 29580944, "question_id": 29568199, "link": "https://stackoverflow.com/questions/29568199/monads-determining-if-an-arbitrary-transformation-is-possible/29580944#29580944", "title": "Monads: Determining if an arbitrary transformation is possible", "body": "<p>Something easy to remember is : \"you can't escape from a Monad\" (it's kind of design for it). Transforming <code>m [a]</code> to <code>[m a]</code> is a form of escape, so you can't.</p>\n\n<p>On the other hand you can easily create a Monad from something (using <code>return</code>) so <em>traversing</em> (<code>[m a] -&gt; m [a]</code>) is usually possible.</p>\n"}], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 3, "accepted_answer_id": 29570425, "answer_count": 4, "score": 9, "last_activity_date": 1428773843, "creation_date": 1428689861, "last_edit_date": 1495542109, "question_id": 29568199, "link": "https://stackoverflow.com/questions/29568199/monads-determining-if-an-arbitrary-transformation-is-possible", "title": "Monads: Determining if an arbitrary transformation is possible", "body": "<p>There are <a href=\"https://stackoverflow.com/questions/18890408/a-io-b-to-io-a-b\">quite</a> a <a href=\"https://stackoverflow.com/questions/27342863/unsequence-monad-function-within-haskell\">few</a> of questions here about whether or not certain transformations of types that involve Monads are possible.</p>\n\n<p>For instance, it's possible to make a function of type <code>f :: Monad m =&gt; [m a] -&gt; m [a]</code>, but impossible to make a function of type <code>g :: Monad m =&gt; m [a] -&gt; [m a]</code> as a proper antifunction to the former. (IE: <code>f . g = id</code>)</p>\n\n<p>I want to understand what rules one can use to determine if a function of that type can or cannot be constructed, and why these types cannot be constructed if they disobey these rules.</p>\n"}, {"tags": ["haskell", "syntax", "monads"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1428687600, "post_id": 29567447, "comment_id": 47284500, "body": "The <code>do</code> notation is a syntactic sugar when dealing with monads. As your function has nothing to do with them (well, explicitly), the <code>do</code> notation is loosing it&#39;s sense here.."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 0, "creation_date": 1428688666, "post_id": 29567447, "comment_id": 47285124, "body": "Without <code>do</code> it&#39;s simply <code>intersperse 42 [1..6] ++ [42]</code>. Assuming you care about that last 42."}], "answers": [{"tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": false, "score": 1, "last_activity_date": 1428688409, "last_edit_date": 1428688409, "creation_date": 1428688058, "answer_id": 29567668, "question_id": 29567447, "link": "https://stackoverflow.com/questions/29567447/return-some-values-in-do-notation-haskell/29567668#29567668", "title": "Return some values in Do-notation - Haskell", "body": "<p>You want to work with the monad List, <code>return</code> in the monad list means something like \"add the value to the monad context\" or in code</p>\n\n<pre><code>do x &lt;- xs\n   return x\n</code></pre>\n\n<p>is equal to </p>\n\n<pre><code>do x &lt;- xs\n   [x]\n</code></pre>\n\n<p>Therefore you transform function should be something like</p>\n\n<pre><code>tranform :: a -&gt; [a] -&gt; [a]\ntranform new_number xs = do x &lt;- xs\n                            x: [new_number]\n</code></pre>\n\n<p>This is equivalent to</p>\n\n<pre><code>tranform new_number xs = concatMap (:[new_number]) xs\n</code></pre>\n\n<p>The do notation is desugar to </p>\n\n<pre><code>xs &gt;&gt;= \\x -&gt; x:[new_number]\n</code></pre>\n\n<p>and the binding operator for the monad list is related to concatMap</p>\n\n<pre><code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]\n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>where in this case <code>m a</code> is the monad list <code>[] a</code></p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 5, "last_activity_date": 1428688127, "creation_date": 1428688127, "answer_id": 29567694, "question_id": 29567447, "link": "https://stackoverflow.com/questions/29567447/return-some-values-in-do-notation-haskell/29567694#29567694", "title": "Return some values in Do-notation - Haskell", "body": "<p><code>return</code> doesn't work in the same way in Haskell as in imperative languages. Writing two <code>return</code>s is pointless here, because the second 'overwrites' the first.</p>\n\n<p><code>do</code>-notation is specifically for dealing with <em>Monads</em>, so you have a correct type, but you're using the functions incorrectly. This is how I'd do this:</p>\n\n<pre><code>transform :: a -&gt; [a] -&gt; [a]\ntransform new xs = do\n  x &lt;- xs\n  [x,new]\n</code></pre>\n\n<p>The reason why this is valid is that I'm ending my expression with something of type <code>[a]</code>. You don't necessarily have to use <code>return</code>!</p>\n\n<p>Using <code>do</code>-notation here is a little confusing, so it may be better to use <code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code>:</p>\n\n<pre><code>transform new xs = concatMap (\\x -&gt; [x,new]) xs\n</code></pre>\n"}], "owner": {"reputation": 3366, "user_id": 1756750, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/db2912f03e4de7e109367b40f874fea6?s=128&d=identicon&r=PG", "display_name": "Denis", "link": "https://stackoverflow.com/users/1756750/denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 29567694, "answer_count": 2, "score": 0, "last_activity_date": 1428690736, "creation_date": 1428687283, "last_edit_date": 1428690736, "question_id": 29567447, "link": "https://stackoverflow.com/questions/29567447/return-some-values-in-do-notation-haskell", "title": "Return some values in Do-notation - Haskell", "body": "<p>I've learnt about <code>do-notation</code>. I now want to develop a function, which transforms a list.</p>\n\n<p>I want it to behave like this:</p>\n\n<pre><code>\u03bb&gt; transform 42 [1, 2, 3, 4, 5, 6]\n[1, 42, 2, 42, 3, 42, 4, 42, 5, 42, 6, 42]\n</code></pre>\n\n<p>My current code is:</p>\n\n<pre><code>transform :: a -&gt; [a] -&gt; [a]\ntransform new_number xs = do x &lt;- xs\n                            return x\n                            return new_number\n</code></pre>\n\n<p>...and my result is:</p>\n\n<pre><code>\u03bb&gt; transform 42 [1, 2, 3]\n[42,42,42]\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1428681643, "post_id": 29565770, "comment_id": 47281266, "body": "As for \u201csolving the problem with spaces and tabs\u201d \u2013 just use <i>always exclusively</i> spaces in Haskell, then there&#39;ll be no problem. Except if the problem is actually something else but indentation: like bheklilr said, it&#39;s in fact about the incomplete <code>if</code> <code>then</code> <code>else</code>."}, {"owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428681690, "post_id": 29565770, "comment_id": 47281296, "body": "@leftaroundabout, yep, I always use spaces. My IDE do it."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428688334, "post_id": 29565770, "comment_id": 47284931, "body": "<code>If</code> and <code>then</code> are <i>always</i> followed by an <code>else</code>. Haskell is <i>not</i> imperative!"}], "answers": [{"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "edited": false, "score": 3, "creation_date": 1428681800, "post_id": 29565826, "comment_id": 47281353, "body": "@David If you&#39;re coming from another language like Java or Python then yes, it isn&#39;t very intuitive, but you would still have an error in Java if you had <code>int func(int x) { if (x == 1) { return 2; } }</code>, since not all code paths return an <code>int</code> (I think my syntax is correct, I haven&#39;t written Java code in several years).  In Haskell it just doesn&#39;t parse without the <code>else</code> instead of throwing what amounts to a type error."}, {"owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "edited": false, "score": 0, "creation_date": 1428681943, "post_id": 29565826, "comment_id": 47281417, "body": "yeah, this code will not compile in <code>Java</code>. But message will give you more sense. Also, IDEA (best Java IDE) tell you about error with help static analyzer."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1428681474, "creation_date": 1428681474, "answer_id": 29565826, "question_id": 29565770, "link": "https://stackoverflow.com/questions/29565770/parse-error-possibly-incorrect-indentation-or-mismatched-brackets-haskell/29565826#29565826", "title": "Parse error (possibly incorrect indentation or mismatched brackets) - Haskell", "body": "<p>You need an <code>else</code> on your <code>if-then</code>.  All <code>if</code>s in Haskell must have <code>then</code> and <code>else</code>, otherwise the expression wouldn't always return a value.  In Haskell, all expression must return a value, so an <code>if-then</code> without an <code>else</code> isn't an expression, hence the parse error.  You need to decide what to do if <code>fst y /= x</code>:</p>\n\n<pre><code>lookups x ys = do y &lt;- ys\n                  if fst y == x\n                    then return (snd y)\n                    else ???\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 29565826, "answer_count": 1, "score": 1, "last_activity_date": 1428681474, "creation_date": 1428681295, "question_id": 29565770, "link": "https://stackoverflow.com/questions/29565770/parse-error-possibly-incorrect-indentation-or-mismatched-brackets-haskell", "title": "Parse error (possibly incorrect indentation or mismatched brackets) - Haskell", "body": "<p>It's silly, but I can not even solve the problem with spaces and tabs. Sometimes I think that the problem is not in me, but in Haskell. Why Python does not have the same problem?</p>\n\n<p>My code is:</p>\n\n<pre><code>lookups :: (Eq a) =&gt; a -&gt; [(a,b)] -&gt; [b]\nlookups x ys = do y &lt;- ys\n                  if fst y == x then return (snd y)\n</code></pre>\n\n<p>I have a error: <code>parse error (possibly incorrect indentation or mismatched brackets)</code>. My code use only spaces.</p>\n"}, {"tags": ["haskell", "command-line-arguments", "cabal"], "comments": [{"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1428688396, "post_id": 29565514, "comment_id": 47284961, "body": "Have you tried using cabal flags to conditionally include a separate module based on the flag? I&#39;m not sure if this works with <code>cabal run</code>"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1428680494, "creation_date": 1428680494, "question_id": 29565514, "link": "https://stackoverflow.com/questions/29565514/specify-command-line-options-to-execute-in-cabal-file", "title": "Specify command line options to execute in Cabal file?", "body": "<p>I have a Haskell test program in a Cabal sandbox. I'd like to be able to do <code>cabal run</code> and have it provide command line arguments automatically when running the program. Can I specify these arguments in the <code>proj.cabal</code> file?</p>\n\n<p>I see <code>--prog-options</code> as an option to <code>cabal</code> but no configuration file options, it seems?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428678599, "post_id": 29564868, "comment_id": 47279380, "body": "Can you provide the types for <code>getResponseBody</code>, <code>simpleHTTP</code>, and <code>getRequest</code>?  Or at least the module(s) they come from?"}, {"owner": {"reputation": 1278, "user_id": 1543835, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/51391702d5e1ab09b91928028ae4d52c?s=128&d=identicon&r=PG", "display_name": "Roman Liutikov", "link": "https://stackoverflow.com/users/1543835/roman-liutikov"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428678667, "post_id": 29564868, "comment_id": 47279422, "body": "They comes from Network.HTTP"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428679061, "post_id": 29564868, "comment_id": 47279686, "body": "What&#39;s wrong with the bind? <code>=&lt;&lt;</code> <i>is</i>, in a sense, composition for monadic functions (aka Kleisli arrows). More precisely, <code>&lt;=&lt;</code> is the Kleisli composition operator: <code>get = getResponseBody &lt;=&lt; simpleHTTP . getRequest</code>."}, {"owner": {"reputation": 1278, "user_id": 1543835, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/51391702d5e1ab09b91928028ae4d52c?s=128&d=identicon&r=PG", "display_name": "Roman Liutikov", "link": "https://stackoverflow.com/users/1543835/roman-liutikov"}, "edited": false, "score": 0, "creation_date": 1428680463, "post_id": 29564868, "comment_id": 47280545, "body": "Nothing wrong, I&#39;m just wondering how to do it differently and what option is right. What s the difference between bind and compose then?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428687742, "post_id": 29564868, "comment_id": 47284579, "body": "Composition is between two functions (of compatible types). Application is between a function of type <code>a-&gt;b</code> and an argument of type <code>a</code>. Bind is similar to application in that it &quot;applies&quot; a function of type <code>a -&gt; m b</code> to an argument of type <code>m a</code>, where <code>m</code> is a monad. Note that regular application would complain that the function expects an <code>a</code>, not an <code>m a</code>. Further, application is a fixed operation, while every monad <code>m</code> has its own bind operation."}], "answers": [{"comments": [{"owner": {"reputation": 1278, "user_id": 1543835, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/51391702d5e1ab09b91928028ae4d52c?s=128&d=identicon&r=PG", "display_name": "Roman Liutikov", "link": "https://stackoverflow.com/users/1543835/roman-liutikov"}, "edited": false, "score": 0, "creation_date": 1428755793, "post_id": 29565478, "comment_id": 47304169, "body": "Thanks! So <code>&gt;&gt;=</code> is a compose operator for monadic functions. Are there any good examples of creating monads? From what I&#39;ve seen: a monad describes a set of rules a type should follow. And it seems to me that Monad is more like a design pattern."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1428680409, "creation_date": 1428680409, "answer_id": 29565478, "question_id": 29564868, "link": "https://stackoverflow.com/questions/29564868/function-composition-and-type-annotations-in-haskell/29565478#29565478", "title": "Function composition and type annotations in Haskell", "body": "<p>If we look at the types:</p>\n\n<pre><code>getRequest :: String -&gt; Request_String\nsimpleHTTP :: Request ty -&gt; IO (Result (Response ty))\ngetResponseBody :: Result (Response ty) -&gt; IO ty\ntype Request_String = Request String\n</code></pre>\n\n<p>So for the purposes of this question we can specialize the types to</p>\n\n<pre><code>simpleHTTP :: Request_String -&gt; IO (Result (Response String))\ngetResponseBody :: Result (Response String) -&gt; IO String\n</code></pre>\n\n<p>It's pretty clear to see that we can just do</p>\n\n<pre><code>simpleHTTP (getRequest url) :: IO (Result (Response String))\n</code></pre>\n\n<p>However, in order to compose this with <code>getResponseBody</code> we are required to use monadic combinators.  There are all sorts of math-y reasons for this, but for simplicity's sake just think of it as function composition not being powerful enough to compose actions together, only functions.  To compose actions, monads were introduced and they come with their own composition operators instead.  Compare the types of these two composition operators:</p>\n\n<pre><code>(.)   ::            (b -&gt;   c) -&gt; (a -&gt;   b) -&gt; (a -&gt;   c)\n(&lt;=&lt;) :: Monad m =&gt; (b -&gt; m c) -&gt; (a -&gt; m b) -&gt; (a -&gt; m c)  -- Imported from Control.Monad\n</code></pre>\n\n<p>They're very similar, aren't they?  The only difference is the addition of the <code>m</code> with the <code>Monad</code> constraint.  This is <strong>the</strong> composition operator for monads, it is more restrictive and powerful than the normal <code>.</code> operator, which means it can do more, such as sequencing and executing IO actions, but it also means that it works with fewer types.  It can be used as</p>\n\n<pre><code>get = simpleHTTP &lt;=&lt; simpleHTTP . getRequest\n</code></pre>\n\n<p>However, there is a more generalized version of composition defined in <code>Control.Category</code> that can handle both:</p>\n\n<pre><code>import Prelude hiding ((.), id)  -- Hide the less general versions in Prelude\nimport Control.Category\nimport Control.Arrow\n\nget = runKleisli (Kleisli getResponseBody . Kleisli simpleHTTP) . getRequest\n</code></pre>\n\n<p>But this requires that you wrap your monadic functions in the <code>Kleisli</code> newtype wrapper and unwrap it with <code>runKleisli</code>.  You can also skip <code>Control.Category</code> and just use <code>Control.Arrow</code>:</p>\n\n<pre><code>get = runKleisli (Kleisli getResponseBody &lt;&lt;&lt; Kleisli simpleHTTP) &lt;&lt;&lt; getRequest\n</code></pre>\n\n<p>You can even swap this around to be</p>\n\n<pre><code>get = getRequest &gt;&gt;&gt; runKleisli (Kleisli simpleHTTP &gt;&gt;&gt; Kleisli getResponseBody)\n</code></pre>\n\n<p>if you want it to read left-to-right instead of right-to-left.</p>\n\n<p>In the end, there are several ways to write equivalent code, but the most familiar and readable to most people, if you are adamant on pointfree style (it isn't necessary to be idiomatic), would be to use the usual <code>.</code> and <code>&lt;=&lt;</code> since it is the shortest implementation and uses more recognizable operators.  <code>Control.Category</code> and <code>Control.Arrow</code> are very useful when building something custom, but for the built-in types there are usually already operators defined that make more sense.</p>\n"}], "owner": {"reputation": 1278, "user_id": 1543835, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/51391702d5e1ab09b91928028ae4d52c?s=128&d=identicon&r=PG", "display_name": "Roman Liutikov", "link": "https://stackoverflow.com/users/1543835/roman-liutikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 29565478, "answer_count": 1, "score": 1, "last_activity_date": 1428680409, "creation_date": 1428678542, "last_edit_date": 1428678793, "question_id": 29564868, "link": "https://stackoverflow.com/questions/29564868/function-composition-and-type-annotations-in-haskell", "title": "Function composition and type annotations in Haskell", "body": "<p>Total noob here. I've seen an example of doing HTTP Get request using <code>do</code> block, but I want to do it via composition.</p>\n\n<p>Like this:</p>\n\n<pre><code>get url = getResponseBody . simpleHTTP $ getRequest url\n</code></pre>\n\n<p>Is it proper? And what is the right type annotation for this function?</p>\n\n<p>This one is ok:</p>\n\n<pre><code>get :: String -&gt; IO String\nget url = getResponseBody =&lt;&lt; simpleHTTP (getRequest url)\n</code></pre>\n\n<p>But I want to compose and not to bind. What it a better/right way?</p>\n"}, {"tags": ["regex", "haskell", "scope", "ghc"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1428691109, "post_id": 29564507, "comment_id": 47286388, "body": "Notice <code>Text.Regex</code> is not a package.  It is a module in the regex-compat package."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1431181728, "post_id": 29564507, "comment_id": 48390890, "body": "Please don&#39;t be so ridiculous with your edits. It seems this question was mostly downvoted because of an unnecessary edit chain; just leave it now, will you?"}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 0, "creation_date": 1429193654, "post_id": 29567267, "comment_id": 47492265, "body": "I&#39;m using ghci but I still run into erro. help! I tried doing that &amp; compile it also run into errorrrr"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 3, "creation_date": 1429200001, "post_id": 29567267, "comment_id": 47497357, "body": "@Help-Ineedsomebody&#39;shelp We cannot help you if you don&#39;t tell us the errror."}, {"owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1429839049, "post_id": 29567267, "comment_id": 47801023, "body": "@Eric GOT THIS EROORORORO: failed during the building phase. The exception was: ExitFailure 1"}, {"owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 0, "creation_date": 1429839262, "post_id": 29567267, "comment_id": 47801078, "body": "in my log it says dist/package.conf.inplace: inappropriate type"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 5, "last_activity_date": 1428687046, "last_edit_date": 1428687046, "creation_date": 1428686645, "answer_id": 29567267, "question_id": 29564507, "link": "https://stackoverflow.com/questions/29564507/what-is-this-error-failed-during-the-building-phase/29567267#29567267", "title": "What is this error? - FAILED DURING THE BUILDING PHASE", "body": "<p>You shouldn't import <code>Text.Regex.Posix</code>, but rather <strong>just <code>Text.Regex</code></strong>, because the two functions you want are there.</p>\n\n<p>Have a look at <a href=\"https://hackage.haskell.org/package/regex-compat-0.92/docs/Text-Regex.html\">the Hackage page</a> - you were almost there, but the functions where actually in that file.</p>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 0, "creation_date": 1429839033, "post_id": 29687291, "comment_id": 47801015, "body": "i got this error while building: failed during the building phase. The exception was: ExitFailure 1"}, {"owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 0, "creation_date": 1429839256, "post_id": 29687291, "comment_id": 47801075, "body": "in my log it says: dist/package.conf.inplace: inappropriate type"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 0, "creation_date": 1429860360, "post_id": 29687291, "comment_id": 47808551, "body": "Let me first mention that by logging another ticket (<a href=\"http://stackoverflow.com/questions/29837198/macosx-cabal-install-built-failed-during-the-building-phase-the-exception-wa\" title=\"macosx cabal install built failed during the building phase the exception wa\">stackoverflow.com/questions/29837198/&hellip;</a>) you admit it is already a separate question. Now, there is <a href=\"http://dev.stephendiehl.com/hask/\" rel=\"nofollow noreferrer\">dev.stephendiehl.com/hask</a> with nice cabal installation info. Then, at <a href=\"http://ircbrowse.net/browse/haskell?events_page=4&amp;q=Dist\" rel=\"nofollow noreferrer\">ircbrowse.net/browse/haskell?events_page=4&amp;q=Dist</a>, you can check for several possible solutions: 1) remove /dist folder using  <code>rm -rf dist</code> and then <code>cabal install</code>, 2) get the latest build from <a href=\"https://www.haskell.org/ghc/\" rel=\"nofollow noreferrer\">haskell.org/ghc</a> (GHC 7.10.1 works with cabal-install version 1.22+)."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "edited": false, "score": 0, "creation_date": 1439965508, "post_id": 29687291, "comment_id": 52071349, "body": "I see you included the code that worked for you in the question. Basically, it is the same code as mine, as you are using <code>subRegex</code> from <code>Text.Regex</code> module."}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 9, "last_activity_date": 1429224597, "creation_date": 1429224597, "answer_id": 29687291, "question_id": 29564507, "link": "https://stackoverflow.com/questions/29564507/what-is-this-error-failed-during-the-building-phase/29687291#29687291", "title": "What is this error? - FAILED DURING THE BUILDING PHASE", "body": "<p>Here are some steps you can perform to make it working.</p>\n\n<ol>\n<li>Download from <a href=\"http://hackage.haskell.org/package/regex-compat-0.92\" rel=\"noreferrer\">http://hackage.haskell.org/package/regex-compat-0.92</a>, unzip to <strong>&lt;Haskell Platform INSTALL FOLDER&gt;</strong>\\2014.2.0.0\\lib\\</li>\n<li>Run Haskell.</li>\n<li>Type <code>:mod +Text.Regex</code> to load the package.</li>\n<li>Type, e.g. <code>subRegex (mkRegex \"[0-9]+\") \"foobar567\" \"123\"</code></li>\n<li>Result is <code>\"foobar123\"</code> (after all packages are loaded).</li>\n</ol>\n\n<p>Here is the <a href=\"http://hackage.haskell.org/package/regex-compat-0.92/docs/Text-Regex.html\" rel=\"noreferrer\"><strong>subRegex</strong> description</a>:</p>\n\n<blockquote>\n  <p><code>:: Regex     Search pattern</code>\n  <br><code>-&gt; String    Input string</code>\n  <br><code>-&gt; String    Replacement text</code>\n  <br><code>-&gt; String    Output string</code></p>\n  \n  <p>Replaces every occurance of the given regexp with the replacement\n  string.</p>\n  \n  <p>In the replacement string, \"\\1\" refers to the first substring; \"\\2\" to\n  the second, etc; and \"\\0\" to the entire match. \"\\\\\" will insert a\n  literal backslash.</p>\n  \n  <p>This does not advance if the regex matches an empty string. This\n  misfeature is here to match the behavior of the the original\n  Text.Regex API.</p>\n</blockquote>\n\n<p>Some cool links that can help you delve deeper:<br>\n<a href=\"http://www.serpentine.com/blog/2007/02/27/a-haskell-regular-expression-tutorial/\" rel=\"noreferrer\">http://www.serpentine.com/blog/2007/02/27/a-haskell-regular-expression-tutorial/</a>, and <br>\n<a href=\"https://wiki.haskell.org/Cookbook/Pattern_matching\" rel=\"noreferrer\">https://wiki.haskell.org/Cookbook/Pattern_matching</a>.</p>\n\n<p>I am using it in Windows, here is my screen:</p>\n\n<p><img src=\"https://i.stack.imgur.com/QZCf9.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 1, "answer_count": 2, "score": -24, "last_activity_date": 1441944549, "creation_date": 1428677468, "last_edit_date": 1441944549, "question_id": 29564507, "link": "https://stackoverflow.com/questions/29564507/what-is-this-error-failed-during-the-building-phase", "title": "What is this error? - FAILED DURING THE BUILDING PHASE", "body": "<p>I got this error while building:</p>\n\n<pre><code>dist/package.conf.inplace:\ninappropriate type\n\nFAILED DURING THE BUILDING PHASE. The **exception** was: ExitFailure 1\n</code></pre>\n\n<p>How do I use <code>subRegex</code> <strong>in package</strong> Text.Regex?</p>\n\n<p>I have written:</p>\n\n<pre><code>import Text.Regex.Posix\n</code></pre>\n\n<p>But I got this error:</p>\n\n<pre><code>_.hs:13:5: Not in scope: \u2018subRegex\u2019\n\n_.hs:13:15:\n    Not in scope: \u2018mkRegex\u2019\n    Perhaps you meant \u2018makeRegex\u2019 (imported from Text.Regex.Posix)\n</code></pre>\n\n<p>So, I went to <code>Text.Regex</code>'s [page][1], and there it said:</p>\n\n<blockquote>\n  <p>Uses the POSIX regular expression interface in <code>Text.Regex.Posix</code>.</p>\n</blockquote>\n\n<p><em>So why not aren't these functions in-scope?</em></p>\n"}, {"tags": ["haskell", "ghc", "constraint-kinds"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1428733691, "post_id": 29564375, "comment_id": 47298410, "body": "<code>GHC.Prim</code> is purely fictitious anyway. Based on comments in <code>GHC.Base</code>, it seems its interface was once defined in <code>GHC.Prim.hi-boot</code>, but that file doesn&#39;t seem to exist anywhere any more."}, {"owner": {"reputation": 177, "user_id": 4483452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058d2fbe4001171d5b2b81ccd80c9ffd?s=128&d=identicon&r=PG&f=1", "display_name": "gspindles", "link": "https://stackoverflow.com/users/4483452/gspindles"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428935632, "post_id": 29564375, "comment_id": 47361447, "body": "I found an <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/src/GHC-Prim.html\" rel=\"nofollow noreferrer\">older version</a> of it. But like you said, this is not the case anymore in current HEAD."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428936582, "post_id": 29564375, "comment_id": 47362208, "body": "That &quot;older version&quot; you found is actually recent, and just as fake. As the comments indicate, it is only used by Haddock, and never actually compiled."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1428688711, "post_id": 29565319, "comment_id": 47285152, "body": "We actually discovered a subtle difference the other day, which is perhaps a bug: If you try to <i>reexport</i> with <code>module ... (module GHC.Exts)</code> or <code>(module GHC.Prim)</code>, the <code>Constra&#236;nt</code> kind will be mysteriously excluded. You have to name it explicitly in export lists, as <code>GHC.Exts</code> does itself. (BTW you can actually <code>:i (GHC.Prim.*)</code>, although it seems impossible to actually <i>use</i> <code>*</code> that way.)"}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 7, "last_activity_date": 1428679955, "creation_date": 1428679955, "answer_id": 29565319, "question_id": 29564375, "link": "https://stackoverflow.com/questions/29564375/where-is-the-constraint-kind-defined/29565319#29565319", "title": "Where is the Constraint kind defined?", "body": "<p>To my knowledge, there is no definition of <code>Constraint</code> in any Haskell source file. It's a built-in, wired-in name that is defined to belong within <code>GHC.Prim</code> in the GHC sources itself. So in particular <code>Constraint</code> is not a promoted datatype, there's no corresponding datatype of kind <code>*</code> that is called <code>Constraint</code>.</p>\n\n<p>There are other kinds in GHC that are treated similarly, such as <code>AnyK</code>, <code>OpenKind</code> or even <code>BOX</code> itself.</p>\n\n<p>GHC doesn't really make a big difference internally between datatypes and kinds and anything above. That's why they e.g. all show up as being defined using <code>data</code> albeit with different target kinds.</p>\n\n<p>Note that as far as GHC is concerned, we also have</p>\n\n<pre><code>data BOX :: BOX\n</code></pre>\n\n<p>It's impossible for a user to directly define new \"kinds\" of super-kind <code>BOX</code>, though.</p>\n\n<p>As far as I know, importing / exporting also makes no difference between the type and kind namespaces. So e.g.</p>\n\n<pre><code>import GHC.Exts (OpenKind, BOX, Constraint)\n</code></pre>\n\n<p>is legal. In fact, if you then say</p>\n\n<pre><code>x :: Constraint\nx = undefined\n</code></pre>\n\n<p>you don't get a scope error, but a kind error, saying that a type of kind <code>*</code> is expected, but a type/kind of kind <code>BOX</code> is provided.</p>\n\n<p>I should perhaps also say that the whole story about kinds is somewhat in flux, and there are proposals being discussed that change this a bit: see e.g. <a href=\"https://ghc.haskell.org/trac/ghc/wiki/NoSubKinds\">https://ghc.haskell.org/trac/ghc/wiki/NoSubKinds</a> for related discussion.</p>\n"}], "owner": {"reputation": 177, "user_id": 4483452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058d2fbe4001171d5b2b81ccd80c9ffd?s=128&d=identicon&r=PG&f=1", "display_name": "gspindles", "link": "https://stackoverflow.com/users/4483452/gspindles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 29565319, "answer_count": 1, "score": 4, "last_activity_date": 1428679955, "creation_date": 1428677139, "question_id": 29564375, "link": "https://stackoverflow.com/questions/29564375/where-is-the-constraint-kind-defined", "title": "Where is the Constraint kind defined?", "body": "<p>I'm not familiar with GHC internals but I have a couple questions about ConstraintKinds.</p>\n\n<p>It says from <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/GHC-Exts.html\" rel=\"nofollow\"><code>GHC.Exts</code></a> that</p>\n\n<pre><code>data Constraint :: BOX\n</code></pre>\n\n<p>which is misleading because <code>Constraint</code> is a kind of sort <code>BOX</code>.  This brings us to the first question: we can import and export kinds?  How does that work?</p>\n\n<p>Please correct me on this next part if I'm totally off. From trying out different imports and glancing around at the source on hackage, my guess is that <code>GHC.Exts</code> imports <code>Constraint</code> from <code>GHC.Base</code>, who in turn, imports it from <code>GHC.Prim</code>. But I do not see where it is defined in <a href=\"http://git.haskell.org/packages/ghc-prim.git\" rel=\"nofollow\"><code>GHC.Prim</code></a>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1428673713, "post_id": 29563020, "comment_id": 47275882, "body": "Try running <code>cabal install regex-posix</code>.  The output from <code>ghc-pkg</code> you&#39;re seeing is just the listings of what package databases GHC is currently seeing, unless you see an actual package name listed under one of those then you don&#39;t have that module available."}, {"owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428674002, "post_id": 29563020, "comment_id": 47276120, "body": "@bheklilr cool story bro. #ProblemSolved. +1."}], "answers": [{"comments": [{"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 4, "creation_date": 1482318778, "post_id": 29563505, "comment_id": 69723320, "body": "If you&#39;re on Stack, you can do <code>stack ghci --package regex-posix</code> followed by <code>:m +Text.Regex.Posix</code>."}, {"owner": {"reputation": 7590, "user_id": 563329, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/91bc2613b6a42cff816cd000b3a05fbd?s=128&d=identicon&r=PG", "display_name": "isomorphismes", "link": "https://stackoverflow.com/users/563329/isomorphismes"}, "edited": false, "score": 1, "creation_date": 1504812272, "post_id": 29563505, "comment_id": 79170209, "body": "I successfully installed <code>regex-posix-0.95-2</code>, it\u2019s in <code>~&#47;.cabal&#47;packages&#47;hackage.haskell.org</code>, restarted, <code>ghci</code>, and I still get the error above."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1508317197, "post_id": 29563505, "comment_id": 80559720, "body": "Also, if anyone wonders why these commands do not work for them, see <a href=\"https://stackoverflow.com/questions/9665843/installing-haskell-gloss\">a related thread</a>."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 21, "last_activity_date": 1430350928, "last_edit_date": 1430350928, "creation_date": 1428674618, "answer_id": 29563505, "question_id": 29563020, "link": "https://stackoverflow.com/questions/29563020/could-not-find-module-text-regex-posix/29563505#29563505", "title": "Could not find module \u2018Text.Regex.Posix\u2019", "body": "<p>The problem is that you simply don't have the <code>regex-posix</code> package installed.  This is the package that exports the <code>Text.Regex.Posix</code> module.  <code>Text.Read</code> is exported by the <code>base</code> package which comes with every Haskell distribution.</p>\n\n<p>You can see this by running <code>ghc-pkg find-module Text.Read</code>.  To install the <code>regex-posix</code> package globally run the command <code>cabal install regex-posix</code>.  If you don't want to install it globally or run into problems getting it to install, it would be better to try installing it with the same command in a sandbox after running <code>cabal sandbox init</code> in the directory of your choice.</p>\n"}], "owner": {"reputation": 1040, "user_id": 2024727, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UHZjr.jpg?s=128&g=1", "display_name": "Help - I need somebody&#39;s help", "link": "https://stackoverflow.com/users/2024727/help-i-need-somebodys-help"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3780, "favorite_count": 1, "accepted_answer_id": 29563505, "answer_count": 1, "score": 15, "last_activity_date": 1430350928, "creation_date": 1428673339, "last_edit_date": 1430350896, "question_id": 29563020, "link": "https://stackoverflow.com/questions/29563020/could-not-find-module-text-regex-posix", "title": "Could not find module \u2018Text.Regex.Posix\u2019", "body": "<p>I want to try doing regexes in GHCi. I tried loading the module</p>\n\n<pre><code> :mod +Text.Regex.Posix\n</code></pre>\n\n<p>But got this error instead</p>\n\n<pre><code>&lt;no location info&gt;:\n    Could not find module \u2018Text.Regex.Posix\u2019\n    It is not a module in the current program, or in any known package.\n</code></pre>\n\n<p>But I should have Text installed</p>\n\n<p><code>ghc-pkg find-module Text.Regex.Posix</code> would give me</p>\n\n<pre><code>/usr/local/Cellar/ghc/7.8.4/lib/ghc-7.8.4/package.conf.d\n/Users/a/.ghc/x86_64-darwin-7.8.4/package.conf.d\n</code></pre>\n\n<p>What do I do?</p>\n\n<p>I have no problem with this though:</p>\n\n<pre><code>import Text.Read\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["haskell", "zsh"], "answers": [{"comments": [{"owner": {"reputation": 4377, "user_id": 1154018, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b815b5d6f9f344aad0c020e6782fb919?s=128&d=identicon&r=PG", "display_name": "jimcgh", "link": "https://stackoverflow.com/users/1154018/jimcgh"}, "edited": false, "score": 0, "creation_date": 1428652919, "post_id": 29555526, "comment_id": 47263005, "body": "Thanks for the reply ava. I had tried doing this, but unfortunately still getting the same error. Is there some other solution ?"}, {"owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "reply_to_user": {"reputation": 4377, "user_id": 1154018, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b815b5d6f9f344aad0c020e6782fb919?s=128&d=identicon&r=PG", "display_name": "jimcgh", "link": "https://stackoverflow.com/users/1154018/jimcgh"}, "edited": false, "score": 0, "creation_date": 1428674248, "post_id": 29555526, "comment_id": 47276314, "body": "@Jim don&#39;t forget to run <code>source ~&#47;.zshrc</code> after changing your <code>.zshrc</code> file."}], "tags": [], "owner": {"reputation": 91, "user_id": 4767643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g2AddwHdGIs/AAAAAAAAAAI/AAAAAAAAASc/kvZ_VG7H8ek/photo.jpg?sz=128", "display_name": "Ava Jarvis", "link": "https://stackoverflow.com/users/4767643/ava-jarvis"}, "is_accepted": false, "score": 2, "last_activity_date": 1428650246, "creation_date": 1428650246, "answer_id": 29555526, "question_id": 29555483, "link": "https://stackoverflow.com/questions/29555483/unable-to-run-haskell-on-osx-due-to-zsh/29555526#29555526", "title": "Unable to run Haskell on OSX due to Zsh", "body": "<p>Instead of appending to <code>~/.bash_profile</code>, instead append (add to the end) of your <code>~/.zshrc</code> file. Then open a new shell (i.e. new Terminal window) and your environment variables will be set appropriately. </p>\n"}], "owner": {"reputation": 4377, "user_id": 1154018, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b815b5d6f9f344aad0c020e6782fb919?s=128&d=identicon&r=PG", "display_name": "jimcgh", "link": "https://stackoverflow.com/users/1154018/jimcgh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1428650246, "creation_date": 1428650065, "question_id": 29555483, "link": "https://stackoverflow.com/questions/29555483/unable-to-run-haskell-on-osx-due-to-zsh", "title": "Unable to run Haskell on OSX due to Zsh", "body": "<p>I just started learning Haskell and installed GHC-7.8.4 on my OSX 10.10.2 machine. But on on launching GHC im getting the following error. I use Zsh as my default shell. Any way to fix this ?</p>\n\n<p><img src=\"https://i.stack.imgur.com/qp1ez.png\" alt=\"enter image description here\"></p>\n\n<p>Thank You</p>\n"}, {"tags": ["json", "haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "edited": false, "score": 0, "creation_date": 1428702341, "post_id": 29563031, "comment_id": 47291705, "body": "Hi thank you for the response i copy you code and it works :-)  another question if you may - what if i use the <code>rawSQL</code>?"}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "reply_to_user": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "edited": false, "score": 0, "creation_date": 1428767993, "post_id": 29563031, "comment_id": 47308197, "body": "Depending on how you use it, <code>rawSql</code> might return a list of <code>Entity</code>, in which case it will work exactly the same. Otherwise, I&#39;m not sure, because it depends on what exactly you get back."}, {"owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "edited": false, "score": 0, "creation_date": 1428907004, "post_id": 29563031, "comment_id": 47344647, "body": "can i ask a follow up question.. i want to include the <code>id</code> how do i do that?"}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "reply_to_user": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "edited": false, "score": 0, "creation_date": 1428916433, "post_id": 29563031, "comment_id": 47349391, "body": "That&#39;s the other part of <code>Record</code>. You can use <code>entityKey</code> to recover the <code>Key</code>. Then the way to convert it to something usable depends on the backend you use. For example, for SQL, ``fromSqlKey```might do the trick."}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 1, "last_activity_date": 1428673362, "creation_date": 1428673362, "answer_id": 29563031, "question_id": 29552552, "link": "https://stackoverflow.com/questions/29552552/return-json-based-on-persistent-query-from-yesod-handler/29563031#29563031", "title": "Return JSON based on Persistent Query from yesod handler", "body": "<p>I guess your main problem is that <code>selectList</code> returns a list of <code>Entity Record</code> (where <code>Record</code> is the type you are querying) instead of <code>Record</code>, so we'll have to get a list of records using <code>map entityVal</code> (<code>entityVal</code> is defined in <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/persistent/Database-Persist-Types.html#t:Entity\" rel=\"nofollow\"><code>Entity</code></a>). You handler will look like this :</p>\n\n<pre><code>getImagesR = do\n  images &lt;- runDB $ selectList [ImagesFilename !=. \"\"] [Desc ImagesDate]\n  returnJson (map entityVal images)\n</code></pre>\n\n<p>Now it's just a matter of transforming <code>[Record]</code> to JSON. Luckily, this can be done automatically by adding the word <code>json</code> to the persistent model definition (<a href=\"https://github.com/yesodweb/persistent/wiki/Persistent-entity-syntax#json-instances\" rel=\"nofollow\">as shown here</a>).</p>\n"}], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 29563031, "answer_count": 1, "score": 1, "last_activity_date": 1428673362, "creation_date": 1428634433, "last_edit_date": 1495535059, "question_id": 29552552, "link": "https://stackoverflow.com/questions/29552552/return-json-based-on-persistent-query-from-yesod-handler", "title": "Return JSON based on Persistent Query from yesod handler", "body": "<p>this will be an additional question for @KonstantineRybnikov about <a href=\"https://stackoverflow.com/questions/17282501/return-json-from-yesod-handler\">Return JSON from yesod handler</a>.</p>\n\n<p>What if i want have a Persistent Query specifically <code>selectList</code> and all the result data must return into a JSON format? what will be the code for it?</p>\n\n<p>here is my code (Adopt from the code of @KonstantineRybnikov):</p>\n\n<pre><code>    -- JSON\n    import           Data.Aeson      (object, (.=))\n    import qualified Data.Aeson      as J\n    import           Yesod.Core.Json (returnJson)\n\n    getImagesR :: Handler Value\n    getImagesR = do\n          images &lt;- runDB $ selectList [ImagesFilename !=. \"\"] [Desc ImagesDate]\n          return $ object (if null images then [] else [] -- i want the result of my perstent to be in a JSON FORMAT)\n</code></pre>\n\n<p>``</p>\n\n<p>hope you help me thank you.</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "edited": false, "score": 2, "creation_date": 1428654158, "post_id": 29549435, "comment_id": 47263649, "body": "By the way, do you really need to choose Parsec for this task? Could you use a simple regular expression like <code>^&lt;option.*value=(\\d+).*&gt;$</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 1, "creation_date": 1428658095, "post_id": 29549556, "comment_id": 47265940, "body": "I guess you need to do it after you extract the &lt;select&gt; tag <a href=\"http://stackoverflow.com/questions/29546940/parsec-ignore-everything-except-one-fragment\">using this</a>. There is no reason for using Parsec since you need just some values and you don&#39;t care at all about grammar. Try use regex (i recommad tdfa) and extract your values. I can hepl you with the regex if you want to"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1428673423, "post_id": 29549556, "comment_id": 47275671, "body": "That&#39;s very useful information. I wasn&#39;t sure if parsed was the right tool for this. Thanks for your help!"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428687553, "post_id": 29549556, "comment_id": 47284481, "body": "This is fine and dandy, but working for arbitrary parsers is more important in my eyes."}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 2, "last_activity_date": 1428615554, "creation_date": 1428615554, "answer_id": 29549556, "question_id": 29549435, "link": "https://stackoverflow.com/questions/29549435/parsec-how-to-find-matches-within-a-string/29549556#29549556", "title": "Parsec how to find &quot;matches&quot; within a string", "body": "<p>You can use </p>\n\n<pre><code> many ( noneOf \"0123456789\")\n</code></pre>\n\n<p>i'm not sure about \"noneOf\" and \"digit\" types but you can give e try also to </p>\n\n<pre><code>many $ noneOf digit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2824, "user_id": 187223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ab705e8ee51d24c8e52192f7fde8d76?s=128&d=identicon&r=PG", "display_name": "James Brock", "link": "https://stackoverflow.com/users/187223/james-brock"}, "edited": false, "score": 0, "creation_date": 1566954085, "post_id": 29567517, "comment_id": 101813697, "body": "This answer is close, but you have to backtrack <code>myParser</code> if it consumes some input and fails, as @neil-smith notes in his answer. Also you have to consider if <code>myParser</code> succeeds without consuming any input, because then this will loop forever. <a href=\"https://hackage.haskell.org/package/replace-megaparsec/docs/Replace-Megaparsec.html#v:sepCap\" rel=\"nofollow noreferrer\"><code>sepCap</code></a> will handle these and other subtleties."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 8, "last_activity_date": 1482620449, "last_edit_date": 1482620449, "creation_date": 1428687498, "answer_id": 29567517, "question_id": 29549435, "link": "https://stackoverflow.com/questions/29549435/parsec-how-to-find-matches-within-a-string/29567517#29567517", "title": "Parsec how to find &quot;matches&quot; within a string", "body": "<p>For an arbitrary parser <code>myParser</code>, it's quite easy:</p>\n\n<pre><code>solution = many (let one = myParser &lt;|&gt; (anyChar &gt;&gt; one) in one)\n</code></pre>\n\n<p>It might be clearer to write it this way:</p>\n\n<pre><code>solution = many loop\n    where \n        loop = myParser &lt;|&gt; (anyChar &gt;&gt; loop)\n</code></pre>\n\n<p>Essentially, this defines a recursive parser (called <code>loop</code>) that will continue searching for the first thing that can be parsed by <code>myParser</code>. <code>many</code> will simply search exhaustively until failure, ie: EOF.</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 2070405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fb99aeccbf72102b1ce5a8df88b62b?s=128&d=identicon&r=PG", "display_name": "Neil Smith", "link": "https://stackoverflow.com/users/2070405/neil-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1481208643, "creation_date": 1481208643, "answer_id": 41042249, "question_id": 29549435, "link": "https://stackoverflow.com/questions/29549435/parsec-how-to-find-matches-within-a-string/41042249#41042249", "title": "Parsec how to find &quot;matches&quot; within a string", "body": "<p>To find the item in the string, the item is either at the start of the string, or consume one character and look for the item in the now-shorter string. If the item isn't right at the start of the string, you'll need to un-consume the characters used while looking for it, so you'll need a <code>try</code> block. </p>\n\n<pre><code>hasItem = prefixItem &lt;* (many anyChar)\npreafixItem = (try item) &lt;|&gt; (anyChar &gt;&gt; prefixItem)\nitem = &lt;parser for your item here&gt;\n</code></pre>\n\n<p>This code looks for just one occurrence of <code>item</code> in the string. </p>\n\n<p>(AJFarmar almost has it.)</p>\n"}, {"tags": [], "owner": {"reputation": 2824, "user_id": 187223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ab705e8ee51d24c8e52192f7fde8d76?s=128&d=identicon&r=PG", "display_name": "James Brock", "link": "https://stackoverflow.com/users/187223/james-brock"}, "is_accepted": false, "score": 0, "last_activity_date": 1566916561, "last_edit_date": 1566916561, "creation_date": 1566914212, "answer_id": 57676298, "question_id": 29549435, "link": "https://stackoverflow.com/questions/29549435/parsec-how-to-find-matches-within-a-string/57676298#57676298", "title": "Parsec how to find &quot;matches&quot; within a string", "body": "<p>The <a href=\"https://hackage.haskell.org/package/replace-megaparsec\" rel=\"nofollow noreferrer\">replace-megaparsec</a> package allows you to split up a string into sections which match your pattern and sections which don't match by using the <a href=\"https://hackage.haskell.org/package/replace-megaparsec/docs/Replace-Megaparsec.html#v:sepCap\" rel=\"nofollow noreferrer\"><code>sepCap</code></a> parser combinator.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Replace.Megaparsec\nimport Text.Megaparsec\nimport Text.Megaparsec.Char\n\nlet num :: Parsec Void String Int\n    num = read &lt;$&gt; many digitChar\n</code></pre>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;&gt;&gt; parseTest (sepCap num) \"I will live to be 111 years &lt;b&gt;old&lt;/b&gt; if I work out 4 days a week starting at 22.\"\n[Left \"I will live to be \"\n,Right 111\n,Left \" years &lt;b&gt;old&lt;/b&gt; if I work out \"\n,Right 4\n,Left \" days a week starting at \"\n,Right 22\n,Left \".\"\n]\n</code></pre>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1344, "favorite_count": 0, "accepted_answer_id": 29567517, "answer_count": 4, "score": 10, "last_activity_date": 1566916561, "creation_date": 1428615079, "last_edit_date": 1428615731, "question_id": 29549435, "link": "https://stackoverflow.com/questions/29549435/parsec-how-to-find-matches-within-a-string", "title": "Parsec how to find &quot;matches&quot; within a string", "body": "<p>How can I use parsec to parse all matched input in a string and discard the rest? </p>\n\n<p>Example: I have a simple number parser, and I can find all the numbers if I know what separates them: </p>\n\n<pre><code>num :: Parser Int\nnum = read &lt;$&gt; many digit\n\nparse (num `sepBy` space) \"\" \"111 4 22\"\n</code></pre>\n\n<p>But what if I don't know what is between the numbers? </p>\n\n<pre><code>\"I will live to be 111 years &lt;b&gt;old&lt;/b&gt; if I work out 4 days a week starting at 22.\"\n</code></pre>\n\n<p><code>many anyChar</code> doesn't work as a separator, because it consumes everything.</p>\n\n<p>So how can I get things that match an arbitrary parser surrounded by things I want to ignore?</p>\n\n<hr>\n\n<p><strong>EDIT</strong>: Note that in the real problem, my parser is more complicated: </p>\n\n<pre><code>optionTag :: Parser Fragment\noptionTag = do\n    string \"&lt;option\"\n    manyTill anyChar (string \"value=\")\n    n &lt;- many1 digit\n    manyTill anyChar (char '&gt;')\n    chapterPrefix\n    text &lt;- many1 (noneOf \"&lt;&gt;\")\n    return $ Option (read n) text\n  where\n    chapterPrefix = many digit &gt;&gt; char '.' &gt;&gt; many space\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 10, "creation_date": 1428612258, "post_id": 29548584, "comment_id": 47248776, "body": "what about &quot;then&quot; ? :P"}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 0, "creation_date": 1428612308, "post_id": 29548584, "comment_id": 47248798, "body": "yep - simple mistake. thanks, &#39;felipez&#39;. Post for credit or shall I delete this?"}, {"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 1, "creation_date": 1428612379, "post_id": 29548584, "comment_id": 47248834, "body": "I&#39;m not sure, just don&#39;t worry. It happens to me all the time!"}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1428614437, "post_id": 29548584, "comment_id": 47250045, "body": "This question should probably be closed, as it is only a typographical mistake."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 3, "creation_date": 1428631653, "post_id": 29548584, "comment_id": 47255682, "body": "A list comprehension is more idiomatic than <code>do</code> notation here: <code>[ x | x &lt;- [1,2,3], even x ]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 3, "creation_date": 1428614201, "post_id": 29549118, "comment_id": 47249905, "body": "<code>[] a</code> (or rather, <code>[a]</code>), is a Monad. You can type <code>:i []</code> in GHCi and receive: <code>instance Monad [] -- Defined in GHC.Base</code>"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1428615010, "post_id": 29549118, "comment_id": 47250319, "body": "Thanks for reply. Didn&#39;t know [] become Monad in &quot;do&quot; constructions"}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 2, "last_activity_date": 1428613906, "creation_date": 1428613906, "answer_id": 29549118, "question_id": 29548584, "link": "https://stackoverflow.com/questions/29548584/using-do-notation-with-if-else/29549118#29549118", "title": "Using do notation with if/else", "body": "<p>You forgot the \"then\".\nAlso, i'm not really sure which Monad is this.. </p>\n\n<pre><code>do { x &lt;- [1,2,3]; if (even x) then [x] else []}\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1428614949, "answer_count": 1, "score": 0, "last_activity_date": 1428613906, "creation_date": 1428612176, "question_id": 29548584, "link": "https://stackoverflow.com/questions/29548584/using-do-notation-with-if-else", "closed_reason": "Not suitable for this site", "title": "Using do notation with if/else", "body": "<p>I'm trying to use <code>do notation</code> to only return a list element if it's <code>even</code>:</p>\n\n<pre><code>ghci&gt; do { x &lt;- [1,2,3]; if (even x) [x] else []}\n&lt;interactive&gt;:43:36: parse error on input `else'\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>In addition, please note if this code is non-idiomatic.</p>\n"}, {"tags": ["html", "haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1428609835, "post_id": 29547890, "comment_id": 47247327, "body": "You mean <code>string &quot;&lt;option&quot;</code> or <code>string &quot;&lt;select&quot;</code> right? I don&#39;t care about the HTML tag itself, I care about the options inside that select tag."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1428610134, "post_id": 29547890, "comment_id": 47247533, "body": "@SeanClarkHess fixed, sorry about that!"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 1, "creation_date": 1428612358, "post_id": 29547890, "comment_id": 47248822, "body": "This is awesome, thanks! Now, a slight variation. I have a parser called <code>optionTag</code> that parses the inner option tags perfectly. How can I write: &quot;parse this string, return a list of all option tags, and ignore the rest&quot;. Your method is great for matching one thing, but what about matching several things anywhere in the string?"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1428615132, "post_id": 29547890, "comment_id": 47250381, "body": "What do you think about this? <a href=\"http://stackoverflow.com/questions/29549435/parsec-how-to-find-matches-within-a-string\" title=\"parsec how to find matches within a string\">stackoverflow.com/questions/29549435/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 2, "last_activity_date": 1428610362, "last_edit_date": 1428610362, "creation_date": 1428609708, "answer_id": 29547890, "question_id": 29546940, "link": "https://stackoverflow.com/questions/29546940/parsec-ignore-everything-except-one-fragment/29547890#29547890", "title": "Parsec ignore everything except one fragment", "body": "<p>Here's how I'd do it:</p>\n\n<pre><code>solution = (do {\n  ; string \"&lt;tag-name\"\n  ; x &lt;- \u27e6insertOptionsParserHere\u27e7\n  ; char '&gt;'\n  ; return x\n  }) &lt;|&gt; (anyChar &gt;&gt; solution)\n</code></pre>\n\n<p>This will recursively consume characters until it meets a starting <code>&lt;html&gt;</code> tag, upon which it uses your parser, and leaves the recursion on consuming a final tag.</p>\n\n<p>It is wise to note that there may be trailing whitespace before &amp; after   To fix that, we could do this, providing your parser consumes the tags:</p>\n\n<pre><code>solution = \u27e6insertHtmlParserHere\u27e7 &lt;|&gt; (anyChar &gt;&gt; solution)\n</code></pre>\n\n<p>To be clear that would mean that <code>\u27e6insertHtmlParserHere\u27e7</code> would have this kind of structure:</p>\n\n<pre><code>\u27e6insertHtmlParserHere\u27e7 = do\n   string \"&lt;tag-name\"\n   \u22ef\n   char '&gt;'\n</code></pre>\n\n<hr>\n\n<p>As a side-note, if you want to capture every tag available, you can quite happily use <code>many</code>:</p>\n\n<pre><code>everyTag = many solution\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 1, "last_activity_date": 1428613694, "creation_date": 1428613694, "answer_id": 29549051, "question_id": 29546940, "link": "https://stackoverflow.com/questions/29546940/parsec-ignore-everything-except-one-fragment/29549051#29549051", "title": "Parsec ignore everything except one fragment", "body": "<p>You can try to use regex and capture the select tag:</p>\n\n<pre><code>import Text.ParserCombinators.Parsec\nimport Text.Regex.Posix\n\n\ngetOptionTags content = content =~ \"(&lt;select.*&lt;/select&gt;)\"::[[String]]\n\nmain :: IO ()\nmain = do\n    s &lt;- readFile \"in\"\n    putStrLn . show . head . head $ getOptionTags s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2824, "user_id": 187223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ab705e8ee51d24c8e52192f7fde8d76?s=128&d=identicon&r=PG", "display_name": "James Brock", "link": "https://stackoverflow.com/users/187223/james-brock"}, "is_accepted": false, "score": 0, "last_activity_date": 1566916387, "creation_date": 1566916387, "answer_id": 57676989, "question_id": 29546940, "link": "https://stackoverflow.com/questions/29546940/parsec-ignore-everything-except-one-fragment/57676989#57676989", "title": "Parsec ignore everything except one fragment", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/replace-megaparsec/docs/Replace-Megaparsec.html#v:findAll\" rel=\"nofollow noreferrer\"><code>Replace.Megaparsec.findAll</code></a> to find the substrings in a document which match a parser.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Replace.Megaparsec\nimport Text.Megaparsec\n\nlet parseSelect :: Parsec Void String String\n    parseSelect = do\n        chunk \"&lt;select\"\n        manyTill anySingle $ chunk \"&lt;/select&gt;\"\n</code></pre>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let input = \"&lt;html&gt;\\n   random content with lots of tags...\\n   &lt;select id=something title=\\\"whatever\\\"&gt;&lt;option value=1 selected&gt;1. First&lt;option value=2&gt;2. Second&lt;/select&gt;\\n   more random content...\\n&lt;/html&gt;\"\n</code></pre>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;&gt;&gt; parseTest (findAll parseSelect) input\n[Left \"&lt;html&gt;\\n   random content with lots of tags...\\n   \"\n,Right \"&lt;select id=something title=\\\"whatever\\\"&gt;&lt;option value=1 selected&gt;1. First&lt;option value=2&gt;2. Second&lt;/select&gt;\"\n,Left \"\\n   more random content...\\n&lt;/html&gt;\"\n]\n</code></pre>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 29547890, "answer_count": 3, "score": 1, "last_activity_date": 1566916387, "creation_date": 1428606589, "question_id": 29546940, "link": "https://stackoverflow.com/questions/29546940/parsec-ignore-everything-except-one-fragment", "title": "Parsec ignore everything except one fragment", "body": "<p>I need to parse a single select tag in a poorly formed HTML document (so XML-based parsers don't work). </p>\n\n<p>I think I know how to use parsec to parse the select tag once I get there, but how do I skip all the stuff before and after that tag?</p>\n\n<p>Example:</p>\n\n<pre><code>&lt;html&gt;\n   random content with lots of tags...\n   &lt;select id=something title=\"whatever\"&gt;&lt;option value=1 selected&gt;1. First&lt;option value=2&gt;2. Second&lt;/select&gt;\n   more random content...\n&lt;/html&gt;\n</code></pre>\n\n<p>That's actually what the HTML looks like in the select tag. How would I do this with Parsec, or would you recommend I use a different library?</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1428610157, "post_id": 29546721, "comment_id": 47247548, "body": "It seems like you could just do something like <code>nonEmptyTokenField *&gt; many1 emptyTokenField</code>."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428711016, "post_id": 29546721, "comment_id": 47294292, "body": "@user2407038, thank you for pointer. That was very helpful in solving the problem. Simple and effective. I will post a solution I wrote with your pointer."}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "is_accepted": true, "score": 4, "last_activity_date": 1428712367, "creation_date": 1428712367, "answer_id": 29572682, "question_id": 29546721, "link": "https://stackoverflow.com/questions/29546721/how-to-parse-multiple-lines-with-start-and-end-tokens-in-parsec/29572682#29572682", "title": "How to parse multiple lines with start and end tokens in Parsec", "body": "<p>I solved the problem with the help of @user2407038 who suggested the basic outline in a comment. Solution and explanation below (please see the comments after the function - they show how the function behaves with the input):</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nimport Control.Monad\nimport Text.Parsec\nimport Control.Applicative hiding ((&lt;|&gt;), many)\n\n\n-- | this one accepts everything until newline, and discards the newline\n-- | This one is used as building block in the functions below\nrestOfLine :: Stream s m Char =&gt; ParsecT s u m [Char]\nrestOfLine = many1 (satisfy (\\x -&gt; not $ x == '\\n')) &lt;* char '\\n'\n\n-- | a line with token is \"many alphanumeric characters\" followed by \n-- | any characters until newline \ntokenLine :: Stream s m Char =&gt; ParsecT s u m [Char]\ntokenLine =  (++) &lt;$&gt;  many1 alphaNum &lt;*&gt; restOfLine\n\n-- | ghci test:\n-- | *Main Text.Parsec&gt; parseTest tokenLine \"a,1,,\\n\"\n-- | \"a,1,,\"\n-- | *Main Text.Parsec&gt; parseTest tokenLine \",1,,\\n\"\n-- | parse error at (line 1, column 1):\n-- | unexpected \",\"\n-- |expecting letter or digit\n\n-- | a non-token line is a line that has any number of spaces followed\n-- | by \",\", then any characters until newline\nnonTokenLine :: Stream s m Char =&gt; ParsecT s u m [Char]\nnonTokenLine = (++) &lt;$&gt; (many space) &lt;*&gt; ((:) &lt;$&gt; char ',' &lt;*&gt; restOfLine)\n\n-- | ghci test:\n-- | *Main Text.Parsec&gt; parseTest nonTokenLine \",1,,\\n\"\n-- | \",1,,\"\n-- | *Main Text.Parsec&gt; parseTest nonTokenLine \"a,1,,\\n\"\n-- | parse error at (line 1, column 1):\n-- | unexpected \"a\"\n-- | expecting space or \",\"\n\n-- | One entry is tokenLine followed by any number of nonTokenLine\noneEntry :: Stream s m Char =&gt; ParsecT s u m [[Char]]\noneEntry = (:) &lt;$&gt; tokenLine &lt;*&gt; (many nonTokenLine)\n\n-- | ghci test - please note that it drops last line as expected\n-- | *Main Text.Parsec&gt; parseTest oneEntry \"a,1,,\\n,,a\\n,,f\\nb,2,,\\n\"\n-- | [\"a,1,,\",\",,a\",\",,f\"]\n\n\n-- | We add 'many' to oneEntry to parse the entire file, and get multiple match entries\nmultiEntries :: Stream s m Char =&gt; ParsecT s u m [[String]]\nmultiEntries = many oneEntry\n\n-- | ghci test - please note that it gets two entries as expected\n-- | *Main Text.Parsec&gt; parseTest multiEntries \"a,1,,\\n,,a\\n,,f\\nb,2,,\\n\"\n-- | [[\"a,1,,\",\",,a\",\",,f\"],[\"b,2,,\"]]\n</code></pre>\n\n<p>The parser error seen in the comments is expected on invalid inputs. This can be easily handled. The above code is just a basic building block to get started.</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 2, "accepted_answer_id": 29572682, "answer_count": 1, "score": 2, "last_activity_date": 1519515643, "creation_date": 1428605848, "last_edit_date": 1519515643, "question_id": 29546721, "link": "https://stackoverflow.com/questions/29546721/how-to-parse-multiple-lines-with-start-and-end-tokens-in-parsec", "title": "How to parse multiple lines with start and end tokens in Parsec", "body": "<p>I am new at <code>Parsec</code>. Will appreciate pointers for the problem here. Say, I have a csv file with fixed number of headers. Instead of parsing each line separately, I will like to look for a token at the beginning of the line, and get all the lines until next line with non-empty token. Example below:</p>\n\n<pre><code>token,flag,values\na,1,\n,,a\n,,f\nb,2,\n</code></pre>\n\n<p>Rule for a valid input is: if the token field is filled in, get all the lines until next non-empty token field. So, I will like <code>Parsec</code> to get multiple lines below as first input (those multiple lines can then be parsed by another rule):</p>\n\n<pre><code>a,1,\n,,a\n,,f\n</code></pre>\n\n<p>Then, the process starts again on the next line with non-empty token field (last line in the example here). What I am trying to figure out is if there a simple way to specify the rule like that in <code>Parsec</code> - get all the lines that meet a certain rule. They could then be handed off to another parser. Basically, it looks like some kind of <code>lookahead</code> rule to specify what is a valid multi-line input. Did I get it right?</p>\n\n<p>We can ignore the comma separator above for now, and just say that an input begins when a character is found at the beginning of a line, and ends when a character is found at the beginning of a line.</p>\n"}, {"tags": ["haskell", "random", "quickcheck", "deterministic"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1428610036, "post_id": 29545593, "comment_id": 47247463, "body": "<code>Gen</code> couldn&#39;t do anything with an <code>Args</code>. You can specify the seed manually by simply deconstructing the <code>Gen</code> datatype by pattern matching or using <code>unGen</code>."}, {"owner": {"reputation": 4870, "user_id": 403875, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/439b8283080e4e2255205993da9de9ca?s=128&d=identicon&r=PG", "display_name": "dspyz", "link": "https://stackoverflow.com/users/403875/dspyz"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428611872, "post_id": 29545593, "comment_id": 47248552, "body": "I tried that.  unGen isn&#39;t visible (is it?)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1428619381, "post_id": 29545593, "comment_id": 47252135, "body": "You need to import Test.QuickCheck.Gen."}], "owner": {"reputation": 4870, "user_id": 403875, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/439b8283080e4e2255205993da9de9ca?s=128&d=identicon&r=PG", "display_name": "dspyz", "link": "https://stackoverflow.com/users/403875/dspyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1428603646, "creation_date": 1428601982, "last_edit_date": 1428603646, "question_id": 29545593, "link": "https://stackoverflow.com/questions/29545593/pass-args-to-generate", "title": "Pass Args to generate", "body": "<p>Does QuickCheck have a way to pass an Args object (or at least specify the seed) to the generate <code>(:: Gen a -&gt; IO a)</code> function (or something equivalent)?\nI see that it has <code>quickCheckWith</code> which takes an Args, but it can only return a Result.  There doesn't seem to be a <code>generateWith</code> function.</p>\n"}, {"tags": ["string", "haskell", "arithmetic-expressions", "rpn"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1428599048, "post_id": 29544352, "comment_id": 47240836, "body": "To parse infix arithmetic you need to implement <a href=\"http://stackoverflow.com/q/2326328/414413\">operator precedence</a>."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 2, "creation_date": 1428599253, "post_id": 29544352, "comment_id": 47240945, "body": "<a href=\"https://en.wikipedia.org/wiki/Shunting-yard_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Shunting-yard_algorithm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 158703, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/10236360c347906897eba1a138891a50?s=128&d=identicon&r=PG", "display_name": "CalumMcCall", "link": "https://stackoverflow.com/users/158703/calummccall"}, "is_accepted": false, "score": 1, "last_activity_date": 1428672494, "creation_date": 1428672494, "answer_id": 29562708, "question_id": 29544352, "link": "https://stackoverflow.com/questions/29544352/reverse-polish-notation-in-haskell/29562708#29562708", "title": "Reverse Polish Notation in Haskell", "body": "<p>You could look at <a href=\"https://wiki.haskell.org/Parsec\" rel=\"nofollow\">parsec</a> for parsing the string. It's powerful and enables you to implement robust parsing. You can then build a data structure out of the input string which you then pass to your RPN logic.</p>\n"}], "owner": {"reputation": 1, "user_id": 4770228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0de127f59b25089dba53e31acdea36?s=128&d=identicon&r=PG&f=1", "display_name": "lehal475", "link": "https://stackoverflow.com/users/4770228/lehal475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1428672494, "creation_date": 1428597969, "last_edit_date": 1428598246, "question_id": 29544352, "link": "https://stackoverflow.com/questions/29544352/reverse-polish-notation-in-haskell", "title": "Reverse Polish Notation in Haskell", "body": "<p>I need to write a function that takes an arithmetic expression and converts it to a string in Reverse Polish notation using Haskell. Creating a function to evaluate an RPN expression is quite easy and need not to worry about, it's only the conversion from arithmetic to RPN that's troubling.</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 8, "creation_date": 1428594503, "post_id": 29542978, "comment_id": 47238019, "body": "Well... <i>you</i> might run out of RAM quickly but not everyone will. ;-).  Also you can eliminate copy-collect via mark-sweep, <code>-c</code>, switch to just one generation (<code>-G</code>), and lower the amount of free space requried (<code>-mN</code>)."}], "tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": true, "score": 17, "last_activity_date": 1428593864, "creation_date": 1428593864, "answer_id": 29542978, "question_id": 29542977, "link": "https://stackoverflow.com/questions/29542977/how-to-disable-garbage-collection-in-ghc-haskell/29542978#29542978", "title": "How to disable Garbage Collection in GHC Haskell?", "body": "<p>(With the help from carter in #ghc on freenode)</p>\n\n<p>There is no switch to completely disable GC. Instead, use all of the following <code>+RTS</code> runtime options:</p>\n\n<ul>\n<li>Disable idle time garbage collection using <code>-I0</code>.</li>\n<li>Set the \"nursery\" == \"allocation area\" size to something very large, e.g. <code>-A100G</code>, as GC will only be done when the allocation area is full.</li>\n</ul>\n\n<p>See <a href=\"https://downloads.haskell.org/~ghc/7.8-latest/docs/html/users_guide/runtime-control.html\">https://downloads.haskell.org/~ghc/7.8-latest/docs/html/users_guide/runtime-control.html</a> for a description of these options.</p>\n\n<p>Be aware that you will run out of RAM quickly.</p>\n"}, {"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": false, "score": 1, "last_activity_date": 1605628219, "creation_date": 1605628219, "answer_id": 64878595, "question_id": 29542977, "link": "https://stackoverflow.com/questions/29542977/how-to-disable-garbage-collection-in-ghc-haskell/64878595#64878595", "title": "How to disable Garbage Collection in GHC Haskell?", "body": "<p>I had good results combining nh2 and Thomas's answers into</p>\n<pre><code>+RTS -I0 -A90G -G1 -m1 -RTS\n</code></pre>\n<p>I have 100 GB of RAM, so I thought <code>90G</code> was a good allocation area size.</p>\n<p>I also used <a href=\"https://hackage.haskell.org/package/base-4.14.0.0/docs/System-Mem.html\" rel=\"nofollow noreferrer\"><code>System.Mem.performGC</code></a> to manually trigger GC at appropriate points and <a href=\"https://hackage.haskell.org/package/base-4.14.0.0/docs/GHC-Stats.html\" rel=\"nofollow noreferrer\"><code>GHC.Stats</code></a> to keep track of how much time has been spent in GC.</p>\n"}], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 0, "accepted_answer_id": 29542978, "answer_count": 2, "score": 13, "last_activity_date": 1605628219, "creation_date": 1428593864, "question_id": 29542977, "link": "https://stackoverflow.com/questions/29542977/how-to-disable-garbage-collection-in-ghc-haskell", "title": "How to disable Garbage Collection in GHC Haskell?", "body": "<p>How can I disable GCs, or vastly decrease the frequency of GCs?</p>\n\n<p>Like giving it an <code>+RTS</code> option for some huge heap or or allocation size maybe?</p>\n\n<p>I want to see how my program behaves when no GCs happen.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1428594065, "post_id": 29542985, "comment_id": 47237688, "body": "if i put that statement in the file it gives me an error on &quot;import&quot;. should this be typed in ghci before i load the file?"}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1428594200, "post_id": 29542985, "comment_id": 47237811, "body": "when i write import Data.List ((\\&#41;) in ghci i still get the same error :("}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 1, "creation_date": 1428594257, "post_id": 29542985, "comment_id": 47237848, "body": "@Chalupa Are you sure you are not doing indendation error. It works fine in ideone: <a href=\"http://ideone.com/e5Gw0w\" rel=\"nofollow noreferrer\">ideone.com/e5Gw0w</a>"}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1428594492, "post_id": 29542985, "comment_id": 47238009, "body": "yea i have the same thing as you and i get this: Hask3.hs:92:1: parse error on input \u2018import\u2019 Failed, modules loaded: none."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 4, "creation_date": 1428596578, "post_id": 29542985, "comment_id": 47239413, "body": "@Chalupa Looks like you&#39;re trying to put the import in the middle of your file.  All imports have to come between the module declaration (e.g. <code>module Main where</code>) and the first declaration in your file, be it a function, value, data type, typeclass, or whatever."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1428593886, "creation_date": 1428593886, "answer_id": 29542985, "question_id": 29542861, "link": "https://stackoverflow.com/questions/29542861/not-in-scope-error-after-importing-data-list-haskell/29542985#29542985", "title": "&#39;\\\\&#39; not in scope error after importing Data.List (Haskell)", "body": "<p>Put the import statement:</p>\n\n<pre><code>import Data.List ((\\\\))\n\nperms :: Eq a =&gt; [a] -&gt; [[a]]\nperms [] = [[]]\nperms xs = [x:ps | x &lt;- xs, ps &lt;- perms(xs \\\\ [x]) ]\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 29542985, "answer_count": 1, "score": 1, "last_activity_date": 1428593886, "creation_date": 1428593546, "question_id": 29542861, "link": "https://stackoverflow.com/questions/29542861/not-in-scope-error-after-importing-data-list-haskell", "title": "&#39;\\\\&#39; not in scope error after importing Data.List (Haskell)", "body": "<p>my function prints different permutations given some numbers however i cannot load my file in ghci even AFTER i import Data.List. it tells me '\\' is not in scope. please help </p>\n\n<pre><code>perms [] = [[]]\nperms xs = [x:ps | x &lt;- xs, ps &lt;- perms(xs\\\\[x]) ]\n</code></pre>\n"}, {"tags": ["events", "haskell", "callback", "event-handling", "scenegraph"], "answers": [{"comments": [{"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1428594051, "post_id": 29542604, "comment_id": 47237676, "body": "I&#39;m not sure I get it. So I wouldn&#39;t use IORefs then, I&#39;m assuming (Ideally, I&#39;d prefer not to). I&#39;m not sure how I&#39;d use them in my scene graph, though. How would I implement something of the sought? Thanks, btw!"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 1, "creation_date": 1428595222, "post_id": 29542604, "comment_id": 47238547, "body": "@Gentatsu <code>TQueue</code> is, inside, a clever <code>IORef</code> wrapper."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1428598528, "post_id": 29542604, "comment_id": 47240556, "body": "I&#39;m still unsure as to how I&#39;d actually use it, though? The GLFW-b example seems quite specific, so I&#39;m not sure as to how I&#39;d abstract it out."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 1, "last_activity_date": 1428618093, "last_edit_date": 1428618093, "creation_date": 1428592894, "answer_id": 29542604, "question_id": 29542217, "link": "https://stackoverflow.com/questions/29542217/adding-interaction-in-to-a-scene-graph-in-haskell/29542604#29542604", "title": "Adding interaction in to a scene graph (in Haskell)", "body": "<p>That approach might work, but there are better ways. I particularly liked <a href=\"https://github.com/bsl/GLFW-b-demo/blob/master/src/Main.hs\" rel=\"nofollow\">GLFW-b example</a> that utilized something called <a href=\"https://hackage.haskell.org/package/stm-2.4.4/docs/Control-Concurrent-STM-TQueue.html\" rel=\"nofollow\"><code>TQueue</code></a>.</p>\n\n<p><code>TQueue</code> is short for Transactional Queue; it's something you can pass events into from the render thread, and then read them from the drawing thread. That way you can process them as if they were a simple, pure value; a list of events.</p>\n\n<p>In general, Haskell favours pure operation to mutable state. The available rendering frameworks emphasize pure transformation of logical state to stuff on the screen. In this case, something like a <code>State OSG</code> monad  would be probably OK, though.</p>\n"}], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1428618093, "creation_date": 1428591959, "question_id": 29542217, "link": "https://stackoverflow.com/questions/29542217/adding-interaction-in-to-a-scene-graph-in-haskell", "title": "Adding interaction in to a scene graph (in Haskell)", "body": "<p>I've made a scene graph functional rendering engine in Haskell and am wondering how to add interaction in to the mixture.</p>\n\n<p>At first, I thought I could just have another Handler node which takes in one of the other nodes and then just apply some IORefs to it. For example, if I had </p>\n\n<pre><code>x,y,z &lt;- IORef 0\nKeyboardHandler KeyboardCallBack $ Translate x y z $ Object\n</code></pre>\n\n<p>When traversing, I would have </p>\n\n<pre><code>KeyboardHandler keyboard drawable -&gt; case drawable of \nTranslate x y z _ -&gt; do \n(Char 'q') -&gt; x $~! (-1)\n(Char 'w') -&gt; x $~! (+1)\n(Char 'a') -&gt; y $~! (-1)\n(Char 's') -&gt; y $~! (+1)\n(Char 'z') -&gt; z $~! (-1)\n(Char 'x') -&gt; z $~! (+1)\nrender drawable\n</code></pre>\n\n<p>Is it possible to do something like that or am I going completely the wrong way?</p>\n"}, {"tags": ["haskell", "stackage"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428589920, "post_id": 29541333, "comment_id": 47234562, "body": "The <code>cabal.config</code> file in the current directory is used for that projects.  What you can do is create a project with <code>cabal init</code>, then <code>wget</code> the stackage <code>cabal.config</code>, then whenever you&#39;re working on that project with the <code>cabal</code> command line tool it will use the stackage servers instead."}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428590305, "post_id": 29541333, "comment_id": 47234848, "body": "I did that and it doesn&#39;t work. <code>cabal update</code> says: &quot;Downloading the latest package list from <i>hackage.haskell.org</i> Skipping download: Local and remote files match.&quot;"}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1428590721, "post_id": 29541333, "comment_id": 47235152, "body": "What about a pre-existing ~/.cabal directory. Is that problematic?"}], "answers": [{"comments": [{"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428601759, "post_id": 29543824, "comment_id": 47242448, "body": "All sounds good, but when I try to install something (e.g. in my sandbox I do <code>cabal install ghc-mod</code>) I get <code>cabal: Could not resolve dependencies</code>. I thought was the whole point of stackage was to resolve such issues."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428602357, "post_id": 29543824, "comment_id": 47242835, "body": "@z5h What is the constraint that you&#39;re getting when cabal complains with that error?"}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428602654, "post_id": 29543824, "comment_id": 47243017, "body": "trying: ghc-mod-5.2.1.2 (user goal)   trying: monad-control-1.0.0.4/installed-e5c... (dependency of ghc-mod-5.2.1.2)   next goal: transformers-compat (dependency of monad-control-1.0.0.4/installed-e5c...)   rejecting: transformers-compat-0.4.0.4/installed-0ef..., 0.4.0.4 (global constraint requires ==0.4.0.3)   rejecting: transformers-compat-0.4.0.3 (conflict: monad-control =&gt; transformers-compat==0.4.0.4/installed-0ef...)   rejecting: transformers-compat-0.4.0.2, 0.3.3.4, 0.3.3.3, 0.3.3.2, 0.3.3, 0.3.2, 0.3, 0.2, 0.1.1.1, 0.1.1, 0.1 (global constraint requires ==0.4.0.3)"}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428603310, "post_id": 29543824, "comment_id": 47243381, "body": "@z5h: Okay, it&#39;s complaining that you&#39;ve got transformers-compat-0.4.0.4 installed, but the version in stackage is pinned to transformers-compat-0.4.0.3. (Stackage works by pinning lots of things so this isn&#39;t too surprising.) So your problem now is: how did transformers-compat get installed? (possibly by installing GHC?) and secondly, is it safe to remove that package? (probably, if your current version of cabal etc. is the one that ships with stackage). Good luck with figuring all that out.  This amount of complication is one reason why Nix was invented."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 1, "creation_date": 1428603369, "post_id": 29543824, "comment_id": 47243421, "body": "Of course, ask whatever questions you want of me here and I&#39;ll still respond, but debugging a wrong-version-of-this-package problem is highly interactive."}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 1, "creation_date": 1428603616, "post_id": 29543824, "comment_id": 47243579, "body": "Before I posted I uninstalled and reinstalled Haskell from <a href=\"http://ghcformacosx.github.io/\" rel=\"nofollow noreferrer\">ghcformacosx.github.io</a>. Used <code>cabal init</code> for 1 project. Did the stackage setup and tried to install ghc-mod and failed. I&#39;m shocked that I&#39;m in a mess already. Have I done something wrong? In what order do I do things?"}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428608557, "post_id": 29543824, "comment_id": 47246509, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/74874/discussion-between-chris-drost-and-z5h\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 1, "last_activity_date": 1428596352, "creation_date": 1428596352, "answer_id": 29543824, "question_id": 29541333, "link": "https://stackoverflow.com/questions/29541333/how-do-i-set-up-stackage/29543824#29543824", "title": "How do I set up stackage?", "body": "<p>I'm sorry to hear that you're having trouble installing Haskell on OSX. Actually, if you're at this point you're something like 90% of the way there; you've got GHC and cabal installed and that's the big thing that you need to start playing around with the basic elements of Haskell: data declarations, functions, and definitions. </p>\n\n<p>The <em>per-user configuration file</em> should be <code>~/.cabal/config</code> and the <em>per-project configuration file</em> should be <code>[Project Directory]/cabal.config</code>. (So, as bheklilr states, you'll need to create a project with cabal first.) </p>\n\n<p>You should check and make sure <code>cabal --version</code> is not hopelessly out-of-date; they're on version 1.22 now but if you're <code>&gt; 1.16</code> you should be able to do the steps above. If not, indeed, the way to upgrade cabal is generally to <code>cabal-update</code> and then <code>cabal install cabal-install</code> to the latest version.</p>\n\n<p>You can of course create your own <code>~/.cabal/</code> folder.</p>\n"}], "owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 29543824, "answer_count": 1, "score": 1, "last_activity_date": 1428596352, "creation_date": 1428589700, "question_id": 29541333, "link": "https://stackoverflow.com/questions/29541333/how-do-i-set-up-stackage", "title": "How do I set up stackage?", "body": "<p>The <a href=\"https://www.stackage.org/\" rel=\"nofollow\">stackage</a> set up instructions are:</p>\n\n<blockquote>\n  <p>Download the following file, place it next to your cabal config file and you\u2019re done.  </p>\n  \n  <p>$ wget <a href=\"https://www.stackage.org/lts/cabal.config\" rel=\"nofollow\">https://www.stackage.org/lts/cabal.config</a><br>\n   $ cabal update<br>\n   $ cabal install </p>\n</blockquote>\n\n<p>The problem is I don't know what or where my cabal config file is. Also, does this mean something different if I'm using sandboxes? </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428799964, "post_id": 29576339, "comment_id": 47317675, "body": "Running ghc-mod after all of that yields <code>cabal-helper-wrapper: Installing a private copy of Cabal, this might take a while but will only happen once per Cabal version. ... (exit 1): failed</code>"}, {"owner": {"reputation": 346, "user_id": 4029471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fIjf2.jpg?s=128&g=1", "display_name": "SkyFold", "link": "https://stackoverflow.com/users/4029471/skyfold"}, "reply_to_user": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428830882, "post_id": 29576339, "comment_id": 47323299, "body": "@z5h: Wait, did you clone DanielG&#39;s repo and install it or downgrade to cabal-1.20.0.3? Regardless, please update your post with more details of what you did to get the error. When running <code>ghc-mod</code> with no args you should get &quot;ghc-mod: No command given (try --help)&quot;"}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "edited": false, "score": 0, "creation_date": 1428951338, "post_id": 29576339, "comment_id": 47371240, "body": "I cloned DanielG&#39;s repo. My OP has been updated with output. Thanks."}, {"owner": {"reputation": 3657, "user_id": 119765, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0a8015e6047bee31cc8c78808c77e5ec?s=128&d=identicon&r=PG", "display_name": "lol", "link": "https://stackoverflow.com/users/119765/lol"}, "edited": false, "score": 0, "creation_date": 1439523391, "post_id": 29576339, "comment_id": 51906806, "body": "I think it&#39;s worth noting that I was trying to install yesod on top of ghcformacosx.github -- I got the &#39;happy&#39; and &#39;alex&#39; error&#39;s which I googled to bring me here. A simple <code>cabal install happy</code> <code>cabal install alex</code> worked!"}, {"owner": {"reputation": 346, "user_id": 4029471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fIjf2.jpg?s=128&g=1", "display_name": "SkyFold", "link": "https://stackoverflow.com/users/4029471/skyfold"}, "edited": false, "score": 0, "creation_date": 1440200408, "post_id": 29576339, "comment_id": 52190632, "body": "Recommendation: use stack, not cabal. Especially for yesod! You might also want to look at the FPComplete editor or emacs plugin that makes life much easier for yesod."}, {"owner": {"reputation": 321, "user_id": 2945404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cE2YA.jpg?s=128&g=1", "display_name": "mikowiec", "link": "https://stackoverflow.com/users/2945404/mikowiec"}, "edited": false, "score": 0, "creation_date": 1467548047, "post_id": 29576339, "comment_id": 63766568, "body": "stack installed gch-mod perfect, all OK. But there is a problem after deleting .stack folder: &quot;ghc-mod: Could not find $libexecdir/cabal-helper-wrapper&quot;, by reason of &quot;~/.stack/snapshots/x86_64-osx/lts-6.4/7.10.3/libexec&quot;. I&#39;ve tried to change $libexecdir , not successfully."}], "tags": [], "owner": {"reputation": 346, "user_id": 4029471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fIjf2.jpg?s=128&g=1", "display_name": "SkyFold", "link": "https://stackoverflow.com/users/4029471/skyfold"}, "is_accepted": true, "score": 23, "last_activity_date": 1440200263, "last_edit_date": 1440200263, "creation_date": 1428745090, "answer_id": 29576339, "question_id": 29540829, "link": "https://stackoverflow.com/questions/29540829/how-do-you-set-up-haskell-ghc-mod-on-os-x/29576339#29576339", "title": "How do you set up Haskell + ghc-mod on OS/X?", "body": "<h2>Edit (August 2015) Better fix</h2>\n\n<p>A better command line tool for installing Haskell binaries and libraries by the awesome <a href=\"https://www.fpcomplete.com/blog/2015/06/stack-0-1-release\">FPComplete</a> group called <a href=\"https://github.com/commercialhaskell/stack\">stack</a> means you can install ghc-mod with <code>stack install ghc-mod</code> (outside a project to make it global) and it will just work. The binary will be installed to <code>~/.local/bin</code> and should be put on your path so your editor can find it.</p>\n\n<p>I will leave the below for anyone who wishes to know what cabal Hell really meant.</p>\n\n<h2>Problem With DanielG's Fork</h2>\n\n<p>I asked on the Haskell reddit and NihillstDandy explained that the GHC for Mac OS X does not register the Cabal library. This is not true for your install from <a href=\"http://ghcformacosx.github.io/\">http://ghcformacosx.github.io/</a>. It does register the Cabal library.</p>\n\n<p>ghc-mod needs the cabal library to work, but it does not compile with the cabal library. Instead it compiles with cabal-helper and that looks to see if you have a registered version of the cabal library. If it does not find any then <code>cabal-helper-wrapper</code> will install a private copy and in this case it tired to install the same version as what cabal-install was compiled with, cabal-1.22.0.0.</p>\n\n<p>When I installed DanielG's Fork it worked for my current project, but after testing it in other projects I am getting the same error you are. This is a problem with the fork and not Haskell (as far as I can tell).</p>\n\n<hr>\n\n<h2>Original Answer</h2>\n\n<p>So, while I was putting this post together ghc-mod was fixed for GHC-7.10. Thanks to DanielG!</p>\n\n<ul>\n<li><code>git clone https://github.com/DanielG/ghc-mod</code></li>\n<li><code>cd ghc-mod</code></li>\n<li><code>cabal install -j4</code></li>\n</ul>\n\n<p>And if you get errors that say \"setup-Simple-Cabal-1.22.2.0-x86_64-osx-ghc-7.10.1: The program 'happy' version\n>=1.17 is required but it could not be found.\"</p>\n\n<ul>\n<li><code>cabal install happy -j4</code></li>\n</ul>\n\n<p>The same for any other problems and it should work. (Although you have happy installed, so it should just work).</p>\n\n<hr>\n\n<p>The rest of the post is on how to downgrade the cabal executable, also known as cabal-install, to version 1.20.0.3. Although you could really use this to downgrade to any version. Since there is a working fork of ghc-mod that works with GHC-7.10 and cabal-1.22 you do not need to downgrade to fix ghc-mod. </p>\n\n<p>I'm just leaving the rest of the post up here since, unfortunately, this is a problem with Haskell as a whole. <a href=\"https://halcyon.sh/\">Halcyon</a> and <a href=\"http://www.pavelkogan.com/2014/07/09/haskell-development-with-nix/\">nix</a> are ways to deal with Haskell's shortcomings in this regard.</p>\n\n<hr>\n\n<h2>How to downgrade Cabal in Haskell</h2>\n\n<p>When I wrote this post ghc-mod, nor any fork, compiled with GHC-7.10 and versions below 7.10 broke with cabal-1.22 sandboxes.</p>\n\n<p>However, even if you compile ghc-mod with GHC-7.8.4 (the version before 7.10) and cabal-1.20.0.3 you still cannot use ghc-mod inside a sandbox created by cabal-1.22 and above. So the only way to use ghc-mod is to either downgrade your entire system to cabal-1.20.0.3 or don't use sandboxes. This means you can still use GHC-7.10, but you have to use the older version of cabal. That is unless you want to wait until the convener or someone else fixes it for GHC-7.10. Its been over a week already, but some kind Haskell programmer fixed it in a fork (see above).</p>\n\n<hr>\n\n<p>If this is something you still want here is how to compile ghc-mod with GHC-7.8.4 and cabal-1.20.0.3. Also, I replace the executable cabal-1.22 with the older cabal-1.20.0.3. Note, it does not matter what directory you download the sources to.</p>\n\n<ul>\n<li>download GHC-7.8.4 source for your OS from <a href=\"https://www.haskell.org/ghc/download_ghc_7_8_4\">here</a> </li>\n<li><code>tar -xf path_to_zipped_source</code></li>\n<li><code>cd path_to_ghc-7.8.4</code></li>\n</ul>\n\n<p>The next steps will install ghc-7.8.4 as ghc-7.8.4 in the same folder as ghc-7.10 is install for you. The -j4 is to tell make to use 4 threads to compile it.</p>\n\n<ul>\n<li><code>./configure</code></li>\n<li><code>make install -j4</code></li>\n</ul>\n\n<p>To get the correct version of cabal we can just ask cabal to get it.</p>\n\n<ul>\n<li><code>cabal get cabal-install-1.20.0.3</code></li>\n<li><code>cd cabal-install-1.20.0.3</code></li>\n</ul>\n\n<p>Now to install cabal with ghc-7.8.4. Here cabal-1.22 will pull all the decencies and should give you some warning about installing another version of the cabal library (not to be confused with cabal-install), this should not cause problems.</p>\n\n<ul>\n<li><code>cabal --with-compiler=ghc-7.8.4 install</code></li>\n</ul>\n\n<p>So now you should have cabal-1.20.0.4 installed, but not on your path. It will be in ~/.cabal/bin. We need to make this global, so remove cabal-1.22 (it only removes the symlink).</p>\n\n<ul>\n<li>rm `which cabal` </li>\n</ul>\n\n<p>And create the symlink to cabal-1.20.0.4. Btw, you will need to remove any sandboxes you made with cabal-1.22 and remake them with cabal-1.20.0.4.</p>\n\n<p>If you do not have <code>realpath</code> you can just type in the full path of cabal. I use it for connivence.</p>\n\n<ul>\n<li><code>cd ~/.cabal/bin</code></li>\n<li>ln -s `realpath cabal` /usr/local/bin</li>\n</ul>\n\n<p>Now this is how I compiled ghc-mod on my mac (you may run into your own problems). I'm not sure why cabal couldn't do it in one call, but this worked in the end.</p>\n\n<ul>\n<li><code>cabal --with-compiler=ghc-7.8.4 install happy</code></li>\n<li><code>cabal --with-compiler=ghc-7.8.4 install haskell-src-exts-1.16.0.1</code></li>\n<li><code>cabal --with-compiler=ghc-7.8.4 install hlint-1.9.19</code></li>\n<li><code>cabal --with-compiler=ghc-7.8.4 install ghc-mod</code></li>\n</ul>\n\n<p>Now you should be able to call ghc-mod from anywhere. To test it just type <code>ghc-mod</code> after you have <code>cabal sandbox init</code>. If it does not throw any errors then your in the clear.</p>\n"}, {"tags": [], "owner": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1429106027, "creation_date": 1429106027, "answer_id": 29652171, "question_id": 29540829, "link": "https://stackoverflow.com/questions/29540829/how-do-you-set-up-haskell-ghc-mod-on-os-x/29652171#29652171", "title": "How do you set up Haskell + ghc-mod on OS/X?", "body": "<p>If Cabal-1.22 isn't registered (<code>ghc-pkg list cabal</code>), the <code>cabal-helper-wrapper</code> will install a private copy because it needs the library installed to work, but it doesn't want to stomp on anything you have that might break by upgrading <code>Cabal</code> directly.</p>\n\n<p>GHC for Mac OS X doesn't register the <code>Cabal</code> library, it comes bundled with a version of <code>cabal-install</code> built against it.</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 2785942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869ccad8f69a57af5d3615a73d3ad172?s=128&d=identicon&r=PG", "display_name": "scturtle", "link": "https://stackoverflow.com/users/2785942/scturtle"}, "is_accepted": false, "score": 2, "last_activity_date": 1430466039, "creation_date": 1430466039, "answer_id": 29983292, "question_id": 29540829, "link": "https://stackoverflow.com/questions/29540829/how-do-you-set-up-haskell-ghc-mod-on-os-x/29983292#29983292", "title": "How do you set up Haskell + ghc-mod on OS/X?", "body": "<p>The version of executable <code>cabal</code> that is used to configure this project should be the same as the version of the global <code>Cabal</code> package.</p>\n\n<p>It's easier to install a compatible version of <code>cabal-install</code> than <code>Cabal</code> as follows:</p>\n\n<pre><code>$ ghc-pkg list | grep Cabal\n    Cabal-1.22.2.0\n$ cabal install cabal-install-1.22.2.0\n</code></pre>\n\n<p>Or build one in sandbox and replace/shadow the original one.</p>\n\n<p>Then don't forget to re-configure the project with the new <code>cabal</code>:</p>\n\n<pre><code>$ cabal clean &amp;&amp; cabal configure\n</code></pre>\n\n<p>Now the <code>ghc-mod</code> should works.</p>\n"}], "owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6594, "favorite_count": 9, "accepted_answer_id": 29576339, "answer_count": 3, "score": 17, "last_activity_date": 1440200263, "creation_date": 1428588417, "last_edit_date": 1495541321, "question_id": 29540829, "link": "https://stackoverflow.com/questions/29540829/how-do-you-set-up-haskell-ghc-mod-on-os-x", "title": "How do you set up Haskell + ghc-mod on OS/X?", "body": "<p>I first set up Haskell from <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow noreferrer\">https://www.haskell.org/platform/</a> but ghc-mod had problems with sandboxes and to update it I needed a newer cabal which needed a newer ghc. Or something like that. (<a href=\"https://stackoverflow.com/a/28049104/131227\">https://stackoverflow.com/a/28049104/131227</a> ??)</p>\n\n<p>So I deleted everything, and installed from <a href=\"http://ghcformacosx.github.io/\" rel=\"nofollow noreferrer\">http://ghcformacosx.github.io/</a>.\nThen some strange failure setting up a new sandbox was because something didn't properly have a dependancy for happy. (<a href=\"https://github.com/haskell-suite/haskell-src-exts/issues/14\" rel=\"nofollow noreferrer\">https://github.com/haskell-suite/haskell-src-exts/issues/14</a>)</p>\n\n<p>Ok. Installed happy. Now trying (again) to install ghc-mod and I get a giant mess (below).</p>\n\n<p>Should I use <a href=\"http://www.stackage.org/\" rel=\"nofollow noreferrer\">http://www.stackage.org/</a>?<br>\nI've seen some people mention <code>ghc-pkg recache</code> or <code>cabal install cabal-install</code>... Are those things I need to do? </p>\n\n<p>Mess:</p>\n\n<pre><code>Resolving dependencies... Configuring ghc-mod-5.2.1.2... Building ghc-mod-5.2.1.2... Failed to install ghc-mod-5.2.1.2 Build log ( /Users/mark/.cabal/logs/ghc-mod-5.2.1.2.log ): Configuring ghc-mod-5.2.1.2... Building ghc-mod-5.2.1.2... Preprocessing library ghc-mod-5.2.1.2...\n\nLanguage/Haskell/GhcMod/Convert.hs:1:51: Warning:\n    -XOverlappingInstances is deprecated: instead use per-instance pragmas OVERLAPPING/OVERLAPPABLE/OVERLAPS [ 1 of 38] Compiling Language.Haskell.GhcMod.Read ( Language/Haskell/GhcMod/Read.hs, dist/build/Language/Haskell/GhcMod/Read.o ) [ 2 of 38] Compiling Language.Haskell.GhcMod.Cabal21 ( Language/Haskell/GhcMod/Cabal21.hs, dist/build/Language/Haskell/GhcMod/Cabal21.o ) [ 3 of 38] Compiling Language.Haskell.GhcMod.Cabal18 ( Language/Haskell/GhcMod/Cabal18.hs, dist/build/Language/Haskell/GhcMod/Cabal18.o ) [ 4 of 38] Compiling Language.Haskell.GhcMod.Cabal16 ( Language/Haskell/GhcMod/Cabal16.hs, dist/build/Language/Haskell/GhcMod/Cabal16.o ) [ 5 of 38] Compiling Language.Haskell.GhcMod.GHCChoice ( Language/Haskell/GhcMod/GHCChoice.hs, dist/build/Language/Haskell/GhcMod/GHCChoice.o ) [ 6 of 38] Compiling Language.Haskell.GhcMod.Error ( Language/Haskell/GhcMod/Error.hs, dist/build/Language/Haskell/GhcMod/Error.o )\n\nLanguage/Haskell/GhcMod/Error.hs:12:1: Warning:\n    Module \u2018Control.Monad.Error\u2019 is deprecated:\n      Use Control.Monad.Except instead\n\nLanguage/Haskell/GhcMod/Error.hs:40:10: Warning:\n    In the use of type constructor or class \u2018Error\u2019\n    (imported from Control.Monad.Error, but defined in Control.Monad.Trans.Error):\n    Deprecated: \"Use Control.Monad.Trans.Except instead\"\n\nLanguage/Haskell/GhcMod/Error.hs:40:10: Warning:\n    In the use of type constructor or class \u2018Error\u2019\n    (imported from Control.Monad.Error, but defined in Control.Monad.Trans.Error):\n    Deprecated: \"Use Control.Monad.Trans.Except instead\" [ 7 of 38] Compiling Language.Haskell.GhcMod.Utils ( Language/Haskell/GhcMod/Utils.hs, dist/build/Language/Haskell/GhcMod/Utils.o )\n\nLanguage/Haskell/GhcMod/Utils.hs:15:1: Warning:\n    The import of \u2018Control.Applicative\u2019 is redundant\n      except perhaps to import instances from \u2018Control.Applicative\u2019\n    To import instances alone, use: import Control.Applicative()\n\nLanguage/Haskell/GhcMod/Utils.hs:45:51: Warning:\n    In the use of \u2018strMsg\u2019\n    (imported from Language.Haskell.GhcMod.Error, but defined in Control.Monad.Trans.Error):\n    Deprecated: \"Use Control.Monad.Trans.Except instead\" [ 8 of 38] Compiling Language.Haskell.GhcMod.Types ( Language/Haskell/GhcMod/Types.hs, dist/build/Language/Haskell/GhcMod/Types.o ) [ 9 of 38] Compiling Language.Haskell.GhcMod.Gap ( Language/Haskell/GhcMod/Gap.hs, dist/build/Language/Haskell/GhcMod/Gap.o )\n\nLanguage/Haskell/GhcMod/Gap.hs:256:18:\n    Not in scope: data constructor \u2018ExposePackageId\u2019\n    Perhaps you meant \u2018ExposePackage\u2019 (imported from DynFlags) cabal: Error: some packages failed to install: ghc-mod-5.2.1.2 failed during the building phase. The exception was: ExitFailure 1\n</code></pre>\n\n<p>After applying the accepted answer (which seemed to install ghc-mod), running gch-mod gives the following:</p>\n\n<pre><code>&gt; ghc-mod check x.hs\ncabal-helper-wrapper: Installing a private copy of Cabal, this might take a\nwhile but will only happen once per Cabal version.\n\nIf anything goes horribly wrong just delete this directory and try again:\n    /Users/mark/.ghc-mod/cabal-helper\n\nIf you want to avoid this automatic installation altogether install version\n1.22.0.0 of Cabal manually (into your user or global package-db):\n    $ cabal install Cabal-1.22.0.0\n...In order, the following would be installed:\nfilepath-1.3.0.1 (latest: 1.4.0.0) (new version)\ndirectory-1.2.2.1 (new version)\nprocess-1.2.3.0 (reinstall) changes: directory-1.2.2.0 -&gt; 1.2.2.1,\nfilepath-1.4.0.0 -&gt; 1.3.0.1\nCabal-1.22.0.0 (latest: 1.22.2.0) (new version)\ncabal: The following packages are likely to be broken by the reinstalls:\nghc-7.10.1\nCabal-1.22.2.0\nUse --force-reinstalls if you want to install anyway.\ncabal-helper-wrapper: Installing Cabal version 1.22.0.0 failed.\nnYou have two choices now:\n- Either you install this version of Cabal in your globa/luser package-db\n  somehow\nn- Or you can see if you can update your cabal-install to use a different\n  version of the Cabal library that we can build with:\n    $ cabal install cabal-install --constraint 'Cabal &gt; 1.22.0.0'\nnTo check the version cabal-install is currently using try:\n    $ cabal --version\n\nghc-mod: readCreateProcess: /Users/mark/.cabal/libexec/cabal-helper-wrapper \"/Users/mark/work/haskell/ixberg/dist\" \"entrypoints\" \"source-dirs\" \"ghc-options\" \"ghc-src-options\" \"ghc-pkg-options\" \"--with-ghc=ghc\" \"--with-ghc-pkg=ghc-pkg\" \"--with-cabal=cabal\" (exit 1): failed\n</code></pre>\n\n<p>Strangely, it wants the version of Cabal that is currently installed:</p>\n\n<pre><code>&gt; cabal --version\ncabal-install version 1.22.0.0\nusing version 1.22.0.0 of the Cabal library\n</code></pre>\n"}, {"tags": ["haskell", "minimum"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1428584301, "post_id": 29538972, "comment_id": 47230342, "body": "What kind of errors? <a href=\"http://ideone.com/Gcg35g\" rel=\"nofollow noreferrer\">No errors here</a>"}, {"owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "edited": false, "score": 0, "creation_date": 1428584474, "post_id": 29538972, "comment_id": 47230478, "body": "could not deduce (Num a) arising from the literal &#39;0&#39;"}, {"owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "edited": false, "score": 0, "creation_date": 1428584636, "post_id": 29538972, "comment_id": 47230588, "body": "found answer  newlist = filter condition test      where condition (n,_) = n &gt; 0"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1428584999, "post_id": 29538972, "comment_id": 47230842, "body": "Remove the type signature. Then type <code>:t minr</code> in ghci."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1428584904, "post_id": 29539329, "comment_id": 47230777, "body": "This doesn&#39;t do exactly the same thing as the other version."}], "tags": [], "owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "is_accepted": false, "score": 0, "last_activity_date": 1428584706, "creation_date": 1428584706, "answer_id": 29539329, "question_id": 29538972, "link": "https://stackoverflow.com/questions/29538972/min-value-in-haskell-excluding-0/29539329#29539329", "title": "Min value in Haskell excluding 0", "body": "<p>here is the answer i got, might not be good but it works</p>\n\n<pre><code>newlist = filter condition tuplename\n where condition (n,_) = n &gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "is_accepted": false, "score": 2, "last_activity_date": 1428584742, "creation_date": 1428584742, "answer_id": 29539340, "question_id": 29538972, "link": "https://stackoverflow.com/questions/29538972/min-value-in-haskell-excluding-0/29539340#29539340", "title": "Min value in Haskell excluding 0", "body": "<p>Because your list is a list of <code>a</code> which is generic (and not a number), Haskell can't let you just compare it to 0...\nYou can try setting <code>(Num a, Ord a)</code> as a constraint.</p>\n\n<p>Your current code doesn't deal with tuples at all by the way, but I'll let you solve that one yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 6537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177a32509816cca09772c80146cf4770?s=128&d=identicon&r=PG", "display_name": "FooLman", "link": "https://stackoverflow.com/users/6537/foolman"}, "is_accepted": false, "score": 1, "last_activity_date": 1428584810, "creation_date": 1428584810, "answer_id": 29539368, "question_id": 29538972, "link": "https://stackoverflow.com/questions/29538972/min-value-in-haskell-excluding-0/29539368#29539368", "title": "Min value in Haskell excluding 0", "body": "<p>Not sure about the tuple part, as your sample was operating on arrays, but here is an option:</p>\n\n<pre><code> foldl (\\a x -&gt; if x==0 then a else min x a)  (maxBound :: Int) [9,15,12,0,5,6,7,8,9]\n</code></pre>\n\n<p>The result is 5.\nFor empty arrays it gives back maxBound which is a quite huge number.</p>\n"}, {"tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": true, "score": 1, "last_activity_date": 1428588178, "creation_date": 1428588178, "answer_id": 29540727, "question_id": 29538972, "link": "https://stackoverflow.com/questions/29538972/min-value-in-haskell-excluding-0/29540727#29540727", "title": "Min value in Haskell excluding 0", "body": "<p>Perhaps not the most efficient way, but simple enough. First filter out zero values. Then sort the remaining in ascending order, and take the first (<code>head</code>). </p>\n\n<p>For empty lists, including the case of a list with all zero values, <code>head</code> will err. This is well-defined up to the question statement / requirements.</p>\n\n<p>Thus consider,</p>\n\n<pre><code>import Data.List\n\nminr :: (Ord a, Num a) =&gt; [(a,[a])] -&gt; (a,[a])\nminr = head . sort . filter (\\(y,_) -&gt; y /= 0)  \n</code></pre>\n\n<p>and so </p>\n\n<pre><code>\u03bb&gt; minr [(45.4, [9.0]), (0, [9.1]), (7,[1.2])]\n(7.0,[1.2])\n</code></pre>\n\n<p>However</p>\n\n<pre><code>\u03bb&gt; minr []\n*** Exception: Prelude.head: empty list\n\n\u03bb&gt; minr [(0.0, [9.0]), (0, [9.1]), (0,[1.2])]\n*** Exception: Prelude.head: empty list\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "closed_date": 1428597909, "accepted_answer_id": 29540727, "answer_count": 4, "score": 0, "last_activity_date": 1428655539, "creation_date": 1428583736, "last_edit_date": 1428655539, "question_id": 29538972, "link": "https://stackoverflow.com/questions/29538972/min-value-in-haskell-excluding-0", "closed_reason": "Needs details or clarity", "title": "Min value in Haskell excluding 0", "body": "<p>im passing a list of tuples eg [(45.4, [9.0]), (0, [9.1])] into a function that will get the smallest </p>\n\n<p>here is the code i have so far </p>\n\n<pre><code>minr :: (Ord a) =&gt; [a] -&gt; a \nminr [] = error \"List is empty\"\nminr [x] = x  \nminr (x:y:xs) = if x &lt; y then \n                   if x &gt; 0 then minr(x:xs) \n                   else minr(y:xs)\n               else minr(y:xs)\n</code></pre>\n\n<p>i can use the function without the if x > 0 then the function will work correctly but when i try to compare it using > 0 then it doesnt work.</p>\n\n<p>fix i removed the 0 before comparing and i know that the compare wasnt working due to the type declaration thanks for the help</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 2114784, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2c1f3ff53b140db2ecc69af62e3125e2?s=128&d=identicon&r=PG", "display_name": "Kheran", "link": "https://stackoverflow.com/users/2114784/kheran"}, "edited": false, "score": 0, "creation_date": 1428594785, "post_id": 29539805, "comment_id": 47238218, "body": "Ah I did not realize this! I am still fairly new to Haskell, but this explains everything. Thank you so much!"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 10, "last_activity_date": 1428585926, "creation_date": 1428585926, "answer_id": 29539805, "question_id": 29538892, "link": "https://stackoverflow.com/questions/29538892/how-do-i-determine-a-child-type-from-a-parents-data-type/29539805#29539805", "title": "How do I determine a &#39;child&#39; type from a parent&#39;s data type?", "body": "<pre><code>data ParentExpression = BooleanExpression | IntegralExpression\n</code></pre>\n\n<p>does not do what you probably think it's doing. What it does, is declaring a new datatype with two nullary constructors, that have nothing in common with the similarly named  datatypes  declared earlier.</p>\n\n<p>In creating new datatypes, you need always to specify a constructor name, like</p>\n\n<pre><code>data ParentExpression = BExpr BooleanExpression | IExpr IntegralExpression\n</code></pre>\n\n<p>In Haskell, all values are explicitly \"tagged\" with their datatype constructors, e.g.:</p>\n\n<pre><code>testConvert :: ParentExpression -&gt; Integer\ntestConvert (IExpr (Value n)) = n\n</code></pre>\n\n<p>there's no implicit type conversions in Haskell.</p>\n"}], "owner": {"reputation": 516, "user_id": 2114784, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2c1f3ff53b140db2ecc69af62e3125e2?s=128&d=identicon&r=PG", "display_name": "Kheran", "link": "https://stackoverflow.com/users/2114784/kheran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 29539805, "answer_count": 1, "score": 3, "last_activity_date": 1428585926, "creation_date": 1428583539, "last_edit_date": 1428585308, "question_id": 29538892, "link": "https://stackoverflow.com/questions/29538892/how-do-i-determine-a-child-type-from-a-parents-data-type", "title": "How do I determine a &#39;child&#39; type from a parent&#39;s data type?", "body": "<p>I'm not sure if my title really describes what I'm after, so I'll just show a piece of code first:</p>\n\n<pre><code>data IntegralExpression= Value Integer\n       | Add IntegralExpression IntegralExpression\n         deriving Show\n\ndata BooleanExpression = BValue Bool\n       | And BooleanExpression BooleanExpression \n       | Or BooleanExpression BooleanExpression \n         deriving Show\n\ndata ParentExpression = BooleanExpression \n      | IntegralExpression\n        deriving Show\n</code></pre>\n\n<p>The way I set this up, it makes sense to me that a ParentExpression can either be an IntegerExpression or BooleanExpression. However, I'm trying to accomplish a function that has a ParentExpression as input, which could (for example) be 'Value 5' (from the IntegerExpression child class). But upon compiling, it will say that it expects a ParentExpression and not an IntegerExpression. How can I create 1 general 'parent' that evaluates any child?</p>\n\n<p>My function (for simplicity sake) looks something like this:</p>\n\n<pre><code>testConvert :: ParentExpression -&gt; Integer\ntestConvert (Value n) = n\n</code></pre>\n\n<p>In my mind, this function should 'understand' that this concerns an IntegralExpression given that I call:</p>\n\n<pre><code>testConvert (Value 5)\n</code></pre>\n\n<p>However, it won't compile since Haskell expects something of type 'ParentExpression' whereas I input 'IntegralExpression'.</p>\n\n<p><strong>So my question is:</strong> How can I create a function with a parent datatype as its type, that accepts any form of input of its childs?</p>\n"}, {"tags": ["haskell", "main", "conventions", "compiler-flags", "type-signature"], "comments": [{"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1428585117, "post_id": 29538610, "comment_id": 47230942, "body": "Missing top level type signature should be an error. In fact it should be illegal."}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 5, "creation_date": 1428585738, "post_id": 29538610, "comment_id": 47231387, "body": "Illegal as in should be punishable as a crime. Not illegal in the language."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1428585747, "post_id": 29538610, "comment_id": 47231394, "body": "In particular, top-level <i>exported</i> type signature could be an error. I use a lot of very generic helpers that aren&#39;t exported, don&#39;t have public docs and their signatures are longer than their bodies. Writing those out doesn&#39;t help at all and is just an annoyance."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1428585946, "post_id": 29538610, "comment_id": 47231543, "body": "The book is merely stating that they are not going to provide type annotations for <code>main</code> to reduce clutter in their presentation. They are not implying that you should not annotate it."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1428586501, "post_id": 29538610, "comment_id": 47231947, "body": "@chi Interesting; I didn&#39;t read it in that way. I&#39;m not sure which way that sentence is supposed to be interpreted, though. Another instance of an ambiguous &quot;we&quot;."}, {"owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "edited": false, "score": 0, "creation_date": 1428587023, "post_id": 29538610, "comment_id": 47232355, "body": "I also get the impression that the sentence is talking about a convention used in the book and not about the Haskell community in general. I&#39;ve personally found that giving <code>main</code> an explicit type signature is very useful in practice."}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1428584479, "post_id": 29539201, "comment_id": 47230483, "body": "Thanks for clarifying."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1428659164, "post_id": 29539201, "comment_id": 47266617, "body": "Also for bigger projects it makes sense to enable <code>-fwarn-missing-signatures</code> and <code>-Werror</code>, which then forces <code>main</code> to have a type signature."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1428665901, "post_id": 29539201, "comment_id": 47270744, "body": "@PetrPudl&#225;k I typically use <code>-Wall</code> (which enables <code>-fwarn-missing-signatures</code>, I believe) in conjunction with <code>-Werror</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 14, "last_activity_date": 1428588434, "last_edit_date": 1428588434, "creation_date": 1428584375, "answer_id": 29539201, "question_id": 29538610, "link": "https://stackoverflow.com/questions/29538610/should-one-specify-a-type-signature-for-main-or-not-why-why-not/29539201#29539201", "title": "Should one specify a type signature for main or not? Why / why not?", "body": "<p>Well, generally speaking, as that warning makes clear, it's <em>always</em> a good idea to give top-level bindings a type signature. In fact, it would be more reasonable to say</p>\n\n<blockquote>\n  <p>By convention, we do specify a type declaration for <strong>everything</strong><sup>1</sup>.</p>\n</blockquote>\n\n<p>Certainly, in a big project, <code>main</code> itself makes up a neglectable effort, so it really doesn't make any sense to omit the signature. Just write it out, for sake of consistency.</p>\n\n<p>However, though Haskell is great for properly structured projects and actually there's a tendency to write almost everything in <em>libraries</em>, it's also surprisingly good as a quick scripting language, for stuff other people would write in Python or Perl. And in those cases, you generally don't care that much about safety and good documentation etc., you just want to quickly write down something as concise as possible that does the job. You also normally don't compile those scripts with <code>-Wall</code> but just execute them with <code>runhaskell</code>. And as scripts always need to contain a <code>main</code> (unlike most other Haskell source files), it is indeed sensible enough to omit the signature here.</p>\n\n<p>I'd still suspect that the majority of Haskellers nowadays <em>do</em> write <code>main::IO()</code> even in the simplest scripts, if just out of habit.</p>\n\n<hr>\n\n<p><sup>1</sup><sub>Only everything on the top-level, that is. Local signatures sometimes do make sense as well, but often they rather clutter the code.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1428587944, "post_id": 29540551, "comment_id": 47233131, "body": "Interesting. Could you add a link to where, in the standard, you read that <i><code>main</code> just has to have some type of the form <code>IO a</code></i>?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1428588336, "post_id": 29540551, "comment_id": 47233406, "body": "@Jubobs: see the second paragraph of <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-980005\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/haskellch5.html#x11-980&zwnj;&#8203;005</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1428594431, "post_id": 29540551, "comment_id": 47237967, "body": "I&#39;d argue that not requiring <code>main :: IO ()</code> is a (very) minor defect of the standard. This is however a matter of personal taste."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1428659053, "post_id": 29540551, "comment_id": 47266536, "body": "Could you add such an example when <code>main</code> ends up with <code>IO (IO a)</code>?"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1428659583, "post_id": 29540551, "comment_id": 47266896, "body": "@PetrPudl&#225;k A contrived example: <code>main = return getLine</code>, which is of type <code>IO (IO String)</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428674840, "post_id": 29540551, "comment_id": 47276767, "body": "Or slightly less contrived, <code>main = putStrLn &lt;$&gt; getLine</code>."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 8, "last_activity_date": 1428587745, "creation_date": 1428587745, "answer_id": 29540551, "question_id": 29538610, "link": "https://stackoverflow.com/questions/29538610/should-one-specify-a-type-signature-for-main-or-not-why-why-not/29540551#29540551", "title": "Should one specify a type signature for main or not? Why / why not?", "body": "<p>It's actually a very good idea to write a type signature for <code>main</code>, since otherwise if you get too fancy trying to write things in point-free form, you can end up with <code>main</code> of type <code>IO (IO ())</code>. This is accepted (the language standard says <code>main</code> just has to have some type of the form <code>IO a</code>) but the \"inner IO action\" that is the result of <code>main</code> will just be discarded, which is almost certainly not what you wanted (you probably wanted to <code>join</code> it).</p>\n"}], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2727, "favorite_count": 1, "accepted_answer_id": 29539201, "answer_count": 2, "score": 14, "last_activity_date": 1428654788, "creation_date": 1428582798, "last_edit_date": 1428654788, "question_id": 29538610, "link": "https://stackoverflow.com/questions/29538610/should-one-specify-a-type-signature-for-main-or-not-why-why-not", "title": "Should one specify a type signature for main or not? Why / why not?", "body": "<p>I learned from <a href=\"http://learnyouahaskell.com/input-and-output#hello-world\" rel=\"noreferrer\">chapter 9 of Learn You A Haskell For Great Good</a> that</p>\n\n<blockquote>\n  <p>By convention, we don't usually specify a type declaration for <code>main</code>.</p>\n</blockquote>\n\n<p>As far as I can tell, this convention is widespread. However, if I compile, using the <code>-Wall</code> flag, a program that lacks a type signature for <code>main</code>, such as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- test.hs\n\n-- main :: IO ()\nmain = print (1 :: Int)\n</code></pre>\n\n<p>GHC does issue a warning:</p>\n\n<pre><code>$ ghc -Wall test.hs\n[1 of 1] Compiling Main             ( test.hs, test.o )\n\ntest.hs:2:1: Warning:\n    Top-level binding with no type signature: main :: IO ()\nLinking test ...\n$\n</code></pre>\n\n<p>I'm confused... If a type signature for <code>main</code> is indeed superfluous, why would <code>-Wall</code> cause GHC to complain when it's missing? Are there good reasons (aside from getting rid of that warning) for specifying <code>main</code>'s type anyway?</p>\n"}, {"tags": ["haskell", "terminal", "prompt", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "edited": false, "score": 0, "creation_date": 1428583538, "post_id": 29538616, "comment_id": 47229792, "body": "Thanks a heap, is it possible to use unicode in set prompt for example for value 03BB which denotes the lamda symbol ?"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1428583624, "post_id": 29538616, "comment_id": 47229847, "body": "To add to MathematicalOrchid&#39;s answer, you should write the following two lines in your <code>.ghci</code> file: <code>:set prompt &quot;\u03bb&gt; &quot;</code>, <code>:set prompt2 &quot;\u03bb| &quot;</code>."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 1, "creation_date": 1443061732, "post_id": 29538616, "comment_id": 53345234, "body": "<code>Q: But where do I put the .ghci file?</code>  A: <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci-dot-files.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 5, "creation_date": 1504901105, "post_id": 29538616, "comment_id": 79210314, "body": "Since at least GHC version 8.2.1, <code>prompt2</code> has been replaced by <code>prompt-cont</code>."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 11, "last_activity_date": 1450696167, "last_edit_date": 1450696167, "creation_date": 1428582816, "answer_id": 29538616, "question_id": 29538549, "link": "https://stackoverflow.com/questions/29538549/haskell-ghci-lambda-symbol-in-prompt/29538616#29538616", "title": "Haskell ghci lambda symbol in prompt", "body": "<p>The command you're looking for is <code>:set prompt</code>. Follow it by whatever you want the prompt to be. You can put this in <code>.ghci</code>, I believe.</p>\n\n<pre><code>:set prompt \"\u03bb&gt; \"\n:set prompt2 \"\u03bb| \"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9946, "user_id": 467754, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3rEtR.png?s=128&g=1", "display_name": "Nikos Baxevanis", "link": "https://stackoverflow.com/users/467754/nikos-baxevanis"}, "edited": false, "score": 1, "creation_date": 1520047457, "post_id": 29738438, "comment_id": 85166441, "body": "Or something like <code>:set prompt &quot;%s\\n\\x03BB &quot;</code> if you want to see the loaded modules on the first line, and the <code>\u03bb </code> on the second line."}], "tags": [], "owner": {"reputation": 121, "user_id": 1781815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0b878bcf73c8f016480de339a88154?s=128&d=identicon&r=PG", "display_name": "danplubell", "link": "https://stackoverflow.com/users/1781815/danplubell"}, "is_accepted": false, "score": 9, "last_activity_date": 1495419553, "last_edit_date": 1495419553, "creation_date": 1429497114, "answer_id": 29738438, "question_id": 29538549, "link": "https://stackoverflow.com/questions/29538549/haskell-ghci-lambda-symbol-in-prompt/29738438#29738438", "title": "Haskell ghci lambda symbol in prompt", "body": "<p>You can use the following command to use the lambda character:</p>\n\n<pre><code>:set prompt \"\\x03BB: \"\n</code></pre>\n"}], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4654, "favorite_count": 2, "accepted_answer_id": 29538616, "answer_count": 2, "score": 8, "last_activity_date": 1495419553, "creation_date": 1428582650, "last_edit_date": 1432627109, "question_id": 29538549, "link": "https://stackoverflow.com/questions/29538549/haskell-ghci-lambda-symbol-in-prompt", "title": "Haskell ghci lambda symbol in prompt", "body": "<p>In Haskell ghci is it possible (and how) to get a lambda symbol in the prompt, for instance like this </p>\n\n<pre><code>\u03bb&gt; \n</code></pre>\n\n<p>Using Linux Ubuntu terminal.</p>\n"}]