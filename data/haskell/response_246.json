[{"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569447954, "post_id": 58106822, "comment_id": 102604514, "body": "Could you explain a bit more explicitly how that theorem applies here?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1569451441, "post_id": 58106822, "comment_id": 102605383, "body": "I added an explicit derivation"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569475855, "post_id": 58106822, "comment_id": 102610147, "body": "Many thanks! I didn&#39;t think to reframe the type as <code>ReaderT</code>; that makes perfect sense now. I still don&#39;t feel like I <i>really</i> understand this stuff, but at least I can follow it."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 8, "last_activity_date": 1569503629, "last_edit_date": 1569503629, "creation_date": 1569447262, "answer_id": 58106822, "question_id": 58105759, "link": "https://stackoverflow.com/questions/58105759/monadbasecontrol-laws/58106822#58106822", "title": "MonadBaseControl laws", "body": "<p>That's an immediate consequence of the free theorem of the type of <code>liftBaseWith</code>.</p>\n\n<p>A simplified version of the \"free theorem theorem\" which is sufficient to generate a version of such a free theorem is:</p>\n\n<p>Any function <code>f :: forall a. F a -&gt; G a</code> where <code>F</code> and <code>G</code> are functors, satisfies, for any types <code>a</code>,<code>b</code>, and any function <code>phi :: a -&gt; b</code>,</p>\n\n<pre><code>fmap phi . f = f . fmap phi  -- simplified \"free theorem\" for f\n</code></pre>\n\n<p>(in other words, that equation holds whenever it typechecks.)</p>\n\n<p>I don't have a proof offhand, but I'd be extremely surprised if there is a counterexample.</p>\n\n<h3>Application</h3>\n\n<p>In this case <code>f</code> is <code>liftBaseWith</code>, where the functors are</p>\n\n<pre><code>F a = RunInBase m b -&gt; b a  -- F = ReaderT (RunInBase m b) b\nG a = m a\n</code></pre>\n\n<p>Apply both sides of the \"free theorem\" above to <code>q</code>, unfold the definition of <code>fmap</code> for <code>ReaderT</code>:</p>\n\n<pre><code>(fmap phi . liftBaseWith) q = (liftBaseWith . fmap phi) q\nfmap phi (liftBaseWith q) = liftBaseWith (fmap phi q)\nfmap phi (liftBaseWith q) = liftBaseWith \\run -&gt; fmap phi (q run)\n</code></pre>\n\n<h3>Relevant literature</h3>\n\n<p>As a starting point to read up on the topic, there's of course the paper <em>Theorems for free!</em> by Philip Wadler, and another closely related one <a href=\"https://www.janis-voigtlaender.eu/papers/FreeTheoremsInvolvingTypeConstructorClasses.pdf\" rel=\"nofollow noreferrer\"><em>Free theorems involving type constructor classes</em></a> by Janis Voigtlander.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 58106822, "answer_count": 1, "score": 16, "last_activity_date": 1569503629, "creation_date": 1569441497, "last_edit_date": 1569444158, "question_id": 58105759, "link": "https://stackoverflow.com/questions/58105759/monadbasecontrol-laws", "title": "MonadBaseControl laws", "body": "<p>The <a href=\"http://hackage.haskell.org/package/monad-control-1.0.2.3/docs/Control-Monad-Trans-Control.html#t:MonadBaseControl\" rel=\"noreferrer\"><code>MonadBaseControl</code> class</a> offers very few laws. To get <a href=\"https://github.com/ekmett/free/issues/193\" rel=\"noreferrer\">something I want</a>, I need one more:</p>\n\n<pre><code>forall f q. f &lt;$&gt; liftBaseWith q\n  = liftBaseWith $ \\runInBase -&gt; fmap f (q runInBase)\n</code></pre>\n\n<p>My extremely vague intuition suggests this is natural (in some sense) and that it might even follow from some combination of the <code>Functor</code> laws, parametricity, and the documented <code>MonadBaseControl</code> laws. Is this so? If not, are there any \"reasonable\" instances that disobey the law?</p>\n\n<p>Note: I've also asked an abbreviated version of this question <a href=\"https://github.com/basvandijk/monad-control/issues/48\" rel=\"noreferrer\">as a GitHub issue</a>.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1569441218, "last_edit_date": 1569441218, "creation_date": 1569437998, "answer_id": 58104968, "question_id": 58104887, "link": "https://stackoverflow.com/questions/58104887/what-does-this-error-message-unexpected-do-block-in-function-application-mean/58104968#58104968", "title": "What does this error message &quot; Unexpected do block in function application&quot; mean?", "body": "<p>The indentation is not entirely correct, and as a result the compiler parses this as if the <code>do</code> is only applied to the <code>c &lt;- readFile fromFile</code>, and not to the <code>writeFile</code>.</p>\n\n<pre><code>copyFile :: FilePath -&gt; FilePath -&gt; IO()\ncopyFile fromFile toFile = do\n    c &lt;- readFile fromFile\n    writeFile toFile c</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>copyFile :: FilePath -&gt; FilePath -&gt; IO()\ncopyFile fromFile toFile = readFile fromFile &gt;&gt;= writeFile toFile</code></pre>\n\n<p>That being said, I strongly recommend to use <a href=\"https://hackage.haskell.org/package/directory-1.3.4.0/docs/System-Directory.html#v:copyFile\" rel=\"nofollow noreferrer\"><strong><code>copyFile :: FilePath -&gt; FilePath -&gt; IO ()</code></strong></a> or <a href=\"https://hackage.haskell.org/package/directory-1.3.4.0/docs/System-Directory.html#v:copyFileWithMetadata\" rel=\"nofollow noreferrer\"><strong><code>copyFileWithMetadata :: FilePath -&gt; FilePath -&gt; IO ()</code></strong></a> instead. That way you do not load the content of the file in memory (the file might be larger than the amount of available memory). Some file systems could improve the efficiency significantly, for example by only adding an extra reference to the file, and making a real copy in case one of the two files is modified.</p>\n"}], "owner": {"reputation": 13, "user_id": 12121011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34f93c747461c974ee4d0339a82bde26?s=128&d=identicon&r=PG&f=1", "display_name": "NM00", "link": "https://stackoverflow.com/users/12121011/nm00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2630, "favorite_count": 0, "accepted_answer_id": 58104968, "answer_count": 1, "score": 1, "last_activity_date": 1569441218, "creation_date": 1569437627, "last_edit_date": 1569437675, "question_id": 58104887, "link": "https://stackoverflow.com/questions/58104887/what-does-this-error-message-unexpected-do-block-in-function-application-mean", "title": "What does this error message &quot; Unexpected do block in function application&quot; mean?", "body": "<p>I'm trying to compile this function but I get an error. What is it that Haskell is not happy about?</p>\n\n<pre><code>copyFile :: FilePath -&gt;  FilePath -&gt; IO()\ncopyFile fromFile toFile = \n     do c &lt;- readFile fromFile\n    writeFile toFile c \n</code></pre>\n\n<p>Unexpected do block in function application:\n        do c &lt;- readFile fromFile\n    You could write it with parentheses\n    Or perhaps you meant to enable BlockArguments?</p>\n"}, {"tags": ["haskell", "servant", "haskell-wai"], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1570454099, "creation_date": 1570454099, "answer_id": 58270350, "question_id": 58104872, "link": "https://stackoverflow.com/questions/58104872/improper-route-construction-with-servant-and-raw-wai-directoryserver/58270350#58270350", "title": "Improper route construction with Servant and Raw WAI directoryServer", "body": "<p>File this one under \"user error\".</p>\n\n<blockquote>\n  <p>When I navigate to my page, e.g.</p>\n\n<pre><code>localhost:8081/myRoute\n</code></pre>\n</blockquote>\n\n<p>Note the lack of trailing slash. The root of the served directory is at </p>\n\n<pre><code>localhost:8081/myRoute/\n</code></pre>\n\n<p>When I navigate there, it all works as expected. This is almost too embarrassing to post, but hopefully I can save someone from wasting as much time as I did on this.</p>\n"}], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570454099, "creation_date": 1569437560, "question_id": 58104872, "link": "https://stackoverflow.com/questions/58104872/improper-route-construction-with-servant-and-raw-wai-directoryserver", "title": "Improper route construction with Servant and Raw WAI directoryServer", "body": "<p>As part of a Haskell Servant project, I'm trying to provide a directory server as an endpoint, i.e.</p>\n\n<pre><code> type DirServe = Capture \"route\" Text :&gt; Raw\n</code></pre>\n\n<p>When I navigate to my page, e.g.</p>\n\n<pre><code>localhost:8081/myRoute\n</code></pre>\n\n<p>Which is serving</p>\n\n<pre><code> myDir/\n   fileA\n   fileB\n</code></pre>\n\n<p>I see the page with <code>fileA</code> and <code>fileB</code> listed in a table like expected. The problem, however, is when I click on <code>fileA</code> (for example) I am redirected to </p>\n\n<pre><code>localhost:8081/fileA\n</code></pre>\n\n<p>and a 404 error. If however I manually enter the correct address,</p>\n\n<pre><code>localhost:8081/myRoute/fileA\n</code></pre>\n\n<p>I am rewarded with <code>fileA</code>. So how do I tell Servant or Network.Wai.Application to prefix the paths in the directory server?</p>\n\n<hr>\n\n<p>Further information. The app also fails when I use a static route instead of a capture:</p>\n\n<pre><code>type DirServe = \"myRoute\" :&gt; Raw\n</code></pre>\n\n<p>If I use the root route, however, the handler works as expected. </p>\n\n<pre><code>type DirServe = Raw\n</code></pre>\n\n<hr>\n\n<p>SimpleDirServer.hs</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE NamedFieldPuns #-}\n{-# LANGUAGE OverloadedStrings #-}\n-- {-# LANGUAGE FlexibleContexts #-}\n\nmodule Main (main) where\n\nimport Servant\nimport Network.Wai.Handler.Warp\nimport Network.Wai.Application.Static\n-- import WaiAppStatic.Storage.Filesystem\n-- import WaiAppStatic.Types\nimport Data.Text\n\nimport Options.Applicative\nimport Data.Semigroup ((&lt;&gt;))\n\ndata Env = Env\n { channelPort :: Int\n , channelFilePath :: FilePath\n , routeRoot :: Text\n } deriving Show\n\ntype DirServe = Capture \"route\" Text :&gt; Raw\n\nmain :: IO ()\nmain = do\n  env@Env { channelPort, channelFilePath, routeRoot } &lt;- getEnv\n  print env\n  run channelPort . serve (Proxy @DirServe)\n                  $ serveAtRoute channelFilePath routeRoot\n  where\n    serveAtRoute :: FilePath -&gt; Text -&gt; Text -&gt; Tagged Handler Application\n    serveAtRoute fp root rt | rt == root =\n        serveDirectoryWith (mySettings fp $ rt)\n                   | otherwise  = error \"not found\"\n    mySettings fp rt = defaultFileServerSettings fp\n      -- Previous attempt to manually prefix route...\n      -- let ss = defaultFileServerSettings fp\n      --     rd = ssMkRedirect ss\n      -- in ss{ssMkRedirect = \\ps -&gt; maybe (rd ps) (\\p -&gt; rd (p:ps)) $ toPiece rt}\n\n    -- Just Options parsing\n    getEnv = execParser $ info (doOpts &lt;**&gt; helper) thisDesc\n    thisDesc = fullDesc\n            &lt;&gt; progDesc \"Simple Directory Server\"\n            &lt;&gt; header \"pkgs\"\n    doOpts = Env &lt;$&gt; doPort &lt;*&gt; doFilePath &lt;*&gt; doRouteRoot\n    doPort = option auto $\n      long \"port\" &lt;&gt; short 'p' &lt;&gt; metavar \"INT\" &lt;&gt;\n      help \"Port.\"  &lt;&gt;\n      value 8081 &lt;&gt; showDefault\n    doFilePath = strOption $\n      long \"dir\" &lt;&gt; short 'd' &lt;&gt; metavar \"PATH\" &lt;&gt;\n      help \"Directory to serve.\" &lt;&gt;\n      value \"/var/lib/serve\"\n    doRouteRoot = strOption $\n      long \"route\" &lt;&gt; short 'r' &lt;&gt; metavar \"ROUTE\" &lt;&gt;\n      help \"The URL \\\"Path\\\" component.\" &lt;&gt;\n      value \"\"\n</code></pre>\n\n<hr>\n\n<p>simpleDirServer.cabal</p>\n\n<pre><code>cabal-version:       2.0\nname:                simpleDirServer\nversion:             0.1.0.1\nsynopsis:            Serves a directory\n-- description:\n-- bug-reports:\nlicense:             BSD3\ncategory:            Distribution\nbuild-type:          Simple\nextra-source-files:  CHANGELOG.md\n\nexecutable simpleDirServer\n  main-is:            SimpleDirServer.hs\n  ghc-options:\n    -O2\n    -threaded\n    -rtsopts\n    \"-with-rtsopts=-N\"\n  -- exposed-modules:\n  -- other-modules:\n  -- other-extensions:\n  build-depends:       base ^&gt;=4.12.0.0,\n                       servant-server,\n                       warp,\n                       bytestring,\n                       text,\n                       optparse-applicative,\n                       wai-app-static\n                       -- mtl\n  hs-source-dirs:      src\n  default-language:    Haskell2010\n</code></pre>\n"}, {"tags": ["haskell", "conduit"], "comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1569445297, "post_id": 58104485, "comment_id": 102603694, "body": "I&#39;d still like to know how to implement this using <code>await</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 0, "last_activity_date": 1569604779, "last_edit_date": 1569604779, "creation_date": 1569531153, "answer_id": 58124628, "question_id": 58104485, "link": "https://stackoverflow.com/questions/58104485/how-to-implement-a-takewhile-like-function-using-conduit-combinators/58124628#58124628", "title": "How to implement a takeWhile-like function using Conduit combinators?", "body": "<p>I came to the eventual conclusion that, if I wanted to implement this component, <a href=\"https://stackoverflow.com/questions/58107971/why-is-there-an-unexpected-expected-type-of-in-this-conduit-composition-fu/58124544#58124544\">I couldn't do it in terms of component composition</a> (fusion).</p>\n\n<p>Here's an implementation that seems to work:</p>\n\n<pre><code>takeWhileGrouped :: forall m mono. Monad m =&gt;\n  [Element mono -&gt; Bool] -&gt; ConduitT (Element mono) [Element mono] m ()\ntakeWhileGrouped preds = start\n  where\n    start = await &gt;&gt;= maybe (return ()) (loop preds [])\n    loop :: [(Element mono) -&gt; Bool] -&gt; [Element mono] -&gt; (Element mono)\n      -&gt; ConduitT (Element mono) [Element mono] m ()\n    loop [] _ _ = yield []\n    loop curPreds@(predF:predRest) accum x =\n        await &gt;&gt;= maybe (yield accumX) go\n      where\n        accumX = if predF x then x:accum else accum\n        go y = if predF y then loop curPreds accumX y\n               else yield accumX &gt;&gt; loop predRest [] y\n</code></pre>\n\n<p>This design was influenced by the most similar function I knew of (though from a deprecated library), <a href=\"https://hackage.haskell.org/package/conduit-1.3.1.1/docs/src/Data.Conduit.List.html#groupBy\" rel=\"nofollow noreferrer\">groupBy</a>.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569604779, "creation_date": 1569435909, "last_edit_date": 1569440805, "question_id": 58104485, "link": "https://stackoverflow.com/questions/58104485/how-to-implement-a-takewhile-like-function-using-conduit-combinators", "title": "How to implement a takeWhile-like function using Conduit combinators?", "body": "<p>I'm trying to implement a function that combines the ideas of <code>groupBy</code> and <code>takeWhile</code>, as well as uses the latter internally. Specifically, it will group all elements that consecutively return <code>True</code> on the current predicate as a list, then it will proceed to do the same with the next predicate, and so on:</p>\n\n<pre><code>   takeWhileGrouped :: (Monad m, MonoFoldable mono) =&gt;\n      ([Element mono -&gt; Bool]) -&gt; ConduitT (Element mono) [Element mono] m ()\n    takeWhileGrouped preds = go preds\n      where\n        go (pred:nextPreds) = yield (goIter pred) &gt;&gt; go nextPreds\n        goIter pred = takeWhile pred .| sinkList\n</code></pre>\n\n<p>It's entirely likely this implementation suffers other issues, but at this stage I'm getting a compilation error that I'm not sure how to proceed with (why can't <code>mono0</code> be identified with <code>mono</code>?); is this due to the lack of using some language extension, or is there another issue?</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018Element mono0\u2019 with \u2018Element mono\u2019\n      Expected type: [Element mono -&gt; Bool]\n                     -&gt; ConduitT (Element mono) [Element mono] m ()\n        Actual type: [Element mono0 -&gt; Bool]\n                     -&gt; ConduitT (Element mono0) [Element mono0] m ()\n      NB: \u2018Element\u2019 is a non-injective type family\n      The type variable \u2018mono0\u2019 is ambiguous\n    \u2022 In the ambiguity check for \u2018takeWhileGrouped\u2019\n      To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n      In the type signature:\n        takeWhileGrouped :: (Monad m, MonoFoldable mono) =&gt;\n                            ([Element mono -&gt; Bool])\n                            -&gt; ConduitT (Element mono) [Element mono] m ()\n    |\n140 | takeWhileGrouped :: (Monad m, MonoFoldable mono) =&gt;\n    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^...\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>Enabling <code>AllowAmbiguousTypes</code> does make the error go away, but I'll note that in <a href=\"https://hackage.haskell.org/package/conduit-1.3.1.1/docs/src/Data.Conduit.Combinators.html\" rel=\"nofollow noreferrer\">the combinators library</a> this appears to be unnecessary.</p>\n\n<p>Now the real issues show themselves:</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018ConduitT a0 c0 m0 [b0]\u2019\n                     with \u2018[Element mono]\u2019\n      Expected type: ConduitT (Element mono) [Element mono] m ()\n        Actual type: ConduitT\n                       (Element seq0) (ConduitM a0 c0 m0 [b0]) m ()\n    \u2022 In the expression: go preds\n      In an equation for \u2018takeWhileGrouped\u2019:\n          takeWhileGrouped preds\n            = go preds\n            where\n                go (pred : nextPreds) = yield (goIter pred) &gt;&gt; go nextPreds\n                goIter pred = takeWhile pred .| sinkList\n    \u2022 Relevant bindings include\n        preds :: [Element mono -&gt; Bool]\n          (bound at src/FDS/Data/Conduits.hs:143:18)\n        takeWhileGrouped :: [Element mono -&gt; Bool]\n                            -&gt; ConduitT (Element mono) [Element mono] m ()\n          (bound at src/FDS/Data/Conduits.hs:143:1)\n    |\n143 | takeWhileGrouped preds = go preds\n    |                          ^^^^^^^^\n\n\n    \u2022 Couldn't match type \u2018seq -&gt; seq\u2019 with \u2018ConduitT a b m1 ()\u2019\n      Expected type: ConduitM a b m1 ()\n        Actual type: seq -&gt; seq\n    \u2022 Probable cause: \u2018takeWhile\u2019 is applied to too few arguments\n      In the first argument of \u2018(.|)\u2019, namely \u2018takeWhile pred\u2019\n      In the expression: takeWhile pred .| sinkList\n      In an equation for \u2018goIter\u2019:\n          goIter pred = takeWhile pred .| sinkList\n    \u2022 Relevant bindings include\n        pred :: Element seq -&gt; Bool\n          (bound at src/FDS/Data/Conduits.hs:146:12)\n        goIter :: (Element seq -&gt; Bool) -&gt; ConduitM a c m1 [b]\n          (bound at src/FDS/Data/Conduits.hs:146:5)\n    |\n146 |     goIter pred = takeWhile pred .| sinkList\n    |                   ^^^^^^^^^^^^^^\n</code></pre>\n\n<p><strong>Update 2</strong> </p>\n\n<p>I was using the wrong <code>takeWhile</code>, now using <code>CC.takeWhile</code> from Conduit Cominators, I'm currently left with:</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018ConduitT\n                             (Element mono) c0 m0 [Element mono]\u2019\n                     with \u2018[Element mono]\u2019\n      Expected type: ConduitT (Element mono) [Element mono] m ()\n        Actual type: ConduitT\n                       (Element mono) (ConduitM (Element mono) c0 m0 [Element mono]) m ()\n    \u2022 In the expression: go preds\n      In an equation for \u2018takeWhileGrouped\u2019:\n          takeWhileGrouped preds\n            = go preds\n            where\n                go (pred : nextPreds) = yield (goIter pred) &gt;&gt; go nextPreds\n                goIter pred = CM.takeWhile pred .| sinkList\n    \u2022 Relevant bindings include\n        preds :: [Element mono -&gt; Bool]\n          (bound at src/FDS/Data/Conduits.hs:144:18)\n        takeWhileGrouped :: [Element mono -&gt; Bool]\n                            -&gt; ConduitT (Element mono) [Element mono] m ()\n          (bound at src/FDS/Data/Conduits.hs:144:1)\n    |\n144 | takeWhileGrouped preds = go preds\n    |                          ^^^^^^^^\n\n\n</code></pre>\n\n<p><strong>Update 3</strong></p>\n\n<p>Had a few combinator API issues to fix, but at least one still remains:</p>\n\n<pre><code>takeWhileGrouped :: forall m mono. (Monad m, MonoFoldable mono) =&gt;\n  ([Element mono -&gt; Bool]) -&gt; ConduitT (Element mono) [Element mono] m ()\ntakeWhileGrouped preds = go preds\n  where\n    go (pred:nextPreds) = yieldM (goIter pred) &gt;&gt; go nextPreds\n    go [] = yield []\n    goIter :: (Element mono -&gt; Bool) -&gt; m ([Element mono])\n    goIter pred = (CC.takeWhile pred) .| sinkList &amp; runConduitRes\n</code></pre>\n\n<p>Unexpectedly, I have a <code>()</code> popping up in the input to <code>takeWhile</code>:</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018Element mono\u2019 with \u2018()\u2019\n      Expected type: () -&gt; Bool\n        Actual type: Element mono -&gt; Bool\n    \u2022 In the first argument of \u2018CC.takeWhile\u2019, namely \u2018pred\u2019\n      In the first argument of \u2018(.|)\u2019, namely \u2018(CC.takeWhile pred)\u2019\n      In the first argument of \u2018(&amp;)\u2019, namely\n        \u2018(CC.takeWhile pred) .| sinkList\u2019\n    \u2022 Relevant bindings include\n        pred :: Element mono -&gt; Bool\n          (bound at src/FDS/Data/Conduits.hs:148:12)\n        goIter :: (Element mono -&gt; Bool) -&gt; m [Element mono]\n          (bound at src/FDS/Data/Conduits.hs:148:5)\n        preds :: [Element mono -&gt; Bool]\n          (bound at src/FDS/Data/Conduits.hs:144:18)\n        takeWhileGrouped :: [Element mono -&gt; Bool]\n                            -&gt; ConduitT (Element mono) [Element mono] m ()\n          (bound at src/FDS/Data/Conduits.hs:144:1)\n    |\n148 |     goIter pred = (CC.takeWhile pred) .| sinkList &amp; runConduitRes\n    |                                 ^^^^\n</code></pre>\n\n<p><strong>Update 4</strong></p>\n\n<p>After fixing some more logic and type errors, which was really aided by adding an internal type annotation <code>(CC.takeWhile curPred :: ConduitT (Element mono) (Element mono) m ())</code>, I have something that compiles, but still needs testing:</p>\n\n<pre><code>takeWhileGrouped :: forall m mono. (Monad m, MonoFoldable mono) =&gt;\n  ([Element mono -&gt; Bool])\n  -&gt; ConduitT () (Element mono) m ()\n  -&gt; ConduitT (Element mono) [Element mono] m ()\ntakeWhileGrouped preds conIn = go preds\n  where\n    go (curPred:nextPreds) = yieldM (goIter curPred) &gt;&gt; go nextPreds\n    go [] = yield []\n    goIter :: (Element mono -&gt; Bool) -&gt; m ([Element mono])\n    goIter curPred = conIn .| CC.takeWhile curPred .| sinkList &amp; runConduit\n</code></pre>\n"}, {"tags": ["haskell", "dll"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569432603, "post_id": 58103636, "comment_id": 102598622, "body": "Haskell frequently uses list <i>fusion</i>, where in short it never constructs a list, but turns it in a looping mechanism, so avoiding the construction of <code>cons</code>, etc., Depending on the exact algorithm, it might happen that you never make a list at all, and thus that boxing/unboxing is not even relevant."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569433107, "post_id": 58103636, "comment_id": 102598841, "body": "@WillemVanOnsem The algorithm starts with an array filled with zeros, and then the cells are filled one by one, using recursion. You can see the algorithm <a href=\"http://math.mit.edu/~edelman/homepage/papers/hypers.pdf\" rel=\"nofollow noreferrer\">here, page 840</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1569434761, "post_id": 58103636, "comment_id": 102599524, "body": "Sorry to ask a triviality, but: are the different implementations actually producing the same results (modulo rounding errors)?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1569435315, "post_id": 58103636, "comment_id": 102599741, "body": "@chi Yes, perfectly the same. I have also a Julia implementation and it gives the same results as well :)"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1569446491, "post_id": 58103636, "comment_id": 102604061, "body": "Are you doing lots of concatenation of vectors?  Concating boxed vectors is a matter of allocating an array of pointers and copying the old pointers.  Concatenation of unboxed vectors involves copying the elements themselves, which is often an equal cost but can be more expensive if they are big."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1569484534, "post_id": 58103636, "comment_id": 102613983, "body": "@ThomasM.DuBuisson No. I&#39;m declaring a mutable array filled with zeros and I fill each cell with <code>writeArray</code>."}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1569432226, "creation_date": 1569432226, "question_id": 58103636, "link": "https://stackoverflow.com/questions/58103636/efficiency-of-unboxed-arrays-as-compared-to-boxed-arrays", "title": "Efficiency of unboxed arrays as compared to boxed arrays", "body": "<p>I have implemented an algorithm in <code>R</code>, in <code>Rcpp</code> (a <code>C++</code> library which allows to easily generate DLLs callable from <code>R</code>), and in Haskell (available <a href=\"https://github.com/stla/hypergeomPFQ\" rel=\"nofollow noreferrer\">here</a>). I have two different implementations in Haskell: one which uses boxed arrays and the other one uses unboxed arrays (both mutable arrays).</p>\n\n<p>Here is the expression evaluated by the algorithm:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iQQI8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iQQI8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Useless to explain this expression, this is just to show that this is a series truncated up to an integer <code>m</code>. </p>\n\n<p>I have made a DLL from the Haskell implementation which is callable from <code>R</code> (with the help of the <code>inline-r</code> library). So I can compare the speed of the four implementations in <code>R</code>. For small values of <code>m</code>, the winner is <code>C++</code>. But when I increase <code>m</code>, Haskell beats <code>C++</code>. Here is an example of benchmarks for an example with <code>m = 40</code>:</p>\n\n<pre><code>&gt; benchmarks &lt;- function(m){\n+   microbenchmark(\n+     R = R(m), # R evaluation\n+     Rcpp = Rcpp(m), # Rcpp (C++) evaluation\n+     Haskell = Haskell(m), # Haskell evaluation\n+     Haskell2 = Haskell2(m), # Haskell evaluation with unboxed arrays\n+     times = 2\n+   )\n+ }\n&gt; benchmarks(40L)\nUnit: seconds\n     expr        min         lq       mean     median         uq        max neval  cld\n        R 100.923679 100.923679 100.948899 100.948899 100.974118 100.974118     2    d\n     Rcpp  27.207624  27.207624  27.252485  27.252485  27.297347  27.297347     2   c \n  Haskell   6.981935   6.981935   7.147086   7.147086   7.312237   7.312237     2 a   \n Haskell2   8.447389   8.447389   8.629766   8.629766   8.812144   8.812144     2  b  \n</code></pre>\n\n<p>One says that unboxed arrays are more efficient than boxed arrays. However this is not the case here, as you can see. </p>\n\n<p>What is the reason for that ? Is there a GHC option to turn on in order to benefit from the efficiency of the unboxed arrays ? I'm making my DLLs with the default settings of <code>foreign-library</code> in the <code>cabal</code> file:</p>\n\n<pre><code>foreign-library Hypergeom\n  buildable:           True\n  type:                native-shared\n  if os(Windows)\n    options: standalone\n  other-modules:       HyperGeomR\n  build-depends:       base &gt;=4.7 &amp;&amp; &lt; 5\n                     , hypergeomPFQ\n                     , inline-r\n  hs-source-dirs:      src-dll\n  c-sources:           StartEnd.c\n  default-language:    Haskell2010\n</code></pre>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 3, "creation_date": 1569425807, "post_id": 58101852, "comment_id": 102595554, "body": "Have you looked at the full text of the &quot;Illegal instance declaration&quot; error? What is it?"}, {"owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1569430694, "post_id": 58101852, "comment_id": 102597794, "body": "Yes you&#39;re right I didn&#39;t read to the end GHC gives a hint  &quot;Use FlexibleInstances if you want to disable this&quot;... my fault. Question 1 remains - in my first attempt I declare the instances as it, without derivation and GHC wasn&#39;t happy."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1569430813, "post_id": 58101852, "comment_id": 102597859, "body": "Once again: how is GHC &quot;not happy&quot;? What did it tell you?"}, {"owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1569432655, "post_id": 58101852, "comment_id": 102598642, "body": "It says <i>all instances types must be of the form (T a1 .... an) etc... etc.. and each type variable appears at most once in the instance head. Use FlexibleInstances if you want to disble this</i> I will just add that this pragma wasn&#39;t in the original code..."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1569433502, "post_id": 58101852, "comment_id": 102598988, "body": "That&#39;s now what I meant. When you say &quot;<i>in my first attempt I declare the instances as it, without derivation and GHC wasn&#39;t happy</i>&quot;, what does &quot;not happy&quot; mean here? And in general: when asking questions on SO, it&#39;s a good idea to include error messages and other relevant info. People who answer questions can&#39;t help you if they don&#39;t know what&#39;s happening."}, {"owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1569434476, "post_id": 58101852, "comment_id": 102599413, "body": "Ok I think that I will respond to my own question, I think that the paper leads me into error first the proper pragma wasn&#39;t mentionned then Class isn&#39;t deriving Eq and class instances were, now I check that if I add Eq and remove the deriving clause it works fine... nevertheless thank for your &quot;passive&quot; help Fyodor"}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "is_accepted": false, "score": 0, "last_activity_date": 1569435004, "creation_date": 1569435004, "answer_id": 58104280, "question_id": 58101852, "link": "https://stackoverflow.com/questions/58101852/haskell-typeclasses-derivation-rules-and-class-w-o-method/58104280#58104280", "title": "Haskell TypeClasses derivation rules and class w/o method", "body": "<p>Ok folks, the issue wasn't really an issue, first I missed the GHC' hint (GHC is always for me a bit cryptic in its error message, so I'm not used to spend lot of time reading them) - I think that with this missing language pragma the code run smoothly.\nFor the ones who will try to implement the paper \n- add {-# LANGUAGE FlexibleInstances #-} then probably no message will be posted\n- if like me you go on to define the data type and method inside the class add a constraint on Eq a at the class level (the paper implements it the instances but not at the class level)</p>\n"}], "owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569435004, "creation_date": 1569425227, "question_id": 58101852, "link": "https://stackoverflow.com/questions/58101852/haskell-typeclasses-derivation-rules-and-class-w-o-method", "title": "Haskell TypeClasses derivation rules and class w/o method", "body": "<p>I try to understand more deeply the Global Variables paradigm in Haskell, I took to work on <a href=\"https://kodu.ut.ee/~nestra/eng/splst11.pdf\" rel=\"nofollow noreferrer\">https://kodu.ut.ee/~nestra/eng/splst11.pdf</a>, as an exercise. First thing I did is rewrite some of the code in 2.1 - The library module :\nchanged this</p>\n\n<pre><code>data family Var a :: *    -- family declaration\nclass (Show l, Ord l) =&gt; Variable l where    -- Class w/o method\n</code></pre>\n\n<p>to</p>\n\n<pre><code>class (Show l, Ord l, Eq l) =&gt; Variable l where\n    data Var l :: *\n</code></pre>\n\n<p>This should have the same meaning (my guess..) with the original code GHC complains further in compiling. Nevertheless the curious thing (for me) was that GHC complains if a class instance is not declared with an explicit deriving clause (my first attempt, it looks redundant:</p>\n\n<pre><code>instance Variable Integer where \n    data Var Integer = X | Y deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>Questions:</p>\n\n<ol>\n<li>Isn't the derivation part of the inherited class \"property\" - I expected not to repeat this in the class instances.</li>\n<li>Is it possible to write in the same style as the paper w/o GHC complaining of a <code>Illegal instance declaration for `Variable (Var Int)'</code> on the line with <code>instance Variable (Var Int)</code> may be it's old style haskell (GHC98)? To avoid this I had to declare the class differently.</li>\n</ol>\n"}, {"tags": ["list", "haskell", "tuples", "cartesian-product"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 6, "creation_date": 1569394811, "post_id": 58092637, "comment_id": 102578097, "body": "It is not quite clear to me what your idea is so I cannot tell where exactly it goes wrong. There is about a zillion way to do this, the simplest one probably being list comprehension <code>rolls = [(fst,snd) | fst &lt;- fstDice, snd &lt;- sndDice]</code>."}, {"owner": {"reputation": 398, "user_id": 10412159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7782a6cbe4dca019ebe564903960341a?s=128&d=identicon&r=PG&f=1", "display_name": "larn", "link": "https://stackoverflow.com/users/10412159/larn"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1569394989, "post_id": 58092637, "comment_id": 102578183, "body": "@n.m. Ooooh, I see. That makes a lot more sense! I tend to have the problem of overthinking very simple problems like this one, unfortunately. Your solution is a lot simpler and makes a ton more sense. Thanks for the tip!"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1569395178, "post_id": 58092637, "comment_id": 102578270, "body": "If you\u2019re interested, another way to do it is <code>(,) &lt;$&gt; list1 &lt;*&gt; list2</code>. This uses <i>applicative functors</i>, if you haven\u2019t encountered them before."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1569395528, "post_id": 58092637, "comment_id": 102578448, "body": "fyi, with MonadComprehensions, the two code snippets proposed in the comments above are equivalent."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1569396546, "post_id": 58092637, "comment_id": 102578923, "body": "@larn simplicity is only easy in retrospect, and is usually only found after a lot of overthinking"}], "answers": [{"comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1569401046, "post_id": 58093381, "comment_id": 102581261, "body": "I would upvote twice, if I could. In particular I found the other ways of writing it quite educational!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1569405836, "post_id": 58093381, "comment_id": 102583968, "body": "@MichaWiedenmann thanks! I&#39;m glad it helps. :) (btw I proposed once, on meta, the ability to up/down vote multiple times in exchange for some reputation deduction, and was downvoted into the ground. :) )"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 6, "last_activity_date": 1609517251, "last_edit_date": 1609517251, "creation_date": 1569396917, "answer_id": 58093381, "question_id": 58092637, "link": "https://stackoverflow.com/questions/58092637/zipping-in-haskell/58093381#58093381", "title": "Zipping in Haskell", "body": "<p>When you're first starting learning recursive programming / Haskell, there's value in coding a solution by hand. You can learn the juggling of primitives later, when you've internalized the various patterns captured by them.</p>\n<pre><code>rolls []     _  = []\nrolls (x:xs) ys = foo ys            -- for x in (x:xs),\n    where\n    foo (y:ys) = (x,y) : foo ys     -- for each y in ys\n    foo []     = rolls xs ys        -- for the rest of x in xs, with the same ys\n</code></pre>\n<p>This combines the two lists as a matrix, tracing it row-by-row:</p>\n<pre><code>                  e      f      g    ....      -- ys\n x1:    a      (a,e)  (a,f)  (a,g)   ....\n x2:    b      (b,e)  (b,f)  (b,g)   ....\n x3:    c      (c,e)  (c,f)  (c,g)   ....\n x4:    d      (d,e)  (d,f)  (d,g)   ....\n        .      ........................\n        .      ........................\n</code></pre>\n<p>So yes, your idea was more or less in the right direction, except that it's not  <code>zip</code> that's the right tool there, but <code>map</code>. Other ways of writing this are:</p>\n<pre><code>rolls xs ys = concat (map (\\ x -&gt; map (x ,)         ys)        xs)\n            = concat [                [(x,y) | y &lt;- ys] | x &lt;- xs ]\n            = [ r     | x &lt;- xs, r &lt;- [(x,y) | y &lt;- ys] ]\n            = [ (x,y) | x &lt;- xs,               y &lt;- ys  ]\n            = [  x y  | x &lt;- map (,) xs,       y &lt;- ys  ]\n            =   (&lt;*&gt;)      (fmap (,) xs)            ys      -- apA\n            = liftA2             (,) xs             ys \n</code></pre>\n<p>so it's just a Cartesian product, or kind of an outer product, of the two lists.</p>\n<p>This kind of &quot;square&quot; / 2D match-up is contrasted with</p>\n<pre><code>zip xs ys = zipWith             (,)          xs           ys \n          = getZipList $ liftA2 (,) (ZipList xs) (ZipList ys)\n          = [                  (x,y) |  x &lt;- xs  |   y &lt;- ys ]\n                           -- with Parallel List Comprehensions\n</code></pre>\n<p>which combines its two argument lists by a &quot;linear&quot;  match-up, reminiscent of an inner product.</p>\n<p>But also</p>\n<pre><code>rolls xs ys = concat        [         [(x,y) | y &lt;- ys] | x &lt;- xs ]\n            = fold          [         [(x,y) | y &lt;- ys] | x &lt;- xs ]\n            = foldr (++) [] [         [(x,y) | y &lt;- ys] | x &lt;- xs ]\n            = foldr ($)     [   ( [(x,y) | y &lt;- ys] ++) | x &lt;- xs ]  []\n</code></pre>\n<p>since</p>\n<pre><code>foldr f z xs = foldr (($) . f) z xs \n             = foldr ($) z (map f xs) \n             = f x1 (f x2 (f x3 (... (f xn z)...)))\n        {-   = foldr (.) id (map f xs) z\n             = foldr ((.) . f) id xs z\n             = foldr ((.) . f) (const z) xs ()\n             = f x1 . f x2 . f x3 . ... . f xn . const z $ ()  -}\n</code></pre>\n<p>In the case of infinite lists though, do consult the answers <a href=\"https://stackoverflow.com/q/20516402/849891\">here</a> and <a href=\"https://stackoverflow.com/q/4119730/849891\">here</a>, <a href=\"https://stackoverflow.com/search?q=dovetailing%20%5Bhaskell%5D\">these posts</a>, etc..</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1569398952, "creation_date": 1569398952, "answer_id": 58093954, "question_id": 58092637, "link": "https://stackoverflow.com/questions/58092637/zipping-in-haskell/58093954#58093954", "title": "Zipping in Haskell", "body": "<p>That's not zipping, since zipping means you iterate <em>concurrently</em> over the two lists. You here want to produce a tuple for every item in the first list, and every item in the second list.</p>\n\n<p>We can handle that by making use of the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--36--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> and the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--42--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a>. A list is both a member of the <code>Functor</code> and <code>Applicative</code> typeclass. So for a list <code>(&lt;$&gt;)</code> is the same as map, and for a list <code>(&lt;*&gt;) :: [a -&gt; b] -&gt; [a] -&gt; [b]</code> will take every function from the first list, and every value from the second list, and apply the function to that item in the new list.</p>\n\n<p>We thus can implement the <code>rolls</code> as:</p>\n\n<pre><code>rolls :: (Num a, Enum a, Num b, Enum b) =&gt; [(a,b)]\nrolls = (,) <b>&lt;$&gt;</b> [1 .. 6] <b>&lt;*&gt;</b> [1 .. 6]</code></pre>\n"}], "owner": {"reputation": 398, "user_id": 10412159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7782a6cbe4dca019ebe564903960341a?s=128&d=identicon&r=PG&f=1", "display_name": "larn", "link": "https://stackoverflow.com/users/10412159/larn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "closed_date": 1569425121, "accepted_answer_id": 58093381, "answer_count": 2, "score": 3, "last_activity_date": 1609517251, "creation_date": 1569394285, "last_edit_date": 1569405578, "question_id": 58092637, "link": "https://stackoverflow.com/questions/58092637/zipping-in-haskell", "closed_reason": "Duplicate", "title": "Zipping in Haskell", "body": "<p>I'm working on a function that will take two six-sided dice and return every possibility of pairs in a list of tuples. </p>\n\n<p>So, I'd like my program to return something like: </p>\n\n<pre><code>[(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),\n (2,1),(2,2),(2,3),(2,4),(2,5),(2,6),\n (3,1),(3,2),(3,3),(3,4),(3,5),(3,6),\n (4,1),(4,2),(4,3),(4,4),(4,5),(4,6),\n (5,1),(5,2),(5,3),(5,4),(5,5),(5,6),\n (6,1),(6,2),(6,3),(6,4),(6,5),(6,6)]\n</code></pre>\n\n<p>I think my head might be in the right general area, but I'm having a little trouble executing it, since I am new to Haskell. Here's what I have: </p>\n\n<pre><code>rolls :: [(Integer, Integer)]\nfstDice = [1, 2, 3, 4, 5, 6]\nsndDice = [1, 2, 3, 4, 5, 6]\nrolls\n    | zip fstDice sndDice\n    | drop 1 sndDice\n    | otherwise = rolls \n</code></pre>\n\n<p>I know that last part is <em>very</em> wrong, trust me. I was using <code>zip</code> to put the two dice together, then my thought was to drop the <code>head</code> off of the second dice, and repeat that process until <code>sndDice</code> is empty and until all the pairs are found. </p>\n\n<p>I'm not sure if this idea is wrong, or if it's just my incorrect amateur execution. </p>\n\n<p>(And for the record, I know this doesn't compile! I'm not sure what to do about the error either.)</p>\n"}, {"tags": ["list", "haskell", "recursion", "merge", "tail-recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569362440, "post_id": 58088657, "comment_id": 102570596, "body": "Related: <a href=\"https://wiki.haskell.org/Tail_recursion\" rel=\"nofollow noreferrer\">wiki.haskell.org/Tail_recursion</a>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1569363946, "post_id": 58088657, "comment_id": 102570996, "body": "Take particular note of &quot;guarded recursion&quot; in WillemVanOnsem&#39;s link. Your <code>merge2</code> function isn&#39;t tail-recursive, but all its recursion is guarded recursion, which is typically more important in Haskell."}], "answers": [{"tags": [], "owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "is_accepted": false, "score": 5, "last_activity_date": 1570871711, "last_edit_date": 1570871711, "creation_date": 1569380329, "answer_id": 58090561, "question_id": 58088657, "link": "https://stackoverflow.com/questions/58088657/how-to-make-a-tail-recursive-function/58090561#58090561", "title": "How to make a tail recursive function", "body": "<p>Your function isn't tail-recursive; it's guarded recursive. However, guarded recursion is what you should be using in Haskell if you want to be memory efficient.</p>\n\n<p>For a call to be a tail call, its result must be the result of the entire function. This definition applies to both recursive and non-recursive calls. </p>\n\n<p>For example, in the code</p>\n\n<pre><code>f x y z = (x ++ y) ++ z\n</code></pre>\n\n<p>the call <code>(x ++ y) ++ z</code> is a tail call because its result is the result of the entire function. The call <code>x ++ y</code> is <em>not</em> a tail call.</p>\n\n<p>For an example of tail-recursion, consider <code>foldl</code>:</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl _ acc []     = acc\nfoldl f acc (x:xs) = foldl f (f acc x) xs\n</code></pre>\n\n<p>The recursive call <code>foldl f (f acc x) xs</code> is a tail-recursive call because its result is the result of the entire function. Thus it's a tail call, and it is recursive being a call of <code>foldl</code> to itself.</p>\n\n<p>The recursive calls in your code</p>\n\n<pre><code>merge2 (x:xs) (y:ys) = if y &lt; x then y : merge2 (x:xs) ys \n                                else x : merge2 xs (y:ys)\n</code></pre>\n\n<p>are not tail-recursive because they do not give the result of the entire function. The result of the call to <code>merge2</code> is used as a part of the whole returned value, a new list. The <code>(:)</code> constructor, not the recursive call, gives the result of the entire function. And in fact, being lazy, <code>(:) _ _</code> returns right away, and the holes <code>_</code> are filled only later, if and when needed. That's why guarded recursion is space efficient.</p>\n\n<p>However, tail-recursion doesn't guarantee space efficiency in a lazy language.\nWith lazy evaluation, Haskell builds up <em>thunks</em>, or structures in memory that represent code that is yet to be evaluated. Consider the evaluation of the following code:</p>\n\n<pre><code>foldl f 0 (1:2:3:[])\n=&gt; foldl f (f 0 1) (2:3:[])\n=&gt; foldl f (f (f 0 1) 2) (3:[])\n=&gt; foldl f (f (f (f 0 1) 2) 3) []\n=&gt; f (f (f 0 1) 2) 3\n</code></pre>\n\n<p>You can think of lazy evaluation as happening \"outside-in.\" When the recursive calls to <code>foldl</code> are evaluated, thunks are built-up in the accumulator. So, tail recursion with accumulators is not space efficient in a lazy language because of the delayed evaluation (unless the accumulator is <em>forced</em> right away, before the next tail-recursive call is made, thus preventing the thunks build-up and instead presenting the already-calculated value, in the end).</p>\n\n<p>Rather than tail recursion, you should try to use guarded recursion, where the recursive call is hidden inside a lazy data constructor. With lazy evaluation, expressions are evaluated until they are in <em>weak head normal form</em> (WHNF). An expression is in WHNF when it is either:</p>\n\n<ul>\n<li>A lazy data constructor applied to arguments (e.g. <code>Just (1 + 1)</code>)</li>\n<li>A partially applied function (e.g. <code>const 2</code>)</li>\n<li>A lambda expression (e.g. <code>\\x -&gt; x</code>)</li>\n</ul>\n\n<p>Consider <code>map</code>:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap _ []     = []\nmap f (x:xs) = f x : map f xs\n\nmap (+1) (1:2:3:[])\n=&gt; (+1) 1 : map (+1) (2:3:[])\n</code></pre>\n\n<p>The expression <code>(+1) 1 : map (+1) (2:3:[])</code> is in WHNF because of the <code>(:)</code> data constructor, and therefore evaluation stops at this point. Your <code>merge2</code> function also uses guarded recursion, so it too is space-efficient in a lazy language.</p>\n\n<p>TL;DR: In a lazy language, tail-recursion can still take up memory if it builds up thunks in the accumulator, while guarded recursion does not build up thunks.</p>\n\n<p>Helpful links:</p>\n\n<ul>\n<li><a href=\"https://wiki.haskell.org/Tail_recursion\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Tail_recursion</a></li>\n<li><a href=\"https://wiki.haskell.org/Stack_overflow\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Stack_overflow</a></li>\n<li><a href=\"https://wiki.haskell.org/Thunk\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Thunk</a></li>\n<li><a href=\"https://wiki.haskell.org/Weak_head_normal_form\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Weak_head_normal_form</a></li>\n<li><a href=\"https://stackoverflow.com/q/13042353/8887578\">Does Haskell have tail-recursive optimization?</a></li>\n<li><a href=\"https://stackoverflow.com/q/6872898/8887578\">What is Weak Head Normal Form?</a></li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 10757123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82088ad05b7850d037101ba174339232?s=128&d=identicon&r=PG&f=1", "display_name": "user234", "link": "https://stackoverflow.com/users/10757123/user234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1570871711, "creation_date": 1569362300, "last_edit_date": 1569399701, "question_id": 58088657, "link": "https://stackoverflow.com/questions/58088657/how-to-make-a-tail-recursive-function", "title": "How to make a tail recursive function", "body": "<p>I am really confused on how to make a function \"Tail recursive\".</p>\n\n<p>Here is my function, but I don't know whether it is already tail recursive or not. </p>\n\n<p>I am trying to merge two lists in Haskell.</p>\n\n<pre><code>merge2 :: Ord a =&gt;[a]-&gt;[a]-&gt;[a]\nmerge2 xs [] = xs\nmerge2 [] ys = ys\nmerge2 (x:xs)(y:ys) = if y &lt; x then y: merge2 (x:xs) ys else x :merge2 xs (y:ys)\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1569359101, "post_id": 58088102, "comment_id": 102569642, "body": "It&#39;s because recursion in your example eventually reaches <code>addNode (LEAF 4)</code> (etc), a case you haven&#39;t defined. You need a case for the <code>LEAF</code> constructor. (Btw, what is <code>createSumTree</code>? I assume this is supposed to be <code>addNode</code>. If it isn&#39;t my comment about recursion doesn&#39;t really make sense.)"}, {"owner": {"reputation": 31, "user_id": 12115542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b14d19f5c5b3a89d6f1bbc6c178408?s=128&d=identicon&r=PG&f=1", "display_name": "scx44", "link": "https://stackoverflow.com/users/12115542/scx44"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1569359854, "post_id": 58088102, "comment_id": 102569890, "body": "Got you, thanks, was trying out with helper functions as well."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1569359902, "post_id": 58088102, "comment_id": 102569902, "body": "Always turn on warnings with <code>-Wall</code>, it reports errors like this."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569434540, "post_id": 58088102, "comment_id": 102599439, "body": "There are at least two sensible meanings of &quot;each node holds the sum of child nodes&quot;. One is to define <code>val (LEAF a) = a; val (NODE a _ _) = a</code> and then demand that this function return a tree such that wherever <code>NODE a l r</code> occurs, we have <code>a = val l + val r</code>. Another -- and different! -- meaning would be to demand that the tree returned have the same shape as the original, and at each position in the new tree, all of the values that are in the subtree rooted at that position in the original tree are summed. Is it one of these (or, perhaps, even a third meaning)?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1569439917, "post_id": 58088102, "comment_id": 102601624, "body": "I made an adjust into my answer, want to check it out?"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 2, "last_activity_date": 1569439752, "last_edit_date": 1569439752, "creation_date": 1569359353, "answer_id": 58088178, "question_id": 58088102, "link": "https://stackoverflow.com/questions/58088102/give-a-tree-where-value-of-each-node-holds-the-sum-of-child-nodes/58088178#58088178", "title": "Give a tree where value of each node holds the sum of child nodes", "body": "<p>You where so close, you just need the base case, the <code>LEAF</code>:</p>\n\n<pre><code>data Tree a = LEAF a | NODE a  (Tree a)  (Tree a) deriving (Show, Read, Eq)\n\naddNode:: Num a =&gt; Tree a -&gt; Tree a\naddNode (LEAF x) = LEAF x\naddNode(NODE x left right) = NODE ((sumT left) + (sumT right)) (addNode left) (addNode right)\n\nsumT :: Num a =&gt; Tree a -&gt; a\nsumT (LEAF a) = a\nsumT (NODE _ left right) = (sumT left) + (sumT right)\n\nt1 = NODE 1 t4 t3\nt2 = NODE 3 (LEAF 4) (LEAF 5)\nt3 = NODE 7 (LEAF 8) (LEAF 9)\nt4 = NODE 2 t2 (LEAF 6)\n\nNODE 1 (NODE 2 (NODE 3 (LEAF 4) (LEAF 5)) \n               (LEAF 6))\n       (NODE 7 (LEAF 8) (LEAF 9))\n\n$&gt; addNode t1\n\nNODE 32 (NODE 15 (NODE 9 (LEAF 4) (LEAF 5)) \n                 (LEAF 6))\n        (NODE 17 (LEAF 8) (LEAF 9))\n</code></pre>\n\n<p>(In general function that work on a particular type - e.g. Tree - have to pattern match on every value constructor from that type or else Haskell will rise non-exhaustive pattern match error)</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 12115542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b14d19f5c5b3a89d6f1bbc6c178408?s=128&d=identicon&r=PG&f=1", "display_name": "scx44", "link": "https://stackoverflow.com/users/12115542/scx44"}, "edited": false, "score": 1, "creation_date": 1569360766, "post_id": 58088238, "comment_id": 102570135, "body": "Right, I was only adding <code>LEAF</code> values rather sub <code>NODE</code> and <code>LEAF</code> at the same time. thanks."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1569439859, "post_id": 58088238, "comment_id": 102601601, "body": "Willem nice answer! after thinking a little bit, I manage to do the same with an aux function! You are my inspiration by the way :D"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1569359699, "creation_date": 1569359699, "answer_id": 58088238, "question_id": 58088102, "link": "https://stackoverflow.com/questions/58088102/give-a-tree-where-value-of-each-node-holds-the-sum-of-child-nodes/58088238#58088238", "title": "Give a tree where value of each node holds the sum of child nodes", "body": "<p>We can generate a function that generates a 2-tuple where the first item is the sum of the tree, and the second item, the <code>Tree</code> itself:</p>\n\n<pre><code>addNode' :: Num a =&gt; Tree a -&gt; (a, Tree a)\naddNode' l@(LEAF x) = (x, l)\naddNode' (NODE _ a b) = (sab, NODE sab ta tb)\n    where (sa, ta) = addNode' a\n          (sb, tb) = addNode' b\n          sab = sa + sb\n</code></pre>\n\n<p>We thus should both take the <code>LEAF</code> and the <code>NODE</code> into account. Likely we need to calculate the sum recursively of the subtrees, and sum these up in the node, therefore it is more efficient to use a 2-tuple here, to store the result of the sum thus far.</p>\n\n<p>then we can define an <code>addNode</code> function that unpacks the 2-tuple and returns only the last element:</p>\n\n<pre><code>addNode :: Num a =&gt; Tree a -&gt; Tree a\naddNode = snd . addNode'\n</code></pre>\n\n<p>This thus will produce a tree like:</p>\n\n<pre><code>Prelude&gt; addNode tree1 \nNODE 32 (NODE 15 (NODE 9 (LEAF 4) (LEAF 5)) (LEAF 6)) (NODE 17 (LEAF 8) (LEAF 9))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12115542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b14d19f5c5b3a89d6f1bbc6c178408?s=128&d=identicon&r=PG&f=1", "display_name": "scx44", "link": "https://stackoverflow.com/users/12115542/scx44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1569439752, "creation_date": 1569358941, "last_edit_date": 1569359534, "question_id": 58088102, "link": "https://stackoverflow.com/questions/58088102/give-a-tree-where-value-of-each-node-holds-the-sum-of-child-nodes", "title": "Give a tree where value of each node holds the sum of child nodes", "body": "<p>trying to figure out how to make a tree where the value of each node holds the sum of child nodes</p>\n\n<pre><code>data Tree a = LEAF a | NODE a  (Tree a)  (Tree a) \n              deriving (Show, Read, Eq)\n\naddNode:: Num a =&gt; Tree a -&gt; Tree a\naddNode(NODE x (LEAF a) (LEAF b)) = (NODE (a+b)  (LEAF a) (LEAF b))\naddNode(NODE x left right) = (NODE x (addNode(left)) (addNode(right)))\n\ntree1 = NODE 1\n     (NODE 2 (NODE 3 (LEAF 4) (LEAF 5)) (LEAF 6))\n     (NODE 7 (LEAF 8) (LEAF 9))\n</code></pre>\n\n<p>When I run the code I got: </p>\n\n<pre><code>addNode tree1\nNODE 1 (NODE 2 (NODE 9 (LEAF 4) (LEAF 5)) *** Exception: testTree.hs:(105,1)-(106,89) Non-exhaustive patterns in function addNode\n</code></pre>\n\n<p>Can't figure out what's the cause, any help is much appreciated</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569357379, "post_id": 58087750, "comment_id": 102569037, "body": "Well the last clause can never fire, since the second pattern <code>toCaps xs</code> will capture all possible input."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1569360100, "post_id": 58087750, "comment_id": 102569952, "body": "Turning warnings on using <code>-Wall</code> detects this error."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569425878, "post_id": 58087750, "comment_id": 102595593, "body": "What should happen if there are leading spaces? Should <code>toCaps &quot;   hey&quot;</code> be <code>&quot;hey&quot;</code> (because <code>&#39;h&#39;</code> is the first non-space character) or <code>&quot;Hey&quot;</code> (because <code>&#39;h&#39;</code> is not the first character)?"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1569358995, "post_id": 58087859, "comment_id": 102569610, "body": "Isn&#39;t <code>go</code> just reimplementing <code>(&gt;&gt;=)</code>? <code>toCaps = (&gt;&gt;= capWord) . words</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1569359090, "post_id": 58087859, "comment_id": 102569638, "body": "@amalloy: if I read the secs correctly the first character of the first word should not be capitalized (well that is suggested by the example). So I think it is basically constructing &quot;camelCase&quot; from a given string."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569425483, "post_id": 58087859, "comment_id": 102595374, "body": "You could use <code>w++concatMap ...</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1569359301, "last_edit_date": 1569359301, "creation_date": 1569357787, "answer_id": 58087859, "question_id": 58087750, "link": "https://stackoverflow.com/questions/58087750/capitalizing-first-letter-of-words-while-removing-spaces-haskell/58087859#58087859", "title": "Capitalizing first letter of words while removing spaces (Haskell)", "body": "<p>I think it might be better if you split the problem into smaller subproblems. First we can make a function that, for a given word will capitalize the first character. For <em>camel case</em>, we thus can implement this as:</p>\n\n<pre><code>import Data.Char(toUpper)\n\ncapWord :: String -&gt; String\ncapWord \"\" = \"\"\ncapWord (c:cs) = toUpper c : cs\n</code></pre>\n\n<p>We can then use <code>words</code> to obtain the list of words:</p>\n\n<pre><code>toCaps :: String -&gt; String\ntoCaps = go . words\n    where go [] = \"\"\n          go (w:ws) = concat (w : map capWord ws)\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude Data.Char&gt; toCaps \"this is a test\"\n\"thisIsATest\"\n</code></pre>\n\n<p>For <em>Pascal case</em>, we can make use of <code>concatMap</code> instead:</p>\n\n<pre><code>toCaps :: String -&gt; String\ntoCaps = concatMap capWord . words\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1569422841, "post_id": 58088374, "comment_id": 102593784, "body": "This doesn&#39;t work right if there&#39;s ever two spaces in a row."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1569423360, "post_id": 58088374, "comment_id": 102594099, "body": "It also doesn&#39;t work right if a space is the last character."}, {"owner": {"reputation": 39, "user_id": 7672363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2878378a17c8ce211c37ceb17a4fbbfc?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Murphy", "link": "https://stackoverflow.com/users/7672363/peter-murphy"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569433048, "post_id": 58088374, "comment_id": 102598808, "body": "Thanks! Updated with a note about that."}], "tags": [], "owner": {"reputation": 39, "user_id": 7672363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2878378a17c8ce211c37ceb17a4fbbfc?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Murphy", "link": "https://stackoverflow.com/users/7672363/peter-murphy"}, "is_accepted": false, "score": 2, "last_activity_date": 1569433025, "last_edit_date": 1569433025, "creation_date": 1569360532, "answer_id": 58088374, "question_id": 58087750, "link": "https://stackoverflow.com/questions/58087750/capitalizing-first-letter-of-words-while-removing-spaces-haskell/58088374#58088374", "title": "Capitalizing first letter of words while removing spaces (Haskell)", "body": "<p>There are a number of ways of doing it, but if I were trying to keep it as close to how you've set up your example, I might do something like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Char (toUpper)\n\ntoCaps :: String -&gt; String\ntoCaps []         = []                    -- base case\ntoCaps (' ':c:cs) = toUpper c : toCaps cs -- throws out the space and capitalizes next letter\ntoCaps (c:cs)     = c : toCaps cs         -- anything else is left as is\n</code></pre>\n\n<p>This is just using basic recursion, dealing with a character (element of the list) at a time, but if you wanted to use higher-order functions such as <code>map</code> or <code>filter</code> that work on the entire list, then you would probably want to compose them (the way that Willem suggested is one way) and in that case you could probably do without using recursion at all.</p>\n\n<p>It should be noted that this solution is brittle in the sense that it assumes the input string does not contain leading, trailing, or multiple consecutive spaces.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1569438596, "post_id": 58101548, "comment_id": 102601109, "body": "using functions instead of Booleans... I expect if we use Church encoded Booleans and simplify, this is the code we&#39;d end up with! -- talking about efficiency, we can even make one more step and squash the reducer and the selector functions together, to get rid of those irritating <code>id</code>s, and end up with <i>two</i> reducer functions switching up between them. :) (only possible with <a href=\"https://stackoverflow.com/a/58048782/849891\">direct recursion</a> of course; an <i>irregular</i> pattern like that wouldn&#39;t have its own name). I&#39;ve posted it as an answer, below. (a very Prolog-ish like code, there). :)"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1569433871, "last_edit_date": 1569433871, "creation_date": 1569424162, "answer_id": 58101548, "question_id": 58087750, "link": "https://stackoverflow.com/questions/58087750/capitalizing-first-letter-of-words-while-removing-spaces-haskell/58101548#58101548", "title": "Capitalizing first letter of words while removing spaces (Haskell)", "body": "<p>Inspired by <a href=\"https://stackoverflow.com/a/57534683/7509065\">this answer from Will Ness</a>, here's a way to do it that avoids unnecessary Booleans and comparisons:</p>\n\n<pre><code>import qualified Data.Char as Char\n\ntoCaps :: String -&gt; String\ntoCaps = flip (foldr go (const [])) id\n  where go ' ' acc _ =     acc Char.toUpper\n        go x   acc f = f x:acc id\n</code></pre>\n\n<p>Or more understandably, but perhaps slightly less efficient:</p>\n\n<pre><code>import qualified Data.Char as Char\n\ntoCaps :: String -&gt; String\ntoCaps = go id\n  where go _ []       =     []\n        go _ (' ':xs) =     go Char.toUpper xs\n        go f (x  :xs) = f x:go id           xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569439480, "post_id": 58104976, "comment_id": 102601465, "body": "If a string has a single trailing space, this doesn&#39;t remove it. This looks good otherwise though!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1569440066, "post_id": 58104976, "comment_id": 102601673, "body": "huh, I tested for trailing spaces, but not for the <i>single</i> space! thanks for catching this."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569445222, "post_id": 58104976, "comment_id": 102603676, "body": "I lifted your functions out of the <code>where</code> and gave them more meaningful names. Feel free to revert if you disagree."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1569480605, "post_id": 58104976, "comment_id": 102611999, "body": "thanks; interesting how the meaning comes out from the minimal solution. the skipping of the leading spaces still needs to be done separately, but it&#39;s a well known pattern already captured by <code>dropWhile isSpace</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1570722364, "post_id": 58104976, "comment_id": 103011770, "body": "(to the casual reader: the bug caught by Joseph was fixed back then, if it&#39;s unclear)."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1569445202, "last_edit_date": 1569445202, "creation_date": 1569438042, "answer_id": 58104976, "question_id": 58087750, "link": "https://stackoverflow.com/questions/58087750/capitalizing-first-letter-of-words-while-removing-spaces-haskell/58104976#58104976", "title": "Capitalizing first letter of words while removing spaces (Haskell)", "body": "<p>Inspired by <a href=\"https://stackoverflow.com/users/7509065/joseph-sible\">Joseph Sible</a> 's <a href=\"https://stackoverflow.com/a/58101548/849891\">answer</a>, a <em>coroutines</em> solution:</p>\n\n<pre><code>import Data.Char\n\ntoCamelCase  :: String -&gt; String\ntoCamelCase  []         =  []\ntoCamelCase  (' ': xs)  =  toPascalCase xs\ntoCamelCase  (x  : xs)  =          x : toCamelCase xs\n\ntoPascalCase :: String -&gt; String\ntoPascalCase []         =  []\ntoPascalCase (' ': xs)  =  toPascalCase xs\ntoPascalCase (x  : xs)  =  toUpper x : toCamelCase xs\n</code></pre>\n\n<p>Be careful to not start the input string with a space, or you'll get the first word capitalized as well.</p>\n"}], "owner": {"reputation": 398, "user_id": 10412159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7782a6cbe4dca019ebe564903960341a?s=128&d=identicon&r=PG&f=1", "display_name": "larn", "link": "https://stackoverflow.com/users/10412159/larn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 58087859, "answer_count": 4, "score": 3, "last_activity_date": 1569445202, "creation_date": 1569357231, "last_edit_date": 1569423677, "question_id": 58087750, "link": "https://stackoverflow.com/questions/58087750/capitalizing-first-letter-of-words-while-removing-spaces-haskell", "title": "Capitalizing first letter of words while removing spaces (Haskell)", "body": "<p>I'm just starting out in Haskell and this is like the third thing I'm writing, so, naturally, I'm finding myself a little stumped. </p>\n\n<p>I'm trying to write a bit of code that will take a string, delete the spaces, and capitalize each letter of that string.</p>\n\n<p>For example, if I input \"this is a test\", I would like to get back something like: \"thisIsATest\" </p>\n\n<pre><code>import qualified Data.Char as Char\n\ntoCaps :: String -&gt; String\ntoCaps [] = []\ntoCaps xs = filter(/=' ') xs\ntoCaps (_:xs) =  map Char.toUpper xs \n</code></pre>\n\n<p>I think the method I'm using is wrong. With my code in this order, I am able to remove all the spaces using the <code>filter</code> function, but nothing becomes capitalize. </p>\n\n<p>When I move the <code>filter</code> bit to the very end of the code, I am able to use the <code>map Char.toUpper</code> bit. When I map that function <code>Char.toUpper</code>, it just capitalizes everything \"HISISATEST\", for example. \nI was trying to make use of an if function to say something similar to </p>\n\n<p><code>if ' ' then map Char.toUpper xs else Char.toLower xs</code>, but that didn't work out for me. I haven't utilized <code>if</code> in Haskell yet, and I don't think I'm doing it correctly. I also know using \"xs\" is wrong, but I'm not sure how to fix it. \nCan anyone offer any pointers on this particular problem? </p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 3645391, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/721788d328e32aa05df1eb71d4e1df73?s=128&d=identicon&r=PG&f=1", "display_name": "Andrzej So\u0142tysik", "link": "https://stackoverflow.com/users/3645391/andrzej-so%c5%82tysik"}, "is_accepted": true, "score": 0, "last_activity_date": 1569406349, "creation_date": 1569406349, "answer_id": 58096034, "question_id": 58086678, "link": "https://stackoverflow.com/questions/58086678/how-to-modify-the-default-setcookie-configuration-in-servant-auth/58096034#58096034", "title": "How to modify the default SetCookie configuration in servant-auth", "body": "<p>I've read the source of <code>acceptLogin</code> and figured out it calls <code>makeSessionCookie</code> and <code>makeXsrfCookie</code>, then uses the results to create a function for adding headers. I did the same in my code, modyfing the result of <code>makeSessionCookie</code> along the way:</p>\n\n<pre><code>checkCreds :: CookieSettings\n           -&gt; JWTSettings\n           -&gt; LoginRequest\n           -&gt; App (Headers '[ Header \"Set-Cookie\" SetCookie\n                            , Header \"Set-Cookie\" SetCookie]\n                            NoContent)\ncheckCreds cookieSettings jwtSettings LoginRequest{email = email, rawPassword = rawPassword} = do\n   -- Usually you would ask a database for the user info. This is just a\n   -- regular servant handler, so you can follow your normal database access\n   -- patterns (including using 'enter').\n   maybeUser &lt;- logicForFetchingAndValidatingUser\n   case maybeUser of\n     Just userView -&gt; do\n      mSessionCookie &lt;- liftIO $ makeSessionCookie cookieSettings jwtSettings userView\n      case mSessionCookie of\n        Nothing -&gt; throwError err401\n        Just sessionCookie -&gt; do\n          let modifiedSessionCookie = sessionCookie { setCookieHttpOnly = False, setCookieSecure = False }\n          xsrfCookie &lt;- liftIO $ makeXsrfCookie cookieSettings\n          return $ (addHeader modifiedSessionCookie . addHeader xsrfCookie) NoContent\n\n     Nothing -&gt; throwError err401\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 3645391, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/721788d328e32aa05df1eb71d4e1df73?s=128&d=identicon&r=PG&f=1", "display_name": "Andrzej So\u0142tysik", "link": "https://stackoverflow.com/users/3645391/andrzej-so%c5%82tysik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 58096034, "answer_count": 1, "score": 1, "last_activity_date": 1569406349, "creation_date": 1569351692, "question_id": 58086678, "link": "https://stackoverflow.com/questions/58086678/how-to-modify-the-default-setcookie-configuration-in-servant-auth", "title": "How to modify the default SetCookie configuration in servant-auth", "body": "<p>After successful logging in, servant-auth sets a <code>JWT-Cookie</code> cookie in the response. The problem is, it also flags the cookie as <code>HttpOnly</code>, which means I can't read the JWT in my single page app. My understanding is that this can be configured with the SetCookie datatype. I've been able to create my own custom <code>SetCookie</code> by using <code>defaultSetCookie { setCookieHttpOnly = False }</code>. How do I stuff it into the <code>acceptLogin</code> function?</p>\n\n<p>Here is my handler for logging in.</p>\n\n<pre><code>checkCreds :: CookieSettings\n           -&gt; JWTSettings\n           -&gt; LoginRequest\n           -&gt; App (Headers '[ Header \"Set-Cookie\" SetCookie\n                            , Header \"Set-Cookie\" SetCookie ]\n                            NoContent)\ncheckCreds cookieSettings jwtSettings LoginRequest{email = email, rawPassword = rawPassword} = do\n   maybeUser &lt;- logicForFetchingAndValidatingUser\n   -- What do I do with this mySetCookie? \n   let mySetCookie = defaultSetCookie { setCookieHttpOnly = False }\n   case maybeUser of\n     Just userView -&gt; do\n      mApplyCookies &lt;- liftIO $ acceptLogin cookieSettings jwtSettings userView\n      case mApplyCookies of\n        Nothing           -&gt; throwError err401\n        Just applyCookies -&gt; return $ applyCookies NoContent\n     Nothing -&gt; throwError err401\n</code></pre>\n"}, {"tags": ["haskell", "types", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 4, "creation_date": 1569346993, "post_id": 58084780, "comment_id": 102565078, "body": "&quot;So is it just the case that we don&#39;t regard magic literals such as 42# as values?&quot; that would be a pretty silly/useless thing to assert. So I think the comment on <code>Type</code> is just imprecise/inaccurate."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1569347993, "post_id": 58084780, "comment_id": 102565476, "body": "<code>42#</code> is indeed value. If you think that the documentation can be improved, you can open an issue to GHC."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 5, "creation_date": 1569352051, "post_id": 58084780, "comment_id": 102567136, "body": "I believe the &quot;the kind of types with values&quot; phrase is mainly used in opposition to &quot;incomplete&quot; types like <code>Maybe</code> or <code>Either Int</code>, or to type-level structures like <code>&#39;[Int,Bool,Char]</code> which (in current Haskell) don&#39;t have values at the term level. If we include kinds like <code>TYPE &#39;IntRep</code> the phrase is no longer correct."}], "answers": [{"comments": [{"owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "edited": false, "score": 0, "creation_date": 1569343861, "post_id": 58084827, "comment_id": 102563741, "body": "That much I know, my objection is to <code>Type</code> being the kind of values, where <code>42#</code> looks like a value to me."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "edited": false, "score": 0, "creation_date": 1569364507, "post_id": 58084827, "comment_id": 102571122, "body": "@Madgen It is an <i>unlifted</i> value, which is treated differently by the compiler than lifted values, and has different kind for that reason. <code>Int#</code> is simply not of kind <code>Type</code>."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 2, "last_activity_date": 1569343409, "creation_date": 1569343409, "answer_id": 58084827, "question_id": 58084780, "link": "https://stackoverflow.com/questions/58084780/why-is-type-the-kind-of-types-with-values/58084827#58084827", "title": "Why is Type the kind of types with values?", "body": "<p>Just elide the type signature and GHCI will happily tell you:</p>\n\n<pre><code>Prelude Data.Kind GHC.Prim&gt; :k Int#\nInt# :: TYPE 'GHC.Types.IntRep\n</code></pre>\n\n<p>It's an unlifted Int, which is about what we'd expect from the name <code>Int#</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "is_accepted": true, "score": 2, "last_activity_date": 1569407631, "creation_date": 1569407631, "answer_id": 58096441, "question_id": 58084780, "link": "https://stackoverflow.com/questions/58084780/why-is-type-the-kind-of-types-with-values/58096441#58096441", "title": "Why is Type the kind of types with values?", "body": "<p>This indeed turned out to be a deficiency in the documentation and <a href=\"https://gitlab.haskell.org/ghc/ghc/commit/9a1dbefc2723df2c341a0c565b693a4eb8b26195\" rel=\"nofollow noreferrer\">is now fixed</a> in GHC's HEAD.</p>\n\n<p>To sum up, <code>Type</code> is the kind of types with lifted values because there are other values with differently kinded types such as <code>42# :: (Int# :: TYPE 'IntRep))</code>.</p>\n"}], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 58096441, "answer_count": 2, "score": 5, "last_activity_date": 1569407631, "creation_date": 1569343194, "question_id": 58084780, "link": "https://stackoverflow.com/questions/58084780/why-is-type-the-kind-of-types-with-values", "title": "Why is Type the kind of types with values?", "body": "<p>If I enable <code>MagicHash</code>, then I have unlifted values such as <code>42#</code> with type <code>Int#</code>.</p>\n\n<p>Now if <a href=\"http://hackage.haskell.org/package/ghc-prim-0.5.3/docs/GHC-Types.html#t:Type\" rel=\"noreferrer\"><code>Type</code> is the kind of types with values</a>, then the kind of <code>Int#</code> should be <code>Type</code>, but it isn't because <code>Type</code> is a synonym for <code>TYPE 'LiftedRep</code> whereas the kind of <code>Int#</code> is <code>TYPE 'IntRep</code>. We can easily confirm this in <code>ghci</code>,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; :set -XMagicHash -XKindSignatures\nPrelude&gt; :m +Data.Kind GHC.Prim\nPrelude Data.Kind GHC.Prim&gt; :k (Int# :: Type)\n\n&lt;interactive&gt;:1:2: error:\n    \u2022 Expecting a lifted type, but \u2018Int#\u2019 is unlifted\n    \u2022 In the type \u2018(Int# :: Type)\u2019\n</code></pre>\n\n<p>So is it just the case that we don't regard magic literals such as <code>42#</code> as values?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569337887, "post_id": 58083132, "comment_id": 102560747, "body": "Likely you used the <code>*</code> from <code>Numeric.Units.Dimension</code>, not from <code>Prelude</code>."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569338179, "post_id": 58083132, "comment_id": 102560910, "body": "@WillemVanOnsem, I think I&#39;m hiding that one, here&#39;s my custom prelude: <a href=\"https://gist.github.com/bbarker/bb34403c693076c8a9b0625f2cd120a3\" rel=\"nofollow noreferrer\">gist.github.com/bbarker/bb34403c693076c8a9b0625f2cd120a3</a>"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569338563, "post_id": 58083132, "comment_id": 102561131, "body": "@WillemVanOnsem oh, yeah, right, I had that the other way around - sorry. Indeed I do need the one from Prelude."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1569343567, "creation_date": 1569343567, "answer_id": 58084868, "question_id": 58083132, "link": "https://stackoverflow.com/questions/58083132/how-to-allow-arithmetic-operations-when-defining-dimensional-constants/58084868#58084868", "title": "How to allow arithmetic operations when defining dimensional constants?", "body": "<p>Based on your <a href=\"https://gist.github.com/bbarker/bb34403c693076c8a9b0625f2cd120a3\" rel=\"nofollow noreferrer\">gist file</a>, the <code>(*)</code> function you here use, originates from the <a href=\"http://hackage.haskell.org/package/dimensional-1.3/docs/Numeric-Units-Dimensional.html\" rel=\"nofollow noreferrer\"><strong><code>Numeric.Units.Dimensional</code></strong> module</a>, and thus has type <a href=\"http://hackage.haskell.org/package/dimensional-1.3/docs/Numeric-Units-Dimensional.html#v:-42-\" rel=\"nofollow noreferrer\"><strong><code>(*) :: (KnownVariant v1, KnownVariant v2, KnownVariant (v1 * v2), Num a) =&gt; Dimensional v1 d1 a -&gt; Dimensional v2 d2 a -&gt; Dimensional (v1 * v2) (d1 * d2) a</code></strong></a>, you likely want to use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-42-\" rel=\"nofollow noreferrer\"><strong><code>(*) :: Num a =&gt; a -&gt; a -&gt; a</code></strong></a> from the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html\" rel=\"nofollow noreferrer\"><strong><code>Prelude</code></strong> module</a>.</p>\n\n<pre><code>{-# LANGUAGE DataKinds, RankNTypes #-}\n\nimport Numeric.Units.Dimensional <b>hiding ((*))</b>\nimport qualified Numeric.Units.Dimensional.Prelude as NUDP\n\nsec :: Num a =&gt; Unit Metric DTime a\nsec = NUDP.second\n\naSecond :: Time Integer\naSecond = 1 *~ sec\n\nsomeSeconds :: Integer -&gt; Time Integer\nsomeSeconds i = i *~ sec\n\nx2Seconds :: Integer -&gt; Time Integer\nx2Seconds i = (2*i) *~ sec</code></pre>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58084868, "answer_count": 1, "score": 2, "last_activity_date": 1569343567, "creation_date": 1569337051, "question_id": 58083132, "link": "https://stackoverflow.com/questions/58083132/how-to-allow-arithmetic-operations-when-defining-dimensional-constants", "title": "How to allow arithmetic operations when defining dimensional constants?", "body": "<p>I'm taking my first crack at using <a href=\"http://hackage.haskell.org/package/dimensional\" rel=\"nofollow noreferrer\">dimensional</a>; the first two definitions below don't present an issue:</p>\n\n<pre><code>aSecond :: Time Integer\naSecond = 1 *~ sec\n\nsomeSeconds :: Integer -&gt; Time Integer\nsomeSeconds i = i *~ sec\n\nx2Seconds :: Integer -&gt; Time Integer\nx2Seconds i = (2*i) *~ (sec)\n</code></pre>\n\n<p>However, <code>x2Seconds</code> has a compile error. </p>\n\n<p>Even more surprisingly, this alternative definition has the same issue:</p>\n\n<pre><code>x2Seconds :: Integer -&gt; Time Integer\nx2Seconds i = let s = 2*i in s *~ sec\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018Integer\u2019\n                  with actual type \u2018Dimensional\n                                      (v10 dimensional-1.3:Numeric.Units.Dimensional.Variants.* v20)\n                                      (d10 * d20)\n                                      a0\u2019\n    \u2022 In the first argument of \u2018(*~)\u2019, namely \u2018s\u2019\n      In the expression: s *~ sec\n      In the expression: let s = 2 * i in s *~ sec\n    \u2022 Relevant bindings include\n        s :: Dimensional\n               (v10 dimensional-1.3:Numeric.Units.Dimensional.Variants.* v20)\n               (d10 * d20)\n               a0\n          (bound at src/FDS/Data/Util.hs:40:19)\n   |\n40 | x2Seconds i = let s = 2*i in s *~ sec\n   |                              ^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1569336798, "post_id": 58082889, "comment_id": 102560117, "body": "&quot;Non-empty, possibly infinite, multi-way trees; also known as rose trees.&quot; - I don&#39;t think mempty can exist, could be wrong though."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569336839, "post_id": 58082889, "comment_id": 102560137, "body": "A tree is an instance of <code>Foldable</code>, so I guess that might give some tooling to work with threes that have values that belong to a type that is an instance of <code>Monoid</code>. But I agree it might make sense to make a tree an instance of <code>Monoid</code> as well."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1569336889, "post_id": 58082889, "comment_id": 102560169, "body": "@Caramiriel: if the item it wraps is a <code>Monoid</code> as well, we could define it as <code>mempty = Node mempty []</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1569342188, "post_id": 58082889, "comment_id": 102562992, "body": "your <code>mappend</code> definition is equivalent to <code>liftA2 mappend</code>, just like <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#t:Ap\" rel=\"nofollow noreferrer\"><code>Ap</code></a> <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.Monoid.html#line-189\" rel=\"nofollow noreferrer\">defines</a>."}, {"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "reply_to_user": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1569399616, "post_id": 58082889, "comment_id": 102580497, "body": "@Caramiriel, as @Willem Van Onsem mentions the instance that Joachim Breitner proposes does indeed require a monoid instance for nodes of the tree so we can have <code>mempty = pure mempty = Node mempty</code>"}, {"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569524396, "post_id": 58082889, "comment_id": 102634868, "body": "Good point @WillNess. Though I personally prefer to write it like <code>mappend &lt;$&gt; f &lt;*&gt; g</code>.  It generalizes to any arity: <code>User &lt;$&gt; parseName &lt;*&gt; parseEmail &lt;*&gt; parsePassword</code> etc. ad nauseam."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1569526762, "post_id": 58082889, "comment_id": 102635936, "body": "@fredefox, <code>liftA2</code> composes more cleanly. <code>liftA2 . liftA2 . liftA2</code> expresses the idea of lifting under multiple functors."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 0, "creation_date": 1569399874, "post_id": 58083791, "comment_id": 102580647, "body": "Ah I see. <code>Ap</code> &quot;witness&quot; the observation that Joachim Breitner mentioned. I didn&#39;t know about this type. I wonder, then, when something qualifies as a &quot;natural&quot; monoid instance as e.g. for <code>[]</code> with <code>mappend = (++)</code> and when something is &quot;naturally ambiguous&quot; for which we employ <code>Sum</code>, <code>Product</code>, <code>Ap</code> et. al. from <code>Data.Monoid</code>. Certainly useful to look closer into <code>Data.Monoid</code> though. Thanks for the tip!"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 0, "creation_date": 1569458153, "post_id": 58083791, "comment_id": 102606549, "body": "@fredefox I think it&#39;s fundamentally subjective. The standard I would use is &quot;if I told you this type had a monoid instance but didn&#39;t tell you how it worked, would you immediately know what the instance probably does?&quot;. But that question has very different answers for people who are only passingly familiar with a type/library than for people who use it substantially. Ultimately we&#39;re just stuck with the judgement of whoever wrote the library, but can usually work around a decision we disagree with via newtypes, so I don&#39;t think anyone loses much sleep over it."}, {"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 1, "creation_date": 1569523912, "post_id": 58083791, "comment_id": 102634673, "body": "Unless you&#39;re a stickler like me I guess ;) but in all seriousness I think that&#39;s a very nice observation. A design principle could be that the instance should be immediately obvious (in the case of library design) or driven by the use-case (in the case of application code). I suppose it&#39;s just a fact of life that type-classes and ditto-coherence is a bit at odds with the mathematical concepts that they represent. What I mean is that it&#39;s really the gadget <code>(Nat, (+), 0, ...laws)</code> that <i>is</i> a monoid and like-wise <code>(Nat, (*), 1, ...laws)</code> and not - as we like to pretend - <code>Nat</code> itself."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1569339383, "creation_date": 1569339383, "answer_id": 58083791, "question_id": 58082889, "link": "https://stackoverflow.com/questions/58082889/why-does-data-tree-tree-not-have-a-monoid-instance/58083791#58083791", "title": "Why does Data.Tree.Tree not have a monoid instance?", "body": "<p>I don't know why it isn't available. However, the instance you propose is available once and for all via the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#t:Ap\" rel=\"noreferrer\"><code>Ap</code></a> newtype, which provides an <code>instance (Applicative f, Monoid m) =&gt; Monoid (Ap f m)</code>. So if you need the instance you write, you can get it with this, even though it doesn't exist on the bare <code>Tree</code> type.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1569526338, "last_edit_date": 1569526338, "creation_date": 1569525544, "answer_id": 58123404, "question_id": 58082889, "link": "https://stackoverflow.com/questions/58082889/why-does-data-tree-tree-not-have-a-monoid-instance/58123404#58123404", "title": "Why does Data.Tree.Tree not have a monoid instance?", "body": "<p>There are multiple valid instances. <code>Tree</code> also supports a \"zippy\" <code>Applicative</code> with its corresponding <code>Ap</code>-based monoid:</p>\n\n<pre><code>instance Applicative Tree where\n  pure a = let t = Node a (repeat t) in t\n  liftA2 f (Node a as) (Node b bs) =\n    Node (f a b) (zipWith (liftA2 f) as bs)\n\ninstance Semigroup a =&gt; Semigroup (Tree a) where\n  Node a as &lt;&gt; Node b bs =\n    Node (a &lt;&gt; b) (zipWith (&lt;&gt;) as bs)\n\ninstance Monoid a =&gt; Monoid (Tree a) where\n  mempty = Node mempty (repeat mempty)\n</code></pre>\n\n<p>I have no idea what instance, if any, would actually be useful.</p>\n\n<hr>\n\n<p>Just for fun, here's a slightly silly one that just lifts the constructor over underlying monoids:</p>\n\n<pre><code>instance Semigroup a =&gt; Semigroup (Tree a) where\n  Node a as &lt;&gt; Node b bs = Node (a &lt;&gt; b) (as ++ bs)\n\ninstance Monoid a =&gt; Monoid (Tree a) where\n  mempty = Node mempty []\n</code></pre>\n"}], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 58083791, "answer_count": 2, "score": 4, "last_activity_date": 1569526338, "creation_date": 1569336269, "last_edit_date": 1569524460, "question_id": 58082889, "link": "https://stackoverflow.com/questions/58082889/why-does-data-tree-tree-not-have-a-monoid-instance", "title": "Why does Data.Tree.Tree not have a monoid instance?", "body": "<p>I realise that the answer may be that there are multiple valid such instances (as is the case for e.g. integers; sum, product, ...). Perhaps someone has a more satisfying answer than this?</p>\n\n<p>As Joachim Breitner excellently explains in this answer <a href=\"https://stackoverflow.com/questions/15054765/how-do-you-implement-monoid-interface-for-this-tree-in-haskell\">How do you implement monoid interface for this tree in haskell?</a> any applicative has a monoid instance:</p>\n\n<pre><code>mempty :: Applicative f =&gt; Monoid a =&gt; f a\nmempty = pure mempty\n\nmappend :: Applicative f =&gt; Monoid a =&gt; f a -&gt; f a -&gt; f a\nmappend f g = mappend &lt;$&gt; f &lt;*&gt; g\n</code></pre>\n\n<p>So I was wondering why <code>Data.Tree.Tree</code> from <code>containers</code> does not have such an instance? Same argument could be used for any other monad without an accompanying monoid instance. It only seems natural to me that they should have such instances. Maybe this is not the case. I hope someone can enlighten me.</p>\n\n<p>I suppose another reason could be that the instance I propose for trees is not \"useful\". This is as unsatisfying as the multiple valid instances argument in my opinion.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569329568, "post_id": 58080511, "comment_id": 102555719, "body": "<code>event = a b c</code> is short for <code>(a b) c</code>, it thus means <code>a</code> should be of type <code>tb -&gt; tc -&gt; td</code>, with <code>tb</code> and <code>tc</code> the types of <code>b</code> and <code>c</code> respectively."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1569330041, "last_edit_date": 1569330041, "creation_date": 1569329510, "answer_id": 58080743, "question_id": 58080511, "link": "https://stackoverflow.com/questions/58080511/haskell-using-multiple-functions-in-one-function/58080743#58080743", "title": "Haskell Using multiple functions in one function", "body": "<p>When you write <code>event = a b c</code>, this means \"<em>apply function <code>a</code> to two arguments, <code>b</code> and <code>c</code></em>\". That's how function application works in Haskell. Function, then space, then argument.</p>\n\n<p>Because you wrote this, thinks Haskell, <code>a</code> must be a function. What type of function must it be? Well, look at types of <code>b</code> and <code>c</code>. Since <code>b :: (Integer, Integer)</code>, and <code>c :: String</code>, function <code>a</code> must be of type <code>(Integer, Integer) -&gt; String -&gt; something</code></p>\n\n<p>But wait! - thinks Haskell - Where did <code>a</code> even come from? Oh, it was returned from <code>first</code>, and the result of <code>first</code> must have the same type as its first tupled argument, and I'm passing <code>x</code> in that position, and <code>x :: (Integer, Integer)</code>, therefore <code>a</code> must also be of type <code>(Integer, Integer)</code></p>\n\n<p>Hmmm, - thinks Haskell, - on one hand I have determined that <code>a :: (Integer, Integer) -&gt; String -&gt; something</code>. On the other hand, I have determined that <code>a :: (Integer, Integer)</code>. DOES NOT COMPUTE!</p>\n\n<p>And so Haskell complains: <em>Couldn't match expected type '(Integer, Integer) -> String -> t' with actual type '(Integer, Integer)'</em></p>\n\n<p>Lesson here: read and try to understand the error messages. In Haskell they are usually quite helpful.</p>\n\n<hr>\n\n<p>From your definition of the type <code>Event</code>, I am <em>guessing</em> that what you actually meant to do is to create a triple of <code>a</code>, <code>b</code>, and <code>c</code>. If so, the correct syntax is this:</p>\n\n<pre><code>event = (a, b, c)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12113123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yer_JNh2mDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfw5VBc0ukK9g8oJGAookICKWai0A/photo.jpg?sz=128", "display_name": "Skyline", "link": "https://stackoverflow.com/users/12113123/skyline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 58080743, "answer_count": 1, "score": -2, "last_activity_date": 1569330041, "creation_date": 1569328654, "question_id": 58080511, "link": "https://stackoverflow.com/questions/58080511/haskell-using-multiple-functions-in-one-function", "title": "Haskell Using multiple functions in one function", "body": "<p>I'm trying to use multiple functions in my code but it's not really working. Is there any way to apply multiple functions in on function? I'm getting this error message:</p>\n\n<pre><code>Couldn't match expected type `(Integer, Integer) -&gt; String -&gt; t'\n                  with actual type `(Integer, Integer)'\n    * The function `a' is applied to two arguments,\n      but its type `(Integer, Integer)' has none\n      In the expression: a b c\n      In an equation for `event': event = a b c\n    * Relevant bindings include\n        event :: t (bound at E:\\\\ELTE\\2019_1_Funkcprog\\hf2.hs:28:10)\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>type Event = ((Integer, Integer), (Integer, Integer), String)\n\nshift :: (Integer, Integer) -&gt; Integer -&gt; (Integer, Integer)\nshift (x, y) z = case y + z &gt;= 60 of\n    True -&gt; ((div ((x*60 + y)  + z) 60) `mod` 24, mod ((x*60 + y)  + z) 60)\n    False -&gt; (x, y + z)\n\n\nisEarlier :: (Integer, Integer) -&gt; (Integer, Integer) -&gt; Bool\nisEarlier (a, b) (c, d) = case a &lt; c || a == c &amp;&amp; b &lt; d of\n    True -&gt; True\n    False -&gt; False \n\n\nfirst :: (a, b, c) -&gt; a\nfirst (x, _, _) = x\nsecond :: (a, b, c) -&gt; b\nsecond (_, y, _) = y\nthird :: (a, b, c) -&gt; c\nthird (_, _, z) = z\n\n\ncreateEvent :: (Integer, Integer) -&gt;  Integer -&gt; String -&gt; Event\ncreateEvent x y z = event\n   where a = first (x,y,z) \n         b = shift x y \n         c = third (x,y,z)\n         event = a b c\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1569324845, "post_id": 58079340, "comment_id": 102553137, "body": "You need to indent the pipe characters (<code>|</code>) with at least one space"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569324897, "post_id": 58079340, "comment_id": 102553165, "body": "Now the error however says that you never defined <code>r</code> (which is indeed correct)"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 12112804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6iIP.jpg?s=128&g=1", "display_name": "dasogom", "link": "https://stackoverflow.com/users/12112804/dasogom"}, "edited": false, "score": 0, "creation_date": 1569327688, "post_id": 58079579, "comment_id": 102554681, "body": "Is there any other way to do this without <code>shiftR?</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61, "user_id": 12112804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6iIP.jpg?s=128&g=1", "display_name": "dasogom", "link": "https://stackoverflow.com/users/12112804/dasogom"}, "edited": false, "score": 0, "creation_date": 1569327723, "post_id": 58079579, "comment_id": 102554708, "body": "@daogom: <code>shiftR ... 1</code>, is equivalent here to <code>div ... 2</code>. But with that difference that a CPU is usually better in shifting than dividing (some compilers can optimize it)"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1569328033, "post_id": 58079579, "comment_id": 102554905, "body": "You could also use <code>n `quot` 2</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1569325441, "creation_date": 1569325441, "answer_id": 58079579, "question_id": 58079340, "link": "https://stackoverflow.com/questions/58079340/parse-errorpossibly-incorrect-indentation-or-mismatched-brackets/58079579#58079579", "title": "parse error(possibly incorrect indentation or mismatched brackets)", "body": "<p>The main problem is that the indentation level of the guards is the same as the <code>md</code> function itself). You need to indent it by at least one space:</p>\n\n<pre><code>modf :: Int -&gt; Int\nmodf n = md 2 (n-1) n r\n    where\n    md b e m r\n        | (mod e 2 == 0) = md (mod b*b m) (div e 2) m r\n        | otherwise = md (mod b*b m) (div e 2) m (mod r*b m)</code></pre>\n\n<p>Now the syntax error has been resolved, but it will raise an error on the fact that you use <code>r</code>, but never defined <code>r</code>.</p>\n\n<p>We can implement this more elegantly by:</p>\n\n<pre><code>import Data.Bits(shiftR)\n\nmodf :: Int -&gt; Int\nmodf m = go 2 (m-1)\n    where go k 1 = k\n          go k n | even n = go2\n                 | otherwise = mod (go2 * k) m\n              where go2 = go (mod (k*k) m) (shiftR n 1)\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 12112804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6iIP.jpg?s=128&g=1", "display_name": "dasogom", "link": "https://stackoverflow.com/users/12112804/dasogom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569334116, "creation_date": 1569324703, "last_edit_date": 1569334116, "question_id": 58079340, "link": "https://stackoverflow.com/questions/58079340/parse-errorpossibly-incorrect-indentation-or-mismatched-brackets", "title": "parse error(possibly incorrect indentation or mismatched brackets)", "body": "<p>I am making calculating 2^(n-1) mod n. I had a problem with Haskell.</p>\n\n<pre><code>parse error (possibly incorrect indentation or mismatched brackets)\n  |\n5 |     | (mod e 2 == 0) = md (mod b*b m) (div e 2) m r\n  |     ^\n</code></pre>\n\n<p>But the problem is I don't know what is the problem</p>\n\n<pre><code>modf :: Int -&gt; Int\nmodf n = md 2 (n-1) n r\n    where\n    md b e m r\n    | (mod e 2 == 0) = md (mod b*b m) (div e 2) m r\n    | otherwise = md (mod b*b m) (div e 2) m (mod r*b m)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 5, "creation_date": 1569321737, "post_id": 58078421, "comment_id": 102551433, "body": "That <code>(Integral b, Floating b, Num a)</code> bit is a <i>typeclass constraint</i>. Have a look at <a href=\"https://en.wikibooks.org/wiki/Haskell/Classes_and_types#Type_constraints\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/&hellip;</a> and <a href=\"http://learnyouahaskell.com/types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/types-and-typeclasses</a> for some info. Another thing \u2014 there are <a href=\"https://stackoverflow.com/a/6400628/7345298\">several different exponentiation operators</a> in Haskell, and I think you want <code>**</code> rather than <code>^</code>."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 3, "creation_date": 1569322706, "post_id": 58078421, "comment_id": 102551979, "body": "The problem is that the <code>^</code> operator expects an integer as its second input (i.e. you can write <code>2 ^ 3</code> but you can&#39;t write <code>2 ^ 3.0</code>). However, the <code>sqrt</code> function returns a floating point number. If you want to raise a number to a floating point power then you have to use the <code>**</code> operator. For example, can write <code>2 ** 3.0</code>. Hence, your function would be <code>let f x y z = x + y ** sqrt z</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569323129, "post_id": 58078421, "comment_id": 102552218, "body": "Most numbers are not both <code>Integral</code> and <code>Floating</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1569323707, "creation_date": 1569323707, "answer_id": 58079061, "question_id": 58078421, "link": "https://stackoverflow.com/questions/58078421/how-to-declare-functions-in-haskell-with-let-single-line-operatoins-only/58079061#58079061", "title": "How to declare functions in Haskell with let ( single line operatoins only )", "body": "<p>The <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-94-\" rel=\"nofollow noreferrer\"><strong><code>(^) :: (Num a, Integral b) =&gt; a -&gt; b -&gt; a</code></strong></a> takes as second parameter an <code>Integral</code> type. An integral type is something like an <code>Int</code>, <code>Integer</code>, etc.</p>\n\n<p>But your <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sqrt\" rel=\"nofollow noreferrer\"><strong><code>sqrt :: Floating f =&gt; f -&gt; f</code></strong></a> takes a <code>Floating</code> value and returns a <code>Floating</code> value. This thus means that the type of <code>z</code> needs to be a type that is both a member of the <code>Integral</code> and <code>Floating</code> typeclass. Although strictly speaking, it is possible to implement such types, the two typeclasses contradict each other in terms on what sort of types can be members.</p>\n\n<p>You probably should use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-42--42-\" rel=\"nofollow noreferrer\"><strong><code>(**) :: Floating f =&gt; f -&gt; f -&gt; f</code></strong></a> here to raise a number to a floating power. We can thus define <code>f</code> as:</p>\n\n<pre><code>f x y z = x + y <b>**</b> sqrt z</code></pre>\n\n<p>Then <code>f</code> has type:</p>\n\n<pre><code>f :: Floating a =&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>It thus takes three <code>a</code>s where <code>a</code> is a type that is a member of the <code>Floating</code> typeclass, and returns an <code>a</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 12112479, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnvLHT9AJ1E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7vRcwYk1yC1um3182zJaozMePVw/photo.jpg?sz=128", "display_name": "Ramune 4fun", "link": "https://stackoverflow.com/users/12112479/ramune-4fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58079061, "answer_count": 1, "score": 2, "last_activity_date": 1569323707, "creation_date": 1569321530, "last_edit_date": 1569322347, "question_id": 58078421, "link": "https://stackoverflow.com/questions/58078421/how-to-declare-functions-in-haskell-with-let-single-line-operatoins-only", "title": "How to declare functions in Haskell with let ( single line operatoins only )", "body": "<p>I am stuck behind a very simple exercise I just have to do <code>x + y ^ sqrt z</code> with <code>let</code>, but I tried: </p>\n\n<pre><code>let f x y z = x + y ^ sqrt z\n</code></pre>\n\n<p>but it doesn't work and complains about a type miss match when <code>f</code> is used and with <code>:t (f)</code> I get: </p>\n\n<pre><code>(f) :: (Integral b, Floating b, Num a) =&gt; a -&gt; a -&gt; b -&gt; a\n</code></pre>\n\n<p>Can somebody explain or give an article which explains the <code>(Integral b, Floating b, Num a)</code> part. What I know is Num a => a \"1\" -> a \"2\" -> a \"3\"\nfor f x y = x + y</p>\n\n<p><code>x</code> has the type of <code>a1</code> and <code>y</code> has the type of <code>a2</code> and the solution is <code>a3</code> all of typeclass <code>Num</code> which is used for <code>(*), (+), (^), ...</code> . </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10964093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4o6U.jpg?s=128&g=1", "display_name": "ovda96", "link": "https://stackoverflow.com/users/10964093/ovda96"}, "edited": false, "score": 1, "creation_date": 1569320894, "post_id": 58078197, "comment_id": 102550976, "body": "Thanks! I don&#39;t know why I was worried that this solution was too much in the direction of hardcoding, but of course it isn&#39;t. Thank you!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1569320897, "last_edit_date": 1569320897, "creation_date": 1569320779, "answer_id": 58078197, "question_id": 58078156, "link": "https://stackoverflow.com/questions/58078156/how-to-transpose-a-triple-consisting-of-triples-in-haskell/58078197#58078197", "title": "How to transpose a triple consisting of triples in Haskell", "body": "<p>Since the number of items in a tuple are fixed, you can just use pattern matching to unpack the 3-tuples and create a new tuple:</p>\n\n<pre><code>transpose3 :: ((a,b,c), (d,e,f), (g,h,i)) -&gt; ((a,d,g), (b,e,h), (c,f,i))\ntranspose3 ((a,b,c), (d,e,f), (g,h,i)) = ((a,d,g), (b,e,h), (c,f,i))\n</code></pre>\n\n<p>So we get as transposed form:</p>\n\n<pre><code>Prelude&gt; transpose3 ((1,2,3),(4,5,6),(7,8,9))\n((1,4,7),(2,5,8),(3,6,9))\n</code></pre>\n\n<p>The nice thing is that we here can transpose heterogeneous \"matrices\", and we keep track of the types.</p>\n"}, {"tags": [], "owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "is_accepted": false, "score": 2, "last_activity_date": 1569356049, "creation_date": 1569356049, "answer_id": 58087533, "question_id": 58078156, "link": "https://stackoverflow.com/questions/58078156/how-to-transpose-a-triple-consisting-of-triples-in-haskell/58087533#58087533", "title": "How to transpose a triple consisting of triples in Haskell", "body": "<p>You can convert your 3-tuple to a list, apply transpose and convert resulting list back to a 3-tuple</p>\n\n<pre><code>tupleToList (x,y,z) = [x,y,z]\nlistToTuple [x,y,z] = (x,y,z)\n\ntranspose3 xs = listToTuple (map lisToTuple (transpose (map tupleToList (tupleToList xs))))\n</code></pre>\n\n<p>Or convert above function to point free form:</p>\n\n<pre><code>transpose3 =  listToTuple.map listToTuple.transpose. map tupleToList.tupleToList\n</code></pre>\n\n<p>This function would work for any size of matrix If your <code>tupleToList</code> and <code>listToTuple</code> functions are defined appropriately</p>\n"}], "owner": {"reputation": 75, "user_id": 10964093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4o6U.jpg?s=128&g=1", "display_name": "ovda96", "link": "https://stackoverflow.com/users/10964093/ovda96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 58078197, "answer_count": 2, "score": 2, "last_activity_date": 1569356049, "creation_date": 1569320621, "last_edit_date": 1569322123, "question_id": 58078156, "link": "https://stackoverflow.com/questions/58078156/how-to-transpose-a-triple-consisting-of-triples-in-haskell", "title": "How to transpose a triple consisting of triples in Haskell", "body": "<p>Haskell has a great function <em>transpose</em> that transposes a list of (lists) rows into a list of (lists) columns. I.e.:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>transpose[[\"name\",\"job\"],[\"john\",\"coder\"]] \n=&gt;[[\"name\",\"john\"],[\"job\",\"coder\"]]\n</code></pre>\n\n<p>I now need to apply this same principle to a triple consisting of triples, so:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>transpose3 ((1,2,3),(4,5,6),(7,8,9))\n=&gt;((1,4,7),(2,5,8),(3,6,9))\n</code></pre>\n\n<p>I cannot use lists instead of the triples. Does anyone have an idea how to achieve this or whether a function like this is already in the Haskell library?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "is_accepted": false, "score": 2, "last_activity_date": 1569319896, "last_edit_date": 1569319896, "creation_date": 1569319234, "answer_id": 58077746, "question_id": 58077656, "link": "https://stackoverflow.com/questions/58077656/access-data-property-haskell/58077746#58077746", "title": "Access data property [Haskell]", "body": "<p>If you haven't define a record visitor, then the only way to visit it's field is pattern matching:</p>\n\n<pre><code>type FirstName = String\ntype LastName = String\n\ndata Name = Name FirstName LastName\n\nmain = do \n      let tim = Name \"tim\" \"lim\"\n      putStrLn (case tim of Name fname lname -&gt; fname)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1083, "user_id": 5272159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bee102cff2130800106cdd7d99db787e?s=128&d=identicon&r=PG&f=1", "display_name": "timothyylim", "link": "https://stackoverflow.com/users/5272159/timothyylim"}, "edited": false, "score": 0, "creation_date": 1569320332, "post_id": 58077750, "comment_id": 102550666, "body": "Great answer as usual!! The reason why I chose not to use record syntax was because I wanted to make a sum type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1083, "user_id": 5272159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bee102cff2130800106cdd7d99db787e?s=128&d=identicon&r=PG&f=1", "display_name": "timothyylim", "link": "https://stackoverflow.com/users/5272159/timothyylim"}, "edited": false, "score": 0, "creation_date": 1569320387, "post_id": 58077750, "comment_id": 102550696, "body": "@timothyylim: you can use record syntax with sum types as well, although I agree it is not implemented very nicely, since then the &quot;getters&quot; are no longer per se total."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1083, "user_id": 5272159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bee102cff2130800106cdd7d99db787e?s=128&d=identicon&r=PG&f=1", "display_name": "timothyylim", "link": "https://stackoverflow.com/users/5272159/timothyylim"}, "edited": false, "score": 0, "creation_date": 1569328430, "post_id": 58077750, "comment_id": 102555127, "body": "@timothyylim For sum types, record fields can become partial functions, so it&#39;s better to avoid them. Similarly, <code>let Constructor x1 .. xn = value</code> can crash the program if the value has another constructor. For sum types, it&#39;s better to use  <code>case value of Constructor1 x1 .. -&gt; something ; Constructor2 x1 ... -&gt; somethingElse ; ...</code> or similar pattern matching."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1569320079, "last_edit_date": 1569320079, "creation_date": 1569319244, "answer_id": 58077750, "question_id": 58077656, "link": "https://stackoverflow.com/questions/58077656/access-data-property-haskell/58077750#58077750", "title": "Access data property [Haskell]", "body": "<p>You unpack it, for example with pattern matching:</p>\n\n<p>type FirstName = String\ntype LastName = String</p>\n\n<p>data Name = Name FirstName LastName</p>\n\n<pre><code>main = do \n      let <b>Name fn _</b> = Name \"tim\" \"lim\"\n      putStrLn <b>fn</b></code></pre>\n\n<p>But it might be better to use a record for your <code>Name</code>:</p>\n\n<pre><code>data Name = Name <b>{ firstName ::</b> FirstName<b>, lastName ::</b> LastName <b>}</b></code></pre>\n\n<p>Then Haskell will automatically generate two functions <code>firstName :: Name -&gt; FirstName</code> and <code>lastName :: Name -&gt; LastName</code>, so you can then use that function with:</p>\n\n<pre><code>main = do \n      let tim = Name \"tim\" \"lim\"\n      putStrLn <b>(firstName tim)</b></code></pre>\n\n<p>The main advantage of using record syntax is that you can easily obtain a field from a data constructor, without having to unpack the data constructor, and taking care of all the fields. If the amount of fields grows, it would likely take some extra work to refactor all places where you used the non-record syntax in the first place.</p>\n\n<blockquote>\n  <p><strong>Note</strong>: you can not use syntax like <code>tim &lt;- Name \"tim\" \"lim\"</code> here, since <code>Name</code> is not a function that returns a monadic value).</p>\n</blockquote>\n"}], "owner": {"reputation": 1083, "user_id": 5272159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bee102cff2130800106cdd7d99db787e?s=128&d=identicon&r=PG&f=1", "display_name": "timothyylim", "link": "https://stackoverflow.com/users/5272159/timothyylim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 58077750, "answer_count": 2, "score": 1, "last_activity_date": 1569320079, "creation_date": 1569318925, "question_id": 58077656, "link": "https://stackoverflow.com/questions/58077656/access-data-property-haskell", "title": "Access data property [Haskell]", "body": "<p>I have defined a data type called Name which consists of the type synonyms FirstName and LastName. </p>\n\n<p>How would I print out the first name? I understand how to do it in record syntax but not in the default syntax.</p>\n\n<pre><code>type FirstName = String\ntype LastName = String\n\ndata Name = Name FirstName LastName\n\nmain = do \n      tim &lt;- Name \"tim\" \"lim\"\n      putStrLn (FirstName tim)\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>test.hs:11:17: error:\n    Data constructor not in scope: FirstName :: t0 -&gt; String\n   |\n11 |       putStrLn (FirstName tim)\n   |                 ^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "continuations"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 0, "last_activity_date": 1569333555, "last_edit_date": 1569333555, "creation_date": 1569325278, "answer_id": 58079524, "question_id": 58077208, "link": "https://stackoverflow.com/questions/58077208/is-it-possible-to-simplify-the-definition-of-cont-with-rankntypes/58079524#58079524", "title": "Is it possible to simplify the definition of Cont with RankNTypes?", "body": "<p>This monad (transformer) is also called <code>Codensity</code>: <a href=\"https://hackage.haskell.org/package/kan-extensions-5.2/docs/Control-Monad-Codensity.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/kan-extensions-5.2/docs/Control-Monad-Codensity.html</a></p>\n\n<hr>\n\n<p>You haven't actually implemented <code>reset</code> either, there's more to it than the types. The following equation must be satisfied:</p>\n\n<blockquote>\n<pre><code>reset (shift f &gt;&gt;= k) = reset (f (evalCont . k))\n</code></pre>\n  \n  <p>-- <a href=\"https://hackage.haskell.org/package/transformers-0.5.6.2/docs/Control-Monad-Trans-Cont.html#v:shift\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/transformers-0.5.6.2/docs/Control-Monad-Trans-Cont.html#v:shift</a></p>\n</blockquote>\n"}], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1569333555, "creation_date": 1569317460, "last_edit_date": 1569326369, "question_id": 58077208, "link": "https://stackoverflow.com/questions/58077208/is-it-possible-to-simplify-the-definition-of-cont-with-rankntypes", "title": "Is it possible to simplify the definition of Cont with RankNTypes?", "body": "<p>I'm reading <a href=\"https://www.stackage.org/haddock/lts-14.6/transformers-0.5.6.2/Control-Monad-Trans-Cont.html\" rel=\"nofollow noreferrer\">this implementation</a> of Continuation in Haskell, and find it tricky, most of the time, <code>r</code> is not such important, so we provide <code>reset</code> to make it easy to be replaced.</p>\n\n<p>So I think the <code>r</code> type variable in <code>Cont r a</code> is not necessary to be exposured, maybe we can just use <code>forall r</code> to hide <code>r</code> inside the definition of <code>Cont</code> at all, so following is my try:</p>\n\n<pre><code>{-# language RankNTypes #-}\n\ndata Cont a = MkCont {runCont :: forall r. (a -&gt; r) -&gt; r}\n\n-- try to construct a Cont\nc1 :: Cont Int\nc1 = MkCont ($ 1)\n\nevalCont :: Cont a -&gt; a\nevalCont c = runCont c id\n\n-- mapCont is useless since `f` can only be `id` now\nmapCont :: (forall r. r -&gt; r) -&gt; Cont a -&gt; Cont a\nmapCont f c = (MkCont (f . runCont c))\n\nwithCont :: (forall r. (b -&gt; r) -&gt; a -&gt; r) -&gt; Cont a -&gt; Cont b\nwithCont f c = MkCont (runCont c . f)\n\n-- reset is unnecessary since `r` is hidden\nreset :: Cont a -&gt; Cont a\nreset = id\n\nshift :: (forall r. (a -&gt; r) -&gt; Cont r) -&gt; Cont a\nshift f = MkCont (evalCont . f)\n\n-- don't know how to define `callCC` now ...\ncallCC :: ((a -&gt; Cont b) -&gt; Cont a) -&gt; Cont a\ncallCC = undefined  -- this definition seems impossible to implement\n</code></pre>\n\n<p>But I got a problem when trying to define and implement callCC, if I reference the traditional definition, then it should be</p>\n\n<pre><code>callCC f = MkCont $ \\c1 -&gt; runCont (f (\\x -&gt; MkCont $ \\c2 -&gt; c1 x)) c1\n</code></pre>\n\n<p>But the above code doesn't type check, so did I make some stupid mistake, or it is impossible to define <code>Cont</code> like this?</p>\n\n<p>PS: I'm not sure above type of <code>callCC</code> is the proper one of my definition of <code>Cont</code>, maybe it need some adjust.</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1569320737, "post_id": 58075208, "comment_id": 102550892, "body": "Right, So the question is: are there any combinators that we could use so that we can write a shrink function that preserves the minimum length invariant?"}, {"owner": {"reputation": 98, "user_id": 9224699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ayZoN.png?s=128&g=1", "display_name": "Commodore64", "link": "https://stackoverflow.com/users/9224699/commodore64"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1569413754, "post_id": 58075208, "comment_id": 102588137, "body": "No, there is only <code>listOf1</code>, which preserves the invariant that the minimum length is 1. You can see it does not call some <code>listOfn</code> function internally and also I&#39;m quite familiar with the library and don&#39;t think there is one. I stated in my answer how you could write one."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1569428001, "post_id": 58075208, "comment_id": 102596613, "body": "I meant preserve the invariant during shrinking :)"}, {"owner": {"reputation": 98, "user_id": 9224699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ayZoN.png?s=128&g=1", "display_name": "Commodore64", "link": "https://stackoverflow.com/users/9224699/commodore64"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1569440964, "post_id": 58075208, "comment_id": 102602042, "body": "Well I guess you first have to write a <code>newtype</code> for your list of minimum length, since there is already the instance <code>Arbitrary a =&gt; Arbitrary [a]</code>. Then as the generator you can supply the generator I suggested. As a shrink function you can provide a modified <a href=\"http://hackage.haskell.org/package/QuickCheck-2.11.3/docs/Test-QuickCheck-Arbitrary.html#v:shrinkList\" rel=\"nofollow noreferrer\">shrinkList</a> function (look at the source code) where you <code>takeWhile (&gt; desiredMin) instead of </code>0`. I really don&#39;t know how much more to tell you to help, the Quickcheck documentation is quite excellent and the source code readable."}], "tags": [], "owner": {"reputation": 98, "user_id": 9224699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ayZoN.png?s=128&g=1", "display_name": "Commodore64", "link": "https://stackoverflow.com/users/9224699/commodore64"}, "is_accepted": false, "score": 1, "last_activity_date": 1569310739, "last_edit_date": 1569310739, "creation_date": 1569310285, "answer_id": 58075208, "question_id": 58075073, "link": "https://stackoverflow.com/questions/58075073/quickcheck-combinators-for-shrinking-lists-of-length-within-given-bounds/58075208#58075208", "title": "QuickCheck combinators for shrinking lists of length within given bounds", "body": "<p>If you look at the <a href=\"http://hackage.haskell.org/package/QuickCheck-2.11.3/docs/src/Test.QuickCheck.Gen.html#listOf1\" rel=\"nofollow noreferrer\">source</a> of the <a href=\"http://hackage.haskell.org/package/QuickCheck-2.11.3/docs/Test-QuickCheck-Gen.html#v:listOf1\" rel=\"nofollow noreferrer\">listOf1</a> function you see that it is implemented essentially like in your second code snippet, except it uses the <a href=\"http://hackage.haskell.org/package/QuickCheck-2.11.3/docs/Test-QuickCheck-Gen.html#v:sized\" rel=\"nofollow noreferrer\">sized</a> function, which means the upper bound decreases as shrinks are performed. I think replacing <code>1</code> by your desired minimum bound there should do the trick.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1569310739, "creation_date": 1569309785, "question_id": 58075073, "link": "https://stackoverflow.com/questions/58075073/quickcheck-combinators-for-shrinking-lists-of-length-within-given-bounds", "title": "QuickCheck combinators for shrinking lists of length within given bounds", "body": "<p>Is there's a <code>QuickCheck</code> function to produce a list whose length is in a given range, similar to what one would achieve with <a href=\"https://www.stackage.org/haddock/lts-14.6/hedgehog-1.0/Hedgehog-Gen.html#v:list\" rel=\"nofollow noreferrer\"><code>hedgegog</code></a>, e.g.:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Gen.list (Range.constant 5 13) someGen\n</code></pre>\n\n<p>I guess one would write something like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>  do\n    n &lt;- choose (minLength, maxLength)\n    vectorOf n genA\n</code></pre>\n\n<p>making such function superfluous, but then I wonder whether there are <code>QuickCheck</code> combinators to shrink lists whose invariant is that they should have a minimum length. A <code>shrink</code> definition like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>  filter ((minLength &lt;=) . length) [ xs' | xs' &lt;- shrink xs ]\n</code></pre>\n\n<p>seems to be quite inefficient, since we're shrinking terms which we could see in advance that are not valid (since the length will be lower than the minimum threshold).</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1569308029, "post_id": 58074459, "comment_id": 102544217, "body": "Yeah agree, maybe it&#39;s a typo and they meant <code>[Branch x&#39; l&#39; r&#39; | x&#39; &lt;- shrink x | l&#39; &lt;- shrink l | r&#39; &lt;- shrink r]</code> back when parallel list comprehensions were in vogue?"}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1569309962, "post_id": 58075070, "comment_id": 102545096, "body": "I see, so maybe the comment should be rephrased to say that shrinking <i>could</i> stop if one of the three is fully shrink (and not <i>once</i>), or something like that..."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1569310668, "post_id": 58075070, "comment_id": 102545437, "body": "I mean, even if it&#39;s not the case that one is fully shrunk, we skip over some valid shrinks. Imagine (1, 1, 1): there are 7 valid shrinks, but a nested list comprehension over the three shrinks misses stuff like (1, 0, 1), yielding only (0, 0, 0)."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1569311666, "post_id": 58075070, "comment_id": 102545902, "body": "@DamianNadales 1. No, shrinking <i>will definitely</i> stop if one of the components is fully shrunk, as it says. Because then you have something like <code>[... | x&#39; &lt;- [], ...]</code> and this is always empty. 2. &quot;and not once&quot; Here &quot;once&quot; means &quot;as soon as&quot;, not &quot;one time&quot;."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1569314043, "post_id": 58075070, "comment_id": 102547010, "body": "Also see the <a href=\"http://hackage.haskell.org/package/successors\" rel=\"nofollow noreferrer\"><code>successors</code></a> package, which gives you an functor to model that \u201cone step in one field\u201d idea."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 3, "last_activity_date": 1569309779, "creation_date": 1569309779, "answer_id": 58075070, "question_id": 58074459, "link": "https://stackoverflow.com/questions/58074459/why-does-shrinking-stop-once-one-of-the-terms-is-fully-shrunk/58075070#58075070", "title": "Why does shrinking stop once one of the terms is fully shrunk", "body": "<p>The proposed code <em>is</em> wrong, because we only consider shrinks that shrink all three of the terms by at least one step. To see the problem, imagine all three candidates are <code>Int</code>:</p>\n\n<pre><code>x = 1\nl = 0\nr = 2\n</code></pre>\n\n<p>Then we have</p>\n\n<pre><code>shrink x = [0]\nshrink l = []\nshrink r = [1, 0]\n</code></pre>\n\n<p>A nested list comprehension over these three lists will yield no values, because no suitable candidate for <code>l</code> can be found. So we never try some valid shrinks like <code>(0, 0, 1)</code>. The <code>shrink</code> instance for tuples does the right thing (suggesting each shrink where <em>at least one</em> term can be shrunk), so mapping over that solves the problem.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58075070, "answer_count": 1, "score": 5, "last_activity_date": 1569309779, "creation_date": 1569307341, "last_edit_date": 1569307421, "question_id": 58074459, "link": "https://stackoverflow.com/questions/58074459/why-does-shrinking-stop-once-one-of-the-terms-is-fully-shrunk", "title": "Why does shrinking stop once one of the terms is fully shrunk", "body": "<p>I'm looking at the comments in <a href=\"https://www.stackage.org/haddock/lts-14.6/QuickCheck-2.13.2/Test-QuickCheck.html#v:shrink\" rel=\"noreferrer\"><code>shrink</code></a>:</p>\n\n<blockquote>\n  <p>It is tempting to write the last line as <code>[Branch x' l' r' | x' &lt;- shrink x, l' &lt;- shrink l, r' &lt;- shrink r]</code> but this is the wrong thing! It will force QuickCheck to shrink <code>x</code>, <code>l</code> and <code>r</code> in tandem, and shrinking will stop once one of the three is fully shrunk.</p>\n</blockquote>\n\n<p>I'm a bit puzzled about this, I thought that the problem with that shrink was that we're taking the cartesian product of the shrinks of the subterms, which might be quite large. I don't get why shrinking will stop once one of the three is fully shrunk.</p>\n\n<p>So in other words, I thought the definition above would compute all combinations of shrinks of <code>x</code>, <code>l</code>, and <code>r</code>, but I wouldn't expect shrink to stop once one the the terms is fully shrunk.</p>\n"}, {"tags": ["haskell", "indexof"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1569309111, "post_id": 58073233, "comment_id": 102544686, "body": "For non-total functions, it is common to return a <code>Maybe</code>, so a <code>Maybe Int</code>, where we return a <code>Nothing</code> if an element is not found, or <code>Just i</code> when it found an item on index <code>i</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1569312355, "post_id": 58073366, "comment_id": 102546244, "body": "Note we can omit the <code>n</code> argument in <code>go</code>."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 7, "last_activity_date": 1569301432, "creation_date": 1569301432, "answer_id": 58073366, "question_id": 58073233, "link": "https://stackoverflow.com/questions/58073233/finding-the-index-of-an-element-in-a-list/58073366#58073366", "title": "Finding the index of an element in a list", "body": "<p>The way I'd solve it is create another recursive function with the same singature plus additional <code>Int</code> parameter to work as accumulator:</p>\n\n<pre><code>indexOf :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nindexOf n xs = go 0 n xs\n    where\n        go i n [] = (-1)\n        go i n (x:xs)\n             | n == x    = i\n             | otherwise = go (i+1) n xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 5, "last_activity_date": 1569301606, "creation_date": 1569301606, "answer_id": 58073389, "question_id": 58073233, "link": "https://stackoverflow.com/questions/58073233/finding-the-index-of-an-element-in-a-list/58073389#58073389", "title": "Finding the index of an element in a list", "body": "<p>Instead of a counter (increment as you go down the list) you can also modify the return value as you go back up again:</p>\n\n<pre><code>indexOf :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nindexOf n [] = -1\nindexOf n (x:xs)\n    | n == x    = 0\n    | otherwise = case n `indexOf` xs of\n        -1 -&gt; -1\n        i  -&gt; i + 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1569310650, "creation_date": 1569310650, "answer_id": 58075302, "question_id": 58073233, "link": "https://stackoverflow.com/questions/58073233/finding-the-index-of-an-element-in-a-list/58075302#58075302", "title": "Finding the index of an element in a list", "body": "<p>In Haskell, one usually uses a <code>Maybe a</code> to return a value <code>a</code>, but when not all input per se is valid. For invalid input, we return <code>Nothing</code>, for valid, we return <code>Just x</code> with <code>x</code> the result.</p>\n\n<p>We thus can implement the <code>indexOf</code> where we map the empty list on <code>Nothing</code>. In case the first item of the list is equal to the item we are looking for, we return <code>Just 0</code>. In case the first item is not equal to the item we are looking for, we recurse on the tail of the list, and increment the value wrapped in the <code>Just</code>, given there is such value:</p>\n\n<pre><code>indexOf :: Eq a =&gt; a -&gt; [a] -&gt; <b>Maybe Int</b>\nindexOf y = go\n    where go [] = Nothing\n          go (x:xs) | x == y = Just 0\n                    | otherwise = (1+) &lt;$&gt; go xs</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1569313569, "last_edit_date": 1569313569, "creation_date": 1569312904, "answer_id": 58075890, "question_id": 58073233, "link": "https://stackoverflow.com/questions/58073233/finding-the-index-of-an-element-in-a-list/58075890#58075890", "title": "Finding the index of an element in a list", "body": "<p>This function is already present in the library (<a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:elemIndex\" rel=\"nofollow noreferrer\"><code>elemIndex</code></a>), but let's implement it anyway.</p>\n\n<p>Given <code>xs = [x0,x1,...]</code>, we have <code>zip xs [0..] = [(x0,0),(x1,1),...]</code>. We can then search on the latter list for a pair satisfying the predicate <code>\\(x,_) -&gt; x==n</code>.</p>\n\n<pre><code>import Data.List\n\nindexOf :: (Eq a) =&gt; a -&gt; [a] -&gt; Maybe Int\nindexOf n xs = fmap snd . find (\\(x,_) -&gt; x==n) $ zip xs [0..]\n</code></pre>\n\n<p>Above, <code>zip</code> adds indices, <code>find</code> will return <code>Just (n,index)</code> on success, and the <code>fmap snd</code> transforms that into <code>Just index</code>.</p>\n\n<p>Note how we prefer to return <code>Nothing</code> instead of <code>-1</code>, which is not idiomatic in Haskell, where we prefer using <code>Maybe</code> instead.</p>\n\n<p>Finally, note that the above code is not inefficient: thanks to laziness, <code>zip</code> will only add the indices to those elements which are demanded by <code>find</code>, so it will not scan the whole list unless the wanted element is not found.</p>\n\n<p>As an exercise, you might want to code <code>fmap snd . find (\\(x,_) -&gt; x==n)</code> with explicit recursion.</p>\n"}], "owner": {"reputation": 398, "user_id": 10412159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7782a6cbe4dca019ebe564903960341a?s=128&d=identicon&r=PG&f=1", "display_name": "larn", "link": "https://stackoverflow.com/users/10412159/larn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1569313569, "creation_date": 1569300277, "last_edit_date": 1569302309, "question_id": 58073233, "link": "https://stackoverflow.com/questions/58073233/finding-the-index-of-an-element-in-a-list", "title": "Finding the index of an element in a list", "body": "<p>I'm a beginner in Haskell and I've been having trouble with my practice programs. For this particular one, I want to find the index of an element in a list (the first element being at 0). \nIf the element given does not appear in the list, I am having the program return -1. </p>\n\n<p>Here is my code: </p>\n\n<pre><code>indexOf :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nindexOf n [] = (-1)\nindexOf n (x:xs)\n    | n == x    = length(xs)\n    | otherwise = n `indexOf` xs\n</code></pre>\n\n<p>I have experience in both C and Java, so my gut instinct is to get a counter to increment every time I go through the list, but, I keep reminding myself that isn't how Haskell works. \nI'm aware that my code is shifting the head of the list every time it goes through and when I do \"length(xs)\", it is merely finding the length of the remainder of the list.\nClearly, I'm very stumped here. Can anyone offer any pointers or recommendations on how I can get this piece of code to work?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 3, "creation_date": 1569293957, "post_id": 58072458, "comment_id": 102540294, "body": "What&#39;s the obstacle which you have? You&#39;ve written the code for 2nd from the last element, and there is nothing essentially different about 3rd from the last element. I can&#39;t help but suspect that the current code is not created by you."}, {"owner": {"reputation": 398, "user_id": 10412159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7782a6cbe4dca019ebe564903960341a?s=128&d=identicon&r=PG&f=1", "display_name": "larn", "link": "https://stackoverflow.com/users/10412159/larn"}, "edited": false, "score": 2, "creation_date": 1569294516, "post_id": 58072458, "comment_id": 102540377, "body": "@dyukha Funnily enough, I found the solution to my problem when trying to explain myself to you. In that final line of code, I just tacked on another &quot;init&quot;. I was definitely just overthinking what had to be done."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 2, "creation_date": 1569295711, "post_id": 58072458, "comment_id": 102540565, "body": "Good, but you should check how it behaves on list <code>[1, 2]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 1, "last_activity_date": 1569307493, "last_edit_date": 1569307493, "creation_date": 1569295747, "answer_id": 58072692, "question_id": 58072458, "link": "https://stackoverflow.com/questions/58072458/finding-third-to-last-element-in-haskell/58072692#58072692", "title": "Finding third to last element in Haskell?", "body": "<p>You were somewhere close, but if you want to do it with pattern matching, make the patter with three elements, and in the recursion part, remove from the back:</p>\n\n<pre><code>msg = \"The list is empty. Cannot return the antepenultimate element.\"\nerr = error msg\nantepenultimate :: [a] -&gt; a\nantepenultimate [] = err\nantepenultimate [_] = err\nantepenultimate [_,_] = err\nantepenultimate [antepenultimateElem,_, _] = antepenultimateElem\nantepenultimate xs = antepenultimate $ tail xs\n</code></pre>\n\n<p>examples:</p>\n\n<pre><code>   antepenultimate [1,2,3]\n=&gt; 1\n   antepenultimate [1,2,3,4]\n=&gt; 2\n   antepenultimate [1,2,3,4,5]\n=&gt; 3\n   antepenultimate [1,2,3,4,5,6]\n=&gt; 4\n   antepenultimate [1,2,3,4,5,6,7]\n=&gt; 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 685, "user_id": 4961930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca9291fdc7f227e71e0ee6b0127ce7?s=128&d=identicon&r=PG&f=1", "display_name": "duyue", "link": "https://stackoverflow.com/users/4961930/duyue"}, "is_accepted": false, "score": 1, "last_activity_date": 1569479371, "last_edit_date": 1569479371, "creation_date": 1569309132, "answer_id": 58074892, "question_id": 58072458, "link": "https://stackoverflow.com/questions/58072458/finding-third-to-last-element-in-haskell/58074892#58074892", "title": "Finding third to last element in Haskell?", "body": "<pre class=\"lang-hs prettyprint-override\"><code>antepenultimate :: [a] -&gt; a\nantepenultimate xs = let xslen = length xs in \n                        if xslen &lt; 3\n                            then error \"The list is too short to return the antepenultimate element.\"\n                        else xs !! (xslen - 3)\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 2, "last_activity_date": 1569480307, "last_edit_date": 1569480307, "creation_date": 1569352886, "answer_id": 58086935, "question_id": 58072458, "link": "https://stackoverflow.com/questions/58072458/finding-third-to-last-element-in-haskell/58086935#58086935", "title": "Finding third to last element in Haskell?", "body": "<p>I like Dami\u00e1n Rafael Lattenero's answer: it demonstrates how a beginner can use pattern matching to solve this problem. It has the problem, though, that if you want some number other than 3rd-last, you have to rewrite your function; and furthermore the number of cases you write corresponds to how far from the back of the list you want to go. Imagine using this technique for the 100th-last element! It also does a lot of unnecessary work: once you make it past the first set of guards, you know they will never match again; but you're still constantly having to check \"Hey, is the rest of the list empty? Does it have one element? What about two?\" So as I say, a good solution for a beginner, but not ideal.</p>\n\n<p>duyue's answer addresses these problems, but at the cost of traversing the list twice: once to find its length, and then again to look up the right index. Very simple and clear, but problematic if the list is too large to hold in memory all at once.</p>\n\n<p>It would be better if we could somehow traverse the list just once, keeping in mind at all times the element we saw three steps ago; then when the list ends we can just return the right element. An intermediate solution might be to write this recursion by hand:</p>\n\n<pre><code>antepenultimate [] = undefined\nantepenultimate [_] = undefined\nantepenultimate [_,_] = undefined\nantepenultimate (a:b:c:xs) = go a b c xs\n  where go a _ _ [] = a\n        go a b c (x:xs) = go b c x xs\n</code></pre>\n\n<p>A somewhat more advanced solution uses the well-known technique of zipping a list with an offset version of itself to have access to two items at once:</p>\n\n<pre><code>antepenultimate xs = last $ zipWith const xs (drop 2 xs)\n</code></pre>\n\n<p>Finally, someone even more familiar with Haskell might recognize the <code>zipWith const xs (drop 2 xs)</code> pattern as being amenable to Applicative style, yielding:</p>\n\n<pre><code>antepenultimate = last . (zipWith const &lt;*&gt; drop 2)\n</code></pre>\n\n<p>Some people will argue this is less readable than the previous version; I have no strong opinions on that, but I do think it is the most elegant/advanced even if another approach is more readable.</p>\n"}], "owner": {"reputation": 398, "user_id": 10412159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7782a6cbe4dca019ebe564903960341a?s=128&d=identicon&r=PG&f=1", "display_name": "larn", "link": "https://stackoverflow.com/users/10412159/larn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 58086935, "answer_count": 3, "score": 1, "last_activity_date": 1569480307, "creation_date": 1569293660, "question_id": 58072458, "link": "https://stackoverflow.com/questions/58072458/finding-third-to-last-element-in-haskell", "title": "Finding third to last element in Haskell?", "body": "<p>I am currently learning Haskell, but I am having some trouble figuring out how to tackle this problem. I would like my code to find the third to last element of a list, but currently, my code finds the second to last element of a list. </p>\n\n<pre><code>antepenultimate :: [a] -&gt; a\nantepenultimate [] = error \"The list is empty. Cannot return the antepenultimate element.\"\nantepenultimate [x] = error \"The list is too short to return the antepenultimate element.\"\nantepenultimate xs = last $ init xs \n</code></pre>\n\n<p>I am not sure how to modify my code so that it returns the elements I want it to. Can anyone offer any pointers? </p>\n"}, {"tags": ["list", "haskell", "type-mismatch", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1569284091, "post_id": 58071474, "comment_id": 102538617, "body": "Variable in Haskell are immutable. You can&#39;t change their value during program run. Use recursion instead."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 3, "creation_date": 1569284870, "post_id": 58071474, "comment_id": 102538750, "body": "<code>p ++ [\u2026]</code> doesn&#39;t change <code>p</code>. It creates a new list. And because that happens in a <code>do</code> block with return type <code>IO</code>, the compiler complains that it&#39;s a list not an IO action. Give <code>myLoop</code> a list parameter, call it initially with the empty list in <code>main</code>, and append to it before passing the new list to the recursive call."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569443885, "post_id": 58071629, "comment_id": 102603216, "body": "after fixing it, maybe comment on how <code>p</code> isn&#39;t used at all in the end, and fixing <i>that</i>, the algorithms is quadratic. probable fixes: cons-and-reverse; using difference list (<code>(xs ++)</code>) encoding instead of plain <code>++</code>; or restructure the <code>do</code> block to non-tail-recursive, <code>sequence</code>-like structure (<code>getPoints =~ [ p:ps | p &lt;- getLine, ps &lt;- getPoints</code>, writing with &quot;monad comprehensions&quot; for brevity)."}], "tags": [], "owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "is_accepted": false, "score": 5, "last_activity_date": 1569287739, "last_edit_date": 1569287739, "creation_date": 1569284918, "answer_id": 58071629, "question_id": 58071474, "link": "https://stackoverflow.com/questions/58071474/couldnt-match-type-with-io-error-in-haskell/58071629#58071629", "title": "&quot;Couldn&#39;t match type \u2018[]\u2019 with \u2018IO\u2019&quot; error in Haskell", "body": "<p>First of all, do-notation is syntactic sugar with the following rules:</p>\n\n<pre><code>do x &lt;- mA\n   mB\n</code></pre>\n\n<p>roughly* desugars to <code>mA &gt;&gt;= \\x -&gt; do mB</code>, where <code>mA</code> has type <code>Monad m =&gt; m a</code> and <code>do mB</code> has type <code>Monad m =&gt; m b</code> for some types <code>m</code>, <code>a</code>, and <code>b</code>.</p>\n\n<pre><code>do mA\n   mB\n</code></pre>\n\n<p>desugars to <code>mA &gt;&gt; do mB</code>, where <code>mA</code> has type <code>Monad m =&gt; m a</code> and <code>do mB</code> has type <code>Monad m =&gt; m b</code> for some types <code>m</code>, <code>a</code>, and <code>b</code>.</p>\n\n<pre><code>do a\n</code></pre>\n\n<p>desugars to <code>a</code>.</p>\n\n<p><code>main</code> is a special name that represents the entrypoint of the program, and it has type <code>IO a</code> for some type <code>a</code>. Because you define <code>main = myLoop</code>, <code>myLoop</code> must also have type <code>IO a</code>.</p>\n\n<p>Therefore, in your <code>myLoop</code> function:</p>\n\n<pre><code>myLoop  = do \n            let p = []\n            done &lt;- isEOF\n            if done\n              then putStrLn \"\"\n              else do inp &lt;- getLine\n                      let (label:coord) = words inp\n                      p ++  [Point label (map getFloat coord)]\n                      -- print (pointerList)\n                      myLoop \n</code></pre>\n\n<p>the <code>do</code>-block is working with the type <code>m</code> = <code>IO</code>. Therefore, when you write <code>p ++  [Point label (map getFloat coord)]</code>, the typechecker expects a value of type <code>IO c</code>, for some type <code>c</code>.</p>\n\n<p>However, <code>p ++  [Point label (map getFloat coord)]</code> has type <code>[Point]</code>, resulting in the type error <code>Cannot match type '[]' with 'IO'</code>.</p>\n\n<p>As the type mismatch indicates, your code does not make sense. I assume that you want to append <code>Point label (map getFloat coord)</code> to <code>p</code>. <code>++</code> does <em>not</em> mutate <code>p</code>; it <em>creates a new list!</em> Idiomatic Haskell uses recursion to achieve what you want. The most direct way of fixing your code would be to do the following:</p>\n\n<pre><code>main = myLoop []\nmyLoop p = do\n    done &lt;- isEOF\n    if done\n    then putStrLn \"\"\n    else do inp &lt;- getLine \n            let (label:coord) = words inp\n            let p' = p ++  [Point label (map getFloat coord)]\n            myLoop  p'\n</code></pre>\n\n<p>Here, <code>myLoop</code> takes <code>p</code> as a parameter and recursively passes an updated <code>p</code> to itself after reading input. <code>main</code> calls <code>myLoop</code> with an argument of <code>[]</code>, which is the initial value of <code>p</code>.</p>\n\n<p>The Haskell Wikibook has <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"noreferrer\">a good explanation of do-notation</a>. In general, I would recommend reading the Haskell Wikibook to better understand Haskell.</p>\n\n<p>*I say \"roughly\" because these aren't the exact rules. The Wikibook article explains do-notation in depth.</p>\n"}], "owner": {"reputation": 80, "user_id": 5369839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-trqlIFhozCU/AAAAAAAAAAI/AAAAAAAAAB0/0Wt1bORIQOE/photo.jpg?sz=128", "display_name": "Alvaro Marques", "link": "https://stackoverflow.com/users/5369839/alvaro-marques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1569419793, "creation_date": 1569283187, "last_edit_date": 1569419793, "question_id": 58071474, "link": "https://stackoverflow.com/questions/58071474/couldnt-match-type-with-io-error-in-haskell", "title": "&quot;Couldn&#39;t match type \u2018[]\u2019 with \u2018IO\u2019&quot; error in Haskell", "body": "<p>I am trying to make a list with Points (a datatype that I created), the idea is add an element in each iteration. Something is wrong.</p>\n\n<p>I have tried to put <code>p</code> out of <code>myLoop</code> but it doesn't seems to work either.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = myLoop \nmyLoop  = do \n            let p = []\n            done &lt;- isEOF\n            if done\n              then putStrLn \"\"\n              else do inp &lt;- getLine\n                      let (label:coord) = words inp\n                      p ++  [Point label (map getFloat coord)]\n                      -- print (pointerList)\n                      myLoop \n</code></pre>\n\n<p>I am getting this output</p>\n\n<pre><code>trabalho.hs:30:23: error:\n    \u2022 Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\n      Expected type: IO Point\n        Actual type: [Point]\n    \u2022 In a stmt of a 'do' block:\n        p ++ [Point label (map getFloat coord)]\n      In the expression:\n        do inp &lt;- getLine\n           let (label : coord) = words inp\n           p ++ [Point label (map getFloat coord)]\n           myLoop\n      In a stmt of a 'do' block:\n        if done then\n            putStrLn \"\"\n        else\n            do inp &lt;- getLine\n               let (label : coord) = ...\n               p ++ [Point label (map getFloat coord)]\n               ....\n   |\n30 |                       p ++  [Point label (map getFloat coord)]\n   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["if-statement", "haskell", "syntax"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1569282078, "post_id": 58071196, "comment_id": 102538236, "body": "Not a quick answer I&#39;m afraid, but if you&#39;re new to Haskell then I seriously recommend <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a>. Amongst so much else, this will teach you how to write idiomatic Haskell code, using higher-order functions - then you will see how to find the min and max of a list in just one line of code rather than having to do all these ugly if/else statements. (Although even doing it naively, there are much better options than this ugly divide-and-conquer. And needless to say, there are standard library functions to find the min and max of a list.)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 3, "creation_date": 1569282822, "post_id": 58071196, "comment_id": 102538378, "body": "You&#39;re missing the <code>=</code> between <code>minMax x</code> and the body of the function again."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1569285447, "post_id": 58071196, "comment_id": 102538869, "body": "FWIW splitting the list in half doesn&#39;t seem very useful for this purpose. The best you can do is a linear scan of the elements anyway, so why not just do it that way?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1569308408, "post_id": 58071196, "comment_id": 102544377, "body": "there is no assignment in Haskell. names can be defined to refer to values, with <code>let</code> or <code>where</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1569311724, "post_id": 58071196, "comment_id": 102545930, "body": "As a thumb rule, you should avoid partial functions like <code>head,tail,!!</code> in your code, and use pattern matching instead which usually leads to much simpler code. <code>length xs == 1</code> is also an antipattern costing O(N) when an O(1) pattern match suffices and provides the head &amp; tail for free."}], "answers": [{"comments": [{"owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "edited": false, "score": 1, "creation_date": 1569286864, "post_id": 58071720, "comment_id": 102539122, "body": "I forgot to add: <code>tail</code> is a method that returns the list with the first element removed. It looks like you were trying to use it to return the last item in the list. Since the list will only have two elements in it, I replaced <code>tail</code> with <code>head $ tail</code> which should do what you want."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1569307252, "post_id": 58071720, "comment_id": 102543884, "body": "Or you could just use <code>last</code>, which does indeed give the last element of a list (but like all these functions, crashes your program if you give it an empty list)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1569312044, "post_id": 58071720, "comment_id": 102546100, "body": "In your different implementation, I would instead use <code>minMax&#39; a b (x:xs) = minMax&#39; (min a x) (max b x) xs</code> and remove the second <code>[x]</code> case. There is no need to consume two elements at each recursion. <code>minMax (x:xs) = minMax&#39; x x xs</code> should also work similarly. Also, the OP should consider returning <code>Maybe (Int, Int)</code> instead -- returning <code>[Int]</code> feels wrong."}, {"owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1569343574, "post_id": 58071720, "comment_id": 102563605, "body": "@chi Oh yeah, good point. <code>Maybe (Int, Int)</code> seems way more idiomatic. I wanted the method to match the Retsek specification, but I guess since he asked for a more Haskell way to do it, there is no reason to stick to <code>[Int]</code>"}, {"owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1569343762, "post_id": 58071720, "comment_id": 102563695, "body": "@chi Oh yeah, and that makes way more sense. I don&#39;t know why I was recursively taking two elements."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569351654, "post_id": 58071720, "comment_id": 102566968, "body": "It&#39;s not a method; it&#39;s a function. Methods are in classes."}], "tags": [], "owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "is_accepted": true, "score": 4, "last_activity_date": 1569351629, "last_edit_date": 1569351629, "creation_date": 1569286142, "answer_id": 58071720, "question_id": 58071196, "link": "https://stackoverflow.com/questions/58071196/struggling-with-haskell-syntax-with-ifs-and-elses/58071720#58071720", "title": "Struggling with Haskell syntax with if&#39;s and else&#39;s", "body": "<p>There are several things in your function that isn't valid Haskell syntax. You are missing a <code>=</code>, and you are trying to declare variables in a way Haskell doesn't allow.</p>\n\n<p>I tried to rearrange your code to be correct and here is what I got:</p>\n\n<pre><code>splitlist :: [a] -&gt; ([a], [a])\nsplitlist xs = splitAt ((length xs + 1) `div` 2) xs\n\nminMax :: [Int] -&gt; [Int]\nminMax x = if length x == 1 then \n              [head x, head x]\n           else if length x == 2 then \n                    if (head x &gt; (head $ tail x)) then \n                      [(head $ tail x), head x]\n                    else \n                      [head x, (head $ tail x)]\n                else [if (minMax1!!0 &lt; minMax2!!0) then minMax1!!0 else minMax2!!0,\n                      if (minMax1!!1 &gt; minMax2!!1) then minMax1!!1 else minMax2!!1]\n  where\n        listOfLists = splitlist x\n        list1 = fst listOfLists\n        list2 = snd listOfLists\n        minMax1 = minMax list1\n        minMax2 = minMax list2\n</code></pre>\n\n<p>It looks like your algorithm works as expected! It was a little tricky because this isn't usually the way most people tend to write Haskell methods.</p>\n\n<p>Here is a different implementation that might be useful for comparison:</p>\n\n<pre><code>minMax        :: [Int] -&gt; [Int]\nminMax []     = []\nminMax (x:xs) = minMax' x x xs\n  where\n    minMax' a b []     = [a, b]\n    minMax' a b (x:xs) = minMax' (min a x) (max b x) xs\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 11846850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b266570180a2815e43051b51c3ec8214?s=128&d=identicon&r=PG&f=1", "display_name": "Retsek", "link": "https://stackoverflow.com/users/11846850/retsek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 58071720, "answer_count": 1, "score": 1, "last_activity_date": 1569351629, "creation_date": 1569280290, "question_id": 58071196, "link": "https://stackoverflow.com/questions/58071196/struggling-with-haskell-syntax-with-ifs-and-elses", "title": "Struggling with Haskell syntax with if&#39;s and else&#39;s", "body": "<p>I'm struggling with the syntax of Haskell and am getting receiving \"error: parse error on input \u2018if\u2019\" when I try to compile my script with GHCI. The aim of my code is to return the minimum and maximum of an unordered list. It does this recursively by splitting the list in half and finding the minimum and maximum of each half. If the list has only one element it simply returns that that element is both the maximum and the minimum, if the list has two elements it does a simple comparison to find the minimum and maximum. Here is my code, the \"splitlist\" function was taken from an online resource:</p>\n\n<pre><code>splitlist :: [a] -&gt; ([a], [a])\nsplitlist xs = splitAt ((length xs + 1) `div` 2) xs\n\nminMax :: [Int] -&gt; [Int]\nminMax x\n    if length x == 1 then \n        [x, x]\n    else if length x == 2 then \n        if (head x &gt; tail x) then \n            [tail x, head x]\n        else \n            [head x, tail x]\n    else \n        listOfLists = splitlist x\n        list1 = listOfLists!!0\n        list2 = listOfLists!!1\n        minMax1 = minMax list1\n        minMax2 = minMax list2\n        if (minMax1!!0 &lt; minMax2!!0) then \n            min = minMax1!!0\n        else \n            min = minMax2!!0\n        if (minMax!!1 &gt; minMax2!!1) then \n            max = minMax1!!1\n        else\n            max = minMax2!!1\n        [min, max]\n</code></pre>\n\n<p>I am also suspicious that I am not attempting to do this in a way that Haskell was meant for, I'm a beginner and still accidentally treat it like python quite a lot. Ideally if someone could tell me what I'm doing wrong with my method and then show me a method more in line with Haskell's design principles I would be very appreciative.</p>\n"}, {"tags": ["if-statement", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1569269263, "post_id": 58069510, "comment_id": 102534702, "body": "<code>if</code>s, etc. are usually written with guards."}, {"owner": {"reputation": 215, "user_id": 11846850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b266570180a2815e43051b51c3ec8214?s=128&d=identicon&r=PG&f=1", "display_name": "Retsek", "link": "https://stackoverflow.com/users/11846850/retsek"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569269466, "post_id": 58069510, "comment_id": 102534788, "body": "@WillemVanOnsem would you be as kind to type this code out with guards?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569271335, "post_id": 58069510, "comment_id": 102535525, "body": "@WillemVanOnsem True, but we can nest <code>if</code>s, while we can not nest guards. (That being said, deeply nested <code>if</code>s usually are a code smell.)"}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 11846850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b266570180a2815e43051b51c3ec8214?s=128&d=identicon&r=PG&f=1", "display_name": "Retsek", "link": "https://stackoverflow.com/users/11846850/retsek"}, "edited": false, "score": 1, "creation_date": 1569269589, "post_id": 58069578, "comment_id": 102534853, "body": "I know it tells me not to just comment &quot;Thanks&quot; but thank-you so much :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1569270244, "last_edit_date": 1569270244, "creation_date": 1569269542, "answer_id": 58069578, "question_id": 58069510, "link": "https://stackoverflow.com/questions/58069510/struggling-with-parsing-if-statements-and-code-layout-in-haskell/58069578#58069578", "title": "Struggling with parsing if statements and code layout in Haskell", "body": "<p>Actually you was very close, you only forgot an equals sign (<code>=</code>) at the start:</p>\n\n<pre><code>example x <b>=</b> if x == 2 then &quot;Input is 2&quot;\n        else if x &gt; 2 then if x == 3 then &quot;Input is 3&quot;\n                else &quot;Input is greater than 3&quot;\n            else &quot;Dunno&quot;</code></pre>\n\n<p>In Haskell, one does not often use <code>if&hellip;then&hellip;else&hellip;</code>. Usually <em>guards</em> are used, or pattern matching. Here a more elegant way to write it with a combination of pattern matching and guards is:</p>\n\n<pre><code>example :: Int -&gt; String\nexample 2 = \"Input is 2\"\nexample 3 = \"Input is 3\"\nexample x | x &gt; 3 = \"Input is greater than 3\"\n          | otherwise = \"Dunno\"</code></pre>\n\n<p>I think it makes it more clear what logic is performed here. Basically every line covers a case, on the left side of the <code>=</code>, we see the condition, on the right side, we see the result.</p>\n"}, {"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": false, "score": 5, "last_activity_date": 1569269615, "creation_date": 1569269615, "answer_id": 58069590, "question_id": 58069510, "link": "https://stackoverflow.com/questions/58069510/struggling-with-parsing-if-statements-and-code-layout-in-haskell/58069590#58069590", "title": "Struggling with parsing if statements and code layout in Haskell", "body": "<p>You can format it like you would in Python, indenting each level of nesting:</p>\n\n<pre><code>example x =\n    if x == 2 then\n        \"Input is 2\"\n    else\n        if x &gt; 2 then\n            if x == 3 then\n                \"Input is 3\"\n            else\n                \"Input is greater than 3\"\n        else\n            \"Dunno\"\n    else\n        \"Dunno\"\n</code></pre>\n\n<p>At that point, it becomes obvious that it doesn\u2019t make any sense, because there are more <code>else</code>s than <code>if</code>s.</p>\n\n<p>But you don\u2019t usually nest that many <code>if</code>s in Haskell anyway, since pattern matching and guards exist.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1569270447, "last_edit_date": 1569270447, "creation_date": 1569269918, "answer_id": 58069652, "question_id": 58069510, "link": "https://stackoverflow.com/questions/58069510/struggling-with-parsing-if-statements-and-code-layout-in-haskell/58069652#58069652", "title": "Struggling with parsing if statements and code layout in Haskell", "body": "<p>Assuming that we need to keep the <code>if</code>s as they are, I would use this indentation</p>\n\n<pre><code>if condition\nthen result1\nelse result2\n</code></pre>\n\n<p>resulting in</p>\n\n<pre><code>example x =\n    if x == 2\n    then \"Input is 2\"\n    else if x &gt; 2\n         then if x == 3\n              then \"Input is 3\"\n              else \"Input is greater than 3\"\n         else \"Dunno\"\n</code></pre>\n\n<p>(Note: I removed the additional <code>else \"Dunno\"</code> found in the original code, since it is a mistake)</p>\n\n<p>Alternatively:</p>\n\n<pre><code>example x =\n    if x == 2 then\n       \"Input is 2\"\n    else if x &gt; 2 then\n       if x == 3 then\n          \"Input is 3\"\n       else\n          \"Input is greater than 3\"\n    else\n       \"Dunno\"\n</code></pre>\n\n<p>is also nice since it avoids the \"staircase effect\", where indentation keeps increasing. This is because we follow the scheme</p>\n\n<pre><code>if condition1 then\n   result1\nelse if condition2 then\n   result2\nelse if condition3 then\n   result3\n...\nelse\n   resultN\n</code></pre>\n\n<p>Of course, for this specific example I would actually use guards and pattern matching instead.</p>\n\n<pre><code>example 2 = \"Input is 2\"\nexample 3 = \"Input is 3\"\nexample x\n   | x &gt; 2 = \"Input is greater than 3\"\n   | otherwise = \"Dunno\"\n</code></pre>\n\n<p>(possibly readjusting the <code>x &gt; 2</code> to <code>x &gt; 3</code>, which is equivalent on integers, but more readable here)</p>\n"}], "owner": {"reputation": 215, "user_id": 11846850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b266570180a2815e43051b51c3ec8214?s=128&d=identicon&r=PG&f=1", "display_name": "Retsek", "link": "https://stackoverflow.com/users/11846850/retsek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58069578, "answer_count": 3, "score": -1, "last_activity_date": 1569274330, "creation_date": 1569269232, "last_edit_date": 1569274330, "question_id": 58069510, "link": "https://stackoverflow.com/questions/58069510/struggling-with-parsing-if-statements-and-code-layout-in-haskell", "title": "Struggling with parsing if statements and code layout in Haskell", "body": "<p>The code here is nonsense and I know it, I don't want a different solution to this problem because this is just to highlight my issue not the actual goal. This is my code:</p>\n\n<pre><code>example x\n    if x == 2 then \"Input is 2\"\n        else if x &gt; 2 then if x == 3 then \"Input is 3\"\n                else \"Input is greater than 3\"\n            else \"Dunno\"\n        else \"Dunno\"\n</code></pre>\n\n<p>My intended input -> output is:</p>\n\n<pre><code>-- input\n[0, 1, 2, 3, 4] \n-- output\n[\"Dunno\", \"Dunno\", \"Input is 2\", \"Input is 3\", \"Input is greater than 3\"]\n</code></pre>\n\n<p>I'm having a hard time getting started with Haskell I'm finding the formatting of if's and else a lot less intuitive than Python.</p>\n"}, {"tags": ["haskell", "operators", "mod"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1569247492, "post_id": 58064216, "comment_id": 102524777, "body": "Nothing, the two are, after the parsing phase identical. <code>x `mod` y</code> is equivalent to <code>mod x y</code>. It is frequently used to make things more readable, like <code>x `elem` y</code>, or <code>(==) `on` f</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569247588, "post_id": 58064216, "comment_id": 102524831, "body": "The only syntactical difference is that <code>x `op` y</code> acts as an operator, and thus has a different precedence level."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1569249773, "post_id": 58064216, "comment_id": 102526107, "body": "There is also the difference that <code>x `f arg` y</code> is not possible."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1569258603, "post_id": 58064216, "comment_id": 102530356, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3125395/haskell-operator-vs-function-precedence\">Haskell operator vs function precedence</a>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 11475860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uxVBrP25b5k/AAAAAAAAAAI/AAAAAAAACIM/ZhAG3ym2qGk/photo.jpg?sz=128", "display_name": "H&#229;kan", "link": "https://stackoverflow.com/users/11475860/h%c3%a5kan"}, "edited": false, "score": 0, "creation_date": 1569367116, "post_id": 58064441, "comment_id": 102571728, "body": "I think it becomes clear if you explain it like this: mod is a 2-parameter function while <code>mod</code> is the corresponding binary operator. That is, in general, back quotes gives us the binary operator corresponding to a 2-parameter function while parenthesis around a binary operator gives us the corresponding 2-parameter function. The function is partially applicable, as is the operator. If we write mod 3, we get a 1-parameter function. If we write (3 <code>mod</code>) we get a unary operator (this is called an operator section). The two forms have different use but compute the same results."}, {"owner": {"reputation": 119, "user_id": 11475860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uxVBrP25b5k/AAAAAAAAAAI/AAAAAAAACIM/ZhAG3ym2qGk/photo.jpg?sz=128", "display_name": "H&#229;kan", "link": "https://stackoverflow.com/users/11475860/h%c3%a5kan"}, "edited": false, "score": 0, "creation_date": 1569367250, "post_id": 58064441, "comment_id": 102571752, "body": "Ok, my back quotes disappeared... sigh."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 1, "last_activity_date": 1569249855, "last_edit_date": 1569249855, "creation_date": 1569248132, "answer_id": 58064441, "question_id": 58064216, "link": "https://stackoverflow.com/questions/58064216/difference-between-mod-in-the-beggining-of-the-operation-or-mod-in-the-middle/58064441#58064441", "title": "Difference between mod in the beggining of the operation or `mod` in the middle", "body": "<p>You can change the precedence of functions in Haskell with the back ticks, just that, because some functions, like plus, times, minus, mod, are more natural understanding in the middle, if you create:</p>\n\n<pre><code>plus :: Int -&gt; Int -&gt; Int\nplus x y = x + y\n</code></pre>\n\n<p>In Haskell <em>white space</em> is function application, and functions are prefix by default:</p>\n\n<pre><code>$&gt; plus 3 4\n</code></pre>\n\n<p>if you want it in the middle, one way is to use the back ticks to make it infix:</p>\n\n<pre><code>$&gt; 3 `plus` 4\n</code></pre>\n\n<p>and you can use parenthesis to make an infix function prefix:</p>\n\n<pre><code>$&gt; (+) 3 4 \n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 12086308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0744fc863cb84f667cbf12ccc0e3bfb9?s=128&d=identicon&r=PG&f=1", "display_name": "unstablespartan", "link": "https://stackoverflow.com/users/12086308/unstablespartan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569249866, "creation_date": 1569247341, "last_edit_date": 1569249866, "question_id": 58064216, "link": "https://stackoverflow.com/questions/58064216/difference-between-mod-in-the-beggining-of-the-operation-or-mod-in-the-middle", "title": "Difference between mod in the beggining of the operation or `mod` in the middle", "body": "<p>I really don't know what's the difference between one method or another, but, in some operations ghci only works if I use one and in another operations it only works if I use the other!\nCan somebody help me and explain me this?</p>\n"}, {"tags": ["haskell", "typeclass", "forall"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569241801, "post_id": 58061923, "comment_id": 102521338, "body": "<code>forall</code> does not mean random. It means <a href=\"https://stackoverflow.com/a/42821578/791604\">the caller chooses</a>. In this case, the caller is <code>func2</code>, and you have to tell it how to choose. Can you say a bit more about what you&#39;re trying to accomplish, so we can give better advice on how to fix this? There are a couple (contradictory) ways forward, and it&#39;s not clear which will be best for you."}, {"owner": {"reputation": 308, "user_id": 4179776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-wqk14GQWaLA/AAAAAAAAAAI/AAAAAAAAARM/3nqY7GWkbTk/photo.jpg?sz=128", "display_name": "Vonfry", "link": "https://stackoverflow.com/users/4179776/vonfry"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569245222, "post_id": 58061923, "comment_id": 102523356, "body": "@DanielWagner My whole program has many lines and it is only an exercise for my other course. I have added an example in the question which is the minimized problem what I have. Would you like to give me some advice?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569338531, "post_id": 58061923, "comment_id": 102561113, "body": "You don&#39;t need to show us your whole program to explain what you&#39;re trying to accomplish, but you do need to talk about the computation you want to achieve, and why you believe that leads you inexorably to needing to have a typeclass of this shape to achieve that computation."}], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 4179776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-wqk14GQWaLA/AAAAAAAAAAI/AAAAAAAAARM/3nqY7GWkbTk/photo.jpg?sz=128", "display_name": "Vonfry", "link": "https://stackoverflow.com/users/4179776/vonfry"}, "edited": false, "score": 0, "creation_date": 1569245045, "post_id": 58062541, "comment_id": 102523245, "body": "Sorry for my incomplete description and I have add an example what I want. The <code>op</code> in <code>func2</code> is defined in a typeclass. If I use typefamilies, the constrain is miss and <code>op</code> cannot be matched."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1569241939, "creation_date": 1569241939, "answer_id": 58062541, "question_id": 58061923, "link": "https://stackoverflow.com/questions/58061923/typeclass-with-constrained-params-function/58062541#58062541", "title": "typeclass with constrained params&#39; function", "body": "<p>In your code as it stands, the problem is simply that <code>c</code> in <code>func b `op` func c</code> is <em>ambiguous</em>. That's not really much of a problem: just pin down the choice with a local signature. E.g.</p>\n\n<pre><code>func2 x y = func x `op` (func y :: Int)\n</code></pre>\n\n<p>But this may not be what you really want. Should <code>c</code> really be a type parameter of the <code>func</code> class, or of the entire instance? In the latter case, a MPTC would be the right approach.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, AllowAmbiguousTypes, TypeApplications #-}\n\nclass \u2200 b c . (A b, C c) =&gt; B b c where\n  func :: b -&gt; c\n  func2 :: b -&gt; b -&gt; Bool\n  func2 x y = func @b @c b `op` func c\n</code></pre>\n\n<p>Or if for each instance, only one <code>c</code> makes sense, then you want a type family or fundep.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass A b =&gt; B b where\n  type Ct b :: *\n  func :: b -&gt; Ct b\n  func2 :: b -&gt; b -&gt; Bool\n  func2 x y = func b `op` func c\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 308, "user_id": 4179776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-wqk14GQWaLA/AAAAAAAAAAI/AAAAAAAAARM/3nqY7GWkbTk/photo.jpg?sz=128", "display_name": "Vonfry", "link": "https://stackoverflow.com/users/4179776/vonfry"}, "edited": false, "score": 0, "creation_date": 1569378307, "post_id": 58083513, "comment_id": 102573597, "body": "Thank for your advice. I have searched a lot about &#39;what is type class&#39; and think that it is not needed here for me, just coding a data struct with some functions and not defining type class."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1569338383, "creation_date": 1569338383, "answer_id": 58083513, "question_id": 58061923, "link": "https://stackoverflow.com/questions/58061923/typeclass-with-constrained-params-function/58083513#58083513", "title": "typeclass with constrained params&#39; function", "body": "<p>The smallest fix to your type families code that lets it compile is to move the demand for an <code>Ord</code> constraint from where it is produced to where it is consumed:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeSynonymInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE ConstrainedClassMethods #-}\n\ntype Ta = (Integer, Integer)\n\nclass Eq a =&gt; A a where\n    type AT a :: *\n    a1f :: a -&gt; AT a\n    a2f :: Ord (AT a) =&gt; a -&gt; a -&gt; Bool\n    a2f x y = a1f x &gt;= a1f y\n\ninstance A Ta where\n    type AT Ta = Integer\n    a1f (_, y) = y\n</code></pre>\n\n<p>If you'd like to only demand <code>Ord (AT a)</code> when the default implementation is used, you can use <code>DefaultSignatures</code> (and eliminate <code>ConstrainedClassMethods</code>):</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeSynonymInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE DefaultSignatures #-}\n\ntype Ta = (Integer, Integer)\n\nclass Eq a =&gt; A a where\n    type AT a :: *\n    a1f :: a -&gt; AT a\n    a2f :: a -&gt; a -&gt; Bool\n    default a2f :: Ord (AT a) =&gt; a -&gt; a -&gt; Bool\n    a2f x y = a1f x &gt;= a1f y\n\ninstance A Ta where\n    type AT Ta = Integer\n    a1f (_, y) = y\n</code></pre>\n\n<p>However, this typeclass structure is exceeding strange and unidiomatic. (Some red flags it raises as I read it: What is that <code>Eq</code> constraint doing there? Why is there a class with just one instance? Why is <code>a2f</code> inside the class instead of outside? Why isn't <code>a1f</code> simply a non-class-polymorphic function? Why should we believe there is just one canonical selection function for each type?)</p>\n\n<p>I'd like to reiterate that you should tell us more about what <em>goal</em> you are trying to achieve with this, rather than talking about your proposed typeclasses for achieving that goal. Much about this architecture screams \"beginner trying to use typeclasses the way OO languages use classes\", which is going to be an ongoing source of impedance mismatches and papercuts for you. I strongly suspect you simply shouldn't be defining a new typeclass at all.</p>\n"}], "owner": {"reputation": 308, "user_id": 4179776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-wqk14GQWaLA/AAAAAAAAAAI/AAAAAAAAARM/3nqY7GWkbTk/photo.jpg?sz=128", "display_name": "Vonfry", "link": "https://stackoverflow.com/users/4179776/vonfry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 58083513, "answer_count": 2, "score": 0, "last_activity_date": 1569338383, "creation_date": 1569239732, "last_edit_date": 1569247272, "question_id": 58061923, "link": "https://stackoverflow.com/questions/58061923/typeclass-with-constrained-params-function", "title": "typeclass with constrained params&#39; function", "body": "<p>I want to write a class like this:</p>\n\n<pre><code>class C c where\n    op :: c -&gt; c -&gt; Bool\n\nclass A b =&gt; B b where\n    func :: C c =&gt; b -&gt; c -- ^ type 'c' is random(forall). \n    func2 :: b -&gt; b -&gt; Bool\n    func2 x y = func b `op` func c\n</code></pre>\n\n<p>Here, <code>c</code> is a type restricted by <code>C</code> and this restriction will be used in func2. \nBut this cannot be compiler. Type <code>c</code> is not a real type. I try to add <code>forall</code> or using <code>TypeFamilies</code>, but none of them can do this. <code>TypeFamilies</code> looks good, but it cannot use with restriction in funcion definition like <code>C c =&gt; b -&gt; c</code> or `type X x :: C * => *.</p>\n\n<p>Must I use <code>(A b, C c) =&gt; B b c</code> to define this class? I have another class using with B like <code>B b =&gt; D d b</code>. If adding a param for class B, the D class needs one more param as well. In fact, <code>Seq a</code> will be used with class <code>D</code>, which cannot match <code>D d b</code>.</p>\n\n<p>EDIT: one more description.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\nmodule Main where\n\ntype Ta = (Integer, Integer)\nnewtype Tb t = Tb { tb :: [t] } deriving Show\n\nclass Eq a =&gt; A a where\n    a1f :: Ord b =&gt; a -&gt; b\n    a2f :: a -&gt; a -&gt; Bool\n    a2f x y = a1f x &gt;= a1f y\n\ninstance A Ta where\n    a1f (_, y) = y\n\nclass A a =&gt; B b a where\n    op :: b a -&gt; b a\n\ninstance B Tb Ta where\n    op x = x\n\nmain :: IO ()\nmain = putStrLn $ show $ op $ (Tb [(1, 1)] :: Tb Ta)\n</code></pre>\n\n<p>Compiler will complain with the line <code>a2f :: b -&gt; Bool</code>:  </p>\n\n<pre><code>    \u2022 Could not deduce (Ord a0) arising from a use of \u2018&gt;=\u2019\n      from the context: A a\n        bound by the class declaration for \u2018A\u2019 at test.hs:10:15\n      The type variable \u2018a0\u2019 is ambiguous\n      These potential instances exist:\n        instance Ord Ordering -- Defined in \u2018GHC.Classes\u2019\n        instance Ord Integer\n          -- Defined in \u2018integer-gmp-1.0.2.0:GHC.Integer.Type\u2019\n        instance Ord a =&gt; Ord (Maybe a) -- Defined in \u2018GHC.Maybe\u2019\n        ...plus 22 others\n        ...plus four instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the expression: a1f x &gt;= a1f y\n      In an equation for \u2018a2f\u2019: a2f x y = a1f x &gt;= a1f y\n</code></pre>\n\n<p>EDIT2: Use type families</p>\n\n<pre><code>...\nclass Eq a =&gt; A a where\n    type AT a :: *\n    a1f :: Ord (AT a) =&gt; a -&gt; AT a\n    a2f :: a -&gt; a -&gt; Bool\n    a2f x y = a1f x &gt;= a2f y\n\ninstance A Ta where\n    type AT Ta = Integer\n    a1f (_, y) = y\n...\n</code></pre>\n\n<p>It will show error with:</p>\n\n<pre><code>    \u2022 Could not deduce (Ord (AT a)) arising from a use of \u2018&gt;=\u2019\n      from the context: A a\n        bound by the class declaration for \u2018A\u2019 at test.hs:10:15\n    \u2022 In the expression: a1f x &gt;= a1f y\n      In an equation for \u2018a2f\u2019: a2f x y = a1f x &gt;= a1f y\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1569236642, "creation_date": 1569236642, "answer_id": 58061026, "question_id": 58060824, "link": "https://stackoverflow.com/questions/58060824/type-error-when-using-existential-types-haskell/58061026#58061026", "title": "Type error when using existential types Haskell", "body": "<p>As always, signatures are parsed right-associative, i.e. it is</p>\n\n<pre><code>foldJ :: ([(String, b)] -&gt; b)\n         -&gt; ( ([b] -&gt; b)\n              -&gt; ( \u2200 a . (JsonValue a)\n                      =&gt; (a -&gt; b) -&gt; (Json -&gt; b)\n                 )\n            )\n</code></pre>\n\n<p>Not that the \u2200 quantifies over the <em>result</em> of the second application. It is thus in covariant position, meaning that whoever uses the function gets to pick what type <code>a</code> is. In fact your signature is equivalent to</p>\n\n<pre><code>foldJ :: JsonValue a\n  =&gt; ([(String, b)] -&gt; b) -&gt; ([b] -&gt; b) -&gt; (a -&gt; b) -&gt; (Json -&gt; b)\n</code></pre>\n\n<p>But that's not what you want to express: the caller can't pick the type, because it's hidden in the json structure!</p>\n\n<p>What you actually want is to have the quantor only run over the <code>a -&gt; b</code> <em>argument</em>, i.e. the caller has to provide an argument <em>that works for any type</em> <code>a</code>.</p>\n\n<pre><code>foldJ :: ([(String, b)] -&gt; b)\n         -&gt; ( ([b] -&gt; b)\n              -&gt; ( (\u2200 a . (JsonValue a) =&gt; (a -&gt; b))\n                    -&gt; (Json -&gt; b)\n                 )\n            )\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 3832665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/520fa46dfc3474e5183d8810bc4ee58b?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/3832665/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58061026, "answer_count": 1, "score": 2, "last_activity_date": 1569236642, "creation_date": 1569235964, "last_edit_date": 1569236199, "question_id": 58060824, "link": "https://stackoverflow.com/questions/58060824/type-error-when-using-existential-types-haskell", "title": "Type error when using existential types Haskell", "body": "<p>I am having an experiment with Existential Types in Haskell. I am building a very short Json library and am trying to construct a fold.\nI am getting error in the code that uses the <code>forall</code> quantifier!</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class (Show m) =&gt; JsonValue m\n\ninstance JsonValue Int\ninstance JsonValue Double\ninstance JsonValue String\ninstance JsonValue Bool\n\ndata Json = JObject [(String, Json)]\n          | JArray [Json]\n          | forall a . (JsonValue a) =&gt; JValue a\n\nfoldJ :: ([(String, b)] -&gt; b) -&gt; ([b] -&gt; b) -&gt; forall a . (JsonValue a) =&gt; (a -&gt; b) -&gt; Json -&gt; b\nfoldJ object array value (JObject xs) = object $ map (bimap id (foldJ object array value)) xs\nfoldJ object array value (JArray xs)  = array $ map (foldJ object array value) xs\nfoldJ object array value (JValue x)   = value x -- ERROR HERE\n</code></pre>\n\n<p>I am using <code>-XExistentialTypes -XFlexibleInstances -XRank2Types</code></p>\n\n<p>The error looks like this:</p>\n\n<pre><code>Json.hs:335:47: error:\n    \u2022 Couldn't match expected type \u2018a\u2019 with actual type \u2018a1\u2019\n      \u2018a1\u2019 is a rigid type variable bound by\n        a pattern with constructor:\n          JValue :: forall a. JsonValue a =&gt; a -&gt; Json,\n        in an equation for \u2018foldJ\u2019\n        at Json.hs:335:27-34\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          foldJ :: ([(String, b)] -&gt; b)\n                   -&gt; ([b] -&gt; b) -&gt; forall a. JsonValue a =&gt; (a -&gt; b) -&gt; Json -&gt; b\n        at Json.hs:(333,1)-(335,47)\n    \u2022 In the first argument of \u2018value\u2019, namely \u2018x\u2019\n      In the expression: value x\n      In an equation for \u2018foldJ\u2019:\n          foldJ object array value (JValue x) = value x\n    \u2022 Relevant bindings include\n        x :: a1 (bound at Json.hs:335:34)\n        value :: a -&gt; b (bound at Json.hs:335:20)\n    |\n335 | foldJ object array value (JValue x)   = value x\n    |                                               ^\nFailed, one module loaded.\n</code></pre>\n\n<p>This is really confusing me. Ive used typed holes and everything <em>seems</em> like it is the correct type but when I put it together nothing works</p>\n"}, {"tags": ["haskell", "haskell-lens", "aeson"], "comments": [{"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 0, "creation_date": 1577124897, "post_id": 58060323, "comment_id": 105100592, "body": "Could you be clearer? If the code works, what behaviour is it that you don&#39;t like, and in what way do you think it needs to be more idiomatic?"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 0, "creation_date": 1577612682, "post_id": 58060323, "comment_id": 105207711, "body": "I asked this 3 months ago, and have forgotten the exact problem I was trying to solve then. Let me take a guess here, now. If the parsing in <code>mapM parseJSON selectedItems</code> fails, will the error message be able to identify which element in the array caused the failure? Also, is there a better lens combinator to achieve what the following expression is doing - <code>filter (\\x -&gt; x ^? (key &quot;objectType&quot;) . _String == Just &quot;typeA&quot;) $ allItems ^.. values</code>"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1569234243, "creation_date": 1569234243, "question_id": 58060323, "link": "https://stackoverflow.com/questions/58060323/how-to-filter-array-values-using-data-lens-aeson-before-parsing-them", "title": "How to filter Array values using Data.Lens.Aeson before parsing them?", "body": "<p>I have an incoming JSON which looks like:</p>\n\n<pre><code>{\n  \"somekey\": [\n    { \"objectType\": \"typeA\"\n    , \"key1\": \"val1\"\n    , \"key2\": \"val2\"\n    }\n  , { \"objectType\": \"typeB\"\n    , \"key3\": \"val3\"\n    , \"key4\": \"val4\"\n    }\n  ]\n</code></pre>\n\n<p>While parsing, I want to deal with ONLY objects tagged with <code>typeA</code>. I've got the following code to work, but I'm looking at something more idiomatic that will use the power of lenses properly AND will result in a better error message if the parsing fails:</p>\n\n<pre><code>import Control.Lens\nimport Data.Aeson.Lens (values, key, _String)\n\ninstance FromJSON MyType where\n  parseJson = Aeson.withObject \"Expecting JSON object\" $ \\o -&gt; do\n    allItems &lt;- o .: \"someKey\"\n    let selectedItems :: [Aeson.Value] = filter (\\x -&gt; x ^? (key \"objectType\") . _String == Just \"typeA\") $ allItems ^.. values \n    someKey &lt;- mapM parseJON selectedItems\n    pure MyType{..}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569230284, "post_id": 58059220, "comment_id": 102515411, "body": "Did you compile the source code with <code>-Wall</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569230322, "post_id": 58059220, "comment_id": 102515441, "body": "It is not entirely clear to me why a leaf has a list of values..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569233179, "post_id": 58059220, "comment_id": 102516870, "body": "@WillemVanOnsem perhaps for the <a href=\"https://stackoverflow.com/questions/43941551/explicit-purely-functional-data-structure-for-difference-lists/43945275#43945275\">possibility of efficient <code>uncons</code></a> operation rearranging the tail so that each leaf element is accessed in amortized O(1) time, and appending to (and accessing past) the end of infinite lists is also then possible."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569233362, "post_id": 58059220, "comment_id": 102516950, "body": "@WillNess: but one can simply use the <code>ListTree [a]</code> in case we want to do that, by specifying it as a list at the <code>data</code> level, it looks like overrestricting :) We thus can make a more generic data type, and define an algorithm on more specific subsets of that data type. Tailoring data towards a certain application, looks a bit ugly imho. Somehow in webserver development, it frequently goes wrong if people model for example a database towards a user interface for example."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569235103, "post_id": 58059220, "comment_id": 102517854, "body": "@WillemVanOnsem I don&#39;t understand, if I have a list of Ints, do you mean I&#39;d have to declare <code>xs :: ListTree [Int]</code>? that would be terribly confusing, IMO."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1569235229, "post_id": 58059220, "comment_id": 102517923, "body": "@WillNess: no, you can just make a type synonym <code>type DList a = ListTree [a]</code>, such that you have a more &quot;clean&quot; data type, and you make it more clear that you work on a difference list. It means for once we can &quot;have the cake and eat it at the same time&quot; :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569236086, "post_id": 58059220, "comment_id": 102518342, "body": "@WillemVanOnsem with what data type definition for <code>ListTree</code>, please?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569236840, "post_id": 58059220, "comment_id": 102518719, "body": "@WillNess: <code>data ListTree a = ListLeaf a | Node [ListTree a]</code>, or in case of your <code>DList</code> likely <code>ListTree a = Leaf a | Node (ListTree a) (ListTree a)</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569239714, "post_id": 58059220, "comment_id": 102520239, "body": "@WillemVanOnsem with the first definition, <code>type DList a = ListTree [a]</code> === <code>data DList a = Leaf [a] | Node [ListTree [a]] = Leaf [a] | Node [DList a]</code>, isn&#39;t it, which is exactly the type in the question. Same with my definition, AFAICT. ... okay, I guess this is what you meant."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569239877, "post_id": 58059220, "comment_id": 102520328, "body": "@WillNess: exactly, but with that difference, that one can use a <code>ListTree Int</code> as well, whereas a <code>DList</code> can not do that. So we have generalized it, and at the same time can use a <code>DList</code> for lists, so that means that defining it with a list in the <i><code>data</code> definition</i>, would needlessly restrict yourself. I somehow have the idea that you here proof the point yourself that using a list in the definition, would result in more types, and more code."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569240308, "post_id": 58059220, "comment_id": 102520537, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/199840/discussion-between-will-ness-and-willem-van-onsem\">continue this discussion in chat</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569256506, "post_id": 58059220, "comment_id": 102529524, "body": "@WillemVanOnsem the semantics of the two types are significantly different, e.g. <code>uncons</code> would be implemented radically differently (so <code>type</code> is no good), so I think I prefer to keep them separate after all and just implement the two almost unrelated types directly, each of them (<code>newtype</code> needs an extra constructor tag, which is inconvenient). why connect them when there&#39;s no connection, really."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1569230831, "creation_date": 1569230831, "answer_id": 58059413, "question_id": 58059220, "link": "https://stackoverflow.com/questions/58059220/find-sum-of-leaves/58059413#58059413", "title": "Find Sum of leaves", "body": "<p>It really helps if you turn on <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using-warnings.html#ghc-flag--Wall\" rel=\"nofollow noreferrer\"><code>-Wall</code></a> since Haskell can provide you a list of the patterns you did not cover.</p>\n\n<p>The main problem is that you wrote as pattern:</p>\n\n<pre><code>foldListTree op base (ListLEAF <b>[a]</b>) = foldr op base [a]</code></pre>\n\n<p>So that means you restricted the pattern to singleton lists. Nowhere in the code, is there a pattern for a <code>ListLEAF</code> constructor that takes a list with an arbitrary number of elements.</p>\n\n<p>You can however make the above a lot simpler by implementing two cases: one for each constructor. We can use <code>foldListTree</code> as folding function in the <code>ListNODE</code> case:</p>\n\n<pre><code>foldListTree :: Num a =&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; ListTree a -&gt; a \nfoldListTree op base (ListLEAF x) = foldr op base x\nfoldListTree op base (ListNODE b) = foldr (flip (foldListTree op)) base b</code></pre>\n\n<p>This gives us:</p>\n\n<pre><code>Prelude&gt; foldListTree (+) 0 t4\n36\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: Although strictly speaking not wrong, I find it odd to write <code>LEAF</code> and <code>NODE</code> in all caps, usually one writes this in camelcase, so <code>ListLeaf</code> and <code>ListNode</code>.</p>\n</blockquote>\n\n<p>&nbsp;</p>\n\n<blockquote>\n  <p><strong>Note</strong>: It might be better that your <code>ListLeaf</code> stores an <code>a</code>, not an <code>[a]</code>, since then you give more freedom what to store in your leaves. It does not exclude the possibility at all to store lists in the leaves, but you leave that decision to the user of the data type.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 12105907, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UGMoGJn40OQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdXGhDYpraBv7S0A67cKFDgILhklg/photo.jpg?sz=128", "display_name": "saa maa", "link": "https://stackoverflow.com/users/12105907/saa-maa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1569236029, "creation_date": 1569230168, "last_edit_date": 1569236029, "question_id": 58059220, "link": "https://stackoverflow.com/questions/58059220/find-sum-of-leaves", "title": "Find Sum of leaves", "body": "<p>I am supposed to write a code such that</p>\n\n<blockquote>\n  <p>A polymorphic tree type with nodes of an arbitrary number of children might be represented as follows (note that the leaves store a list, and interior nodes store list of \u201cListTree\u201ds):</p>\n</blockquote>\n\n<pre><code>data ListTree a = ListLEAF [a] | ListNODE [(ListTree a)]\n deriving (Show, Read, Eq)\n</code></pre>\n\n<blockquote>\n  <p>Write a function <code>foldListTree</code> that takes a function (<code>f</code>), a base value (<code>base</code>), and a ListTree (<code>t</code>) and combines the values in the lists of the leaf notes in tree <code>t</code> by applying function <code>f</code>. (The leaves of the tree are scanned from left to right). <code>foldListTree</code> is invoked as: </p>\n  \n  <p><code>foldListTree f base t</code> where <code>f</code> is the combining function of type <code>a-&gt;a-&gt;a</code>. The type of <code>foldListTree</code> should be:</p>\n</blockquote>\n\n<pre><code>foldListTree :: (a -&gt; a -&gt; a) -&gt; a -&gt; ListTree a -&gt; a\n</code></pre>\n\n<p>I am trying to read every node in the list but I guess it's getting into an infinite loop.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data ListTree a = ListLEAF [a] | ListNODE [(ListTree a)] deriving (Show, Read, Eq)\n\n\nfoldListTree :: (Num a) =&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; ListTree a -&gt; a \nfoldListTree op base (ListLEAF []) = base\nfoldListTree op base (ListNODE []) = base\nfoldListTree op base (ListLEAF [a]) = foldr op base [a]\nfoldListTree op base (ListNODE b) = (op (foldListTree op base x) \n                                        (foldListTree op base (ListNODE xs)))\n                                        where x:xs = b\n\nt4 = ListNODE\n       [ ListNODE\n           [ ListLEAF [1,2,3]\n           , ListLEAF [4,5]\n           , ListNODE [ListLEAF [6], ListLEAF []]\n           ]\n       , ListNODE []\n       , ListLEAF [7,8]\n       , ListNODE [ListLEAF [], ListLEAF []]\n       ]\n</code></pre>\n\n<p>Command: <code>foldListTree (+) 0 t4</code></p>\n\n<blockquote>\n  <p>> Error : *** Exception: indi.hs:(86,1)-(90,54): Non-exhaustive patterns in function <code>foldListTree</code></p>\n</blockquote>\n"}, {"tags": ["haskell", "yesod", "haskell-stack", "fay"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 4530858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40aede2adf7189c0ce681af16398b0e5?s=128&d=identicon&r=PG", "display_name": "Orfest", "link": "https://stackoverflow.com/users/4530858/orfest"}, "is_accepted": true, "score": 1, "last_activity_date": 1603043403, "creation_date": 1603043403, "answer_id": 64416487, "question_id": 58057449, "link": "https://stackoverflow.com/questions/58057449/fay-cant-find-fay-base/64416487#64416487", "title": "Fay can&#39;t find fay-base", "body": "<p>I concluded that fay doesn't work with stack.</p>\n"}], "owner": {"reputation": 125, "user_id": 4530858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40aede2adf7189c0ce681af16398b0e5?s=128&d=identicon&r=PG", "display_name": "Orfest", "link": "https://stackoverflow.com/users/4530858/orfest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "accepted_answer_id": 64416487, "answer_count": 1, "score": 3, "last_activity_date": 1603043403, "creation_date": 1569223265, "last_edit_date": 1569405489, "question_id": 58057449, "link": "https://stackoverflow.com/questions/58057449/fay-cant-find-fay-base", "title": "Fay can&#39;t find fay-base", "body": "<p>I want to use <a href=\"https://github.com/faylang/fay/wiki\" rel=\"nofollow noreferrer\">Fay</a> with <a href=\"https://www.yesodweb.com/\" rel=\"nofollow noreferrer\">Yesod</a>, but can't get Fay typechecking to work.\nWill appreciate any advice.</p>\n\n<pre><code>$ stack build                                                                                                                           \n[ 9 of 11] Compiling Handler.Home     ( src/Handler/Home.hs, .stack-work/dist/x86_64-linux-dkda49f7ca9b244180d3cfb1987cbc9743/Cabal-2.4.0.1/build/Handler/Home.o )                                                                 \n\n/home/user/code/myproject/src/Handler/Home.hs:121:13: error:\n    _ Exception when trying to run compile-time code:\n        ghc-pkg describe error:\nTimestamp 2019-05-07 18:46:44 UTC for /opt/ghc/8.6.5/lib/ghc-8.6.5/package.conf.d/package.cache\nghc-pkg: cannot find package fay-base  &lt;- ########### Why?\n\nGHC package manager version 8.6.5\nusing cache: /opt/ghc/8.6.5/lib/ghc-8.6.5/package.conf.d/package.cache\ndb stack: [\"/opt/ghc/8.6.5/lib/ghc-8.6.5/package.conf.d\"]\nflag db stack: [\"/opt/ghc/8.6.5/lib/ghc-8.6.5/package.conf.d\"]\n\nCallStack (from HasCallStack):\n  error, called at src/Fay/Compiler/Packages.hs:70:24 in fay-0.24.0.3-CdLcUWVJEOpLCiYHkNVTai:Fay.Compiler.Packages                                                                                                                 \n      Code: fayFile' (ConE 'StaticR) \"HelloWorld\"\n    _ In the untyped splice: $(fayFile' (ConE 'StaticR) \"HelloWorld\")\n    |\n121 |             $( fayFile' (ConE 'StaticR) \"HelloWorld\" )\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Fay packages are not yet in stackage, so I added them to <code>stack.yaml</code> as <code>extra-deps</code>:</p>\n\n<pre><code>extra-deps:                                                                                                     - fay-0.24.0.3\n- fay-base-0.21.1.1\n- fay-dom-0.5.0.1\n- fay-text-0.3.2.2\n- yesod-fay-0.10.0\n</code></pre>\n\n<p>and to <code>package.yaml</code> as <code>dependencies</code>:</p>\n\n<pre><code>dependencies:\n... more dependencies ...  \n- fay == 0.24.0.3\n- fay-base == 0.21.1.1\n- fay-dom == 0.5.0.1\n- fay-text == 0.3.2.2\n- yesod-fay == 0.10.0\n</code></pre>\n\n<p>Fay packages are in the <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#different-databases\" rel=\"nofollow noreferrer\">local package database</a>: </p>\n\n<pre><code>$ stack exec -- ghc-pkg list                                                                                                                                                                             \n/opt/ghc/8.6.5/lib/ghc-8.6.5/package.conf.d\n    Cabal-2.4.0.1\n    array-0.5.3.0\n    base-4.12.0.0\n    ...\n/home/user/.stack/snapshots/x86_64-linux-dkda49f7ca9b244180d3cfb1987cbc9743/lts-13.30/8.6.5/pkgdb\n    Cabal-2.4.1.0\n    Diff-0.3.4\n    HUnit-1.6.0.0\n    ...\n    yesod-1.6.0\n    yesod-core-1.6.14\n    yesod-form-1.6.5\n    yesod-newsfeed-1.6.1.0\n    yesod-persistent-1.6.0.2\n    yesod-static-1.6.0.1\n/home/user/code/myproject/.stack-work/install/x86_64-linux-dkda49f7ca9b244180d3cfb1987cbc9743/lts-13.30/8.6.5/pkgdb\n    fay-0.24.0.3\n    fay-base-0.21.1.1\n    fay-dom-0.5.0.1\n    fay-text-0.3.2.2\n    yesod-fay-0.10.0\n</code></pre>\n\n<p>However trying to set <code>HASKELL_PACKAGE_SANDBOX</code> to the local database as <a href=\"https://github.com/faylang/fay/wiki/Troubleshooting\" rel=\"nofollow noreferrer\">Fay Troubleshooting</a> suggests doesn't work, because sandboxes containing the string <code>.stack</code> are <a href=\"https://github.com/fpco/yesod-fay/blob/7c87550a3450b1d476737eee34bf2a09b9048751/Yesod/Fay.hs#L325\" rel=\"nofollow noreferrer\">ignored in <code>yesod-fay</code></a>.</p>\n\n<p>If I remove that check from <code>yesod-fay</code> and force the <code>--package-db</code> to point to the local database, it still doesn't work, complains that <code>fay-base</code> can't find the <code>fay</code> package.</p>\n\n<pre><code>$ stack build\n    /home/user/code/myproject/src/Handler/Home.hs:121:13: error:\n        \u2022 Exception when trying to run compile-time code:\n            Unable to compile Fay module \"HelloWorld\":\n\n    ghc: &lt;command line&gt;: cannot satisfy -package fay-base-0.21.1.1: \n        fay-base-0.21.1.1-91eIy2f24Wa5OHg9LMre7 is unusable due to missing dependencies:\n          fay-0.24.0.3-CdLcUWVJEOpLCiYHkNVTai\n        (use -v for more information)\n\n    CallStack (from HasCallStack):\n      error, called at ./Yesod/Fay.hs:483:3 in yesod-fay-0.10.9999-CzTT9fyZ6636pi0gIof7Ge:Yesod.Fay\n          Code: fayFile' (ConE 'StaticR) \"HelloWorld\"\n        \u2022 In the untyped splice: $(fayFile' (ConE 'StaticR) \"HelloWorld\")\n        |\n    121 |             $( fayFile' (ConE 'StaticR) \"HelloWorld\" )\n        |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Update: not using satck or cabal and using packages that are installed system-wide, this error doesn't occur. I guess the problem is in my local stack package database (the one in .stack-work)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1569218229, "post_id": 58056296, "comment_id": 102510084, "body": "I\u2019m not sure I understand the question. Do you mean that you want <code>alpha</code> to be anything <b>except</b> for <code>Complex</code>?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1569218269, "post_id": 58056296, "comment_id": 102510097, "body": "Oh, actually I think I understand now. If <code>a</code> (for example) is <code>Complex Double</code>, then you want <code>alpha</code> to be <code>Double</code>. Is that correct?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1569218553, "post_id": 58056296, "comment_id": 102510186, "body": "@bradm Yes, exactly."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1569219618, "post_id": 58056296, "comment_id": 102510526, "body": "Thanks! Another question: Is <code>a</code> restricted to types of the form <code>Complex (something)</code>, or can it be any <code>Fractional</code>? If it can be any <code>Fractional</code>, then is <code>alpha</code> of the same type?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1569220088, "post_id": 58056296, "comment_id": 102510713, "body": "@bradrn The other arguments can be any <code>Fractional</code>. And unless they are complex, <code>alpha</code> must be of the same type."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1569220220, "post_id": 58056645, "comment_id": 102510764, "body": "Thanks. This is beyond my Haskell skills, so I will try before sending my feedback."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1569220266, "post_id": 58056645, "comment_id": 102510786, "body": "I think you can say <code>instance RealFrac a =&gt; BaseFrac a</code> instead of many concrete instances (need FlexibleInstances)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1569220344, "post_id": 58056645, "comment_id": 102510819, "body": "@n.m. I assumed that runs into problems with overlapping instances, but I didn&#39;t try it (though I know sometimes instances are allowed to overlap to an extent). If it doesn&#39;t have those issues, that would definitely be convenient!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1569220358, "post_id": 58056645, "comment_id": 102510823, "body": "@St&#233;phaneLaurent Let me know if you have any questions or if it doesn&#39;t work out!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1569220871, "post_id": 58056645, "comment_id": 102511004, "body": "(I can also add some more explanation to the answer when I get a bit of time. I&#39;m going to go to bed soon, but I should have some time tomorrow.)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1569224963, "post_id": 58056645, "comment_id": 102512844, "body": "Unless someone adds <code>instance RealFrac Complex</code> or something equally weird I don&#39;t think there will be issues."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1569225529, "post_id": 58056645, "comment_id": 102513110, "body": "@St&#233;phaneLaurent I can try to explain how this works quickly: <code>BaseFrac</code> is a typeclass. Using an \u2018associated type\u2019 <code>BaseFracType a</code>, this contains an <code>inject</code> method which converts a <code>BaseFracType a</code> to an <code>a</code>. The <code>Complex</code> instance defines <code>BaseFracType (Complex a) = a</code>, so <code>inject</code> has type <code>Complex a -&gt; a</code>; the other instances define <code>BaseFracType a = a</code>, so <code>inject</code> has type <code>a -&gt; a</code>. (continued in next comment\u2026)"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1569225569, "post_id": 58056645, "comment_id": 102513137, "body": "@St&#233;phaneLaurent (continued) Then in <code>hypergeom</code>, we constrain <code>a</code> to be a <code>BaseFrac</code>, so we can define <code>alpha</code> as being of type <code>BaseFracType a</code>; the implementation of <code>hypergeom</code> can then use <code>inject</code> to convert <code>alpha</code> to the same type as <code>a</code>. For more details, look up \u2018type families\u2019, which is the technique being used here."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1569230727, "post_id": 58056645, "comment_id": 102515660, "body": "@bradrn I suggest you move the explanation from the comment to the answer, if David is fine with that."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1569243736, "post_id": 58056645, "comment_id": 102522461, "body": "@MichaWiedenmann I do want to! But as you say I would like to wait for confirmation from David first."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1569246635, "post_id": 58056645, "comment_id": 102524248, "body": "@David do you object?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1569277255, "post_id": 58056645, "comment_id": 102537204, "body": "@bradrn I added some explanation. I personally lean towards thinking it is best to consolidate the same answer into the same SO answer, but I will leave that up to your discretion."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1569277340, "post_id": 58056645, "comment_id": 102537228, "body": "@n.m. It looks like that does immediately run into issues with overlapping instance errors. Whenever you have an instance that looks like <code>instance forall a. ... =&gt; SomeClass a</code> then you are <i>very</i> likely to run into overlapping instance issues (since GHC ignores the constraint when it searches for a matching type class <code>instance</code>)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1569277364, "post_id": 58056645, "comment_id": 102537235, "body": "@St&#233;phaneLaurent I added a bit of explanation which hopefully helps. If you have any questions, you can let me know!"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1571095813, "post_id": 58056645, "comment_id": 103118313, "body": "@ David. Thanks, this works. Thank you for the detailed explanations."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 7, "last_activity_date": 1569277168, "last_edit_date": 1569277168, "creation_date": 1569219668, "answer_id": 58056645, "question_id": 58056296, "link": "https://stackoverflow.com/questions/58056296/preventing-an-argument-to-be-a-complex-number/58056645#58056645", "title": "Preventing an argument to be a complex number", "body": "<h1>Code</h1>\n\n<p>If I am understanding correctly, you could use a type class with an associated type family for this:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DefaultSignatures #-}\n\nimport           Data.Complex\nimport           Data.Ratio\n\nclass BaseFrac a where\n  type family BaseFracType a\n  type BaseFracType a = a -- Default type family instance (unless overridden)\n\n  inject :: BaseFracType a -&gt; a\n\n  default inject :: BaseFracType a ~ a =&gt; BaseFracType a -&gt; a\n  inject = id\n\ninstance Integral a =&gt; BaseFrac (Ratio a)\ninstance BaseFrac Float\ninstance BaseFrac Double\n\n-- etc...\n\ninstance Num a =&gt; BaseFrac (Complex a) where\n  type BaseFracType (Complex a) = a\n\n  inject x = x :+ 0\n\n\nhypergeom ::\n     forall a. (Eq a, Fractional a, BaseFrac a)\n  =&gt; Int  -- truncation weight\n  -&gt; BaseFracType a    -- alpha parameter (usually 2)\n  -&gt; [a]  -- \"upper\" parameters\n  -&gt; [a]  -- \"lower\" parameters\n  -&gt; [a]  -- variables (the eigen values)\n  -&gt; IO a\nhypergeom m alpha a b x = ...\n</code></pre>\n\n<p>It is possible that you will need to add additional methods to the type class, but I think <code>inject</code> should provide some important utility.</p>\n\n<h1>Explanation</h1>\n\n<p>Writing this explanation, I realized that I probably compressed several ideas into a small area without giving the background information I should have given. Hopefully this helps and if you have any questions or are confused, you should let me know!</p>\n\n<p>There are two main interacting ideas here. The first is that of a type class. I will assume some basic background on type classes (there are many resources going over the basics on that. If you would like, I can find some to link here).</p>\n\n<p>The other is the idea of a type family. A type family is essentially a sort of function from types to types. Sometimes they are inside type classes (as they are here), but they don't have to be. Also, sometimes they are \"open\" and sometimes they are \"closed\" (if they are inside a type class, they are essentially open)</p>\n\n<h2>Closed type families</h2>\n\n<p>I think it is instructive to look at a closed type family which is not in a type class first. Consider this:</p>\n\n<pre><code>type family Example :: * -&gt; * where\n  Example Int = Bool\n  Example a   = a\n</code></pre>\n\n<p>This is very much like a regular Haskell function definition, except it happens to operate on types instead of values. If its input is the type <code>Int</code> it gives back the type <code>Bool</code>. Otherwise, it gives back the same type as the type it got as an argument.</p>\n\n<p>We can see this using the <code>:kind!</code> command in GHCi:</p>\n\n<pre><code>\u03bb &gt; :kind! Example Int\nExample Int :: *\n= Bool\n\u03bb &gt;\n\u03bb &gt; :kind! Example Char\nExample Char :: *\n= Char\n</code></pre>\n\n<p>You can also think of type synonyms as a very restricted form of type family.</p>\n\n<p>That type family is called \"closed\" because you cannot add more \"equations\" to its definition (just like a \"regular\" Haskell function).</p>\n\n<h2>Open type families</h2>\n\n<p>But, you can also have \"open\" type families where you <em>can</em> add additional equations later on. For example:</p>\n\n<pre><code>type family OpenExample :: * -&gt; *\n\n\ntype instance OpenExample [a] = a\ntype instance OpenExample Text = Char\ntype instance OpenExample IntSet = Int\n-- ^ These just give you the \"element type\" inside some containers\n</code></pre>\n\n<p>We can later add on new equations with <code>type instance</code> (for instance, here if we add a new container type).</p>\n\n<h2>Type families associated with type classes</h2>\n\n<p>This brings us to the sort of type family we have here: a type class with an associated type family. This is much like an open type family, but the input is constrained by the type class. Also, each equation is inside an instance of the type class.</p>\n\n<p>I have provided a default type instance (the 2nd line of the <code>class</code> <code>BaseFrac</code>) which will automatically be used if none is provided. To write out the <code>Double</code> instance explicitly (without using this default) it looks like:</p>\n\n<pre><code>instance BaseFrac Double where\n  type BaseFracType Double = Double\n</code></pre>\n\n<p>Note how similar this is to the <code>type instance</code> syntax.</p>\n\n<p>I have also provided a default implementation for the <code>inject</code> method. This default can <em>only</em> be used if <code>BaseFracType a</code> is the <em>same</em> as <code>a</code> (this is what the constraint <code>BaseFracType a ~ a</code> means in the default signature).</p>\n\n<p>This constraint <em>does</em> hold for any <code>instance</code> that uses the default <code>BaseFracType</code> definition (since it is just <code>type BaseFracType a = a</code>), which is why those \"empty\" instance definitions just automatically work.</p>\n\n<p>So, for the instances given so far, <code>BaseFracType Double</code> is the same as <code>Double</code> (from the (default) type family definition used in the <code>Double</code> instance of the <code>BaseFrac</code> class) and <code>BaseFracType (Complex a)</code> is the same as <code>a</code> (from the type family instance definition given in the  <code>Complex a</code> instance of the <code>BaseFrac</code> class).</p>\n\n<h1>What <code>inject</code> is for</h1>\n\n<p>That kind of explains <em>why</em> the types work out, but the next questions are <em>how do we actually use it</em> and why does <code>inject</code> matter? Luckily, the answers to those two questions are linked.</p>\n\n<p><code>inject</code> essentially provides you a way to put a \"basic\" (\"1-dimensional\") fractional value into whatever type that has an instance of the <code>BaseFrac</code> class.</p>\n\n<p>For most types, this is just the identity function (since <code>Double</code> is already a \"basic\" fractional value, etc). For <code>Complex a</code>, this is different. It just constructs a complex number with a zero in its imaginary component and its argument as its real component. In that case, it is a function of type <code>inject :: Num a =&gt; a -&gt; Complex a</code>.</p>\n\n<p>Here is a simple example of <code>inject</code> in action based on the function you gave, with its full generality (this function works with any <code>BaseFrac</code> inputs):</p>\n\n<pre><code>hypergeom :: forall a. (Eq a, Fractional a, BaseFrac a)\n  =&gt; Int\n  -&gt; BaseFracType a\n  -&gt; [a]\n  -&gt; [a]\n  -&gt; [a]\n  -&gt; IO a\nhypergeom m alpha a b x = return (inject alpha * head a)\n</code></pre>\n\n<p>If the type variable <code>a</code> is <code>Rational</code>, then:</p>\n\n<ul>\n<li><code>alpha</code> has type <code>Rational</code> (since <code>BaseFracType Rational</code> is the same as <code>Rational</code>)</li>\n<li><code>inject alpha</code> also has type <code>Rational</code></li>\n<li>The value of <code>inject alpha</code> is just <code>alpha</code></li>\n</ul>\n\n<p>If the type variable <code>a</code> is <code>Complex Double</code>, then:</p>\n\n<ul>\n<li><code>alpha</code> has type <code>Double</code> (since <code>BaseFracType (Complex Double)</code> is the same as <code>Double</code>)</li>\n<li><code>inject alpha</code> has the type <code>Complex Double</code></li>\n<li>The value of <code>inject alpha</code> is <code>alpha :+ 0</code></li>\n</ul>\n\n<p>You can also use the GHCi <code>:kind!</code> command here:</p>\n\n<pre><code>\u03bb &gt; :kind! BaseFracType (Complex Double)\nBaseFracType (Complex Double) :: *\n= Double\n</code></pre>\n\n<p>If there's anything that's confusing, you can let me know and I should be able to clarify it.</p>\n\n<h1>Additional material</h1>\n\n<p>There is some more information on type families <a href=\"https://wiki.haskell.org/GHC/Type_families\" rel=\"nofollow noreferrer\">here</a>. Probably the most relevant sections there would be <a href=\"https://wiki.haskell.org/GHC/Type_families#Detailed_definition_of_type_synonym_families\" rel=\"nofollow noreferrer\">the section on type synonym instances (which are the type families we talked about that were not associated with a type class)</a>, the subsection on <a href=\"https://wiki.haskell.org/GHC/Type_families#Closed_family_simplification\" rel=\"nofollow noreferrer\">closed type families</a> and  the subsection on <a href=\"https://wiki.haskell.org/GHC/Type_families#Associated_type_instances_2\" rel=\"nofollow noreferrer\">associated type families</a>.</p>\n\n<p>Note that page also talks about data families, which are not particularly relevant here (data families are kind of like \"open\" GADTs).</p>\n"}, {"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1569277874, "post_id": 58058296, "comment_id": 102537359, "body": "This is a good answer. Before I wrote mine, I was trying to think of something like this that already exists but I couldn&#39;t come up with it (I looked in the <code>linear</code> package, but I don&#39;t think there&#39;s anything in <code>linear</code> for this kind of thing). Forgot about <code>vector-space</code>! The other thing that I was unsure of is, like you mentioned, complex numbers can be considered scalars (since they form a field) and I wasn&#39;t sure if something like this would quite work out since, even though complex numbers <i>are</i> a vector space over the reals, they are also a field (with vector spaces over it)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1569313111, "post_id": 58058296, "comment_id": 102546589, "body": "@David the <code>linear</code> style would be <code>Traversable v =&gt; Int -&gt; s  -&gt; [v s] -&gt; ...</code>. But that would require to wrap real numbers in <a href=\"http://hackage.haskell.org/package/linear-1.20.9/docs/Linear-V1.html\" rel=\"nofollow noreferrer\"><code>V1</code></a>, and is generally awkward."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 8, "last_activity_date": 1569229484, "last_edit_date": 1569229484, "creation_date": 1569226755, "answer_id": 58058296, "question_id": 58056296, "link": "https://stackoverflow.com/questions/58056296/preventing-an-argument-to-be-a-complex-number/58058296#58058296", "title": "Preventing an argument to be a complex number", "body": "<p>Every Haskeller should know <a href=\"http://hackage.haskell.org/package/vector-space-0.16/docs/Data-VectorSpace.html\" rel=\"noreferrer\">the <code>vector-space</code> library</a>, and this is one application where it can be used.</p>\n\n<pre><code>hypergeom ::\n     \u2200 a. (VectorSpace a, Eq a, RealFrac (Scalar a))\n  =&gt; Int       -- truncation weight\n  -&gt; Scalar a  -- alpha parameter (usually 2)\n  -&gt; [a]       -- \"upper\" parameters\n  -&gt; [a]       -- \"lower\" parameters\n  -&gt; [a]       -- variables (the eigen values)\n  -&gt; IO a\nhypergeom m \u03b1 a b x = do\n  ......\n</code></pre>\n\n<p>This uses, in <a href=\"http://hackage.haskell.org/package/vector-space-0.16/docs/src/Data.VectorSpace.html#line-143\" rel=\"noreferrer\">the complex case</a>,</p>\n\n<pre><code>instance (RealFloat v, VectorSpace v) =&gt; VectorSpace (Complex v) where\n  type Scalar (Complex v) = Scalar v\n  s*^(u :+ v) = s*^u :+ s*^v\n</code></pre>\n\n<p>However, caveat: I personally am not a fan of that particular instance. Because complex numbers are a division algebra, it is quite often useful to consider them as a <em>scalar</em> type, i.e.</p>\n\n<pre><code>instance RealFloat a =&gt; VectorSpace (Complex a) where\n  type Scalar (Complex a) = Complex a\n  (*^) = (*)\n</code></pre>\n\n<p>The reason this is preferrable is that free vector spaces over the complex number (e.g. tuples) will then actually be complex vector spaces, not real vector spaces as they are as of version 0.16 of the library.</p>\n\n<p>If the instance <em>were</em> defined as I would do it, then it would <em>not</em> work. This was actually <a href=\"https://github.com/conal/vector-space/issues/20\" rel=\"noreferrer\">discussed</a>, maybe it'll change in the future.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 2, "accepted_answer_id": 58056645, "answer_count": 2, "score": 10, "last_activity_date": 1569277168, "creation_date": 1569217643, "question_id": 58056296, "link": "https://stackoverflow.com/questions/58056296/preventing-an-argument-to-be-a-complex-number", "title": "Preventing an argument to be a complex number", "body": "<p>I have a function like this:</p>\n\n<pre><code>hypergeom ::\n     forall a. (Eq a, Fractional a)\n  =&gt; Int  -- truncation weight\n  -&gt; a    -- alpha parameter (usually 2)\n  -&gt; [a]  -- \"upper\" parameters\n  -&gt; [a]  -- \"lower\" parameters\n  -&gt; [a]  -- variables (the eigen values)\n  -&gt; IO a\nhypergeom m alpha a b x = do\n  ......\n</code></pre>\n\n<p>I choosed the constraint <code>Fractional a</code> because I want the possibility to take <code>a</code> of type <code>Float</code>, <code>Double</code>, <code>Rational</code> or <code>Complex</code> (for example <code>Complex Double</code> or <code>Complex Rational</code>). </p>\n\n<p>But now, I would like to allow <code>Complex</code> except for the parameter <code>alpha</code>. But if <code>a</code> is the type <code>Complex b</code> then <code>alpha</code> must be of type <code>b</code>. For example:</p>\n\n<pre><code>hypergeom ::\n  =&gt; Int               -- truncation weight\n  -&gt; Double            -- alpha parameter (usually 2)\n  -&gt; [Complex Double]  -- \"upper\" parameters\n  -&gt; [Complex Double]  -- \"lower\" parameters\n  -&gt; [Complex Double]  -- variables (the eigen values)\n  -&gt; IO (Complex Double)\n</code></pre>\n\n<p>I hope I'm clear. How could I do that in a neat way ?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569275722, "post_id": 58056158, "comment_id": 102536842, "body": "If you try to compile something manually with that GHC, what happens?"}, {"owner": {"reputation": 11, "user_id": 7971403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afb10a4d3da501e1624a86237d421e?s=128&d=identicon&r=PG&f=1", "display_name": "vaorozco", "link": "https://stackoverflow.com/users/7971403/vaorozco"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569292396, "post_id": 58056158, "comment_id": 102540006, "body": "@JosephSible it works, but I need the stack to use Data.hashmap.lazy because I am not able to install it differently."}, {"owner": {"reputation": 11, "user_id": 7971403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afb10a4d3da501e1624a86237d421e?s=128&d=identicon&r=PG&f=1", "display_name": "vaorozco", "link": "https://stackoverflow.com/users/7971403/vaorozco"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569292475, "post_id": 58056158, "comment_id": 102540022, "body": "@JosephSible I got this error &quot;Could find module Data.hashmap.lazy&quot;. If you know how to solve it using WinGHCI or Visual Studio Code will be great."}], "owner": {"reputation": 11, "user_id": 7971403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afb10a4d3da501e1624a86237d421e?s=128&d=identicon&r=PG&f=1", "display_name": "vaorozco", "link": "https://stackoverflow.com/users/7971403/vaorozco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1583634928, "creation_date": 1569216682, "last_edit_date": 1583634928, "question_id": 58056158, "link": "https://stackoverflow.com/questions/58056158/how-can-i-solve-this-problem-the-ghc-located-at-failed-to-compile-a-sanity-c", "title": "How can I solve this problem The GHC located at ___ failed to compile a sanity check. (windows)?", "body": "<p>I am trying to use haskell on Windows with visual studio code, but when I use \"stack setup\", I got this error </p>\n\n<blockquote>\n  <p>The GHC located at\n  C:\\Users\\Username\\AppData\\Local\\Programs\\stack\\x86_64-windows\\ghc-8.6.5\\bin\\ghc-8.6.5.EXE\n  failed to compile a sanity check.</p>\n</blockquote>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4789917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c66188d3afe7070457570133fe7395?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4789917/alex"}, "edited": false, "score": 0, "creation_date": 1569267872, "post_id": 58055382, "comment_id": 102534093, "body": "Thank, I didn&#39;t know about concat.  That would come in handy"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1569210177, "creation_date": 1569210177, "answer_id": 58055382, "question_id": 58055289, "link": "https://stackoverflow.com/questions/58055289/adding-data-types-in-a-function/58055382#58055382", "title": "Adding data types in a function", "body": "<p>Try this:</p>\n\n<pre><code>addAllLengths list = foldr addLengths (INCH 0) (concat list)\n</code></pre>\n\n<p><code>concat</code> turns <code>[[FOOT 2], [FOOT 2, INCH 2],[]]</code> into <code>[FOOT 2, FOOT 2, INCH 2]</code>, and then <code>foldr addLengths (INCH 0)</code> turns that into <code>INCH 50</code>.</p>\n"}], "owner": {"reputation": 173, "user_id": 4789917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c66188d3afe7070457570133fe7395?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4789917/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58055382, "answer_count": 1, "score": 1, "last_activity_date": 1569210177, "creation_date": 1569209224, "question_id": 58055289, "link": "https://stackoverflow.com/questions/58055289/adding-data-types-in-a-function", "title": "Adding data types in a function", "body": "<p>I am new to Haskell and learning about data types.  I am attempting to do a simple problem, but I cant seem to grasp the bigger picture.  I have a data type of LengthUnit which resembles inches, feet, and yards.  I want to make a function that takes a list of lists of LengthUnits and converts them to inches and sums all elements.</p>\n\n<p>I created a helper function convert, which converts the LengthUnit to inches. I also have addLengths which accepts two LengthUnits and adds them up.  I cant seem to get the output I am looking for.  Here is what I have: </p>\n\n<pre><code>data LengthUnit =  INCH  Int | FOOT  Int | YARD  Int\n                   deriving (Show, Read, Eq)\n\nconvert :: LengthUnit -&gt; Int  \nconvert (INCH x) =  (x) \nconvert (FOOT x) =  (x * 12)\nconvert (YARD x) =  (x * 36)\n\n-- addLengths \naddLengths :: LengthUnit -&gt; LengthUnit -&gt; LengthUnit\naddLengths x y = INCH ((convert x) + (convert y))\n\n\n-- addAllLengths\n--addAllLengths :: Foldable t =&gt; [t LengthUnit] -&gt; LengthUnit\naddAllLengths list = let nList = map convert list\n                     in foldr addLengths 0 nList\n\n</code></pre>\n\n<p>From the above I get an error: Couldn't match type 'Int' with 'LengthUnit'.  Any help would be appreciated.</p>\n\n<p>I'm looking to get something like this:</p>\n\n<pre><code>addAllLengths [[FOOT 2], [FOOT 2, INCH 2],[]]\nINCH 50\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 173, "user_id": 4789917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c66188d3afe7070457570133fe7395?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4789917/alex"}, "edited": false, "score": 4, "creation_date": 1569202914, "post_id": 58054545, "comment_id": 102507224, "body": "@Alex That isn&#39;t a type cast. It is using the <code>INCH</code> constructor to make a <code>LengthUnit</code> value from an <code>Int</code> value. To give a quick example of one difference from type casting, constructors can take multiple arguments (this is just one slight, quick motivation for the difference. They are really fundamentally different things overall). Haskell doesn&#39;t really have type casting in the way a language like C does."}], "tags": [], "owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "is_accepted": true, "score": 3, "last_activity_date": 1569202915, "last_edit_date": 1569202915, "creation_date": 1569200346, "answer_id": 58054545, "question_id": 58054482, "link": "https://stackoverflow.com/questions/58054482/haskell-data-type-functions/58054545#58054545", "title": "Haskell - data type functions", "body": "<p>You mean something like:</p>\n\n<pre><code>addLengths x y = INCH ((convert x) + (convert y))\n</code></pre>\n\n<p>There might be more parentheses than required.</p>\n\n<p>The use of the INCH constructor is not a type cast. </p>\n"}], "owner": {"reputation": 173, "user_id": 4789917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c66188d3afe7070457570133fe7395?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4789917/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 58054545, "answer_count": 1, "score": 1, "last_activity_date": 1569202915, "creation_date": 1569199579, "question_id": 58054482, "link": "https://stackoverflow.com/questions/58054482/haskell-data-type-functions", "title": "Haskell - data type functions", "body": "<p>I'm learning Haskell and started looking over data types.  I tried doing a simple example with converting Yard and feet to inches with a data type defined as LengthUnit. I want to add two LengthUnit vars so I created a helper function called convert that would take in a LengthUnit and convert it to inches.</p>\n\n<p>I tried to do the following but I keep getting an error 'Couldnt match expected type LengthUnit with type Int.</p>\n\n<p>Here is what I have: </p>\n\n<pre><code>data LengthUnit =  INCH  Int | FOOT  Int | YARD  Int\n                   deriving (Show, Read, Eq)\n\nconvert :: LengthUnit -&gt; Int    \nconvert (INCH x) = x \nconvert (FOOT x) = x * 12\nconvert (YARD x) = x * 36\n\n-- addLengths \naddLengths :: LengthUnit -&gt; LengthUnit -&gt; LengthUnit\naddLengths (INCH x) (INCH y) = convert(x) + convert(y)\n-- I tried this as well and still receive same error\naddLengths (INCH x) (INCH y) = x + y\naddLengths (INCH x) (FOOT y) = convert(x) + convert(y)\n.\n.\n.\n</code></pre>\n\n<p>I cant seem to find the equivalence of :</p>\n\n<pre><code>addLengths (LengthUnit x) (LengthUnit y) = convert(x) + convert(y)\n</code></pre>\n\n<p>Any help is appreciated, thanks!</p>\n"}, {"tags": ["haskell", "applicative", "function-composition"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569222420, "post_id": 58054217, "comment_id": 102511679, "body": "<code>Compose fgh &lt;*&gt; Compose fgx = Compose ((&lt;*&gt;) &lt;$&gt; fgh &lt;*&gt; fgx) = Compose (liftA2 (&lt;*&gt;) fgh fgx)</code> and <code>liftA2 (&lt;*&gt;) fgh fgx ::~ f {gh &lt;*&gt; gx} :: f (g {h x})</code> (pseudocode, reading <code>{ }</code> as &quot;type of&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 1564106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35d895ec931b2609c500431c4730adae?s=128&d=identicon&r=PG", "display_name": "bpaterni", "link": "https://stackoverflow.com/users/1564106/bpaterni"}, "edited": false, "score": 0, "creation_date": 1569199551, "post_id": 58054268, "comment_id": 102506758, "body": "This helped me a great deal to see a concrete example evaluated down: Compose [Just (+1)] &lt;*&gt; Compose [Just 5] //  Compose (&lt;*&gt;) &lt;$&gt; [Just (+1)] &lt;*&gt; [Just 5] //  Compose [(&lt;*&gt;) (Just (+1))] &lt;*&gt; [Just 5] //  Compose [Just (+1) &lt;*&gt; Just 5]  // Compose [Just 6] // ``` I&#39;m not sure why I over-complicated things :shrug: Thanks Joseph!"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1569197016, "creation_date": 1569197016, "answer_id": 58054268, "question_id": 58054217, "link": "https://stackoverflow.com/questions/58054217/composing-applicatives/58054268#58054268", "title": "Composing Applicatives", "body": "<p>Consider the expression <code>a &lt;$&gt; b &lt;*&gt; c</code>. It means take the function <code>a</code>, and map it over the functor <code>b</code>, which will yield a new functor, and then map that new functor over the functor <code>c</code>.</p>\n\n<p>First, imagine that <code>a</code> is <code>(\\x y -&gt; x + y)</code>, <code>b</code> is <code>Just 3</code>, and <code>c</code> is <code>Just 5</code>. <code>a &lt;$&gt; b</code> then evaluates to <code>Just (\\y -&gt; 3 + y)</code>, and <code>a &lt;$&gt; b &lt;*&gt; c</code> then evaluates to <code>Just 8</code>.</p>\n\n<p>(If what's before here doesn't make sense, then you should try to understand single layers of applicatives further before you try to understand multiple layers of them.)</p>\n\n<p>Similarly, in your case, <code>a</code> is <code>(&lt;*&gt;)</code>, <code>b</code> is <code>f</code>, and <code>c</code> is <code>x</code>. If you were to choose suitable values for <code>f</code> and <code>x</code>, you'd see that they can be easily evaluated as well (though be sure to keep your layers distinct; the <code>(&lt;*&gt;)</code> in your case belongs to the inner Applicative, whereas the <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code> belong to the outer one).</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1569260313, "post_id": 58055426, "comment_id": 102531015, "body": "(... and <code>a &lt;*&gt; b === liftA2 id a b</code>.)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1569279048, "last_edit_date": 1569279048, "creation_date": 1569210575, "answer_id": 58055426, "question_id": 58054217, "link": "https://stackoverflow.com/questions/58054217/composing-applicatives/58055426#58055426", "title": "Composing Applicatives", "body": "<p>Rather than <code>&lt;*&gt;</code>, you can define <code>liftA2</code>.</p>\n\n<pre><code>import Control.Applicative (Applicative (..))\n\nnewtype Compose f g a = Compose\n  { getCompose :: f (g a) }\n  deriving Functor\n\ninstance (Applicative f, Applicative g) =&gt; Applicative (Compose f g) where\n  pure a = Compose (pure (pure a))\n  -- liftA2 :: (a -&gt; b -&gt; c) -&gt; Compose f g a -&gt; Compose f g b -&gt; Compose f g c\n  liftA2 f (Compose fga) (Compose fgb) = Compose _1\n</code></pre>\n\n<p>We have <code>fga :: f (g a)</code> and <code>fgb :: f (g b)</code> and we need <code>_1 :: f (g c)</code>. Since <code>f</code> is applicative, we can combine those two values using <code>liftA2</code>:</p>\n\n<pre><code>  liftA2 f (Compose fga) (Compose fgb) = Compose (liftA2 _2 fga fgb)\n</code></pre>\n\n<p>Now we need</p>\n\n<pre><code>_2 :: g a -&gt; g b -&gt; g c\n</code></pre>\n\n<p>Since <code>g</code> is also applicative, we can use its <code>liftA2</code> as well:</p>\n\n<pre><code>  liftA2 f (Compose fga) (Compose fgb) = Compose (liftA2 (liftA2 f) fga fgb)\n</code></pre>\n\n<p>This pattern of lifting <code>liftA2</code> applications is useful for other things too. Generally speaking,</p>\n\n<pre><code>liftA2 . liftA2 :: (Applicative f, Applicative g) =&gt; (a -&gt; b -&gt; c) -&gt; f (g a) -&gt; f (g b) -&gt; f (g c)\n\nliftA2 . liftA2 . liftA2\n  :: (Applicative f, Applicative g, Applicative h)\n  =&gt; (a -&gt; b -&gt; c) -&gt; f (g (h a)) -&gt; f (g (h b)) -&gt; f (g (h c))\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 1564106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35d895ec931b2609c500431c4730adae?s=128&d=identicon&r=PG", "display_name": "bpaterni", "link": "https://stackoverflow.com/users/1564106/bpaterni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 58054268, "answer_count": 2, "score": 2, "last_activity_date": 1569279048, "creation_date": 1569196483, "last_edit_date": 1569196843, "question_id": 58054217, "link": "https://stackoverflow.com/questions/58054217/composing-applicatives", "title": "Composing Applicatives", "body": "<p>I'm reading through Chapter 25 (Composing Types) of the <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">haskellbook</a>, and wish to understand applicative composition more completely</p>\n\n<p>The author provides a type to embody type composition:</p>\n\n<pre><code>newtype Compose f g a =\n  Compose { getCompose :: f (g a) }\n  deriving (Eq, Show)\n</code></pre>\n\n<p>and supplies the functor instance for this type:</p>\n\n<pre><code>instance (Functor f, Functor g) =&gt;\n  Functor (Compose f g) where\n    fmap f (Compose fga) =\n      Compose $ (fmap . fmap) f fga\n</code></pre>\n\n<p>But the Applicative instance is left as an exercise to the reader:</p>\n\n<pre><code>instance (Applicative f, Applicative g) =&gt;\n  Applicative (Compose f g) where\n    -- pure :: a -&gt; Compose f g a\n    pure = Compose . pure . pure\n    -- (&lt;*&gt;) :: Compose f g (a -&gt; b)\n    --       -&gt; Compose f g a\n    --       -&gt; Compose f g b\n    Compose fgf &lt;*&gt; Compose fgx = undefined\n</code></pre>\n\n<p>I can cheat and look the answer up online... The source for <a href=\"http://hackage.haskell.org/package/transformers-0.4.2.0/docs/src/Data-Functor-Compose.html#line-86\" rel=\"nofollow noreferrer\">Data.Functor.Compose</a> provides the applicative instance definition:</p>\n\n<pre><code>Compose f &lt;*&gt; Compose x = Compose ((&lt;*&gt;) &lt;$&gt; f &lt;*&gt; x)\n</code></pre>\n\n<p>but I'm having trouble understanding what's going on here. According to type signatures, both <code>f</code> and <code>x</code> are wrapped up in two layers of applicative structure. The road block I seem to be hitting though is understanding what's going on with this bit: <code>(&lt;*&gt;) &lt;$&gt; f</code>. I will probably have follow up questions, but they probably depend on how that expression is evaluated. Is it saying \"fmap <code>&lt;*&gt;</code> over f\" or \"apply <code>&lt;$&gt;</code> to f\"?</p>\n\n<p>Please help to arrive at an intuitive understanding of what's happening here.</p>\n\n<p>Thanks! :)</p>\n"}, {"tags": ["haskell", "types", "nested", "nested-lists"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569185782, "post_id": 58053304, "comment_id": 102504588, "body": "Where&#39;s the definition of the type <code>Tag</code>?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569186075, "post_id": 58053304, "comment_id": 102504646, "body": "Also, do you mean <code>example = Item table [Item t [Item r [Text &quot;hello&quot;]]]</code>?"}, {"owner": {"reputation": 139, "user_id": 11091943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6fa21b5c90f680fe854c762e7050ac?s=128&d=identicon&r=PG&f=1", "display_name": "lex449", "link": "https://stackoverflow.com/users/11091943/lex449"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569186710, "post_id": 58053304, "comment_id": 102504777, "body": "@JosephSible I edited the post. <code>data Tag = table | t | r</code>. Tag has a show function where it just prints the value in a string. I also changed the example. Thank you for catching that!"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569186786, "post_id": 58053304, "comment_id": 102504788, "body": "That&#39;s not a valid definition of Tag. Data constructors aren&#39;t allowed to start with lowercase letters."}, {"owner": {"reputation": 139, "user_id": 11091943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6fa21b5c90f680fe854c762e7050ac?s=128&d=identicon&r=PG&f=1", "display_name": "lex449", "link": "https://stackoverflow.com/users/11091943/lex449"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569187459, "post_id": 58053304, "comment_id": 102504911, "body": "@JosephSible my mistake, didn&#39;t compile it previously."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569187530, "post_id": 58053304, "comment_id": 102504927, "body": "And now your example doesn&#39;t match the type."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569187954, "post_id": 58053304, "comment_id": 102505003, "body": "I&#39;ve taken the liberty of finishing fixing the example."}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1569185910, "creation_date": 1569185910, "answer_id": 58053351, "question_id": 58053304, "link": "https://stackoverflow.com/questions/58053304/iterate-through-new-data-type-of-nested-lists-in-haskell/58053351#58053351", "title": "Iterate through new data type of nested lists in haskell", "body": "<p>Your recursive type needs a recursive function to walk it:</p>\n\n<pre><code>tableList :: Table -&gt; [String]\ntableList (Item tag xs) = show tag:concatMap tableList xs\ntableList (Text t) = [t]\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 11091943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6fa21b5c90f680fe854c762e7050ac?s=128&d=identicon&r=PG&f=1", "display_name": "lex449", "link": "https://stackoverflow.com/users/11091943/lex449"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 58053351, "answer_count": 1, "score": 3, "last_activity_date": 1569187918, "creation_date": 1569185422, "last_edit_date": 1569187918, "question_id": 58053304, "link": "https://stackoverflow.com/questions/58053304/iterate-through-new-data-type-of-nested-lists-in-haskell", "title": "Iterate through new data type of nested lists in haskell", "body": "<p>I am new at making new types in Haskell. This is my type that I created:</p>\n\n<pre><code>data Tag = Table | Td | Tr deriving(Show)\ndata Table = Item Tag [Table] | Text String\n</code></pre>\n\n<p>The Tag data type also has a show function where it prints the values to a string. I know this type works recursively because Table uses [Table] in the first value. I want to be able to make a list of all of the Tag elements and the innermost element, which will be Text or an empty list. </p>\n\n<p>For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;example = Item Table [Item Td [Item Tr [Text \"hello\"]]]\n&gt;tableList example\n[\"Table\",\"Td\",\"Tr\",\"hello\"]\n</code></pre>\n\n<p>This is what I've tried so far:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>tableList :: Table -&gt; [String]\ntableList (Item tag _) = [x | x &lt;- show tag]\n</code></pre>\n\n<p>But this only shows <code>\"table\"</code>. I'm not sure how to access all of the inner <code>Tag</code> values.</p>\n"}, {"tags": ["haskell", "operator-precedence", "composition", "function-composition"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1569186124, "post_id": 58051838, "comment_id": 102504660, "body": "This is type inference at work. There are many instances of <code>read</code> and GHC can see what is the one you want from the context. GHCi, without the proper context, infers the wrong one and causes the crash. Inconvenient, but that&#39;s what it happened."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1569230235, "last_edit_date": 1569230235, "creation_date": 1569176526, "answer_id": 58052195, "question_id": 58051838, "link": "https://stackoverflow.com/questions/58051838/explanation-about-haskell-operator-precedence-and-function-composition/58052195#58052195", "title": "Explanation about Haskell operator precedence and function composition", "body": "<p>Defining at GHCi prompt</p>\n\n<pre><code>g = (\\(n:arr) -&gt; f n arr)\n where\n f = concatMap . replicate\n</code></pre>\n\n<p>we get the derived type back as <code>g :: [Int] -&gt; [Int]</code>. This defines the type of <code>read</code> in the <code>map read</code> (feeding into <code>g</code>) as <code>String -&gt; Int</code>, and everything works. It could be easier to follow in the more readable form, </p>\n\n<pre><code>g :: [Int] -&gt; [Int]\ng (n:arr) = concatMap (replicate n) arr\n</code></pre>\n\n<p>The type <code>Int</code> is derived for <code>n :: Int</code> because of <code>replicate :: Int -&gt; a -&gt; [a]</code>, and the type for <code>arr</code> as well as <code>(n:arr) :: [Int]</code> follows from that because Haskell lists are homogeneous, i.e. having all the elements of the same type.</p>\n\n<p>The most general type of <code>read</code> is <code>read :: Read a =&gt; String -&gt; a</code>. Indeed <code>Int</code> is in <code>Read</code> type class.</p>\n\n<p>But what if we don't know whether this is an <code>Int</code>, a <code>Double</code>, or something else? Then <code>read</code> does not know which format to parse, and so we get the <code>\"read: no parse\"</code> error message back.</p>\n\n<p>This is what happens when we try </p>\n\n<pre><code>(map read . words) \"2\\n3\\n4\\n\"  =  map read $ words \"2\\n3\\n4\\n\" \n                                =  map read (words \"2\\n3\\n4\\n\")\n</code></pre>\n\n<p>The <code>$</code> appears there instead of the  <code>.</code> when we open the parentheses. Due to the operator precedence your <code>main</code> function is actually</p>\n\n<pre><code>main :: IO ()\nmain = getContents &gt;&gt;=\n       (mapM_ print . (\\(n:arr) -&gt; f n arr) . map read . words)\n     = getContents &gt;&gt;= (\\s -&gt; \n       (mapM_ print . g                     . map read . words) s)\n     = getContents &gt;&gt;= (\\s -&gt; \n        mapM_ print $ g                     $ map read $ words  s)\n</code></pre>\n\n<p>Using <code>.</code> instead of <code>$</code> there as you did is wrong, because just omitting those parentheses is wrong, causes that other error message related to functions, as <code>.</code> expects a function as its argument on the right but <code>[\"2\",\"3\",\"4\"]</code> is not a function. </p>\n"}], "owner": {"reputation": 45, "user_id": 12103516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f0f3b70902ee34c245e99bb96b2f2d?s=128&d=identicon&r=PG&f=1", "display_name": "niklasd", "link": "https://stackoverflow.com/users/12103516/niklasd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58052195, "answer_count": 1, "score": 3, "last_activity_date": 1569230235, "creation_date": 1569174178, "last_edit_date": 1569175615, "question_id": 58051838, "link": "https://stackoverflow.com/questions/58051838/explanation-about-haskell-operator-precedence-and-function-composition", "title": "Explanation about Haskell operator precedence and function composition", "body": "<p>I need some help understanding a Haskell template of the \"List Replication\" Hackerrank challenge. I do not understand the order in which the functions are executed.</p>\n\n<pre><code>f = concatMap . replicate\n\n-- This part handles the Input and Output and can be used as it is. \nmain :: IO ()\nmain = getContents &gt;&gt;=\n       mapM_ print . (\\(n:arr) -&gt; f n arr) . map read . words\n</code></pre>\n\n<p>The <code>getContents</code> function should produce an <code>IO String</code> like <code>\"2\\n1\\n2\\n3\\n4\\n5\\n6\\n7\\n8\\n9\\n10\"</code>. I understand roughly what happens next, but I do not understand in what order and with which precedence. I tried to execute <code>words \"2\\n1\\n2\\n3\\n4\\n5\\n6\\n7\\n8\\n9\\n10</code> in ghci and to feed the result into <code>map read</code>. But then I get the result <code>\"[*** Exception: Prelude.read: no parse\"</code>. If I try <code>map read . words \"2\\n1\\n2\\n3\\n4\\n5\\n6\\n7\\n8\\n9\\n10\"</code> I get the result <code>\"Couldn't match expected type \u2018a -&gt; [String]\u2019 with actual type \u2018[String]\u2019\"</code>. How is it that the whole composed main function throws no errors?</p>\n\n<p>I would very much appreciate if someone could help me understand the whole main function. Especially which functions get executed in which order with which input, and how I could slice it in smaller (working!) parts to understand it better.</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["forms", "haskell", "get", "yesod", "web-development-server"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569172522, "post_id": 58051606, "comment_id": 102501240, "body": "I think one usually does not use a form for pagination, but constructs a URI with a querystring at the end."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569172699, "post_id": 58051606, "comment_id": 102501298, "body": "@WillemVanOnsem could you create any snippet in Haskell using the Yesod framework just to illustrate this way? I can imagine that it is right because the querystring will contain all the filters but I don&#39;t know the &quot;official&quot; or &quot;optimal&quot; way of implementing such links."}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1569172420, "creation_date": 1569172420, "question_id": 58051606, "link": "https://stackoverflow.com/questions/58051606/yesod-monad-forms-with-pagination-or-even-input-forms-with-pagination-is-the", "title": "Yesod - Monad Forms with Pagination, or even Input Forms with Pagination, is there an optimal way to implement it", "body": "<p>How can I use a Monad Form or even an Input Form to pass variables of a GET request and also navigate through its pages?</p>\n"}, {"tags": ["string", "function", "haskell", "reverse", "concat"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1569169969, "post_id": 58051229, "comment_id": 102500502, "body": "Why <code>f &quot;&quot;</code>? The text seems to ask for <code>f s</code> instead. Anyway, you can&#39;t call <code>func</code> with two strings, the first argument must be a <i>function</i>."}, {"owner": {"reputation": 63, "user_id": 10213801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LdfV.jpg?s=128&g=1", "display_name": "Marrows", "link": "https://stackoverflow.com/users/10213801/marrows"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1569170714, "post_id": 58051229, "comment_id": 102500712, "body": "Thanks, I knew that something was off."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1569170099, "creation_date": 1569170099, "answer_id": 58051272, "question_id": 58051229, "link": "https://stackoverflow.com/questions/58051229/concat-functions-in-haskell/58051272#58051272", "title": "Concat functions in haskell", "body": "<p>Your function is almost correct, except that you did not use <code>s</code> as parameter for the function application with <code>s</code>:</p>\n\n<pre><code>func:: (String -&gt; String) -&gt; String -&gt; String\nfunc f s = reverse s ++ f <b>s</b></code></pre>\n\n<p>You furthermore use the function the wrong way, since the first parameter is not a string, but a function that maps a string on a string. We can for example use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:id\" rel=\"nofollow noreferrer\"><strong><code>id :: a -&gt; a</code></strong></a> to return <code>s</code>, or <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:reverse\" rel=\"nofollow noreferrer\"><strong><code>reverse :: [a] -&gt; [a]</code></strong></a> to reverse the string:</p>\n\n<pre><code>Prelude&gt; func id \"haskell\"\n\"lleksahhaskell\"\nPrelude&gt; func reverse \"haskell\"\n\"lleksahlleksah\"\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10213801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LdfV.jpg?s=128&g=1", "display_name": "Marrows", "link": "https://stackoverflow.com/users/10213801/marrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2761, "favorite_count": 0, "accepted_answer_id": 58051272, "answer_count": 1, "score": -1, "last_activity_date": 1569170099, "creation_date": 1569169821, "question_id": 58051229, "link": "https://stackoverflow.com/questions/58051229/concat-functions-in-haskell", "title": "Concat functions in haskell", "body": "<p>I'm new to Haskell so I have lots of questions so I'd like your help.</p>\n\n<blockquote>\n  <p>Make a function \"func\" that receives a function \" f \" (String -> String) type and a String \"s\" that returns the reverse of \"s\" concat with \" f \" application in \"s\"</p>\n</blockquote>\n\n<p>I managed to make the \" f \" function like this:</p>\n\n<pre><code>f:: String -&gt; String\nf x -&gt; reverse(x) ++ x\n</code></pre>\n\n<blockquote>\n  <p>console: f \"HASKELL\" -> \"LLEKSAHHASKELL\"</p>\n</blockquote>\n\n<p>But when it comes to the \"func\" function I don't know what to do or type in the console. This code below worked in GHC, but I don't know why, it doesn't accepts entries.</p>\n\n<pre><code>func:: (String -&gt; String) -&gt; String -&gt; String\nfunc f s = (reverse(s) ++ f \"\")\n\nconsole: func \"HASKELL\" \"ROCKS\"\n\n&lt;interactive&gt;:49:6: error:\n    \u2022 Couldn't match expected type \u2018String -&gt; String\u2019\n                  with actual type \u2018[Char]\u2019\n    \u2022 In the first argument of \u2018func\u2019, namely \u2018\"HASKELL\"\u2019\n      In the expression: func \"HASKELL\" \"ROCKS\"\n      In an equation for \u2018it\u2019: it = func \"HASKELL\" \"ROCKS\"\n</code></pre>\n\n<p>If there's a better way to do it, please can you tell me ? </p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["regex", "parsing", "haskell", "parser-combinators"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569164261, "post_id": 58050250, "comment_id": 102499002, "body": "The standard technique is to build an epsilon-NFA, compile that to a DFA, then execute the DFA. Can you say why this technique will not work for you?"}, {"owner": {"reputation": 393, "user_id": 5561345, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xq317Q7HvD0/AAAAAAAAAAI/AAAAAAAAAIA/uTkP3_rkfBs/photo.jpg?sz=128", "display_name": "Shuumatsu", "link": "https://stackoverflow.com/users/5561345/shuumatsu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569164850, "post_id": 58050250, "comment_id": 102499138, "body": "@DanielWagner I haven&#39;t tried the automata approach yet. I&#39;m reviewing my parser combinator knowledge so I&#39;m wondering how to do this. And the parser combinator approach(LL parsing) is stronger than dfa, so I think there must be a way to implement it."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1569174393, "post_id": 58050250, "comment_id": 102501747, "body": "Alternation and repetition in regular expressions work differently than in PEGs, so you can&#39;t just take a regular expression and treat it as a PEG. You&#39;re right that PEGs are more powerful than regular expressions, but that only means that you can transform a regex into an equivalent PEG - it doesn&#39;t mean that the resulting PEG is going to look similar to the regex. In your example the PEG <code>S &lt;- &#39;a&#39;? (&#39;a&#39; &#47; &#39;b&#39;) .* &#39;h&#39;+</code> is not equivalent to the regex <code>a?(a|b).*h+</code> because PEGs don&#39;t backtrack that way. An equivalent PEG would be <code>S &lt;- (&#39;aa&#39; &#47; &#39;ab&#39; &#47; &#39;a&#39; &#47; &#39;b&#39;) H</code> and <code>H &lt;- &#39;h&#39;+ &#47; . H</code>."}], "owner": {"reputation": 393, "user_id": 5561345, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xq317Q7HvD0/AAAAAAAAAAI/AAAAAAAAAIA/uTkP3_rkfBs/photo.jpg?sz=128", "display_name": "Shuumatsu", "link": "https://stackoverflow.com/users/5561345/shuumatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569164703, "creation_date": 1569163201, "last_edit_date": 1569164703, "question_id": 58050250, "link": "https://stackoverflow.com/questions/58050250/handling-trailing-patterns-after-something-like-when-building-regex-engine", "title": "Handling trailing patterns after something like `.*` when building regex engine", "body": "<p>I tried to implement a regex engine using the parser combinators in Haskell.</p>\n\n<p>The idea is that first parse the pattern to build a regex parser, then use the parser to parse the input text.</p>\n\n<p>But my code cannot handle this scenario: if the pattern is something like <code>a?(a|b).*h+</code>, then the <code>h+</code> after <code>.*</code> will never be satisfied since the <code>.*</code> part will consume all the inputs.</p>\n\n<p>(Usually the <code>&lt;|&gt;</code> is implemented with a <code>try</code> func, due to efficiency. But here I don't think this is the case.</p>\n\n<p>Below is my code</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule Matcher where\n\nimport           Data.Function (on)\nimport           Data.Functor (($&gt;))\nimport           Control.Monad\nimport           Control.Applicative\n\nnewtype Parser a = Parser { runParser :: String -&gt; Maybe (a, String) }\n\nparse :: Parser a -&gt; String -&gt; Maybe a\nparse parser inp = case runParser parser inp of\n  Just (a, []) -&gt; Just a\n  _ -&gt; Nothing\n\ninstance Functor Parser where\n  fmap t (Parser g) = Parser $ \\inp -&gt; fmap (\\(a, inp') -&gt; (t a, inp')) (g inp)\n\ninstance Applicative Parser where\n  pure a = Parser $ \\inp -&gt; Just (a, inp)\n\n  (Parser f) &lt;*&gt; (Parser g) = Parser\n    $ \\inp -&gt; case f inp of\n      Nothing        -&gt; Nothing\n      Just (t, inp') -&gt; case g inp' of\n        Nothing         -&gt; Nothing\n        Just (a, inp'') -&gt; Just (t a, inp'')\n\ninstance Alternative Parser where\n  empty = Parser $ const Nothing\n\n  (Parser f) &lt;|&gt; (Parser g) = Parser\n    $ \\inp -&gt; case f inp of\n      Nothing -&gt; g inp\n      Just r  -&gt; Just r\n\n  some p = (:) &lt;$&gt; p &lt;*&gt; (some p &lt;|&gt; pure [])\n\ninstance Monad Parser where\n  (Parser f) &gt;&gt;= g = Parser\n    $ \\inp -&gt; case f inp of\n      Nothing        -&gt; Nothing\n      Just (a, inp') -&gt; runParser (g a) inp'\n\nsatisfy p = Parser\n  $ \\case\n    (x:xs)\n      | p x -&gt; Just (x, xs)\n    _      -&gt; Nothing\n\nchar :: Char -&gt; Parser Char\nchar c = satisfy (== c)\n\nstring :: String -&gt; Parser String\nstring \"\" = pure \"\"\nstring (c:cs) = do\n  char c\n  string cs\n  return (c:cs)\n\nbetween :: Parser a -&gt; Parser b -&gt; Parser c -&gt; Parser b\nbetween left content right = left *&gt; content &lt;* right\n\nunit :: Parser (Parser String)\nunit = (do\n          c &lt;- satisfy (`notElem` ['.', '*', '?', '+', '(', ')', '|'])\n          return $ fmap (:[]) (char c))\n  &lt;|&gt; (char '.' $&gt; fmap (:[]) (satisfy (const True)))\n  &lt;|&gt; oneOf\n\noneOf :: Parser (Parser String)\noneOf = between (char '(') content (char ')')\n  where\n    content = do\n      p1 &lt;- unit\n      rest &lt;- many $ char '|' *&gt; unit\n      return $ foldr (&lt;|&gt;) p1 rest\n\noneOrMore :: Parser (Parser String)\noneOrMore = do\n  arp &lt;- unit\n  char '+'\n  return $ fmap concat (some arp)\n\nzeroOrMore :: Parser (Parser String)\nzeroOrMore = do\n  arp &lt;- unit\n  char '*'\n  return $ fmap concat (many arp)\n\nzeroOrOne :: Parser (Parser String)\nzeroOrOne = do\n  arp &lt;- unit\n  char '?'\n  return $ arp &lt;|&gt; pure \"\"\n\nreg :: Parser (Parser String)\nreg = fmap\n  (foldr (liftA2 (++)) (pure \"\"))\n  (some $ zeroOrMore &lt;|&gt; zeroOrOne &lt;|&gt; oneOrMore &lt;|&gt; unit)\n\ncreateRegParser :: String -&gt; Maybe (Parser String)\ncreateRegParser = parse reg\n\nexample = createRegParser \"a?(a|b).*h+\"\n</code></pre>\n"}, {"tags": ["haskell", "import", "module"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569156561, "post_id": 58049364, "comment_id": 102497220, "body": "A file belongs to one module. You can however reimport a module, and export a subset."}, {"owner": {"reputation": 553, "user_id": 2316602, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8aM2D.jpg?s=128&g=1", "display_name": "user2316602", "link": "https://stackoverflow.com/users/2316602/user2316602"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569157471, "post_id": 58049364, "comment_id": 102497435, "body": "I am not sure I understand. Could you please explain what you mean?"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1569157897, "creation_date": 1569157897, "answer_id": 58049561, "question_id": 58049364, "link": "https://stackoverflow.com/questions/58049364/exporting-multiple-modules-in-one-file/58049561#58049561", "title": "Exporting multiple modules in one file", "body": "<p>You need to distinguish between <em>defining</em> a module and <em>exporting</em> names from that module; they are two separate steps.</p>\n\n<p>A file can only define a single module. However, you can export names imported from other modules as part of that module. For example,</p>\n\n<pre><code>module MyModule (foo, bar) where\n\nimport OtherModule (bar) -- Let's say bar :: Int -&gt; String\n\nfoo :: Int -&gt; Int\nfoo x = x + 3\n</code></pre>\n\n<p><code>MyModule</code> does not define <code>bar</code>; rather, it imports it from <code>OtherModule</code>, then exports it as part of itself. Users of <code>MyModule</code> then have access to <code>bar</code> without explicitly importing <code>OtherModule</code>:</p>\n\n<pre><code>import MyModule\n\nmain = putStrLn (bar (foo 9))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1569157918, "creation_date": 1569157918, "answer_id": 58049564, "question_id": 58049364, "link": "https://stackoverflow.com/questions/58049364/exporting-multiple-modules-in-one-file/58049564#58049564", "title": "Exporting multiple modules in one file", "body": "<p>To the best of my knowledge, you can not have multiple modules in the same file. <a href=\"https://stackoverflow.com/a/6922573/67579\">This answer</a> seems to confirm this.</p>\n\n<p>What you could do however is create a second module, that <em>re-exports</em> some functions. So we first make a file <code>NameForTesting.hs</code> with:</p>\n\n<pre><code>-- NameForTesting.hs\nmodule NameForTesting where\n\nimportant :: Int\nimportant = 42\n\nfunctions :: Int -&gt; Int\nfunctions = (42 +)\n\nfoo :: Int\nfoo = 21</code></pre>\n\n<p>Then we can construct a second file <code>Name.hs</code> that imports the <code>NameForTesting</code> module, but only exports <code>important</code> and <code>functions</code>:</p>\n\n<pre><code>-- Name.hs\nmodule Name(<b>important, functions</b>) where\n\nimport NameForTesting</code></pre>\n\n<p>The <code>Name</code> module will here only export <code>important</code> and <code>functions</code> that are imported from the <code>NameForTesting</code> module.</p>\n"}], "owner": {"reputation": 553, "user_id": 2316602, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8aM2D.jpg?s=128&g=1", "display_name": "user2316602", "link": "https://stackoverflow.com/users/2316602/user2316602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 58049564, "answer_count": 2, "score": 1, "last_activity_date": 1569161892, "creation_date": 1569156455, "last_edit_date": 1569161892, "question_id": 58049364, "link": "https://stackoverflow.com/questions/58049364/exporting-multiple-modules-in-one-file", "title": "Exporting multiple modules in one file", "body": "<p>I need to export two modules in a single Haskell file. Right now, I have</p>\n\n<pre><code>module name (important,functions) where\nmodule nameForTesting where\n\n-- the code is here\n</code></pre>\n\n<p>however, it gives me this error:</p>\n\n<pre><code>filename.hs:5:1: error: parse error on input \u2018module\u2019\n</code></pre>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["haskell", "data-kinds", "forall", "polykinds"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569165013, "post_id": 58048754, "comment_id": 102499174, "body": "Why not just use the <code>Category</code> class from <code>Control.Category</code>? It&#39;s essentially the same (including being polykinded)."}], "answers": [{"comments": [{"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1569195907, "post_id": 58049885, "comment_id": 102506289, "body": "Thanks, this makes sense. I don&#39;t understand the &quot;Your original signatures were too restricted&quot; comment though. It seems like your signatures are the same as mine, just with differently named skolems."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1569207271, "post_id": 58049885, "comment_id": 102507854, "body": "I think you misread the type signatures in the question. It&#39;s <code>bifunction_id :: Bifunction &#39;(a, a&#39;) &#39;(a, a&#39;)</code>, not <code>bifunction_id :: Bifunction &#39;(a, a) &#39;(a, a)</code>. Similar for the composition operation. Changing <code>a</code> to <code>x</code> and <code>a&#39;</code> to <code>y</code> doesn&#39;t make a difference."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1569207770, "post_id": 58049885, "comment_id": 102507919, "body": "No worries. Thanks for teaching me a new technique, I&#39;ve often needed to &quot;magically&quot; introduce constraints into scope."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1569207540, "last_edit_date": 1569207540, "creation_date": 1569160529, "answer_id": 58049885, "question_id": 58048754, "link": "https://stackoverflow.com/questions/58048754/unifying-polykinded-quantification-variable-with-tuple-kinded-type/58049885#58049885", "title": "Unifying polykinded quantification variable with tuple kinded type", "body": "<p>In <code>gid @Bifunction</code>'s definition, you have a type <code>a :: (Type, Type)</code>. <code>(,)</code> only has one constructor, so we can deduce that there must exist <code>x :: Type</code> and <code>y :: Type</code> such that <code>a ~ '(x, y)</code>. However, this reasoning is not expressible in Haskell. Basically, when you have a type-level pair (something of type <code>(i, j)</code>) in Haskell, you can not assume that it is actually a pair (something of form <code>'(x, y)</code>). This causes your code to break: you have <code>Bifunction id id :: forall x y. Bifunction '(x, y) '(x, y)</code>, but you need a <code>Bifunction a a</code>, and you just do not have a typing rule that lets you assume that <code>a ~ (x, y)</code> for some <code>x</code>, <code>y</code>. When you use the alternate, weird definition of <code>Bifunction</code>, then you get <code>Bifunction id id :: forall a. Bifunction a a</code> (because that's the return type of the constructor), and it works basically because <code>Fst</code> and <code>Snd</code> are \"partial\" functions.</p>\n\n<p>I would personally just add \"all pairs are actually pairs\" as an axiom.</p>\n\n<pre><code>data IsTup (xy :: (i, j)) =\n    forall (x :: i) (y :: j). xy ~ '(x, y) =&gt; IsTup\n-- could also write\n-- data IsTup (xy :: (i, j)) where\n--     IsTup :: forall (x :: i) (y :: j). IsTup '(x, y)\nisTup :: forall xy. IsTup xy\nisTup = unsafeCoerce IsTup\n\nbifunction_id :: Bifunction '(a, x) '(a, x)\nbifunction_id = Bifunction id id\nbifunction_compose :: Bifunction '(b, y) '(c, z) -&gt; Bifunction '(a, x) '(b, y) -&gt; Bifunction '(a, c) '(x, z)\nbifunction_compose (Bifunction fl fr) (Bifunction gl gr) = Bifunction (fl . gl) (fr . gr)\n\ninstance GCategory Bifunction where\n   gid :: forall a. Bifunction a a -- necessary to bind a\n   -- usage of axiom: isTup produces a \"proof\" that a is actually a pair and\n   -- matching against IsTup \"releases\" the two components and the equality \n   gid | IsTup &lt;- isTup @a = bifunction_id\n   gcompose :: forall a b c. Bifunction b c -&gt; Bifunction a b -&gt; Bifunction a c\n   gcompose\n     | IsTup &lt;- isTup @a, IsTup &lt;- isTup @b, IsTup &lt;- isTup @c\n     = bifunction_compose\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1569190224, "post_id": 58049997, "comment_id": 102505446, "body": "Isn&#39;t the decomposition you&#39;re doing by turning <code>NotAPair &#39;() &#39;() &#39;() ~ &#39;(,) x y</code> into <code>NotAPair &#39;() ~ &#39;(,)</code>, <code>&#39;() ~ x</code>, <code>&#39;() ~ y</code> only valid when we are looking at generative + injective type mappings (which elsewhere are called &quot;matchable&quot;)? As far as I understand the type system doesn&#39;t bother to decompose things like this anyway when faced with a type family instead of a type constructor, so you don&#39;t end up with the absurd conclusion you&#39;re illustrating. Am I getting something wrong?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1569191487, "post_id": 58049997, "comment_id": 102505669, "body": "The point is precisely that <code>NotAPair</code> is creating a generative type mapping out of thin air."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1569161396, "creation_date": 1569161396, "answer_id": 58049997, "question_id": 58048754, "link": "https://stackoverflow.com/questions/58048754/unifying-polykinded-quantification-variable-with-tuple-kinded-type/58049997#58049997", "title": "Unifying polykinded quantification variable with tuple kinded type", "body": "<p><code>forall (x :: k) (y :: l). p '(x, y)</code> is less general than <code>forall (a :: (k, l)). p a</code>, mainly because there are things of kind <code>(k, l)</code> which are not pairs.</p>\n\n<pre><code>type family NotAPair :: () -&gt; () -&gt; () -&gt; (k, l)\n</code></pre>\n\n<p>(Note that the type family has no parameters, it's not the same as <code>NotAPair (u :: ()) (v :: ()) (w :: ()) :: ()</code>). If <code>NotAPair '() '() '() :: (k, l)</code> were actually a pair <code>'(,) x y</code>, then we would have this nonsense: <code>'(,) ~ NotAPair '()</code>, <code>x ~ '()</code>, <code>y ~ '()</code>.</p>\n\n<p>See also Computing with impossible types <a href=\"https://gelisam.blogspot.com/2017/11/computing-with-impossible-types.html\" rel=\"nofollow noreferrer\">https://gelisam.blogspot.com/2017/11/computing-with-impossible-types.html</a></p>\n\n<p>And even if \"all things of kind <code>(k, l)</code> are pairs\", there are different ways to make that fact available in the language. If you make it implicit, so that you could for example implicitly convert a <code>forall x y. p '(x, y)</code> into a <code>forall a. p a</code>, you may (or may not) make typechecking undecidable. If you make it explicit, you will have to work to write that conversion (that's Coq for example).</p>\n"}], "owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "accepted_answer_id": 58049997, "answer_count": 2, "score": 5, "last_activity_date": 1569207540, "creation_date": 1569151645, "question_id": 58048754, "link": "https://stackoverflow.com/questions/58048754/unifying-polykinded-quantification-variable-with-tuple-kinded-type", "title": "Unifying polykinded quantification variable with tuple kinded type", "body": "<p>I have the following class representing categories where the object class is represented by a kind, and each hom class is represented by a type indexed by types of the aforementioned kind.</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, PolyKinds #-}\n\ntype Hom o = o -&gt; o -&gt; *\n\nclass GCategory (p :: Hom o)\n  where\n  gid :: p a a\n  gcompose :: p b c -&gt; p a b -&gt; p a c\n</code></pre>\n\n<p>a simple example of an instance is:</p>\n\n<pre><code>instance GCategory (-&gt;)\n  where\n  gid = id\n  gcompose = (.)\n</code></pre>\n\n<p>Now I want to model product categories. As a simple starting point, here's a type modeling the morphisms of a category corresponding to a product of <code>-&gt;</code> with itself:</p>\n\n<pre><code>data Bifunction ab cd\n  where\n  Bifunction :: (a -&gt; c) -&gt; (b -&gt; d) -&gt; Bifunction '(a, b) '(c, d)\n</code></pre>\n\n<p>here's the corresponding operations:</p>\n\n<pre><code>bifunction_id :: Bifunction '(a, a') '(a, a')\nbifunction_id = Bifunction id id\n\nbifunction_compose :: Bifunction '(b, b') '(c, c') -&gt; Bifunction '(a, a') '(b, b') -&gt; Bifunction '(a, a') '(c, c')\nbifunction_compose (Bifunction f1 g1) (Bifunction f2 g2) = Bifunction (f1 . f2) (g1 . g2)\n</code></pre>\n\n<p>but when I try to stick the operations into an instance of the class:</p>\n\n<pre><code>instance GCategory Bifunction\n  where\n  gid = bifunction_id\n  gcompose = bifunction_compose\n</code></pre>\n\n<p>I run into the following issue:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018a\u2019 with \u2018'(a0, a'0)\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n    the type signature for:\n      gid :: forall (a :: (*, *)). Bifunction a a\n    at /tmp/ghc-mod29677/Bifunction29676-49.hs:28:3-5\n  Expected type: Bifunction a a\n    Actual type: Bifunction '(a0, a'0) '(a0, a'0)\n\u2022 In the expression: bifunction_id\n  In an equation for \u2018gid\u2019: gid = bifunction_id\n  In the instance declaration for \u2018GCategory Bifunction\u2019\n\u2022 Relevant bindings include\n    gid :: Bifunction a a\n      (bound at /tmp/ghc-mod29677/Bifunction29676-49.hs:28:3)\n</code></pre>\n\n<p>I believe the important part of the message is the following:</p>\n\n<pre><code>  Expected type: Bifunction a a\n    Actual type: Bifunction '(a0, a'0) '(a0, a'0)\n</code></pre>\n\n<p>specifically that it can't unify the type <code>forall x y. Bifunction '(x, y) '(x, y)</code> with the type <code>forall (a :: (*, *)). Bifunction a a</code>.</p>\n\n<p>Stripping away most of the domain specific stuff, we're left with the following minimal repro of the problem:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, PolyKinds, RankNTypes #-}\n\nmodule Repro where\n\ndata Bifunction ab cd\n  where\n  Bifunction :: (a -&gt; c) -&gt; (b -&gt; d) -&gt; Bifunction '(a, b) '(c, d)\n\nbifunction_id :: Bifunction '(a, a') '(a, a')\nbifunction_id = Bifunction id id\n\nbifunction_id' :: Bifunction a a\nbifunction_id' = bifunction_id\n</code></pre>\n\n<p>Is there a way I can unify <code>bifunction_id</code> with <code>bifunction_id'</code> above?</p>\n\n<hr>\n\n<p>An alternative approach I've tried is to use type families, but that still doesn't completely solve the problem:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, PolyKinds, RankNTypes, TypeFamilies #-}\n\nmodule Repro where\n\ntype family Fst (ab :: (x, y)) :: x\n  where\n  Fst '(x, y) = x\n\ntype family Snd (ab :: (x, y)) :: y\n  where\n  Fst '(x, y) = y\n\ndata Bifunction ab cd = Bifunction (Fst ab -&gt; Fst cd) (Snd cd -&gt; Snd cd)\n\nbifunction_id :: Bifunction '(a, a') '(a, a')\nbifunction_id = Bifunction id id\n\n-- This still doesn't work\n-- bifunction_id' :: Bifunction a a\n-- bifunction_id' = bifunction_id\n\n-- But now I can do this successfully\nbifunction_id' :: Bifunction a a\nbifunction_id' = Bifunction id id\n</code></pre>\n\n<p>But I don't really understand why this identical expression works, and would rather not have to manage a somewhat non obvious distinction like this throughout the rest of the code.</p>\n"}, {"tags": ["haskell", "import"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1569151685, "post_id": 58048733, "comment_id": 102496130, "body": "You can not hide instance declarations. I do not really see why you want to do that anyway, since for a list, the instances are, exactly defined as you defined these."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569151713, "post_id": 58048733, "comment_id": 102496141, "body": "You can however explicitly not import the <code>Prelude</code> at all, but then you thus will not import any function of the prelude."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1569154849, "last_edit_date": 1569154849, "creation_date": 1569152391, "answer_id": 58048854, "question_id": 58048733, "link": "https://stackoverflow.com/questions/58048733/hiding-instance-declaration-from-prelude/58048854#58048854", "title": "Hiding instance declaration from Prelude", "body": "<p>The <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-1060005.4\" rel=\"nofollow noreferrer\">Haskell report</a> says:</p>\n\n<blockquote>\n  <p>Instance declarations cannot be explicitly named on import or export lists. All instances in scope within a module are always exported and <strong>any import brings all instances in from the imported module</strong>. Thus, an instance declaration is in scope if and only if a chain of import declarations leads to the module containing the instance declaration.</p>\n</blockquote>\n\n<p>It is thus not possible to exclude a certain instance. That being said, here it is not necessary at all to implement your <code>Semigroup</code> and <code>Monoid</code> for a list, since it is already defined. Indeed if, we inspect the source code, we see for <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-290\" rel=\"nofollow noreferrer\"><code>Semigroup</code> [src]</a>:</p>\n\n<blockquote><pre><code>-- | @since 4.9.0.0\ninstance Semigroup [a] where\n        <b>(&lt;&gt;) = (++)</b>\n        {-# INLINE (&lt;&gt;) #-}\n\n        stimes = stimesList</code></pre></blockquote>\n\n<p>and for <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-297\" rel=\"nofollow noreferrer\"><code>Monoid</code> [src]</a>:</p>\n\n<blockquote><pre><code>-- | @since 2.01\ninstance Monoid [a] where\n        {-# INLINE mempty #-}\n        <b>mempty  = []</b>\n        {-# INLINE mconcat #-}\n        mconcat xss = [x | xs &lt;- xss, x &lt;- xs]</code></pre></blockquote>\n\n<p>So this is already implemented exactly the way you implemented this yourself.</p>\n\n<p>It is usually considered an anti-pattern to implement an instance of a typeclass you did not implement yourself, on a data type you did not implement yourself. This is called an <a href=\"https://wiki.haskell.org/Orphan_instance\" rel=\"nofollow noreferrer\"><em>orphan instance</em> [haskell-wiki]</a>:</p>\n\n<blockquote>\n  <p>An orphan instance is a type class instance for class <em>C</em> and type <em>T</em> which is <strong>neither defined in the module where <em>C</em> is defined nor in the module where <em>T</em> is defined</strong>.</p>\n</blockquote>\n\n<p>Usually one wraps a type into another data constructor (with <code>newtype</code>) to define different instances for that type for a typeclass.</p>\n"}], "owner": {"reputation": 19222, "user_id": 789186, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9d232cc5abe46092d3972d4f85833e42?s=128&d=identicon&r=PG", "display_name": "user4035", "link": "https://stackoverflow.com/users/789186/user4035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 58048854, "answer_count": 1, "score": 2, "last_activity_date": 1569154849, "creation_date": 1569151502, "question_id": 58048733, "link": "https://stackoverflow.com/questions/58048733/hiding-instance-declaration-from-prelude", "title": "Hiding instance declaration from Prelude", "body": "<p>I am playing with Monoids now and wanted to define my instances of <code>&lt;&gt;</code> and <code>mempty</code> for a list. I wrote this:</p>\n\n<pre><code>instance Semigroup [a] where\n  (&lt;&gt;) = (++)\n\ninstance Monoid [a] where\n  mempty = []\n</code></pre>\n\n<p>But got an error:</p>\n\n<pre><code>Duplicate instance declarations:\n     instance Monoid [a] -- Defined at newtype.hs:25:10\n     instance Monoid [a] -- Defined in \u2018GHC.Base\u2019\n</code></pre>\n\n<p>Probably, I need to add this at the beginning of file:</p>\n\n<pre><code>import Prelude hiding (???)\n</code></pre>\n\n<p>What should I write in place of \"???\"?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1569085810, "creation_date": 1569085810, "answer_id": 58042429, "question_id": 58042134, "link": "https://stackoverflow.com/questions/58042134/problem-loading-module-data-number-creal-in-cabal-file/58042429#58042429", "title": "Problem loading module Data.Number.CReal in cabal file", "body": "<p>The <code>dependencies</code> field, which specifies the <code>numbers</code> dependency, should be in your <a href=\"https://stackoverflow.com/q/40332040/2751851\"><code>package.yaml</code> file</a> (which Stack uses to generate the cabal file), and not in <code>stack.yaml</code> (which is for Stack-specific configuration, such as choosing the resolver).</p>\n"}], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58042429, "answer_count": 1, "score": 2, "last_activity_date": 1569085819, "creation_date": 1569083381, "last_edit_date": 1569085819, "question_id": 58042134, "link": "https://stackoverflow.com/questions/58042134/problem-loading-module-data-number-creal-in-cabal-file", "title": "Problem loading module Data.Number.CReal in cabal file", "body": "<p>I installed a simple proyect with stack, my stack.yaml looks like:</p>\n\n<pre><code>resolver: lts-14.6\n\npackages:\n- .\n\ndependencies:\n  - base (&gt;=3 &amp;&amp; &lt;5)\n  - numbers\n</code></pre>\n\n<p>and I have a simple code that only calls a function:</p>\n\n<pre><code>module Main where\n\nimport Lib\nimport Data.Number.CReal\n\nmain :: IO ()\nmain = someFunc\n</code></pre>\n\n<p>and the error is always the same:</p>\n\n<pre><code>numbers-play-0.1.0.0: unregistering (local file changes: numbers-play.cabal)\nnumbers-play&gt; configure (lib + exe)\nConfiguring numbers-play-0.1.0.0...\nnumbers-play&gt; build (lib + exe)\nPreprocessing library for numbers-play-0.1.0.0..\nBuilding library for numbers-play-0.1.0.0..\n[1 of 2] Compiling Lib\n[2 of 2] Compiling Paths_numbers_play\nPreprocessing executable 'numbers-play-exe' for numbers-play-0.1.0.0..\nBuilding executable 'numbers-play-exe' for numbers-play-0.1.0.0..\n[1 of 2] Compiling Main [Data.Number.CReal changed]\n\n/home/damian/dev/haskell/numbers-play/app/Main.hs:4:1: error:\n    Could not load module \u2018Data.Number.CReal\u2019\n    It is a member of the hidden package \u2018numbers-3000.2.0.2\u2019.\n    Perhaps you need to add \u2018numbers\u2019 to the build-depends in your .cabal file.\n    Use -v to see a list of the files searched for.\n  |\n4 | import Data.Number.CReal\n  | ^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>My cabal file:</p>\n\n<pre><code>cabal-version: 1.12\n\n-- This file has been generated from package.yaml by hpack version 0.31.2.\n--\n-- see: https://github.com/sol/hpack\n--\n-- hash: fb0ed9e8eb8062639f1d6a02a65d857d15b3265158925242287d4a8a885f8381\n\nname:           numbers-play\nversion:        0.1.0.0\ndescription:    Please see the README on GitHub at &lt;https://github.com/githubuser/numbers-play#readme&gt;\nhomepage:       https://github.com/githubuser/numbers-play#readme\nbug-reports:    https://github.com/githubuser/numbers-play/issues\nauthor:         Author name here\nmaintainer:     example@example.com\ncopyright:      2019 Author name here\nlicense:        BSD3\nlicense-file:   LICENSE\nbuild-type:     Simple\nextra-source-files:\n    README.md\n    ChangeLog.md\n\nsource-repository head\n  type: git\n  location: https://github.com/githubuser/numbers-play\n\nlibrary\n  exposed-modules:\n      Lib\n  other-modules:\n      Paths_numbers_play\n  hs-source-dirs:\n      src\n  build-depends:\n      base &gt;=4.7 &amp;&amp; &lt;5\n  default-language: Haskell2010\n\nexecutable numbers-play-exe\n  main-is: Main.hs\n  other-modules:\n      Paths_numbers_play\n  hs-source-dirs:\n      app\n  ghc-options: -threaded -rtsopts -with-rtsopts=-N\n  build-depends:\n      base &gt;=4.7 &amp;&amp; &lt;5\n    , numbers-play\n  default-language: Haskell2010\n\ntest-suite numbers-play-test\n  type: exitcode-stdio-1.0\n  main-is: Spec.hs\n  other-modules:\n      Paths_numbers_play\n  hs-source-dirs:\n      test\n  ghc-options: -threaded -rtsopts -with-rtsopts=-N\n  build-depends:\n      base &gt;=4.7 &amp;&amp; &lt;5\n    , numbers-play\n  default-language: Haskell2010\n</code></pre>\n\n<p>How can I import it properly?</p>\n"}, {"tags": ["haskell", "type-families"], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1569076935, "creation_date": 1569076024, "last_edit_date": 1569076935, "question_id": 58041216, "link": "https://stackoverflow.com/questions/58041216/generalizing-extending-a-type-by-a-data-family", "title": "Generalizing extending a type by a data family", "body": "<p>I'm writing a library where I'm extending several types of kind <code>* -&gt; * -&gt; *</code> into type families of kind <code>k -&gt; k -&gt; k</code> (for certain <code>k</code>) using a data family:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeFamilyDependencies #-}\n{-# LANGUAGE TypeOperators #-}\n-- ...\n\ntype family (+) = (c :: k -&gt; k -&gt; k) | c -&gt; k where\n  (+) = Either\n  (+) = Sum_\ninfixl 6 +\n\ndata family Sum_ (a :: j -&gt; k) (b :: j -&gt; k) :: j -&gt; k\nnewtype instance Sum_ a b x = Sum1 { getSum1 :: a x + b x }\nnewtype instance Sum_ a b x y = Sum2 { getSum2 :: a x y + b x y }\nnewtype instance Sum_ a b x y z = Sum3 { getSum3 :: a x y z + b x y z }\n\ntype family (\u00d7) = (p :: k -&gt; k -&gt; k) | p -&gt; k where\n  (\u00d7) = (,)\n  (\u00d7) = Product_\ninfixl 7 \u00d7\n\ndata family Product_ (a :: j -&gt; k) (b :: j -&gt; k) :: j -&gt; k\nnewtype instance Product_ a b x = Product1 { getProduct1 :: a x \u00d7 b x }\nnewtype instance Product_ a b x y = Product2 { getProduct2 :: a x y \u00d7 b x y }\nnewtype instance Product_ a b x y z = Product3 { getProduct3 :: a x y z \u00d7 b x y z }\n</code></pre>\n\n<p>This works great, but I can't help but notice repetition in how I'm extending each type, so naturally I want to capture that pattern and use it to cut down on boilerplate:</p>\n\n<pre><code>type family Extension (base :: * -&gt; * -&gt; *) = (p :: k -&gt; k -&gt; k) | p -&gt; k where\n  Extension base = base\n  Extension base = Extension_ base\n\ndata family Extension_ (base :: * -&gt; * -&gt; *) (a :: j -&gt; k) (b :: j -&gt; k) :: j -&gt; k\nnewtype instance Extension_ base a b x = Extension1 { getExtension1 :: Extension base (a x) (b x) }\nnewtype instance Extension_ base a b x y = Extension2 { getExtension2 :: Extension base (a x y) (b x y) }\nnewtype instance Extension_ base a b x y z = Extension3 { getExtension3 :: Extension base (a x y z) (b x y z) }\n\ntype (+) = Extension Either\ninfixl 6 +\n\ntype (\u00d7) = Extension (,)\ninfixl 7 +\n\ntype (^) = Extension (Dual (-&gt;))\ninfixr 8 ^\n</code></pre>\n\n<p>Unfortunately, this appears to violate injectivity as GHC understands it (though, as far as I can tell, there's only one possible <code>k</code> for each <code>Extension base</code>):</p>\n\n<pre><code>src/Extension.hs:36:3: error:\n    \u2022 Type family equation violates injectivity annotation.\n      RHS of injective type family equation is a bare type variable\n      but these LHS type and kind patterns are not bare variables: \u2018*\u2019\n        Extension base = base\n          -- Defined at src/Extension.hs:36:3\n    \u2022 In the equations for closed type family \u2018Extension\u2019\n      In the type family declaration for \u2018Extension\u2019\n   |\n36 |   Extension base = base\n   |   ^^^^^^^^^^^^^^^^^^^^^\n\nsrc/Extension.hs:36:3: error:\n    \u2022 Type family equations violate injectivity annotation:\n        Extension base = base\n          -- Defined at src/Extension.hs:36:3\n        Extension base = Extension_ base\n          -- Defined at src/Extension.hs:37:3\n    \u2022 In the equations for closed type family \u2018Extension\u2019\n      In the type family declaration for \u2018Extension\u2019\n   |\n36 |   Extension base = base\n   |   ^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>If I ditched the type family and went for a pure data family solution, I wouldn't have this problem, but I don't want to introduce <code>newtype</code> wrappers around the <code>* -&gt; * -&gt; *</code> kinded type operators.</p>\n\n<p>Is there another way I can capture and reuse the <code>Extension</code> pattern?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569073028, "post_id": 58040821, "comment_id": 102482110, "body": "Please post the full traceback."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1569073162, "post_id": 58040821, "comment_id": 102482148, "body": "Make sure you do not mix tabs and spaces."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1569073242, "post_id": 58040821, "comment_id": 102482170, "body": "I pasted the code into GHCi and, although it complains about a few type errors, there are no parse errors. (The parsing is done before type checking.) So what you have put here can&#39;t be the exact coding that is leading to your parse error."}, {"owner": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569073723, "post_id": 58040821, "comment_id": 102482328, "body": "@WillemVanOnsem I posted it just now."}, {"owner": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1569073739, "post_id": 58040821, "comment_id": 102482333, "body": "@RobinZigmond I posted the beginning of my code."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1569085311, "post_id": 58040821, "comment_id": 102485078, "body": "I see the same thing as @RobinZigmond. As such, voting to close as a problem that can&#39;t be reproduced."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "edited": false, "score": 0, "creation_date": 1569073586, "post_id": 58040879, "comment_id": 102482274, "body": "but even when I changed everything to Double, it still didn&#39;t work"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "edited": false, "score": 0, "creation_date": 1569079155, "post_id": 58040879, "comment_id": 102483638, "body": "@SpencerHastings: exactly how did you change everything to a <code>Double</code>. Can you edit your question with the new attempt?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1569073376, "creation_date": 1569073376, "answer_id": 58040879, "question_id": 58040821, "link": "https://stackoverflow.com/questions/58040821/why-am-i-getting-parse-error-on-input-x1/58040879#58040879", "title": "why am I getting parse error on input &#39;x1&#39;?", "body": "<p>Haskell is <em>strongly</em> typed. That means it does not implictly convert an <code>Int</code> to a <code>Double</code> for example. You thus can not construct expressions like <code>(-b + sqrt delta)/(2*a)</code>.</p>\n\n<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fromIntegral\" rel=\"nofollow noreferrer\"><strong><code>fromIntegral :: (Integral i, Num n) =&gt; i -&gt; n</code></strong></a> to convert from an <code>Int</code> to a <code>Double</code>:</p>\n\n<pre><code>roots :: Int -&gt; Int -&gt; Int -&gt; [Double]\nroots a b c = if delta &gt; 0 then [x1,x2]\n           else if delta == 0 then [x1]\n           else []\n where\n    delta = b*b - 4*a*c\n    sqdelta = sqrt (<b>fromIntegral</b> delta)\n    x1 = -0.5*(<b>fromIntegral</b> b + sqdelta) / <b>fromIntegral</b> a\n    x2 = -0.5*(<b>fromIntegral</b> b - sqdelta)/ <b>fromIntegral</b> a</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "edited": false, "score": 0, "creation_date": 1569095485, "post_id": 58043301, "comment_id": 102487471, "body": "how can you tell if it&#39;s tabs or spaces from looking at my code?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "edited": false, "score": 0, "creation_date": 1569097263, "post_id": 58043301, "comment_id": 102487851, "body": "Press the edit button on your post to see the actual text you pasted, rather than the rendered HTML."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1569092828, "creation_date": 1569092828, "answer_id": 58043301, "question_id": 58040821, "link": "https://stackoverflow.com/questions/58040821/why-am-i-getting-parse-error-on-input-x1/58043301#58043301", "title": "why am I getting parse error on input &#39;x1&#39;?", "body": "<p>You are mixing spaces and tabs. <code>delta</code> is indented by two tabs, and <code>x1</code> by some number of spaces. Don't do that.</p>\n"}], "owner": {"reputation": 45, "user_id": 7323351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bad8c3200e392b8f77102088fd0f075?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Hastings", "link": "https://stackoverflow.com/users/7323351/spencer-hastings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1569092828, "creation_date": 1569072953, "last_edit_date": 1569073563, "question_id": 58040821, "link": "https://stackoverflow.com/questions/58040821/why-am-i-getting-parse-error-on-input-x1", "title": "why am I getting parse error on input &#39;x1&#39;?", "body": "<p>So nroots is a function which returns the number of roots of a Polynomial based on the delta value.\nThen I created a function which returns the actual value of the roots of the polynomial. If the nroots is equal to 1 then roots returns a list with 1 item, if it's equal to two then it returns a list with 2 itens.\nHowever, when I try to compile it, I always get error: parse error on input 'x1'\nHere is my code:</p>\n\n<pre><code>module Main where\nmain = do putStrLn \"Hello World\"\n\nnroots :: Int -&gt; Int -&gt; Int -&gt; Int\n\nnroots a b c = if delta &gt; 0 then 2 \n            else if delta == 0 then 1\n            else 0\n   where\n     delta = b^2 - 4*a*c\n\nroots :: Int -&gt; Int -&gt; Int -&gt; [Double]\nroots a b c = if n &gt; 0 then [x1,x2]\n           else if n ==0 then [x1]\n           else []\n where\n    n = nroots a b c\n    delta = b^2 - 4*a*c\n    x1 = (-b +sqrt(delta))/2*a\n    x2 = (-b -sqrt(delta))/2*a\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1569072083, "post_id": 58040688, "comment_id": 102481894, "body": "I don&#39;t understand what you mean by &quot;evaluate functions&quot; and &quot;return functions&quot;."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1569072084, "post_id": 58040688, "comment_id": 102481895, "body": "This seems like 3 completely different questions - some of them (the first, in particular) too  vaguely stated to really be able to answer. It is fine to have several different questions, but please create a new question for each, rather than putting unrelated queries into one question."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1569072151, "post_id": 58040688, "comment_id": 102481906, "body": "&quot;<i>Suppose that in the middle of a function definition, I say <code>temp = x + 1</code>.</i>&quot; That&#39;s a syntax error."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569072171, "post_id": 58040688, "comment_id": 102481915, "body": "In Haskell all variables are immutable. <code>f</code> can not increment a variable. <code>f</code> simply returns a <code>x+1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1569084692, "post_id": 58040873, "comment_id": 102484925, "body": "Please don&#39;t spread the dangerous misconception that <code>succ</code> is always the same as <code>(+1)</code> when both are available. They&#39;re different for <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Fixed.html#t:Fixed\" rel=\"nofollow noreferrer\"><code>Fixed</code></a>, for example, and the assumption that they&#39;re always the same causes <a href=\"https://stackoverflow.com/q/57843502/7509065\">real problems</a>."}, {"owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1569090558, "post_id": 58040873, "comment_id": 102486266, "body": "Ah, you&#39;re right! succ would give you the next possible value while +1 would increment by one unit."}], "tags": [], "owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "is_accepted": true, "score": 0, "last_activity_date": 1569084617, "last_edit_date": 1569084617, "creation_date": 1569073354, "answer_id": 58040873, "question_id": 58040688, "link": "https://stackoverflow.com/questions/58040688/haskell-function-evaluation/58040873#58040873", "title": "Haskell - Function Evaluation", "body": "<p>This certainly was a collection of questions. </p>\n\n<p>Firstly, about evaluation, Haskell is lazy. It will evaluate values as they are needed. This includes the fact that a function is not necessarily evaluated in its entirety. Pattern matching may drive evaluation in some cases, for instance in <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.Maybe.html#maybe\" rel=\"nofollow noreferrer\"><code>maybe</code></a> either a <code>Nothing</code> or <code>Just x</code> must match, in order to find out what value is produced. But if you didn't demand the result in the first place, this matching was never needed. </p>\n\n<p><code>f</code> in your example is a function known as <code>(+1)</code>, or more explicitly <code>\\x -&gt; x + 1</code>. Being a function, it must be applied to a value to produce another, and there is in fact a pattern; the argument <code>x</code>, having type <code>Int</code>. This works as a simple binding, but it could have been a constant value pattern like <code>1</code> instead. Here's an example:</p>\n\n<pre><code>fib :: Int -&gt; Int\nfib 0 = 1\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>The two first patterns give us our base cases. </p>\n\n<p>An 8x8 grid of numbers is a matrix, not a list. <a href=\"https://hackage.haskell.org/package/array-0.5.2.0/docs/Data-Array.html\" rel=\"nofollow noreferrer\">Data.Array</a>, <a href=\"https://hackage.haskell.org/package/matrix-0.3.6.1/docs/Data-Matrix.html\" rel=\"nofollow noreferrer\">Data.Matrix</a> and <a href=\"https://hackage.haskell.org/package/vector-0.12.0.3/docs/Data-Vector.html\" rel=\"nofollow noreferrer\">Data.Vector</a> provide types that can describe such things more accurately, and what you describe can be done. Data.Ix provides multidimensional indices and functions like <a href=\"https://hackage.haskell.org/package/vector-0.12.0.3/docs/Data-Vector.html#v:modify\" rel=\"nofollow noreferrer\">Data.Vector.modify</a> may perform updates in place without violating value immutability. </p>\n\n<p><code>let bindings in expression</code> and <code>expression where bindings</code> are mostly a matter of preference. <code>let binding</code> within a <code>do</code> block is a different matter. In your sample binding <code>temp = x + 1</code>, <code>x</code> must be bound from elsewhere, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-43-\" rel=\"nofollow noreferrer\"><code>+</code></a> is of type <code>Num a =&gt; a -&gt; a -&gt; a</code>, so both <code>x</code> and <code>temp</code> must be the same <code>Num a</code>. A function must take an argument, so this is just a value (though mathematically it's a function of <code>x</code>). </p>\n\n<p>As for <code>do</code> with <code>let</code>, it's essentially a shorthand for adding another binding; you could write:</p>\n\n<pre><code>main = do\n    putStrLn \"hello\"\n    let word = \"world\"\n    putStrLn word\n</code></pre>\n\n<p>and it's equivalent to:</p>\n\n<pre><code>main = do\n    putStrLn \"hello\"\n    let word = \"world\" in do\n        putStrLn word\n</code></pre>\n\n<p>This provides a way to introduce a pure value mid-<code>do</code>, like <code>&lt;-</code> introduces monadic ones. </p>\n"}], "owner": {"reputation": 129, "user_id": 11940374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHjkCuSC4Ig/AAAAAAAAAAI/AAAAAAAAABE/jyw9QYcSD2Y/photo.jpg?sz=128", "display_name": "Agent 008", "link": "https://stackoverflow.com/users/11940374/agent-008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 58040873, "answer_count": 1, "score": -2, "last_activity_date": 1569084617, "creation_date": 1569071893, "question_id": 58040688, "link": "https://stackoverflow.com/questions/58040688/haskell-function-evaluation", "title": "Haskell - Function Evaluation", "body": "<p>I am confused about when Haskell evaluates functions, compared to when it just returns the function itself. I was taught that pattern matching drives function evaluation, but then I don't understand why</p>\n\n<pre><code>f :: Int -&gt; Int\nf x = x+1\n</code></pre>\n\n<p>works. Does f add 1 to an integer, or does it return a function which adds 1 to an integer? Are these two the same thing? There is no pattern matching as far as I can tell, so I'm not sure why it gets evaluated.</p>\n\n<p>Another question: suppose I want to make an 8x8 list that contains all 0's, except the first row contains the numbers 1,2,3,4,5,6,7,8 instead. Is there any way I could initialize it to all 0's first and then change the first row to [1..8]? I understand that it's not idiomatic to make sequential code like this, so is there a better way to do it, hopefully without using <code>do</code> blocks?</p>\n\n<p>Finally, I am also confused about the <code>let</code> and <code>where</code> syntax. Suppose that in the middle of a function definition, I say <code>temp = x + 1</code>. How is this different from saying <code>let temp = x + 1</code> or <code>...temp where temp = x + 1</code>? In each of these cases, does <code>temp</code> have type <code>Int</code> or <code>Int -&gt; Int</code>? Why do people use <code>do</code> with <code>let</code> so often?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1569066013, "post_id": 58039893, "comment_id": 102480516, "body": "Hints: start by writing the types of all your functions. E.g. <code>tre :: Tree a -&gt; [a]</code>. Then fix the type errors first. <code>tre (LEAF a) = a</code> does not return a list. In the other case you should recurse and use <code>++</code> to join the two lists (and don&#39;t forget the value in the node). In <code>sum</code> there is no need to check <code>tre x == Int</code>, that does not mean anything. Rather, make <code>sum</code> work on a <code>Tree Int</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569066015, "post_id": 58039893, "comment_id": 102480517, "body": "There are a lot of problems here: you mix type constructors (<code>Tree</code>) with data constructors (well you use these in your expression), there are type errors, etc. The main error is already in the <code>tre</code> function. So I suggest you take a look at that."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1569066057, "post_id": 58039893, "comment_id": 102480531, "body": "<code>But it&#39;s shooting an error every time.</code>. Great - compiler errors are very helpful because they tell you what is wrong with your code, and where! And while some errors can be hard to understand, if you want the Stack Overflow community to help you out you need to share what the error message is, and anything you might have tried or suspected relating to it."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569066123, "post_id": 58039893, "comment_id": 102480545, "body": "I would find it a bit (very) odd that a compiler raises an error one time, but not the next time."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1569143405, "post_id": 58039893, "comment_id": 102494243, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9834976, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uBxAMGiP8_I/AAAAAAAAAAI/AAAAAAAAAEU/pmFUc86-ed4/photo.jpg?sz=128", "display_name": "sannidhya malpani", "link": "https://stackoverflow.com/users/9834976/sannidhya-malpani"}, "edited": false, "score": 0, "creation_date": 1569101844, "post_id": 58040952, "comment_id": 102488821, "body": "since we just want sum of values at leaves, at node subtracting &#39;a&#39; is also necessary but thank you. This makes working with trees a lot easier"}], "tags": [], "owner": {"reputation": 152, "user_id": 1011794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cff3ddfb94480f2c2bddeff261dac2?s=128&d=identicon&r=PG", "display_name": "chekkal", "link": "https://stackoverflow.com/users/1011794/chekkal"}, "is_accepted": false, "score": 0, "last_activity_date": 1569074023, "creation_date": 1569074023, "answer_id": 58040952, "question_id": 58039893, "link": "https://stackoverflow.com/questions/58039893/sumation-of-tree/58040952#58040952", "title": "Sumation of tree", "body": "<p>The Haskell snipet provided is not the idiomatic Haskell way of solving the problem.</p>\n\n<ul>\n<li>You don't need the <strong><em>tre</em></strong> function => use Pattern matching on constructors of your type</li>\n<li>You don't have  to use <strong><em>tre x == Int</em></strong> let out the magic of type inference</li>\n</ul>\n\n<p>I've provided the following snippet of the code, load it into ghci and use :i Tree and :i sumTree to understand the types</p>\n\n<pre><code>module Main where\n\ndata Tree a = Leaf a | Node a  (Tree a)  (Tree a) deriving (Show)\n\nsumTree (Leaf a) = a\nsumTree (Node a l r) = a + sumTree l + sumTree r\n\nmain = do \n  let tree =  Node 5 (Node 21 (Leaf 14) (Leaf 13)) (Leaf 29)\n  putStrLn $ show tree\n  putStrLn $ show $ sumTree tree\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9834976, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uBxAMGiP8_I/AAAAAAAAAAI/AAAAAAAAAEU/pmFUc86-ed4/photo.jpg?sz=128", "display_name": "sannidhya malpani", "link": "https://stackoverflow.com/users/9834976/sannidhya-malpani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1569143353, "creation_date": 1569065720, "last_edit_date": 1569143353, "question_id": 58039893, "link": "https://stackoverflow.com/questions/58039893/sumation-of-tree", "title": "Sumation of tree", "body": "<p>So for this problem I tried to take the sum of all leaves in a tree. But it's shooting an error every time. I am providing a snippet of the code I wrote.</p>\n\n<p>Sample case</p>\n\n<pre><code>t1 =NODE 1 (NODE 2 (NODE 3 (LEAF 4) (LEAF 5)) (LEAF 6)) (NODE 7 (LEAF 8) (LEAF 9))\n</code></pre>\n\n<p>Answer should be 32.</p>\n\n<pre><code>data Tree a = LEAF a | NODE a  (Tree a)  (Tree a) deriving (Show, Read, Eq)\n\ntre (LEAF a) = a\ntre (NODE a (Tree b) (Tree c)) = [Tree b, Tree c]\n\nsum [] accum = []\nsum list@(x:xs) accum = if tre x == Int \n                        then sumTree xs (accum + x) \n                        else sumTree x accum\n\nsumTree :: Num p =&gt; Tree p -&gt; p\nsumTree p accum= let\n                list = tre p\n                in sum list accum \n</code></pre>\n\n<p>32</p>\n"}, {"tags": ["string", "haskell", "text", "compiler-errors"], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 2, "last_activity_date": 1569065605, "creation_date": 1569065605, "answer_id": 58039873, "question_id": 58039818, "link": "https://stackoverflow.com/questions/58039818/data-text-constants-in-haskell/58039873#58039873", "title": "Data.Text constants in Haskell", "body": "<p>I checked the documentation and you're right - this will only work if you are using the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overloaded-string-literals\" rel=\"nofollow noreferrer\">OverloadedStrings</a> GHC extension.</p>\n\n<p>It allows you to use string literals for other \"string-like\" types, and is pretty much a necessity if you're working heavily with <code>Text</code> or <code>ByteString</code>. I am surprised that it does not appear to be mentioned in the documentation, but it is clearly assumed that <code>OverloadedStrings</code> is in use in these examples.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1569065612, "creation_date": 1569065612, "answer_id": 58039878, "question_id": 58039818, "link": "https://stackoverflow.com/questions/58039818/data-text-constants-in-haskell/58039878#58039878", "title": "Data.Text constants in Haskell", "body": "<p>The documentation of <code>Data.Text</code> has for all examples the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-OverloadedStrings\" rel=\"noreferrer\"><strong><code>OverloadedStrings</code></strong></a> extension enabled. This will, for all string literals, add an implicit <code>fromString</code> function call.</p>\n\n<p>For example:</p>\n\n<pre><code>$ ghci <b>-XOverloadedStrings</b>\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/kommusoft/.ghc/ghci.conf\nPrelude&gt; import Data.Text\nPrelude Data.Text&gt; replace &quot;oo&quot; &quot;foo&quot; &quot;oo&quot;\n&quot;foo&quot;</code></pre>\n\n<p>or you can add this as a pragma in your Haskell file:</p>\n\n<pre><code>{-# LANGUAGE <b>OverloadedStrings</b> #-}\n\nimport Data.Text\n\nfoo = replace \"oo\" \"foo\" \"oo\"</code></pre>\n\n<p>By using <code>OverloadedString</code>s you can make your own type that works with string <em>literals</em>. For example you can make a type:</p>\n\n<pre><code>import Data.String\n\nnewtype SpecialString = SpecialString String\n\ninstance <b>IsString SpecialString</b> where\n    fromString = SpecialString</code></pre>\n\n<p>Now you can use string literal, and these can, depending on the context, get converted to a <code>SpecialString</code>.</p>\n"}], "owner": {"reputation": 553, "user_id": 2316602, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8aM2D.jpg?s=128&g=1", "display_name": "user2316602", "link": "https://stackoverflow.com/users/2316602/user2316602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 58039878, "answer_count": 2, "score": 3, "last_activity_date": 1569065612, "creation_date": 1569065255, "question_id": 58039818, "link": "https://stackoverflow.com/questions/58039818/data-text-constants-in-haskell", "title": "Data.Text constants in Haskell", "body": "<p>In the documentation of Data.Text, there are examples such as <code>replace \"oo\" \"foo\" \"oo\"</code>. However, when I try to run this, it tells me that the function replace was expecting Text, but got String. Now, of course, I could use <code>pack</code> in front of every constant to turn the Strings into type Text, but that is rather inconvenient. Is there a way to write text constants the way they do in the documentation?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569060799, "post_id": 58039256, "comment_id": 102479403, "body": "In Haskell you can not change the value of a variable. All variables are immutable. You can only define another variable with the same name (and only in certain situations, like with a <code>let</code>)."}, {"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569060937, "post_id": 58039256, "comment_id": 102479429, "body": "That&#39;s what I thought, but the command line appears to allow me to do this. The scope of command line declarations appear to be global, i.e. you can use them after you have written them. Why can you mutate variable declarations?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1569060990, "post_id": 58039256, "comment_id": 102479437, "body": "no, what you did was basically write <code>let myPi = 3.14 in (let myPi = 4 in ...)</code>, so you constructed <i>another</i> variables with the same name, that is more locally scoped."}, {"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569061067, "post_id": 58039256, "comment_id": 102479455, "body": "ah, ok. How would you get to the original value of <code>myPi</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569061261, "post_id": 58039256, "comment_id": 102479485, "body": "well you can not really exit a <code>let</code> in a <code>do</code> block, since its scope is the rest of the <code>do</code> lines. But you could for example write something like: <code>let myPi = 4 in myPi</code>, and then it will automatically &quot;exit&quot; the scope you defined at the end of that line."}], "answers": [{"comments": [{"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "edited": false, "score": 1, "creation_date": 1569061489, "post_id": 58039320, "comment_id": 102479526, "body": "many thanks, I thought there might be some hidden scoping going on there somewhere"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1569064603, "last_edit_date": 1569064603, "creation_date": 1569061178, "answer_id": 58039320, "question_id": 58039256, "link": "https://stackoverflow.com/questions/58039256/in-haskell-why-does-the-ghci-cmd-line-allow-me-to-change-the-value-of-a-variable/58039320#58039320", "title": "In Haskell why does the GHCi cmd line allow me to change the value of a variable, which isn&#39;t allowed when loading from a text file", "body": "<blockquote>\n  <p>I can do the following in GHCi, which I understand shouldn't be possible in Haskell</p>\n\n<pre><code>Prelude&gt; myPi = 3.14\nPrelude&gt; myPi = 4\nPrelude&gt; myPi\n</code></pre>\n</blockquote>\n\n<p>In <code>ghci</code> you basically are working in an \"implicit\" <code>do</code>. And the interpreter will add an implicit <code>let</code> to it.</p>\n\n<p>You thus wrote the equivalent of:</p>\n\n<pre><code>main = do\n    let myPi = 3.14\n    let myPi = 4\n    print myPi\n</code></pre>\n\n<p>If we desugar the <code>do</code> notation, we thus obtain:</p>\n\n<pre><code>main = let myPi = 3.14 in (let myPi = 4 in print myPi)\n</code></pre>\n\n<p>What we here did was constructing <em>two</em> different variables, that happen to have the same name. <code>let</code> defines a scope, and thus in your <code>print myPi</code>, it takes the variables that has the closest scope, so the second variable.</p>\n\n<p>But outside the inner <code>let &hellip; in &hellip;</code>, there is still a <code>myPi</code> variable with value <code>3.14</code>. So you did <em>not</em> change the value of <code>myPi</code>.</p>\n\n<p>If we for example write:</p>\n\n<pre><code>main = do\n    let myPi = 3.14\n    let myPi = 4 in print myPi\n    print myPi\n</code></pre>\n\n<p>It will first print <code>4</code> (from the inner <code>myPi</code>) and then <code>3.14</code> (from the outer <code>myPi</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "edited": false, "score": 0, "creation_date": 1569067592, "post_id": 58039824, "comment_id": 102480846, "body": "Thanks, that a pretty neat example"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 8, "last_activity_date": 1569065307, "creation_date": 1569065307, "answer_id": 58039824, "question_id": 58039256, "link": "https://stackoverflow.com/questions/58039256/in-haskell-why-does-the-ghci-cmd-line-allow-me-to-change-the-value-of-a-variable/58039824#58039824", "title": "In Haskell why does the GHCi cmd line allow me to change the value of a variable, which isn&#39;t allowed when loading from a text file", "body": "<p>Here's a session which demonstrates that GHCi does <em>not</em> change the value, but rather introduces a new variable with the same name:</p>\n\n<pre><code>Prelude&gt; let myPi = 3.14\nPrelude&gt; let f x = x + myPi\nPrelude&gt; let myPi = 4\nPrelude&gt; f 0\n3.14\n</code></pre>\n"}], "owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 58039320, "answer_count": 2, "score": 1, "last_activity_date": 1569065307, "creation_date": 1569060547, "last_edit_date": 1569060982, "question_id": 58039256, "link": "https://stackoverflow.com/questions/58039256/in-haskell-why-does-the-ghci-cmd-line-allow-me-to-change-the-value-of-a-variable", "title": "In Haskell why does the GHCi cmd line allow me to change the value of a variable, which isn&#39;t allowed when loading from a text file", "body": "<p>I can do the following in GHCi, which I understand shouldn't be possible in Haskell:</p>\n\n<pre><code>Prelude&gt; myPi = 3.14\nPrelude&gt; myPi = 4\nPrelude&gt; myPi\n4\n</code></pre>\n\n<p>But if I put this in a file it gives me an error</p>\n\n<pre><code>-- main.hs\nmyPi = 3.14\nmyPi = 4\n</code></pre>\n\n<pre><code>Prelude&gt; :l main.hs\nmain.hs:2:1: error:\n    Multiple declarations of \u2018myPi\u2019\n    Declared at: main.hs:1:1\n                 main.hs:2:1\n</code></pre>\n\n<p>What is GHCi doing to allow me to 'redeclare' variables. Is there a way of stopping this happening?</p>\n"}, {"tags": ["haskell", "ghc", "ghc-api"], "comments": [{"owner": {"reputation": 2773, "user_id": 3925507, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/bXVeK.png?s=128&g=1", "display_name": "concat", "link": "https://stackoverflow.com/users/3925507/concat"}, "edited": false, "score": 0, "creation_date": 1572850805, "post_id": 58037699, "comment_id": 103675147, "body": "It dawned on me recently that the <code>Unique</code>s can&#39;t match because the instance isn&#39;t unique in general. While it&#39;s obvious in the example I provided, for <code>bar = foo</code> it wouldn&#39;t, because the constraint <code>A a =&gt;</code> on <code>bar</code> is only solved later whenever <code>bar</code> is fully parameterized."}], "owner": {"reputation": 2773, "user_id": 3925507, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/bXVeK.png?s=128&g=1", "display_name": "concat", "link": "https://stackoverflow.com/users/3925507/concat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1569045796, "creation_date": 1569045796, "question_id": 58037699, "link": "https://stackoverflow.com/questions/58037699/ghc-api-finding-implementations-of-instance-functions", "title": "GHC API: finding implementations of instance functions", "body": "<p>I'm writing a symbolic execution engine for Haskell using GHC, and often I need to find the <code>instance</code> implementations of various functions in the program. However, after leafing through many ASTs produced by the typechecker, I can't see any way to tie a function call to its implementation in an <code>instance</code> block. The AST doesn't have the information to support the obvious solution of matching the <code>Unique</code> keys. Unlike top-level function definitions, none of the <code>Unique</code>s in the instance function binding match the <code>Unique</code> of the callsite. For example, in this simple program:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module M where\n  class A a where\n    foo :: a b -&gt; b\n\n  newtype Box a = Box a\n  instance A Box where\n    foo (Box a) = a\n\n  bar = foo (Box ())\n</code></pre>\n\n<p>in the body of <code>bar</code>, <code>foo</code> has unique id <code>rrZ</code>. Within the <code>HsBind</code> of the instance definition, there are the following varName-varUnique pairs:</p>\n\n<ul>\n<li>In top-level <code>AbsBind</code>:\n\n<ul>\n<li><code>$cfoo</code>: <code>a1dd</code></li>\n<li><code>foo</code>: <code>a1de</code></li>\n</ul></li>\n<li>In nested <code>AbsBind</code>\n\n<ul>\n<li><code>foo</code>: <code>a1dg</code></li>\n</ul></li>\n</ul>\n\n<p>Since none of them match the callsite, I've resorted to an indirect method of matching the type at the callsite against all the types that have the same name, but this requires me to write separate logic for instances from top-level functions. Is there a unified way to find the implementation of some function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1569036554, "post_id": 58037008, "comment_id": 102475621, "body": "Your opening paragraph reminds me of a famous koan in the go world: one time a beginner was reviewing one of his games with his teacher. The teacher stopped him at one point and said, &quot;You must not play this move.&quot;. He said, &quot;But it is joseki [a standard opening that all agree is good for both players]. I have seen many pros play this move.&quot;. The teacher replied, &quot;When the pros play it, it is a good move. But when you play it, it is a mistake.&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 1, "creation_date": 1569038868, "post_id": 58037074, "comment_id": 102475856, "body": "Thanks Joseph. I like the use of fmap at the end there, I was experimenting with that. Going inside the Monad with a Functor - just a tidbit I learned but wasn&#39;t experienced/knowledgeable enough yet to apply. This all really helps, thanks again."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1569039668, "post_id": 58037074, "comment_id": 102475950, "body": "Fantastic answer. Not only does it show the right way to do it, it lays out a mechanical process that people can apply to other, similar chunks of code: convert the pure version to <code>let foo = bar in baz</code> form, where <code>bar</code> is the thing that needs to become <code>IO</code>y instead of pure, then refactor to <code>do { foo &lt;- bar; baz }</code> while changing <code>bar</code> to do <code>IO</code>. Even if <code>filterM</code> didn&#39;t exist, it could be created out of the source of <code>filter</code> by following this exact same process."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1569037592, "last_edit_date": 1569037592, "creation_date": 1569037092, "answer_id": 58037074, "question_id": 58037008, "link": "https://stackoverflow.com/questions/58037008/how-to-plug-this-type-hole-3/58037074#58037074", "title": "How to plug this type hole 3", "body": "<p>First, let's split out your filtering function:</p>\n\n<pre><code>isAnnotatedPdf :: FilePath -&gt; Bool\nisAnnotatedPdf path = (isSubsequenceOf \"annotated\" (titleString (dir &lt;/&gt; path))) &amp;&amp; (takeExtension path == \".pdf\")\n\nmain :: IO ()\nmain = do\n  print =&lt;&lt;\n    liftM\n      (filter isAnnotatedPdf)\n      (listDirectory dir)\n</code></pre>\n\n<p>Now, use some syntactic sugar to clean up <code>main</code>:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  dirList &lt;- listDirectory dir\n  let filteredList = filter isAnnotatedPdf dirList\n  print filteredList\n</code></pre>\n\n<p>Next, change <code>isAnnotatedPdf</code> to return its result inside of <code>IO</code>, and then modify <code>main</code> so that it's okay to do that:</p>\n\n<pre><code>isAnnotatedPdf :: FilePath -&gt; IO Bool\nisAnnotatedPdf path = do\n  return $ (isSubsequenceOf \"annotated\" (titleString (dir &lt;/&gt; path))) &amp;&amp; (takeExtension path == \".pdf\")\n\nmain :: IO ()\nmain = do\n  dirList &lt;- listDirectory dir\n  filteredList &lt;- filterM isAnnotatedPdf dirList\n  print filteredList\n</code></pre>\n\n<p>Extract a variable <code>pdfTitle</code> inside <code>isAnnotatedPdf</code> to make the next step more clear:</p>\n\n<pre><code>isAnnotatedPdf :: FilePath -&gt; IO Bool\nisAnnotatedPdf path = do\n  let pdfTitle = titleString (dir &lt;/&gt; path)\n  return $ (isSubsequenceOf \"annotated\" pdfTitle) &amp;&amp; (takeExtension path == \".pdf\")\n</code></pre>\n\n<p>Finally, change <code>isAnnotatedPdf</code> to use its new <code>IO</code> context instead of using your <code>unsafePerformIO</code> wrapper:</p>\n\n<pre><code>isAnnotatedPdf :: FilePath -&gt; IO Bool\nisAnnotatedPdf path = do\n  pdfTitle &lt;- title (dir &lt;/&gt; path)\n  return $ (isSubsequenceOf \"annotated\" pdfTitle) &amp;&amp; (takeExtension path == \".pdf\")\n</code></pre>\n\n<p>And you're done! Now you can get rid of <code>titleString</code> and all of your references to <code>unsafePerformIO</code>.</p>\n\n<hr>\n\n<p>As a bonus, you can now easily avoid the need to call <code>pdfInfo</code> on things that aren't PDFs, by moving the pure <code>takeExtension</code> check to before the monadic title check, like this:</p>\n\n<pre><code>isAnnotatedPdf :: FilePath -&gt; IO Bool\nisAnnotatedPdf path = if takeExtension path == \".pdf\"\n  then do\n    pdfTitle &lt;- title (dir &lt;/&gt; path)\n    return $ isSubsequenceOf \"annotated\" pdfTitle\n  else return False\n</code></pre>\n\n<p>Or using <code>&lt;$&gt;</code> instead of <code>do</code>:</p>\n\n<pre><code>isAnnotatedPdf :: FilePath -&gt; IO Bool\nisAnnotatedPdf path = if takeExtension path == \".pdf\"\n  then isSubsequenceOf \"annotated\" &lt;$&gt; title (dir &lt;/&gt; path)\n  else return False\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58037074, "answer_count": 1, "score": 2, "last_activity_date": 1569037592, "creation_date": 1569035981, "question_id": 58037008, "link": "https://stackoverflow.com/questions/58037008/how-to-plug-this-type-hole-3", "title": "How to plug this type hole 3", "body": "<p>Following on from <a href=\"https://stackoverflow.com/questions/58035216/how-to-plug-this-type-hole-2\">my last question</a>, I am now able to get the desired result I was after, but in a totally evil way: using <code>unsafePerformIO</code>. I understand this is not the right way to approach this (though to my defense I got the idea from hoogle checking types, and then from an ag search in kmett's repos to see when he used <code>unsafePerformIO</code> across a hundred or so repos. I read the warnings on hackage, I know it is bad.). </p>\n\n<p>What I'd like now is to be a way to do this without <code>unsafePerformIO</code>. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>module Main where\n\nimport Control.Monad (liftM)\nimport Data.List (isSubsequenceOf)\nimport qualified Data.Text as T\nimport System.Directory (listDirectory)\nimport System.FilePath ((&lt;/&gt;), takeExtension)\nimport System.IO.Unsafe (unsafePerformIO)\nimport Text.PDF.Info\n\ntitle :: FilePath -&gt; IO String\ntitle path = do\n  result &lt;- pdfInfo path\n  case result of\n    Left someError -&gt; do\n      return \"no title\"\n    Right info -&gt; do\n      case (pdfInfoTitle info) of\n        Nothing -&gt; return \"no title\"\n        Just title -&gt; return (T.unpack title)\n\ntitleString :: FilePath -&gt; String\ntitleString s = unsafePerformIO (title s)\n{-# NOINLINE titleString #-}\n\ndir = \"/some/path\"\n\nmain :: IO ()\nmain = do\n  print =&lt;&lt;\n    liftM\n      (filter\n         (\\path -&gt;\n            (isSubsequenceOf \"annotated\" (titleString (dir &lt;/&gt; path))) &amp;&amp;\n            (takeExtension path == \".pdf\")))\n      (listDirectory dir)\n</code></pre>\n\n<p>Along the way I tried to use hole typing and lots of Hoogle to get help from the tools (teach a man to fish..). I need mentoring to get the process of discovery using tools and docs more dialed. If you have tips on how you approach such things, or at least imagine what you would do if you lost all your long term memory of Haskell except hole typing and hoogle and let me know how you would proceed. I plan to watch Brian McKenna's data61 videos soon, but until then. Thanks in advance!</p>\n"}, {"tags": ["list", "haskell", "recursion"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1569031764, "post_id": 58036733, "comment_id": 102475095, "body": "This seems like a weird almost-duplicate of <a href=\"https://stackoverflow.com/q/58021470/625403\">stackoverflow.com/q/58021470/625403</a>."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1569033057, "post_id": 58036733, "comment_id": 102475216, "body": "@amalloy Yep. And this almost certainly means that both are homework."}, {"owner": {"reputation": 27334, "user_id": 7758804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBA7j.jpg?s=128&g=1", "display_name": "Trenton McKinney", "link": "https://stackoverflow.com/users/7758804/trenton-mckinney"}, "edited": false, "score": 3, "creation_date": 1569043820, "post_id": 58036733, "comment_id": 102476391, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/58021470/returning-a-list-of-lists-with-recursion\">Returning a list of lists with recursion</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1569152006, "post_id": 58036733, "comment_id": 102496212, "body": "@amalloy this is of course a duplicate, but it is worded much better, so maybe close that other one as the duplicate of this one?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "edited": false, "score": 0, "creation_date": 1569106767, "post_id": 58043709, "comment_id": 102489491, "body": "Thank you - looks good. You did a good job of explaining each step; very clear and easy to follow."}, {"owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "edited": false, "score": 0, "creation_date": 1569107572, "post_id": 58043709, "comment_id": 102489600, "body": "What does does &#39;map&#39; refer to?"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "edited": false, "score": 0, "creation_date": 1569139788, "post_id": 58043709, "comment_id": 102493537, "body": "@anon0987654321  Well, <code>map</code> is used to apply a given function to every element of a list, and return all the results as a new list. For example, if sq is the square function, the expression <code>map sq [1, 3, 5]</code> evaluates to the list: [1, 9, 25]. Defined <a href=\"https://hoogle.haskell.org/?hoogle=map\" rel=\"nofollow noreferrer\">here</a> for example."}], "tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": true, "score": 1, "last_activity_date": 1569097085, "last_edit_date": 1569097085, "creation_date": 1569096393, "answer_id": 58043709, "question_id": 58036733, "link": "https://stackoverflow.com/questions/58036733/recursion-returning-a-list-of-list-using-haskell/58043709#58043709", "title": "Recursion returning a list of list using haskell", "body": "<p>Yes, groupBy can be used. You will need the comparison function to feed groupBy, let's call it <code>grf</code>. Easiest path is probably to test the solution gradually within the interactive command, <code>ghci</code>.</p>\n\n<pre><code>$ ghci\nPrelude&gt; \nPrelude Data.List&gt; import Data.List\nPrelude Data.List&gt; grf ((x1,y1),p1) ((x2,y2),p2) = (p1==p2)\nPrelude Data.List&gt; let lsa = [((1,1),True),((2,2), False),((3,3), False), ((4,4),True),((5,5),True)]\nPrelude Data.List&gt; \nPrelude Data.List&gt; lsb = groupBy grf lsa\nPrelude Data.List&gt; lsb\n[[((1,1),True)],[((2,2),False),((3,3),False)],[((4,4),True),((5,5),True)]]\nPrelude Data.List&gt; \n</code></pre>\n\n<p><br>That's just a start. Then you need to get rid of the false ones, and then to get rid of the boolean values themselves.\n<br></p>\n\n<pre><code>Prelude Data.List&gt; \nPrelude Data.List&gt; lsc = filter (snd . head) lsb\nPrelude Data.List&gt; lsc\n[[((1,1),True)],[((4,4),True),((5,5),True)]]\nPrelude Data.List&gt; \nPrelude Data.List&gt; lsd = map (map fst) lsc\nPrelude Data.List&gt; lsd\n[[(1,1)],[(4,4),(5,5)]]\nPrelude Data.List&gt; \nPrelude Data.List&gt; \n</code></pre>\n\n<p>Putting it all together:</p>\n\n<pre><code>import Data.List\n\nconsecTrue :: [((Double, Double),Bool)] -&gt; [[(Double,Double)]]\nconsecTrue xs = let grf ((x1,y1),p1) ((x2,y2),p2) = (p1==p2)\n                in  map (map fst) (filter (snd . head) (groupBy grf xs))\n\nmain = do\n    let lsa = [((1,1),True),((2,2), False),((3,3), False),\n              ((4,4),True),((5,5),True)]\n    let res = consecTrue lsa\n\n    putStrLn $ \"input  = \" ++ show lsa\n    putStrLn $ \"output = \" ++ show res\n</code></pre>\n\n<p>That seems to do what you wanted:</p>\n\n<pre><code>input  = [((1.0,1.0),True),((2.0,2.0),False),((3.0,3.0),False),((4.0,4.0),True),((5.0,5.0),True)]\noutput = [[(1.0,1.0)],[(4.0,4.0),(5.0,5.0)]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1569151900, "creation_date": 1569151900, "answer_id": 58048782, "question_id": 58036733, "link": "https://stackoverflow.com/questions/58036733/recursion-returning-a-list-of-list-using-haskell/58048782#58048782", "title": "Recursion returning a list of list using haskell", "body": "<p>As a newcomer learning Haskell, not even yet knowing what <code>map</code> is, it makes total sense to have been asked to do this first of all by simple, direct recursion, creating a definition which stands on its own, not using any library functions.</p>\n\n<p>And definition by simple direct recursion is just enumeration of possible cases we're presented with:</p>\n\n<pre><code>consecTrue :: [(t, Bool)] -&gt; [[t]]\n  -- empty list:\nconsecTrue [] = []\n  -- list with exactly one entry in it:\nconsecTrue [(a,True)] = [[a]]\nconsecTrue [(a,False)] = []\n  -- list with two or more entries in it:\nconsecTrue ((a1,True) : (a2, True) : more2)  =  (a1:r):q  where  \n                                                    (r:q) = consecTrue ((a2,t2) : more2)\nconsecTrue ((a1,True) : (a2,False) : more2)  =  [a1] : consecTrue more2\nconsecTrue ((a1,False) : more1)              =  consecTrue more1\n</code></pre>\n\n<p>The <code>(Double, Double)</code> is immaterial, extraneous detail. Just <code>t</code> is enough, meaning anything can go there.</p>\n"}], "owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 58043709, "answer_count": 2, "score": 0, "last_activity_date": 1569151900, "creation_date": 1569031335, "last_edit_date": 1569043948, "question_id": 58036733, "link": "https://stackoverflow.com/questions/58036733/recursion-returning-a-list-of-list-using-haskell", "title": "Recursion returning a list of list using haskell", "body": "<p>I'm quite new to Haskell and i'm not sure how to solve / approach this problem: I want a function with the type signature: <code>[((Double, Double), Bool)]</code> -> <code>[[(Double, Double)]]</code>. The function should only add <code>(Double, Double)</code> to the list of lists if <code>Bool == True</code>. If the bool is False, I want the <code>(Double, Double)</code> associated with the next True bool to be added to a new list. Consecutive <code>(Double, Double)</code>'s paired with <code>Bool == True</code> should be added to the same list. For example, an input of: <code>[((1,1),True),((2,2), False),((3,3), False),((4,4),True),((5,5),True)]</code> should return <code>[[(1,1)],[(4,4),(5,5)]]</code>. I did a little research and it seems like the groupBy function might be useful in solving the problem, but I'm not quite sure how to use it properly. As I'm new new to Haskell I'd prefer a more simple solution or explanation but any suggestions would help. </p>\n\n<p>So far my code just creates a new list for every <code>(Double, Double)</code> associated with True bool. I'm not quite sure how to add to an existing list within a list.</p>\n\n<pre><code>consecTrue :: [((Double, Double),Bool)] -&gt; [[(Double,Double)]]\nconsecTrue xs = case xs of\n    [] -&gt; []\n    x:xs\n        |snd x == True -&gt; [fst x]:consecTrue xs\n        |snd x == False -&gt; consecTrue xs\n</code></pre>\n"}, {"tags": ["haskell", "ghci", "let"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569014830, "post_id": 58035349, "comment_id": 102472508, "body": "A <code>let</code> expects an <code>in</code>. It scopes the variable locally in the <code>in</code> expression. In case of <code>do</code> notation, the <code>in</code> is implicit, and wraps the remaining lines in the <code>do</code>."}, {"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569014861, "post_id": 58035349, "comment_id": 102472521, "body": "it seems to work without one in GHCi. Should it require one?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569014883, "post_id": 58035349, "comment_id": 102472525, "body": "is that in a <code>do</code> block?"}, {"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569014914, "post_id": 58035349, "comment_id": 102472531, "body": "It&#39;s from the command line"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1569014951, "post_id": 58035349, "comment_id": 102472539, "body": "well the <code>ghci</code> has some sort of &quot;implicit&quot; <code>do</code> so to speak."}, {"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569015119, "post_id": 58035349, "comment_id": 102472570, "body": "have adjusted the question. I take it the answer is no?"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1569015297, "post_id": 58035349, "comment_id": 102472614, "body": "The answer depends on where these lines appear exactly. In GHCi there no practical difference."}, {"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "edited": false, "score": 0, "creation_date": 1569015491, "post_id": 58035349, "comment_id": 102472662, "body": "Thanks that helps. Not sure why this has been voted down though. Is not using let bad form?"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1569015945, "post_id": 58035349, "comment_id": 102472770, "body": "I&#39;m guessing the downvotes were before you edited to be specific about the GHCi context. In &quot;normal&quot; Haskell you normally can&#39;t choose between the forms (one or the other is required depending on the context), so the question seemed a bit silly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1569074024, "post_id": 58035349, "comment_id": 102482405, "body": "When the optional-<code>let</code> feature was new, there were definitely bugs that made them different sometimes. Not sure about now."}], "answers": [{"comments": [{"owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "edited": false, "score": 0, "creation_date": 1569015936, "post_id": 58035468, "comment_id": 102472766, "body": "thanks, that explains why a lot of old tutorials seem to mention it, but it doesn&#39;t appear to make any difference"}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 6, "last_activity_date": 1569016851, "last_edit_date": 1569016851, "creation_date": 1569015720, "answer_id": 58035468, "question_id": 58035349, "link": "https://stackoverflow.com/questions/58035349/in-haskell-is-there-any-difference-between-a-let-x-and-an-x-on-the-ghci-comman/58035468#58035468", "title": "In haskell is there any difference between a let x= and an x= on the GHCi command line?", "body": "<p>At the GHCi prompt, no, there is no difference.</p>\n\n<p>The <code>let</code> used to be required (with the reasoning that the GHCi prompt is a bit like you're entering lines in an <code>IO</code> do block). But relatively recently<sup>1</sup> it was updated so that the <code>let</code> is optional, in order to provide a more convenient interactive syntax.</p>\n\n<hr>\n\n<p><sup>1</sup> In <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/8.0.1-notes.html#ghci\" rel=\"nofollow noreferrer\">GHC 8.0</a> (the \"Added support for top-level function declarations\" part). This is old enough that you're very unlikely to be using an older GHCi that requires <code>let</code>, but there's still a lot of tutorials and other material around from before that (which don't always tell you clearly what version is being used in their examples). And for some people old habits die hard.</p>\n"}, {"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1569028741, "post_id": 58035825, "comment_id": 102474779, "body": "What are mutually exclusive bindings?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1569028828, "post_id": 58035825, "comment_id": 102474791, "body": "@FyodorSoikin They are a typo for &quot;mutually recursive bindings&quot;! Thanks, fixed."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1569028888, "post_id": 58035825, "comment_id": 102474802, "body": "Ah! And here I thought, there would be something new and interesting to learn... :-)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1569028809, "last_edit_date": 1569028809, "creation_date": 1569018966, "answer_id": 58035825, "question_id": 58035349, "link": "https://stackoverflow.com/questions/58035349/in-haskell-is-there-any-difference-between-a-let-x-and-an-x-on-the-ghci-comman/58035825#58035825", "title": "In haskell is there any difference between a let x= and an x= on the GHCi command line?", "body": "<p>There is a small difference, yes. Under normal operation, ghci accepts one line of input at a time and processes it immediately. However, it also has an \"automatic multiline\" mode, in which it will try to detect if you want to enter multiple lines at once before processing all of them together. For example, in normal mode:</p>\n\n<pre><code>&gt; (3 +\n&lt;interactive&gt;:1:5: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n&gt;  case () of\n&lt;interactive&gt;:2:1: error:\n    Empty list of alternatives in case expression\n      Use EmptyCase to allow this\n</code></pre>\n\n<p>After enabling automatic multiline mode with <code>:set +m</code> (put that in <code>~/.ghci</code> to enable it by default!):</p>\n\n<pre><code>&gt; (3 +\n| 4)\n7\n&gt; case () of\n|  () -&gt; ()\n|\n()\n</code></pre>\n\n<p>With that preamble out of the way, I can now tell you what the small difference is: <code>myPi = 3.14</code> does not trigger multiline processing, instead defining it immediately; but <code>let myPi = 3.14</code> does trigger multiline processing. This can matter, for example, if you want to create mutually recursive bindings; without <code>let</code>, they would have to be entered on a single line and separated by explicit semicolons, while with <code>let</code> and automatic multiline mode, you could use indentation to separate them in the standard, idiomatic way.</p>\n\n<p>(Additionally, if you are using very old versions of GHC, the non-<code>let</code> form may not yet have been available.)</p>\n"}], "owner": {"reputation": 2690, "user_id": 948397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1cdf616876083f7c5ec1a49fc357530?s=128&d=identicon&r=PG", "display_name": "pluke", "link": "https://stackoverflow.com/users/948397/pluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "accepted_answer_id": 58035468, "answer_count": 2, "score": 2, "last_activity_date": 1569028809, "creation_date": 1569014676, "last_edit_date": 1569016436, "question_id": 58035349, "link": "https://stackoverflow.com/questions/58035349/in-haskell-is-there-any-difference-between-a-let-x-and-an-x-on-the-ghci-comman", "title": "In haskell is there any difference between a let x= and an x= on the GHCi command line?", "body": "<p>I'm writing a simple declaration in Haskell GHCi</p>\n\n<pre><code>myPi = 3.14\n</code></pre>\n\n<p>I can also write this as</p>\n\n<pre><code>let myPi = 3.14\n</code></pre>\n\n<p>Is there any difference for this very simple example between the two declarations? I'm aware of the extra functionality with let, but don't need it here</p>\n"}, {"tags": ["haskell", "floating-point", "type-conversion", "precision", "largenumber"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569014395, "post_id": 58035248, "comment_id": 102472407, "body": "It looks like floating point overflow."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1569014536, "post_id": 58035248, "comment_id": 102472439, "body": "related: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\" title=\"is floating point math broken\">stackoverflow.com/questions/588004/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1569019627, "post_id": 58035248, "comment_id": 102473564, "body": "I don&#39;t think this is a duplicate. This seems like a clear bug: <code>fromInteger $ 4141414141414141*4141414141414141</code> produces <code>1.7151311090705025e31</code>, but <code>1.7151311090705027e31</code> is a valid <code>Double</code> and is closer to the correct integer <code>17151311090705026668707274767881</code>. So <code>fromInteger</code> is to blame here, not rounding!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1569021251, "post_id": 58035248, "comment_id": 102473812, "body": "For exact bignum square roots (i.e. staying within <code>Integer</code> and never passing through <code>Double</code>), you might like <a href=\"http://hackage.haskell.org/package/arithmoi-0.9.0.0/docs/Math-NumberTheory-Powers-Squares.html\" rel=\"nofollow noreferrer\">arithmoi</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569050287, "post_id": 58035248, "comment_id": 102477291, "body": "in ghci 7.8.3 I get same correct result for both calculations."}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1569052314, "post_id": 58035248, "comment_id": 102477664, "body": "IMO, all languages should care of ISO/IEC 10967-2 (Language Independent Arithmetic (LIA), Part II, 1994) which convers float&lt;-&gt;int conversions including case of unbounded integer. See <a href=\"http://www.open-std.org/JTC1/SC22/WG11/docs/n462.pdf\" rel=\"nofollow noreferrer\">open-std.org/JTC1/SC22/WG11/docs/n462.pdf</a> &#167;5.4.3. At least, level of conformance to 10967 should be reported."}, {"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "edited": false, "score": 0, "creation_date": 1569125164, "post_id": 58035248, "comment_id": 102491492, "body": "I filed a GHC bug here: <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/17231\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/issues/17231</a>"}, {"owner": {"reputation": 363, "user_id": 9833235, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dvinubius", "link": "https://stackoverflow.com/users/9833235/dvinubius"}, "edited": false, "score": 0, "creation_date": 1569181005, "post_id": 58035248, "comment_id": 102503498, "body": "Thank you all for the input. Learned a lot, I appreciate it!"}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1569456298, "post_id": 58035248, "comment_id": 102606240, "body": "You can use <code>(read . show)</code> instead of <code>fromInteger</code> to circumvent the rounding issue. This is how <code>dhall</code> implements its <code>Integer&#47;toDouble</code> operation."}, {"owner": {"reputation": 363, "user_id": 9833235, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dvinubius", "link": "https://stackoverflow.com/users/9833235/dvinubius"}, "edited": false, "score": 0, "creation_date": 1569617922, "post_id": 58035248, "comment_id": 102668736, "body": "sjakobi, now that&#39;s a neat workaround. thank you."}], "answers": [{"comments": [{"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "edited": false, "score": 0, "creation_date": 1569023258, "post_id": 58036010, "comment_id": 102474108, "body": "Your analysis is supported by z3. Funny this never came up before!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1569050340, "post_id": 58036010, "comment_id": 102477303, "body": "ghci 7.8.3. returns same correct result in both cases. (Windows7  64 bit)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1569021392, "last_edit_date": 1569021392, "creation_date": 1569021055, "answer_id": 58036010, "question_id": 58035248, "link": "https://stackoverflow.com/questions/58035248/a-haskell-floating-point-calculation-anomaly/58036010#58036010", "title": "A haskell floating point calculation anomaly?", "body": "<p>Not all <code>Integer</code>s are exactly representable as <code>Double</code>s. For those that aren't, <code>fromInteger</code> is in the bad position of needing to make a choice: which <code>Double</code> should it return? I can't find anything in the Report which discusses what to do here, wow!</p>\n\n<p>One obvious solution would be to return a <code>Double</code> that has no fractional part and which represents the integer with the smallest absolute difference from the original of any <code>Double</code> that exists. Unfortunately this appears not to be the decision made by GHC's <code>fromInteger</code>.</p>\n\n<p>Instead, GHC's choice is to return the <code>Double</code> with the largest magnitude that does not exceed the magnitude of the original number. So:</p>\n\n<pre><code>&gt; 17151311090705026844052714160127 :: Double\n1.7151311090705025e31\n&gt; 17151311090705026844052714160128 :: Double\n1.7151311090705027e31\n</code></pre>\n\n<p>(Don't be fooled by how short the displayed number is in the second one: the <code>Double</code> there is the exact representation of the integer on the line above it; the digits stop there because there are enough to uniquely identify a single <code>Double</code>.)</p>\n\n<p>Why does this matter for you? Well, the true answer to <code>4141414141414141*4141414141414141</code> is:</p>\n\n<pre><code>&gt; 4141414141414141*4141414141414141\n17151311090705026668707274767881\n</code></pre>\n\n<p>If <code>fromInteger</code> converted this to the nearest <code>Double</code>, as in plan (1) above, it would choose <code>1.7151311090705027e31</code>. But since it returns the largest <code>Double</code> less than the input as in plan (2) above, and <code>17151311090705026844052714160128</code> is technically bigger, it returns the less accurate representation <code>1.7151311090705025e31</code>.</p>\n\n<p>Meanwhile, <code>4141414141414141</code> itself is exactly representable as a <code>Double</code>, so if you first convert to <code>Double</code>, then square, you get <code>Double</code>'s semantics of choosing the representation that is closest to the correct answer, hence plan (1) instead of plan (2).</p>\n\n<p>This explains the discrepancy in <code>sqrt</code>'s output: doing your computations in <code>Integer</code> first and getting an exact answer, then converting to <code>Double</code> at the last second, paradoxically is less accurate than converting to <code>Double</code> immediately and doing your computations with rounding the whole way, because of how <code>fromInteger</code> does its conversion! Ouch.</p>\n\n<p>I suspect a patch to modify <code>fromInteger</code> to do something better would be looked on favorably by GHCHQ; in any case I know <em>I</em> would look favorably on it!</p>\n"}, {"tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": true, "score": 7, "last_activity_date": 1569184542, "last_edit_date": 1569184542, "creation_date": 1569046987, "answer_id": 58037815, "question_id": 58035248, "link": "https://stackoverflow.com/questions/58035248/a-haskell-floating-point-calculation-anomaly/58037815#58037815", "title": "A haskell floating point calculation anomaly?", "body": "<h1>TLDR</h1>\n\n<p>It comes down to how one converts an <code>Integer</code> value to a <code>Double</code> that is not exactly representable. Note that this can happen not just because <code>Integer</code> is too big (or too small), but <code>Float</code> and <code>Double</code> values by design \"skip around\" integral values as their magnitude gets larger. So, not every integral value in the range is exactly representable either. In this case, an implementation has to pick a value based on the rounding-mode. Unfortunately, there are multiple candidates; and what you are observing is that the candidate picked by Haskell gives you a worse numeric result.</p>\n\n<h1>Expected Result</h1>\n\n<p>Most languages, including Python, use what's known as \"round-to-nearest-ties-to-even\" rounding mechanism; which is the default IEEE754 rounding mode and is typically what you would get unless you explicitly set a rounding mode when issuing a floating-point related instruction in a compliant processor. Using Python as the \"reference\" here, we get:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; float(long(4141414141414141)*long(4141414141414141))\n1.7151311090705027e+31\n</code></pre>\n\n<p>I haven't tried in other languages that support so called big-integers, but I'd expect most of them would give you this result.</p>\n\n<h1>How Haskell converts <code>Integer</code> to <code>Double</code></h1>\n\n<p>Haskell, however, uses what's known as <em>truncation</em>, or round-towards-zero. So you get:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Main&gt; (fromIntegral $ 4141414141414141*4141414141414141) :: Double\n1.7151311090705025e31\n</code></pre>\n\n<p>Turns out this is a \"worse\" approximation in this case (cf. to the Python produced value above), and you get the unexpected result in your original example.</p>\n\n<p>The call to <code>sqrt</code> is really red-herring at this point.</p>\n\n<h1>Show me the code</h1>\n\n<p>It all originates from this code: (<a href=\"https://hackage.haskell.org/package/integer-gmp-1.0.2.0/docs/src/GHC.Integer.Type.html#doubleFromInteger\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/integer-gmp-1.0.2.0/docs/src/GHC.Integer.Type.html#doubleFromInteger</a>)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>doubleFromInteger :: Integer -&gt; Double#\ndoubleFromInteger (S# m#) = int2Double# m#\ndoubleFromInteger (Jp# bn@(BN# bn#))\n    = c_mpn_get_d bn# (sizeofBigNat# bn) 0#\ndoubleFromInteger (Jn# bn@(BN# bn#))\n    = c_mpn_get_d bn# (negateInt# (sizeofBigNat# bn)) 0#\n</code></pre>\n\n<p>which in turn calls: (<a href=\"https://github.com/ghc/ghc/blob/master/libraries/integer-gmp/cbits/wrappers.c#L183-L190\" rel=\"nofollow noreferrer\">https://github.com/ghc/ghc/blob/master/libraries/integer-gmp/cbits/wrappers.c#L183-L190</a>):</p>\n\n<pre><code>/* Convert bignum to a `double`, truncating if necessary\n * (i.e. rounding towards zero).\n *\n * sign of mp_size_t argument controls sign of converted double\n */\nHsDouble\ninteger_gmp_mpn_get_d (const mp_limb_t sp[], const mp_size_t sn,\n                       const HsInt exponent)\n{\n...\n</code></pre>\n\n<p>which <em>purposefully</em> says the conversion is done rounding-toward zero.</p>\n\n<p>So, that explains the behavior you get.</p>\n\n<h1>Why does Haskell do this?</h1>\n\n<p>None of this explains why Haskell uses round-towards-zero for integer-to-double conversion. I'd strongly argue that it should use the default rounding mode, i.e., round-nearest-ties-to-even. I can't find any mention whether this was a conscious choice, and it at least disagrees with what Python does. (Not that I'd consider Python the gold standard, but it does tend to get these things right.)</p>\n\n<p>My best guess is it was just coded that way, without a conscious choice; but perhaps other people familiar with the history of numeric programming in Haskell can remember better.</p>\n\n<h1>What to do</h1>\n\n<p>Interestingly, I found the following discussion dating all the way back to 2008 as a Python bug: <a href=\"https://bugs.python.org/issue3166\" rel=\"nofollow noreferrer\">https://bugs.python.org/issue3166</a>. Apparently, Python used to do the wrong thing here as well, but they fixed the behavior. It's hard to track the exact history, but it appears Haskell and Python both made the same mistake; Python recovered, but it went unnoticed in Haskell. If this was a conscious choice, I'd like to know why.</p>\n\n<p>So, that's where it stands. I'd recommend opening a GHC ticket so it can be at least documented properly that this is the \"chosen\" behavior; or better, fix it so that it uses the default rounding mode instead.</p>\n\n<h1>Update:</h1>\n\n<p>GHC ticket opened: <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/17231\" rel=\"nofollow noreferrer\">https://gitlab.haskell.org/ghc/ghc/issues/17231</a></p>\n"}], "owner": {"reputation": 363, "user_id": 9833235, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dvinubius", "link": "https://stackoverflow.com/users/9833235/dvinubius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 58037815, "answer_count": 2, "score": 5, "last_activity_date": 1569184542, "creation_date": 1569014034, "question_id": 58035248, "link": "https://stackoverflow.com/questions/58035248/a-haskell-floating-point-calculation-anomaly", "title": "A haskell floating point calculation anomaly?", "body": "<p>Using ghci 8.6.5</p>\n\n<p>I want to calculate the square root of an Integer input, then round it to the bottom and return an Integer.</p>\n\n<pre><code>square :: Integer -&gt; Integer\nsquare m = floor $ sqrt $ fromInteger m\n</code></pre>\n\n<p>It works. \nThe problem is, for this specific big number as input: </p>\n\n<p>4141414141414141*4141414141414141</p>\n\n<p>I get a wrong result.</p>\n\n<p>Putting my function aside, I test the case in ghci:</p>\n\n<pre><code>&gt; sqrt $ fromInteger $ 4141414141414141*4141414141414141\n4.1414141414141405e15\n</code></pre>\n\n<p>wrong... right?</p>\n\n<p>BUT SIMPLY</p>\n\n<pre><code>&gt; sqrt $ 4141414141414141*4141414141414141\n4.141414141414141e15\n</code></pre>\n\n<p>which is more like what I expect from the calculation...</p>\n\n<p>In my function I have to make some type conversion, and I reckon fromIntegral is the way to go. So, using that, my function gives a wrong result for the 4141...41 input. </p>\n\n<p>I can't figure out what ghci does implicitly in terms of type conversion, right before running sqrt. Because ghci's conversion allows for a correct calculation. </p>\n\n<p>Why I say this is an anomaly: the problem does not occur with other numbers like 5151515151515151 or 3131313131313131 or 4242424242424242 ...</p>\n\n<p>Is this a Haskell bug?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1569013858, "post_id": 58035216, "comment_id": 102472284, "body": "<code>return</code> is not a keyword like in a lot of imperative languages. <code>return :: Monad m =&gt; a -&gt; m a</code> is a function. So here it makes your function a <code>Monad m =&gt; m String</code>. This is already the case because you use <code>do</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1569014017, "post_id": 58035216, "comment_id": 102472321, "body": "In addition to what @WillemVanOnsem, the <code>pdfInfo</code> function does IO, so there is &quot;no escape&quot; from that back to pure code. So no function that uses it, as yours does, can return a &quot;plain&quot; <code>String</code>, or any other type that doesn&#39;t involve <code>IO</code>."}, {"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1569014100, "post_id": 58035216, "comment_id": 102472340, "body": "@RobinZigmond, ah, that really helps. Not sure how to salvage what I have..."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1569014253, "post_id": 58035216, "comment_id": 102472375, "body": "@Joe just make your function return an <code>IO String</code> rather than a <code>String</code>. I believe in that case you can simply leave the function body alone, but I haven&#39;t checked in detail. Then in <code>main</code> you can &quot;assign&quot; to the result of <code>title</code> by doing something like <code>x &lt;- title path</code> and using the string <code>x</code> in subsequent code."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1569014306, "post_id": 58035216, "comment_id": 102472385, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/57976753/match-type-errors-between-io-char-and-char\">Match type errors between IO Char and &#91;Char&#93;</a>"}, {"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1569014428, "post_id": 58035216, "comment_id": 102472421, "body": "@RobinZigmond, thanks for the link"}], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 0, "creation_date": 1569015353, "post_id": 58035286, "comment_id": 102472628, "body": "This is helpful, thank you. Now I am looking to get the do syntax correct for <code>x &lt;- title path</code> in the lambda for <code>filter</code>..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 2, "creation_date": 1569015594, "post_id": 58035286, "comment_id": 102472687, "body": "@Joe, but you can not use <code>x &lt;- title path</code> in a lambda (for <code>filter</code>). You could use <code>filterM</code>, but then you still can not use this since this is supposed to return a <code>Bool</code>. I would strongly advice taking a look what the difference between an <code>IO a</code> and <code>a</code> is, since it will otherwise make it very hard to solve the problem you aim to fix."}, {"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 0, "creation_date": 1569036004, "post_id": 58035286, "comment_id": 102475569, "body": "Next question: <a href=\"https://stackoverflow.com/questions/58037008/how-to-plug-this-type-hole-3\" title=\"how to plug this type hole 3\">stackoverflow.com/questions/58037008/&hellip;</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1569014308, "creation_date": 1569014308, "answer_id": 58035286, "question_id": 58035216, "link": "https://stackoverflow.com/questions/58035216/how-to-plug-this-type-hole-2/58035286#58035286", "title": "How to plug this type hole 2", "body": "<blockquote>\n  <p>To me it looks like I am returning a <code>String</code> (<code>[Char]</code>) type.</p>\n</blockquote>\n\n<p><strong>No</strong>. <code>return</code> is not, as in most imperative languages, a keyword to return content. It is a function. Indeed <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:return\" rel=\"nofollow noreferrer\"><strong><code>return :: Monad m =&gt; a -&gt; m a</code></strong></a> is a function that \"<em>injects a value in a monadic type</em>\".</p>\n\n<p>The <code>pdfInfo</code> function has as type <a href=\"https://hackage.haskell.org/package/pdfinfo-1.5.4/docs/Text-PDF-Info.html#v:pdfInfo\" rel=\"nofollow noreferrer\"><strong><code>pdfInfo :: MonadIO m =&gt; FilePath -&gt; m (Either PDFInfoError PDFInfo)</code></strong></a>. So we will need to use a <code>MonadIO</code> type:</p>\n\n<pre><code>title :: <b>MonadIO m =&gt;</b> FilePath -&gt; <b>m</b> String\ntitle path = do\n    result &lt;- pdfInfoTitle info\n    case pdfInfo path of\n        Left someError -&gt; return \"no title\"\n        Right info -&gt; case (pdfInfoTitle info) of\n            Nothing -&gt; return \"no title\"\n            Just title -&gt; return (T.unpack title)</code></pre>\n\n<p>We here thus return an <code>m String</code>. You can see a <code>MonadIO</code> as a \"recipe\" to construct a value (here a <code>String</code>). Not a <code>String</code> itself.</p>\n"}], "owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 58035286, "answer_count": 1, "score": 1, "last_activity_date": 1569014308, "creation_date": 1569013753, "last_edit_date": 1569014009, "question_id": 58035216, "link": "https://stackoverflow.com/questions/58035216/how-to-plug-this-type-hole-2", "title": "How to plug this type hole 2", "body": "<p>Following along from <a href=\"https://stackoverflow.com/questions/58032008/how-to-plug-this-type-hole/58032339#58032339\">here</a> (I've refactored the code from main into its own function) I am trying to get the following code to compile:</p>\n\n<pre><code>import qualified Data.Text as T\nimport Text.PDF.Info\n\ntitle :: FilePath -&gt; String\ntitle path = do\n  result &lt;- pdfInfo path\n  case result of\n    Left someError -&gt; do\n      return \"no title\"\n    Right info -&gt; do\n      case (pdfInfoTitle info) of\n        Nothing -&gt; return \"no title\"\n        Just title -&gt; return (T.unpack title)\n</code></pre>\n\n<p>I am getting </p>\n\n<pre><code>    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019\n      Expected type: [Char]\n        Actual type: [[Char]]\n    \u2022 In a stmt of a 'do' block: return \"no title\"\n      In the expression: do return \"no title\"\n      In a case alternative: Left someError -&gt; do return \"no title\"\n   |\n14 |       return \"no title\"\n   |       ^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>To me it looks like I am returning a String ([Char]) type, but I guess not. Guidance please, thanks in advance.</p>\n\n<p>Here it is in greater context of what I hope to accomplish:</p>\n\n<pre><code>module Main where\n\nimport Control.Monad (liftM)\nimport Data.List (isSubsequenceOf, isSuffixOf)\nimport System.Directory (listDirectory)\nimport qualified Data.Text as T\nimport Text.PDF.Info\n\ntitle :: FilePath -&gt; String\ntitle path = do\n  result &lt;- pdfInfo path\n  case result of\n    Left someError -&gt; do\n      return \"no title\"\n    Right info -&gt; do\n      case (pdfInfoTitle info) of\n        Nothing -&gt; return \"no title\"\n        Just title -&gt; return (T.unpack title)\n\nmain :: IO ()\nmain = do\n  print =&lt;&lt;\n    liftM\n      (filter\n         (\\path -&gt;\n            ((isSubsequenceOf \"annotated\" path) ||\n             (isSubsequenceOf \"annotated\" (title path))) &amp;&amp;\n            (isSuffixOf \"pdf\" path)))\n      (listDirectory \"/home/foo\")\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1568996822, "post_id": 58032008, "comment_id": 102466476, "body": "Do you need to <i>produce</i> a value of that type, or to <i>consume</i> a value of that type? I ask because, to me, &quot;type hole&quot; suggests produce, while &quot;out of it&quot; suggests consume."}, {"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1568996898, "post_id": 58032008, "comment_id": 102466500, "body": "I need to return a value of that type from the expression so that I can then call pdfInfoTitle on it and return that value to main"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1568996999, "post_id": 58032008, "comment_id": 102466532, "body": "What do you mean by &quot;return a value ... from the expression&quot;? Again, produce or consume? &quot;return a value&quot; is producing, &quot;from an expression&quot; is consuming, so it is still unclear :-/"}, {"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1568997172, "post_id": 58032008, "comment_id": 102466600, "body": "I&#39;d like to take further action on the result of pdfInfoTitle once I have it and I can&#39;t get it until I can get at the PDFInfo value. I hope that helps."}], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 0, "creation_date": 1569000123, "post_id": 58032339, "comment_id": 102467650, "body": "thanks! If I wanted to get just the title and not: Just &quot;the title&quot; as a result of the Right branch of logic, what do I do? I want to now take action on the actual title string."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 1, "creation_date": 1569005572, "post_id": 58032339, "comment_id": 102469707, "body": "@Joe The title has a <code>Maybe Text</code> type since it might be missing in the pdf file.  You can convert that to <code>Text</code> by providing a default title, e.g. <code>print (fromMaybe &quot;No Title&quot; (pdfInfoTitle info))</code>, after <code>import Data.Maybe</code>. Here, <code>case pdfInfoTitle info of Nothing -&gt; .... ; Just title -&gt; ....</code> would also work, as a basic alternative."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 1, "creation_date": 1569006048, "post_id": 58032339, "comment_id": 102469866, "body": "@Joe Do the same thing this answer does for <code>Either</code>: pattern match on it! <code>case pdfInfoTitle info of Nothing -&gt; {- ... -}; Just title -&gt; {- ... -}</code>"}, {"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 0, "creation_date": 1569013836, "post_id": 58032339, "comment_id": 102472277, "body": "Next question: <a href=\"https://stackoverflow.com/questions/58035216/how-to-plug-this-type-hole-2\" title=\"how to plug this type hole 2\">stackoverflow.com/questions/58035216/&hellip;</a>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1569006142, "last_edit_date": 1569006142, "creation_date": 1568997988, "answer_id": 58032339, "question_id": 58032008, "link": "https://stackoverflow.com/questions/58032008/how-to-plug-this-type-hole/58032339#58032339", "title": "How to plug this type hole?", "body": "<p>Here's a compiling example:</p>\n\n<pre><code>module Main where\n\nimport Text.PDF.Info\n\nmain :: IO ()\nmain = do\n  result &lt;- pdfInfo \"foo.pdf\"\n  case result of\n    Left someError -&gt; do\n       putStrLn \"Oh, no!\"\n       print someError\n    Right info -&gt; do\n       putStrLn \"OK! Got info!\"\n       print (pdfInfoTitle info)\n</code></pre>\n\n<p>The idea is: in your type, the monad <code>m</code> can be chosen as we wish as long as <code>m</code> belong to class <code>MonadIO</code>. <code>m = IO</code> satisfies that, so we can \"run\" <code>pdfInfo \"foo.pdf\"</code> inside <code>main</code>, much like <code>putStrLn \"hello\"</code> or <code>l &lt;- geTLine</code> or any other IO action.</p>\n\n<p>(Whenever you have <code>MonadIO m =&gt; ...</code>, you can always pretend that <code>m = IO</code>. They type is slightly more general than that, but keeping things simple helps intuition.)</p>\n\n<p>So, we can use <code>result &lt;- pdfInfo \"foo.pdf\"</code>.\nHere, <code>result</code> has type whatever is inside <code>m</code>, that is <code>Either PDFInfoError PDFInfo</code>. Hence, <code>result</code> is either an error (wrapped under <code>Left</code>) or the actual info (wrapped using <code>Right</code>).</p>\n\n<p>We can then use <code>case result of</code> to branch on the two possibilities, and handle them accordingly.</p>\n"}], "owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58032339, "answer_count": 1, "score": 0, "last_activity_date": 1569006142, "creation_date": 1568996400, "last_edit_date": 1568997428, "question_id": 58032008, "link": "https://stackoverflow.com/questions/58032008/how-to-plug-this-type-hole", "title": "How to plug this type hole?", "body": "<p>If I have a returned type of an expression/value:</p>\n\n<pre><code>:: Control.Monad.IO.Class.MonadIO m =&gt;\n     m (Either PDFInfoError PDFInfo)\n</code></pre>\n\n<p>How do I get the PDFInfo out of it? Perhaps more importantly, what process does one use to figure such things out. I'd like to leverage typed holes or some other process to be able to reason through these types (no pun intended) of questions on my own. Still reading through my first Haskell book, but wanting to understand how a more experienced Haskeller would solve this using tools. </p>\n\n<p>Perhaps it will help to have the greater context of the problem (attempting to use a typed hole to let ghc help me find what I am missing to get the PDFInfo result so that I can call pdfInfoTitle on it):</p>\n\n<pre><code>module Main where\n\nimport Text.PDF.Info\n\nmain :: IO ()\nmain = do\n  pdfInfoTitle $ _ pdfInfo \"foo.pdf\" \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1568984659, "post_id": 58028854, "comment_id": 102460251, "body": "What is <code>let a = [] ++ num1</code> supposed to do?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1568984859, "post_id": 58028854, "comment_id": 102460319, "body": "What did you try to solve this problem yourself? What should be the signature of the core function that solves the problem?"}, {"owner": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1568984916, "post_id": 58028854, "comment_id": 102460353, "body": "making a list like this   for example  A=[1,2,4] B=[1,2,5]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1568984947, "post_id": 58028854, "comment_id": 102460368, "body": "but <code>num1</code>, is already a list of <code>Int</code>s. <code>([] ++)</code> is basically a no-op."}, {"owner": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1568985043, "post_id": 58028854, "comment_id": 102460414, "body": "that&#39;s why i&#39;ve posted this problem because im a beginner in Haskell hihi..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1568985168, "post_id": 58028854, "comment_id": 102460481, "body": "can you make at least to make a fair attempt to solve the real problem, not just the input/output?"}, {"owner": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1568985360, "post_id": 58028854, "comment_id": 102460605, "body": "i have an example for the problem:  if A = [2,1,7] and B = [1,3,4], we can choose 1 from A and 4 from B, as number 5 = 1 + 4 doesn&#39;t belong to A and doesn&#39;t belong to B. However, we can&#39;t choose 2 from A and 1 from B, as 3 = 2 + 1 belongs to B."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1568985412, "post_id": 58028854, "comment_id": 102460636, "body": "can you write an algorithm, for example in pseudocode. What would be the output here?"}, {"owner": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1568985579, "post_id": 58028854, "comment_id": 102460720, "body": "that&#39;s also my problem if what would be the output.  our instructor give us the problem without teaching us."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1568987792, "post_id": 58028854, "comment_id": 102461990, "body": "Try looking up list comprehensions in Haskell. That&#39;s probably the easiest way to solve this problem."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "edited": false, "score": 0, "creation_date": 1569082371, "post_id": 58035490, "comment_id": 102484382, "body": "but i don&#39;t know how to install z3?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "edited": false, "score": 1, "creation_date": 1569090597, "post_id": 58035490, "comment_id": 102486276, "body": "@Rvincent16, I think you&#39;re supposed to draw inspiration from this answer rather than actually using it. Could be wrong though. It may also be intended primarily as humor."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1569091879, "post_id": 58035490, "comment_id": 102486631, "body": "A bit of each. I wanted to convey why the asker wasn&#39;t getting help and what to do about that.  Also Z3 is cool if much less useful in a classroom setting like I suspect they&#39;re facing."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1569015912, "creation_date": 1569015912, "answer_id": 58035490, "question_id": 58028854, "link": "https://stackoverflow.com/questions/58028854/how-can-i-get-output-mention-in-below/58035490#58035490", "title": "How can I get output mention in below", "body": "<p><strong>Serious</strong></p>\n\n<p>If your instructor isn't teaching, and that isn't just you being burned out and stressed, then talk to the instructor.  They probably aren't trying to waste your and their time.  If that doesn't work then talk to the professor.</p>\n\n<p>As for getting homework help here, it is entirely doable but help is very unlikely to appear without some semblance of an attempt and a clear cut issue.  You usually need to come to the table with <em>how</em> the problem can be solved and have problems translating that how into the specifics of <em>Haskell</em> or whatever target language.</p>\n\n<p><strong>Cheeky</strong></p>\n\n<p>A cheeky response I'd use if I were in the classroom:</p>\n\n<p>This is a finite domain so I'd just use DPLL.  DPLL is a general purpose algorithm for finite domains that allows us to just state the problem as a symbolic computation and constraints then request satisfying models.   We'll construct the problem first then use the SBV library to get the model.</p>\n\n<blockquote>\n  <p>Choose some element a of A</p>\n</blockquote>\n\n<p>So lets define the set A (called <code>as</code>) as a list of symbolics and then constrain an existential to being a member of this set!</p>\n\n<pre><code>     a &lt;- exists \"value1\"\n     constrain (a `sElem` as)\n</code></pre>\n\n<blockquote>\n  <p>and some element b of B</p>\n</blockquote>\n\n<p>OK, same thing.  We make a list of symbolic values and constrain an existential to being a member.</p>\n\n<pre><code>     b &lt;- exists \"value2\"\n     constrain (b `sElem` bs)\n</code></pre>\n\n<blockquote>\n  <p>such that a + b</p>\n</blockquote>\n\n<p>Let's define an alias for this:</p>\n\n<pre><code>let c = a + b\n</code></pre>\n\n<blockquote>\n  <p>doesn't belong to A</p>\n</blockquote>\n\n<p>We can just reuse the test for membership, <code>sElem</code>, and symbolic negation <code>sNot</code>.</p>\n\n<pre><code>constrain $ sNot (c `sElem` as)\n</code></pre>\n\n<blockquote>\n  <p>and doesn't belong to B</p>\n</blockquote>\n\n<p>Yep, same!</p>\n\n<pre><code>constrain $ sNot (c `sElem` bs)\n</code></pre>\n\n<p><strong>Putting it together</strong></p>\n\n<p>Honestly the hardest part is actually <em>running</em> your problem more than stating it.  We need to read the inputs (as you showed), call the solver (<code>sat</code>), and get the answer (aka the \"model) via <code>extractModel</code> which can finally be printed.</p>\n\n<pre><code>#!/usr/bin/env cabal\n{- cabal:\n    build-depends:\n        base, sbv &gt;= 8.4\n-}\n{-# LANGUAGE ViewPatterns #-}\n\nimport Data.SBV\n\nreadInts :: IO [Int64]\nreadInts = fmap read . words &lt;$&gt; getLine\n\nreadInt :: IO Int64\nreadInt = read &lt;$&gt; getLine\n\nmain =\n do putStrLn \"List number of A: \"\n    a &lt;- readInts\n    putStrLn \"List number of B: \"\n    b  &lt;- readInts\n    result &lt;- getValues a b\n    let values :: Maybe (Int64,Int64)\n        values = extractModel result\n    print values\n\ngetValues :: [Int64] -&gt; [Int64] -&gt; IO SatResult\ngetValues (map literal -&gt; as) (map literal -&gt; bs) = sat $\n    do a &lt;- exists \"value1\"\n       constrain (a `sElem` as)\n\n       b &lt;- exists \"value2\"\n       constrain (b `sElem` bs)\n\n       let c = a + b\n       constrain $ sNot (c `sElem` as)\n       constrain $ sNot (c `sElem` bs)\n</code></pre>\n\n<p>Because this uses SBV you'll have to have first installed <code>z3</code>.  I included a cabal header to auto build as a package.  For example:</p>\n\n<pre><code>brew install z3\n...\nchmod +x mycode.hs\n./mycode.hs\n...\nList number of A:\n1 3 4 5\nList number of B:\n1 2 3\nJust (3,3)  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12095590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEgkSrO5Nh_cD-UcpjhozIhxlQ_x8MXp2Q9UrUKg=k-s128", "display_name": "Rvincent16", "link": "https://stackoverflow.com/users/12095590/rvincent16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": -11, "last_activity_date": 1569015912, "creation_date": 1568984290, "last_edit_date": 1568984634, "question_id": 58028854, "link": "https://stackoverflow.com/questions/58028854/how-can-i-get-output-mention-in-below", "title": "How can I get output mention in below", "body": "<pre><code>readInts = fmap (map read.words) getLine\nreadInts :: IO [Int]\n\nmain = do\n    putStrLn \"List number of A: \"\n    num1 &lt;- readInts\n    let a = [] ++ num1\n    putStrLn \"List number of B: \"\n    num2 &lt;- readInts\n    let b = [] ++ num2\n</code></pre>\n\n<p>Choose some element a of A and some element b of B such that a + b doesn't belong to A and doesn't belong to B</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 10552205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c468e05d33cced21afcfe2faa69828c1?s=128&d=identicon&r=PG", "display_name": "syocy", "link": "https://stackoverflow.com/users/10552205/syocy"}, "is_accepted": false, "score": 5, "last_activity_date": 1568980492, "creation_date": 1568980492, "answer_id": 58027909, "question_id": 58027908, "link": "https://stackoverflow.com/questions/58027908/flycheck-haskell-and-doctest-dont-work-on-cabal-3-0-v2-build-project/58027909#58027909", "title": "flycheck-haskell and doctest don&#39;t work on Cabal 3.0 v2-build project", "body": "<p>Your doctest doesn't find proper <a href=\"https://ghc.gitlab.haskell.org/ghc/doc/users_guide/packages.html#envvar-GHC_ENVIRONMENT\" rel=\"noreferrer\">GHC_ENVIRONEMNT</a>.</p>\n\n<p>Since Cabal 3.0, cabal v2-build doesn't generate environment files by default.</p>\n\n<blockquote>\n  <p>Since Cabal 3.0, defaults to never. Before that, defaulted to creating them only when compiling with GHC 8.4.4 and older (GHC 8.4.4 is the first version that supports the -package-env - option that allows ignoring the package environment files).\n  <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build.html#cfg-field-write-ghc-environment-files\" rel=\"noreferrer\">https://www.haskell.org/cabal/users-guide/nix-local-build.html#cfg-field-write-ghc-environment-files</a></p>\n</blockquote>\n\n<p>So you should set this option on v2-build.</p>\n\n<pre><code>$ cabal v2-build --write-ghc-environment-files=ghc8.4.4+\n</code></pre>\n\n<p>Or you can write this in <a href=\"https://www.haskell.org/cabal/users-guide/installing-packages.html#overview\" rel=\"noreferrer\">$HOME/.cabal/config</a> for default cabal behavior.</p>\n\n<pre><code>write-ghc-environment-files: ghc8.4.4+\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10552205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c468e05d33cced21afcfe2faa69828c1?s=128&d=identicon&r=PG", "display_name": "syocy", "link": "https://stackoverflow.com/users/10552205/syocy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1568980492, "creation_date": 1568980492, "question_id": 58027908, "link": "https://stackoverflow.com/questions/58027908/flycheck-haskell-and-doctest-dont-work-on-cabal-3-0-v2-build-project", "title": "flycheck-haskell and doctest don&#39;t work on Cabal 3.0 v2-build project", "body": "<p>I tried to create a Nix-style local build (v2-build) project on Cabal 3.0.<br>\nBut several development tools (flycheck-haskell and doctest) don't work.<br>\nThey worked on new-build project on Cabal 2.4.<br>\nError message says they cannot find dependencies, as far as I read.</p>\n\n<pre><code>$ cabal v2-clean\n$ cabal v2-build\n$ cabal v2-test\nBuild profile: -w ghc-8.8.1 -O1\nIn order, the following will be built (use -v for more details):\n - hstest9-0.1.0.0 (test:doctestd) (first run)\nConfiguring test suite 'doctestd' for hstest9-0.1.0.0..\nPreprocessing test suite 'doctestd' for hstest9-0.1.0.0..\nBuilding test suite 'doctestd' for hstest9-0.1.0.0..\n[1 of 1] Compiling Main             ( test/doctest-driver.hs, /Users/user/work/hstest9/dist-newstyle/build/x86_64-osx/ghc-8.8.1/hstest9-0.1.0.0/t/doctestd/build/doctestd/doctestd-tmp/Main.o )\nLinking /Users/user/work/hstest9/dist-newstyle/build/x86_64-osx/ghc-8.8.1/hstest9-0.1.0.0/t/doctestd/build/doctestd/doctestd ...\nRunning 1 test suites...\nTest suite doctestd: RUNNING...\n\n/Users/user/work/hstest9/src/MyLib.hs:3:1: error:\n    Could not find module \u2018Control.Effect\u2019\n    Use -v (or `:set -v` in ghci) to see a list of the files searched for.\n  |\n3 | import Control.Effect\n  | ^^^^^^^^^^^^^^^^^^^^^\n\nTest suite doctestd: FAIL\nTest suite logged to:\n/Users/user/work/hstest9/dist-newstyle/build/x86_64-osx/ghc-8.8.1/hstest9-0.1.0.0/t/doctestd/test/hstest9-0.1.0.0-doctestd.log\n0 of 1 test suites (0 of 1 test cases) passed.\ncabal: Tests failed for test:doctestd from hstest9-0.1.0.0.\n</code></pre>\n"}, {"tags": ["haskell", "either", "hoogle"], "comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 3, "creation_date": 1568976595, "post_id": 58026711, "comment_id": 102456091, "body": "Not an answer but just a remark: <a href=\"https://github.com/ndmitchell/hoogle/blob/master/docs/TypeSearch.md\" rel=\"nofollow noreferrer\">github.com/ndmitchell/hoogle/blob/master/docs/TypeSearch.md</a> defines how it works currently."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1568978380, "post_id": 58026711, "comment_id": 102456968, "body": "I would argue that your second result is actually a much better fit for the search than your first result. So I see this as an improvement!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1568978394, "post_id": 58026711, "comment_id": 102456977, "body": "I daresay that the version from today is definitely <i>much closer</i> to what you searched for. The signature of <code>either</code> is very different from what you searched for; if Hoogle shows all just <i>remotely</i> related signatures from hundreds of packages than how are you supposed to find the right one there?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1568978727, "post_id": 58026711, "comment_id": 102457139, "body": "Worse, this gets no results at all: <code>(a -&gt; IO c) -&gt; (b -&gt; IO c) -&gt; Either a b -&gt; IO c</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1568983801, "post_id": 58026711, "comment_id": 102459764, "body": "@dfeuer that, indeed, is a bit sad."}], "answers": [{"tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": true, "score": 8, "last_activity_date": 1568980122, "creation_date": 1568980122, "answer_id": 58027801, "question_id": 58026711, "link": "https://stackoverflow.com/questions/58026711/either-a-b-different-hoogle-results-after-two-years/58027801#58027801", "title": "Either a b. Different Hoogle results after two years?", "body": "<p>The code has changed completely since the last time you tried it. In particular, it now scales up to all of Stackage (~2K packages), gets updated every night and takes a bounded amount of time per query (certain queries like searching for the type <code>a</code> could make the old Hoogle take up a huge amount of time and memory). Completely rewriting the type search algorithm impacted almost all queries - some got better, some worse, and in some cases, what is better or worse is hard to define. <a href=\"https://neilmitchell.blogspot.com/2015/01/hoogle-5-is-coming.html\" rel=\"noreferrer\">This blog post</a> serves as an overview of what happened and <a href=\"https://github.com/ndmitchell/hoogle/issues\" rel=\"noreferrer\">this issue tracker</a> can be used for searches you think could be improved.</p>\n"}], "owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 58027801, "answer_count": 1, "score": 5, "last_activity_date": 1568980122, "creation_date": 1568975798, "last_edit_date": 1568978262, "question_id": 58026711, "link": "https://stackoverflow.com/questions/58026711/either-a-b-different-hoogle-results-after-two-years", "title": "Either a b. Different Hoogle results after two years?", "body": "<p>I am following a video that was recorded about two years ago. The speaker enters <code>Either a b -&gt; IO b</code> in the public Hoogle search input and the result contains (among others):</p>\n\n<pre><code>either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c\n</code></pre>\n\n<p>If I <a href=\"https://hoogle.haskell.org/?hoogle=Either%20a%20b%20-%3E%20IO%20b\" rel=\"nofollow noreferrer\">try it today</a>, this result is not found, which is a pity. Similar results are found, like </p>\n\n<pre><code>fromEither :: (Exception e, MonadIO m) =&gt; Either e a -&gt; m a\n</code></pre>\n\n<p>but they are less ready-to-use.</p>\n\n<p><strong>How can this be explained? Has the Hoogle search algorithm gotten stricter? Has Either changed?</strong></p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1568977930, "post_id": 58024845, "comment_id": 102456746, "body": "In the cabal file, <code>exposed-modules</code> for the importable modules and <code>other-modules</code> for the non-importable modules."}, {"owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1568992596, "post_id": 58024845, "comment_id": 102464631, "body": "I&#39;m using <code>stack</code> which automatically generates the <code>cabal</code> file from <code>package.yaml</code>. So is there a way to put this info in <code>package.yaml</code>?"}, {"owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1568993111, "post_id": 58024845, "comment_id": 102464905, "body": "Comment at the top of the <code>cabal</code> file: <i>-- This file has been generated from package.yaml by hpack version 0.31.2.</i>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1568997824, "post_id": 58024845, "comment_id": 102466826, "body": "Sorry I never used <code>package.yaml</code>, I don&#39;t know."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1569024317, "post_id": 58024845, "comment_id": 102474232, "body": "@LoHaBuyshan2 If you&#39;ve solved your problem, then you should post an answer to your own question, to help any future comers."}, {"owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "edited": false, "score": 0, "creation_date": 1569119384, "post_id": 58024845, "comment_id": 102490835, "body": "Thanks Stephane for your solution. FYI, <code>stack</code> integration is explained in <a href=\"https://mmhaskell.com/blog/2017/7/17/cleaning-up-our-projects-with-hpack\" rel=\"nofollow noreferrer\">mmhaskell.com/blog/2017/7/17/&hellip;</a>"}], "owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568969228, "creation_date": 1568968828, "last_edit_date": 1568969228, "question_id": 58024845, "link": "https://stackoverflow.com/questions/58024845/haskell-module-restricted-sharing", "title": "Haskell module restricted sharing", "body": "<p>I have 2 modules which share code, so I want to factor out a third module for this code sharing. But I only want those first 2 modules to be able to see it (via <code>import</code>) because the code is not re-usable to the outside world. Thus any other module would be blocked from importing the third module. Is this doable?</p>\n\n<p>Alternatively the third module does have some code that is useful to the outside world, and some that is not (but rather only to the first 2 modules). Is there a way to qualify its export list?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1568957886, "post_id": 58022292, "comment_id": 102447416, "body": "So, first hint : <code>_</code> isn&#39;t actually a variable name. It means &quot;I know something goes here, but please don&#39;t give it a name&quot; in patterns (left side of = in this case).and &quot;I know something goes here, but I&#39;m not sure what yet, please tell me its type haskell compiler&quot; in expressions."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1568958126, "post_id": 58022292, "comment_id": 102447476, "body": "So you need to give a name to things you&#39;re going to refer to, those start with lower case letters"}, {"owner": {"reputation": 205, "user_id": 7122820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4f3016562e441ea99bcdc6da3708a?s=128&d=identicon&r=PG&f=1", "display_name": "jiipeezz", "link": "https://stackoverflow.com/users/7122820/jiipeezz"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1568958835, "post_id": 58022292, "comment_id": 102447696, "body": "@Cubic I don&#39;t understand fully where I&#39;m supposed to give those names. <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#Typeclasses%20102\" rel=\"nofollow noreferrer\">learnyouahaskell.com/&hellip;</a> , section Typeclasses 102 has an example (TrafficLight one) which I tried to follow, and I can&#39;t see how it differs from mine, other than mine takes an Integer as a parameter."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1568960138, "post_id": 58022292, "comment_id": 102448150, "body": "@jiipeezz See <a href=\"http://learnyouahaskell.com/starting-out#babys-first-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/starting-out#babys-first-functions</a>: <code>doubleMe x = x + x</code> (using a parameter named <code>x</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1568985604, "post_id": 58023362, "comment_id": 102460736, "body": "I think the idea here is to format a telephone country access code, in which case <code>x</code>  should be unsigned and the <code>+</code> should be used unconditionally, not to indicate a positive value."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1568985823, "last_edit_date": 1568985823, "creation_date": 1568963214, "answer_id": 58023362, "question_id": 58022292, "link": "https://stackoverflow.com/questions/58022292/showing-a-number-with-preceding-sign/58023362#58023362", "title": "Showing a number with preceding &#39;+&#39; sign", "body": "<p>You should unpack the data constructor, and thus obtain the parameter <code>x</code>. We can then use guards to check if the value is positive or negative. In case it is positive, we can prepend <code>'x'</code> to the result of <code>show x</code>:</p>\n\n<pre><code>instance Show CountryCode where\n    show (CountryCode x) | x &gt;= 0 = '+' : show x\n                         | otherwise = show x</code></pre>\n\n<p>or we can omit branching in a positive and negative case like <a href=\"https://stackoverflow.com/questions/58022292/showing-a-number-with-preceding-sign/58023362?noredirect=1#comment102460736_58023362\">@chepner suggests</a> with:</p>\n\n<pre><code>instance Show CountryCode where\n    show (CountryCode x) = '+' : show x</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 7122820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4f3016562e441ea99bcdc6da3708a?s=128&d=identicon&r=PG&f=1", "display_name": "jiipeezz", "link": "https://stackoverflow.com/users/7122820/jiipeezz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58023362, "answer_count": 1, "score": 1, "last_activity_date": 1568985823, "creation_date": 1568957440, "question_id": 58022292, "link": "https://stackoverflow.com/questions/58022292/showing-a-number-with-preceding-sign", "title": "Showing a number with preceding &#39;+&#39; sign", "body": "<p>I'm new to functional programming and Haskell, and having really difficult time understanding making of your own data types. As a learning source I have been using <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/</a>, but I'm still unable to grasp some ideas.</p>\n\n<p>My specific problem is, that I'm trying to create a show Instance for my custom data type, which always shows '+' symbol in front of whatever is showed (in my case input 555 would be \"+555\"). This is how I've been trying to solve it.</p>\n\n<pre><code>data CountryCode = CountryCode Integer deriving Eq\n\ninstance Show CountryCode where\n    show _ = \"+\" : _\n</code></pre>\n\n<p>And this is what I get when I try to load it.</p>\n\n<pre><code>[1 of 1] Compiling Main             ( phonetest.hs, interpreted )\n\nphonetest.hs:6:14: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019\n      Expected type: String\n        Actual type: [[Char]]\n    \u2022 In the expression: \"+\" : _\n      In an equation for \u2018show\u2019: show _ = \"+\" : _\n      In the instance declaration for \u2018Show CountryCode\u2019\n\nphonetest.hs:6:20: error:\n    \u2022 Found hole: _ :: [[Char]]\n    \u2022 In the second argument of \u2018(:)\u2019, namely \u2018_\u2019\n      In the expression: \"+\" : _\n      In an equation for \u2018show\u2019: show _ = \"+\" : _\n    \u2022 Relevant bindings include\n        show :: CountryCode -&gt; String (bound at phonetest.hs:6:5)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I can get something out of the error message, but not enough to make it work correctly. I also tried <code>show (CountryCode _) = \"+\" : _</code> but haskell still complains. To me it seems pretty logical, but clearly there's some basic haskell knowledge I'm lacking.</p>\n"}, {"tags": ["list", "haskell", "recursion", "sublist"], "comments": [{"owner": {"reputation": 21, "user_id": 12093344, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qSdO1M_jP0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re9vYCY7ttQ03CbnyKY9ttrLhn-Wg/photo.jpg?sz=128", "display_name": "nick doig", "link": "https://stackoverflow.com/users/12093344/nick-doig"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1568952071, "post_id": 58021470, "comment_id": 102446153, "body": "I edited my post to include my current code. I&#39;m not sure how to add an int to an existing list within the list of lists."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1568973480, "post_id": 58021470, "comment_id": 102454483, "body": "<a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:span\" rel=\"nofollow noreferrer\"><code>span</code></a> might be useful here."}, {"owner": {"reputation": 21, "user_id": 12093344, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qSdO1M_jP0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re9vYCY7ttQ03CbnyKY9ttrLhn-Wg/photo.jpg?sz=128", "display_name": "nick doig", "link": "https://stackoverflow.com/users/12093344/nick-doig"}, "reply_to_user": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1569028018, "post_id": 58021470, "comment_id": 102474689, "body": "how would you use span to approach the problem?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570721818, "post_id": 58021470, "comment_id": 103011444, "body": "@nickdoig like <a href=\"https://stackoverflow.com/a/58326464/849891\">this</a>. :)"}], "answers": [{"tags": [], "owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "is_accepted": true, "score": 2, "last_activity_date": 1568956256, "creation_date": 1568956256, "answer_id": 58022115, "question_id": 58021470, "link": "https://stackoverflow.com/questions/58021470/breaking-up-a-list-into-sublists-with-recursion/58022115#58022115", "title": "Breaking up a list into sublists with recursion", "body": "<p>You can break this problem into two sub-problems. <br></p>\n\n<ol>\n<li>For any given list, take the head of this list and match it against the rest of list. There are two possibilities during this matching: i) You are successful i.e. you match, and if so, you collect the matched value and continue looking for more values, or ii) You fail, i.e. you don't match, and if so, you stop immediately and return the so far matched result with  rest of, not-inspected, list. </li>\n</ol>\n\n<blockquote>\n<pre><code>   collectF :: (Eq a) =&gt; (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\n   collectF f [] = ([], [])\n   collectF f (x : xs) \n    | f x = let (ys, zs) = collectF f xs in (x : ys, zs)\n    | otherwise = ([], x : xs)\n</code></pre>\n</blockquote>\n\n<ol start=\"2\">\n<li>Now that you have the collectF function, you can use it recursively on input list. In each call, you would get a successful list with rest of, not-inspected, list. Apply collectF again on rest of list until it is exhausted. </li>\n</ol>\n\n<blockquote>\n<pre><code>groupBy :: (Eq a) =&gt; (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\ngroupBy _ [] = []\ngroupBy f (x : xs) = \n    let (ys, zs) = collectF (f x) xs in \n    (x : ys) : groupBy f zs\n\n*Main&gt; groupBy (\\x y -&gt; snd x == snd y) [(1,True),(2,True),(3,False),(4,True),(5,False),(6,False),(7,True)]\n[[(1,True),(2,True)],[(3,False)],[(4,True)],[(5,False),(6,False)],[(7,True)]]\n</code></pre>\n</blockquote>\n\n<p>I am leaving it to you to remove the True and False values from List. Also, have a look at List library of Haskell [1]. Hope, I am clear enough, but let me know if you have any other question. </p>\n\n<p>[1] <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.OldList.html#groupBy\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.OldList.html#groupBy</a></p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570782645, "post_id": 58314713, "comment_id": 103030626, "body": "we can produce not so many <code>[]</code>s in the first place. <code>go (n, False) l</code> can inspect the   <code>l</code> and if its first sublist is <code>[]</code>, just keep it as is. the laziness of not inspecting the <code>l</code> in that case is destroyed by the downstream <code>filter (not . null)</code> anyway. :) so there will in the end be only one extraneous <code>[]</code> at the head of produced list, at the most. (reason I know, this thing was already asked, and answered several years back... I remember there was an answer by Daniel Fischer, and possibly also by me)."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1571008020, "post_id": 58314713, "comment_id": 103087024, "body": "@WillNess Good catch. I added a variant that takes advantage of that."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1571008790, "last_edit_date": 1571008790, "creation_date": 1570675350, "answer_id": 58314713, "question_id": 58021470, "link": "https://stackoverflow.com/questions/58021470/breaking-up-a-list-into-sublists-with-recursion/58314713#58314713", "title": "Breaking up a list into sublists with recursion", "body": "<p>Here's how I'd write this:</p>\n\n<pre><code>import Data.List.NonEmpty (NonEmpty(..), (&lt;|))\nimport qualified Data.List.NonEmpty as NE\n\ntest :: [(Int, Bool)] -&gt; [[Int]]\ntest = NE.filter (not . null) . foldr go ([]:|[])\n  where\n    go :: (Int, Bool) -&gt; NonEmpty [Int] -&gt; NonEmpty [Int]\n    go (n, True) ~(h:|t) = (n:h):|t\n    go (n, False) l = []&lt;|l\n</code></pre>\n\n<p>Or with <a href=\"https://stackoverflow.com/questions/58021470/breaking-up-a-list-into-sublists-with-recursion/58314713#comment103030626_58314713\">Will Ness's suggestion</a>:</p>\n\n<pre><code>import Data.List.NonEmpty (NonEmpty(..))\n\ntest :: [(Int, Bool)] -&gt; [[Int]]\ntest = removeHeadIfEmpty . foldr prependOrStartNewList ([]:|[])\n  where\n    prependOrStartNewList :: (Int, Bool) -&gt; NonEmpty [Int] -&gt; NonEmpty [Int]\n    prependOrStartNewList (n, True) ~(h:|t) = (n:h):|t\n    prependOrStartNewList (n, False) l = []:|removeHeadIfEmpty l\n    removeHeadIfEmpty :: NonEmpty [Int] -&gt; [[Int]]\n    removeHeadIfEmpty (h:|t) = if null h then t else h:t\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1570721602, "creation_date": 1570721602, "answer_id": 58326464, "question_id": 58021470, "link": "https://stackoverflow.com/questions/58021470/breaking-up-a-list-into-sublists-with-recursion/58326464#58326464", "title": "Breaking up a list into sublists with recursion", "body": "<p>Repeatedly, drop the <code>False</code>s, grab the <code>True</code>s. With view patterns:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\ntest :: [(a, Bool)] -&gt; [[a]]\ntest (span snd . dropWhile (not . snd) -&gt; (a,b))\n               | null a     =  [] \n               | otherwise  =  map fst a : test b\n</code></pre>\n\n<p>Works with infinite lists as well, inasmuch as possible. </p>\n"}], "owner": {"reputation": 21, "user_id": 12093344, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qSdO1M_jP0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re9vYCY7ttQ03CbnyKY9ttrLhn-Wg/photo.jpg?sz=128", "display_name": "nick doig", "link": "https://stackoverflow.com/users/12093344/nick-doig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 1, "accepted_answer_id": 58022115, "answer_count": 3, "score": 1, "last_activity_date": 1571008790, "creation_date": 1568950671, "last_edit_date": 1570724622, "question_id": 58021470, "link": "https://stackoverflow.com/questions/58021470/breaking-up-a-list-into-sublists-with-recursion", "title": "Breaking up a list into sublists with recursion", "body": "<p>I'm trying to write a function with the type declaration <code>[(Int, Bool)] -&gt; [[Int]]</code>. I want the function to only add <code>Int</code>s to the same nested sublist if the Boolean is <code>True</code>. However if the Boolean is <code>False</code>, I want the <code>Int</code> associated with the next <code>True</code> bool to be added to a <em>new</em> sublist. For example: An input of </p>\n\n<pre><code>[(1,True),(2,True),(3,False),(4,True),(5,False),(6,False),(7,True)]\n</code></pre>\n\n<p>should return</p>\n\n<pre><code>[[1,2],[4],[7]]. \n</code></pre>\n\n<p>My code so far:</p>\n\n<pre><code>test:: [(Int, Bool)] -&gt; [[Int]]\ntest xs = case xs of\n    []-&gt;[]\n    x:xs\n        | snd x == True -&gt; [(fst x)] : test xs\n        | snd x == False -&gt; test xs\n</code></pre>\n\n<p>I'm currently having issues on adding concurrent Ints to the same list if their bools are both <code>True</code>.</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "edited": false, "score": 0, "creation_date": 1568932797, "post_id": 58019587, "comment_id": 102442745, "body": "Please direct your answer towards my edited example . (sorry for the late edit)"}, {"owner": {"reputation": 3706, "user_id": 2018455, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e75a41fc224930ef1fa9ddcc9c714174?s=128&d=identicon&r=PG", "display_name": "Neil Locketz", "link": "https://stackoverflow.com/users/2018455/neil-locketz"}, "reply_to_user": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "edited": false, "score": 0, "creation_date": 1568933086, "post_id": 58019587, "comment_id": 102442793, "body": "@LoHaBuyshan2 , the answer is very similar. Updated."}, {"owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "edited": false, "score": 0, "creation_date": 1568934315, "post_id": 58019587, "comment_id": 102442998, "body": "But you are passing in a constant for <code>choice</code>. I want a different choice for each invocation. (I just added that as a comment in the example code)"}], "tags": [], "owner": {"reputation": 3706, "user_id": 2018455, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e75a41fc224930ef1fa9ddcc9c714174?s=128&d=identicon&r=PG", "display_name": "Neil Locketz", "link": "https://stackoverflow.com/users/2018455/neil-locketz"}, "is_accepted": true, "score": 4, "last_activity_date": 1568935637, "last_edit_date": 1568935637, "creation_date": 1568931886, "answer_id": 58019587, "question_id": 58019400, "link": "https://stackoverflow.com/questions/58019400/haskell-quickcheck-generating-values-within-a-function/58019587#58019587", "title": "Haskell QuickCheck generating values within a function", "body": "<p>The problem is <code>choose (0, 1)</code> does not produce an <code>Int</code>, it produces a <code>Gen Int</code>.</p>\n\n<p>You're treating it as though it were an <code>Int</code> in this expression: </p>\n\n<pre><code>pure $ g (\\i -&gt; i + choose (0, 1))\n</code></pre>\n\n<p>Since <code>Gen Int</code> is a monad you need to bind it in order to use the result of the \"choice\".</p>\n\n<p>Something like this:</p>\n\n<pre><code>instance Arbitrary Q where\n    arbitrary :: Gen Q\n    arbitrary = do\n        choice &lt;- choose (0, 1)\n        return $ g (\\i -&gt; i + choice)\n</code></pre>\n\n<p><strong>Responding to the edited question:</strong></p>\n\n<p>The issue is still the same, you're trying to use the <code>Gen Int</code> as though it were an <code>Int</code>.\nYou can bind multiple times inside a <code>do</code>.</p>\n\n<p>Here is a solution:</p>\n\n<pre><code>instance Arbitrary Q where\n    arbitrary :: Gen Q\n    arbitrary = do\n        len &lt;- choose (1, 5)\n        choice &lt;- choose (0, 1)\n        return $ g len (\\i -&gt; i + choice)\n</code></pre>\n\n<p><strong>Responding to the edited, edited question</strong>:</p>\n\n<p>You have to propagate the side effects somewhere, this just means you need to run <code>choose</code> <code>len</code> times. Because <code>g</code> is a \"library\" function, I'm going to assume that you have no control over it, and can't change it. Note that the solution below is ugly since I need to use the partial function <code>(!!)</code>, and because it is rather slow (there is probably a better way to do this, but I'm not able to find it).</p>\n\n<p>The trick here is I'm mapping a function that returns <code>len</code> <code>Gen Int</code>'s, and then runs all of them, producing a list of chosen numbers (see <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Traversable.html#v:mapM\" rel=\"nofollow noreferrer\"><code>mapM</code></a> description for more details).</p>\n\n<pre><code>instance Arbitrary Q where\n arbitrary :: Gen Q\n arbitrary = do\n     len &lt;- choose (1, 5)\n     choices &lt;- mapM (\\_ -&gt; choose (0, 1)) [1 .. len]\n     return $ g len (\\i -&gt; i + (choices !! i))\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 12055103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea52ab06f550709f21fb31c128c1b71a?s=128&d=identicon&r=PG&f=1", "display_name": "puzzled", "link": "https://stackoverflow.com/users/12055103/puzzled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58019587, "answer_count": 1, "score": 0, "last_activity_date": 1568937189, "creation_date": 1568930442, "last_edit_date": 1568937189, "question_id": 58019400, "link": "https://stackoverflow.com/questions/58019400/haskell-quickcheck-generating-values-within-a-function", "title": "Haskell QuickCheck generating values within a function", "body": "<p>How do I get this contrived example to work?</p>\n\n<pre><code>newtype Q = Q [Int]\n\ninstance Arbitrary Q where\n    arbitrary :: Gen Q\n    arbitrary = do\n        len &lt;- choose (1, 5)\n        pure $ g len (\\ i -&gt; i + choose (0, 1)) -- want different choice for each invocation\n\ng :: Int -&gt; (Int -&gt; Int) -&gt; Q -- g is a library function\ng len f = Q $ fmap f [1 .. len]\n</code></pre>\n\n<p>It gives compiler error:</p>\n\n<pre><code>    * Couldn't match expected type `Int' with actual type `Gen a0'\n    * In the second argument of `(+)', namely `choose (0, 1)'\n      In the expression: i + choose (0, 1)\n      In the second argument of `g', namely `(\\ i -&gt; i + choose (0, 1))'\n</code></pre>\n"}, {"tags": ["haskell", "gitlab", "gitlab-ci", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1568919997, "post_id": 58017051, "comment_id": 102438590, "body": "@MarkSeemann If you look at the question details you&#39;ll note that they put <code>.stack-work</code> into the cache option of their CI config, they&#39;re asking why that&#39;s apparently not enough to reliably cache dependencies between CI runs/different stages of the same pipeline"}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1568985354, "post_id": 58017051, "comment_id": 102460603, "body": "Make sure to pass the <code>stack --system-ghc test</code> when running tests, also you don&#39;t need to run a separate <code>stack build</code>, <code>stack test</code> does building already."}], "answers": [{"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 2, "last_activity_date": 1568923782, "creation_date": 1568923782, "answer_id": 58018322, "question_id": 58017051, "link": "https://stackoverflow.com/questions/58017051/gitlab-ci-for-a-haskell-stack-project-how-to-cache-built-libraries/58018322#58018322", "title": "gitlab-CI for a Haskell Stack project: How to cache built libraries?", "body": "<p>Most important for proper caching of a stack project is saving all folders being involved:</p>\n\n<ul>\n<li>Project work directory (or many directories if it is a multi-package setup), usually <code>.stack-work</code></li>\n<li>Global stack directory, usually <code>~/.stack</code></li>\n<li>Possibly a separate folder with binaries (ghc, ghc-pkg, ...)</li>\n</ul>\n\n<p>These can vary between the operating systems and customized with environment variables, but can be easily discovered by asking <code>stack</code> itself. Run <code>stack path</code> within a stack project and you'll see all of the paths that stack might care about. These are the ones you'll need to cache and restore on CI in order to prevent recompilation:</p>\n\n<ul>\n<li><code>stack path --stack-root</code></li>\n<li><code>.stack-work</code> directories in all of the packages within the project (paths from \n<code>packages</code> in <code>stack.yaml</code>)</li>\n<li>on Windows <code>stack path --programs</code></li>\n</ul>\n\n<p>Just in case, if you want to see how this stuff can be derived programmatically from Haskell itself, you can find it <a href=\"https://github.com/fpco/cache-s3/blob/master/src/Network/AWS/S3/Cache/Stack.hs\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I wrote this tool called <a href=\"https://www.fpcomplete.com/blog/2018/02/cache-ci-builds-to-an-s3-bucket\" rel=\"nofollow noreferrer\"><code>cache-s3</code></a> a while back that allows you to use an AWS S3 bucket as cache for your CI and it has separate mode that will save and restore all of the stack related directories. This is probably an overkill for a simple project, so the gitlab's caching mechanism will likely be sufficient, but in case you need it is an option.</p>\n"}, {"comments": [{"owner": {"reputation": 1175, "user_id": 1725547, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lndRe.png?s=128&g=1", "display_name": "Kasper", "link": "https://stackoverflow.com/users/1725547/kasper"}, "edited": false, "score": 0, "creation_date": 1584355498, "post_id": 59056148, "comment_id": 107402564, "body": "I also had to chown the parent folder, stack complains a lot when the stack root folder is owned by a different user than the parent folder of the stack-root folder, fwiw."}], "tags": [], "owner": {"reputation": 61, "user_id": 4126514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe05679f61c8456880ca145ab9621c2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cigarette Smoking Man", "link": "https://stackoverflow.com/users/4126514/cigarette-smoking-man"}, "is_accepted": false, "score": 4, "last_activity_date": 1574788427, "creation_date": 1574788427, "answer_id": 59056148, "question_id": 58017051, "link": "https://stackoverflow.com/questions/58017051/gitlab-ci-for-a-haskell-stack-project-how-to-cache-built-libraries/59056148#59056148", "title": "gitlab-CI for a Haskell Stack project: How to cache built libraries?", "body": "<p>Add these parts to your <code>.gitlab-ci.yml</code>:</p>\n\n<pre><code>variables:\n  STACK_ROOT: \"${CI_PROJECT_DIR}/.stack-root\"\n\ncache:\n  paths:\n    - .stack-work/\n    - .stack-root/\n</code></pre>\n\n<p>The <code>$STACK_ROOT</code> env variable changes the folder stack uses for it's global files. This is required because GitLab CI can only cache files under the project folder, so caching <code>$HOME/.stack</code>, <code>~/.stack</code> or <code>/root/.stack</code> won't work.</p>\n\n<p>A few relevant references from the web:</p>\n\n<ul>\n<li><a href=\"http://blog.braulio.me/2018/10/24/use-haskell-stack-gitlab-ci.html\" rel=\"nofollow noreferrer\">http://blog.braulio.me/2018/10/24/use-haskell-stack-gitlab-ci.html</a>;</li>\n<li><a href=\"https://vadosware.io/post/zero-to-continuous-integrated-testing-a-haskell-project-with-gitlab/\" rel=\"nofollow noreferrer\">https://vadosware.io/post/zero-to-continuous-integrated-testing-a-haskell-project-with-gitlab/</a></li>\n<li><a href=\"https://dev.to/drbearhands/haskell-for-madmen-setup-4cj9\" rel=\"nofollow noreferrer\">https://dev.to/drbearhands/haskell-for-madmen-setup-4cj9</a></li>\n<li><a href=\"https://github.com/bitemyapp/haskell-continuous-integration/blob/master/.gitlab-ci.yml\" rel=\"nofollow noreferrer\">https://github.com/bitemyapp/haskell-continuous-integration/blob/master/.gitlab-ci.yml</a></li>\n</ul>\n"}], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1574788427, "creation_date": 1568917733, "last_edit_date": 1570437148, "question_id": 58017051, "link": "https://stackoverflow.com/questions/58017051/gitlab-ci-for-a-haskell-stack-project-how-to-cache-built-libraries", "title": "gitlab-CI for a Haskell Stack project: How to cache built libraries?", "body": "<p>I'm using the following <code>.gitlab-ci.yml</code> file for setting up gitlab-CI for a Haskell Stack project created with <code>stack new actividad3 --resolver=lts-14.6</code>.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>image: haskell:8.6.5\n\ncache:\n  paths:\n    - .stack\n    - .stack-work\n    - target\n\ntest:\n  stage: test\n  script:\n    - ghc --version\n    - stack --system-ghc build\n    - stack test\n</code></pre>\n\n<p>Building and testing the project last almost 5 minutes. Most of the time is spent building the hspec library. Is there any way to cache the used libraries between pipeline runs?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "types", "polymorphism"], "comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 4, "creation_date": 1568915819, "post_id": 58016489, "comment_id": 102436806, "body": "Is there a specific problem you are trying to solve, or is it more out of curiosity? And what could/would you do with the information &quot;f has no functor insurance&quot;?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1568915934, "post_id": 58016489, "comment_id": 102436846, "body": "It looks like a strange signature. Usually one uses type constraints to use functions that the corresponding classes provide."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1568916628, "post_id": 58016489, "comment_id": 102437128, "body": "I feel like this has been asked before. The short answer is <b>no</b>, this is not possible."}, {"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "edited": false, "score": 0, "creation_date": 1568917337, "post_id": 58016489, "comment_id": 102437465, "body": "I want to compose all Functors to get Functor of a where a is not a Functor. Then I know that I map on bottom Functor."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1568918597, "creation_date": 1568918597, "answer_id": 58017249, "question_id": 58016489, "link": "https://stackoverflow.com/questions/58016489/is-it-possibile-to-negate-type-parameter-constraint-in-haskell/58017249#58017249", "title": "Is it possibile to negate type parameter constraint in Haskell?", "body": "<p>Reasons why this is not possible: (basically all the same reason, just different aspects of it)</p>\n\n<ul>\n<li>There is an <em>open-world assumption</em> about type classes. It isn't possible to prove that a type is not an instance of a class because even if <em>during compilation of a module</em>, the instance isn't there, that doesn't mean somebody doesn't define it in a module \u201cfurther down the road\u201d. This could in principle be in a separate package, such that the compiler can't possibly know whether or not the instance exists.<br>\n(Such <em>orphan instances</em> are generally quite frowned upon, but there are use cases for them and the language doesn't attempt to prevent this.)</li>\n<li>Membership in a class is an <a href=\"https://en.wikipedia.org/wiki/Intuitionistic_logic\" rel=\"noreferrer\">intuitionistic property</a>, meaning that you shouldn't think of it as a classical boolean value \u201cinstance or not instance\u201d but rather, if you can prove that a type is an instance then this gives you certain features for the type (specified by the class methods). If you can't prove that the type is an instance then this doesn't mean <em>there is no</em> instance, but perhaps just that you're not smart enough to prove it. (Read, \u201cperhaps that <em>nobody</em> is smart enough\u201d.)<br>This ties back to the first point: the compiler not yet having the instance available is one case of \u201cnot being smart enough\u201d.</li>\n<li>A class isn't supposed to be used for making dispatch on whether or not a type is in it, but for enabling certain polymorphic functions even if they require ad-hoc conditions on the types. That's what class methods do, and they can come from a class instance, but how could they come from a \u201cnot-in-class instance\u201d?</li>\n</ul>\n\n<hr>\n\n<p>Now, all that said, there <em>is</em> a way you can kind of fake this: with an <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overlapping-instances\" rel=\"noreferrer\">overlapping instance</a>. Don't do it, it's a bad idea, but... that's the closest you can get.</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 58017249, "answer_count": 1, "score": 1, "last_activity_date": 1568918597, "creation_date": 1568915387, "last_edit_date": 1568917164, "question_id": 58016489, "link": "https://stackoverflow.com/questions/58016489/is-it-possibile-to-negate-type-parameter-constraint-in-haskell", "title": "Is it possibile to negate type parameter constraint in Haskell?", "body": "<p>In Haskell, it's possible to add constraints to a type parameter.</p>\n\n<p>For example:</p>\n\n<pre><code>foo :: Functor f =&gt; f a\n</code></pre>\n\n<p><strong>The question:</strong> is it possible to negate a constraint?</p>\n\n<p>I want to say that <code>f</code> can be anything except <code>Functor</code> for example.</p>\n\n<p><strong>UPD:</strong></p>\n\n<p>So it comes from the idea of how to map the bottom nested Functor.\nLet's say I have <code>Functor a</code> where <code>a</code> can be a <code>Functor b</code> or not and the same rules works for <code>b</code>.</p>\n"}, {"tags": ["haskell", "haskell-stack", "nix"], "answers": [{"tags": [], "owner": {"reputation": 70803, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 4, "last_activity_date": 1568924458, "last_edit_date": 1568924458, "creation_date": 1568924131, "answer_id": 58018392, "question_id": 58015660, "link": "https://stackoverflow.com/questions/58015660/how-to-pass-customize-environment-variable-like-password-in-stack-with-nix/58018392#58018392", "title": "How to pass customize environment variable (like password) in stack with nix?", "body": "<p>You can use the <code>builtins.getEnv</code> function in a Nix expression to the value of an environment variable from the external environment, so you could do something like this:</p>\n\n<pre><code>PGPASSWORD = builtins.getEnv \"PGPASSWORD\";\n</code></pre>\n\n<p>This is just one way to set its value.  You could also use <code>import</code> to import a Nix expression file that you never commit to git, or you could use <code>builtins.readFile</code> to read a file that you never commit to git.</p>\n"}], "owner": {"reputation": 85, "user_id": 7213147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34688e226d571c41a85ee5ca520893cc?s=128&d=identicon&r=PG&f=1", "display_name": "R Beckett", "link": "https://stackoverflow.com/users/7213147/r-beckett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 58018392, "answer_count": 1, "score": 3, "last_activity_date": 1583635031, "creation_date": 1568911804, "last_edit_date": 1583635031, "question_id": 58015660, "link": "https://stackoverflow.com/questions/58015660/how-to-pass-customize-environment-variable-like-password-in-stack-with-nix", "title": "How to pass customize environment variable (like password) in stack with nix?", "body": "<p>I'm using stack with nix. I need to pass the environment variable as DB password to connect to Postgres while runtime. Currently, I enabled nix in the YAML and customized my own <code>.nix</code> to put the password in <code>.nix</code>.</p>\n\n<p>stack.yaml:</p>\n\n<pre><code>nix:\n  enable: true\n  pure: true\n  shell-file: shell.nix\n</code></pre>\n\n<p>shell.nix:</p>\n\n<pre><code>{ghc}:\nwith (import &lt;nixpkgs&gt; {});\n\nhaskell.lib.buildStackProject {\n  inherit ghc;\n  name = \"myenv\";\n  buildInputs = [ postgresql_10 ];\n  PGPASSWORD = \"pw\";\n}\n</code></pre>\n\n<p>But when I want to commit the code into GitHub/Gitlab and go to CI/CD pipeline, explicit the password in <code>.nix</code> seems not good. I'd like to know is there a good way to deal with this?</p>\n"}, {"tags": ["list", "function", "haskell", "question-answering", "value-constructor"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1568912075, "post_id": 58015610, "comment_id": 102435196, "body": "So what doesn&#39;t work for you exactly?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1568912113, "post_id": 58015610, "comment_id": 102435209, "body": "Haskell won&#39;t translate between English and... Portuguese? You have to use <code>Yes</code> and <code>No</code> as defined by the <code>data</code> declaration. (Or change to <code>data Question = Sim | Nao deriving Show</code>.)"}, {"owner": {"reputation": 63, "user_id": 10213801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LdfV.jpg?s=128&g=1", "display_name": "Marrows", "link": "https://stackoverflow.com/users/10213801/marrows"}, "edited": false, "score": 0, "creation_date": 1568912400, "post_id": 58015610, "comment_id": 102435330, "body": "Thanks for the answer, but I&#39;m having trouble with the prompt too. I don&#39;t know what to write on it"}, {"owner": {"reputation": 63, "user_id": 10213801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LdfV.jpg?s=128&g=1", "display_name": "Marrows", "link": "https://stackoverflow.com/users/10213801/marrows"}, "edited": false, "score": 0, "creation_date": 1568912501, "post_id": 58015610, "comment_id": 102435385, "body": "Thanks, chepner, I didn&#39;t pay attention"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 1, "creation_date": 1568916663, "post_id": 58015610, "comment_id": 102437149, "body": "@Marrows Check my edited answer please, add your promp issue with details in the question, you can edit it"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 1, "last_activity_date": 1568916630, "last_edit_date": 1568916630, "creation_date": 1568916309, "answer_id": 58016724, "question_id": 58015610, "link": "https://stackoverflow.com/questions/58015610/value-constructors-in-haskell/58016724#58016724", "title": "Value constructors in haskell", "body": "<p>There are several ways to do that, you did it by list comprehension, another way is using map:</p>\n\n<pre><code>listQuest :: [Question] -&gt; [Int]\nlistQuest xs = map questNum  xs\n</code></pre>\n\n<p>shorter</p>\n\n<pre><code>listQuest :: [Question] -&gt; [Int]\nlistQuest  = map questNum  \n</code></pre>\n\n<p>using foldr (it is also a way to say map, indeed you can write the general map using foldr):</p>\n\n<pre><code>listQuest :: [Question] -&gt; [Int]\nlistQuest = foldr (\\x rs -&gt; questNum x : rs) []\n</code></pre>\n\n<p>and the old good pattern matching (is map, but with pattern matching):</p>\n\n<pre><code>listQuest :: [Question] -&gt; [Int]\nlistQuest []  = []\nlistQuest (x:xs) = questNum x : listQuest xs  \n</code></pre>\n\n<p>your way, and all of this, are equivalent.</p>\n\n<blockquote>\n  <p>On the prompt:</p>\n</blockquote>\n\n<p>Then on the prompt you type something like:</p>\n\n<pre><code>$&gt; :l file_name.hs\n$&gt; listQuest [Yes, Yes, No]\n$&gt; [1,1,0]\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10213801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LdfV.jpg?s=128&g=1", "display_name": "Marrows", "link": "https://stackoverflow.com/users/10213801/marrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58016724, "answer_count": 1, "score": 1, "last_activity_date": 1568917305, "creation_date": 1568911627, "last_edit_date": 1568917305, "question_id": 58015610, "link": "https://stackoverflow.com/questions/58015610/value-constructors-in-haskell", "title": "Value constructors in haskell", "body": "<p>I have a question about Haskell. I'm new so I don't understand too well, but if anyone could help me I'd really appreciate. I have this exercise from a book that I bought.</p>\n\n<blockquote>\n  <p>Create a type <em>Question</em> with value contructors <em>Sim</em> or <em>Nao</em>. Make a\n  function that: </p>\n</blockquote>\n\n<ul>\n<li>listQuest: receive from a parameter a list of <em>Questions</em> and return <em>0</em> for <em>Nao</em> or <em>1</em> for <em>Sim</em> corresponding the constructors in the list.</li>\n</ul>\n\n<p>I tried this code:</p>\n\n<pre><code>module Question where \n\ndata Question = Yes | No deriving Show\n\nquestNum :: Question -&gt; Int\nquestNum No = 0\nquestNum Yes = 1\n\nlistQuest :: [Question] -&gt; [Int]\nlistQuest listQuestion =  [ questNum quest | quest &lt;- listQuestion ]\n</code></pre>\n\n<p>I'm lost in the prompt matter. Don't know what to write to use the function.</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["templates", "haskell"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1568920997, "post_id": 58012918, "comment_id": 102438994, "body": "A simple solution that still requires some runtime deserialisation is to emit a <code>StringL</code> of the result of <code>show</code> on <code>parsed</code>, and emit a call to <code>read</code> rather than <code>parseNarration</code>. It\u2019d be better to directly emit the Haskell code that would construct <code>parsed</code> itself (i.e., the result of <code>Show</code>, but not serialised as a string)\u2014you could easily write a function <code>Narration -&gt; Q Exp</code> that generates that, but I don\u2019t know offhand how to do so conveniently/generically."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1568921117, "post_id": 58012918, "comment_id": 102439034, "body": "Also you don\u2019t need <code>unsafePerformIO</code> here, there\u2019s <a href=\"https://hackage.haskell.org/package/template-haskell-2.15.0.0/docs/Language-Haskell-TH.html#v:runIO\" rel=\"nofollow noreferrer\"><code>runIO :: IO a -&gt; Q a</code></a> for embedding I/O in splices."}], "owner": {"reputation": 359, "user_id": 2649762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8574838cef0a260ea45417d364e002b6?s=128&d=identicon&r=PG", "display_name": "user2649762", "link": "https://stackoverflow.com/users/2649762/user2649762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1568902102, "creation_date": 1568902102, "question_id": 58012918, "link": "https://stackoverflow.com/questions/58012918/how-to-parse-a-string-into-a-code-structure-with-templatehaskell", "title": "How to parse a string into a code structure with TemplateHaskell?", "body": "<p>Right now, I have the following piece of code in my project:</p>\n\n<pre><code>embedNarration :: String -&gt; Q Exp\nembedNarration file = \n    let text = unsafePerformIO $ readFile file\n        parsedMaybe = parseNarration  text\n        succ x = case x of\n          Left x -&gt; throw $ ErrorCall x\n          Right x' -&gt; x'\n        parsed = succ parsedMaybe\n        res = do parser &lt;- [|((fromRight undefined) . parseNarration)|]\n                 d &lt;- return $ seq parsed text\n                 return $ AppE parser $! LitE $! StringL d\n    in res\n</code></pre>\n\n<p>Which is jury-rigged from Data.FileEmbed module's source code. The intention of the code is to generate a Narration (which is a data structure defined in-code) from a resource file. </p>\n\n<p>Right now this quite ugly piece that I don't fully understand tries to parse the resource file; throws a compile-time error if the parse is unsuccessful; or, if the parse is successful, embeds the following piece into the source code:</p>\n\n<pre><code>((fromRight undefined) . parseNarration $ \"THE ENTIRE RESOURCE FILE\")\n</code></pre>\n\n<p>Where parseNarration is a function <code>:: String -&gt; Either String Narration</code></p>\n\n<p>The problem here is the double parsing - the resource file is parsed once during compile time to ensure it's valid, and then the second time during runtime from a string literal. Ideally, I want to, instead of a string literal and a call to the parser, for TemplateHaskell to directly substitute a Narration, so that the parser would only exist during compile-time. But I have no idea how to do this. Surface-level guides to TemplateHaskell and trying to jury-rigg the code further haven't been successful. Is it possible to do? If yes, how?</p>\n"}, {"tags": ["haskell", "optimization", "fibonacci"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1568901843, "post_id": 58012505, "comment_id": 102429803, "body": "As an aside, while it wasn&#39;t what you were asking if you wanted to write an efficient recursive definition you could try something like <code>fibs = fibs&#39; 0 1 where fibs&#39; x y = y : fibs&#39; y (x + y)</code>; This is more or less the same as the <code>zipWith</code> version but might be a bit easier to understand."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1568913600, "post_id": 58012505, "comment_id": 102435854, "body": "There is another solution that is completely different from this one. Note that <code>fib n = round $ phi ^ n &#47; sqrt 5 where phi = (1 + sqrt 5)&#47;2</code>. With some algebra, you can turn this into a formula for <code>n</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1568902182, "post_id": 58012755, "comment_id": 102430001, "body": "Also <code>stepper</code> function calls <code>fibGen</code> at every recursion call. So <code>stepper 5</code> will call <code>fibGen 5</code> in the first guard, and then call <code>stepper 6</code> which will call <code>fibGen 6</code> without memoizing <code>fibGen 5</code> which is needed for <code>fibGen 6</code>. So is not only the exponential branches in <code>fibGen</code> but also all duplicate computation in <code>stepper</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1568905748, "post_id": 58012755, "comment_id": 102432165, "body": "@Shadesfear Can read up on the topic of memoization for more."}, {"owner": {"reputation": 663, "user_id": 11118251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUR0V.jpg?s=128&g=1", "display_name": "Shadesfear", "link": "https://stackoverflow.com/users/11118251/shadesfear"}, "edited": false, "score": 0, "creation_date": 1568973329, "post_id": 58012755, "comment_id": 102454412, "body": "Thanks guy for the answer and comments, this is exactly what i needed! It&#39;s gonna be something I will think about in the future"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1568902355, "last_edit_date": 1568902355, "creation_date": 1568901597, "answer_id": 58012755, "question_id": 58012505, "link": "https://stackoverflow.com/questions/58012505/slow-solution-to-project-euler-25-using-haskell/58012755#58012755", "title": "Slow solution to project euler 25 using haskell", "body": "<blockquote>\n  <p>So my question is what is wrong in the first approach that is making it so slow.</p>\n</blockquote>\n\n<p>Your first approach has an infinite loop in the difinition of <code>stepper</code>, but nevertheless, even if there was no infinite loop it would take a considerable amount of time, due to the exponential branching strategy.</p>\n\n<hr>\n\n<p>Your first approach results in exponential recursion. Indeed, except for the two base cases, all other cases will result in two extra calls:</p>\n\n<pre><code>fibGen :: Int -&gt; Int\nfibGen 0 = 0\nfibGen 1 = 1\nfibGen n = <b>fibGen (n-1)</b> + <b>fibGen (n-2)</b></code></pre>\n\n<p>So this means that for <code>fibGen 5</code> for example, we will evaluate this as:</p>\n\n<pre><code>fibGen 5\n  - fibGen 4\n    - fibGen 3\n      - fibGen 2\n        - fibGen 1\n        - fibGen 0\n      - fibGen 1\n    - fibGen 2\n      - fibGen 1\n      - fibGen 0\n  - fibGen 3\n    - fibGen 2\n      - fibGen 1\n      - fibGen 0\n    - fibGen 1\n</code></pre>\n\n<p>So in order to calculate <code>fibGen 5</code>, we thus will make a total of 15 calls. One for <code>fibGen 4</code>, two for <code>fibGen 3</code>, three for <code>fibGen 2</code>, five for <code>fibGen 1</code>, and three for <code>fibGen 0</code>.</p>\n\n<p>Each time we increment <code>n</code>, we will almost double the amount of calls. It is clear that for a large <code>n</code>, the number of calls is that huge that a modern machine can still not process it.</p>\n\n<p>Furthermore your <code>stepper</code> function is defined as an infinite loop. Indeed, a more verbose variant of your function is:</p>\n\n<pre><code><b>stepper n</b>\n  | length (show ( fibGen n )) &gt;= 1000 = n\n  | otherwise = (<b>stepper n</b>) + 1</code></pre>\n\n<p>So that means that if you calculate <code>stepper n</code>, and the constraint fails, you call <code>stepper n</code> again, and you will later add <code>1</code> to that result, but you thus get stuck in an infinite loop.</p>\n\n<p>You can fix this by adding parenthesis:</p>\n\n<pre><code><b>stepper n</b>\n  | length (show ( fibGen n )) &gt;= 1000 = n\n  | otherwise = stepper <b>(</b>n + 1<b>)</b></code></pre>\n\n<p>Now eventually the program will terminate, but it will take a lot of time, due to the branching in the recursive definition. Note that each time you call <code>fibGen</code>, it will again branch, so that means that even if we fix the infinite loop, if we have called <code>fibGen 5</code>, then if we later call <code>fibGen 6</code>, we will do all the work again to calculate <code>fibGen 5</code> to calculate <code>fibGen 6</code>. We thus do not use memoization here.</p>\n\n<hr>\n\n<p>Your second fibonacci program on the other hand generates a list, and it reuses the results in the list. <code>fib</code> will thus evaluate as:</p>\n\n<pre><code>   0 : 1 : zipWith &hellip;\n-> 0 : 1 : 1 : zipWith &hellip;\n-> 0 : 1 : 1 : 2 : zipWith &hellip;\n-> 0 : 1 : 1 : 2 : 3 : zipWith &hellip;\n-> 0 : 1 : 1 : 2 : 3 : 5 : zipWith &hellip;</code></pre>\n\n<p>So this will not suffer from branching, since it <em>reuses</em> results that are already in the list.</p>\n"}], "owner": {"reputation": 663, "user_id": 11118251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUR0V.jpg?s=128&g=1", "display_name": "Shadesfear", "link": "https://stackoverflow.com/users/11118251/shadesfear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 58012755, "answer_count": 1, "score": 2, "last_activity_date": 1587694964, "creation_date": 1568900765, "last_edit_date": 1587694964, "question_id": 58012505, "link": "https://stackoverflow.com/questions/58012505/slow-solution-to-project-euler-25-using-haskell", "title": "Slow solution to project euler 25 using haskell", "body": "<p>I am new to the Haskell language, and to learn I thought i would jump into some Project Euler. In <a href=\"https://projecteuler.net/problem=25\" rel=\"nofollow noreferrer\">Project Euler 25</a> we are tasked with doing the following: </p>\n\n<p><strong>The 12th term, F12, is the first term to contain three digits.\nWhat is the index of the first term in the Fibonacci sequence to contain 1000 digits?</strong></p>\n\n<p>And this is my solution to the problem: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fibGen :: Int -&gt; Int\nfibGen 0 = 0\nfibGen 1 = 1\nfibGen n = fibGen (n-1) + fibGen (n-2)\n\nstepper n\n  | length (show ( fibGen n )) &gt;= 1000 = n\n  | otherwise = stepper n + 1\n</code></pre>\n\n<p>Here <code>n</code> is just the starting point of the sequence. But this approach is incredibly slow, it had run over an hour before I decided to try another approach. Then I found another solution which is the following: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fibs = 0:1:(zipWith (+) fibs (tail fibs))\nt = 10^999\n\nproblem_25 = length w\n    where\n      w = takeWhile (&lt; t) fibs\n</code></pre>\n\n<p>And this is incredibly fast. </p>\n\n<p>So my question is what is wrong in the first approach that is making it so slow.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 4, "creation_date": 1568897098, "post_id": 58011063, "comment_id": 102426764, "body": "The type variables bound in the data definition are not visible in the definition of the constructors. Change it to <code>A&#39; :: forall c a. c a =&gt; { unA :: a } -&gt; A&#39; c</code>"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 1, "creation_date": 1568897238, "post_id": 58011063, "comment_id": 102426855, "body": "Also note that this can be made into a newtype!"}, {"owner": {"reputation": 23, "user_id": 12089289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb08ea22bfe78091de51221bb441ee24?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#246;rn Gohla", "link": "https://stackoverflow.com/users/12089289/bj%c3%b6rn-gohla"}, "reply_to_user": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1568897544, "post_id": 58011063, "comment_id": 102427026, "body": "thanks for your suggestion. i do want <code>A&#39;</code> to be of kind <code>A&#39; :: Constraint -&gt; Type</code> though. with your suggestion it would be seem to be of kind <code>A&#39; :: Type</code>, right?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 1, "creation_date": 1568899470, "post_id": 58011063, "comment_id": 102428325, "body": "@sara I ended up writing your comments into an answer, it probably makes more sense than try to answer it in the comments"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1568900214, "post_id": 58011063, "comment_id": 102428779, "body": "@Cubic that&#39;s fine, I&#39;m on a phone right now, so not really set up for writing a good full answer with formatting and stuff anyway!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12089289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb08ea22bfe78091de51221bb441ee24?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#246;rn Gohla", "link": "https://stackoverflow.com/users/12089289/bj%c3%b6rn-gohla"}, "edited": false, "score": 0, "creation_date": 1568905718, "post_id": 58011668, "comment_id": 102432149, "body": "the unusability of <code>unPack</code> is big bummer though"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 23, "user_id": 12089289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb08ea22bfe78091de51221bb441ee24?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#246;rn Gohla", "link": "https://stackoverflow.com/users/12089289/bj%c3%b6rn-gohla"}, "edited": false, "score": 2, "creation_date": 1568906563, "post_id": 58011668, "comment_id": 102432653, "body": "@Bj&#246;rnGohla That just comes with the territory because the type signature of <code>unPack</code> would have to depend on the exact constructor used - that&#39;s why I showed you the <code>withPacked</code> function which, like I said, pretty much encapsulates the only useful thing you can do with this datatype."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 6, "last_activity_date": 1568899227, "last_edit_date": 1568899227, "creation_date": 1568898289, "answer_id": 58011668, "question_id": 58011063, "link": "https://stackoverflow.com/questions/58011063/can-i-generalize-over-class-constraints-in-haskell/58011668#58011668", "title": "Can I generalize over class constraints in Haskell?", "body": "<p>You got it almost right, what you want is</p>\n\n<pre><code>data HasConstraint (c :: Type -&gt; Constraint) where\n  Pack :: forall (c :: Type -&gt; Constraint) a . c a =&gt; { unPack :: a } -&gt; HasConstraint c\n</code></pre>\n\n<p>so you have to include <code>c</code> as inside your constructor type signature as well because it's completely separate from the data declaration for GADTs.</p>\n\n<p>I imagine you'd want to use it like this:</p>\n\n<pre><code>instance Show (HasConstraint Show) where show (Pack x) = show x\nshow (Pack 10 :: HasConstraint Show) -- =&gt; \"10\"\n</code></pre>\n\n<p>You could also write</p>\n\n<pre><code>withPacked :: forall (c :: Type -&gt; Constraint) b. (forall a. c a =&gt; a -&gt; b) -&gt; HasConstraint c -&gt; b\nwithPacked f (Pack x) = f x\nwithPacked @Show show (Pack 10) -- =&gt; \"10\"\n</code></pre>\n\n<p>I'm not sure if there's much else you can do with this though.</p>\n\n<hr>\n\n<p>(Note that the \"getter\" <code>unPack</code> here actually isn't usable with GADTs either, you'll always have to pattern match on the constructor if you want to actually unpack things).</p>\n"}], "owner": {"reputation": 23, "user_id": 12089289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb08ea22bfe78091de51221bb441ee24?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#246;rn Gohla", "link": "https://stackoverflow.com/users/12089289/bj%c3%b6rn-gohla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58011668, "answer_count": 1, "score": 2, "last_activity_date": 1568899227, "creation_date": 1568896122, "question_id": 58011063, "link": "https://stackoverflow.com/questions/58011063/can-i-generalize-over-class-constraints-in-haskell", "title": "Can I generalize over class constraints in Haskell?", "body": "<p>In my application I have a type definition that looks like this:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\nclass C a where\n\ndata A = forall a. C a =&gt; A { unA :: a }\n</code></pre>\n\n<p>I most definitely want the kind signature <code>A :: Type</code>.</p>\n\n<p>I would like to generalize over the class constraint, like so:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE GADTs                     #-}\n{-# LANGUAGE KindSignatures            #-}\n{-# LANGUAGE ScopedTypeVariables       #-}\n\nimport Data.Kind (Type, Constraint)\n\nclass C a where\n\ndata A' (c :: Type -&gt; Constraint) where\n  A' :: forall a. c a =&gt; { unA :: a } -&gt; A' c\n\ntype A = A' C\n</code></pre>\n\n<p>Note that <code>A</code> should be isomorphic to the <code>A</code> as defined in the beginning.</p>\n\n<p>However GHC (8.6.5) rejects the generalized definition:</p>\n\n<pre><code>\ngeneralize.hs:11:19: error: Not in scope: type variable \u2018c\u2019\n   |\n11 |   A' :: forall a. c a =&gt; { unA :: a } -&gt; A' c\n   |                   ^\n\ngeneralize.hs:11:45: error: Not in scope: type variable \u2018c\u2019\n   |\n11 |   A' :: forall a. c a =&gt; { unA :: a } -&gt; A' c\n   |                                             ^\n</code></pre>\n\n<p>I don't understand the error, since I did enable <code>ScopedTypeVariables</code>.</p>\n\n<p>Am I missing something obvious, or is what I'm trying to do not possible? If so, why not?</p>\n"}]