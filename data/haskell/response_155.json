[{"tags": ["haskell", "polymorphism", "ghc", "data-conversion", "type-level-computation"], "comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1514409572, "post_id": 47998603, "comment_id": 82965890, "body": "Note that <code>Iso&#39;</code> and <code>Prism&#39;</code> by the <code>lens</code> library implement isomorphisms and embeddings, the latter of which also allow going <code>Maybe</code> back. An iso and a prism can even be composed, as functions, into a prism!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514412603, "post_id": 47998603, "comment_id": 82966899, "body": "Note that all the isomorphisms mentioned above do <i>not</i> involve polymorphic types, in contrast with the title. Indeed, there is no <code>forall</code> in such types. A polymorphic iso could be e.g. Yoneda&#39;s <code>(forall r. (a-&gt;r)-&gt;r) &lt;~&gt; a</code>. However, the above isos are between monomorphic simple types, parameterized over a few type variables."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1514416121, "post_id": 47998603, "comment_id": 82967837, "body": "<a href=\"https://stackoverflow.com/q/39417445/791604\">Related</a>. Even if you get over this hurdle, you&#39;re going to find there&#39;s others to follow, e.g. normalizing both <code>((), a)</code> and <code>(a, ())</code> to the normalization of <code>a</code> in a sensible way. I wouldn&#39;t be surprised if there were further hurdles beyond. If this is just an exercise, have fun; but if you plan to use this for something, have you considered making the isomorphisms more explicit and only using the typeclass mechanism for stuff that it&#39;s good at...?"}, {"owner": {"reputation": 131, "user_id": 4108839, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u3r9Hd2y9y8/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckhyIsYzernILdGTfK66_1DRHcLog/s96-c/photo.jpg?sz=128", "display_name": "Benjamin Berger", "link": "https://stackoverflow.com/users/4108839/benjamin-berger"}, "edited": false, "score": 0, "creation_date": 1514455076, "post_id": 47998603, "comment_id": 82978782, "body": "My motivation was that I wanted to compose morphisms in a non-strict monoidal category where the codomain of the first morphism is not the domain of the second, but is naturally isomorphic to it via some combination of the associator and the unitors and their inverses. Then I got carried away a little bit and included the other conversions. For my original problem, it is acceptable to wrap all &quot;elementary&quot; objects into Identity functors, because I can define the morphisms generating the monoidal category to expect these and then I do not have to care about them when composing the morphisms."}, {"owner": {"reputation": 131, "user_id": 4108839, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u3r9Hd2y9y8/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckhyIsYzernILdGTfK66_1DRHcLog/s96-c/photo.jpg?sz=128", "display_name": "Benjamin Berger", "link": "https://stackoverflow.com/users/4108839/benjamin-berger"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514456167, "post_id": 47998603, "comment_id": 82979395, "body": "@chi: I didn&#39;t mean to say the isomorphisms would involve polymorphic types, but rather that I want to convert between polymorphic types using these isomorphisms. A polymorphic type <i>is</i> a type parameterized by type variable, or example the type of <code>2 :: forall a. (Num a)=&gt;a</code>, Yoneda&#39;s iso has already a rank-2-type. If I used <code>2</code> in the type I want to convert in a place that the recursion descends to, it would yield an ambiguity error, because it is polymorphic and the type variable might be instantiated to something that the recursion could further descend into (e.g. a <code>Num</code> inst for pairs)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514457486, "post_id": 47998603, "comment_id": 82980081, "body": "@BenjaminBerger Maybe it&#39;s just a matter of terminology, and it&#39;s not that important, but I&#39;d think you want a polymorphic isomorphism (or, if you prefer, a natural isomorphism), rather than an isomorphism between polymorphic types (which would be higher ranked, as you mentioned). Anyway, the text of the question is clear, and mine is only a very minor point about terminology."}], "owner": {"reputation": 131, "user_id": 4108839, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u3r9Hd2y9y8/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckhyIsYzernILdGTfK66_1DRHcLog/s96-c/photo.jpg?sz=128", "display_name": "Benjamin Berger", "link": "https://stackoverflow.com/users/4108839/benjamin-berger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514408452, "creation_date": 1514408452, "question_id": 47998603, "link": "https://stackoverflow.com/questions/47998603/haskell-conversions-of-polymorphic-types", "title": "Haskell: Conversions of polymorphic types", "body": "<p>I wanted to write a library that can convert types between various isomorphic formats and from \"subtypes\" to \"supertypes\", for example using the following isomorphisms and injections:</p>\n\n<p><code>(a, (b, c))</code> &lt;~> <code>((a, b), c)</code> </p>\n\n<p><code>(Either a (Either b c))</code> &lt;~> <code>(Either (Either a b) c)</code> </p>\n\n<p><code>(a, ())</code> &lt;~> <code>a</code> &lt;~> <code>((), a)</code></p>\n\n<p><code>(Either a Void)</code> &lt;~> <code>a</code> &lt;~> <code>(Either Void a)</code></p>\n\n<p><code>(a, Void)</code> &lt;~> <code>Void</code> &lt;~> <code>(Void, a)</code></p>\n\n<p><code>((a, b) -&gt; c)</code> &lt;~> <code>a -&gt; (b -&gt; c)</code></p>\n\n<p><code>(() -&gt; c)</code> &lt;~> c</p>\n\n<p><code>(a, Either x y)</code> &lt;~> <code>Either (a, x) (a, y)</code></p>\n\n<p><code>(Either x y, a)</code> &lt;~> <code>Either (x, a) (y, a)</code></p>\n\n<p><code>a</code> ~> <code>x -&gt; a</code> (Constant function)</p>\n\n<p><code>Int</code> ~> <code>Integer</code></p>\n\n<p><code>Int</code> ~> <code>Double</code></p>\n\n<p><code>a</code> ~> <code>()</code></p>\n\n<p>\u2026 and nested combinations of that.</p>\n\n<p>It works (by transforming the input type into a canonical isomorphic form, deeply applying the subtype injections and than de-canonicalizing to the result type), but mostly only for monotypes. Using a polymorphic type in a position that is reachable in the tree of type constructors going only through the constructors <code>(-&gt;)</code>, <code>Either</code> and <code>(,)</code> will lead to an \"Ambiguous Type\" error message because the overlapping type classes that determine which transformations are applied cannot be resolved, and that is good, because the type variable <em>could</em> possibly be instantiated to for example a pair type, and ignoring this would make the whole transformation incoherent.</p>\n\n<p>How can I constrain a Type variable to be neither of the form <code>(a -&gt; b)</code> nor of the form <code>(a, b)</code> nor of the form <code>(Either a b)</code>? I tried this:</p>\n\n<pre><code>class BinaryTC tc x (r::Bool) a b | tc x a b -&gt; r\ninstance {-# OVERLAPPING #-} (r~'False) =&gt; BinaryTC tc (tc a b) r a b\ninstance {-# OVERLAPPABLE #-} (r~'True) =&gt; BinaryTC tc x r a b\n\ntype NotHaskGenerating x = (\n  ForallV (BinaryTC (,) x 'False),\n  ForallV (BinaryTC (-&gt;) x 'False),\n  ForallV (BinaryTC Either x 'False)\n )\n</code></pre>\n\n<p>in order to constrain the polymorphic type variables, but it does not work, not even in the canonicalization stage. This is because the information contained in a <code>ForallV</code> constraint is apparently only available by instantiating it via the <code>instV</code> function, and this must be done manually at the expression level. Is there any way to teach GHC to automatically use the information of a <code>Forall</code> constraint? An alternative would be to wrap each value in the <code>Identity</code> functor, but I would prefer to be able to put a constraint on the variables.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514399566, "post_id": 47996905, "comment_id": 82962094, "body": "Are you familiar with <code>Data.Dynamic</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1514402657, "post_id": 47997256, "comment_id": 82963315, "body": "This proposal uses <code>String</code> as a poor man&#39;s <code>Data.Dynamic.Dynamic</code> and parse (<code>readMaybe</code>) in place of an explicit <code>TypeRep</code>.   It&#39;s a good strategy if the data is in string form to start with, but if the data is actually a Haskell value then calling <code>show</code> just to unify the types is a bit clumsy."}], "tags": [], "owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "is_accepted": false, "score": 2, "last_activity_date": 1514400869, "creation_date": 1514400869, "answer_id": 47997256, "question_id": 47996905, "link": "https://stackoverflow.com/questions/47996905/haskell-function-application-on-wrapped-data/47997256#47997256", "title": "Haskell: Function Application on Wrapped Data", "body": "<p><code>readMaybe</code> is in the <code>Text.Read</code> package. I would try to read an input, and if returns <code>Nothing</code> try to parse another type. You must to keep an order to do so. For instance, first <code>Int</code>, then <code>Bool</code>, etc.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.10.1.0/docs/Text-Read.html#v:readMaybe</a></p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514435006, "post_id": 47997509, "comment_id": 82971568, "body": "Why are you using <code>unsafeCoerce</code>? The classic <code>Box</code> is <code>data Box = forall a. Typeable a =&gt; Box a</code>, which lets you use <code>cast</code>, <code>eqT</code>, or <code>gcast</code> to do the job properly. Yes, those are ultimately built on <code>unsafeCoerce</code> (in the implementation of <code>Data.Typeable</code>), but none of that should concern users. Something more like your style of box can be written properly using the new <code>Type.Reflection</code>, if you prefer that."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514436320, "post_id": 47997509, "comment_id": 82971853, "body": "Indeed, and I use the reflection module, implicitly, in the version using dynamic."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 4, "last_activity_date": 1514434202, "last_edit_date": 1514434202, "creation_date": 1514402249, "answer_id": 47997509, "question_id": 47996905, "link": "https://stackoverflow.com/questions/47996905/haskell-function-application-on-wrapped-data/47997509#47997509", "title": "Haskell: Function Application on Wrapped Data", "body": "<p>What I <em>think</em> you are asking for is entirely non-idiomatic.  I'm going to present an answer that you should never use because if it is what you want then you are solving the problem the wrong way.</p>\n\n<p><strong>A Bad But Fun Solution</strong></p>\n\n<p><em>Overview:</em> We will be constructing boxes - values of <em>any</em> type.  These boxes will carry both the value and a type representation we can use for equality checks to ensure our function applications and return types are all correct.  We then manually check the type representations (values that represent the types, which were lost at compile time) before applying the function.  Remember the function and the argument types are opaque - they've been erased at compile time - so we need to use the sinful function <code>unsafeCoerce</code>.</p>\n\n<p>So to start with we need existential types, typeable and unsafe coerce:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE TypeApplications #-}\nimport Data.Typeable\nimport Unsafe.Coerce\n</code></pre>\n\n<p>The Box is our existential:</p>\n\n<pre><code>data Box = forall a. Box (TypeRep, a)\n</code></pre>\n\n<p>If we were making a module with a safe API we'd want to make a smart constructor:</p>\n\n<pre><code>-- | Convert a type into a \"box\" of the value and the value's type.\nmkBox :: Typeable a =&gt; a -&gt; Box\nmkBox a = Box (typeOf a, a)\n</code></pre>\n\n<p>Your <code>exec</code> function now doesn't need to take a list of this ugly sum type (<code>Data</code>) but can instead take a list of boxes and the function, in the form of a box, then apply each argument to the function one at a time to obtain the result.  Notice the caller needs to statically know the return type - signified by the Proxy argument - or else we'd have to return a Box as the result which is pretty useless.</p>\n\n<pre><code>exec :: Typeable a\n     =&gt; [Box] -- ^ Arguments\n     -&gt; Box   -- ^ Function\n     -&gt; Proxy a\n     -&gt; Either String a\nexec [] (Box (fTy,f)) p\n    | fTy == typeRep p = Right $ unsafeCoerce f\n    -- ^^ The function is fully applied. If it is the type expected\n    --    by the caller then we can return that value.\n    | otherwise        = Left \"Final value does not match proxy type.\"\nexec ((Box (aTy,a)):as) (Box (fTy,f)) p\n    | Just appliedTy &lt;- funResultTy fTy aTy = exec as (Box (appliedTy, (unsafeCoerce f) (unsafeCoerce a))) p\n    -- ^^ There is at least one more argument\n    | otherwise = Left \"Some argument was the wrong type. XXX we can thread the arg number through if desired\"\n    -- ^^ The function expected a different argument type _or_ it was fully applied (too many argument supplied!)\n</code></pre>\n\n<p>We can test the three outcomes simply:</p>\n\n<pre><code>main :: IO ()\nmain =\n  do print $ exec [mkBox (1::Int), mkBox (2::Int)] (mkBox ( (+) :: Int -&gt; Int -&gt; Int)) (Proxy @Int)\n     print $ exec [mkBox (1::Int)] (mkBox (last :: [Int] -&gt; Int)) (Proxy @Int)\n     print $ exec [mkBox (1::Int)] (mkBox (id :: Int -&gt; Int)) (Proxy @Double)\n</code></pre>\n\n<p>Yielding:</p>\n\n<pre><code>Right 3\nLeft \"Some argument was the wrong type. XXX we can thread the arg number through if desired\"\nLeft \"Final value does not match proxy type.\"\n</code></pre>\n\n<p>EDIT: I should mention that <code>Box</code> and this API is more educational and less concise than needed since you can use <code>Data.Dynamic</code>.  For example (I changed up the API too since proxy can be inferred):</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE GADTs #-}\nimport Data.Dynamic\nimport Type.Reflection\n\ntype Box = Dynamic\n\n-- | Convert a type into a \"box\" of the value and the\n-- value's type.\nmkBox :: Typeable a =&gt; a -&gt; Box\nmkBox = toDyn\n\nexec :: Typeable a\n     =&gt; [Box]  -- ^ Arguments\n     -&gt; Box    -- ^ Function\n     -&gt; Either String a\nexec [] f = case fromDynamic f of\n                Just x -&gt; Right x\n                Nothing -&gt; Left \"Final type did not match proxy\"\nexec (a:as) f\n    | Just applied &lt;- dynApply f a = exec as applied\n    | otherwise = Left \"Some argument was the wrong type. XXX we can thread the arg number through if desired\"\n\n\nmain :: IO ()\nmain =\n  do print ( exec [mkBox (1::Int), mkBox (2::Int)] (mkBox ( (+) :: Int -&gt; Int -&gt; Int)) :: Either String Int)\n     print ( exec [mkBox (1::Int)] (mkBox (last :: [Int] -&gt; Int)) :: Either String Int)\n     print ( exec [mkBox (1::Int)] (mkBox (id :: Int -&gt; Int)) :: Either String Double)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514435797, "post_id": 47999338, "comment_id": 82971733, "body": "You don&#39;t need to use <code>FlexibleInstances</code> if you don&#39;t want to. You can instead add an auxiliary class <code>class Arg a where exec&#39; :: Function r =&gt; (a -&gt; r) -&gt; [Data] -&gt; Either Error Data</code> and then use the instance <code>instance (Arg a, Function r) =&gt; Function (a -&gt; r) where exec = exec&#39;</code>."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1514413425, "creation_date": 1514413425, "answer_id": 47999338, "question_id": 47996905, "link": "https://stackoverflow.com/questions/47996905/haskell-function-application-on-wrapped-data/47999338#47999338", "title": "Haskell: Function Application on Wrapped Data", "body": "<p>Here's one approach that uses type classes with one extension.</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n</code></pre>\n\n<p>The idea is to define <code>exec</code> within a <code>Function</code> type class:</p>\n\n<pre><code>data Data = DInt Int | DBool Bool | DChar Char deriving (Show)\ndata Error = TypeError String Data | MissingArg String | ExtraArgs\n           deriving (Show)\n\nclass Function a where\n  exec :: a -&gt; [Data] -&gt; Either Error Data\n</code></pre>\n\n<p>and then define a pair of instances for each <code>Data</code> constructor, one to type-check and apply an argument of that type, recursively evaluating <code>exec</code> to move on to the remaining arguments:</p>\n\n<pre><code>instance Function r =&gt; Function (Int -&gt; r) where\n  exec f (DInt x : xs) = exec (f x) xs\n  exec _ (     y : xs) = Left $ TypeError \"DInt\" y\n  exec _ []            = Left $ MissingArg \"DInt\"\n</code></pre>\n\n<p>and another to handle a \"final value\" of that type:</p>\n\n<pre><code>instance Function Int where\n  exec x [] = Right (DInt x)\n  exec _ _  = Left ExtraArgs\n</code></pre>\n\n<p>You need similar boilerplate for <code>Bool</code> and <code>Char</code> and all your other supported types.  (Actually, much of this boilerplate can probably be removed with some helper functions and/or perhaps by introducing a second <code>DataType</code> typeclass with <code>Int</code>, <code>Bool</code>, and <code>Char</code> instances, but I haven't worked that out.)</p>\n\n<pre><code>instance Function r =&gt; Function (Bool -&gt; r) where\n  exec f (DBool x : xs) = exec (f x) xs\n  exec _ (      y : xs) = Left $ TypeError \"DBool\" y\n  exec _ []             = Left $ MissingArg \"DBool\"\ninstance Function Bool where\n  exec x [] = Right (DBool x)\n  exec _ _  = Left ExtraArgs\n\ninstance Function r =&gt; Function (Char -&gt; r) where\n  exec f (DChar x : xs) = exec (f x) xs\n  exec _ (      y : xs) = Left $ TypeError \"DChar\" y\n  exec _ []             = Left $ MissingArg \"DChar\"\ninstance Function Char where\n  exec x [] = Right (DChar x)\n  exec _ _  = Left ExtraArgs\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>&gt; exec f [DInt 1, DInt 2]\nRight (DInt 3)\n&gt; exec g [DBool True, DInt 1, DInt 0]\nRight (DInt 1)\n&gt; exec f [DInt 1, DChar 'a']\nLeft (TypeError \"DInt\" (DChar 'a'))\n&gt; exec f [DInt 1]\nLeft (MissingArg \"DInt\")\n&gt; exec f [DInt 1, DInt 2, DInt 3]\nLeft ExtraArgs\n&gt; \n</code></pre>\n\n<p>Perhaps surprisingly, <code>exec</code> itself wraps these functions into the same type, so you can write:</p>\n\n<pre><code>&gt; let myFunctions = [exec f, exec g]\n&gt; :t myFunctions\nmyFunctions :: [[Data] -&gt; Either Error Data]\n&gt; (myFunctions !! 0) [DInt 1, DInt 2]\nRight (DInt 3)\n&gt; \n</code></pre>\n\n<p>which allows you to manipulate these functions as first class values of type <code>[Data] -&gt; Either Error [Data]</code>.</p>\n"}], "owner": {"reputation": 333, "user_id": 5863981, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/TU6uQ.jpg?s=128&g=1", "display_name": "TheJohnMajor01", "link": "https://stackoverflow.com/users/5863981/thejohnmajor01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1514434202, "creation_date": 1514398938, "question_id": 47996905, "link": "https://stackoverflow.com/questions/47996905/haskell-function-application-on-wrapped-data", "title": "Haskell: Function Application on Wrapped Data", "body": "<p>I have a system with a long list of different functions. I would like the user \nto be able to pass data into these functions from a shell. If the data that they pass is of the wrong type, a error should be displayed when the function is executed.</p>\n\n<p>Data needs to be stored in a general way, as the same type, so that it can be stored in lists before being passed into an exec function.</p>\n\n<pre><code>data Data = DInt Int | DBool Bool | DChar Char .....\n</code></pre>\n\n<p>Is there a way for a list of Data, to be passed into a function like such?</p>\n\n<pre><code> exec :: [Data] -&gt; (wrapped up function) -&gt; Either Error Data\n</code></pre>\n\n<p>If the function was expecting a Bool but an Int was found, an error is thrown etc.</p>\n\n<p>The function would have to wrapped in some sort of structure to allow this application but I'm not sure if there's an easy way to achieve this kind of behaviour.</p>\n\n<p>Thanks, second trying trying to write this so please ask for any clarification.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514394575, "post_id": 47996025, "comment_id": 82960159, "body": "It is unclear what you want. Do you want to concatenate &quot;<i>rowwise</i>&quot;?"}, {"owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514394991, "post_id": 47996025, "comment_id": 82960312, "body": "@WillemVanOnsem i have added more information"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1514395507, "post_id": 47996025, "comment_id": 82960525, "body": "Based on the information, I think <code>++</code> works fine. <code>(++)</code> appends two lists with the same type of data. The fact that that type is a list, does not changes anything. You probably want to change the basecase to <code>getAllPaths [] = []</code>."}, {"owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514395828, "post_id": 47996025, "comment_id": 82960647, "body": "No i get wrong result because <code>(++) :: [a] -&gt; [a] -&gt; [a]</code> but i have here <code>[[a]] -&gt; [[a]] -&gt; [[a]]</code> and i can&#39;t flatten anylist otherwise all the paths will be mixed. If i change Base-case then i can only return one list not a nested list"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1514396969, "post_id": 47996025, "comment_id": 82961021, "body": "mind that the <code>a</code> of the signature of <code>(++)</code> is a different one than the <code>a</code> in <code>getAllPaths</code>. <code>(++)</code> has signature <code>[b] -&gt; [b] -&gt; [b]</code> if we disambiguate, and then <code>b ~ [a]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1514401507, "post_id": 47997243, "comment_id": 82962852, "body": "Pedantic note: <code>a :: [b]</code> is a (logical) type error: <code>a :: [b]</code> would mean that <code>a</code> is a <i>value</i> of type <code>[b]</code>. <code>~</code> is commonly used for type-level equality, so <code>a ~ [b]</code>."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1514402436, "last_edit_date": 1514402436, "creation_date": 1514400774, "answer_id": 47997243, "question_id": 47996025, "link": "https://stackoverflow.com/questions/47996025/combining-two-nested-lists-as-one-nested-list/47997243#47997243", "title": "Combining two nested lists as one nested list", "body": "<p>As <a href=\"https://stackoverflow.com/users/67579/willem-van-onsem\">WillemVanOnsem</a> mentions in the comments, you're looking for <code>(++)</code>. It may not be immediately obvious from the type signature but consider:</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n-- if a ~ [b] then the specific type is:\n(++) :: [[b]] -&gt; [[b]] -&gt; [[b]]\n</code></pre>\n\n<p>And by experiment:</p>\n\n<pre><code>GHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; [[1,2,3],[1,4,6]] ++ [[2,7,9],[2,0,6]]\n[[1,2,3],[1,4,6],[2,7,9],[2,0,6]]\n</code></pre>\n\n<p>If you have a whole list of these, you can combine with <code>foldr</code>.</p>\n\n<pre><code>foldr (++) [] (results :: [[[a]]])\n</code></pre>\n\n<p>or indeed <code>concat</code></p>\n\n<pre><code>concat (results :: [[[a]]])\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 47997243, "answer_count": 1, "score": 0, "last_activity_date": 1514402436, "creation_date": 1514394463, "last_edit_date": 1514394970, "question_id": 47996025, "link": "https://stackoverflow.com/questions/47996025/combining-two-nested-lists-as-one-nested-list", "title": "Combining two nested lists as one nested list", "body": "<p>I want to combine two lists of lists and get a new nested list,Here is my code:</p>\n\n<pre><code>getAllPaths ::(Eq a) =&gt; [(a,a)] -&gt; [[a]]\ngetAllPaths [] = [[]]\ngetAllPaths (x:xs) = findAllPath (fst x) xs ++ getAllPaths xs\n</code></pre>\n\n<p>I want to combine the nested list returned from the findAllPath with all the elements from the recursive calls which are also nested list. </p>\n\n<p>I know that <code>++</code> is used for combining two lists and no nested list but i also can't use first concat and then <code>++</code> because then list will be flatten. </p>\n\n<p>Here is the type signature of <code>findAllPath</code>  and function also:</p>\n\n<pre><code>   findAllPath ::(Eq a) =&gt; a -&gt; [(a,a)] -&gt; [[a]]\n   findAllPath val list = path val list\n            where\n                (first,second) = partition((==val).fst) list\n                singl = map snd first\n                path val list\n                            | first == [] = [[val]]\n                            | otherwise = map ((:) val) $ concat $ map (\\x -&gt; findAllPath x list) singl\n</code></pre>\n\n<p>This functionr returns all the possible paths from one node. I want to collect all the possible paths from all nodes. </p>\n\n<p>For example, there are few paths from node 1 and 2 like this:</p>\n\n<p>from node <code>1</code> to <code>[[1,2,3],[1,4,6]]</code></p>\n\n<p>from node <code>2</code> to  <code>[[2,7,9],[2,0,6]]]</code></p>\n\n<p>and i want a combination of <code>[[1,2,3],[1,4,6],[2,7,9],[2,0,6]]</code></p>\n\n<p>Can someone tell me how do it combine them in recursive call?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack", "cabal-install", "stackage"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1514406402, "post_id": 47994868, "comment_id": 82964777, "body": "Sounds similar to <a href=\"https://stackoverflow.com/questions/47989939/is-there-a-declarative-way-to-specify-packages-to-be-installed-into-global-proje\">this question only a couple hours earlier</a>, and like there I would suggest you use Cabal-install instead of stack, then you never need to worry about making module installs global."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1514478420, "post_id": 47994868, "comment_id": 82990272, "body": "Thanks for your comment. Yes, &quot;cabal install&quot; did solve my problem. However, now I&#39;ve got two separate, parallel, and largely redundant Haskell installations chewing up hard drive space, and that seems terribly wasteful and unnecessary. It&#39;s particularly infuriating, because the binary executable I&#39;m producing can run fine, from any directory, which means it knows how to find my new Haskell modules from anywhere on my system (since it imports them). So, why can&#39;t I make these new modules available to other Haskell executables, as well?!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1514484042, "post_id": 47994868, "comment_id": 82992918, "body": "It absolutely is unnecessary, that&#39;s why I use <i>only</i> Cabal-install on my laptop, and Stack merely on Travis. \u2014 Note that the way your executable finds imported modules is very different from how the compiler finds them for a source file. In fact, if you link statically then there <i>isn&#39;t</i> anything external that needs to be found as everything is included in the binary already. If you link dynamically, it looks up a hard-coded path to a particular hashed dynamic-library file, but that only works because the version resolver and linker have done their work beforehands."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1514649178, "post_id": 47994868, "comment_id": 83040849, "body": "Oh, I get it (I think; perhaps, you could confirm?): my newly compiled executable had the benefit of &quot;knowing&quot; where these custom Haskell modules were located on my system, at the time it was compiled/linked. These other Haskell executables, which I&#39;d like to have be able to import these same custom modules, didn&#39;t have that same luxury when they were compiled/linked. Is that it?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1514651230, "post_id": 47994868, "comment_id": 83041411, "body": "Yes, that&#39;s right. But with cabal (non-sandboxed), there&#39;s one global package registry which all projects have access to, so there&#39;s generally no more duplication than necessary."}], "answers": [{"comments": [{"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "edited": false, "score": 0, "creation_date": 1514478847, "post_id": 47998084, "comment_id": 82990467, "body": "Thanks for the response. So, if I understand what you&#39;re saying, it sounds like modules built for use with Haskell executables, which use a dynamic plugin style of customization, are just not a good candidate for building/installing with stack. They should be built/installed with cabal, instead. Is that a fair summary?"}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "reply_to_user": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "edited": false, "score": 0, "creation_date": 1514607769, "post_id": 47998084, "comment_id": 83032059, "body": "Oh, I did not realize you were trying to dynamically load modules.  If you do &quot;stack build pkg-x&quot; in a project, then the modules will be available within the package DBs specified by the GHC_PACKAGE_PATH set by <code>stack exec</code>.  It sounds like you want more global sharing, but consider that for dynamic plugins to work, dependency versions need to line up, so it should be done within a single stack project...  No, you probably shouldn&#39;t use cabal for this.  Pretty sure the new-build stuff would actually makes this quite a bit more awkward because you would need to specify a particular package id"}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "edited": false, "score": 0, "creation_date": 1514649548, "post_id": 47998084, "comment_id": 83040935, "body": "Thanks! I&#39;d like to make sure I understand: so, what I really need to do is rebuild this &quot;foreign&quot; executable, after adding my new custom plugins to its stack project description. Is that right? In other words, attempting to build the executable, using one stack project, and the plugins, using a different stack project, is an inherently flawed approach. If that&#39;s correct, it seems awfully fragile and restrictive to potential plugin developers. I thought that this is what a well designed/documented API (for the executable) was intended to prevent. I must be missing something fundamental, here."}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "reply_to_user": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "edited": false, "score": 0, "creation_date": 1514928751, "post_id": 47998084, "comment_id": 83109820, "body": "The plugins would need to be binary compatible, so yeah, the versions need to match exactly.  Mere API compatibility is insufficient.  One way around this is to load plugins from source files.  If you are talking about a dev tool that uses plugins, then it should be feasible to run it in one stack environment but use it in another.  You&#39;d just need to plumb environment variables like PATH and GHC_PACKAGE_PATH to the right places."}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 1, "last_activity_date": 1514405513, "creation_date": 1514405513, "answer_id": 47998084, "question_id": 47994868, "link": "https://stackoverflow.com/questions/47994868/how-do-i-use-stack-to-install-locally-authored-haskell-modules-for-global-usage/47998084#47998084", "title": "How do I use stack to install locally authored Haskell modules for global usage?", "body": "<p>Each stack project is in its own sandbox, so the compiled modules can only be used within that project.  Compiled dependencies (which come from a stackage snapshot) sometimes get shared between projects.</p>\n\n<p>Note that you can list a relative path in the packages list, and point to this package.  It will get built again, but it can be directly used in another project this way.  Why the extra building?  Stack has a different model of projects than cabal-install - it does not allow mutations to the package DB to affect how your other projects build.</p>\n\n<p>One option for sharing such a package is to have it in a git repo and use <a href=\"https://docs.haskellstack.org/en/stable/custom_snapshot/\" rel=\"nofollow noreferrer\">https://docs.haskellstack.org/en/stable/custom_snapshot/</a> , but that stuff is still a bit new.</p>\n"}], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 1, "accepted_answer_id": 47998084, "answer_count": 1, "score": 1, "last_activity_date": 1514405513, "creation_date": 1514389343, "question_id": 47994868, "link": "https://stackoverflow.com/questions/47994868/how-do-i-use-stack-to-install-locally-authored-haskell-modules-for-global-usage", "title": "How do I use stack to install locally authored Haskell modules for global usage?", "body": "<p>I have a locally authored Haskell project, which produces both:</p>\n\n<ol>\n<li>a binary executable, and</li>\n<li>several new Haskell modules, which I'd like made accessible to my other, Haskell based, executables.</li>\n</ol>\n\n<p>After:</p>\n\n<pre><code>stack build\nstack install\n</code></pre>\n\n<p>I'm finding that:</p>\n\n<ol>\n<li>the binary executable (#1, above) runs just fine from any directory.</li>\n<li>But, the new Haskell modules (#2, above) are only found when I'm running from within my project directory! (That is, for any executable other than #1, above.)</li>\n</ol>\n\n<p>I need to be able to find the new modules from anywhere.\nHow can I achieve this?</p>\n"}, {"tags": ["haskell", "ini"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1514390136, "post_id": 47994626, "comment_id": 82958116, "body": "Sounds like config returns an Either String Ini rather than just an Ini. Just pattern match on the config, <code>case config of Left err -&gt; putStrLn err; Right c -&gt; do lookupValue ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 335, "user_id": 8273880, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-94n7PxafGjk/AAAAAAAAAAI/AAAAAAAAAWY/jGnUYdJPQP0/photo.jpg?sz=128", "display_name": "Eric Chiesse", "link": "https://stackoverflow.com/users/8273880/eric-chiesse"}, "is_accepted": false, "score": 2, "last_activity_date": 1514390724, "creation_date": 1514390724, "answer_id": 47995192, "question_id": 47994626, "link": "https://stackoverflow.com/questions/47994626/read-an-ini-file-in-haskell/47995192#47995192", "title": "Read an ini file in Haskell", "body": "<p>The problem is that <code>readIniFile</code> returns an <code>IO (Either String Ini)</code>. And <code>lookupValue</code> expects an <code>Ini</code> value. So you have to unwrap the ini value from inside the <code>Either</code> and provide proper handling of errors.</p>\n\n<p>I'm pretty sure there's a more monadic and expressive way to solve the problem but here comes a solution.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Ini\n\nmain :: IO ()\nmain = do\n    config &lt;- readIniFile \"config.ini\"\n    case config of\n        Right ini -&gt; do\n            let p = lookupValue \"NETWORK\" \"port\" ini\n            putStrLn $ case p of\n                        Left s -&gt; s\n                        Right t -&gt; show t\n        Left s -&gt; putStrLn s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "is_accepted": true, "score": 2, "last_activity_date": 1514391013, "creation_date": 1514391013, "answer_id": 47995251, "question_id": 47994626, "link": "https://stackoverflow.com/questions/47994626/read-an-ini-file-in-haskell/47995251#47995251", "title": "Read an ini file in Haskell", "body": "<p>Reading the documentation, <code>readIniFile</code> returns an <code>IO (Either String Ini)</code>, but the third argument of <code>lookupValue</code> must be an <code>Ini</code> (and it returns an <code>Either String Text</code>). You need to use a case statement to retrieve the ini:</p>\n\n<pre><code>result &lt;- readIniFile \"config.ini\"\np &lt;- case result of\n         Left str -&gt; Left str\n         Right ini -&gt; lookupValue \"NETWORK\" \"port\" ini\n</code></pre>\n\n<p>Reading the source code, the Left discriminant seems to be used for reporting error messages.</p>\n\n<p>If you want to get fancier, you can use Either as a monad: <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Either.html#t:Either\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Either.html#t:Either</a></p>\n\n<pre><code>result &lt;- readIniFile \"config.ini\"\np &lt;- (result &gt;&gt;= (lookupValue \"Network\" \"port\"))\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 5717066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXUcs.jpg?s=128&g=1", "display_name": "Matteo Ugolotti", "link": "https://stackoverflow.com/users/5717066/matteo-ugolotti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 47995251, "answer_count": 2, "score": 1, "last_activity_date": 1514391013, "creation_date": 1514388237, "last_edit_date": 1514389447, "question_id": 47994626, "link": "https://stackoverflow.com/questions/47994626/read-an-ini-file-in-haskell", "title": "Read an ini file in Haskell", "body": "<p>I'm trying to read a simple .ini file in Haskell to use as configuration for my application. I'm not an expert in Haskell so I may be missing something simple. </p>\n\n<p>So far my simplified code looks like this</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings          #-}\n\nimport Data.Ini\n\nmain :: IO ()\nmain = do\n  config &lt;- readIniFile \"config.ini\"\n  p &lt;- lookupValue \"NETWORK\" \"port\" config\n\n  ...\n</code></pre>\n\n<p>The compiler gives me this error</p>\n\n<p>Couldn't match expected type 'Ini' with actual type 'Either String Ini' in the third argument of lookupValue namely 'config'.</p>\n\n<p>I looked at the <a href=\"https://hackage.haskell.org/package/ini-0.3.5/docs/Data-Ini.html#t:Ini\" rel=\"nofollow noreferrer\">docs</a> for Data.Ini but I cannot find any example of how to use the Api.</p>\n\n<p>Any help would be really appreciated.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1514385508, "post_id": 47993949, "comment_id": 82956086, "body": "You can define an <code>f :: Either Fruit Vegetable -&gt; String</code>, or you can define a typeclass (and define two <code>f</code>s)."}, {"owner": {"reputation": 2028, "user_id": 3455216, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CHS4x.png?s=128&g=1", "display_name": "Claudio P", "link": "https://stackoverflow.com/users/3455216/claudio-p"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514385942, "post_id": 47993949, "comment_id": 82956291, "body": "@WillemVanOnsem Thank you for the hints. Am I right that <code>Either</code> is only working with two types?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1514386005, "post_id": 47993949, "comment_id": 82956318, "body": "no with one type, the <code>Either Fruit Vegetable</code> type. So you then write <code>f (Left (Apple s b)) = ...</code>, <code>f (Right (Carrot c)) = ...</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514424044, "post_id": 47993949, "comment_id": 82969536, "body": "@WillemVanOnsem great idea too, you could post it even as an answer, now I\u2019m thinking, is my answer equivalent at what you say?"}], "answers": [{"comments": [{"owner": {"reputation": 2028, "user_id": 3455216, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CHS4x.png?s=128&g=1", "display_name": "Claudio P", "link": "https://stackoverflow.com/users/3455216/claudio-p"}, "edited": false, "score": 0, "creation_date": 1514388715, "post_id": 47994332, "comment_id": 82957490, "body": "Thank you very much. Very clean solution without changing existing types."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 2028, "user_id": 3455216, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CHS4x.png?s=128&g=1", "display_name": "Claudio P", "link": "https://stackoverflow.com/users/3455216/claudio-p"}, "edited": false, "score": 0, "creation_date": 1514388837, "post_id": 47994332, "comment_id": 82957542, "body": "@ClaudioP no problem! I have always loved to help, I hope you accept one of the two answers :)"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 6, "last_activity_date": 1514468038, "last_edit_date": 1514468038, "creation_date": 1514386933, "answer_id": 47994332, "question_id": 47993949, "link": "https://stackoverflow.com/questions/47993949/function-to-handle-multiple-existing-independent-data-definitions/47994332#47994332", "title": "Function to handle multiple existing independent data definitions", "body": "<p>A way to do what you are trying to do is with a new data type that involves both foods, so, lets call it Food, it would be:</p>\n\n<pre><code>data Food = Veg Vegetable | Fr Fruit deriving Show\n\ndata Fruit = Apple String Bool\n            | Cherry String String\n            | Grape String deriving Show\n\ndata Vegetable = Carrot String\n                | Onion Bool String\n                | Tomato String String deriving Show\n\n\nf :: Food -&gt; String\nf (Veg v) = fVeg v\nf (Fr f) = fFruit f\n\nfVeg (Carrot s) = s\nfVeg (Onion b s) = s\nfVeg (Tomato s1 s2) = s1 ++ s2\n\nfFruit (Apple s b) = s\n...\n...\n\n  f $ Veg $ Onion True \"friend\"\n=&gt; \"friend\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1514416290, "post_id": 47994581, "comment_id": 82967883, "body": "Note that typeclasses+existstentials often lead to a <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">known antipattern</a>"}], "tags": [], "owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "is_accepted": false, "score": 5, "last_activity_date": 1514474203, "last_edit_date": 1514474203, "creation_date": 1514388038, "answer_id": 47994581, "question_id": 47993949, "link": "https://stackoverflow.com/questions/47993949/function-to-handle-multiple-existing-independent-data-definitions/47994581#47994581", "title": "Function to handle multiple existing independent data definitions", "body": "<p>There are two options. One It is what Damian Lattenero says,  Another option, on the other hand is to use typeclasses.</p>\n\n<pre><code>class Food a where\n   f :: a -&gt; String\n\ninstance Food Fruit where\n    f (Apple ...) = ...\n    f (Cherry ...) = ...\n    f ...\n\ninstance Food Vegetable where\n    f (Carrot ...) = ...\n    f (Onion ...) = ...\n    f (Tomato ...) = ...\n</code></pre>\n\n<p>The problem with that is that you cannot have, for instance, a list of Food, because Fruit and Vegetable are of different types. But you can use f for both types without problem.</p>\n\n<p>EDIT:</p>\n\n<p>Another option, existential quantification, to have both types in a list, but only applying f to the data (using also the code above):</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\ndata F = forall a. (Food a) =&gt; F a\n\ninstance Food F where\n    f (F x) = f x\n\nxs :: [F]\nxs = [F (Apple ...), F (Carrot ..), F (Tomato ...)]\n</code></pre>\n\n<p>And an example of a function using f:</p>\n\n<pre><code>mapF :: [F] -&gt; [String]\nmapF xs = map f xs\n</code></pre>\n"}], "owner": {"reputation": 2028, "user_id": 3455216, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CHS4x.png?s=128&g=1", "display_name": "Claudio P", "link": "https://stackoverflow.com/users/3455216/claudio-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47994332, "answer_count": 2, "score": 2, "last_activity_date": 1514474203, "creation_date": 1514385198, "question_id": 47993949, "link": "https://stackoverflow.com/questions/47993949/function-to-handle-multiple-existing-independent-data-definitions", "title": "Function to handle multiple existing independent data definitions", "body": "<p>I have multiple data definitions, as an easy example:</p>\n\n<pre><code>data Fruit = Apple String Bool\n            | Cherry String String\n            | Grape String\n\ndata Vegetable = Carrot String\n                | Onion Bool String\n                | Tomato String String\n</code></pre>\n\n<p>Now I want to have a function which should proceed both types and I tried something like this:</p>\n\n<pre><code>f :: a -&gt; String\nf (Carrot s) = s\nf (Apple s b) = s\nf (Onion b s) = s\n...\n</code></pre>\n\n<p>But this is not working because the expected type <code>a</code> cannot be matched with for example the type <code>Carrot</code>. I want to know how I should define a function which can handle multiple existing independent data definitions with the help of pattern matching or other techniques.</p>\n"}, {"tags": ["haskell", "error-handling", "either"], "answers": [{"comments": [{"owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "edited": false, "score": 1, "creation_date": 1514385543, "post_id": 47993854, "comment_id": 82956098, "body": "Thanks. Also I use <code>System.Exit.die</code> in <code>either</code> to deal with errors: <a href=\"https://github.com/srid/slownews/commit/a80134c4d918e8b258ae3f1115a62c99ae9b601f\" rel=\"nofollow noreferrer\">github.com/srid/slownews/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 6, "last_activity_date": 1514384804, "creation_date": 1514384804, "answer_id": 47993854, "question_id": 47993584, "link": "https://stackoverflow.com/questions/47993584/error-handling-on-multiple-either-values/47993854#47993854", "title": "Error handling on multiple Either values", "body": "<p>You can use the fact that <code>Either String</code> is an <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Control-Applicative.html#t:Applicative\" rel=\"noreferrer\"><code>Applicative</code></a> for things like this.</p>\n\n<p>Assuming</p>\n\n<pre><code>mcnf :: Either String Config\nmenv :: Either String Env\n</code></pre>\n\n<p>You can write</p>\n\n<pre><code>mapp :: Either String App\nmapp = App &lt;$&gt; mcnf &lt;*&gt; menv\n</code></pre>\n"}], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 47993854, "answer_count": 1, "score": 1, "last_activity_date": 1514384804, "creation_date": 1514383650, "question_id": 47993584, "link": "https://stackoverflow.com/questions/47993584/error-handling-on-multiple-either-values", "title": "Error handling on multiple Either values", "body": "<p>I have two <code>either</code> values, for example:</p>\n\n<pre><code>Either String Config  -- error string or config parsed\nEither String Env     -- error string or environment variables detected\n</code></pre>\n\n<p>And I'd like to extract their values into this record:</p>\n\n<pre><code>type App = App { config :: Config, env :: Env }\n</code></pre>\n\n<p>while failing fast if there were errors (the <code>Left</code> value on one of those either values). </p>\n\n<p>I could use two <code>case</code> statements, but I wonder if there is already an abstraction I can use here? </p>\n\n<p>Ideally I would be logging a message upon an error and exit the program immediately.</p>\n"}, {"tags": ["postgresql", "haskell", "yesod", "haskell-persistent"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1514372967, "post_id": 47990394, "comment_id": 82950411, "body": "This would in fact be a bug, but I haven&#39;t seen this behavior in any of the web apps I maintain. Have you potentially modified the scaffolding in some way? How are you running these functions from GHCi? Is it possible that it&#39;s the GHCi session itself holding onto the connections?"}, {"owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1514375257, "post_id": 47990394, "comment_id": 82951448, "body": "Huh - you were right, it is something to do with GHCi.  I made an executable that just called the function I was testing, and the problem disappeared.  Just tried it again in GHCi and it still breaks there.  Does this sound like a bug with GHCi? Worth reporting it anywhere?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1514375311, "post_id": 47990394, "comment_id": 82951475, "body": "It depends on how you&#39;re calling it from GHCi, so I can&#39;t really tell."}], "owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514370090, "creation_date": 1514370090, "question_id": 47990394, "link": "https://stackoverflow.com/questions/47990394/yesod-persistent-not-closing-db-connections", "title": "Yesod/Persistent not closing DB connections", "body": "<p>I have a web app that uses Yesod and Persistent.  I'm using the default scaffolded <code>Foundation.hs</code> and <code>Application.hs</code>.  I've written a function which processes a local JSON file, and then inserts a row into several tables for each item in the JSON file.  So it is going to be performing 1000+ inserts in all.</p>\n\n<p>Running the function in GHCI, it successfully saves some rows, and then errors with:</p>\n\n<p><code>libpq: failed (FATAL:  sorry, too many clients already)</code></p>\n\n<p>Using the postgres query:</p>\n\n<p><code>select *\nfrom pg_stat_activity\nwhere datname = 'mydb-name'</code></p>\n\n<p>I can see that there are 100 idle connections that have been created by my app and not closed.  I then need to kill these connections to be able to do anything.</p>\n\n<p>Shouldn't persistent be closing these connections as the <code>INSERT</code> queries complete?  What do I need to do differently?</p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1514378388, "post_id": 47990096, "comment_id": 82952890, "body": "Please include a <a href=\"https://stackoverflow.com/help/mcve\">minimal complete example</a>."}, {"owner": {"reputation": 51, "user_id": 8796884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f88ef73271b1363103b85defb8d40c69?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Costa", "link": "https://stackoverflow.com/users/8796884/pedro-costa"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514511565, "post_id": 47990096, "comment_id": 83002089, "body": "I can do that, but not easy since I have around 400 lines of code on what I&#39;m doing. I&#39;ll try."}], "owner": {"reputation": 51, "user_id": 8796884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f88ef73271b1363103b85defb8d40c69?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Costa", "link": "https://stackoverflow.com/users/8796884/pedro-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514641920, "creation_date": 1514369018, "last_edit_date": 1514641920, "question_id": 47990096, "link": "https://stackoverflow.com/questions/47990096/haskell-gloss-making-zoom-pan-and-all-that-kind-of-effects-for-module-graphi", "title": "Haskell Gloss : Making zoom, pan, and all that kind of effects for module Graphics.Gloss.Interface.Pure.Game", "body": "<p>Recently I have been working on making a game with Haskell, and we have been using the library Gloss in order to complete the graphic part. To make a game with Gloss, as you probably know, you have to use Graphics.Gloss.Interface.Pure.Game (or IO game, that's not the main thing to focus here). My doubt is simple. As they say on their description of this module : \"Pressing ESC will still abort the program, but you don't get automatic pan and zoom controls like with displayInWindow.\". I have been trying to build those two effects but with no sucess. I made an accumulator in my state, called v, that gets the value of 1 when 'reactEvent (EventKey (MouseButton WheelUp) Down _ _) ((px,py),p,mapas,i,players,b,c,d,v) = ((px,py),p,mapas,i,players,b,c,d,1)' and then the function that makes the picture appear would turn it back to 0 after applying the effect needed, creating a cicle. What's the mistake in my logic?\nEdit : Added the prints, that's what I am trying to get to work. Also, if anyone has a clue on how to make different camera angles, I would also appreciate some help.</p>\n\n<p><a href=\"https://imgur.com/3PAqO2x\" rel=\"nofollow noreferrer\">https://imgur.com/3PAqO2x</a>\n<a href=\"https://imgur.com/jk93lzQ\" rel=\"nofollow noreferrer\">https://imgur.com/jk93lzQ</a></p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1514371984, "post_id": 47989939, "comment_id": 82949967, "body": "I write this a lot, and here it applies too: <b>I think the tool you want is Cabal-install, not Stack</b>. <code>cabal</code> installs all packages globally by default. (This used to often lead to conflicts in the past \u2013 \u201cCabal Hell\u201d \u2013 which is one reason why Stack became so popular, but thanks to its new <a href=\"http://blog.ezyang.com/2016/05/announcing-cabal-new-build-nix-style-local-builds/\" rel=\"nofollow noreferrer\">Nix-style versioning</a> this is not an issue anymore.) Of course, Stack is invaluable to build projects on a clean-slate server / VM and be sure that it&#39;ll actually work, but for development, Cabal-install is better IMO."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1514372869, "post_id": 47989939, "comment_id": 82950364, "body": "Can you clarify what you&#39;re trying to accomplish here? If the goal is to provide some packages from outside of the snapshot, then using <code>extra-deps</code> in the file you referenced works. If you&#39;re trying to achieve something else, it would help if you could clarify what&#39;s not working."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1514374027, "post_id": 47989939, "comment_id": 82950927, "body": "@MichaelSnoyman When I tried with <code>extra-deps</code>, what stack command actualises these packages? I ran with <code>stack ghci</code>, but none of the packages listed there were installed. Was there meant to be a specific stack command that will read in all the <code>extra-deps</code> and install everything?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1514374134, "post_id": 47989939, "comment_id": 82950972, "body": "That command doesn&#39;t exist, you have to tell Stack <i>somehow</i> which packages you want. For example, you can do <code>stack ghci --package foobar</code>. Stack never eagerly installs all available packages. If it did, you&#39;d end up with about 2,500 packages installed, and a possibly melted CPU :)"}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1514374201, "post_id": 47989939, "comment_id": 82951004, "body": "In that case, what is the utility of putting my &quot;global&quot; packages into <code>extra-deps</code> of <code>global-project&#47;stack.yaml</code>? I already run <code>stack install &lt;...&gt;</code> for all my global package atm. Note that the only global packages I try to get are the ones that have executables like stylish-haskell, pretty-print, hlint... etc. This is quite useful when these things are not available as packages for the OS/distro you&#39;re running (like Windows)."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1514374495, "post_id": 47989939, "comment_id": 82951137, "body": "I&#39;m not sure that it <i>is</i> useful, I&#39;ve never seen anyone do it before. There are certainly cases you may want it done, but generally I&#39;d recommend some other more reproducible approach (like using the <a href=\"https://haskell-lang.org/tutorial/stack-script\" rel=\"nofollow noreferrer\">script interpreter</a>). If your goal is to get executables available: I also just use <code>stack install package-name</code>."}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514368419, "creation_date": 1514368419, "question_id": 47989939, "link": "https://stackoverflow.com/questions/47989939/is-there-a-declarative-way-to-specify-packages-to-be-installed-into-global-proje", "title": "Is there a declarative way to specify packages to be installed into global-project using Haskell stack?", "body": "<p>Stack allows global installation of packages using <code>stack install &lt;packagename&gt;</code> outside of a project directory.</p>\n\n<p>Stack also has a <code>~/.stack/global-project/stack.yaml</code> file that allows configuration of the global-project. However I can't see a way to \"install\" packages declaratively. The <code>extra-deps</code> and <code>packages</code> key in the yaml file don't seem to work for this method.</p>\n\n<p>Instead I just have to run <code>stack install &lt;...&gt; &lt;...&gt;</code> each time the snapshot version gets updated for my global-project.</p>\n"}, {"tags": ["function", "haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1514361453, "post_id": 47988395, "comment_id": 82945464, "body": "Adding 1 to 2 twice is <code>twice (1+) 2</code>."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 4, "creation_date": 1514364760, "post_id": 47988395, "comment_id": 82946649, "body": "&quot;Now this only results in errors.&quot; -&gt; what do you mean? What have you tried? Which error do you get?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1514433478, "post_id": 47988395, "comment_id": 82971290, "body": "Perhaps compare to <code>once f x = f x</code>, where <code>once</code> is more commonly spelled <code>($)</code>. Also, <code>twice f = f . f</code> or <code>twice f = (.) f f</code>, which leads to the minimal (and unreadable) definition <code>twice = join (.)</code>"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1514462955, "post_id": 47988395, "comment_id": 82982660, "body": "@gallais: most comments helped me out, but I need to explain you what the error was. My biggest mistake I was feeding {twice} values rather than a function and an argument. So I got confused. Comments of all of you got me on track again, so I will dig some deeper into the wonderful world of Haskell."}], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 2, "last_activity_date": 1514361447, "creation_date": 1514361447, "answer_id": 47988429, "question_id": 47988395, "link": "https://stackoverflow.com/questions/47988395/feeding-data-to-haskell-twice-function-as-explained-by-erik-meijer-lecture-7/47988429#47988429", "title": "Feeding data to Haskell twice function as explained by Erik Meijer lecture 7", "body": "<p>The derived type signature is <code>(t -&gt; t) -&gt; t -&gt; t</code>. Pass any arguments that match and you won't get compiler errors. One example is <code>twice (+1) 0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1514365760, "creation_date": 1514365760, "answer_id": 47989295, "question_id": 47988395, "link": "https://stackoverflow.com/questions/47988395/feeding-data-to-haskell-twice-function-as-explained-by-erik-meijer-lecture-7/47989295#47989295", "title": "Feeding data to Haskell twice function as explained by Erik Meijer lecture 7", "body": "<p>The main mistake here is disregarding the type of <code>twice</code>. In Haskell types are very important, and explain precisely how you would call such a function.</p>\n\n<pre><code>twice :: (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n\n<p>So, the function works in this way:</p>\n\n<ul>\n<li>the caller chooses any type <code>a</code> they want</li>\n<li>the caller passes a function <code>f</code> of type <code>a -&gt; a</code></li>\n<li>the caller passes an argument of type <code>a</code></li>\n<li><code>twice</code> finally produces a value of type <code>a</code></li>\n</ul>\n\n<p>Hence, we could do the following. We can choose, for instance, <code>a = Int</code>. Then define the function <code>f</code> as</p>\n\n<pre><code>myFun :: Int -&gt; Int\nmyFun y = y*y + 42\n</code></pre>\n\n<p>then choose <code>x :: Int</code> as <code>10</code>. Finally, we can make the call</p>\n\n<pre><code>twice myFun 10\n</code></pre>\n\n<p>Alternatively, we can use a lambda and skip the function definition above</p>\n\n<pre><code>twice (\\y -&gt; y*y + 42) 10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "is_accepted": false, "score": 0, "last_activity_date": 1514571996, "last_edit_date": 1514571996, "creation_date": 1514442008, "answer_id": 48002552, "question_id": 47988395, "link": "https://stackoverflow.com/questions/47988395/feeding-data-to-haskell-twice-function-as-explained-by-erik-meijer-lecture-7/48002552#48002552", "title": "Feeding data to Haskell twice function as explained by Erik Meijer lecture 7", "body": "<p>For illustration here are three functions called erik1, erik2, and erik3 with the same type signature.</p>\n\n<pre><code>erik1, erik2, erik3  ::(a  -&gt;  a)  -&gt;  a  -&gt;  a \nerik1 f x = f x\nerik2 f x = f(f x)  -- Equivalent to \"twice\"\nerik3 f x = f(f(f x))\n</code></pre>\n\n<p>These eriks take two arguments, the first being a function and the second being a number. Let's choose sqrt as the function and the number to be 16 and run the three eriks.  Here's what you get:</p>\n\n<pre><code>*Main&gt; erik1 sqrt 16\n4.0\n*Main&gt; erik2 sqrt 16\n2.0\n*Main&gt; erik3 sqrt 16\n1.4142135623730951\n</code></pre>\n\n<p>There are many things you can try, such as erik3 (/2) 16 = 2,because the f in the function allows you to use any appropriate function. In the particular case of sqrt, erik3 is equivalent to this statement in C:</p>\n\n<pre><code>printf (\"Eighth root of 16 =  %f \\n\", sqrt(sqrt(sqrt(16)))); \n</code></pre>\n\n<p><a href=\"https://www.youtube.com/watch?v=YRTQkBO2v-s&amp;list=PLlHF8jw6FqhBKWxhfZchP0haXXPYk5mSB&amp;index=7\" rel=\"nofollow noreferrer\">Dr. Meijer Ch 7</a>  1:48 to 3:37\nAs I watched this lecture last night a key point was made when Erik wrote the type signature as twice :: (a -> a) -> (a -> a) and said, \"<strong>twice is a function that takes a to a and returns a new function from a to a</strong>, and by putting some extra parens it becomes painfully obvious that twice is a higher order function.\"   </p>\n\n<p>A C example that comes closer to illustrating that is:</p>\n\n<pre><code>#define eighthRoot(x)  (sqrt(sqrt(sqrt(x))))\nprintf (\"eigthtRoot(16)  = %f \\n\", eighthRoot(16));\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1514571996, "creation_date": 1514361297, "question_id": 47988395, "link": "https://stackoverflow.com/questions/47988395/feeding-data-to-haskell-twice-function-as-explained-by-erik-meijer-lecture-7", "title": "Feeding data to Haskell twice function as explained by Erik Meijer lecture 7", "body": "<p>Can somebody point me to how to feed data to: </p>\n\n<pre><code>twice f x = f (f x)\n</code></pre>\n\n<p>It's taken from Erik Meijer's lecture, and I have the feeling I can only truely understand when passing data to it. Now this only results in errors.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1514337345, "post_id": 47985194, "comment_id": 82939522, "body": "Can&#39;t reproduce on ghci 8.0.2, windows."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1514338262, "post_id": 47985194, "comment_id": 82939655, "body": "@Zpalmtree i use os x, see my edit"}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 0, "creation_date": 1514338788, "post_id": 47985194, "comment_id": 82939732, "body": "Cannot reproduce with GHCi 8.2.1 on Windows."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1514339017, "post_id": 47985194, "comment_id": 82939769, "body": "The expressions <code>(f . g) x</code> and <code>f (g x)</code> are definitionally equal; it really isn&#39;t possible that they have different values (unless you&#39;ve snuck in a use of an unsafe function somewhere, or your installation of GHC is somehow massively broken)."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1514339178, "post_id": 47985194, "comment_id": 82939798, "body": "Ok, so it is likely to be a bug and I might report it. Shall I delete this question?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1514339942, "post_id": 47985194, "comment_id": 82939927, "body": "@Elmex80s Are you certain that you&#39;re copying and pasting the exact code that you are typing in?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514342286, "post_id": 47985194, "comment_id": 82940267, "body": "@Elmex80s If you can reproduce your issue by running e.g. <a href=\"https://repl.it/repls/OutgoingDimOryx\" rel=\"nofollow noreferrer\">this</a> program, then it&#39;s likely a bug, but I would assume it isn&#39;t a bug in GHC. If that program doesn&#39;t show the issue, then it&#39;s a user error. Whether you delete the question is up to you (but if you do find out it&#39;s a bug, feel free to post a link to the bug report along with a short explanation as an answer)."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1514342304, "post_id": 47985194, "comment_id": 82940271, "body": "Cannot reproduce on Linux or OS X with GHCi 8.0.1 and 8.2.1 respectively. I&#39;m voting to close this question due to being unreproducible."}], "answers": [{"comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1514363508, "post_id": 47985822, "comment_id": 82946180, "body": "<b>Yes there is no bug</b>. By typing <code>(unwords . words) s = s</code> I accidentally made <code>(unwords . words)</code> the identity function throughout the whole session of course regardless the values for <code>s</code>, as I redefined <code>s</code> several times during the session."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 4, "creation_date": 1514368269, "post_id": 47985822, "comment_id": 82948153, "body": "@Elmex80s: you did not <i>only</i> make <code>(unwords . words)</code> the identity function. Note that <code>unwords</code> and <code>words</code> are variables here. You make <code>(.) x y</code> the identity function. Regardless what the two operands are."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1514405104, "post_id": 47985822, "comment_id": 82964308, "body": "Wow, you have made a frankly amazing deductive leap here. Well done."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 16, "last_activity_date": 1514357495, "last_edit_date": 1514357495, "creation_date": 1514343738, "answer_id": 47985822, "question_id": 47985194, "link": "https://stackoverflow.com/questions/47985194/unexpected-result-for-unwords-words/47985822#47985822", "title": "Unexpected result for (unwords . words)", "body": "<p>I suspect you probably wrote something like:</p>\n\n<pre><code>Prelude&gt; (unwords . words) s = s   -- oops: used \"=\" instead of \"==\"\n</code></pre>\n\n<p>earlier in your GHCi session.  This would have the effect of redefining the <code>(.)</code> operator so that <code>f . g</code> is the identity function for any <code>f</code> and <code>g</code>, after which you'd get the observed behavior:</p>\n\n<pre><code>Prelude&gt; unwords (words \"a  b  c  \")\n\"a b c\"\nPrelude&gt; (unwords . words) \"a  b  c  \"\n\"a  b  c  \"\n</code></pre>\n\n<p>or even:</p>\n\n<pre><code>Prelude&gt; (16 . map) \"hello, world!\"\n\"hello, world!\"\n</code></pre>\n"}], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "closed_date": 1514353415, "accepted_answer_id": 47985822, "answer_count": 1, "score": 2, "last_activity_date": 1514357495, "creation_date": 1514336309, "last_edit_date": 1514338196, "question_id": 47985194, "link": "https://stackoverflow.com/questions/47985194/unexpected-result-for-unwords-words", "closed_reason": "Not suitable for this site", "title": "Unexpected result for (unwords . words)", "body": "<p>Can anyone explain the behavior of <code>unwords . words</code> in the example below. I would expect it to remove all the double spaces in the string <code>s</code>, however apparently it doesn't. On the other hand the behavior of <code>unwords (words s)</code> is as expected.  </p>\n\n<pre><code>Prelude&gt; s\n\"this     is   a  test    \"\nPrelude&gt; unwords (words s) \n\"this is a test\"\nPrelude&gt; (unwords . words) s \n\"this     is   a  test    \"\nPrelude&gt; (unwords . words) s == unwords (words s)\nFalse\nPrelude&gt; (unwords . words) s == s \nTrue\n</code></pre>\n\n<p>I use GHCi 8.2.2 on OS X 10.11.6.</p>\n"}, {"tags": ["haskell", "recursion", "immutability"], "answers": [{"comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1514330654, "post_id": 47984637, "comment_id": 82938363, "body": "The recursive solution will always return <code>Nothing</code>, since it eventually reaches the empty-list-case."}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 1, "last_activity_date": 1514330973, "last_edit_date": 1514330973, "creation_date": 1514329645, "answer_id": 47984637, "question_id": 47984609, "link": "https://stackoverflow.com/questions/47984609/recursion-with-maybe/47984637#47984637", "title": "Recursion with Maybe", "body": "<p>You're close, but your recursive call to <code>example xs ls</code> returns a <code>Maybe Int</code>, and you can't add an <code>Int</code> and a <code>Maybe Int</code> (in <code>x*l + example xs ls</code>), hence your error on the last line.</p>\n\n<p>You can use <a href=\"https://www.haskell.org/hoogle/?hoogle=fromMaybe\" rel=\"nofollow noreferrer\"><code>fromMaybe</code></a> to deal with this case, using <code>0</code> as the default sum:</p>\n\n<pre><code>example :: [Int] -&gt; [Int] -&gt; Maybe Int\nexample [] []         = Nothing\nexample (x:xs) (l:ls) = Just $ x * l + fromMaybe 0 (example xs ls)\n</code></pre>\n\n<p>Alternatively (and more neatly), you can avoid the explicit recursion using something like this:</p>\n\n<pre><code>example [] [] = Nothing\nexample xl yl = Just $ sum $ zipWith (*) xl yl\n</code></pre>\n\n<hr>\n\n<p>Note that you have non-exhaustive patterns in your pattern match. Two lists of different lengths will cause a pattern-match exception.</p>\n"}, {"comments": [{"owner": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 0, "creation_date": 1514364780, "post_id": 47984696, "comment_id": 82946659, "body": "Why do you get Just 11 and not Just 10 in the first example?"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "reply_to_user": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 1, "creation_date": 1514388541, "post_id": 47984696, "comment_id": 82957412, "body": "@Soldalma because it is calculating (1*3)+(2*4)."}, {"owner": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 0, "creation_date": 1514393433, "post_id": 47984696, "comment_id": 82959625, "body": "Ok, got it. I am still not familiar with Haskell&#39;s syntax in some cases."}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 5, "last_activity_date": 1514330977, "last_edit_date": 1514330977, "creation_date": 1514330312, "answer_id": 47984696, "question_id": 47984609, "link": "https://stackoverflow.com/questions/47984609/recursion-with-maybe/47984696#47984696", "title": "Recursion with Maybe", "body": "<p>I'm guessing at what your intent is here, not sure whether I read it correctly: You want the function to produce <code>Nothing</code> when the two input lists have difference lengths?</p>\n\n<p>The \"happy\" base case is <code>0</code> just like in the first attempt, but lifted into <code>Maybe</code>.</p>\n\n<pre><code>example [] [] = Just 0\n</code></pre>\n\n<p>To handle situations where the lists have different lengths, include the cases where only <em>one</em> of the lists is empty. You should have gotten a compiler warning about a non-exhaustive pattern match for not including these cases.</p>\n\n<pre><code>example [] _ = Nothing\nexample _ [] = Nothing\n</code></pre>\n\n<p>The final case, then, is where you have two nonempty lists. It looks a lot like that line from your first attempt, except rather than applying the addition directly to <code>example xs ys</code>, we <strong><code>fmap</code></strong> the addition over <code>example xs ys</code>, taking advantage of the fact that <code>Maybe</code> is a <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Functor.html\" rel=\"nofollow noreferrer\"><code>Functor</code></a>.</p>\n\n<pre><code>example (x : xs) (y : ys) = fmap (x * y +) (example xs ys)\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>\u03bb&gt; example [1,2] [3,4]\nJust 11\n\n\u03bb&gt; example [1,2] [3,4,5]\nNothing\n</code></pre>\n\n<p>By the way, if you wanted to use a library this, <a href=\"https://hackage.haskell.org/package/safe-0.3.15/docs/Safe-Exact.html#v:zipWithExactMay\" rel=\"nofollow noreferrer\"><code>safe</code></a> would be a nice choice to turn this into a one-liner.</p>\n\n<pre><code>import Safe.Exact\n\nexample xs ys = fmap sum (zipWithExactMay (*) xs ys)\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 1, "accepted_answer_id": 47984696, "answer_count": 2, "score": 0, "last_activity_date": 1514330977, "creation_date": 1514329435, "question_id": 47984609, "link": "https://stackoverflow.com/questions/47984609/recursion-with-maybe", "title": "Recursion with Maybe", "body": "<p>I'm having difficulty try to write a function to find the sum of two lists using recursion, that possibly could be Nothing if any list is empty.</p>\n\n<p>The math of the following functions are:</p>\n\n<pre><code>\u03a3w[i]x[i]\n</code></pre>\n\n<p>where w and x are equal length int arrays</p>\n\n<p>Here is my working code:</p>\n\n<pre><code>example :: [Int] -&gt; [Int] -&gt; Int\nexample [] [] = 0\nexample (x:xs) (l:ls) = ((x*l) + (example xs ls))\n</code></pre>\n\n<p>Here is the idea of what I want to work:</p>\n\n<pre><code>example :: [Int] -&gt; [Int] -&gt; Maybe Int\nexample [] [] = Nothing\nexample (x:xs) (l:ls) = Just((x*l) + (example xs ls))\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "list-comprehension", "infinite"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514320882, "post_id": 47983444, "comment_id": 82935765, "body": "Who told you to use list comprehension? How are you benchmarking this? Please say <code>ghc -O2 -fforce-recomp -fllvm</code>.  What order should the search be in? Depth first?  Why would nothing be evaluated if <code>a</code> is drawn from an infinite list?"}, {"owner": {"reputation": 229, "user_id": 7450338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5419bd8beb0bdef4aac01a64cb9c7e9e?s=128&d=identicon&r=PG&f=1", "display_name": "A.M.", "link": "https://stackoverflow.com/users/7450338/a-m"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514321391, "post_id": 47983444, "comment_id": 82935949, "body": "Using a list comprehension is a requirement of the question. I don&#39;t have a clue what your &quot;ghc ...&quot; code means; I used the command <code>:set +s</code> in Haskell, but speed is not my main concern.  Any sensible order would be good for me - the problem is that I don&#39;t know how to get Haskell to evaluate in a specific order, though I could construct a bijection \u2115^4 -&gt; \u2115 that would cycle through the integers. I am aware infinite lists are necessary; I meant that replacing <code>a &lt;- [1..n]</code> with <code>a &lt;- [1..]</code> without further changes will cause the program to never output anything."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514335298, "post_id": 47983444, "comment_id": 82939188, "body": "FYI  <code>:set +s</code> is not done &quot;in Haskell&quot; but in the GHC interpreter named GHCi.  In addition to this interpreter there is a compiler named ghc which can produce machine code that runs much faster.  The use of list comprehension locks you in to something of a breadth first exploration of values for the first list, considering all possible values for later listed variables before considering the next value for the first one.  This is easy and educational to play with using statements such as <code>[ (a,b,c) | a &lt;- [1..3], b &lt;- [1,2], c &lt;- [1,2] ]</code>."}, {"owner": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 0, "creation_date": 1514365087, "post_id": 47983444, "comment_id": 82946793, "body": "Shouldn&#39;t it be b &lt; c and not a &lt; c?"}, {"owner": {"reputation": 229, "user_id": 7450338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5419bd8beb0bdef4aac01a64cb9c7e9e?s=128&d=identicon&r=PG&f=1", "display_name": "A.M.", "link": "https://stackoverflow.com/users/7450338/a-m"}, "reply_to_user": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 0, "creation_date": 1514495895, "post_id": 47983444, "comment_id": 82997948, "body": "@Soldalma not at all. Consider (1,12,9,10). The inequality conditions are only there to avoid also getting the other 23 permutations of this tuple e.g. (9,10,1,12) or (12,1,9,10). Within each pair, we want the lower number first and of the pairs, we want the one with the smallest number first (of course, this is only one possible solution)."}], "answers": [{"comments": [{"owner": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 0, "creation_date": 1514365310, "post_id": 47983583, "comment_id": 82946888, "body": "Why [a+1..n] twice and no [b+1..n]?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4136, "user_id": 1675230, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f9cdd386245eff27ad111fbd849a588?s=128&d=identicon&r=PG", "display_name": "Soldalma", "link": "https://stackoverflow.com/users/1675230/soldalma"}, "edited": false, "score": 0, "creation_date": 1514395002, "post_id": 47983583, "comment_id": 82960318, "body": "@Soldalma Because the original question specifies <code>a&lt;</code> twice and no <code>b&lt;</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1514321883, "last_edit_date": 1514321883, "creation_date": 1514321502, "answer_id": 47983583, "question_id": 47983444, "link": "https://stackoverflow.com/questions/47983444/tidying-up-a-list-comprehension-in-haskell/47983583#47983583", "title": "Tidying up a list comprehension in Haskell", "body": "<blockquote>\n  <p>The domain for a,b,c,d are all identical but I can't work out how to simplify this code so <code>[1..n]</code> is only written once.</p>\n</blockquote>\n\n<p>Use <code>[a,b,c,d] &lt;- replicateM 4 [1..n]</code>.</p>\n\n<blockquote>\n  <p>The program is very slow: just taxi 50 takes 19 seconds.</p>\n</blockquote>\n\n<p>One cheap improvement is to bake your <code>a&lt;b</code>, <code>a&lt;c</code>, and <code>c&lt;d</code> conditions into the comprehension.</p>\n\n<pre><code>taxi n = [(a,b,c,d) | a &lt;- [1..n], b &lt;- [a+1..n], c &lt;- [a+1..n], d &lt;- [c+1..n], a^3 + b^3 == c^3 + d^3]\n</code></pre>\n\n<p>This makes things significantly faster on my machine.</p>\n\n<p>Or, for better composability with the next (and previous) part of the answer, treat <code>b</code>, <code>c</code>, and <code>d</code> as offsets.</p>\n\n<pre><code>taxi n =\n    [ (a,b,c,d)\n    | a &lt;- [1..n]\n    , b_ &lt;- [1..n], let b = a+b_, b&lt;=n\n    , c_ &lt;- [1..n], let c = a+c_, c&lt;=n\n    , d_ &lt;- [1..n], let d = c+d_, d&lt;=n\n    , a^3 + b^3 == c^3 + d^3\n    ]\n</code></pre>\n\n<blockquote>\n  <p>I want an infinite list, without an upper limit.</p>\n</blockquote>\n\n<p>See my answer to <a href=\"https://stackoverflow.com/questions/4119730/cartesian-product-of-2-lists-in-haskell/46900780#46900780\">Cartesian product of 2 lists in Haskell</a> for a hint. tl;dr use <a href=\"http://hackage.haskell.org/package/universe-base-1.0.2.1/docs/Data-Universe-Helpers.html#v:choices\" rel=\"nofollow noreferrer\">choices</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 229, "user_id": 7450338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5419bd8beb0bdef4aac01a64cb9c7e9e?s=128&d=identicon&r=PG&f=1", "display_name": "A.M.", "link": "https://stackoverflow.com/users/7450338/a-m"}, "edited": false, "score": 0, "creation_date": 1514322838, "post_id": 47983648, "comment_id": 82936469, "body": "Ahhh, that&#39;s so simple! Thank you. One question: how did you get those ranges for the list? I deduced <code>b &lt;- [1..n], a &lt;- [1..b-3], c &lt;- [a+1..b-2], d &lt;- [c+1..b-1]</code> since the four integers will all be distinct."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 229, "user_id": 7450338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5419bd8beb0bdef4aac01a64cb9c7e9e?s=128&d=identicon&r=PG&f=1", "display_name": "A.M.", "link": "https://stackoverflow.com/users/7450338/a-m"}, "edited": false, "score": 0, "creation_date": 1514323188, "post_id": 47983648, "comment_id": 82936577, "body": "@A.Morris Yeah, you can do that. Doesn&#39;t really help, though. You just avoid some irrelevantly tiny dead ends, at the cost of having to think and increasing your chance to make a mistake."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1514326996, "post_id": 47983648, "comment_id": 82937629, "body": "Love this solution, much cleaner than mine. You might also like <a href=\"http://hackage.haskell.org/package/arithmoi-0.6.0.1/docs/Math-NumberTheory-Powers-Cubes.html#v:exactCubeRoot\" rel=\"nofollow noreferrer\">exactCubeRoot</a>. (Probably won&#39;t matter within the amount of time you&#39;re willing to wait, of course.)"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1514327245, "post_id": 47983648, "comment_id": 82937689, "body": "@DanielWagner Thanks, I might try that later. I just started learning Haskell, have no idea yet how to use that."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 229, "user_id": 7450338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5419bd8beb0bdef4aac01a64cb9c7e9e?s=128&d=identicon&r=PG&f=1", "display_name": "A.M.", "link": "https://stackoverflow.com/users/7450338/a-m"}, "edited": false, "score": 0, "creation_date": 1514355033, "post_id": 47983648, "comment_id": 82943067, "body": "@A.Morris I just changed the order of my variables, completely going from largest to smallest. Now the ranges all start at 1, looks much nicer. I even considered to instead start them at 4, 3, 2 and 1, as it&#39;s now so orderly. But I still prefer the simplicity of all just starting at 1."}], "tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": true, "score": 13, "last_activity_date": 1514353271, "last_edit_date": 1514353271, "creation_date": 1514321953, "answer_id": 47983648, "question_id": 47983444, "link": "https://stackoverflow.com/questions/47983444/tidying-up-a-list-comprehension-in-haskell/47983648#47983648", "title": "Tidying up a list comprehension in Haskell", "body": "<p>Your constraints imply <code>a &lt; c &lt; d &lt; b</code>. So let <code>b</code> run outermost and let the others run in appropriate lower ranges:</p>\n\n<pre><code>taxi n = [ (a,b,c,d) | b &lt;- [1..n],\n                       d &lt;- [1..b-1],\n                       c &lt;- [1..d-1],\n                       a &lt;- [1..c-1],\n                       a^3 + b^3 == c^3 + d^3 ]\n</code></pre>\n\n<p>To go infinite, simply use <code>b &lt;- [1..]</code>.</p>\n\n<hr>\n\n<p>A further big improvement is to <em>compute</em> one of the four variables from the other three:</p>\n\n<pre><code>taxi = [ (a,b,c,d) | b &lt;- [1..],\n                     c &lt;- [1..b-1],\n                     a &lt;- [1..c-1],\n                     let d3 = a^3 + b^3 - c^3,\n                     let d = round(fromIntegral(d3)**(1/3)),\n                     c &lt; d,\n                     d^3 == d3 ]\n</code></pre>\n\n<hr>\n\n<p>Benchmarking <code>taxi 50</code> in GHCi with <code>:set +s</code> like you did:</p>\n\n<pre><code>Yours:          (16.49 secs, 17,672,510,704 bytes)\nMy first:        (0.65 secs,    658,537,184 bytes)\nMy second:       (0.09 secs,     66,229,376 bytes)  (modified to use b &lt;- [1..n] again)\nDaniel's first:  (1.94 secs,  2,016,810,312 bytes)\nDaniel's second: (2.87 secs,  2,434,309,440 bytes)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 2, "last_activity_date": 1530690201, "last_edit_date": 1530690201, "creation_date": 1514377967, "answer_id": 47992274, "question_id": 47983444, "link": "https://stackoverflow.com/questions/47983444/tidying-up-a-list-comprehension-in-haskell/47992274#47992274", "title": "Tidying up a list comprehension in Haskell", "body": "<p>Picking up Stefan his excellent answer. Given <code>a^3 + b^3 == c^3 + d^3</code> we only have to look at integers for which holds <code>0 &lt; a &lt; c &lt; b</code>. Now introduce this (infinite) iterative structure</p>\n\n<pre><code>-- generates all integers x, y and z for which holds 0 &lt; x &lt; y &lt; z\ntriplets = [(x, y, z) | z &lt;- [3 .. ], y &lt;- [2 .. z - 1], x &lt;- [1 .. y - 1]]\n</code></pre>\n\n<p>This will give us triplets easy accessible from our list comprehension which we will present here after. For people with a Python background, this should be equivalent to Python's <code>yield</code>.</p>\n\n<pre><code>1 2 3\n1 2 4\n1 3 4\n2 3 4\n1 2 5\n1 3 5\n2 3 5\n1 4 5\n2 4 5\n3 4 5\n1 2 6\n1 3 6\n2 3 6\n1 4 6\n2 4 6\n3 4 6\n1 5 6\n2 5 6\n3 5 6\n4 5 6\n</code></pre>\n\n<p>Next we need something to (quickly) find the largest cube and test for integers to be cube, also called integer cube root. There is this package <a href=\"https://hackage.haskell.org/package/arithmoi-0.6.0.1/docs/Math-NumberTheory-Powers-Cubes.html\" rel=\"nofollow noreferrer\">Math.NumberTheory.Powers.Cubes</a> which has functions for these tasks. Or just use these</p>\n\n<pre><code>-- given integer x &gt;= 0 find the largest integer r such that r^3 &lt;= x\nlargestCube :: Integral a =&gt; a -&gt; a\nlargestCube x = \n    let powers_of_two = iterate ((*) 2) 1\n        upper         = head [j | j &lt;- powers_of_two, x &lt; j ^ 3]\n    in  largestCubeSub 0 upper x\n\n\nlargestCubeSub :: Integral a =&gt; a -&gt; a -&gt; a -&gt; a\nlargestCubeSub lower upper x\n    | lower + 1 == upper   = lower\n    | b ^ 3 &lt;= x           = largestCubeSub b upper x\n    | otherwise            = largestCubeSub lower b x\n    where\n    b = div (lower + upper) 2\n\n\n-- test if an integer x &gt;= 0 is a cube\nisCube :: Integral a =&gt; a -&gt; Bool\nisCube x = (largestCube x) ^ 3 == x\n</code></pre>\n\n<p>Now your compact list comprehension for the first 50 taxicab numbers looks like</p>\n\n<pre><code>*Main&gt; condition = \\a b c -&gt; and [isCube (a^3 + b^3 - c^3), a^3 + b^3 - c^3 &gt; c^3]\n*Main&gt; taxi = [(a, b, c, largestCube (a^3 + b^3 - c^3)) | (a, c, b) &lt;- triplets, condition a b c]\n*Main&gt; first50 = take 50 taxi \n</code></pre>\n\n<p>Printing them using</p>\n\n<pre><code>*Main&gt; single_line = \\(x, y, z, u) -&gt; unwords [show i | i &lt;- [x, y, z, u]]\n*Main&gt; putStrLn $ unlines $ map single_line first50 \n</code></pre>\n\n<p>Will give  </p>\n\n<pre><code>1 12 9 10\n2 16 9 15\n2 24 18 20\n10 27 19 24\n4 32 18 30\n2 34 15 33\n9 34 16 33\n3 36 27 30\n17 39 26 36\n12 40 31 33\n6 48 27 45\n4 48 36 40\n12 51 38 43\n8 53 29 50\n20 54 38 48\n17 55 24 54\n9 58 22 57\n3 60 22 59\n5 60 45 50\n8 64 36 60\n30 67 51 58\n4 68 30 66\n18 68 32 66\n42 69 56 61\n6 72 54 60\n17 76 38 73\n5 76 48 69\n34 78 52 72\n10 80 45 75\n15 80 54 71\n24 80 62 66\n30 81 57 72\n51 82 64 75\n7 84 63 70\n2 89 41 86\n11 93 30 92\n23 94 63 84\n12 96 54 90\n50 96 59 93\n8 96 72 80\n20 97 33 96\n47 97 66 90\n35 98 59 92\n24 98 63 89\n29 99 60 92\n6 102 45 99\n27 102 48 99\n23 102 60 95\n24 102 76 86\n1 103 64 94\n</code></pre>\n\n<p>Within a few seconds it returns the first 50 Taxi-cab numbers. </p>\n"}], "owner": {"reputation": 229, "user_id": 7450338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5419bd8beb0bdef4aac01a64cb9c7e9e?s=128&d=identicon&r=PG&f=1", "display_name": "A.M.", "link": "https://stackoverflow.com/users/7450338/a-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 1, "accepted_answer_id": 47983648, "answer_count": 3, "score": 7, "last_activity_date": 1530690201, "creation_date": 1514320458, "question_id": 47983444, "link": "https://stackoverflow.com/questions/47983444/tidying-up-a-list-comprehension-in-haskell", "title": "Tidying up a list comprehension in Haskell", "body": "<p>So I'm trying to generate a list of taxicab numbers in Haskell. Taxicab numbers are numbers that can be written as the sum of two distinct cubes in two different ways - the smallest is\n<code>1729 = 1^3 + 12^3 = 9^3 + 10^3</code>.</p>\n\n<p>For now, I'm just bothered about generating the four numbers that \"make up\" the taxicab number e.g. (1,12,9,10), and have been told to use a list comprehension (which I'm not too familiar with). This function will generate all 4-tuples where the largest number is at most n:</p>\n\n<blockquote>\n  <p><code>taxi n = [(a,b,c,d) | a &lt;- [1..n], b &lt;- [1..n], c &lt;- [1..n], d &lt;- [1..n], a^3 + b^3 == c^3 + d^3, a &lt; b, a &lt; c, c &lt; d]</code></p>\n</blockquote>\n\n<p>However, it is troublesome for a few reasons:</p>\n\n<ul>\n<li>The domain for a,b,c,d are all identical but I can't work out how to simplify this code so <code>[1..n]</code> is only written once.</li>\n<li>I want an infinite list, without an upper limit, so I can just leave the program running for as long as possible and terminate it when I please. Clearly if I just set <code>a &lt;- [1..]</code> etc. then the program will never end up evaluating anything.</li>\n<li>The program is very slow: just <code>taxi 50</code> takes 19 seconds.</li>\n</ul>\n\n<p>Any speed optimisations would also be good, but if not the naive method I'm using is sufficient.</p>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"comments": [{"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 1, "creation_date": 1514310946, "post_id": 47981992, "comment_id": 82932483, "body": "I specially like the solution without TH!"}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1514311603, "post_id": 47981992, "comment_id": 82932688, "body": "Unfortunately the nice TH-free solution has a little quirk: It doesn&#39;t generate different names for the data constructor. It generates always <i>MyRecord</i> and not <i>MyRecordA</i> and <i>MyRecordXYZ</i>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1514314163, "post_id": 47981992, "comment_id": 82933533, "body": "@Jogger Indeed, but that doesn&#39;t really cost you anything. You can still restrict the type of the constructor to any name, e.g. <code>MyRecord :: String -&gt; t -&gt; MyRecord &quot;X&quot; t</code>. With <code>-XTypeApplications</code> you can even write ` MyRecord @&quot;X&quot;`"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 2, "last_activity_date": 1514310534, "creation_date": 1514310534, "answer_id": 47981992, "question_id": 47981492, "link": "https://stackoverflow.com/questions/47981492/template-haskell-generate-records/47981992#47981992", "title": "Template Haskell: Generate Records", "body": "<p>There are several issues here; lets look at them one by one. The splice you have:</p>\n\n<pre><code>[d|\n  data $typeName :: $constName \n    {$fieldFoo, $fieldBar}\n  |]\n</code></pre>\n\n<p>is simply not valid; you may only splice entire expressions, types, or declarations, and not parts thereof. You also probably meant <code>data $typeName = $constName</code> but of course the same restriction applies to that, so it still won't work.</p>\n\n<hr>\n\n<p>The definition </p>\n\n<pre><code>fieldFoo = sigP name ($clsString)\n</code></pre>\n\n<p>doesn't work because you may not have an splice of a local variable without an intervening quote. This is known as the 'stage restriction'.</p>\n\n<hr>\n\n<pre><code>fieldFoo = sigP name ($clsString)\nfieldBar = sigP name cls\n</code></pre>\n\n<p><code>sigP</code> is wrong because it constructs a pattern; you don't need to build any patterns (not sure what you meant here).</p>\n\n<hr>\n\n<pre><code>typeName = conT  $ \"MyRecord\" &lt;&gt; name\nconstrName = RecC $ \"MyRecord\" &lt;&gt; name\nclsString = conT \"String\" \n</code></pre>\n\n<p>All of these are trying to treat a <code>Name</code> as a <code>String</code>. If it isn't clear why that doesn't make sense, perhaps you should familiarize yourself with the basics of Haskell.</p>\n\n<hr>\n\n<p>Now the solution:</p>\n\n<pre><code>import Data.Monoid\nimport Language.Haskell.TH\nimport Language.Haskell.TH.Syntax\n\ndefBang = Bang NoSourceUnpackedness NoSourceStrictness\nstringType = ConT ''String\n\nmkRecord :: Name -&gt; Name -&gt; Q [Dec] \nmkRecord name cls = (pure.pure)$\n  DataD [] typeName [] Nothing [constr] []\n  where\n    typeName = mkName $ \"MyRecord\" &lt;&gt; nameBase name\n    constr = RecC typeName [(mkName $ \"foo\" &lt;&gt; nameBase name, defBang, stringType)\n                           ,(mkName $ \"bar\" &lt;&gt; nameBase name, defBang, ConT cls)]\n</code></pre>\n\n<p>Note that you don't even make use of the <code>Q</code> monad here; not to generate names, nor to reify info about names. Therefore you can actually write a function <code>Name -&gt; Name -&gt; Dec</code> and then applying <code>pure.pure</code> to the result produces a type which can be spliced.</p>\n\n<p>The above is for GHC 8.0.1; the AST of Template Haskell varies significantly between majour releases so it may not compile exactly as is on other versions.</p>\n\n<p>Then e.g. </p>\n\n<pre><code>$(mkRecord (mkName \"XYZ\") ''Bool)\n$(mkRecord (mkName \"A\") ''Int)\n</code></pre>\n\n<p>produces </p>\n\n<pre><code>data MyRecordXYZ = MyRecordXYZ {fooXYZ :: String, barXYZ :: Bool}\ndata MyRecordA = MyRecordA {fooA :: String, barA :: Int}\n</code></pre>\n\n<hr>\n\n<p>Finally, here is a solution which doesn't require TH. The family of types you wish to generate can be represented in a first class way:</p>\n\n<pre><code>import GHC.TypeLits\n\ndata MyRecord (nm :: Symbol) t = MyRecord { foo :: String, bar :: t }\n\ntype MyRecordA = MyRecord \"A\" Bool\ntype MyRecordXYZ = MyRecord \"XYZ\" Int\n</code></pre>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 47981992, "answer_count": 1, "score": 1, "last_activity_date": 1514310534, "creation_date": 1514307458, "question_id": 47981492, "link": "https://stackoverflow.com/questions/47981492/template-haskell-generate-records", "title": "Template Haskell: Generate Records", "body": "<p>With Template Haskell I would like to generate records, eg:</p>\n\n<pre><code>data MyRecordA = MyRecordA\n  {fooA :: String, barA :: Bool} \n</code></pre>\n\n<p>The uppercase <em>A</em> in <em>MyRecordA</em>, <em>fooA</em>, <em>barA</em> and the type <em>Bool</em> of the second field should be variable and specified by the caller of the TH function.</p>\n\n<p>I tried with several variations of:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nmodule THRecord where\nimport Language.Haskell.TH\n\nmkRecord :: Name -&gt; Name -&gt; Q [Dec] \nmkRecord name cls = [d|\n  data $typeName :: $constName \n    {$fieldFoo, $fieldBar}\n  |]\n  where\n    typeName = conT  $ \"MyRecord\" &lt;&gt; name\n    constrName = RecC $ \"MyRecord\" &lt;&gt; name\n    fieldFoo = sigP name ($clsString)\n    fieldBar = sigP name cls\n    clsString = conT \"String\" \n</code></pre>\n\n<p>Unfortunately, I get parse errors like </p>\n\n<blockquote>\n  <p>src/THRecord.hs:8:9: error: parse error on input \u2018$fieldFoo\u2019</p>\n</blockquote>\n"}, {"tags": ["arrays", "haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 2, "creation_date": 1514297952, "post_id": 47979780, "comment_id": 82928161, "body": "You can\u2019t pattern match arrays. Look up the functions documented in Data.Array online."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514433421, "post_id": 47979780, "comment_id": 82971283, "body": "The immutable arrays in the <code>array</code> package aren&#39;t really meant to be used like that. An immutable array is best created &quot;all at once&quot;, either using one of the high-level creation functions or by freezing an <code>STArray</code> or <code>IOArray</code>. Once it&#39;s created, you normally don&#39;t want to modify it; doing so is quite expensive if the array is large. I don&#39;t know of any production-quality Haskell libraries for really high-performance immutable array-like structures, but there have been some promising experiments in recent years."}], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 4, "last_activity_date": 1514316687, "last_edit_date": 1514316687, "creation_date": 1514305542, "answer_id": 47981192, "question_id": 47979780, "link": "https://stackoverflow.com/questions/47979780/haskell-array-pattern-in-a-function/47981192#47981192", "title": "Haskell Array Pattern in a function", "body": "<p>You can't pattern match on arrays because <a href=\"https://hackage.haskell.org/package/array-0.5.2.0/docs/Data-Array-IArray.html#t:Array\" rel=\"nofollow noreferrer\">the <code>data</code> declaration in the <code>Data.Array.IArray</code> module for the <code>Array</code> type</a> doesn't have any of its data constructors exposed. This is a common practice in Haskell because it allows the author to update the internal representation of their data type without making a breaking change for users of their module.</p>\n\n<p>The only way to use an <code>Array</code>, therefore, is to use the functions provided by the module. To access the first value in an array, you can use a combination of <code>bounds</code> and <code>(!)</code>, or take the first key/value pair from <code>assocs</code>. Then you can use <code>(//)</code> to make an update to the array.</p>\n\n<pre><code>arraytest arr = arr // [(index, value + 1)]\n  where\n    index = fst (bounds arr)\n    value = arr ! index\n</code></pre>\n\n<p>If you choose to use <code>assocs</code>, you can pattern match on its result:</p>\n\n<pre><code>arraytest arr = arr // [(index, value + 1)]\n  where\n    (index, value) = head (assocs arr) -- `head` will crash if the array is empty\n</code></pre>\n\n<p>Or you can make use of the <code>Functor</code> instances for lists and tuples:</p>\n\n<pre><code>arraytest arr = arr // take 1 (fmap (fmap (+1)) (assocs arr))\n</code></pre>\n\n<hr>\n\n<p>You will probably quickly notice, though, that the <code>array</code> package is lacking a lot of convenience functions. All of the solutions above are fairly verbose compared to how the operation would be implemented in other languages.</p>\n\n<p>To fix this, we have the <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code></a> package (and its cousins), which add a ton of convenience functions to Haskell and make packages like <code>array</code> much more bearable. This package has a fairly steep learning curve, but it's used very commonly and is definitely worth learning.</p>\n\n<pre><code>import Control.Lens\n\narraytest arr = arr &amp; ix (fst (bounds arr)) +~ 1\n</code></pre>\n\n<p>If you squint your eyes, you can almost see how it says <code>arr[0] += 1</code>, but we still haven't sacrificed any of the benefits of immutability.</p>\n"}, {"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1514356447, "last_edit_date": 1514356447, "creation_date": 1514318507, "answer_id": 47983219, "question_id": 47979780, "link": "https://stackoverflow.com/questions/47979780/haskell-array-pattern-in-a-function/47983219#47983219", "title": "Haskell Array Pattern in a function", "body": "<p>This is more like an extended comment to @4castle's answer. You cannot pattern match on an <code>Array</code> because its implementation is hidden; you must use its public API to work with them. However, you can use the public API to <em>define</em> such a pattern (with the appropriate language extensions):</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms, ViewPatterns #-}\n-- PatternSynonyms: Define patterns without actually defining types\n-- ViewPatterns: Construct patterns that apply functions as well as match subpatterns\nimport Control.Arrow((&amp;&amp;&amp;)) -- solely to dodge an ugly lambda; inline if you wish\n\npattern Array :: Ix i =&gt; (i, i) -&gt; [(i, e)] -&gt; Array i e\n-- the type signature hints that this is the array function but bidirectional\npattern Array bounds' assocs' &lt;- ((bounds &amp;&amp;&amp; assocs) -&gt; (bounds', assocs'))\n-- When matching against Array bounds' assocs', apply bounds &amp;&amp;&amp; assocs to the\n-- incoming array, and match the resulting tuple to (bounds', assocs')\n  where Array = array\n  -- Using Array in an expression is the same as just using array\n\narraytest (Array bs ((i,x):xs)) = Array bs ((i,x+1):xs)\n</code></pre>\n\n<p>I'm fairly sure that the conversions to and from <code>[]</code> make this absolutely abysmal for performance.</p>\n"}], "owner": {"reputation": 49, "user_id": 9010647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8059510497e4ae0d44cd50e8ee966550?s=128&d=identicon&r=PG&f=1", "display_name": "essence", "link": "https://stackoverflow.com/users/9010647/essence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "accepted_answer_id": 47981192, "answer_count": 2, "score": 2, "last_activity_date": 1514356447, "creation_date": 1514297548, "question_id": 47979780, "link": "https://stackoverflow.com/questions/47979780/haskell-array-pattern-in-a-function", "title": "Haskell Array Pattern in a function", "body": "<p>Hi total Haskell beginner here: What does the pattern in a function for an array look like ? For example: I simply want to add +1 to the first element in my array </p>\n\n<pre><code>&gt; a = array (1,10) ((1,1) : [(i,( i * 2)) | i &lt;- [2..10]])\n</code></pre>\n\n<p>My first thought was:</p>\n\n<pre><code>&gt; arraytest :: Array (Int,Int) Int -&gt; Array (Int,Int) Int\n&gt; arraytest (array (mn,mx) (a,b):xs) = (array (mn,mx) (a,b+1):xs)\n</code></pre>\n\n<p>I hope you understand my problem :)</p>\n"}, {"tags": ["haskell", "gtk3"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514298503, "post_id": 47979509, "comment_id": 82928385, "body": "Could you please provide a short Haskell example which clearly illustrates the problem and what you want to do."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514304967, "post_id": 47979509, "comment_id": 82930605, "body": "Have you tried using <a href=\"https://hackage.haskell.org/package/haskell-gi-base-0.20.7/docs/Data-GI-Base-ManagedPtr.html#v:castTo\" rel=\"nofollow noreferrer\"><code>castTo</code></a>?"}], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1514312477, "post_id": 47981149, "comment_id": 82932967, "body": "getting close:  Couldn&#39;t match type \u2018Text\u2019 with \u2018[Char]\u2019   Expected type: Text -&gt; IO ()     Actual type: String -&gt; IO ()"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1514321236, "post_id": 47981149, "comment_id": 82935902, "body": "Apologies. You need to convert text to string or print text. But you\u2019ve figured that out I see"}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 1, "last_activity_date": 1514305302, "creation_date": 1514305302, "answer_id": 47981149, "question_id": 47979509, "link": "https://stackoverflow.com/questions/47979509/how-do-i-cast-widget-to-label-in-haskells-gi-gtk/47981149#47981149", "title": "How do I cast Widget to Label in Haskell&#39;s GI-Gtk?", "body": "<p>Try this:</p>\n\n<pre><code>cc &lt;- containerGetChildren r\nmlabel &lt;- castTo Label (head cc)\ncase mlabel of\n  Nothing -&gt; putStrLn \u201cNot a label!\u201d\n  Just label -&gt; labelGetText label &gt;&gt;= putStrLn\n</code></pre>\n"}], "owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 47981149, "answer_count": 1, "score": 0, "last_activity_date": 1514318601, "creation_date": 1514296092, "last_edit_date": 1514318601, "question_id": 47979509, "link": "https://stackoverflow.com/questions/47979509/how-do-i-cast-widget-to-label-in-haskells-gi-gtk", "title": "How do I cast Widget to Label in Haskell&#39;s GI-Gtk?", "body": "<p>I have this sample code where I have a ListBox containing ListBoxRows, which in turn contain a Label. When I click on the ListBox, I get a ListBoxRow. So far so good. The problems start when I want to interact with the ListBoxRows children.</p>\n\n<p>I have used this function to get the Label, which is the child of the ListBoxRow.\n<a href=\"https://hackage.haskell.org/package/gi-gtk-3.0.18/docs/GI-Gtk-Objects-Container.html#g:13\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/gi-gtk-3.0.18/docs/GI-Gtk-Objects-Container.html#g:13</a></p>\n\n<p>However, the returned type is Widget. How do I convert the type of the object? Function widgetGetName tells me it is a label, but the Haskell Type system insists it is a Widget, so I can not use label specific functions.</p>\n\n<h2>working code</h2>\n\n<pre><code>  _ &lt;- onListBoxRowSelected listbox2 (\\(Just r) -&gt; do\n                                         cc &lt;- containerGetChildren r\n                                         mlabel &lt;- castTo Label (head cc)\n                                         case mlabel of\n                                           Nothing -&gt; putStrLn \"Not a label!\"\n                                           Just label -&gt; (labelGetText label) &gt;&gt;= putStrLn . unpack)\n</code></pre>\n\n<p>Thanks to Dan</p>\n"}, {"tags": ["haskell", "shared-libraries", "dockerfile", "ghc"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1514308729, "post_id": 47978884, "comment_id": 82931813, "body": "This is a good question but I think you&#39;re unlikely to attract a good answer here (GHC internals are very complex, esp. wrt compiling GHC itself in a non-standard way). I would suggest you post on the <a href=\"https://mail.haskell.org/mailman/listinfo/ghc-devs\" rel=\"nofollow noreferrer\">ghc-devs mailing list</a>"}, {"owner": {"reputation": 711, "user_id": 774228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d85066d4024c48c64b05f6d149833f?s=128&d=identicon&r=PG", "display_name": "unclechu", "link": "https://stackoverflow.com/users/774228/unclechu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514462075, "post_id": 47978884, "comment_id": 82982192, "body": "user2407038, I did it but for now with no success: <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2017-December/015251.html\" rel=\"nofollow noreferrer\">mail.haskell.org/pipermail/ghc-devs/2017-December/015251.htm&zwnj;&#8203;l</a>"}], "owner": {"reputation": 711, "user_id": 774228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d85066d4024c48c64b05f6d149833f?s=128&d=identicon&r=PG", "display_name": "unclechu", "link": "https://stackoverflow.com/users/774228/unclechu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 0, "score": 9, "last_activity_date": 1517001656, "creation_date": 1514292509, "last_edit_date": 1517001656, "question_id": 47978884, "link": "https://stackoverflow.com/questions/47978884/how-do-i-recompile-ghc-with-fpic", "title": "How do I recompile GHC with -fPIC?", "body": "<p><em>Introduction: I'm actually trying to build a shared-library written in Haskell that compatible with C (could be used from C code without knowing it is written in Haskell), but I want all Haskell dependencies being statically linked, for now I can only dynamically link all dependencies (for every packages including \"base\" and \"ghc-prim\" packages. This experiment presented <a href=\"https://github.com/unclechu/haskell-experiment-shared-library-for-c-application\" rel=\"noreferrer\">here</a>.</em></p>\n\n<p>I tried to solve that by writing <a href=\"https://github.com/unclechu/haskell-experiment-shared-library-for-c-application/blob/228b652f900c106ebdcde52b842a2fe090a47867/docker/ghc-with-fpic/Dockerfile\" rel=\"noreferrer\">Dockerfile</a> where I build GHC 8.2.2 from scratch with replaced <em>mk/build.mk</em> file with <a href=\"https://github.com/unclechu/haskell-experiment-shared-library-for-c-application/blob/228b652f900c106ebdcde52b842a2fe090a47867/docker/ghc-with-fpic/my-build.mk\" rel=\"noreferrer\">this contents</a> (I just did kinda the same I saw in different stack overflow issues like <a href=\"https://stackoverflow.com/questions/27815467/haskell-dynamic-library/28131655#28131655\">this one</a>) but when I try to link with <code>--make -static -shared -fPIC</code> I get a lot of similar errors about linking \"ghc-prim\", example of last one:</p>\n\n<pre><code>/usr/bin/ld.gold: error: /ghc-8.2.2-fpic/lib/ghc-8.2.2/ghc-prim-0.5.1.1/libHSghc-prim-0.5.1.1.a(Classes.o): requires dynamic R_X86_64_PC32 reloc against 'stg_ap_0_fast' which may overflow at runtime; recompile with -fPIC\n</code></pre>\n\n<p>What should I actually do to build GHC with -fPIC and link my library with static Haskell dependencies?</p>\n\n<p><code>Dockerfile</code> forked from <code>debian:stretch</code>, here is quote of last most important part of it:</p>\n\n<pre><code># ... apt-get update ... installing build-essential and other stuff ...\n\n# see https://stackoverflow.com/a/28131655/774228\n# for info about customizations in 'build.mk'\nCOPY my-build.mk /my-build.mk\n\nRUN mkdir /compile &amp;&amp; cd /compile \\\n    &amp;&amp; wget https://downloads.haskell.org/~ghc/8.2.2/ghc-8.2.2-src.tar.xz \\\n    &amp;&amp; tar -xvf ghc-8.2.2-src.tar.xz \\\n    &amp;&amp; rm ghc-8.2.2-src.tar.xz \\\n    &amp;&amp; cd ghc-8.2.2/ \\\n    &amp;&amp; ./configure --prefix=/ghc-8.2.2-fpic --disable-library-profiling --enable-shared \\\n    &amp;&amp; cp /my-build.mk mk/build.mk \\\n    &amp;&amp; make install \\\n    &amp;&amp; cd /usr/local/bin \\\n    &amp;&amp; ls /ghc-8.2.2-fpic/bin/ | xargs -I{} ln -s /ghc-8.2.2-fpic/bin/{}\n</code></pre>\n\n<p>And here is whole <code>my-build.mk</code> file:</p>\n\n<pre><code>SRC_HC_OPTS          = -H64m -O\nEXTRA_HC_OPTS        = -fPIC\nSRC_CC_OPTS          = -fPIC -O\nGhcStage1HcOpts      = -fasm -O0\nGhcStage2HcOpts      = -fasm -O0\nGhcLibHcOpts         = -fasm -O2\nGhcLibWays           = v dyn\nDYNAMIC_GHC_PROGRAMS = YES\nDYNAMIC_BY_DEFAULT   = NO\nSplitObjs            = NO\nHADDOCK_DOCS         = NO\nBUILD_DOCBOOK_HTML   = NO\nBUILD_DOCBOOK_PS     = NO\nBUILD_DOCBOOK_PDF    = NO\nV                    = 1\nLATEX_DOCS           = NO\nHSCOLOUR_SRCS        = NO\nBeConservative       = YES\n</code></pre>\n"}, {"tags": ["haskell", "graphics"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 2, "creation_date": 1514298236, "post_id": 47978311, "comment_id": 82928285, "body": "Could you be more specific please? Are you getting image files like <code>.png</code>? Do you want to output to the screen in a window? Or a pdf or are you using OpenGL? Or do you want to produce an image file? What have you tried already?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514309536, "post_id": 47978311, "comment_id": 82932047, "body": "Check out friday and juicypixels on Hackage."}, {"owner": {"reputation": 11, "user_id": 9141527, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WftErVhZBF4/AAAAAAAAAAI/AAAAAAAAAIA/g_MuydzaZbI/photo.jpg?sz=128", "display_name": "Franco Musi", "link": "https://stackoverflow.com/users/9141527/franco-musi"}, "edited": false, "score": 0, "creation_date": 1514419582, "post_id": 47978311, "comment_id": 82968610, "body": "I added more info"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514354043, "post_id": 47985405, "comment_id": 82942785, "body": "Is there some numerical reason to use <code>cos (x+(pi&#47;2)) + 1</code> rather than <code>1 - sin x</code>?"}, {"owner": {"reputation": 2692, "user_id": 448858, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c225e2d1fd51a59a99e735963041243d?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/448858/chris"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514400060, "post_id": 47985405, "comment_id": 82962283, "body": "Nope, none other than me forgetting my basic trig ;)"}], "tags": [], "owner": {"reputation": 2692, "user_id": 448858, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c225e2d1fd51a59a99e735963041243d?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/448858/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1514339154, "creation_date": 1514339154, "answer_id": 47985405, "question_id": 47978311, "link": "https://stackoverflow.com/questions/47978311/haskell-draw-image-over-image/47985405#47985405", "title": "Haskell draw image over image", "body": "<p>You can use JuicyPixels to do that sort of thing:</p>\n\n<pre><code>module Triangles where\n\nimport Codec.Picture\nimport LineGraphics\n\n{-| Parameterize color smoothly as a function of angle -}\ncolorWheel :: Float -&gt; Colour\ncolorWheel x = (r, g, b, a)\n  where\n    r = floor $ (cos x + 1) * (255 / 2)\n    g = floor $ (sin x + 1) * (255 / 2)\n    b = floor $ (cos (x+(pi/2)) + 1) * (255 / 2)\n    a = 255\n\n{-| Draw a triangle centered about the point (x, y) -}\ntriangle :: Point -&gt; Path\ntriangle (x, y) =\n    [ (x - k, y - k)\n    , (x + k, y - k)\n    , (x, y + k)\n    , (x - k, y - k)\n    ]\n  where\n    size = 30\n    k = size / 2\n\n{-|\n  Draw 'n' equally-spaced triangles at a radius of 'r' about a center\n  point, '(x, y)'.\n-}\ntriangles :: Float -&gt; Radius -&gt; Vector -&gt; Picture\ntriangles n r (x, y) =\n    [ (colorWheel theta, tri theta) | theta &lt;- steps n ]\n  where\n    tri theta = triangle ((r * cos theta) + x, (r * sin theta) + y)\n\n{-| Interpolate the range [0, 2pi] by 'n' steps -}\nsteps :: Float -&gt; [Float]\nsteps n = map (\\i -&gt; i * (2*pi/n)) [0 .. n]\n</code></pre>\n\n<p>And we'll use this module of supporting code:</p>\n\n<pre><code>module LineGraphics (\n    Point, Vector, Line, Path, Picture, Colour, Radius,\n    black,\n    drawPicture,\n) where\n\nimport Graphics.Rasterific hiding (Point, Vector, Line, Path, polygon)\nimport Graphics.Rasterific.Texture\nimport Codec.Picture\n\ntype Radius  = Float\ntype Point   = (Float, Float)\ntype Vector  = (Float, Float)\ntype Line    = (Point, Point)\ntype Path    = [Point]\ntype Picture = [(Colour, Path)]\ntype Colour  = (Int, Int, Int, Int) -- red, green, blue, opacity\n\nblack = (0, 0, 0, 255)\n\ndrawPicture :: Float -&gt; Picture -&gt; Image PixelRGBA8\ndrawPicture linewidth picture =\n    renderDrawing  800 800 (toColour black) $\n        mapM_ renderFn picture\n  where\n    renderFn (col, path) = withTexture (uniformTexture $ toColour col) (drawPath path)\n    drawPath points    = stroke linewidth  JoinRound (CapRound, CapStraight 0) $\n        polyline (map (\\(x, y) -&gt; V2 x y) points)\n    toColour (a,b,c,d) = PixelRGBA8\n        (fromIntegral a) (fromIntegral b) (fromIntegral c) (fromIntegral d)\n</code></pre>\n\n<p>And here's what we get:\n<a href=\"https://i.stack.imgur.com/10vcR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/10vcR.png\" alt=\"The rendered image\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 9141527, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WftErVhZBF4/AAAAAAAAAAI/AAAAAAAAAIA/g_MuydzaZbI/photo.jpg?sz=128", "display_name": "Franco Musi", "link": "https://stackoverflow.com/users/9141527/franco-musi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514419558, "creation_date": 1514289383, "last_edit_date": 1514419558, "question_id": 47978311, "link": "https://stackoverflow.com/questions/47978311/haskell-draw-image-over-image", "title": "Haskell draw image over image", "body": "<p>I want to take two different images (taken from image files, like .png) and draw one over the other several times in different positions. The resulting image should be presented on screen or generate a new image file, whichever is easier. I\u00b4ll be taking that new image and drawing on it more with further operations</p>\n\n<p>Is there any Haskell library that allows me to do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1514286124, "post_id": 47976972, "comment_id": 82924029, "body": "<code>Maybe Pole</code> is not <code>Pole</code>. You can&#39;t pass a <code>Maybe Pole</code> to something that takes a <code>Pole</code>. LYAH is going to go into this soon."}, {"owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1514286193, "post_id": 47976972, "comment_id": 82924064, "body": "Thanks @AJFarmar - that helpful. Could you expand that in terms of how this can be resolved?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1514286330, "post_id": 47976972, "comment_id": 82924126, "body": "LYAH is going to tell you how to do this, but you could write <code>a :- f = a &gt;&gt;= f</code> and write <code>Just (0,0)</code> instead of <code>(0,0)</code>. But once again, LYAH is going to explain this soon."}], "answers": [{"comments": [{"owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "edited": false, "score": 0, "creation_date": 1514294875, "post_id": 47978830, "comment_id": 82927146, "body": "Thanks @Zeta that\u2019s helpful. Are you saying that where the book says that the erroring code gives a valid value - that the book contains a typo?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "edited": false, "score": 0, "creation_date": 1514314460, "post_id": 47978830, "comment_id": 82933660, "body": "@hawkeye I&#39;m saying that the chapter has to be read completely in sequence. If you read only the snippets, you can end up with broken code. There are <i>two</i> variants of <code>landLeft</code>, one that uses <code>Maybe</code> and is therefore unsuitable for <code>(-:)</code>, and one that does not use <code>Maybe</code> and is therefore suitable for <code>(-:)</code>. It&#39;s unfortunate that both variants share the same name."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1514292161, "creation_date": 1514292161, "answer_id": 47978830, "question_id": 47976972, "link": "https://stackoverflow.com/questions/47976972/why-cant-ghci-match-this-type/47978830#47978830", "title": "Why can&#39;t ghci match this type?", "body": "<p>The variants of <code>landLeft</code> and <code>landRight</code> that work with <code>-:</code> use <code>Pole</code> as return type, not <code>Maybe Pole</code>. Let's view all types at ones:</p>\n\n<pre><code>landLeft  1             ::       Pole -&gt; Maybe Pole\nlandRight 4             ::       Pole -&gt; Maybe Pole \n(-:)                    :: a -&gt; (a    -&gt; b         ) -&gt; b\n(0,0)                   :: Pole\n(-:) (0,0)              ::      (Pole -&gt; b         ) -&gt; b\n(-:) (0,0) (landLeft 1) ::                              Maybe Pole\n</code></pre>\n\n<p>Since <code>Maybe Pole</code> isn't <code>Pole</code>, we cannot use <code>(-:)</code> again for <code>landRight</code>. LYAH shows how to deal with those functions: you need a way to use <code>a -&gt; Maybe b</code> functions with <code>Maybe a</code>. That's <code>(&gt;&gt;=)</code> job:</p>\n\n<pre><code>landLeft 1 (0,0) &gt;&gt;= landRight 4\n</code></pre>\n\n<p>Continue the chapter, as the author immediately tackles your issue:</p>\n\n<blockquote>\n  <p>When we land birds without throwing Pierre off balance, we get a new pole wrapped in a <code>Just</code>. But when many more birds end up on one side of the pole, we get a <code>Nothing</code>. This is cool, but <strong><em>we seem to have lost the ability to repeatedly land birds on the pole</em></strong>. We can't do <code>landLeft 1 (landRight 1 (0,0))</code> anymore because when we apply <code>landRight 1</code> to <code>(0,0)</code>, we don't get a <code>Pole</code>, but a <code>Maybe Pole</code>. <code>landLeft 1</code> takes a <code>Pole</code> and not a <code>Maybe Pole</code>. [emphasis mine]</p>\n</blockquote>\n"}], "owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 47978830, "answer_count": 1, "score": 0, "last_activity_date": 1514292161, "creation_date": 1514283046, "question_id": 47976972, "link": "https://stackoverflow.com/questions/47976972/why-cant-ghci-match-this-type", "title": "Why can&#39;t ghci match this type?", "body": "<p>I'm working through the <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">following Haskell book</a> - looking at the Chapter <a href=\"http://learnyouahaskell.com/a-fistful-of-monads#walk-the-line\" rel=\"nofollow noreferrer\">Walk the Line</a>:</p>\n\n<p>When I run the following code in ghci:</p>\n\n<pre><code>type Birds = Int  \ntype Pole = (Birds,Birds)  \n\nx -: f = f x\n\n:{\nlandLeft :: Birds -&gt; Pole -&gt; Maybe Pole\nlandLeft n (left,right)\n    | abs ((left + n) - right) &lt; 4 = Just (left + n, right)\n    | otherwise                    = Nothing\n:}\n\n:{\nlandRight :: Birds -&gt; Pole -&gt; Maybe Pole\nlandRight n (left,right)\n    | abs (left - (right + n)) &lt; 4 = Just (left, right + n)\n    | otherwise                    = Nothing\n:}\n\n--Failure\n(0,0) -: landLeft 1 -: landRight 4 \n--(0,0) -: landLeft 1 -: landRight 4 -: landLeft (-1) -: landRight (-2)  \n--(0,2)  \n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>Prelude&gt; (0,0) -: landLeft 1 -: landRight 4 \n\n&lt;interactive&gt;:17:24: error:\n    \u2022 Couldn't match type \u2018Maybe Pole\u2019 with \u2018(Birds, Birds)\u2019\n      Expected type: Maybe Pole -&gt; Maybe Pole\n        Actual type: Pole -&gt; Maybe Pole\n    \u2022 In the second argument of \u2018(-:)\u2019, namely \u2018landRight 4\u2019\n      In the expression: (0, 0) -: landLeft 1 -: landRight 4\n      In an equation for \u2018it\u2019: it = (0, 0) -: landLeft 1 -: landRight 4\n</code></pre>\n\n<p>My question is: <strong>Why can't ghci match this type?</strong></p>\n"}, {"tags": ["regex", "haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514279977, "post_id": 47976107, "comment_id": 82921657, "body": "I think you are trying to use a wrong regex flavour. AFAIR Posix EREs don&#39;t support <code>?:</code> Also please show your actual Haskell syntax. <code>\\\\.</code> is a Haskell backslash-period which is a RE literal-period. And what&#39;s with the <code>&#47;...&#47;</code> delimiters? They are not a part of any regex syntax."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514281546, "post_id": 47976107, "comment_id": 82922289, "body": "I tried to remove slashes, no difference. Is there a substitute for <code>?:</code>. <code>TDFA</code> is used elsewhere in my program. See UPD."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514282637, "post_id": 47976107, "comment_id": 82922653, "body": "I don&#39;t think trial and error is a particularly useful method of getting a regex to work. I recommend knowing exactly what every single characrer is doing. Removing backslashes? Why not adding some instead? In this application, a plain old capturing group should do the job, there&#39;s no need to use a non-capturing group."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514283405, "post_id": 47976107, "comment_id": 82922913, "body": "I played with it on <code>regex101</code>; non-capturing group matters :) . Of course some studying will do a lot of good to me. Conducted properly, it&#39;ll take a week or so..."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514283618, "post_id": 47976107, "comment_id": 82922999, "body": "Try <a href=\"https://stackoverflow.com/a/7797678/3832970\"><code>&quot;\\&quot;(\\\\.|[^\\&quot;\\\\])*\\&quot;&quot;</code></a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514283668, "post_id": 47976107, "comment_id": 82923022, "body": "A term that matches a backslash character in regex syntax is spelled &quot;\\\\&quot; A literal backslash character in a string in Haskell source is spelled &quot;\\\\&quot;. Therefore to make a regex that matches a backslash character you need <b>four</b> backslashes in a row in Haskell source."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514283963, "post_id": 47976107, "comment_id": 82923109, "body": "Where exactly does it matter? There is no such feature in TDFA anyway, TDFA implements POSIX ERE."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514284468, "post_id": 47976107, "comment_id": 82923327, "body": "@Wiktor Stribi\u017cew: Much better, indeed. Input: <code>removeQuotedSubstrings &quot;alf\\&quot;foo\\&quot; dp \\&quot;bar\\&quot; kip&quot;</code>; output: <code>[&quot;\\&quot;foo\\&quot;&quot;,&quot;o&quot;,&quot;\\&quot;bar\\&quot;&quot;,&quot;r&quot;]</code>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514284670, "post_id": 47976107, "comment_id": 82923416, "body": "So, you will have to somehow omit each even element from this list. POSIX ERE does not support non-capturing groups."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1514285136, "post_id": 47976107, "comment_id": 82923601, "body": "Will do. Thanks!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514285903, "post_id": 47976107, "comment_id": 82923929, "body": "@WiktorStribi\u017cew can you explain what exactly <code>\\\\.</code> is doing in your regex?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514287618, "post_id": 47976107, "comment_id": 82924624, "body": "It is either impossible or too unwieldy to support quoted strings if arbitrary backslash-escaped characters are allowed using POSIX ERE. If backslash-escaped characters are not needed, then a simple RE like <code>&quot;\\&quot;([^\\&quot;])*\\&quot;&quot;</code> would suffice."}], "answers": [{"tags": [], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "is_accepted": true, "score": 0, "last_activity_date": 1514470478, "creation_date": 1514470478, "answer_id": 48009066, "question_id": 47976107, "link": "https://stackoverflow.com/questions/47976107/haskell-regex-tdfa-match-and-remove-quoted-substrings/48009066#48009066", "title": "Haskell, regex, TDFA: match (and remove) quoted substrings", "body": "<p>No improvement, just an acceptable solution, albeit lacking in elegance:</p>\n\n<pre><code>import qualified Data.Text as T\nimport Text.Regex.TDFA\n\n-- | Removes all double quoted substrings, if any, from a string.\n--\n-- Examples:\n--\n-- &gt;&gt;&gt; removeQuotedSubstrings \"alfa\"\n-- \"alfa\"\n-- &gt;&gt;&gt; removeQuotedSubstrings \"ngoro\\\"dup\\\"lai \\\"ming\\\"\"\n-- \"ngoro lai  \"\nremoveQuotedSubstrings :: String -&gt; String\nremoveQuotedSubstrings str =\n  let quoteds  = filter (('\"' ==) . head)\n               $ concat (str =~ (\"\\\"(\\\\.|[^\\\"\\\\])*\\\"\" :: String) :: [[String]])\n  in  T.unpack $ foldr (\\quoted acc -&gt; T.replace (T.pack quoted) \" \" acc)\n                       (T.pack str) quoteds\n</code></pre>\n\n<p>Yes, the final purpose has always been to <em>remove</em> the quoted substrings.</p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 48009066, "answer_count": 1, "score": 1, "last_activity_date": 1514470763, "creation_date": 1514278527, "last_edit_date": 1514470763, "question_id": 47976107, "link": "https://stackoverflow.com/questions/47976107/haskell-regex-tdfa-match-and-remove-quoted-substrings", "title": "Haskell, regex, TDFA: match (and remove) quoted substrings", "body": "<p>There is a regular expression matching quoted substrings: <code>\"/\\\"(?:[^\\\"\\\\]|\\\\.)*\\\"/\"</code> (originally <code>/\"(?:[^\"\\\\]|\\\\.)*\"/</code>, see <a href=\"https://stackoverflow.com/questions/249791/regex-for-quoted-string-with-escaping-quotes\">Here</a>). Tested on <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">regex101</a>, it works.</p>\n\n<p>With <code>TDFA</code>, it's syntax:</p>\n\n<pre><code>*** Exception: Explict error in module Text.Regex.TDFA.String : Text.Regex.TDFA.String died:\nparseRegex for Text.Regex.TDFA.String failed:\"/\"(?:[^\"\\]|\\.)*\"/\" (line 1, column 4):\nunexpected \"?\"\nexpecting empty () or anchor ^ or $ or an atom\n</code></pre>\n\n<p>Is there a way co correct it?</p>\n\n<p>Test string: <code>Is big \"problem\", no?</code></p>\n\n<p>Expected result: <code>\"problem\"</code></p>\n\n<p>UPD:</p>\n\n<p>This is full context:</p>\n\n<pre><code>removeQuotedSubstrings :: String -&gt; [String]\nremoveQuotedSubstrings str =\n  let quoteds = concat (str =~ (\"/\\\"(?:[^\\\"\\\\]|\\\\.)*\\\"/\" :: String) :: [[String]])\n  in  quoteds\n</code></pre>\n"}, {"tags": ["haskell", "archlinux", "agda"], "comments": [{"owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 0, "creation_date": 1514268103, "post_id": 47974116, "comment_id": 82918226, "body": "Please add the Agda, standard library and GHC versions."}, {"owner": {"reputation": 101, "user_id": 9102756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ7U9.png?s=128&g=1", "display_name": "prover", "link": "https://stackoverflow.com/users/9102756/prover"}, "reply_to_user": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 0, "creation_date": 1514271295, "post_id": 47974116, "comment_id": 82919113, "body": "@asr edited my question to add that information."}, {"owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 2, "creation_date": 1514273073, "post_id": 47974116, "comment_id": 82919659, "body": "It seems an error in Arch Linux. Using the same versions in Ubuntu the line 5278 of  <code>MAlonzo&#47;...&#47;BooleanAlgebra.hs</code> is <code>(coe MAlonzo.Code.Algebra.d1484 v0 v3 v4) v5)</code>"}, {"owner": {"reputation": 101, "user_id": 9102756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ7U9.png?s=128&g=1", "display_name": "prover", "link": "https://stackoverflow.com/users/9102756/prover"}, "reply_to_user": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 0, "creation_date": 1514504408, "post_id": 47974116, "comment_id": 83000700, "body": "I think archlinux update agda-2.5.3-6 solved this issue since after that update standard library does compile."}, {"owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 1, "creation_date": 1514611851, "post_id": 47974116, "comment_id": 83032726, "body": "Good to know. @prover, thanks for sharing!"}], "owner": {"reputation": 101, "user_id": 9102756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ7U9.png?s=128&g=1", "display_name": "prover", "link": "https://stackoverflow.com/users/9102756/prover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514271262, "creation_date": 1514265275, "last_edit_date": 1514271262, "question_id": 47974116, "link": "https://stackoverflow.com/questions/47974116/agda-compilation-error-in-the-standard-library-possible-archlinux-agda-bug", "title": "Agda compilation error in the standard library. (Possible archlinux agda bug?)", "body": "<p>I'm compiling following trivial program (<code>Agda.agda</code>):</p>\n\n<pre><code>module Agda where\n  open import IO\n  main = run (putStrLn \"Hello, World!\")\n</code></pre>\n\n<p>with this command: <code>agda --compile --ghc-flag=-dynamic Agda.agda</code>. I'm compiling with <code>-dynamic</code> since I'm in archlinux so without this flag Haskell can't find any of the standard libraries. This gives me the following error message:</p>\n\n<pre><code>Calling: ghc -O -o /storage/src/test/Agda -Werror -dynamic -i/storage/src/test -main-is MAlonzo.Code.Agda /storage/src/test/MAlonzo/Code/Agda.hs --make -fwarn-incomplete-patterns -fno-warn-overlapping-patterns\n[60 of 75] Compiling MAlonzo.Code.Algebra.Properties.BooleanAlgebra ( MAlonzo/Code/Algebra/Properties/BooleanAlgebra.hs, MAlonzo/Code/Algebra/Properties/BooleanAlgebra.o )\nCompilation error:\n\nMAlonzo/Code/Algebra/Properties/BooleanAlgebra.hs:5278:70: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n     |\n5278 |                            (coe MAlonzo.Code.Algebra.d1484 v0 v3 v4) \n     |                                                                      ^\n</code></pre>\n\n<p>This seems to be consistent and I can't compile anything that requires this file of the standard library. I am only using official arch packages and nothing else. How can I fix this issue? What am I doing wrong?</p>\n\n<p>EDIT:</p>\n\n<p>Agda version: 2.5.3</p>\n\n<p>GHC version : 8.2.2</p>\n\n<p>Agda-stdlib : 0.14</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514253401, "post_id": 47973109, "comment_id": 82916096, "body": "Can we have an example in Haskell because there are two ways to interpret $f(a,b)$ in Haskell (i.e. do you want e.g. <code>f a b :: (Int,Int,Int) -&gt; Int</code> or <code>f a b :: Int -&gt; Int -&gt; Int</code>?)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514253676, "post_id": 47973109, "comment_id": 82916136, "body": "The type of a function taking <code>n_a</code> inputs is <code>Vec n_a X -&gt; Y</code> where <code>data Vec n a where Nil :: Vec 0 a; Cons ::a -&gt; Vec n a -&gt; Vec (1 + n) a</code>."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514253681, "post_id": 47973109, "comment_id": 82916137, "body": "@DanRobertson Well strictly speaking we won&#39;t know <code>f a b</code> to have either of those types, because <code>f a b</code> might take any number of inputs.  However I think the intention of the puzzle is for a curried function, because having a tuple of arbitrary size is clearly impossible in Haskell.  (That being said currying in this way might be impossible, I&#39;m just not sure of that in the way I am sure taking arbitrary tuples won&#39;t work)"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514253822, "post_id": 47973109, "comment_id": 82916153, "body": "Yes of course. I was using an arbitrary example to clarify whether you wanted currying or not or something odd like <code>Vec</code> above or some kind of typed homogeneous tuple-list hybrid. That clears things up."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514254023, "post_id": 47973109, "comment_id": 82916174, "body": "@DanRobertson The puzzle was given to me as is, so I&#39;d be interested in both/any type of solution.  Currying would be cool, but a solution is a solution, and I&#39;m certainly not going to complain because I find the puzzle interesting, and new ways of thinking are probably good for me."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1514254069, "post_id": 47973109, "comment_id": 82916177, "body": "I\u2019ve no solution I\u2019m afraid."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514271137, "post_id": 47973109, "comment_id": 82919068, "body": "The puzzle is ill-defined. A function type can have an instance of Num."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514271237, "post_id": 47973109, "comment_id": 82919097, "body": "@n.m. I&#39;m not sure what you are getting at.  Your statement is correct but I don&#39;t see how that relates to the puzzle being ill-defined."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514271678, "post_id": 47973109, "comment_id": 82919222, "body": "For example, if you give <code>Int-&gt;Int</code> an instance of <code>Num</code> then say <code>(+)</code> is a two-argument function that returns a <code>Num</code> and is <i>also</i> a one-argument function that returns an instance of <code>Num</code>. There is no way <i>defined in the puzzle</i> to decide which interpretation you want."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514272136, "post_id": 47973109, "comment_id": 82919376, "body": "@n.m. I suppose, would assume that we would probably be interested in the in the latter result.  However this is a really contrived case and I don&#39;t think it really matters what the function does when encountering this type of scenario."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514274475, "post_id": 47973109, "comment_id": 82920045, "body": "You cannot tell the compiler &quot;do whatever you want&quot;, you need to decide on something. The problem here is that neither decision is really expressible in Haskell. Try writing down one in an exact and detailed manner (either one). You will end up with things like &quot;do this for all types which are <i>not</i> functions&quot; or &quot;which are <i>not</i> instances of <code>Num</code>&quot;, These things are not possible (with common safe extensions at any rate). You can say &quot;do this thing for <code>Int</code> and that other thing for functions`, which is what the answer below does."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514359759, "post_id": 47973109, "comment_id": 82944806, "body": "@n.m., something not being a function is quite easy to express with MPTC and a closed type family."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514360926, "post_id": 47973109, "comment_id": 82945244, "body": "@dfeuer I don&#39;t understand closed type families well, cany you show how it&#39;s done?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514282206, "post_id": 47974727, "comment_id": 82922512, "body": "Upvoted, but I wouldn&#39;t call this a &quot;pretty simple approach&quot; ;-) It&#39;s not hard, but it&#39;s not exactly beginner&#39;s material."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514294236, "post_id": 47974727, "comment_id": 82926898, "body": "Another small problem with this is that you <i>need</i> <code>times2</code>. Why not just <code>(*)</code>? <code>f (*) (*) 1 2 3 4</code> will produce a stream of errors, because the type of <code>(*)</code> is too good for <code>f</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1514331866, "post_id": 47974727, "comment_id": 82938569, "body": "I suspect you&#39;re better off counting arrows than looking for <code>Int</code>. You&#39;ll miss <code>Num</code> instances for functions, but catch the rest."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 7, "last_activity_date": 1514269747, "creation_date": 1514269747, "answer_id": 47974727, "question_id": 47973109, "link": "https://stackoverflow.com/questions/47973109/implementing-functional-addition-in-haskell/47974727#47974727", "title": "Implementing functional addition in Haskell", "body": "<p>Here's a pretty simple approach using type families that works monomorphically in the numeric type (e.g., specialized to <code>Int</code>).  We'll need a few extensions:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE InstanceSigs #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies #-}\n</code></pre>\n\n<p>The function <code>f</code> will be defined in a type class:</p>\n\n<pre><code>class VarArgs r s where\n  type F r s\n  f :: r -&gt; s -&gt; F r s\n</code></pre>\n\n<p>and we'll handle the following cases.  If the type of the first function is of form <code>a :: Int -&gt; r</code>, we'll use the following instance to gobble an argument <code>x</code> and feed it to <code>a</code>:</p>\n\n<pre><code>instance VarArgs r s =&gt; VarArgs (Int -&gt; r) s where\n  type F (Int -&gt; r) s = Int -&gt; F r s\n  f :: (Int -&gt; r) -&gt; s -&gt; Int -&gt; F r s\n  f a b x = f (a x) b\n</code></pre>\n\n<p>This has the effect of recursing on the type of <code>a</code> until it's of the form <code>Int</code>.  Then, we'll use a similar instance to recurse on the type <code>b :: Int -&gt; s</code>:</p>\n\n<pre><code>instance VarArgs Int s =&gt; VarArgs Int (Int -&gt; s) where\n  type F Int (Int -&gt; s) = Int -&gt; F Int s\n  f :: Int -&gt; (Int -&gt; s) -&gt; Int -&gt; F Int s\n  f a b x = f a (b x)\n</code></pre>\n\n<p>Ultimately, both functions will be reduced to 0-ary functions of type <code>a, b :: Int</code>, and we can use the terminal instance:</p>\n\n<pre><code>instance VarArgs Int Int where\n  type F Int Int = Int\n  f :: Int -&gt; Int -&gt; Int\n  f a b = a + b\n</code></pre>\n\n<p>Here's a little test to prove it works:</p>\n\n<pre><code>times2 :: Int -&gt; Int -&gt; Int\ntimes2 x y = x * y\ntimes3 :: Int -&gt; Int -&gt; Int -&gt; Int\ntimes3 x y z = x * y * z\n\nfoo :: [Int]\nfoo = [ f times2 times2 1 2 3 4\n      , f times2 times3 1 2 3 4 5\n      , f times3 times2 1 2 3 4 5\n      , f times3 times3 1 2 3 4 5 6]\n</code></pre>\n\n<p>and loading this into GHCi gives:</p>\n\n<pre><code>&gt; foo\n[14,62,26,126]\n&gt;\n</code></pre>\n\n<p>Generalizing this to be polymorphic in any <code>Num</code> type doesn't seem to be straightforward.  Replacing the <code>Int</code> type with a constrained <code>Num n</code> type leads to errors regarding conflicting family instance declarations.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1514412743, "post_id": 47994162, "comment_id": 82966933, "body": "I think an <code>HList</code> probably fits better than a vector--the problem description doesn&#39;t indicate that the function arguments all have the same type. The whole thing works out about the same, except you have <code>++</code> instead of <code>+</code>. But to get maximal type inference, you probably also need to define dropping from both the right and the left."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1514394196, "last_edit_date": 1514394196, "creation_date": 1514386093, "answer_id": 47994162, "question_id": 47973109, "link": "https://stackoverflow.com/questions/47973109/implementing-functional-addition-in-haskell/47994162#47994162", "title": "Implementing functional addition in Haskell", "body": "<p>This is easy and simple - much simpler than @K.A.Buhr's type family approach, in my opinion - if you tweak your representation of an <em>n</em>-ary function, instead using a unary function of an <em>n</em>-dimensional vector.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n\nimport Prelude hiding (splitAt)\nimport Data.Bifunctor\n</code></pre>\n\n<p>The usual suspects: (type-level) natural numbers, their (value-level) singletons, type-level addition, and vectors.</p>\n\n<pre><code>data Nat = Z | S Nat\ndata Natty n where\n    Zy :: Natty Z\n    Sy :: Natty n -&gt; Natty (S n)\ntype family n + m where\n    Z + m = m\n    S n + m = S (n + m)\n\ndata Vec n a where\n    Nil :: Vec Z a\n    (:&gt;) :: a -&gt; Vec n a -&gt; Vec (S n) a\n</code></pre>\n\n<p><code>splitAt</code> takes a runtime <code>Natty</code> - it needs to know at runtime where to split the vector - and a vector that is at least as long as the <code>Natty</code>.</p>\n\n<pre><code>splitAt :: Natty n -&gt; Vec (n + m) a -&gt; (Vec n a, Vec m a)\nsplitAt Zy xs = (Nil, xs)\nsplitAt (Sy n) (x :&gt; xs) =\n    let (ys, zs) = splitAt n xs\n    in (x :&gt; ys, zs)\n</code></pre>\n\n<p>Then your <code>f</code>, which I'm calling <code>splitApply</code>, is a straightforward application of <code>splitAt</code>.</p>\n\n<pre><code>splitApply :: Natty n -&gt; (Vec n a -&gt; b) -&gt; (Vec m a -&gt; c) -&gt; Vec (n + m) a -&gt; (b, c)\nsplitApply at f g xs = bimap f g $ splitAt at xs\n</code></pre>\n\n<p>(I haven't bothered to show the \"add the results\" part, because it's so simple that I bored myself writing it. You could argue that, since <strong>Hask</strong> is a monoidal category, <code>(,)</code> represents a sort of addition anyway.)</p>\n"}], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1571427718, "creation_date": 1514250922, "last_edit_date": 1571427718, "question_id": 47973109, "link": "https://stackoverflow.com/questions/47973109/implementing-functional-addition-in-haskell", "title": "Implementing functional addition in Haskell", "body": "<p>I was given a puzzle to do the following in Haskell,</p>\n\n<blockquote>\n  <p><code>f</code> takes two functions, function <code>a</code> and function <code>b</code>.  Function <code>a</code> takes  <strong>n<sub>a</sub></strong> inputs and returns a <code>Num</code> type and function <code>b</code> takes <strong>n<sub>b</sub></strong> inputs and returns a <code>Num</code> type.  <code>f</code> returns a new function of arity <strong>n<sub>a</sub>+n<sub>b</sub></strong> that applies <code>a</code> to the first <strong>n<sub>a</sub></strong> arguments, <strong>n<sub>b</sub></strong> to the rest of the arguments and returns their sum.</p>\n</blockquote>\n\n<p>In mathematics I would write this as:</p>\n\n<p><a href=\"https://web.archive.org/web/20171228121450/https://a-ta.co/mathjax/!ZihhLGIpKGlfMSxpXzIsIFxkb3RzLGlfe25fYX0saV97bl9hKzF9LCBcZG90cywgaV97bl9hK25fYn0pID0KYShpXzEsaV8yLCBcZG90cyxpX3tuX2F9LGlfe25fYSsxfSkgKwpiKGlfe25fYSsxfSxpX3tuX2ErMn0sIFxkb3RzLCBpX3tuX2Erbl9ifSk=.svg\" rel=\"nofollow noreferrer\"><img src=\"https://web.archive.org/web/20171228121450/https://a-ta.co/mathjax/!ZihhLGIpKGlfMSxpXzIsIFxkb3RzLGlfe25fYX0saV97bl9hKzF9LCBcZG90cywgaV97bl9hK25fYn0pID0KYShpXzEsaV8yLCBcZG90cyxpX3tuX2F9LGlfe25fYSsxfSkgKwpiKGlfe25fYSsxfSxpX3tuX2ErMn0sIFxkb3RzLCBpX3tuX2Erbl9ifSk=.svg\" alt=\"latex of formula\"></a></p>\n\n<p>My first na\u00efve attempt at this in Haskell was:</p>\n\n<pre><code>f a b = flip ((+) . a) . b\n</code></pre>\n\n<p>But this only works if <code>a</code> is a unary function.</p>\n\n<p>After this I thought about the puzzle for a long while without being able to come up with even an idea for how I might do this.  This is the first time in a long time I have been this utterly stumped in Haskell.</p>\n\n<p>How might I solve this puzzle?  Is there a solution to this puzzle? <em>(I was given this puzzle by a friend and I don't believe they had a actual solution in mind at the time)</em></p>\n"}, {"tags": ["list", "haskell", "optimization", "functional-programming", "map-function"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6683535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153372728107920/picture?type=large", "display_name": "Arms Wide Open", "link": "https://stackoverflow.com/users/6683535/arms-wide-open"}, "edited": false, "score": 1, "creation_date": 1514245066, "post_id": 47972642, "comment_id": 82915078, "body": "and there&#39;s sensible elegance in the explanation. i truly appreciate you taking the time!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1514243830, "creation_date": 1514243830, "answer_id": 47972642, "question_id": 47972597, "link": "https://stackoverflow.com/questions/47972597/haskell-argument-application-through-x-in-map-to-a-list-of-inflix-operator/47972642#47972642", "title": "Haskell argument application through &#39;$x&#39; in &#39;map&#39; to a list of inflix operator functions. How does it work?", "body": "<p>If I understand your question correctly, you are wondering what happens if you write <code>($ 3)</code>?</p>\n\n<p>Haskell syntax has a concept called \"<a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"noreferrer\"><strong><em>Section of an infix operator</em></strong></a>\". It means that if you write an expression with an operator (here <code>+</code>), then:</p>\n\n<pre><code>(2 +) == \\x -&gt; 2 + x == (+) 2\n(+ 2) == \\x -&gt; x + 2 == flip (+) 2\n</code></pre>\n\n<p>Haskell is a <em>functional</em> programming language. One of the aspects of a functional programming language is that you can take functions as parameters. This is not limited to functional programming languages: in Java, C#, C++, etc. you can pass function/method references to functions/methods, and for instance call these functions with parameters.</p>\n\n<p>So you have written:</p>\n\n<pre><code>map (\\x -&gt; ($) x 3) [(4+), (10*), (^2), sqrt]\n</code></pre>\n\n<p>and <code>\\x -&gt; ($) x 3</code> is just an ordinary function. So if we apply this to the first argument, we get:</p>\n\n<pre><code>(\\x -&gt; ($) x 3) (4+)\n-&gt; ($) (4+) 3\n-&gt; (4+) 3\n-&gt; 4 + 3\n-&gt; 7\n</code></pre>\n\n<p>So there is nothing special with the <code>($ 3)</code> case, it works with any operator where we only fill in the right hand side of the operator.</p>\n\n<p>In fact you already used that concept with <code>(^2)</code> as well. Your list actually looks like:</p>\n\n<pre><code>map (flip ($) 3) [(+) 4, (*) 10, flip (^) 2, sqrt]\n</code></pre>\n\n<p>So you used sectioning - both left and right - in the elements of the list.</p>\n"}], "owner": {"reputation": 35, "user_id": 6683535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153372728107920/picture?type=large", "display_name": "Arms Wide Open", "link": "https://stackoverflow.com/users/6683535/arms-wide-open"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 47972642, "answer_count": 1, "score": 1, "last_activity_date": 1514508396, "creation_date": 1514243132, "last_edit_date": 1514508396, "question_id": 47972597, "link": "https://stackoverflow.com/questions/47972597/haskell-argument-application-through-x-in-map-to-a-list-of-inflix-operator", "title": "Haskell argument application through &#39;$x&#39; in &#39;map&#39; to a list of inflix operator functions. How does it work?", "body": "<p>I would just like to know, out of curiosity pertaining to how this functions, is the intermediary expression below resulting from some sort of optimization? I do understand that the $ is actually a function, which is being supplied only with one argument. Somehow, through application of this function to a function from the list provided by 'map', it manages to see that '$' function is lacking precisely a function, which as I mentioned is provided by 'map'. Is this optimization behavior something unique to function application with '$'? Because, for what its worth I cannot see it how this would follow from the function definitions of 'map' and '$', which I provide for convenience below. </p>\n\n<p>From an outset, it seems that the '$3' should emerge before the function expressions, but such expressions will not evaluate in compiler. Here is the expanded intermediary expression of the optimization, that is seemingly taking place:</p>\n\n<pre><code>[(4+) $3, (10*) $3, (^2) $3, sqrt $3]\n</code></pre>\n\n<p>definition - $</p>\n\n<pre><code>($) :: (a -&gt; b) -&gt; a -&gt; b  \nf $ x = f x\n</code></pre>\n\n<p>definition - map     </p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]  \nmap _ [] = []  \nmap f (x:xs) = f x : map f xs  \n</code></pre>\n\n<p>example used</p>\n\n<pre><code>map ($ 3) [(4+), (10*), (^2), sqrt]\n</code></pre>\n\n<p>returned result</p>\n\n<pre><code>[7.0,30.0,9.0,1.7320508075688772]\n</code></pre>\n"}, {"tags": ["haskell", "typeclass", "overloading"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 8, "creation_date": 1514234009, "post_id": 47971360, "comment_id": 82913280, "body": "&quot;just throw the error&quot; at runtime is exactly what statically typed languages try to avoid. A main point of having a type system is detecting certain kinds of errors early, at compile time."}, {"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514234193, "post_id": 47971360, "comment_id": 82913325, "body": "No, I mean throw the error when encountering the undefined function during compilation."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 11, "creation_date": 1514234579, "post_id": 47971360, "comment_id": 82913404, "body": "If I write <code>f :: a -&gt; a -&gt; Bool</code>, and later apply it to something that can&#39;t be compared for equality, say, <code>f (1+) (1-)</code>, how should the compiler detect that we now need to have an <code>(==)</code> defined in order to throw an error? Answer: the compiler records a small fact about <code>f</code> that it applies <code>(==)</code> to its arguments, so that it knows when it sees calls to <code>f</code> to check that <code>(==)</code> is available. How do we notate that fact? Answer: we put it in the type, as <code>f :: Eq a =&gt; a -&gt; a -&gt; Bool</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1514239326, "post_id": 47971360, "comment_id": 82914232, "body": "@lotolmencre Ah, maybe I&#39;m starting to see your point. It&#39;s possible that you are confused since you are used to C++ templates. C++ templates are more-or-less compiled (including type checking) for every instantiation of the template arguments. Haskell&#39;s (bounded-)polymorphic functions are only compiled once, and there is no &quot;template instantiation&quot; (similar to e.g. Java&#39;s generics). In C++, you need header files to contain template sources. In Haskell, you don&#39;t need the source after compilation."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514239563, "post_id": 47971360, "comment_id": 82914269, "body": "If I had to make a forced comparison, typeclasses are vaguely related to C++20 concepts, except that in Haskell there&#39;s no SFINAE: the function is compiled early (unlike templates), and constraints must guarantee that the function definition is OK for all types (providing the constraints)."}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "edited": false, "score": 0, "creation_date": 1514277998, "post_id": 47971360, "comment_id": 82921045, "body": "&gt; I suspect there is a theoretical basis in these for how Haskell does things here.  One of the theoretical things that I would like to mention that is going on here is parametricity and free theorems."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1522961671, "post_id": 47971470, "comment_id": 86374504, "body": "&quot;Because that&#39;s how it&#39;s designed.&quot; Okay, sure, but why is it designed that way?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1522967623, "post_id": 47971470, "comment_id": 86376758, "body": "@DanielWagner: well that is argued in the remainder of the answer. For example to make explicit what needs te be explicit, etc. As far as I know not all rationale are completely documented by the designers, and there can be confusion if some was &quot;on purpose&quot; or more a &quot;(lucky) coincidence&quot; :)."}, {"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1588085258, "post_id": 47971470, "comment_id": 108760859, "body": "But these contracts are not enforced by the type system, right?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1588086458, "post_id": 47971470, "comment_id": 108761626, "body": "@bob: what contracts exactly?"}, {"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1588087189, "post_id": 47971470, "comment_id": 108762119, "body": "identity/associativity"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1588089839, "post_id": 47971470, "comment_id": 108763696, "body": "@bob: no although there exists theorem provers that can sometimes (dis)proof these automatically."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 18, "last_activity_date": 1514275454, "last_edit_date": 1514275454, "creation_date": 1514230230, "answer_id": 47971470, "question_id": 47971360, "link": "https://stackoverflow.com/questions/47971360/typeclasses-and-overloading-what-is-the-connection/47971470#47971470", "title": "Typeclasses and overloading, what is the connection?", "body": "<p>In short: <strong>because that is how Haskell was designed</strong>.</p>\n\n<blockquote>\n  <p>Why put <code>(Eq a)</code> in the signature. If <code>==</code> is not defined for a then why not just throw the error when encountering <code>a == b</code>?</p>\n</blockquote>\n\n<p>Why do we put the types in the signature of a C++ program (and not just somewhere as an assertion in the body)? Because that is how C++ is designed. Typically a concept on what programming languages are built is \"<em>make explicit what needs to be explicit</em>\".</p>\n\n<p>It is not said that a Haskell module is open-source. So that means we only have the signature available. It would thus mean that when we for instance write:</p>\n\n<pre><code>Prelude&gt; foo A A\n\n&lt;interactive&gt;:4:1: error:\n    \u2022 No instance for (Eq A) arising from a use of \u2018foo\u2019\n    \u2022 In the expression: foo A A\n      In an equation for \u2018it\u2019: it = foo A A\n</code></pre>\n\n<p>We would frequently write <code>foo</code> here with types that have no <code>Eq</code> typeclass. As a result, we would get a lot of errors that are only discovered at compile time (or if Haskell was a dynamic language, at runtime). The idea of putting <code>Eq a</code> in the type signature is that we can look up the signature of <code>foo</code> in advance, and thus ensure that the types are instance of the typeclass.</p>\n\n<p>Note that you do not have to write type signatures yourself: Haskell can typically derive the signature of a function, but a signature should include all the necessary information to call and use a function effectively. By adding type constraints, we speed up development.</p>\n\n<blockquote>\n  <p>What is up with that? Why can't I have two functions with the same name but operating on different types.</p>\n</blockquote>\n\n<p>Again: that is how Haskell is designed. Functions in functional programming languages are \"<em>first class citizens</em>\". It means these usually have a name and we want to avoid name clashes as much as possible. Just like classes in C++ typically have a unique name (except for namespaces).</p>\n\n<p>Say you would define two different functions:</p>\n\n<pre><code>incr :: Int -&gt; Int\nincr = (+1)\n\nincr :: Bool -&gt; Bool\nincr _ = True\n\nbar = incr\n</code></pre>\n\n<p>Then which <code>incr</code> would <code>bar</code> have to select? Of course we can make the types explicit (i.e. <code>incr :: Bool -&gt; Bool</code>), but usually we want to avoid that work, since it introduces a lot of noise.</p>\n\n<p>Another good reason why we do not do that, is because typically a typeclass is not just a collection of functions: it adds <strong>contracts</strong> to these functions. For instance the <code>Monad</code> typeclass has to satisfy certain relations between the functions. For example <code>(&gt;&gt;= return)</code> should be equivalent with <code>id</code>. In other words, the typeclass:</p>\n\n<pre><code>class Monad m where\n    (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n    return :: a -&gt; m a\n</code></pre>\n\n<p>Does not describes two <em>independent</em> functions <code>(&gt;&gt;=)</code> and <code>return</code>: this is a set of functions. You have them both (usually with some contracts between the specific <code>&gt;&gt;=</code> and <code>return</code>), or none of these at all.</p>\n"}, {"comments": [{"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1588086263, "post_id": 47971589, "comment_id": 108761518, "body": "Can&#39;t we just pass <code>&gt;&gt;=</code> explicitly to <code>join</code>? All we would lose would be implicit constraints.."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 38, "last_activity_date": 1514231744, "last_edit_date": 1514231744, "creation_date": 1514231410, "answer_id": 47971589, "question_id": 47971360, "link": "https://stackoverflow.com/questions/47971360/typeclasses-and-overloading-what-is-the-connection/47971589#47971589", "title": "Typeclasses and overloading, what is the connection?", "body": "<p>I agree with much of <a href=\"https://stackoverflow.com/a/47971470/465378\">Willem Van Onsem\u2019s answer</a>, but I think it overlooks one of the principal advantages of typeclasses over truly ad-hoc overloading: <strong>abstraction</strong>. Imagine we used ad-hoc overloading instead of typeclasses to define the <code>Monad</code> operations:</p>\n\n<pre><code>-- Maybe\npure :: a -&gt; Maybe a\npure = Just\n\n(&gt;&gt;=) :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b\nJust x &gt;&gt;= f = f x\nNothing &gt;&gt;= _ = Nothing\n\n-- Either\npure :: a -&gt; Either e a\npure = Right\n\n(&gt;&gt;=) :: Either e a -&gt; (a -&gt; Either e b) -&gt; Either e b\nRight x &gt;&gt;= f = f x\nLeft err &gt;&gt;= _ = Left err\n</code></pre>\n\n<p>Now, we know that every monad can be expressed in terms of <code>pure</code> and <code>&gt;&gt;=</code>, as above, but we <em>also</em> know that they can be equivalently expressed using <code>fmap</code>, <code>pure</code>, and <code>join</code>. Therefore, we should be able to implement a <code>join</code> function that works on <em>any</em> monad:</p>\n\n<pre><code>join x = x &gt;&gt;= id\n</code></pre>\n\n<p>However, now we have a problem. What is <code>join</code>\u2019s type?</p>\n\n<p>Clearly, <code>join</code> has to be polymorphic, since it works on any monad by design. But giving it the type signature <code>forall m a. m (m a) -&gt; m a</code> would obviously be wrong, since it <em>doesn\u2019t</em> work for all types, only monadic ones. Therefore, we need something in our type that expresses the need for the existence of some operation <code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code>, which is exactly what the typeclass constraint provides.</p>\n\n<p>Given this, it becomes clear that ad-hoc overloading makes it possible to overload names, but it is impossible to abstract over those overloaded names because there is no guarantee the different implementations are related in any way. You <em>could</em> define monads without typeclasses, but then you couldn\u2019t define <code>join</code>, <code>when</code>, <code>unless</code>, <code>mapM</code>, <code>sequence</code>, and all the other nice things that you get for free when you define just two operations.</p>\n\n<p>Therefore, typeclasses are necessary in Haskell to enable code reuse and to avoid enormous amounts of duplication. But could you have <em>both</em> typeclass-style overloading and type-directed, ad-hoc name overloading? <strong>Yes</strong>, and in fact, Idris does. But Idris\u2019s type inference is very different from Haskell\u2019s, so it\u2019s more feasible to support than it is in Haskell for many of the reasons in Willem\u2019s answer.</p>\n"}, {"comments": [{"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "edited": false, "score": 0, "creation_date": 1514234336, "post_id": 47971717, "comment_id": 82913356, "body": "Ah, so <code>(Eq a) =&gt; a -&gt; a -&gt; Bool</code> means <code>forall a. a in Eq =&gt; a -&gt; a -&gt; Bool</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "edited": false, "score": 0, "creation_date": 1514234582, "post_id": 47971717, "comment_id": 82913405, "body": "@lotolmencre If I&#39;m understanding you correctly, it roughly means something like that (that <code>a</code> must be a &quot;member&quot; of the &quot;type class&quot; Eq)... There is a little more to it since technically <code>(Eq a)</code> is the (type-level) application of <code>Eq</code> to a type, to get a constraint, though. <code>Eq</code> takes in one type and gives back a constraint. This is important because, for example, some type classes take in more than one type (you must enable an extension to do this, but it is a common extension)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "edited": false, "score": 0, "creation_date": 1514234827, "post_id": 47971717, "comment_id": 82913453, "body": "One way to look at it is that single parameter type classes are predicates on types (so <code>Eq a =&gt; ...</code> means &quot;<code>a</code> has an instance of <code>Eq</code>&quot;). This extends pretty nicely to multi-parameter type classes, since it lets you look at them as relations between types. That might be getting a bit ahead of things, but it can be good to get an idea of where things are heading."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 6, "last_activity_date": 1514234234, "last_edit_date": 1514234234, "creation_date": 1514232697, "answer_id": 47971717, "question_id": 47971360, "link": "https://stackoverflow.com/questions/47971360/typeclasses-and-overloading-what-is-the-connection/47971717#47971717", "title": "Typeclasses and overloading, what is the connection?", "body": "<p>This only answers question 1 (directly, at least).</p>\n\n<p>The type signature <code>f :: a -&gt; a -&gt; Bool</code> is shorthand for <code>f :: forall a. a -&gt; a -&gt; Bool</code>. <code>f</code> would not truly work <em>for all</em> types <code>a</code> if it only works for <code>a</code>s that have <code>(==)</code> defined. This restriction to types that have <code>(==)</code> is expressed using the constraint <code>(Eq a)</code> in <code>f :: forall a. (Eq a) =&gt; a -&gt; a -&gt; Bool</code>.</p>\n\n<p>\"For all\"/universal quantification is at the core of Haskell's (parametric) polymorphism and, among other things, provides the powerful and important properties of <a href=\"https://bartoszmilewski.com/2014/09/22/parametricity-money-for-nothing-and-theorems-for-free/\" rel=\"noreferrer\">parametricity</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 1, "last_activity_date": 1514244929, "creation_date": 1514244929, "answer_id": 47972718, "question_id": 47971360, "link": "https://stackoverflow.com/questions/47971360/typeclasses-and-overloading-what-is-the-connection/47972718#47972718", "title": "Typeclasses and overloading, what is the connection?", "body": "<p>Haskell holds to two axioms (among others):</p>\n\n<ol>\n<li>Every variable is useable as an expression in its own right;</li>\n<li>Every expression has a type that <em>precisely</em> specifies what you are allowed to do with it.</li>\n</ol>\n\n<p>If you had</p>\n\n<pre><code>f :: A -&gt; A\n</code></pre>\n\n<p>and</p>\n\n<pre><code>f :: B -&gt; B\n</code></pre>\n\n<p>then, according to the principles adopted in Haskell, <code>f</code> would still be a valid expression, on its own  which would still have to have a <em>single</em> type. While it's possible to do that using subtyping, it was deemed much more complicated than the type-class solution.</p>\n\n<p>Similarly, the need for <code>Eq a</code> in</p>\n\n<pre><code>(==) :: Eq a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>comes from the fact that the type of <code>==</code> has to completely describe what you can do with it. If you can only call it at certain types, the type signature has to reflect that.</p>\n"}], "owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2499, "favorite_count": 9, "accepted_answer_id": 47971589, "answer_count": 4, "score": 18, "last_activity_date": 1514275454, "creation_date": 1514229153, "question_id": 47971360, "link": "https://stackoverflow.com/questions/47971360/typeclasses-and-overloading-what-is-the-connection", "title": "Typeclasses and overloading, what is the connection?", "body": "<p>I am currently trying to wrap my head around typeclasses and instances and I don't quite understand the point of them yet. I have two questions on the matter so far:</p>\n\n<p>1) Why is it necessary to have a type class in a function signature when the function uses some function from that type class. Example:</p>\n\n<pre><code>f :: (Eq a) =&gt; a -&gt; a -&gt; Bool\nf a b = a == b\n</code></pre>\n\n<p>Why put <code>(Eq a)</code> in the signature. If <code>==</code> is not defined for <code>a</code> then why not just throw the error when encountering <code>a == b</code>? What is the point in having to declare the type class ahead?</p>\n\n<p>2) How are type classes and function overloading related?</p>\n\n<p>It is not possible to do this:</p>\n\n<pre><code>data A = A\ndata B = B\n\nf :: A -&gt; A\nf a = a\n\nf :: B -&gt; B\nf b = b\n</code></pre>\n\n<p>But it is possible to do this:</p>\n\n<pre><code>data A = A\ndata B = B\n\nclass F a where\n  f :: a -&gt; a\n\ninstance F A where\n  f a = a\n\ninstance F B where\n  f b = b\n</code></pre>\n\n<p>What is up with that? Why can't I have two functions with the same name but operating on different types... Coming from C++ I find that very strange. But I probably have wrong conceptions about what these things really are.  but once I wrap them in these type class instance thingies I can.</p>\n\n<p>Feel free to hurl category or type theoretical words at me as well, as I am learning about these subjects in parallel to learning Haskell and I suspect there is a theoretical basis in these for how Haskell does things here.</p>\n"}, {"tags": ["list", "haskell", "take"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1514222877, "last_edit_date": 1514222877, "creation_date": 1514222679, "answer_id": 47970696, "question_id": 47970581, "link": "https://stackoverflow.com/questions/47970581/haskell-how-to-take-n-items-from-a-tuple-list-after-sorting/47970696#47970696", "title": "Haskell - How to take n items from a tuple list after sorting", "body": "<p>The problem here is that <code>sortBy (flip compare `on` snd)</code> is <strong>not</strong> a list of tuples, it is a function that takes as input a list of tuples and returns a list of tuples.</p>\n\n<p>We can use the <strong>function composition operator <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:.\" rel=\"noreferrer\"><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code></a></strong>:</p>\n\n<pre><code>sortWords :: Ord b =&gt; [(a,b)] -&gt; [(a,b)]\nsortWords = take 3 . sortBy (flip compare `on` snd)\n</code></pre>\n\n<p>here we thus first will apply <code>sortBy (flip compare `on` snd)</code> on the input, and then we will apply <code>take 3</code> on the output of that function.</p>\n"}], "owner": {"reputation": 49, "user_id": 8929879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jSMkb.jpg?s=128&g=1", "display_name": "k1r4n", "link": "https://stackoverflow.com/users/8929879/k1r4n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 47970696, "answer_count": 1, "score": 2, "last_activity_date": 1514508370, "creation_date": 1514221757, "last_edit_date": 1514508370, "question_id": 47970581, "link": "https://stackoverflow.com/questions/47970581/haskell-how-to-take-n-items-from-a-tuple-list-after-sorting", "title": "Haskell - How to take n items from a tuple list after sorting", "body": "<p>Hi I am a beginner to haskell. I am trying to get the first 3 items from this tuple list:</p>\n\n<pre><code>[(\"and\",2),(\"cat\",1),(\"dog\",1),(\"rabbit\",1),(\"the\",2)]\n</code></pre>\n\n<p>First I sort the list by frequency and descending order: </p>\n\n<pre><code>sortWords =  sortBy(flip compare `on` snd)\n</code></pre>\n\n<p>This gives me the result:</p>\n\n<pre><code>[(\"and\",2),(\"the\",2),(\"cat\",1),(\"dog\",1),(\"rabbit\",1)]\n</code></pre>\n\n<p>Then I know I can do the function:</p>\n\n<pre><code>take 3 [(\"and\",2),(\"the\",2),(\"cat\",1),(\"dog\",1),(\"rabbit\",1)] \n</code></pre>\n\n<p>which gives me the <strong>desired</strong> result of <code>[(\"and\",2),(\"the\",2),(\"cat\",1)]</code></p>\n\n<p>However, I want to be able to incorporate the <code>take</code> function into the <code>sortWords</code> function. The problem is, when I attempt to do this, for example:</p>\n\n<pre><code>sortWords =  take 3 (sortBy(flip compare `on` snd))\n</code></pre>\n\n<p>this does not work. </p>\n\n<p>Ideally, I want to keep <code>sortWords</code> as the end function so I do not want to pass it into another to be able to perform the <code>take</code> function. If there's a way to perform <code>take</code> before calling <code>sortWords</code> that could be a solution, however I have also tried this and found that the words which are taken are not sorted first and therefore do not give me the result I want. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1514217468, "post_id": 47969861, "comment_id": 82909608, "body": "Good question, but can you add a description of the algorithm? It&#39;s hard to differentiate &#39;inefficiency&#39; from &#39;inevitable cost&#39; when you don&#39;t know what the code should be doing. Some broad observations: <code>intsToQuads</code> takes 25% of time and 17% of alloc - but it looks like that function should run in constant memory; <code>44:25-45</code> allocates almost nothing - it&#39;s a very tight loop (very good!); <code>55:13-23</code> and <code>51:11-25</code> collectively allocated 60% of your programs memory - this is your first avenue of attack (since your program spends 70% time on GC, which isn&#39;t terrible nor good)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1514217584, "post_id": 47969861, "comment_id": 82909636, "body": "Also, many of your cost centres are named the same thing (these are autogenerated by GHC) which can make debugging confusing. Solely for readability, it may be useful to either manually add cost centres (and give them descriptive names) or to split your functions into many more functions (which would make the autogenerated names of GHC slightly more unique)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514314997, "post_id": 47969861, "comment_id": 82933850, "body": "Some GC cost is inevitable when building large structures. You may be able to reduce it by increasing the initial heap size."}], "answers": [{"comments": [{"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1514345412, "post_id": 47981994, "comment_id": 82940876, "body": "I could reach same max residency but not performance time, maybe due to my misapplication of your guide. Could you give me the full modified code?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1514346438, "post_id": 47981994, "comment_id": 82941073, "body": "Using <code>ghc -fforce-recomp -O2</code>?  Remember performance without <code>O2</code> makes baby Knuth cry."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1514346955, "post_id": 47981994, "comment_id": 82941157, "body": "Still same. I was already applying <code>-O2</code>. It takes about 1.3sec."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1514348512, "post_id": 47981994, "comment_id": 82941440, "body": "Ah, my claim of 0.39 seconds was looking at the mutator only (look at the quoted output) and omitted GC.  We should be able to get better efficiency and thus better performance by finding why GC is taking so long if desired."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1514351572, "post_id": 47981994, "comment_id": 82942107, "body": "<code>intsToQuads</code> looks like a pretty bad design (not tail recursive, for example), and I don&#39;t feel confident it is doing... whatever you&#39;d want it to do."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1514348558, "last_edit_date": 1514348558, "creation_date": 1514310540, "answer_id": 47981994, "question_id": 47969861, "link": "https://stackoverflow.com/questions/47969861/how-can-i-optimize-big-intmap-generation/47981994#47981994", "title": "How can I optimize big IntMap generation?", "body": "<p>Your algorithm is a bit too lazy, you are putting unevaluated thunks in your map.</p>\n\n<p>Your original code performed as such:</p>\n\n<pre><code>&lt;&lt;ghc: 1185249008 bytes, 1136 GCs, 85006914/288126544 avg/max bytes residency (10 samples), 827M in use, 0.000 INIT (0.002 elapsed), 0.595 MUT (0.605 elapsed), 1.830 GC (2.065 elapsed) :ghc&gt;&gt;\n./jeiea +RTS -tstderr  2.43s user 0.32s system 99% cpu 2.773 total\n</code></pre>\n\n<p>That is, 288MB residency, 2.4 seconds.</p>\n\n<p>But if we force the evaluation of intsToQuads:</p>\n\n<pre><code>allCasesST :: Int -&gt; STUArray s Int Int -&gt; Int -&gt; ST s (M.IntMap Int)\nallCasesST ix clocks pushs\n  | ix &gt; 9 = do\n    cs &lt;- getElems clocks\n    let n = intsToQuads cs\n    n `seq` return (M.singleton n pushs)\n</code></pre>\n\n<p>Then the the performance is:</p>\n\n<pre><code>&lt;&lt;ghc: 1151694576 bytes, 1104 GCs, 26972457/72834536 avg/max bytes residency (11 samples), 215M in use, 0.000 INIT (0.002 elapsed), 0.500 MUT (0.515 elapsed), 0.735 GC (0.816 elapsed) :ghc&gt;&gt;\n./jeiea +RTS -tstderr  1.24s user 0.11s system 98% cpu 1.367 total\n</code></pre>\n\n<p>Which is 72MB max residency and 1.25 seconds.</p>\n\n<p>If we apply the same modification to <code>applySwitch</code> and <code>next</code> we get performance of:</p>\n\n<pre><code>&lt;&lt;ghc: 1151694576 bytes, 1104 GCs, 26972457/72834536 avg/max bytes residency (11 samples), 215M in use, 0.000 INIT (0.002 elapsed), 0.389 MUT (0.395 elapsed), 0.517 GC (0.573 elapsed) :ghc&gt;&gt;\n</code></pre>\n\n<p>Which is 72MB residency and about 1 second but the variance is huge.</p>\n\n<p>EDIT:</p>\n\n<p>The full code and run:</p>\n\n<pre><code>import Control.Monad (forM_)\nimport Control.Monad.ST\nimport Data.Array\nimport Data.Array.ST\nimport Data.Bits\nimport Data.List\nimport qualified Data.IntMap as M\n\ntype Switch = Int\ntype Clock = Int\n\nswitches :: Array Switch [Clock]\nswitches = listArray (0, 9) [\n  [0, 1, 2],\n  [3, 7, 9, 11],\n  [4, 10, 14, 15],\n  [0, 4, 5, 6, 7],\n  [6, 7, 8, 10, 12],\n  [0, 2, 14, 15],\n  [3, 14, 15],\n  [4, 5, 7, 1, 15],\n  [1, 2, 3, 4, 5],\n  [3, 4, 5, 9, 13]]\n\ntype Quads = Int\n\nintsToQuads :: [Int] -&gt; Quads\nintsToQuads [] = 0\nintsToQuads (x:xs) = x .|. (intsToQuads xs `shiftL` 2)\n\nswitchCases :: [[Int]]\nswitchCases = sequence $ replicate 10 [0..3]\n\napplySwitch :: Int -&gt; STUArray s Int Int -&gt; ST s ()\napplySwitch sw clocks = forM_ (switches ! sw) $ \\ix -&gt; do\n  clock &lt;- readArray clocks ix\n  let n = ((clock + 1) `rem` 4)\n  n `seq` writeArray clocks ix n\n\nallCasesST :: Int -&gt; STUArray s Int Int -&gt; Int -&gt; ST s (M.IntMap Int)\nallCasesST ix clocks pushs\n  | ix &gt; 9 = do\n    cs &lt;- getElems clocks\n    let n = intsToQuads cs\n    n `seq` return (M.singleton n pushs)\n  | otherwise = do\n    rs &lt;- mapM next [pushs..pushs + 3]\n    return (M.unions rs)\n  where\n    next pu = do\n      let n = ix + 1\n      rs &lt;- n `seq` allCasesST n clocks pu\n      applySwitch ix clocks\n      return rs\n\nallCases :: M.IntMap Int\nallCases = runST $ do\n  st &lt;- newArray (0,15) 0\n  allCasesST 0 st 0\n\nmain = do\n  putStrLn . show $ M.lookup 0 allCases\n  return ()\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>% time ./jeiea +RTS -tstderr\nJust 0\n&lt;&lt;ghc: 1151694576 bytes, 1104 GCs, 26972457/72834536 avg/max bytes residency (11 samples), 215M in use, 0.000 INIT (0.005 elapsed), 0.812 MUT (0.820 elapsed), 0.979 GC (1.093 elapsed) :ghc&gt;&gt;\n./jeiea +RTS -tstderr  1.79s user 0.16s system 99% cpu 1.971 total\n</code></pre>\n"}], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 47981994, "answer_count": 1, "score": 3, "last_activity_date": 1514348558, "creation_date": 1514215012, "question_id": 47969861, "link": "https://stackoverflow.com/questions/47969861/how-can-i-optimize-big-intmap-generation", "title": "How can I optimize big IntMap generation?", "body": "<p>The below code's <code>allCases</code> is 2^20 size <code>IntMap</code> and its generation takes heavy computation and memory. I don't know whether this is inevitable cost, and how can I find out the spot making inefficiency.</p>\n\n<pre><code>import Control.Monad (forM_)\nimport Control.Monad.ST\nimport Data.Array\nimport Data.Array.ST\nimport Data.Bits\nimport Data.List\nimport qualified Data.IntMap as M\n\ntype Switch = Int\ntype Clock = Int\n\nswitches :: Array Switch [Clock]\nswitches = listArray (0, 9) [\n  [0, 1, 2],\n  [3, 7, 9, 11],\n  [4, 10, 14, 15],\n  [0, 4, 5, 6, 7],\n  [6, 7, 8, 10, 12],\n  [0, 2, 14, 15],\n  [3, 14, 15],\n  [4, 5, 7, 1, 15],\n  [1, 2, 3, 4, 5],\n  [3, 4, 5, 9, 13]]\n\ntype Quads = Int\n\nintsToQuads :: [Int] -&gt; Quads\nintsToQuads [] = 0\nintsToQuads (x:xs) = x .|. (intsToQuads xs `shiftL` 2)\n\nswitchCases :: [[Int]]\nswitchCases = sequence $ replicate 10 [0..3]\n\napplySwitch :: Int -&gt; STUArray s Int Int -&gt; ST s ()\napplySwitch sw clocks = forM_ (switches ! sw) $ \\ix -&gt; do\n  clock &lt;- readArray clocks ix\n  writeArray clocks ix ((clock + 1) `rem` 4)\n\nallCasesST :: Int -&gt; STUArray s Int Int -&gt; Int -&gt; ST s (M.IntMap Int)\nallCasesST ix clocks pushs\n  | ix &gt; 9 = do\n    cs &lt;- getElems clocks\n    return (M.singleton (intsToQuads cs) pushs)\n  | otherwise = do\n    rs &lt;- mapM next [pushs..pushs + 3]\n    return (M.unions rs)\n  where\n    next pu = do\n      rs &lt;- allCasesST (ix + 1) clocks pu\n      applySwitch ix clocks\n      return rs\n\nallCases :: M.IntMap Int\nallCases = runST $ do\n  st &lt;- newArray (0,15) 0\n  allCasesST 0 st 0\n\nmain = do\n  putStrLn . show $ M.lookup 0 allCases\n  return ()\n</code></pre>\n\n<p>The following are profiling results.\n<a href=\"https://i.stack.imgur.com/a6U6h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a6U6h.png\" alt=\"Profiling results 1\"></a></p>\n\n<pre><code>  2,754,242,472 bytes allocated in the heap\n  2,095,063,056 bytes copied during GC\n    788,992,504 bytes maximum residency (23 sample(s))\n      3,087,880 bytes maximum slop\n            815 MB total memory in use (0 MB lost due to fragmentation)\n\n                                    Tot time (elapsed)  Avg pause  Max pause\nGen  0      2618 colls,     0 par   10.859s  11.052s     0.0042s    1.1284s\nGen  1        23 colls,     0 par    0.000s   0.011s     0.0005s    0.0009s\n\nINIT    time    0.000s  (  0.001s elapsed)\nMUT     time    1.531s  (  3.622s elapsed)\nGC      time    8.750s  (  8.916s elapsed)\nRP      time    0.000s  (  0.000s elapsed)\nPROF    time    2.109s  (  2.146s elapsed)\nEXIT    time    0.047s  (  0.072s elapsed)\nTotal   time   12.438s  ( 12.612s elapsed)\n\n%GC     time      70.4%  (70.7% elapsed)\n\nAlloc rate    1,798,688,961 bytes per MUT second\n\nProductivity  12.7% of total user, 12.3% of total elapsed\n</code></pre>\n\n<p>.prof file (with some modification for tidiness).</p>\n\n<pre><code>    Mon Dec 25 23:52 2017 Time and Allocation Profiling Report  (Final)\n\n       a.exe +RTS -p -hc -xc -s -c -RTS\n\n    total time  =        1.52 secs   (1518 ticks @ 1000 us, 1 processor)\n    total alloc = 1,576,087,408 bytes  (excludes profiling overheads)\n\nCOST CENTRE     MODULE       SRC                       %time %alloc\n\nintsToQuads     Main         Main.hs:38:29-42          24.9   17.0\nallCasesST      Main         Main.hs:55:13-23          13.7   20.2\napplySwitch     Main         Main.hs:44:25-45          12.2    0.0\nallCasesST      Main         Main.hs:51:11-25          10.5   44.2\napplySwitch     Main         Main.hs:46:3-44            9.5    0.0\nintsToQuads     Main         Main.hs:38:22-54           7.2    0.0\nallCasesST.next Main         Main.hs:58:13-41           6.2    5.7\nintsToQuads     Main         Main.hs:38:29-53           4.2    0.0\napplySwitch     Main         Main.hs:45:12-30           2.6    7.1\nallCasesST.next Main         Main.hs:59:7-27            2.2    0.0\nallCasesST      Main         Main.hs:52:26-39           1.8    1.1\napplySwitch     Main         Main.hs:(44,25)-(46,44)    1.5    0.0\nallCasesST      Main         Main.hs:52:13-46           1.4    2.7\nallCasesST      Main         Main.hs:54:11-38           0.7    2.1\n\n\n                                                          individual     inherited\nCOST CENTRE           SRC                       entries  %time %alloc   %time %alloc\n\nMAIN                  &lt;built-in&gt;                   0      0.1    0.0    100.0  100.0\n CAF                  GHC.IO.Encoding.CodePage     0      0.0    0.0      0.0    0.0\n CAF                  GHC.IO.Encoding              0      0.0    0.0      0.0    0.0\n CAF                  GHC.IO.Handle.Text           0      0.0    0.0      0.0    0.0\n CAF                  GHC.Show                     0      0.0    0.0      0.0    0.0\n CAF                  GHC.IO.Handle.FD             0      0.0    0.0      0.0    0.0\n CAF                  &lt;entire-module&gt;              0      0.0    0.0     99.9  100.0\n  allCases            Main.hs:(63,12)-(65,19)      0      0.0    0.0     99.9  100.0\n   allCases           Main.hs:64:9-25              0      0.0    0.0      0.0    0.0\n   allCasesST         Main.hs:55:5-24              0      0.0    0.0      5.5    5.3\n    allCasesST        Main.hs:55:13-23             0      5.5    5.3      5.5    5.3\n   allCasesST         Main.hs:54:11-38             0      0.7    2.1     94.5   94.7\n    allCasesST.next   Main.hs:59:7-27              0      0.1    0.0      0.5    0.0\n     applySwitch      Main.hs:(44,25)-(46,44)      0      0.0    0.0      0.3    0.0\n      applySwitch     Main.hs:44:25-45             0      0.1    0.0      0.3    0.0\n       applySwitch    Main.hs:45:12-30             0      0.0    0.0      0.0    0.0\n       applySwitch    Main.hs:44:32-44             0      0.2    0.0      0.2    0.0\n    allCasesST.next   Main.hs:58:13-41             0      6.2    5.7     93.3   92.5\n     allCasesST       Main.hs:52:5-47              0      0.1    0.0     39.7   20.8\n      allCasesST      Main.hs:52:13-46             0      1.4    2.7     39.6   20.8\n       allCasesST     Main.hs:52:26-39             0      1.8    1.1     38.2   18.1\n        intsToQuads   Main.hs:38:22-54             0      7.2    0.0     36.4   17.0\n         intsToQuads  Main.hs:38:29-53             0      4.2    0.0     29.1   17.0\n          intsToQuads Main.hs:38:29-42             0     24.9   17.0     24.9   17.0\n     allCasesST       Main.hs:55:5-24              0      0.1    0.0      8.3   14.9\n      allCasesST      Main.hs:55:13-23             0      8.2   14.9      8.2   14.9\n     allCasesST       Main.hs:51:11-25             0     10.5   44.2     10.5   44.2\n     allCasesST.next  Main.hs:59:7-27              0      2.1    0.0     28.7    7.1\n      applySwitch     Main.hs:(44,25)-(46,44)      0      1.5    0.0     26.5    7.1\n       applySwitch    Main.hs:44:25-45             0     12.1    0.0     25.0    7.1\n        applySwitch   Main.hs:46:3-44              0      9.5    0.0     10.4    0.0\n         applySwitch  Main.hs:46:25-43             0      0.9    0.0      0.9    0.0\n        applySwitch   Main.hs:45:12-30             0      2.6    7.1      2.6    7.1\n  main                Main.hs:68:3-39              0      0.0    0.0      0.0    0.0\n   main               Main.hs:68:21-39             0      0.0    0.0      0.0    0.0\n   main               Main.hs:68:3-17              0      0.0    0.0      0.0    0.0\n  switches            Main.hs:(22,12)-(32,19)      0      0.0    0.0      0.0    0.0\n main                 Main.hs:68:3-39              0      0.0    0.0      0.0    0.0\n  main                Main.hs:68:3-17              0      0.0    0.0      0.0    0.0\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "template-haskell"], "comments": [{"owner": {"reputation": 929, "user_id": 4190925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49e067e8fdca6c90df737a0d519f746?s=128&d=identicon&r=PG&f=1", "display_name": "jjj", "link": "https://stackoverflow.com/users/4190925/jjj"}, "edited": false, "score": 0, "creation_date": 1514212742, "post_id": 47969550, "comment_id": 82908527, "body": "Do you mean <a href=\"https://www.yesodweb.com/book\" rel=\"nofollow noreferrer\">this book</a>? Maybe add the link to your question?"}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 8, "last_activity_date": 1514215903, "creation_date": 1514215903, "answer_id": 47969957, "question_id": 47969550, "link": "https://stackoverflow.com/questions/47969550/what-is-code-introspection-in-haskell/47969957#47969957", "title": "What is code introspection in haskell?", "body": "<p>The Template Haskell code in Yesod is only used to generate code. In that sense, it's a strict replacement for boilerplate. Instead of using Template Haskell, we could write out manually a transformation from the route file syntax to code you should write by hand, and you could write the equivalent code yourself.</p>\n\n<p>With introspection, you actually look at existing information the compiler has and make decisions. For example, you could search for all of the instances of the <code>Show</code> typeclass and create a <code>String</code> with that list. That kind of approach can be useful in some cases, such as auto-generating a set of tests. The comment in the book is just stating that Yesod never does this sort of thing.</p>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 47969957, "answer_count": 1, "score": 5, "last_activity_date": 1514248000, "creation_date": 1514212457, "last_edit_date": 1592644375, "question_id": 47969550, "link": "https://stackoverflow.com/questions/47969550/what-is-code-introspection-in-haskell", "title": "What is code introspection in haskell?", "body": "<p>In the <a href=\"https://www.yesodweb.com/book/haskell\" rel=\"nofollow noreferrer\">yesod book</a> there is a paragraph:</p>\n<blockquote>\n<p>Template Haskell is essentially Haskell which generates a Haskell Abstract Syntax Tree (AST).</p>\n<p>There\u2019s actually more power in TH than that, as it can actually introspect code. We don\u2019t use these facilities in Yesod, however.</p>\n</blockquote>\n<p>What does it mean to introspect code and what can you do with this feature?</p>\n"}, {"tags": ["haskell", "hspec"], "answers": [{"comments": [{"owner": {"reputation": 15791, "user_id": 839733, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2s6lO.jpg?s=128&g=1", "display_name": "Abhijit Sarkar", "link": "https://stackoverflow.com/users/839733/abhijit-sarkar"}, "edited": false, "score": 0, "creation_date": 1514197842, "post_id": 47967669, "comment_id": 82905001, "body": "Upvoted, but writing more code to implement what a unit testing framework should provide out of the box is not what I&#39;m looking for. And specifying the type does get rid of the warning, but I&#39;d like to understand why it appears in the first place. It&#39;s quite evident that <code>input</code> is <code>[Integer]</code> - what problem is the otherwise smart compiler having with that?"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 15791, "user_id": 839733, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2s6lO.jpg?s=128&g=1", "display_name": "Abhijit Sarkar", "link": "https://stackoverflow.com/users/839733/abhijit-sarkar"}, "edited": false, "score": 0, "creation_date": 1514198011, "post_id": 47967669, "comment_id": 82905033, "body": "You can look at <code>QuickCheck</code> to provide better data-driven stuff, it can generate random test inputs. It&#39;s what I use, personally. For the error, it&#39;s likely that the values could have type <code>Integer</code> or <code>Int</code>."}, {"owner": {"reputation": 15791, "user_id": 839733, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2s6lO.jpg?s=128&g=1", "display_name": "Abhijit Sarkar", "link": "https://stackoverflow.com/users/839733/abhijit-sarkar"}, "edited": false, "score": 1, "creation_date": 1514198349, "post_id": 47967669, "comment_id": 82905109, "body": "Thank you, I&#39;ll look at quickcheck, although it seems to be property-driven testing, a different approach. And <code>[Int]</code> works too for <code>input</code> and <code>output</code> - I&#39;d forgotten about <a href=\"https://stackoverflow.com/questions/3429291/haskell-int-and-integer\">Int vs Integer</a>."}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 3, "last_activity_date": 1514198401, "last_edit_date": 1514198401, "creation_date": 1514196968, "answer_id": 47967669, "question_id": 47967600, "link": "https://stackoverflow.com/questions/47967600/how-to-write-data-driven-tests-using-hspec/47967669#47967669", "title": "How to write data-driven tests using Hspec?", "body": "<p>You can define a higher-order function like:</p>\n\n<pre><code>describeSort :: Ord a =&gt; String -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a] -&gt; SpecWith b\ndescribeSort sortName sorter input output =\n    describe sortName $ do\n        it (\"sorts \" ++ show input) $ do\n        sorter input `shouldBe` output\n</code></pre>\n\n<p>It's not data-driven, but it basically removes the boilerplate in this instance (I can't verify the syntax is exactly right, don't have a HSpec installation to hand).</p>\n\n<p>Then you can define your tests as:</p>\n\n<pre><code>spec :: Spec\nspec = do\n    let input  = [3, 1, 5, 2, 4]\n        output = [1, 2, 3, 4, 5]\n\n    describeSort \"bubblesort\" bubblesort input output\n    describeSort \"mergesort\"  mergeSort  input output\n    describeSort \"quicksort\"  quickSort  input output\n</code></pre>\n\n<hr>\n\n<p>A more data-driven (property testing) testing framework specifically for Haskell is <a href=\"https://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow noreferrer\"><code>QuickCheck</code></a>. It allows you to define \"properties\" obeyed by functions, and can then generate data to test these. For example a quick test of a sorting function could be written as:</p>\n\n<pre><code>quickCheck (\\xl -&gt; bubblesort xl == sort xl)\n</code></pre>\n\n<p>Where <code>sort</code> is the <code>Data.List</code> version and <code>bubblesort</code> is your implementation under test. QuickCheck will then generate 100 lists that fit the constraints (must be lists of <code>Ord</code> values), and report any errors encountered.</p>\n\n<hr>\n\n<p>You can probably fix that warning by explicitly stating the type of your <code>input</code> and <code>output</code>s:</p>\n\n<pre><code>let input  = [3, 1, 5, 2, 4] :: [Integer]\n    output = [1, 2, 3, 4, 5] :: [Integer]\n</code></pre>\n"}], "owner": {"reputation": 15791, "user_id": 839733, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2s6lO.jpg?s=128&g=1", "display_name": "Abhijit Sarkar", "link": "https://stackoverflow.com/users/839733/abhijit-sarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514626405, "creation_date": 1514196353, "last_edit_date": 1514626405, "question_id": 47967600, "link": "https://stackoverflow.com/questions/47967600/how-to-write-data-driven-tests-using-hspec", "title": "How to write data-driven tests using Hspec?", "body": "<p>I'm learning Haskell, and being a good developer, writing unit tests as I go. I implemented various sorting algorithms, and corresponding tests. However, I feel that separate tests are redundant, because the input and output are not varying, only the algorithms used to sort the input are. Is there a way to create data-driven tests or data tables as possible in various other unit testing frameworks?</p>\n\n<pre><code>module RecursionSpec (main, spec) where\n\nimport Test.Hspec\nimport Recursion\n\nmain :: IO ()\nmain = hspec spec\n\nspec :: Spec\nspec = do\n  let input = [3, 1, 5, 2, 4]\n      output = [1, 2, 3, 4, 5]\n  describe \"bubblesort\" $ do\n    it (\"sorts \" ++ show input) $ do\n      bubblesort input `shouldBe` output\n\n  describe \"mergesort\" $ do\n    it (\"sorts \" ++ show input) $ do\n      mergesort input `shouldBe` output\n\n  describe \"quicksort\" $ do\n      it (\"sorts \" ++ show input) $ do\n        quicksort input `shouldBe` output\n</code></pre>\n\n<p>Also, I get the following warning that I'd like to understand and eliminate.</p>\n\n<pre><code>warning: [-Wtype-defaults]\n    \u2022 Defaulting the following constraints to type \u2018Integer\u2019\n        (Show a0)\n          arising from a use of \u2018show\u2019 at test/RecursionSpec.hs:14:21-30\n        (Eq a0)\n          arising from a use of \u2018shouldBe\u2019 at test/RecursionSpec.hs:15:7-40\n        (Ord a0)\n          arising from a use of \u2018bubblesort\u2019 at test/RecursionSpec.hs:15:7-22\n        (Num a0)\n          arising from the literal \u20181\u2019 at test/RecursionSpec.hs:12:17\n        (Num a0)\n          arising from the literal \u20183\u2019 at test/RecursionSpec.hs:11:16\n    \u2022 In the second argument of \u2018(++)\u2019, namely \u2018show input\u2019\n      In the first argument of \u2018it\u2019, namely \u2018(\"sorts \" ++ show input)\u2019\n      In the expression: it (\"sorts \" ++ show input)\n</code></pre>\n"}, {"tags": ["haskell", "purescript"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514202744, "post_id": 47967024, "comment_id": 82906189, "body": "You, basically, want a Purescript quasiquoter. This should be pretty easy to make up."}, {"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514205188, "post_id": 47967024, "comment_id": 82906759, "body": "But I also need a compilation into the Javascript&#39;s text."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514216085, "post_id": 47967024, "comment_id": 82909293, "body": "This is essentially asking how to write a compiler/interpreter for Purescript in Haskell targeting Javascript. This is much too broad for a SO question."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 1, "last_activity_date": 1514221168, "creation_date": 1514221168, "answer_id": 47970530, "question_id": 47967024, "link": "https://stackoverflow.com/questions/47967024/purescript-inside-haskell-code/47970530#47970530", "title": "Purescript inside Haskell code", "body": "<p>When I have done something similar, I've kept the Purescript source in separate files, and combined the Haskell &amp; Purescript parts later (during the build or at runtime).  I think this is the easiest way, and you can keep using existing Purescript tools.</p>\n\n<p>I had my web server read the JS output from <code>purs</code> at runtime.  Another option would be to use <code>file-embed</code> to include the JS text when compiling the Haskell code.  One reason to prefer <code>file-embed</code> is if you need to have a single executable file to deploy.</p>\n\n<p>Finally, I have a Makefile that builds the Purescript code, then the Haskell code.  </p>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 47970530, "answer_count": 1, "score": 1, "last_activity_date": 1514221168, "creation_date": 1514190902, "question_id": 47967024, "link": "https://stackoverflow.com/questions/47967024/purescript-inside-haskell-code", "title": "Purescript inside Haskell code", "body": "<p>I want to use a PureScript in the program code to generate text of JavaScript from it. For example, I use Julius (from Yesod) to directly insert a javascript. I want to use the same PureScript .Maybe there are such solutions or libraries?\nThank you!</p>\n"}, {"tags": ["performance", "haskell", "linked-list", "functional-programming", "scheme"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1514187869, "post_id": 47966667, "comment_id": 82902892, "body": "1) Simplicity 2) Trivial O(1) prepend 3) Sharing"}, {"owner": {"reputation": 2004, "user_id": 4916831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kIpeA.jpg?s=128&g=1", "display_name": "lcmylin", "link": "https://stackoverflow.com/users/4916831/lcmylin"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1514188081, "post_id": 47966667, "comment_id": 82902937, "body": "@Bergi Simplicity isn&#39;t really a &quot;performance&quot; advantage, but it is a reason. I&#39;m not so sure I understand your sharing point, though. Assuming immutability, you can share flat arrays just as easily."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1514188902, "post_id": 47966667, "comment_id": 82903092, "body": "But you cannot share parts of arrays. Lists can share their tails."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1514191654, "post_id": 47966667, "comment_id": 82903659, "body": "@Bergi Does sharing happen at all in the context of an eager language? I guess you could do it manually."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1514194110, "post_id": 47966667, "comment_id": 82904152, "body": "@DavidYoung I didn&#39;t mean sharing of lazy computation, I did mean sharing of data structure components. I guess that&#39;s done in every language with immutable data structures, regardless whether lazy or eager."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1514203035, "post_id": 47968273, "comment_id": 82906257, "body": "It should be mentioned that C++ arrays/vectors are only so fast because they&#39;re by default <i>unboxed</i> (memory-packed). That allows actually accessing the <i>elements</i> without cache misses. But in dynamic languages (including limited OO dynamic typing) and also in Haskell et al., you can in general only have arrays as <i>arrays of pointers</i>, which means you&#39;ll still get cache misses if you need to look up the elements in an <i>O</i> (<i>n</i>) search. Arrays will still be faster than linked lists, but not nearly but such a big factor as in C++."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1514204649, "post_id": 47968273, "comment_id": 82906616, "body": "@leftaroundabout I concur, but we now do have unboxed vectors in Haskell. These had to be defined using low level unsafe primitives, and only for unboxable types, but with those the performance should be closer to C++, at least."}, {"owner": {"reputation": 50347, "user_id": 1763356, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zGWG9.png?s=128&g=1", "display_name": "Veedrac", "link": "https://stackoverflow.com/users/1763356/veedrac"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1518196725, "post_id": 47968273, "comment_id": 84420922, "body": "@leftaroundabout No, the speed is primarily gained from removing memory dependencies; a vector of pointers will still be much faster than a linked list of values. Dereferencing memory is atrociously latent, but has not-atrocious throughput."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 50347, "user_id": 1763356, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zGWG9.png?s=128&g=1", "display_name": "Veedrac", "link": "https://stackoverflow.com/users/1763356/veedrac"}, "edited": false, "score": 0, "creation_date": 1518202616, "post_id": 47968273, "comment_id": 84423831, "body": "@Veedrac that only helps you when processing each element independently of the others, and also only when compiler and processor can reorder the instructions so well that the latency happens completely out-of-order. In practice, this often works decently nowadays, but still not as fast as when you avoid most of the latency-inducing cache misses entirely."}, {"owner": {"reputation": 50347, "user_id": 1763356, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zGWG9.png?s=128&g=1", "display_name": "Veedrac", "link": "https://stackoverflow.com/users/1763356/veedrac"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1518204500, "post_id": 47968273, "comment_id": 84424712, "body": "@leftaroundabout OoO will make this work even when the processing is not independent, as long as it&#39;s traversed roughly linearly; the loop will end up pipelined and the latency will be hidden. Obviously having contiguous data is even better, but it&#39;s comparatively less important."}], "tags": [], "owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "is_accepted": true, "score": 1, "last_activity_date": 1514202143, "creation_date": 1514202143, "answer_id": 47968273, "question_id": 47966667, "link": "https://stackoverflow.com/questions/47966667/do-linked-lists-have-a-practical-performance-advantage-in-eager-functional-langu/47968273#47968273", "title": "Do linked lists have a practical performance advantage in eager functional languages?", "body": "<p><strong>TL; DR: No performance advantage!</strong></p>\n\n<p>The first Lisp had <code>cons</code> (linked list cell) as only data structure and it used it for everything. Both Common Lisp and Scheme have vectors today, but for functional style it's not a good match. The linked list can have one recursive step add zero or more elements in front of an accumulator and in the end you have a list that was made with sharing between the iterations. The operation might do more than one recursion making several versions all sharing the tail. I would say sharing is the most important aspect of the linked list. If you make a minimax algorithm and store the state in a linked list you can change the state without having to copy the unchanged parts of the state.</p>\n\n<p>Creator of C++ Bjarne Stroustrup mentions <a href=\"https://youtu.be/YQs6IC-vgmo\" rel=\"nofollow noreferrer\">in a talk</a> that the penalty of having the data structure scrambled and double the size like in a linked list is easily outperformed even if you insert in order and need to move half the elements in the data structure. Keep in mind these were doubly linked lists and mutation inserts, but he mentions that most of the time was following the pointers linearly, getting all the CPU cache misses, to find the correct spot and thus for every O(n) search in a sorted list a vector would be better. </p>\n\n<p>If you have a program where you do many inserts on a list which is not in front then perhaps a tree is a better choice, which you can do in CL and Scheme with <code>cons</code>. In fact all of Chris Okasaki purly functional data structures can be implemented with <code>cons</code>. Most \"mutable\" structures in Haskell are implemented similar to it. </p>\n\n<p>If you are suffering from performance problems in Scheme and after profiling you find out you should try to replace a linked list operation with an array one there is nothing standing in the way of that. In the end all algorithm choices have pros and cons. Hard computations are hard in any language. </p>\n"}], "owner": {"reputation": 2004, "user_id": 4916831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kIpeA.jpg?s=128&g=1", "display_name": "lcmylin", "link": "https://stackoverflow.com/users/4916831/lcmylin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 47968273, "answer_count": 1, "score": 3, "last_activity_date": 1514202143, "creation_date": 1514187458, "question_id": 47966667, "link": "https://stackoverflow.com/questions/47966667/do-linked-lists-have-a-practical-performance-advantage-in-eager-functional-langu", "title": "Do linked lists have a practical performance advantage in eager functional languages?", "body": "<p>I'm aware that in lazy functional languages, linked lists take on generator-esque semantics, and that under an optimizing compiler, their overhead can be completely removed when they're not actually being used for storage.</p>\n\n<p>But in eager functional languages, their use seems no less heavy, while optimizing them out seems more difficult. Is there a good performance reason that languages like Scheme use them over flat arrays as their primary sequence representation?</p>\n\n<p>I'm aware of the obvious time complexity implications of using singly-linked lists; I'm more thinking about the in-practice performance consequences of using eager singly-linked lists as a primary sequence representation, compiler optimizations considered.</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 1677501, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b4bbea40e2df964cf5c483ee0fdd3392?s=128&d=identicon&r=PG", "display_name": "laiboonh", "link": "https://stackoverflow.com/users/1677501/laiboonh"}, "edited": false, "score": 0, "creation_date": 1514185154, "post_id": 47966379, "comment_id": 82902377, "body": "Thank you for correcting my understanding of <code>newtype</code>"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 7, "last_activity_date": 1514185093, "last_edit_date": 1514185093, "creation_date": 1514184721, "answer_id": 47966379, "question_id": 47966296, "link": "https://stackoverflow.com/questions/47966296/how-to-have-different-implementation-of-same-record-type-in-haskell/47966379#47966379", "title": "How to have different implementation of same record type in haskell?", "body": "<p>You don't have any duplicate record fields here; the only record fields are <code>name</code> and <code>age</code> on the <code>Person</code> type. The <code>AnotherPerson</code> type is not a record, and it does not have record fields. <code>AnotherPerson</code> \"wraps\" a <code>Person</code> value; it does not \"inherit\" the fields from the <code>Person</code> type.</p>\n\n<p>The <code>AnotherPerson</code> constructor has a (non-record) field of type <code>Person</code>. You can pattern match on <code>AnotherPerson</code> to get at the underlying <code>Person</code> value:</p>\n\n<pre><code>instance Describable AnotherPerson where\n  describe (AnotherPerson person) =\n    name person ++ \" - \" ++ show (age person)\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 1677501, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b4bbea40e2df964cf5c483ee0fdd3392?s=128&d=identicon&r=PG", "display_name": "laiboonh", "link": "https://stackoverflow.com/users/1677501/laiboonh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47966379, "answer_count": 1, "score": 3, "last_activity_date": 1514195288, "creation_date": 1514183909, "last_edit_date": 1514195288, "question_id": 47966296, "link": "https://stackoverflow.com/questions/47966296/how-to-have-different-implementation-of-same-record-type-in-haskell", "title": "How to have different implementation of same record type in haskell?", "body": "<p>I understand that to define different implementations for the same type we will need to use <code>newtype</code></p>\n\n<pre><code>data Person = Person {\n  name :: String\n  , age :: Int\n} deriving Show\n\nclass Describable a where describe :: a -&gt; String\n\ninstance Describable Person where\n  describe person = name person ++ \" (\" ++ show (age person) ++ \")\" \n\nnewtype AnotherPerson = AnotherPerson Person\n</code></pre>\n\n<p>However with the haskell problem of name clash between Records of the same field name</p>\n\n<pre><code>instance Describable AnotherPerson where\n  describe person = name person ++ \" - \" ++ show (age person)\n\n&lt;interactive&gt;:79:65: error:\n    \u2022 Couldn't match expected type \u2018Person\u2019\n                  with actual type \u2018AnotherPerson\u2019\n    \u2022 In the first argument of \u2018name\u2019, namely \u2018person\u2019\n      In the first argument of \u2018(++)\u2019, namely \u2018name person\u2019\n      In the expression: name person ++ \" - \" ++ show (age person) \n</code></pre>\n\n<p>I tried using pragma <code>DuplicateRecordFields</code> but it does not help. How can we do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1514166119, "post_id": 47965096, "comment_id": 82900034, "body": "Referential transparency does not apply to the results of IO actions. Otherwise, how would you be able to get more than one line of input with <code>getLine</code>?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1514166126, "post_id": 47965096, "comment_id": 82900035, "body": "There is no breaking of referential transparency since this program is in <code>IO</code> (particularly, there&#39;s no way to rewrite it to not use <code>IO</code>). This is no different than having a <code>State StdGen ()</code> and writing <code>do { x &lt;- get; modify changeTheStateSomehow; y &lt;- get; return (x,y) }</code>. I hope you agree this program should produce a tuple of two different values (unless <code>changeTheStateSomehow</code> happens to be the identity). Also note: your program has two different <code>gen</code> variables - they just happen to both be named <code>gen</code>. In the scope of the 2nd one, the 1st one is no longer accessible."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1514166531, "post_id": 47965096, "comment_id": 82900097, "body": "If you enable <code>-Wall</code> you will get a warning about <code>gen</code> being shadowed. Thus I would say those two variables are different. Also I think it is hard to talk about referential transparency inside an <code>IO</code>-block, but only outside of it. But I am not really firm in the theoretical foundations of the <code>IO</code>-monad."}, {"owner": {"reputation": 4418, "user_id": 1103705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa36ad5f4b3bda5f6975bd21773f032c?s=128&d=identicon&r=PG", "display_name": "enobayram", "link": "https://stackoverflow.com/users/1103705/enobayram"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1514172805, "post_id": 47965096, "comment_id": 82900785, "body": "@epsilonhalbe AFAIK, the only semantics of <code>IO</code> is &quot;These actions will be performed in the order that they are composed.&quot;. Even that is questionable due to the existence of <code>unsafeInterleaveIO</code>, but it has <code>unsafe</code> in its name, so maybe it doesn&#39;t count."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1514187038, "post_id": 47965096, "comment_id": 82902703, "body": "&quot;Perhaps the solution is simply that the sequence of monadic bind operations implicit in the do syntax ensures that the two gen variables are different.&quot; Yes. If you translate out of <code>do</code> syntactic sugar, you&#39;ll see they are arguments of two different lambdas: <code>get &gt;&gt;= (gen -&gt; ... get &gt;&gt;= gen -&gt; ...)</code>."}, {"owner": {"reputation": 5053, "user_id": 520997, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/880b0bb3a4be9237326dd69565444dee?s=128&d=identicon&r=PG", "display_name": "Reb.Cabin", "link": "https://stackoverflow.com/users/520997/reb-cabin"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514214241, "post_id": 47965096, "comment_id": 82908880, "body": "@user2407038 Later chapters of LYAH explain <code>State</code> <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#state\" rel=\"nofollow noreferrer\">learnyouahaskell.com/for-a-few-monads-more#state</a>, which further clarifies that we can have code that looks like it\u2019s calling the same function with the same arguments but getting different results."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1514230775, "last_edit_date": 1514230775, "creation_date": 1514181762, "answer_id": 47966106, "question_id": 47965096, "link": "https://stackoverflow.com/questions/47965096/newstdgen-breaks-referential-transparency-of-getstdgen/47966106#47966106", "title": "`newStdGen` breaks referential transparency of `getStdGen`?", "body": "<p>Referential transparency says that you can replace a variable with its definition (or vice versa) without changing the meaning of the program. (The \"reference\" -- variable name -- is \"transparent\" -- you can't tell whether you're looking at the reference or the thing behind it.)</p>\n\n<p>In this case, Haskell's module system is hiding pieces of the implementation, notably, <code>theStdGen :: IORef StdGen</code>, so we can't <em>technically</em> replace <code>newStdGen</code> with its implementation. But this is not a \"deep\" violation of referential transparency; if this part of the module were exposed, we could indeed replace <code>newStdGen</code> with its implementation, namely,</p>\n\n<pre><code>atomicModifyIORef' theStdGen split\n</code></pre>\n\n<p>and the meaning of the program would change not one whit. So there is no problem with referential transparency here.</p>\n\n<p>Compare, e.g., this C snippet:</p>\n\n<pre><code>int referent[4] = {0, 1, 2, 3};\nint *x = referent, *y = x;\nx++;\nprintf(\"%d\\n\", *y);\n</code></pre>\n\n<p>Here if we replace <code>y</code> with its definition, <code>x</code>, we will get a program with a different meaning!</p>\n\n<p>Compare also this Haskell snippet:</p>\n\n<pre><code>theStdGen :: IORef StdGen\ntheStdGen  = unsafePerformIO $ do\n   rng &lt;- mkStdRNG 0\n   newIORef rng\n</code></pre>\n\n<p>If we were to replace <code>theStdGen</code> by its definition, that <em>would</em> change the meaning of the program -- instead of reusing the existing <code>IORef</code>, that would cause a fresh <code>IORef</code> to be created, and sharing would be lost. That is (part of) the meaning of the <code>unsafe</code> in <code>unsafePerformIO</code>: things that use <code>unsafePerformIO</code> may not be referentially transparent!</p>\n"}], "owner": {"reputation": 5053, "user_id": 520997, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/880b0bb3a4be9237326dd69565444dee?s=128&d=identicon&r=PG", "display_name": "Reb.Cabin", "link": "https://stackoverflow.com/users/520997/reb-cabin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514230775, "creation_date": 1514165668, "last_edit_date": 1514215805, "question_id": 47965096, "link": "https://stackoverflow.com/questions/47965096/newstdgen-breaks-referential-transparency-of-getstdgen", "title": "`newStdGen` breaks referential transparency of `getStdGen`?", "body": "<p>I'm reading some <a href=\"http://learnyouahaskell.com/input-and-output#randomness\" rel=\"nofollow noreferrer\">samples about randomness in \"Learn You a Haskell\"</a> and I got slightly confused about <code>newStdGen</code>. According to the <a href=\"https://hackage.haskell.org/package/random-1.1/docs/System-Random.html\" rel=\"nofollow noreferrer\">documentation</a>, it updates internal variables so that <code>getStdGen</code> will produce something different next time it's called. That doesn't sound like referential transparency. Indeed, the following program shows that further calls to <code>getStdGen</code> produce different results, at least when monadically bound to variables:</p>\n\n<pre><code>import System.Random\nmain = do\n  gen &lt;- getStdGen\n  putStrLn $ take 20 ( randomRs ('a','z') gen)\n  newStdGen\n  gen &lt;- getStdGen\n  putStrLn $ take 20 ( randomRs ('a','z') gen)\n</code></pre>\n\n<blockquote>\n<pre><code>\u03bb&gt; main\ndgnatnxgvammlgxgeumk\nrrxxnwupmbnxpxrkofjw\n</code></pre>\n</blockquote>\n\n<p>I appreciate that the type of <code>getStdGen</code> is <code>IO StdGen</code>, which is \"an IO action that, when performed, will produce a <code>StdGen</code>,\" and that the bind operation</p>\n\n<pre><code>gen &lt;- getStdGen\n</code></pre>\n\n<p>binds each <code>StdGen</code> to a (sequentially local) variable <code>gen</code>. Perhaps the solution is simply that the sequence of monadic <code>bind</code> operations implicit in the <code>do</code> syntax ensures that the two <code>gen</code> variables are different. </p>\n\n<p>I'd be grateful for a confirmation or refutation of my reasoning and for any further clarification that would make this seem less spooky.</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>Comments helped me realize that my deeper confusion concerns the <em>appearance</em> of calling <code>getStdGen</code> twice with the same arguments (namely none) and getting different results. The property of getting the same results for the same arguments is not called <em>referential transparency</em>, so my question was misleading. What\u2019s going on behind the scenes is similar to what\u2019s going on in <code>State</code>, as pointed out by user2407038: the results are functions of hidden states, which are threaded together inside the bind operations.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 3, "creation_date": 1514149619, "post_id": 47963959, "comment_id": 82897473, "body": "You can&#39;t append characters. Perhaps you meant to use strings. Use double quotes."}], "answers": [{"tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": true, "score": 8, "last_activity_date": 1514149554, "creation_date": 1514149554, "answer_id": 47964025, "question_id": 47963959, "link": "https://stackoverflow.com/questions/47963959/how-do-i-add-a-char-to-every-item-in-a-list/47964025#47964025", "title": "How do I add a char to every item in a list?", "body": "<p>As you say <code>++</code> is the concat operator for lists. It takes a list, and adds another list to the end, for example, <code>[1, 2, 3] ++ [4, 5, 6] == [1,2,3,4,5,6]</code>. The issue in your case is you're attempting to add a character to a character - not a list to a list. </p>\n\n<p>A string is a list of characters, so instead we could do:</p>\n\n<p><code>map (\\x -&gt; [x] ++ ['A']) ['A'..'Z']</code></p>\n\n<p>However, this is a bit cumbersome and ugly. If we just want to add one item to the start of a list, we can use the <code>:</code> operator. In this way, we can invert the problem. Instead of adding 'A' to the end of each character, we can add the character to the start of 'A'.</p>\n\n<p>For example:</p>\n\n<p><code>map (\\x -&gt; x : \"A\") ['A'..'Z']</code></p>\n\n<p>We can then ETA reduce this to:</p>\n\n<p><code>map (: \"A\") ['A'..'Z']</code></p>\n\n<p>As you may notice, I have replaced 'A' with \"A\". \"A\" is a list of characters, which happens to be one element long. Now, we can add one character to the list, the input, instead of having to convert both to lists first.</p>\n\n<p>And we can see, it works as expected:</p>\n\n<pre><code>Prelude&gt; map (: \"A\") ['A'..'Z']\n[\"AA\",\"BA\",\"CA\",\"DA\",\"EA\",\"FA\",\"GA\",\"HA\",\"IA\",\"JA\",\"KA\",\"LA\",\"MA\",\"NA\",\"OA\",\"PA\",\"QA\",\"RA\",\"SA\",\"TA\",\"UA\",\"VA\",\"WA\",\"XA\",\"YA\",\"ZA\"]\n</code></pre>\n"}], "owner": {"reputation": 966, "user_id": 5669167, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2cc0p.jpg?s=128&g=1", "display_name": "zython", "link": "https://stackoverflow.com/users/5669167/zython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2279, "favorite_count": 0, "accepted_answer_id": 47964025, "answer_count": 1, "score": 0, "last_activity_date": 1514149554, "creation_date": 1514149023, "question_id": 47963959, "link": "https://stackoverflow.com/questions/47963959/how-do-i-add-a-char-to-every-item-in-a-list", "title": "How do I add a char to every item in a list?", "body": "<p>As an exercise to see if I understand the <code>map</code> function I wanted to add a char 'a' to every item in the range A-Z.</p>\n\n<p>Well appearently I dont because I get these exceptions which I dont undestand as output:</p>\n\n<pre><code>Prelude&gt; map (++ 'A')['A'..'Z']\n\n&lt;interactive&gt;:46:9:\n    Couldn't match expected type \u2018[a]\u2019 with actual type \u2018Char\u2019\n    Relevant bindings include it :: [[a]] (bound at &lt;interactive&gt;:46:1)\n    In the second argument of \u2018(++)\u2019, namely \u2018'A'\u2019\n    In the first argument of \u2018map\u2019, namely \u2018(++ 'A')\u2019\n    In the expression: map (++ 'A') ['A' .. 'Z']\n\n&lt;interactive&gt;:46:14:\n    Couldn't match expected type \u2018[a]\u2019 with actual type \u2018Char\u2019\n    Relevant bindings include it :: [[a]] (bound at &lt;interactive&gt;:46:1)\n    In the expression: 'A'\n    In the second argument of \u2018map\u2019, namely \u2018['A' .. 'Z']\u2019\n    In the expression: map (++ 'A') ['A' .. 'Z']\n\n&lt;interactive&gt;:46:19:\n    Couldn't match expected type \u2018[a]\u2019 with actual type \u2018Char\u2019\n    Relevant bindings include it :: [[a]] (bound at &lt;interactive&gt;:46:1)\n    In the expression: 'Z'\n    In the second argument of \u2018map\u2019, namely \u2018['A' .. 'Z']\u2019\n    In the expression: map (++ 'A') ['A' .. 'Z']\nPrelude&gt; \n</code></pre>\n\n<p>I understand ++ is the concat operator for lists which includes strings.</p>\n\n<p>Whats wrong with my code ?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "is_accepted": true, "score": 2, "last_activity_date": 1514136845, "creation_date": 1514136845, "answer_id": 47962727, "question_id": 47962726, "link": "https://stackoverflow.com/questions/47962726/minimal-example-of-katip-logging-library/47962727#47962727", "title": "Minimal example of Katip logging library", "body": "<p>Credit goes to <a href=\"https://jkachmar.github.io\" rel=\"nofollow noreferrer\">Joe Kachmar</a></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TemplateHaskell   #-}\n\nmodule Main where\n\nimport Control.Exception\nimport Katip\nimport System.IO (stdout)\n\ntype Stack a = KatipContextT IO a\n\n-- `Stack ()` is the same thing as `KatipContextT IO ()`\n-- test :: Stack ()\ntest :: KatipContextT IO ()\ntest = do\n  $(logTM) InfoS \"Hello from Katip!\"\n  $(logTM) InfoS \"I can do any kind of `IO` action here with `liftIO`!\"\n\nmain :: IO ()\nmain = do\n  handleScribe &lt;- mkHandleScribe ColorIfTerminal stdout InfoS V2\n  let mkLogEnv = registerScribe \"stdout\" handleScribe defaultScribeSettings =&lt;&lt; initLogEnv \"MyApp\" \"production\"\n\n  bracket mkLogEnv closeScribes $ \\le -&gt; do\n    runKatipContextT le (mempty :: LogContexts) mempty test\n</code></pre>\n"}], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 1, "accepted_answer_id": 47962727, "answer_count": 1, "score": 1, "last_activity_date": 1514136845, "creation_date": 1514136845, "question_id": 47962726, "link": "https://stackoverflow.com/questions/47962726/minimal-example-of-katip-logging-library", "title": "Minimal example of Katip logging library", "body": "<p>Is there a minimal example demonstrating the use of <a href=\"https://github.com/Soostone/katip\" rel=\"nofollow noreferrer\">Katip logging library</a> for haskell?</p>\n"}, {"tags": ["haskell", "haskell-stack", "nixos"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1514134934, "post_id": 47962377, "comment_id": 82894163, "body": "What does <code>stack --version</code> say ?"}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1514136417, "post_id": 47962377, "comment_id": 82894551, "body": "@Sibi I have edited and added the output of the <code>stack --version</code> command"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1514137392, "post_id": 47962377, "comment_id": 82894815, "body": "Okay, so the problem is that you still have the old version of nix in your path. I don&#39;t think the <code>stack upgrade</code> will work in Nix OS. You have to install the newest version of Stack using nix package manager globally."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514166325, "post_id": 47962377, "comment_id": 82900068, "body": "In general, you need to make sure that <code>which stack</code> refers to the location of the binary installed by <code>stack upgrade</code>, for instance by making <code>~&#47;.local&#47;bin</code> appear earlier in your <code>$PATH</code>."}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1514196406, "post_id": 47962377, "comment_id": 82904631, "body": "Try <code>stack --nix build</code> it might work. I don&#39;t know why, if anyone know please answer my <a href=\"https://stackoverflow.com/questions/46090460/what-is-reason-not-to-use-stack-nix-when-i-using-nix\">question</a>. Also try <a href=\"https://stackoverflow.com/questions/46861022/generating-a-nix-package-from-a-stack-project/47110522#47110522\">this</a> method."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "reply_to_user": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1514240865, "post_id": 47962377, "comment_id": 82914457, "body": "@wizzup thanks for the suggestion. However none of <code>stack --nix init</code> , <code>stack --nix build</code> or <code>stack --nix setup</code> works in my case, the output is still the same error about the flag name. I do think I have to get nixos install a more recent version of stack, but I still don&#39;t know how to do that for now."}], "answers": [{"comments": [{"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1515583949, "post_id": 47984658, "comment_id": 83352564, "body": "I think in the <code>nix-channel --add ...</code> command,  you should use <code>nixos-unstable</code> instead of <code>unstable</code>  i.e. <code>https:&#47;&#47;nixos.org&#47;channels&#47;nixos-unstable</code> . Otherwise it did not work for me."}, {"owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1515597104, "post_id": 47984658, "comment_id": 83360879, "body": "@StephaneRolland What does <code>it did not work</code> mean, can you post an error? At least theoretically, any label for the channel should do as long as you use the same lebal in the argument to <code>nix-env</code>."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1515608181, "post_id": 47984658, "comment_id": 83367918, "body": "when launching <code>nix-channel --update</code> I had something like &quot;unable to download...&quot;. I try to get the entire error message and post it here."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1515666761, "post_id": 47984658, "comment_id": 83390793, "body": "as you asked, I have tried again with <code>https:&#47;&#47;nixos.org&#47;channels&#47;unstable</code> instead of <code>https:&#47;&#47;nixos.org&#47;channels&#47;nixos-unstable</code> and as soon as I do <code>nix-@nh2 channel --update</code> the error message is kind of almost explicit:  <code>error: unable to download &#39;https:&#47;&#47;nixos.org&#47;channels&#47;unstable&#47;nixexprs.tar.bz2</code> etc... As I said I no longer have an error if instead of <code>unstable</code> I use <code>nixos-unstable</code>. I think you should check by yourself and edit your answer accordingly."}, {"owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 1, "creation_date": 1517493557, "post_id": 47984658, "comment_id": 84124784, "body": "@StephaneRolland Ah, you are right, I had a part of the URL cut off. I have corrected it to <code>nix-channel --add &#39;https:&#47;&#47;nixos.org&#47;channels&#47;nixpkgs-unstable&#39; unstable</code>. I thought you were referring to the <i>label</i> (last word in this command), which can really be anything you like, but you were referring to the URL itself. I have edited the answer to fix that. Thanks for clarifying."}], "tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": false, "score": 1, "last_activity_date": 1517493433, "last_edit_date": 1517493433, "creation_date": 1514329899, "answer_id": 47984658, "question_id": 47962377, "link": "https://stackoverflow.com/questions/47962377/cannot-build-a-hello-world-program-with-stack-because-of-flag-bytestring-lt-0-1/47984658#47984658", "title": "Cannot build a hello world program with Stack because of flag bytestring--lt-0_10_4", "body": "<p><strong>Short answer:</strong> Upgrade <code>stack</code> using:</p>\n\n<pre><code>nix-channel --add 'https://nixos.org/channels/unstable' unstable\nnix-channel --update\nnix-env -iA unstable.stack\n</code></pre>\n\n<hr>\n\n<p><strong>Long answer:</strong></p>\n\n<p>The issue here is, as you have correctly identified, the double <code>--</code> in the flag you mentioned. See <a href=\"https://github.com/haskell-hvr/cassava/pull/155]\" rel=\"nofollow noreferrer\">this issue</a> for details.</p>\n\n<p>The recommendations you have got, upgrading <code>stack</code>, are good.</p>\n\n<p>The only thing you seem to be missing is how to upgrade <code>stack</code> on your NixOS.</p>\n\n<p>Here's how to do it if you use nix-channels:</p>\n\n<pre><code>% nix-channel --list\nnixpkgs https://nixos.org/channels/nixos-17.09\n\n% nix-channel --add 'https://nixos.org/channels/nixpkgs-unstable' unstable\n\n% nix-channel --list\nnixpkgs https://nixos.org/channels/nixos-17.09\nunstable https://nixos.org/channels/nixpkgs-unstable\n\n% nix-channel --update\ndownloading Nix expressions from \u2018https://d3g5gsiof5omrk.cloudfront.net/nixos/17.09/nixos-17.09.2476.53e6d671a96/nixexprs.tar.xz\u2019...\ndownloading \u2018https://d3g5gsiof5omrk.cloudfront.net/nixos/17.09/nixos-17.09.2476.53e6d671a96/nixexprs.tar.xz\u2019... [0/0 KiB, 0.0 KiB/s]\ndownloading Nix expressions from \u2018https://d3g5gsiof5omrk.cloudfront.net/nixpkgs/nixpkgs-18.03pre123609.93829f1b031/nixexprs.tar.xz\u2019...\ndownloading \u2018https://d3g5gsiof5omrk.cloudfront.net/nixpkgs/nixpkgs-18.03pre123609.93829f1b031/nixexprs.tar.xz\u2019... [0/0 KiB, 0.0 KiB/s]\nunpacking channels...\ncreated 7 symlinks in user environment\n\n% nix-env -iA unstable.stack\ninstalling \u2018stack-1.6.3\u2019\nthese derivations will be built:\n  /nix/store/d0laffx9yarcb6r243pfcd2xyvmxylgn-remove-references-to.drv\n  /nix/store/6da8kmc6pdxzgmi4bpahwckl8y6ify1z-stack-1.6.3.drv\nthese paths will be fetched (218.74 MiB download, 2452.84 MiB unpacked):\n  ...\n</code></pre>\n\n<p>In the above, I have added the <code>unstable</code> NixOS release, and then I fetched its contents and installed stack from it using <code>nix-env -iA unstable.stack</code>.</p>\n\n<p>That gets me <code>stack-1.6.3</code> as of writing (as opposed from <code>release-17.09</code>, which has <code>stack-1.5.1</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "edited": false, "score": 0, "creation_date": 1515759173, "post_id": 48186493, "comment_id": 83433722, "body": "I &quot;fixed&quot; this by returning to lts-9.14. The stack version on NixOS is not up to date, unfortunately."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "reply_to_user": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "edited": false, "score": 0, "creation_date": 1516540879, "post_id": 48186493, "comment_id": 83720946, "body": "@YotamOhad Got it. Using the --resolver lts-9.14 flag when using stack."}, {"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "edited": false, "score": 1, "creation_date": 1516633939, "post_id": 48186493, "comment_id": 83756488, "body": "Well, you can also add it to you <code>stack.yaml</code>"}], "tags": [], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "is_accepted": true, "score": 2, "last_activity_date": 1563524862, "last_edit_date": 1563524862, "creation_date": 1515583862, "answer_id": 48186493, "question_id": 47962377, "link": "https://stackoverflow.com/questions/47962377/cannot-build-a-hello-world-program-with-stack-because-of-flag-bytestring-lt-0-1/48186493#48186493", "title": "Cannot build a hello world program with Stack because of flag bytestring--lt-0_10_4", "body": "<p>For bypassing the issue with the <code>bytestring--lt</code> flag:</p>\n\n<p>Use <code>--nix</code> and <code>--resolver</code> with a former lts version for stack commands:</p>\n\n<pre><code>stack new myproject --nix --resolver lts-9.14\nstack setup --nix --resolver lts-9.14\nstack build --nix --resolver lts-9.14\n</code></pre>\n\n<hr>\n\n<p>It is not necessary, but so as to install a more recent version of <code>stack</code>:</p>\n\n<p>First, we have to add the <code>nixos-unstable</code> channel so as to pick a more recent version of stack from it:</p>\n\n<pre><code>nix-channel --add 'https://nixos.org/channels/nixos-unstable' unstable\nnix-channel --update\n</code></pre>\n\n<p>Then, update the nixos <code>configuration.nix</code> file so as to install the unstable version of stack:</p>\n\n<pre><code>{ config, pkgs, ... }:\n  let\n      unstable = import &lt;unstable&gt; {};\n  in {\n      environment.systemPackages = [ unstable.stack ];\n}\n</code></pre>\n\n<p>and rebuild the system:</p>\n\n<pre><code>$ nixos-rebuild reboot\n</code></pre>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1556, "favorite_count": 0, "accepted_answer_id": 48186493, "answer_count": 2, "score": 6, "last_activity_date": 1564398058, "creation_date": 1514133824, "last_edit_date": 1564398058, "question_id": 47962377, "link": "https://stackoverflow.com/questions/47962377/cannot-build-a-hello-world-program-with-stack-because-of-flag-bytestring-lt-0-1", "title": "Cannot build a hello world program with Stack because of flag bytestring--lt-0_10_4", "body": "<p>With a bare \"hello world\" project generated by </p>\n\n<pre><code>stack new myproject simple\n</code></pre>\n\n<p>whenever I run <code>stack setup</code>, <code>stack init</code> or <code>stack build</code> I have the following error all the time:</p>\n\n<pre><code>Downloading lts-10.0 build plan Downloaded lts-10.0 build plan.\nAesonException \"Error in $.packages.cassava.constraints.flags['bytestring--lt-0_10_4']: Invalid flag name: \\\"bytestring--lt-0_10_4\\\"\"\n</code></pre>\n\n<p>I saw some guys talk about the issue, and argue about whether it is accepted or not to have two sequential <code>-</code> in a flag name like in \"bytestring--lt-0...\", that it is the fault of stack or cassava or cabal etc... </p>\n\n<p>But someone constructively suggests a workaround with</p>\n\n<pre><code>stack upgrade\n</code></pre>\n\n<p>However even after running <code>stack upgrade</code> command, I still have the issue. And I cannot build the \"hello world\" program.</p>\n\n<p>Any idea how to fix this or workaround ?</p>\n\n<p>I use NixOs, if there are solutions that works best with NixOs.</p>\n\n<p>This is the output to <code>stack --version</code>:</p>\n\n<pre><code>Version 1.5.1 x86_64\nCompiled with:\n- Cabal-1.24.2.0\n- Glob-0.8.0\n- HUnit-1.5.0.0\n- MonadRandom-0.5.1\n- QuickCheck-2.9.2\n- SHA-1.6.4.2\n- StateVar-1.1.0.4\n- aeson-1.1.2.0\n- aeson-compat-0.3.6\n- annotated-wl-pprint-0.7.0\n- ansi-terminal-0.6.3.1\n- ansi-wl-pprint-0.6.7.3\n- array-0.5.1.1\n- asn1-encoding-0.9.5\n- asn1-parse-0.9.4\n- asn1-types-0.3.2\n- async-2.1.1.1\n- attoparsec-0.13.1.0\n- attoparsec-iso8601-1.0.0.0\n- auto-update-0.1.4\n- base-4.9.1.0\n- base-compat-0.9.3\n- base-orphans-0.6\n- base16-bytestring-0.1.1.6\n- base64-bytestring-1.0.0.1\n- bifunctors-5.4.2\n- binary-0.8.3.0\n- binary-tagged-0.1.4.2\n- bitarray-0.0.1.1\n- blaze-builder-0.4.0.2\n- blaze-html-0.9.0.1\n- blaze-markup-0.8.0.0\n- byteable-0.1.1\n- bytestring-0.10.8.1\n- call-stack-0.1.0\n- case-insensitive-1.2.0.10\n- cereal-0.5.4.0\n- clock-0.7.2\n- comonad-5.0.2\n- conduit-1.2.11\n- conduit-extra-1.1.16\n- connection-0.2.8\n- constraints-0.9.1\n- containers-0.5.7.1\n- contravariant-1.4\n- cookie-0.4.2.1\n- cryptohash-0.11.9\n- cryptohash-sha256-0.11.100.1\n- cryptonite-0.23\n- cryptonite-conduit-0.2.0\n- data-default-class-0.1.2.0\n- deepseq-1.4.2.0\n- digest-0.0.1.2\n- directory-1.3.0.0\n- distributive-0.5.3\n- dlist-0.8.0.3\n- easy-file-0.2.1\n- echo-0.1.3\n- ed25519-0.0.5.0\n- either-4.4.1.1\n- errors-2.2.1\n- exceptions-0.8.3\n- extra-1.5.3\n- fail-4.9.0.0\n- fast-logger-2.4.10\n- file-embed-0.0.10\n- filelock-0.1.1.2\n- filepath-1.4.1.1\n- foundation-0.0.13\n- free-4.12.4\n- fsnotify-0.2.1.1\n- generic-deriving-1.11.2\n- generics-sop-0.3.1.0\n- ghc-boot-th-8.0.2\n- ghc-prim-0.5.0.0\n- gitrev-1.3.1\n- hackage-security-0.5.2.2\n- hashable-1.2.6.1\n- hastache-0.6.1\n- hinotify-0.3.9\n- hourglass-0.2.10\n- hpack-0.18.1\n- hpc-0.6.0.3\n- hspec-2.4.4\n- hspec-core-2.4.4\n- hspec-discover-2.4.4\n- hspec-expectations-0.8.2\n- hspec-smallcheck-0.4.2\n- http-api-data-0.3.7.1\n- http-client-0.5.7.0\n- http-client-tls-0.3.5.1\n- http-conduit-2.2.3.2\n- http-types-0.9.1\n- ieee754-0.8.0\n- integer-gmp-1.0.0.1\n- integer-logarithms-1.0.2\n- lifted-async-0.9.3\n- lifted-base-0.2.3.11\n- logict-0.6.0.2\n- memory-0.14.6\n- microlens-0.4.8.1\n- microlens-mtl-0.1.11.0\n- microlens-th-0.4.1.1\n- mime-types-0.1.0.7\n- mintty-0.1.1\n- mmorph-1.0.9\n- monad-control-1.0.2.2\n- monad-logger-0.3.25\n- monad-loops-0.4.3\n- monad-unlift-0.2.0\n- mono-traversable-1.0.2.1\n- mtl-2.2.1\n- nats-1.1.1\n- network-2.6.3.2\n- network-uri-2.6.1.0\n- old-locale-1.0.0.7\n- old-time-1.1.0.3\n- open-browser-0.2.1.0\n- optparse-applicative-0.13.2.0\n- optparse-simple-0.0.3\n- parsec-3.1.11\n- path-0.5.13\n- path-io-1.2.2\n- path-pieces-0.2.1\n- pem-0.2.2\n- persistent-2.7.0\n- persistent-sqlite-2.6.2\n- persistent-template-2.5.2\n- pid1-0.1.2.0\n- prelude-extras-0.4.0.3\n- pretty-1.1.3.3\n- primitive-0.6.2.0\n- process-1.4.3.0\n- profunctors-5.2.1\n- project-template-0.2.0\n- quickcheck-io-0.2.0\n- random-1.1\n- regex-applicative-0.3.3\n- regex-applicative-text-0.1.0.1\n- resource-pool-0.2.3.2\n- resourcet-1.1.9\n- retry-0.7.4.2\n- rts-1.0\n- safe-0.3.15\n- safe-exceptions-0.1.6.0\n- scientific-0.3.5.2\n- semigroupoids-5.2.1\n- semigroups-0.18.3\n- setenv-0.1.1.3\n- silently-1.2.5\n- smallcheck-1.1.2\n- socks-0.5.5\n- split-0.2.3.2\n- stm-2.4.4.1\n- stm-chans-3.0.0.4\n- store-0.4.3.2\n- store-core-0.4.1\n- streaming-commons-0.1.17\n- syb-0.7\n- tagged-0.8.5\n- tar-0.5.0.3\n- template-haskell-2.11.1.0\n- temporary-1.2.1.1\n- text-1.2.2.2\n- text-binary-0.2.1.1\n- text-metrics-0.3.0\n- tf-random-0.5\n- th-expand-syns-0.4.3.0\n- th-lift-0.7.7\n- th-lift-instances-0.1.11\n- th-orphans-0.13.4\n- th-reify-many-0.1.8\n- th-utilities-0.2.0.1\n- time-1.6.0.1\n- time-locale-compat-0.1.1.3\n- tls-1.3.11\n- transformers-0.5.2.0\n- transformers-base-0.4.4\n- transformers-compat-0.5.1.4\n- unexceptionalio-0.3.0\n- unicode-transforms-0.3.3\n- unix-2.7.2.1\n- unix-compat-0.4.3.1\n- unix-time-0.3.7\n- unordered-containers-0.2.8.0\n- uri-bytestring-0.2.3.3\n- uuid-types-1.0.3\n- vector-0.12.0.1\n- vector-algorithms-0.7.0.1\n- vector-binary-instances-0.2.3.5\n- void-0.7.2\n- x509-1.7.2\n- x509-store-1.6.5\n- x509-system-1.6.6\n- x509-validation-1.6.9\n- yaml-0.8.23.3\n- zip-archive-0.3.1.1\n- zlib-0.6.1.2\n</code></pre>\n"}, {"tags": ["haskell", "crash", "haskell-stack"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 3, "creation_date": 1514129693, "post_id": 47961876, "comment_id": 82892997, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47577986/stack-build-failed-with-usr-bin-ld-final-link-failed-on-archlinux\">`stack build` failed with `/usr/bin/ld: final link failed` on Archlinux</a>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1514134878, "post_id": 47961876, "comment_id": 82894151, "body": "What OS, what stack version ?"}, {"owner": {"reputation": 75, "user_id": 5055454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec331b40d0ae6e7b5fc4805b14573aa?s=128&d=identicon&r=PG", "display_name": "user5055454", "link": "https://stackoverflow.com/users/5055454/user5055454"}, "edited": false, "score": 0, "creation_date": 1514312950, "post_id": 47961876, "comment_id": 82933119, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/47577986/stack-build-failed-with-usr-bin-ld-final-link-failed-on-archlinux\" title=\"stack build failed with usr bin ld final link failed on archlinux\">stackoverflow.com/questions/47577986/&hellip;</a>. Thanks Zpalmtree."}], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 2084808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c110e61b5d989baeab5552fc92407423?s=128&d=identicon&r=PG", "display_name": "Sebastian Neira", "link": "https://stackoverflow.com/users/2084808/sebastian-neira"}, "edited": false, "score": 0, "creation_date": 1515260776, "post_id": 47993209, "comment_id": 83237015, "body": "Totally worked! Thanks Would you mind adding some details on what&#39;s the issue here, please?"}, {"owner": {"reputation": 428, "user_id": 1349005, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5fb89edff2da0d0fe819bc5335ddf556?s=128&d=identicon&r=PG", "display_name": "Lindenk", "link": "https://stackoverflow.com/users/1349005/lindenk"}, "edited": false, "score": 0, "creation_date": 1569626441, "post_id": 47993209, "comment_id": 102670439, "body": "Reinstalling causing <code>Unable to find installation URLs for OS key: linux-armv7-tinfo6</code> on armv7"}], "tags": [], "owner": {"reputation": 111, "user_id": 2007549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938a3a24d781090702afa69346e264?s=128&d=identicon&r=PG", "display_name": "Emanuel Borsboom", "link": "https://stackoverflow.com/users/2007549/emanuel-borsboom"}, "is_accepted": true, "score": 2, "last_activity_date": 1528553609, "last_edit_date": 1528553609, "creation_date": 1514381972, "answer_id": 47993209, "question_id": 47961876, "link": "https://stackoverflow.com/questions/47961876/stack-install-crashes-on-pretty-much-anything/47993209#47993209", "title": "stack install crashes on pretty much anything", "body": "<p>I'm guessing you're using Arch Linux.</p>\n\n<p>I'm in the middle of trying to come up with a comprehensive fix for this and related problems in <code>stack setup</code>, but I believe the simplest course of action is to add this to your <code>~/.stack/config.yaml</code>:</p>\n\n<pre><code>ghc-build: tinfo6\n</code></pre>\n\n<p>You may need to run <code>stack setup --reinstall</code> to force a re-install.</p>\n"}], "owner": {"reputation": 75, "user_id": 5055454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec331b40d0ae6e7b5fc4805b14573aa?s=128&d=identicon&r=PG", "display_name": "user5055454", "link": "https://stackoverflow.com/users/5055454/user5055454"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 47993209, "answer_count": 1, "score": 0, "last_activity_date": 1528553609, "creation_date": 1514129379, "last_edit_date": 1514160586, "question_id": 47961876, "link": "https://stackoverflow.com/questions/47961876/stack-install-crashes-on-pretty-much-anything", "title": "stack install crashes on pretty much anything", "body": "<p>I'm trying to install tidal cycles via stack using <code>stack install tidal</code>.<br>\nInstallation went smooth for the first couple dependencies but now I'm getting this.</p>\n\n<pre><code>04:24 ~ stack install tidal\nmersenne-random-pure64-0.2.2.0: configure\nmersenne-random-pure64-0.2.2.0: build\nnetwork-2.6.3.2: configure\nzlib-0.6.1.2: configure\nzlib-0.6.1.2: build\nProgress: 3/7\n--  While building custom Setup.hs for package zlib-0.6.1.2 using:\n      /home/mn/.stack/setup-exe-cache/x86_64-linux-tinfo6-nopie/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /home/mn/.stack/global-project/.stack-work/logs/zlib-0.6.1.2.log\n\n    Configuring zlib-0.6.1.2...\n    Preprocessing library for zlib-0.6.1.2..\n    /usr/bin/ld.gold: error: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Codec/Compression/Zlib/Stream_hsc_make.o: requires dynamic R_X86_64_32 reloc which may overflow at runtime; recompile with -fPIC\n    /usr/bin/ld.gold: error: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Codec/Compression/Zlib/Stream_hsc_utils.o: requires dynamic R_X86_64_PC32 reloc against 'vprintf' which may overflow at runtime; recompile with -fPIC\n    collect2: error: ld returned 1 exit status\n    linking .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Codec/Compression/Zlib/Stream_hsc_make.o failed (exit code 1)\n    command was: /usr/bin/gcc .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Codec/Compression/Zlib/Stream_hsc_make.o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Codec/Compression/Zlib/Stream_hsc_utils.o -o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Codec/Compression/Zlib/Stream_hsc_make -fuse-ld=gold -fno-PIE -fno-stack-protector -fuse-ld=gold -lz -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/bytestring-0.10.8.2 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/bytestring-0.10.8.2 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/deepseq-1.4.3.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/deepseq-1.4.3.0 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/array-0.5.2.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/array-0.5.2.0 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/base-4.10.1.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/base-4.10.1.0 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/integer-gmp-1.0.1.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/integer-gmp-1.0.1.0 -lgmp -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/ghc-prim-0.5.1.1 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/ghc-prim-0.5.1.1 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/rts -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/rts -lm -lrt -ldl -lpthread\n\n\n--  While building custom Setup.hs for package network-2.6.3.2 using:\n      /tmp/stack17553/network-2.6.3.2/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/setup/setup --builddir=.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0 configure --with-ghc=/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/bin/ghc --with-ghc-pkg=/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/bin/ghc-pkg --user --package-db=clear --package-db=global --package-db=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/pkgdb --libdir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/lib --bindir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/bin --datadir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/share --libexecdir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/libexec --sysconfdir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/etc --docdir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/doc/network-2.6.3.2 --htmldir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/doc/network-2.6.3.2 --haddockdir=/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/doc/network-2.6.3.2 --dependency=base=base-4.10.1.0 --dependency=bytestring=bytestring-0.10.8.2 --dependency=unix=unix-2.7.2.2\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /home/mn/.stack/global-project/.stack-work/logs/network-2.6.3.2.log\n\n    [1 of 2] Compiling Main             ( /tmp/stack17553/network-2.6.3.2/Setup.hs, /tmp/stack17553/network-2.6.3.2/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/setup/Main.o )\n    [2 of 2] Compiling StackSetupShim   ( /home/mn/.stack/setup-exe-src/setup-shim-mPHDZzAJ.hs, /tmp/stack17553/network-2.6.3.2/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/setup/StackSetupShim.o )\n    Linking /tmp/stack17553/network-2.6.3.2/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/setup/setup ...\n    Configuring network-2.6.3.2...\n    configure: WARNING: unrecognized options: --with-compiler\n    checking build system type... x86_64-pc-linux-gnu\n    checking host system type... x86_64-pc-linux-gnu\n    checking for gcc... /usr/bin/gcc\n    checking whether the C compiler works... yes\n    checking for C compiler default output file name... a.out\n    checking for suffix of executables... \n    checking whether we are cross compiling... configure: error: in `/tmp/stack17553/network-2.6.3.2':\n    configure: error: cannot run C compiled programs.\n    If you meant to cross compile, use `--host'.\n    See `config.log' for more details\n\n\n--  While building custom Setup.hs for package mersenne-random-pure64-0.2.2.0 using:\n      /home/mn/.stack/setup-exe-cache/x86_64-linux-tinfo6-nopie/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /home/mn/.stack/global-project/.stack-work/logs/mersenne-random-pure64-0.2.2.0.log\n\n    Configuring mersenne-random-pure64-0.2.2.0...\n    Preprocessing library for mersenne-random-pure64-0.2.2.0..\n    /usr/bin/ld.gold: error: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/System/Random/Mersenne/Pure64/Base_hsc_make.o: requires dynamic R_X86_64_32 reloc which may overflow at runtime; recompile with -fPIC\n    /usr/bin/ld.gold: error: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/System/Random/Mersenne/Pure64/Base_hsc_utils.o: requires dynamic R_X86_64_PC32 reloc against 'vfprintf' which may overflow at runtime; recompile with -fPIC\n    collect2: error: ld returned 1 exit status\n    linking .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/System/Random/Mersenne/Pure64/Base_hsc_make.o failed (exit code 1)\n    command was: /usr/bin/gcc .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/System/Random/Mersenne/Pure64/Base_hsc_make.o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/System/Random/Mersenne/Pure64/Base_hsc_utils.o -o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/System/Random/Mersenne/Pure64/Base_hsc_make -fuse-ld=gold -fno-PIE -fno-stack-protector -fuse-ld=gold -L/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/lib/x86_64-linux-ghc-8.2.2/random-1.1-LLUGZ7T9DqQ5vN0Jbcd0We -Wl,-R,/home/mn/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-10.0/8.2.2/lib/x86_64-linux-ghc-8.2.2/random-1.1-LLUGZ7T9DqQ5vN0Jbcd0We -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/time-1.8.0.2 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/time-1.8.0.2 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/deepseq-1.4.3.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/deepseq-1.4.3.0 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/array-0.5.2.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/array-0.5.2.0 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/base-4.10.1.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/base-4.10.1.0 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/integer-gmp-1.0.1.0 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/integer-gmp-1.0.1.0 -lgmp -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/ghc-prim-0.5.1.1 -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/ghc-prim-0.5.1.1 -L/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/rts -Wl,-R,/home/mn/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/rts -lm -lrt -ldl -lpthread\n\u2718 04:24 ~ \n</code></pre>\n\n<p>Googled a little and found a few things, tried a few things but none worked, I'm lost.</p>\n\n<p>Any help is appreciated, thanks.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1514154737, "post_id": 47958167, "comment_id": 82898517, "body": "After re-reading this response many times two questions come to mind: 1) If step&#39; returns a list, how does foldr accept that as its first argument? 2) The arguments to step&#39; are x  and xs. foldr calls step&#39; with zero and [].  How did the  zero wind up as the second argument in the left hand side of your last line of code when it was called with zero as the first argument?"}, {"owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "reply_to_user": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1514156253, "post_id": 47958167, "comment_id": 82898751, "body": "1) <code>step&#39;</code> is a function, not a list. Check <code>foldr</code>&#39;s type: <code>(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>. So <code>step&#39;</code> takes something of type <code>a</code> and also something of type <code>b</code>, which is a list. So <code>b</code> has the form <code>[c]</code>, for another type <code>c</code>. Is that clear?"}, {"owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "reply_to_user": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1514156420, "post_id": 47958167, "comment_id": 82898770, "body": "2) Let&#39;s recap <code>foldr</code> equations: <code>foldr op z [] = z</code> and <code>foldr op z (x:xs) = op x (foldr op z xs)</code>  <code>foldr</code> eventually will expand into this expression: <code>op x1 (op x2 (op x3 (... (op xn z))...)</code>  change <code>op</code> to <code>step&#39;</code> and <code>z</code> to <code>zero</code> and you will see why <code>zero</code> winds up as the second argument. I can explain this better in the solution if you want."}, {"owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1514166671, "post_id": 47958167, "comment_id": 82900112, "body": "I appreciate your offer to explain this better, but I hope that won&#39;t be necessary because I feel you&#39;ve explained it thoroughly.  It now remains for me to study it until I understand it.  Thank you."}, {"owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1514173556, "post_id": 47958167, "comment_id": 82900844, "body": "OK, I now get it :)  After getting your initial answer, I did copy the definition of foldr  to my work file.  However, I did not take the trouble to unwind it.  Had I done so, I would&#39;ve seen that zero in the base case, which is usually a number, but in this case, in order to agree with step&#39;, it had to be a list [zero]. (Honestly I&#39;m not sure I would made the connection though.)  But by following your comments it became obvious how the [zero] became the second argument in step&#39;.  For me this has been a major lesson on how to analyze these functions."}, {"owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "reply_to_user": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1514245299, "post_id": 47958167, "comment_id": 82915108, "body": "I&#39;m glad you got it! Yes, it could be a bit tough in the beginning, but once you understand those types you&#39;ll start use these high order patterns naturally ;)"}], "tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": true, "score": 1, "last_activity_date": 1514118595, "last_edit_date": 1514118595, "creation_date": 1514091376, "answer_id": 47958167, "question_id": 47957645, "link": "https://stackoverflow.com/questions/47957645/scanr3-why-does-step-a-binary-operator-accept-zero-as-a-parameter/47958167#47958167", "title": "scanr3: Why does step, a binary operator, accept [zero] as a parameter?", "body": "<p>Why is that? As far as I understood your question, the expression types (in your words, it compiles) because it infers that <code>zero</code> is a list of something (why? [1]).</p>\n\n<pre><code>-- this expression types!\nscanr3 step zero xs = foldr step' zero xs\n  where step' x xs = (step x (head xs)):xs\n</code></pre>\n\n<p>Recall that <code>zero</code> now should be a list:</p>\n\n<pre><code>Prelude&gt; scanr3 (+) [0] [1,2,3]\n[6,5,3,0]\n</code></pre>\n\n<p>but can't be an <code>Int</code> as you expected:</p>\n\n<pre><code>Prelude&gt; scanr3 (+) 0 [1,2,3]\n\n&lt;interactive&gt;:18:1: error:\n    \u2022 Non type-variable argument in the constraint: Num [a]\n      (Use FlexibleContexts to permit this)\n    \u2022 When checking the inferred type\n        it :: forall a. (Num [a], Num a) =&gt; [a]\n</code></pre>\n\n<p>[1]: Because, when the definition reaches the base case of <code>foldr</code>, that is, <code>foldr step' zero []</code>, it will be substituted by <code>zero</code>, and replacing this expression in</p>\n\n<pre><code>where step' x xs = (step x (head xs)):xs\n</code></pre>\n\n<p>where <code>xs = zero</code>, is equivalent to</p>\n\n<pre><code>where step' x zero = (step x (head xs)):zero\n</code></pre>\n\n<p>So, <code>zero</code> should be a list, because it is expected to be on the right hand side of <code>:</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47958167, "answer_count": 1, "score": -2, "last_activity_date": 1514118595, "creation_date": 1514082890, "question_id": 47957645, "link": "https://stackoverflow.com/questions/47957645/scanr3-why-does-step-a-binary-operator-accept-zero-as-a-parameter", "title": "scanr3: Why does step, a binary operator, accept [zero] as a parameter?", "body": "<p><a href=\"https://en.wikibooks.org/wiki/Haskell/Solutions/Lists_III\" rel=\"nofollow noreferrer\">Lists_III Solutions</a></p>\n\n<p>To do: Write your own definition of scanr using foldr.</p>\n\n<p>After making my function I studied the book's solution and saw that step' calls step which gets its x argument from step' which was called with two list arguments: [zero] and xs. Then step' calls step with a list x and a number (head xs).   Oddly, if you replace [zero] with a number, like plain zero by removing the square brackets, the program compiles but does not run.  It actually wants a list.  Why is that?</p>\n\n<pre><code>--Implement scanr (+) 0 [1,2,3] = [6,5,3,0]: My scnrf\nscnrf   f acc  []     =  [acc]\nscnrf   f acc  y@(x:xs)   =  foldr f  acc y :  scnrf  f  acc  xs\n\n--with fold: Haskell book's solution\nscanr3 step zero xs = foldr step' [zero] xs\n    where step' x xs = (step x (head xs)):xs \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1514084577, "post_id": 47957612, "comment_id": 82884772, "body": "Could you narrow down your question to a specific part you don&#39;t understand? If you&#39;re completely new to Haskell, you should start with a tutorial. There&#39;s a bunch of things going on in those two terse lines."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1514087976, "post_id": 47957612, "comment_id": 82885196, "body": "The code doesn&#39;t do anything, there is no IO."}, {"owner": {"reputation": 452, "user_id": 3531310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c879bfa7b230a3b1a3f96fd3cb830e?s=128&d=identicon&r=PG&f=1", "display_name": "jaroslawj", "link": "https://stackoverflow.com/users/3531310/jaroslawj"}, "edited": false, "score": 0, "creation_date": 1514105963, "post_id": 47957612, "comment_id": 82887857, "body": "First line (function) returns factors of given number n, for example for for 7 it would be 1 and 7, for 9 - 1, 3, 9. Second line returns infinite list of primes, checking if number of factors equals two (1 and the number itself). Play with it inside ghci and you would know how it works."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514109571, "post_id": 47957612, "comment_id": 82888452, "body": "<a href=\"http://learnyouahaskell.com/starting-out#im-a-list-comprehension\" rel=\"nofollow noreferrer\">learnyouahaskell.com/starting-out#im-a-list-comprehension</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": false, "score": 5, "last_activity_date": 1514089598, "creation_date": 1514089598, "answer_id": 47958061, "question_id": 47957612, "link": "https://stackoverflow.com/questions/47957612/could-someone-explain-what-this-code-does-please/47958061#47958061", "title": "Could someone explain what this code does please?", "body": "<p>The first line of your code defines a function called <code>factors</code> which takes an argument <code>n</code>, presumably an <code>Int</code>, and returns a list of elements, defined by a comprehension list.</p>\n\n<p>List comprehensions are syntactic sugar that Haskell provides for you to define lists in, at least to me, a clearer an elegant way.</p>\n\n<p>Basically, they have this pattern:</p>\n\n<pre><code>[ elements | generators and predicates ]\n</code></pre>\n\n<p>Where generators are expressions of the form <code>x &lt;- collection</code> and predicates are boolean expressions. Each expression/predicate on the right side of the <code>|</code> is separated either by a comma or by another <code>|</code>, which means you could have more than one generator in the same list comprehension. Generators serve as a way of take/generate elements from specific collections, where predicates act as filters.</p>\n\n<p>An easy example:</p>\n\n<pre><code>[ x + 1 | x &lt;- [1, 2, 3], x == 2 ]\n</code></pre>\n\n<p>will result in</p>\n\n<pre><code>[3]\n</code></pre>\n\n<p>The generator <code>x &lt;- [1, 2, 3]</code> says, take each element from <code>[1, 2, 3]</code>, and the predicate <code>x == 2</code> states: but only those who accomplish this <code>x == 2</code>, which means the only value that the <code>generators and predicates</code> expression returns is <code>2</code>. Then, <code>elements</code> is <code>x</code> but <code>+ 1</code>, so we result in <code>3</code>.</p>\n\n<p>Let's recap your first line of code:</p>\n\n<pre><code>factors n = [x | x &lt;- [1..n], n `mod` x == 0]\n</code></pre>\n\n<p>Well, the left hand side of the <code>=</code> is clear, it's a function called <code>factors</code> that takes <code>n</code> as an argument, right? And in the right hand side, what do we have? Yes, a list comprehension!</p>\n\n<p>Let's analyze it, remembering the form:</p>\n\n<pre><code>[ form of the elements | generators and predicates ]\n</code></pre>\n\n<p>It seems that we have <code>x</code> as the structure of the elements, and we have two expressions on the right hand side of the <code>|</code>.</p>\n\n<p>The first one</p>\n\n<pre><code>x &lt;- [1..n]\n</code></pre>\n\n<p>is a... generator! It basically says, take the <code>x</code>s from this collection <code>[1..n]</code> (which is the list from 1 to <code>n</code>, the parameter given).</p>\n\n<p>The second one</p>\n\n<pre><code>n `mod` x == 0\n</code></pre>\n\n<p>is a... predicate! It states that the elements we are going to put as a result, must verify this condition: the remainder of <code>n</code> divided by <code>x</code> is <code>0</code>.</p>\n\n<p>All in all, what <code>factors n</code> function does is to calculate the list of numbers from <code>1</code> to <code>n</code> which exactly divide <code>n</code>, that is, the list of <code>n</code> divisors (factors).</p>\n\n<p>Now, I think you will be able to analyze and say what <code>primes</code> does by yourself.</p>\n"}], "owner": {"reputation": 5, "user_id": 8981389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70692410fde916529e9ebfb36360f36?s=128&d=identicon&r=PG&f=1", "display_name": "Omey Iin", "link": "https://stackoverflow.com/users/8981389/omey-iin"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "closed_date": 1514098899, "answer_count": 1, "score": -11, "last_activity_date": 1514089598, "creation_date": 1514082357, "last_edit_date": 1514082466, "question_id": 47957612, "link": "https://stackoverflow.com/questions/47957612/could-someone-explain-what-this-code-does-please", "closed_reason": "Needs more focus", "title": "Could someone explain what this code does please?", "body": "<p>Could someone explain what this code does, please?</p>\n\n<pre><code>factors n = [x | x &lt;- [1..n], n `mod` x == 0]\nprimes = [x| x &lt;- [1..], length (factors x) == 2]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1514075718, "post_id": 47957146, "comment_id": 82883699, "body": "Similar: <a href=\"https://stackoverflow.com/questions/36047841/haskell-foldr-results-in-type-error-while-foldl-doesnt?rq=1\" title=\"haskell foldr results in type error while foldl doesnt\">stackoverflow.com/questions/36047841/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": true, "score": 4, "last_activity_date": 1514076184, "creation_date": 1514076184, "answer_id": 47957221, "question_id": 47957146, "link": "https://stackoverflow.com/questions/47957146/how-to-use-foldl-with-operator/47957221#47957221", "title": "How to use foldl with operator", "body": "<p>The type signatures for <code>foldl</code> and <code>foldr</code> are slightly different in the function argument (they have switched arguments):</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n\nfoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p>For <code>foldl</code> to work you can use <code>flip</code> which swaps the arguments of a function:</p>\n\n<pre><code>flip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c\n</code></pre>\n\n<p>I.e. this should work:</p>\n\n<pre><code>foldl (flip (:)) [] [1..5]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": false, "score": 1, "last_activity_date": 1514123052, "last_edit_date": 1514123052, "creation_date": 1514082297, "answer_id": 47957609, "question_id": 47957146, "link": "https://stackoverflow.com/questions/47957146/how-to-use-foldl-with-operator/47957609#47957609", "title": "How to use foldl with operator", "body": "<p>Let's start by its equations:</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl op z [] = z\nfoldl op z (x:xs) = foldl op (op z x) xs\n</code></pre>\n\n<p>The big difference between <code>foldr</code> and <code>foldl</code> is how the operator <code>op</code> works: <code>foldl</code> is tail recursive and applies the operator from left to right in contrast to <code>foldr</code> which does the oppossite.</p>\n\n<p>So, what you'd probably want is this:</p>\n\n<pre><code>foldl (\\(currentFold, element) -&gt; element:currentFold) [] [1,2,3,4,5]\n</code></pre>\n\n<p>Which could be beautified using <code>flip</code> (as @mschmidt points out)</p>\n\n<p>Recall that from <code>foldr</code> equations:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldr op z [] = z\nfoldr op z (x:xs) = op x (foldr op z xs)\n</code></pre>\n\n<p>it will be slightly different:</p>\n\n<pre><code>foldr (\\(element, currentFold) -&gt; element:currentFold) [] [1,2,3,4,5]\n</code></pre>\n\n<p>Which is the same as the one you posted:</p>\n\n<pre><code>foldr (:) [] [1,2,3,4,5]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1514109450, "creation_date": 1514109450, "answer_id": 47959628, "question_id": 47957146, "link": "https://stackoverflow.com/questions/47957146/how-to-use-foldl-with-operator/47959628#47959628", "title": "How to use foldl with operator", "body": "<p>Another way to understand it, is:</p>\n\n<pre><code>foldr (:) [] [1..5]\n</code></pre>\n\n<p>means</p>\n\n<pre><code>1 : (2 : (3 : (4 : (5 : []))))\n</code></pre>\n\n<p>while</p>\n\n<pre><code>foldl (:) [] [1..5]\n</code></pre>\n\n<p>means</p>\n\n<pre><code>(((([] : 1) : 2) : 3) : 4) : 5\n</code></pre>\n\n<p>The latter makes no sense: is uses numbers as if they were lists. Further, every usage of <code>:</code> changes the type of the output (<code>[]</code> is a list, <code>[]:x</code> is a list-of-lists, <code>([]:x):y</code> is a list-of-lists-of-lists, and so on).</p>\n"}], "owner": {"reputation": 29, "user_id": 6414952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82a488c30ab37a6afc14a8a2f56481bc?s=128&d=identicon&r=PG&f=1", "display_name": "woljako", "link": "https://stackoverflow.com/users/6414952/woljako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 47957221, "answer_count": 3, "score": 1, "last_activity_date": 1514123052, "creation_date": 1514075188, "last_edit_date": 1514075948, "question_id": 47957146, "link": "https://stackoverflow.com/questions/47957146/how-to-use-foldl-with-operator", "title": "How to use foldl with operator", "body": "<p>I thought that two codes should run properly</p>\n\n<pre><code>foldr (:) [] [1..5]\nfoldl (:) [] [1..5]\n</code></pre>\n\n<p>But I get error use foldl:</p>\n\n<pre><code>Occurs check: cannot construct the infinite type: a ~ [a]\nExpected type: [a] -&gt; [a] -&gt; [a]\nActual type: a -&gt; [a] -&gt; [a]\nRelevant bindings include it :: [a] (bound at &lt;interactive&gt;:253:1)\nIn the first argument of \u2018foldl\u2019, namely \u2018(:)\u2019\nIn the expression: foldl (:) [] [1 .. 5]\n</code></pre>\n\n<p>Why foldl not run?</p>\n"}, {"tags": ["haskell", "parallel-processing"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1514068062, "post_id": 47956309, "comment_id": 82882481, "body": "This seems a bit vague. Is the only issue that only a single hardware thread is being used? If so this is due to the  distinction between parallelism and concurrency. Note the text &quot;using -N1&quot;  in your output. Pass e.g. <code>+RTS -N8</code> to your program"}, {"owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514077052, "post_id": 47956309, "comment_id": 82883876, "body": "Thanks, this fixed it. You might as well turn this into an answer."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514135068, "post_id": 47957576, "comment_id": 82894198, "body": "I googled &quot;distinction between parallelism and concurrency&quot; and the two top entries&#39; quotations on the search results page seem to contradict each other. The third entry, Quora&#39;s, 2nd answer says two terms are interchangeable. Could you perhaps clarify the issue? Give links to resources that you approve of? Something? Thanks."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514138573, "post_id": 47957576, "comment_id": 82895092, "body": "I&#39;m afraid I can&#39;t find any such contradiction in the google results; nor any claim they are interchangeable terms. However, I&#39;ve included some links in the answer (which agree with my understanding)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1514138929, "post_id": 47957576, "comment_id": 82895183, "body": "I guess things are somewhat complicated by the fact that the Haskell package in question is called <code>parallel</code> and claims to implement &quot;parallel programming&quot;, when it really implements concurrent programming - indeed with only one physical thread, parallelism is by definition impossible. But I suppose the intent of <code>parallel</code> and libraries like it is to define a pure interface for parallelism, which, on a denotational level, is only implementing concurrency, but is intended to be used with <code>-N&lt;threads&gt;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514141152, "post_id": 47957576, "comment_id": 82895730, "body": "I don&#39;t see what <code>parallel</code> has to do with concurrent programming. Concurrent programming features show up in <code>base</code>, <code>stm</code>, and <code>async</code>. <code>parallel</code> is all about parallelism, as best I can tell."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514144677, "post_id": 47957576, "comment_id": 82896523, "body": "link-only answers, without any summary of their contents, are frowned upon. I&#39;m not referring to the whole of your answer of course, but to the part with the link. It would really help if you could provide some short description, is all I&#39;m saying."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514147813, "post_id": 47957576, "comment_id": 82897121, "body": "@WillNess Sure, but the first paragraph isn&#39;t really important to the answer; nor can I see a way to summarize the distinction (or what I believe it to be) better than <a href=\"https://stackoverflow.com/questions/1050222/concurrency-vs-parallelism-what-is-the-difference/1050257#1050257\">this</a> answer. Maybe I should just quote it? Given how contentious this section of the answer has been, I&#39;m inclined to just delete it (but this leaves a very confusing comment train)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514149771, "post_id": 47957576, "comment_id": 82897514, "body": "@user2407038 I was bold and made an edit. :) Perhaps it&#39;ll serve as a starting point for your further edit, correcting the wording or something, or you will want to revert it altogether. :) Hope this helps."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1514218356, "post_id": 47957576, "comment_id": 82909781, "body": "@WillNess Thanks a lot for your help. I think I&#39;ve finally got this answer in a place where I&#39;m satisfied with it. Notably I&#39;ve removed the language &quot; a very well explored topic &quot; which seems to imply that it is a trivial topic; which we&#39;ve discovered it most certainly isn&#39;t...."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 5, "last_activity_date": 1514218141, "last_edit_date": 1514218141, "creation_date": 1514081811, "answer_id": 47957576, "question_id": 47956309, "link": "https://stackoverflow.com/questions/47956309/haskell-whats-up-with-parmap/47957576#47957576", "title": "Haskell - What&#39;s up with parMap?", "body": "<p>By default, GHC runs all programs using a single OS thread, even with <code>-threaded</code> enabled. Note the text \"using -N1\" in your output - it indicates that the program is being run with 1 physical thread.</p>\n\n<p>In short: pass e.g. <code>+RTS -N8</code> to your program. For documentation of this flag, see <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using-concurrent.html#rts-flag--N%20%E2%9F%A8x%E2%9F%A9\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<hr>\n\n<p>In a broad sense, this is due to the distinction between parallelism and concurrency. <a href=\"https://stackoverflow.com/questions/1050222/concurrency-vs-parallelism-what-is-the-difference\">Here</a> <a href=\"https://stackoverflow.com/questions/1897993/what-is-the-difference-between-concurrent-programming-and-parallel-programming\">are</a> <a href=\"https://softwareengineering.stackexchange.com/questions/190719/the-difference-between-concurrent-and-parallel-execution\">some</a> SO questions which try to explain the difference. The difference can be summarized as: </p>\n\n<ul>\n<li><p>parrallelism: a task subdivided into similar chunks to run simultaneously on separate cores/CPUs at some point in time; for increased speed</p></li>\n<li><p>concurrency: several tasks being executed conceptually independently such that their execution times overlap, whether on the same thread through time slicing or on separate cores/CPUs; usually utilizing shared resources more efficiently</p></li>\n</ul>\n\n<p>However, these definitions are somewhat contentious; sometimes the two have opposite meanings, and sometimes they are used interchangeably. However, for the purpose of understanding this problem (why you must pass another flag in addition to <code>-threaded</code> to make a 'parallel' program actually run in parallel) I believe they are useful definitions.</p>\n"}], "owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 47957576, "answer_count": 1, "score": 1, "last_activity_date": 1514218141, "creation_date": 1514065712, "question_id": 47956309, "link": "https://stackoverflow.com/questions/47956309/haskell-whats-up-with-parmap", "title": "Haskell - What&#39;s up with parMap?", "body": "<p>I've run some tests:</p>\n\n<pre><code>import Control.Parallel.Strategies\nimport Data.Vector as V\nimport Data.Maybe\n\nparMapVec :: (a -&gt; b) -&gt; Vector a -&gt; Vector b\nparMapVec f v = runEval $ evalTraversable rpar $ V.map f v\n\nrange :: Integer -&gt; Integer -&gt; Vector Integer\nrange x y\n  | x == y = x `cons` empty\n  | x &lt; y  = x `cons` (range (x + 1) y)\n  | x &gt; y  = (range x (y + 1)) `snoc` y\n\nfac :: Integer -&gt; Integer\nfac n\n  | n &lt; 2     = 1\n  | otherwise = n * (fac $ n - 1)\n\nmain :: IO ()\nmain = do\n  let result = runEval $ do\n        let calc = parMapVec fac $ 80000 `range` 80007\n        rseq calc\n        return calc\n  putStrLn $ show result\n</code></pre>\n\n<p>As well as with the following modification to <code>main</code> to make sure that my <code>parMapVector</code> wasn't what was wrong:</p>\n\n<pre><code>main = do\n  let result = runEval $ do\n        let calc = parMap rpar fac [80000..80007]\n        rseq calc\n        return calc\n  putStrLn $ show result\n</code></pre>\n\n<p>I compiled with <code>gch --make parVectorTest.hs -threaded -rtsopts</code> and ran both with <code>./parVectorTest -s</code>.</p>\n\n<p>Here's what I found with the version with vectors:</p>\n\n<pre><code>56,529,547,832 bytes allocated in the heap\n10,647,896,984 bytes copied during GC\n    7,281,792 bytes maximum residency (16608 sample(s))\n    3,285,392 bytes maximum slop\n            21 MB total memory in use (0 MB lost due to fragmentation)\n\n                                    Tot time (elapsed)  Avg pause  Max pause\nGen  0     82708 colls,     0 par    0.828s   0.802s     0.0000s    0.0016s\nGen  1     16608 colls,     0 par   15.006s  14.991s     0.0009s    0.0084s\n\nTASKS: 4 (1 bound, 3 peak workers (3 total), using -N1)\n\nSPARKS: 8 (7 converted, 0 overflowed, 0 dud, 0 GC'd, 1 fizzled)\n\nINIT    time    0.001s  (  0.001s elapsed)\nMUT     time    5.368s  (  5.369s elapsed)\nGC      time   15.834s  ( 15.793s elapsed)\nEXIT    time    0.001s  (  0.000s elapsed)\nTotal   time   21.206s  ( 21.163s elapsed)\n\nAlloc rate    10,530,987,847 bytes per MUT second\n\nProductivity  25.3% of total user, 25.4% of total elapsed\n\ngc_alloc_block_sync: 0\nwhitehole_spin: 0\ngen[0].sync: 0\ngen[1].sync: 0\n</code></pre>\n\n<p>So that's good, except that I watched the process execute on my system monitor, and only one core was working at a time. Every time one of the results was printed out, the process would switch to a different core. So I thought it was something wrong with my <code>parMapVec</code> function. But then I did the same thing except with the version with lists:</p>\n\n<pre><code>56,529,535,488 bytes allocated in the heap\n12,483,967,024 bytes copied during GC\n    6,246,872 bytes maximum residency (19843 sample(s))\n    2,919,544 bytes maximum slop\n            20 MB total memory in use (0 MB lost due to fragmentation)\n\n                                    Tot time (elapsed)  Avg pause  Max pause\nGen  0     79459 colls,     0 par    0.818s   0.786s     0.0000s    0.0009s\nGen  1     19843 colls,     0 par   17.725s  17.709s     0.0009s    0.0087s\n\nTASKS: 4 (1 bound, 3 peak workers (3 total), using -N1)\n\nSPARKS: 16 (14 converted, 0 overflowed, 0 dud, 1 GC'd, 1 fizzled)\n\nINIT    time    0.001s  (  0.001s elapsed)\nMUT     time    5.394s  (  5.400s elapsed)\nGC      time   18.543s  ( 18.495s elapsed)\nEXIT    time    0.000s  (  0.000s elapsed)\nTotal   time   23.940s  ( 23.896s elapsed)\n\nAlloc rate    10,479,915,927 bytes per MUT second\n\nProductivity  22.5% of total user, 22.6% of total elapsed\n\ngc_alloc_block_sync: 0\nwhitehole_spin: 0\ngen[0].sync: 0\ngen[1].sync: 0\n</code></pre>\n\n<p>So there was more garbage collection, which makes sense. And there was also more sparks, which I don't know how to explain. This program exhibited the same behavior when I watched it execute on my system monitor.</p>\n\n<p>I also ran both tests with <code>./parVector -s -C0.01</code> because of the answer to <a href=\"https://stackoverflow.com/questions/46586941/why-are-ghc-sparks-fizzling\">this question</a> and got basically the same results. I'm on a Lenovo Ideapad, 8 cores, running Ubuntu Linux 17.04. At the time of the tests, the only apps I had open were VS Code and my system monitor, although there other processes taking up a very small portion of the processing power. Does a processor have to be completely idle to take a spark?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1514068581, "post_id": 47956250, "comment_id": 82882583, "body": "That&#39;s not the only problem here. In fact, the code looks pretty much completely bogus."}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 3, "last_activity_date": 1514065090, "creation_date": 1514065090, "answer_id": 47956250, "question_id": 47956176, "link": "https://stackoverflow.com/questions/47956176/haskell-not-in-scope-class-gen/47956250#47956250", "title": "Haskell - Not in scope: class Gen", "body": "<p>Hoogle reports that <code>choose</code> is a function from QuickCheck (see <a href=\"https://www.haskell.org/hoogle/?hoogle=choose\" rel=\"nofollow noreferrer\">here</a>). <code>Gen</code> is a type from <a href=\"https://hackage.haskell.org/package/QuickCheck-2.10.1/docs/Test-QuickCheck-Gen.html\" rel=\"nofollow noreferrer\"><code>Test.QuickCheck.Gen</code></a>.</p>\n\n<p>You just need to add an <code>import</code> statement for the QuickCheck library (<code>Test.QuickCheck</code> and <code>Test.QuickCheck.Gen</code>) and make sure your build system is aware of the library.</p>\n"}], "owner": {"reputation": 380, "user_id": 9090849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/307621803079298/picture?type=large", "display_name": "Filipe N&#243;brega", "link": "https://stackoverflow.com/users/9090849/filipe-n%c3%b3brega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 47956250, "answer_count": 1, "score": -4, "last_activity_date": 1514065499, "creation_date": 1514064550, "last_edit_date": 1514065499, "question_id": 47956176, "link": "https://stackoverflow.com/questions/47956176/haskell-not-in-scope-class-gen", "title": "Haskell - Not in scope: class Gen", "body": "<p>In the main module we have:</p>\n\n<pre><code>import System.Environment\nimport System.Random\n\nmain = do\n    args &lt;- getArgs\n    random &lt;- choose (0,100000) :: Gen Int\n    newCards = baralhar (mkStdGen random) baralho40\n    putStrLn $ \"-----The End -----\"\n</code></pre>\n\n<p>and we get this error when we compile:</p>\n\n<pre><code>Bisca.hs:13:36: error:\n    Not in scope: type constructor or class \u2018Gen\u2019\n   |\n13 |     random &lt;- choose (0,100000) :: Gen Int\n   |                                    ^^^    \n</code></pre>\n\n<p>I don\u00b4t understand what the Gen means and what the solution could be</p>\n"}, {"tags": ["regex", "haskell"], "comments": [{"owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 1, "creation_date": 1514063908, "post_id": 47956032, "comment_id": 82881586, "body": "Why not use <code>\\d+</code> instead of <code>.*</code> ?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 0, "creation_date": 1514064268, "post_id": 47956032, "comment_id": 82881677, "body": "Thanks for the suggestion, that does not seem to work either (updated the question)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514067365, "post_id": 47956032, "comment_id": 82882366, "body": "What effort have you made to resolve this error? There is indeed no such instance, so of course this code doesn&#39;t work ( specify a different type such that the instance does actually exist )."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 7, "last_activity_date": 1514068613, "creation_date": 1514068613, "answer_id": 47956582, "question_id": 47956032, "link": "https://stackoverflow.com/questions/47956032/how-can-i-use-regex-to-match-an-integer-with-haskell/47956582#47956582", "title": "How can I use regex to match an integer with Haskell?", "body": "<p>First of all I wouldn't use a Regex-library - because <a href=\"http://regex.info/blog/2006-09-15/247\" rel=\"noreferrer\">now you got two problems</a>, haskell has a good - no great ecosystem of parsers that will do the job for you.</p>\n\n<p>The solution to your problem is - I think you used the wrong regex.</p>\n\n<pre><code>$ stack ghci --package regex-posix --package safe\n...\nPrelude&gt; :m + Safe Text.Regex.Posix\nPrelude Safe Text.Regex.Posix&gt; readMay (\"123_\" =~ \"[0-9]+\") :: Maybe Integer\nJust 123\n</code></pre>\n\n<p>The downside of using regex is they are hard to understand/get right in the first place and to maintain afterwards, error prone (in my opinion) - and moreover. And when you match with it you get the matched <code>String</code>. I.e. <code>(\"123_\" =~ \"([0-9]+)_\") :: String</code> will yield \"123_\" and not \"123\" thus \"readMay ...\"  will return a <code>Nothing</code> instead of <code>Just 123</code>.</p>\n\n<p>Therefore I would recommend using a parsing library - something like <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"noreferrer\">attoparsec</a>. But as I said there are plenty of parsing alternatives if you don't like this one.</p>\n\n<pre><code>$ stack ghci --package attoparsec\nPrelude&gt; :set -XOverloadedStrings\nPrelude&gt; import Data.Attoparsec.ByteString.Char8 as C8\nPrelude Data.Attoparsec.Char8&gt; :{\nPrelude Data.Attoparsec.Char8| strangeNumber = do\nPrelude Data.Attoparsec.Char8|   d &lt;- decimal\nPrelude Data.Attoparsec.Char8|   char '_'\nPrelude Data.Attoparsec.Char8|   return d\nPrelude Data.Attoparsec.Char8| :}\nPrelude C8&gt; parseOnly strangeNumber \"123_\" :: Either String Integer\nRight 123\n</code></pre>\n\n<p>Putting this in ghci is a bit unwieldy, but in a file it is perfectly fine and maintainable - so if you want to allow for optional '_' at the beginning and/or end of the number you can write this as</p>\n\n<p><code>StrangeNumber.hs</code></p>\n\n<pre><code>strangeNumber :: Parser Integer\nstrangeNumber = do\n  skipMany (char '_')\n  d &lt;- decimal\n  skipMany (char '_')\n  return d\n</code></pre>\n\n<p>and using it in GHCi</p>\n\n<pre><code>Prelude Data.Attoparsec.ByteString.Char8&gt; parseOnly strangeNumber \"123_\"\nRight 123\nPrelude Data.Attoparsec.ByteString.Char8&gt; parseOnly strangeNumber \"_123_\"\nRight 123\nPrelude Data.Attoparsec.ByteString.Char8&gt; parseOnly strangeNumber \"_123__\"\nRight 123\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 47956582, "answer_count": 1, "score": 1, "last_activity_date": 1514068613, "creation_date": 1514063339, "last_edit_date": 1514064241, "question_id": 47956032, "link": "https://stackoverflow.com/questions/47956032/how-can-i-use-regex-to-match-an-integer-with-haskell", "title": "How can I use regex to match an integer with Haskell?", "body": "<p>How can I retrieve a <code>123 :: Integer</code> value from a string like <code>123_</code> using any regex related Haskell library?</p>\n\n<pre><code>import Text.Regex.Posix\n\nlet (_,_,_,[sectionKey]) = (\"123_\") =~ (\"(\\\\d+)_\" :: String) :: (String, String, String, [Int])\n</code></pre>\n\n<p>I've tried the above (using the <a href=\"https://hackage.haskell.org/package/regex-posix\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/regex-posix</a> library) which produces an error of:</p>\n\n<pre><code>\u2022 No instance for (RegexContext\n                     Regex [Char] (String, String, String, [Int]))\n    arising from a use of \u2018=~\u2019\n\u2022 In the expression:\n      (\"123_\") =~ (\"(\\\\d+)_\" :: String) ::\n        (String, String, String, [Int])\n  In a pattern binding:\n    (_, _, _, [sectionKey])\n      = (\"123_\") =~ (\"(\\\\d+)_\" :: String) ::\n          (String, String, String, [Int])\n</code></pre>\n\n<p>This is a simplified case, I'm looking for a solution that will provide a regex compatible solution.</p>\n"}, {"tags": ["haskell", "warnings", "code-generation", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "edited": false, "score": 2, "creation_date": 1514136617, "post_id": 47954880, "comment_id": 82894600, "body": "On how to use this flag to achieve the desired result: <a href=\"https://stackoverflow.com/a/32959693/55246\">stackoverflow.com/a/32959693/55246</a>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1514053170, "creation_date": 1514053170, "answer_id": 47954880, "question_id": 47954609, "link": "https://stackoverflow.com/questions/47954609/finding-explicit-imports-for-ghcs-wmissing-import-lists/47954880#47954880", "title": "Finding explicit imports for ghc&#39;s -Wmissing-import-lists", "body": "<p>GHC has a <code>-ddump-minimal-imports</code> flag which will do the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 1, "last_activity_date": 1514111438, "creation_date": 1514111438, "answer_id": 47959811, "question_id": 47954609, "link": "https://stackoverflow.com/questions/47954609/finding-explicit-imports-for-ghcs-wmissing-import-lists/47959811#47959811", "title": "Finding explicit imports for ghc&#39;s -Wmissing-import-lists", "body": "<p>There's an open pull request un <code>importify</code> tool which I'm working on. After this is done you will be able to convert implicit imports to explicit automatically:</p>\n\n<p><a href=\"https://github.com/serokell/importify/pull/82\" rel=\"nofollow noreferrer\">https://github.com/serokell/importify/pull/82</a></p>\n"}, {"tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1515299710, "creation_date": 1515299710, "answer_id": 48134342, "question_id": 47954609, "link": "https://stackoverflow.com/questions/47954609/finding-explicit-imports-for-ghcs-wmissing-import-lists/48134342#48134342", "title": "Finding explicit imports for ghc&#39;s -Wmissing-import-lists", "body": "<p>The <a href=\"http://haskelltools.org\" rel=\"nofollow noreferrer\">Haskell Tools</a> project has some nice looking tooling for that. Apparently it works in Atom but I couldn't get it to work with atom or atom-beta on macOS. However, it does work at the command line. I have <a href=\"https://github.com/steshaw/ht-example\" rel=\"nofollow noreferrer\">a simple example stack project set up</a>. The <code>Main.hs</code> uses an explicit import list:</p>\n\n<pre><code>module Main where\n\nimport System.Environment\n\ndoMain = print =&lt;&lt; getEnvironment\n\nmain = doMain\n</code></pre>\n\n<p>BTW, I installed the Haskell Tools with:</p>\n\n<pre><code>$ stack install haskell-tools-daemon haskell-tools-cli fswatch\n</code></pre>\n\n<p>Then execute:</p>\n\n<pre><code>$ ht-refact -e 'ProjectOrganizeImports' .\n</code></pre>\n\n<p>Now git tells me that I have the following diff:</p>\n\n<pre><code>-import System.Environment\n+import System.Environment (getEnvironment)\n</code></pre>\n\n<p>Check out the <a href=\"http://haskelltools.org\" rel=\"nofollow noreferrer\">Haskell Tools</a> website for an interactive example of how it should work in an editor. Looks like a very promising set of refactoring tools.</p>\n"}], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1515299710, "creation_date": 1514050860, "question_id": 47954609, "link": "https://stackoverflow.com/questions/47954609/finding-explicit-imports-for-ghcs-wmissing-import-lists", "title": "Finding explicit imports for ghc&#39;s -Wmissing-import-lists", "body": "<p>GHC generates warnings when there are implicit imports (see below). The goal is to replace these with explicit imports. Is there an automated way to generated the list (instead of manually finding it in code)?</p>\n\n<pre><code>/Users/srid/code/slownews/backend/src/SlowNews/Main.hs:10:1: warning: [-Wmissing-import-lists]\n    The module \u2018Control.Exception\u2019 does not have an explicit import list\n   |\n10 | import           Control.Exception\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n/Users/srid/code/slownews/backend/src/SlowNews/Main.hs:13:1: warning: [-Wmissing-import-lists]\n    The module \u2018Control.Monad.IO.Class\u2019 does not have an explicit import list\n   |\n13 | import           Control.Monad.IO.Class\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "higher-order-functions", "fold"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 6, "creation_date": 1514051254, "post_id": 47954602, "comment_id": 82878557, "body": "&quot;I&#39;m getting an error&quot; isn&#39;t very helpful, please post the full error message in your post, not an image."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1514060568, "post_id": 47954602, "comment_id": 82880856, "body": "It&#39;s always better to avoid <code>head,tail,!!</code>, when possible, since these are dangerously partial."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514068974, "post_id": 47954602, "comment_id": 82882662, "body": "You really <i>shouldn&#39;t</i> use <code>foldl</code> for this purpose. You&#39;re guaranteed to get code that&#39;s less efficient and less lazy than it should be. You can do much better with <code>foldr</code>, but you&#39;ll have to be a bit clever about it."}], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 4, "last_activity_date": 1514053859, "creation_date": 1514053859, "answer_id": 47954966, "question_id": 47954602, "link": "https://stackoverflow.com/questions/47954602/how-can-i-drop-nth-element-of-a-list-using-foldl/47954966#47954966", "title": "How can I drop nth element of a list using foldl?", "body": "<p><code>a</code> are presumably the elements that you have already decided not to drop. You should then decide whether to drop, not the last element of <code>a</code>, but the next element in <code>xs</code>, which is presumably <code>b</code>.</p>\n\n<p><code>b ++ []</code> is presumably meant to express that you have decided not to drop the element <code>b</code>, instead adding it to the list <code>a</code>. This is actually written <code>a ++ [b]</code>.</p>\n\n<p>This allows me to write this piece of code, which at least compiles:</p>\n\n<pre><code>dropnth' :: Eq a =&gt; [a] -&gt; Int -&gt; [a]\ndropnth' xs n = foldl (\\a b -&gt; if b == xs!!n then a else a ++ [b]) [head xs] xs\n</code></pre>\n\n<p><code>xs!!n</code> finds the nth element of <code>xs</code>, and comparing with that will find decide whether something's value is equal to that, not something's position. Note the <code>Eq a</code>, which tells us that we are comparing list values. <code>foldl</code> will have to get the positions of the entries from somewhere, such as from <code>zip [0..]</code>.</p>\n\n<pre><code>dropnth' :: [a] -&gt; Int -&gt; [a]\ndropnth' xs n = foldl (\\a (i, b) -&gt; if mod i n == 0 then a else a ++ [b]) [head xs] (zip [0..] xs)\n</code></pre>\n\n<p>Adding an element to the end of a list has to rebuild the whole list. Building the list up from its end would be much more efficient. But in this case, we can even use more specialized list operations for our use case.</p>\n\n<pre><code>dropnth' :: [a] -&gt; Int -&gt; [a]\ndropnth' xs n = [b | (i, b) &lt;- zip [0..] xs, mod i n &gt; 0]\n</code></pre>\n\n<p>Note that we now drop the initial element as well. Perhaps that is what you want? Or you could <code>zip</code> with <code>[1..]</code> instead to shift all the crosshairs one to the left.</p>\n\n<p>Usually, type signatures like <code>Int -&gt; [a] -&gt; [a]</code> compose better.</p>\n"}], "owner": {"reputation": 1, "user_id": 7089881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pV_UEoKPaiU/AAAAAAAAAAI/AAAAAAAAAFo/-X8HLb6zs58/photo.jpg?sz=128", "display_name": "mehmetcanaygun", "link": "https://stackoverflow.com/users/7089881/mehmetcanaygun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 47954966, "answer_count": 1, "score": -3, "last_activity_date": 1514061072, "creation_date": 1514050792, "last_edit_date": 1514061072, "question_id": 47954602, "link": "https://stackoverflow.com/questions/47954602/how-can-i-drop-nth-element-of-a-list-using-foldl", "title": "How can I drop nth element of a list using foldl?", "body": "<pre><code>dropnth' :: [a] -&gt; Int -&gt; [a]\ndropnth' xs n = foldl (\\a b -&gt; if (last a) == xs!!n then a else b ++ []) [head xs] xs\n</code></pre>\n\n<p>I was trying to solve this \"dropping every nth element of a list\" question using foldl, but I'm getting an error. How can I do that?</p>\n\n<p>Error:\n<img src=\"https://i.stack.imgur.com/t7Vmn.jpg\" alt=\"The error\"></p>\n"}, {"tags": ["haskell", "hashmap"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1514049489, "post_id": 47954108, "comment_id": 82878110, "body": "Don&#39;t prematurely optimize. If you can make the program you want with HashMaps, do it."}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1514051159, "post_id": 47954108, "comment_id": 82878531, "body": "Well sure, but I&#39;d rather not rewrite the whole thing in C after the fact because it&#39;s horribly slow, I&#39;d rather know before if what I want to do will result in hundreds or thousands of pointless copies each frame or not"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1514056143, "post_id": 47954108, "comment_id": 82879819, "body": "Then benchmark it to find out if it meets your requirements. Of find <a href=\"https://github.com/tanakh/hashtable-bench\" rel=\"nofollow noreferrer\">someone else&#39;s benchmark</a> and <a href=\"https://rawgit.com/tanakh/hashtable-bench/master/result.html\" rel=\"nofollow noreferrer\">use their results</a>."}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1514105697, "post_id": 47955512, "comment_id": 82887798, "body": "I&#39;m going to change at least two values in each object in all the hashmaps every tick (the x and y coordinates), but if they can share everything that doesn&#39;t change, I guess it won&#39;t be that much work. That&#39;s what I wanted to know, thanks !"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1514058675, "creation_date": 1514058675, "answer_id": 47955512, "question_id": 47954108, "link": "https://stackoverflow.com/questions/47954108/data-hashmap-performances-outside-of-io/47955512#47955512", "title": "Data.HashMap performances outside of IO", "body": "<p>I support the comments about avoiding premature optimization and benchmarking, instead of guessing, to determine if performance is acceptable.  That said, you had some specific questions too.</p>\n\n<blockquote>\n  <p>Data.HashMap.Strict (or Lazy ?) would probably work better, but I imagine each change would create a new copy, and the GC would free up the old one at some future point. Is that correct ?</p>\n</blockquote>\n\n<p>Yes, the path to the modified node will consist of new nodes.  Modulo balancing, the sub trees on the left and right of the path will all be shared (not copied) by the old and new tree structures.</p>\n\n<blockquote>\n  <p>That would potentially mean hundreds of copy then free per frame</p>\n</blockquote>\n\n<p>I'm not sure where you get \"hundreds\" from.  Are you saying there are hundreds of updates?  For some structures there are rewrite rules that allow much of the intermediate values to be used in a mutating manner.  See for example, <a href=\"https://stackoverflow.com/questions/45840094/when-does-modify-copy-the-vector/45850410#45850410\">this small examination of vector</a>.</p>\n\n<blockquote>\n  <p>So how does this work in practice ?</p>\n</blockquote>\n\n<p>In practice people implement what they want and rework parts that are too slow.  I might reach for HashMap early, instead of assuming the containers <code>Data.Map</code> will suffice, but I don't go beyond that without evidence.</p>\n"}], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47955512, "answer_count": 1, "score": 0, "last_activity_date": 1514058675, "creation_date": 1514046478, "question_id": 47954108, "link": "https://stackoverflow.com/questions/47954108/data-hashmap-performances-outside-of-io", "title": "Data.HashMap performances outside of IO", "body": "<p>I've discovered Helm (<a href=\"http://helm-engine.org/\" rel=\"nofollow noreferrer\">http://helm-engine.org/</a>) the other day and I've been playing a bit with it. I like Elm, so Helm has been great to use thus far.\nSimply put, the update function gets called every tick and get passed the model, and has to return an updated version of that model. Another function then gets called to render that model on screen.</p>\n\n<p>For small games with not much in the model it seems ideal, but I've been thinking about something a bit bigger, for which a HashMap (or a lot of them) would be ideal, and I'm wondering about the performances of that.</p>\n\n<p>I'm no expert but I believe using the Data.HashTable.IO should modify the hashtable in ram instead of creating a new copy on change, but that seems complicated to interface with Helm. That would mean using a Cmd for each lookups and each changes and returning that to Helmn and then get passed the result from a new call to update, a nightmare to use if you have more than one or two things to lookup I think.</p>\n\n<p>Data.HashMap.Strict (or Lazy ?) would probably work better, but I imagine each change would create a new copy, and the GC would free up the old one at some future point. Is that correct ?\nThat would potentially mean hundreds of copy then free per frame, unless the whole thing is smart enough to realise I'm not using the old hashtable again after the change and just not copy it.</p>\n\n<p>So how does this work in practice ? (I'm thinking of HashMap because it seems like the easier solution, but I guess this applies to regular lists too).</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1514063291, "post_id": 47954175, "comment_id": 82881468, "body": "Explaining my formatting edit: we don&#39;t use <code>```</code> for code blocks; we use 4 spaces. Also, the language is automatically chosen from the tags. If you need to override the automatic decision for any reason, you can give the language by placing an HTML comment of the form <code>&lt;!-- language: ... --&gt;</code> before each code block. This is usually only necessary for language agnostic and multilingual questions."}], "tags": [], "owner": {"reputation": 1329, "user_id": 383958, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JjIgB.jpg?s=128&g=1", "display_name": "Joel Burget", "link": "https://stackoverflow.com/users/383958/joel-burget"}, "is_accepted": true, "score": 8, "last_activity_date": 1514063208, "last_edit_date": 1514063208, "creation_date": 1514047173, "answer_id": 47954175, "question_id": 47954076, "link": "https://stackoverflow.com/questions/47954076/using-state-monad-without-get-function/47954175#47954175", "title": "Using state monad without &quot;get&quot; function", "body": "<p>Let's look at the line <code>boss.health -= 10</code>. <code>-=</code> is <a href=\"https://hackage.haskell.org/package/lens-4.15.4/docs/src/Control.Lens.Setter.html#-%3D\" rel=\"nofollow noreferrer\">defined</a> in the <code>lens</code> package as:</p>\n\n<pre><code>(-=) :: (MonadState s m, Num a) =&gt; ASetter' s a -&gt; a -&gt; m ()\nl -= b = State.modify (l -~ b)\n</code></pre>\n\n<p>Two points about this definition:</p>\n\n<ol>\n<li><p>It doesn't use <code>get</code> / <code>put</code>, but <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Lazy.html#v:modify\" rel=\"nofollow noreferrer\"><code>modify</code></a>, where <code>modify f</code> is equivalent to <code>get x &gt;&gt;= \\x -&gt; put (f x)</code></p></li>\n<li><p>The first argument is <code>ASetter' s a</code>. A lens, in particular <code>boss.health</code> which the article used, works. The operator says \"I'll subtract from the value in the state using the lens you pass\".</p></li>\n</ol>\n"}], "owner": {"reputation": 2659, "user_id": 581085, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5ef2ca8729e462595f1500b554ef95e0?s=128&d=identicon&r=PG", "display_name": "Dragno", "link": "https://stackoverflow.com/users/581085/dragno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 47954175, "answer_count": 1, "score": 3, "last_activity_date": 1514063208, "creation_date": 1514046202, "last_edit_date": 1514049927, "question_id": 47954076, "link": "https://stackoverflow.com/questions/47954076/using-state-monad-without-get-function", "title": "Using state monad without &quot;get&quot; function", "body": "<p>In <a href=\"http://www.haskellforall.com/2013/05/program-imperatively-using-haskell.html\" rel=\"nofollow noreferrer\">this</a> nice article about lenses Gabriel Gonzalez writes this code:</p>\n\n<pre><code>import Control.Monad.Trans.Class\nimport Control.Monad.Trans.State\n\nstrike :: StateT Game IO ()\nstrike = do\n        lift $ putStrLn \"*shink*\"\n        boss.health -= 10\n</code></pre>\n\n<p>but later on writes</p>\n\n<pre><code>newState^.boss.health\n</code></pre>\n\n<p>I know that in order to modify the <code>State</code> monad (here is the <code>StateT</code> monad transformer) you need to get the state using the <code>get</code> function, do something with it, and then use the <code>put</code> function. But here the author does not use these functions. Also in the second example he uses the <code>^</code> operator which means that to use the <code>boss</code> lens you need a <code>Game</code> value. But he does not do that in the first example. How?</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1514052040, "creation_date": 1514052040, "answer_id": 47954735, "question_id": 47953171, "link": "https://stackoverflow.com/questions/47953171/using-the-quickcheckall-function-in-tasty-quickcheck/47954735#47954735", "title": "Using the quickCheckAll function in tasty-quickcheck", "body": "<p>That doesn't seem possible with <code>quickCheckAll</code> but the underlying logic could be reused by testing frameworks. <a href=\"https://github.com/nick8325/quickcheck/pull/192\" rel=\"nofollow noreferrer\">Here's a new PR to get all properties in a list.</a></p>\n"}], "owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 47954735, "answer_count": 1, "score": 1, "last_activity_date": 1514052040, "creation_date": 1514038191, "last_edit_date": 1514040919, "question_id": 47953171, "link": "https://stackoverflow.com/questions/47953171/using-the-quickcheckall-function-in-tasty-quickcheck", "title": "Using the quickCheckAll function in tasty-quickcheck", "body": "<p><em>Short version</em>: It is possible to use the <code>quickCheckAll</code> function in tasty-quickcheck?</p>\n\n<p><em>Long version</em>:</p>\n\n<p>The <code>quickCheckAll</code> function tests <strong>all</strong> properties beginning with <code>prop_</code> in the current module as shows the following example:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule Main where\n\nimport Test.QuickCheck ( quickCheckAll )\n\nprop_1 :: Int -&gt; Bool\nprop_1 x = x + x == 2 * x\n\nprop_2 :: Int -&gt; Int -&gt; Bool\nprop_2 x y = x + y == y + x\n\n-- Template Haskell hack to make the following $quickCheckAll work\n-- under GHC &gt;= 7.8.\nreturn []\n\n-- All properties as collected by 'quickCheckAll'.\nrunTests :: IO Bool\nrunTests = $quickCheckAll\n\nmain :: IO ()\nmain = runTests &gt;&gt; return ()\n</code></pre>\n\n<p>On the other hand, I can use QuickCheck in the Tasty test framework via the tasty-quickcheck package as shows the following example:</p>\n\n<pre><code>module Main where\n\nimport Test.Tasty ( defaultMain, testGroup, TestTree )\n\nimport qualified Test.Tasty.QuickCheck as QC\n\nprop_1 :: Int -&gt; Bool\nprop_1 x = x + x == 2 * x\n\nprop_2 :: Int -&gt; Int -&gt; Bool\nprop_2 x y = x + y == y + x\n\ntests :: TestTree\ntests = testGroup \"Tested by QuickCheck\"\n  [ QC.testProperty \"prop_1\" prop_1\n  , QC.testProperty \"prop_2\" prop_2\n  ]\n\nmain :: IO ()\nmain = defaultMain tests\n</code></pre>\n\n<p>It is possible to use the <code>quickCheckAll</code> function on the above example for avoiding <strong>explicitly</strong> listing all the properties when using QuickCheck and Tasty?</p>\n\n<p>Versions: The above examples were tested using GHC 8.2.2, QuickCheck 2.10.1 and tasty-quickcheck 0.9.1.</p>\n"}, {"tags": ["haskell", "linear-algebra"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 3, "last_activity_date": 1514044678, "last_edit_date": 1514044678, "creation_date": 1514043335, "answer_id": 47953749, "question_id": 47953036, "link": "https://stackoverflow.com/questions/47953036/how-to-create-matrices-with-the-linear-library-in-haskell/47953749#47953749", "title": "How to create matrices with the Linear library in Haskell", "body": "<p>Look at <code>(!*!)</code>'s type</p>\n\n<pre><code>(!*!) :: (Functor m, Foldable t, Additive t, Additive n, Num a)\n      =&gt; m (t a) -&gt; t (n a) -&gt; m (n a)\n</code></pre>\n\n<p>The important constraint here is <code>Additive</code>, so look at its instances</p>\n\n<pre><code>instance Additive []\ninstance Additive Vector -- ordinary, unsized vectors from the vectors package\ninstance Additive V0\ninstance Additive V1\ninstance Additive V2\ninstance Additive V3\ninstance Additive V4 -- Sized vectors from linear up to n = 4\ninstance Dim n =&gt; Additive (V n) -- Vectors of arbitrary dimension where the size is given by a type level number n\n-- plus other instances\n</code></pre>\n\n<p>So you can just use nested lists:</p>\n\n<pre><code>m :: [[Int]]\nm = [ [ 0,1,2,3,4 ],\n      [ 1,2,3,4,0 ],\n      [ 2,3,4,0,1 ],\n      [ 3,4,0,1,2 ],\n      [ 4,0,1,2,3 ] ]\n\nmsq :: [[Int]]\nmsq = m !*! m\n</code></pre>\n\n<p>Or nested <code>Vectors</code></p>\n\n<pre><code>import Data.Vector(Vector)\nimport qualified Data.Vector as V\n\nmv :: Vector (Vector Int)\nmv = V.fromList $ V.fromList &lt;$&gt; m\n\nmvsq :: Vector (Vector Int)\nmvsq = mv !*! mv\n</code></pre>\n\n<p>Or mix and match:</p>\n\n<pre><code>mvl :: Vector [Int]\nmvl = V.fromList m\nmlv :: [Vector Int]\nmlv = V.fromList &lt;$&gt; m\n\nmvlmlv :: Vector (Vector Int)\nmvlmlv = mvl !*! mlv\n</code></pre>\n\n<p>And you can use <code>V</code> to keep track of the sizes:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\nimport Linear.V\n\nmV :: V 5 (V 5 Int) -- GHC.TypeLits.Nat literals\nmV = fromJust $ fromVector $ fromJust &lt;$&gt; fromVector &lt;$&gt; mv\nmVsq :: V 5 (V 5 Int)\nmVsq = mV !*! mV -- does not compile in case of dimension mismatch\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 4575363, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QUCj2.jpg?s=128&g=1", "display_name": "The Hoff", "link": "https://stackoverflow.com/users/4575363/the-hoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 47953749, "answer_count": 1, "score": 2, "last_activity_date": 1514044678, "creation_date": 1514036907, "question_id": 47953036, "link": "https://stackoverflow.com/questions/47953036/how-to-create-matrices-with-the-linear-library-in-haskell", "title": "How to create matrices with the Linear library in Haskell", "body": "<p>The <a href=\"https://hackage.haskell.org/package/matrix-0.3.5.0/docs/Data-Matrix.html\" rel=\"nofollow noreferrer\">documentation</a> for Linear shows how you can create vectors and matrices using the V1,V2,V3,V4 functions to create vectors of dimensions 1,2,3,4. But I would like to work with matrices that have more elements.</p>\n\n<p>The matrix multiplication <a href=\"https://hackage.haskell.org/package/linear-1.20.7/docs/Linear-Matrix.html\" rel=\"nofollow noreferrer\">example</a> shows and example using a function <code>fromList</code>.</p>\n\n<pre><code>V2 (fromList [(1,2)]) (fromList [(2,3)]) !*! fromList [(1,V3 0 0 1), (2, V3 0 0 5)]\n</code></pre>\n\n<p>But I can't seem to find that function in the Linear library. How would I go about creating a matrix of double values with arbitrary dimensions (e.g. 5x6)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514032975, "post_id": 47952554, "comment_id": 82874483, "body": "So, what&#39;s wrong with that code? It works for me."}, {"owner": {"reputation": 29, "user_id": 6414952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82a488c30ab37a6afc14a8a2f56481bc?s=128&d=identicon&r=PG&f=1", "display_name": "woljako", "link": "https://stackoverflow.com/users/6414952/woljako"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514033303, "post_id": 47952554, "comment_id": 82874559, "body": "I get error:   <code>Expecting one more argument to \u2018Integral\u2019     Expected a type, but \u2018Integral\u2019 has kind \u2018* -&gt; GHC.Prim.Constraint\u2019     In the type signature for \u2018roundSqrt\u2019:       roundSqrt :: Integral -&gt; Integral</code>"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514033495, "post_id": 47952554, "comment_id": 82874603, "body": "Ah, it should be <code>Integral t =&gt; t -&gt; t</code>. Or even remove all type annotations."}, {"owner": {"reputation": 29, "user_id": 6414952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82a488c30ab37a6afc14a8a2f56481bc?s=128&d=identicon&r=PG&f=1", "display_name": "woljako", "link": "https://stackoverflow.com/users/6414952/woljako"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514033766, "post_id": 47952554, "comment_id": 82874683, "body": "Thanks, I already know why it did not work"}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 0, "last_activity_date": 1514033559, "creation_date": 1514033559, "answer_id": 47952663, "question_id": 47952554, "link": "https://stackoverflow.com/questions/47952554/how-can-i-get-floor-with-sqrt-in-type-integral/47952663#47952663", "title": "How Can I get floor with sqrt in type Integral", "body": "<p><code>Integral</code> is a typeclass, so it shouldn't be used as a type. You even used it correctly in <code>isPrime</code> type annotation. So, to make it work, you should write</p>\n\n<pre><code>roundSqrt :: Integral t =&gt; t -&gt; t\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6414952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82a488c30ab37a6afc14a8a2f56481bc?s=128&d=identicon&r=PG&f=1", "display_name": "woljako", "link": "https://stackoverflow.com/users/6414952/woljako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47952663, "answer_count": 1, "score": 0, "last_activity_date": 1514033559, "creation_date": 1514032596, "last_edit_date": 1514032840, "question_id": 47952554, "link": "https://stackoverflow.com/questions/47952554/how-can-i-get-floor-with-sqrt-in-type-integral", "title": "How Can I get floor with sqrt in type Integral", "body": "<p>I wrote simple function in Haskell, I would like check if number is prime with small optimazation. I don't have any idea how to write correct roundSqrt</p>\n\n<pre><code>roundSqrt :: Integral -&gt; Integral\nroundSqrt x = floor (sqrt (fromIntegral x))  \n\n\nisPrime :: Integral t =&gt; t -&gt; Bool\nisPrime n = [i | i &lt;- [2..k], n `mod` i == 0] == []\n           where k =  roundSqrt(n)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1514034227, "post_id": 47952434, "comment_id": 82874798, "body": "Please include more context: minimal reproducible example, and what compiler and os you are using (because I&#39;ve never seen this error!)"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1514038321, "post_id": 47952434, "comment_id": 82875653, "body": "Worth pointing out that a <a href=\"https://www.google.co.uk/search?q=haskell+Required+ancestor+%E2%80%98A%E2%80%99+not+found+for+type+%E2%80%98B%E2%80%99\" rel=\"nofollow noreferrer\">search for <code>Haskell &lt;the above error&gt;</code></a> yields the relevant link almost immediately. Lots of Haskell stuff is open source, you can normally find the error message directly in the source then work out what&#39;s gone wrong from that."}, {"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1514042517, "post_id": 47952434, "comment_id": 82876529, "body": "@hnefatl, you are right about the search, but you forget I am a new user and what I saw did not make sense to me. How do I know if the error is my fault, or is is a library bug or ghc bug or something else."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1514043805, "post_id": 47952434, "comment_id": 82876790, "body": "@ruby_object It&#39;s not at all clear from your question what proficiency you have with Haskell, but given the source of the error it was reasonable to assume you were not a beginner."}, {"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1514045163, "post_id": 47952434, "comment_id": 82877131, "body": "I am a beginner. At the moment I am evaluating a feasibility of using Haskell for the project I have in mind. In order to know if it is worth to spend my time learning Haskell I need to evaluate one of the neglected corners of GUI programming where all languages that I have tried struggle."}], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1514331688, "post_id": 47952968, "comment_id": 82938545, "body": "Finally, I have figured it out. Function castTo was the missing link.  More info here: <a href=\"https://stackoverflow.com/questions/47979509/how-do-i-cast-widget-to-label-in-haskells-gi-gtk\" title=\"how do i cast widget to label in haskells gi gtk\">stackoverflow.com/questions/47979509/&hellip;</a>"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 7, "last_activity_date": 1514036275, "creation_date": 1514036275, "answer_id": 47952968, "question_id": 47952434, "link": "https://stackoverflow.com/questions/47952434/what-is-the-meaning-of-haskell-error-required-ancestor-a-not-found-for-type/47952968#47952968", "title": "What is the meaning of Haskell error: Required ancestor \u2018A\u2019 not found for type \u2018B\u2019", "body": "<p>That's not a Haskell error; that's a custom message from the <a href=\"https://hackage.haskell.org/package/haskell-gi-base-0.20.8/docs/Data-GI-Base-Overloading.html\" rel=\"noreferrer\">Data.GI.Base.Overloading</a> module:</p>\n\n<p><a href=\"https://github.com/haskell-gi/haskell-gi/blob/0c66d9ebab48285c22a96fb0221d8d77d78beaba/base/Data/GI/Base/Overloading.hs#L87-L106\" rel=\"noreferrer\">https://github.com/haskell-gi/haskell-gi/blob/0c66d9ebab48285c22a96fb0221d8d77d78beaba/base/Data/GI/Base/Overloading.hs#L87-L106</a></p>\n\n<pre><code>#if MIN_VERSION_base(4,9,0)\n-- | Type error to be generated when an ancestor check fails.\ntype family UnknownAncestorError (a :: *) (t :: *) where\n    UnknownAncestorError a t =\n        TypeError ('Text \"Required ancestor \u2018\" ':&lt;&gt;: 'ShowType a\n                   ':&lt;&gt;: 'Text \"\u2019 not found for type \u2018\"\n                   ':&lt;&gt;: 'ShowType t ':&lt;&gt;: 'Text \"\u2019.\")\n#endif\n\n-- | Check whether a type appears in a list. We specialize the\n-- names/types a bit so the error messages are more informative.\ntype family CheckForAncestorType t (a :: *) (as :: [*]) :: AncestorCheck * * where\n    CheckForAncestorType t a '[] =\n#if !MIN_VERSION_base(4,9,0)\n        'DoesNotHaveRequiredAncestor \"Error: Required ancestor\" a \"not found for type\" t\n#else\n        UnknownAncestorError a t\n#endif\n    CheckForAncestorType t a (a ': as) = 'HasAncestor a t\n    CheckForAncestorType t a (b ': as) = CheckForAncestorType t a as\n</code></pre>\n"}], "owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 47952968, "answer_count": 1, "score": -4, "last_activity_date": 1514036275, "creation_date": 1514031487, "question_id": 47952434, "link": "https://stackoverflow.com/questions/47952434/what-is-the-meaning-of-haskell-error-required-ancestor-a-not-found-for-type", "title": "What is the meaning of Haskell error: Required ancestor \u2018A\u2019 not found for type \u2018B\u2019", "body": "<p>What is the meaning of Haskell error like:</p>\n\n<blockquote>\n  <p>Required ancestor \u2018A\u2019 not found for type \u2018B\u2019.</p>\n</blockquote>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 1, "last_activity_date": 1514040037, "creation_date": 1514040037, "answer_id": 47953369, "question_id": 47951906, "link": "https://stackoverflow.com/questions/47951906/words-from-string-to-list/47953369#47953369", "title": "Words from string to list", "body": "<p>There's quite a few mistakes here, you should spend more time reading over some tutorials (<a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learn you a Haskell</a>, <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow noreferrer\">Real World Haskell</a>). You're pretty close though, so I'll try to do a break-down here.</p>\n\n<p><code>do</code> is special - it doesn't switch Haskell into \"imperative mode\", it lets you write clearer code when using Monads - if you don't yet know what Monads are, stay away from <code>do</code>! Keywords like <code>return</code> also don't behave the same as in imperative languages. Try to approach Haskell with a completely fresh mind.</p>\n\n<p>Also in Haskell, indentation is important - see <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation\" rel=\"nofollow noreferrer\">this link</a> for a good explanation. Essentially, you want all the lines in the same \"block\" to have the same indentation.</p>\n\n<hr>\n\n<p>Okay, let's strip out the <code>do</code> and <code>return</code> keywords, and align the indentation. We'll also name the parameter to the function <code>str</code> - in your original code, you missed this bit out.</p>\n\n<pre><code>toWordList :: String -&gt; [String]\ntoWordList str =\n    [toLower x | x &lt;- str]\n    let var = removePunctuation(x)\n    words var\n</code></pre>\n\n<p>The syntax for <code>let</code> is <code>let __ = __ in __</code>. There's different notation when using <code>do</code>, but forget about that for now. We also don't name the result of the list comprehension, so let's do that:</p>\n\n<pre><code>toWordList str =\n    let lowered = [toLower x | x &lt;- str] in\n    let var = removePunctuation lowered in\n    words var\n</code></pre>\n\n<p>And this works! We just needed to get some syntax right and avoid the monadic syntactic sugar of <code>do</code>/<code>return</code>.</p>\n\n<hr>\n\n<p>It's possible (and easy) to make it nicer though. Those <code>let</code> blocks are kinda ugly, we can strip those away. We can also replace the list comprehension with <code>map toLower</code>, which is a bit more elegant and is equivalent to your comprehension:</p>\n\n<pre><code>toWordList str = words (removePunctuation (map toLower str))\n</code></pre>\n\n<p>Nice, that's down to a single line now! But all those brackets are also a bit of an eyesore, how about we use <a href=\"https://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign\">the <code>$</code> function</a>?</p>\n\n<pre><code>toWordList str = words $ removePunctuation $ map toLower str\n</code></pre>\n\n<p>Looking good. There's another improvement we can make, which is to convert this into <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow noreferrer\">point-free style</a>, where we don't explicitly name our parameter - instead we express this function as the composition of other functions.</p>\n\n<pre><code>toWordList = words . removePunctuation . (map toLower)\n</code></pre>\n\n<hr>\n\n<p>And we're done! Hopefully the first two code snippets make it clearer how the Haskell syntax works, and the last few might show you some nice examples of how you can make fairly verbose code much much cleaner.</p>\n"}], "owner": {"reputation": 183, "user_id": 9131774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xobmcreNojY/AAAAAAAAAAI/AAAAAAAAAek/n7i1CnMa5_o/photo.jpg?sz=128", "display_name": "Mushood Hanif", "link": "https://stackoverflow.com/users/9131774/mushood-hanif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 47953369, "answer_count": 1, "score": -1, "last_activity_date": 1514040377, "creation_date": 1514026715, "last_edit_date": 1514040377, "question_id": 47951906, "link": "https://stackoverflow.com/questions/47951906/words-from-string-to-list", "title": "Words from string to list", "body": "<p>I'm trying to write a Haskell function which would read a string and return a list with the words from the string saved in it.</p>\n\n<p>Here's how I did it:  </p>\n\n<pre><code>toWordList :: String -&gt; [String]\ntoWordList = do\n[ toLower x | x &lt;- str ]\n    let var = removePunctuation(x)\n        return (words var)  \n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>Test1.hs:13:17: error: parse error on input 'let'\n   |\n13 |                 let var = removePunctuation(x)\n   |                 ^^^\n</code></pre>\n\n<p>I'm new to Haskell so I don't have the grasp over its syntax so thanks in advance for the help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1514032675, "post_id": 47951614, "comment_id": 82874423, "body": "<code>mapM (loadTicks ticksArchivePath) sortedEntries</code>"}, {"owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514037845, "post_id": 47951614, "comment_id": 82875540, "body": "I tried something similar but I am getting the following error: &quot;Couldn&#39;t match expected type \u2018Path Abs File\u2019 with actual type \u2018IO (Path Abs File)\u2019In the first argument of \u2018loadTicks\u2019, namely \u2018ticksArchivePath\u2019   In the first argument of \u2018mapM\u2019, namely \u2018(loadTicks ticksArchivePath)\u2019   In the expression: mapM (loadTicks ticksArchivePath) sortedEntries&quot;"}, {"owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514040747, "post_id": 47951614, "comment_id": 82876166, "body": "By adding an fmap (code edited) our suggestion works and I get an array of ByteString"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1514041846, "post_id": 47951614, "comment_id": 82876377, "body": "You should write <code>ticksArchivePath &lt;- resolveFile&#39; ...</code> instead of <code>let ticksArchivePath = resolveFile&#39; ...</code>. Think of <code>&lt;-</code> as an operator that unwraps <code>IO</code>."}, {"owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514042047, "post_id": 47951614, "comment_id": 82876423, "body": "@arrowd I would like to grant you the answer points..."}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 1, "last_activity_date": 1514042909, "creation_date": 1514042909, "answer_id": 47953698, "question_id": 47951614, "link": "https://stackoverflow.com/questions/47951614/extracting-lines-by-iterating-over-a-set-of-files-in-a-pk-zipped-archive-in-hask/47953698#47953698", "title": "Extracting lines by iterating over a set of files in a PK zipped archive in Haskell", "body": "<p>Take as a rule of thumb, that arrow <code>&lt;-</code> \"pulls\" <code>a</code> from some <code>m a</code>, where <code>m</code> is a Monad. In this case, arrows of your do-block pull <code>a</code>s from <code>IO a</code>s.</p>\n\n<p>So, to get rid of fmaps you should write</p>\n\n<pre><code>ticksArchivePath &lt;- resolveFile' \"data/data-small.zip\" :: IO (Path Abs File)\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>let ticksArchivePath = resolveFile' \"data/data-small.zip\" :: IO (Path Abs File) \n</code></pre>\n\n<p>and</p>\n\n<pre><code>entries &lt;- extractEntries ticksArchivePath :: IO [EntrySelector]\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>let entries = extractEntries =&lt;&lt; ticksArchivePath :: IO [EntrySelector]\n</code></pre>\n\n<p>Expressions starting with <code>let</code> in do-blocks are usually used for pure computations. In your case it is</p>\n\n<pre><code>let sortedEntries = sortBy customSort entries\n</code></pre>\n\n<p>StackOverflow documentation had a great section explaining monads and do-syntax, but alas, it is gone now.</p>\n"}], "owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 47953698, "answer_count": 1, "score": 0, "last_activity_date": 1514046977, "creation_date": 1514024082, "last_edit_date": 1514046977, "question_id": 47951614, "link": "https://stackoverflow.com/questions/47951614/extracting-lines-by-iterating-over-a-set-of-files-in-a-pk-zipped-archive-in-hask", "title": "Extracting lines by iterating over a set of files in a PK zipped archive in Haskell", "body": "<p>Being totally new to Haskell I thought that writing a small practical tool would be a good start for learning it. My goal is to implement some kind of a linux \"more\" command for displaying the content of a PK zipped archive file. So far I only managed to list the file names within the archive:</p>\n\n<pre><code>module Main where\n\nimport Codec.Archive.Zip\nimport Path\nimport Path.IO (resolveFile')\nimport Data.List (sortBy)\nimport Data.Ord (comparing)\nimport qualified Data.Map as Map\nimport qualified Data.ByteString.Char8 as Byte (ByteString)\n\nloadTicks :: Path Abs File -&gt; EntrySelector -&gt; IO Byte.ByteString\nloadTicks ticksArchivePath entry = withArchive ticksArchivePath (getEntry entry)\n\nextractEntries :: Path Abs File -&gt; IO [EntrySelector]\nextractEntries ticksArchivePath = withArchive ticksArchivePath loadEntries\n\nloadEntries :: ZipArchive [EntrySelector]\nloadEntries = fmap Map.keys getEntries\n\n-- not really useful since only natural ordering is required\ncustomSort :: Ord a =&gt; a -&gt; a -&gt; Ordering\ncustomSort elem1 elem2 = compare elem1 elem2\n\nmain :: IO ()\nmain = do\n    let ticksArchivePath = resolveFile' \"data/data-small.zip\" :: IO (Path Abs File)  \n    let entries = extractEntries =&lt;&lt; ticksArchivePath :: IO [EntrySelector]  \n    sortedEntries &lt;- fmap (sortBy customSort) entries :: IO [EntrySelector]\n    print sortedEntries\n</code></pre>\n\n<p>I am stuck at this point because I cannot figure out how to call the <code>loadTicks</code> function over each entry in <code>sortedEntries</code>. How can I do that in order to eventually obtain a <code>[String]</code> output that concatenates all lines from each file of the archive (example archive: <a href=\"https://drive.google.com/open?id=1mp1TIPmJd74SGJ4Yy5J-BBsoyBPPPHRh\" rel=\"nofollow noreferrer\">\nhttps://drive.google.com/open?id=1mp1TIPmJd74SGJ4Yy5J-BBsoyBPPPHRh</a>) ?</p>\n\n<p><em>EDIT</em></p>\n\n<p>After @arrowd comments the following code works:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Codec.Archive.Zip\nimport Path\nimport Path.IO (resolveFile')\nimport Data.List (sortBy)\nimport Data.Text (takeEnd)\nimport Data.Ord (comparing)\nimport Prelude hiding (concat)\nimport Data.ByteString.Char8 (concat)\nimport qualified Data.Map as Map\nimport qualified Data.ByteString.Char8 as Byte (ByteString)\n\nloadTicks :: Path Abs File -&gt; EntrySelector -&gt; IO Byte.ByteString\nloadTicks ticksArchivePath entry = withArchive ticksArchivePath (getEntry entry)\n\nextractEntries :: Path Abs File -&gt; IO [EntrySelector]\nextractEntries ticksArchivePath = withArchive ticksArchivePath loadEntries\n\nloadEntries :: ZipArchive [EntrySelector]\nloadEntries = fmap Map.keys getEntries\n\n-- not really useful since only natural ordering is required\ncustomSort :: Ord a =&gt; a -&gt; a -&gt; Ordering\ncustomSort elem1 elem2 = compare elem1 elem2\n\nisCSVFile :: EntrySelector -&gt; Bool\nisCSVFile entry = takeEnd 4 (getEntryName entry) == \".csv\"\n\nmain :: IO ()\nmain = do\n    ticksArchivePath &lt;- resolveFile' \"data/data-small.zip\" :: IO (Path Abs File)\n    entries &lt;- extractEntries ticksArchivePath :: IO [EntrySelector]\n    let sortedEntries = sortBy customSort entries :: [EntrySelector]\n    let ticks = loadTicks ticksArchivePath\n    contents &lt;- mapM ticks sortedEntries :: IO [Byte.ByteString]\n    print (concat contents)\n</code></pre>\n"}, {"tags": ["arrays", "performance", "haskell", "recursion"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1514023405, "post_id": 47951472, "comment_id": 82872470, "body": "The &quot;stack&quot; in Haskell is not a function call stack; that&#39;s why tail recursion isn&#39;t relevant."}, {"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514025042, "post_id": 47951472, "comment_id": 82872784, "body": "what is the right way to run that code?"}, {"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514026907, "post_id": 47951472, "comment_id": 82873230, "body": "this works <code>lucas-MacBook-Pro:src lucapuggini$ stack ghc challenge5.hs  [1 of 1] Compiling Main             ( challenge5.hs, challenge5.o ) Linking challenge5 ... lucas-MacBook-Pro:src lucapuggini$ .&#47;challenge5 5 381680 10 29717847 </code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514062915, "post_id": 47951472, "comment_id": 82881393, "body": "What Haskell implementation are you using, and what version? I didn&#39;t think GHC <i>had</i> stack overflow errors anymore."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514063217, "post_id": 47951472, "comment_id": 82881452, "body": "Also, yes, if you&#39;re writing code like this, it doesn&#39;t really make sense to use immutable arrays. Switch to mutable arrays, or use something with faster pure operations like <code>Data.IntMap.Strict</code>."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1514157916, "last_edit_date": 1514157916, "creation_date": 1514112470, "answer_id": 47959919, "question_id": 47951472, "link": "https://stackoverflow.com/questions/47951472/haskell-optimise-code-and-stack-overflow-in-tail-recursion/47959919#47959919", "title": "haskell optimise code and stack overflow in tail recursion", "body": "<p>If you import <code>Data.Array.Unboxed</code> instead of <code>Data.Array</code>, and declare your array as </p>\n\n<pre><code>    ....\n        a :: UArray Int Int \n        a = listToArray l\n    return a\n</code></pre>\n\n<p>or something, in <code>getData</code>, you'll get significant speedup, bordering on miraculous. </p>\n\n<p>Also, you will have to re-implement <code>lengthArr = rangeSize . bounds</code>, so it works for the unboxed arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 1, "creation_date": 1514288172, "post_id": 47963482, "comment_id": 82924831, "body": "Mutable array seems to be the most reasonable choice. But I thought that mutable structure should be avoided in functional programming"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 1, "creation_date": 1514327641, "post_id": 47963482, "comment_id": 82937770, "body": "Those who subscribe to this view would actually say that mutable structures should be avoided in <i>all</i> programming.  It&#39;s just easier in functional languages.  The argument (which I won&#39;t make here!) is that immutable algorithms lead to cleaner design and fewer bugs, and the potential inefficiencies of copying data to make small changes can usually be optimized away by careful data structure design and clever compilers.  However, some algorithms are still more easily implemented using mutable data structures, so we settle with using them &quot;sparingly&quot;."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514370589, "post_id": 47963482, "comment_id": 82949308, "body": "the problem is with the implementation, whereas for the unboxed immutable array <code>a</code>, <code>a &#47;&#47; [(i,e)]</code> <a href=\"https://wiki.haskell.org/Prime_numbers#Accumulating_Array\" rel=\"nofollow noreferrer\">in tail position</a> should be <i>O(1)</i>, but isn&#39;t."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1514157573, "last_edit_date": 1514157573, "creation_date": 1514143884, "answer_id": 47963482, "question_id": 47951472, "link": "https://stackoverflow.com/questions/47951472/haskell-optimise-code-and-stack-overflow-in-tail-recursion/47963482#47963482", "title": "haskell optimise code and stack overflow in tail recursion", "body": "<p><em>With respect to your first question (why the stack overflow):</em></p>\n\n<p>Using <code>stack runhaskell</code> (or equivalently <code>stack runghc</code>) runs your code in a special \"just in time\" compilation mode, much the same way expressions entered at the GHCi prompt are run.  The code is unoptimized and will frequently exhibit terrible performance characteristics.</p>\n\n<p>For your particular program, this means it runs very slowly, with an ever-expanding memory footprint, and eventually produces a stack overflow.</p>\n\n<p>If you instead compile and run with:</p>\n\n<pre><code>stack ghc -- -O2 challenge5.hs\n./challenge5\n</code></pre>\n\n<p>you'll find that it runs much faster (about a minute on my laptop), in constant memory, and, obviously, without a stack overflow.</p>\n\n<p>As indicated in the comments, a stack overflow error in GHC doesn't really have anything to do with tail recursion.  Instead, it arises from a particular aspect of lazy evaluation.  (See <a href=\"https://stackoverflow.com/questions/43265198/do-stack-overflow-errors-occur-in-haskell\">Do stack overflow errors occur in Haskell?</a>, for example.)</p>\n\n<p>Briefly, GHC creates \"thunks\" representing unevaluated expressions whose value can be demanded at a future point.  Sometimes, these thunks get linked together in a long chain in such a way that when the value of the thunk at one end of the chain is needed, all the thunks down the chain need to be \"partially evaluated\" to the end of the chain to get the last thunk's value before the program can start calculating thunk values all the way back up the chain.  GHC maintains all these \"thunk evaluations in process\" in a stack with finite size, and that can overflow.</p>\n\n<p>A simple example to trigger a stack overflow is:</p>\n\n<pre><code>-- Sum.hs\nmain = print $ sum [1..100000000]\n</code></pre>\n\n<p>If you run this with:</p>\n\n<pre><code>stack runhaskell -- Sum.hs      # using GHC version 8.0.2\n</code></pre>\n\n<p>you'll get:</p>\n\n<pre><code>Sum.hs: stack overflow\n</code></pre>\n\n<p>However, compiling it with <code>ghc -O2</code> is enough to make the problem go away (both for <code>Sum.hs</code> and in your original program).  One of the reasons is likely the application of a \"strictness analysis\" optimization that forces thunks early so these long chains can't form.</p>\n\n<p><em>With respect to your second question (is an immutable array the right approach):</em></p>\n\n<p>As @WillNess points out, using unboxed arrays in place of boxed arrays gives a huge performance improvement:  on my laptop, an unboxed version of your code runs in 8 secs versus 63 secs.</p>\n\n<p>However, with this type of algorithm -- basically, where a large number of small changes are made incrementally to a vector in such a way that the changes to be made depend on the whole history of accumulated previous changes -- you can do much better with a <em>mutable</em> array.  I have a version using <code>Data.Vector.Unboxed.Mutable</code> that runs part 2 in 0.12 secs, and you should be able to achieve similar performance with a mutable unboxed array from <code>Data.Array.Unboxed</code>.</p>\n"}], "owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1514157916, "creation_date": 1514022849, "last_edit_date": 1514112696, "question_id": 47951472, "link": "https://stackoverflow.com/questions/47951472/haskell-optimise-code-and-stack-overflow-in-tail-recursion", "title": "haskell optimise code and stack overflow in tail recursion", "body": "<p>As I am trying to learn functional programming I have decided to do the advent of code challenges in haskell. </p>\n\n<p>While doing challenge 5 <a href=\"https://adventofcode.com/2017/day/5\" rel=\"nofollow noreferrer\">https://adventofcode.com/2017/day/5</a>\nwith input data <a href=\"https://adventofcode.com/2017/day/5/input\" rel=\"nofollow noreferrer\">https://adventofcode.com/2017/day/5/input</a> I have encountered several problem. </p>\n\n<p>This is my code</p>\n\n<pre><code>import Data.Array\nimport System.IO\n\nlistToArray l =\n  let n_elem = length l\n      pos_val = zip (range (0, n_elem)) l\n  in array (0, n_elem-1) pos_val\n\ngetData filename = do\n  s &lt;- readFile filename\n  let l = map read (lines s) ::[Int]\n      a = listToArray l \n  return a\n\n-- Part 1\n\nupdatePosArray i a =\n  let i_val = a ! i\n  in (i+i_val, a//[(i, i_val + 1)])\n\nsolution1 a n_steps i\n | i &gt;= length a || i &lt; 0 = n_steps\n | otherwise =\n    let ai = updatePosArray i a\n    in solution1 (snd ai) (n_steps+1) (fst ai)\n\n-- Part 2\n\nupdatePosArray2 i a =\n  let i_val = a ! i\n  in\n    if i_val&gt;=3 then (i+i_val, a//[(i, i_val-1)])\n    else (i+i_val, a//[(i, i_val+1)])\n\nsolution2 a n_steps i\n | i &gt;= length a || i &lt; 0 = n_steps\n | otherwise =\n    let ai = updatePosArray2 i a\n    in solution2 (snd ai) (n_steps+1) (fst ai)\n\n\nmain = do\n  x &lt;- getData \"/Users/lucapuggini/Documents/AdventOfCode/data/data_ch5_p1.txt\"\n  let x_ex = array (0,4) [(0, 0), (1, 3), (2, 0), (3, 1), (4, -3)]\n\n  let n_steps_ex1 = solution1 x_ex 0 0\n  print $ n_steps_ex1\n\n  let n_steps1 = solution1 x 0 0\n  print $ n_steps1\n\n  let n_steps_ex2 = solution2 x_ex 0 0\n  print $ n_steps_ex2\n\n  -- very slow. Probably due to the immutable array\n  let n_steps2 = solution2 x 0 0\n  print $ n_steps2\n</code></pre>\n\n<p>and this is the result I get :</p>\n\n<pre><code>lucas-MacBook-Pro:src lucapuggini$ stack runhaskell challenge5.hs\n\n    5\n    381680\n    10\n    stack overflow\n</code></pre>\n\n<p>the code is quiet slow but this is probably expected due to the fact that I am using immutable array but I am surprised by the stack overflow error. I thought that this should not happen with tail recursion. </p>\n\n<p>In conclusion I have 2 questions:</p>\n\n<p>1) Why am I getting stackoverflow error? Am I using tail recursion wrongly?</p>\n\n<p>2) What is a more efficient but still functional way to run this code? Are immutable array a bad choice? </p>\n\n<p>I am very new to haskell so please be clear. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1513994825, "post_id": 47949087, "comment_id": 82868239, "body": "It&#39;s always been there. See the <a href=\"https://www.haskell.org/onlinereport/standard-prelude.html\" rel=\"nofollow noreferrer\">Haskell 98 <code>Prelude</code></a>, which does not have that function. The <code>Prelude</code> alternative is <code>fromEnum</code>."}, {"owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513994984, "post_id": 47949087, "comment_id": 82868254, "body": "Thanks @dfeuer - I tried that and it needed type hints - have you tried to make that one work?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "edited": false, "score": 0, "creation_date": 1513995056, "post_id": 47949087, "comment_id": 82868266, "body": "@hawkeye, you can use <code>Just (fromEnum :: Char -&gt; Int) &lt;*&gt; Nothing</code>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 6, "last_activity_date": 1513993527, "creation_date": 1513993527, "answer_id": 47949087, "question_id": 47949048, "link": "https://stackoverflow.com/questions/47949048/why-do-i-get-variable-not-in-scope-for-just-ord-nothing/47949087#47949087", "title": "Why do I get &#39;variable not in scope&#39; for Just ord &lt;*&gt; Nothing?", "body": "<p><a href=\"https://www.haskell.org/hoogle/?hoogle=ord\" rel=\"noreferrer\">A quick search for \"ord\" on Hoogle</a> reveals that <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Char.html#v:ord\" rel=\"noreferrer\">it lives in the <code>Data.Char</code> module</a>. (I have no idea whether it was always there, or whether it only recently got moved there.) So you just need to import <code>Data.Char</code> into your <code>ghci</code> session.</p>\n\n<pre><code>ghci&gt; import Data.Char\nghci&gt; Just ord &lt;*&gt; Nothing\nNothing\n</code></pre>\n"}], "owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 47949087, "answer_count": 1, "score": 2, "last_activity_date": 1513993527, "creation_date": 1513992896, "question_id": 47949048, "link": "https://stackoverflow.com/questions/47949048/why-do-i-get-variable-not-in-scope-for-just-ord-nothing", "title": "Why do I get &#39;variable not in scope&#39; for Just ord &lt;*&gt; Nothing?", "body": "<p>I'm learning Haskell from a popular <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">book</a>.</p>\n\n<p>It includes the <a href=\"http://learnyouahaskell.com/a-fistful-of-monads#getting-our-feet-wet-with-maybe\" rel=\"nofollow noreferrer\">following ghci command</a>:</p>\n\n<pre><code>ghci&gt; Just ord &lt;*&gt; Nothing  \nNothing\n</code></pre>\n\n<p>When I run this in ghci I get:</p>\n\n<pre><code>&lt;interactive&gt;:1:6: error:\n    \u2022 Variable not in scope: ord :: a0 -&gt; b\n    \u2022 Perhaps you meant one of these:\n        \u2018or\u2019 (imported from Prelude), \u2018odd\u2019 (imported from Prelude)\n</code></pre>\n\n<p>I think there is a typo, either due to an author mistake or the version of Haskell changing the syntax. </p>\n\n<p>My question is: <strong>Why do I get <code>variable not in scope</code> for <code>Just ord &lt;*&gt; Nothing</code>?</strong></p>\n"}, {"tags": ["haskell", "state-monad"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 4, "creation_date": 1513991528, "post_id": 47948897, "comment_id": 82867873, "body": "One problem is that type for <code>doIt</code> can&#39;t work. Try <code>Vector a -&gt; (forall s. [STVector s a -&gt; ST s ()]) -&gt; Vector a</code> instead."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1513992099, "post_id": 47948897, "comment_id": 82867939, "body": "<code>traverse ($ v&#39;) ops</code>; which doesn&#39;t typecheck with your type signature, but does with @Carl &#39;s."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1514001155, "post_id": 47948897, "comment_id": 82868974, "body": "@user2407038 Well, you want <code>traverse_</code> instead, given the constraints mentioned in the problem.But yeah, that should do."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1514385976, "post_id": 47948897, "comment_id": 82956303, "body": "@Carl Want to make that an answer?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514405197, "post_id": 47948897, "comment_id": 82964350, "body": "@Davislor I suppose I had nothing else to do while my bus was stuck in traffic anyway..."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1514410117, "post_id": 47998006, "comment_id": 82966096, "body": "Thanks for writing this up! The link to the paper is especially helpful, even if I feel unqualified to read much of it past the abstract"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1514416197, "post_id": 47998006, "comment_id": 82967858, "body": "@AdamSmith I felt the same way the first time I saw the paper. It&#39;s worth a read anyway. SPJ writes very clearly, even if you don&#39;t follow the math. And if you stick with Haskell, it will eventually click. It doesn&#39;t need to make perfect sense now."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 3, "last_activity_date": 1514405118, "creation_date": 1514405118, "answer_id": 47998006, "question_id": 47948897, "link": "https://stackoverflow.com/questions/47948897/sequence-partially-applied-monadic-actions/47998006#47998006", "title": "Sequence partially-applied Monadic Actions", "body": "<p>The operation you're looking for is <code>traverse_</code>. It visits each value in a data structure, applies a function with a monadic return type, and sequences their effects together while discarding their results. The \"discarding their results\" part is important. It means that the return type of <code>traverse_</code> in this case will be <code>ST s ()</code> instead of <code>ST s [()]</code>. The difference there is significant. It means that the operation won't build up a giant list of <code>()</code> values to eventually throw away.</p>\n\n<p>The function you want to pass to <code>traverse_</code> is the one that means \"apply a function to <code>v'</code>\". That could be written as <code>\\f -&gt; f v'</code>, but there's a shorter version that's idiomatic and uses the <code>$</code> operator. Note that you can rewrite the lambda above as <code>\\f -&gt; f $ v'</code>, which can be rewritten as the section <code>($ v')</code>.</p>\n\n<p>So you have <code>traverse_ ($ v') ops</code>, which is the correct operation, but it still won't type check. That's because of the type of <code>runST</code>, which requires that the type <code>s</code> in <code>ST s</code> be polymorphic. With your type signature as written, <code>s</code> is chosen by the caller of <code>doIt</code>. To make this work, you need to enable the RankNTypes extension by making sure <code>{-# LANGUAGE RankNTypes #-}</code> is at the top of the file, and then change the type to <code>Vector a -&gt; (forall s. [STVector s a -&gt; ST s ()]) -&gt; Vector a</code>.  This narrowing of the scope of the <code>s</code> type variable requires that <code>s</code> be polymorphic in the value passed to <code>doIt</code>. With that restriction in place, <code>runST</code> will type check successfully with the operation above.</p>\n\n<p>For more information on why <code>runST</code> has such a funny type, see <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/1994/06/lazy-functional-state-threads.pdf\" rel=\"nofollow noreferrer\">Lazy Functional State Threads</a>, the paper which introduced the ST type and showed how it can be used to constrain mutability inside an externally-pure interface. </p>\n"}], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 47998006, "answer_count": 1, "score": 1, "last_activity_date": 1514405118, "creation_date": 1513990862, "question_id": 47948897, "link": "https://stackoverflow.com/questions/47948897/sequence-partially-applied-monadic-actions", "title": "Sequence partially-applied Monadic Actions", "body": "<p>I'm aware this is probably obvious, but my hoogle-fu is failing me here. I have a list of actions of type:</p>\n\n<pre><code>import Data.Vector.Mutable (STVector)\n[STVector s a -&gt; ST s ()]\n</code></pre>\n\n<p>That is, a set of actions that take a starting MVector and mutate it in some way</p>\n\n<p>I also have a starting vector</p>\n\n<pre><code>import Data.Vector         (Vector, thaw, freeze)\nv :: Vector a\n</code></pre>\n\n<p>After thawing <code>v</code>, how do I sequence these actions into a final result?</p>\n\n<pre><code>doIt :: forall s. Vector a -&gt; [STVector s a -&gt; ST s ()] -&gt; Vector a\ndoIt v ops = runST $ do\n  v' &lt;- thaw v\n  -- do all the things to v'\n  unfreeze v'\n</code></pre>\n\n<hr>\n\n<p>If context helps, I'm attempting Advent of Code's day 16 puzzle (part 2), so <code>ops</code> is a long list of mutations that I actually need to run through literally a billion times. I expected to be able to use <code>replicateM_</code> to do this, but can't see how to provide a starting value. I similarly thought <code>foldM_</code> would work, but I can't seem to get it to typecheck. Perhaps I'm doing something fundamentally wrong? I can't say I understand the ST monad backwards and forwards yet.</p>\n"}, {"tags": ["haskell", "haskell-lens", "template-haskell", "type-families", "lenses"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1513973762, "post_id": 47946585, "comment_id": 82863713, "body": "I guess <code>lens</code> package can&#39;t implement lenses for associated data families. I found similar issue report for <code>microlens</code> library (this library uses the same <code>makeLenses</code> function): <a href=\"https://github.com/aelve/microlens/issues/93\" rel=\"nofollow noreferrer\">github.com/aelve/microlens/issues/93</a>  So probably no luck here. I suggest you to create issue in <code>lens</code> github repository. Or you can create your own <code>-XTemplateHaskell</code> macro for generating lenses specifically for your case..."}], "answers": [{"comments": [{"owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "edited": false, "score": 0, "creation_date": 1513972608, "post_id": 47946686, "comment_id": 82863366, "body": "Unfortunately, it&#39;s not the solution for my case. It is assumed that datatypes may contain much more fields."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "edited": false, "score": 1, "creation_date": 1513976292, "post_id": 47946686, "comment_id": 82864476, "body": "If it&#39;s so many fields that you can&#39;t afford a single line to define a lens for each, then I seriously question that it&#39;s a clever idea to define it as a monolithic data structure. If you just find the repetion ugly \u2013 ok, but that can be addressed with a simple CPP macro."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "edited": false, "score": 0, "creation_date": 1513976302, "post_id": 47946686, "comment_id": 82864481, "body": "@errfrom This works regardless of how many fields your datatypes have. Unless you&#39;re generating these datatypes and <i>need</i> to derive the lenses automatically, this just just a matter of a modicum of tedium."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 1, "creation_date": 1521777871, "post_id": 47946686, "comment_id": 85886143, "body": "I don&#39;t think it&#39;s just tedium that is the issue; this is code duplication that can lead to many bugs, and has all the issues that boilerplate has."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1513972613, "last_edit_date": 1513972613, "creation_date": 1513972321, "answer_id": 47946686, "question_id": 47946585, "link": "https://stackoverflow.com/questions/47946585/lenses-and-typefamilies/47946686#47946686", "title": "Lenses and TypeFamilies", "body": "<p>The most sensible thing would be to just define those lenses yourself... it's not like it's very difficult:</p>\n\n<pre><code>a, b :: Lens' (SomeData MyData a) a\na = lens _a (\\s a' -&gt; s{_a=a'})\nb = lens _b (\\s b' -&gt; s{_b=b'})\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>a, b :: Functor f =&gt; (a -&gt; f a) -&gt; SomeData MyData a -&gt; f (SomeData MyData a)\na f (SomeData a\u2080 b\u2080) = (`SomeData`b\u2080) &lt;$&gt; f a\u2080\nb f (SomeData a\u2080 b\u2080) =   SomeData a\u2080  &lt;$&gt; f b\u2080\n</code></pre>\n\n<p>...which doesn't use anything from the lens library at all, but is fully compatible to all lens combinators.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514069255, "post_id": 47952602, "comment_id": 82882696, "body": "Setters, or lenses? Your remark is a bit confusing. Also, your code needs much more explanation to be a proper answer!"}, {"owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514073465, "post_id": 47952602, "comment_id": 82883406, "body": "@dfeuer It doesn&#39;t play a major role here and can be easily adapted for generating lenses instead of pure setters. But yes, you&#39;re absolutely right - this answer could be improved. I&#39;m going to do that after a while =)"}], "tags": [], "owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1514033093, "creation_date": 1514033093, "answer_id": 47952602, "question_id": 47946585, "link": "https://stackoverflow.com/questions/47946585/lenses-and-typefamilies/47952602#47952602", "title": "Lenses and TypeFamilies", "body": "<p><code>tfMakeLenses</code> generates setters of type <code>t a -&gt; a -&gt; t a</code> for associated datatypes.<br>\nThere are some places this function can be improved, but it works!  </p>\n\n<pre><code>tfMakeLenses :: Name -&gt; DecsQ\ntfMakeLenses t = do\n  fieldNames &lt;- tfFieldNames t\n  let associatedFunNames = associateFunNames fieldNames\n  return (map createLens associatedFunNames)\n  where createLens :: (Name, Name) -&gt; Dec\n        createLens (funName, fieldName) =\n          let dtVar  = mkName \"dt\"\n              valVar = mkName \"newValue\"\n              body   = NormalB (LamE [VarP valVar] (RecUpdE (VarE dtVar) [(fieldName, VarE valVar)]))\n          in FunD funName [(Clause [VarP dtVar] body [])]\n\n        associateFunNames :: [Name] -&gt; [(Name, Name)]\n        associateFunNames [] = []\n        associateFunNames (fieldName:xs) = ((mkName . tail . nameBase) fieldName, (mkName . nameBase) fieldName)\n                                         : associateFunNames xs\n\n        tfFieldNames t = do\n          FamilyI _ ((DataInstD _ _ _ _ ((RecC _ fields):_) _):_) &lt;- reify t\n          let fieldNames = flip map fields $ \\(name, _, _) -&gt; name\n          return fieldNames\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 10670383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/735dee423a3e7cc73b81975f789f7c6d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad B", "link": "https://stackoverflow.com/users/10670383/ahmad-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1612803891, "last_edit_date": 1612803891, "creation_date": 1612595598, "answer_id": 66074458, "question_id": 47946585, "link": "https://stackoverflow.com/questions/47946585/lenses-and-typefamilies/66074458#66074458", "title": "Lenses and TypeFamilies", "body": "<p><em>This answer is an adaptation of errfrom's original answer with a bit more details. The function below also creates lenses, rather than just setters.</em></p>\n<p><code>tfMakeLenses</code> generates lenses of type <code>Lens' s a</code>, or by definition, <code>(a -&gt; f a) -&gt; s -&gt; f s</code> for associated datatypes.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>{-# TemplateHaskell #-}\nimport Control.Lens.TH\nimport Language.Haskell.TH.Syntax\n\ntfMakeLenses typeFamilyName = do\n  fieldNames &lt;- tfFieldNames typeFamilyName\n  let associatedFunNames = associateFunNames fieldNames\n  return $ map createLens associatedFunNames\n\n  where -- Creates a function of the form:\n        -- funName lensFun record = fmap (\\newValue -&gt; record {fieldName=newValue}) (lensFun (fieldName record))\n        createLens :: (Name, Name) -&gt; Dec\n        createLens (funName, fieldName) =\n          let lensFun   = mkName &quot;lensFunction&quot;\n              recordVar = mkName &quot;record&quot;\n              valVar    = mkName &quot;newValue&quot;\n              setterFunction = LamE [VarP valVar] $ RecUpdE (VarE recordVar) [(fieldName, VarE valVar)]\n              getValue       = AppE (VarE fieldName) (VarE recordVar)\n              body           = NormalB (AppE (AppE (VarE 'fmap) setterFunction) (AppE (VarE lensFun) getValue))\n          in FunD funName [(Clause [VarP lensFun, VarP recordVar] body [])]\n\n        -- Maps [Module._field1, Module._field2] to [(field1, _field1), (field2, _field2)]\n        associateFunNames :: [Name] -&gt; [(Name, Name)]\n        associateFunNames = map funNames\n                            where funNames fieldName = ((mkName . tail . nameBase) fieldName, (mkName . nameBase) fieldName)\n\n        -- Retrieves fields of last instance declaration of type family &quot;t&quot;\n        tfFieldNames t = do\n          FamilyI _ ((DataInstD _ _ _ _ ((RecC _ fields):_) _):_) &lt;- reify t\n          let fieldNames = flip map fields $ \\(name, _, _) -&gt; name\n          return fieldNames\n</code></pre>\n<p><strong>Usage:</strong> pass type family name to <code>tfMakeLenses</code>. Lenses will be created for the last type family instance before the call.</p>\n<pre><code>class SomeClass t where\n  data SomeData t :: * -&gt; *\n\ndata MyData = MyData Int\n\ninstance SomeClass MyData where\n  data SomeData MyData a = SomeData {_a :: a, _b :: a\n\ntfMakeLenses ''SomeData\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1612803891, "creation_date": 1513971701, "last_edit_date": 1513972837, "question_id": 47946585, "link": "https://stackoverflow.com/questions/47946585/lenses-and-typefamilies", "title": "Lenses and TypeFamilies", "body": "<p>I've encountered a problem of using <code>Control.Lens</code> together with<br>\ndatatypes while using the <code>-XTypeFamilies</code> GHC pragma.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE TypeFamilies    #-}\n\nimport Control.Lens (makeLenses)\n\nclass SomeClass t where\n  data SomeData t :: * -&gt; *\n\ndata MyData = MyData Int\n\ninstance SomeClass MyData where\n  data SomeData MyData a = SomeData {_a :: a, _b :: a}\n\nmakeLenses ''SomeData\n</code></pre>\n\n<p>The error message is: <code>reifyDatatype: Use a value constructor to reify a data family instance</code>.  </p>\n\n<p>Is there any way to overcome it, maybe using some functional from <code>Control.Lens</code>?  </p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1513974241, "post_id": 47946382, "comment_id": 82863845, "body": "You could use <code>readLn</code> directly instead <code>getLine</code> and <code>read</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513971575, "creation_date": 1513971575, "answer_id": 47946567, "question_id": 47946382, "link": "https://stackoverflow.com/questions/47946382/simple-input-function-haskell/47946567#47946567", "title": "Simple input function Haskell", "body": "<p>The <code>return</code> function has one argument, but you're giving it two - the first one is <code>read</code>, the second one is <code>toParse</code>.</p>\n\n<p>Use parentheses to specify the application order:</p>\n\n<pre><code>return (read toParse :: Custom)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 2, "last_activity_date": 1513972239, "last_edit_date": 1513972239, "creation_date": 1513971641, "answer_id": 47946576, "question_id": 47946382, "link": "https://stackoverflow.com/questions/47946382/simple-input-function-haskell/47946576#47946576", "title": "Simple input function Haskell", "body": "<p>You have two type errors. The second one is easier to understand:</p>\n\n<pre><code>getFormula::IO Custom\n</code></pre>\n\n<p><code>getFormula</code> is declared to have type <code>IO Custom</code>.</p>\n\n<pre><code>    return read toParse::Custom\n</code></pre>\n\n<p>... but here you claim the last expression has type <code>Custom</code>. <code>IO Custom</code> is not the same as <code>Custom</code>, so the compiler complains.</p>\n\n<hr>\n\n<p>By the way, your spacing is a bit weird. Why do you have <code>::</code> jammed right against identifiers on the left and right?</p>\n\n<pre><code>    return read toParse :: Custom\n</code></pre>\n\n<p>looks less crowded and also less misleading: The <code>:: Custom</code> part applies to the whole expression on the left, not just a single variable.</p>\n\n<hr>\n\n<p>The first error is a bit confused, but it contains a vital hint: <code>The function \u2018return\u2019 is applied to two arguments</code>.</p>\n\n<p><code>return</code> only takes one argument:</p>\n\n<pre><code>return read toParse\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>return (read toParse)\n</code></pre>\n\n<p>In order to also fix the type annotation, you can use one of the following:</p>\n\n<ul>\n<li><p>A bit clunky:</p>\n\n<pre><code>return (read toParse) :: IO Custom\n</code></pre></li>\n<li><p>Slightly neater (no need to specify <code>IO</code>):</p>\n\n<pre><code>return (read toParse :: Custom)\n</code></pre></li>\n<li><p>Easiest solution:</p>\n\n<pre><code>return (read toParse)\n</code></pre>\n\n<p>You don't need to explicitly specify a type here at all. The compiler already knows you're looking for a <code>Custom</code> because of the <code>getFormula :: IO Custom</code> declaration.</p></li>\n</ul>\n"}], "owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 47946576, "answer_count": 2, "score": 1, "last_activity_date": 1513972239, "creation_date": 1513970471, "last_edit_date": 1513971137, "question_id": 47946382, "link": "https://stackoverflow.com/questions/47946382/simple-input-function-haskell", "title": "Simple input function Haskell", "body": "<p>I want to write a simple function that reads a string from console and parses it to a custom data type.</p>\n\n<p>My attempt:</p>\n\n<pre><code>data Custom = A | B Int | C String deriving Read\n\ngetFormula::IO Custom\ngetFormula = do \n    putStrLn(\"Introduce una formula: \")\n    toParse &lt;- getLine\n    return read toParse::Custom\n</code></pre>\n\n<p>But this does not work and I do not know how to interpret the resulting compiling error. How do I fix this? What am I misunderstanding about how IO functions work?</p>\n\n<hr>\n\n<p>EDIT: This is the error I get when I try to load the file into GCHI</p>\n\n<pre><code>test.hs:7:5:\nCouldn't match type \u2018String -&gt; a0\u2019 with \u2018Custom\u2019\nExpected type: String -&gt; Custom\n  Actual type: String -&gt; String -&gt; a0\nThe function \u2018return\u2019 is applied to two arguments,\nbut its type \u2018(String -&gt; a0) -&gt; String -&gt; String -&gt; a0\u2019\nhas only three\nIn a stmt of a 'do' block: return read toParse :: Custom\nIn the expression:\n  do { putStrLn (\"Introduce una formula: \");\n       toParse &lt;- getLine;\n         return read toParse :: Custom }\n\ntest.hs:7:5:\nCouldn't match expected type \u2018IO Custom\u2019 with actual type \u2018Custom\u2019\nIn a stmt of a 'do' block: return read toParse :: Custom\nIn the expression:\n  do { putStrLn (\"Introduce una formula: \");\n       toParse &lt;- getLine;\n         return read toParse :: Custom }\nIn an equation for \u2018getFormula\u2019:\n    getFormula\n      = do { putStrLn (\"Introduce una formula: \");\n             toParse &lt;- getLine;\n               return read toParse :: Custom }\n</code></pre>\n"}, {"tags": ["haskell", "math", "category-theory", "bifunctor", "distributive"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513968915, "post_id": 47945109, "comment_id": 82862017, "body": "I suspect you&#39;ll find <code>Control.Lens.Prism</code> interesting. The <code>_Right</code> prism represents a function <code>Either a b -&gt; Maybe b</code> along with a function you don&#39;t really need, <code>b -&gt; Either a b</code>. Once you have <code>Either a (c,d)</code>, you can use the <code>_Right . _1</code> <code>Traversal</code> to work with <code>c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "edited": false, "score": 0, "creation_date": 1513964071, "post_id": 47945285, "comment_id": 82860289, "body": "Is this a limitation of the category <code>Hask</code>, or of categories in general?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "edited": false, "score": 6, "creation_date": 1513964154, "post_id": 47945285, "comment_id": 82860321, "body": "@KeithPinson it&#39;s a limitation of any category with an initial object."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "edited": false, "score": 0, "creation_date": 1513964396, "post_id": 47945285, "comment_id": 82860409, "body": "Sure, it&#39;s <code>Bifunctor (Biconst c)</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1513969159, "post_id": 47945285, "comment_id": 82862128, "body": "Your <code>Biconst</code> needs three arguments."}, {"owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "edited": false, "score": 0, "creation_date": 1513974998, "post_id": 47945285, "comment_id": 82864076, "body": "So basically I have identified something that has the structure of the distributive laws, but only monomorphically to &quot;and/pair&quot; and &quot;or/either&quot;, not categorically?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1513975963, "post_id": 47945285, "comment_id": 82864374, "body": "That&#39;s one way to put it. Though that doesn&#39;t mean it&#39;s \u201cnot categorical\u201d. It&#39;s still pretty generic, just specific to the coproduct bifunctor."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1513971118, "last_edit_date": 1513971118, "creation_date": 1513964022, "answer_id": 47945285, "question_id": 47945109, "link": "https://stackoverflow.com/questions/47945109/is-there-such-thing-as-a-bidistributive-what-function-do-i-need-here/47945285#47945285", "title": "Is there such thing as a bidistributive? What function do I need here?", "body": "<p><code>bidistribute</code> can't be implemented as such. Consider the trivial example</p>\n\n<pre><code>data Biconst c a b = Biconst c\n\ninstance Bifunctor (Biconst c) where\n  bimap _ _ (Biconst c) = Biconst c\n</code></pre>\n\n<p>Then we'd have the specialisation</p>\n\n<pre><code>bidistribute :: Biconst () (Void, ()) (Void, ()) -&gt; (Void, Biconst () () ())\nbidistribute (Biconst ()) = ( ????, Biconst () )\n</code></pre>\n\n<p>There's clearly no way to fill in the gap, which would need to have type <code>Void</code>.</p>\n\n<p>Actually, I think you really need <code>Either</code> there (or something isomorphic to it) rather than an arbitrary bifunctor. Then your function is just</p>\n\n<pre><code>uncozipL :: Functor f =&gt; Either (f a) (f b) -&gt; f (Either a b)\nuncozipL (Left l) = Left &lt;$&gt; l\nuncozipL (Right r) = Right &lt;$&gt; l\n</code></pre>\n\n<p>It's defined <a href=\"http://hackage.haskell.org/package/adjunctions-4.3/docs/Data-Functor-Adjunction.html#v:uncozipL\" rel=\"noreferrer\">in <code>adjunctions</code></a> (found <a href=\"https://www.stackage.org/lts-10.0/hoogle?q=Either+%28f+b%29+%28f+c%29+-%3E+f+%28Either+b+c%29\" rel=\"noreferrer\">using Hoogle</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "is_accepted": false, "score": 3, "last_activity_date": 1514414946, "last_edit_date": 1514414946, "creation_date": 1513989930, "answer_id": 47948833, "question_id": 47945109, "link": "https://stackoverflow.com/questions/47945109/is-there-such-thing-as-a-bidistributive-what-function-do-i-need-here/47948833#47948833", "title": "Is there such thing as a bidistributive? What function do I need here?", "body": "<p>Based on @leftaroundabout's tip-off to look at adjunctions, in addition to <code>uncozipL</code> that he mentions in <a href=\"https://stackoverflow.com/a/47945285/834176\">his answer</a>, if we defer the \"default the first value of the pair in the left case of either\", we can also solve this with <code>unzipR</code>:</p>\n\n<pre><code>unzipR :: Functor u =&gt; u (a, b) -&gt; (u a, u b)\n</code></pre>\n\n<p>Then it would still be necessary to map over the first element in the pair and pull out the value with something like <code>either (const \"default\") id</code>. The interesting thing about this is that it if you use <code>uncozipL</code>, you need to know that one of the things is a pair. If you use <code>unzipR</code>, you need to know that one is an either. In neither case do you use an abstract bifunctor.</p>\n\n<p>Further, it seems that the pattern or abstraction that I'm looking for is a <a href=\"https://en.wikipedia.org/wiki/Distributive_lattice\" rel=\"nofollow noreferrer\">distributive lattice</a>. Wikipedia says:</p>\n\n<blockquote>\n  <p>A lattice (L,\u2228,\u2227) is distributive if the following additional identity holds for all x, y, and z in L:</p>\n\n<pre><code>x \u2227 (y \u2228 z) = (x \u2227 y) \u2228 (x \u2227 z).\n</code></pre>\n</blockquote>\n\n<p>which is exactly the property I have observed occuring in many different places.</p>\n"}], "owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 2, "accepted_answer_id": 47945285, "answer_count": 2, "score": 7, "last_activity_date": 1514414946, "creation_date": 1513962942, "question_id": 47945109, "link": "https://stackoverflow.com/questions/47945109/is-there-such-thing-as-a-bidistributive-what-function-do-i-need-here", "title": "Is there such thing as a bidistributive? What function do I need here?", "body": "<p>I have code (in C# actually, but this question has nothing to do with C# specifically, so I will speak of all my types in Haskell-speak) where I am working inside of an <code>Either a b</code>. I then <code>bind</code> a function with a signature that in Haskell-speak is <code>b -&gt; (c, d)</code>, after which I want to pull <code>c</code> to the outside and default it in the left case, i.e. I want <code>(c, Either a d)</code>. Now this pattern occurred many times one particular service I was writing so I pulled out a method to do it. However it bothers me whenever I just \"make up\" a method like this without understanding the correct theoretical underpinnings. In other words, what abstraction are we dealing with here?</p>\n\n<p>I had a similar situation in some F# code where my pair and my either were reversed: <code>(a, b) -&gt; (b -&gt; Either c d) -&gt; Either c (a, d)</code>. I asked a friend what this was and he turned me on to <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Traversable.html#v:traverse\" rel=\"noreferrer\">traverse</a> which made me very happy even though I have to make horrifically monomorphic implementations in F# due to the lack of typeclasses. (I wish I could remap my <kbd>F1</kbd> in Visual Studio to Hackage; it is one of my primary resources for writing .NET code). The problem though is that traverse is:</p>\n\n<pre><code>class (Functor t, Foldable t) =&gt; Traversable t where\n    traverse :: Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p>Which means it works great when you start with a pair and want to \"bind\" an either to it, but <strong>does not work</strong> when you start with an either and want to end up with a pair, because pair is not an <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Applicative.html\" rel=\"noreferrer\">Applicative</a>.</p>\n\n<p>However I thought about my first case more, the one that is not <code>traverse</code>, and realize that \"defaulting <code>c</code> in the left case\" can just be done with mapping over the left case, which changes the problem to having this shape: <code>Either (c, a) (c, d) -&gt; (c, Either a d)</code> which I recognize as the pattern that we see in arithmetic with multiplication and addition: <code>a(b + c) = ab + ac</code>. I also remembered that the same pattern exists in Boolean algebra and in set theory (if memory serves, <code>A intersect (B union C) = (A intersect B) union (A intersect C)</code>). Clearly there is some abstract algebraic structure here. However, memory does not serve, and I could not remember what it was called. A little poking around on Wikipedia quickly solved this: these are the <a href=\"https://en.wikipedia.org/wiki/Heyting_algebra#Distributivity\" rel=\"noreferrer\">distributive</a> laws. And joy, oh joy, Kmett has given us <a href=\"https://hackage.haskell.org/package/distributive-0.5.3/docs/Data-Distributive.html#v:distribute\" rel=\"noreferrer\">distribute</a>:</p>\n\n<pre><code>class Functor g =&gt; Distributive g where\n    distribute :: Functor f =&gt; f (g a) -&gt; g (f a)\n</code></pre>\n\n<p>It even has a <code>cotraverse</code> because it is dual to <code>Travsersable</code>! Lovely!! However, I noticed that there is no <code>(,)</code> instance. Uh oh. Because, yeah, where does the \"default <code>c</code> value\" come into all this? Then I realized, uh oh, I perhaps I need something like a bidistributive based on a <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bifunctor.html#t:Bifunctor\" rel=\"noreferrer\">bifunctor</a>? perhaps dual to <a href=\"https://hackage.haskell.org/package/bifunctors-5.5/docs/Data-Bitraversable.html\" rel=\"noreferrer\">bitraversable</a>? Conceptually:</p>\n\n<pre><code>class Bifunctor g =&gt; Bidistributive g where\n    bidistribute :: Bifunctor f =&gt; f (g a b) (g a c) -&gt; g a (f b c)\n</code></pre>\n\n<p>This seems to be the structure of the distributive law I am talking about. I can't find such a thing in Haskell which doesn't matter to me in and of itself since I am actually writing C#. However, <strong>the thing that is important to me is to not be coming up with bogus abstractions, and yet to recognize as many lawful abstractions in my code as possible, whether they are expressed as such or not, for my own understanding</strong>.</p>\n\n<p>I currently have a <code>.InsideOut(&lt;default&gt;)</code> function (extension method) in my C# code (what a hack, right!). Would I be totally off-base to create a (yes, sadly monomorphic) <code>.Bidistribute(...)</code> function (extension method) to replace it and map the \"default\" for the left case into the left case before invoking it (or just recognize the \"bidistributive\" character of \"inside out\")?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1513956722, "post_id": 47943732, "comment_id": 82857295, "body": "There&#39;s also the <code>notElem</code> function."}], "tags": [], "owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "is_accepted": true, "score": 6, "last_activity_date": 1513956937, "last_edit_date": 1513956937, "creation_date": 1513955902, "answer_id": 47943732, "question_id": 47943575, "link": "https://stackoverflow.com/questions/47943575/how-to-remove-common-elements-between-two-lists-of-strings-in-haskell/47943732#47943732", "title": "How to remove common elements between two lists of strings in Haskell?", "body": "<p>I think that is what you want</p>\n\n<pre><code>let removeCommonWords  xs ys = filter (\\x -&gt; not (x `elem` ys)) xs\n</code></pre>\n\n<p><strong>Edit</strong>:\nYou can also use <code>notElem</code> directly as:</p>\n\n<pre><code>let removeCommonWords  xs ys = filter (\\x -&gt; x `notElem` ys) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 1445227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BS2xD.jpg?s=128&g=1", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/1445227/josh-taylor"}, "is_accepted": false, "score": 2, "last_activity_date": 1513956135, "creation_date": 1513956135, "answer_id": 47943765, "question_id": 47943575, "link": "https://stackoverflow.com/questions/47943575/how-to-remove-common-elements-between-two-lists-of-strings-in-haskell/47943765#47943765", "title": "How to remove common elements between two lists of strings in Haskell?", "body": "<p>Within Data.List there are three functions that do what you're trying to achieve with filters.</p>\n\n<p><code>intersect :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]</code> does exactly what <code>removeCommonWords</code> does in your code. <code>intersect list_1 list_2</code> will produce <code>[\"apple\",\"apple\"]</code>.</p>\n\n<p><code>nub :: Eq a =&gt; [a] -&gt; [a]</code> combined with <code>(\\\\) :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]</code> will give you the opposite. <code>nub list_1 \\\\ nub list_2</code> will produce <code>[\"orange\"]</code>.</p>\n\n<p>Look up these functions on <a href=\"https://www.haskell.org/hoogle/?hoogle=%5C%5C\" rel=\"nofollow noreferrer\">Hoogle</a> for more details :)</p>\n"}], "owner": {"reputation": 968, "user_id": 6774746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/70d280e468a87e6efb7f21c92ff52bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Big Smile", "link": "https://stackoverflow.com/users/6774746/big-smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2312, "favorite_count": 0, "accepted_answer_id": 47943732, "answer_count": 2, "score": 4, "last_activity_date": 1513956937, "creation_date": 1513955145, "last_edit_date": 1513955618, "question_id": 47943575, "link": "https://stackoverflow.com/questions/47943575/how-to-remove-common-elements-between-two-lists-of-strings-in-haskell", "title": "How to remove common elements between two lists of strings in Haskell?", "body": "<p>I am a beginner to Haskell. I want to compare two lists of strings and remove the common elements between the lists and return a new list with unique elements.  </p>\n\n<p>Below is the code that I have:</p>\n\n<pre><code>Prelude Data.List&gt; let list_1 = [\"apple\", \"orange\", \"apple\"]\nPrelude Data.List&gt; let list_2 = [\"apple\"]\nPrelude Data.List&gt; let removeCommonWords  xs ys = filter (\\x -&gt; x `elem` ys) xs\nPrelude Data.List&gt; removeCommonWords list_1 list_2\n</code></pre>\n\n<p>output of the above code:</p>\n\n<pre><code>[\"apple\",\"apple\"]\n</code></pre>\n\n<p>Currently, the <code>filter</code> function is filtering the common words and returning a new list that contains the common words. However, I want it to return a new list that contains the unique words. I think I will need a new regex expression for the filter function. </p>\n\n<p>Expected output:</p>\n\n<pre><code>[\"orange\"]\n</code></pre>\n\n<p>I also attempted the following:</p>\n\n<pre><code>Prelude Data.List&gt; let removeCommonWords  xs ys = filter (\\x -&gt; x `elem` ys) xs\nPrelude Data.List&gt; remove [\"orange\", \"apple\", \"apple\"] \"apple\" \n</code></pre>\n\n<p>The output of the above code is:</p>\n\n<pre><code>[\"orange\"]\n</code></pre>\n\n<p>However, I want to compare two lists of strings - not a list and string.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "edited": false, "score": 3, "creation_date": 1513924836, "post_id": 47936688, "comment_id": 82843105, "body": "or you can write it as one line: <code>product [] = 1; product (x:xs) = x * product xs</code>"}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 8, "last_activity_date": 1513923306, "creation_date": 1513923306, "answer_id": 47936688, "question_id": 47936615, "link": "https://stackoverflow.com/questions/47936615/haskell-non-exhaustive-patterns-missing/47936688#47936688", "title": "haskell non-exhaustive patterns missing", "body": "<p>GHCi processes each line separately, so you have defined a function</p>\n\n<pre><code>product [] = 1\n</code></pre>\n\n<p>and then shadowed <code>product</code> by defining a new function</p>\n\n<pre><code>product (x:xs) = x * product xs\n</code></pre>\n\n<p>To fix this, you can use <code>:{</code> and <code>:}</code> for a multiline block:</p>\n\n<pre><code>:{\nproduct [] = 1\nproduct (x:xs) = x * product xs\n:}\n</code></pre>\n\n<p>or, and this is what I would recommend, put your function definitions in a file and load them in GHCi.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1513961615, "creation_date": 1513961615, "answer_id": 47944869, "question_id": 47936615, "link": "https://stackoverflow.com/questions/47936615/haskell-non-exhaustive-patterns-missing/47944869#47944869", "title": "haskell non-exhaustive patterns missing", "body": "<p>I strongly recommend to turn on warnings with <code>-Wall</code>. Doing so, here, would also hint at the fact that each definition is considered separately.</p>\n\n<pre><code>&gt; :set -Wall\n&gt; product [] = 1\n\n&lt;interactive&gt;:2:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018product\u2019: Patterns not matched: (_:_)\n&gt; product (x:xs) = x * product xs\n\n&lt;interactive&gt;:3:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018product\u2019: Patterns not matched: []\n</code></pre>\n\n<p>Indeed, note how the last warning complaints about <code>[]</code> not being matched, showing that the first definition <code>product []</code> was ignored.</p>\n"}], "owner": {"reputation": 889, "user_id": 1163153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cda8bb97c45f51587474460f34d90b8a?s=128&d=identicon&r=PG", "display_name": "Curious", "link": "https://stackoverflow.com/users/1163153/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 47936688, "answer_count": 2, "score": 3, "last_activity_date": 1513961615, "creation_date": 1513922878, "last_edit_date": 1513961114, "question_id": 47936615, "link": "https://stackoverflow.com/questions/47936615/haskell-non-exhaustive-patterns-missing", "title": "haskell non-exhaustive patterns missing", "body": "<p>I'm getting following error for the below, I assume all the recursive cases, What is missing ?</p>\n\n<pre><code>Prelude&gt; product [] =1\nPrelude&gt; product (x:xs) =x * product xs\nPrelude&gt; product [1,2,3]\n*** Exception: &lt;interactive&gt;:48:1-30: Non-exhaustive patterns in function product\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 3, "creation_date": 1513919919, "post_id": 47936164, "comment_id": 82841717, "body": "The fix is to put <code>-1</code> in brackets, e.g. <code>abs (-1)</code>, this is due to haskell&#39;s parsing, someone else can explain better than I can the other questions."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 1, "creation_date": 1513961567, "post_id": 47936164, "comment_id": 82859366, "body": "<code>abs -1</code> to Haskell looks like <code>abs - 1</code>, as if <code>abs</code> were a number, this is the quirk of Haskell&#39;s parsing @Zpalmtree was talking about."}], "answers": [{"tags": [], "owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "is_accepted": true, "score": 5, "last_activity_date": 1513921797, "creation_date": 1513921797, "answer_id": 47936457, "question_id": 47936164, "link": "https://stackoverflow.com/questions/47936164/ord-in-implicit-definition-error-with-guards/47936457#47936457", "title": "Ord in implicit definition, error with guards", "body": "<p>When you write <code>abs -1</code> or <code>x -1</code> Haskell parse <code>-</code> as binary operator. So it complains that <code>abs</code> (which is a function) is not a number.  As  Zpalmtree said, you need to write <code>abs (-1)</code>.</p>\n"}], "owner": {"reputation": 889, "user_id": 1163153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cda8bb97c45f51587474460f34d90b8a?s=128&d=identicon&r=PG", "display_name": "Curious", "link": "https://stackoverflow.com/users/1163153/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 47936457, "answer_count": 1, "score": 0, "last_activity_date": 1513961526, "creation_date": 1513919720, "last_edit_date": 1513961526, "question_id": 47936164, "link": "https://stackoverflow.com/questions/47936164/ord-in-implicit-definition-error-with-guards", "title": "Ord in implicit definition, error with guards", "body": "<p>I'm getting following error</p>\n\n<pre><code>Prelude&gt; abs n | n&gt;=0 = n+100 | otherwise =n\nPrelude&gt; abs 10\n110\nPrelude&gt; abs -1\n\n&lt;interactive&gt;:44:1: error:\n    * Non type-variable argument in the constraint: Num (t -&gt; t)\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        it :: forall t. (Ord t, Num (t -&gt; t), Num t) =&gt; t -&gt; t\n</code></pre>\n\n<ol>\n<li>Why there is <code>Ord</code> in implicit type definition?</li>\n<li>What the error is saying?</li>\n<li>what is wrong in the definition?</li>\n</ol>\n"}, {"tags": ["haskell", "docker", "haskell-stack"], "comments": [{"owner": {"reputation": 33032, "user_id": 6603816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ecdaa8afcbc3d826ef9beac53b2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "yamenk", "link": "https://stackoverflow.com/users/6603816/yamenk"}, "edited": false, "score": 0, "creation_date": 1513930674, "post_id": 47935925, "comment_id": 82845101, "body": "<code>v1.6.1</code> exists whereas <code>v1.6.1.1</code> doesn&#39;t exist. There might be a typo, bug ..."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 33032, "user_id": 6603816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ecdaa8afcbc3d826ef9beac53b2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "yamenk", "link": "https://stackoverflow.com/users/6603816/yamenk"}, "edited": false, "score": 0, "creation_date": 1513936069, "post_id": 47935925, "comment_id": 82847602, "body": "You&#39;ve got a sharp eye! This is no typo. There is no <code>...src&#47;Stack&#47;Setup.hs</code> on my system. Line <code>1768</code> is also way too much. Is this really happening on my box?"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 33032, "user_id": 6603816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ecdaa8afcbc3d826ef9beac53b2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "yamenk", "link": "https://stackoverflow.com/users/6603816/yamenk"}, "edited": false, "score": 0, "creation_date": 1514016289, "post_id": 47935925, "comment_id": 82871146, "body": "I killed the docker daemon, and commented out docker support from <code>stack.yaml</code> of my project. It works now; curiously, still on container&#39;s versions of <code>ghci</code> and <code>ghc</code>. I can move on, but docker is there for a reason..."}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1514043895, "post_id": 47953528, "comment_id": 82876814, "body": "You are right, probably. I just solved it minutes ago simply by <code>$ stack upgrade</code>. Got indeed <code>stack-1.6.3</code>. Thanks!"}], "tags": [], "owner": {"reputation": 111, "user_id": 2007549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938a3a24d781090702afa69346e264?s=128&d=identicon&r=PG", "display_name": "Emanuel Borsboom", "link": "https://stackoverflow.com/users/2007549/emanuel-borsboom"}, "is_accepted": true, "score": 1, "last_activity_date": 1514041362, "creation_date": 1514041362, "answer_id": 47953528, "question_id": 47935925, "link": "https://stackoverflow.com/questions/47935925/haskell-docker-stack-download-failure/47953528#47953528", "title": "Haskell, docker: stack download failure", "body": "<p>You probably built <code>stack</code> from Hackage, where I uploaded 1.6.1.1 release that just makes it buildable with some newer dependencies.  This isn't a \"real\" new version of Stack (it has no user facing changes) so I didn't build new binaries for it or make a Github release, which means it couldn't find a docker-compatible binary that matched your version.  In the past, Stack would leave off the patchlevel when looking for such a binary, but looks like that functionality was lost at some point.  I actually noticed that myself a couple of days ago and fixed it in <a href=\"https://github.com/commercialhaskell/stack/commit/b33840102becbff9093865ef21368c9c5f66a309\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/commit/b33840102becbff9093865ef21368c9c5f66a309</a>, which is included in the just-released stack-1.6.3.</p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 47953528, "answer_count": 1, "score": 1, "last_activity_date": 1514041362, "creation_date": 1513917618, "last_edit_date": 1513975070, "question_id": 47935925, "link": "https://stackoverflow.com/questions/47935925/haskell-docker-stack-download-failure", "title": "Haskell, docker: stack download failure", "body": "<p>I've got a working docker image of haskell: <a href=\"https://hub.docker.com/r/fpco/stack-build/\" rel=\"nofollow noreferrer\">https://hub.docker.com/r/fpco/stack-build/</a> . Untill today, that is. Any stack command in the project directory responds with this:</p>\n\n<pre><code>$ stack build\nDownloading Docker-compatible stack executable\nControl.Exception.Safe.throwString called with:\n\nCould not get release information for Stack from: https://api.github.com/repos/commercialhaskell/stack/releases/tags/v1.6.1.1\nCalled from:\n  throwString (src/Stack/Setup.hs:1768:14 in stack-1.6.1.1-LhZa5A6LsiS9SkA3QDJMKN:Stack.Setup\n</code></pre>\n\n<p>Google is not being very helpful. Any ideas? The fault is totally 'unprovoked': last yesterday's build was uneventful.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "is_accepted": false, "score": 0, "last_activity_date": 1514331464, "creation_date": 1514331464, "answer_id": 47984791, "question_id": 47934802, "link": "https://stackoverflow.com/questions/47934802/how-do-i-print-the-label-text-in-haskell-gi-gtk-listboxrow/47984791#47984791", "title": "How do I print the label text in Haskell GI-Gtk listBoxRow?", "body": "<p>Dan Robertson has provided the most helpful answer. After obtaining the label object you have to cast it to Label type. That was the missing link.</p>\n\n<h2>working code</h2>\n\n<pre><code>  _ &lt;- onListBoxRowSelected listbox2 (\\(Just r) -&gt; do\n                                         cc &lt;- containerGetChildren r\n                                         mlabel &lt;- castTo Label (head cc)\n                                         case mlabel of\n                                           Nothing -&gt; putStrLn \"Not a label!\"\n                                           Just label -&gt; (labelGetText label) &gt;&gt;= putStrLn . unpack)\n</code></pre>\n\n<p>Thank you very much for your help.</p>\n\n<p>related post\n<a href=\"https://stackoverflow.com/questions/47979509/how-do-i-cast-widget-to-label-in-haskells-gi-gtk\">How do I cast Widget to Label in Haskell&#39;s GI-Gtk?</a></p>\n"}], "owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514331464, "creation_date": 1513905711, "last_edit_date": 1513953514, "question_id": 47934802, "link": "https://stackoverflow.com/questions/47934802/how-do-i-print-the-label-text-in-haskell-gi-gtk-listboxrow", "title": "How do I print the label text in Haskell GI-Gtk listBoxRow?", "body": "<p>I am trying to print the label text when I click on a listBoxRow.</p>\n\n<p>This is the link to my gist: <a href=\"https://gist.github.com/bigos/6cf02ff27231cfc0352394da00023f67\" rel=\"nofollow noreferrer\">https://gist.github.com/bigos/6cf02ff27231cfc0352394da00023f67</a></p>\n\n<p>the relevant code looks like this:</p>\n\n<pre><code>  _ &lt;- onListBoxRowSelected listbox2 (\\(Just r) -&gt; do\n                                        -- rn &lt;- listBoxRowGetIndex r\n                                        cc &lt;- containerGetChildren r\n                                        dd &lt;- widgetGetName (head cc)\n                                        -- how do I print label text?\n                                        -- I get the error:\n                                        -- Required ancestor \u2018GI.Gtk.Objects.Label.Label\u2019 not found for type GI.Gtk.Objects.Widget.Widget\u2019.\n                                        ee &lt;- labelGetText (head cc)\n                                        putStrLn (\"Clicked \" ++ (show ee)))\n</code></pre>\n\n<h2>The error</h2>\n\n<blockquote>\n  <p>\u2022 Required ancestor \u2018GI.Gtk.Objects.Label.Label\u2019 not found for type\n  \u2018GI.Gtk.Objects.Widget.Widget\u2019. \u2022 In a stmt of a 'do' block: ee &lt;-\n  labelGetText (head cc)   In the expression:\n      do { cc &lt;- containerGetChildren r;\n           ee &lt;- labelGetText (head cc);\n           putStrLn (\"Clicked \" ++ (show ee)) }   In the second argument of \u2018onListBoxRowSelected\u2019, namely</p>\n</blockquote>\n\n<h2>relevant documentation</h2>\n\n<p><a href=\"https://hackage.haskell.org/package/gi-gtk-3.0.18/docs/doc-index.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/gi-gtk-3.0.18/docs/doc-index.html</a></p>\n"}, {"tags": ["algorithm", "haskell", "graph", "functional-programming", "depth-first-search"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513898033, "post_id": 47933960, "comment_id": 82837190, "body": "This will not work, since this is a non-linear pattern matching."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1513898167, "post_id": 47933960, "comment_id": 82837237, "body": "Depth-first usually does not per se gets the deepest nodes first. It means that we search top-down and then left-to-right, instead of breadth-first that searches left-to-right first, and then top-down."}, {"owner": {"reputation": 13, "user_id": 7767612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718dde5e9e331e8a7a419b7694e4c20c?s=128&d=identicon&r=PG&f=1", "display_name": "johannesha", "link": "https://stackoverflow.com/users/7767612/johannesha"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513898350, "post_id": 47933960, "comment_id": 82837283, "body": "Ok can you describe that a little bit more specific? Does that mean that I can just take the first nodes and reverse them when the search algorithm finished?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513898441, "post_id": 47933960, "comment_id": 82837309, "body": "You do not need to reverse the list at all, given you construct it correctly (for instance not with <i>tail</i> recursion. But first of all I think the type of the function is not correct. Shouldn&#39;t it be <code>Maybe [a]</code>, or <code>[[a]]</code> (since it is possible there is no solution, or that there are multiple solutions)."}, {"owner": {"reputation": 13, "user_id": 7767612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718dde5e9e331e8a7a419b7694e4c20c?s=128&d=identicon&r=PG&f=1", "display_name": "johannesha", "link": "https://stackoverflow.com/users/7767612/johannesha"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513898611, "post_id": 47933960, "comment_id": 82837349, "body": "Sadly that&#39;s no option to change the type :D"}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1513899999, "post_id": 47933960, "comment_id": 82837767, "body": "Wait, no/multiple solutions to what exactly? Judging by function signature, nodes just have to be sorted in depth-first order. There&#39;s always a solution to that, but cycles might pose a bit of a challenge. I imagine <code>Eq</code> constraint is supposed to help with that."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 1, "creation_date": 1513904937, "post_id": 47933960, "comment_id": 82838898, "body": "Anyway, here&#39;s a general idea: go down the tree the first chance you get, maintaining the list of nodes you&#39;ve seen along the way. If a node has no outgoing edges, cool, you&#39;re done here. If you&#39;ve already seen a given node, bail, you don&#39;t need infinite recursion. This should be a straightforward application of fold with recursion sprinkled in (probably left fold since you want to traverse top-down left-to-right), something to the tune of <code>recurse seen node = foldl&#39; recurse ...</code>. I&#39;m assuming nodes are unique, otherwise <code>Graph</code> isn&#39;t a very good graph."}], "answers": [{"tags": [], "owner": {"reputation": 948, "user_id": 1031831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaa42d3b80a8cd02591cc70b4f57134?s=128&d=identicon&r=PG", "display_name": "Sam Westrick", "link": "https://stackoverflow.com/users/1031831/sam-westrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1513963642, "last_edit_date": 1513963642, "creation_date": 1513962755, "answer_id": 47945071, "question_id": 47933960, "link": "https://stackoverflow.com/questions/47933960/haskell-depth-first-search-for-a-graph/47945071#47945071", "title": "Haskell depth-first-search for a graph", "body": "<p>For graph searches like DFS and BFS, you need to keep around a list of vertices that you've previously visited. This makes it possible to check if you've seen a vertex before, so that you don't visit a vertex twice (and this handles cycles too, although it can't actually detect for sure if cycles exist).</p>\n\n<p>Here's my implementation. The <code>visited</code> list keeps track of which vertices have been visited. For each vertex we encounter, we check to see if it's been visited by traversing the list. When we \"visit\" a vertex (that is, in the <code>else</code> branch), we add the vertex to the list. The visited list is kept up-to-date by passing it around in the <code>foldl</code>.</p>\n\n<p>In this approach, we can actually hijack the <code>visited</code> list for recording the depth-first order. Since we add vertices to the list when we first see them, the <code>visited</code> list is in <em>reverse</em> depth-first order. So we simply reverse it once the search has completed.</p>\n\n<pre><code>depthFirst source (G _ sucs) = reverse (search [] source)\n  where\n    search visited v =\n      if v `elem` visited\n      then visited -- already seen v, so skip it\n      else foldl search (v:visited) (sucs v)\n</code></pre>\n\n<p>I'd recommend walking through how the code executes on a small graph to get a sense for how it works and why it is correct. For example, try it on the graph defined as follows, from source 0.</p>\n\n<pre><code>edges = [[1,2,3],[4],[5],[4,6],[5],[1],[4]]\ng = G [0,1,2,3,4,5,6] (edges!!)\n</code></pre>\n\n<p>Finally, note that this implementation is correct but highly inefficient, taking time O(nm) for a graph of n vertices and m edges, because we traverse the visited list once per edge. In a more efficient implementation, you would want to keep around two data structures, one for looking up whether or not a vertex has been visited (such as a hash set or binary search tree) and a second one for writing down the depth-first ordering.</p>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "is_accepted": false, "score": 1, "last_activity_date": 1513993304, "creation_date": 1513993304, "answer_id": 47949077, "question_id": 47933960, "link": "https://stackoverflow.com/questions/47933960/haskell-depth-first-search-for-a-graph/47949077#47949077", "title": "Haskell depth-first-search for a graph", "body": "<p>I've had one too much of a drink and have a somewhat fuzzy idea of what I'm talking about, but here's a solution I came up with.</p>\n\n<pre><code>depthFirst :: Eq a =&gt; a -&gt; Graph a -&gt; [a]\ndepthFirst root (G _nodes edges)\n  = reverse $ go [] root\n  where\n    go seen x\n      | x `elem` seen = seen\n      | otherwise = foldl' go (x:seen) (edges x)\n</code></pre>\n\n<p>I use <code>foldl'</code> from <code>Data.List</code> here because we want to traverse nodes left-to-right, which is somewhat challenging with <code>foldr</code>. And straight up using <code>foldl</code> without <code>'</code> is usually not a good idea, since it builds up thunks unless forced (while forcing is exactly what <code>foldl'</code> does).</p>\n\n<p>So, the general idea, as I outlined in my comment, is as follows. Go down the tree the first chance you get, maintaining the list of nodes you've seen along the way. If a node has no outgoing edges, cool, you're done here. If you've already seen a given node, bail, you don't need infinite recursion. </p>\n\n<p>Fold starts from current node prepended to the list of already seen nodes (at the beginning, empty list). Then, from left to right, it visits every node directly reachable from current node. At every \"next\" node, it builds reverse depth-first order of a subtree plus already seen nodes. Already seen nodes are carried over to each \"next\" node (left-to-right order). If there are no nodes reachable from current node, it returns just current node prepended to list of all seen nodes.</p>\n\n<p>List of seen nodes is reversed because prepending is <code>O(1)</code> while appending is <code>O(n)</code>. Easier to reverse once and get complexity <code>O(n)</code> rather than append every time and get complexity of roughly <code>O(n\u00b2)</code> (complexities are from the top of my head, and I'm more than a bit tipsy, so apply salt liberally)</p>\n\n<p>If <code>elem x seen</code>, function bails returning the list of all nodes seen so far. It makes sure we don't recurse into the nodes we've visited already, and hence avoids infinite recursion on cyclic graphs.</p>\n\n<p>This is classical depth-first search. It could be optimized, and potential for optimization is rather obvious (for one, <code>elem x seen</code> has <code>O(n)</code> worst-case complexity, while it could've been <code>O(log n)</code>. Feel free to improve on the code.</p>\n\n<p>As a last bit of advice, type of <code>Graph</code> doesn't guarantee that nodes are unique. A stricter implementation would look like this: <code>data Graph a = G (Set a) (BRfun a)</code>, where <code>Set</code> is from <code>Data.Set</code> (or something similar). Given the stated definition with list, it <em>might</em> be a good idea to relabel all nodes, f.ex. <code>nodes' = zip [1..] nodes</code> or something like that.</p>\n"}], "owner": {"reputation": 13, "user_id": 7767612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718dde5e9e331e8a7a419b7694e4c20c?s=128&d=identicon&r=PG&f=1", "display_name": "johannesha", "link": "https://stackoverflow.com/users/7767612/johannesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513993304, "creation_date": 1513897880, "last_edit_date": 1513898063, "question_id": 47933960, "link": "https://stackoverflow.com/questions/47933960/haskell-depth-first-search-for-a-graph", "title": "Haskell depth-first-search for a graph", "body": "<p>For hours now I am trying to implement a depth-first search for Haskell. My depthfirst algorithm has given a starting node and a graph. That is what I have so far + the definition of the graph datatype.</p>\n\n<pre><code>data Graph a = G [a] (BRfun a)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>type BRfun a = a -&gt; [a]\n</code></pre>\n\n<p>current attempt:</p>\n\n<pre><code>depthFirst :: Eq a =&gt; a -&gt; Graph a -&gt; [a]\ndepthFirst a (G [a] sucs) = [a]\n</code></pre>\n\n<p>So if only one element is in the nodes list that's the only one I have to put in the final list (I think that should be the cancellation condition).\nBut now I am struggling to create an recursive algorithm to first get the deepest nodes.</p>\n"}, {"tags": ["haskell", "functional-programming", "data-kinds"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513897439, "post_id": 47933770, "comment_id": 82837017, "body": "In GHCi, <code>:info C</code> will tell you the kind of <code>f</code> and <code>:kind T</code> will tell you the kind of <code>T</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1513897574, "post_id": 47933770, "comment_id": 82837051, "body": "@ReinHenrichs I suspect this is homework. Intended to be reasoned out with organic brain."}, {"owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "edited": false, "score": 0, "creation_date": 1513898551, "post_id": 47933770, "comment_id": 82837331, "body": "The names <code>f</code> and <code>comp</code> are an absolute giveaway."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513914870, "post_id": 47933770, "comment_id": 82840653, "body": "FYI, the class <code>C</code> is just <code>Semigroupoid</code> from the <code>semigroupoids</code> package."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513897408, "creation_date": 1513897408, "answer_id": 47933887, "question_id": 47933770, "link": "https://stackoverflow.com/questions/47933770/haskell-kinds-beginner/47933887#47933887", "title": "Haskell kinds. Beginner", "body": "<p>For the first question, I don't see why you have decided that <code>a</code> has kind <code>* -&gt; *</code>. From what is written, <code>a</code> is just a <code>*</code>, nothing more. Therefore, the kind of <code>f</code> is <code>* -&gt; * -&gt; *</code>.</p>\n\n<p>For the second question, you are correct.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 4, "last_activity_date": 1513898084, "creation_date": 1513898084, "answer_id": 47933982, "question_id": 47933770, "link": "https://stackoverflow.com/questions/47933770/haskell-kinds-beginner/47933982#47933982", "title": "Haskell kinds. Beginner", "body": "<p>GHCi can tell you the kinds of various things.  For example, if you put:</p>\n\n<pre><code>data T f g = T (f String Int) (g Bool)\n</code></pre>\n\n<p>in a file <code>Kinds.hs</code>, you can load it into GHCi and ask for the kind of <code>T</code>:</p>\n\n<pre><code>&gt; :l Kinds.hs\n&gt; :k T\nT :: (* -&gt; * -&gt; *) -&gt; (* -&gt; *) -&gt; *\n&gt;\n</code></pre>\n\n<p>so it looks like GHCi agrees with your solution.</p>\n\n<p>For your first question, you can't ask GHCi to tell you the kind of <code>f</code> directly, but since <code>f</code> is a parameter to the typeclass <code>C</code>, you can ask for the kind of <code>C</code>:</p>\n\n<pre><code>&gt; :k C\nC :: (* -&gt; * -&gt; *) -&gt; Constraint\n&gt;\n</code></pre>\n\n<p>meaning that <code>C</code> takes a type of kind <code>* -&gt; * -&gt; *</code> to produce a constraint.  So, GHCi disagrees with you and thinks that <code>f</code> is of kind <code>* -&gt; * -&gt; *</code>.</p>\n\n<p>Looking at the type signature for:</p>\n\n<pre><code>comp :: f b c -&gt; f a b -&gt; f a c\n</code></pre>\n\n<p>note that you couldn't have <code>f</code> of kind <code>(* -&gt; *) -&gt; * -&gt; *</code> because <code>f b c</code> would imply that <code>b</code> was of kind <code>* -&gt; *</code> while <code>f a b</code> would imply that <code>b</code> of of kind <code>*</code>, and it can't be both.</p>\n\n<p>It turns out that the most general possible kind would be:</p>\n\n<pre><code>f :: k -&gt; k -&gt; *\n</code></pre>\n\n<p>where the first two arguments are forced to have the same kind <code>k</code> because <code>b</code> is used in both positions (in <code>f a b</code> and <code>f b c</code> respectively), and the final result is forced to have kind <code>*</code> because <code>f b c</code>, <code>f a b</code>, and <code>f a c</code> all need to be concrete types in order for the type signature of <code>comp</code> to make sense.</p>\n\n<p>However, Haskell98 (no extensions) doesn't infer the most general possible kind, so it chooses <code>k</code> to be <code>*</code>, giving the kind signature <code>* -&gt; * -&gt; *</code>.  It turns out that if you enable a certain extension (<code>PolyKinds</code>), then the kind signature will be <code>k -&gt; k -&gt; *</code> instead.</p>\n"}], "owner": {"reputation": 43, "user_id": 8951381, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-PszXe-KggKE/AAAAAAAAAAI/AAAAAAAAABo/pdb4Hf1GyAM/photo.jpg?sz=128", "display_name": "Anonnnn", "link": "https://stackoverflow.com/users/8951381/anonnnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513898084, "creation_date": 1513896696, "last_edit_date": 1513897038, "question_id": 47933770, "link": "https://stackoverflow.com/questions/47933770/haskell-kinds-beginner", "title": "Haskell kinds. Beginner", "body": "<p>What is the kind of <code>f</code>?</p>\n\n<pre><code>class C f where\n    comp :: f b c -&gt; f a b -&gt; f a c\n</code></pre>\n\n<p>I have written: <code>(* -&gt; *) -&gt; * -&gt; *</code>\nIs this correct? <code>c</code> is a concrete type <code>*</code>. <code>a</code> is a type that takes a type and produces a type. And these both are the parameters for <code>f</code>? Is my argumentation correct?</p>\n\n<p>What is kind of <code>T</code>?</p>\n\n<pre><code>data T f g = T (f String Int) (g Bool)\n</code></pre>\n\n<p><code>f</code> has two concrete types as parameters (<code>String</code> and <code>Int</code>).  <code>g</code> has one parameter (<code>Bool</code>) These both are the parameters for <code>T</code>. So I have: <code>(*-&gt;*-&gt;*)-&gt;(*-&gt;*)-&gt;*</code>.\nIs this correct? Thank you</p>\n"}, {"tags": ["haskell", "traversal", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1513895280, "post_id": 47933424, "comment_id": 82836323, "body": "Do be careful with partsOf. It does strange things (see documentation) if the list isn\u2019t the same size (which means the lens it produces isn\u2019t really a lens)."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1513894985, "last_edit_date": 1513894985, "creation_date": 1513894440, "answer_id": 47933424, "question_id": 47932449, "link": "https://stackoverflow.com/questions/47932449/haskell-lens-apply-a-transformation-to-a-traversal/47933424#47933424", "title": "Haskell Lens: Apply a transformation to a traversal", "body": "<p>For this particular transformation, I think you're looking for:</p>\n\n<pre><code>gameState &amp; partsOf (units.traverse.health) %~ reverse\n</code></pre>\n\n<p>The optic:</p>\n\n<pre><code>units.traverse.health\n</code></pre>\n\n<p>represents a traversal of the <code>_health</code> of each <code>Unit</code> (in the order the <code>Unit</code>s appears in the <code>_units</code> field) within your <code>Game</code>.  This is different than the lens (not traversal!) that focuses on the list of healths as an <code>[Int]</code> within the <code>Game</code> -- to get this, you need to apply <code>partsOf</code> to the traversal.</p>\n\n<p>You can use the traversal directly if -- as documented in the <code>Control.Lens.Traversal</code> module -- you want to traverse over the structure changing out its contents with monadic or applicative side effects (applied in order from left to right).  However, if you want to operate on the entire list as a unit and use general <code>[Health] -&gt; [Health]</code> transformations, you'll want to convert the traversal to the <code>partsOf</code> lens first. </p>\n"}], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513894985, "creation_date": 1513888920, "question_id": 47932449, "link": "https://stackoverflow.com/questions/47932449/haskell-lens-apply-a-transformation-to-a-traversal", "title": "Haskell Lens: Apply a transformation to a traversal", "body": "<p>I'm hitting a wall with the following problem when using the Haskell Lens library.</p>\n\n<p>Let me use the example from the <a href=\"http://www.haskellforall.com/2013/05/program-imperatively-using-haskell.html\" rel=\"nofollow noreferrer\">\"Program imperatively using Haskell lenses\"</a> blog post by Gabriel Gonzalez.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Control.Lens\n\ndata Game = Game\n    { _score :: Int\n    , _units :: [Unit]\n    , _boss  :: Unit\n    } deriving (Show)\n\ndata Unit = Unit\n    { _health   :: Int\n    , _position :: Point\n    } deriving (Show)\n\ndata Point = Point\n    { _x :: Double\n    , _y :: Double\n    } deriving (Show)\n\nmakeLenses ''Game\nmakeLenses ''Unit\nmakeLenses ''Point\n</code></pre>\n\n<p>It's a good toy structure. For concreteness, here's an instantiation:</p>\n\n<pre><code>gameState :: Game\ngameState = Game\n    { _score = 0\n    , _units =\n        [ Unit\n            { _health = 10\n            , _position = Point { _x = 3.5, _y = 7.0 }\n            }\n        , Unit\n            { _health = 15\n            , _position = Point { _x = 1.0, _y = 1.0 }\n            }\n        , Unit\n            { _health = 8\n            , _position = Point { _x = 0.0, _y = 2.1 }\n            }\n        ]\n    , _boss = Unit\n        { _health = 100\n        , _position = Point { _x = 0.0, _y = 0.0 }\n        }\n    }\n</code></pre>\n\n<p>Querying units works like this:</p>\n\n<pre><code>gameState ^.. units . traverse . health    -- health of all units is [10,15,8]\n</code></pre>\n\n<p>Changing the health of <em>all</em> units can be done like this</p>\n\n<pre><code>gameState &amp; units . traverse . health .~ 100 \n</code></pre>\n\n<p>Here's where I get stuck: Suppose I wanted to apply a transformation to the traversal of the units, i.e. get the health of all the units, change all of them according to some rule, and set them. For example, if I wanted to reverse the health-list (not a very meaningful transformation in this example), something like this should work:</p>\n\n<pre><code>gameState &amp; units . traverse . health %~ reverse \n</code></pre>\n\n<p>But I can't quite figure out which operator(s) to use. </p>\n\n<p>I used this example as guidance (sort and replace all elements &lt; 4)</p>\n\n<pre><code>[2,4,3,5,4,6,1] &amp; partsOf (traverse. filtered (&lt;4)) %~ sort  -- is [1,4,2,5,4,6,3]\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1513893060, "post_id": 47932033, "comment_id": 82835515, "body": "what resolver do you use? - can you show us your <code>stack.yaml</code>"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 8395938, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k3L1AkAbhi8/AAAAAAAAAAI/AAAAAAAABro/-t9l2v7djFg/photo.jpg?sz=128", "display_name": "Marcos Daniel Baroni", "link": "https://stackoverflow.com/users/8395938/marcos-daniel-baroni"}, "is_accepted": false, "score": 4, "last_activity_date": 1513953693, "creation_date": 1513953693, "answer_id": 47943270, "question_id": 47932033, "link": "https://stackoverflow.com/questions/47932033/linking-error-when-trying-stack-install-yesod-bin/47943270#47943270", "title": "Linking error when trying &quot;stack install yesod-bin&quot;", "body": "<p>I finally figured out what was the problem and I was able to solve it in my environment.</p>\n\n<h3>Reason</h3>\n\n<p>It seems that GCC enabled PIE (Position Independent Executable) by default and stack (which uses GCC in the back) does not expect this, causing the reported problem at linking stage (<a href=\"https://github.com/commercialhaskell/stack/issues/2712#issuecomment-254085837\" rel=\"nofollow noreferrer\">source</a>).</p>\n\n<h3>Solution</h3>\n\n<p>As suggested <a href=\"https://github.com/commercialhaskell/stack/issues/3540#issuecomment-341086100\" rel=\"nofollow noreferrer\">here</a> the solution was to configure stack to pass gcc the right flags to correct this.</p>\n\n<p>This is done editing the file \"~/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.1/lib/ghc-8.0.1/settings\" in my case.\nI had to modify the configuration of 3 lines as follows:</p>\n\n<pre><code> ...\n (\"C compiler flags\", \"-fno-PIE -fno-stack-protector -fPIC\"),\n (\"C compiler link flags\", \"-no-pie -fuse-ld=gold\"),\n (\"C compiler supports -no-pie\", \"YES\"),\n ...\n</code></pre>\n\n<p>Best.</p>\n"}], "owner": {"reputation": 61, "user_id": 8395938, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k3L1AkAbhi8/AAAAAAAAAAI/AAAAAAAABro/-t9l2v7djFg/photo.jpg?sz=128", "display_name": "Marcos Daniel Baroni", "link": "https://stackoverflow.com/users/8395938/marcos-daniel-baroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513953693, "creation_date": 1513886776, "question_id": 47932033, "link": "https://stackoverflow.com/questions/47932033/linking-error-when-trying-stack-install-yesod-bin", "title": "Linking error when trying &quot;stack install yesod-bin&quot;", "body": "<p>I would like to start developing for web using yesod framework.\nBut I can not install yesod.</p>\n\n<p>I'm following the steps suggested:</p>\n\n<pre><code>stack new my-project yesod-sqlite\ncd my-project\nstack install yesod-bin --install-ghc\n</code></pre>\n\n<p>But the \"stack install yesod-bin --install-ghc\" command gives me the following output:</p>\n\n<pre><code>clock-0.7.2: configure\nclock-0.7.2: build\nbasement-0.0.4: configure\nfile-embed-0.0.10.1: download\nhourglass-0.2.10: download\nbasement-0.0.4: build\nfile-embed-0.0.10.1: configure\nfile-embed-0.0.10.1: build\nhourglass-0.2.10: configure\nhourglass-0.2.10: build\nfile-embed-0.0.10.1: copy/register\nhourglass-0.2.10: copy/register\nProgress: 4/93\n--  While building custom Setup.hs for package basement-0.0.4 using:\n      /home/mbaroni/.stack/setup-exe-cache/x86_64-linux-tinfo6-nopie/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /home/mbaroni/Computacao/prog/yesod-project/.stack-work/logs/basement-0.0.4.log\n\n    Configuring basement-0.0.4...\n    Preprocessing library for basement-0.0.4..\n    /usr/bin/ld.gold: error: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Basement/Terminal/Size_hsc_make.o: requires dynamic R_X86_64_32 reloc which may overflow at runtime; recompile with -fPIC\n    /usr/bin/ld.gold: error: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Basement/Terminal/Size_hsc_utils.o: requires dynamic R_X86_64_PC32 reloc against 'vprintf' which may overflow at runtime; recompile with -fPIC\n    collect2: error: ld returned 1 exit status\n    linking .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Basement/Terminal/Size_hsc_make.o failed (exit code 1)\n    command was: /usr/bin/gcc .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Basement/Terminal/Size_hsc_make.o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Basement/Terminal/Size_hsc_utils.o -o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-2.0.1.0/build/Basement/Terminal/Size_hsc_make -fuse-ld=gold -fno-PIE -fno-stack-protector -fuse-ld=gold -L/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/base-4.10.1.0 -Wl,-R,/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/base-4.10.1.0 -L/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/integer-gmp-1.0.1.0 -Wl,-R,/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/integer-gmp-1.0.1.0 -lgmp -L/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/ghc-prim-0.5.1.1 -Wl,-R,/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/ghc-prim-0.5.1.1 -L/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/rts -Wl,-R,/home/mbaroni/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.2.2/lib/ghc-8.2.2/rts -lm -lrt -ldl -lpthread\n</code></pre>\n\n<p>Any idea about what could be the cause of the problem would be greatly appreciated.</p>\n\n<p>My environment:</p>\n\n<pre><code>stack --version                      \nVersion 1.6.1, Git revision f25811329bbc40b0c21053a8160c56f923e1201b (5435 commits) x86_64 hpack-0.20.0\n\nghc --version                   \nThe Glorious Glasgow Haskell Compilation System, version 8.2.2\n\nuname -a\nLinux mbaroni 4.12.13-1-ARCH #1 SMP PREEMPT Fri Sep 15 06:36:43 UTC 2017 x86_64 GNU/Linux\n</code></pre>\n\n<p>Thanks for helping!</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1513880495, "creation_date": 1513880495, "answer_id": 47930627, "question_id": 47930334, "link": "https://stackoverflow.com/questions/47930334/haskell-what-does-var-get-mean/47930627#47930627", "title": "Haskell what does var &lt;- get mean?", "body": "<p>Your grid is \"contained\" within the <code>State</code> monad. See how your <code>GridState a</code> is defined? It's an alias for <code>State Grid a</code>. It says that <code>GridState</code> is a state monad, which \"carries\" a state of type <code>Grid</code>.</p>\n\n<p>The way that the <code>State</code> monad \"contains\" your grid is also relatively straightforward: you can <a href=\"https://www.stackage.org/haddock/lts-10.0/transformers-0.5.2.0/src/Control-Monad-Trans-State-Lazy.html#StateT\" rel=\"nofollow noreferrer\">look it up</a>, it's just a function that takes the state as parameter. A computation in this monad simply \"tunnels\" this parameter through the steps, but that happens behind the scenes, invisibly for you. The compiler desugars the <code>do</code> syntax into successive applications of the <code>&gt;&gt;=</code> operator, and for the <code>State</code> monad this operator \"tunnels\" the state parameter from one computation to the next.</p>\n\n<p>The <code>get</code> function is a monadic operation in the <code>State</code> monad. It merely returns the state that is \"contained\" in the monad at this point (you can <a href=\"https://www.stackage.org/haddock/lts-10.0/transformers-0.5.2.0/src/Control-Monad-Trans-State-Lazy.html#get\" rel=\"nofollow noreferrer\">look up the function too</a>).</p>\n\n<p>So the way to read the line <code>grid &lt;- get</code> is \"<em>take out the current state of the <code>State</code> monad, and give it the name <code>grid</code></em>\".</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1513885911, "last_edit_date": 1513885911, "creation_date": 1513882454, "answer_id": 47931091, "question_id": 47930334, "link": "https://stackoverflow.com/questions/47930334/haskell-what-does-var-get-mean/47931091#47931091", "title": "Haskell what does var &lt;- get mean?", "body": "<p>The <code>State</code> monad is effectively hiding the fact that every function takes a state value as input and includes a (possibly changed) state in the output. <code>get</code> effectively just returns that hidden argument.</p>\n\n<p>It's clearer if you write your function without using <code>State</code>.</p>\n\n<pre><code>-- State Grid a == Grid -&gt; (Grid, a)\nsetPositionToColor :: Int -&gt; Int -&gt; Color -&gt; Grid -&gt; (Grid, ())\n                                             ^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>When you call <code>setPositionToColor 2 0 Alive</code>, you don't actually color any particular element of your grid, because there is no grid involved yet. You just get back a function that, when <em>it</em> is called with a <code>Grid</code>, will produce the newly modified <code>Grid</code>.</p>\n\n<p>Without the <code>Monad</code> instance, every call to <code>setPositionToColor</code> would need that additional argument, and it would return a new <code>Grid</code> to be passed to the next call. Your code would look something like</p>\n\n<pre><code>let (grid1,_) = setPositionToColor x1 y1 color1 initialGrid\n    (grid2,_) = setPositionToColor x2 y2 color2 grid1\n    (grid3,_) = setPositionToColor x3 y3 color3 grid2\n    (grid4,_) = setPositionToColor x4 y4 color4 grid3\nin grid4\n</code></pre>\n\n<hr>\n\n<p>All the <code>Monad</code> instance does is let take care of passing the intermediate <code>Grid</code> values from one function to the next; all you need to do is supply <code>initialGrid</code> as the argument to <code>runState</code>, which actually starts the calls to the composed <code>State</code> action.</p>\n\n<pre><code>-- Back to setPositionToColor :: Int -&gt; Int -&gt; Color -&gt; State Grid a\nlet allFour = setPositionToColor x1 y1 color1 &gt;&gt;= (\\() -&gt;\n              setPositionToColor x2 y2 color2 &gt;&gt;= (\\() -&gt;\n              setPositionToColor x3 y3 color3 &gt;&gt;= (\\() -&gt;\n              setPositionToColor x3 y3 color4)))\nin runState allFour initialGrid\n</code></pre>\n\n<p>or, because we don't actually care about the <code>()</code> value being returned from each call,</p>\n\n<pre><code>let allFour = setPositionToColor x1 y1 color1 &gt;&gt;\n              setPositionToColor x2 y2 color2 &gt;&gt;\n              setPositionToColor x3 y3 color3 &gt;&gt;\n              setPositionToColor x3 y3 color4\nin runState allFour initialGrid\n</code></pre>\n\n<p>Using <code>do</code> notation,</p>\n\n<pre><code>let allFour = do\n   setPosition x1 y1 color1\n   setPosition x2 y2 color2\n   setPosition x3 y3 color3\n   setPosition x4 y4 color4\nin runState allFour initialGrid\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9128147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0235b86eaacf581ac8c5b09a3cadd65?s=128&d=identicon&r=PG&f=1", "display_name": "George Down", "link": "https://stackoverflow.com/users/9128147/george-down"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1513885911, "creation_date": 1513879115, "last_edit_date": 1513879547, "question_id": 47930334, "link": "https://stackoverflow.com/questions/47930334/haskell-what-does-var-get-mean", "title": "Haskell what does var &lt;- get mean?", "body": "<p>I have run into this code but I have no idea what does <code>grid &lt;- get</code> do? How do we know that this grid is our current grid? We are not passing it as an argument. So how can we use it to grab rows using that?   </p>\n\n<pre><code>data Grid = Grid [Row]\ntype GridState a = State Grid a\n\ninitializeGrid :: GridState ()\ninitializeGrid = do\n        setPositionToColor 2 0 Alive\n\n\nsetPositionToColor :: Int -&gt; Int -&gt; CellState -&gt; GridState ()\nsetPositionToColor x y color = do\n        grid &lt;- get\n        let rows = getRows grid\n            ...\n        put newState\n\ngetRows :: Grid -&gt; [Row]\n...\n</code></pre>\n"}, {"tags": ["haskell", "types", "functional-programming", "type-families"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1513876489, "post_id": 47929720, "comment_id": 82827991, "body": "I think you meant <code>type Item (Colist a) = a</code>. And you probably meant <code>toList</code> to be a method of <code>Listable</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1513876529, "post_id": 47929720, "comment_id": 82828017, "body": "You need to include the code that causes the error if you want a good explanation. This code loads just fine (after fixing indentation errors). That said: it is because, like all type family first-timers, you have not yet understood what &quot;type families are not injective&quot; means."}, {"owner": {"reputation": 43, "user_id": 8951381, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-PszXe-KggKE/AAAAAAAAAAI/AAAAAAAAABo/pdb4Hf1GyAM/photo.jpg?sz=128", "display_name": "Anonnnn", "link": "https://stackoverflow.com/users/8951381/anonnnn"}, "edited": false, "score": 0, "creation_date": 1513877054, "post_id": 47929720, "comment_id": 82828270, "body": "<a href=\"https://imgur.com/a/bIjXI\" rel=\"nofollow noreferrer\">imgur.com/a/bIjXI</a> I get this error"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1513882210, "post_id": 47929720, "comment_id": 82830793, "body": "Don&#39;t post images of text on SO -- copy &amp; paste the actual error text message inside your question, so that everyone will notice that and read it immediately. Hiding important information under a link to an image makes it less likely others will simply skip the question, providing no help."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513900838, "post_id": 47929944, "comment_id": 82837962, "body": "An inductive list would be <code>data List a = Nil | Cons !a !(List a)</code>, no?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513901117, "post_id": 47929944, "comment_id": 82838046, "body": "Also ... I don&#39;t consider this stripped down version of <code>MonoFoldable</code> to be unreasonable. Unlike <code>Functor</code> and <code>Traverseable</code>, the higher kind of <code>Foldable</code> only offers extra power under special circumstances (polymorphic recursion, for example). And some important instances, like unboxed arrays, can&#39;t be <code>Foldable</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513901555, "post_id": 47929944, "comment_id": 82838152, "body": "@dfeuer I never said it was unreasonable, <code>MonoFoldable</code> is indeed a useful class. From reading the question, though, I suspect the questioneer is a beginner, so to me it felt pedagogically justified to point the questioneer towards <code>Foldable</code> :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513901631, "post_id": 47929944, "comment_id": 82838168, "body": "I mean to say, I think the extra power of <code>MonoFoldable</code> (in that it has a larger number of instances) is not justified by the extra complexity, if you\u2019re a beginner who\u2019s learning to use the class system"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1513877244, "creation_date": 1513877244, "answer_id": 47929944, "question_id": 47929720, "link": "https://stackoverflow.com/questions/47929720/type-family-error/47929944#47929944", "title": "Type family error", "body": "<p>Did you mean...</p>\n\n<pre><code>{-#\u00a0LANGUAGE TypeFamilies #-}\n\nnewtype List a = List (Maybe (a, List a))\n\nclass Listable l where\n    type Item l :: *\n    toList :: l -&gt; [Item l]\n\ninstance Listable (List a) where\n    type Item (List a) = a\n\n    toList (List Nothing) = []\n    toList (List (Just (x, xs)) = x : toList xs\n</code></pre>\n\n<p>I've changed a few things about your code. Zero, I renamed <code>Colist</code> to <code>List</code> (because there's no such thing as a coinductive list in Haskell). One, I fixed the indentation, making <code>toList</code> a method of the <code>Listable</code> class. Two, I made <code>List a</code>'s instance of <code>Item</code> return <code>a</code>, not <code>List a</code>. Three, I fixed <code>toList</code> to actually return a list of the elements of the <code>List</code> - your version just put the whole <code>List</code> in a singleton list.</p>\n\n<p>I strongly suspect you're misusing type families here though. Here's a much simpler and more Haskell-ish formulation of this class:</p>\n\n<pre><code>class Listable l where\n    toList :: l a -&gt; [a]\n\ninstance Listable List where\n    toList (List Nothing) = []\n    toList (List (Just (x, xs)) = x : toList xs\n</code></pre>\n\n<p>Or you can just derive <code>Foldable</code> and get <code>toList</code> for free:</p>\n\n<pre><code>newtype List a = List (Maybe (a, List a)) deriving Foldable\n\nghci&gt; import Data.Foldable\nghci&gt; toList $ List (Just ('a', List Nothing))\n\"a\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8951381, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-PszXe-KggKE/AAAAAAAAAAI/AAAAAAAAABo/pdb4Hf1GyAM/photo.jpg?sz=128", "display_name": "Anonnnn", "link": "https://stackoverflow.com/users/8951381/anonnnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513939007, "creation_date": 1513876281, "last_edit_date": 1513939007, "question_id": 47929720, "link": "https://stackoverflow.com/questions/47929720/type-family-error", "title": "Type family error", "body": "<p>Hello I wrote my first program with type family</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\ndata Colist a = Colist (Maybe (a,Colist a))\n\nclass Listable l where type Item l :: *\n    toList :: l -&gt; [Item l]\n\ninstance Listable (Colist a) where \n    type Item (Colist a) = (Colist a)\n    toList x = [x]\n</code></pre>\n\n<p>The program should take Colist a and take it into a list\nI get the error that 'Item l' couldn't be matched with actual type 'l'. But I wrote that the Item x EQUALS (Colist a). Where is my mistake?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1513876796, "post_id": 47929556, "comment_id": 82828134, "body": "Yes, it is <code>Formula ( Formula )</code>. Maybe you just try it, instead of asking? That&#39;d be much faster way to find out, I think."}, {"owner": {"reputation": 353, "user_id": 8906596, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10207778167811470/picture?type=large", "display_name": "Adrien Varet", "link": "https://stackoverflow.com/users/8906596/adrien-varet"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1513877124, "post_id": 47929556, "comment_id": 82828306, "body": "But this doesnt work x)"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1513877298, "post_id": 47929556, "comment_id": 82828410, "body": "Then post a error message, at least."}, {"owner": {"reputation": 353, "user_id": 8906596, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10207778167811470/picture?type=large", "display_name": "Adrien Varet", "link": "https://stackoverflow.com/users/8906596/adrien-varet"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1513877346, "post_id": 47929556, "comment_id": 82828433, "body": "Console.hs:11:29:     <code>typeFormula&#39; is not a (visible) field of constructor </code>Formula&#39;"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1513879906, "post_id": 47929556, "comment_id": 82829615, "body": "In your export list <code>Formula (Formula)</code> means you&#39;ve only exported the type <code>Formula</code> and its constructor <code>Formula</code> but not the projections <code>typeFormula</code>, <code>nbClauses</code>, etc. If you want to export these too, you can write <code>Formula(..)</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1577178605, "post_id": 47930041, "comment_id": 105112434, "body": "I&#39;m not sure your third example is valid: it doesn&#39;t appear in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html\" rel=\"nofollow noreferrer\">the Report</a>&#39;s &quot;5.2 Export Lists&quot; subsection, and <a href=\"https://repl.it/repls/OblongTomatoEquation\" rel=\"nofollow noreferrer\">repl.it</a> goes into infinite loop trying to compile it (it uses GHC 8.6.5)."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1577202663, "post_id": 47930041, "comment_id": 105120640, "body": "Hmmm @WillNess I think it was allowed in an older version of GHC when this answer was written, but not in newer versions (it&#39;s just a compiler parse error for me now). However you can still write <code>module Formula (module Formula, ... )</code> to export the entire module."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1577204532, "post_id": 47930041, "comment_id": 105121198, "body": "right; but not what&#39;s shown in the answer at the moment."}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": false, "score": 19, "last_activity_date": 1516211043, "last_edit_date": 1516211043, "creation_date": 1513877674, "answer_id": 47930041, "question_id": 47929556, "link": "https://stackoverflow.com/questions/47929556/haskell-export-data-constructor/47930041#47930041", "title": "Haskell - Export data constructor", "body": "<p>Some of your confusion is coming from having the same module name as the constructor you're trying to export. </p>\n\n<pre><code>module Formula (\n    Formula ( Formula ),\n    solve\n) where\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>module Formula (\n    Formula (..),\n    solve\n) where\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>module Formula (\n    module Formula ( Formula (..)),\n    solve\n) where\n</code></pre>\n\n<hr>\n\n<p>Your current export statement says, in the Module Forumla, export the Type <code>Formula</code> defined in the Module Formula and the function solve (that is in scope for the module, wherever it is defined))</p>\n\n<p>The <code>(..)</code> syntax means, export all constructors for the preceding type. In your case, it is equivalent to the explicit </p>\n\n<pre><code>module Formula (\n    Formula (typeFormula,nbClauses, nbVars,clauses),\n    solve\n) where\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 8906596, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10207778167811470/picture?type=large", "display_name": "Adrien Varet", "link": "https://stackoverflow.com/users/8906596/adrien-varet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4312, "favorite_count": 1, "answer_count": 1, "score": 16, "last_activity_date": 1613879104, "creation_date": 1513875651, "last_edit_date": 1613879104, "question_id": 47929556, "link": "https://stackoverflow.com/questions/47929556/haskell-export-data-constructor", "title": "Haskell - Export data constructor", "body": "<p>I have this data on my Module Formula : </p>\n\n<pre><code>data Formula = Formula {\n    typeFormula :: String, \n    nbClauses   :: Int,\n    nbVars      :: Int,\n    clauses     :: Clauses       \n}\n</code></pre>\n\n<p>And I want to export it but I don't know the right syntax : </p>\n\n<pre><code>module Formula (\n    Formula ( Formula ),\n    solve\n) where\n</code></pre>\n\n<p>Someone can tell me the right syntax please ?</p>\n"}, {"tags": ["linux", "haskell", "ghc"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513874673, "post_id": 47929099, "comment_id": 82827093, "body": "At runtime the representation of <code>IO X</code> and <code>X</code> are identical. unsafePerformIO is just the identity."}, {"owner": {"reputation": 17508, "user_id": 1128289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9gnmI.jpg?s=128&g=1", "display_name": "Praxeolitic", "link": "https://stackoverflow.com/users/1128289/praxeolitic"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513875192, "post_id": 47929099, "comment_id": 82827363, "body": "@user2407038 IO actions also produce side-effects."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1513875834, "post_id": 47929099, "comment_id": 82827667, "body": "@Praxeolitic What you said is in fact not evidence that user2407038 is wrong. (Nevertheless, they are wrong: <code>IO X</code> has the same representation as a function that returns an <code>X</code> and some other data in an unboxed tuple.)"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513875877, "post_id": 47929099, "comment_id": 82827691, "body": "@user2407038 That&#39;s not true at all.  The runtime represenation of <code>IO X</code> is a function.  Try running <code>(unsafeCoerce (putStrLn &quot;Hello World!&quot;) :: () -&gt; ()) ()</code> in ghci. It will crash, but it will produce output."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1513931615, "post_id": 47929099, "comment_id": 82845476, "body": "Just for reference: <code>newtype IO a = IO (State# RealWorld -&gt; (# State# RealWorld, a #))</code>. Nether <code>State#</code> nor <code>RealWorld</code> actually exist at runtime. <code>State# s</code> simply represents a state token: it gets threaded around like in a normal state monad to sequence actions: <code>(IO f) &gt;&gt;= g = IO $ \\s -&gt; case f s of (# s&#39;, x #) -&gt; unIO (g x) s&#39;</code> vs <code>(State f) &gt;&gt;= g = State $ \\s -&gt; case f s of (s&#39;, x) -&gt; runState (g x) s&#39;</code>, but it goes *poof* sometime during compilation. If you take out the tokens in <code>IO a</code>, it&#39;s runtime representation looks a bit like <code>() -&gt; a</code>, but this&#39;ll be an impure function."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1513939350, "post_id": 47929099, "comment_id": 82849404, "body": "This is explained here: <a href=\"https://wiki.haskell.org/Evaluation_order_and_state_tokens\" rel=\"nofollow noreferrer\">wiki.haskell.org/Evaluation_order_and_state_tokens</a>  Read about state tokens and IO model in Haskell."}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1513876826, "creation_date": 1513876826, "answer_id": 47929849, "question_id": 47929099, "link": "https://stackoverflow.com/questions/47929099/how-does-ghc-implement-unsafeperformio/47929849#47929849", "title": "How does GHC implement unsafePerformIO?", "body": "<p>As far as I can recall, a value of type <code>IO x</code> is really a function from <code>RealWorld#</code> to a [strict] tuple of <code>RealWorld#</code> and <code>x</code>. In other words, a simple state monad.</p>\n\n<p>You won't find <code>read()</code> etc in the RTS itself; I believe the usual Prelude interface calls them via FFI. That is, the code to do it is in the <code>base</code> package, not in the RTS itself. (The RTS <em>does</em>, however, house its own thread-scheduler, which presumably calls <code>pthread</code> or whatever. And also the garbage collector and memory manager, which probably call <code>mmap</code>.)</p>\n\n<p>At least, I <em>believe</em> that's how it works, as best as I can remember. Needless to say, this is all <em>highly</em> specific to GHC's particular implementation, rather than part of any official Haskell language specification.</p>\n"}], "owner": {"reputation": 17508, "user_id": 1128289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9gnmI.jpg?s=128&g=1", "display_name": "Praxeolitic", "link": "https://stackoverflow.com/users/1128289/praxeolitic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1513876826, "creation_date": 1513873926, "question_id": 47929099, "link": "https://stackoverflow.com/questions/47929099/how-does-ghc-implement-unsafeperformio", "title": "How does GHC implement unsafePerformIO?", "body": "<p>Starting from <code>unsafePerformIO</code> and ending at either the RTS, libc, or an OS API, how does GHC implement IO?</p>\n\n<hr>\n\n<p>I'm trying to get a sense of how IO works in Haskell when the standard prelude isn't available (e.g. if we were implementing the standard prelude ourselves for whatever reason).</p>\n\n<p>I was originally expecting to find wrapped calls to C functions in GHC's Haskell code, but that's not the case. <code>unsafePerformIO</code> is built on top of <code>runRW#</code> which is where heavy magic begins and we start crashing into functions and types that aren't implemented in Haskell and are instead built into the compiler. <code>runRW#</code> appears to be able to run an IO action on the state of the real world (i.e. a <code>State# RealWorld</code>).</p>\n\n<p>Trying to go from the other direction, I haven't found a foothold in the RTS. It doesn't appear to contain the calls I would expect to functions like <code>fread()</code> and <code>fwrite()</code> or <code>read()</code> and <code>write()</code>.</p>\n\n<p>Where do I continue following the IO implementation from here? What is the basic roadmap from here onwards?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1513874462, "post_id": 47929032, "comment_id": 82826982, "body": "you&#39;re not filtering out for the chars in the specific list but for words equal to <code>&quot;,.?!-:;\\&quot;\\&#39;&quot;</code> (after removing the spurious comma).  Check my answer below for a working solution with lowercase."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874106, "post_id": 47929113, "comment_id": 82826788, "body": "getList s = filter (\\w -&gt; w <code>notElem</code> [&quot;,.?!-:;\\&quot;\\&#39;&quot;,]) (words lowercase s)  like this"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874136, "post_id": 47929113, "comment_id": 82826801, "body": "That should be <code>words (lowercase s)</code>, not <code>words lowercase s</code>. But yes."}, {"owner": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874263, "post_id": 47929113, "comment_id": 82826891, "body": "getList s = filter (\\w -&gt; w <code>notElem</code> [&quot;,.?!-:;\\&quot;\\&#39;&quot;,]) words (lowercase s)"}, {"owner": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874311, "post_id": 47929113, "comment_id": 82826913, "body": "i get an error on this line &quot;error: parse error on input \u2018]\u2019&quot;"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874377, "post_id": 47929113, "comment_id": 82826944, "body": "You added a comma in your list for no reason. Why are you writing new questions in comments? If you have a problem you can&#39;t solve on your own, ask another question elsewhere."}, {"owner": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874606, "post_id": 47929113, "comment_id": 82827061, "body": "Thanks @AJFarmar for your help."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1513873975, "creation_date": 1513873975, "answer_id": 47929113, "question_id": 47929032, "link": "https://stackoverflow.com/questions/47929032/is-there-any-way-we-can-lowercase-the-string-while-using-filter-in-haskell/47929113#47929113", "title": "Is there any way we can lowerCase the string while using filter in haskell", "body": "<p>Use <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Char.html#v:toLower\" rel=\"nofollow noreferrer\"><code>toLower :: Char -&gt; Char</code></a> from <code>Data.Char</code>:</p>\n\n<pre><code>lowerCase :: String -&gt; String\nlowerCase = map toLower\n</code></pre>\n\n<p>Just apply <code>getList</code> to <code>lowerCase s</code> instead of just <code>s</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "edited": false, "score": 0, "creation_date": 1513874509, "post_id": 47929165, "comment_id": 82827007, "body": "Thanks buddy, its perfect"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 0, "last_activity_date": 1513874176, "creation_date": 1513874176, "answer_id": 47929165, "question_id": 47929032, "link": "https://stackoverflow.com/questions/47929032/is-there-any-way-we-can-lowercase-the-string-while-using-filter-in-haskell/47929165#47929165", "title": "Is there any way we can lowerCase the string while using filter in haskell", "body": "<p>I don't think your function is doing what you intent </p>\n\n<p>you can rewrite is as </p>\n\n<pre><code>getList = map (map toLower . filter (`notElem` \",.?!-:;'\\\"\")) . words\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9127919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aa2b1caa0c06003922e4fcb1987aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Rotez Izmail", "link": "https://stackoverflow.com/users/9127919/rotez-izmail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 47929165, "answer_count": 2, "score": 0, "last_activity_date": 1513878469, "creation_date": 1513873681, "last_edit_date": 1513878469, "question_id": 47929032, "link": "https://stackoverflow.com/questions/47929032/is-there-any-way-we-can-lowercase-the-string-while-using-filter-in-haskell", "title": "Is there any way we can lowerCase the string while using filter in haskell", "body": "<p>I have a function in Haskell that takes a string and, after removing specific characters from it, returns a list of the characters in the string. Is there any way I can have the output be lowercase?</p>\n\n<p>See my function below:</p>\n\n<pre><code>getList s = filter (\\w -&gt; w `notElem` [\",.?!-:;\\\"\\'\",]) (words s)\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1513873353, "post_id": 47928908, "comment_id": 82826328, "body": "<code>f</code> is the second parameter of the lambda expression."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1513873638, "creation_date": 1513873638, "answer_id": 47929024, "question_id": 47928908, "link": "https://stackoverflow.com/questions/47928908/what-does-the-following-function-do-scanl/47929024#47929024", "title": "What does the following function do? (scanl)", "body": "<p>From the documentation for <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\"><code>scanl</code></a>:</p>\n\n<blockquote>\n  <p>scanl is similar to foldl, but returns a list of successive reduced values from the left:</p>\n\n<pre><code>scanl f z [x1, x2, ...] == [z, z `f` x1, (z `f` x1) `f` x2, ...]\n</code></pre>\n  \n  <p>Note that\n  <code>last (scanl f z xs) == foldl f z xs</code>.</p>\n</blockquote>\n\n<p>So, <code>scanl (\\s f -&gt; f s ) g</code> behaves like this:</p>\n\n<pre><code>scanl (\\s f -&gt; f s) g [x1, x2, ...] == [g, x1 g, x2 (x1 g), ...]\n</code></pre>\n\n<p>Since <code>\\s f -&gt; f s</code> is an <a href=\"https://wiki.haskell.org/Anonymous_function\" rel=\"nofollow noreferrer\">anonymous function</a> which takes two arguments and applies the second to the first:</p>\n\n<pre><code> \u03bb&gt; (\\s f -&gt; f s) 2 (+1)\n 3\n \u03bb&gt; (\\s f -&gt; f s) \"Hello\" length\n 5\n</code></pre>\n\n<p>Note that <code>\\s f -&gt; f s</code> could be written as <code>flip ($)</code>.</p>\n\n<hr>\n\n<p>So, specifically:</p>\n\n<pre><code>run g n = scanl (\\s f -&gt; f s) g $ replicate n playRound\n</code></pre>\n\n<p>Could be seen as:</p>\n\n<pre><code>run g n = [g, playRound g, playRound (playRound g), ...] -- Repeated n times.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1513873765, "creation_date": 1513873765, "answer_id": 47929052, "question_id": 47928908, "link": "https://stackoverflow.com/questions/47928908/what-does-the-following-function-do-scanl/47929052#47929052", "title": "What does the following function do? (scanl)", "body": "<p>If we look at the <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\">documentation of <strong><code>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a]</code></strong></a> we see that:</p>\n\n<blockquote>\n<pre><code><b>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</b></code></pre>\n  \n  <p>scanl is similar to foldl, but returns a list of successive reduced\n  values from the left:</p>\n\n<pre><code>scanl f z [x1, x2, ...] == [z, z `f` x1, (z `f` x1) `f` x2, ...]\n</code></pre>\n  \n  <p>Note that</p>\n\n<pre><code>last (scanl f z xs) == foldl f z xs.\n</code></pre>\n</blockquote>\n\n<p>So it starts with n initial value <code>z</code>, and each time it applies a function to <code>z</code> and the next element of the given list.</p>\n\n<p>Here the initial value is <code>g</code>, and the list is <code>replicate n playRound</code> (which means a list of <code>n</code> items, each item is <code>playRound</code>). The function here takes the <em>accumulator</em> <code>s</code>, and an element of the list (here always <code>playRound</code>), and the outcome of <code>f s</code> (in this case <code>playRound s</code>), is the next item in the list.</p>\n\n<p>So it will produce a list:</p>\n\n<pre><code>[g, playRound g, playRound (playRound g), ...]\n</code></pre>\n\n<p>and the list will contain <code>n+1</code> items.</p>\n\n<p>Probably a more elegant approach should have been:</p>\n\n<pre><code>run :: Grid -&gt; Int -&gt; [Grid]\nrun g n = take (n+1) $ iterate playRound g\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 7271772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eef9b3cffd3ca044729a43c23f7232d9?s=128&d=identicon&r=PG&f=1", "display_name": "George Morris", "link": "https://stackoverflow.com/users/7271772/george-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 47929024, "answer_count": 2, "score": 1, "last_activity_date": 1514508326, "creation_date": 1513873285, "last_edit_date": 1514508326, "question_id": 47928908, "link": "https://stackoverflow.com/questions/47928908/what-does-the-following-function-do-scanl", "title": "What does the following function do? (scanl)", "body": "<p>I really don't understand what does <code>scanl (\\s f -&gt; f s ) g</code> do in this example. What is <code>f</code>?</p>\n\n<pre><code>data Grid = Grid [Line]\ndata CellState = Dead | Alive deriving (Eq)\ndata Cell = Cell CellState Int deriving (Eq)\ndata Line = Line [Cell] Int deriving (Eq)\n\nrun :: Grid -&gt; Int -&gt; [Grid]\nrun g n = scanl (\\s f -&gt; f s) g $ replicate n playRound\n\nplayRound :: Grid -&gt; Grid\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1513875888, "post_id": 47928680, "comment_id": 82827699, "body": "You forgot <code>sqr&#39;&#39;&#39;&#39; = join (*)</code> as a fourth option :) The first two should be equivalent (ignoring type inference issues), as the second is syntactic sugar for the first. I&#39;m not sure if there would be any difference between the first two and the third (although you could also consider <code>sqr = join (*)</code> as a point-free equivalent to the first two)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1513875936, "post_id": 47928680, "comment_id": 82827724, "body": "I think most people would consider <code>sqr&#39;&#39;</code> as the most readable, and the performance issues between any of the three should be negligible."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1513877500, "post_id": 47928680, "comment_id": 82828487, "body": "There&#39;s probably a dozen minor variations on how to write this. It is <i>highly unlikely</i> that there&#39;s any performance difference at all (unless the types end up being different). Which one is <i>most readable</i> depends on who you ask."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1513888166, "post_id": 47928680, "comment_id": 82833616, "body": "@AdamSmith WHNF is not really related to this (WHNF is not generally used in the context of describing written code directly, since it is about evaluation order. If anything, though, all of the options would be in WHNF since they are all function values). Maybe you mean point-free?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1513895052, "post_id": 47928680, "comment_id": 82836245, "body": "@DavidYoung sorry, yes, point-free!"}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1514048857, "post_id": 47933027, "comment_id": 82877955, "body": "Wow! Thanks for the elaborate explanations to all of you. This already provides me with a load of new insights. Really appreciate the time you take to answer my (sometimes absurd) questions. But it does help me along much quicker!"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1513966550, "last_edit_date": 1513966550, "creation_date": 1513892122, "answer_id": 47933027, "question_id": 47928680, "link": "https://stackoverflow.com/questions/47928680/whats-the-best-style-in-haskell/47933027#47933027", "title": "What&#39;s the best style in Haskell", "body": "<p>Between these two top-level definitions:</p>\n\n<pre><code>sqr' = \\x -&gt; x * x\nsqr'' x = x * x\n</code></pre>\n\n<p>the second is pretty much universally preferred in Haskell programs.  Search through almost any chunk of real-world Haskell code, and you will find many examples of the second but few of the first. Instead, \"lambda abstraction\" (i.e., the <code>\\x -&gt; ...</code> syntax) is most often used for defining anonymous functions to pass as arguments to higher order functions.</p>\n\n<p>There are a couple of reasons the second syntax is preferred.  First, it's literally more concise and, from a readability perspective, incorporates fewer distinct syntactic elements (i.e., juxtaposition and the <code>=</code> operator, instead of juxtaposition, <code>=</code>, <code>\\</code>, and <code>-&gt;</code>).  It also generalizes well to the common Haskell idiom of defining a function using multiple patterns:</p>\n\n<pre><code>factorial 0 = 1\nfactorial n | n &gt; 0 = n * factorial (n-1)\n</code></pre>\n\n<p>To do this with the lambda syntax, you'd need to add an explicit <code>case</code> construct, involving <em>yet another</em> set of syntactic elements.</p>\n\n<p>Between:</p>\n\n<pre><code>sqr'' x = x * x\nsqr''' = (^2)\n</code></pre>\n\n<p>or -- perhaps a fairer comparison -- between:</p>\n\n<pre><code>sqr'''' x = x^2\nsqr''' = (^2)\n</code></pre>\n\n<p>it's more a matter of personal preference.  Many Haskell programmers like the clean look of so-called <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow noreferrer\">point-free</a> syntax, where larger functions are made up using higher-order functions and/or chains of composed functions without explicit arguments, like:</p>\n\n<pre><code>mostFrequentWord\n   = head . maximumBy (comparing length) . group . sort . words\n</code></pre>\n\n<p>and definitions like <code>sqr'''</code> are more in line with this overall style.</p>\n\n<p>In terms of differences in <em>meaning</em> between these forms, it's actually a little complicated.  For obscure reasons having to do with things called \"the monomorphism restriction\" and \"defaulting rules\", if you took the following module:</p>\n\n<pre><code>module Square where\nsqr' = \\x -&gt; x * x\nsqr'' x = x * x\nsqr''' = (^2)\n</code></pre>\n\n<p>and compiled it with <code>ghc -O</code>, the definitions of <code>sqr'</code> and <code>sqr'''</code> would be equivalent -- both would be specialized to operate on the <code>Integer</code> type and would generate exactly the same code.  (Tested with GHC 8.0.2).  In contrast, <code>sqr''</code> remains polymorphic with signature <code>Num a =&gt; a -&gt; a</code>, meaning it can operate on any numeric type.</p>\n\n<p>If you add top-level type signatures (good practice anyway!), like so:</p>\n\n<pre><code>module Square where\nsqr', sqr'', sqr''' :: (Num a) =&gt; a -&gt; a\nsqr' = \\x -&gt; x * x\nsqr'' x = x * x\nsqr''' = (^2)\n</code></pre>\n\n<p>then they all generate exactly the same code.  You can verify this yourself by peeking at the generated \"core\" (the intermediate Haskell-like language that the compiler creates as a midpoint in the compilation process) using:</p>\n\n<pre><code>ghc -O -ddump-simpl -dsuppress-all -fforce-recomp Square.hs\n</code></pre>\n\n<p>In the generated core, you'll see the definition:</p>\n\n<pre><code>sqr' = \\ @ a_aBC $dNum_aLW x_arx -&gt; * $dNum_aLW x_arx x_arx\n</code></pre>\n\n<p>which looks weird, but basically says, apply the <code>*</code> operation for the appropriate <code>Num</code> type to the arguments <code>x_arx x_arx</code>.  The generated code for the two variants:</p>\n\n<pre><code>sqr'' = sqr'\nsqr''' = sqr'\n</code></pre>\n\n<p>shows that GHC sees no difference between them and <code>sqr'</code>, and so there will be no semantic or performance difference.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513966550, "creation_date": 1513872494, "question_id": 47928680, "link": "https://stackoverflow.com/questions/47928680/whats-the-best-style-in-haskell", "title": "What&#39;s the best style in Haskell", "body": "<p>Made serious progress also thanks to Erik Meijer's lectures. Good watch, maybe a hint. Haskell allows for several ways to write the same function. Which one of these would be best in terms of efficiency and readability?</p>\n\n<pre><code>sqr' = \\x -&gt; x * x\nsqr'' x = x * x\nsqr''' = (^2)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513869750, "post_id": 47927856, "comment_id": 82824217, "body": "Can you describe (without Haskell) how the algorithm would look like? For instance by writing it in pseudo-code, or another programming laguage?"}, {"owner": {"reputation": 49, "user_id": 8929879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jSMkb.jpg?s=128&g=1", "display_name": "k1r4n", "link": "https://stackoverflow.com/users/8929879/k1r4n"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513869955, "post_id": 47927856, "comment_id": 82824346, "body": "<b>1.</b> create two lists of strings as shown above <b>2.</b> check second list with first list <b>3.</b> count how many times the words from the first list appear in the second list and then return the number"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1513870560, "post_id": 47927856, "comment_id": 82824733, "body": "Have you looked anywhere on <a href=\"https://www.haskell.org/hoogle/?hoogle=Eq+a+%3D%3E+%5Ba%5D+-%3E+%5Ba%5D+-%3E+%5Ba%5D\" rel=\"nofollow noreferrer\">hoogle?</a> There&#39;s a function there that might help you."}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "is_accepted": true, "score": 2, "last_activity_date": 1513870513, "creation_date": 1513870513, "answer_id": 47928172, "question_id": 47927856, "link": "https://stackoverflow.com/questions/47927856/haskell-compare-two-list-of-strings-and-return-the-number-of-times-a-word-appe/47928172#47928172", "title": "Haskell - Compare two list of strings and return the number of times a word appears?", "body": "<p>You can use <code>filter f</code>, where <code>f :: a -&gt; Bool</code>, on a list of <code>a</code>s, and return only those elements <code>x</code> for which <code>f x</code> is <code>True</code>.</p>\n\n<p>Thus, taking <code>f</code> to be <code>(== x)</code> above, gives you a list consisting only of <code>x</code>s, repeated the number of times <code>x</code> occurs in the original list.</p>\n\n<p>Composing this with <code>length</code> then gives you how many times <code>x</code> occurs in the list:</p>\n\n<pre><code>countOccurencesIn xs x = length . filter (== x) $ xs\n</code></pre>\n\n<p>Then you want to call this with your second list as <code>xs</code> for each <code>x</code> in your first list, which is a <code>map</code>:</p>\n\n<pre><code>map (countOccurencesIn ys) xs\n</code></pre>\n\n<p>This gives you a list of integers resulting from replacing each element of <code>xs</code> by the number of its occurences in <code>ys</code>, then you should of course sum these numbers:</p>\n\n<pre><code>finalCounter xs ys = sum . map (countOccurencesIn ys) $ xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 0, "last_activity_date": 1513904966, "last_edit_date": 1513904966, "creation_date": 1513902749, "answer_id": 47934517, "question_id": 47927856, "link": "https://stackoverflow.com/questions/47927856/haskell-compare-two-list-of-strings-and-return-the-number-of-times-a-word-appe/47934517#47934517", "title": "Haskell - Compare two list of strings and return the number of times a word appears?", "body": "<p>If your lists dont have duplicates, you can use <a href=\"https://www.haskell.org/hoogle/?hoogle=intersect\" rel=\"nofollow noreferrer\"><code>intersect</code></a> from <code>Data.List</code> to do this task:</p>\n\n<pre><code>import Data.List\n\ncountWords :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\ncountWords xs ys = length $ intersect xs ys\n</code></pre>\n\n<p>Which works as follows:</p>\n\n<pre><code>*Main&gt; countWords [\"the\", \"cat\", \"bit\", \"the\" , \"dog\"] [\"cat\", \"dog\", \"rabbit\"] \n2\n</code></pre>\n\n<p>But runs into problems when list one has duplicates:</p>\n\n<pre><code>*Main&gt; countWords [\"the\", \"cat\", \"bit\", \"the\" , \"dog\", \"cat\"] [\"cat\", \"dog\", \"rabbit\"]\n2\n</code></pre>\n\n<p>The above function should have returned <code>3</code>. One way around this is the recursive approach. We can first make a function which filters elements from list one, which exist in list two:</p>\n\n<pre><code>filterWords :: (Eq a) =&gt; [a] -&gt; [a] -&gt; [a]\nfilterWords [] _ = []\nfilterWords (x:xs) ys\n   | x `elem` ys = x : filterWords xs ys\n   | otherwise = filterWords xs ys\n</code></pre>\n\n<p>which works as follows:</p>\n\n<pre><code>*Main&gt; filterWords [\"the\", \"cat\", \"bit\", \"the\" , \"dog\", \"cat\"] [\"cat\", \"dog\", \"rab\nbit\"]\n[\"cat\",\"dog\",\"cat\"]\n</code></pre>\n\n<p>Then we can just take the <code>length</code> of this result:</p>\n\n<pre><code>countWords :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\ncountWords xs ys = length $ filterWords xs ys\n</code></pre>\n\n<p>Which now works properly:</p>\n\n<pre><code>*Main&gt; countWords [\"the\", \"cat\", \"bit\", \"the\" , \"dog\", \"cat\"] [\"cat\", \"dog\", \"rabbit\"]\n3\n</code></pre>\n\n<p>As others have mentioned, <code>filter</code> makes this task much easier:</p>\n\n<pre><code>countWords :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\ncountWords xs ys = length $ filter (\\x -&gt; x `elem` ys) xs\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8929879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jSMkb.jpg?s=128&g=1", "display_name": "k1r4n", "link": "https://stackoverflow.com/users/8929879/k1r4n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 943, "favorite_count": 0, "accepted_answer_id": 47928172, "answer_count": 2, "score": 0, "last_activity_date": 1513904966, "creation_date": 1513869405, "last_edit_date": 1513902372, "question_id": 47927856, "link": "https://stackoverflow.com/questions/47927856/haskell-compare-two-list-of-strings-and-return-the-number-of-times-a-word-appe", "title": "Haskell - Compare two list of strings and return the number of times a word appears?", "body": "<p>I am a beginner in Haskell. I am trying to find a solution to how to compare two lists of strings and check how many times the words of one list appear in the other list. </p>\n\n<p>I have attempted to use the <code>length</code> function but it returns the number of string (elements) in the list. I also used <code>filter</code> but I am unsure how to construct this solution. I have checked <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">this</a> website for help but I am unsure which function to use and how.</p>\n\n<p>For example, the below code should return the number 2 as <em>listofStrings</em> contains 2 words form <em>animals</em>.</p>\n\n<pre><code>animals = [\"cat\", \"dog\", \"rabbit\"]\nlistofStrings = [\"the\", \"cat\", \"bit\", \"the\" , \"dog\"]\n</code></pre>\n\n<p>Expected result should be:</p>\n\n<pre><code>2\n</code></pre>\n"}, {"tags": ["string", "haskell", "networking"], "comments": [{"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1513887575, "post_id": 47927838, "comment_id": 82833372, "body": "Can&#39;t you use <code>socketToHandle</code> to convert a socket into a <code>Handle</code> and use <code>hGetLine</code> on that?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1513890999, "post_id": 47927838, "comment_id": 82834691, "body": "I would probably use a streaming library for handling decoding and line splitting. <code>pipes</code> + <code>pipes-bytestring</code> + <code>pipes-text</code> for example, or the counduit equivalents <a href=\"http://hackage.haskell.org/package/conduit-extra-1.2.2/docs/Data-Conduit-Text.html#v:lines\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/conduit-extra-1.2.2/docs/&hellip;</a>"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1513894260, "post_id": 47927838, "comment_id": 82835956, "body": "Using <code>socketToHandle</code> would solve part of the problem, but that will expose me to [this bug] (<a href=\"https://ghc.haskell.org/trac/ghc/ticket/14503\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/14503</a>), which I&#39;m trying to avoid."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1513897131, "post_id": 47927838, "comment_id": 82836925, "body": "Well, yeah, then probably either conduit-extra with Data.Conduit.Network or pipes-network is your best bet. Former seems fair bit more feature-complete."}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1515072850, "creation_date": 1513869348, "last_edit_date": 1515072850, "question_id": 47927838, "link": "https://stackoverflow.com/questions/47927838/which-high-level-interface-to-use-instead-of-network-for-sending-and-haskell-st", "title": "Which high level interface to use instead of Network for sending and haskell `Strings`", "body": "<p>The first line of documentation of the <a href=\"https://hackage.haskell.org/package/network-2.6.3.2/docs/Network.html\" rel=\"nofollow noreferrer\"><code>Network</code></a> module reads:</p>\n\n<blockquote>\n  <p>This module is kept for backwards-compatibility. New users are encouraged to use Network.Socket instead.</p>\n</blockquote>\n\n<p>The <code>Network</code> library has functions that allow to send and receive <code>Strings</code> in a convenient manner, for instance:</p>\n\n<pre><code>  h &lt;- connectTo \"localhost\" (PortNumber 9090)\n  -- ...\n  line &lt;- hGetLine h\n</code></pre>\n\n<p>Without using this library (and using <code>Network.Socket</code> instead), the code above will become something like:</p>\n\n<pre><code>addrinfos &lt;- getAddrInfo Nothing (Just \"\") (Just \"9090\")\nlet serveraddr = head addrinfos\nsock &lt;- socket (addrFamily serveraddr) Stream defaultProtocol\nconnect sock (addrAddress serveraddr)\n-- ...\nmsg &lt;- recv sock Size\n-- What `Size` should be? The line above should be probably repeated until all the data is received.\n</code></pre>\n\n<p>Which is is quite low level, and requires coding/decoding a <code>String</code>'s. So my question is, if all I want to do is to send and receive strings (with some encoding) over a socket what are the alternatives for accomplishing this task, provided that <code>Network</code> is not an option?</p>\n\n<p><strong>EDIT</strong>: although pipes are conduits are good options, the project I'm working on makes heavy use of these <code>Network</code> functions, so I ended up developing a <a href=\"https://github.com/capitanbatata/text-via-sockets\" rel=\"nofollow noreferrer\">library</a> for sending and receiving <code>Text</code> using similar functions as in the <code>Network</code> library.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513864681, "post_id": 47926501, "comment_id": 82820807, "body": "What with tabs, .."}, {"owner": {"reputation": 968, "user_id": 6774746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/70d280e468a87e6efb7f21c92ff52bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Big Smile", "link": "https://stackoverflow.com/users/6774746/big-smile"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513864732, "post_id": 47926501, "comment_id": 82820838, "body": "@WillemVanOnsem spaces between words"}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 6774746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/70d280e468a87e6efb7f21c92ff52bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Big Smile", "link": "https://stackoverflow.com/users/6774746/big-smile"}, "edited": false, "score": 0, "creation_date": 1513865464, "post_id": 47926613, "comment_id": 82821329, "body": "Thank you very much this worked and I will rename the function. You are missing <code>-&gt;</code> in the second block of the code."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1542160905, "last_edit_date": 1542160905, "creation_date": 1513865003, "answer_id": 47926613, "question_id": 47926501, "link": "https://stackoverflow.com/questions/47926501/haskell-removing-non-letter-characters-but-ignoring-white-spaces/47926613#47926613", "title": "Haskell - Removing non-letter characters but ignoring white spaces?", "body": "<blockquote>\n  <p>I think the filter function is removing the white spaces and therefore it becomes a single string.</p>\n</blockquote>\n\n<p>That is correct. As filter predicate you write <code>\\x -&gt; x `elem` ['a'..'z']</code>. <code>['a'..'z']</code> is a list that contains lowercase letters, so for whitespace, the predicate will fail, and thus you should allow spaces as well.</p>\n\n<p>We can for instance add the space character to the list:</p>\n\n<pre><code>dropNonLetters xs = words $ (filter (\\x -&gt; x `elem` <b>(' ':</b>['a'..'z']<b>)</b>))) $ toLowerStr xs</code></pre>\n\n<p>But this is inelegant and does not really explain itself. The <code>Data.Char</code> module however ships with two functions that are interesting here: <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Char.html#v:isLower\" rel=\"nofollow noreferrer\"><strong><code>isLower :: Char -&gt; Bool</code></strong></a>, and <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Char.html#v:isSpace\" rel=\"nofollow noreferrer\"><strong><code>isSpace :: Char -&gt; Bool</code></strong></a>. We can use this like:</p>\n\n<pre><code>dropNonLetters xs = words $ (filter (\\x -&gt; <b>isLower x || isSpace x</b>)) $ toLowerStr xs</code></pre>\n\n<p><code>isLower</code> and <code>isSpace</code> are not only more \"descriptive\" and <em>elegant</em>. Usually these functions will be faster than a membership check (which will usually be done in <em>O(n)</em>), and furthermore it will also take into account tabs, new lines, etc.</p>\n\n<p>We can also perform an <em>eta-reduction</em> on the function:</p>\n\n<pre><code>dropNonLetters = words <b>.</b> (filter (\\x -&gt; isLower x || isSpace x)) <b>.</b> toLowerStr</code></pre>\n\n<p>This then produces:</p>\n\n<pre><code>Prelude Data.Char&gt; dropNonLetters \"ORANGE, apple! APPLE!!\"\n[\"orange\",\"apple\",\"apple\"]\n</code></pre>\n\n<p>I advise you to rename the function <code>dropNonLetters</code>, since now it does not fully explain that it will generate a list of words. Based on the name, I would think that it only drops non-letters, not that it converts the string to lowercase nor that it constructs words.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12401833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c9b35357c74bac0db06cb61c35e957?s=128&d=identicon&r=PG&f=1", "display_name": "xcodyx", "link": "https://stackoverflow.com/users/12401833/xcodyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1575095322, "last_edit_date": 1575095322, "creation_date": 1574233966, "answer_id": 58948678, "question_id": 47926501, "link": "https://stackoverflow.com/questions/47926501/haskell-removing-non-letter-characters-but-ignoring-white-spaces/58948678#58948678", "title": "Haskell - Removing non-letter characters but ignoring white spaces?", "body": "<p>here's an example of separating characters into separate string lists:</p>\n\n<blockquote>\n  <p>sortNumbers ::  [Char] -> [String]\n  sortNumbers args = filter (\\strings ->strings/= \"\") $ zipWith (\\x numbers -> filter (\\char -> char == numbers) x) (repeat args)\n  ['1'..'9']</p>\n</blockquote>\n"}], "owner": {"reputation": 968, "user_id": 6774746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/70d280e468a87e6efb7f21c92ff52bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Big Smile", "link": "https://stackoverflow.com/users/6774746/big-smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2594, "favorite_count": 0, "accepted_answer_id": 47926613, "answer_count": 2, "score": 4, "last_activity_date": 1575095322, "creation_date": 1513864624, "last_edit_date": 1513865446, "question_id": 47926501, "link": "https://stackoverflow.com/questions/47926501/haskell-removing-non-letter-characters-but-ignoring-white-spaces", "title": "Haskell - Removing non-letter characters but ignoring white spaces?", "body": "<p>I am very new to Haskell. I am trying to return a list of strings from a given string (which could contain non-letter characters) but I get a single string in the list.</p>\n\n<p>The below code shows What I have tried so far:</p>\n\n<pre><code>toLowerStr xs = map toLower xs\n\n--drop non-letters characters\ndropNonLetters xs = words $ (filter (\\x -&gt; x `elem` ['a'..'z'])) $ toLowerStr xs\n</code></pre>\n\n<ul>\n<li>lowercase all the characters by using <code>toLower</code> function</li>\n<li>remove non-letter characters by using <code>filter</code> function</li>\n<li>return a list of strings by using <code>words</code> function </li>\n</ul>\n\n<p>I think the <code>filter</code> function is removing the white spaces and therefore it becomes a single string. I tried using <code>isSpace</code> function but I don't know exactly how to implement it in this case. </p>\n\n<p>What is it that I am doing wrong? I get this output:</p>\n\n<pre><code>\u03bb&gt; dropNonLetters \"ORANGE, apple! APPLE!!\"\n[\"orangeappleapple\"]\n</code></pre>\n\n<p>But I want to achieve the below output:</p>\n\n<pre><code>\u03bb&gt; dropNonLetters \"ORANGE, apple! APPLE!!\"\n[\"orange\",\"apple\",\"apple\"]\n</code></pre>\n"}, {"tags": ["haskell", "exception-handling", "haskell-turtle"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1513885153, "post_id": 47926346, "comment_id": 82832260, "body": "&quot;throwing an IO exception for a parsing error&quot; perhaps you could define your own <code>ParsingException</code>. It would let you include more detailed errors."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1513894016, "post_id": 47926346, "comment_id": 82835871, "body": "Problem is that if I use <code>die</code> I cannot help throwing an IO Exception. Unless I just use <code>throw</code> inside a <code>Shell</code> monad and the I could use the exception you mentioned. I guess that is a bit better thanks for the tip"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1513952372, "post_id": 47926346, "comment_id": 82855474, "body": "For what it&#39;s worth, I once wrote a wrapper for the &quot;process&quot; package that let you exit early (and kill the external process) by returning a <code>Left</code> instead of throwing exceptions: <a href=\"http://hackage.haskell.org/package/process-streaming-0.9.1.2/docs/System-Process-Streaming.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/process-streaming-0.9.1.2/docs/&hellip;</a> see the <code>executeFallibly</code> function."}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1513864125, "creation_date": 1513864125, "question_id": 47926346, "link": "https://stackoverflow.com/questions/47926346/failing-turtle-shell-without-throwing-an-error", "title": "Failing `Turtle` `Shell` without throwing an error", "body": "<p>I have a program that is supossed to parse the output lines of a program, and produce some output data structure that contains some information extracted from those lines. For doing this I'm using <a href=\"https://hackage.haskell.org/package/turtle-1.4.1/\" rel=\"nofollow noreferrer\"><code>turtle</code></a>:</p>\n\n<pre><code>import Turtle\nimport qualified Control.Foldl as F\nimport           Control.Monad.Except\n\n-- Just for illustration purposes\nnewtype Result a = Result [a]\ntype Error = String\n\ncollectOutput :: (MonadIO m, MonadError Error m) =&gt; Text -&gt; m Result\ncollectOutput cmd = Result &lt;$&gt; fold (runCmd cmd) F.list\n-- Yes, I know turtle does also streaming, but I need to return all the results at the same time. Sorry...\n\nrunCmd ::Text -&gt; Shell Result\nrunCmd cmd = do\n    line &lt;- inproc cmd [] empty\n    tryParseOutput\n</code></pre>\n\n<p>Now the problem comes when trying to define <code>tryParseOutput</code>. I would like to abort the command (spawned with <code>inproc cmd [] empty</code>) as soon as an error occurs. For doing this, the the only way I see is by using the <a href=\"https://hackage.haskell.org/package/turtle-1.4.1/docs/Turtle-Prelude.html#v:die\" rel=\"nofollow noreferrer\"><code>die</code></a> function, which will throw an <code>IOError</code>:</p>\n\n<pre><code>tryParseOutput line =\n    case parseOutput line of\n        Left parseErr -&gt; die $ show parseErr\n        Right res     -&gt; return res \n</code></pre>\n\n<p>But now this means that I need to modify <code>collectOutput</code> to handle <code>IOExceptions</code>:</p>\n\n<pre><code>collectOutput :: (MonadIO m, MonadError Error m) =&gt; Text -&gt; m Result\ncollectOutput cmd = do\n    mRes &lt;- liftIO $ collectOutputIO cmd\n    case mRes of\n        Left err -&gt; throwError err\n        Right res -&gt; return res\n\ncollectOutputIO :: Text -&gt; IO (Either Error Result)\ncollectOutputIO cmd = \n    (Right . Result &lt;$&gt; fold (runCmd cmd) F.list) `catch` handler\n    where \n        handler :: IOException -&gt; Either Error Result\n        handler ex = show ex\n</code></pre>\n\n<p>While this works, I don't like the fact that I'm throwing an IO exception for a parsing error, and there is some exception catching and case analysis involved. So I was wondering whether this could be solved in a more elegant manner (maybe more <code>turtle</code> idiomatic), or I should forget about using <code>MonadError</code> and accept <code>IOError</code> as a fact of life of <code>turtle</code> shell scripts?</p>\n"}, {"tags": ["haskell", "conduit"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1513881304, "creation_date": 1513881304, "answer_id": 47930816, "question_id": 47923615, "link": "https://stackoverflow.com/questions/47923615/combine-sources-output-into-stream/47930816#47930816", "title": "Combine source&#39;s output into stream", "body": "<p>I think you're looking for <a href=\"https://www.stackage.org/haddock/lts-10.0/conduit-1.2.12.1/Data-Conduit.html#t:ZipSource\" rel=\"nofollow noreferrer\">ZipSource</a>, which may look like this in your case:</p>\n\n<pre><code>getZipSource $ (,)\n    &lt;$&gt; ZipSource (yieldMany [1..])\n    &lt;*&gt; ZipSource (yieldMany [100..])\n</code></pre>\n"}], "owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 47930816, "answer_count": 1, "score": 2, "last_activity_date": 1513881304, "creation_date": 1513854436, "question_id": 47923615, "link": "https://stackoverflow.com/questions/47923615/combine-sources-output-into-stream", "title": "Combine source&#39;s output into stream", "body": "<p>I'd like a conduit that takes a source as an argument and uses the latter's output combined with its own. In types, something like e.g.</p>\n\n<pre><code>combine :: ConduitM () Int m ()\n        -&gt; ConduitM Int (Int, Int) m ()\n</code></pre>\n\n<p>where I'd hope that the following</p>\n\n<pre><code>runConduit $ yieldMany [(1::Int)..]\n          .| combine (yieldMany [100..])\n          .| takeC 5\n          .| sinkList\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>[(1,100), (2,102), (3,103), (4,104), (5, 105)]\n</code></pre>\n\n<p>This is a simplified version of my use case. But I'm not sure how to go about this beyond</p>\n\n<pre><code>combine source = mapC $ \\i -&gt; do\n  -- stream output from source somehow\n  (i, i)\n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 1, "creation_date": 1513836311, "post_id": 47918767, "comment_id": 82805376, "body": "You can probably fix it by replacing <code>withTransaction con $ runMigration</code> with <code>withTransaction con $ void $ runMigration</code> where <code>void</code> is imported from Control.Monad. Void discards the result of a monadic computation."}, {"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "reply_to_user": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1513837404, "post_id": 47918767, "comment_id": 82805754, "body": "@Zpalmtree that does work to get it to compile. I wonder why the example is different."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 1, "creation_date": 1513837779, "post_id": 47918767, "comment_id": 82805884, "body": "It looks like it must be just a typo/mistake, I checked the hackage history and runMigration always had this type signature."}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513835775, "creation_date": 1513835775, "question_id": 47918767, "link": "https://stackoverflow.com/questions/47918767/sample-postgresql-simple-migration-program-does-not-compile", "title": "sample postgresql-simple-migration program does not compile", "body": "<p>I am attempting to get started with the <code>postgresql-simple-migration</code> library, and am having trouble getting a listed sample program to compile.</p>\n\n<p>The sample program, shown below, is the \"Initializing the database\" example listed on the <a href=\"https://hackage.haskell.org/package/postgresql-simple-migration\" rel=\"nofollow noreferrer\"><code>postgresql-simple-migration</code> hackage page</a>.</p>\n\n<pre><code>main :: IO ()\nmain = do\n    let url = \"host=$host dbname=$db user=$user password=$pw\"\n    con &lt;- connectPostgreSQL (BS8.pack url)\n    withTransaction con $ runMigration $\n        MigrationContext MigrationInitialization True con\n</code></pre>\n\n<p>It seems all I should need to do for this to compile is import the correct modules. Importing <code>postgresql-simple-migration</code> modules containing these terms and <code>Data.ByteString.Char8</code> which makes <code>pack</code> have the expected types, gives the following.</p>\n\n<pre><code>import Database.PostgreSQL.Simple.Migration\nimport Database.PostgreSQL.Simple\nimport Data.ByteString.Char8 as BS8\n\nmain :: IO ()\nmain = do\n    let url = \"host=$host dbname=$db user=$user password=$pw\"\n    con &lt;- connectPostgreSQL (BS8.pack url)\n    withTransaction con $ runMigration $\n        MigrationContext MigrationInitialization True con\n</code></pre>\n\n<p>However, attempting to compile this results in a type error.</p>\n\n<pre><code>$ stack build\nBuilding all executables for `db' once. After a successful build of all of them, only specified executables will be rebuilt.\ndb-0.1.0.0: build (lib + exe)\nPreprocessing library db-0.1.0.0...\nPreprocessing executable 'db-exe' for db-0.1.0.0...\n[1 of 1] Compiling Main             ( app/Main.hs, .stack-work/dist/x86_64-linux-nix/Cabal-1.24.2.0/build/db-exe/db-exe-tmp/Main.o )\n\n/home/matthew/backup/organizeactions/taskmasterplatform/db/app/Main.hs:12:5: error:\n    \u2022 Couldn't match type \u2018MigrationResult String\u2019 with \u2018()\u2019\n      Expected type: IO ()\n        Actual type: IO (MigrationResult String)\n    \u2022 In a stmt of a 'do' block:\n        withTransaction con\n        $ runMigration $ MigrationContext MigrationInitialization True con\n      In the expression:\n        do { let url = \"host=$host dbname=$db user=$user password=$pw\";\n             con &lt;- connectPostgreSQL (pack url);\n             withTransaction con\n             $ runMigration\n               $ MigrationContext MigrationInitialization True con }\n      In an equation for \u2018main\u2019:\n          main\n            = do { let url = ...;\n                   con &lt;- connectPostgreSQL (pack url);\n                   withTransaction con\n                   $ runMigration\n                     $ MigrationContext MigrationInitialization True con }\n\n--  While building custom Setup.hs for package db-0.1.0.0 using:\n      /home/matthew/.stack/setup-exe-cache/x86_64-linux-nix/Cabal-simple_mPHDZzAJ_1.24.2.0_ghc-8.0.2 --builddir=.stack-work/dist/x86_64-linux-nix/Cabal-1.24.2.0 build lib:db exe:db-exe --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p><code>runMigration</code> (of <a href=\"https://hackage.haskell.org/package/postgresql-simple-migration-0.1.11.0/docs/Database-PostgreSQL-Simple-Migration.html\" rel=\"nofollow noreferrer\"><code>Database.PostgreSQL.Simple.Migration</code></a>) has type</p>\n\n<pre><code>`runMigration :: MigrationContext -&gt; IO (MigrationResult String)`\n</code></pre>\n\n<p>and the <code>(MigrationResult String)</code> does not match the <code>()</code> marked in the type signature for <code>main</code>.</p>\n\n<p><strong>Why is the example not compiling?</strong></p>\n\n<ul>\n<li>Do I need to import from a different module?</li>\n<li>Does the example contain an error?</li>\n</ul>\n"}, {"tags": ["debugging", "haskell", "trace", "fold"], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 2, "last_activity_date": 1513829522, "last_edit_date": 1513829522, "creation_date": 1513827263, "answer_id": 47917547, "question_id": 47917436, "link": "https://stackoverflow.com/questions/47917436/could-you-trace-how-this-haskell-foldl-lambda-function-is-working/47917547#47917547", "title": "Could you trace how this Haskell foldl lambda function is working?", "body": "<p>We can step through the evaluation of, say, <code>myReverse [1,2,3]</code>. We need the definition of <code>foldl</code></p>\n\n<pre><code>foldl f z []     = z\nfoldl f z (x:xs) = foldl f (f z x) xs\n</code></pre>\n\n<p>So we have</p>\n\n<pre><code>myReverse [1,2,3,4]\n-- definition of myReverse\n= foldl (\\a x -&gt; x:a) [] [1,2,3]\n-- definition of foldl (x:xs case)\n= foldl (\\a x -&gt; x:a) ((\\a x -&gt; x:a) [] 1) [2,3]\n-- beta reduction [1]\n= foldl (\\a x -&gt; x:a) [1] [2,3]\n-- definition of foldl\n= foldl (\\a x -&gt; x:a) ((\\a x -&gt; x:a) [1] 2) [3]\n-- beta reduction\n= foldl (\\a x -&gt; x:a) [2,1] [3]\n-- definition of foldl\n= foldl (\\a x -&gt; x:a) ((\\a x -&gt; x:a) [2,1] 3) []\n-- beta reduction\n= foldl (\\a x -&gt; x:a) [3,2,1] []\n-- definition of foldl ([] case)\n= [3,2,1]\n</code></pre>\n\n<p>with the important caveat at [1] and for each beta reduction step that this beta reduction actually only happens when something scrutinizes the result. As <code>foldl</code> is progressing, the repeated applications of <code>f</code> build up as thunks, so what we really get (if <code>f = \\a x -&gt; x:a</code>) is:</p>\n\n<pre><code>foldl f [] [1,2,3]\nfoldl f (f [] 1) [2,3]\nfoldl f ((f 2 (f [] 1))) [3]\nfoldl f (((f 3 ((f 2 (f [] 1)))))) []\n(((f 3 ((f 2 (f [] 1))))))\n</code></pre>\n\n<p>This is why we have <code>foldl'</code>, which is strict in its accumulator and prevents this thunk build-up.</p>\n\n<p>The initial value is <code>[]</code>. The <code>[b]</code> in this case is the same as the <code>a</code> in <code>foldl</code>, which is the <code>[a]</code> in <code>myReverse</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1513844978, "creation_date": 1513844978, "answer_id": 47920888, "question_id": 47917436, "link": "https://stackoverflow.com/questions/47917436/could-you-trace-how-this-haskell-foldl-lambda-function-is-working/47920888#47920888", "title": "Could you trace how this Haskell foldl lambda function is working?", "body": "<pre><code>myReverse :: [a] -&gt; [a]\nmyReverse = foldl (\\a x -&gt; x:a) []\n</code></pre>\n\n<p>can be equivalently rewritten as</p>\n\n<pre><code>myReverse :: [a] -&gt; [a]\nmyReverse xs = foldl (\\a x -&gt; x:a) [] xs\n</code></pre>\n\n<p>Hence, the folding function is the lambda <code>\\a x -&gt; x:a</code>, the starting value is <code>[]</code>, and the list to fold over is <code>xs</code>.</p>\n"}], "owner": {"reputation": 961, "user_id": 2079306, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/Wm1fn.jpg?s=128&g=1", "display_name": "john stamos", "link": "https://stackoverflow.com/users/2079306/john-stamos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1513852700, "creation_date": 1513826438, "last_edit_date": 1513852700, "question_id": 47917436, "link": "https://stackoverflow.com/questions/47917436/could-you-trace-how-this-haskell-foldl-lambda-function-is-working", "title": "Could you trace how this Haskell foldl lambda function is working?", "body": "<pre><code>myReverse :: [a] -&gt; [a]\nmyReverse = foldl (\\a x -&gt; x:a) []\n\nfoldl is (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a\n</code></pre>\n\n<p>The lambda function is obviously in the brackets. Where does <code>foldl</code> get its initial value from?  And what is <code>[b]</code> in this case?</p>\n"}, {"tags": ["haskell", "integration-testing", "yesod", "yesod-test"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1513886247, "post_id": 47916409, "comment_id": 82832801, "body": "I think you have the wrong signature for the <code>spec</code> value. Check out the yesod scaffolding (<code>stack new foo yesod-simple</code>) for a working example."}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 0, "last_activity_date": 1514036205, "creation_date": 1514036205, "answer_id": 47952961, "question_id": 47916409, "link": "https://stackoverflow.com/questions/47916409/how-is-ydescribe-from-yesod-test-used/47952961#47952961", "title": "How is ydescribe from Yesod.Test used?", "body": "<p>Found out I have to use yesodSpec as well and pass ydescribe as the second parameter.</p>\n\n<p>Here is a usage example.</p>\n\n<pre><code>spec :: Spec\nspec = do\n    settings &lt;-\n        runIO $ loadYamlSettings\n            [\"config/test-settings.yml\", \"config/settings.yml\"]\n            []\n            useEnv\n    foundation &lt;- runIO $ makeFoundation settings\n    yesodSpec foundation $ do\n        ydescribe \"Tests\" $ do\n            yit \"Test\" $ do\n               -- Test something\n</code></pre>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 47952961, "answer_count": 1, "score": 1, "last_activity_date": 1514036205, "creation_date": 1513817650, "question_id": 47916409, "link": "https://stackoverflow.com/questions/47916409/how-is-ydescribe-from-yesod-test-used", "title": "How is ydescribe from Yesod.Test used?", "body": "<p>I am trying to write tests where one test signs in and then the following tests use the cookie set from the first sign in test.</p>\n\n<p>From what I can see, this is done with <code>ydescribe</code> </p>\n\n<blockquote>\n  <p>Start describing a Tests suite keeping cookies and a reference to the tested Application and ConnectionPool</p>\n</blockquote>\n\n<p>I attempted to use this in my app by looking at some examples from github repos but had no luck.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>module Handler.PostSpec ( spec ) where\n\nimport TestImport hiding (postBody)\nimport Data.Aeson\nimport Yesod.Test\n\nspec :: Spec\nspec =\n    ydescribe \"Auth\" $ do\n        yit \"logs in to dummy auth\" $ do\n            request $ do\n                addPostParam \"ident\" \"0\"\n                setMethod \"POST\"\n                setUrl (\"http://localhost:3000/auth/page/dummy\" :: Text)\n            statusIs 303\n</code></pre>\n\n<p>When compiled this gives the error:</p>\n\n<pre><code>test/Handler/PostSpec.hs:9:5: error:\n    \u2022 Couldn't match type \u2018transformers-0.5.2.0:Control.Monad.Trans.Writer.Lazy.WriterT\n                             [YesodSpecTree site0] Identity ()\u2019\n                     with \u2018hspec-core-2.4.4:Test.Hspec.Core.Spec.Monad.SpecM () ()\u2019\n      Expected type: Spec\n        Actual type: YesodSpec site0\n    \u2022 In the expression:\n        ydescribe \"Auth\"\n        $ do { yit \"logs in to dummy auth\"\n               $ do { request $ do { ... };\n                      statusIs 303 } }\n\n      In an equation for \u2018spec\u2019:\n          spec\n            = ydescribe \"Auth\"\n              $ do { yit \"logs in to dummy auth\"\n                     $ do { request $ ...;\n                            .... } }\n</code></pre>\n\n<p>What would be the correct way to use ydescribe?</p>\n"}]