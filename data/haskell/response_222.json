[{"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554921563, "post_id": 55619179, "comment_id": 97931729, "body": "I&#39;m not sure how fundamental it can be if it&#39;s missing. Presumably, nobody has ever seen a need for it. Voting to close as primarily opinion-based."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554921856, "post_id": 55619179, "comment_id": 97931883, "body": "@chepner Not the operator or this question are fundamental. The part of Haskell that this question relates to is fundamental, namely the Monad! If you don&#39;t know the answer to the question don&#39;t answer. I did not express my opinion, but listed all of the facts that I could find on this topic."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1554924034, "post_id": 55619179, "comment_id": 97932842, "body": "@BobDalgleish I can&#39;t believe that &quot;No good reason&quot; is the best that Haskell community and stackoverflow can do. With regards to the solution proposed in the duplicate question, I go into the details why it is not the same to use <code>&lt;*</code> vs <code>&lt;&lt;</code>"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1554924810, "post_id": 55619179, "comment_id": 97933159, "body": "This does seem like an odd oversight, but then again, there are a lot of odd oversights in prelude. Some of them are just mistakes, others probably &quot;seemed like a good idea at the time&quot;, and others have an actual historical reason for existing. I&#39;d be interested to see which category this falls into, though it&#39;s probably just a mistake."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1554924920, "post_id": 55619179, "comment_id": 97933203, "body": "That is precisely the point for this question. If it is indeed an oversight, I will be happy to submit a PR to <code>base</code> with this operator, but I want to get some discussion from the community first."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1554925047, "post_id": 55619179, "comment_id": 97933257, "body": "The community you want to have this discussion with is <i>precisely</i> the people who will approve or reject such a pull request. They&#39;ll tell you &quot;Yes, that was an oversight, thanks for the patch&quot; or &quot;No thanks, because ...&quot;. Nothing we say or speculate about here is going to affect that."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554925920, "post_id": 55619179, "comment_id": 97933674, "body": "@chepner Community is the people who use Haskell, not the ones who maintain ghc. The latter do have the ultimate decision, but it will be driven by the community. Is it not the same in bash scripting? :D"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1554928611, "post_id": 55619179, "comment_id": 97934831, "body": "&quot;I don&#39;t like the answer&quot; doesn&#39;t mean the answer is incorrect..."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554933440, "post_id": 55619179, "comment_id": 97936718, "body": "@DanielWagner, I disagree with the answer and believe that it is incorrect to think of <code>&lt;*</code> as <code>&lt;&lt;</code>. The fact that you like the answer, doesn&#39;t make it correct either. But thank you for the discussion. That is exactly what I was trying to get out of everyone."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1554937383, "post_id": 55619179, "comment_id": 97937844, "body": "@lehins Why do you believe this is incorrect? All <code>Monad</code> instances are required by the type system to have an <code>Applicative</code> instance. This instance is also supposed to satisfy the law <code>(*&gt;) = (&gt;&gt;)</code> as <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">stated in the documentation</a>, therefore <code>(&lt;*) = flip (*&gt;) = flip (&gt;&gt;)</code> which is the same as the proposed <code>(&lt;&lt;)</code>. What is the difference?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1554938348, "post_id": 55619179, "comment_id": 97938074, "body": "@David Note that <code>(&lt;*)</code> is not <code>flip (*&gt;)</code>; rather, <code>flip (&lt;*)</code> is what lehins would like to have as <code>(&lt;&lt;)</code>. See <a href=\"https://stackoverflow.com/a/55620742/2751851\">K. A. Buhr&#39;s answer to the target question</a> for extra commentary on that point."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554939423, "post_id": 55619179, "comment_id": 97938326, "body": "Thanks @duplode  @David If you look closely you will see that <code>(&lt;*)</code> is not the same as <code>flip (&gt;&gt;)</code>. Not only because of precedence, but also because of the order of evaluation. There is a law clearly stating that <code>(*&gt;)</code> should be equal to <code>(&gt;&gt;)</code>, nothing says that there is such a law for the the right to left operator, so there is no such constraint for <code>(&lt;*)</code> to be equivalent to <code>(&lt;&lt;)</code>. Moreover, <code>m &gt;&gt; k = m &gt;&gt;= (\\_ -&gt; k)</code>, so it only makes sense to have <code>k &lt;&lt; m = (\\_ -&gt; k) =&lt;&lt; m</code>, or simply <code>(&lt;&lt;) = flip (&gt;&gt;)</code>, Applicative has nothing to do with the latter definitions, in my opinion."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1554939598, "post_id": 55619179, "comment_id": 97938368, "body": "(Correcting a silly typo: in my comment above, I meant to write &quot;[...] rather, <code>flip (*&gt;)</code> is what lehins [...]&quot;.)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1554941515, "post_id": 55619179, "comment_id": 97938766, "body": "Ah, right. I forgot to take that aspect into account."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1554969426, "post_id": 55619179, "comment_id": 97946606, "body": "This is a good proposal, I see no reason not to add this operator."}], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "closed_date": 1554925611, "answer_count": 0, "score": 3, "last_activity_date": 1554924569, "creation_date": 1554921094, "last_edit_date": 1554924569, "question_id": 55619179, "link": "https://stackoverflow.com/questions/55619179/the-missing-operator", "closed_reason": "Duplicate", "title": "The missing &lt;&lt; operator", "body": "<p>Today I want to compile the list of different, but related operators available today in <code>base</code> and ask why this one is missing: <code>(&lt;&lt;)</code>? I apologize for the long preamble, but it is a question about a pretty fundamental part of Haskell which I can't find an answer to.</p>\n\n<p><strong>Edit</strong> @Bob Dalgleish thank you for pointing this out. There seems to be already a question like this one: <a href=\"https://stackoverflow.com/questions/14176667/why-is-there-no-in-the-haskell-standard-library\">Why is there no &lt;&lt; in the Haskell standard library?</a> That's great, since that means I am not the only one wondering about this. Nevertheless, the accepted answer to that question was \"no good reason\", which IMHO is not satisfactory. Also that same answer notes that <code>&lt;*</code> can be used instead, which is incorrect since they have different semantics. Read below for more details.</p>\n\n<p>I am not gonna go into details on what exactly each operator does, and what it can be used for, but I'll list their type signatures and infix precedence as well as associativity: </p>\n\n<h1>Application</h1>\n\n<h2>Function</h2>\n\n<ul>\n<li>Application: <code>($) :: (a -&gt; b) -&gt; a -&gt; b</code> (<code>infixr 0</code>)</li>\n<li>Flipped application: <code>(&amp;) :: a -&gt; (a -&gt; b) -&gt; b</code> (<code>infixl 1</code>)</li>\n</ul>\n\n<h2>Functor</h2>\n\n<ul>\n<li>fmap: <code>(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code> (<code>infixl 4</code>)</li>\n<li>Flipped fmap: <code>(&lt;&amp;&gt;) :: Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b</code> (<code>infixl 1</code>)</li>\n<li>Discard left: <code>($&gt;) :: Functor f =&gt; f a -&gt; b -&gt; f b</code> (<code>infixl 4</code>)</li>\n<li>Discard right: <code>(&lt;$) :: Functor f =&gt; a -&gt; f b -&gt; f a</code> (<code>infixl 4</code>)</li>\n</ul>\n\n<h2>Aplicative</h2>\n\n<ul>\n<li>App: <code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code> (<code>infixl 4 &lt;*&gt;</code>)</li>\n<li>Flipped App: <code>(&lt;**&gt;) :: Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b</code> (<code>infixl 4 &lt;**&gt;</code>)</li>\n<li>Discard left: <code>(*&gt;) :: Applicative f =&gt; f a -&gt; f b -&gt; f b</code> (<code>infixl 4 *&gt;</code>)</li>\n<li>Discard right: <code>(&lt;*) :: Applicative f =&gt; f a -&gt; f b -&gt; f a</code> (<code>infixl 4 &lt;*</code>)</li>\n</ul>\n\n<h2>Monad</h2>\n\n<ul>\n<li>Bind: <code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code> (<code>infixl 1 &gt;&gt;=</code>)</li>\n<li>Flipped bind: <code>(=&lt;&lt;) :: Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b</code> (<code>infixr 1 =&lt;&lt;</code>)</li>\n<li>Discard left: <code>(&gt;&gt;) :: Monad m =&gt; m a -&gt; m b -&gt; m b</code> (<code>infixl 1 &gt;&gt;</code>)</li>\n<li><strong>Discard right is missing!</strong></li>\n</ul>\n\n<p>I'd expect to have a definition along those lines:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Just like `(&gt;&gt;)`, but with arguments flipped.\n(&lt;&lt;) :: Monad m =&gt; m b -&gt; m a -&gt; m b\nk &lt;&lt; m = const k =&lt;&lt; m\ninfixr 1 &lt;&lt;\n</code></pre>\n\n<p>Which is equivalent to both either <code>(&lt;&lt;) = flip (&gt;&gt;)</code> or <code>k &lt;&lt; m = (\\_ -&gt; k) =&lt;&lt; m</code></p>\n\n<p>Some might say: \"Why do we need <code>&lt;&lt;</code> if we can use <code>&lt;*</code>?\". But these two operators are very different:</p>\n\n<ul>\n<li>They might be using different implementation, after all <code>&gt;&gt;</code> and <code>&lt;*</code> are functions of two different classes with default implementations and can be overridden.</li>\n<li>Because of difference in precedence we often can't use <code>&lt;*</code> with <code>=&lt;&lt;</code> or <code>*&gt;</code> with <code>&gt;&gt;=</code> without parenthesis:\n\n<ul>\n<li><code>pure 5 &gt;&gt;= print &gt;&gt; pure 6</code> vs <code>(pure 5 &gt;&gt;= print) *&gt; pure 6</code></li>\n</ul></li>\n<li>For <code>Applicative</code>s information always flows from left to right, while for monads it can be reversed:\n\n<ul>\n<li><code>print 5 *&gt; print 7 *&gt; print 6</code> == <code>print 5 &lt;* print 7 &lt;* print 6</code></li>\n<li><code>print 5 &gt;&gt; print 7 &gt;&gt; print 6</code> /= <code>print 5 &lt;&lt; print 7 &lt;&lt; print 6</code></li>\n</ul></li>\n</ul>\n\n<h1>Composition:</h1>\n\n<p>We are very well familiar with function composition. It has also information flowing from right to left, and doesn't compose naturally with left-to-right flow, i.e. just looks a bit awkward. It's no big deal, but I wanted to mention it anyways.</p>\n\n<ul>\n<li>Compose: <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> (<code>infixr 9 .</code>)</li>\n</ul>\n\n<p>Here are two examples with order of execution of functions (not operators)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- 4.         3.      2.            1.\n\u03bb&gt; print 8 &lt;&lt; print . succ =&lt;&lt; 6 &lt;$ print 5\n5\n7\n8\n</code></pre>\n\n<p>Note, that I'd need parenthesis if used <code>*&gt;</code> instead of <code>&gt;&gt;</code>, otherwise it wouldn't compile.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>--  1.               3.      2.       4\n\u03bb&gt; print 5 $&gt; 6 &gt;&gt;= print . succ &gt;&gt; print 8\n5\n7\n8\n</code></pre>\n\n<h1>Consistency</h1>\n\n<p>Finally, all of the operators have there opposite directions counterparts. Some of them are listed above, but there a re also:\n * Kleisli: <code>(&gt;=&gt;)</code> vs <code>(&lt;=&lt;)</code>\n * Category: <code>(&gt;&gt;&gt;)</code> vs <code>(&lt;&lt;&lt;)</code>\n * Arrows: <code>(^&gt;&gt;)</code> vs <code>(&lt;&lt;^)</code> and <code>(&gt;&gt;^)</code> vs <code>(^&lt;&lt;)</code></p>\n\n<h1>So why don't we have <code>(&lt;&lt;)</code>?</h1>\n\n<ul>\n<li>Is there some fundamental reason why it was excluded?</li>\n<li>Maybe no one really cares about this style of programming and people tend to just stick to the <code>do</code> notation?</li>\n<li>Maybe people find right-to-left flow information confusing. But that would surprise me, since function composition is like bread and butter in Haskell.</li>\n<li>It's hard to find any info on this topic, partially cause it's not easy to search special characters online, partially cause there are too many tutorials about monads :) Any link to such discussions would be appreciated.</li>\n</ul>\n\n<p>For the benefit of those googling this in the future here is the question without the operator: Why don't we have the left monadic bind operator that discard the results of the right action?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554914114, "post_id": 55616219, "comment_id": 97928103, "body": "@chepner, it seems unfortunate to mark <i>this one</i> a dupe. It&#39;s far better than the other versions I&#39;ve seen. Can we reshuffle the dupe graph edges?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8654751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b63b801572995f0f53b897cce1f55f2?s=128&d=identicon&r=PG&f=1", "display_name": "E Lonnen", "link": "https://stackoverflow.com/users/8654751/e-lonnen"}, "edited": false, "score": 0, "creation_date": 1554911088, "post_id": 55616473, "comment_id": 97926446, "body": "Thanks very much for your answer, although I&#39;m still getting an error:      parse error (possibly incorrect indentation or mismatched brackets)    | 20 | complement :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Maybe [a]    | ^"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 11, "user_id": 8654751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b63b801572995f0f53b897cce1f55f2?s=128&d=identicon&r=PG&f=1", "display_name": "E Lonnen", "link": "https://stackoverflow.com/users/8654751/e-lonnen"}, "edited": false, "score": 0, "creation_date": 1554914968, "post_id": 55616473, "comment_id": 97928561, "body": "Maybe you still have errors in the guard in <code>subset</code>, or the 3 lines of <code>complement</code> don&#39;t begin in the first column."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 1, "last_activity_date": 1554910649, "creation_date": 1554910649, "answer_id": 55616473, "question_id": 55616219, "link": "https://stackoverflow.com/questions/55616219/i-need-to-write-a-function-which-returns-the-compliment-of-asupplied-with-resp/55616473#55616473", "title": "I need to write a function which returns the compliment of A(supplied) with respect to U(universal set also entered by user)", "body": "<p>It looks as though you are trying to write a pattern guard, but left out the <code>|</code>.  Try:  </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>complement :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Maybe [a]\ncomplement [] ys = Just ys\ncomplement xs ys\n  | subset xs ys = Just (filter (not.(`elem`xs))ys)\n  | otherwise = Nothing\n</code></pre>\n\n<p>There are similar issues in <code>subset</code>.  There are a couple other indentation issues, though maybe those were introduced pasting into SO.</p>\n"}], "owner": {"reputation": 11, "user_id": 8654751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b63b801572995f0f53b897cce1f55f2?s=128&d=identicon&r=PG&f=1", "display_name": "E Lonnen", "link": "https://stackoverflow.com/users/8654751/e-lonnen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1554910995, "answer_count": 1, "score": 0, "last_activity_date": 1554919751, "creation_date": 1554909850, "last_edit_date": 1554919751, "question_id": 55616219, "link": "https://stackoverflow.com/questions/55616219/i-need-to-write-a-function-which-returns-the-compliment-of-asupplied-with-resp", "closed_reason": "Duplicate", "title": "I need to write a function which returns the compliment of A(supplied) with respect to U(universal set also entered by user)", "body": "<p>I don't believe I am allowed to use any non standard libraries.</p>\n\n<p>I've tried messing about with indenting like tabs and spaces, however I am a Haskell novice so it is very likely I have missed something.</p>\n\n<pre><code>subset :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool\nsubset [] ys = True\nsubset (x:xs) ys\n elem x ys = subset xs ys\n let otherwise = False\n\ncomplement :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Maybe [a]\n complement [] ys = Just ys\n complement xs ys\n  subset xs ys = Just (filter (not.(`elem`xs))ys)\n      otherwise = Nothing\n</code></pre>\n\n<p>Expected result with entered data([1,2,3] [1..5]) = Just [4,5]</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554904554, "post_id": 55614297, "comment_id": 97922532, "body": "We can&#39;t help you understand what went wrong with your attempt if you won&#39;t show us your attempt. So include the code you think ought to work but doesn&#39;t, along with the error message you get."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1554905619, "post_id": 55614297, "comment_id": 97923175, "body": "In <code>Leaf y</code> you are <a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching\" rel=\"nofollow noreferrer\">pattern matching</a> the <code>Leaf a</code> constructor. Valid matches for your <code>Node [Tree a]</code> constructor are: <code>Node _</code>, <code>Node []</code>, <code>Node [x]</code> (or <code>Node (x:[])</code>), <code>Node [x,y]</code> (or <code>Node (x:y:[])</code>), and so on."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554917366, "post_id": 55614297, "comment_id": 97929729, "body": "What is the definition of <code>example4</code>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554905281, "post_id": 55614400, "comment_id": 97922991, "body": "So you can name it whatever you&#39;d like and it just represents the list. But one final question: how do I create an example to test.        <code>example :: Tree a       example = Node [(Leaf 1) (Leaf 7) (Leaf 8)]</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554905589, "post_id": 55614400, "comment_id": 97923158, "body": "that looks fine, although the type is <code>Tree a Int</code> (any numeric type would do in place of <code>Int</code>, but it doesn&#39;t actually matter)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554905617, "post_id": 55614400, "comment_id": 97923173, "body": "Also, what do you mean I can implement <code>any</code> if I wanted. Could it be defined instead of calling the library function?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554906075, "post_id": 55614400, "comment_id": 97923467, "body": "Yes, all I was trying to say that it isn&#39;t some &quot;magical&quot; function provided for us by the standard library - like most library functions, it&#39;s there for convenience but could easily be implemented in a few lines of Haskell if you needed to. Since it is provided for us, then you never need to actually write it yourself, except as an exercise."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554906283, "post_id": 55614400, "comment_id": 97923572, "body": "Could you please show me? It would be extremely helpful to understand the function. Thank you so much for helping me btw! The answer was obvious once I saw it but writing examples to test it caused me some time."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554906648, "post_id": 55614400, "comment_id": 97923787, "body": "there&#39;s not space in a comment to do it, certainly not to lay it out properly - but I would strongly encourage you to try it out yourself, but here are some large hints. It&#39;s a very simple recursive function: the base case is <code>any p [] = False</code>, the recursive case is <code>any p (x:xs)</code>, you need to test if <code>p x</code> is true or false and give the appropriate result (one involves a recursive call to <code>any p xs</code>, the other can give an answer straightaway)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554914397, "post_id": 55614400, "comment_id": 97928240, "body": "I created a function to match it but it doesn&#39;t work in the actual function where <code>any</code> was used.   <code>helper p [] = False helper p (x:xs)   | p == x    = True   | otherwise = helper p xs</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554914519, "post_id": 55614400, "comment_id": 97928308, "body": "No, it won&#39;t. Think about it logically. You want to tell if any element in the list satisfies <code>p</code>. So you test <code>p</code> against the first element: if it passes, do you need to examine the rest of the list? If it fails, do you want to give an immediate answer of &quot;no&quot;? That&#39;s what your function above does."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554915227, "post_id": 55614400, "comment_id": 97928666, "body": "So I wrote this new one and it compiles but when I test it by example it gives me an error. The code: <code>helper p []   = False helper p (x : xs)   | p x       = True   | otherwise = helper p xs</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554916888, "post_id": 55614400, "comment_id": 97929488, "body": "<code>* No instance for (Eq (Tree2 Int)) arising from a use of </code>occs * In the expression: occs example5`       <code>In an equation for </code>it: it = occs example5`"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554917213, "post_id": 55614400, "comment_id": 97929648, "body": "I put the full code up. It won&#39;t test an example but it compiles. I&#39;m not sure what the error message above means."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1554919212, "post_id": 55614400, "comment_id": 97930608, "body": "@Drake From your error, it looks like you have an <code>example5</code> which I assume is a tree, and you&#39;re calling <code>occs example5</code> to run the test. But <code>occs</code> takes two arguments, not one. It should be e.g. <code>occs 7 example5</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1554919316, "post_id": 55614400, "comment_id": 97930662, "body": "DUHHHHH! I&#39;m such an idiot, you&#39;re totally right. I&#39;ve been focused on the code so much I forgot what it was doing. Thank you all so much, you&#39;ve all been amazing"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 3, "last_activity_date": 1554904859, "last_edit_date": 1554904859, "creation_date": 1554904551, "answer_id": 55614400, "question_id": 55614297, "link": "https://stackoverflow.com/questions/55614297/traversing-data-type-with-recursive-binary-tree-list-in-function/55614400#55614400", "title": "Traversing Data Type with Recursive Binary Tree List in Function", "body": "<p>You just want to recursively check if any of the branches (that's what I'm calling the trees in the list) contains <code>x</code>. Luckily the Prelude includes a function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:any\" rel=\"nofollow noreferrer\">any</a> to make this very easy:</p>\n\n<pre><code>occs :: Eq a =&gt; a -&gt; Tree a -&gt; Bool \noccs x (Leaf y) = x == y\noccs x (Node branches) = any (occs x) branches\n</code></pre>\n\n<p>(<code>any</code> is also very easy to implement oneself if you wanted to)</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1554925910, "post_id": 55618340, "comment_id": 97933670, "body": "Writing Foldable instances by hand gets tiresome quickly. Instead, derive them with DeriveFoldable."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1554959157, "last_edit_date": 1554959157, "creation_date": 1554917543, "answer_id": 55618340, "question_id": 55614297, "link": "https://stackoverflow.com/questions/55614297/traversing-data-type-with-recursive-binary-tree-list-in-function/55618340#55618340", "title": "Traversing Data Type with Recursive Binary Tree List in Function", "body": "<p>Since Robin Zigmond gave an answer to your question, \"How can you write a listed tree <code>[Tree a]</code> as a variable to manipulate?\", I'll try to answer differently.</p>\n\n<blockquote>\n  <p>I created a recursive binary tree where there can be unlimited children:</p>\n\n<pre><code>data Tree a = [...]\n</code></pre>\n</blockquote>\n\n<p>Then it isn't binary but <em>n</em>-ary.</p>\n\n<p>This exact type already exists in the <code>containers</code> package under the <a href=\"http://hackage.haskell.org/package/containers/docs/Data-Tree.html\" rel=\"nofollow noreferrer\"><code>Data.Tree</code></a> module.</p>\n\n<p><code>Data.Tree</code> has a bunch of type class instances defined for it, and one of those is <a href=\"http://hackage.haskell.org/package/base/docs/Data-Foldable.html#t:Foldable\" rel=\"nofollow noreferrer\"><code>Foldable</code></a>, and the function you're writing is already in <code>Data.Foldable</code> under the name <a href=\"http://hackage.haskell.org/package/base/docs/Data-Foldable.html#v:elem\" rel=\"nofollow noreferrer\"><code>elem</code></a> and has the type: </p>\n\n<pre><code>elem :: (Eq a, Foldable t) =&gt; a -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>So if your choice of data type is an <em>n</em>-ary tree, <code>Data.Tree</code> and <code>elem</code> would be the right choices.</p>\n\n<hr>\n\n<p>If, on the other hand, an actual binary tree with two child nodes is what you're after, defining this and making it an instance of <code>Foldable</code> would give you <code>elem</code> in the same way:</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\n\ndata BinaryTree a\n  = Leaf\n  | Node a (BinaryTree a) (BinaryTree a)\n  deriving (Foldable)\n\n-- now `elem` comes for free\n</code></pre>\n\n<p><strong>Edit:</strong> Following amalloy's suggestion, the <code>Foldable</code> instance was derived instead.</p>\n\n<p>But because <code>elem</code> is only constrained with <code>Eq a</code> and not <code>Ord a</code>, you cannot get <em>O(log n)</em> lookups as you would be able to for a binary <em>search</em> tree, so you'd have to call it something else if you wanted that:</p>\n\n<pre><code>occs :: Ord a =&gt; a -&gt; BinaryTree a -&gt; Bool\noccs _ Leaf = False\noccs x (Node y left right) =\n  case x `compare` y of\n    LT -&gt; occs x left\n    EQ -&gt; True\n    GT -&gt; occs x right\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 55614400, "answer_count": 2, "score": 1, "last_activity_date": 1554959157, "creation_date": 1554904267, "last_edit_date": 1554919236, "question_id": 55614297, "link": "https://stackoverflow.com/questions/55614297/traversing-data-type-with-recursive-binary-tree-list-in-function", "title": "Traversing Data Type with Recursive Binary Tree List in Function", "body": "<p>I created a recursive binary tree where there can be unlimited children:</p>\n\n<pre><code>data Tree a = Leaf a\n            | Node [Tree a]\n</code></pre>\n\n<p>My issue is in the syntax during the creation of a function in order to traverse the tree.</p>\n\n<p>Say I want to do something easy, like give an argument 1 and then find out <code>Bool</code> if 1 occurs within the tree. I'm having issue with the function definition when the <code>Node</code> is <code>[Tree a]</code> instead of <code>Node [Leaf root Leaf]</code>. I'm not used to the function calling a list in the variable.</p>\n\n<p>Here's how it would work with a simpler recursive data type:</p>\n\n<pre><code>occs :: Eq a =&gt; a -&gt; Tree a -&gt; Bool \noccs x (Leaf y) = x == y\noccs x (Node left y right) = x == y || occs x left || occs x right\n</code></pre>\n\n<p>However, <code>(Node left y right)</code> are no longer proper because <code>Node</code> is now a listed tree <code>[Tree a]</code>. How can you write a listed tree <code>[Tree a]</code> as a variable to manipulate?</p>\n\n<p>The expected results would be <code>True</code> or <code>False</code> if it appears but the issue is mainly in the syntax of identifying a listed <code>[Tree a]</code> in the function. I've tried multiple ways of writing it and it always comes back error.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1554901858, "post_id": 55606126, "comment_id": 97920764, "body": "For <code>Array</code>, you can avoid a lot of list allocation using <code>ixmap</code>, as in <code>transpose arr = ixmap (swap lo, swap hi) swap arr where swap (r,c) = (c,r); (lo, hi) = bounds arr</code>."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 4, "last_activity_date": 1554923153, "last_edit_date": 1554923153, "creation_date": 1554878084, "answer_id": 55606126, "question_id": 55605249, "link": "https://stackoverflow.com/questions/55605249/how-to-transpose-a-2d-vector/55606126#55606126", "title": "How to transpose a 2D vector", "body": "<p><code>Array</code> and <code>Vector</code> have similar internal representations, but the API of <code>Array</code> is designed for indexing operations (through the <code>Ix</code> class) while <code>Vector</code> has a more list-like interface and relies on fusion to combine these operations efficiently. Both allow O(1) random access.</p>\n\n<p>As an aside, <code>Array</code> is available in <code>base</code> while <code>Vector</code> is defined the <code>vector</code> package, so you can use <code>Array</code> if you wish to avoid an additional dependency.</p>\n\n<p>In either case, transposition can be implemented in terms of indices. It\u2019s perhaps slightly more natural using <code>Array</code>, which can be indexed by a pair to make a 2D array that\u2019s guaranteed to be rectangular:</p>\n\n<pre><code>import Data.Array (Array, (!))\nimport qualified Data.Array as Array\n\nexample1 :: Array (Int, Int) Char\nexample1 = Array.array ((0, 0), (1, 1))\n  [ ((0, 0), 'a'), ((0, 1), 'b')\n  , ((1, 0), 'c'), ((1, 1), 'd')\n  ]\n\nexample2 :: Array (Int, Int) Int\nexample2 = Array.listArray ((0, 0), (2, 2))\n  [ 1, 2, 3\n  , 4, 5, 6\n  , 7, 8, 9\n  ]\n\ntranspose :: Array (Int, Int) a -&gt; Array (Int, Int) a\ntranspose a = Array.array bounds\n  [ ((row, col), a ! (col, row))\n  | row &lt;- [minRow .. maxRow]\n  , col &lt;- [minCol .. maxCol]\n  ]\n  where\n    -- Note that indices need not be 0-based.\n    bounds@((minRow, minCol), (maxRow, maxCol)) = Array.bounds a\n\ntranspose example1 == Array.array ((0, 0), (1, 1))\n  [ ((0, 0), 'a'), ((0, 1), 'c')\n  , ((1, 0), 'b'), ((1, 1), 'd')\n  ]\n\nArray.elems (transpose example2) ==\n  [ 1, 4, 7\n  , 2, 5, 8\n  , 3, 6, 9\n  ]\n</code></pre>\n\n<p>For <code>Vector</code>, you will just need to index twice:</p>\n\n<pre><code>import Data.Vector (Vector, (!))\nimport qualified Data.Vector as Vector\n\n-- Does not handle non-square arrays, nor\n-- those with an outer dimension of zero.\ntranspose :: Vector (Vector a) -&gt; Vector (Vector a)\ntranspose v = Vector.fromList\n  [ Vector.fromList\n    [ v ! col ! row\n    | col &lt;- [0 .. maxCol]\n    ]\n  | row &lt;- [0 .. maxRow]\n  ]\n  where\n    maxRow = Vector.length v - 1\n    maxCol = Vector.length (v ! 0) - 1\n</code></pre>\n\n<p>Note that there is no guarantee that <code>Vector (Vector a)</code> is not a \u201cjagged\u201d 2D array, in which the inner vectors are of different lengths, like so:</p>\n\n<pre><code>fromList\n  [ fromList ['a', 'b']\n  , fromList ['c']\n  ]\n</code></pre>\n\n<p>This just means that you need to check that the input is well-formed. In addition, <code>Vector (Vector a)</code> is not contiguous in memory: it\u2019s an array of pointers to vectors of elements, while an <code>Array (Int, Int) a</code> is a single block of memory, so <code>Vector</code> imposes a constant overhead with this representation. In case performance is a concern, you can remove this indirection by using a <code>Vector a</code> of length <code>rows * cols</code> and indexing it manually as <code>row * cols + col</code>; this is essentially what <code>Array</code> does internally via <code>Ix</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 0, "last_activity_date": 1554922626, "creation_date": 1554922626, "answer_id": 55619559, "question_id": 55605249, "link": "https://stackoverflow.com/questions/55605249/how-to-transpose-a-2d-vector/55619559#55619559", "title": "How to transpose a 2D vector", "body": "<p>If you are working with flat vectors, than sticking to <code>vector</code> package might be a good idea. But if you do need more than 1 dimension, I suggest you use a library that deals with arrays. I am the author of <a href=\"https://github.com/lehins/massiv\" rel=\"nofollow noreferrer\"><code>massiv</code></a>, as such I am a bit biased, but that is the library I'd recommend. I would definitely advise you against <code>array</code> library, despite it being wired in with ghc, its interface is very limited and a bit confusing.</p>\n\n<p>For example if you'd like to transpose a 2d matrix with <code>massiv</code> you would do this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; arr &lt;- resizeM (Sz2 3 3) (1 ... 9)\n\u03bb&gt; arr\nArray D Seq (Sz (3 :. 3))\n  [ [ 1, 2, 3 ]\n  , [ 4, 5, 6 ]\n  , [ 7, 8, 9 ]\n  ]\n\u03bb&gt; let arrUnboxed = computeAs U $ transpose arr\n\u03bb&gt; arrUnboxed\nArray U Seq (Sz (3 :. 3))\n  [ [ 1, 4, 7 ]\n  , [ 2, 5, 8 ]\n  , [ 3, 6, 9 ]\n  ]\n\u03bb&gt; arrUnboxed ! (2 :. 1)\n6\n</code></pre>\n\n<p>Note that until you call <code>compute</code> no memory allocation has happened, but you can only index it in O(1) once you compute it. Also if you apply <code>setComp Par arr</code>, this whole manipulation will be automatically parallelized for you.</p>\n\n<p>There are lot more examples in the documentation if you need to get started with it.</p>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 55606126, "answer_count": 2, "score": 5, "last_activity_date": 1554923153, "creation_date": 1554873919, "last_edit_date": 1554913867, "question_id": 55605249, "link": "https://stackoverflow.com/questions/55605249/how-to-transpose-a-2d-vector", "title": "How to transpose a 2D vector", "body": "<p>How to represent a 2d array integers in Haskell so that I can access any element with (i, j) in O(1) or O(logN)?</p>\n\n<p>What's the difference between defining with Data.Array and Data.Vector? Which one is more practical</p>\n\n<pre><code>data Matrix = Vector (Vector Int)\n</code></pre>\n\n<p>If I define as the above, how to make a function that transposes this Matrix?</p>\n\n<p>For instance: transposing a <code>[[1,2,3],[4,5,6],[7,8,9]]</code> would return <code>[[1,4,7],[2,5,8],[3,6,9]]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554847330, "post_id": 55601821, "comment_id": 97899712, "body": "If you really, truly need this to be I/O, you could maybe implement this in C with the FFI?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 3, "creation_date": 1554848483, "post_id": 55601821, "comment_id": 97900046, "body": "&quot;EDIT: It looks like Data.UUID provides this via <code>generatedNamed</code>.&quot; Careful. The one you linked is UUID v5, which means the number is based on the inputs you give it. It will only give you unique results if you give it unique namespace and/or object parameters each time. I don&#39;t think that&#39;s what you want. If you want to use UUID, try <a href=\"http://hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID-V1.html\" rel=\"nofollow noreferrer\">UUID v1</a>, which uses your MAC address and a timestamp. Or just use the <a href=\"http://hackage.haskell.org/package/time\" rel=\"nofollow noreferrer\">time</a> package to get an actual timestamp."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1554848988, "creation_date": 1554848988, "answer_id": 55602213, "question_id": 55601821, "link": "https://stackoverflow.com/questions/55601821/generate-unique-values-each-time-a-function-is-called/55602213#55602213", "title": "Generate Unique Values Each Time A Function Is Called?", "body": "<p>The <code>base</code> package offers <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Unique.html#v:newUnique\" rel=\"noreferrer\"><code>newUnique</code></a> for this purpose. (N.B. these values will be unique within a single program run, but not necessarily across runs.)</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554852081, "post_id": 55602305, "comment_id": 97900839, "body": "But why roll your own when it already comes standard with the compiler?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1554854216, "post_id": 55602305, "comment_id": 97901342, "body": "@DanielWagner: If indeed the <i>only</i> property that matters is that the value is unique, then <code>Data.Unique</code> is perfectly fine. (Heck, even <code>IORef ()</code> would work for that.) If you want to <code>Show</code>, serialise, or otherwise manipulate the identifier, you need an implementation that exposes those capabilities."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 5, "last_activity_date": 1555096622, "last_edit_date": 1555096622, "creation_date": 1554849675, "answer_id": 55602305, "question_id": 55601821, "link": "https://stackoverflow.com/questions/55601821/generate-unique-values-each-time-a-function-is-called/55602305#55602305", "title": "Generate Unique Values Each Time A Function Is Called?", "body": "<p>I would probably solve this using <code>State Integer</code> at first\u2014or if the code is already in <code>IO</code>, then by writing a wrapper for <code>ReaderT (IORef Integer) IO</code>. It\u2019s easier to understand code that makes it explicit which functions can access and modify the value, compared to a global counter.</p>\n\n<p>However, if all else fails and you really do want it to be program-global, the usual <em>unsafe</em> way to do it in GHC Haskell is:</p>\n\n<pre><code>import Data.IORef\nimport System.IO.Unsafe (unsafePerformIO)\n\n-- A global mutable counter\n-- The NOINLINE is critical to ensure the counter is unique\ncounter :: IORef Integer\ncounter = unsafePerformIO (newIORef 0)\n{-# NOINLINE counter #-}\n\n-- Atomically increment the counter and return its current value\nnext :: IO Integer\nnext = atomicModifyIORef' counter (\\ x -&gt; (x + 1, x)) \n</code></pre>\n\n<p><code>Data.Unique</code> in <code>base</code> uses this implementation under the hood, but does not provide access to the underlying integer. There are also various packages on Hackage providing similar unique ID generation\u2014GUIDs, UUIDs, &amp;c.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 55602213, "answer_count": 2, "score": 4, "last_activity_date": 1555096622, "creation_date": 1554846481, "last_edit_date": 1554877760, "question_id": 55601821, "link": "https://stackoverflow.com/questions/55601821/generate-unique-values-each-time-a-function-is-called", "title": "Generate Unique Values Each Time A Function Is Called?", "body": "<p>How do I make a Haskell function which generates a unique value every time it's called over the course of a program?</p>\n\n<p>One idea is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>incrementInteger :: IO (Integer)\nincrementInteger = -- ...\n</code></pre>\n\n<p>such that it increments each time it is called over the course of the program (no matter which thread it's called from, etc).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>incrementIngeter\n=&gt; 0\n\nincrementInteger\n=&gt; 1\n\nincrementInteger\n=&gt; 2\n</code></pre>\n\n<p>That said, the only property I care about for this function \"no matter what, the value is unique each time it is called\".  How to do this?</p>\n\n<p><strong>EDIT:</strong> It looks like <a href=\"http://hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID-V5.html\" rel=\"nofollow noreferrer\">Data.UUID</a> provides this via <code>generatedNamed</code>.</p>\n"}, {"tags": ["haskell", "functional-programming", "tuples"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554843065, "post_id": 55601040, "comment_id": 97898168, "body": "Are you sure you want <code>getAverage</code> to take an <code>Int</code>? Looks like the type should be <code>Student -&gt; String</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554843559, "post_id": 55601040, "comment_id": 97898350, "body": "Type aliases must start with a capital letter, just like any other type. <code>type Subject = String</code>, etc."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554843667, "post_id": 55601040, "comment_id": 97898391, "body": "<code>student</code> should probably be a list <code>[Student]</code> (or possibly even a map <code>Data.Map.Map Int Student</code>) rather than a function of type <code>Int -&gt; Student</code>."}, {"owner": {"reputation": 13, "user_id": 10443257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1647110035344516/picture?type=large", "display_name": "Rafael Claumann Bernardes", "link": "https://stackoverflow.com/users/10443257/rafael-claumann-bernardes"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554843705, "post_id": 55601040, "comment_id": 97898406, "body": "@chepner yess, thank you for notifying. I had to translate this code and I ended up forgetting this one."}], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 4, "last_activity_date": 1554843518, "last_edit_date": 1554843518, "creation_date": 1554843111, "answer_id": 55601166, "question_id": 55601040, "link": "https://stackoverflow.com/questions/55601040/retrieve-tuple-and-operate-over-nth-elements/55601166#55601166", "title": "retrieve tuple and operate over nth element(s)", "body": "<p>You can pattern match on the result of calling <code>student</code> with the given ID number, and then get the average of the terms you care about.</p>\n\n<pre><code>getAverage :: Int -&gt; Float\ngetAverage studentId = (a + b + c) / 3\n  where (_, _, a, b, c) = student studentId\n</code></pre>\n\n<p>The danger is that the <code>student</code> function is not total. Evaluating <code>student 2</code> would currently crash the program.</p>\n"}], "owner": {"reputation": 13, "user_id": 10443257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1647110035344516/picture?type=large", "display_name": "Rafael Claumann Bernardes", "link": "https://stackoverflow.com/users/10443257/rafael-claumann-bernardes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 55601166, "answer_count": 1, "score": 0, "last_activity_date": 1554844003, "creation_date": 1554842549, "last_edit_date": 1554844003, "question_id": 55601040, "link": "https://stackoverflow.com/questions/55601040/retrieve-tuple-and-operate-over-nth-elements", "title": "retrieve tuple and operate over nth element(s)", "body": "<p>I have a type defined and elements of this type. This elements have tuples and i need to take 3 items of this tuples and get an average over them.</p>\n\n<pre><code>type Name = String\ntype Subject = String\ntype Grade = Float\n\n-- Definition of a type\ntype Student = (Name, Subject, Grade, Grade, Grade)\n\n-- Elements of this type\nstudent :: Int -&gt; Student\nstudent 1 = (\"Rafael\", \"INE5416\", 6.0, 5.0, 8.0)\n\n-- now i need a function that can receive an Int as student ID, get this\n-- student by ID and calculate her average grade.\ngetAverage :: Int -&gt; Float\ngetAverage student x =  ((_, _, c, d, e) / 3) -- Int is to get x student\n\nmain = do\n  print (getAverage(1)) -- passing student ID--\n</code></pre>\n"}, {"tags": ["haskell", "types", "sqlite", "hdbc"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 5, "creation_date": 1554837616, "post_id": 55599058, "comment_id": 97895920, "body": "As simple as <code>convertFromSql = map fromSql</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554840251, "post_id": 55599058, "comment_id": 97896995, "body": "Although <code>fromSql :: Convertible SqlValue a =&gt; SqlValue -&gt; a</code>, the fact that you have explicitly typed <code>convertFromSql</code> as <code>[SqlValue] -&gt; [String]</code> means that <code>fromSql</code> will be specialized to <code>SqlValue -&gt; String</code> when you apply it to the input list."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554888212, "post_id": 55599058, "comment_id": 97912546, "body": "@Chepner: true, my bad considering (in this case) it is all <code>String</code>s"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1554889063, "post_id": 55599058, "comment_id": 97913086, "body": "@arrowd: does not work, since the fetched rows are presented as a list of lists. Maybe with a double mapping. Will try."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554896584, "post_id": 55599058, "comment_id": 97917481, "body": "@Madderote Yes, <code>map convertFromSql :: [[SqlValue]] -&gt; [[String]]</code>."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555324037, "post_id": 55599058, "comment_id": 98057495, "body": "@Chepner, yes, sorry. Thanks for adding that. Case closed :)"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554837576, "creation_date": 1554834401, "last_edit_date": 1554837576, "question_id": 55599058, "link": "https://stackoverflow.com/questions/55599058/haskell-more-elegant-conversion-from-sql-to-other-types", "title": "Haskell more elegant conversion from Sql to other types", "body": "<p>I have this: </p>\n\n<pre><code>import Database.HDBC.Sqlite3\nimport Database.HDBC\n</code></pre>\n\n<p>For converting fetched rows from a database I use this: </p>\n\n<pre><code>convertFromSql :: [SqlValue] -&gt; [String]\nconvertFromSql [name, address, number, postal, city, country] = \n  [cName, cAddress, cNumber, cPostal, cCity, cCountry] where \n      cName     = (fromSql name) \n      cAddress  = (fromSql address) :: String \n      cNumber   = (fromSql number) :: String \n      cPostal   = (fromSql postal) :: String \n      cCity     = (fromSql city) :: String \n      cCountry  = (fromSql country) :: String \n</code></pre>\n\n<p>All works, but can I for example <code>map</code> the <code>fromSql</code> over the list of entries fetched from <code>sql</code>? And maybe a longshot: <code>zip</code> the mapped list with a list of types, so that code like above is more terse? </p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 2, "creation_date": 1554837665, "post_id": 55598445, "comment_id": 97895942, "body": "See the standard <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:group\" rel=\"nofollow noreferrer\"><code>group</code></a> function, which does exactly this."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554839867, "post_id": 55598445, "comment_id": 97896827, "body": "How is this different from your <a href=\"https://stackoverflow.com/q/55580150/1126841\">previous question</a>?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1554840480, "post_id": 55598445, "comment_id": 97897100, "body": "Chepner is right; this is almost exactly the same as your previous question. <b>Do not post a question twice.</b>"}], "answers": [{"comments": [{"owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 1, "creation_date": 1554833595, "post_id": 55598611, "comment_id": 97894081, "body": "Thank you. Is there another way to write it so it&#39;ll look closer to what I did? for example without span and where"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1554832633, "creation_date": 1554832633, "answer_id": 55598611, "question_id": 55598445, "link": "https://stackoverflow.com/questions/55598445/haskell-beginners-level-function-implementation/55598611#55598611", "title": "Haskell beginners level function implementation", "body": "<p>The problem isn't really what you said, it's just that you only hard-coded the cases that either one or two consecutive elements are equal. Actually you want to ground together <em>an arbitrary</em> number of equal consecutives. IOW, for every element, you pop off as many following ones as are equal.</p>\n\n<p>Generally, splitting of the head-part of a list which fulfills some condition is what the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:span\" rel=\"nofollow noreferrer\"><code>span</code></a> function does. In this case, the condition it's supposed to check is <em>being equal to the element you already removed</em>. That's written thus:</p>\n\n<pre><code>f [] = []\nf (x:xs) = (x:xCopies) : f others\n where (xCopies,others) = span (==x) xs\n</code></pre>\n\n<p>Here, <code>x:xCopies</code> puts together the chunk of elements equal to <code>x</code> (with <code>x</code> itself on front), use that as the heading chunk-list of the result, and then you recurse over all the elements that remain.</p>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1554836177, "creation_date": 1554836177, "answer_id": 55599526, "question_id": 55598445, "link": "https://stackoverflow.com/questions/55598445/haskell-beginners-level-function-implementation/55599526#55599526", "title": "Haskell beginners level function implementation", "body": "<p>Your problem is that both halves of your <code>if</code> have the same structure: they cons exactly one element onto the front of the recursive call. This can't be right: sometimes you want to add an element to the front of the list, and other times you want to combine your element with what's already in the recursive call.</p>\n\n<p>Instead, you need to pattern-match on the recursive call to get the first item in the recursive result, and then prepend to <em>that</em> when the first two items match.</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [[a]]\nf [] = []\nf [x] = [[x]]\nf (x:xs@(y:_)) | x == y = (x:head):more\n               | otherwise = [x]:result\n  where result@(head:more) = f xs\n</code></pre>\n"}], "owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1554839892, "answer_count": 2, "score": -1, "last_activity_date": 1554836177, "creation_date": 1554831908, "question_id": 55598445, "link": "https://stackoverflow.com/questions/55598445/haskell-beginners-level-function-implementation", "closed_reason": "Duplicate", "title": "Haskell beginners level function implementation", "body": "<p>I am new to Haskell and am trying to write quite an easy function which gathers each repeated consecutive elements under separate sub-lists, For example:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>f [] = []\nf [3] = [[3]]\nf [1,1,1,3,2,2,1,1,1,1] = [[1,1,1],[3],[2,2],[1,1,1,1]]\n</code></pre>\n\n<p>I thought about this function:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [[a]]\nf [] = []\nf (x:[]) = [[x]]\nf (x:x':xs) = if x == x' then [[x, x']] ++ (f (xs))\n                    else [[x]] ++ (f (xs))\n</code></pre>\n\n<p>It seems to not work well since when it arrives to the last element, it wants to compare it to its consecutive, which clearly does not exist. </p>\n\n<p>I would like to receive a simple answer (beginner level) that will <strong>not</strong> be too different than mine, correcting my code will be the best.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 2, "creation_date": 1554822675, "post_id": 55595926, "comment_id": 97888584, "body": "I believe GHC is able to recognise that list is constant and only evaluate it once, however I&#39;m not an expert so I&#39;ll leave the answer to someone more competent"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 6, "creation_date": 1554823451, "post_id": 55595926, "comment_id": 97889074, "body": "<code>primes</code> isn&#39;t a function; it&#39;s a list <i>constructed</i> by lazy functions."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1554826592, "post_id": 55597133, "comment_id": 97890811, "body": "In other words, the list is memoised, no?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1554829923, "post_id": 55597133, "comment_id": 97892402, "body": "It&#39;s not memoised in the traditional sense, which is a caching of function arguments to function return values. If anything, it&#39;s more like in-lining, where a thunk gets replaced with the value the thunk evaluates to. Think <code>2:sieve [3,5..]</code> being replaced with <code>2:3:5:7:11:sieve [13,15..]</code>. The delayed call to <code>sieve</code> is gone (or rather, replaced with a different delayed call), not just memoized."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 5, "last_activity_date": 1554826502, "creation_date": 1554826502, "answer_id": 55597133, "question_id": 55595926, "link": "https://stackoverflow.com/questions/55595926/how-to-evaluate-a-lazy-list-once/55597133#55597133", "title": "How to evaluate a lazy list once?", "body": "<p>As @chepner notes in the comments, <code>primes</code> is a list, not a function.  The way Haskell works, the elements of the <code>primes</code> list are computed on an as-needed basis but once computed they are kept in memory and not recomputed over and over.</p>\n\n<p>You can see this yourself by loading your module into GHCi:</p>\n\n<pre><code>&gt; :l MyPrimes\n&gt; :set +s\n&gt; nthPrimes [100000]\n[1299721]\n(6.45 secs, 3,246,628,344 bytes)\n&gt; nthPrimes [100001]\n[1299743]\n(0.01 secs, 188,184 bytes)\n&gt;\n</code></pre>\n\n<p>Calculating the 100,000th prime takes about 6 seconds.  Once that's done, calculating the 100,001st prime takes only 0.01 seconds. </p>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 55597133, "answer_count": 1, "score": 2, "last_activity_date": 1554826502, "creation_date": 1554822402, "question_id": 55595926, "link": "https://stackoverflow.com/questions/55595926/how-to-evaluate-a-lazy-list-once", "title": "How to evaluate a lazy list once?", "body": "<p><a href=\"http://www.garrisonjensen.com/2015/05/13/haskell-programs-are-lies.html\" rel=\"nofollow noreferrer\">I referred to this post</a> to compute a function <code>nthPrimes</code> that takes \na list of n and returns a list of nth prime:</p>\n\n<pre><code>import qualified Data.Set as PQ\n\nmain :: IO ()\nmain = print $ nthPrimes ns\n  where\n    ns = [1,3,10]\n\nnthPrimes :: [Int] -&gt; [Integer]\nnthPrimes = map (primes !!)\n\nprimes :: [Integer]\nprimes = 2:sieve [3,5..]\n  where\n    sieve (x:xs) = x : sieve' xs (insertprime x xs PQ.empty)\n\n    sieve' (x:xs) table\n        | nextComposite == x = sieve' xs (adjust x table)\n        | otherwise          = x : sieve' xs (insertprime x xs table)\n      where\n        (nextComposite,_) = PQ.findMin table\n\n    adjust x table\n        | n == x    = adjust x (PQ.insert (n', ns) newPQ)\n        | otherwise = table\n      where\n        Just ((n, n':ns), newPQ) = PQ.minView table\n\n    insertprime p xs = PQ.insert (p*p, map (*p) xs)\n</code></pre>\n\n<p>So, this will print <code>[3,7,31]</code>.</p>\n\n<p>However, since the <code>primes</code> function is lazy, it will be evaluated again and again in each call to get an nth-prime, but actually, we could just evaluate all the primes once if we know the <code>n</code> has a Max limit, (for instance <code>1000</code>), because <code>primes</code> never changes, and computing <code>primes</code> is CPU and Memory heavy. </p>\n\n<p>So the question is how to force the evaluation of <code>primes</code> for the first X elements so that all the pre-evaluated elements can be reused in functions that take from it? </p>\n\n<p>I believe reusing the pre-evaluated elements will reduce the overall Memory usage, especially when <code>ns</code> is a long list, correct?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554819538, "post_id": 55594748, "comment_id": 97886589, "body": "<code>stack install package</code> does this doesn&#39;t it?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1554822480, "post_id": 55594748, "comment_id": 97888457, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39848576/load-a-new-package-in-ghci-using-stack\">Load a new package in ghci using stack</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556195818, "post_id": 55602351, "comment_id": 98360671, "body": "Can I write a package.yaml and add dependencies for the global project ?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556317563, "post_id": 55602351, "comment_id": 98411001, "body": "@luochen1990 That isn&#39;t possible, because the global project isn&#39;t a Cabal project (that is, something you can actually build), but just a Stack configuration. What you can do, if you want to keep track of the packages you want to keep around, is creating a normal Stack project, which will have a package.yaml (or, equivalently, a *.cabal file)."}, {"owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556505582, "post_id": 55602351, "comment_id": 98448947, "body": "so how to use the global project to solve my problem ? is it impossible?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556506436, "post_id": 55602351, "comment_id": 98449083, "body": "@luochen1990 I&#39;m not sure why would you need a <code>package.yaml</code> while using the global project. It seems seting an appropriate resolver in (plus any non-Stackage extra-deps you might need) would be enough. (Alternatively, there is still the Stack script possibility.)"}, {"owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556506865, "post_id": 55602351, "comment_id": 98449152, "body": "because when I run <code>stack exec ghc test.hs</code>. an error like <code>Could not find module &#39;Test.QuickCheck&#39;</code> will occur. It seems that I need to add the package <code>QuickCheck</code> to somewhere like package.yaml &#39;s dependencies."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556511621, "post_id": 55602351, "comment_id": 98450026, "body": "@luochen1990 Oh, I see it now. <code>stack exec ghc test.hs</code> outside of a project will only use whatever is already installed for your global project resolver. If this is the first time you are using the <i>QuickCheck</i> package with that resolver, you need  <code>stack exec ghc --package QuickCheck -- test.hs</code>, which will install <i>QuickCheck</i> before attempting to compile your file. After you do that once, <code>stack exec ghc test.hs</code> will work (at least until you change the global project resolver)."}, {"owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1556519374, "post_id": 55602351, "comment_id": 98452134, "body": "thanks, now I can express my problem in another way: I have a list of package names, which I may depend on them when I&#39;m working with single files, and I want the installation step to be produced automatically, when I switch the global resolver, these packages will also be automatically installed when we need to import them."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 1, "creation_date": 1556588033, "post_id": 55602351, "comment_id": 98480189, "body": "@luochen1990 I don&#39;t think there is any purpose-built way to do that. The closest you can get, I guess, is creating a brand new project with <code>stack new</code>, setting it to the same resolver as that of the global project, and then only using it to add dependencies, so that a <code>stack build</code> will install whatever you need."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1554850045, "creation_date": 1554850045, "answer_id": 55602351, "question_id": 55594748, "link": "https://stackoverflow.com/questions/55594748/how-to-work-with-single-file-using-stack/55602351#55602351", "title": "How to work with single file using stack?", "body": "<p>There are a few options:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/39848576/load-a-new-package-in-ghci-using-stack\">The <code>--package</code> flag</a>, for ad hoc invocations;</p></li>\n<li><p><a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#finding-project-configs-and-the-implicit-global-project\" rel=\"nofollow noreferrer\">The global project</a> (see also <a href=\"https://stackoverflow.com/a/49504352/2751851\">this answer</a>), a default configuration located at <code>~/.stack/global-project/stack.yaml</code> (or the corresponding path for your OS) which kicks in when working outside of an actual project; and</p></li>\n<li><p><a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#script-interpreter\" rel=\"nofollow noreferrer\">Stack scripts</a>, which amount to placing a header specifying a Stack invocation atop your source file, as in this example taken from the docs...</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n  script\n  --resolver lts-6.25\n  --package turtle\n  --package \"stm async\"\n  --package http-client,http-conduit\n-}\n</code></pre>\n\n<p>... and which are useful when you want something portable.</p></li>\n</ul>\n"}], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 55602351, "answer_count": 1, "score": 3, "last_activity_date": 1554850045, "creation_date": 1554818619, "question_id": 55594748, "link": "https://stackoverflow.com/questions/55594748/how-to-work-with-single-file-using-stack", "title": "How to work with single file using stack?", "body": "<p>When I'm working with single file haskell code, without project, I can only dependent on the <code>base</code> package and import it's modules, but when I want to import modules from other packages, I have to create a new project and edit it's <code>package.yaml</code> and add items into <code>dependencies</code>, these works are too heavy for just a single file.</p>\n\n<p>Can I put my mostly used <code>dependencies</code> list into somewhere so that when I load a single file via <code>stack exec -- ghci my-file.hs</code> it will find my imported modules correctly ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554812998, "post_id": 55592711, "comment_id": 97882260, "body": "Um? <code>x</code> is a niladic function, so what is (irrefutably) matching to what? I can&#39;t for example write an equivalent lambda expression."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 2, "creation_date": 1554813775, "post_id": 55592711, "comment_id": 97882737, "body": "@AntC It&#39;s not a function at all, it&#39;s an <code>Integer</code>, as you observed. You definitely can&#39;t write an equivalent lambda expression; all lambda expressions are functions. The pattern <code>x</code> matches any <code>Integer</code>, binding that <code>Integer</code> to the name <code>x</code>; so in <code>~x = x+2</code> the name <code>x</code> is bound to the expression <code>x+2</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554816453, "post_id": 55592711, "comment_id": 97884555, "body": "@AntC Concepts like a &quot;niladic function&quot; are alien to Haskell. In Haskell, all functions take exactly one argument."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554818143, "post_id": 55592711, "comment_id": 97885733, "body": "@AntC <code>let</code> bindings are either pattern bindings, or function bindings (in case it&#39;s got some arguments). When there&#39;s no arguments, it&#39;s a pattern, either  simple single-variable pattern (already irrefutable), or a more complex pattern like <code>(a,b) = (1,2)</code> or <code>(x:xs) = [1..]</code> or <code>~(x:xs) = []</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554818765, "post_id": 55592711, "comment_id": 97886124, "body": "@AntC see <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-880004.5\" rel=\"nofollow noreferrer\">4.4.3 Function and Pattern Bindings</a> in the report."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554882803, "post_id": 55592711, "comment_id": 97909470, "body": "this is a correct answer but I think you&#39;d agree that it&#39;s not a useful answer as it contains no explanations and no elaborations, just a cryptic determination."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554899110, "post_id": 55592711, "comment_id": 97919022, "body": "@WillNess Given <code>~ x +++ y = y * 3       -- this makes sense</code>, what explanation is needed?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554906596, "post_id": 55592711, "comment_id": 97923758, "body": "@DanielWagner I thought it self-evident, hmm. for instance there&#39;s more comments from you with some explanations (and whole other answer). Maybe you had only the OP in mind when answering, but there&#39;ll be many other readers too, newbies as well as the more advanced ones..."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 11, "last_activity_date": 1554910900, "last_edit_date": 1554910900, "creation_date": 1554812346, "answer_id": 55592711, "question_id": 55592519, "link": "https://stackoverflow.com/questions/55592519/strange-tilde-syntax/55592711#55592711", "title": "Strange tilde syntax", "body": "<p>The tilde is doing exactly what it did in your other example: it makes the pattern irrefutable (so the pattern match can not fail). The pattern already was irrefutable, of course, in both cases (being a plain variable, which always matches), but that doesn't make the tilde illegal, just unnecessary.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554825647, "post_id": 55595013, "comment_id": 97890318, "body": "(...but top-level bindings are already irrefutable anyway, so even in your examples the <code>~</code>s are completely unnecessary.)"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554831672, "post_id": 55595013, "comment_id": 97893184, "body": "@DanielWagner Really? Interesting... I didn&#39;t know that."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1554832010, "post_id": 55595013, "comment_id": 97893343, "body": "If they weren&#39;t, at what moment should they fail? @MathematicalOrchid"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1554834334, "post_id": 55595013, "comment_id": 97894418, "body": "@luqui When you first try to use the binding, I suppose... Hmm, but that only works if they&#39;re irrefutable... I see your point."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554865262, "post_id": 55595013, "comment_id": 97903491, "body": "OK so if I want to give an equation to define <code>~</code> as a (unary, prefix) operator, that would be <code>(~) x = x + 2</code>. ;-)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554882241, "post_id": 55595013, "comment_id": 97909174, "body": "@AntC have you tried it? It is part of a <i>syntax</i>. Similarly, you can&#39;t define your own function named <code>let</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554882579, "post_id": 55595013, "comment_id": 97909350, "body": "(1) not just top-level, <code>let</code> bindings are all irrefutable. Unless bangs <code>!</code> are involved. (2) <code>let False = True in False</code> simply returns <code>False</code> because the pattern match isn&#39;t even attempted, and if it were it&#39;d fail. <code>False</code> isn&#39;t redefined by that as it&#39;s not a variable pattern. It&#39;s the same as <code>let Just x = Nothing in 1</code> except <code>False</code> is a nullary data constructor."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554883134, "post_id": 55595013, "comment_id": 97909661, "body": "(contd.) so maybe you meant <code>let (2+2) = 5 in (2+2)</code> as the bizarre and the obscure. :)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 8, "last_activity_date": 1554819523, "creation_date": 1554819523, "answer_id": 55595013, "question_id": 55592519, "link": "https://stackoverflow.com/questions/55592519/strange-tilde-syntax/55595013#55595013", "title": "Strange tilde syntax", "body": "<p>Writing</p>\n\n<pre><code>x = 5\n</code></pre>\n\n<p>creates a global variable named <code>x</code>, bound to the value <code>5</code>. Adding a tilde makes the pattern match irrefutable, but it was <em>already</em> irrefutable, so that doesn't make much sense. But it's legal to write something like</p>\n\n<pre><code>(xs, ys) = span odd [1..10]\n</code></pre>\n\n<p>This defines two global variables, <code>xs</code> and <code>ys</code>, containing all the odd numbers and all the even numbers between 1 and 10. You could even make this irrefutable if you want by adding a tilde. Of course, this pattern can't fail (if the expression is well-typed), so there's no point to that. But consider:</p>\n\n<pre><code>~(x:xs) = filter odd [1..10]\n</code></pre>\n\n<p>This defines two global variables, <code>x</code> and <code>xs</code>, <em>if</em> the filter returns at least one result. If the filter were to return <em>zero</em> results, the pattern match would fail. (In practice, this means that accessing <code>x</code> or <code>xs</code> would throw a pattern match failure exception.)</p>\n\n<p>You can <em>even</em> write utterly bizarre stuff like</p>\n\n<pre><code>False = True\n</code></pre>\n\n<p>This seemingly nonsensical declaration pattern-matches the pattern <code>False</code> against the value <code>True</code>, and does nothing either way. It's one of those obscure corners of the language.</p>\n"}], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 55595013, "answer_count": 2, "score": 10, "last_activity_date": 1554910900, "creation_date": 1554811711, "question_id": 55592519, "link": "https://stackoverflow.com/questions/55592519/strange-tilde-syntax", "title": "Strange tilde syntax", "body": "<p>GHC accepts this code, but it ought to be illegal syntax(?) Any guesses as to what's going on?</p>\n\n<pre><code>module Tilde  where\n\n~ x = x + 2             -- huh?\n\n~ x +++ y = y * 3       -- this makes sense\n</code></pre>\n\n<p>The <code>(+++)</code> equation makes sense: it's declaring an operator, using infix syntax, and using an irrefutable pattern match on the first argument.</p>\n\n<p>The first 'equation' looks like the same to start with. But there's no operator. If I ask</p>\n\n<pre><code>\u03bb&gt; :i ~\n===&gt; &lt;interactive&gt;:1:1: error: parse error on input `~'\n\n\u03bb&gt; :i (~)\n===&gt; class (a ~ b) =&gt; (~) (a :: k) (b :: k)\n     -- Defined in `Data.Type.Equality'\n     instance [incoherent] forall k (a :: k) (b :: k). (a ~ b) =&gt; a ~ b\n     -- Defined in `Data.Type.Equality'\n</code></pre>\n\n<p>which is a bemusing discovery, but nothing to do with it(?) I can't define my own class or operator <code>(~)</code> -- <code>Illegal binding of built-in syntax</code>, not surprisingly.</p>\n\n<p>Oh:</p>\n\n<pre><code>\u03bb&gt; :i x\n===&gt; x :: Integer         -- GHCi defaulting, presumably\n</code></pre>\n\n<p>and trying to run <code>x</code> loops for ever. So the strangeness is actually defining</p>\n\n<pre><code>x = x + 2\n</code></pre>\n\n<p>Then what's the <code>~</code> doing?</p>\n"}, {"tags": ["api", "haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554816798, "post_id": 55592013, "comment_id": 97884811, "body": "A third alternative to consider: one of <code>(MonadIO m, Alternative m) =&gt; ID -&gt; m User</code> if there&#39;s really no interesting error information you can report, or <code>(MonadIO m, MonadError MyFancyError m) =&gt; ID -&gt; m User</code> if there is."}], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 0, "creation_date": 1554812193, "post_id": 55592254, "comment_id": 97881796, "body": "for the sake of interest, <code>findById</code> would then look like <code>findById :: ID -&gt; Request User \\n findById 1 = return User \\n findById _ = Request . MaybeT $ return Nothing</code> Right?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 1, "creation_date": 1554821869, "post_id": 55592254, "comment_id": 97888061, "body": "Yeah. If you also derive <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:Alternative\" rel=\"nofollow noreferrer\"><code>Alternative</code></a> then you can simplify the failure case to <code>findById _ = empty</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1554810807, "creation_date": 1554810807, "answer_id": 55592254, "question_id": 55592013, "link": "https://stackoverflow.com/questions/55592013/transformers-in-type-signature-or-not/55592254#55592254", "title": "Transformers in type signature or not?", "body": "<p>If this is for something simple, and it's only a few functions that do this maybe-in-IO, I would just make the type <code>IO (Maybe User)</code>.</p>\n\n<p>If this is a pattern that stretches across your library, I would give a semi-abstract name to the tfm-stack monad:</p>\n\n<pre><code>type Request = MaybeT IO\n\nfindById :: ID -&gt; Request User\n</code></pre>\n\n<p>... or even</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\nnewtype Request a = Request (runRequest :: MaybeT IO a)\n   deriving (Functor, Applicative, Monad)\n</code></pre>\n\n<p>Making the signature <code>ID -&gt; MaybeT IO User</code> isn't very good: the transformer only helps if you're doing a whole bunch of actions in that monad, but in that case always writing out <code>MaybeT IO</code> violates the DRY principle.</p>\n"}], "owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 55592254, "answer_count": 1, "score": 2, "last_activity_date": 1554810807, "creation_date": 1554809992, "last_edit_date": 1554810398, "question_id": 55592013, "link": "https://stackoverflow.com/questions/55592013/transformers-in-type-signature-or-not", "title": "Transformers in type signature or not?", "body": "<p>Just thinking about an API design. What is \"common\" in Haskell? Transformers in type signature or rather \"hidden\"?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>findById :: ID -&gt; IO (Maybe User)\nfindById x = runMaybeT $ do\n  ...\n  return User\n</code></pre>\n\n<p>or</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>findById :: ID -&gt; MaybeT IO User\nfindById x = do\n  ...\n  return User\n</code></pre>\n"}, {"tags": ["string", "file", "haskell", "io"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554806557, "post_id": 55590817, "comment_id": 97878435, "body": "<code>getInputTest file_name :: IO String</code>, but <code>lines :: String -&gt; [String]</code> \u2013 you can&#39;t just write <code>parse</code> like that. You mean <code>parse file_name = fmap lines (getInputTest file_name)</code>. If you don&#39;t understand this, you should read <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a>."}, {"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554807034, "post_id": 55590817, "comment_id": 97878710, "body": "@AJFarmar I replaced my function with this line, but I still get the same error."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554810937, "post_id": 55590817, "comment_id": 97881025, "body": "If you add explicit type signatures to your functions, it&#39;s easier to catch this kind of error. It will be &quot;obvious&quot; that you can&#39;t pass <code>getInputTest file_name</code> to <code>lines</code>, because you&#39;ll have already noted that <code>getInputTest</code> returns an <code>IO String</code>, not a <code>String</code> like <code>lines</code> expects."}, {"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554811106, "post_id": 55590817, "comment_id": 97881133, "body": "@chepner But still, how can I make this work? What code for &quot;parse&quot; should I try? I still haven&#39;t figured it out."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "edited": false, "score": 0, "creation_date": 1554807079, "post_id": 55590969, "comment_id": 97878729, "body": "This is what I came up with:parse file_name =  do  let x = fmap (lines (getInputTest file_name))  return x"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "edited": false, "score": 0, "creation_date": 1554808530, "post_id": 55590969, "comment_id": 97879622, "body": "@zzz it should be <code>fmap lines (getInputTest fName)</code>, and you only need <code>return</code> there if you bind <code>x</code> with <code>x &lt;- ...</code>. If instead you use <code>let x = ...</code>, then <code>x</code> will have the type <code>IO String</code> rather than <code>String</code>, and you can simply write <code>x</code> in the last line without <code>return</code>. However, that means you could also omit the <code>x</code> binding completely: just make it <code>parse fName = fmap lines $ getInputTest fName</code>, or shorter <code>parse fName = fmap lines . getInputTest</code>."}, {"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1554809174, "post_id": 55590969, "comment_id": 97879988, "body": "@leftaroundabout my entire function right now is: parse :: String -&gt; [String] parse file_name = fmap lines . getInputTest And it still does not work"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1554809265, "post_id": 55590969, "comment_id": 97880055, "body": "The type is of course <code>String -&gt; IO [String]</code>. If something inside is doing IO, the type <i>must</i> always be an <code>IO</code> type."}, {"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1554809333, "post_id": 55590969, "comment_id": 97880102, "body": "@leftaroundabout And if my function is required to have it head like: parse :: String -&gt; [Instr], how am I supposed to define the Instr type?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1554809415, "post_id": 55590969, "comment_id": 97880145, "body": "You can&#39;t. But anyways, probably <code>parse</code> should actually <i>not</i> do IO at all, i.e. it should just accept the file <i>contents</i> instead of opening the file itself. Then it also doesn&#39;t need an <code>IO</code> type. For <code>Instr</code>, you should probably design a suitable ADT."}, {"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1554809497, "post_id": 55590969, "comment_id": 97880190, "body": "@leftaroundabout And how can I give the content of the file as a String for the parse function?"}, {"owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1554809740, "post_id": 55590969, "comment_id": 97880334, "body": "@leftaroundabout And what would this do eaxctly? Sorry, I am very new to Haskell."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "edited": false, "score": 0, "creation_date": 1554811067, "post_id": 55590969, "comment_id": 97881105, "body": "@zzz This isn&#39;t the forum for a basic tutorial in how Haskell works. I <i>strongly</i> recommend you read a good basic introduction like <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a>."}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 1, "last_activity_date": 1554806670, "creation_date": 1554806670, "answer_id": 55590969, "question_id": 55590817, "link": "https://stackoverflow.com/questions/55590817/couldnt-match-type-io-string-with-char/55590969#55590969", "title": "Couldn&#39;t match type \u2018IO String\u2019 with \u2018[Char]\u2019", "body": "<p><code>String</code> is <code>[Char]</code>, so the compiler is complaining that it's wrapped in <code>IO</code>. Read eg. <a href=\"https://wiki.haskell.org/Introduction_to_IO\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Introduction_to_IO</a> for an explanation.</p>\n\n<p>To fix it, you need to \"lift\" your parse function at its call point to operate on <code>IO String</code> instead. This would usually require eg. <code>fmap / &lt;$&gt;</code>, but working inside <code>do</code> notation then it can be sugared-in by writing eg. <code>return $ parse x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1554816863, "last_edit_date": 1554816863, "creation_date": 1554816455, "answer_id": 55594058, "question_id": 55590817, "link": "https://stackoverflow.com/questions/55590817/couldnt-match-type-io-string-with-char/55594058#55594058", "title": "Couldn&#39;t match type \u2018IO String\u2019 with \u2018[Char]\u2019", "body": "<blockquote>\n<pre><code>getInputTest file_name = do  \n    x &lt;- readFile file_name\n    return x\n</code></pre>\n</blockquote>\n\n<p>This is equivalent to any of the following:</p>\n\n<pre><code>getInputTest :: FilePath -&gt; IO String\ngetInputTest fileName = readFile fileName &gt;&gt;= \\x -&gt; return x\ngetInputTest fileName = readFile fileName &gt;&gt;= return\ngetInputTest fileName = readFile fileName\ngetInputTest = readFile\n</code></pre>\n\n<blockquote>\n<pre><code>parse :: String -&gt; [Instr]\nparse file_name = lines (getInputTest file_name)\n</code></pre>\n</blockquote>\n\n<p>Since <code>getInputTest :: FilePath -&gt; IO String</code> and <code>lines :: String -&gt; [String]</code>, you must, as A Tayler says, <em>lift</em> <code>lines</code> such that it works in the context of <code>IO</code>.</p>\n\n<p>Doing <code>fmap lines</code> you get the type <code>Functor f =&gt; f String -&gt; f [String]</code>, which, when specialising <code>f</code> to <code>IO</code>, becomes <code>IO String -&gt; IO [String]</code>. This matches the output type of <code>readFile</code> and so the functions may compose:</p>\n\n<pre><code>parse :: FilePath -&gt; IO [String]\nparse fileName = fmap lines (getInputTest fileName)\n</code></pre>\n\n<p>I'm not sure what kind of type <code>Instr</code> is and if there is further parsing than what <code>lines</code> does to turn a <code>String</code> line into an <code>Instr</code>; if there isn't, perhaps you could combine the two functions into one:</p>\n\n<pre><code>type Instr = String\n\nfromFile :: FilePath -&gt; IO [Instr]\nfromFile = fmap lines . readFile\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11333967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359d386df647e42370c4213499bcc5e?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/11333967/zzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1554816863, "creation_date": 1554806150, "question_id": 55590817, "link": "https://stackoverflow.com/questions/55590817/couldnt-match-type-io-string-with-char", "title": "Couldn&#39;t match type \u2018IO String\u2019 with \u2018[Char]\u2019", "body": "<p>I am having a project to do for school where I am required to read from file, being given the head of the function I have to implement.</p>\n\n<p>I have the following function already being give which I assume it reads the file that has the name \"file_name\":</p>\n\n<pre><code>getInputTest file_name = do  \n    x &lt;- readFile file_name\n    return x\n</code></pre>\n\n<p>Next, I have to parse each line of the text, in order to get a vector of Strings, each element of the vector being one line of the file. This is where I am give the head of the function I have to implement:</p>\n\n<pre><code>parse :: String -&gt; [Instr]\n</code></pre>\n\n<p>The first argument of this function should be everything that is read from the file(all lines) and the [Instr] should be formed of all the lines from the file, each element of the vector being one line.(the \"Instr\" should be chosen by me and I tried choosing it \"String\", but it does not work)</p>\n\n<p>I already tried this:</p>\n\n<pre><code>parse file_name = lines (getInputTest file_name)\n</code></pre>\n\n<p>But I keep getting errors such as: \"Couldn't match type \u2018IO String\u2019 with \u2018[Char]\u2019\".</p>\n\n<p>What am I doing wrong and how can I fix it? Considering that the head of \"parse\" function should not be modified.</p>\n"}, {"tags": ["sockets", "haskell", "tcpserver"], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1554800201, "post_id": 55588545, "comment_id": 97874609, "body": "But still the connection closes after 1 message sent."}, {"owner": {"reputation": 46, "user_id": 6506124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72808ba3c7c636782192c2616def151b?s=128&d=identicon&r=PG&f=1", "display_name": "Dvoliq", "link": "https://stackoverflow.com/users/6506124/dvoliq"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 2, "creation_date": 1554800871, "post_id": 55588545, "comment_id": 97875022, "body": "Check at <a href=\"https://catonmat.net/simple-haskell-tcp-server\" rel=\"nofollow noreferrer\">link</a>. It will show you a great example of a TCP server."}], "tags": [], "owner": {"reputation": 46, "user_id": 6506124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72808ba3c7c636782192c2616def151b?s=128&d=identicon&r=PG&f=1", "display_name": "Dvoliq", "link": "https://stackoverflow.com/users/6506124/dvoliq"}, "is_accepted": true, "score": 3, "last_activity_date": 1554799414, "creation_date": 1554799414, "answer_id": 55588545, "question_id": 55588006, "link": "https://stackoverflow.com/questions/55588006/starting-tcp-server-in-haskell/55588545#55588545", "title": "Starting TCP server in Haskell", "body": "<p>You need to execute your binaries after compiling them:\n<code>./Main</code> on linux or <code>Main.exe</code> on windows.</p>\n\n<p>Then you can request your server thanks to <code>telnet localhost 8100</code></p>\n\n<p><code>telnet localhost 8100\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nhelloConnection closed by foreign host.\n</code></p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 1, "accepted_answer_id": 55588545, "answer_count": 1, "score": 0, "last_activity_date": 1573415126, "creation_date": 1554797557, "last_edit_date": 1573415126, "question_id": 55588006, "link": "https://stackoverflow.com/questions/55588006/starting-tcp-server-in-haskell", "title": "Starting TCP server in Haskell", "body": "<p>I am trying to create a TCP server in Haskell from the example provided on <a href=\"https://wiki.haskell.org/Implement_a_chat_server\" rel=\"nofollow noreferrer\">haskell.org</a>. When I run the code from the terminal with <code>ghc run Main.hs</code>, I get:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( Main.hs, Main.o )\nLinking Main.exe ...\n</code></pre>\n\n<p>After which it closes.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>module Main where \n    import Network.Socket\n    import Network.Socket.ByteString\n    import qualified Data.ByteString.Char8 as C\n\n    main::IO()\n    main=do\n        sock&lt;-socket AF_INET Stream 0\n        bind sock (SockAddrInet 8100 iNADDR_ANY)\n        listen sock 2\n        mainloop sock\n\n\n    mainloop::Socket-&gt;IO()\n    mainloop sock=do\n        conn&lt;-accept sock\n        runConn conn\n        mainloop sock\n\n\n    runConn::(Socket,SockAddr)-&gt;IO()\n    runConn (sock,_)=do\n        Network.Socket.ByteString.send sock (C.pack \"hello\")\n        close sock\n</code></pre>\n\n<p>I first assumed the server might somehow run in the backgroud so I tested it with the <code>Simple Web Socket Client</code> - browser extension and nada.</p>\n\n<p><strong>Tested url</strong><br>\n<code>ws://localhost:8100</code></p>\n"}, {"tags": ["haskell", "stm"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1554792472, "post_id": 55586520, "comment_id": 97870443, "body": "How much CPU is your server using when it gets &quot;stuck&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1554793768, "post_id": 55586633, "comment_id": 97871084, "body": "yep, that&#39;s it! thank you! all those connections are in <code>TIME_WAIT</code> state. does this suggest that scotty is not closing connections properly?"}, {"owner": {"reputation": 3637, "user_id": 797637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1577f43a7c6eb01836e1758a2ba4df5?s=128&d=identicon&r=PG&f=1", "display_name": "firefrorefiddle", "link": "https://stackoverflow.com/users/797637/firefrorefiddle"}, "edited": false, "score": 1, "creation_date": 1554798039, "post_id": 55586633, "comment_id": 97873291, "body": "So what&#39;s the solution?"}, {"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 1, "creation_date": 1554867744, "post_id": 55586633, "comment_id": 97904028, "body": "seems like <code>wrk</code> (instead of <code>ab</code>) doesn&#39;t cause this issue."}, {"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "reply_to_user": {"reputation": 3637, "user_id": 797637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1577f43a7c6eb01836e1758a2ba4df5?s=128&d=identicon&r=PG&f=1", "display_name": "firefrorefiddle", "link": "https://stackoverflow.com/users/797637/firefrorefiddle"}, "edited": false, "score": 0, "creation_date": 1554916970, "post_id": 55586633, "comment_id": 97929535, "body": "@firefrorefiddle, I&#39;m not quite sure. I clicked because I spent a lot of time learning STM, not Scotty. I know that TCP ports need to be closed before more can be opened, but how to make that happen should probably be asked in a new question with Scotty prominently in the title."}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 5, "last_activity_date": 1554792326, "creation_date": 1554792326, "answer_id": 55586633, "question_id": 55586520, "link": "https://stackoverflow.com/questions/55586520/getting-stuck-using-stm/55586633#55586633", "title": "Getting &quot;stuck&quot; using STM", "body": "<p>Quick guess here.  16,000 is about the number of available TCP ports.  Is is possible you have not closed any connections and therefore run out of open ports for <code>ab</code>?</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55586633, "answer_count": 1, "score": 0, "last_activity_date": 1554792326, "creation_date": 1554791852, "question_id": 55586520, "link": "https://stackoverflow.com/questions/55586520/getting-stuck-using-stm", "title": "Getting &quot;stuck&quot; using STM", "body": "<p>I have the following <a href=\"http://hackage.haskell.org/package/scotty\" rel=\"nofollow noreferrer\">Scotty</a> app which tries to use STM to keep a count of API calls served:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport Web.Scotty\nimport Data.Monoid (mconcat)\nimport Control.Concurrent.STM\nimport Control.Monad.IO.Class\n\nmain :: IO ()\nmain = do\n  counter &lt;- newTVarIO 0\n  scotty 3000 $\n    get \"/:word\" $ do\n      liftIO $ atomically $ do\n        counter' &lt;- readTVar counter\n        writeTVar counter (counter' + 1)\n      liftIO $ do\n        counter' &lt;- atomically (readTVar counter)\n        print counter'\n      beam &lt;- param \"word\"\n      html $ mconcat [\"&lt;h1&gt;Scotty, \", beam, \" me up!&lt;/h1&gt;\"]\n</code></pre>\n\n<p>I \"load test\" the API like this:</p>\n\n<pre><code>ab -c 100 -n 100000 http://127.0.0.1:3000/z\n</code></pre>\n\n<p>However, the API serves roughly about 16 thousand requests and then gets \"stuck\" - <code>ab</code> stops with error <code>apr_socket_recv: Operation timed out (60)</code>.</p>\n\n<p>I think I'm misusing STM, but not sure what I'm doing wrong. Any suggestions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554786190, "post_id": 55585360, "comment_id": 97868108, "body": "The input format appears to contain only a list of cells ie. a 1D array, not a 2D matrix. You need to say where <code>x</code> and <code>y</code> are coming from (probably by matching on parameter <code>c</code>). You haven&#39;t given the definition of <code>Cell</code>. The calculation of <code>ratio</code> can be expressed as a <code>fold</code>. Can you write a function to do that given some list of numbers? Then, how will you generate that list from cell coordinates?"}, {"owner": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554787574, "post_id": 55585360, "comment_id": 97868546, "body": "-- Type-definition of a Cell: it is just a coordinate and an optional AgentType. -- Note: the agent type is optional and is Nothing in case the cell is empty. type Cell = (Coord, Maybe AgentType)"}, {"owner": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554787710, "post_id": 55585360, "comment_id": 97868604, "body": "@ATayler Thank you for the advice. I feel like I need to try to understand the whole thing more because since I get even more confused about your advice. Thanks though"}, {"owner": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554787752, "post_id": 55585360, "comment_id": 97868619, "body": "type Coord = (Int, Int)"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554787941, "post_id": 55585360, "comment_id": 97868680, "body": "Is the grid infinite? In which case the input list of cells is just the non-empty ones?"}, {"owner": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554787999, "post_id": 55585360, "comment_id": 97868695, "body": "@ATayler oh, I got what you mean. so I should first change the moore list .. hmm"}, {"owner": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554788113, "post_id": 55585360, "comment_id": 97868738, "body": "it has boundaries . worldSize :: (Int, Int) worldSize = (20, 20)"}], "answers": [{"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "edited": false, "score": 0, "creation_date": 1554789170, "post_id": 55585802, "comment_id": 97869131, "body": "Your original post is supposed to contain everything needed to answer the question. Please edit it if there&#39;s more information you wish to provide."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1554847176, "post_id": 55585802, "comment_id": 97899653, "body": "<code>isHappy cs (Cell (x, y) a) = ratio &gt;= 0.4 where \u2026</code>, and I think you need a <code>fromIntegral</code> for the <code>length</code> results since <code>Int</code> is not <code>Fractional</code>."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1554848735, "post_id": 55585802, "comment_id": 97900115, "body": "@JonPurdy imo the first change hurt readability but is more acceptable with better variable names. added the <code>fromIntegral</code>s."}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 1, "last_activity_date": 1554848458, "last_edit_date": 1554848458, "creation_date": 1554788503, "answer_id": 55585802, "question_id": 55585360, "link": "https://stackoverflow.com/questions/55585360/haskell-getting-same-neighbors/55585802#55585802", "title": "Haskell. getting same neighbors", "body": "<pre><code>data Cell = Cell Coord (Maybe AgentType)\n\ninBounds :: Coord -&gt; Bool\ninBounds (x,y) = 0 &lt;= x &amp;&amp; x &lt;= fst worldSize\n              &amp;&amp; 0 &lt;= y &amp;&amp; y &lt;= snd worldSize\n\nisHappy cs (Cell (x,y) a) = ratioSameNeighbours &gt;= 0.4\n    where neighbourCoords = filter inBounds [(x-1,y-1),(x-1,y),(x-1,y+1),(x,y+1),(x+1,y+1),(x+1,y),(x+1,y-1),(x,y-1)]\n          sameNeighbours = filter ((\\(Cell p ma) -&gt; p `elem` neighbourCoords &amp;&amp; ma == a) cs\n          ratioSameNeighbours = fromIntegral (length sameNeighbours) / fromIntegral (length neighbours)\n</code></pre>\n\n<p>What you've said is still a bit underspecified, (eg. can an empty cell ever be happy?) but this is a start. If the input cell array is supposed to be 2D (rather than a \"sparse\" representation ie. 1D list of only the non-empty cells) then <code>ratio</code> has to be a bit different.</p>\n"}], "owner": {"reputation": 55, "user_id": 6886108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ffd94b773364441a9709ec574fe13?s=128&d=identicon&r=PG&f=1", "display_name": "Dop3n", "link": "https://stackoverflow.com/users/6886108/dop3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 55585802, "answer_count": 1, "score": 2, "last_activity_date": 1554848458, "creation_date": 1554785910, "last_edit_date": 1554788463, "question_id": 55585360, "link": "https://stackoverflow.com/questions/55585360/haskell-getting-same-neighbors", "title": "Haskell. getting same neighbors", "body": "<p>I'm the cs student who recently started to learn Haskell.\nI tried my best to find the way to interpret in Haskell but I couldn't yet. I need help. Here's the explanation. There are three types of content.</p>\n\n<pre><code>type Coord = (Int, Int)\n\n-- Type-definition of a Cell: it is just a coordinate and an optional \nAgentType.\n-- Note: the agent type is optional and is Nothing in case the cell is \nempty.\n\ntype Cell = (Coord, Maybe AgentType)\n\n-- data definition for the agent types\n  data AgentType \n    = Red       -- ^ Red agent\n    | Green     -- ^ Green agent\n    | Blue      -- ^ Blue agent\n    deriving (Eq, Show) -- Needed to compare for equality, otherwise would need to implement by ourself\n</code></pre>\n\n<p>Each cell has either a content( can be red, green or blue) or empty. I'm trying to find the neighbours who have the same content from every side including diagonal ways which is 8 in total. If 40% of the cell neighbours are the same as the cell, return true.</p>\n\n<pre><code>-- Returns True if an agent on a given cell is happy or not\nisHappy :: Double  -- ^ The satisfaction factor\n    -&gt; [Cell]  -- ^ All cells\n    -&gt; Cell    -- ^ The cell with the agent\n    -&gt; Bool    -- ^ True in case the agent is happy, False otherwise\n\nisHappy ratio cs c\n    | ratio &lt; 0.4 = False\n    | otherwise = True\n    where\n    moore = [(x-1,y-1),(x-1,y),(x-1,y+1),(x,y+1),(x+1,y+1),(x+1,y),(x+1,y-1),(x,y-1)]\n    -- here is where I got stuck\n</code></pre>\n\n<p>I made a 'moore' list which contains all direction, but I'm not sure how to compare 'the Cell' to 'neighbours [Cell]'.\nMy thought is following in another programming language,</p>\n\n<pre><code>if (TheCell[X-1,Y] == TheCell)){\n    stack ++;\n    }\n ...\n ...\n ratio = stack / len(8);\n</code></pre>\n\n<p>I've been searching how to interpreted in Haskell but couldn't find it yet. Maybe my thinking process is wrong. Please help me in any way</p>\n"}, {"tags": ["haskell", "typeclass", "functor"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1554775550, "post_id": 55584018, "comment_id": 97866048, "body": "The problem is <code>fmap g (Wrap (f a)) =</code>. In particular, <code>f a</code>  is not a valid pattern. I don&#39;t really understand what you&#39;re trying to express there."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554775617, "post_id": 55584018, "comment_id": 97866060, "body": "Another way of looking at it: in <code>fmap g (Wrap (f a))</code>, <code>f</code> is not a type (nor a type constructor)."}, {"owner": {"reputation": 436, "user_id": 2227966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1471a2a4abd39213b3cd2b6296b120d1?s=128&d=identicon&r=PG", "display_name": "Kevin Bradner", "link": "https://stackoverflow.com/users/2227966/kevin-bradner"}, "edited": false, "score": 0, "creation_date": 1554775891, "post_id": 55584018, "comment_id": 97866102, "body": "Can you explain more about how f is not a type constructor? I think this is the source of my issues. Is it wrong to say that f must have kind (* -&gt; *) based only on the datatype declaration? From here, I thought (f a) would be a valid type to pattern match on."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1554776215, "post_id": 55584018, "comment_id": 97866144, "body": "@KevinBradner The <code>f</code> in the instance declaration, <code>instance Functor f =&gt; Functor (Wrap f)</code>, is a type constructor. The <code>f</code> in the <code>fmap</code> definition, however, is not the same thing, and not a type constructor. Patterns match values, not types."}, {"owner": {"reputation": 436, "user_id": 2227966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1471a2a4abd39213b3cd2b6296b120d1?s=128&d=identicon&r=PG", "display_name": "Kevin Bradner", "link": "https://stackoverflow.com/users/2227966/kevin-bradner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554777081, "post_id": 55584018, "comment_id": 97866305, "body": "@duplode I think I understand. You&#39;re saying that (f a) can&#39;t be interpreted as a value of type &#39;f a&#39;, correct? This seems to make sense if I imagine a concrete example substituting [] for f."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554777575, "post_id": 55584018, "comment_id": 97866378, "body": "Once you have a value of type f a, you can&#39;t (necessarily) match against it to extract the a, that&#39;s the whole point of functors/monads etc., wrapping up values such that the type indicates that they&#39;re not ^just^ that value but rather eg. an action that can result in a value."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1554777984, "post_id": 55584018, "comment_id": 97866439, "body": "What f is not, it is not a value constructor. You seem to mix up type and value constructors. This is an often source of confusions b/c of the wide use of definitions like <code>data D = D Int</code>. On the left from = you see (nullary) type constructor D. On the right \u2014 value constructor. To disambiguate, let&#39;s use <code>data D = V Int</code>. Remember, we can pattern-match only on value constructors (V in this case), not on type constructors (D in this case). Back to your example: f is a type variable standing for some (unary) type constructor but you cannot pattern-match on it b/c it is not a value constructor."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554779616, "post_id": 55584018, "comment_id": 97866729, "body": "Related: <a href=\"https://stackoverflow.com/q/42026435/2751851\"><i>Writing a generic functor instance across type constructors?</i></a>"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1554779319, "creation_date": 1554779319, "answer_id": 55584545, "question_id": 55584018, "link": "https://stackoverflow.com/questions/55584018/why-does-ghc-not-parse-functor-instance-for-data-wrap-f-a-wrap-f-a/55584545#55584545", "title": "Why does GHC not parse functor instance for &#39;data Wrap f a = Wrap (f a)&#39;?", "body": "<p><code>fmap g (Wrap (f a))</code> on the left hand side of the definition results in a parse error because <code>(f a)</code> is not a syntactically valid pattern.</p>\n\n<blockquote>\n  <p>My approach focuses on pattern matching to use f in a \"functor-ish\" way without fmap [...]</p>\n</blockquote>\n\n<p>Syntax issue aside, you can't literally use that <code>f</code> as a pattern in this way. The <code>f</code> in the instance declaration is a type constructor, while patterns are meant to match values and values constructors. For a minimal illustration, in...</p>\n\n<pre><code>id :: x -&gt; x\nid x = x\n</code></pre>\n\n<p>... the <code>x</code> from the type signature, a type variable, is not the same <code>x</code> from the left side of the function definition, a pattern which matches values (of type <code>x</code>) and binds them to a variable (named <code>x</code>). There is no reason why the names must coincide.</p>\n\n<p>If I understood your intent well, the plan was to use <code>(f a)</code> as a pattern such that <code>f</code> would match any \"functor-ish\" constructor with something (the <code>a</code>) inside. That doesn't work (we can't abstract over constructors in this manner), but even if it did somehow work it wouldn't be good enough for this task. That's because not all functorial values fit the mould of a constructor wrapping some other value. One example: <code>Nothing :: Maybe Integer</code>. There is no unary value constructor here, nor any value being wrapped.</p>\n"}], "owner": {"reputation": 436, "user_id": 2227966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1471a2a4abd39213b3cd2b6296b120d1?s=128&d=identicon&r=PG", "display_name": "Kevin Bradner", "link": "https://stackoverflow.com/users/2227966/kevin-bradner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 55584545, "answer_count": 1, "score": 0, "last_activity_date": 1554779319, "creation_date": 1554774784, "last_edit_date": 1554775624, "question_id": 55584018, "link": "https://stackoverflow.com/questions/55584018/why-does-ghc-not-parse-functor-instance-for-data-wrap-f-a-wrap-f-a", "title": "Why does GHC not parse functor instance for &#39;data Wrap f a = Wrap (f a)&#39;?", "body": "<p>In <strong>Haskell Programming From First Principles</strong> section 16.13, the <strong>Wrap</strong> datatype is presented to demonstrate a type whose Functor instance requires a typeclass constraint on one of its parameters:</p>\n\n<pre><code>data Wrap f a =\n  Wrap (f a)\n  deriving (Eq, Show)\n</code></pre>\n\n<p>After demonstrating a couple of incorrect instances of Functor for (Wrap f), a correct instance is shown:</p>\n\n<pre><code>instance Functor f =&gt; Functor (Wrap f) where\n  fmap g (Wrap fa) = Wrap (fmap g fa)\n</code></pre>\n\n<p>The fact that this typeclass instance should work seems right to me. Indeed, GHC accepts it without complaint.</p>\n\n<p>In order to convince myself that the 'Functor f' constraint is required, I attempted to create my own typeclass instance without it. My approach focuses on pattern matching to use f in a \"functor-ish\" way without fmap, similar to approaches shown earlier in the book. Here is the attempt:</p>\n\n<pre><code>instance Functor (Wrap f) where\n  fmap g (Wrap (f a)) = Wrap f (g a)\n</code></pre>\n\n<p>When I load this into GHCi, I get the following error:</p>\n\n<pre><code>Prelude&gt; :l 16.12-wrap.hs\n[1 of 1] Compiling Main             ( 16.12-wrap.hs, interpreted )\n\n16.12-wrap.hs:10:17: error: Parse error in pattern: f\n   |\n10 |   fmap g (Wrap (f a)) = Wrap f (g a)\n   |                 ^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Can someone explain the issue with my attempted instance? It seems to me that GHC has enough information to infer that f is of kind (* -> *) from the definition of Wrap at the top, so I can't understand why my attempt does not parse.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1554765380, "post_id": 55582983, "comment_id": 97864111, "body": "I don&#39;t see a question here."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1554765762, "post_id": 55582983, "comment_id": 97864196, "body": "What do you want <code>localMaxima [1,2]</code> to do?"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 0, "last_activity_date": 1554765770, "last_edit_date": 1592644375, "creation_date": 1554765770, "answer_id": 55583097, "question_id": 55582983, "link": "https://stackoverflow.com/questions/55582983/haskell-function-non-exaustive-patters-in-function-error/55583097#55583097", "title": "Haskell function non-exaustive patters in function error", "body": "<h1>Problem</h1>\n<p>As you can tell from the error, your pattern matching does not cover all the cases: what happens if you give it a list with 2 elements? <code>e1:e2:[]</code> does not match any of your cases, resulting in a non-exhaustive patterns error.</p>\n<h1>Solution</h1>\n<p>The solution is fairly easy: add a base-case for a list with two elements only. Assuming a point on the boundary cannot be a local min/max, your function should look something like this.</p>\n<pre><code>localMaxima :: [Integer] -&gt; [Integer]\nlocalMaxima [] = []\nlocalMaxima [x] = []\nlocalMaxima [a,b] = []\nlocalMaxima (e1:e2:e3:xs)\n    |    (e2 &gt; e3) &amp;&amp; (e2 &gt; e1) = e2 : (localMaxima (e2:(e3:xs)))\n    |    otherwise = (localMaxima (e2:(e3:xs)))\n</code></pre>\n<p>Furthermore, you can simplify this even more by</p>\n<ul>\n<li>noting <code>:</code> is right-associative</li>\n<li>use pattern wildcard <code>_</code></li>\n<li>make your type signature more generic</li>\n</ul>\n<p>You can now have</p>\n<pre><code>localMaxima :: Ord a =&gt; [a] -&gt; [a]\nlocalMaxima (e1:e2:e3:xs)\n    |    (e2 &gt; e3) &amp;&amp; (e2 &gt; e1) = e2 : localMaxima (e2:e3:xs)\n    |    otherwise = localMaxima (e2:e3:xs)\nlocalMaxima _ = []\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11331626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0a8dc587ed636fb1b8dde31dafaa3f?s=128&d=identicon&r=PG&f=1", "display_name": "Unshure", "link": "https://stackoverflow.com/users/11331626/unshure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1554768301, "accepted_answer_id": 55583097, "answer_count": 1, "score": -3, "last_activity_date": 1554765770, "creation_date": 1554764977, "question_id": 55582983, "link": "https://stackoverflow.com/questions/55582983/haskell-function-non-exaustive-patters-in-function-error", "closed_reason": "Duplicate", "title": "Haskell function non-exaustive patters in function error", "body": "<p>I'm trying to make a function that finds the local Maximum number in a list.</p>\n\n<pre><code>localMaxima :: [Integer] -&gt; [Integer]\nlocalMaxima [] = []\nlocalMaxima [x] = []\nlocalMaxima (e1:e2:e3:xs)\n    |    (e2 &gt; e3) &amp;&amp; (e2 &gt; e1) = e2 : (localMaxima (e2:(e3:xs)))\n    |    otherwise = (localMaxima (e2:(e3:xs)))\n</code></pre>\n\n<p>After inputting a list of [2,3,4,1,5], the console outputs: </p>\n\n<p>Non-exhaustive patterns in function localMaxima</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1554767306, "post_id": 55580805, "comment_id": 97864570, "body": "&quot;how come after isn&#39;t run twice in case of an exception?&quot; - <code>onException</code> doesn&#39;t <i>catch</i> the exception"}], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 5, "last_activity_date": 1554755120, "last_edit_date": 1554755120, "creation_date": 1554754300, "answer_id": 55581065, "question_id": 55580805, "link": "https://stackoverflow.com/questions/55580805/is-interruption-also-an-asynchronous-exception-in-ghc/55581065#55581065", "title": "Is interruption also an asynchronous exception in GHC?", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:mask\" rel=\"noreferrer\"><code>mask</code></a> <em>sort of</em> prevents asynchronous interruptions from being raised.</p>\n\n<blockquote>\n  <p>Asynchronous exceptions may still be received while in the masked state if the masked thread <em>blocks</em> in certain ways</p>\n</blockquote>\n\n<p>There's a different function, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:uninterruptibleMask\" rel=\"noreferrer\"><code>uninterruptibleMask</code></a>, which does completely block async exceptions.</p>\n\n<p>A POSIX interrupt signal does by default result in an <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#t:AsyncException\" rel=\"noreferrer\"><code>AsyncException</code></a> raised in the main thread. If I'm understanding correctly, I don't think that's relevant to your question. When people are saying \"interruptable\" they're not referring specifically to the POSIX interrupt signal; they mean that an action is \"interruptable\" if it has not been masked with <code>uninterruptibleMask</code> and therefore can receive any async exception from any source.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 55581065, "answer_count": 1, "score": 2, "last_activity_date": 1554755120, "creation_date": 1554753136, "last_edit_date": 1592644375, "question_id": 55580805, "link": "https://stackoverflow.com/questions/55580805/is-interruption-also-an-asynchronous-exception-in-ghc", "title": "Is interruption also an asynchronous exception in GHC?", "body": "<p>When trying to understand how GHC programs work with regard to signals and exceptions, I found an interesting if inconclusive discussion regarding <a href=\"https://mail.haskell.org/pipermail/libraries/2014-November/024351.html\" rel=\"nofollow noreferrer\">&quot;fixing&quot; the bracket</a>.</p>\n<p>I struggle to understand why would a change be needed when a bracket already <a href=\"https://www.stackage.org/haddock/lts-13.16/base-4.12.0.0/src/Control-Exception-Base.html#bracket\" rel=\"nofollow noreferrer\">masks asynchronous exceptions</a>.</p>\n<p>It seems to me that either interruption (as in POSIX signals) is not an asynchronous exception or I'm missing some detail in the current long-standing implementation:</p>\n<pre><code>bracket before after thing =\n  mask $ \\restore -&gt; do\n    a &lt;- before\n    r &lt;- restore (thing a) `onException` after a\n    _ &lt;- after a -- can be interrupted??\n    return r\n</code></pre>\n<p>In my understanding, <code>after a</code> must be evaluated to provide <code>IO</code> action that will be forced by <code>IO</code> monad which is within <code>mask</code> scope.</p>\n<p>EDIT: While on the topic, how come <code>after</code> isn't run twice in case of an exception?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1554753668, "post_id": 55580638, "comment_id": 97860307, "body": "You can also use the function <code>lines</code> so you only need one string and one <code>putStrLn</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7475856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4b5d256809beba4df4e68efeb8d60b?s=128&d=identicon&r=PG&f=1", "display_name": "Dilly", "link": "https://stackoverflow.com/users/7475856/dilly"}, "edited": false, "score": 0, "creation_date": 1554756584, "post_id": 55580705, "comment_id": 97861442, "body": "How would I format the test data with this solution? I&#39;ve tried removing commas, changing brackets but nothing seems to work."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 25, "user_id": 7475856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4b5d256809beba4df4e68efeb8d60b?s=128&d=identicon&r=PG&f=1", "display_name": "Dilly", "link": "https://stackoverflow.com/users/7475856/dilly"}, "edited": false, "score": 0, "creation_date": 1554763613, "post_id": 55580705, "comment_id": 97863695, "body": "@Dilly <code>testData = [ Student &quot;Garry&quot; &quot;Queen&quot; 10 1, ... ]</code>"}], "tags": [], "owner": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1554813156, "last_edit_date": 1554813156, "creation_date": 1554752689, "answer_id": 55580705, "question_id": 55580638, "link": "https://stackoverflow.com/questions/55580638/output-each-type-from-type-list-on-a-seperate-line/55580705#55580705", "title": "Output each type from type list on a seperate line", "body": "<p>In your definition, <code>Student</code> is a type alias, not a data constructor, therefore you cannot use it in the way you intended. It would be as if you wrote:</p>\n\n<pre><code>studentToString :: Student FirstName Surname Age Id -&gt; String\nstudentToString :: (FirstName, Surname, Age, Id) FirstName Surname Age Id -&gt; String\n</code></pre>\n\n<p>Not much sense there. One way to fix this is to convert your <code>Student</code> definition to a data constructor:</p>\n\n<pre><code>data Student = Student FirstName Surname Age Id\n\nstudentToString :: Student -&gt; String\n...\n</code></pre>\n\n<p>One neat trick of data constructors is that it will let you use pattern matching on the wrapped values, just as if it were a tuple:</p>\n\n<pre><code>getAge :: Student -&gt; Age\ngetAge (Student _ _ age _) = age\n\ngetId :: Student -&gt; Id\ngetId (Student _ _ _ id) = id\n\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 1, "last_activity_date": 1554847756, "last_edit_date": 1554847756, "creation_date": 1554764376, "answer_id": 55582902, "question_id": 55580638, "link": "https://stackoverflow.com/questions/55580638/output-each-type-from-type-list-on-a-seperate-line/55582902#55582902", "title": "Output each type from type list on a seperate line", "body": "<p>I am afraid to say that there are very many things wrong with your code. I'll try to go through them one at a time and adapt this to a working solution.</p>\n\n<p>1) This line:</p>\n\n<pre><code>type Student = (FirstName, Surname, Age, Id)\n</code></pre>\n\n<p>declares what is known as a \"type synonym\". It just makes <code>Student</code> mean exactly the same thing to the compiler as the 4-tuple <code>(FirstName, Surname, Age, Id)</code>.  You could instead have done this:</p>\n\n<pre><code>data Student = Student FirstName Surname Age Id\n</code></pre>\n\n<p>which would have made <code>Student</code> into a completely new type, which you can construct values of by using a function - also called <code>Student</code>, the \"data constructor\" on the right of the <code>=</code> sign (you could assign any name to this, but it's conventional to use the same name as that of the type itself) - applied to values of types <code>FirstName</code>, <code>Surname</code>, <code>Age</code> and <code>Id</code>.</p>\n\n<p>While I think most experienced Haskell programmers (which I'm not, just a developer who is interested in the language and tries to dabble when I get the chance) would prefer the <code>data</code> declaration because it is more \"type safe\" (there is no risk of confusing a <code>Student</code> with some 4-tuple of the same types which is intended to be something else), I think the type synonym which you have is fine for casual use, and I'll continue with this below.</p>\n\n<p>Anyway, your first problem is with the type signature of the <code>studentToString</code> function. As I said, <code>Student</code> is a type in its own right, in this case a synonym for a particular type of 4-tuple. Although it has fields of the 4 types you've listed in the signature, it is a type in its own right, and doesn't need - and therefore cannot have - other types after it in order to make a valid type. This is nonsensical here. The input type of your function is a <code>Student</code> - that is, a 4-tuple. So the type signature should be simply:</p>\n\n<pre><code>studentToString :: Student -&gt; String\n</code></pre>\n\n<p>(As an aside, that fits rather neatly with the accurate name that you've given the function.)</p>\n\n<p>2) You've got similarly confused with the function definition itself:</p>\n\n<pre><code>studentToString (Student FirstName Surname Age Id) = ...\n</code></pre>\n\n<p>This won't compile, for the reason GHC is giving you in the error message. It only knows <code>Student</code> as the name of a type, and in order for this definition to make sense it would have to also be the name of a function - specifically a constructor function. As I mentioned above, you could have made this happen by using a <code>data</code> declaration for <code>Student</code>, rather than a type synonym. But this isn't what you've done. Your <code>Student</code> type, as I've said, is simply a 4-tuple, so you have to define the function in such a way that it accepts a 4-tuple. In addition, uppercase identifiers like <code>FirstName</code> refer to types and type constructors, while you want lowercase identifiers like <code>firstName</code> which refer to functions and variables. So you should do this instead:</p>\n\n<pre><code>studentToString (firstName, surname, age, id) = ...\n</code></pre>\n\n<p>3) You also have a type mismatch on the right hand side of the function definition. The <code>++</code> operator is used to put lists (of the same type) together into a bigger list. It's fine and normal to do this with strings, because Haskell strings are simply lists of characters. (There are performance reasons not to do this if it's for a performance-critical application, or if your strings will be huge - but don't worry about this for simple learning exercises like this.)</p>\n\n<p>But the problem is that <code>age</code> and <code>id</code> will have type <code>Int</code>, not <code>String</code>. You can't use <code>++</code> with them at all - an <code>Int</code> is not a list, and certainly not a list of <code>Char</code>. Unlikely many languages, Haskell will not happily convert numbers to strings for you when used in a \"string context\". It has a static and very strict type system which simply does not allow you to use values of the wrong type at any point. (In other respects the type system can be very flexible, due to typeclasses and polymorphic functions, as you'll discover as you learn more about the language. But converting a numerical type to a string representation is not something it will do for you.)</p>\n\n<p>So you have to do the conversion explicitly - and Haskell has a simple function for this, called <code>show</code>. Without being too technical, it basically converts anything into a string that can reasonably be converted. So, putting this together with all my previous comments, a working version of <code>studentToString</code> would be:</p>\n\n<pre><code>studentToString :: Student -&gt; String\nstudentToString (firstName, surname, age, id) = firstName ++ surname ++ show age ++ show id\n</code></pre>\n\n<p>4) A minor point - the above will compile fine, but for practical purposes you probably want to space out the different parts of the output string:</p>\n\n<pre><code>studentToString :: Student -&gt; String\nstudentToString (firstName, surname, age, id) = firstName ++ \" \" ++ surname ++ \" \" ++ show age ++ \" \" ++ show id\n</code></pre>\n\n<p>5) Moving on now to your second function, <code>studentsToString</code>, there is a fundamental type mismatch in your attempted implementation:</p>\n\n<pre><code>studentsToString :: [Student] -&gt; String\nstudentsToString (x:xs) = putStrLn(studentToString x) ++ studentsToString xs\n</code></pre>\n\n<p>Your type signature proclaims that the output will be a <code>String</code> (as does the name!). Yet <code>putStrLn</code> does <em>not</em> output a <code>String</code>! It outputs a value of type <code>IO ()</code> - without going too deeply into Haskell's type system and how it handles I/O in a pure way, we can say that this is not the same thing, precisely because it has a \"side effect\" (printing some output to the terminal). Nothing in Haskell has any side effects - all values are \"pure\" - except for those whose type begins with <code>IO</code>. Basically a value of type <code>IO ()</code> is an \"action\" that, when executed, does something in the \"outside world\" (in this case, prints something), and returns no useful value of its own. (And note that merely making such an \"action\" in your code does not execute its effects - that does happen though when you run your final program, or output such a value in GHCi.)</p>\n\n<p>So your function is frankly a bit confused. You can either convert the list of students to a string (a pure operation) and then try to output the result. Or you could simply make the function output the result, using a return value of <code>IO ()</code>.</p>\n\n<p>Here, quicky, is how I might do both of these. First, the pure function could be (note how similar it is to your faulty version):</p>\n\n<pre><code>studentsToString :: [Student] -&gt; String\nstudentsToString [] = \"\"\nstudentsToString (x:xs) = studentToString x ++ \", \" ++ studentsToString xs\n</code></pre>\n\n<p>All I have really changed is removing the <code>putStrLn</code> so that you get a \"pure\" <code>String</code> result. I've also added a \"base case\" for the empty list - without this your function will crash because each recursive step acts on a shorter list, and eventually it'll reach the empty list and fail because the <code>(x:xs)</code> pattern doesn't match an empty list.</p>\n\n<p>Finally, and least importantly, I've added some \"padding\" between each output value, so they don't all run on together. I've chosen a comma and space, but this is arbitrary. You may prefer a newline - or indeed anything else.</p>\n\n<p>Having done that, you can just run <code>putStrLn (studentsToString testData)</code> in GHCi, to output the result. (Although the <code>putStrLn</code> isn't necessary, GHCi always prints any expression you give it.)</p>\n\n<p>Finally, here is a very simple - and slightly more advanced - way in which you could output the test data, one student on each line:</p>\n\n<pre><code>mapM_ (putStrLn . studentToString) testData\n</code></pre>\n\n<p>To understand this fully you have to know a bit about Monads - which, trust me, are not as scary as they sound - but it basically makes an \"action\" (like a small program) that \"loops\" over the <code>testData</code> list, applies <code>studentToString</code> to each element, and prints each on a new line.</p>\n"}], "owner": {"reputation": 25, "user_id": 7475856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4b5d256809beba4df4e68efeb8d60b?s=128&d=identicon&r=PG&f=1", "display_name": "Dilly", "link": "https://stackoverflow.com/users/7475856/dilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554847756, "creation_date": 1554752426, "question_id": 55580638, "link": "https://stackoverflow.com/questions/55580638/output-each-type-from-type-list-on-a-seperate-line", "title": "Output each type from type list on a seperate line", "body": "<pre><code>type FirstName = String\ntype Surname = String\ntype Age = Int\ntype Id = Int\ntype Student = (FirstName, Surname, Age, Id)\ntestData :: [Student]\ntestData = [(\"Garry\", \"Queen\", 10, 1),\n    (\"Jerry\", \"Bob\", 11, 2),\n    (\"Amy\", \"Big\", 9, 3)]\n</code></pre>\n\n<p>I am trying to output each students information on a new line using the testData.\nHow would I go about doing this?</p>\n\n<p>I tried this but it doesn't work.</p>\n\n<pre><code>studentToString :: Student FirstName Surname Age Id -&gt; String\nstudentToString (Student FirstName Surname Age Id) = FirstName ++ Surname ++ Age ++ Id\n\nstudentsToString :: [Student] -&gt; String\nstudentsToString (x:xs) = putStrLn(studentToString x) ++ studentsToString xs\n</code></pre>\n\n<p>It gave me an error </p>\n\n<pre><code>error: Not in scope: data constructor \u2018Student\u2019\n</code></pre>\n\n<p>for this line</p>\n\n<pre><code>studentToString :: Student FirstName Surname Age Id -&gt; String\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 3, "creation_date": 1554750493, "post_id": 55580150, "comment_id": 97858855, "body": "&quot;I feel like I do not use anything with the Eq =&gt; function.&quot; You&#39;re using <code>==</code>, which is defined in the <code>Eq</code> typeclass. If you didn&#39;t have the <code>Eq</code> constraint, you couldn&#39;t use <code>==</code>. So you <i>are</i> using <code>Eq</code> properly."}, {"owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1554750576, "post_id": 55580150, "comment_id": 97858892, "body": "So when I use Eq it lets me use ==, same for + , - etc ?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 4, "creation_date": 1554750672, "post_id": 55580150, "comment_id": 97858933, "body": "<code>+</code> and <code>-</code> are defined in <code>Num</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1554750709, "post_id": 55580150, "comment_id": 97858945, "body": "A typeclass is a collection of function names (and their types). The <code>Eq</code> class provides the <code>==</code> function name. An instance of a typeclass is an implementation of those named functions for a specific type. So when you say <code>Eq a =&gt; [a]</code>, what you are saying is &quot;Lists whose element type has a defined <code>==</code> function&quot;. When you say <code>Num a =&gt; a</code>, what you are saying is &quot;a type that has implemented <code>+</code> and <code>*</code> and the other functions of <code>Num</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554750765, "post_id": 55580150, "comment_id": 97858968, "body": "<code>Eq</code> is used only for <code>Eq</code>uality. If you want to treat something like a <code>Num</code>ber, use <code>Num</code> (in certain cases). If you want to see information about a typeclass, type <code>:info &lt;class&gt;</code> in GHCi, for instance <code>:info Eq</code>."}, {"owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 0, "creation_date": 1554750829, "post_id": 55580150, "comment_id": 97859004, "body": "Thank you all. Can someone please show it over my function and tell what am I doing wrong?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1554750883, "post_id": 55580150, "comment_id": 97859030, "body": "Your problem is not related to the <code>Eq</code> typeclass. You could see this by changing its type to use a concrete type that implements <code>Eq</code>, for example <code>f :: [Int] -&gt; [[Int]]</code>. You will still have the same problem, and there is no <code>Eq</code> around."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1554751372, "post_id": 55580375, "comment_id": 97859268, "body": "I would have to see the new code in context along with an error message to know why it doesn&#39;t compile. But the good news is that you now have a new problem to solve, and that is progress! (OP had reported that adding <code>f[x]=[[x]]</code> gave an error.)"}, {"owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 0, "creation_date": 1554751428, "post_id": 55580375, "comment_id": 97859289, "body": "Thank you, let me edit my question so you can see the current code"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 3, "creation_date": 1554751457, "post_id": 55580375, "comment_id": 97859301, "body": "Please don&#39;t edit questions into different questions. This will make all of the current work irrelevant and confuse people who may see it later. Please post a new question."}, {"owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 0, "creation_date": 1554751525, "post_id": 55580375, "comment_id": 97859330, "body": "Sure, I just added a new line thats it. The question stayed the same. Should I still open a new question for that ?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 0, "creation_date": 1554751535, "post_id": 55580375, "comment_id": 97859335, "body": "No, that&#39;s ok. In response to your edit, <code>f x:[]</code> is not the same thing as <code>f [x]</code> or <code>f (x:[])</code> and will not work."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 0, "creation_date": 1554751595, "post_id": 55580375, "comment_id": 97859363, "body": "(The parens are required here.)"}, {"owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "edited": false, "score": 0, "creation_date": 1554751764, "post_id": 55580375, "comment_id": 97859431, "body": "Added parentheses, it compiles but still do not considers the last element. Also, for [1,1,1,2] it will output [[1,1],[1]] :("}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 4, "last_activity_date": 1554751133, "creation_date": 1554751133, "answer_id": 55580375, "question_id": 55580150, "link": "https://stackoverflow.com/questions/55580150/eq-function-in-haskell/55580375#55580375", "title": "Eq =&gt; function in Haskell", "body": "<p>The presence of the <code>Eq</code> typeclass in your type is a red herring: it is not related to the error you report. The error you report happens because you have defined how the function should behave when the list is empty (<code>f [] =</code>) and when the list has at least two elements (<code>f (x:x':xs) =</code>), but not when the list has exactly one element. The solution will be to add a case that begins*</p>\n\n<pre><code>f [x] = ????\n</code></pre>\n\n<p>and decide how to deal with one-element lists. Or to find some other way to write the function that deals with all of its cases.</p>\n\n<hr>\n\n<p>* Note that <code>f [x]</code> is the same thing as <code>f (x:[])</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 1, "last_activity_date": 1554781635, "creation_date": 1554781635, "answer_id": 55584833, "question_id": 55580150, "link": "https://stackoverflow.com/questions/55580150/eq-function-in-haskell/55584833#55584833", "title": "Eq =&gt; function in Haskell", "body": "<p>You can also use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:span\" rel=\"nofollow noreferrer\"><code>span</code></a> and a recursive call to make it work:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [[a]]\nf [] = []\nf l@(x:xs) = grouped : f remainder\n    where\n        (grouped, remainder) = span (== x) l\n</code></pre>\n\n<p>Here you have the <a href=\"https://repl.it/repls/CheerfulStupidTrigger\" rel=\"nofollow noreferrer\">live example</a></p>\n"}], "owner": {"reputation": 695, "user_id": 9733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f81e5b70f7650bb2ec38ef326bd0d67?s=128&d=identicon&r=PG&f=1", "display_name": "I.zv", "link": "https://stackoverflow.com/users/9733887/i-zv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554781635, "creation_date": 1554750284, "last_edit_date": 1554752160, "question_id": 55580150, "link": "https://stackoverflow.com/questions/55580150/eq-function-in-haskell", "title": "Eq =&gt; function in Haskell", "body": "<p>I am trying to figure out how to write this function with the Eq function in Haskell.</p>\n\n<p>An easy function that I am trying to implement is:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>Where f will gather each repeated consecutive elements under separate sub-lists, For example:</p>\n\n<pre><code>f [3] = [[3]]\nf [1,1,1,3,2,2,1,1,1,1] = [[1,1,1],[3],[2,2],[1,1,1,1]]\n</code></pre>\n\n<p>I thought about this function:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [[a]]\nf [] = []\nf (x:[]) = [[x]]\nf (x:x':xs) = if x == x' then [[x, x']] ++ (f (xs))\n                    else [[x]] ++ (bundler (xs))\n</code></pre>\n\n<p>It seems to not work well since when it arrives to the last element, it wants to compare it to its consecutive, which clearly does not exist. </p>\n\n<p>Moreover, I feel like I do not use anything with the Eq => function.</p>\n\n<p>I would like to receive an answer that will show how to use Eq properly in my case. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1554743070, "post_id": 55577897, "comment_id": 97855372, "body": "This is getting to be an FAQ. GHC doesn&#39;t look at instance constraints when resolving overlap. Only the part to the right of the double arrow is considered. Since those are the same for your instances, they&#39;ll be rejected."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554743139, "post_id": 55577897, "comment_id": 97855406, "body": "Also: You&#39;ve linked to the manual for GHC 7.6.3, which is now quite old. Did you do that on purpose?"}, {"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554745208, "post_id": 55577897, "comment_id": 97856353, "body": "No, I thought it was a chapter... I am going to read the one for the version I have."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554746648, "post_id": 55577897, "comment_id": 97857041, "body": "It also seems peculiar that a <code>Monad</code> instance would have any use for a <code>Show</code> constraint. What are you trying to accomplish with that?"}, {"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554754037, "post_id": 55577897, "comment_id": 97860466, "body": "I would like fail to be able to &quot;print&quot; the state I am at. I will update my post to show this."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554754694, "post_id": 55577897, "comment_id": 97860721, "body": "Unfortunately, you can&#39;t always get what you want. You can overlap for <i>specific</i> types, but not for classes. And I think you should think twice and thrice before overlapping, and then think again. It can come back to bite you."}, {"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554755046, "post_id": 55577897, "comment_id": 97860848, "body": "Ok, thanks. It&#39;s still a pickle."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554759466, "post_id": 55577897, "comment_id": 97862445, "body": "Side note: these days, it&#39;s probably better to use <code>MonadFail</code> for <code>fail</code> rather than <code>Monad</code>. That means enabling <code>-XMonadFailDesugaring</code> and defining a <code>MonadFail</code> instance. If I were you, I&#39;d either 1. Give the <code>MonadFail (Parse m a)</code> a <code>Show a</code> constraint, and offer a custom failure function that <i>doesn&#39;t</i> show the state, or 2. Leave the instance unconstrained and offer a custom failure function that shows the state. Option (2) seems much cleaner. It would be my choice, especially because knowing only the parser state doesn&#39;t really seem likely to be very helpful when (cont)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554759489, "post_id": 55577897, "comment_id": 97862458, "body": "(cont) there&#39;s a pattern match failure and you can&#39;t see what failed to match."}], "owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554754873, "creation_date": 1554741188, "last_edit_date": 1554754873, "question_id": 55577897, "link": "https://stackoverflow.com/questions/55577897/problem-getting-language-pragma-overlapping-to-work", "title": "Problem getting language pragma OVERLAPPING to work", "body": "<p>I cannot get the following instances to work :</p>\n\n<pre><code>newtype ParseState a = ParseState {\n  state :: a\n} deriving (Show)\n\nnewtype Parse m a b = Parse { -- In monad m, parsing from state a to b\n  runParse :: ParseState a -&gt; m (b,ParseState a)\n}\n\ninstance Monad m =&gt; Monad (Parse m a) where\n  parser &gt;&gt;= f = Parse $ \\s -&gt; do\n    (result,s') &lt;- runParse parser s\n    runParse (f result) s'\n\ninstance {-# OVERLAPPING #-} (Monad m, Show a) =&gt; Monad (Parse m a) where\n  (&gt;&gt;=) = -- same definition as above\n  fail err = Parse $ \\s -&gt;\n    fail $ \"Parsing error while at\" ++ (show s) ++ \" : \" ++ err\n</code></pre>\n\n<p>GHC gives me the error \"Duplicate instance declarations\". <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/type-class-extensions.html\" rel=\"nofollow noreferrer\">Section 7.6.3.4 of GHC manual</a> seems to allow for such constructs, doesn't it ?</p>\n\n<p>If not, how can I get around it ?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1554735917, "post_id": 55576395, "comment_id": 97851704, "body": "<code>maybe something like map snd from each tuple</code> - did you try what you have suggested?"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1554744896, "post_id": 55576395, "comment_id": 97856213, "body": "If you want to try it again but this time without help you can try to get the same result using list-comprehension."}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 7771744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NA1zH.jpg?s=128&g=1", "display_name": "Popplar", "link": "https://stackoverflow.com/users/7771744/popplar"}, "edited": false, "score": 0, "creation_date": 1554736673, "post_id": 55576442, "comment_id": 97852127, "body": "Thanks a lot chepner, this worked &#39;textos = map snd&#39; since the list was coming as parameter. Can I ask you, if you dont mind, the firm of that function? &#39;textos:: [a] -&gt;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 233, "user_id": 7771744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NA1zH.jpg?s=128&g=1", "display_name": "Popplar", "link": "https://stackoverflow.com/users/7771744/popplar"}, "edited": false, "score": 5, "creation_date": 1554736978, "post_id": 55576442, "comment_id": 97852293, "body": "You know more about the input than that it is a list of some unknown type; you know that it&#39;s a list of <i>tuples</i>. <code>textos :: [(a,b)] -&gt; [b]</code>. You can see that by running <code>:t map snd</code> in GHCi."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1554735907, "creation_date": 1554735907, "answer_id": 55576442, "question_id": 55576395, "link": "https://stackoverflow.com/questions/55576395/given-a-list-how-to-map-the-second-value-of-each-element-from-that-list/55576442#55576442", "title": "Given a list, how to map the second value of each element from that list?", "body": "<p>It's just <code>map snd yourList</code>:</p>\n\n<pre><code>&gt; map snd [(\"@elBarto\", \"yo no fui\"), (\"@krusty\", \"yo tampoco\"), (\"@pedro\", \"tal vez\")]\n[\"yo no fui\",\"yo tampoco\",\"tal vez\"]\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 7771744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NA1zH.jpg?s=128&g=1", "display_name": "Popplar", "link": "https://stackoverflow.com/users/7771744/popplar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55576442, "answer_count": 1, "score": -4, "last_activity_date": 1554735907, "creation_date": 1554735785, "question_id": 55576395, "link": "https://stackoverflow.com/questions/55576395/given-a-list-how-to-map-the-second-value-of-each-element-from-that-list", "title": "Given a list, how to map the second value of each element from that list?", "body": "<p>Given a list, lets say <code>[(\"@elBarto\", \"yo no fui\"), (\"@krusty\", \"yo tampoco\"), (\"@pedro\", \"tal vez\")]</code>\n, I need a function that get the second value of each element from that list  <code>[\"yo no fui\", \"yo tampoco\", \"tal vez\"]</code>.\nFrom what I can tell, the list contains tuples so I can use snd from each one. The return is should be a mapped list but I can't get how to do it, maybe something like map snd from each tuple..</p>\n"}, {"tags": ["if-statement", "haskell"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1554731286, "post_id": 55574876, "comment_id": 97848740, "body": "Haskell uses indentation and spacing to indicate scope of expressions. Your <code>if</code> statement is indented in such a way that indicates that it is outside of the <code>where</code> clause."}, {"owner": {"reputation": 321, "user_id": 7258019, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd67072fa5a339883959902b8350894e?s=128&d=identicon&r=PG&f=1", "display_name": "Dani Kemper", "link": "https://stackoverflow.com/users/7258019/dani-kemper"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1554731604, "post_id": 55574876, "comment_id": 97848955, "body": "Do I need to put the if and else statement underneath the where statement, or what?"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 7258019, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd67072fa5a339883959902b8350894e?s=128&d=identicon&r=PG&f=1", "display_name": "Dani Kemper", "link": "https://stackoverflow.com/users/7258019/dani-kemper"}, "edited": false, "score": 0, "creation_date": 1554732088, "post_id": 55575096, "comment_id": 97849277, "body": "Thank you for you explanation, if I run this and use 10 for x it won&#39;t work. But if I use 4 for x it will. How is this possible and how can we fix this?"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 321, "user_id": 7258019, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd67072fa5a339883959902b8350894e?s=128&d=identicon&r=PG&f=1", "display_name": "Dani Kemper", "link": "https://stackoverflow.com/users/7258019/dani-kemper"}, "edited": false, "score": 0, "creation_date": 1554732215, "post_id": 55575096, "comment_id": 97849356, "body": "Well, your original program only works for exact powers of <code>2</code> right? One way to improve it would be to write <code>&gt;=</code> instead of <code>==</code>, then at least it will halt for <code>10</code>. But you&#39;ll need something more complicated than adding <code>1</code> each iteration to find exact logarithms."}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 3, "last_activity_date": 1554731671, "creation_date": 1554731671, "answer_id": 55575096, "question_id": 55574876, "link": "https://stackoverflow.com/questions/55574876/haskell-compare-two-int-with-if-statement/55575096#55575096", "title": "Haskell compare two int with if statement", "body": "<p>It is difficult to explain precisely why the syntax error arises, given that it is not obvious to what (valid) syntax it is intended to correspond. Suffice to say you have essentially written <code>log2 x = 0</code> <code>if .....</code>. One might expect the second phrase to be a definition or part of the same expression as the <code>0</code>, but <code>if</code> begins neither.</p>\n\n<p>More generally, Haskell does not have mutable variables. You cannot \"assign\" to <code>y</code>. The closest to what you want would be something like,</p>\n\n<p><code>log2 x = until (\\y -&gt; x == 2^y) (\\y -&gt; y + 1) 0</code></p>\n\n<p>Notice that we are never assigning to <code>y</code>, we simply bind it to execute each lambda expression. We can imagine it receiving a different name each time! and that would be fine.</p>\n"}], "owner": {"reputation": 321, "user_id": 7258019, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd67072fa5a339883959902b8350894e?s=128&d=identicon&r=PG&f=1", "display_name": "Dani Kemper", "link": "https://stackoverflow.com/users/7258019/dani-kemper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 55575096, "answer_count": 1, "score": -1, "last_activity_date": 1554731671, "creation_date": 1554731000, "question_id": 55574876, "link": "https://stackoverflow.com/questions/55574876/haskell-compare-two-int-with-if-statement", "title": "Haskell compare two int with if statement", "body": "<p>I want to implement a function named log2, which computes the integer log (base 2) of its argument. I can't use log function. My solution is: to check if x equals to 2^y. If x equals 2^y give the value y, if x doesn't equals to 2^y then y = y + 1. This will go on until y is found. This is what I got so far: </p>\n\n<pre><code>log2 x = y where y = 0\n    if x == 2^y then y\n    else y = y + 1\n</code></pre>\n\n<p>When I want to run this I will get this error: </p>\n\n<blockquote>\n  <p>error: parse error on input `if'</p>\n</blockquote>\n\n<p>I am new to Haskell so can somebody explain me what's wrong?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1554723960, "post_id": 55571674, "comment_id": 97844043, "body": "Have you tried reading the documentation for stack?"}, {"owner": {"reputation": 5584, "user_id": 10315163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a6e3f2d130ac5f5672a9e474f92da?s=128&d=identicon&r=PG&f=1", "display_name": "Ynjxsjmh", "link": "https://stackoverflow.com/users/10315163/ynjxsjmh"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554727689, "post_id": 55571674, "comment_id": 97846328, "body": "Thanks for your advice, I didn&#39;t think of this, cause Google doesn&#39;t give me any related links. I will look for it now."}], "answers": [{"comments": [{"owner": {"reputation": 5584, "user_id": 10315163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a6e3f2d130ac5f5672a9e474f92da?s=128&d=identicon&r=PG&f=1", "display_name": "Ynjxsjmh", "link": "https://stackoverflow.com/users/10315163/ynjxsjmh"}, "edited": false, "score": 0, "creation_date": 1554727522, "post_id": 55572783, "comment_id": 97846212, "body": "Thanks for your answer. But after running <code>ghc -v</code>, the output seems quite different from what I want. I edited the question, could you please take a look at it?"}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 5584, "user_id": 10315163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a6e3f2d130ac5f5672a9e474f92da?s=128&d=identicon&r=PG&f=1", "display_name": "Ynjxsjmh", "link": "https://stackoverflow.com/users/10315163/ynjxsjmh"}, "edited": false, "score": 0, "creation_date": 1554728681, "post_id": 55572783, "comment_id": 97847018, "body": "I&#39;m not sure I understand, does maybe <code>cabal</code> or <code>ghc-pkg</code> produce what you want?"}, {"owner": {"reputation": 5584, "user_id": 10315163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a6e3f2d130ac5f5672a9e474f92da?s=128&d=identicon&r=PG&f=1", "display_name": "Ynjxsjmh", "link": "https://stackoverflow.com/users/10315163/ynjxsjmh"}, "edited": false, "score": 0, "creation_date": 1554729319, "post_id": 55572783, "comment_id": 97847396, "body": "There seems not cabal command on my machine.  <code>ghc-pkg list</code> outputs the files in <code>\\package.conf.d</code> which I have listed in my update."}], "tags": [], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "is_accepted": false, "score": 0, "last_activity_date": 1554724154, "creation_date": 1554724154, "answer_id": 55572783, "question_id": 55571674, "link": "https://stackoverflow.com/questions/55571674/how-to-use-v-to-see-a-list-of-the-files-searched-for-in-haskell-stack/55572783#55572783", "title": "How to use -v to see a list of the files searched for in Haskell Stack", "body": "<p>It looks like you're trying to call it from the prelude. It is actually a command for the compiler itself, so if you open your terminal/console try to run <code>ghc -v</code>. (I assumed you're using GHC as you tagged your question <a href=\"/questions/tagged/haskell-stack\" class=\"post-tag\" title=\"show questions tagged &#39;haskell-stack&#39;\" rel=\"tag\">haskell-stack</a>.)</p>\n"}, {"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 4, "last_activity_date": 1554748135, "creation_date": 1554748135, "answer_id": 55579666, "question_id": 55571674, "link": "https://stackoverflow.com/questions/55571674/how-to-use-v-to-see-a-list-of-the-files-searched-for-in-haskell-stack/55579666#55579666", "title": "How to use -v to see a list of the files searched for in Haskell Stack", "body": "<p>Assuming you started GHCi with <code>stack ghci</code>, you can pass the <code>-v</code> option with <code>stack ghci --ghc-options -v</code>.  </p>\n\n<p>Stack passes GHC a list of folders where stack installs packages, and where GHC should therefore look for Haskell modules.  So to get useful output from GHC, it's usually necessary to invoke it through <code>stack</code>, as above.  The situation is analogous for <code>cabal</code> and other build tools.</p>\n"}], "owner": {"reputation": 5584, "user_id": 10315163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a6e3f2d130ac5f5672a9e474f92da?s=128&d=identicon&r=PG&f=1", "display_name": "Ynjxsjmh", "link": "https://stackoverflow.com/users/10315163/ynjxsjmh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 55579666, "answer_count": 2, "score": 2, "last_activity_date": 1554748135, "creation_date": 1554720471, "last_edit_date": 1554727480, "question_id": 55571674, "link": "https://stackoverflow.com/questions/55571674/how-to-use-v-to-see-a-list-of-the-files-searched-for-in-haskell-stack", "title": "How to use -v to see a list of the files searched for in Haskell Stack", "body": "<p>I have some Haskell code below.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Determine the prime factors of a given positive integer.\n\nmodule P36 where\nimport Data.List\nimport Data.Numbers (primeFactors)\n\nprime_factors_mult :: Integer -&gt; [(Integer, Int)]\nprime_factors_mult = map encode . group . primeFactors\n    where encode xs = (head xs, length xs)\n</code></pre>\n\n<p>I run it in ghci, it gives me the output:</p>\n\n<pre><code>Prelude&gt; :l P36\n[1 of 1] Compiling P36              ( P36.hs, interpreted )\n\nP36.hs:5:1: error:\n    Failed to load interface for \u2018Data.Numbers\u2019\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I know it's because I don't have <code>Data.Numbers</code> installed. I have solved it by running <code>stack install Numbers</code>.</p>\n\n<p>But I can't figure out what does <strong>Use -v to see a list of the files searched for.</strong> mean.</p>\n\n<p>I Google a lot and I have tried using <code>:l P36 -v</code> and <code>stack -v</code>. But none of those executed right.</p>\n\n<p>My question is <strong>How to use -v to see a list of the files searched for.</strong></p>\n\n<p>----- <strong>Update</strong> ------</p>\n\n<p>After running <code>ghc -v</code> in console, it shows</p>\n\n<pre><code>C:\\Users\\Administrator&gt;ghc -v\nGlasgow Haskell Compiler, Version 8.6.3, stage 2 booted by GHC version 8.4.3\nUsing binary package database: C:\\Users\\Administrator\\AppData\\Local\\Programs\\sta\nck\\x86_64-windows\\ghc-8.6.3\\lib\\package.conf.d\\package.cache\npackage flags []\nloading package database C:\\Users\\Administrator\\AppData\\Local\\Programs\\stack\\x86\n_64-windows\\ghc-8.6.3\\lib\\package.conf.d\nwired-in package ghc-prim mapped to ghc-prim-0.5.3\nwired-in package integer-gmp mapped to integer-gmp-1.0.2.0\nwired-in package base mapped to base-4.12.0.0\nwired-in package rts mapped to rts\nwired-in package template-haskell mapped to template-haskell-2.14.0.0\nwired-in package ghc mapped to ghc-8.6.3\n*** Deleting temp files:\nDeleting:\n*** Deleting temp dirs:\nDeleting:\nghc: no input files\nUsage: For basic information, try the `--help' option.\n</code></pre>\n\n<p>But I have seen a post <a href=\"https://stackoverflow.com/questions/40998196/error-failed-to-load-interface-for-data-either-utils\">Error: \u201cFailed to load interface for 'Data.Either.Utils'\u201d\n</a> which got a result of running with -v. It's</p>\n\n<pre><code>Using a sandbox located at\n/Users/myuser/Desktop/mydirectory/myotherdirectory/.cabal-sandbox\n/usr/local/bin/ghc --print-global-package-db\n/usr/local/bin/runghc filename.hs\n</code></pre>\n\n<p>I check the path <code>C:\\Users\\Administrator\\AppData\\Local\\Programs\\stack\\x86\n_64-windows\\ghc-8.6.3\\lib\\package.conf.d</code> and find it has many <code>.conf</code> files.</p>\n\n<pre><code>C:.\n    array-0.5.3.0.conf\n    base-4.12.0.0.conf\n    binary-0.8.6.0.conf\n    bytestring-0.10.8.2.conf\n    Cabal-2.4.0.1.conf\n    containers-0.6.0.1.conf\n    deepseq-1.4.4.0.conf\n    directory-1.3.3.0.conf\n    .....\n</code></pre>\n\n<p>Are these the files searched by Haskell?</p>\n\n<p>Is my output with <code>ghc -v</code> reasonable? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1554701180, "last_edit_date": 1554701180, "creation_date": 1554700808, "answer_id": 55566689, "question_id": 55566397, "link": "https://stackoverflow.com/questions/55566397/how-many-fmaps-does-it-take/55566689#55566689", "title": "How many fmaps does it take?", "body": "<p>Infinite. The following term loops your rewriter:</p>\n\n<pre><code>FMap :@ ((FMap :@ (FMap :@ FMap)) :@ FMap)\n</code></pre>\n\n<p>It does so in just three steps, which are:</p>\n\n<pre><code>((FMap :@ FMap) :@ (FMap :@ (FMap :@ FMap))) :@ FMap\n(((FMap :@ (FMap :@ FMap)) :@ FMap) :@ (FMap :@ FMap)) :@ FMap\n(((FMap :@ ((FMap :@ (FMap :@ FMap)) :@ FMap)) :@ FMap) :@ FMap) :@ FMap\n</code></pre>\n\n<p>This last has the original term at its head. (The original looping term itself arises after six steps of rewriting your <code>BAR :@ (FMap :@ (FMap :@ F) :@ L)</code>.)</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 55566689, "answer_count": 1, "score": 4, "last_activity_date": 1554701180, "creation_date": 1554698791, "question_id": 55566397, "link": "https://stackoverflow.com/questions/55566397/how-many-fmaps-does-it-take", "title": "How many fmaps does it take?", "body": "<p>A <a href=\"https://stackoverflow.com/questions/55564018/is-fmap-f-the-same-as-f-if-f-is-a-function-of-type-a-b#comment97828453_55564018\">comment</a> by Daniel Wagner led me to this question. Let's start with an over-simplification. Suppose you have a type</p>\n\n<pre><code>data Foo a = Foo [a]\n</code></pre>\n\n<p>Then you can write the <code>Functor</code> instance</p>\n\n<pre><code>instance Functor Foo where\n  fmap f (Foo l) = Foo (fmap f l)\n</code></pre>\n\n<p>You can rewrite the right hand side as</p>\n\n<pre><code>Foo . fmap f $ l\n</code></pre>\n\n<p>Recognizing that for <code>(-&gt;) a</code>, <code>fmap = (.)</code>, you can write it</p>\n\n<pre><code>fmap Foo (fmap f) l\n</code></pre>\n\n<p>Repeating, you get</p>\n\n<pre><code>fmap (fmap Foo) fmap f l\n</code></pre>\n\n<p>And so, finally,</p>\n\n<pre><code>fmap f (Foo l) =\n  fmap fmap fmap Foo fmap f l\n</code></pre>\n\n<hr>\n\n<p>What if you pick a slightly more complex functor?</p>\n\n<pre><code>data Bar = Bar [Maybe a]\n\ninstance Functor Bar where\n  fmap f (Bar l) = Bar (fmap (fmap f) l)\n</code></pre>\n\n<p>I started doing this by hand, but it started to get out of control, so I switched to automatic.</p>\n\n<pre><code>infixl 9 :@\ndata Expr\n  = BAR | F | L | FMap | Expr :@ Expr\n  deriving (Show)\n\nrewrite :: Expr -&gt; Expr\nrewrite (p :@ (q :@ r))\n  = rewrite $ FMap :@ p :@ q :@ r\nrewrite (p :@ q) = rewrite p :@ q\nrewrite e = e\n\nmain = print $ rewrite $\n  BAR :@ (FMap :@ (FMap :@ F) :@ L)\n</code></pre>\n\n<p>Unfortunately, this seems to produce an utterly enormous result. I couldn't even calculate the leftmost leaf of the tree in a reasonable amount of time. Just how big an expression does this make? How quickly does it grow as more functors are layered on?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1554692337, "post_id": 55565167, "comment_id": 97830705, "body": "Are you using Stack 1.9.3?"}], "answers": [{"tags": [], "owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "is_accepted": false, "score": 1, "last_activity_date": 1554693617, "last_edit_date": 1554693617, "creation_date": 1554693292, "answer_id": 55565765, "question_id": 55565167, "link": "https://stackoverflow.com/questions/55565167/building-a-specific-library-with-stack/55565765#55565765", "title": "Building a Specific Library with Stack?", "body": "<p>Unfortunately, <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#developing-packages\" rel=\"nofollow noreferrer\">you can't write multiple <code>library</code>s in one cabal file</a>.\nSo you have to make one cabal file per library (usually make one directory per one cabal file).</p>\n\n<p>Then, list them up in the stack.yaml:</p>\n\n<pre><code>packages:\n- your-main-library\n- generate\n</code></pre>\n\n<p>Then, run <code>stack &lt;the-library-to-build&gt;</code> to build a specific library:</p>\n\n<pre><code>stack build generate\n</code></pre>\n\n<p>FYI. Here's a project which contains several libraries: <a href=\"https://github.com/iij-ii/direct-hs\" rel=\"nofollow noreferrer\">https://github.com/iij-ii/direct-hs</a></p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554693617, "creation_date": 1554686761, "question_id": 55565167, "link": "https://stackoverflow.com/questions/55565167/building-a-specific-library-with-stack", "title": "Building a Specific Library with Stack?", "body": "<p>I have a Haskell stack project whose cabal file is divided as follows:</p>\n\n<pre><code>library\n  exposed-modules:\n      Godot.Api\n      Godot.Api.Auto\n-- ...\n\n\nlibrary generate \n  exposed-modules:\n      Generate\n      Spec\n      Types\n      Types.Internal\n-- ...\n</code></pre>\n\n<p>When I run <code>stack build</code> it seems to only build the first <code>library</code>, but what I want stack to do is build <em>just</em> <code>library generate</code>. How do I do this? The following doesn't seem to work:</p>\n\n<pre><code>stack build project-name:library:generate # doesn't seem to work\nstack build project-name:lib:generate # doesn't seem to work\n</code></pre>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1554674381, "post_id": 55564018, "comment_id": 97827795, "body": "<code>fmap f</code> is indeed the same as <code>(f .)</code> if the functor being talked about is functions (<code>(-&gt;) r</code> as it&#39;s usually denoted)."}, {"owner": {"reputation": 355, "user_id": 3150464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6994392ca8aa3dc2bc3cfbf83e02044e?s=128&d=identicon&r=PG&f=1", "display_name": "klabe", "link": "https://stackoverflow.com/users/3150464/klabe"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554674486, "post_id": 55564018, "comment_id": 97827824, "body": "@RobinZigmond Thanks. So is my solution also correct?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554675101, "post_id": 55564018, "comment_id": 97827954, "body": "I believe so, yes. (But I&#39;m not an expert and don&#39;t have time right now to check in detail.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554675295, "post_id": 55564018, "comment_id": 97827997, "body": "They are both correct indeed (cc @RobinZigmond)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1554677666, "post_id": 55564018, "comment_id": 97828453, "body": "...and you can even replace <code>map</code> with <code>fmap</code> to make it funnier to read. <code>fmap f (Con2 l) = Con2 (fmap (fmap (fmap f)) l)</code>. And then decide it would be even funnier with more <code>fmap</code>s, and that <code>fmap (fmap (fmap f))</code> is <code>fmap . fmap . fmap $ f</code>, and that <code>(.)</code> is <code>fmap</code>, so <code>Con2 (fmap fmap (fmap fmap fmap) f l)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554690050, "post_id": 55564018, "comment_id": 97830361, "body": "@DanielWagner, I don&#39;t think you&#39;ve gone far enough. I&#39;m pretty sure it&#39;s possible to write <code>fmap f (Con2 l) = fmap fmap ... fmap Con2 fmap fmap ... fmap f l</code> where the first batch of <code>fmap</code>s is extremely long, and I believe the second batch is fairly short. It would be interesting to calculate how many are required."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554695302, "post_id": 55564018, "comment_id": 97831220, "body": "@DanielWagner, actually ... that will end up so enormous that there&#39;s little chance it could be compiled. But you can definitely add a lot more <code>fmap</code>s."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554699245, "post_id": 55564018, "comment_id": 97832001, "body": "@DanielWagner, I&#39;ve <a href=\"https://stackoverflow.com/questions/55566397/how-many-fmaps-does-it-take\">asked a question</a> about this."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554726267, "post_id": 55564018, "comment_id": 97845437, "body": "For fun, you can let the predefined notion of functor composition do this for you. From <code>Data.Functor.Compose</code>, the newtype <code>Compose</code> has a functor instance. <code>fmap f (Con2 l) = Con2 . getCompose . getCompose . fmap f . Compose . Compose $ l</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554753592, "post_id": 55564018, "comment_id": 97860280, "body": "@klabe In my opinion, not only you solution is correct, but is also more readable than the other. You essentially need to &quot;lift&quot; <code>f :: b-&gt;b&#39;</code> through two functors, <code>a -&gt;</code> and <code>Maybe</code>, so using two <code>fmap</code>s feels very natural to me. I would also like <code>fmap (fmap (fmap f))</code>, since <code>[]</code> is a third functor. (Of course, the simplest is to write <code>deriving Functor</code> and let GHC do it for us, but writing functor instances by hand is very useful to learn how functor work)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554753697, "post_id": 55564018, "comment_id": 97860317, "body": "@DanielWagner, you disproved my conjecture, but you can still write <code>fmap f (Con2 l) = Con2 $ fmap fmap fmap fmap fmap fmap fmap fmap f l</code>."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1554692508, "post_id": 55564192, "comment_id": 97830730, "body": "I wish the syntax <code>(r -&gt;)</code> were allowed, since I\u2019ve seen people misread <code>(-&gt;) r</code> as a function <i>to</i> <code>r</code> instead of <i>from</i> \u2014trouble is, it suggests <code>(-&gt; r)</code> would be allowed, which it can\u2019t be, since it\u2019d affect decidability of unification for higher-kinded types. Whomp."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1554719445, "post_id": 55564192, "comment_id": 97841434, "body": "That would be helpful indeed, @JonPurdy"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 6, "last_activity_date": 1554675671, "creation_date": 1554675671, "answer_id": 55564192, "question_id": 55564018, "link": "https://stackoverflow.com/questions/55564018/is-fmap-f-the-same-as-f-if-f-is-a-function-of-type-a-b/55564192#55564192", "title": "Is (fmap f) the same as (f .) if f is a function of type a-&gt;b?", "body": "<p>The solutions are indeed equivalent. <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-818\" rel=\"noreferrer\"><code>fmap</code> for the function/reader functor</a> is <code>(.)</code>:</p>\n\n<pre><code>instance Functor ((-&gt;) r) where\n    fmap = (.)\n</code></pre>\n\n<p>(<code>(-&gt;) r</code> is the function type constructor being used with prefix syntax -- <code>(-&gt;) r a</code> is the same as <code>r -&gt; a</code>.)</p>\n\n<p>The intuition is that, as you have noted, <code>(.) :: (x -&gt; y) -&gt; (a -&gt; x) -&gt; (a -&gt; y)</code> uses a <code>x -&gt; y</code> function to modify the results of an <code>a -&gt; x</code> function.</p>\n"}], "owner": {"reputation": 355, "user_id": 3150464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6994392ca8aa3dc2bc3cfbf83e02044e?s=128&d=identicon&r=PG&f=1", "display_name": "klabe", "link": "https://stackoverflow.com/users/3150464/klabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 55564192, "answer_count": 1, "score": 7, "last_activity_date": 1554675671, "creation_date": 1554674080, "question_id": 55564018, "link": "https://stackoverflow.com/questions/55564018/is-fmap-f-the-same-as-f-if-f-is-a-function-of-type-a-b", "title": "Is (fmap f) the same as (f .) if f is a function of type a-&gt;b?", "body": "<p>I am trying to implement a Functor instance of </p>\n\n<pre><code>data ComplicatedA a b\n    = Con1 a b\n    | Con2 [Maybe (a -&gt; b)]\n</code></pre>\n\n<p>For Con2, my thought process was the fmap needs to be something like</p>\n\n<pre><code>fmap f (Con2 xs) = Con2 (map f' xs)\n</code></pre>\n\n<p>then I need to have a list map function f' like</p>\n\n<pre><code>Maybe (a -&gt; x) -&gt; Maybe (a -&gt; y)\n</code></pre>\n\n<p>Since <code>Maybe</code> is a Functor, I can write f' like</p>\n\n<pre><code>fmap ((a-&gt;x) -&gt; (a-&gt;y))\n</code></pre>\n\n<p>In order to get <code>((a-&gt;x) -&gt; (a-&gt;y))</code>, I thought I could just do \n<code>fmap (x-&gt;y)</code> which is the same as <code>(fmap f)</code></p>\n\n<p>So my sulotion was </p>\n\n<pre><code>instance Functor (ComplicatedA a) where\n    fmap f (Con1 x y) = Con1 x (f y)\n    fmap f (Con2 xs) = Con2 (map (fmap (fmap f)) xs)\n</code></pre>\n\n<p>However the real solution uses <code>(f .)</code> instead of <code>(fmap f)</code> to get <code>((a-&gt;x) -&gt; (a-&gt;y))</code> from <code>x -&gt; y</code> and it looks like this</p>\n\n<pre><code>instance Functor (ComplicatedA a) where\n    fmap f (Con1 a b) = Con1 a (f b)\n    fmap f (Con2 l) = Con2 (map (fmap (f .)) l)\n</code></pre>\n\n<p>I was just wondering what the problem was with my thought process and solution. Is (fmap f) the same as (f .) if f is a function of type a->b?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1554666758, "post_id": 55562988, "comment_id": 97825905, "body": "Note that <code>filterM</code> (for general applicatives, not just <code>Maybe</code>) is already defined in <code>Control.Monad</code>."}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1554666952, "post_id": 55562988, "comment_id": 97825972, "body": "Yes, changing the function name to something else still gives same result"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1554667155, "post_id": 55562988, "comment_id": 97826029, "body": "<code>p x</code> has type <code>m Bool</code> so you can&#39;t match it against <code>Just True</code> which has type <code>Maybe Bool</code>"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1554689325, "post_id": 55563212, "comment_id": 97830264, "body": "The <code>case</code> you recommend in your last sentence is more easily written using Maybe&#39;s Functor instance: <code>(x :) &lt;$&gt; filterM p xs</code>"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 4, "last_activity_date": 1554667752, "creation_date": 1554667752, "answer_id": 55563212, "question_id": 55562988, "link": "https://stackoverflow.com/questions/55562988/create-a-filter-function-for-monads-in-haskell/55563212#55563212", "title": "Create a filter function for monads in haskell", "body": "<p>There are two problems.  The first is that you've given the type signature:</p>\n\n<pre><code>filterM :: Monad m =&gt; (a -&gt; m Bool) -&gt; [a] -&gt; m [a]\n</code></pre>\n\n<p>and then defined <code>filterM</code> with <code>m</code> specialized to <code>Maybe</code> (because you use <code>Just</code> and <code>Nothing</code> in your definition).  When Haskell deduces that <code>m</code> must be <code>Maybe</code>, this results in an error.  The type <code>m</code> is \"rigid\" in the sense that it was supplied by you in a type signature, and rigid types have to stay general; it's a conflict if they become less polymorphic than specified.  You can generate a similar error message by writing:</p>\n\n<pre><code>badId :: a -&gt; Int\nbadId x = x\n</code></pre>\n\n<p>Clearly, <code>a</code> is <code>Int</code>, and so it's a conflict that the rigid (programmer-specified) type <code>a</code> was determined to match <code>Int</code> during type checking.</p>\n\n<p>However, even if you fix your type signature:</p>\n\n<pre><code>filterM :: (a -&gt; Maybe Bool) -&gt; [a] -&gt; Maybe [a]\nfilterM p [] = pure []\nfilterM p (x : xs) | p x == Just True = x : (filterM p xs)\n                   | p x == Just False = filterM p xs\n                   | otherwise = Nothing\n</code></pre>\n\n<p>you'll still get an error message.  You're mixing up monadic actions and values in your code.  In the expression:</p>\n\n<pre><code>x : filterM p xs\n</code></pre>\n\n<p>you're applying the operator <code>(:) :: b -&gt; [b] -&gt; [b]</code> to the types <code>a</code> and <code>Maybe [a]</code>, so it doesn't typecheck (\"Couldn't match expected type <code>Maybe [a]</code> with actual type <code>[a]</code>.\")</p>\n\n<p>You'll need to replace <code>x : filterM p xs</code> with something like:</p>\n\n<pre><code>case filterM p xs of\n    Nothing -&gt; Nothing\n    Just xs' -&gt; Just (x : xs')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1554857777, "post_id": 55563621, "comment_id": 97902051, "body": "How is it possible to do <code>x: xs&#39;</code>? <code>xs&#39;</code> is a monadic value, wheras <code>x</code> is just an integer"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1554876928, "post_id": 55563621, "comment_id": 97906510, "body": "@KSplitX: In all of these examples, <code>xs&#39;</code> is a pure value of type <code>[a]</code>; the recursive call <code>filterM p xs</code> is a monadic action of type <code>m [a]</code>, but we <i>bind</i> its result to <code>xs&#39;</code> using a bind statement (<code>&lt;-</code>) within <code>do</code> or the bind operator (<code>&gt;&gt;=</code>). Specifically, <code>xs&#39; &lt;- filterM p xs; pure (x : xs&#39;)</code> = <code>filterM p xs &gt;&gt;= \\ xs&#39; -&gt; pure (x : xs&#39;)</code>\u2014the key is that we <i>chain</i> <code>filterM p xs :: m [a]</code> with a function of type <code>[a] -&gt; m [a]</code> to produce a combined action of type <code>m [a]</code>. Within that function, we can use the value directly."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1554877015, "post_id": 55563621, "comment_id": 97906535, "body": "@KSplitX: An important thing to note is that a value of type <code>m a</code> is <i>not</i> a value of type <code>a</code> \u201ctagged\u201d with a monadic context of type <code>m</code>\u2014rather, it\u2019s a value representing an <i>action</i> that may produce values of type <code>a</code> when executed, and may perform effects according to the particular <code>m</code>. (Some monads such as <code>Maybe</code>, <code>[]</code>, and <code>Either</code> do happen to be containers, but many such as <code>IO</code>, <code>Cont</code>, and <code>STM</code> are not, so the \u201caction\u201d interpretation is more general.)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1554671126, "last_edit_date": 1554671126, "creation_date": 1554670698, "answer_id": 55563621, "question_id": 55562988, "link": "https://stackoverflow.com/questions/55562988/create-a-filter-function-for-monads-in-haskell/55563621#55563621", "title": "Create a filter function for monads in haskell", "body": "<p>Your type error comes from specifying a type signature that is polymorphic (<code>m</code>) but an implementation that\u2019s specialised to a particular <code>m</code> (<code>Maybe</code>)\u2014you\u2019ve told the typechecker this function works <code>forall m</code>, but it doesn\u2019t.</p>\n\n<p>In order to generalise this, you need to solve two other minor issues: first, you can\u2019t use a general monadic condition in a guard, only a pure condition. Second, you can\u2019t use the <code>:</code> operator on <code>x</code> and the result of <code>filterM</code>, since <code>:</code> is pure but you\u2019ve given it a monadic argument.</p>\n\n<p>For the monadic version, you can use <code>do</code> notation:</p>\n\n<pre><code>filterM p [] = pure []\nfilterM p (x : xs) = do\n  px &lt;- p x  -- Run the condition\n  if px\n    then do\n      xs' &lt;- filterM p xs  -- Run the recursive action\n      pure (x : xs')       -- Build the result\n    else filterM p xs\n</code></pre>\n\n<blockquote>\n  <p>I would use do notation but it doesn\u2019t seem like best option since there is recursion.</p>\n</blockquote>\n\n<p>It\u2019s perfectly fine to write recursive monadic code, with or without <code>do</code> notation, as you can see here\u2014you just need to be aware of when you\u2019re <em>executing actions</em> versus <em>evaluating expressions</em>.</p>\n\n<p>The <code>otherwise</code> case in your original code is handled implicitly by the monadic bindings; if <code>p x</code> returns <code>Nothing</code> for <code>m ~ Maybe</code> then the whole computation will return <code>Nothing</code>.</p>\n\n<p>If you want to avoid <code>do</code> notation, you can use the monad/functor combinators directly:</p>\n\n<pre><code>filterM p [] = pure []\nfilterM p (x : xs)\n  = p x &gt;&gt;= \\ px -&gt; if px\n    then (x :) &lt;$&gt; filterM p xs\n    else filterM p xs\n</code></pre>\n\n<p>While <code>&lt;$&gt;</code> (<code>fmap</code>) is nicer here, I would personally prefer to use <code>do</code> over <code>&gt;&gt;=</code> with a lambda.</p>\n\n<p>This can also be simplified somewhat by factoring out the repetition of <code>filterM p</code> and, since <code>p</code> doesn\u2019t change within a call to <code>filterM</code>, just referencing it in a helper function.</p>\n\n<pre><code>filterM p = go\n  where\n    go [] = pure []\n    go (x : xs) = do\n      px &lt;- p x\n\n      -- Or: if px then (x :) &lt;$&gt; go xs else go xs\n      xs' &lt;- go xs\n      pure (if px then x : xs' else xs')\n</code></pre>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1554671126, "creation_date": 1554666197, "question_id": 55562988, "link": "https://stackoverflow.com/questions/55562988/create-a-filter-function-for-monads-in-haskell", "title": "Create a filter function for monads in haskell", "body": "<p>Suppose we have a filter function.</p>\n\n<p><code>filterM :: Monad m =&gt; (a -&gt; m Bool) -&gt; [a] -&gt; m [a]</code></p>\n\n<p>Assume our <code>a -&gt; m Bool</code> function is as such:</p>\n\n<pre><code>p :: Integer -&gt; Maybe Bool\np n | n &gt; 0 = Just True\n    | n &lt; 0 = Just False\n    | otherwise = Nothing\n</code></pre>\n\n<p>In the example, <code>m</code> is Maybe.</p>\n\n<p>I want to create the filterM function such that:</p>\n\n<pre><code>filterM p [2,\u22124,1] = Just [2,1]\n\nfilterM p [2,0,\u22124,1] = Nothing\n</code></pre>\n\n<p>Essentially this filterM is filter, but for monads.</p>\n\n<p>Here is my implementation of it. It doesn't work, and I have a couple of questions about it.</p>\n\n<pre><code>filterM p [] = pure []\nfilterM p (x : xs) | p x == Just True = x : (filterM p xs)\n                   | p x == Just False = filterM p xs\n                   | otherwise = Nothing\n</code></pre>\n\n<p>Firstly, why doesn't it work. It says <code>Couldn't match type m with Maybe m is a rigid type variable</code>.</p>\n\n<pre><code>  Expected type: m Bool\n  Actual type: Maybe Bool\n</code></pre>\n\n<p>In my function, I hardcoded \"Maybe\" as <code>m</code>, but how do I make this more generic?</p>\n\n<p>I would use do notation but it doesn't seem like best option since there is recursion.</p>\n"}, {"tags": ["haskell", "garbage-collection", "ghc", "language-design"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554670374, "post_id": 55562754, "comment_id": 97826820, "body": "I think this question has less to do with Haskell and GHC than it does language design in general. I think the tags should reflect that, if I may suggest?"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1554678434, "post_id": 55562754, "comment_id": 97828583, "body": "Could you specify your question with some benchmarks you performed? What does it mean &quot;vastly larger&quot;, what did you get and what had you expected?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1554678868, "post_id": 55562754, "comment_id": 97828651, "body": "There are so, so many differences between ghc and javac -- lazy vs. eager, yes, but also immutable vs. mutable, functional vs. imperative, copying GC vs. mark-sweep GC, and I&#39;m sure I could come up with a half a dozen more if you gave me some time to think carefully. What makes you think it&#39;s obviously &quot;lazy vs. eager&quot; that is the thing to point your finger at?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 5, "creation_date": 1554682155, "post_id": 55562754, "comment_id": 97829112, "body": "In verbal conversations, Mark Jones (iirc) said he showed Java compilers devs GHC in action.  The bytes allocated and copied were through the roof from the Java devs perspective.  The difference is that of mutable vs immutable, but the GHC RTS and GC with it&#39;s bump allocator are built with this aspect in mind.  As a result, GC is not so computationally significant for most programs.  When productivity (time spent in GC vs mutator) is low then that is worth investigating as it is often an &quot;easy&quot; win when optimizing a program for production (producing less garbage, increasing nursery size, etc)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1554743380, "post_id": 55562754, "comment_id": 97855512, "body": "@ThomasM.DuBuisson, bytes allocated is often important (most especially for concurrent programs, but I suspect also for L1 cache utilization). Bytes copied is almost always important."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1554680786, "creation_date": 1554680786, "answer_id": 55564639, "question_id": 55562754, "link": "https://stackoverflow.com/questions/55562754/is-there-inherent-cost-of-carry-of-garbage-thunks-in-haskell/55564639#55564639", "title": "Is there inherent &quot;cost of carry&quot; of garbage thunks in Haskell?", "body": "<p>No, laziness does not inherently lead to a large amount of copying in GC. The programmer's failure to <em>manage</em> laziness properly, however, can certainly do so. For example, if a persistent data structure ends up full of chains of thunks due to lazy modification, then it will end up badly bloated.</p>\n\n<p>Another major issue you may be encountering, as Daniel Wagner mentioned, is the cost of immutability. While it is certainly possible to program with mutable structures in Haskell, it is much more idiomatic to work with immutable ones when possible. Immutable structure designs have various trade-offs. For example, ones designed for high performance when used persistently tend to have low branching factors to increase sharing, which leads to some bloat when they're used ephemerally.</p>\n"}, {"comments": [{"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1554755653, "post_id": 55579528, "comment_id": 97861098, "body": "Wonderful explanation of low level operational detail, thank you! I wish there was a &quot;retrobounty&quot; award of some kind! You have convinced me that the amount of live &quot;stack&quot; data is likely equivalent - almost certainly after optimizations and even more so once the new GC will (hopefully) avoid copying these thunks! I still worry about expressions that (I think) evaluate to WHNF due to laziness, need to be carried around as &quot;possibly&quot; live and much later discarded when the algorithm decides to discard them."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 1, "creation_date": 1554759937, "post_id": 55579528, "comment_id": 97862582, "body": "@sevo, you&#39;ll be able to offer a bounty &quot;to reward an existing answer&quot; once two days have elapsed from your original post."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 10, "last_activity_date": 1554747599, "creation_date": 1554747599, "answer_id": 55579528, "question_id": 55562754, "link": "https://stackoverflow.com/questions/55562754/is-there-inherent-cost-of-carry-of-garbage-thunks-in-haskell/55579528#55579528", "title": "Is there inherent &quot;cost of carry&quot; of garbage thunks in Haskell?", "body": "<p><strong>tl;dr:</strong>  Most of the stuff that the JVM does in stack frames, GHC does on the heap.  If you wanted to compare GHC heap/GC stats with the JVM equivalent, you'd really need to account for <em>some</em> portion of the bytes/cycles the JVM spends pushing arguments on the stack or copying return values between stack frames.</p>\n\n<h3>Long version:</h3>\n\n<p>Languages targeting the JVM typically make use of its call stack.  Each invoked method has an active stack frame that includes storage for the parameters passed to it, additional local variables, and temporary results, plus room for an \"operand stack\" used for passing arguments to and receiving results from other methods it calls.</p>\n\n<p>As a simple example, if the Haskell code:</p>\n\n<pre><code>bar :: Int -&gt; Int -&gt; Int\nbar a b = a * b\nfoo :: Int -&gt; Int -&gt; Int -&gt; Int\nfoo x y z = let u = bar y z in x + u\n</code></pre>\n\n<p>were compiled to JVM, the byte code would probably look something like:</p>\n\n<pre><code>public static int bar(int, int);\n  Code:\n    stack=2, locals=2, args_size=2\n       0: iload_0   // push a\n       1: iload_1   // push b\n       2: imul      // multiply and push result\n       3: ireturn   // pop result and return it\n\npublic static int foo(int, int, int);\n  Code:\n    stack=2, locals=4, args_size=3\n       0: iload_1   // push y\n       1: iload_2   // push z\n       2: invokestatic bar   // call bar, pushing result\n       5: istore_3  // pop and save to \"u\"\n       6: iload_0   // push x\n       7: iload_3   // push u\n       8: iadd      // add and push result\n       9: ireturn   // pop result and return it\n</code></pre>\n\n<p>Note that calls to built-in primitives like <code>imul</code> and user-defined methods like <code>bar</code> involve copying/pushing the parameter values from local storage to the operand stack (using <code>iload</code> instructions) and then invoking the primitive or method.  Return values then need to be saved/popped to local storage (with <code>istore</code>) or returned to the caller with <code>ireturn</code>; occasionally, a return value can be left on the stack to serve as an operand for another method invocation.  Also, while it's not explicit in the byte code, the <code>ireturn</code> instruction involves a copy, from the callee's operand stack to the caller's operand stack.  Of course, in actual JVM implementations, various optimizations are presumably possible to reduce copying.</p>\n\n<p>When something else eventually calls <code>foo</code> to produce a computation, for example:</p>\n\n<pre><code>some_caller t = foo (1+3) (2+4) t + 1\n</code></pre>\n\n<p>the (unoptimized) code might look like:</p>\n\n<pre><code>       iconst_1\n       iconst_3\n       iadd      // put 1+3 on the stack\n       iconst_2\n       iconst_4\n       iadd      // put 2+4 on the stack\n       iload_0   // put t on the stack\n       invokestatic foo\n       iconst 1\n       iadd\n       ireturn\n</code></pre>\n\n<p>Again, subexpressions are evaluated with a lot of pushing and popping on the operand stack.  Eventually, <code>foo</code> is invoked with its arguments pushed on the stack and its result popped off for further processing.</p>\n\n<p>All of this allocation and copying takes place on this stack, so there's no heap allocation involved in this example.</p>\n\n<p>Now, what happens if that same code is compiled with GHC 8.6.4 (without optimization and on an x86_64 architecture for the sake of concreteness)?  Well, the pseudocode for the generated assembly is something like:</p>\n\n<pre><code>foo [x, y, z] =\n    u = new THUNK(sat_u)                   // thunk, 32 bytes on heap\n    jump: (+) x u\n\nsat_u [] =                                 // saturated closure for \"bar y z\"\n    push UPDATE(sat_u)                     // update frame, 16 bytes on stack\n    jump: bar y z\n\nbar [a, b] =\n    jump: (*) a b\n</code></pre>\n\n<p>The calls/jumps to the <code>(+)</code> and <code>(*)</code> \"primitives\" are actually more complicated than I've made them out to be because of the typeclass that's involved.  For example, the jump to <code>(+)</code> looks more like:</p>\n\n<pre><code>    push CONTINUATION(\\f -&gt; f x u)         // continuation, 24 bytes on stack\n    jump: (+) dNumInt                      // get the right (+) from typeclass instance\n</code></pre>\n\n<p>If you turn on <code>-O2</code>, GHC optimizes away this more complicated call, but it also optimizes away everything else that's interesting about this example, so for the sake of argument, let's pretend the pseudocode above is accurate.</p>\n\n<p>Again, <code>foo</code> isn't of much use until someone calls it.  For the <code>some_caller</code> example above, the portion of code that calls <code>foo</code> will look something like:</p>\n\n<pre><code>some_caller [t] =\n    ...\n    foocall = new THUNK(sat_foocall)       // thunk, 24 bytes on heap\n    ...\n\nsat_foocall [] =                           // saturated closure for \"foo (1+3) (2+4) t\"\n    ...\n    v = new THUNK(sat_v)                   // thunk \"1+3\", 16 bytes on heap\n    w = new THUNK(sat_w)                   // thunk \"2+4\", 16 bytes on heap\n    push UPDATE(sat_foocall)               // update frame, 16 bytes on stack\n    jump: foo sat_v sat_w t\n\nsat_v [] = ...\nsat_w [] = ...\n</code></pre>\n\n<p>Note that nearly all of this allocation and copying takes place on the heap, rather than the stack.</p>\n\n<p>Now, let's compare these two approaches.  At first blush, it looks like the culprit really is lazy evaluation.  We're creating these thunks all over the place that wouldn't be necessary if evaluation was strict, right?  But let's look at one of these thunks more carefully.  Consider the thunk for <code>sat_u</code> in the definition of <code>foo</code>.  It's 32 bytes / 4 words with the following contents:</p>\n\n<pre><code>// THUNK(sat_u)\nword 0:  ptr to sat_u info table/code\n     1:  space for return value\n     // variables we closed over:\n     2:  ptr to \"y\"\n     3:  ptr to \"z\"\n</code></pre>\n\n<p>The creation of this thunk isn't fundamentally different than the JVM code:</p>\n\n<pre><code>       0: iload_1   // push y\n       1: iload_2   // push z\n       2: invokestatic bar   // call bar, pushing result\n       5: istore_3  // pop and save to \"u\"\n</code></pre>\n\n<p>Instead of pushing <code>y</code> and <code>z</code> onto the operand stack, we loaded them into a heap-allocated thunk.  Instead of popping the result off the operand stack into our stack frame's local storage and managing stack frames and return addresses, we left space for the result in the thunk and pushed a 16-byte update frame onto the stack before transferring control to <code>bar</code>.</p>\n\n<p>Similarly, in the call to <code>foo</code> in <code>some_caller</code>, instead of evaluating the argument subexpressions by pushing constants on the stack and invoking primitives to push results on the stack, we created thunks on the heap, each of which included a pointer to info table / code for invoking primitives on those arguments and space for the return value; an update frame replaced the stack bookkeeping and result copying implicit in the JVM version.</p>\n\n<p>Ultimately, thunks and update frames are GHC's replacement for stack-based parameter and result passing, local variables, and temporary workspace.  A lot of activity that takes place in JVM stack frames takes place in the GHC heap.</p>\n\n<p>Now, most of the stuff in JVM stack frames and on the GHC heap quickly becomes garbage.  The main difference is that in the JVM, stack frames are automatically tossed out when a function returns, after the runtime has copied the important stuff out (e.g., return values).  In GHC, the heap needs to be garbage collected.  As others have noted, the GHC runtime is built around the idea that the vast majority of heap objects will immediately become garbage: a fast bump allocator is used for initial heap object allocation, and instead of copying out the important stuff every time a function returns (as for the JVM), the garbage collector copies it out when the bump heap gets kind of full.</p>\n\n<p>Obviously, the above toy example is ridiculous.  In particular, things are going to get much more complicated when we start talking about code that operates on Java objects and Haskell ADTs, rather than <code>Ints</code>.  However, it serves to illustrate the point that a direct comparison of heap usage and GC cycles between GHC and JVM doesn't make a whole lot of sense. Certainly, an exact accounting doesn't really seem possible as the JVM and GHC approaches are too fundamentally different, and the proof would be in real-world performance.  At the very least, an apples-to-apples comparison of GHC heap usage and GC stats needs to account for some portion of the cycles the JVM spends pushing, popping, and copying values between operand stacks.  In particular, at least some fraction of JVM <code>return</code> instructions should count towards GHC's \"bytes copied\".</p>\n\n<p>As for the contribution of \"laziness\" to heap usage (and heap \"garbage\" in particular), it seems hard to isolate.  Thunks really play a dual role as a replacement for stack-based operand passing and as a mechanism for deferred evaluation.  Certainly a switch from laziness to strictness can reduce garbage -- instead of first creating a thunk and then eventually evaluating it to another closure (e.g., a constructor), you can just create the evaluated closure directly -- but that just means that instead of your simple program allocating a mind-blowing 172 gigabytes on the heap, maybe the strict version \"only\" allocates a modest 84 gigabytes.</p>\n\n<p>As far as I can see, the specific contribution of lazy evaluation to \"bytes copied\" should be minimal -- if a closure is important at GC time, it will need to be copied.  If it's still an unevaluated thunk, the thunk will be copied.  If it's been evaluated, just the final closure will need to be copied.  If anything, since thunks for complicated structures are much smaller than their evaluated versions, laziness should typically <em>reduce</em> bytes copied.  Instead, the usual big win with strictness is that it allows certain heap objects (or stack objects) to become garbage faster so we don't end up with space leaks.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 55579528, "answer_count": 2, "score": 3, "last_activity_date": 1555100952, "creation_date": 1554664730, "last_edit_date": 1554671549, "question_id": 55562754, "link": "https://stackoverflow.com/questions/55562754/is-there-inherent-cost-of-carry-of-garbage-thunks-in-haskell", "title": "Is there inherent &quot;cost of carry&quot; of garbage thunks in Haskell?", "body": "<p>I often see high number of cycles spent in GC when running GHC-compiled programs.</p>\n\n<p>These numbers tend to be order of magnitude higher than my JVM experience suggests they should be. In particular, number of bytes \"copied\" by GC seems to be vastly larger than amounts of data I'm computing.</p>\n\n<p>Is such difference between non- and strict languages fundamental?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554673864, "post_id": 55562722, "comment_id": 97827666, "body": "what is <code>fun2</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 4, "last_activity_date": 1554666300, "creation_date": 1554666300, "answer_id": 55563003, "question_id": 55562722, "link": "https://stackoverflow.com/questions/55562722/incorrect-output-with-haskell-function-which-uses-lists-and-zip/55563003#55563003", "title": "Incorrect output with Haskell function which uses lists and zip", "body": "<p>There are a couple of issues.  The first is that, when you write:</p>\n\n<pre><code>func4 :: String -&gt; [(Char, Int)]\nfunc4 fun3 = zip (fun3)[length fun3]\n</code></pre>\n\n<p>the <code>fun3</code> in this definition has absolute <strong>nothing</strong> to do with the <code>fun3</code> function you previously defined.  If you turned on compiler warnings (e.g., using the flag <code>-Wall</code>), it would warn you that the binding for <code>fun3</code> in this definition of <code>func4</code> \"shadows\" the existing binding.  This means that it's treated the same as if you'd used a complete separate name:</p>\n\n<pre><code>func4 :: String -&gt; [(Char, Int)]\nfunc4 bob = zip (bob) [length bob]\n</code></pre>\n\n<p>So, when you evaluate:</p>\n\n<pre><code>func4 \"ccccchhrrre\"\n</code></pre>\n\n<p>the function <code>fun3</code> isn't used at all.  Instead, it's expanded by the definition of <code>func4</code> to:</p>\n\n<pre><code>func4 \"ccccchhrrre\"\n= zip \"ccccchhrrre\" [length \"ccccchhrrre\"]\n= zip \"ccccchhrrre\" [11]\n</code></pre>\n\n<p>and since strings in Haskell are lists of characters, this is the same as:</p>\n\n<pre><code>= zip ['c','c',...] [11]\n</code></pre>\n\n<p>When you zip two lists and one is shorter than the other, the zip ends when the list runs out, so this yields:</p>\n\n<pre><code>= [('c', 11)]\n</code></pre>\n\n<p>and ignores the second and following elements of the character list.</p>\n\n<p>What you probably wanted instead was to write <code>func4</code> to take a string argument and pass it to <code>fun3</code>:</p>\n\n<pre><code>func4 :: String -&gt; [(Char, Int)]\nfunc4 xs = zip (fun3 xs) [length (fun3 xs)]\n</code></pre>\n\n<p>Unfortunately, this won't type check.  The problem is that this is equivalent to:</p>\n\n<pre><code>func4 \"ccccchhrrre\"\n= zip [\"ccccc\",\"hh\",\"rrr\",\"e\"] [length [\"ccccc\",\"hh\",\"rrr\",\"e\"]]\n= zip [\"ccccc\",\"hh\",\"rrr\",\"e\"] [4]\n= [(\"ccccc\", 4)]\n</code></pre>\n\n<p>which has type <code>[(String, Char)]</code> instead of the <code>[(Char, Char)]</code> you were expecting.</p>\n\n<p>If you've learned about <code>map</code>, you may consider it useful to know that:</p>\n\n<pre><code>&gt; map head [\"ccccc\",\"hh\",\"rrr\",\"e\"]\n\"chre\"\n&gt;\n</code></pre>\n\n<p>and <code>\"chre\"</code> is equivalent to the list <code>['c','h','r','e']</code>.  If you could somehow get a list of the lengths <code>[5,2,3,1]</code> the same way you got a list of the heads, these lists would zip up great.</p>\n\n<p>If you don't want to use <code>map</code>, you might find it helpful to write a <code>func4</code> that processes the <em>output</em> of <code>fun3</code>, like so:</p>\n\n<pre><code>&gt; func4 [\"ccccc\",\"hh\",\"rrr\",\"e\"]\n[('c',5),('h',2),('r',3),('e',1)]\n&gt;\n</code></pre>\n\n<p>It would have a slightly different signature, but a similar structure to your <code>fun3</code>:</p>\n\n<pre><code>func4 :: [String] -&gt; [(Char, Int)]\nfunc4 [] = []\nfunc4 (str : strs) = ??? : func4 strs\n</code></pre>\n\n<p>and then your final function could chain <code>fun3</code> and <code>func4</code> together:</p>\n\n<pre><code>rle :: String -&gt; [(Char, Int)]\nrle str = func4 (fun3 str)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2479, "user_id": 11301900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8826c4b7675bd83127fddefc109b7f5d?s=128&d=identicon&r=PG&f=1", "display_name": "AMC", "link": "https://stackoverflow.com/users/11301900/amc"}, "is_accepted": false, "score": 0, "last_activity_date": 1555262132, "creation_date": 1555262132, "answer_id": 55677957, "question_id": 55562722, "link": "https://stackoverflow.com/questions/55562722/incorrect-output-with-haskell-function-which-uses-lists-and-zip/55677957#55677957", "title": "Incorrect output with Haskell function which uses lists and zip", "body": "<p>The <a href=\"https://stackoverflow.com/a/55563003/11301900\">other answer</a> provides a good explanation of the problems in your code. Here is a slightly different solution, which I find easier to understand.</p>\n\n<p><code>fun3</code> can be replaced with an existing function, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:group\" rel=\"nofollow noreferrer\"><code>Data.List.group</code></a>. <code>group</code> takes a list and produces a list of lists, which contain adjacent elements which are equal:</p>\n\n<pre><code>&gt; Data.List.group \"ccccchhrrre\"\n[\"ccccc\",\"hh\",\"rrr\",\"e\"]\n</code></pre>\n\n<p>The work that <code>fun4</code> is supposed to perform can also be simplified by the use of <code>map</code>. The anonymous function <code>\\x -&gt; (head x, length x)</code> takes one argument <code>x</code>, and produces a tuple whose first element is the head of x, and whose second element is the length of x. Mapping this function over the output of <code>group</code> should give us the desired result:</p>\n\n<pre><code>&gt; map (\\x -&gt; (head x, length x)) [\"ccccc\",\"hh\",\"rrr\",\"e\"]\n[('c',5),('h',2),('r',3),('e',1)]\n</code></pre>\n\n<p>We can now combine both <code>group</code> and our <code>map</code> into one function, and give it a more appropriate name:</p>\n\n<pre><code>-- Count adjacent repeated characters\ncountRep :: String -&gt; [(Char, Int)]\ncountRep str = map (\\x -&gt; (head x, length x)) (List.group str)\n</code></pre>\n\n<h3>Just for fun</h3>\n\n<p>The function we wrote can be used on any list whose items can be compared for equality! Here it is, in point-free style:</p>\n\n<pre><code>countRep :: Eq a =&gt; [a] -&gt; [(a, Int)]\ncountRep = map (liftA2 (,) head length) . List.group\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11285895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100930f253a9dc2246cb90e59cc2f9c8?s=128&d=identicon&r=PG&f=1", "display_name": "NorthernStars", "link": "https://stackoverflow.com/users/11285895/northernstars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1555262132, "creation_date": 1554664550, "last_edit_date": 1554682351, "question_id": 55562722, "link": "https://stackoverflow.com/questions/55562722/incorrect-output-with-haskell-function-which-uses-lists-and-zip", "title": "Incorrect output with Haskell function which uses lists and zip", "body": "<p>My code is supposed to take a string, e.g. <code>ccccchhrrre</code> and return a list of pairs <code>[('c', 5) , ('h', 2) , ('r', 3), ('e', 1)]</code>.  The first part of the pair is a letter and the second part is the number of times it is repeated til the next string occurs. </p>\n\n<p>Currently, however, my code returns <code>[('c',11)]</code> - which is the first character and length of the total number of characters in the string:</p>\n\n<pre><code>&gt; fun4 \"ccccchhrrre\"\n[('c',11)]\n</code></pre>\n\n<p>My issue is with <code>fun4</code>. When running <em>func3</em></p>\n\n<pre><code>&gt; fun3 \"ccccchhrrre\"\n[\"ccccc\",\"hh\",\"rrr\",\"e\"]\n</code></pre>\n\n<pre><code>fun3 :: String -&gt; [String]\nfun3 \"\" = [] \nfun3 xs = fun2 xs : fun3 (drop(length(fun2 xs))xs)\n\nfunc4 :: String -&gt; [(Char, Int)]\nfunc4 fun3 = zip (fun3)[length fun3]\n</code></pre>\n\n<p>I appreciate any help that includes detailed explanations.</p>\n"}, {"tags": ["haskell", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554649543, "post_id": 55560328, "comment_id": 97820790, "body": "Personally, I feel uneasy about using the <code>Eq</code> instance when we can just pattern-match on ADTs. Might be just me though?"}, {"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554649665, "post_id": 55560328, "comment_id": 97820830, "body": "yep, I also prefer <code>case .. of</code>. Your suggestion to use <code>LambdaCase</code> is even better. Just decided to make minimal changes to the original code."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554650205, "post_id": 55560328, "comment_id": 97820987, "body": "Of course. Perhaps also worth mentioning for OPs benefit, a halfway house would be to write eg. ` | Just (EventSpecialKey KeyLeftArrow) &lt;- e = -1` (using pattern guards and pattern matching but without <code>case</code>)."}], "tags": [], "owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "is_accepted": true, "score": 0, "last_activity_date": 1554649066, "creation_date": 1554649066, "answer_id": 55560328, "question_id": 55560122, "link": "https://stackoverflow.com/questions/55560122/how-to-do-conditional-on-ncurses-getevent/55560328#55560328", "title": "How to do conditional on NCurses getEvent", "body": "<p>Looking at <a href=\"http://hackage.haskell.org/package/ncurses-0.2.16/docs/UI-NCurses.html#v:getEvent\" rel=\"nofollow noreferrer\"><code>getEvent</code></a> definition</p>\n\n<pre><code>getEvent\n  :: Window  \n  -&gt; Maybe Integer  \n  -&gt; Curses (Maybe Event)\n</code></pre>\n\n<p>you may notice that it returns <code>Maybe Event</code> wrapped into <code>Curses</code> monad. And in <code>setX</code> function you are trying to compare event to key.\nCompiler says you exactly about this mismatch:</p>\n\n<pre><code>Couldn't match type \u2018Event\u2019 with \u2018Key\u2019\n  Expected type: Maybe Key\n    Actual type: Maybe Event\n</code></pre>\n\n<p>Let's go to documentation and find a bit more about <code>Event</code> and <code>Key</code> types.\nHere is how <a href=\"http://hackage.haskell.org/package/ncurses-0.2.16/docs/UI-NCurses.html#t:Event\" rel=\"nofollow noreferrer\"><code>Event</code></a> is defined:</p>\n\n<pre><code>data Event\n    = EventCharacter Char\n    | EventSpecialKey Key\n    | EventMouse Integer MouseState\n    | EventResized\n    | EventUnknown Integer\n</code></pre>\n\n<p>You may notice that <code>Event</code> has several variants (constructors) and one of them <code>EventSpecialKey</code> wraps <code>Key</code>. That is exactly what you need.</p>\n\n<pre><code>setX e\n    | e == Just (EventSpecialKey KeyLeftArrow) = -1\n    | e == Just (EventSpecialKey KeyRightArrow) = 1\n    | otherwise = 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 1, "last_activity_date": 1554649308, "creation_date": 1554649308, "answer_id": 55560376, "question_id": 55560122, "link": "https://stackoverflow.com/questions/55560122/how-to-do-conditional-on-ncurses-getevent/55560376#55560376", "title": "How to do conditional on NCurses getEvent", "body": "<p>Youve correctly identified the problem. Your proposed solution, to put <code>Key</code> on left hand side of the equals, is to <em>assert</em> that you have a key, when you've already identified that in fact you don't! </p>\n\n<p>Looking at the package link reveals that an <code>Event</code> might be a keypress <code>EventSpecialKey Key</code>. Thus,</p>\n\n<pre><code>setX e = case e of --lambdacase would be even more idiomatic\n    Just (EventSpecialKey KeyLeftArrow) -&gt; -1\n    Just (EventSpecialKey KeyRightArrow) -&gt; 1\n    _ -&gt; 0\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11295023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4f4d288ee8e206796cea1221f66be8?s=128&d=identicon&r=PG&f=1", "display_name": "abc556", "link": "https://stackoverflow.com/users/11295023/abc556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 55560328, "answer_count": 2, "score": 3, "last_activity_date": 1554679784, "creation_date": 1554647938, "last_edit_date": 1554679784, "question_id": 55560122, "link": "https://stackoverflow.com/questions/55560122/how-to-do-conditional-on-ncurses-getevent", "title": "How to do conditional on NCurses getEvent", "body": "<p>I'm looking at the info from here: <a href=\"https://hackage.haskell.org/package/ncurses-0.2.16/docs/UI-NCurses.html#g:14\" rel=\"nofollow noreferrer\">Hackage</a></p>\n\n<p>I want different things to happen in my program depending on which arrow-key was pressed. Using the NCurses module, I can register an event with the getEvent function. But I cannot get my if statements to work on the stored event. This is my code:</p>\n\n<pre><code>main = runCurses $ do\n    w &lt;- defaultWindow\n    e &lt;- getEvent w (Just 300)\n    let x = setX e\n\nsetX e\n    | e == KeyLeftArrow = -1\n    | e == KeyRightArrow = 1\n    | otherwise = 0\n</code></pre>\n\n<p>This gives <code>Couldn't match expected type \u2018Key\u2019 with actual type \u2018Maybe Event\u2019</code> So I change to <code>e == Just Key...Arrow</code> and then get </p>\n\n<pre><code>Couldn't match type \u2018Event\u2019 with \u2018Key\u2019\n      Expected type: Maybe Key\n        Actual type: Maybe Event\n</code></pre>\n\n<p>I guess this is because <code>e</code> is an Event, and I'm acting as if it were a Key, but even after trying this <code>Key e == Just Key...Arrow</code> it isn't working. How can I turn this event into a key? Or in some other way just be able to get my conditional on <code>e</code> to work?</p>\n"}, {"tags": ["haskell", "haskell-lucid"], "answers": [{"comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1554664578, "post_id": 55560236, "comment_id": 97825234, "body": "+1.   Note that the value of <code>p_ &quot;Test&quot;</code> is basically a complicated monadic representation of the byte string <code>&lt;p&gt;Test&lt;&#47;p&gt;</code>, so its actually already rendered HTML rather than any sort of DOM.  As such, you don&#39;t really gain anything by parsing the HTML and then re-rendering it to <code>Html ()</code> -- it&#39;ll be a sort of expensive identity function.  If you need to validate or normalize some HTML before rendering, you&#39;d <i>still</i> be better off using a completely separate library (maybe HXT?) to parse and re-render it, and then use Lucid&#39;s <code>toHtmlRaw</code> on your re-rendered HTML."}], "tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 2, "last_activity_date": 1554648601, "creation_date": 1554648601, "answer_id": 55560236, "question_id": 55559896, "link": "https://stackoverflow.com/questions/55559896/how-to-embed-arbitrary-dynamic-html-string-into-haskells-lucid-html-type/55560236#55560236", "title": "How to embed arbitrary dynamic HTML String into Haskell&#39;s Lucid Html type?", "body": "<p><a href=\"http://hackage.haskell.org/package/lucid-2.9.11/docs/Lucid-Base.html#v:toHtmlRaw\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/lucid-2.9.11/docs/Lucid-Base.html#v:toHtmlRaw</a></p>\n\n<pre><code>toHtmlRaw \"&lt;p&gt;Test&lt;/p&gt;\"\n</code></pre>\n\n<p>The above seems to work well enough, though possibly it does not check for valid syntax.</p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 55560236, "answer_count": 1, "score": 0, "last_activity_date": 1554675779, "creation_date": 1554646510, "last_edit_date": 1554675779, "question_id": 55559896, "link": "https://stackoverflow.com/questions/55559896/how-to-embed-arbitrary-dynamic-html-string-into-haskells-lucid-html-type", "title": "How to embed arbitrary dynamic HTML String into Haskell&#39;s Lucid Html type?", "body": "<p>How can I parse an html string for example <code>&lt;p&gt;Test&lt;/p&gt;</code> and have this be converted to value that would be similar to <code>p_ \"Test\"</code>?</p>\n\n<p>So the function type would be <code>String -&gt; Html ()</code>.</p>\n\n<p>I've found the following project <a href=\"https://github.com/dbaynard/lucid-from-html\" rel=\"nofollow noreferrer\">https://github.com/dbaynard/lucid-from-html</a> but this generates actual Haskell source code as a <code>String</code>. </p>\n\n<p>I'm aware that there are HTML parsing libraries, but I'm just wondering if there already exists a library that has implemented this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1554633828, "post_id": 55558064, "comment_id": 97816505, "body": "That code doesn&#39;t look correct. I think you need parenthesis around <code>Card a b</code>. Also those guards look off, as it&#39;s assuming <code>a</code> is a function. As for the parsing though, it needs to be Maybe likely because the String may not be parsable as a Card."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 3, "creation_date": 1554634375, "post_id": 55558064, "comment_id": 97816616, "body": "@Jesse that doesn&#39;t look very much like Haskell, maybe have a look at <a href=\"https://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions</a> for example..."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554643095, "post_id": 55558732, "comment_id": 97819038, "body": "The derived <code>Show</code> instance for Card wouldn&#39;t give the desired instance away."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554643672, "post_id": 55558732, "comment_id": 97819182, "body": "Good point, by &quot;extraneous&quot; i primarily meant that you can only have one or the other, not both, but that wasn&#39;t clear @chepner"}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 8, "last_activity_date": 1554643744, "last_edit_date": 1554643744, "creation_date": 1554638005, "answer_id": 55558732, "question_id": 55558064, "link": "https://stackoverflow.com/questions/55558064/instance-declaration-and-convert-string-to-maybe-type/55558732#55558732", "title": "instance declaration and convert string to Maybe type", "body": "<p>1) Firstly,</p>\n\n<pre><code>instance Show Card where show (Card a b) \n     = show a ++ show (tail show b)\n</code></pre>\n\n<p>You have automatically derived a <code>Show</code> instance for <code>Card</code>, so this will conflict (you can only have 1 instance), and further it won't compile. The <code>show</code> should go on a new line, and <code>tail</code> should be applied to the <em>result</em> of <code>show b</code>.</p>\n\n<pre><code>instance Show Card where \n    show (Card a b) = show a ++ \" \" + tail (show b)\n</code></pre>\n\n<p>2) Secondly,</p>\n\n<pre><code>toCard :: String -&gt; Maybe Card\ntoCard all@(x:xs)\n        | (x=A|B|C|D|E|F)&amp;&amp;(xs==1|2|3) = Just Card\n        | otherwise  = Nothing\n</code></pre>\n\n<p>The syntax <code>(x=A|B|C|D|E|F)&amp;&amp;(xs==1|2|3)</code> is pretty wild, and certainly not valid Haskell. The closest approximation would be something like, <code>x `elem` ['A','B','C','D','E','F'] &amp;&amp; xs `elem` [\"1\",\"2\",\"3\"]</code>, but as you can see this rapidly becomes boilerplate-y. Also, <code>Just Card</code> makes no sense - you still need to use the <code>x</code> and <code>xs</code> to say what the card actually is! eg. <code>Just $ Card x xs</code> (though that still won't work because they're still character/string not Suit/Rank).</p>\n\n<p>One solution would be to automatically derive a <code>Read</code> instance on <code>Rank</code>, <code>Suit</code>, and <code>Card</code>. However, the automatic derivation for <code>read</code> on <code>Card</code> would require you to input eg. <code>\"Card A R1\"</code>, so let's try using the instance on <code>Rank</code> and <code>Suit</code> to let us write a parser for <code>Card</code>s that doesn't require prefixed <code>\"Card\"</code>. </p>\n\n<p>First attempt:</p>\n\n<pre><code>toCard :: String -&gt; Maybe Card\ntoCard (x:xs) = Just $ Card (read [x] :: Suit) (read xs :: Rank)\n</code></pre>\n\n<p>Hmm, this doesn't really allow us to deal with bad inputs - problem being that <code>read</code> just throws errors instead of giving us a <code>Maybe</code>. Notice however that we use <code>[x]</code> rather than <code>x</code> because <code>read</code> applies to <code>[Char]</code> and <code>x :: Char</code>. Next attempt:</p>\n\n<pre><code>import Text.Read (readMaybe)\n\ntoCard :: String -&gt; Maybe Card\ntoCard [] = Nothing\ntoCard (x:xs) = let mSuit = readMaybe [x] :: Suit\n                    mRank = readMaybe xs :: Rank\n                in case (mSuit, mRank) of\n                    (Just s, Just r) -&gt; Just $ Card s r\n                    _ -&gt; Nothing\n</code></pre>\n\n<p>This copes better with bad inputs, but has started to get quite long. Here's two possible ways to shorten it again:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code> -- using the Maybe monad\n toCard (x:xs) = do mSuit &lt;- readMaybe [x]\n                    mRank &lt;- readMaybe xs\n                    return $ Card mSuit mRank\n\n -- using Applicative\n toCard (x:xs) = Card &lt;$&gt; readMaybe [x] &lt;*&gt; readMaybe xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1554657657, "last_edit_date": 1554657657, "creation_date": 1554643995, "answer_id": 55559555, "question_id": 55558064, "link": "https://stackoverflow.com/questions/55558064/instance-declaration-and-convert-string-to-maybe-type/55559555#55559555", "title": "instance declaration and convert string to Maybe type", "body": "<p>A parser library, though it comes with a steeper learning curve, makes this simpler. For this example, we'll use <code>Text.Parsec</code>, from the <code>parsec</code> library. Import it, and define a type alias for using in defining your parsers.</p>\n\n<pre><code>import Text.Parsec\ntype Parser = Parsec String ()  -- boilerplate\n</code></pre>\n\n<p><code>Parsec String ()</code> indicates a type of parser that consumes a stream of characters, and can produce a value of type <code>()</code> after parsing is complete. (In this case, we only care about the parsing, not any computation done along side the parsing.)</p>\n\n<p>For your core types, we'll define a <code>Show</code> instant by hand for <code>Rank</code> so that you don't need to strip the <code>R</code> off later. We'll also derive a <code>Read</code> instance for <code>Suit</code> to make it easier to convert a string like <code>\"A\"</code> to a <code>Suit</code> value like <code>A</code>.</p>\n\n<pre><code>data Suit = A|B|C|D|E|F|G deriving (Show, Read, Eq)\n\ndata Rank = R1|R2|R3 deriving (Eq)\n-- Define Show yourself so you don't constantly have to remove the `R`\ninstance Show Rank where\n    show R1 = \"1\"\n    show R2 = \"2\"\n    show R3 = \"3\"\n\ndata Card = Card Suit Rank deriving Eq\ninstance Show Card where\n    show (Card s r) = show s ++ show r\n</code></pre>\n\n<p>With that out of the way, we can define some parsers for each type.</p>\n\n<pre><code>-- Because oneOf will fail if you don't get one\n-- of the valid suit characters, read [s] is guaranteed\n-- to succeed. Using read eliminates the need for a\n-- large case statement like in rank, below.\nsuit :: Parser Suit\nsuit = do\n    s &lt;- oneOf \"ABCDEF\"\n    return $ read [s]\n\nrank :: Parser Rank\nrank = do\n    n &lt;- oneOf \"123\"\n    return $ case n of\n        '1' -&gt; R1\n        '2' -&gt; R2\n        '3' -&gt; R3\n\n-- A Card parser just combines the Suit and Rank parsers    \ncard :: Parser Card\ncard = Card &lt;$&gt; suit &lt;*&gt; rank\n\n-- parse returns an Either ParseError Card value;\n-- you can ignore the exact error if the parser fails\n-- to return Nothing instead.\ntoCard :: String -&gt; Maybe Card\ntoCard s = case parse card \"\" s of\n                Left _ -&gt; Nothing\n                Right c -&gt; Just c\n</code></pre>\n\n<hr>\n\n<p><code>oneOf</code> is a predefined parser that consumes exactly one of the items in the given list.</p>\n\n<p><code>parse</code> takes three arguments:</p>\n\n<ol>\n<li>A parser</li>\n<li>A \"source name\" (only used for error message; you can use any string you like)</li>\n<li>The string to parse</li>\n</ol>\n"}], "owner": {"reputation": 149, "user_id": 9684220, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jesse", "link": "https://stackoverflow.com/users/9684220/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 55558732, "answer_count": 2, "score": -1, "last_activity_date": 1554657657, "creation_date": 1554633619, "last_edit_date": 1554634712, "question_id": 55558064, "link": "https://stackoverflow.com/questions/55558064/instance-declaration-and-convert-string-to-maybe-type", "title": "instance declaration and convert string to Maybe type", "body": "<p>An guessing and answering game. \nEach Card comprises a Suit, one of A,B,C,D,E,F,G, and a Rank, one of 1|2|3.</p>\n\n<p>I need to have a function to guarantee input(String) whether is valid type. And also write an instance declaration so that the type is in the Show class.</p>\n\n<p>I am not sure about the function toCard, how to express \"String\" in the function and meet it with the condition.</p>\n\n<pre><code>data Suit = A|B|C|D|E|F|G \n            deriving (Show , Eq)\n\ndata Rank = R1|R2|R3\n              deriving (Show, Eq)\n\ndata Card = Card Suit Rank\n             deriving (Show, Eq)\n\ninstance Show Card where show (Card a b) \n     = show a ++ show (tail show b)\n\ntoCard :: String -&gt; Maybe Card\ntoCard all@(x:xs)\n        | (x=A|B|C|D|E|F)&amp;&amp;(xs==1|2|3) = Just Card\n        | otherwise  = Nothing\n</code></pre>\n\n<p>edit toCard function, input should be any String, so i use a list expression, but it seems to be not correct, cause i try it in ghci, (x=A|B|C|D|E|F)&amp;&amp;(y==1|2|3) is not valid</p>\n"}, {"tags": ["windows", "haskell", "dependencies", "haskell-stack"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1554634738, "post_id": 55557343, "comment_id": 97816737, "body": "how long have you tried letting in execute? old CPU?"}, {"owner": {"reputation": 123, "user_id": 11323942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d040d48dc09031501a031acd841cd580?s=128&d=identicon&r=PG", "display_name": "Giulio", "link": "https://stackoverflow.com/users/11323942/giulio"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1554634820, "post_id": 55557343, "comment_id": 97816759, "body": "several minutes... I don&#39;t think it&#39;s going to do it (but I can be wrong of course). The problem is simply with the package comonad: this seems to fail <code>stack ghci --package comonad</code> inside the new project"}, {"owner": {"reputation": 123, "user_id": 11323942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d040d48dc09031501a031acd841cd580?s=128&d=identicon&r=PG", "display_name": "Giulio", "link": "https://stackoverflow.com/users/11323942/giulio"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1554636287, "post_id": 55557343, "comment_id": 97817181, "body": "After more than 15 minutes of CPU time it&#39;s at 2.4 GB of working set memory... does it make sense to let it execute for more time?"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 11323942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d040d48dc09031501a031acd841cd580?s=128&d=identicon&r=PG", "display_name": "Giulio", "link": "https://stackoverflow.com/users/11323942/giulio"}, "edited": false, "score": 1, "creation_date": 1554637986, "post_id": 55558682, "comment_id": 97817681, "body": "Yes, I needed to <code>stack upgrade</code> ==&gt; <code>Current Stack version: 1.7.1, available download version: 1.9.3</code> I&#39;m running the build with <code>--interleaved-output</code> and I&#39;ll let you know"}, {"owner": {"reputation": 123, "user_id": 11323942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d040d48dc09031501a031acd841cd580?s=128&d=identicon&r=PG", "display_name": "Giulio", "link": "https://stackoverflow.com/users/11323942/giulio"}, "edited": false, "score": 1, "creation_date": 1554639326, "post_id": 55558682, "comment_id": 97818063, "body": "Yeah... it took 20 minutes and more than 2.5GB for Cabal"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 5, "last_activity_date": 1554637616, "creation_date": 1554637616, "answer_id": 55558682, "question_id": 55557343, "link": "https://stackoverflow.com/questions/55557343/stack-build-hangs-on-ghc-8-6-4-cabal-2-4-1-0-on-windows/55558682#55558682", "title": "Stack build hangs on GHC-8.6.4/Cabal-2.4.1.0 on Windows", "body": "<p>Try rerunning with <code>--interleaved-output</code>, which will show the output of each module being compiled by GHC (you may need to upgrade Stack first via <code>stack upgrade</code>). Cabal takes a <em>long</em> time to compile, it's probably just working through all the modules.</p>\n"}], "owner": {"reputation": 123, "user_id": 11323942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d040d48dc09031501a031acd841cd580?s=128&d=identicon&r=PG", "display_name": "Giulio", "link": "https://stackoverflow.com/users/11323942/giulio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 1, "accepted_answer_id": 55558682, "answer_count": 1, "score": 5, "last_activity_date": 1554639662, "creation_date": 1554628366, "last_edit_date": 1554639662, "question_id": 55557343, "link": "https://stackoverflow.com/questions/55557343/stack-build-hangs-on-ghc-8-6-4-cabal-2-4-1-0-on-windows", "title": "Stack build hangs on GHC-8.6.4/Cabal-2.4.1.0 on Windows", "body": "<p>My stack project build hangs on windows at the step related to Cabal.</p>\n\n<p>See output below</p>\n\n<pre><code>C:\\haskell\\hrt\\Comonad&gt;stack ghc -- --version\nThe Glorious Glasgow Haskell Compilation System, version 8.6.4\n\nC:\\haskell\\hrt\\Comonad&gt;stack build\n\u2190[0mCabal-2.4.1.0: configure\u2190[0m\n\u2190[0mCabal-2.4.1.0: build\u2190[0m\nProgress 0/5\n</code></pre>\n\n<p>I have to interrupt with <kbd>Ctrl</kbd>+<kbd>C</kbd> </p>\n\n<p>I've tried to follow the Haskell Weekly <a href=\"https://chshersh.github.io/posts/2019-03-25-comonadic-builders\" rel=\"nofollow noreferrer\">Comonadic builders by Dmitrii Kovanikov</a> and I've started by creating a new project</p>\n\n<pre><code>stack new Comonad\ncd Comonad\n</code></pre>\n\n<p>then I've pasted the <a href=\"https://gist.github.com/ChShersh/5a4c8e1c0557627859fe93ad0b05dd56\" rel=\"nofollow noreferrer\">code sample</a> into the Main </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards   #-}\n\nmodule Main where\n\nimport Control.Comonad (Comonad (..), (=&gt;&gt;))\nimport Data.Semigroup (Any (..))\nimport Data.Text (Text)\nimport Text.Pretty.Simple (pPrint)\n\nimport Lib\n-- see the gist above for the rest of the code\nalwaysTravisB :: ProjectBuilder -&gt; Project\nalwaysTravisB builder = builder $ mempty { settingsTravis = Any True }\n\ntravisB :: ProjectBuilder -&gt; Project\ntravisB builder =\n  let project = extract builder\n  in project { projectTravis = projectGitHub project }\n\n\n\nmain :: IO ()\nmain = do\n    -- plain\n    pPrint $ extract $ buildProject \"minimal-project\"\n    pPrint $ extract $ buildProject \"only-library\" =&gt;&gt; hasLibraryB\n    pPrint $ extract $ buildProject \"library-github\" =&gt;&gt; hasLibraryB =&gt;&gt; gitHubB\n\n    -- dependent: 1 level\n    pPrint $ extract $ buildProject \"travis\" =&gt;&gt; travisB\n    pPrint $ extract $ buildProject \"always-travis\" =&gt;&gt; alwaysTravisB\n    pPrint $ extract $ buildProject \"github-travis\" =&gt;&gt; gitHubB =&gt;&gt; travisB\n    pPrint $ extract $ buildProject \"travis-github\" =&gt;&gt; travisB =&gt;&gt; gitHubB\n    someFunc\n</code></pre>\n\n<p>and I've specified the dependencies in the package.yaml</p>\n\n<pre><code>dependencies:\n- base &gt;= 4.12.0.0\n- comonad &gt;= 5.0\n- pretty-simple &gt;= 2.2\n- text\n\nlibrary:\n  source-dirs: src\n\nexecutables:\n  Comonad-exe:\n    main:                Main.hs\n    source-dirs:         app\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - Comonad\n</code></pre>\n\n<p>I can see that <code>ghc.exe</code> is working on a temp folder (<code>C:\\Users\\MyHome\\AppData\\Local\\Temp\\stacknnnn</code>) and keep the cpu busy, I'm aso wondering if it's a memory leak (1.7GB of working set)...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fmchs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fmchs.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>stack build --verbose\n-- ... ...\n\u2190[90m2019-04-07 11:35:28.096702: \u2190[32m[debug] \u2190[0mEncoding C:\\Users\\MyHome\\AppData\\Local\\Temp\\stack6060\\Cabal-2.4.1.0\\.s\ntack-work\\dist\\e626a42b\\stack-config-cache\u2190[90m\n@(src/Stack\\Build\\Cache.hs:164:7)\u2190[0m\n\u2190[90m2019-04-07 11:35:28.098702: \u2190[32m[debug] \u2190[0mFinished writing C:\\Users\\MyHome\\AppData\\Local\\Temp\\stack6060\\Cabal-2.\n4.1.0\\.stack-work\\dist\\e626a42b\\stack-config-cache\u2190[90m\n@(src/Stack\\Build\\Cache.hs:164:7)\u2190[0m\n\u2190[90m2019-04-07 11:35:28.099702: \u2190[32m[debug] \u2190[0mEncoding C:\\Users\\MyHome\\AppData\\Local\\Temp\\stack6060\\Cabal-2.4.1.0\\.s\ntack-work\\dist\\e626a42b\\stack-cabal-mod\u2190[90m\n@(src/Stack\\Build\\Cache.hs:173:7)\u2190[0m\n\u2190[90m2019-04-07 11:35:28.320715: \u2190[32m[debug] \u2190[0mFinished writing C:\\Users\\MyHome\\AppData\\Local\\Temp\\stack6060\\Cabal-2.\n4.1.0\\.stack-work\\dist\\e626a42b\\stack-cabal-mod\u2190[90m\n@(src/Stack\\Build\\Cache.hs:173:7)\u2190[0m\n\u2190[90m2019-04-07 11:35:28.320715: \u2190[34m[info] \u2190[0mCabal-2.4.1.0: build\u2190[90m\n@(src/Stack\\Build\\Execute.hs:873:23)\u2190[0m\n\u2190[90m2019-04-07 11:35:28.322715: \u2190[32m[debug] \u2190[0mRun process within C:\\Users\\MyHome\\AppData\\Local\\Temp\\stack6060\\Cabal-\n2.4.1.0\\: C:\\sr\\setup-exe-cache\\x86_64-windows\\Cabal-simple_Z6RU0evB_2.4.0.1_ghc-8.6.4.exe --builddir=.stack-work\\dist\\e\n626a42b build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\u2190[90m\n@(src/Stack\\Build\\Execute.hs:1133:29)\u2190[0m\nProgress 0/5\n-- hangs here\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "nix"], "answers": [{"tags": [], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "is_accepted": true, "score": 2, "last_activity_date": 1554628150, "creation_date": 1554628150, "answer_id": 55557317, "question_id": 55556184, "link": "https://stackoverflow.com/questions/55556184/finding-foreign-library-with-cabal-using-nix-shell/55557317#55557317", "title": "Finding foreign library with cabal using nix-shell", "body": "<p>Basically the the <code>extra-libraries</code> need to be using <code>mnl</code> not <code>libmnl</code>. Then when using <code>cabal2nix</code>, it needs to map <code>libmnl</code> package to the <code>mnl</code> attribute. This was solved with upstream cabal2nix mapping mnl to libmnl commit: <a href=\"https://github.com/NixOS/cabal2nix/issues/413#event-2257811946\" rel=\"nofollow noreferrer\">https://github.com/NixOS/cabal2nix/issues/413#event-2257811946</a></p>\n"}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 55557317, "answer_count": 1, "score": 2, "last_activity_date": 1554628150, "creation_date": 1554617932, "last_edit_date": 1554618675, "question_id": 55556184, "link": "https://stackoverflow.com/questions/55556184/finding-foreign-library-with-cabal-using-nix-shell", "title": "Finding foreign library with cabal using nix-shell", "body": "<p>I have a similar problem to: <a href=\"https://stackoverflow.com/q/34457141/582917\">Cabal can&#39;t find foreign library when building on NixOS</a></p>\n\n<p>Basically I'm using <code>cabal2nix</code> to generate from a package.yaml containing:</p>\n\n<pre><code>extra-libraries:\n  - libmnl\n</code></pre>\n\n<p>This produces a cabal.nix file: </p>\n\n<pre><code>{ mkDerivation, base, bytestring, cereal, containers, hpack\n, iproute, lens, libmnl, netlink, primitive\n, resourcet, safe-exceptions, stdenv, transformers\n}:\nmkDerivation {\n  pname = \"relay\";\n  version = \"0.1.0.0\";\n  src = ./.;\n  libraryHaskellDepends = [\n    base bytestring cereal containers iproute lens netlink\n    primitive resourcet safe-exceptions transformers\n  ];\n  librarySystemDepends = [ libmnl ];\n  libraryToolDepends = [ hpack ];\n  testHaskellDepends = [\n    base bytestring cereal containers iproute lens netlink\n    primitive resourcet safe-exceptions transformers\n  ];\n  testSystemDepends = [ libmnl ];\n  preConfigure = \"hpack\";\n  homepage = \"https://github.com/MatrixAI/Relay#readme\";\n  license = stdenv.lib.licenses.asl20;\n}\n</code></pre>\n\n<p>If I enter into this via <code>nix-shell</code>, and run <code>cabal configure</code>. It complains that it cannot find libmnl:</p>\n\n<pre><code>Resolving dependencies...\nConfiguring relay-0.1.0.0...\ncabal: Missing dependency on a foreign library:\n* Missing (or bad) C library: libmnl\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.If the\nlibrary file does exist, it may contain errors that are caught by the C\ncompiler at the preprocessing stage. In this case you can re-run configure\nwith the verbosity flag -v3 to see the error messages.\n</code></pre>\n\n<p>Also running <code>gcc -c test.c -lmnl</code> on this file inside <code>nix-shell</code> works:</p>\n\n<pre><code>#include &lt;libmnl/libmnl.h&gt;\n\nint main() { return 0; }\n</code></pre>\n\n<p>So why is cabal failing to find <code>libmnl</code> but <code>gcc</code> can easily find it in the <code>nix-shell</code>.</p>\n\n<p>When running with <code>-v3</code> it appears to try to link to <code>-llibmnl</code>. But the proper linking should be <code>-lmnl</code>. This seems very problematic, is there a way to tell cabal to be linking with the flag <code>-lmnl</code>, not <code>-llibmnl</code>?</p>\n\n<p>I've found that if I edit the Cabal file and change <code>extra-libraries</code> to point to <code>mnl</code> instead of <code>libmnl</code>, it then works by changing how Cabal tries to link. However the <code>cabal2nix</code> then when taking <code>package.yaml</code> generates <code>libmnl</code> which is the correct package attribute from Nix. It appears that <code>extra-libraries</code> should be <code>mnl</code> whereas the <code>cabal.nix</code> should be <code>libmnl</code>.</p>\n"}, {"tags": ["haskell", "pattern-matching", "data-kinds"], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1554624430, "last_edit_date": 1554624430, "creation_date": 1554623828, "answer_id": 55556819, "question_id": 55556060, "link": "https://stackoverflow.com/questions/55556060/restrict-pattern-matching-to-subset-of-constructors/55556819#55556819", "title": "Restrict Pattern Matching to Subset of Constructors", "body": "<p>This solution works but it might not be very practical in the end. I'm using extensible variants from the <a href=\"http://hackage.haskell.org/package/red-black-record\" rel=\"nofollow noreferrer\">red-black-record</a> package.</p>\n\n<p>We define our types like this:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, DataKinds, TypeFamilies, TypeApplications #-}\nimport           GHC.Generics\nimport           Data.RBR\n\ndata Ty\n  = StringTy ()\n  | IntTy ()\n  | FloatTy ()\n  deriving (Show,Generic)\ninstance ToVariant Ty\n\ntype ShrunkTy = Variant I (Delete \"StringTy\" () (VariantCode Ty))\n\ndata Op\n  = Add Ty\n  | Subtract ShrunkTy\n</code></pre>\n\n<p>Those annoying <code>()</code> parameters are there to overcome a <a href=\"https://github.com/danidiaz/red-black-record/issues/7\" rel=\"nofollow noreferrer\">limitation</a> of red-black-record; currently there are no instances of <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#t:ToVariant\" rel=\"nofollow noreferrer\"><code>ToVariant</code></a> for sum types without constructor arguments.</p>\n\n<p>Basically, we are removing the <code>StringTy</code> constructor from the <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#t:VariantCode\" rel=\"nofollow noreferrer\"><code>VariantCode</code></a> using the <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#t:Deletable\" rel=\"nofollow noreferrer\"><code>Delete</code></a> type family, and defining a <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#t:Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a> with the reduced set of constructors.</p>\n\n<p>We can then use the type like this:</p>\n\n<pre><code>foo :: Op -&gt; String\nfoo op = \n    case op of\n        Add ty -&gt; \n            show \"add\" ++ show ty\n        Subtract ty -&gt; \n            let cases = addCaseI @\"IntTy\"   show\n                      . addCaseI @\"FloatTy\" show\n                      $ unit\n            in  show \"add\" ++ eliminateSubset cases ty\n</code></pre>\n\n<p><code>Variant</code>s are <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#v:eliminateSubset\" rel=\"nofollow noreferrer\">eliminated</a> using a <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#t:Record\" rel=\"nofollow noreferrer\"><code>Record</code></a> of handlers, constructed using the <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#v:addCaseI\" rel=\"nofollow noreferrer\"><code>addCaseI</code></a> function. <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2/docs/Data-RBR.html#v:unit\" rel=\"nofollow noreferrer\"><code>unit</code></a> is the empty <code>Record</code>. If the <code>Record</code> doesn't cover all cases that will result in a (pretty inscrutable) type error.</p>\n\n<hr>\n\n<p>The disadvantages with this solution are:</p>\n\n<ul>\n<li>Different syntax for handling the shrunk type.</li>\n<li>Worse type errors.</li>\n<li>Slower at runtime, not as efficient as native sum types.</li>\n<li>The usual bane of extensible record libraries: <a href=\"https://github.com/danidiaz/red-black-record/issues/12\" rel=\"nofollow noreferrer\">very slow</a> compilation times for large types.</li>\n</ul>\n\n<p>Other extensible record libraries (<a href=\"http://hackage.haskell.org/package/vinyl\" rel=\"nofollow noreferrer\">vinyl</a> + <a href=\"http://hackage.haskell.org/package/vinyl-generics\" rel=\"nofollow noreferrer\">vinyl-generics</a>, perhaps) might offer better ergonomics.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 2, "last_activity_date": 1554675326, "last_edit_date": 1554675326, "creation_date": 1554672261, "answer_id": 55563794, "question_id": 55556060, "link": "https://stackoverflow.com/questions/55556060/restrict-pattern-matching-to-subset-of-constructors/55563794#55563794", "title": "Restrict Pattern Matching to Subset of Constructors", "body": "<p>Indexing a GADT with <code>DataKinds</code> is one approach that may work, depending on your use case:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE GADTs #-}\n\n-- The \u201cgroup\u201d of a type\ndata TypeGroup = NonNumeric | Numeric\n\n-- A type indexed by whether it\u2019s numeric\ndata Type (g :: TypeGroup) where\n  StringType :: Type 'NonNumeric\n  IntType :: Type 'Numeric\n  FloatType :: Type 'Numeric\n\ndata Op where\n  Add :: Type a -&gt; Op\n  Subtract :: Type 'Numeric -&gt; Op\n</code></pre>\n\n<p>Note that <code>Add</code> works on either <code>'Numeric</code> or <code>'NonNumeric</code> <code>Type</code>s because of the (existentially quantified) type variable <code>a</code>.</p>\n\n<p>Now this will work:</p>\n\n<pre><code>patternMatch :: Op -&gt; ()\npatternMatch (Add StringType) = ()\npatternMatch (Add IntType) = ()\npatternMatch (Add FloatType) = ()\npatternMatch (Subtract IntType) = ()\npatternMatch (Subtract FloatType) = ()\n</code></pre>\n\n<p>But adding this will fail:</p>\n\n<pre><code>patternMatch (Subtract StringType) = ()\n</code></pre>\n\n<p>With a warning about inaccessible code: <code>Couldn't match type \u2018'Numeric\u2019 with \u2018'NonNumeric\u2019</code>.</p>\n\n<p>If you need to add more type groupings, you may prefer to introduce type families to classify types instead, e.g.:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n\n-- An un-indexed type\ndata TypeTag = StringTag | IntTag | FloatTag\n\n-- A type indexed with a tag we can dispatch on\ndata Type (t :: TypeTag) where\n  StringType :: Type StringTag\n  IntType :: Type IntTag\n  FloatType :: Type FloatTag\n\n-- Classify a type as numeric\ntype family IsNumeric' (t :: TypeTag) :: Bool where\n  IsNumeric' 'StringTag = 'False\n  IsNumeric' 'IntTag = 'True\n  IsNumeric' 'FloatTag = 'True\n\n-- A convenience synonym for the constraint\ntype IsNumeric t = (IsNumeric' t ~ 'True)\n\ndata Op where\n  Add :: Type t -&gt; Op\n  Subtract :: IsNumeric t =&gt; Type t -&gt; Op\n</code></pre>\n\n<p>This will produce the (slightly less descriptive) warning <code>Couldn't match type \u2018'True\u2019 with \u2018'False\u2019</code> if you add the redundant pattern.</p>\n\n<p>When working with GADTs you will often want existentials and <code>RankNTypes</code> in order to work with runtime information; for that, patterns like these may prove useful:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\n-- Hide the type-level tag of a type\ndata SomeType where\n  SomeType :: Type t -&gt; SomeType\n\n-- An unknown type, but that is known to be numeric\ndata SomeNumericType where\n  SomeNumericType :: IsNumeric t =&gt; Type t -&gt; SomeNumericType\n\nparseType :: String -&gt; Maybe SomeType\nparseType \"String\" = Just (SomeType StringType)\nparseType \"Int\" = Just (SomeType IntType)\nparseType \"Float\" = Just (SomeType FloatType)\nparseType _ = Nothing\n\n-- Unpack the hidden tag within a function\nwithSomeType :: SomeType -&gt; (forall t. Type t -&gt; r) -&gt; r\nwithSomeType (SomeType t) k = k t\n</code></pre>\n"}], "owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 55563794, "answer_count": 2, "score": 4, "last_activity_date": 1554675326, "creation_date": 1554616782, "question_id": 55556060, "link": "https://stackoverflow.com/questions/55556060/restrict-pattern-matching-to-subset-of-constructors", "title": "Restrict Pattern Matching to Subset of Constructors", "body": "<p>Say I have the following:</p>\n\n<pre><code>data Type\n  = StringType\n  | IntType\n  | FloatType\n\ndata Op\n  = Add Type\n  | Subtract Type\n</code></pre>\n\n<p>I'd like to constrain the possible types under <code>Subtract</code>, such that it only allows for int or float. In other words,</p>\n\n<pre><code>patternMatch :: Op -&gt; ()\npatternMatch (Add StringType) = ()\npatternMatch (Add IntType) = ()\npatternMatch (Add FloatType) = ()\npatternMatch (Subtract IntType) = ()\npatternMatch (Subtract FloatType) = ()\n</code></pre>\n\n<p>Should be an exhaustive pattern match.</p>\n\n<p>One way of doing this is to introduce separate datatypes for each operation, where it only has the allowed subtypes:</p>\n\n<pre><code>newtype StringType = StringType\nnewtype IntType = IntType\nnewtype FloatType = FloatType\n\ndata Addable = AddableString StringType | AddableInt IntType | AddableFloat FloatType\n\ndata Subtractable = SubtractableInt IntType | SubtractableFloat FloatType\n\ndata Op = Add Addable | Subtract Subtractable\n</code></pre>\n\n<p>However, this makes things a lot more verbose, as we have to create a new constructor name for each category. Is there a way to 'restrict' the possible constructors within a type without making an explicit subset?\nWould this shorter with the use of <code>DataKinds</code>? I'm a bit unsure as to how to make it more concise than just specifying new data for each constraint.</p>\n\n<p>This question is an extension of my <a href=\"https://stackoverflow.com/questions/54720058/datakind-unions\">original question</a>, where I asked about datakind unions. There were lots of good suggestions there, but unfortunately the unions don't work when pattern matching; the compiler will still complain that the patterns are not exhaustive.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554613448, "post_id": 55555778, "comment_id": 97812531, "body": "I don&#39;t see a question here."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7024548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QNu4Hva2KLA/AAAAAAAAAAI/AAAAAAAAAMw/FkXQl2NBjho/photo.jpg?sz=128", "display_name": "firstname gklsodascb", "link": "https://stackoverflow.com/users/7024548/firstname-gklsodascb"}, "edited": false, "score": 0, "creation_date": 1554644378, "post_id": 55556382, "comment_id": 97819373, "body": "Interesting solution"}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 1, "last_activity_date": 1554620985, "last_edit_date": 1554620985, "creation_date": 1554619989, "answer_id": 55556382, "question_id": 55555778, "link": "https://stackoverflow.com/questions/55555778/convert-a-list-of-position-value-tuples-into-a-single-list/55556382#55556382", "title": "Convert a list of position,value tuples into a single list", "body": "<p>Here's something I threw together.</p>\n\n<pre><code> f = snd . foldr (\\(e,n) (i,l') -&gt; ( e , (n : replicate (e-i-1) 0) ++ l')) (-1,[])\n f . map (fromIntegral *** fromIntegral) $ baseN_digits 50301020 10 = [5,0,3,0,1,0,2,0]\n</code></pre>\n\n<p>I think I understood your requirements (?)</p>\n\n<p>EDIT:\nPerhaps more naturally,</p>\n\n<pre><code>f xs = foldr (\\(e,n) fl' i -&gt; (replicate (i-e) 0) ++ (n : fl' (e-1))) (\\i -&gt; replicate (i+1) 0) xs 0\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7024548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QNu4Hva2KLA/AAAAAAAAAAI/AAAAAAAAAMw/FkXQl2NBjho/photo.jpg?sz=128", "display_name": "firstname gklsodascb", "link": "https://stackoverflow.com/users/7024548/firstname-gklsodascb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55556382, "answer_count": 1, "score": -1, "last_activity_date": 1554620985, "creation_date": 1554613278, "question_id": 55555778, "link": "https://stackoverflow.com/questions/55555778/convert-a-list-of-position-value-tuples-into-a-single-list", "title": "Convert a list of position,value tuples into a single list", "body": "<p>I am writing some code to work with arbitrary radix numbers in haskell. They will be stored as lists of integers representing the digits.</p>\n\n<p>I almost managed to get it working, but I have run into the problem of converting a list of tuples [(a_1,b_1),...,(a_n,b_n)] into a single list which is defined as follows:</p>\n\n<p>for all i, L(a_i) = b_i.\nif there is no i such that a_i = k, a(k)=0</p>\n\n<p>In other words, this is a list of (position,value) pairs for values in an array. If a position does not have a corresponding value, it should be set to zero.</p>\n\n<p>I have read this (<a href=\"https://wiki.haskell.org/How_to_work_on_lists\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/How_to_work_on_lists</a>) but I don't think any of these methods are suitable for this task.</p>\n\n<pre><code>baseN :: Integer -&gt; Integer -&gt; [Integer]\nbaseN n b = convert_digits (baseN_digits n b)\n\nchunk :: (Integer, Integer) -&gt; [Integer]\nchunk (e,m) = m : (take (fromIntegral e) (repeat 0))\n\n-- This is broken because the exponents don't count for each other's zeroes\nconvert_digits :: [(Integer,Integer)] -&gt; [Integer]\nconvert_digits ((e,m):rest) = m : (take (fromIntegral (e)) (repeat 0)) \nconvert_digits []       = []\n\n-- Converts n to base b array form, where a tuple represents (exponent,digit).\n-- This works, except it ignores digits which are zero. thus, I converted it to return (exponent, digit) pairs.\nbaseN_digits :: Integer -&gt; Integer -&gt; [(Integer,Integer)]\n\nbaseN_digits n b | n &lt;= 0 = [] -- we're done.\n          | b &lt;= 0 = [] -- garbage input. \n          | True   = (e,m) : (baseN_digits (n-((b^e)*m)) b)\n                     where e = (greedy n b 0)      -- Exponent of highest digit\n                           m = (get_coef n b e 1)  -- the highest digit\n\n-- Returns the exponent of the highest digit.\ngreedy :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\ngreedy n b e | n-(b^e) &lt;  0  = (e-1) -- We have overshot so decrement.\n             | n-(b^e) == 0  = e     -- We nailed it. No need to decrement. \n             | n-(b^e) &gt;  0  = (greedy n b (e+1)) -- Not there yet.\n\n-- Finds the multiplicity of the highest digit\nget_coef :: Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer\nget_coef n b e m | n - ((b^e)*m) &lt; 0  = (m-1) -- We overshot so decrement.\n                 | n - ((b^e)*m) == 0 = m    -- Nailed it, no need to decrement.\n                 | n - ((b^e)*m) &gt; 0  = get_coef n b e (m+1) -- Not there yet.\n</code></pre>\n\n<p>You can call \"baseN_digits n base\" and it will give you the corresponding array of tuples which needs to be converted to the correct output</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1554588737, "post_id": 55553766, "comment_id": 97808977, "body": "Try putting <code>lambda</code> first in <code>block</code>, so something like <code>block = lambda &lt;|&gt; cond &lt;|&gt; ...</code>. (I&#39;m not sure if it will work, but sometimes this sort of thing does work well.)"}, {"owner": {"reputation": 63, "user_id": 11092512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oRvt3Bok-bk/AAAAAAAAAAI/AAAAAAAAACw/m12qxXXs2LA/photo.jpg?sz=128", "display_name": "Ceilvia C", "link": "https://stackoverflow.com/users/11092512/ceilvia-c"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1554589561, "post_id": 55553766, "comment_id": 97809134, "body": "No, it didn&#39;t. But I think I might realize what the problem is. &quot;-&gt;&quot; is not being parsed correctly either"}, {"owner": {"reputation": 63, "user_id": 11092512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oRvt3Bok-bk/AAAAAAAAAAI/AAAAAAAAACw/m12qxXXs2LA/photo.jpg?sz=128", "display_name": "Ceilvia C", "link": "https://stackoverflow.com/users/11092512/ceilvia-c"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1554589976, "post_id": 55553766, "comment_id": 97809214, "body": "Can someone set this question to solved?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 11092512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oRvt3Bok-bk/AAAAAAAAAAI/AAAAAAAAACw/m12qxXXs2LA/photo.jpg?sz=128", "display_name": "Ceilvia C", "link": "https://stackoverflow.com/users/11092512/ceilvia-c"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554591979, "post_id": 55554011, "comment_id": 97809567, "body": "When I do that I get this:  &gt;You can accept your own answer in 2 days"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1554658538, "post_id": 55554011, "comment_id": 97823446, "body": "Why not <code>operator \u201c-&gt;\u201d</code>?"}], "tags": [], "owner": {"reputation": 63, "user_id": 11092512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oRvt3Bok-bk/AAAAAAAAAAI/AAAAAAAAACw/m12qxXXs2LA/photo.jpg?sz=128", "display_name": "Ceilvia C", "link": "https://stackoverflow.com/users/11092512/ceilvia-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1554590546, "last_edit_date": 1554590546, "creation_date": 1554589811, "answer_id": 55554011, "question_id": 55553766, "link": "https://stackoverflow.com/questions/55553766/trouble-parsing-when-implementing-a-parser-for-a-made-up-language-in-a-hask/55554011#55554011", "title": "Trouble parsing &#39;\\\\&#39; when implementing a parser for a made up language in a Haskell assignment", "body": "<p>NVM I found the problem</p>\n\n<pre><code>operator \"\\\\\"\n</code></pre>\n\n<p>actually works but</p>\n\n<pre><code>keyword \"-&gt;\"\n</code></pre>\n\n<p>doesn't because keyword only parse letters, that's why I was getting <strong>Nothing</strong> when using operator \"\\\". So I'm going to use operator \"\\\" and write a parser just for \"->\"</p>\n\n<p>This worked in the end:</p>\n\n<pre><code>    lambda = do\n        operator \"\\\\\"\n        va &lt;- var\n        char '-'\n        operator \"&gt;\"\n        blk &lt;- block\n        return (Lambda va blk)\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 11092512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oRvt3Bok-bk/AAAAAAAAAAI/AAAAAAAAACw/m12qxXXs2LA/photo.jpg?sz=128", "display_name": "Ceilvia C", "link": "https://stackoverflow.com/users/11092512/ceilvia-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55554011, "answer_count": 1, "score": 2, "last_activity_date": 1554590546, "creation_date": 1554587323, "question_id": 55553766, "link": "https://stackoverflow.com/questions/55553766/trouble-parsing-when-implementing-a-parser-for-a-made-up-language-in-a-hask", "title": "Trouble parsing &#39;\\\\&#39; when implementing a parser for a made up language in a Haskell assignment", "body": "<p>I'm writing a parser for a language provide by a EBNF. Everything was going smoothly, I successfully parsed \"if\" \"then\" \"else\", \"Let\" \"in\", and infix like 1 + 2. But when I use the same approach for \"\\\", \"Nothing\" is returned and I just don't know why. the EBNF describes lambda like this:</p>\n\n<pre><code>block ::= cond | lambda | let | infix\nlambda ::= \"\\\" var \"-&gt;\" block\nvar is a letter followed by 0 or more letters. I tested my var parser, it works\n</code></pre>\n\n<p>The <strong>test</strong> is set up like this:</p>\n\n<pre><code>newtype Parser a = PsrOf (String -&gt; Maybe (String, a))\nrunParser :: Parser a -&gt; String -&gt; Maybe a\nrunParser (PsrOf p) inp = case p inp of\n                            Nothing -&gt; Nothing\n                            Just (_, a) -&gt; Just a\nparse = runParser mainParser\ntestHandout =\n    \"handout\" ~: parse inp\n    ~?= (Just (Lambda \"y\" (Num 3)))\n</code></pre>\n\n<p>This is the <strong>Expr</strong> data type provided:</p>\n\n<pre><code>data Expr\n    = Num Integer\n    | Var String\n    | Prim2 Op2 Expr Expr       -- Prim2 op operand operand\n    | Let [(String, Expr)] Expr -- Let [(name, rhs), ...] body\n    | Lambda String Expr        -- Lambda var body\n    | App Expr Expr             -- App func arg\n    | Cond Expr Expr Expr       -- Cond test then-branch else-branch\n    deriving (Eq, Show)\n\ndata Op2 = Eq | Lt | Plus | Minus | Mul | Div | Mod\n    deriving (Eq, Show)\n</code></pre>\n\n<p>My job is to write the <strong>mainParser</strong>. The below code is the part that's related to this question (All code compiles with no error or warning)</p>\n\n<pre><code>mainParser :: Parser Expr\nmainParser = whitespaces *&gt; block &lt;* eof\n  where\n    block = cond &lt;|&gt; lambda &lt;|&gt; letin &lt;|&gt; infixx &lt;|&gt; return (Var \"Error\")\n    lambda = do\n        char '\\\\' *&gt; whitespaces\n        va &lt;- var\n        keyword \"-&gt;\"\n        blk &lt;- block\n        return (Lambda va blk)\n...more code unrelated to question\n</code></pre>\n\n<p>for the line </p>\n\n<pre><code>char '\\\\' *&gt; whitespaces\n</code></pre>\n\n<p>I've tried</p>\n\n<pre><code>operator \"\\\\\"\n</code></pre>\n\n<p>and </p>\n\n<pre><code>keyword \"\\\\\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>string \"\\\\\" *&gt; whitespaces\n</code></pre>\n\n<p>non of them worked, I get Nothing as result everytime.\n<strong>FYI</strong>, My given <strong>parser library</strong> related to this question:</p>\n\n<pre><code>char :: Char -&gt; Parser Char\nchar wanted = satisfy (\\c -&gt; c == wanted)\n\nsatisfy :: (Char -&gt; Bool) -&gt; Parser Char\nsatisfy pred = PsrOf p\n  where\n    p (c:cs) | pred c = Just (cs, c)\n    p _ = Nothing\n\nstring :: String -&gt; Parser String\nstring wanted = PsrOf p\n  where\n    p inp = case stripPrefix wanted inp of\n              Nothing -&gt; Nothing\n              Just suffix -&gt; Just (suffix, wanted)\n\nkeyword :: String -&gt; Parser String\nkeyword wanted = do\n    c &lt;- satisfy isAlpha\n    cs &lt;- many (satisfy isAlphaNum)\n    whitespaces\n    if c:cs == wanted then return wanted else empty\n\n-- | Read something that looks like an operator, then skip trailing spaces.\nanyOperator = some (satisfy symChar) &lt;* whitespaces\n  where\n    symChar c = c `elem` \"=/&lt;&gt;&amp;|+-*%\\\\\"\n\n-- | Read the wanted operator, then skip trailing spaces.\noperator wanted = do\n    sym &lt;- anyOperator\n    if sym == wanted then return wanted else empty\n</code></pre>\n\n<p>My testcase:</p>\n\n<pre><code>\"\\\\y-&gt;3\"\n</code></pre>\n\n<p>Expected result:</p>\n\n<pre><code>(Just (Lambda \"y\" (Num 3)))\n</code></pre>\n\n<p>Actual result:</p>\n\n<pre><code>Nothing\n</code></pre>\n\n<p>I know it's problem with \"\\\" because I switched the \"if\" in my working if then else parser to \"\\\" then else and the if then else parser instantly broke.\nAlso I want to at least try to get an error message so I added</p>\n\n<pre><code> lambda = (do ...... ) &lt;|&gt; return (Var \"lambdaError\")\n</code></pre>\n\n<p>at the end of the lambda block in the <strong>mainParser</strong> but instead of a Just (Var \"lambdaError\") I still get Nothing. \nHow to parse '\\'? Or at least how to test what's the issue here?</p>\n"}, {"tags": ["haskell", "functional-programming", "lazy-evaluation"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1554587268, "post_id": 55553618, "comment_id": 97808671, "body": "Do you have some other examples for us?"}, {"owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1554588088, "post_id": 55553618, "comment_id": 97808862, "body": "@Elmex80s Sorry, I should have put more than 1 example. I added a few more and explained the process more clearly"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1554588322, "post_id": 55553618, "comment_id": 97808906, "body": "Thanks. Input output is sufficient. First step in loop might be distracting"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1554590058, "post_id": 55553618, "comment_id": 97809225, "body": "For your amusement, <code>turnIntList = transpose . map (uncurry (flip replicate))</code> works, too, though technically with signature <code>[(a, Int)] -&gt; [[a]]</code> using <code>Int</code> instead of <code>Integer</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554600105, "post_id": 55553618, "comment_id": 97810770, "body": "Or even shorter, <code>turnIntList = (&gt;&gt;= uncurry (flip replicate))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "edited": false, "score": 0, "creation_date": 1554589096, "post_id": 55553909, "comment_id": 97809052, "body": "I knew there had to be a simpler solution with list comprehensions. I&#39;m pretty new to Haskell and that is one of the areas I am still pretty weak on. Will definitely be reading up on it more. One thing I don&#39;t understand, I would imagine this would throw a <code>n</code> not in scope error since it isn&#39;t explicitly declared anywhere, however this works perfectly."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "edited": false, "score": 0, "creation_date": 1554589904, "post_id": 55553909, "comment_id": 97809202, "body": "<code>n</code> is bound by the pattern match of the inner list comprehension @WilliamJones"}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 2, "last_activity_date": 1555624617, "last_edit_date": 1555624617, "creation_date": 1554588778, "answer_id": 55553909, "question_id": 55553618, "link": "https://stackoverflow.com/questions/55553618/haskell-turning-list-of-tuples-into-list-of-lists/55553909#55553909", "title": "Haskell turning list of tuples into list of lists", "body": "<p>This maybe</p>\n\n<pre><code>turnIntList :: [(Integer, Integer)] -&gt; [[Integer]]\nturnIntList [] = [] -- if it doesn\u2019t compile use [[]]\nturnIntList ls = [i | (i, _) &lt;- ls] : turnIntList [(i, n - 1) | (i, n) &lt;- ls, n - 1 &gt; 0]\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 55553909, "answer_count": 1, "score": 0, "last_activity_date": 1555624617, "creation_date": 1554586002, "last_edit_date": 1554588795, "question_id": 55553618, "link": "https://stackoverflow.com/questions/55553618/haskell-turning-list-of-tuples-into-list-of-lists", "title": "Haskell turning list of tuples into list of lists", "body": "<p>I am trying to turn a list of tuples into a list of lists. For example, if I have the list <code>[(9,1), (6,3), (4,1)]</code>, then this will turn into <code>[[9, 6, 4],[6],[6]]</code>. What's happening is that in the list of tuples <code>[(a,b)]</code>, <code>a</code> represents a number from 0-9 and <code>b</code> represents the occurrence of that number, <code>a</code> will always be unique.</p>\n\n<p>What I am trying to do it go go over the list <code>n</code> times, where <code>n = maximum b in the list of tuples.</code> Each time I go over the list, I take <code>a</code> and put it into a list, then decrement <code>b</code> by 1. If <code>b == 0</code> then I just skip it. </p>\n\n<p>So from my example, I take <code>[9,6,4]</code> and throw them into a list, then decrement the <code>b</code> of each of them, so now the list would look like <code>[(9,0),(6,2),(4,0)]</code>. Then going over again, I take <code>[6]</code>, list of tuples now looks like <code>[(9,0), (6,1), (4,0)]</code>. Finally, take <code>[6]</code> one last time, and now ever <code>b</code> in the list of tuples is <code>0</code> so it is done.</p>\n\n<p>I have created a a function that takes the 1st element from the list of tuples iff <code>b</code> is >= 1, but I don't know how I can iterate this over the updated list with all `b - 1' for each tuple.</p>\n\n<pre><code>turnIntList :: [(Integer, Integer)] -&gt; [[Integer]]\nturnIntList [] = []\nturnIntList x = ([map (\\(a, b) -&gt; case (a,b) of  _ | b &gt;= 1 -&gt; a | otherwise -&gt; -1) x])\n</code></pre>\n\n<p>I have also tried creating another helper function that takes a list of tuples and will turn them into a list depending on how large <code>b</code> is. From the main function, I would try to send [(a, 1), (b, 1)...] to create the list, then keep track of decrementing <code>b</code> here until it's done. So, for this function:</p>\n\n<pre><code>pairingL :: [(Integer, Integer)] -&gt; [Integer] -&gt; [Integer]\npairingL ((a,b):xs) l -- = if b /= 0 then [a,b-1] else []\n    | null xs = if b == 1 then [a] ++ l else if b &gt; 1 then [a] ++ l ++ pairingL [(a,b-1)] l else l\n    | otherwise = \n        if b /= 0 then [a] ++ l ++ pairingL ((a,b-1):xs) l else pairingL xs l\n\n\npairingL [(9,1), (7,2), (5,1)]\n[9,7,7,5]\n\npairingL [(1,1), (2,1), (3,1)]\n[1,2,3]\n\npairingL [(1,2), (2,2), (3,2)]\n[1,1,2,2,3,3]\n</code></pre>\n\n<p>I've tried looking into unzipping the list and working with that, iteration, and repeat but I can't figure out how to get the function to go over the list multiple times and updating the list with the new <code>b</code> values then going again.</p>\n\n<p>In conclusion, what I am trying to do is something like:</p>\n\n<pre><code>    turnIntList [(9,3),(5,1),(2,1)]\n    [[9,5,2],[9],[9]]\n\n    turnIntList [(1,1),(2,1),(3,1),(4,1)]\n    [[1,2,3,4]]\n\n    turnIntList [(1,2),(2,2),(3,2)]\n    [[1,2,3],[1,2,3]]\n\n    turnIntList [(4,2),(6,1)]\n    [[4,6],[4]]\n</code></pre>\n\n<p><strong>Process:</strong>\nI am taking the first element from the tuples, adding them to a list, then subtracting the second element by 1. After doing this for each tuple in the list, I repeat the process until all the second elements for each tuple is 0</p>\n\n<p>Important notes: again, in the list of tuples [(a,b)], <code>a</code> will ALWAYS be UNIQUE number from 0-9, and <code>b &gt;= 0</code></p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1554585055, "post_id": 55553466, "comment_id": 97808171, "body": "Break things up. You are really close. Don&#39;t try and get fancy with point-free notation."}, {"owner": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554585330, "post_id": 55553466, "comment_id": 97808232, "body": "Trying make things done for about 3 hours. I will be delighted if you can help me a little more ;)."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1554756018, "post_id": 55553466, "comment_id": 97861236, "body": "&quot;I know that isLower don&#39;t have got any argument but I don&#39;t know what to use.&quot; Instead of thinking about the arguments to <code>isLower</code>, try thinking about the arguments to <code>filter</code>. It takes two of them. How many are you passing to it?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554586263, "post_id": 55553613, "comment_id": 97808443, "body": "lowerCount and upperCount should have something like this? <code>length . filter (isLower)</code>?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554586462, "post_id": 55553613, "comment_id": 97808479, "body": "Try it and see."}, {"owner": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554586586, "post_id": 55553613, "comment_id": 97808509, "body": "I tried and it still doesn&#39;t work :/. I am wondering where i should put this str. I tried <code>length . filter (isLower str)</code> but it doesn&#39;t work and doesn&#39;t make sense I think."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554586670, "post_id": 55553613, "comment_id": 97808534, "body": "&quot;it doesn&#39;t work&quot;, helps no one, least of all you. What&#39;s the error? Include what you tried, and the error in your problem report above. Not in comments."}, {"owner": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554586969, "post_id": 55553613, "comment_id": 97808610, "body": "Updated post, I&#39;m trying to understand the problem but I&#39;m new to functional programming and don&#39;t know how to build tuples by now."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554587144, "post_id": 55553613, "comment_id": 97808651, "body": "Your functions need a value. The name of the value in this case is <code>str</code>. The problem isn&#39;t not being able to build tuples but rather understanding the error message you see. This will come in time, you&#39;re doing fine."}, {"owner": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554587348, "post_id": 55553613, "comment_id": 97808687, "body": "I get that str is a string and function isLower needs char. What i should do? Something like head and tail? How can I get suitable value for isLower and isUpper?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "edited": false, "score": 0, "creation_date": 1554588714, "post_id": 55553613, "comment_id": 97808971, "body": "what is the type of <code>filter</code>? what is the type of <code>filter isLower</code> ? What is the type of <code>str</code>?"}], "tags": [], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "is_accepted": false, "score": 0, "last_activity_date": 1554585970, "creation_date": 1554585970, "answer_id": 55553613, "question_id": 55553466, "link": "https://stackoverflow.com/questions/55553466/count-lowercase-and-uppercase-then-return-it-as-a-tuple/55553613#55553613", "title": "Count lowercase and uppercase then return it as a tuple", "body": "<pre><code>import Data.Char\n\ncountLowerUpper :: String -&gt; (Int,Int)\ncountLowerUpper str = (lowerCount,upperCount)\n    where lowerCount = undefined\n          upperCount = undefined\n</code></pre>\n\n<p>You can do this.</p>\n"}], "owner": {"reputation": 1, "user_id": 11322562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dab4a5144183584924fe3a4e1316b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dev1998", "link": "https://stackoverflow.com/users/11322562/dev1998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554586902, "creation_date": 1554584685, "last_edit_date": 1554586902, "question_id": 55553466, "link": "https://stackoverflow.com/questions/55553466/count-lowercase-and-uppercase-then-return-it-as-a-tuple", "title": "Count lowercase and uppercase then return it as a tuple", "body": "<p>I want to implement a function called countLowerUpper which takes a String and count lower and uppercases and return it as a tuple. For example : <code>countLowerUpper \"TeST\"</code> should return <code>(1,3)</code>. I don't know how to return a tuple properly. I am forced to use <code>countLowerUpper :: String-&gt; (Int,Int)</code>. I can't change it.</p>\n\n<pre><code>import Data.Char\ncountLowerUpper :: String-&gt; (Int,Int)\ncountLowerUpper = (length . filter (isLower),length . filter(isUpper))\n</code></pre>\n\n<p>EDIT After received help I change my code to:</p>\n\n<pre><code>import Data.Char\n\ncountLowerUpper :: String-&gt; (Int,Int)\ncountLowerUpper str  = (lowerCount,upperCount)\n    where lowerCount =length . filter(isLower)\n          upperCount =length . filter(isUpper)\n</code></pre>\n\n<p>But still have got error:</p>\n\n<pre><code> error:\n    \u2022 Couldn't match expected type \u2018Int\u2019\n                  with actual type \u2018[Char] -&gt; Int\u2019\n    \u2022 Probable cause: \u2018upperCount\u2019 is applied to too few arguments\n      In the expression: upperCount\n      In the expression: (lowerCount, upperCount)\n      In an equation for \u2018countLowerUpper\u2019:\n          countLowerUpper str\n            = (lowerCount, upperCount)\n            where\n                lowerCount = length . filter (isLower)\n                upperCount = length . filter (isUpper)\n  |\n4 | countLowerUpper str  = (lowerCount,upperCount)   | \n</code></pre>\n\n<p>I know that isLower don't have got any argument but I don't know what to use. Maybe str? Or use head and tail of string?</p>\n"}, {"tags": ["haskell", "ncurses"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1554572176, "post_id": 55550659, "comment_id": 97804751, "body": "To elaborate on the answer, instead of trying to reassign variables, pass the &quot;modified&quot; states to the next iteration/recurse. Think of <code>fold</code>. The accumulator is passed to each successive call as an argument instead of reassigning some variable."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1554565469, "creation_date": 1554565469, "answer_id": 55550737, "question_id": 55550659, "link": "https://stackoverflow.com/questions/55550659/ncurses-continously-update-x-and-y-coordinate-in-movecursor/55550737#55550737", "title": "NCurses continously update x and y coordinate in moveCursor", "body": "<p>Curse, ncurse, and recurse:</p>\n\n<pre><code>loop w x y = do\n    e &lt;- getEvent w Nothing\n    updateWindow w $ do\n        moveCursor x y\n        drawString (show e)\n    render\n    loop w (x+1) (y+1)\n\nmain = runCurses $ do\n    w &lt;- defaultWindow\n    loop w 0 0\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11295023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4f4d288ee8e206796cea1221f66be8?s=128&d=identicon&r=PG&f=1", "display_name": "abc556", "link": "https://stackoverflow.com/users/11295023/abc556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 55550737, "answer_count": 1, "score": 2, "last_activity_date": 1554579541, "creation_date": 1554564950, "last_edit_date": 1554579541, "question_id": 55550659, "link": "https://stackoverflow.com/questions/55550659/ncurses-continously-update-x-and-y-coordinate-in-movecursor", "title": "NCurses continously update x and y coordinate in moveCursor", "body": "<p>I want to make some sort of game with a snake-like mechanic where you use your arrowkeys to change the coordinate of your snake. But since reassignment of variables isn't a thing in haskell I'm unsure of how to do this. Here is my code:</p>\n\n<pre><code>import Control.Monad\nimport UI.NCurses\n\nmain :: IO ()\nmain = runCurses $ do\n    w &lt;- defaultWindow\n    forever $ do\n        e &lt;- getEvent w Nothing\n        updateWindow w $ do\n            moveCursor 0 0\n            drawString (show e)\n        render\n\n</code></pre>\n\n<p>I want it to print the key pressed (<code>drawString (show e)</code>) and then change the cursor to previous x+1, previous y+1, then draw the next key pressed then change the cursor and so on.</p>\n\n<p>How do you do this in NCurses? If reassignment was possible it would be simple, like </p>\n\n<pre><code>loop forever:\nmoveCursor x y\nprint\nx = x+1\ny = y+1\n</code></pre>\n\n<p>But reassignment doesn't work so what can I do instead?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554564917, "post_id": 55550603, "comment_id": 97802592, "body": "We have <code>newtype StateT s m a = StateT { runStateT :: s -&gt; m (a,s) }</code>. That being so, <code>(StateT s IO)    a</code> boils down to <code>s -&gt; IO (a,s)</code>, and there is no dangling <code>a</code>."}, {"owner": {"reputation": 309, "user_id": 7571000, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155043356444224/picture?type=large", "display_name": "Shane Unger", "link": "https://stackoverflow.com/users/7571000/shane-unger"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554565117, "post_id": 55550603, "comment_id": 97802643, "body": "@duplode what about the <code>a</code> that ReaderT returns? <code>newtype ReaderT r m a = ReaderT { runReaderT :: r -&gt; m a }</code>.  Because <code>IO (a,s)</code> has the <code>a</code> in the tuple it&#39;s been removed from far right like I have it above?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554565576, "post_id": 55550603, "comment_id": 97802783, "body": "&quot;what about the <code>a</code> that ReaderT returns?&quot; -- That&#39;s the <code>a</code> in <code>(StateT s IO) a</code>. Note that <code>ReaderT</code> doesn&#39;t return an <code>a</code> per se, but rather an <code>m a</code>."}, {"owner": {"reputation": 309, "user_id": 7571000, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155043356444224/picture?type=large", "display_name": "Shane Unger", "link": "https://stackoverflow.com/users/7571000/shane-unger"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554565982, "post_id": 55550603, "comment_id": 97802940, "body": "@duplode :mind-blown: that makes total sense now, wow thanks so much for clearing that up for me!!"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 7571000, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155043356444224/picture?type=large", "display_name": "Shane Unger", "link": "https://stackoverflow.com/users/7571000/shane-unger"}, "edited": false, "score": 0, "creation_date": 1554610892, "post_id": 55550814, "comment_id": 97812204, "body": "You&#39;re answer was very helpful, I really appreciate it, thanks!"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 9, "last_activity_date": 1554565999, "creation_date": 1554565999, "answer_id": 55550814, "question_id": 55550603, "link": "https://stackoverflow.com/questions/55550603/understanding-monad-transformer-type-signatures/55550814#55550814", "title": "Understanding Monad Transformer Type Signatures", "body": "<p>The stack you wrote is a little odd because it's parametrized by <code>m</code> on the left but specialized to <code>IO</code> on the right, so let's look at the fully <code>m</code>-parametrized variant:</p>\n\n<pre><code>newtype Stack s m a = Stack { runStack :: ReaderT s (StateT s m) a }\n</code></pre>\n\n<p>Now <code>runStack</code> here is just a field name, so we can drop it and write the equivalent <code>newtype</code> definition:</p>\n\n<pre><code>newtype Stack s m a = Stack (ReaderT s (StateT s m) a)\n</code></pre>\n\n<p>We also have the following library newtype definitions, skipping the field names.  I've also used fresh variables so we don't do something stupid like confuse two <code>a</code>s in different scope while expanding:</p>\n\n<pre><code>newtype ReaderT r1 m1 a1 = ReaderT (r1 -&gt; m1 a1)\nnewtype StateT s2 m2 a2 = StateT (s2 -&gt; m2 (a2, s2))\n</code></pre>\n\n<p>Of course, if we're only interested in the type up to isomorphism, then the newtype wrappers don't matter, so just rewrite these as type aliases:</p>\n\n<pre><code>type Stack s m a = ReaderT s (StateT s m) a\ntype ReaderT r1 m1 a1 = r1 -&gt; m1 a1\ntype StateT s2 m2 a2 = s2 -&gt; m2 (a2, s2)\n</code></pre>\n\n<p>Now, it's easy to expand the <code>Stack</code> type:</p>\n\n<pre><code>Stack s m a\n= ReaderT s (StateT s m) a\n-- expand ReaderT with r1=s, m1=StateT s m, a1=a\n= s -&gt; (StateT s m) a\n= s -&gt; StateT s m a\n-- expand StateT with s2=s m2=m a2=a\n= s -&gt; (s -&gt; m (a, s))\n= s -&gt; s -&gt; m (a, s)\n</code></pre>\n\n<p>As @duplode noted, there's no extra <code>a</code> here.</p>\n\n<p>Intuitively this <code>Stack</code> reads from an <code>s</code> (first argument) takes an initial state of type <code>s</code> (second argument), and returns a monadic action in <code>m</code> (e.g., <code>IO</code>) that can return a value of type <code>a</code> and an updated state of type <code>s</code>.</p>\n"}], "owner": {"reputation": 309, "user_id": 7571000, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155043356444224/picture?type=large", "display_name": "Shane Unger", "link": "https://stackoverflow.com/users/7571000/shane-unger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 55550814, "answer_count": 1, "score": 7, "last_activity_date": 1554565999, "creation_date": 1554564629, "question_id": 55550603, "link": "https://stackoverflow.com/questions/55550603/understanding-monad-transformer-type-signatures", "title": "Understanding Monad Transformer Type Signatures", "body": "<p>I'm currently tackling monad transformers and trying to really understand the type signatures, and I'm having some confusion. Let's use the following stack for discussion:</p>\n\n<pre><code>newtype Stack s m a = Stack { runStack :: ReaderT s (StateT s IO) a }\n</code></pre>\n\n<p>I'm trying to go through layer by layer and write the unwrapped type signatures but getting stuck:</p>\n\n<pre><code>newtype Stack s m a = Stack { \n    runStack :: ReaderT s         (StateT s IO)       a }\n--              ReaderT s                  m          a\n--                      s -&gt;               m          a\n--                      s -&gt;         (StateT s IO)    a\n--                            StateT  s     m         a\n--                      s -&gt;         (s -&gt; IO (a, s)) a  \n</code></pre>\n\n<p>That just doesn't look like a valid return type signature on the last line, we have essentially a function that takes an s and returns a function shoved up against an <code>a</code>? </p>\n\n<p>I <em>get</em> that the inner function evaluates to a Monad eventually, and that's why it's the <code>m</code> in <code>ReaderT r m a</code>, but it's bending my brain. </p>\n\n<p>Could anyone offer any insight, have I correceclty analyzed the types and I just have to accept that <code>s -&gt; (s -&gt; IO (a, s)) a</code> is indeed valid?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1554564568, "post_id": 55549883, "comment_id": 97802504, "body": "There isn&#39;t a question here"}], "answers": [{"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 26, "user_id": 5773108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x5N8g.jpg?s=128&g=1", "display_name": "mohamad Jamal", "link": "https://stackoverflow.com/users/5773108/mohamad-jamal"}, "edited": false, "score": 4, "creation_date": 1554561632, "post_id": 55550041, "comment_id": 97801708, "body": "@mohamadJamal Also note there is a prelude function that does just this: <code>words :: String -&gt; [String]</code>, and the  you can take the head"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 6, "last_activity_date": 1554561021, "last_edit_date": 1554561021, "creation_date": 1554560789, "answer_id": 55550041, "question_id": 55549883, "link": "https://stackoverflow.com/questions/55549883/define-takeword-dropword-and-words-function-in-haskell/55550041#55550041", "title": "Define takeword, dropword and words function in Haskell", "body": "<p>Well, let's start with your definition:</p>\n\n<pre><code>takeword :: String -&gt; String\ntakeword \"\" = \"\"\ntakeword (x:xs) = x : takeword xs\n</code></pre>\n\n<p>This does nothing to treat non-space characters and spaces differently. The first step would be to pattern match on spaces. So, let's split the second line into two cases:</p>\n\n<pre><code>takeword :: String -&gt; String\ntakeword \"\" = \"\"\ntakeword (' ':xs) = error \"TODO\"  -- Spaces\ntakeword (x:xs) = x : takeword xs -- Non-spaces\n</code></pre>\n\n<p>Now, if we encounter a space, then clearly that's as far as we need to go, so at that point we can just return an empty string. After a bit of formatting, we get this:</p>\n\n<pre><code>takeword :: String -&gt; String\ntakeword  \"\"      = \"\"\ntakeword (' ':xs) = \"\"\ntakeword (x  :xs) = x : takeword xs\n</code></pre>\n\n<p>And that's it. That's all there is to it. Here it is in action:</p>\n\n<pre><code>\u03bb&gt; takeword \"Hello, World!\"\n\"Hello,\"\n\u03bb&gt; takeword \"This is a test.\"\n\"This\"\n\u03bb&gt; takeword \"is a test.\"\n\"is\"\n</code></pre>\n\n<hr>\n\n<p><em><strong>Exercise</strong>: What if I wanted to split a string on the first word, so <code>splitOnWord \"Hello, world of worlds!\"</code> returns <code>(\"Hello,\", \"World of worlds!\")</code>? This can be very easily written given the <code>takeword</code> function you already have.</em></p>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1554606246, "creation_date": 1554606246, "answer_id": 55555226, "question_id": 55549883, "link": "https://stackoverflow.com/questions/55549883/define-takeword-dropword-and-words-function-in-haskell/55555226#55555226", "title": "Define takeword, dropword and words function in Haskell", "body": "<p>Here's an even simpler solution:</p>\n\n<pre><code>takeword = takeWhile (' ' /=)\n</code></pre>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:takeWhile\" rel=\"nofollow noreferrer\"><code>takeWhile</code></a>, applied to a predicate p and a list xs, returns the longest prefix (possibly empty) of <code>xs</code> of elements that satisfy <code>p</code></p>\n</blockquote>\n\n<p>In this case, the predicate is testing that the element isn't a space. Thus, this will return the longest prefix that contains no spaces.</p>\n"}], "owner": {"reputation": 26, "user_id": 5773108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x5N8g.jpg?s=128&g=1", "display_name": "mohamad Jamal", "link": "https://stackoverflow.com/users/5773108/mohamad-jamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 55550041, "answer_count": 2, "score": -4, "last_activity_date": 1554630295, "creation_date": 1554559650, "last_edit_date": 1554630295, "question_id": 55549883, "link": "https://stackoverflow.com/questions/55549883/define-takeword-dropword-and-words-function-in-haskell", "title": "Define takeword, dropword and words function in Haskell", "body": "<p>I am trying to Define a takeWord function in Haskell which takes a string and returns its first word. It should take each character at a time from the beginning to the end until the first space character. It should return the characters before the first space character. dropword function it is similar to takeword but drop the first word and take rest. wordsof function it is similar to words function in haskell.</p>\n\n<pre><code>takeword :: String -&gt; String\ntakeword \"\" = \"\"\ntakeword (x:xs) = x : takeword xs\n</code></pre>\n\n<p>sample of result</p>\n\n<pre><code>*Main&gt; takeword \"abcdef\"\n\"abcdef\"\n</code></pre>\n\n<pre><code>dropword :: String -&gt; String\ndropword \"\" = \"\"\ndropword (' ': xs) = \"\"\ndropword (x:xs) = drop length(takeword xs) takeword xs\n\n\n\n\nwordsof :: String -&gt; [[Char]]\nwordsof \"\" = []\nwordsof (x:xs) = takeword xs\nwordsof x = splitOn (takeword x)\n\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1554564635, "post_id": 55548005, "comment_id": 97802535, "body": "What is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "is_accepted": true, "score": -2, "last_activity_date": 1554548094, "last_edit_date": 1554548094, "creation_date": 1554547596, "answer_id": 55548297, "question_id": 55548005, "link": "https://stackoverflow.com/questions/55548005/count-occurences-in-a-list-and-return-it-in-another-list/55548297#55548297", "title": "Count occurences in a list and return it in another list", "body": "<p>One way of doing it is with <a href=\"http://learnyouahaskell.com/starting-out#im-a-list-comprehension\" rel=\"nofollow noreferrer\">list comprehension</a>:</p>\n\n<pre><code>countAll xs = nub [(x, count x xs) | x &lt;- xs]\n</code></pre>\n\n<p><code>nub</code> removes the duplicates and you will need to <code>import Data.List (nub)</code> to use it.</p>\n"}, {"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554566184, "post_id": 55549425, "comment_id": 97803000, "body": "The original question did ask to use the function <code>count</code>. Also worth noting that this only works on ints - which may be sufficient, OP is not entirely clear, but <code>count</code> only assumes <code>Eq</code> constraint."}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 0, "last_activity_date": 1554556562, "creation_date": 1554556562, "answer_id": 55549425, "question_id": 55548005, "link": "https://stackoverflow.com/questions/55548005/count-occurences-in-a-list-and-return-it-in-another-list/55549425#55549425", "title": "Count occurences in a list and return it in another list", "body": "<p>Using a fast data-structure, for example <code>Data.IntMultiSet</code>. Let <code>ls = [1,2,3,4,4,4]</code></p>\n\n<pre><code>import qualified Data.IntMultiSet as IntMultiSet\n\nIntMultiSet.fromList ls \n</code></pre>\n\n<p>An alternative using <code>IntMap</code>:</p>\n\n<pre><code>import qualified Data.IntMap.Strict as IntMap\n\nIntMap.fromListWith (+) [(k,1) | k &lt;- ls]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 0, "last_activity_date": 1554662678, "last_edit_date": 1554662678, "creation_date": 1554662299, "answer_id": 55562405, "question_id": 55548005, "link": "https://stackoverflow.com/questions/55548005/count-occurences-in-a-list-and-return-it-in-another-list/55562405#55562405", "title": "Count occurences in a list and return it in another list", "body": "<p>We can do better than <code>nub</code> (which is <code>O(n^2)</code>) if the list elements are also instances of <code>Ord</code> without requiring the heavy machinery of an <code>IntMultiSet</code> by putting like elements together with <code>sort</code> and then grouping them into sublists with <code>group</code>. For example, <code>group . sort $ [1,2,3,4,4,4]</code> gives <code>[[1], [2], [3], [4,4,4]]</code>.</p>\n\n<p>Once we have these items organized into sublists, we can count each sublist:</p>\n\n<pre><code>countAll = map (\\(x:xs) -&gt; (x, count x (x:xs))) . group . sort\n</code></pre>\n\n<p>(Note that <code>group</code> guarantees that there won't be any empty sublists so we know that we don't need to check the <code>[]</code> case in our mapped function even though the compiler does not.)</p>\n\n<p>If we don't need to use <code>count</code>, we can instead use</p>\n\n<pre><code>countAll = map (\\xs -&gt; (head xs, length xs)) . group . sort\n</code></pre>\n\n<p>or, with the handy <code>(&amp;&amp;&amp;)</code> combinator from <code>Control.Arrow</code>,</p>\n\n<pre><code>countAll = map (head &amp;&amp;&amp; length) . group . sort\n</code></pre>\n\n<p>Since an <a href=\"https://en.m.wikipedia.org/wiki/Association_list\" rel=\"nofollow noreferrer\">association list</a> of elements with their counts is a handy way to represent a <a href=\"https://en.m.wikipedia.org/wiki/Multiset\" rel=\"nofollow noreferrer\">bag</a>, I like to call this</p>\n\n<pre><code>bag = map (head &amp;&amp;&amp; length) . group . sort\n</code></pre>\n\n<p><code>bag</code> is <code>O(n log n)</code>, which is only a log factor worse than the <code>IntMultiSet</code> version.</p>\n"}], "owner": {"reputation": 40, "user_id": 11320753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0fe992b4bf6cedd71801cfefe7188c?s=128&d=identicon&r=PG&f=1", "display_name": "Kardam", "link": "https://stackoverflow.com/users/11320753/kardam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 55548297, "answer_count": 3, "score": -3, "last_activity_date": 1554662678, "creation_date": 1554545233, "question_id": 55548005, "link": "https://stackoverflow.com/questions/55548005/count-occurences-in-a-list-and-return-it-in-another-list", "title": "Count occurences in a list and return it in another list", "body": "<p>I want to do a function called countAll. This function should get a list of numbers and return a list (element,number of occurences). For example :\ncountAll [1,2,3,4,4,4] should return \n[(1,1),(2,1),(3,1),(4,3)]\nI am forced to use function count which i posted below.</p>\n\n<pre><code>count :: Eq a=&gt; a -&gt; [a] -&gt; Int\ncount e [] = 0\ncount e (x:xs) \n | e == x = 1 + count e xs\n | otherwise = count e xs\n</code></pre>\n"}, {"tags": ["python", "haskell", "python-typing"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1554546658, "post_id": 55547950, "comment_id": 97798129, "body": "What <i>is</i> <code>Monad</code>? It&#39;s not in <a href=\"https://docs.python.org/3/library/typing.html\" rel=\"nofollow noreferrer\"><code>typing</code></a>. And what do you mean <i>&quot;not valid&quot;</i>? Give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1554635148, "post_id": 55547950, "comment_id": 97816838, "body": "might also depend on what you actually use for typechecking (<code>mypy</code> vs PyCharm IDE etc.) see <a href=\"https://medium.com/@ageitgey/learn-how-to-use-static-type-checking-in-python-3-6-in-10-minutes-12c86d72677b#c3b1\" rel=\"nofollow noreferrer\">medium.com/@ageitgey/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1554561763, "post_id": 55548174, "comment_id": 97801754, "body": "Thanks. The problem is that Monad is defined in a library and is not my code. (I should have mentioned that in the question.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1554562805, "post_id": 55548174, "comment_id": 97802037, "body": "@RussAbbott You&#39;ll probably have to define your own type-hint proxy for <code>Monad</code>, just as <code>typing</code> provides <code>List</code> for <code>[]</code> (and other list-like types)."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554586735, "post_id": 55548174, "comment_id": 97808554, "body": "@chepner, Do you have a suggestion about what that might look like?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554587474, "post_id": 55548174, "comment_id": 97808712, "body": "<code>class MonadType(Generic[a]): pass</code> might suffice."}], "tags": [], "owner": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "is_accepted": false, "score": 2, "last_activity_date": 1554546491, "creation_date": 1554546491, "answer_id": 55548174, "question_id": 55547950, "link": "https://stackoverflow.com/questions/55547950/how-to-represent-a-parameterized-type-in-python/55548174#55548174", "title": "How to represent a parameterized type in Python?", "body": "<p>Have <code>Monad</code> inherit from <code>Generic</code>:</p>\n\n<pre><code>from typing import TypeVar, List, Callable, Generic\n\na = TypeVar('a')\nb = TypeVar('b')\n\nclass Monad(Generic[a]):\n    # your code here\n    pass\n\ndef foldM(f: Callable[[a, b], Monad[a]], acc: a, xs: List[b]) -&gt; Monad[a]:\n    # your code here\n    pass\n</code></pre>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554546491, "creation_date": 1554544882, "question_id": 55547950, "link": "https://stackoverflow.com/questions/55547950/how-to-represent-a-parameterized-type-in-python", "title": "How to represent a parameterized type in Python?", "body": "<p>In Haskell, <code>foldm</code> (the monad version of <code>foldl</code>) has this type.</p>\n\n<p><code>foldM :: (Monad m) =&gt; (a -&gt; b -&gt; m a) -&gt; a -&gt; [b] -&gt; m a</code></p>\n\n<p>(See <a href=\"https://wiki.haskell.org/All_About_Monads#Monadic_versions_of_list_functions\" rel=\"nofollow noreferrer\">this</a>, for example.)</p>\n\n<p>A Python equivalent might be declared like this.</p>\n\n<pre><code>a = TypeVar('a')\nb = TypeVar('b')\ndef foldM(f: Callable[[a, b], Monad], acc: a, xs: List[b]) -&gt; Monad:\n    ...\n</code></pre>\n\n<p>A problem with this is that it doesn't show <code>Monad</code> as parameterized by type <code>a</code>. I'd like to write <code>Monad[a]</code>, but that is not valid. Is there a way to do this?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1554537401, "post_id": 55546912, "comment_id": 97796175, "body": "Can you write a function <code>mergeStars :: String -&gt; String -&gt; String</code> that takes two of these star-lists and produces one that combines stars from both? Hint: you might want to use <code>zipWith</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554537761, "post_id": 55546912, "comment_id": 97796229, "body": "I would find the maximum of the list, and then <code>map</code> over the enumeration <code>[0..maxOfList]</code> with a function that checks if the number is in the input list, and produces <code>&#39;*&#39;</code> or <code>&#39; &#39;</code> accordingly."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554543264, "post_id": 55546912, "comment_id": 97797418, "body": "what&#39;s the output for <code>[2,2]</code>? and for <code>[3,1]</code>?"}, {"owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "edited": false, "score": 0, "creation_date": 1554550992, "post_id": 55546912, "comment_id": 97799136, "body": "Looks like the <code>s</code> in <code>makeStr (x:xs) s</code> is never used. The type signature could not be just <code>makeStr :: [Integer] -&gt; String</code> instead of <code>makeStr :: [Integer] -&gt; String -&gt; String</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1554538489, "post_id": 55547139, "comment_id": 97796377, "body": "You have to check every element at every step, consider <code>f [3, 1]</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1554538713, "post_id": 55547139, "comment_id": 97796421, "body": "@Koterpillar The OP stated that &quot;the list will always be a number from 0-9, increasing, and NO repeats&quot;, so that can not happen."}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1554538790, "post_id": 55547139, "comment_id": 97796438, "body": "Sorry, I didn&#39;t notice, was just trying to reverse engineer the requirements from the examples :)"}, {"owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "edited": false, "score": 0, "creation_date": 1554539666, "post_id": 55547139, "comment_id": 97796621, "body": "Ahh, I wish I would have thought of this. I really over complicated what I had to do haha, I&#39;ll update my post with this solution"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1554538412, "creation_date": 1554538412, "answer_id": 55547139, "question_id": 55546912, "link": "https://stackoverflow.com/questions/55546912/haskell-string-manipulation/55547139#55547139", "title": "Haskell string manipulation", "body": "<p>A possible solution could follow these steps.</p>\n\n<ul>\n<li>If the input list is empty, return the empty string.</li>\n<li>If the input list is <code>x:xs</code>, check <code>x</code>.\n\n<ul>\n<li>If <code>x==0</code>, then emit a <code>'*'</code>, and recurse with <code>xs</code> where each number has been decremented</li>\n<li>If <code>x/=0</code>, then emit a <code>' '</code>, and recurse with <code>x:xs</code> where each number has been decremented</li>\n</ul></li>\n</ul>\n\n<p>E.g.</p>\n\n<pre><code>f [1,3]\n= ' ' : f [0,2]\n= ' ' : '*' : f [1]\n= ' ' : '*' : ' ' : f [0]\n= ' ' : '*' : ' ' : '*' : f []\n= ' ' : '*' : ' ' : '*' : []\n= \" * *\"\n</code></pre>\n\n<p>The above is not efficient as it could be. One can improve the efficiency keeping a second \"offset\" integer argument, and incrementing that instead of decrementing the whole list.</p>\n"}, {"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554564375, "post_id": 55548572, "comment_id": 97802450, "body": "I prefer <code>f i (x:xs) = replicate (x-i) &quot; &quot; ++ &#39;*&#39; : f (x+1) xs</code>, no need to single-step the integer accumulator"}], "tags": [], "owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "is_accepted": false, "score": 2, "last_activity_date": 1554549714, "creation_date": 1554549714, "answer_id": 55548572, "question_id": 55546912, "link": "https://stackoverflow.com/questions/55546912/haskell-string-manipulation/55548572#55548572", "title": "Haskell string manipulation", "body": "<p>@chi solution, but without the need to decrement every element of the list at every recursive step.</p>\n\n<pre><code>makeStr = f 0\n\nf _ [] = \"\"\nf i (x:xs)\n    | x - i == 0 = '*' : f (i+1) xs\n    | otherwise  = ' ' : f (i+1) (x:xs)\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 55547139, "answer_count": 2, "score": 4, "last_activity_date": 1554568895, "creation_date": 1554536393, "last_edit_date": 1554568895, "question_id": 55546912, "link": "https://stackoverflow.com/questions/55546912/haskell-string-manipulation", "title": "Haskell string manipulation", "body": "<p>I am trying to create a function that combines strings given a list of Integers. For example, say the function was given <code>[1,2,3]</code>, then the output would be <code>\" ***\"</code>. Basically, each number represents a <code>*</code> with spaces before it. So the number <code>5</code> would be <code>\"    *\"</code> which is 4 spaces followed by the <code>*</code>. However, I am given a list and I can't just <code>++</code> them all together because the strings mess up the order.</p>\n\n<p>My idea was to start out by taking the first element in the list and send it back as the string recursively. So for <code>[1,2,3]</code> I would send back to the function <code>[2,3]</code> with <code>String = \" *\"</code>. Next, for each element I check if the length of the string -1 is <code>&lt;=</code> the next element (- 1 because 0 is included). In the list that I am giving the function, this will ALWAYS be the case (the list will always be a number from 0-9, increasing, and NO repeats). Then I would <code>++</code> the original string to the function call again to make the recursive statement. I did this till there was nothing left. Here is what I've done:</p>\n\n<pre><code>makeStr :: [Integer] -&gt; String -&gt; String\nmakeStr [] _ = \"\"\nmakeStr (x:xs) s\n        | null xs &amp;&amp; s == \"\"               = getStar ((fromIntegral x)) \"*\"\n        | null xs &amp;&amp; s /= \"\"               = s ++ getStar ((fromIntegral x) - (length s)) \"*\"\n        | s == \"\"                          = makeStr xs (getStar ((fromIntegral x) - ((length s))) \"*\")\n        | length s - 1 &lt;= (fromIntegral x) = s ++ makeStr xs (getStar ((fromIntegral x) - ((length s))) \"*\")\n</code></pre>\n\n<p>Note: getStar is a simple function that takes a number and \"*\" and returns the string with the correct amount of spaces. It has the declaration of <code>getStar :: Int -&gt; String -&gt; String</code>. This function works perfectly, I have tested it numerous times and I really do not believe it is the issue, hence why I did not include it.</p>\n\n<p>An example of getStar function is:</p>\n\n<pre><code>getStar 3 \"*\"\n\"   *\"\n</code></pre>\n\n<p>some example inputs with expected outputs:</p>\n\n<pre><code>makeStr [1,2,3] \"\"\n\" ***\"\n\nmakeStr [0,2,3] \"\"\n\"*  **\"\n\nmakeStr [1,2,3,4] \"\"\n\" ****\"\n\nmakeStr [0,9] \"\"\n\"*        *\"\n</code></pre>\n\n<p>The output of my program is incorrect for any list over 2 elements. </p>\n\n<pre><code>makeStr [0,1] \"\" -- correct\n\"**\"\n\nmakeStr [1,2,3] \"\" -- incorrect, should be \" ***\"\n\" **  *\"\n\nmakeStr [1,2,3,4] \"\" -- incorrect, should be \" ****\"\n\" **  * *\"\n</code></pre>\n\n<p>I can't figure out why it is correct for the first 2 elements, then incorrect for anything after. I've traced through it multiple times but it all seems like it should work fine.</p>\n\n<p><strong>Edit</strong>\nSolution: </p>\n\n<pre><code>makeStr :: [Integer] -&gt; String\nmakeStr [] = \"\"\nmakeStr (x:xs)\n            | x == 0 = \"*\" ++ makeStr (map (subtract 1) xs)\n            | x /= 0 = \" \" ++ makeStr (map (subtract 1) (x:xs))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1554536438, "post_id": 55546863, "comment_id": 97796020, "body": "The second way is pretty much the idiomatic way to do it. The only obvious improvement I see on that is to just have <code>country s</code> at the end of the <code>do</code> block, instead of pointlessly unwrapping the value and then <code>return</code>ing it."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1554537418, "post_id": 55546863, "comment_id": 97796178, "body": "Or you could not bother with the <code>do</code> block, and write it more concisely (although it&#39;s more opaque, at least to some) as <code>let countryMaybe = product &gt;&gt;= supplier &gt;&gt;= country in fromMaybe &quot;unknown&quot; countryMaybe</code>"}, {"owner": {"reputation": 23, "user_id": 11315072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23724d2800e8e85c1ade42ccae22fba9?s=128&d=identicon&r=PG&f=1", "display_name": "SCprog", "link": "https://stackoverflow.com/users/11315072/scprog"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554538845, "post_id": 55546863, "comment_id": 97796446, "body": "@Robin Nice. Succinct, but a bit &#39;opaque&#39; indeed - for newbies. Thank you."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 3, "creation_date": 1554540170, "post_id": 55546863, "comment_id": 97796738, "body": "&quot;I need a function that returns a Maybe product&#39;s country, or &quot;unknown&quot; if there is a Nothing in the chain. &quot;. Why? Why not just return <code>Nothing</code>?"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554556285, "post_id": 55546863, "comment_id": 97800294, "body": "It&#39;s quite advanced, but definitely relevant <a href=\"https://reasonablypolymorphic.com/blog/higher-kinded-data/\" rel=\"nofollow noreferrer\">reasonablypolymorphic.com/blog/higher-kinded-data</a>"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554557717, "post_id": 55546863, "comment_id": 97800636, "body": "Another approach would be to compose <code>^?</code> , <code>_Just</code> lenses"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554561385, "post_id": 55546863, "comment_id": 97801647, "body": "@RobinZigmond, how about making that comment into an answer (well, perhaps simplified using the identity<code>let x = y in f x</code> ===  <code>f y</code>).  &quot;Opaque&quot; or not, it&#39;s hard to imagine a more idiomatic solution."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1554563160, "post_id": 55546863, "comment_id": 97802138, "body": "There&#39;s little reason to avoid <code>&gt;&gt;=</code>. You don&#39;t have to know exactly how it works in order to recognize that <code>product &gt;&gt;= supplier</code> will produce the supplier of an actual product or <code>Nothing</code> if the product doesn&#39;t exist. People use floating-point arithmetic all the time without knowing exactly how <i>it</i> works."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11315072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23724d2800e8e85c1ade42ccae22fba9?s=128&d=identicon&r=PG&f=1", "display_name": "SCprog", "link": "https://stackoverflow.com/users/11315072/scprog"}, "edited": false, "score": 0, "creation_date": 1554725046, "post_id": 55550463, "comment_id": 97844646, "body": "Interesting! But could you please explain what you mean by &quot;you are unnecessarily avoiding Maybe&#39;s monad instance&quot; (newbie question!). Why is it better for function &#39;productCountry&#39; to have the signature &#39;Product -&gt; Maybe String&#39; instead of &#39;Maybe Product -&gt; String&#39;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 23, "user_id": 11315072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23724d2800e8e85c1ade42ccae22fba9?s=128&d=identicon&r=PG&f=1", "display_name": "SCprog", "link": "https://stackoverflow.com/users/11315072/scprog"}, "edited": false, "score": 0, "creation_date": 1554729532, "post_id": 55550463, "comment_id": 97847552, "body": "Kleisli arrows (functions with type <code>a -&gt; m b</code> for some monad <code>m</code>) compose; functions like <code>m a -&gt; b</code> do not. Strive for composability."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1554566573, "last_edit_date": 1554566573, "creation_date": 1554563680, "answer_id": 55550463, "question_id": 55546863, "link": "https://stackoverflow.com/questions/55546863/haskell-how-to-unwrap-nested-maybes-in-data/55550463#55550463", "title": "Haskell: How to unwrap nested maybes in data", "body": "<p>If you are writing a function whose first argument has type <code>Maybe Something</code>, it's usually a good sign that you are unnecessarily avoiding <code>Maybe</code>'s monad instance.</p>\n\n<pre><code>data Supplier = Supplier { \n    nameS :: String,\n    country :: Maybe String\n}\n\ndata Product = Product {\n    nameP :: String,\n    supplier :: Maybe Supplier\n}\n\nproductCountry :: Product -&gt; Maybe String\nproductCountry p = supplier p &gt;&gt;= country\n-- Or, using Kleisli composition (requires Control.Monad)\n-- productCountry = supplier &gt;=&gt; country\n</code></pre>\n\n<p>If you find yourself with an instance of <code>Maybe Product</code>, use the <code>Maybe</code> monad again to feed it to <code>productCountry</code>.</p>\n\n<pre><code>maybeProduct &gt;&gt;= productCountry  -- Just \"somelandia\" or Nothing\n</code></pre>\n\n<p>Also, let whatever <em>calls</em> <code>productCountry</code> worry about if they need a placeholder country name should they get back <code>Nothing</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 1, "last_activity_date": 1554587910, "creation_date": 1554587910, "answer_id": 55553832, "question_id": 55546863, "link": "https://stackoverflow.com/questions/55546863/haskell-how-to-unwrap-nested-maybes-in-data/55553832#55553832", "title": "Haskell: How to unwrap nested maybes in data", "body": "<p>Collecting some of my comments into an answer, as suggested:</p>\n\n<p>Your second code snippet:</p>\n\n<pre><code>productCountry2 :: Maybe Product -&gt; String\nproductCountry2 product =\n    let countryMaybe = do\n        p &lt;- product\n        s &lt;- supplier p\n        c &lt;- country s\n        return c\n    in fromMaybe \"unknown\" countryMaybe\n</code></pre>\n\n<p>is already close to what I would say is idiomatic Haskell. It's certainly many times better than your first snippet, with multiple explicit <code>case</code> statements to account for the fact that any <code>Nothing</code> result encountered along the way should mean immediate failure. The <code>Monad</code> instance for <code>Maybe</code> - which you have used in this second snippet, with the <code>do</code> block - is there precisely to avoid having to repeat such boilerplate code. (In fact it could be argued that this is what all Monads are really for, with the exception of <code>IO</code> which is somewhat \"magical\".)</p>\n\n<p>I have only 2 suggestions for improving it. The first is that this, from the end of your <code>do</code> block:</p>\n\n<pre><code>c &lt;- country s\nreturn c\n</code></pre>\n\n<p>is completely equivalent to simply</p>\n\n<pre><code>country s\n</code></pre>\n\n<p>This is because all <code>do</code> blocks are simply syntactic sugar for uses of the <code>&gt;&gt;=</code> operator - your first snippet is equivalent to <code>country s &gt;&gt;= return</code>. And this, by the so-called <a href=\"https://wiki.haskell.org/Monad_laws\" rel=\"nofollow noreferrer\">Right identity law</a>, is the same as <code>country s</code>, as used in the second snippet.</p>\n\n<p>The second possible simplification - although I would argue this is more a matter of opinion - is to simply leave out the <code>do</code> block altogether and use the \"desugared\" version:</p>\n\n<pre><code>productCountry2 :: Maybe Product -&gt; String\nproductCountry2 product =\n    let countryMaybe = product &gt;&gt;= supplier &gt;&gt;= country\n    in fromMaybe \"unknown\" countryMaybe\n</code></pre>\n\n<p>Finally, as suggested by @K.A.Buhr, you can realise the <code>let</code> expression doesn't really gain you a lot here, and simply write this as:</p>\n\n<pre><code>productCountry2 :: Maybe Product -&gt; String\nproductCountry2 product = fromMaybe \"unknown\" $ product &gt;&gt;= supplier &gt;&gt;= country\n</code></pre>\n\n<p>(Although personally I think the <code>let</code> expression is OK here, it is a bit more long-winded, and isn't strictly needed - but I wouldn't criticise it as it separates the monadic expression from the separate use of <code>fromMaybe</code> to extract the result and supply <code>\"unknown\"</code> if it happens to be <code>Nothing</code>.)</p>\n"}], "owner": {"reputation": 23, "user_id": 11315072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23724d2800e8e85c1ade42ccae22fba9?s=128&d=identicon&r=PG&f=1", "display_name": "SCprog", "link": "https://stackoverflow.com/users/11315072/scprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 55553832, "answer_count": 2, "score": 2, "last_activity_date": 1554587910, "creation_date": 1554535978, "question_id": 55546863, "link": "https://stackoverflow.com/questions/55546863/haskell-how-to-unwrap-nested-maybes-in-data", "title": "Haskell: How to unwrap nested maybes in data", "body": "<p>Newbie here!</p>\n\n<p>Suppose I have the following data:</p>\n\n<pre><code>data Supplier = Supplier { \n    nameS :: String,\n    country :: Maybe String\n}\n\ndata Product = Product {\n    nameP :: String,\n    supplier :: Maybe Supplier\n}\n</code></pre>\n\n<p>I need a function that returns a Maybe product's country, or \"unknown\" if there is a Nothing in the chain.\nI could do it like this:</p>\n\n<pre><code>productCountry :: Maybe Product -&gt; String\nproductCountry product =\n    case product of\n    Just p -&gt; case supplier p of\n              Just s -&gt; case country s of\n                        Just c -&gt; c\n                        Nothing -&gt; \"unknown\"\n              Nothing -&gt; \"unknown\"\n    Nothing -&gt; \"unknown\"\n</code></pre>\n\n<p>But this is awkward. Another way would be:</p>\n\n<pre><code>import Data.Maybe (fromMaybe)\n\nproductCountry2 :: Maybe Product -&gt; String\nproductCountry2 product =\n    let countryMaybe = do\n        p &lt;- product\n        s &lt;- supplier p\n        c &lt;- country s\n        return c\n    in fromMaybe \"unknown\" countryMaybe\n</code></pre>\n\n<p>I feel like there must be a better way to do it, but I couldn't find it.</p>\n\n<p>What would be the best idiomatic Haskell code for 'productCountry'?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 8, "creation_date": 1554529040, "post_id": 55546205, "comment_id": 97794721, "body": "You can&#39;t use integers as data constructor names. Try something like <code>data Rank = A1|A2</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1554561133, "post_id": 55546205, "comment_id": 97801579, "body": "Or maybe <code>R1 | R2</code> where R is for Rank?"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 4, "last_activity_date": 1554564776, "creation_date": 1554564776, "answer_id": 55550632, "question_id": 55546205, "link": "https://stackoverflow.com/questions/55546205/cannot-parse-data-constructor-in-a-data-newtype-declaration/55550632#55550632", "title": "Cannot parse data constructor in a data/newtype declaration", "body": "<p>It might look as if the statement:</p>\n\n<pre><code>data Suit = A | B\n</code></pre>\n\n<p>is only defining one thing, the type <code>Suit</code>, as a collection/set of arbitrary objects.  Actually, though, it's defining three things:  the type <code>Suit</code> and two constructors <code>A</code> and <code>B</code> for creating values of that type.</p>\n\n<p>If the definition:</p>\n\n<pre><code>data Rank = 1 | 2\n</code></pre>\n\n<p>actually worked, it wouldn't be defining <code>Rank</code> as a collection of the numbers <code>1</code> and <code>2</code>, it would be <strong>redefining</strong> the numbers <code>1</code> and <code>2</code> as constructors/values of the new type <code>Rank</code>, and you'd no longer be able to use them as regular numbers.  (For example, the expression <code>n + 1</code> would now be a type error, because <code>(+)</code> expects a number, and <code>1</code> would have been redefined as a <code>Rank</code>).</p>\n\n<p>Fortunately or unfortunately, Haskell won't accept numbers as constructor names -- they need to be valid identifiers starting with uppercase letters (or operators that start with a colon).</p>\n\n<p>So, there are two usual approaches to defining a type like <code>Rank</code> that's meant to represent some subset of numbers.  The first, as noted in the comments, is to define it much like you already have, but change your numbers into valid identifiers by prefixing with an uppercase letter:</p>\n\n<pre><code>data Rank = R1 | R2\n</code></pre>\n\n<p>The advantage of this is that it guarantees that only valid ranks can be represented.  Here, only ranks 1 and 2 are allowed.  If someone tried to write <code>R3</code> somewhere, it wouldn't work, because that constructor hasn't been defined.  The big disadvantage is that this quickly becomes unruly.  If these were playing cards, the definition would be:</p>\n\n<pre><code>data Rank = R1 | R2 | R3 | R4 | R5 | R6 | R7 | R8 | R9 | R10 | R11 | R12 | R13\n</code></pre>\n\n<p>and a function to, say, assign point values to cards for rummy would look like:</p>\n\n<pre><code>points :: Rank -&gt; Int\npoints R1 = 10   -- Ace worth 10\npoints R2 = 2\npoints R3 = 3\n...\npoints R9 = 9\npoints R10 = 10  -- 10 and face cards all worth 10\npoints R11 = 10\npoints R12 = 10\npoints R13 = 10\n</code></pre>\n\n<p>(In real code, you'd use more advanced Haskell features like a derived <code>Enum</code> instance to deal with this.)</p>\n\n<p>The second approach is to define your rank in terms of an existing numeric type:</p>\n\n<pre><code>data Rank = Rank Int   -- actually, `data` would probably be `newtype`\n</code></pre>\n\n<p>This defines two things, a type named <code>Rank</code>, and a constructor, also named <code>Rank</code>.  (This is okay, as types and constructors live in different namespaces.)</p>\n\n<p>In this definition, instead of <code>Rank</code> being defined as a discrete set of values given by explicit constructors with one constructor per value, this definition essential makes the type <code>Rank</code> an <code>Int</code> that's  \"tagged\" with the constructor <code>Rank</code>.</p>\n\n<p>The disadvantage of this approach is that it's now possible to create invalid ranks (since someone can write <code>Rank 14</code>).  The advantage is that it's often easier to work with.  For example, you can extract the integer from the rank, so <code>points</code> can be defined as:</p>\n\n<pre><code>points :: Rank -&gt; Int\npoints (Rank 1)             = 10  -- Ace is worth 10\npoints (Rank r) | r &gt;= 10   = 10  -- 10 and face are worth 10\n                | otherwise = r   -- rest are worth their rank\n</code></pre>\n\n<p>Note that, with this set of definitions:</p>\n\n<pre><code>data Suit = A | B deriving (Show, Eq)\nnewtype Rank = Rank Int deriving (Show, Eq)\ndata Card = Card Suit Rank deriving (Show, Eq)\n</code></pre>\n\n<p>you'd construct <code>Card</code> value using an expression like <code>Card A (Rank 1)</code> for your \"A1\" card.</p>\n\n<p>There's actually a third approach.  Some people might skip defining the <code>Rank</code> type entirely and either write:</p>\n\n<pre><code>data Suit = A | B deriving (Show, Eq)\ndata Card = Card Suit Int deriving (Show, Eq)\n</code></pre>\n\n<p>or write the equivalent code using a type alias:</p>\n\n<pre><code>data Suit = A | B deriving (Show, Eq)\ntype Rank = Int\ndata Card = Card Suit Rank deriving (Show, Eq)\n</code></pre>\n\n<p>Note that the type alias here is really just for documentation.  Here, <code>Rank</code> and <code>Int</code> are exactly the same type and can be used interchangeably.  Using <code>Rank</code> just makes the code easier to understand by making it clear where the programmer intended an <code>Int</code> to stand for a <code>Rank</code> versus an integer used for some other purpose.</p>\n\n<p>The main advantage of this approach is that you can avoid including the word <code>Rank</code> in lots of places (e.g., cards are written <code>Card A 1</code> instead of <code>Card A (Rank 1)</code>, and the definition of points wouldn't need to pattern match the argument on <code>Rank r</code>, etc.)  The main disadvantage is that it blurs the distinction between <code>Rank</code> and other integers and makes it easier to make programming errors like using the <code>Rank</code> where you meant to use the points and vice versa.</p>\n"}], "owner": {"reputation": 149, "user_id": 9684220, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jesse", "link": "https://stackoverflow.com/users/9684220/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 55550632, "answer_count": 1, "score": 1, "last_activity_date": 1554564776, "creation_date": 1554528748, "question_id": 55546205, "link": "https://stackoverflow.com/questions/55546205/cannot-parse-data-constructor-in-a-data-newtype-declaration", "title": "Cannot parse data constructor in a data/newtype declaration", "body": "<p>I have the type Card, consists of suit and rank,</p>\n\n<pre><code>data Suit = A|B deriving (Show, Eq)\ndata Rank = 1|2 deriving (Show, Eq)\ndata Card = Card Suit Rank deriving (Show, Eq)\n</code></pre>\n\n<p>It seems be wrong about the data Rank function, since Int cannot be the type constructor and how to create a right function if my cards are A1|B1|A2|B2</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell", "ghc", "type-families"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1554501390, "post_id": 55543598, "comment_id": 97790796, "body": "It&#39;s probably to do with the difficulties explored here <a href=\"https://repository.brynmawr.edu/cgi/viewcontent.cgi?article=1075&amp;context=compsci_pubs\" rel=\"nofollow noreferrer\">repository.brynmawr.edu/cgi/&hellip;</a>. Type Families are kinda total but kinda not. Haskell accepts <code>F a</code> even though there&#39;s no such instance."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554504983, "post_id": 55543598, "comment_id": 97791686, "body": "I completely agree with you, in that the whole point of injectivity <i>should</i> be the deduction you mention! Instead, GHC uses injectivity (roughly) only to accept some types which would have been rejected as ambiguous otherwise (see the GHC docs). I was surprised when I finally understood that injectivity was not being exploited as I expected."}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 2, "creation_date": 1554514994, "post_id": 55544397, "comment_id": 97793096, "body": "And indeed presuming that type families are total is known to be unsound. (See the Eisenberg+Morris paper.) The code compiles if you supply <code>type instance Fa = a</code>, but not if you provide instances less general than that."}], "tags": [], "owner": {"reputation": 589, "user_id": 754121, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e72d591f55f1ac188fdfe09af0b02299?s=128&d=identicon&r=PG", "display_name": "Ashley Yakeley", "link": "https://stackoverflow.com/users/754121/ashley-yakeley"}, "is_accepted": true, "score": 4, "last_activity_date": 1554505960, "creation_date": 1554505960, "answer_id": 55544397, "question_id": 55543598, "link": "https://stackoverflow.com/questions/55543598/why-is-this-injective-type-family-not-actually-injective/55544397#55544397", "title": "Why is this injective type family not actually injective?", "body": "<p>It turns out this is <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/10833\" rel=\"nofollow noreferrer\">a known issue in GHC</a>. Apparently it's because it hasn't been proven sound.</p>\n"}], "owner": {"reputation": 589, "user_id": 754121, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e72d591f55f1ac188fdfe09af0b02299?s=128&d=identicon&r=PG", "display_name": "Ashley Yakeley", "link": "https://stackoverflow.com/users/754121/ashley-yakeley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 55544397, "answer_count": 1, "score": 6, "last_activity_date": 1554505960, "creation_date": 1554499687, "question_id": 55543598, "link": "https://stackoverflow.com/questions/55543598/why-is-this-injective-type-family-not-actually-injective", "title": "Why is this injective type family not actually injective?", "body": "<p>I tried this:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilyDependencies #-}\nmodule Injective where\n\ntype family F (a :: *) = (fa :: *) | fa -&gt; a\n\nconvert :: F a ~ F b =&gt; a -&gt; b\nconvert x = x\n</code></pre>\n\n<p>GHC 8.6.4 gave me this error</p>\n\n<pre><code>    \u2022 Could not deduce: a ~ b\n      from the context: F a ~ F b\n        bound by the type signature for:\n                   convert :: forall a b. (F a ~ F b) =&gt; a -&gt; b\n        at Injective.hs:6:1-30\n</code></pre>\n\n<p>Why? Surely the whole point of injectivity is that one <em>can</em> deduce <code>a ~ b</code> from <code>F a ~ F b</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 4, "creation_date": 1554499639, "post_id": 55543553, "comment_id": 97790285, "body": "Uhhh, why would you want to deliberately throw an error when this can be handled purely eg. <code>update :: a -&gt; Int -&gt; [a] -&gt; Maybe [a]</code> or <code>... -&gt; ([a],Bool)</code>? Well, I mean, you can always throw something manually according to your needs, but it doesn&#39;t &quot;belong&quot; in the <code>update</code> function."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554500082, "post_id": 55543553, "comment_id": 97790399, "body": "Good suggestion"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554500638, "post_id": 55543553, "comment_id": 97790580, "body": "If the index is out of bounds, why not just return the original list? I don&#39;t think that&#39;s any more ambiguous than if you tried to replace an element which the value that was already there. (This is in the same spirit as <code>take</code> returning the longest list it can if the request size is greater than the length of the argument.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6435535"}, "edited": false, "score": 0, "creation_date": 1554501028, "post_id": 55543553, "comment_id": 97790696, "body": "According to <a href=\"https://hoogle.haskell.org\" rel=\"nofollow noreferrer\">hoogle</a> there is no such a function but <a href=\"https://stackoverflow.com/a/5852820\">this</a> answer is what you need."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554501589, "post_id": 55543553, "comment_id": 97790853, "body": "@chepner I think a Maybe is more principled. You can always go from a Maybe version to a self-returning version by just inspecting the Maybe, but if the only version you have always returns <code>[a]</code> it&#39;s not cheap to tell whether the replacement was successful or not."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1554502035, "post_id": 55543553, "comment_id": 97791002, "body": "@amalloy Not quite; how do I get <code>[1,2,3]</code> back from <code>update 1 4 [1,2,3]</code> if it returns <code>Nothing</code>? Attempting to update a non-existent location just feels more like a no-op than an error to me. The location didn&#39;t exist before you call <code>update</code>; and it won&#39;t exist after."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1554504391, "post_id": 55543553, "comment_id": 97791570, "body": "@amalloy @chepner the lens library fails silently, <code>[1,2,3] &amp; ix 5 .~ 8 = [1,2,3]</code>. The <code>at</code> Lens (which unlike <code>ix</code> deals in <code>Maybe</code>s in order to insert/remove elements rather than just change them) has no instance on lists, which I guess makes sense (eg. if you try the above example, what do you put in the newly-created cells 3,4 as a default value?). Just providing a comparison point in the design space."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554505306, "post_id": 55543553, "comment_id": 97791748, "body": "@chepner Of course, you can&#39;t recover it from just the Nothing, but you can keep around the original list: <code>let xs = [1..5] in fromMaybe xs $ update 9 1 xs</code>"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1554501642, "post_id": 55543835, "comment_id": 97790876, "body": "The first version is quite dangerous, since it will loop infinitely on an infinite list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1554510673, "post_id": 55543835, "comment_id": 97792620, "body": "I think <code>Data.List.splitAt</code> would help a lot here. Something like <code>case splitAt idx xs of (_, []) -&gt; error &quot;..&quot; ; (before, _:after) -&gt; before ++ val : after </code>"}], "tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1554502001, "last_edit_date": 1554502001, "creation_date": 1554501290, "answer_id": 55543835, "question_id": 55543553, "link": "https://stackoverflow.com/questions/55543553/update-list-with-an-element-at-a-given-index/55543835#55543835", "title": "Update list with an element at a given index", "body": "<p>It can be written quite brutally:</p>\n\n<pre><code>update val idx l =\n  if idx &gt;= length l || idx &lt; 0\n  then Nothing\n  else updateUnsafe val idx l\n\nupdateUnsafe _ _ [] = error \"Empty List\"\nupdateUnsafe val idx (h:t) =\n  if idx == 0 then val:t\n  else h:(updateUnsafe val (idx - 1) t)\n</code></pre>\n\n<p>Or tail recursive:</p>\n\n<pre><code>updateUnsafe val idx = reverse . go [] val idx where\n  go acc _ _ [] = acc\n  go acc v i (h:t) = go ((if i == 0 then v else h) : t) v (i - 1) t\n</code></pre>\n\n<p>However, both of them will loop infinitely when we get never ending list which can be fixed in the first case. We may rewrite <code>updateUnsafe</code> not to throw an error, but to let it operate on <code>Maybe</code> type instead:</p>\n\n<pre><code>update _ idx _ | idx &lt; 0 = Nothing\nupdate _ _ [] = Nothing\nupdate val idx (h:t) =\n  if idx == 0 then Just $ val:t\n  else (h:) &lt;$&gt; (updateUnsafe val (idx - 1) t)\n</code></pre>\n\n<hr>\n\n<p>I don't see any function that would solve it in the standard <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">Data.List</a> library</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554544642, "post_id": 55545672, "comment_id": 97797701, "body": "maybe add another clause at the top, to handle the negative index just once?"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1554521908, "creation_date": 1554521908, "answer_id": 55545672, "question_id": 55543553, "link": "https://stackoverflow.com/questions/55543553/update-list-with-an-element-at-a-given-index/55545672#55545672", "title": "Update list with an element at a given index", "body": "<p>I'd do it like this. Of particular note, it doesn't use any partial functions or incomplete pattern matches, even in places where hitting them would \"never\" happen. It also correctly handles the case of a negative index, immediately returning <code>Nothing</code> rather than looping forever.</p>\n\n<pre><code>update :: a -&gt; Int -&gt; [a] -&gt; Maybe [a]\nupdate y = go\n  where\n    go _ [] = Nothing -- whoops, called update with too large an index\n    go i (x:xs) = case i `compare` 0 of\n      LT -&gt; Nothing -- whoops, called update with a negative index\n      EQ -&gt; Just (y:xs)\n      GT -&gt; (x:) &lt;$&gt; update y (pred i) xs\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554521908, "creation_date": 1554499378, "last_edit_date": 1554500068, "question_id": 55543553, "link": "https://stackoverflow.com/questions/55543553/update-list-with-an-element-at-a-given-index", "title": "Update list with an element at a given index", "body": "<p>Is there such function:</p>\n\n<pre><code>update :: a -&gt; Int -&gt; [a] -&gt; Maybe [a]\n</code></pre>\n\n<p>such that it will update the list with the element at given index, or return <code>Nothing</code> if the index is out of boundary?</p>\n\n<p>For example:</p>\n\n<pre><code>&gt; update 9 1 [3,4,5]\nJust [3,9,5]\n\n&gt; update 4 2 [3,4,5]\nJust [3,4,4]\n\n&gt; update 6 5 [3,4,5]\nNothing\n</code></pre>\n"}, {"tags": ["haskell", "stream", "effects", "infinite"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1554493946, "post_id": 55542170, "comment_id": 97788187, "body": "As stated, this requires &quot;lazy IO&quot; -- you can google for that, but please note it comes with a few subtle issues, e.g. IO will be performed at essentially unpredictable points in the program. I&#39;d rather try to rewrite <code>parse</code> to use pipes or conduit, or some other library for &quot;IO streams&quot;."}, {"owner": {"reputation": 327, "user_id": 4288267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e0bea6e3bd4072485f0efdcfc1c262?s=128&d=identicon&r=PG&f=1", "display_name": "abitbol", "link": "https://stackoverflow.com/users/4288267/abitbol"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554496589, "post_id": 55542170, "comment_id": 97789202, "body": "Ok thank you. What is the difference between <code>[IO ByteString]</code> and Haskell <code>Stream</code> for instance ?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554499115, "post_id": 55542170, "comment_id": 97790090, "body": "@abitbol Which <code>Stream</code> are you referring to? <code>pipes</code> and <code>conduit</code> are two different libraries which provide their own implementation of the concept of an infinite stream."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554499155, "post_id": 55542170, "comment_id": 97790102, "body": "Actually, I only have a vague intuition about pipes and conduit streams, and I&#39;m afraid that I might mislead you. I think you should be able to convert an <code>[IO a]</code> into a conduit <code>StreamSource IO a</code> or something like that."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1554502816, "post_id": 55542170, "comment_id": 97791221, "body": "Aren&#39;t you looking for <code>sequence</code> function?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 1, "creation_date": 1554506859, "post_id": 55542170, "comment_id": 97792027, "body": "@radrow They aren&#39;t, because <code>sequence</code> with <code>IO</code> and infinite lists doesn&#39;t terminate."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554510396, "post_id": 55544145, "comment_id": 97792589, "body": "Note that if we have a function like <code>parse1</code>, then the problem is much simpler. <code>fmap (fmap parse1) inputs :: [IO Object]</code> is already a huge step forwards. Rather, I would have expected that a main issue here is that we do not know how many bytestrings the parser has to consume to produce an object, and that the last bytetring might also be only partially consumed. Of course, a proper conduit parser should ignore such issues in a nice way, since it essentially awaits enough bytes before producing one object."}, {"owner": {"reputation": 327, "user_id": 4288267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e0bea6e3bd4072485f0efdcfc1c262?s=128&d=identicon&r=PG&f=1", "display_name": "abitbol", "link": "https://stackoverflow.com/users/4288267/abitbol"}, "edited": false, "score": 0, "creation_date": 1554528653, "post_id": 55544145, "comment_id": 97794674, "body": "Thank you for your very detailed response! It helps me to understand what is idiomatic in Haskell for such kind of IO treatement."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 8, "last_activity_date": 1554504116, "last_edit_date": 1554504116, "creation_date": 1554503529, "answer_id": 55544145, "question_id": 55542170, "link": "https://stackoverflow.com/questions/55542170/infinite-stream-of-effectful-actions/55544145#55544145", "title": "Infinite stream of effectful actions", "body": "<h3>The Problem</h3>\n\n<p>Generally speaking, in order for IO actions to be properly ordered and behave predictably, each action needs to complete fully before the next action is run.  In a do-block, this means that this works:</p>\n\n<pre><code>main = do\n    sequence (map putStrLn [\"This\",\"action\",\"will\",\"complete\"])\n    putStrLn \"before we get here\"\n</code></pre>\n\n<p>but unfortunately this won't work, if that final IO action was important:</p>\n\n<pre><code>dontRunMe = do\n    putStrLn \"This is a problem when an action is\"\n    sequence (repeat (putStrLn \"infinite\"))\n    putStrLn \"&lt;not printed&gt;\"\n</code></pre>\n\n<p>So, even though <code>sequence</code> can be specialized to the right type signature:</p>\n\n<pre><code>sequence :: [IO a] -&gt; IO [a]\n</code></pre>\n\n<p>it doesn't work as expected on an infinite list of IO actions.  You'll have no problem <em>defining</em> such a sequence:</p>\n\n<pre><code>badSeq :: IO [Char]\nbadSeq = sequence (repeat (return '+'))\n</code></pre>\n\n<p>but any attempt to execute the IO action (e.g., by trying to print the head of the resulting list) will hang:</p>\n\n<pre><code>main = (head &lt;$&gt; badSeq) &gt;&gt;= print\n</code></pre>\n\n<p>It doesn't matter if you only need a <em>part</em> of the result.  You won't get anything out of the IO monad until the entire <code>sequence</code> is done (so \"never\" if the list is infinite).</p>\n\n<h3>The \"Lazy IO\" Solution</h3>\n\n<p>If you want to get data from a partially completed IO action, you need to be explicit about it and make use of a scary-sounding Haskell escape hatch, <code>unsafeInterleaveIO</code>.  This function takes an IO action and \"defers\" it so that it won't actually execute until the value is demanded.</p>\n\n<p>The reason this is unsafe in general is that an IO action that makes sense now, might mean something different if actually executed at a later time point.  As a simple example, an IO action that truncates/removes a file has a very different effect if it's executed <em>before</em> versus <em>after</em> updated file contents are written!</p>\n\n<p>Anyway, what you'd want to do here is write a lazy version of <code>sequence</code>:</p>\n\n<pre><code>import System.IO.Unsafe (unsafeInterleaveIO)\n\nlazySequence :: [IO a] -&gt; IO [a]\nlazySequence [] = return []  -- oops, not infinite after all\nlazySequence (m:ms) = do\n  x &lt;- m\n  xs &lt;- unsafeInterleaveIO (lazySequence ms)\n  return (x:xs)\n</code></pre>\n\n<p>The key point here is that, when a <code>lazySequence infstream</code> action is executed, it will actually execute <em>only</em> the first action; the remaining actions will be wrapped up in a deferred IO action that won't truly execute until the second and subsequent elements of the returned list are demanded.</p>\n\n<p>This works for fake IO actions:</p>\n\n<pre><code>&gt; take 5 &lt;$&gt; lazySequence (repeat (return ('+'))\n\"+++++\"\n&gt;\n</code></pre>\n\n<p>(where if you replaced <code>lazySequence</code> with <code>sequence</code>, it would hang).  It also works for real IO actions:</p>\n\n<pre><code>&gt; lns &lt;- lazySequence (repeat getLine)\n&lt;waits for first line of input, then returns to prompt&gt;\n&gt; print (head lns)\n&lt;prints whatever you entered&gt;\n&gt; length (head (tail lns))  -- force next element\n&lt;waits for second line of input&gt;\n&lt;then shows length of your second line before prompt&gt;\n&gt;\n</code></pre>\n\n<p>Anyway, with this definition of <code>lazySequence</code> and types:</p>\n\n<pre><code>parse :: [ByteString] -&gt; [Object]\ninput :: [IO ByteString]\n</code></pre>\n\n<p>you should have no trouble writing:</p>\n\n<pre><code>outputs :: IO [Object]\noutputs = parse &lt;$&gt; lazySequence inputs\n</code></pre>\n\n<p>and then using it lazily however you want:</p>\n\n<pre><code>main = do\n    objs &lt;- outputs\n    mapM_ doSomethingWithObj objs\n</code></pre>\n\n<h3>Using Conduit</h3>\n\n<p>Even though the above lazy IO mechanism is pretty simple and straightforward, lazy IO has fallen out of favor for production code due to issues with resource management, fragility with respect to space leaks (where a small change to your code blows up the memory footprint), and problems with exception handling.</p>\n\n<p>One solution is the <code>conduit</code> library.  Another is <code>pipes</code>.  Both are carefully designed streaming libraries that can support infinite streams.</p>\n\n<p>For <code>conduit</code>, if you had a parse function that created one object per byte string, like:</p>\n\n<pre><code>parse1 :: ByteString -&gt; Object\nparse1 = ...\n</code></pre>\n\n<p>then given:</p>\n\n<pre><code>inputs :: [IO ByteString]\ninputs = ...\n\nuseObject :: Object -&gt; IO ()\nuseObject = ...\n</code></pre>\n\n<p>the conduit would look something like:</p>\n\n<pre><code>import Conduit\n\nmain :: IO ()\nmain = runConduit $  mapM_ yieldM inputs\n                  .| mapC parse1\n                  .| mapM_C useObject\n</code></pre>\n\n<p>Given that your parse function has signature:</p>\n\n<pre><code>parse :: [ByteString] -&gt; [Object]\n</code></pre>\n\n<p>I'm pretty sure you can't integrate this with conduit directly (or at least not in any way that wouldn't toss out all the benefits of using conduit).  You'd need to rewrite it to be conduit friendly in how it consumed byte strings and produced objects.</p>\n"}], "owner": {"reputation": 327, "user_id": 4288267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e0bea6e3bd4072485f0efdcfc1c262?s=128&d=identicon&r=PG&f=1", "display_name": "abitbol", "link": "https://stackoverflow.com/users/4288267/abitbol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 55544145, "answer_count": 1, "score": 4, "last_activity_date": 1554504116, "creation_date": 1554492424, "last_edit_date": 1554495452, "question_id": 55542170, "link": "https://stackoverflow.com/questions/55542170/infinite-stream-of-effectful-actions", "title": "Infinite stream of effectful actions", "body": "<p>I would like to parse an infinite stream of bytes into an infinite stream of Haskell data. Each byte is read from the network, thus they are wrapped into IO monad.</p>\n\n<p>More concretely I have an infinite stream of type <code>[IO(ByteString)]</code>. On the other hand I have a pure parsing function <code>parse :: [ByteString] -&gt; [Object]</code> (where <code>Object</code> is a Haskell data type)</p>\n\n<p>Is there a way to plug my infinite stream of monad into my parsing function ? </p>\n\n<p>For instance, is it possible to write a function of type <code>[IO(ByteString)] -&gt; IO [ByteString]</code> in order for me to use my function <code>parse</code> in a monad?</p>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"tags": [], "owner": {"reputation": 962, "user_id": 490815, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/366f7b0d571e7811680c53984c34c966?s=128&d=identicon&r=PG", "display_name": "sinoTrinity", "link": "https://stackoverflow.com/users/490815/sinotrinity"}, "is_accepted": false, "score": 4, "last_activity_date": 1554498799, "creation_date": 1554498799, "answer_id": 55543447, "question_id": 55541589, "link": "https://stackoverflow.com/questions/55541589/is-jake-wheats-intro-to-parsing-with-parsec-in-haskell-outdated/55543447#55543447", "title": "Is Jake Wheat&#39;s &quot;Intro to Parsing with Parsec in Haskell&quot; outdated?", "body": "<p>There is a typo in the tutorial. <code>term5</code> should be</p>\n\n<pre><code>term5 = term simpleExpr5\n</code></pre>\n"}], "owner": {"reputation": 962, "user_id": 490815, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/366f7b0d571e7811680c53984c34c966?s=128&d=identicon&r=PG", "display_name": "sinoTrinity", "link": "https://stackoverflow.com/users/490815/sinotrinity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1554498799, "creation_date": 1554489722, "question_id": 55541589, "link": "https://stackoverflow.com/questions/55541589/is-jake-wheats-intro-to-parsing-with-parsec-in-haskell-outdated", "title": "Is Jake Wheat&#39;s &quot;Intro to Parsing with Parsec in Haskell&quot; outdated?", "body": "<p>I am following <a href=\"http://jakewheat.github.io/intro_to_parsing/\" rel=\"nofollow noreferrer\">an incredibly detailed Parsec tutorial</a>. However, some examples do not work as expected, e.g.,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>ghci&gt; parseWithWhitespace simpleExpr5 \"(1+2)\"\nLeft (line 1, column 3):\nunexpected \"+\"\nexpecting digit or \")\"\n</code></pre>\n\n<p>Is it because the tutorial is <a href=\"https://github.com/JakeWheat/intro_to_parsing/issues/11\" rel=\"nofollow noreferrer\">outdated</a>? Has anyone tried it recently?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1554477757, "post_id": 55538665, "comment_id": 97780676, "body": "<code>agp</code> is a recursive function that always makes a recursive call - it has no &quot;base case&quot; where it stops, so it will never stop evaluating. (Note that the &quot;stack overflow&quot; in Haskell isn&#39;t due to it filling up with function calls, as it would be in other languages - it&#39;s due to &quot;thunks&quot;, that is unevaluated expressions. But the root cause is the same here, you&#39;ve got infinite recursion.)"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1554478180, "post_id": 55538665, "comment_id": 97780926, "body": "<code>agp x = forever (consume stack space)</code>  Yeah, that&#39;s bad."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554478432, "post_id": 55538665, "comment_id": 97781089, "body": "Note that the code you actually show doesn&#39;t cause the problem, because nothing forces the value of <code>agp1</code>. Trying to <i>print</i> its value would force it, leading to infinite recursion. (I&#39;m assuming you&#39;ve left out some code, given the gap between A1 and A6 and the fact that there are several undefined functions, e.g. <code>agl</code>.)"}, {"owner": {"reputation": 51, "user_id": 9260033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeca554bf2e6f3bcf68b1e1814f9ced2?s=128&d=identicon&r=PG&f=1", "display_name": "April Williams", "link": "https://stackoverflow.com/users/9260033/april-williams"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554478883, "post_id": 55538665, "comment_id": 97781356, "body": "Yes @chepner I meant, when try printing agp1 I get the exception."}, {"owner": {"reputation": 51, "user_id": 9260033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeca554bf2e6f3bcf68b1e1814f9ced2?s=128&d=identicon&r=PG&f=1", "display_name": "April Williams", "link": "https://stackoverflow.com/users/9260033/april-williams"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1554479069, "post_id": 55538665, "comment_id": 97781446, "body": "@RobinZigmond If I make a base case of : agp 0.0 = 0.0 I still get the infinite recursion. Am I going about the base case wrong?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1554480907, "post_id": 55538665, "comment_id": 97782473, "body": "@AprilWilliams Have you checked what the value of <code>x</code> is? And is this equation supposed to be recursive?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1554481121, "post_id": 55538665, "comment_id": 97782561, "body": "@AprilWilliams The base case might not be reached if, say, one starts with <code>agp 100.5</code> since we move from <code>0.5</code> to <code>-0.5</code>. Also, rounding errors might cause an issue since <code>0.000000001</code> is not considered <code>0.0</code>, so the base case is not met. You could try to define <code>agp x | x &lt;= 0.001 = 0</code> so that values that are close enough to 0 and negative values act as a base case. Or you could use an <code>Int</code> as an argument (and then convert it to float inside the function, if needed)."}], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "is_accepted": false, "score": 0, "last_activity_date": 1554488389, "creation_date": 1554488389, "answer_id": 55541293, "question_id": 55538665, "link": "https://stackoverflow.com/questions/55538665/i-cannot-pinpoint-why-i-am-getting-exception-stack-overflow/55541293#55541293", "title": "I cannot pinpoint why I am getting ***Exception: Stack overflow", "body": "<p>You need some base case where <code>agp</code> doesn't call itself so the computation ends.\nMy gues is your function need to be like this:</p>\n\n<pre><code>--A6 AGP(t)\nagp :: Float -&gt; Float\nagp x\n    | agp' &gt; 0 = agp'\n    | otherwise = 0\n    where agp' = (agp (x-1) - ((at - agp (x-1)) / at)) * (atl (x-1) - at)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9260033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeca554bf2e6f3bcf68b1e1814f9ced2?s=128&d=identicon&r=PG&f=1", "display_name": "April Williams", "link": "https://stackoverflow.com/users/9260033/april-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1554490856, "creation_date": 1554477569, "last_edit_date": 1554490856, "question_id": 55538665, "link": "https://stackoverflow.com/questions/55538665/i-cannot-pinpoint-why-i-am-getting-exception-stack-overflow", "title": "I cannot pinpoint why I am getting ***Exception: Stack overflow", "body": "<p>I am writing functions that call other functions. Everything was working fine until I got to comment --A6 AGP(t). When I try running agp1 it throws ***Exception: stack overflow. </p>\n\n<p>I have tried adding and removing parenthesis so that no function is being called over and over, but still no luck. </p>\n\n<pre><code>import Data.List\nimport System.IO\n\np = 1.50\ndt= 0.050\nat = 0.075\nwMax = 20.00\nda1 = 300.0\ndcasa = 0.05\ndSort = 1.50\ndKafv = 0.50\naa1 = 250.0\nacasa = 0.05\naKafv = 0.25\naSort = 1.00\nv = 1200.0\nl = 47490.0\n\n\n--A1 AGL(t)\nagl :: Float -&gt; Float\nagl a = a + 5\n\n--A6 AGP(t)\nagp :: Float -&gt; Float\nagp x = (agp (x-1) - ((at - agp (x-1)) / at)) * (atl (x-1) - at)\n\nagp1 =  agp 2.0\n\n--A7 ATL(t)\natl :: Float -&gt; Float\natl x = (agl x - agl (x+1)) / agl (x)\n\n--A10 DCAS(t)\ndcas :: Float -&gt; Float\ndcas x = (l/v)*da1*((1.0-dcasa)**(dSort*(x - 1)))*dKafv*(((1 - ((1- \n         dcasa)**(dSort+1))) / dcasa) - 1)\n\n\n--A11 ACAS(t)\nacas :: Float -&gt; Float\nacas x = (l/v)*aa1*((1.0-acasa)**(aSort*(x - 1)))*aKafv*(((1 - ((1- \n          acasa)**(aSort+1))) / acasa) - 1)\n\n--A12 Da(t)\nda :: Float -&gt; Float\nda x = da1 * ((1.0 - dcasa) ** (dSort * (x - 1)))\n\n\n--A13 Aa(t)\naa :: Float -&gt; Float\naa x = aa1 * ((1.0 - acasa) ** (x - 1))\n</code></pre>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1554468535, "post_id": 55535575, "comment_id": 97774801, "body": "In the future, please <i>post the error</i>. The compiler provides useful information, and you are making us guess about what that could be, or copy your code in our GHC."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1554468585, "last_edit_date": 1554468585, "creation_date": 1554468391, "answer_id": 55535755, "question_id": 55535575, "link": "https://stackoverflow.com/questions/55535575/use-in-list-comprehension/55535755#55535755", "title": "Use : in list-comprehension", "body": "<p><code>:</code> prepends an element and a list. Your <code>as</code> and <code>bs</code> are instead both lists.</p>\n\n<p>You probably need concatenation, as in <code>as ++ bs</code>.</p>\n\n<p>It seems that you will find other issues, but this should be the first thing to fix.</p>\n"}], "owner": {"reputation": 69, "user_id": 6209441, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/36a02632e6afdaafe57afd9be71017e0?s=128&d=identicon&r=PG&f=1", "display_name": "hhwwww", "link": "https://stackoverflow.com/users/6209441/hhwwww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55535755, "answer_count": 1, "score": -2, "last_activity_date": 1554468585, "creation_date": 1554467861, "question_id": 55535575, "link": "https://stackoverflow.com/questions/55535575/use-in-list-comprehension", "title": "Use : in list-comprehension", "body": "<p>Im am trying to write a function, which takes a list and returns a list of all sublists. </p>\n\n<p>Unfortunately my solution doesn't compile and I don't understand why.</p>\n\n<p>My idea is to use take and drop in a list-comprehension and to generate in every iteration from 0 to the length of the list two sublists. </p>\n\n<pre><code>sublists:: [a] -&gt; [[a]]\nsublists xs = [ as:bs | i &lt;-[0..length xs], as &lt;- (take i xs), bs &lt;- drop (length xs - i) xs]\n</code></pre>\n"}, {"tags": ["javascript", "haskell", "recursion", "functional-programming", "mutual-recursion"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1554467538, "creation_date": 1554467538, "answer_id": 55535474, "question_id": 55535229, "link": "https://stackoverflow.com/questions/55535229/how-to-translate-the-poly-variadic-fix-point-combinator-to-a-strict-language/55535474#55535474", "title": "How to translate the poly-variadic fix-point combinator to a strict language?", "body": "<p><code>($ self)</code> is just <code>\\f -&gt; f $ self</code>; it's a function that applies its argument to <code>self</code>. You could rewrite the Haskell version using a list comprehension:</p>\n\n<pre><code>fix_poly fl = fix (\\self -&gt; [f self | f &lt;- fl])\n    where fix f = f (fix f)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1554471536, "post_id": 55536531, "comment_id": 97776848, "body": "This kind of mistakes happen a lot to me, because I tend to focus on patterns (like passing a <code>Defer</code> to <code>f</code>) rather than actually visualizing the algorithm. This works frequently with the declarative code of FP, but not always."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1554511845, "post_id": 55536531, "comment_id": 97792774, "body": "@bob, very circular code like this is hard to visualize. Types help a lot. You can use them in your mind."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 2, "last_activity_date": 1554471541, "last_edit_date": 1554471541, "creation_date": 1554470945, "answer_id": 55536531, "question_id": 55535229, "link": "https://stackoverflow.com/questions/55535229/how-to-translate-the-poly-variadic-fix-point-combinator-to-a-strict-language/55536531#55536531", "title": "How to translate the poly-variadic fix-point combinator to a strict language?", "body": "<p>The definition of <code>defFixPoly</code> has an extra layer of <code>Defer</code> than it should. Since <code>self</code> is already a <code>Defer</code> value, you can just pass it directly to <code>f</code> rather than wrapping it again.</p>\n\n<pre><code>const defFixPoly = (...fs) =&gt;\n  defFix(self =&gt; fs.map(f =&gt; f(self)));\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const structure = type =&gt; cons =&gt; {\r\n  const f = (f, args) =&gt; ({\r\n    [\"run\" + type]: f,\r\n    [Symbol.toStringTag]: type,\r\n    [Symbol(\"args\")]: args\r\n  });\r\n\r\n  return cons(f);\r\n};\r\n\r\nconst Defer = structure(\"Defer\") (Defer =&gt; thunk =&gt; Defer(thunk));\r\n\r\nconst defFix = f =&gt; f(Defer(() =&gt; defFix(f)));\r\n\r\nconst defFixPoly = (...fs) =&gt;\r\n  defFix(self =&gt; fs.map(f =&gt; f(self)));\r\n\r\nconst pair = defFixPoly(\r\n  f =&gt; n =&gt; n === 0\r\n    ? true\r\n    : f.runDefer() [1] (n - 1),\r\n  f =&gt; n =&gt; n === 0\r\n    ? false\r\n    : f.runDefer() [0] (n - 1));\r\n\r\nconsole.log(pair[0] (2)); // true expected</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This now defines mutually recursive <code>isEven</code> and <code>isOdd</code> functions.</p>\n\n<pre><code>const isEven = pair[0];\nconst isOdd = pair[1];\n</code></pre>\n"}], "owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 55536531, "answer_count": 2, "score": 4, "last_activity_date": 1554471541, "creation_date": 1554466682, "last_edit_date": 1554471258, "question_id": 55535229, "link": "https://stackoverflow.com/questions/55535229/how-to-translate-the-poly-variadic-fix-point-combinator-to-a-strict-language", "title": "How to translate the poly-variadic fix-point combinator to a strict language?", "body": "<p>I am attempting to translate the following Haskell code to Javascript:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fix_poly :: [[a] -&gt; a] -&gt; [a]\nfix_poly fl = fix (\\self -&gt; map ($ self) fl)\n  where fix f = f (fix f)\n</code></pre>\n\n<p>I have trouble understanding <code>($ self)</code> though. Here is what I've achieved so far:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const structure = type =&gt; cons =&gt; {\n  const f = (f, args) =&gt; ({\n    [\"run\" + type]: f,\n    [Symbol.toStringTag]: type,\n    [Symbol(\"args\")]: args\n  });\n\n  return cons(f);\n};\n\nconst Defer = structure(\"Defer\") (Defer =&gt; thunk =&gt; Defer(thunk));\n\nconst defFix = f =&gt; f(Defer(() =&gt; defFix(f)));\n\nconst defFixPoly = (...fs) =&gt;\n  defFix(self =&gt; fs.map(f =&gt; f(Defer(() =&gt; self))));\n\nconst pair = defFixPoly(\n  f =&gt; n =&gt; n === 0\n    ? true\n    : f.runDefer() [1] (n - 1),\n  f =&gt; n =&gt; n === 0\n    ? false\n    : f.runDefer() [0] (n - 1));\n\npair[0] (2); // true expected but error is thrown\n</code></pre>\n\n<p>The error is <code>Uncaught TypeError: f.runDefer(...)[1] is not a function</code>.</p>\n\n<p>Here is the <a href=\"https://stackoverflow.com/a/18413448/5536315\">source</a>.</p>\n"}, {"tags": ["haskell", "applicative", "monoids", "traversable", "foldable"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1554461153, "post_id": 55533260, "comment_id": 97770400, "body": "I can&#39;t write a proper answer right now (will do it later if no one else covers it first). In the meantime, I wonder if you&#39;ll find the explanation in <a href=\"https://en.wikibooks.org/wiki/Haskell/Traversable#Functors_made_for_walking\" rel=\"nofollow noreferrer\">the beginning of the Wikibook chapter</a> (upon which this article was based on) any clearer."}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1554503461, "post_id": 55535649, "comment_id": 97791396, "body": "I think you have an extra slash in your first <code>foldr</code> signature."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 9, "last_activity_date": 1554503860, "last_edit_date": 1554503860, "creation_date": 1554468078, "answer_id": 55535649, "question_id": 55533260, "link": "https://stackoverflow.com/questions/55533260/what-does-traversable-is-to-applicative-contexts-mean/55535649#55535649", "title": "What does Traversable is to Applicative contexts mean?", "body": "<p>In the beginning, there was <code>foldr</code>:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>and there was <code>mapM</code>:</p>\n\n<pre><code>mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\n</code></pre>\n\n<p><code>foldr</code> was generalized to data types other than <code>[a]</code> by letting each type define its own definition of <code>foldr</code> to describe how to reduce it to a single value.</p>\n\n<pre><code>-- old foldr ::        (a -&gt; b -&gt; b) -&gt; b -&gt; [] a -&gt; b\nfoldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t  a -&gt; b\n</code></pre>\n\n<p>If you have a monoid, you don't have to specify a binary function, because the <code>Monoid</code> instance already provides its own starting value and knows how to combine two values, which is apparent from its default definition in terms of <code>foldr</code>:</p>\n\n<pre><code>-- If m is a monoid, it provides its own function of type b -&gt; b.\nfoldMap :: (Foldable t, Monoid m) =&gt; (a -&gt; m) -&gt; t a -&gt; m\nfoldMap f = foldr (mappend . f) mempty\n</code></pre>\n\n<p><code>Traverse</code> does the same kind of generalization from lists to traversable types, but for <code>mapM</code>:</p>\n\n<pre><code>-- old mapM ::              Monad m        =&gt; (a -&gt; m b) -&gt; [] a -&gt; m ([] b)\ntraverse :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t  a -&gt; f (t  b)\n</code></pre>\n\n<p>(When <code>mapM</code> was first defined, there was no <code>Applicative</code> class; if there had been, <code>mapA :: Applicative f =&gt; (a -&gt; f b) -&gt; [a] -&gt; f [b]</code> could have been defined instead; the <code>Monad</code> constraint was stronger than was necessary.)</p>\n\n<p>An <code>Applicative</code> is monoidal in nature, so there was no need in <code>Traverse</code> for the type of distinction that <code>foldr</code>/<code>foldMap</code> draws.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1554508885, "creation_date": 1554508885, "answer_id": 55544676, "question_id": 55533260, "link": "https://stackoverflow.com/questions/55533260/what-does-traversable-is-to-applicative-contexts-mean/55544676#55544676", "title": "What does Traversable is to Applicative contexts mean?", "body": "<p>The article (and <a href=\"https://en.wikibooks.org/wiki/Haskell/Traversable#Functors_made_for_walking\" rel=\"nofollow noreferrer\">the corresponding passage of the Wikibook</a>) is talking about how the effects (or, to use the language seen there, the contexts) of applicative values can be combined monoidally. The connection with <code>Foldable</code> is that list-like folding is ultimately amounts to combining values monoidally (see <a href=\"https://stackoverflow.com/a/55535649/2751851\">chepner's answer</a>, and also <a href=\"https://stackoverflow.com/a/23319967/2751851\"><em>Foldr/Foldl for free when Tree is implementing Foldable foldmap?</em></a>. As for the applicative contexts part, there are a few ways to look at that. One of them is noting that, for any <code>Applicative f</code> and <code>Monoid m</code>, <code>f m</code> is a monoid, with <code>pure mempty</code> as <code>mempty</code> and <code>liftA2 mappend</code> as <code>mappend</code> (<a href=\"http://hackage.haskell.org/package/reducers-3.12.3/docs/Data-Semigroup-Applicative.html#t:Ap\" rel=\"nofollow noreferrer\">this <code>Ap</code> type from the <em>reducers</em> package</a> witnesses that). For a concrete example, let's pick <code>f ~ Maybe</code> and <code>m ~ ()</code>. That leaves us with four possible combinations:</p>\n\n<pre><code>liftA2 mappend (Just ()) (Just ()) = Just ()\nliftA2 mappend (Just ()) Nothing   = Nothing\nliftA2 mappend Nothing   (Just ()) = Nothing\nliftA2 mappend Nothing   Nothing   = Nothing\n</code></pre>\n\n<p>Now contrast with <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#t:All\" rel=\"nofollow noreferrer\"><code>All</code></a>, the <code>Bool</code> monoid with <code>(&amp;&amp;)</code> as <code>mappend</code>:</p>\n\n<pre><code>mappend (All True)  (All True)  = All True\nmappend (All True)  (All False) = All False\nmappend (All False) (All True)  = All False\nmappend (All False) (All False) = All False\n</code></pre>\n\n<p>They match perfectly: <code>Just ()</code> stands for <code>True</code>, <code>Nothing</code> for <code>False</code>, and <code>liftA2 mappend</code> for <code>(&amp;&amp;)</code>.</p>\n\n<p>Now let's have another look at the Wikibook example:</p>\n\n<pre><code>deleteIfNegative :: (Num a, Ord a) =&gt; a -&gt; Maybe a\ndeleteIfNegative x = if x &lt; 0 then Nothing else Just x\n\nrejectWithNegatives :: (Num a, Ord a, Traversable t) =&gt; t a -&gt; Maybe (t a)\nrejectWithNegatives = traverse deleteIfNegative\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; rejectWithNegatives [2,4,8]\nJust [2,4,8]\nGHCi&gt; rejectWithNegatives [2,-4,8]\nNothing\n</code></pre>\n\n<p>The <code>Maybe</code> values generated by applying <code>deleteIfNegative</code> to the values in the lists are combined monoidally in the way shown above, so that we get a <code>Nothing</code> unless <em>all</em> the <code>Maybe</code> values are <code>Just</code>.</p>\n\n<p>This matter can also be approached in the opposite direction. Through the <code>Applicative</code> instance for <code>Const</code>...</p>\n\n<pre><code>-- I have suppressed a few implementation details from the instance used by GHC.\ninstance Monoid m =&gt; Applicative (Const m) where\n    pure _ = Const mempty\n    Const x &lt;*&gt; Const y = Const (x `mappend` y)\n</code></pre>\n\n<p>... we can get an <code>Applicative</code> out of any <code>Monoid</code>, such that <code>(&lt;*&gt;)</code> combines the monoidal values monoidally. That makes it possible to <a href=\"https://en.wikibooks.org/wiki/Haskell/Traversable#Recovering_fmap_and_foldMap\" rel=\"nofollow noreferrer\">define <code>foldMap</code> and friends in terms of <code>traverse</code></a>.</p>\n\n<p>On a final note, the category theoretical description of <code>Applicative</code> as a class for monoidal functors involves something rather different from what I have covered here. For further discussion of this issue, and of other fine print, see <a href=\"https://stackoverflow.com/q/50702929/2751851\"><em>Monoidal Functor is Applicative but where is the Monoid typeclass in the definition of Applicative?</em></a> (if you want to dig deeper, it is well worth it to read all of the answers there).</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 55535649, "answer_count": 2, "score": 8, "last_activity_date": 1554508929, "creation_date": 1554459557, "last_edit_date": 1554508929, "question_id": 55533260, "link": "https://stackoverflow.com/questions/55533260/what-does-traversable-is-to-applicative-contexts-mean", "title": "What does Traversable is to Applicative contexts mean?", "body": "<p>I am trying to understand Traversable with the help of <a href=\"https://namc.in/2018-02-05-foldables-traversals\" rel=\"noreferrer\">https://namc.in/2018-02-05-foldables-traversals</a>.  </p>\n\n<p>Somewhere the author mentioned the following sentence:</p>\n\n<blockquote>\n  <p>Traversable is to Applicative contexts what Foldable is to Monoid\n  values. </p>\n</blockquote>\n\n<p>What did he try to clarify?  </p>\n\n<p>I do not get the connection between <code>Foldable to Monoid</code>.</p>\n\n<p>Please provide an example.</p>\n"}, {"tags": ["haskell", "type-inference"], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 2, "last_activity_date": 1554449089, "creation_date": 1554449089, "answer_id": 55530235, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of/55530235#55530235", "title": "How does Haskell infer the type of (+).(+)", "body": "<p>You're nearly there.</p>\n\n<pre><code>(Num i =&gt;)\nb = i\nc = i -&gt; i\n(Num j =&gt;)\na = j -- this is different, you associated b,c correctly but a wrongly\nb = j -&gt; j\n=&gt; i = j -&gt; j -- ( by i = b = j -&gt; j )\n=&gt; c = (j -&gt; j) -&gt; (j -&gt; j) -- ( by c = i -&gt; i, i = j -&gt; j )\n=&gt; (+) . (+) :: a -&gt; c = j -&gt; ((j -&gt; j) -&gt; (j -&gt; j)) \n    = j -&gt; (j -&gt; j) -&gt; j -&gt; j -- ( simplifying brackets )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384, "user_id": 4098149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4eff262713ed007414ceb4e35f6b63f5?s=128&d=identicon&r=PG&f=1", "display_name": "Schoon", "link": "https://stackoverflow.com/users/4098149/schoon"}, "is_accepted": false, "score": 2, "last_activity_date": 1554450842, "last_edit_date": 1554450842, "creation_date": 1554450029, "answer_id": 55530476, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of/55530476#55530476", "title": "How does Haskell infer the type of (+).(+)", "body": "<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n\nIf you apply two functions to it you get in pseudocode:\n(+) . (+) -&gt; a -&gt; c\n\nSo what is the type of a? It has the same type as the first argument \nof the second function you pass into (.). You can rewrite the type \nof (+) with brackets and get\n(+) :: a -&gt; (a -&gt; a)\n\nFrom that we know that\n\na :: a\nb :: (a -&gt; a)\n\nNow that we know what a and b are, let's look at the first argument of (.).\n\nIt's (+) applied by an argument b :: (a -&gt; a). So we get\n(a -&gt; a) -&gt; ((a -&gt; a) -&gt; (a -&gt; a))\n\nso we found the type of c:\nc :: (a -&gt; a) -&gt; (a -&gt; a) \nand since we can remove the second pair of brackets\nc :: (a -&gt; a) -&gt; a -&gt; a\n\nif we plug our findings into \n\n(+) . (+) -&gt; a -&gt; c\n\nwe get \n\n(+) . (+) :: a -&gt; (a -&gt; a) -&gt; a -&gt; a\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 6, "last_activity_date": 1554457468, "last_edit_date": 1554457468, "creation_date": 1554451184, "answer_id": 55530800, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of/55530800#55530800", "title": "How does Haskell infer the type of (+).(+)", "body": "<p>A different approach:</p>\n\n<pre><code>((+).(+)) x y z\n= (+) ((+) x) y z\n= ((x +) + y) z\n</code></pre>\n\n<p>Now notice:</p>\n\n<pre><code>(x +) + y\n</code></pre>\n\n<p>is the sum of two <em>functions</em>, since one of the arguments is a function.  Let's assume <code>x :: a</code> since we have to start somewhere (this assumption does not necessarily mean <code>a</code> is going to appear in the final type, we just want to give it a name to start our reasoning process)</p>\n\n<pre><code>x :: a\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>(x +) :: a -&gt; a\ny :: a -&gt; a      -- since the operands of + have to be the same type\n</code></pre>\n\n<p>Also we are adding <code>x</code> in <code>(x +)</code> which gives us <code>Num a</code>, and we are adding the functions which give us <code>Num (a -&gt; a)</code>  (at this point, this is essentially an error, since no sane person defines an instance of <code>Num</code> for functions \u2013\u2013\u00a0it's possible, but it's a bad idea).</p>\n\n<p>Anyway, the expression we have just analyzed is the sum of two things of type <code>a -&gt; a</code>, so the result must be of type <code>a -&gt; a</code> as well.</p>\n\n<pre><code>((x +) + y) z    -- since the result of + has to have the same type \n^^^^^^^^^^^      --                                    as its operands \n  a -&gt; a\n</code></pre>\n\n<p>Therefore, <code>z :: a</code>.</p>\n\n<p>So finally the whole expression is typed</p>\n\n<pre><code>(+).(+) :: a -&gt; (a -&gt; a) -&gt; a -&gt; a\n           ^    ^^^^^^^^    ^    ^\n           x       y        z    final result\n</code></pre>\n\n<p>plus the constraints that we picked up along the way.</p>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 6, "last_activity_date": 1613927226, "last_edit_date": 1613927226, "creation_date": 1554451240, "answer_id": 55530817, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of/55530817#55530817", "title": "How does Haskell infer the type of (+).(+)", "body": "<p>My explanations tend to have more words and fewer formulae - apologies if this isn't helpful, but I'm left a little unsatisfied by the other answers so I thought I'd explain it in a slightly different way.</p>\n<p>Clearly you already have a good idea of what the various parts do. Let's focus on the function composition operator <code>.</code>. It takes two functions, and returns the new function which first applies the function on the right of <code>.</code> to the argument, then applies the function on the  left of <code>.</code> to the result of that.</p>\n<p>So in <code>(+).(+)</code> we'll start with the function on the right of <code>.</code>: <code>(+)</code>. This has type <code>(Num a) =&gt; a -&gt; a -&gt; a</code> - that is, it takes two arguments which must be the same type, and that type must be an instance of <code>Num</code>. And then it returns a value of the same type.</p>\n<p>Recall that, because of currying, this is equivalent to <code>(Num a) =&gt; a -&gt; (a -&gt; a)</code>. That is, it takes an instance of <code>Num</code>, and returns a function from that same type to that same type.</p>\n<p>Now we must compose it with another function - one that takes its result type as input. What is that other function? It's <code>(+)</code> again! But we know that, in order for the composition to type-check, we must feed it that function type: <code>a -&gt; a</code> (where <code>a</code> is an instance of <code>Num</code>). As we already saw, this isn't a problem, as <code>(+)</code> can take <em>any type that is an instance of <code>Num</code></em>. That can include <code>a -&gt; a</code>, when we have the appropriate instance. And this explains why the final type has the 2 constraints <code>Num a</code> and <code>Num (a -&gt; a)</code>.</p>\n<p>Now it's easy to put everything together. Leaving off the constraints (which we've already dealt with), we schematically have:</p>\n<pre><code>(+)                                 .     (+)\n(a -&gt; a) -&gt; ((a -&gt; a) -&gt; (a -&gt; a))        a -&gt; (a -&gt; a)\n</code></pre>\n<p>So in the type signature of <code>(.)</code>, which I'll write as <code>(c -&gt; d) -&gt; (b -&gt; c) -&gt; (b -&gt; d)</code>, we have <code>a</code> as <code>b</code>, <code>a -&gt; a</code> as <code>c</code>, and <code>(a -&gt; a) -&gt; (a -&gt; a)</code> as <code>d</code>. Substituting these in, we get the final type (<code>b  -&gt; d</code>) as:</p>\n<pre><code>a -&gt; ((a -&gt; a) -&gt; (a -&gt; a))\n</code></pre>\n<p>Which we can rewrite as</p>\n<pre><code>a -&gt; (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n<p>by removing unnecessary parentheses, after recalling that function arrows are right-associative.</p>\n"}, {"tags": [], "owner": {"reputation": 6962, "user_id": 4854046, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455ede71befeab638394c3eebb0ae3b5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Jerred", "link": "https://stackoverflow.com/users/4854046/mike-jerred"}, "is_accepted": false, "score": 0, "last_activity_date": 1554452888, "creation_date": 1554452888, "answer_id": 55531262, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of/55531262#55531262", "title": "How does Haskell infer the type of (+).(+)", "body": "<p>The types of <code>(.)</code> and <code>(+)</code> are like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>We can relabel to avoid confusion:</p>\n\n<pre><code>(+) :: Num i =&gt; i -&gt; i -&gt; i -- the first (+)\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n(+) :: Num j =&gt; j -&gt; j -&gt; j -- the second (+)\n</code></pre>\n\n<p>Now, lets work out the type of <code>(+) (.)</code>. This is <code>(.)</code> with one argument applied, so the result will be <code>(a -&gt; b) -&gt; a -&gt; c</code>, and we have matched <code>(b -&gt; c)</code> with the type of our first <code>(+)</code> so:</p>\n\n<pre><code>(b -&gt; c) = Num i =&gt; i -&gt; i -&gt; i\nb = i\nc = i -&gt; i\n\n(+) (.) :: (a -&gt; b) -&gt; a -&gt; c\n= Num i =&gt; (a -&gt; i) -&gt; a -&gt; c -- replacing b\n= Num i =&gt; (a -&gt; i) -&gt; a -&gt; (i -&gt; i) -- replacing c\n= Num i =&gt; (a -&gt; i) -&gt; a -&gt; i -&gt; i -- simplifying\n</code></pre>\n\n<p>Now, we can apply the second argument to this. The result will be <code>a -&gt; i -&gt; i</code>, and we have matched <code>(a -&gt; i)</code> with the type of our second <code>(+)</code> so:</p>\n\n<pre><code>(a -&gt; i) = Num j =&gt; j -&gt; j -&gt; j\na = j\ni = j -&gt; j\n\n(+) (.) (+) :: Num i =&gt; a -&gt; i -&gt; i\n= (Num i, Num j) =&gt; j -&gt; i -&gt; i -- replacing a\n= (Num (j -&gt; j), Num j) =&gt; j -&gt; (j -&gt; j) -&gt; (j -&gt; j) -- replacing i\n= (Num (j -&gt; j), Num j) =&gt; j -&gt; (j -&gt; j) -&gt; j -&gt; j -- simplifying\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1554458396, "creation_date": 1554458396, "answer_id": 55532857, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of/55532857#55532857", "title": "How does Haskell infer the type of (+).(+)", "body": "<p>Type derivation is a purely mechanical procedure:</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n(.) :: (       b -&gt; c     ) -&gt;  (       a -&gt; b     )  -&gt; a -&gt; c\n\n(.)    ((+) :: t -&gt; (t-&gt;t))     ((+) :: s -&gt; (s-&gt;s))  :: a -&gt; c\n----------------------------------------------------\n            b ~ t, c ~ t-&gt;t,          a ~ s, b ~ s-&gt;s    s -&gt; (t -&gt; t)\n            Num t                     Num s              s -&gt; (b -&gt; b)\n            Num b                     Num s              s -&gt; ((s-&gt;s) -&gt; (s-&gt;s))\n            Num (s-&gt;s)                Num s              s -&gt; ((s-&gt;s) -&gt; (s-&gt;s))\n</code></pre>\n\n<p><code>(+) . (+)</code> is the same as <code>(.) (+) (+)</code>.</p>\n"}], "owner": {"reputation": 119, "user_id": 10998854, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-woJZEacxuts/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMZQ9PvigLleC18lYZqEW0kJs8mFQ/mo/photo.jpg?sz=128", "display_name": "zichao liu", "link": "https://stackoverflow.com/users/10998854/zichao-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 6, "score": 6, "last_activity_date": 1613927226, "creation_date": 1554446332, "last_edit_date": 1554448085, "question_id": 55529564, "link": "https://stackoverflow.com/questions/55529564/how-does-haskell-infer-the-type-of", "title": "How does Haskell infer the type of (+).(+)", "body": "<p>Why the type of <code>(+).(+)</code> is <code>(Num a, Num (a -&gt; a)) =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a</code> ?</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>I tried but didn't know how to turn out <code>(Num a, Num (a -&gt; a)) =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a</code>.</p>\n\n<pre><code>(+) :: Num i =&gt; i -&gt; i -&gt; i\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\n(+) :: Num j =&gt; j -&gt; j -&gt; j\n\n(+) . (+) :: (i -&gt; (i -&gt; i)) -&gt; ((j -&gt; j) -&gt; i) -&gt; ((j -&gt; j) -&gt; (i -&gt; i))\nwhere: \n  b = i\n  c = i -&gt; i\n  a = j -&gt; j\n</code></pre>\n\n<p>Could someone help and give me analysis steps?</p>\n"}, {"tags": ["haskell", "currying", "function-composition", "first-class-functions"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1554446142, "post_id": 55529449, "comment_id": 97762490, "body": "Really, why not? Do you get any error message?"}, {"owner": {"reputation": 297, "user_id": 5623621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b2a8b4e1985e409c8916c9442bc4c9?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/5623621/owen"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1554447369, "post_id": 55529449, "comment_id": 97763061, "body": "Oops! I&#39;ve found that my question was totally founded by a different issue."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554451449, "post_id": 55530019, "comment_id": 97765091, "body": "surely, to match the OP&#39;s original definition, the section line should be <code>f _ = \\_ -&gt; 1</code>? (Oh sorry, I didn&#39;t realise you <i>were</i> the OP until after I commented :) )"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554476071, "post_id": 55530019, "comment_id": 97779652, "body": "That&#39;s also just <code>f i = (i +)</code>."}], "tags": [], "owner": {"reputation": 297, "user_id": 5623621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b2a8b4e1985e409c8916c9442bc4c9?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/5623621/owen"}, "is_accepted": false, "score": 4, "last_activity_date": 1554448259, "creation_date": 1554448259, "answer_id": 55530019, "question_id": 55529449, "link": "https://stackoverflow.com/questions/55529449/haskell-fast-naming-of-projection-functions/55530019#55530019", "title": "Haskell - fast naming of projection functions", "body": "<p>Indeed, writing <code>f 2 = g</code> is a valid way to define <code>f</code>. However, when defining functions in this way, remember you must define the whole function with the same pattern signature. That is, you may not exhaust your function by writing</p>\n\n<pre><code>f 2 = g\nf i j = i+j\n</code></pre>\n\n<p>Instead, this may be achieved like so:</p>\n\n<pre><code>f 2 = g\nf i = (\\j-&gt; i+j)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1554476021, "last_edit_date": 1554476021, "creation_date": 1554475633, "answer_id": 55538014, "question_id": 55529449, "link": "https://stackoverflow.com/questions/55529449/haskell-fast-naming-of-projection-functions/55538014#55538014", "title": "Haskell - fast naming of projection functions", "body": "<p>You can use the <code>const</code> function, which creates a function that ignores its argument to return a fixed value.</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; Int\nf 2 = g            -- f 2 x = g x\nf _ = const 1      -- f _ x = const 1 x == (\\_ -&gt; 1) x == 1\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 5623621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b2a8b4e1985e409c8916c9442bc4c9?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/5623621/owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1554476021, "creation_date": 1554445807, "question_id": 55529449, "link": "https://stackoverflow.com/questions/55529449/haskell-fast-naming-of-projection-functions", "title": "Haskell - fast naming of projection functions", "body": "<p>Suppose I want to define a function <code>f</code> in terms of some other predefined function <code>g</code> as follows:</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; Int\nf 2 b = g b\nf _ _ = 1\n</code></pre>\n\n<p>That is, I want to define the projection, <code>f(2,_) : Int-&gt;Int</code> to be the same as <code>g(_) : Int-&gt;Int</code>. Gladly, Haskell has first class functions, and so definitions like the following <code>squarePlusOne</code> are valid and standard: </p>\n\n<pre><code>plusOne :: Int -&gt; Int\nplusOne i = i+1\nsquare :: Int -&gt; Int\nsquare i = i*i\nsquarePlusOne :: Int -&gt; Int\nsquarePlusOne = plusOne . Square\n</code></pre>\n\n<p>With Haskell's currying (ie. <code>f</code> takes just one <code>Int</code> as input and returns an <code>(Int-&gt;Int)</code> typed function), I am surprised I cannot write </p>\n\n<pre><code>f 2 = g\n</code></pre>\n\n<p>Why not? Or is there some other syntax?</p>\n"}, {"tags": ["haskell", "typeclass", "type-constraints", "default-method", "overlapping-instances"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554436456, "post_id": 55527670, "comment_id": 97759687, "body": "You definitely can&#39;t do this in GHC Haskell (or any other existing Haskell variant I know of). Those three default instances are &quot;duplicates&quot; because they have the same <i>instance heads</i>. The compiler <i>ignores</i> instance constraints until it has actually chosen an instance. Those other instances are overlapping, which is a bit less fatal, but requires special annotations and will likely make life difficult."}], "answers": [{"comments": [{"owner": {"reputation": 2652, "user_id": 5445670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrwS2.png?s=128&g=1", "display_name": "Solomon Ucko", "link": "https://stackoverflow.com/users/5445670/solomon-ucko"}, "edited": false, "score": 0, "creation_date": 1554460117, "post_id": 55528129, "comment_id": 97769866, "body": "I think <code>default</code> is exactly what I&#39;m looking for! Thanks!"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 4, "last_activity_date": 1554437395, "creation_date": 1554437395, "answer_id": 55528129, "question_id": 55527670, "link": "https://stackoverflow.com/questions/55527670/type-variable-dependent-default-method-implementation-in-haskell/55528129#55528129", "title": "Type-variable-dependent default method implementation in Haskell", "body": "<p>Trying to specify a default for a single method using something like:</p>\n\n<pre><code>instance (Ord v, Fractional w) =&gt; Distribution d v w where\n    probability d v = probabilityOfRange d v v\n</code></pre>\n\n<p>won't work.  Haskell instances don't \"accumulate\".  For a given triple of types <code>d v w</code>, at most one <code>instance Distribution d v w</code> clause will apply.  (If multiple clauses <em>could</em> apply because of \"overlapping\" instances, there are mechanisms to choose the \"best\" match, but there are no direct mechanisms to combine methods from multiple instance clauses.)</p>\n\n<p>In general, if you have a class method:</p>\n\n<pre><code>class Distribution d v w where\n    probability :: d v w -&gt; v w\n</code></pre>\n\n<p>and you'd like to define a default method with a more restrictive type signature (i.e., with constraints on some of the types):</p>\n\n<pre><code>probability :: (Ord v) =&gt; d v w -&gt; v -&gt; w\nprobability d v = probabilityOfRange d v v\n</code></pre>\n\n<p>there are two approaches.</p>\n\n<p>The first is to make use of the <code>DefaultSignatures</code> extension.  This allows you to separate the type signature for the method from the (possibly more restrictive) type signature of the <em>default</em> method.  The syntax is:</p>\n\n<pre><code>class Fractional w =&gt; Distribution d v w where\n    probability :: d v w -&gt; v -&gt; w\n    default probability :: (Ord v) =&gt; d v w -&gt; v -&gt; w\n    probability d v = probabilityOfRange d v v\n    ...\n</code></pre>\n\n<p>The caveat here is that, if you define an instance that <strong>doesn't</strong> override the default method, then it must satisfy the constraint <code>Ord v</code>, or it won't typecheck.</p>\n\n<p>If you want more control over when the default method is used, then the usual approach is to separate the default definition out into a separate function that must be explicitly included in instances that wish to use it.  So, you'd have:</p>\n\n<pre><code>class Fractional w =&gt; Distribution d v w where\n    probability :: d v w -&gt; v -&gt; w\n\nprobabilityDefault :: (Distribution d v w, Ord v) =&gt; d v w -&gt; v -&gt; w\nprobabilityDefault d v = probabilityOfRange d v v\n</code></pre>\n\n<p>and an instance that wishes to use the default must do so explicitly:</p>\n\n<pre><code>instance Distribution Whatever Int w where\n    probability = probabilityDefault\n</code></pre>\n"}], "owner": {"reputation": 2652, "user_id": 5445670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrwS2.png?s=128&g=1", "display_name": "Solomon Ucko", "link": "https://stackoverflow.com/users/5445670/solomon-ucko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 55528129, "answer_count": 1, "score": 1, "last_activity_date": 1554437395, "creation_date": 1554433742, "question_id": 55527670, "link": "https://stackoverflow.com/questions/55527670/type-variable-dependent-default-method-implementation-in-haskell", "title": "Type-variable-dependent default method implementation in Haskell", "body": "<p>I am trying to define default method implementations, but only if the class's type variables derive certain other classes.</p>\n\n<p>I have tried creating type-dependent instances using <code>=&gt;</code> (am I even using it correctly?), but I get a \"duplicate instance declaration error\": (<a href=\"https://repl.it/@solly_ucko/Distributions\" rel=\"nofollow noreferrer\">https://repl.it/@solly_ucko/Distributions</a>)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE FlexibleInstances, FunctionalDependencies, MultiParamTypeClasses, InstanceSigs #-}\n\nimport Data.Int\nimport Data.Ratio\nimport Data.Set\nimport System.Random\n\nduplicate :: a -&gt; (a, a)\nduplicate a = (a, a)\n\nlistRange :: Enum a =&gt; a -&gt; a -&gt; [a]\nlistRange a b = [a..b]\n\nclass Fractional w =&gt; Distribution d v w where\n    probability :: d v w -&gt; v -&gt; w\n\n    probabilityOfRange :: Ord v =&gt; d v w -&gt; v -&gt; v -&gt; w\n\n    ranges :: (Ord v) =&gt; d v w -&gt; Set (v, v)\n    ranges = (Data.Set.map duplicate) . values\n\n    sample :: RandomGen g =&gt; d v w -&gt; g -&gt; (v, g)\n    --sample d g = (scanl1 (+) $ flip Prelude.map $ probability d, g) -- Will need to implement some sort of binary tree, most likely.\n\n    sampleIO :: d v w -&gt; IO v\n    sampleIO = getStdRandom . sample\n\n    values :: d v w -&gt; Set v\n\ninstance (Ord v, Fractional w) =&gt; Distribution d v w where\n    probability d v = probabilityOfRange d v v\n\ninstance Enum v =&gt; Distribution d v w where\n    probabilityOfRange d v1 v2 = sum $ Prelude.map (probability d) [v1..v2]\n\ninstance (Enum v, Ord v) =&gt; Distribution d v w where\n    values = fromList . (concatMap $ uncurry listRange) . toList . ranges\n</code></pre>\n\n<p>When I then try to add real instances (and comment out some of the \"instances\" I created earlier so that the compiler can reach that point), it gives me an error about conflicting instances.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Empty v w = Empty\n\ninstance Distribution Empty v (Ratio Int8) where\n    sample _ g = (undefined, g)\n    sampleIO _ = return undefined\n    probabilityOfRange _ _ _ = 0\n    values _ = empty\n\ndata Singleton v w = Singleton v\n\ninstance Distribution Singleton v Integer where\n    sample (Singleton v) g = (v, g)\n    sampleIO (Singleton v) = return v\n    probabilityOfRange (Singleton v1) v2 v3\n        | v2 &lt;= v1 &amp;&amp; v1 &lt;= v3 = 1\n        | otherwise        = 0\n\ndata Uniform v w = Uniform (Set v)\n</code></pre>\n\n<p>To clarify, my goal is for <code>probability</code> and <code>values</code> to be defined for all <code>Distributions</code>, and for <code>probabilityOfRange</code> to be defined for all <code>Distributions</code> with values deriving <code>Ord</code>. I also wish to provide defaults when additional constraints are met, because without them, a reasonable default (based on other methods) is impossible.</p>\n"}, {"tags": ["parsing", "haskell", "monads"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1554429241, "post_id": 55526952, "comment_id": 97758332, "body": "Note that <code>dePsr (k a) rest</code> is inside the <code>q</code> function. The <code>q</code> function is not directly given as a result of <code>... &gt;&gt;= ...</code>. The result of <code>... &gt;&gt;= ...</code> is <code>PsrOf q</code>, not <code>q</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1554429336, "post_id": 55526952, "comment_id": 97758346, "body": "Also, note that <code>k</code> has type <code>a -&gt; Parser b</code> (this can be seen in the commented-out type signature). So, if you give <code>k</code> an <code>a</code> value, it will give you a <code>Parser b</code> value. This is why <code>k a :: Parser b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 5645683, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-XwpNtcwfsg4/AAAAAAAAAAI/AAAAAAAAAGk/QFbyHHYdJ1c/photo.jpg?sz=128", "display_name": "Sakeeb Hossain", "link": "https://stackoverflow.com/users/5645683/sakeeb-hossain"}, "edited": false, "score": 0, "creation_date": 1554433508, "post_id": 55527257, "comment_id": 97759136, "body": "I followed everything you wrote, but the main thing I was confused about is still the application of the monad in <code>satisfy</code>. You know how we have <code>k :: a -&gt; Parser b</code>? In <code>satisfy</code>, if you look at the do-notation version commented out below, the <code>k</code> function matches with <code>(c -&gt; if pred c then return c else empty)</code>. As you established, <code>k</code> should take in some <code>a</code> and return a <code>Parser b</code> but I don&#39;t see how it does that in this instance. There are only two outcomes: <code>return c</code> or <code>empty</code> (refers to the <code>Alternative</code> I believe) neither of which are of type <code>Parser b</code>."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 3, "creation_date": 1554437775, "post_id": 55527257, "comment_id": 97759974, "body": "The type of <code>return c</code> is <code>Monad m =&gt; m Char</code>, and the type of <code>empty</code> is <code>Alternative m =&gt; m Char</code>.  Because your <code>Parser</code> has both <code>Monad</code> (shown) and <code>Applicative</code> (not shown) instances, both these types unify with <code>Parser Char</code>, so the expression <code>if pred c then return c else empty</code> <b>DOES</b> have type <code>Parser Char</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1554451728, "post_id": 55527257, "comment_id": 97765244, "body": "You haven&#39;t given the <code>Alternative</code> instance for <code>Parser</code> here: but I think it&#39;s helpful in this context to know that <code>empty</code> would be defined as <code>empty = PsrOf $ const Nothing</code> (that is, it&#39;s a &quot;useless&quot; parser that fails for every input - but such &quot;useless&quot; things have a mysterious way of ending up being very useful for defining abstract concepts). In particular, the <code>else empty</code> in the <code>do</code> block version corresponds exactly to the <code>p _ = Nothing</code> in the other version."}, {"owner": {"reputation": 469, "user_id": 5645683, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-XwpNtcwfsg4/AAAAAAAAAAI/AAAAAAAAAGk/QFbyHHYdJ1c/photo.jpg?sz=128", "display_name": "Sakeeb Hossain", "link": "https://stackoverflow.com/users/5645683/sakeeb-hossain"}, "edited": false, "score": 1, "creation_date": 1554579304, "post_id": 55527257, "comment_id": 97806720, "body": "@John one last thing: could you explain how you arrived at <code>return a = PsrOf (\\rest -&gt; Just (rest, a))</code> from <code>return = pure</code> after you put &quot;points&quot; back into return? How can we assume to use <code>(\\rest -&gt; Just (rest, a))</code>? Also seriously, thanks for your responses. You&#39;ve cleared up a lot."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 469, "user_id": 5645683, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-XwpNtcwfsg4/AAAAAAAAAAI/AAAAAAAAAGk/QFbyHHYdJ1c/photo.jpg?sz=128", "display_name": "Sakeeb Hossain", "link": "https://stackoverflow.com/users/5645683/sakeeb-hossain"}, "edited": false, "score": 1, "creation_date": 1554777914, "post_id": 55527257, "comment_id": 97866430, "body": "@SakeebHossain, the definition of <code>pure</code> or <code>return</code> can be calculated from the definition of <code>&gt;&gt;=</code> (or even <code>&lt;*&gt;</code>, I believe). The monad identity laws <code>pure x &gt;&gt;= f = f x</code> and <code>m &gt;&gt;= pure = m</code> tell you all you need to know. Indeed, you only need one for the calculation. I think this time you&#39;re better off using the second law."}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 4, "last_activity_date": 1554746928, "last_edit_date": 1554746928, "creation_date": 1554429559, "answer_id": 55527257, "question_id": 55526952, "link": "https://stackoverflow.com/questions/55526952/using-monad-for-simple-haskell-parser/55527257#55527257", "title": "Using monad for simple Haskell parser", "body": "<p>Ok, Maybe this will help.  Let's start by puting some points back into <code>dePsr</code>.</p>\n\n<pre><code>dePsr :: Parser a -&gt; String -&gt; Maybe (String, a)\ndePsr (PsrOf p) rest = p rest\n</code></pre>\n\n<p>And let's also write out return: (NB I'm putting in all the points for clarity)</p>\n\n<pre><code>return :: a -&gt; Parser a\nreturn a = PsrOf (\\rest -&gt; Just (rest, a))\n</code></pre>\n\n<p>And now from the <code>Just</code> branch of the <code>(&gt;&gt;=)</code> definition</p>\n\n<pre><code> Just (rest, a) -&gt; dePsr (k a) rest\n</code></pre>\n\n<p>Let's make sure we agree on what every thing is:</p>\n\n<ul>\n<li><code>rest</code> the string remaining unparsed after <code>p1</code> is applied</li>\n<li><code>a</code> the result of applying <code>p1</code></li>\n<li><code>k :: a -&gt; Parser b</code> takes the result of the previous parser and makes a new parser</li>\n<li><code>dePsr</code> unwraps a <code>Parser a</code> back into a function `String -> Maybe (String, a)</li>\n</ul>\n\n<p>Remember we will wrap this <em>back</em> into a parser again at the top of the function: <code>PsrOf q</code></p>\n\n<p>So in English bind <code>(&gt;&gt;=)</code> take a parser in <code>a</code> and a function from <code>a</code> to a parser in <code>b</code> and returns a parser in <code>b</code>.  The resulting parser is made by wrapping <code>q :: String -&gt; Maybe (String, b)</code> in the Parser constructor <code>PsrOf</code>. Then <code>q</code>, the combined parser, take a <code>String</code> called <code>inp</code> and applies the function <code>p1 :: String -&gt; Maybe (String,a)</code> that we got from pattern matching against the first parser, and pattern matches on the result. For an error we propagate <code>Nothing</code> (easy).  If the first parser had a result we have tow pieces of information, the still unparsed string called <code>rest</code> and the result <code>a</code>. We give <code>a</code> to <code>k</code>, the second parser combinator, and get a <code>Parser b</code> which we need to unwrap with <code>dePsr</code> to get a function (<code>String -&gt; Maybe (String,b)</code> back.  That function can be applied to <code>rest</code> for the final result of the combined parsers.</p>\n\n<p>I think the hardest part about reading this is that sometimes we <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">curry</a> the parser function which obscures what is actually happening.</p>\n\n<p>Ok for the <code>satisfy</code> example</p>\n\n<pre><code>satisfy pred \n  = anyChar &gt;&gt;= (c -&gt; if pred c then return c else empty)\n</code></pre>\n\n<p><code>empty</code> comes from the alternative instance and is <code>PsrOf (const Nothing)</code> so a parser that always fails. </p>\n\n<p>Lets look at only the successful branches. By substitution of only the successful part:</p>\n\n<pre><code>PsrOf (\\(c:cs) -&gt;Just (cs, c)) &gt;&gt;= (\\c -&gt; PsrOf (\\rest -&gt; Just (rest, c)))\n</code></pre>\n\n<p>So in the bind <code>(&gt;&gt;=)</code> definition</p>\n\n<ul>\n<li><code>p1 = \\(c:cs -&gt; Just (cs, c))</code></li>\n<li><code>k = (\\c -&gt; PsrOf (\\rest -&gt; Just (rest, c)))</code></li>\n<li><code>q inp = let Just (rest,a) = p1 inp in dePsr (k a) rest</code> again only successful branch</li>\n</ul>\n\n<p>Then <code>q</code> becomes</p>\n\n<pre><code>q inp = \n  let Just (rest, a) = (\\(c:cs) -&gt; Just (cs, c)) inp\n   in dePsr (\\c -&gt; PsrOf (\\rest -&gt; Just (rest, c))) a rest\n</code></pre>\n\n<p>Doing a little \u03b2-reduction</p>\n\n<pre><code>q inp =\n let (c:cs) = inp\n     rest = cs\n     a = c\n  in dePsr (PsdOf (\\rest -&gt; Just (rest, a))) rest -- dePsr . PsrOf = id\n</code></pre>\n\n<p>Finally cleaning up some more</p>\n\n<pre><code>q (c:cs) = Just (cs, c) \n</code></pre>\n\n<p>So if <code>pred</code> is successful we reduce <code>satisfy</code> back to exactly <code>anyChar</code> which is exactly what we expect, <em>and</em> exactly what we find in the first example of the question. I will leave it as and exersize to the reader (read: I'm lazy) to prove that if either <code>inp = \"\"</code> or <code>pred c = False</code> that the outcome is <code>Nothing</code> as in the first <code>satisfy</code> example.</p>\n\n<hr>\n\n<p>NOTE: If you are doing anything other than a class assignment, you will save yourself hours of pain and frustration by starting with error handling from the beginning make your parser <code>String -&gt; Either String (String,a)</code> it is easy to make the error type more general later, but a PITA to change everything from <code>Maybe</code> to <code>Either</code>.</p>\n\n<hr>\n\n<p><strong>Question:</strong> \"[C]ould you explain how you arrived at <code>return a = PsrOf (\\rest -&gt; Just (rest, a))</code> from <code>return = pure</code> after you put \"points\" back into return?</p>\n\n<p><strong>Answer:</strong> First off, it is pretty unfortunate to give the Monad instance definition without the Functor and Applicative definitions.  The <code>pure</code> and <code>return</code> functions must be identical (It is part of the Monad Laws), and they would be called the same thing except <code>Monad</code> far predates Applicative in Haskell history. In point of fact, I don't \"know\" what pure looks like, but I know what it has to be because it is the only possible definition. (If you want to understand the the proof of that statement ask, I have read the papers, and I know the results, but I'm not into typed lambda calculus quite enough to be confident in reproducing the results.)</p>\n\n<p><code>return</code> must wrap a value in the context <em>without</em> altering the context.</p>\n\n<pre><code>return :: Monad m =&gt; a -&gt; m a\nreturn :: a -&gt; Parser a -- for our Monad\nreturn :: a -&gt; PsrOf(\\str -&gt; Maybe (rest, value)) -- substituting the constructor (PSUDO CODE)\n</code></pre>\n\n<p>A <code>Parser</code> is a function that takes a string to be parsed and returns <code>Just</code> the value along with any unparsed portion of the original string or <code>Nothing on failure, all wrapped in the constructor</code>PsrOf<code>.  The context is the string to be parsed, so we cannot change that. The value is of course what was passed to</code>return`. The parser always succeeds so we must return Just a value.</p>\n\n<pre><code>return a =  PsrOf (\\rest -&gt; Just (rest, a))\n</code></pre>\n\n<p><code>rest</code> is the context and it is passed through unaltered.\n<code>a</code> is the value we put into the Monad context.</p>\n\n<p>For completeness here is also the only reasonable definition of <code>fmap</code> from Functor.</p>\n\n<pre><code>fmap :: Functor f =&gt; (a-&gt;b) -&gt; f a -&gt; f b\nfmap :: (a -&gt; b) -&gt; Parser a -&gt; Parser b -- for Parser Monad\nfmap f (PsrOf p) = PsrOf q\n  where q inp = case p inp of\n    Nothing -&gt; Nothing\n    Just (rest, a) -&gt; Just (rest, f a)\n  -- better but less instructive definition of q\n  -- q = fmap (\\(rest,a) -&gt; (rest, f a)) . p\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 5645683, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-XwpNtcwfsg4/AAAAAAAAAAI/AAAAAAAAAGk/QFbyHHYdJ1c/photo.jpg?sz=128", "display_name": "Sakeeb Hossain", "link": "https://stackoverflow.com/users/5645683/sakeeb-hossain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 55527257, "answer_count": 1, "score": 3, "last_activity_date": 1554746928, "creation_date": 1554426685, "last_edit_date": 1554428454, "question_id": 55526952, "link": "https://stackoverflow.com/questions/55526952/using-monad-for-simple-haskell-parser", "title": "Using monad for simple Haskell parser", "body": "<h2><strong>TL;DR</strong></h2>\n\n<p>I'm trying to understand how this:</p>\n\n<pre><code>satisfy :: (Char -&gt; Bool) -&gt; Parser Char\nsatisfy pred = PsrOf p\n  where\n    p (c:cs) | pred c = Just (cs, c)\n    p _ = Nothing\n</code></pre>\n\n<p>Is equivalent to this:</p>\n\n<pre><code>satisfy :: (Char -&gt; Bool) -&gt; Parser Char\nsatisfy pred = do\n    c &lt;- anyChar\n    if pred c then return c else empty\n</code></pre>\n\n<h2>Context</h2>\n\n<p>This is a snippet from some lecture notes on Haskell parsing, which I'm trying to understand:    </p>\n\n<pre><code>import Control.Applicative\nimport Data.Char\nimport Data.Functor\nimport Data.List\n\nnewtype Parser a = PsrOf (String -&gt; Maybe (String, a))\n    -- Function from input string to:\n    --\n    -- * Nothing, if failure (syntax error);\n    -- * Just (unconsumed input, answer), if success.\n\ndePsr :: Parser a -&gt; String -&gt; Maybe (String, a)\ndePsr (PsrOf p) = p\n\n-- Monadic Parsing in Haskell uses [] instead of Maybe to support ambiguous\n-- grammars and multiple answers.\n\n-- | Use a parser on an input string.\nrunParser :: Parser a -&gt; String -&gt; Maybe a\nrunParser (PsrOf p) inp = case p inp of\n                            Nothing -&gt; Nothing\n                            Just (_, a) -&gt; Just a\n                          -- OR: fmap (\\(_,a) -&gt; a) (p inp)\n\n-- | Read a character and return. Failure if input is empty.\nanyChar :: Parser Char\nanyChar = PsrOf p\n  where\n    p \"\" = Nothing\n    p (c:cs) = Just (cs, c)\n\n-- | Read a character and check against the given character.\nchar :: Char -&gt; Parser Char\n-- char wanted = PsrOf p\n--   where\n--     p (c:cs) | c == wanted = Just (cs, c)\n--     p _ = Nothing\nchar wanted = satisfy (\\c -&gt; c == wanted)   -- (== wanted)\n\n-- | Read a character and check against the given predicate.\nsatisfy :: (Char -&gt; Bool) -&gt; Parser Char\nsatisfy pred = PsrOf p\n  where\n    p (c:cs) | pred c = Just (cs, c)\n    p _ = Nothing\n-- Could also be:\n-- satisfy pred = do\n--     c &lt;- anyChar\n--     if pred c then return c else empty\n\ninstance Monad Parser where\n    -- return :: a -&gt; Parser a\n    return = pure\n\n    -- (&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\n    PsrOf p1 &gt;&gt;= k = PsrOf q\n      where\n        q inp = case p1 inp of\n                  Nothing -&gt; Nothing\n                  Just (rest, a) -&gt; dePsr (k a) rest\n</code></pre>\n\n<p>I understand everything up until the last bit of the Monad definition, specifically I don't understand how the following line returns something of type <code>Parser b</code> as is required by the <code>(&gt;&gt;=)</code> definition:</p>\n\n<pre><code>Just (rest, a) -&gt; dePsr (k a) rest\n</code></pre>\n\n<p>It's difficult for me grasp what the Monad definition means without an example. Thankfully, we have one in the alternate version of the <code>satisfy</code> function, which uses do-notation (which of course means the Monad is being called). I really don't understand do-notation yet, so here's the desugared version of <code>satisfy</code>:</p>\n\n<pre><code>satisfy pred = do\n    anyChar &gt;&gt;= (c -&gt;\n    if pred c then return c else empty)\n</code></pre>\n\n<p>So based on the first line of our <code>(&gt;&gt;=)</code>definition, which is</p>\n\n<pre><code>PsrOf p1 &gt;&gt;= k = PsrOf q\n</code></pre>\n\n<p>We have <code>anyChar</code> as our <code>PsrOf p1</code> and <code>(c -&gt; if pred c then return c else empty)</code> as our <code>k</code>. What I don't get is how in <code>dePsr (k a) rest</code> that <code>(k a)</code> returns a <code>Parser</code> (at least it shold, otherwise calling <code>dePsr</code> on it wouldn't make sense). This is made more confusing by the presence of <code>rest</code>. Even if <code>(k a)</code> returned a <code>Parser</code>, calling <code>dePsr</code> would extract the underlying function from the returned <code>Parser</code> and pass <code>rest</code> to it as an input. This is definitely doesn't return something of type <code>Parser b</code> as required by the definition of <code>(&gt;&gt;=)</code>. Clearly I'm misunderstanding something somewhere.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1554414744, "post_id": 55525407, "comment_id": 97755029, "body": "&quot;So why does (/) accept a generic Num-type as an argument?&quot; It doesn&#39;t. It only accepts an instance of <code>Fractional</code>. But since <code>Fractional</code> is a subclass of <code>Num</code>, and <code>fromIntegral</code> can produce any <code>Num</code>, <code>fromIntegral</code> can also produce a <code>Fractional</code> - as it has to in order to be used with <code>(&#47;)</code>. As for why the functions don&#39;t list a concrete type in their definition, it&#39;s because that would unnecessarily restrict their use - but being polymorphic they can be used in more situations."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1554414822, "post_id": 55525407, "comment_id": 97755054, "body": "PS there was much discussion of a similar point recently in <a href=\"https://stackoverflow.com/questions/55436571/type-error-when-creating-list-from-integral-type\">this question</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554422377, "post_id": 55525407, "comment_id": 97757079, "body": "&quot;Obviously fromIntegral converts an Int/Integer into some Num class type (which one? I have no idea).&quot; I like to think of it as a nondeterministic function that converts its argument into a value of <i>all</i> types with a <code>Num</code> instance. The values exist in a superposition until you &quot;observe&quot; the value of the requested type."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1554444748, "last_edit_date": 1554444748, "creation_date": 1554414997, "answer_id": 55525501, "question_id": 55525407, "link": "https://stackoverflow.com/questions/55525407/haskell-understanding-type-conversion-mechanics-by-fromintegral/55525501#55525501", "title": "Haskell: Understanding type conversion mechanics by `fromIntegral`", "body": "<p><code>fromIntegral</code> doesn't convert to some vague unknowable <code>Num</code> type. It converts to the one that's demanded of it. That is, <code>fromIntegral</code> doesn't choose its own result type; the caller does. So</p>\n\n<pre><code>fromIntegral :: Int -&gt; Integer\nfromIntegral :: Int -&gt; Word\nfromIntegral :: Integer -&gt; Double\n</code></pre>\n\n<p>Etc. In this case, the type checker infers</p>\n\n<pre><code>minimalExample :: Integer -&gt; Integer\nminimalExample a = truncate y\n  where\n    x, y :: Fractional n =&gt; n\n    x = fromIntegral (a + 10)\n    y = x - 12 * (x / 13)\n</code></pre>\n\n<p>because <code>(/)</code> demands a <code>Fractional</code> type.</p>\n\n<p>Then the defaulting mechanism kicks in to fix <code>n</code>:</p>\n\n<pre><code>minimalExample :: Integer -&gt; Integer\nminimalExample a = truncate y\n  where\n    x, y :: Double\n    x = fromIntegral (a + 10)\n    y = x - 12 * (x / 13)\n</code></pre>\n\n<p>You might expect this, instead, to turn out</p>\n\n<pre><code>minimalExample :: Integer -&gt; Integer\nminimalExample a = truncate (y :: Double)\n  where\n    x, y :: Fractional n =&gt; n\n    x = fromIntegral (a + 10)\n    y = x - 12 * (x / 13)\n</code></pre>\n\n<p>I certainly did! But it does not. The dreaded monomorphism restriction kicks in and forces <code>x</code> and <code>y</code> to be monomorphic in the constrained type <code>n</code>, because they are not (syntactically) functions. Yeah, the monomorphism restriction is weird.</p>\n"}], "owner": {"reputation": 125, "user_id": 10668561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21803983c09af1831ec4e0a2a4df7168?s=128&d=identicon&r=PG&f=1", "display_name": "StckXchnge-nub12", "link": "https://stackoverflow.com/users/10668561/stckxchnge-nub12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55525501, "answer_count": 1, "score": 2, "last_activity_date": 1554444748, "creation_date": 1554414455, "question_id": 55525407, "link": "https://stackoverflow.com/questions/55525407/haskell-understanding-type-conversion-mechanics-by-fromintegral", "title": "Haskell: Understanding type conversion mechanics by `fromIntegral`", "body": "<h2>Understanding type conversion by <code>fromIntegral</code></h2>\n\n<p>So, I have been running into a lot of type conversion errors lately. This brought me to the use of <code>fromIntegral</code>, though I am quite puzzled on the way it works.</p>\n\n<pre><code>minimalExample :: Integer -&gt; Integer\nminimalExample a = truncate y\n    where\n        x = fromIntegral (a + 10)\n        y = x - 12 * (x / 13)\n</code></pre>\n\n<p>Note how I had to use <code>fromIntegral</code> to make sure <code>x</code> is of the right type for the <code>(/)</code> operator. It wouldn't have worked if <code>x</code> was an Integral type. A typecheck for the functions in GHCI gives me this info:</p>\n\n<pre><code>Prelude&gt; :t fromIntegral\nfromIntegral :: (Integral a, Num b) =&gt; a -&gt; b\n\nPrelude&gt; :t (/)\n(/) :: Fractional a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Obviously <code>fromIntegral</code> converts an <code>Int</code>/<code>Integer</code> into some <code>Num</code> class type (which one? I have no idea). The division infix operator expects two Fractionals as input. Now take a look at <a href=\"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Base-classes.svg/788px-Base-classes.svg.png\" rel=\"nofollow noreferrer\">this graphic</a>, which summarizes the standard type-class-relations in Haskell.</p>\n\n<p><code>Num</code> is above <code>Fractional</code>, which means not every <code>Num</code>-Type is a <code>Fractional</code>. So why does <code>(/)</code> accept a generic <code>Num</code>-type as an argument?</p>\n\n<p>I assume it is because <code>fromIntegral</code> doesn't really convert to a <code>Num</code> (those aren't even instantiable, are they? Only inheritable by concrete types), but rather it converts directly to a <code>Double</code> or a <code>Float</code>.</p>\n\n<p>If so, which one does it actually convert to? And why doesn't it actually list that concrete type in its definition, instead of the fuzzy and generic <code>Num</code> class type?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 6, "creation_date": 1554413496, "post_id": 55525164, "comment_id": 97754561, "body": "The <code>-&gt;</code> is part of the <code>case</code> statement you didn&#39;t include in the question."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554413908, "post_id": 55525164, "comment_id": 97754717, "body": "Ah, thanks, fixed."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554414334, "post_id": 55525164, "comment_id": 97754859, "body": "Still, can&#39;t wrap my head around this. We can pattern match a <code>case</code> and then add more guarded subsequent matches? What is the structure of such expressions?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1554415375, "post_id": 55525164, "comment_id": 97755242, "body": "This is an example of a <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow noreferrer\">pattern guard</a>. It happens to be a guard within a case expression here, but it also can be used with guards that are not part of a case expression."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1554420108, "post_id": 55525588, "comment_id": 97756539, "body": "I just realized I have no idea how the compiler actually desugars fall-through. Does it immediately define auxiliary functions?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1554420391, "post_id": 55525588, "comment_id": 97756618, "body": "I don&#39;t know; I always assumed that it basically unrolls the outer and inner fallbacks \u2013 but thinking about it, that code duplication would be quite haphazard."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1554415492, "creation_date": 1554415492, "answer_id": 55525588, "question_id": 55525164, "link": "https://stackoverflow.com/questions/55525164/haskell-meaning-of-and-in-a-single-line/55525588#55525588", "title": "Haskell: Meaning of `|`, `&lt;-` and `-&gt;` in a single line", "body": "<p>That's a <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"noreferrer\">pattern guard</a>. It's a bit like syntactic sugar for</p>\n\n<pre><code>case x of\n    Left e -&gt; case fromException e of\n      Just pe -&gt; return $ Left pe\n</code></pre>\n\n<p>except if the <code>Just pe</code> match fails, execution will automatically handed on to the next clause in the <em>outer</em> <code>case x of</code> switch.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 55525588, "answer_count": 1, "score": 1, "last_activity_date": 1554419649, "creation_date": 1554413232, "last_edit_date": 1554413838, "question_id": 55525164, "link": "https://stackoverflow.com/questions/55525164/haskell-meaning-of-and-in-a-single-line", "title": "Haskell: Meaning of `|`, `&lt;-` and `-&gt;` in a single line", "body": "<p>What is the meaning of expressions like this one? Taken from <a href=\"https://www.stackage.org/haddock/lts-13.15/yaml-0.11.0.0/src/Data.Yaml.Internal.html#decodeHelper\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>case x of\n    Left e\n        | Just pe &lt;- fromException e -&gt; return $ Left pe\n</code></pre>\n\n<p>Is this pattern matching with guards and then mapping of the matched result? What is the name of the <code>-&gt;</code> syntax used here?</p>\n"}, {"tags": ["list", "haskell", "cartesian-product"], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554407543, "post_id": 55523838, "comment_id": 97752023, "body": "Surely this produces a list of pairs, rather than a list of concatenated strings? I&#39;m not in a position to test right now but think it should work with <code>(:)</code> instead of <code>(,)</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 99, "user_id": 10763836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a08cd486f1d5d56bd7afdaae1833539?s=128&d=identicon&r=PG&f=1", "display_name": "hskjskj", "link": "https://stackoverflow.com/users/10763836/hskjskj"}, "edited": false, "score": 0, "creation_date": 1554407915, "post_id": 55523838, "comment_id": 97752196, "body": "Boy, I missed a lot of subtleties to this question, didn&#39;t I? @hskjskj If exactly one of the lists is infinite, you can still make progress by putting it first, and then reordering the arguments of your function to account for that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 99, "user_id": 10763836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a08cd486f1d5d56bd7afdaae1833539?s=128&d=identicon&r=PG&f=1", "display_name": "hskjskj", "link": "https://stackoverflow.com/users/10763836/hskjskj"}, "edited": false, "score": 0, "creation_date": 1554408641, "post_id": 55523838, "comment_id": 97752537, "body": "@hskjskj In this case, putting the infinite list first helps, as amalloy pointed out. The general case where both lists can be infinite is more tricky, since you need a careful enumeration of all cases so to not get too focused on an infinite proper part of that (like your <code>A1,A2,A3,...</code> sequence). For handling that issue, some packages help (e.g. the <code>Omega</code> monad) but I don&#39;t recommend you use those until you are quite familiar with Haskell."}, {"owner": {"reputation": 99, "user_id": 10763836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a08cd486f1d5d56bd7afdaae1833539?s=128&d=identicon&r=PG&f=1", "display_name": "hskjskj", "link": "https://stackoverflow.com/users/10763836/hskjskj"}, "edited": false, "score": 0, "creation_date": 1554408865, "post_id": 55523838, "comment_id": 97752662, "body": "Thanks for your edit. That makes loads of sense now about the infinite inner loop!"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1554408294, "last_edit_date": 1554408294, "creation_date": 1554407231, "answer_id": 55523838, "question_id": 55523791, "link": "https://stackoverflow.com/questions/55523791/cartesian-product-of-two-lists-of-different-types-haskell/55523838#55523838", "title": "Cartesian product of two lists of different types (Haskell)", "body": "<pre><code>(,) &lt;$&gt; xs (show &lt;$&gt; cs)\n</code></pre>\n\n<p>parses as</p>\n\n<pre><code>(,) &lt;$&gt; (xs (show &lt;$&gt; cs))\n</code></pre>\n\n<p>Note that here you are calling <code>xs</code> as a function, with <code>show &lt;$&gt; cs</code> as its argument. That can't be right: <code>xs</code> is a String!</p>\n\n<p>Since you seem to be trying to program in applicative style, you probably meant to write something of the form</p>\n\n<pre><code>f &lt;$&gt; a &lt;*&gt; b\n</code></pre>\n\n<p>In your case,</p>\n\n<pre><code>f = (,)\na = xs\nb = show &lt;$&gt; cs\n</code></pre>\n\n<p>So, you meant to write:</p>\n\n<pre><code>(,) &lt;$&gt; xs &lt;*&gt; (show &lt;$&gt; cs)\n</code></pre>\n\n<p>This is sorta close to what you wanted, but there are a few problems. First, its type is <code>[(Char, String)]</code>, where you wanted them joined up as strings. That can be fixed by using <code>(:)</code> instead of <code>(,)</code>.</p>\n\n<p>Second, since one list is infinite, you need to process that as your \"outermost loop\" - if it's an inner loop, the fact that it never ends will mean your other loops never progress. When using <code>[]</code> as an Applicative, the \"outer loop\" is the first thing you map over.</p>\n\n<p>So, we might try:</p>\n\n<pre><code>(,) &lt;$&gt; (show &lt;$&gt; cs) &lt;*&gt; xs\n</code></pre>\n\n<p>Note I've gone back to <code>(,)</code> for a moment to highlight something:</p>\n\n<pre><code>Prelude&gt; take 5 $ (,) &lt;$&gt; (show &lt;$&gt; cs) &lt;*&gt; xs\n[(\"1\",'A'),(\"1\",'B'),(\"1\",'C'),(\"2\",'A'),(\"2\",'B')]\n</code></pre>\n\n<p>Now we get the pairs you want, but <code>(:)</code> won't work on them anymore because they're in the wrong order. So, you need to use a different function, one like <code>(:)</code> but which takes its arguments in the other order. Happily, it is easy to produce such a function: it's simply <code>flip (:)</code>:</p>\n\n<pre><code>Prelude&gt; take 5 $ (flip (:)) &lt;$&gt; (show &lt;$&gt; cs) &lt;*&gt; xs\n[\"A1\",\"B1\",\"C1\",\"A2\",\"B2\"]\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 10763836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a08cd486f1d5d56bd7afdaae1833539?s=128&d=identicon&r=PG&f=1", "display_name": "hskjskj", "link": "https://stackoverflow.com/users/10763836/hskjskj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555080147, "creation_date": 1554406992, "last_edit_date": 1555080147, "question_id": 55523791, "link": "https://stackoverflow.com/questions/55523791/cartesian-product-of-two-lists-of-different-types-haskell", "title": "Cartesian product of two lists of different types (Haskell)", "body": "<p>I'm (very) new to Haskell and I'm trying to solve what I think is a simple problem:</p>\n\n<p>I want to create a list of the Cartesian product of two lists of different types: eg. one contains characters and one contains integers.</p>\n\n<pre><code>   ['A','B','C']\n</code></pre>\n\n<p>and the infinite list:</p>\n\n<pre><code>    [1..]\n</code></pre>\n\n<p>I'm trying to get an output where each of my letters is suffixed with a number: eg.</p>\n\n<pre><code>    [\"A1\", \"B1\", \"C1\", \"A2\", \"B2\"..]\n</code></pre>\n\n<p>I've been attempting this using things I've read online, however I'm struggling. As I understand it, I want to convert my integer list to a string using 'show'. My code is below:</p>\n\n<pre><code>    combinations xs cs = (,) &lt;$&gt; xs (show &lt;$&gt; cs)\n</code></pre>\n\n<p>Where xs and cs are passed in my function as ['A','B','C'] and [1..] respectively. </p>\n\n<p>However I receive this error:</p>\n\n<pre><code>   Couldn't match expected type \u2018[String] -&gt; [a0]\u2019\n              with actual type \u2018[Char]\u2019\n</code></pre>\n\n<p>I'd really appreciate any ideas as I've been struggling for a while.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["list", "haskell", "fold", "foldleft"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1554403536, "post_id": 55522847, "comment_id": 97750193, "body": "What errors? Your code has indentation issues, so I don&#39;t know if your errors are because of that, or because of the types. <b>Always write your errors in your question</b>."}, {"owner": {"reputation": 11, "user_id": 5900247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f64fbc3c3aad02eb989c31d4da2465?s=128&d=identicon&r=PG&f=1", "display_name": "amir ahmed", "link": "https://stackoverflow.com/users/5900247/amir-ahmed"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1554404735, "post_id": 55522847, "comment_id": 97750724, "body": "i have added the error produced, please revise. thank you"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554405136, "post_id": 55522847, "comment_id": 97750926, "body": "You have the parameters to <code>func</code> the wrong way round."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554405693, "post_id": 55522847, "comment_id": 97751177, "body": "And on closer look, if you correct that then your function will build the list back-to-front. It would really be much more natural to use <code>foldr</code> here (as it usually is in Haskell). [Another small problem, the inequality should be <code>&gt;= n</code>]"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5900247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f64fbc3c3aad02eb989c31d4da2465?s=128&d=identicon&r=PG&f=1", "display_name": "amir ahmed", "link": "https://stackoverflow.com/users/5900247/amir-ahmed"}, "edited": false, "score": 0, "creation_date": 1554408187, "post_id": 55523947, "comment_id": 97752303, "body": "interesting! but what if we assume the list is finite for now ? can it be done ? Thanks"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554415372, "post_id": 55523947, "comment_id": 97755241, "body": "Is <code>ndrop</code> meant to call <code>drop</code> like that?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554417714, "post_id": 55523947, "comment_id": 97755912, "body": "@WillNess, yeah, isn&#39;t the whole point to <i>implement</i> drop, not to use it?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554417890, "post_id": 55523947, "comment_id": 97755970, "body": "@dfeuer right; already switched to <code>tail</code>. :) I could argue that <code>drop 1</code> is not <code>drop n</code>, but I won&#39;t. :) was just being superstitious, <code>tail</code> of course is safe to use there by construction. (could use lazy pattern just as well...)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1554418621, "post_id": 55523947, "comment_id": 97756176, "body": "I just saw how disgusting that is. Folds just aren&#39;t the right tools for <code>drop</code>. Better to drive a nail in with a screwdriver than drive a screw in with a hammer. Take the efficiency loss and rebuild the whole list if you have no choice. <code>tail</code> isn&#39;t a real thing, unless you&#39;re doing something bizarre like the <code>MonadFix []</code> instance."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554418971, "post_id": 55523947, "comment_id": 97756261, "body": "@dfeuer you&#39;re referring to <code>ntake</code>, or the new additions? <i>paramorphism</i> is the natural fit for drop, and it&#39;s easy to emulate either as cata over explicit <code>tails</code>, or with the repeated <code>tail</code> like I did. paramorphisms are nice too. :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554419204, "post_id": 55523947, "comment_id": 97756329, "body": "Yes, a paramorphism is the right tool. But pretending you&#39;re using a catamorphism like that seems like a cheat."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1554578493, "last_edit_date": 1554578493, "creation_date": 1554407745, "answer_id": 55523947, "question_id": 55522847, "link": "https://stackoverflow.com/questions/55522847/implementing-haskells-take-function-using-foldl/55523947#55523947", "title": "Implementing Haskell&#39;s `take` function using `foldl`", "body": "<p>Can't be done. </p>\n\n<p>Left fold necessarily diverges on infinite lists, but <code>take n</code> does not. This is so because left fold is tail recursive, so it must scan through the whole input list before it can start the processing.</p>\n\n<p>With the right fold, it's</p>\n\n<pre><code>ntake :: Int -&gt; [a] -&gt; [a]\nntake 0 _  = []\nntake n xs = foldr g z xs 0\n    where\n    g x r i | i&gt;=n      = []\n            | otherwise = x : r (i+1)\n    z _ = []\n\nndrop :: Int -&gt; [a] -&gt; [a]\nndrop 0 xs = xs\nndrop n xs = foldr g z xs 0 xs\n    where\n    g x r i xs@(_:t) | i&gt;=n      = xs\n                     | otherwise = r (i+1) t\n    z _ _ = []\n</code></pre>\n\n<p><code>ndrop</code> implements a <em>paramorphism</em> nicely and faithfully, up to the order of arguments to the reducer function <code>g</code>, giving it access to both the current element <code>x</code> and the current list node <code>xs</code> (such that <code>xs == (x:t)</code>) as well as the recursive result <code>r</code>. A <em>catamorphism's</em> reducer has access only to <code>x</code> and <code>r</code>.</p>\n\n<p>Folds usually encode catamorphisms, but this shows that right fold can be used to code up a paramorphism just as well. It's <em>universal</em> that way. I think it is beautiful.</p>\n\n<p>As for the type error, to fix it just switch the arguments to your <code>func</code>:</p>\n\n<pre><code>       func y x | ..... = .......\n</code></pre>\n\n<p>The accumulator in the <em>left</em> fold comes as the <em>first</em> argument to the reducer function.</p>\n\n<hr>\n\n<p>If you <em>really</em> want it done with the left fold, and if you're <em>really</em> sure the lists are finite, two options:</p>\n\n<pre><code>ltake n xs = post $ foldl' g (0,id) xs\n    where\n    g (i,f) x | i &lt; n = (i+1, f . (x:))\n              | otherwise = (i,f)\n    post (_,f) = f []\n\nrltake n xs = foldl' g id xs r n\n    where\n    g acc x = acc . f x\n    f x r i | i &gt; 0 = x : r (i-1)\n            | otherwise = []\n    r _ = []\n</code></pre>\n\n<p>The first counts from the left straight up, potentially stopping assembling the prefix in the middle of the full list traversal that it does carry to the end nevertheless, being a left fold.</p>\n\n<p>The second also traverses the list in full turning it into a right fold which <em>then</em> gets to work counting down from the left again, being able to actually stop working as soon as the prefix is assembled.</p>\n\n<p>Implementing <code>drop</code> this way is bound to be (?) even clunkier. Could be a nice exercise.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5900247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f64fbc3c3aad02eb989c31d4da2465?s=128&d=identicon&r=PG&f=1", "display_name": "amir ahmed", "link": "https://stackoverflow.com/users/5900247/amir-ahmed"}, "edited": false, "score": 0, "creation_date": 1554412877, "post_id": 55524365, "comment_id": 97754311, "body": "Awesome, Thank you very much!!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554415301, "post_id": 55524365, "comment_id": 97755221, "body": "Checking the length over and over is sure to make it quadratic anyway."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554415358, "post_id": 55524365, "comment_id": 97755237, "body": "@dfeuer I indeed missed that. Thanks."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1554415425, "last_edit_date": 1554415425, "creation_date": 1554409569, "answer_id": 55524365, "question_id": 55522847, "link": "https://stackoverflow.com/questions/55522847/implementing-haskells-take-function-using-foldl/55524365#55524365", "title": "Implementing Haskell&#39;s `take` function using `foldl`", "body": "<p>You are not too far. Here are a pair of fixes. </p>\n\n<p>First, note that <code>func</code> is passed the accumulator first (i.e. a list of <code>a</code>, in your case) and then the list element (an <code>a</code>). So, you need to swap the order of the arguments of <code>func</code>.</p>\n\n<p>Then, if we want to mimic <code>take</code>, we need to add <code>x</code> when the <code>length y</code> is <em>less</em> than <code>n</code>, not greater!</p>\n\n<p>So we get</p>\n\n<pre><code>myFunc :: Int -&gt; [a] -&gt; [a]\nmyFunc n list = foldl func [] list\n    where \n    func y x | (length y) &lt; n = x : y \n             | otherwise      = y\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>&gt; myFunc 5 [1..10]\n[5,4,3,2,1]\n</code></pre>\n\n<p>As you can see, this is reversing the string. This is because we add <code>x</code> at the front (<code>x:y</code>) instead of at the back (<code>y++[x]</code>). Or, alternatively, one could use <code>reverse (foldl ....)</code> to fix the order at the end.</p>\n\n<p>Also, since <code>foldl</code> always scans the whole input list, <code>myFunc 3 [1..1000000000]</code> will take a lot of time, and <code>myFunc 3 [1..]</code> will fail to terminate. Using <code>foldr</code> would be much better.</p>\n\n<p><code>drop</code> is more tricky to do. I don't think you can easily do that without some post-processing like <code>myFunc n xs = fst (foldl ...)</code> or making <code>foldl</code> return a function which you immediately call (which is also a kind of post-processing).</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554419988, "post_id": 55526100, "comment_id": 97756495, "body": "I guess our views on this are diametrically opposed. for me, the tail absolutely <i>must</i> be shared. My feeling is that <i>this</i> is &quot;cheating&quot;. :) I&#39;m retracing a <i>finite</i> prefix; you&#39;re rebuilding a potentially <i>infinite</i> suffix. Do several such drops in a row and you&#39;re inching ever closer to a quadratic behavior. I dislike it strongly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554420217, "post_id": 55526100, "comment_id": 97756566, "body": "It&#39;s horrible either way. But one way helps the OP understand how folds can be used to structure functions and what their limits are, while the other is just an ugly kluge with nothing to say for itself."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554449399, "post_id": 55526100, "comment_id": 97764032, "body": "well, I like it; I&#39;ve added more explanations to my answer. Essentially, it <i>is</i> a paramorphism; end of story. YMMV."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554585734, "post_id": 55526100, "comment_id": 97808318, "body": "@WillNess, this is clearly a matter of didactic taste. I hope we can agree to disagree."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1554622917, "post_id": 55526100, "comment_id": 97814119, "body": "Of course, exactly what I meant (by YMMV). the dv is of course not mine, too; I checked the times -- all three votes (on the three answers) where given within a minute or so. someone felt strong agreement with my <i>take</i> on this for some reason. :) (I&#39;m glad to have this chance to clear this out)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1554652440, "post_id": 55526100, "comment_id": 97821615, "body": "@WillNess, nice edit. That captures a lot of the good from our argument."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1554624703, "last_edit_date": 1554624703, "creation_date": 1554419060, "answer_id": 55526100, "question_id": 55522847, "link": "https://stackoverflow.com/questions/55522847/implementing-haskells-take-function-using-foldl/55526100#55526100", "title": "Implementing Haskell&#39;s `take` function using `foldl`", "body": "<p>Will Ness showed a nice way to implement <em><code>take</code></em> with <code>foldr</code>. The least repulsive way to implement <em><code>drop</code></em> with <code>foldr</code> is this:</p>\n\n<pre><code>drop n0 xs0 = foldr go stop xs0 n0\n  where\n    stop _ = []\n    go x r n\n      | n &lt;= 0 = x : r 0\n      | otherwise = r (n - 1)\n</code></pre>\n\n<p>Take the efficiency loss and rebuild the whole list if you have no choice! Better to drive a nail in with a screwdriver than drive a screw in with a hammer. </p>\n\n<p>Both ways are horrible. But this one helps you understand how folds can be used to structure functions and what their <em>limits</em> are. </p>\n\n<p>Folds just aren't the right tools for implementing <code>drop</code>; a <em>paramorphism</em> is the right tool.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554811540, "post_id": 55584633, "comment_id": 97881418, "body": "this reminds me of Lisp macros: it builds a function first -- because it is a <i>left</i> fold -- then applies it. Usually it is a right fold that is applied to extra arguments, I think. Interesting."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1554798861, "last_edit_date": 1554798861, "creation_date": 1554780114, "answer_id": 55584633, "question_id": 55522847, "link": "https://stackoverflow.com/questions/55522847/implementing-haskells-take-function-using-foldl/55584633#55584633", "title": "Implementing Haskell&#39;s `take` function using `foldl`", "body": "<p>I note that you never specified the fold had to be over the supplied list.  So, one approach that meets the <em>letter</em> of your question, though probably not the spirit, is:</p>\n\n<pre><code>sillytake :: Int -&gt; [a] -&gt; [a]\nsillytake n xs = foldl go (const []) [1..n] xs\n  where go f _ (x:xs) = x : f xs\n        go _ _ []     = []\n\nsillydrop :: Int -&gt; [a] -&gt; [a]\nsillydrop n xs = foldl go id [1..n] xs\n  where go f _ (_:xs) = f xs\n        go _ _ []     = []\n</code></pre>\n\n<p>These each use left folds, but over the list of numbers <code>[1..n]</code> -- the numbers themselves are ignored, and the list is just used for its length to build a custom <code>take n</code> or <code>drop n</code> function for the given <code>n</code>.  This function is then applied to the original supplied list <code>xs</code>.</p>\n\n<p>These versions work fine on infinite lists:</p>\n\n<pre><code>&gt; sillytake 5 $ sillydrop 5 $ [1..]\n[6,7,8,9,10]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5900247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f64fbc3c3aad02eb989c31d4da2465?s=128&d=identicon&r=PG&f=1", "display_name": "amir ahmed", "link": "https://stackoverflow.com/users/5900247/amir-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1554798861, "creation_date": 1554402883, "last_edit_date": 1554625250, "question_id": 55522847, "link": "https://stackoverflow.com/questions/55522847/implementing-haskells-take-function-using-foldl", "title": "Implementing Haskell&#39;s `take` function using `foldl`", "body": "<p>Implementing Haskell's <code>take</code> and <code>drop</code> functions using <code>foldl</code>.</p>\n\n<p>Any suggestions on how to implement take and drop functions using <code>foldl</code> ??</p>\n\n<pre><code>take x ls = foldl ???\n\ndrop x ls = foldl ???\n</code></pre>\n\n<p>i've tried these but it's showing errors:</p>\n\n<pre><code>myFunc :: Int -&gt; [a] -&gt; [a]\nmyFunc n list = foldl func [] list\n    where \n    func x y | (length y) &gt; n = x : y \n             | otherwise      = y\n</code></pre>\n\n<p>ERROR PRODUCED :</p>\n\n<pre><code>*** Expression : foldl func [] list\n*** Term : func\n*** Type : a -&gt; [a] -&gt; [a]\n*** Does not match : [a] -&gt; [a] -&gt; [a]\n*** Because : unification would give infinite type\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 1, "last_activity_date": 1554399541, "creation_date": 1554399541, "answer_id": 55521979, "question_id": 55521575, "link": "https://stackoverflow.com/questions/55521575/how-to-compose-errors-using-data-validation/55521979#55521979", "title": "How to compose errors using data.validation", "body": "<p>I'll use <code>Either EmailError PasswordError</code> as the combined type.  You could instead make a custom sum type.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mkCreds :: Text -&gt; Text -&gt; Validation [Either EmailError PasswordError] Creds\nmkCreds e p = Creds &lt;$&gt; first Left (mkEmail e) &lt;*&gt; first Right (mkPassword p)\n</code></pre>\n\n<p>This does three things:</p>\n\n<ul>\n<li>use <code>mkEmail</code> and <code>mkPassword</code> to validate each part</li>\n<li>lift the errors into the <code>Either</code> error type, with <code>first Left</code> &amp; <code>first Right</code></li>\n<li>combine either all the errors, or all the parts of Creds, with <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 2607335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/382f32de63fd5b97f0dae460ffa61c3d?s=128&d=identicon&r=PG", "display_name": "Twig", "link": "https://stackoverflow.com/users/2607335/twig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554399541, "creation_date": 1554397906, "question_id": 55521575, "link": "https://stackoverflow.com/questions/55521575/how-to-compose-errors-using-data-validation", "title": "How to compose errors using data.validation", "body": "<p>I'm using the wonderful Data.Validation package for my validations. However, I'm not able to compose them properly for complex types. </p>\n\n<p>I have created types for email and password Email and Password respectively. I have created validations and errors that can accumulate using Data.Validation package. I have made a new type called data Creds = Email Password. Now, I'm not able to accumulate errors from both Email and Password</p>\n\n<p>`</p>\n\n<pre><code>``\n{-# LANGUAGE OverloadedStrings   #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE DeriveGeneric       #-}\n\nmodule ErrorComposition\n  ()\nwhere\n\n\nimport           Data.Text                     as T\nimport           Data.Validation\nimport           Control.Lens\n\n\n------------------------------------\n-- validations and errors for Email\n------------------------------------\ndata Email =  Email\n  {\n    email :: Text\n  } deriving (Show)\n\ndata EmailError = EmailNoDotError | EmailNoPeriodError\n  deriving (Show)\n\n\nnoDot :: Email -&gt; Validation [EmailError] ()\nnoDot x = if \".\" `isInfixOf` (email x)\n  then _Success # ()\n  else _Failure # [EmailNoDotError]\n\nnoPeriod :: Email -&gt; Validation [EmailError] ()\nnoPeriod x = if \"@\" `isInfixOf` (email x)\n  then _Success # ()\n  else _Failure # [EmailNoPeriodError]\n\nvalidateEmail :: Email -&gt; Validation [EmailError] ()\nvalidateEmail e = noDot e &lt;* noPeriod e\n\nmkEmail :: Text -&gt; Validation [EmailError] Email\nmkEmail e = pure (Email e) &lt;* validateEmail (Email e)\n\n\n\n-----------------------------------------------------------\n-- validations for password and errors\n-- --------------------------------------------------------\n\ndata Password = Password\n  {\n    password :: Text\n  } deriving Show\n\ndata PasswordError = MinLengthPasswordError | NotStrongPasswordError\n deriving (Show)\n\nminLength :: Int -&gt; Password -&gt; Validation [PasswordError] ()\nminLength n x | T.length (password x) &gt;= n = _Success # ()\n              | otherwise                  = _Failure # [MinLengthPasswordError]\n\nnotStrong :: Password -&gt; Validation [PasswordError] ()\nnotStrong x = if \"strong\" `isInfixOf` (password x)\n  then _Success # ()\n  else _Failure # [NotStrongPasswordError]\n\nvalidatePassword :: Password -&gt; Validation [PasswordError] ()\nvalidatePassword p = minLength 7 p &lt;* notStrong p\n\nmkPassword :: Text -&gt; Validation [PasswordError] Password\nmkPassword p = pure (Password p) &lt;* validatePassword (Password p)\n\n\n\n--------------------------------------------------------------------\n-- Domain Modelling for an Creds type\n-- The expectation is errors from email and password should be combined\n-- ----------------------------------------------------------------\n\ndata Creds = Creds\n  {\n    credsEmail :: Email\n  , credsPassword:: Password\n  } deriving (Show)\n\ndata CredsError = EmailError | PasswordError\n deriving (Show)\n\nvalidateCreds :: Creds -&gt; Validation [CredsError] ()\n--validateCreds (Creds e p) = validateEmail e &lt;* validatePassword p\nvalidateCreds = undefined\n\nmkCreds :: Email -&gt; Password -&gt; Validation [CredsError] Creds\nmkCreds e p = pure (Creds e p) &lt;* validateCreds (Creds e p)\n</code></pre>\n\n<pre><code>\nErrorComposition&gt; let e1= mkEmail \"bob\"\n*ErrorComposition&gt; show e1\n\"Failure [EmailNoDotError,EmailNoPeriodError]\"\n*ErrorComposition&gt; let p1 = mkPassword \"he\"\n*ErrorComposition&gt; show p1\n\"Failure [MinLengthPasswordError,NotStrongPasswordError]\"\n*ErrorComposition&gt; let c1 = mkCreds (Email \"bob\") (Password \"he\")\n\n\n\nWhat Am I expecting? \nFailure [EmailNoDotError, EmailNoPeriodError, MinLengthPasswordError,NotStrongPasswordError] \n\n1. Is it possible to get the above result?\n2. Even if the above result is not possible because the error types differ, atleast, I'm looking for a way to get the following:\n  Failure [\"EmailNoDotError\", \"EmailNoPeriodError\", \n           \"MinLengthPasswordError,\"NotStrongPasswordError\"] \n3. Essentially could you please help me in fixing the validateCreds function above in the code?\n\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 2, "creation_date": 1554404025, "post_id": 55518966, "comment_id": 97750412, "body": "There is a recommended action right near the end. It looks like it would address the issue. What happened when you implemented that recommendation?"}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1554413124, "post_id": 55518966, "comment_id": 97754407, "body": "That actually worked. Thanks!"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1554396439, "creation_date": 1554389398, "last_edit_date": 1554396439, "question_id": 55518966, "link": "https://stackoverflow.com/questions/55518966/stack-plan-construction-failed", "title": "stack &quot;Plan construction failed.&quot;", "body": "<p>I'm trying to build a local hoogle server with the following command on a project, which is using <code>lts-11.1</code> as the resolver in <code>stack.yaml</code></p>\n\n<pre><code>stack hoogle -- server --local --port=8080\n</code></pre>\n\n<p>It used to work, but now it fails with this error:</p>\n\n<pre><code>\u25b8 stack hoogle -- server --local --port=8080\nHoogle isn't installed. Automatically installing (use --no-setup to disable) ...\nMinimum version is hoogle-5.0. Found acceptable hoogle-5.0.17.6 in your index, installing it.\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for hoogle-5.0.17.6:\n    haskell-src-exts-1.20.3 from stack configuration does not match &gt;=1.21 &amp;&amp; &lt;1.22  (latest matching version is 1.21.0)\nneeded since hoogle is a build target.\n\nSome different approaches to resolving this:\n\n  * Set 'allow-newer: true' in /Users/leo/.stack/config.yaml to ignore all version constraints and build anyway.\n\n  * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build configuration. This can be convenient when dealing with many complicated constraint\n    errors, but results may be unpredictable.\n\n  * Recommended action: try adding the following to your extra-deps in /Users/leo/.stack/global-project/stack.yaml:\n\nhaskell-src-exts-1.21.0@sha256:02421cacaa48c055551b8e5796efc543301b7ea9527a38e1385403d2b85512fb\n\nPlan construction failed.\n</code></pre>\n\n<p>The <code>/Users/leo/.stack/global-project/stack.yaml</code> has <code>resolver: lts-13.15</code> in it. </p>\n\n<p>When I was working on that project a long while ago, I was using <code>ghc8.2.2</code> with <code>lts-11.1</code>. I recently reinstalled everything on my laptop, including <code>haskell-stack</code>, now my <code>stack --version</code> is <code>1.9.3 x86_64</code>, and hoogle can't be built. Not sure if it's because of my stack version or something else.</p>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["function", "haskell", "url-rewriting", "let"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1554378461, "post_id": 55514235, "comment_id": 97735014, "body": "You have a number of indentation errors. Unless there is a reason to indent, code has to be indented by the same amount as the previous line. The second line of a multi-line <code>do</code> block has to be indented to match the text <i>following</i> the <code>do</code> keyword."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1554398808, "post_id": 55514235, "comment_id": 97747905, "body": "After fixing indentation errors and adding placeholders for all undefined variables, the final code snippet you posted compiles fine. <a href=\"https://gist.github.com/luqui/e3cc0f8ac31cf6275415035a429c1720\" rel=\"nofollow noreferrer\">Here are my changes</a>.  An <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> would be very helpful."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554380626, "post_id": 55515236, "comment_id": 97736439, "body": "Hej thanks for answering, but it is not that. That is just a mistake of copying the code into stackoverflow"}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 2, "last_activity_date": 1554378412, "creation_date": 1554378412, "answer_id": 55515236, "question_id": 55514235, "link": "https://stackoverflow.com/questions/55514235/how-to-rewrite-in-haskell-a-main-io-to-two-functions-consisting-of-one-mai/55515236#55515236", "title": "How to rewrite in Haskell a main :: IO () to two functions consisting of one main :: IO()", "body": "<p>You've done everything correctly; there's just a small problem with indentation. Try dedenting the last line of <code>main</code>, like this:</p>\n\n<pre><code> main :: IO ()  \n main = do\n      -- ... stuff ...\n      eindstand &lt;- {-maakNieuwSpel (digitToInt aantalTegenspelers) firstName-} spelSpelen rijTegels spelers 0\n      putStrLn (\"Het spel is afgelopen. De eindstand is \" ++ eindstand)\n</code></pre>\n\n<p>See how in my version, <code>eindstand</code> and <code>putStrLn</code> have the same number of spaces before them? In your version, <code>putStrLn</code> has an extra space before it, causing GHC to think that it is a parameter to <code>spelSpelen</code>. It should start to work if you remove that extra space.</p>\n"}, {"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554385134, "post_id": 55516185, "comment_id": 97739474, "body": "This is a little beside-the-point, but part of me wonders if it wouldn&#39;t be easier to read the code under alpha-renaming to single-character variable names? Something about the fact that the Dutch is just <i>somewhat</i> intelligible makes it more difficult to parse."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554390851, "post_id": 55516185, "comment_id": 97743484, "body": "@dfeuer: It sounded to me like this code was only broken by copy-pasting it into Stack Overflow, but you&#39;re right."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 1, "last_activity_date": 1554381486, "creation_date": 1554381486, "answer_id": 55516185, "question_id": 55514235, "link": "https://stackoverflow.com/questions/55514235/how-to-rewrite-in-haskell-a-main-io-to-two-functions-consisting-of-one-mai/55516185#55516185", "title": "How to rewrite in Haskell a main :: IO () to two functions consisting of one main :: IO()", "body": "<p>This Q&amp;A is probably better suited for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>.</p>\n\n<p>Besides basic indentation problems, wanting to split your <code>main</code> in multiple parts is a good idea.</p>\n\n<p>Additionally you will want to try and make some of those parts non-<code>IO</code>. For example, it should be possible to address <em>all</em> game logic without touching any <code>IO</code>. If you don't have any <code>getLine</code> or <code>putStrLn</code> calls in your game logic, it is easier to test, and there are few sources of errors, since input validation can be separated out into its own part.</p>\n\n<p>As for how the game logic might look like without <code>IO</code> embedded into it, I can't say, because the game logic is written in, what, Dutch? If you translate this code to English, or resubmit a translated copy of the code to codereview.stackexchange.com, someone may be able to suggest how to do this.</p>\n"}], "owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1554381486, "creation_date": 1554375480, "last_edit_date": 1554380724, "question_id": 55514235, "link": "https://stackoverflow.com/questions/55514235/how-to-rewrite-in-haskell-a-main-io-to-two-functions-consisting-of-one-mai", "title": "How to rewrite in Haskell a main :: IO () to two functions consisting of one main :: IO()", "body": "<p>I want to make this a simpler main function by splitting some stuff. But when I add a new function maakNieuwSpel I get errors</p>\n\n<pre><code> maakNieuwSpel :: Int -&gt; String -&gt; IO ()\n maakNieuwSpel aantal firstName= do let rijTegels = volleRijTegels\n                                    let spelers = deSpelers aantal firstName \n                                    w &lt;- spelSpelen rijTegels spelers 0\n                                    putStrLn (w ++ \"dit is waar ik mee bezig was in functie nieuwSpel\")\n</code></pre>\n\n<p>And when I called it in main with </p>\n\n<pre><code>    eindstand &lt;- maakNieuwSpel (digitToInt aantalTegenspelers) firstName\n</code></pre>\n\n<p>it gave errors.</p>\n\n<p>ANOTHER thing I tried and want to achieve is to rewrite the let functions in main by putting a where function. \nSomething like this was what I thought</p>\n\n<pre><code>    eindstand &lt;- spelSpelen rijTegels spelers 0 \n            where rijTegels = volleRijTegels\n                   spelers = deSpelers (digitToInt aantalTegenspelers) firstName  \n</code></pre>\n\n<p>But then it says \"  parse error on input \u2018=\u2019 Perhaps you need a 'let' in a 'do' block?\"</p>\n\n<p>This is part of my code. I guess it will you give you enough insight of what I am doing.</p>\n\n<pre><code> data Dobbelsteen = Steen Char -- now its values can be specified\n                deriving (Show, Eq)  \n data Tegel = Teg Int Int \n          deriving (Show, Eq) \n data Speler = Spel Tactiek Spelersstapel String\n type Tactiek = ([Dobbelsteen]  -&gt; [Dobbelsteen] -&gt; IO [Dobbelsteen], [Dobbelsteen]  -&gt; Int -&gt; IO Bool)\n  type Spelersstapel = [Tegel]\n\n\n\n main :: IO ()  \n main = do putStrLn (\"Hoi! Je speelt regenwormen. Wat is je naam?\")\n           firstName &lt;- getLine  \n           putStrLn (\"Beste \"++ firstName ++ \", je speelt tegen twee computertegenstanders. Ze heten Lap en Top.\")\n           putStr \"Tegen hoeveel computertegenstanders wil u spelen? (Dit spel is voor 2 tot 8 personen) \"\n           aantalTegenspelers &lt;- getChar\n           let rijTegels = volleRijTegels\n           let spelers = deSpelers (digitToInt aantalTegenspelers) firstName \n           eindstand &lt;- {-maakNieuwSpel (digitToInt aantalTegenspelers) firstName-} spelSpelen rijTegels spelers 0\n           putStrLn (\"Het spel is afgelopen. De eindstand is \" ++ eindstand)\n\n\nspelSpelen :: [Tegel]  -&gt; [Speler]  -&gt; Int -&gt; IO String -- de RijTegels, de spelers en degene die gaat spelen (int)\nspelSpelen []        spelers spelerNr = do return (show (bepaalEindStand spelers))\nspelSpelen rijTegels spelers spelerNr = do let Spel tactiek stapel naam = (spelers !! spelerNr)\n                                           putStrLn (\"Deze speler is nu aan de beurt: \" ++ naam)\n                                           score &lt;- beurt tactiek (\\x -&gt; elem x (bepaalGeldigeScore spelers naam rijTegels))\n                                           let rijTegelsNieuw = pakTegelAlsMogelijk rijTegels score\n                                           let rijTegelsTeruggelegdNieuw = legTegelTerug spelers rijTegels score\n                                           let spelersAfgepaktNieuw = pakTegelAf spelers score\n                                           let spelersNieuw = voegTegelToeAanSpelerVanStapel spelersAfgepaktNieuw score naam rijTegelsTeruggelegdNieuw\n                                           putStrLn (\"De beurt van speler \" ++ naam ++ \" is nu afgelopen.\")\n                                           printStatus rijTegelsNieuw spelersNieuw\n                                           spelSpelen rijTegelsNieuw spelersNieuw ( (spelerNr+1) `mod` 3)  \n\n\n volleRijTegels :: [Tegel] -- deze functie maakt de rij tegels van 21 tot 36.\n volleRijTegels = zipWith Teg [21..36] (replicate 4 1 ++ replicate 4 2 ++ replicate 4 3 ++ replicate 4 4)\n\n deSpelers :: Int -&gt; String -&gt; [Speler]\n deSpelers aantalTegenspelers firstName = do [Spel computerTactiek [] firstName, Spel computerTactiek [] \"Lap\", Spel computerTactiek [] \"Top\"]\n</code></pre>\n"}, {"tags": ["haskell", "operators", "naming-conventions", "applicative", "category-theory"], "comments": [{"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 3, "creation_date": 1554373384, "post_id": 55513329, "comment_id": 97731790, "body": "I don&#39;t think there is a link between <code>*</code> and <code>&lt;*&gt;</code>, I guess <code>&lt;*&gt;</code> was chosen for its relation to <code>&lt;$&gt;</code>, but I&#39;d say the <code>*</code> used here is quite arbitrary."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1554373385, "post_id": 55513329, "comment_id": 97731793, "body": "I don&#39;t think the <code>*</code> in <code>&lt;*&gt;</code> is meaningful. Function names <code>&lt;$&gt;</code> and <code>&lt;&amp;&gt;</code> are clearly taken from <code>$</code> and <code>&amp;</code>. However, <code>&lt;*&gt;</code> is incidental. I think the <code>&lt;</code> and <code>&gt;</code> were chosen so that the idiom <code>f &lt;$&gt; x &lt;*&gt; y &lt;*&gt; z</code> looks nice, but the <code>*</code> looks arbitrary there."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1554375196, "post_id": 55513329, "comment_id": 97732898, "body": "@chi do you have historical notes on that? I don&#39;t know for sure whether this was deliberate, but to me the reference to the products in monoidal functors is striking and seems unlikely to be a coincidence."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1554375765, "post_id": 55513329, "comment_id": 97733248, "body": "@leftaroundabout Mine is only a guess, I have nothing to back me up. I don&#39;t know if I agree with you on this point: I would if we had <code>(&lt;*&gt;) :: Applicative f =&gt; f a -&gt; f b -&gt; f (a,b)</code>. Just because this can be defined in terms of <code>&lt;*&gt;</code> is not enough to fully convince me. (But you might be right!)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1554377107, "post_id": 55513329, "comment_id": 97734081, "body": "@chi see edit to my answer: it <b>is</b> derived from products in the original McBride and Paterson paper."}], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1554378584, "post_id": 55514013, "comment_id": 97735107, "body": "great ! Thank you !"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 17, "last_activity_date": 1554377440, "last_edit_date": 1554377440, "creation_date": 1554374879, "answer_id": 55514013, "question_id": 55513329, "link": "https://stackoverflow.com/questions/55513329/does-in-have-a-special-meaning/55514013#55514013", "title": "Does * in (&lt;*&gt;) have a special meaning?", "body": "<p>This is deliberate. <code>&lt;*&gt;</code> has characteristics of a <a href=\"https://en.wikipedia.org/wiki/Tensor_product\" rel=\"noreferrer\">tensor product</a>. This is best seen in the list monad:</p>\n\n<pre><code>Prelude&gt; (,) &lt;$&gt; ['a'..'e'] &lt;*&gt; [0..4]\n[('a',0),('a',1),('a',2),('a',3),('a',4)\n,('b',0),('b',1),('b',2),('b',3),('b',4)\n,('c',0),('c',1),('c',2),('c',3),('c',4)\n,('d',0),('d',1),('d',2),('d',3),('d',4)\n,('e',0),('e',1),('e',2),('e',3),('e',4)]\n</code></pre>\n\n<p>More generally, applicative functors (aka <a href=\"https://en.wikipedia.org/wiki/Monoidal_functor\" rel=\"noreferrer\">monoidal functors</a>) map from the product of two objects (i.e. product type, aka tuple or via currying <em>two function arguments</em>) behind the functor to the functor-result of a product before the functor. So it's a pretty product-ey operation indeed.</p>\n\n<p><em>\u03c6</em><sub><em>A</em>,<em>B</em></sub>: <em>F A</em> \u2219 <em>F B</em> &rarr; <em>F</em>(<em>A</em>\u2297<em>B</em>)</p>\n\n<p>...in Haskell,</p>\n\n<pre><code>\u03c6 :: (f a, f b) -&gt; f (a,b)\n\u03c6 = uncurry (liftA2 (,))\n-- recall `liftA2 f x y = f &lt;$&gt; x &lt;*&gt; y`\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\ntype x \u2297 y = (x,y)\n\n\u03c6 :: f a \u2297 f b -&gt; f (a\u2297b)\n</code></pre>\n\n<p>To see the historical side, look into <a href=\"http://www.staff.city.ac.uk/~ross/papers/Applicative.html\" rel=\"noreferrer\">McBride and Paterson 2008</a> (doi:<a href=\"https://doi.org/10.1017/S0956796807006326\" rel=\"noreferrer\">10.1017/S0956796807006326</a>), the paper that first introduced the <code>Applicative</code> typeclass. They note</p>\n\n<blockquote>\n  <p>The Applicative class features the asymmetrical operation <code>\u229b</code>, but there is an equivalent symmetrical definition.<pre><code>class Functor f -> Monoidal f where\n    unit :: f ()\n    (\u2605) :: f a -> f b -> f (a,b)</code></pre></p>\n  \n  <p>These operations are clearly definable for any Applicative functor...</p>\n</blockquote>\n\n<p>So, the <code>&lt;*&gt;</code> is an ASCII rendition of McBride and Paterson's <code>\u229b</code> operator, which in turn is an \u201capplicativised\u201d form of <code>\u2605</code> which the category theorists call, in uncurried form, \u03c6.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 5, "accepted_answer_id": 55514013, "answer_count": 1, "score": 11, "last_activity_date": 1554449616, "creation_date": 1554372671, "last_edit_date": 1554449616, "question_id": 55513329, "link": "https://stackoverflow.com/questions/55513329/does-in-have-a-special-meaning", "title": "Does * in (&lt;*&gt;) have a special meaning?", "body": "<p>Trying to expand my understanding about symbols in Haskell :</p>\n\n<ul>\n<li><code>($)</code> : Function Application operator (Allow you to apply arguments over a function)</li>\n<li><code>(&amp;)</code> : flipped version of Function Application Operator? <code>(&amp;) = flip ($)</code></li>\n<li><code>(&lt;&gt;)</code> : associative operator (You'll find it in Semigroups and Monoids)</li>\n<li><code>(&lt;$&gt;)</code> : function application <code>($)</code> lifted over a Functor structure </li>\n<li><code>(&lt;&amp;&gt;)</code> : flipped functor map</li>\n</ul>\n\n<p>Can we make a link between <code>(*)</code> and <code>(&lt;*&gt;)</code>?</p>\n\n<p>I don't understand the meaning of <code>*</code> actually...</p>\n"}, {"tags": ["haskell", "benchmarking", "haskell-stack"], "comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1554367992, "post_id": 55508536, "comment_id": 97728462, "body": "Just curious, <code>base &gt;=4.10 &amp;&amp; &lt;10</code>, does the <code>&amp;&amp; &lt;10</code> really add anything here?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1554368345, "post_id": 55508536, "comment_id": 97728670, "body": "@SimonShine I think it is to avoid warnings from <code>cabal</code> before uploading a package to Hackage."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 3, "last_activity_date": 1554368369, "last_edit_date": 1554368369, "creation_date": 1554355994, "answer_id": 55508537, "question_id": 55508536, "link": "https://stackoverflow.com/questions/55508536/stack-run-single-benchmark/55508537#55508537", "title": "Stack run single benchmark", "body": "<p>You need to do something like this to just run a single benchmark:</p>\n\n<pre><code>stack bench package-name:my-guage-bench\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 3, "last_activity_date": 1554377243, "creation_date": 1554377243, "answer_id": 55514821, "question_id": 55508536, "link": "https://stackoverflow.com/questions/55508536/stack-run-single-benchmark/55514821#55514821", "title": "Stack run single benchmark", "body": "<p>This applies to all targets in <code>stack</code>, be it tests, benchmarks or executables.</p>\n\n<p>There is a cool little command in stack that can help you list all available targets, without resorting to dig through <code>my-package.cabal</code> or <code>package.yaml</code> files. It is especially useful for multi-package projects and will work for all packages listed in <code>packages:</code> field in <code>stack.yaml</code>:</p>\n\n<pre><code>$ stack ide targets\nmy-package:lib\nmy-package:test:doctests\nmy-package:test:tests\nmy-package:bench:weight\nmy-package:bench:gauge\nanother-package:lib\nanother-package:exe:my-cool-executable\nanother-package:test:doctests\nanother-package:test:tests\nanother-package:bench:weight\nanother-package:bench:criterion\n</code></pre>\n\n<p>Now that we know the list we can invoke specific benchmarks </p>\n\n<pre><code>$ stack bench my-package:bench:gauge another-package:bench:criterion\n</code></pre>\n"}], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 55514821, "answer_count": 2, "score": 2, "last_activity_date": 1554377243, "creation_date": 1554355994, "question_id": 55508536, "link": "https://stackoverflow.com/questions/55508536/stack-run-single-benchmark", "title": "Stack run single benchmark", "body": "<p>I have multiple benchmarks defined in my cabal file:</p>\n\n<pre><code>benchmark my-gauge-bench\n  type: exitcode-stdio-1.0\n  main-is: Main.hs\n  hs-source-dirs:\n      bench/gauge\n  ghc-options: -Wall -Wcompat -Wincomplete-record-updates -Wincomplete-uni-patterns -Wredundant-constraints -Wall -threaded -rtsopts -with-rtsopts=-N\n  build-depends:\n      QuickCheck\n    , base &gt;=4.10 &amp;&amp; &lt;10\n    , bytestring\n    , gauge\n  default-language: Haskell2010\n\nbenchmark my-weigh-bench\n  type: exitcode-stdio-1.0\n  main-is: Main.hs\n  other-modules:\n      Paths_pkg_core_gen\n  hs-source-dirs:\n      bench/weigh\n  ghc-options: -Wall -Wcompat -Wincomplete-record-updates -Wincomplete-uni-patterns -Wredundant-constraints -Wall\n  build-depends:\n      QuickCheck\n    , base &gt;=4.10 &amp;&amp; &lt;10\n    , bytestring\n    , weigh\n</code></pre>\n\n<p>How can I run only single benchmark (like <code>my-guage-bench</code>) using Stack ?</p>\n"}, {"tags": ["haskell", "functional-programming", "lazy-evaluation"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1554383243, "post_id": 55508010, "comment_id": 97738160, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/2026912/how-to-get-every-nth-element-of-an-infinite-list-in-haskell\" title=\"how to get every nth element of an infinite list in haskell\">stackoverflow.com/questions/2026912/&hellip;</a>"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1554821670, "post_id": 55508010, "comment_id": 97887902, "body": "<code>tnn s n  = [ c| (i,c)&lt;- zip [1..] s, mod i n==0]</code> ;; <code>tnn &quot;Testing&quot; 2</code> &gt;&gt;&gt; &quot;etn&quot; ;; <code>tnn &quot;Testing&quot; 3</code> &gt;&gt;&gt; &quot;sn&quot; ;; <code>tnn &quot;Testing&quot; 1</code> &gt;&gt;&gt; &quot;Testing&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "edited": false, "score": 0, "creation_date": 1554354566, "post_id": 55508174, "comment_id": 97721790, "body": "It&#39;s funny, out of map, filter, and folder ... folder (and all of its types) was the one that I thought for certain I was not going to need to use. Thank you for thoroughly explaining the process though, this has helped me a lot"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "edited": false, "score": 0, "creation_date": 1554354904, "post_id": 55508174, "comment_id": 97721883, "body": "@WilliamJones It&#39;s definitely not necessary. <code>foldr</code> would be a bit of a strange choice (though I don&#39;t doubt it&#39;s possible), <code>unfoldr</code> is quite different (sort-of an inverse). You can straightforwardly do it by cycling / filtering eg. <code>printing s n = map fst . filter snd $ zip s (cycle (replicate (n-1) False ++ [True]))</code> but as you can see it&#39;s not quite as slick (do try to grok that definition too though). Glad to help."}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 3, "last_activity_date": 1554354075, "creation_date": 1554354075, "answer_id": 55508174, "question_id": 55508010, "link": "https://stackoverflow.com/questions/55508010/removing-specific-elements-from-lists-in-haskell/55508174#55508174", "title": "Removing specific elements from lists in Haskell", "body": "<p>I'll try to describe my thought process so you can follow. This function fits the pattern of creating an output list (here a string) from an input seed (here a string) by repeated function application (here dropping some elements). Thus I choose an implementation with <code>Data.List.unfoldr</code>.</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>Okay so, I need to turn the seed <code>b</code> into (<code>Maybe</code>) an output <code>a</code> and the rest of the string. I'll call this subfunction <code>f</code> and pass it into <code>unfoldr</code>.</p>\n\n<pre><code>printing s n = unfoldr f s\n  where f b = case drop n b of\n                [] -&gt; Nothing\n                (x:xs) -&gt; Just (x,xs)\n</code></pre>\n\n<p>It turns out that attempting to take the head off the front of the list and returning a <code>Maybe</code> is also a common pattern. It's <code>Data.List.uncons</code>, so</p>\n\n<pre><code>printing s n = unfoldr (uncons . drop n) s\n</code></pre>\n\n<p>Very smooth! So I test it out, and the output is wrong! Your specified output actually eg. for <code>n=2</code> selects every 2nd character, ie. drops <code>(n-1)</code> characters.</p>\n\n<pre><code>printing s n = unfoldr (uncons . drop (n-1)) s\n</code></pre>\n\n<p>I test it again and it matches the desired output. Phew!</p>\n"}, {"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554371802, "post_id": 55509058, "comment_id": 97730813, "body": "I considered making the same point (hah!) about argument order but couldn&#39;t express it convincingly. I may as well say, <code>printing &quot;testing&quot;</code> is also a function, from <code>n</code> to every <code>n</code>th character of &quot;testing&quot;, so why is <code>printing n xs</code> any more natural of a formulation? But I do believe it, deeply!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554374025, "post_id": 55509058, "comment_id": 97732190, "body": "I&#39;d be tempted to avoid the <code>mod</code> using instead this variant: <code>[s | (i, s) &lt;- zip (cycle [1 .. j]) ls, i == j]</code>"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554374888, "post_id": 55509058, "comment_id": 97732697, "body": "@A-Tayler I would say it is more likely to happen to users of the <code>printing</code> function. But both are fine and we always have <code>flip</code> so it is not much of a big deal."}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 2, "last_activity_date": 1554382966, "last_edit_date": 1554382966, "creation_date": 1554358588, "answer_id": 55509058, "question_id": 55508010, "link": "https://stackoverflow.com/questions/55508010/removing-specific-elements-from-lists-in-haskell/55509058#55509058", "title": "Removing specific elements from lists in Haskell", "body": "<p>To demonstrate the Haskell language some alternative solutions to the accepted answer.</p>\n\n<p>Using <strong>list comprehension</strong>:</p>\n\n<pre><code>printing :: Int -&gt; String -&gt; String\nprinting j ls = [s | (i, s) &lt;- zip [1 .. ] ls, mod i j == 0]\n</code></pre>\n\n<p>Using <strong>recursion</strong>:</p>\n\n<pre><code>printing' :: Int -&gt; String -&gt; String \nprinting' n ls \n    | null ls'    = []\n    | otherwise   = x : printing' n xs\n    where\n    ls'         = drop (n - 1) ls\n    (x : xs)    = ls' \n</code></pre>\n\n<p>In both cases I flipped the arguments so it is easier to do partial application: <code>printing 5</code> for example is a new function and will give each 5th character when applied to a string.</p>\n\n<p>Note with a minor modification they will work for any list</p>\n\n<pre><code>takeEvery :: Int -&gt; [a] -&gt; [a]\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5167770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4e4c09fed04ca2df1346c734e048e5?s=128&d=identicon&r=PG&f=1", "display_name": "William Jones", "link": "https://stackoverflow.com/users/5167770/william-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 55508174, "answer_count": 2, "score": 1, "last_activity_date": 1554382966, "creation_date": 1554353053, "question_id": 55508010, "link": "https://stackoverflow.com/questions/55508010/removing-specific-elements-from-lists-in-haskell", "title": "Removing specific elements from lists in Haskell", "body": "<p>I'm having a hard time getting Haskell and functional programming together in my head. What I am trying to do is manipulate a string so that I am printing/returning specific characters each time based on a number given. For example: </p>\n\n<pre><code>printing \"testing\" 2 = \"etn\"\n\nprinting \"testing\" 3 = \"sn\"\n</code></pre>\n\n<p>I've read a lot online, and from what I understand I can achieve this with filtering and cycling, but I cannot get/understand the syntax of this language to get a working program. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554350415, "post_id": 55507567, "comment_id": 97720702, "body": "Why <code>[[(String, String)]]</code> instead of <code>[(String, String)]</code>? You only seem to be treating the <code>(&quot;a&quot;, ...)</code> tuples separately; the <code>(&quot;b&quot;, ...)</code> and <code>(&quot;c&quot;, ...)</code> tuples are in the same list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1554350562, "post_id": 55507567, "comment_id": 97720725, "body": "If you just want a single list, use the <code>Applicative</code> instance for lists: <code>f xs ys = (,) &lt;$&gt; xs &lt;*&gt; ys</code>."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554351563, "post_id": 55507567, "comment_id": 97720969, "body": "your <code>f</code> is nearly correct, just <code>f [] _ = []</code> instead for the base case. (assuming you&#39;re actually trying to create a list of list of tuples instead of a list of tuples)"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1554357643, "post_id": 55507567, "comment_id": 97722894, "body": "<code>f = liftA2 (,)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1554361234, "post_id": 55507601, "comment_id": 97724582, "body": "Missing <code>|</code> in <code>[[(x, y) | y &lt;- ys] | x &lt;- xs]</code>"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 6, "last_activity_date": 1554374376, "last_edit_date": 1554374376, "creation_date": 1554350206, "answer_id": 55507601, "question_id": 55507567, "link": "https://stackoverflow.com/questions/55507567/all-elements-of-a-list-list/55507601#55507601", "title": "all elements of a List * List", "body": "<p>For explicit recursion, it's tough to beat:</p>\n\n<pre><code>f :: [a] -&gt; [a] -&gt; [[(a, a)]]\nf [] _       = []\nf _ []       = []\nf (x:xs) yss = go x yss : f xs yss\n  where\n  go _ []     = []\n  go x (y:ys) = (x, y): go x ys\n</code></pre>\n\n<p>However there's no reason to do this. This is the use case that list comprehensions were made for!</p>\n\n<pre><code>f xs ys = [[(x, y) | y &lt;- ys] | x &lt;- xs]\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11223128, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KQmH9yLBqD0/AAAAAAAAAAI/AAAAAAAAAM0/D5Acg1f8G4U/photo.jpg?sz=128", "display_name": "\uc800Nash", "link": "https://stackoverflow.com/users/11223128/%ec%a0%80nash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55507601, "answer_count": 1, "score": -1, "last_activity_date": 1554374376, "creation_date": 1554349941, "question_id": 55507567, "link": "https://stackoverflow.com/questions/55507567/all-elements-of-a-list-list", "title": "all elements of a List * List", "body": "<p>I'm trying to do a list of tuples with 2 lists of like this: </p>\n\n<pre><code>[\"a\", \"b\", \"c\"] [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>[(\"a\", \"a\"), (\"a\", \"b\"),(\"a\", \"c\")], [(\"b\", \"a\"), (\"b\", \"b\"), (\"b\", \"c\"), (\"c\", \"a\"), (\"c\", \"b\"), (\"a\", \"c\")]\n</code></pre>\n\n<p>so I'm trying this, but I don't know how can I make that work:</p>\n\n<pre><code>f [] [] = [[]]\nf (x:xs) y =\n         zip (repeat x) y: f xs y\n</code></pre>\n"}, {"tags": ["haskell", "lambda-calculus"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554348154, "post_id": 55507206, "comment_id": 97720217, "body": "It would help to see the precise construction you&#39;re working with. This is not my instinctive reaction on how to solve it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6943017"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554348431, "post_id": 55507206, "comment_id": 97720275, "body": "what do you mean by the precise construction?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1554348601, "post_id": 55507206, "comment_id": 97720315, "body": "Yes you could, though <code>isEven 1176845632190017</code> would take quite some time to rin."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6943017"}, "edited": false, "score": 0, "creation_date": 1554348701, "post_id": 55507206, "comment_id": 97720343, "body": "Actually, I think I would have to check the predecessor not the successor and then recurse to zero"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554349368, "post_id": 55507206, "comment_id": 97720482, "body": "@pythonhelpthrow Let&#39;s say you had some data type like <code>data Nat = Zero | Succ Nat</code>. Then <code>isEven :: Nat -&gt; Bool</code> would look like <code>isEven Zero = True; isEven (Succ n) = not (isEven n)</code>. But you have some other data type or encoding for <code>Nat</code>; that&#39;s what&#39;s missing from your question."}], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 2, "last_activity_date": 1554348670, "creation_date": 1554348670, "answer_id": 55507411, "question_id": 55507206, "link": "https://stackoverflow.com/questions/55507206/lambda-calculus-iseven-function-in-haskell/55507411#55507411", "title": "Lambda calculus isEven function in Haskell", "body": "<p>I assume that by \"lambda calculus\" you mean we're working with some Church-encoded numerals + booleans, and the \"Haskell\" part is mostly incidental to your question.</p>\n\n<pre><code>isEven = \\n -&gt; n flip True\nflip = \\x y z -&gt; x z y\nTrue = \\x y -&gt; x\nFalse = \\x y -&gt; y\n</code></pre>\n\n<p>This operates slightly differently to how you express it. </p>\n\n<p>Recall the Church numeral <code>n</code> means <code>n</code> iterated function applications. <code>flip</code> repeated an even # of times is <code>id</code>, thus <code>n flip == id</code> for even <code>n</code>, <code>n flip == flip</code> for odd <code>n</code>. Also, <code>flip True == False</code> and <code>flip False == True</code>. Thus the construction correctly encodes parity.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6943017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554348670, "creation_date": 1554346887, "question_id": 55507206, "link": "https://stackoverflow.com/questions/55507206/lambda-calculus-iseven-function-in-haskell", "title": "Lambda calculus isEven function in Haskell", "body": "<p>So I'm learning about lambda calculus in Haskell, and I'm trying to implement an isEven function that returns true if it's even and false otherwise. I know that 0 is even and then 1 is odd and then each alternating number is the alternative of the one before i.e. if one is odd then 2 is even then 3 is odd. Could I have the isEven function check if the input is 0 and if it's not then somehow check if it's successor is even or odd?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 0, "last_activity_date": 1554339848, "creation_date": 1554339848, "answer_id": 55506406, "question_id": 55506239, "link": "https://stackoverflow.com/questions/55506239/implementing-flatten/55506406#55506406", "title": "Implementing flatten", "body": "<p>You're really close, just one line change,</p>\n\n<p><code>x:r -&gt; flattenL r (concatenate x t)</code> </p>\n\n<p>because <code>flattenL</code> needs 2 arguments and <code>r</code> is not a function. </p>\n\n<p>Note that this does reverse the outer list order, eg.</p>\n\n<p><code>flatten [[1,2],[3,4,5]] = [3,4,5,1,2]</code></p>\n\n<p>To fix this, you could reverse the outer list before passing it to <code>flattenL</code></p>\n\n<p><code>flatten l = flattenL (reverse l) []</code></p>\n\n<p>or, change the other line to,</p>\n\n<p><code>x:r -&gt; concatenate x (flattenL r [])</code></p>\n\n<p>But this reveals that we're not really accumulating in the variable <code>t</code> at all! So the function simplifies to</p>\n\n<pre><code>flatten l = case l of \n  [] -&gt; []\n  l:ls -&gt; l ++ flatten ls\n</code></pre>\n\n<p>aka</p>\n\n<p><code>flatten [] = []\nflatten (l:ls) = l ++ flatten ls</code></p>\n\n<p>A fold would be a natural way to express it, I know you're not permitting yourself standard functions though. A list comprehension is also quite nice eg. <code>flatten ls = [x | l &lt;- ls, x &lt;- l]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11305956, "user_type": "registered", "profile_image": "https://graph.facebook.com/2376065545785995/picture?type=large", "display_name": "Quentin Doniczka", "link": "https://stackoverflow.com/users/11305956/quentin-doniczka"}, "is_accepted": false, "score": 0, "last_activity_date": 1554342060, "creation_date": 1554342060, "answer_id": 55506663, "question_id": 55506239, "link": "https://stackoverflow.com/questions/55506239/implementing-flatten/55506663#55506663", "title": "Implementing flatten", "body": "<p>I will just add the final modification, but i go it, thank to Tayler\n   finaly, i juste use my concatene fonction on my fonction on the final line:</p>\n\n<pre><code>concatene (l,t) =  case l of\n                         x:r -&gt; x:concatene (r,t)\n                         []  -&gt; t \naplatir l = case l of \n  [] -&gt; []\n  x:r -&gt; concatene (x,aplatir(r))\n</code></pre>\n\n<p>and can also declare it localy</p>\n\n<pre><code>aplatirF l = let concateneL (l,t) =  case l of\n                     x:r -&gt; x:concateneL (r,t)\n                     []  -&gt; t in\n                     case l of \n                         [] -&gt; []\n                         x:r -&gt; concateneL (x,aplatirF(r))\n</code></pre>\n\n<p>and everything working, thank you !</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1554370922, "creation_date": 1554370922, "answer_id": 55512713, "question_id": 55506239, "link": "https://stackoverflow.com/questions/55506239/implementing-flatten/55512713#55512713", "title": "Implementing flatten", "body": "<p>Consider this sequence of transitions:</p>\n\n<pre><code>flatten [[11,22],[4,2,8,1,7,12,4]] \n==&gt; 11 : flatten [[22],[4,2,8,1,7,12,4]]\n         ==&gt; 22 : flatten [[],[4,2,8,1,7,12,4]]\n                  ==&gt; flatten [[4,2,8,1,7,12,4]]\n                  ==&gt; 4 : flatten [[2,8,1,7,12,4]]\n                          ==&gt; 2 : f [[8,1,7,12,4]]\n                                  ==&gt; .....\n                                      .....\n                                           ==&gt; 4 : flatten [[]]\n                                                   ==&gt; flatten []\n                                                   ==&gt; []\n</code></pre>\n\n<p>Thus we see just a few laws here:</p>\n\n<pre><code>flatten ((x:xs):r) = x : flatten (xs:r)\nflatten (   [] :r) = flatten r\nflatten []         = []\n</code></pre>\n\n<p>Now all that's left is to put these laws into code. </p>\n"}], "owner": {"reputation": 31, "user_id": 11305956, "user_type": "registered", "profile_image": "https://graph.facebook.com/2376065545785995/picture?type=large", "display_name": "Quentin Doniczka", "link": "https://stackoverflow.com/users/11305956/quentin-doniczka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 55506406, "answer_count": 3, "score": 0, "last_activity_date": 1554370922, "creation_date": 1554338492, "last_edit_date": 1554367780, "question_id": 55506239, "link": "https://stackoverflow.com/questions/55506239/implementing-flatten", "title": "Implementing flatten", "body": "<p>I'm currently try to implement common functions on lists and I created the function '++' eg.</p>\n\n<p>[11,22] ++ [4,2,8,1,7,12,4]</p>\n\n<blockquote>\n  <p>[11,22,4,2,8,1,7,12,4]</p>\n</blockquote>\n\n<p>as follows:</p>\n\n<pre><code>concatenate l t =  case l of\n                     x:r -&gt; x:concatenate r t\n                     []  -&gt; t\n</code></pre>\n\n<p>and this is working! no problems.</p>\n\n<p>But now, I'm trying to write <code>flatten</code>;</p>\n\n<pre><code> flatten[[11,22],[4,2,8,1,7,12,4]]\n</code></pre>\n\n<blockquote>\n  <p>[11,22,4,2,8,1,7,12,4]</p>\n</blockquote>\n\n<p>But, I don't know how to do it, because, you have a list, containing n lists, with different sizes (the objective is to not use any standard functions). I tried eg.</p>\n\n<pre><code>concatenate l t =  case l of\n                     x:r -&gt; x:concatenate r t\n                     []  -&gt; t \n\nflatten l = flattenL l []\n      where flattenL l t= case l of\n              x:r -&gt; flattenL (r (concatenate x t)) -- here x is a list, so that can't work\n              []  -&gt; t\n</code></pre>\n"}]