[{"tags": ["haskell", "types", "happy", "polykinds"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1501717509, "post_id": 45472341, "comment_id": 77906210, "body": "This seems relevant: <a href=\"https://stackoverflow.com/a/35320729/180286\">stackoverflow.com/a/35320729/180286</a>. Basically a function can&#39;t be polymorphic over kinds, unless you really want to, and only in GHC 8+"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1501721245, "post_id": 45472341, "comment_id": 77907074, "body": "If Happy generates code which doesn&#39;t compile in this way, it is probably a bug in Happy (perhaps one which can be worked around!). Can you put together a minimal Happy example which produces such code? I don&#39;t think GHC ever infers a kind other than <code>*</code> for a polytype."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501722217, "post_id": 45472341, "comment_id": 77907276, "body": "@user2407038 Although my question still stands, this particular Happy bug is easily fixed. Basically any generated code that uses <code>happyMonad2Reduce</code> and was not generated with <code>-a</code> will have this problem for the <code>nt :: Int#</code> variable (which is not used without <code>-a</code>, hence the type inference issues). I&#39;m currently fighting some nastier Happy issues, so filing an issue for <i>this</i> is going on the back burner. :)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501722566, "post_id": 45472341, "comment_id": 77907338, "body": "@Alec Thanks for the explanation, I see you are already aware of the problem/solution higher up in the toolchain. This question is interesting in a much broader context than Happy, but unfortunately I don&#39;t think it has a solution (other than writing a type signature). Best of luck!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1501735054, "post_id": 45472341, "comment_id": 77910231, "body": "Inference or no, the argument to <code>f</code> can&#39;t have a polykinded (specifically, levity-polymorphic) type. <code>x</code> is a variable with the type that would be levity-polymorphic, and no variables can have such types. So you&#39;d need GHC to infer a <i>monomorphic</i> type here. My guess is that whereas the type checker can delay class-polymorphic code to apply the monomorphism restriction, it has no mechanism for doing so with (fundamentally) levity-polymorphic code."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 1, "last_activity_date": 1506370892, "creation_date": 1506370892, "answer_id": 46413556, "question_id": 45472341, "link": "https://stackoverflow.com/questions/45472341/ghc-cant-infer-unlifted-kind/46413556#46413556", "title": "GHC can&#39;t infer unlifted kind", "body": "<p>As hinted at by @dfeuer, this is impossible. In the worst case, GHC would have to look for usages of a given function across the whole project in order to infer the levity of an argument.</p>\n\n<p>This was reported as a <a href=\"https://github.com/simonmar/happy/issues/95\" rel=\"nofollow noreferrer\">bug in Happy</a> and has since been <a href=\"https://github.com/simonmar/happy/pull/97\" rel=\"nofollow noreferrer\">fixed</a>.</p>\n"}], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 46413556, "answer_count": 1, "score": 4, "last_activity_date": 1506370892, "creation_date": 1501715151, "question_id": 45472341, "link": "https://stackoverflow.com/questions/45472341/ghc-cant-infer-unlifted-kind", "title": "GHC can&#39;t infer unlifted kind", "body": "<p>I'm running up against what looks like invalid code generated by Happy. The problem boils down to GHC not inferring a polykinded type signature for a function. Here is an example of this:</p>\n\n<pre><code>{-# Language MagicHash #-}\n\nf x = ()\n\nmain = pure (f 1#)\n</code></pre>\n\n<p>Since GHC is inferring <code>f :: a -&gt; ()</code> where <code>a :: *</code>, this fails with </p>\n\n<pre><code> \u2022 Couldn't match a lifted type with an unlifted type\n   When matching the kind of \u2018GHC.Prim.Int#\u2019\n \u2022 In the first argument of \u2018f\u2019, namely \u20181#\u2019\n   In the first argument of \u2018pure\u2019, namely \u2018(f 1#)\u2019\n   In the expression: pure (f 1#)\n</code></pre>\n\n<p>Are there any language pragmas I could just turn on to get this code to compile? I know I could in theory just add type signatures but, as this is code generated by Happy which I'd prefer not to have to manually modify anything.</p>\n"}, {"tags": ["haskell", "cabal", "cairo"], "comments": [{"owner": {"reputation": 1304, "user_id": 231299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dff0c4f2df2394109a0b09fa59dce1?s=128&d=identicon&r=PG", "display_name": "beerboy", "link": "https://stackoverflow.com/users/231299/beerboy"}, "edited": false, "score": 2, "creation_date": 1501717606, "post_id": 45471742, "comment_id": 77906229, "body": "Try <code>cabal update --verbose=3</code>?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501719493, "post_id": 45471742, "comment_id": 77906708, "body": "As suggested by another commenter, you should run it with <code>--verbose=3</code> to see at which stage it hangs. On Windows, this is often (in my experience) a permission issue with some file that cabal is trying to write."}], "owner": {"reputation": 183, "user_id": 4865799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y7tmw6wcErg/AAAAAAAAAAI/AAAAAAAAAgE/PYsaBUR6qvE/photo.jpg?sz=128", "display_name": "Isaac Middlemiss", "link": "https://stackoverflow.com/users/4865799/isaac-middlemiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501712275, "creation_date": 1501711327, "last_edit_date": 1501712275, "question_id": 45471742, "link": "https://stackoverflow.com/questions/45471742/cabal-update-appears-to-be-working-but-not-doing-anything", "title": "Cabal update appears to be working but not doing anything", "body": "<p>I just installed Haskell and have been trying to get it going, but when I tried to start it up, it does this:</p>\n\n<pre><code>C:\\Users\\isaac&gt;cabal install\nWarning: The package list for 'hackage.haskell.org' does not exist. Run \n'cabal update' to download it.\ncabal: Error reading local package.\nCouldn't find .cabal file in: .\n\nC:\\Users\\isaac&gt;cabal update\nDownloading the latest package list from hackage.haskell.org\n</code></pre>\n\n<p>It has been like that for 10 hours now. I don't know if it's even possible to see how much progress, if any, it's made, but it doesn't seem to be doing anything. The version is:</p>\n\n<pre><code>C:\\Users\\isaac&gt;cabal --version\ncabal-install version 1.24.0.2\ncompiled using version 1.24.2.0 of the Cabal library\n</code></pre>\n\n<p>All of this has been just to get Cairo working (on Windows).</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1501702913, "creation_date": 1501702913, "answer_id": 45469631, "question_id": 45469510, "link": "https://stackoverflow.com/questions/45469510/how-do-i-remove-copies-of-ghc-that-were-installed-by-stack/45469631#45469631", "title": "How do I remove copies of GHC that were installed by Stack?", "body": "<p>Yes, deleting those directories is safe.</p>\n"}], "owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 45469631, "answer_count": 1, "score": 3, "last_activity_date": 1501702913, "creation_date": 1501702442, "question_id": 45469510, "link": "https://stackoverflow.com/questions/45469510/how-do-i-remove-copies-of-ghc-that-were-installed-by-stack", "title": "How do I remove copies of GHC that were installed by Stack?", "body": "<p>Like the poster in <a href=\"https://www.reddit.com/r/haskell/comments/46reio/how_to_uninstall_snapshots_and_older_ghc_from/?st=j5veogfw&amp;sh=24d5685e\" rel=\"nofollow noreferrer\">this Reddit thread</a>, I am running low on drive space and would like to get rid of some of the older versions of GHC that Stack installed for me. (I have five versions installed and they\u2019re taking up over 6 GB.) Is it safe just to remove the individual versions\u2019 folders from <code>~/.stack/programs/x86_64-osx</code>, or is there a better way?</p>\n"}, {"tags": ["regex", "haskell", "substring"], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501710810, "post_id": 45467859, "comment_id": 77904261, "body": "<code>map (!! 1)</code> might be more readable, because the number indicates the capture group."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1501711109, "last_edit_date": 1501711109, "creation_date": 1501696528, "answer_id": 45467859, "question_id": 45467695, "link": "https://stackoverflow.com/questions/45467695/extract-string-between-two-substrings-in-haskell/45467859#45467859", "title": "extract string between two substrings in Haskell", "body": "<p>The result you obtain is the following:</p>\n\n<pre><code>Prelude Text.Regex.PCRE&gt; (s ++ s) =~ \"asdf=5;(.*)123jasd\" :: [[String]]\n[[\"asdf=5;iwantthis123jasd---+++asdf=5;iwantthis123jasd\",\"iwantthis123jasd---+++asdf=5;iwantthis\"]]\n</code></pre>\n\n<p>This is correct, the first element is the <em>implicit</em> capture group 0 (the entire regex), and the <em>second</em> element is that of capture group 1 (the one that matches <code>(.*)</code>. Since it matches like:</p>\n\n<pre>+++asdf=5;<b>iwantthis123jasd---+++asdf=5;iwantthis</b>123jasd---</pre>\n\n<p>So it still matches between the <code>asdf=5;</code> and <code>123jasd</code> part.</p>\n\n<p>This is due to the fact that the Kleene start <code>*</code> matches <em>greedy</em>: it aims to capture as much as possible. You can use <code>(.*?)</code> however to use a <em>non-greedy</em> quantifier:</p>\n\n<pre><code>Prelude Text.Regex.PCRE&gt; (s ++ s) =~ \"asdf=5;<b>(.*?)</b>123jasd\" :: [[String]]\n[[\"asdf=5;iwantthis123jasd\",\"iwantthis\"],[\"asdf=5;iwantthis123jasd\",\"iwantthis\"]]</code></pre>\n\n<p>And now we obtain <em>two</em> matches. Each match has <code>\"iwantthis\"</code> as capture group 1.</p>\n\n<p>You can use <code>map (head . tail)</code> or <code>map (!!1)</code> on it to obtain a list of captures of the <code>(.*?)</code> part:</p>\n\n<pre><code>Prelude Text.Regex.PCRE&gt; <b>map (!!1)</b> ((s ++ s) =~ \"asdf=5;(.*?)123jasd\" :: [[String]])\n[\"iwantthis\",\"iwantthis\"]</code></pre>\n"}], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 45467859, "answer_count": 1, "score": 1, "last_activity_date": 1501711109, "creation_date": 1501695952, "question_id": 45467695, "link": "https://stackoverflow.com/questions/45467695/extract-string-between-two-substrings-in-haskell", "title": "extract string between two substrings in Haskell", "body": "<p>I wanted to adapt the python regex (PCRE) technique in this SO question <a href=\"https://stackoverflow.com/questions/3368969\">Find string between two substrings</a> to Haskell so that I can do the same in Haskell.</p>\n\n<p>But I can't figure out how to make it work in GHC (8.2.1). I've installed <code>cabal install regex-pcre</code>, and came up with the following test code after some search:</p>\n\n<pre><code>import Text.Regex.PCRE\ns = \"+++asdf=5;iwantthis123jasd---\"\nresult = (s ++ s) =~ \"asdf=5;(.*)123jasd\" :: [[String]]\n</code></pre>\n\n<p>I was hoping to get the first and last instance of the middle string</p>\n\n<pre><code>iwantthis\n</code></pre>\n\n<p>But I can't get the result right:</p>\n\n<blockquote>\n  <p>[[\"asdf=5;iwantthis123jasd---+++asdf=5;iwantthis123jasd\",\"iwantthis123jasd---+++asdf=5;iwantthis\"]]</p>\n</blockquote>\n\n<p>I haven't used regex or pcre in Haskell before. </p>\n\n<p><em>Can someone help with the right usage (to extract the first and last occurrence) ?\nAlso, I don't quite understand the <code>::[[String]]</code> usage here. What does it do and why is it necessary?</em></p>\n\n<p>I searched the <a href=\"https://hackage.haskell.org/package/regex-pcre-0.94.4/docs/Text-Regex-PCRE-Wrap.html#v:-61--126--126-\" rel=\"nofollow noreferrer\">documentation</a> but found no mention of the usage with type conversion to  <code>:: [[String]]</code>.</p>\n"}, {"tags": ["haskell", "middleware", "haskell-wai"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1501720144, "post_id": 45467648, "comment_id": 77906857, "body": "The result of <code>responseToStream</code> is a 3-tuple; I&#39;m guessing by &quot;body&quot; you mean you are interested in the 3rd component and not the first two (which are concrete, i.e. non-abstract, algebraic types, so you can access their fields directly). For the 3rd comp, you could probably just pass a function for <code>Builder -&gt; IO ()</code> which <code>mappend</code>s each <code>Builder</code> to an <code>IORef</code> (or <code>MVar</code> in a concurrent setting) - &quot;the first parameter provides a means of sending another chunk of data&quot; (here &#39;sending&#39; is just saving in memory)."}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 0, "last_activity_date": 1501766648, "creation_date": 1501766648, "answer_id": 45485526, "question_id": 45467648, "link": "https://stackoverflow.com/questions/45467648/how-to-read-response-body-in-wai-middleware/45485526#45485526", "title": "How to read response body in WAI middleware?", "body": "<p>An implementation of the comment by @user2407038:</p>\n\n<pre><code>import Data.IORef (newIORef,modifyIORef',readIORef)\nimport Data.Monoid ((&lt;&gt;))\nimport Data.ByteString.Lazy (ByteString)\nimport Data.ByteString.Builder (toLazyByteString)\n\nimport Network.Wai\n\nresponseBody :: Response -&gt; IO ByteString\nresponseBody res =\n  let (status,headers,body) = responseToStream res in\n  body $ \\f -&gt; do\n    content &lt;- newIORef mempty\n    f (\\chunk -&gt; modifyIORef' content (&lt;&gt; chunk)) (return ())\n    toLazyByteString &lt;$&gt; readIORef content\n</code></pre>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501766648, "creation_date": 1501695763, "question_id": 45467648, "link": "https://stackoverflow.com/questions/45467648/how-to-read-response-body-in-wai-middleware", "title": "How to read response body in WAI middleware?", "body": "<p>I'm trying to create some middleware that will send 500 errors to a remote server. The error information is in the response body. </p>\n\n<p>How can I get the response body from a <code>Response</code> as any kind of string? I see <a href=\"https://hackage.haskell.org/package/wai-3.2.1.1/docs/Network-Wai.html#v:responseToStream\" rel=\"nofollow noreferrer\"><code>responseToStream</code></a> but I can't figure out how to use it.</p>\n\n<pre><code>import Network.Wai\nimport Data.ByteString.Lazy (ByteString)\n\nresponseBody :: Response -&gt; IO ByteString\nresponseBody res = _\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "edited": false, "score": 0, "creation_date": 1502098474, "post_id": 45489321, "comment_id": 78047040, "body": "What about stack global project? Can global project configuration be considered as sort of local installation? I guess Stack will make all packages mentioned in global stack.yaml available to ghci if you just start it with <code>stack ghci</code> outside of project directory, but global stack.yaml will be completely overridden by project stack.yaml if one present in project directory."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1501776391, "last_edit_date": 1501776391, "creation_date": 1501776083, "answer_id": 45489321, "question_id": 45466304, "link": "https://stackoverflow.com/questions/45466304/installing-local-package-with-stack/45489321#45489321", "title": "Installing local package with Stack", "body": "<p>Um, <code>stack build</code> (within the source directory)?</p>\n\n<p>Stack doesn't really have a notion of <em>installing</em> libraries though, it only installs executables. To \u201cinstall\u201d locally-sourced packages, you need to specify <em>what for</em> you want them installed: add them as dependencies to another project, via a <code>location:</code> field in the <code>packages:</code> field in that project's <code>stack.yaml</code> file.</p>\n\n<p>That's arguably sensible since, one might say, there's nothing you can do with an installed library except invoking it in another Haskell project (or in a REPL, which you can get with <code>stack ghci</code>). I personally don't hold with that though, I like actually being able to say <em>install that library now</em>. Which is one of the reasons I have always stuck to good old cabal-install rather than Stack. With that, you can just</p>\n\n<pre><code>cabal install\n</code></pre>\n\n<p>from within the source directory.</p>\n\n<p>Cabal-install has often been criticised: its local installs can easily get out of sync and then you have weird dependency conflicts and need to rebuild lots of stuff. I never found this <em>that much</em> of a problem, and anyway this has been adressed in recent Cabal through <a href=\"http://blog.ezyang.com/2016/05/announcing-cabal-new-build-nix-style-local-builds/\" rel=\"nofollow noreferrer\">Nix-style builds</a>, which never produce conflicts.</p>\n"}], "owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "accepted_answer_id": 45489321, "answer_count": 1, "score": 0, "last_activity_date": 1501776391, "creation_date": 1501691441, "last_edit_date": 1501775702, "question_id": 45466304, "link": "https://stackoverflow.com/questions/45466304/installing-local-package-with-stack", "title": "Installing local package with Stack", "body": "<p>Is it possible to install package from sources with something similar to <code>stack build package-name</code>? (latter works with packages on Stackage, but not with custom ones)</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1501694073, "post_id": 45463664, "comment_id": 77895055, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45463573/how-to-know-in-haskell-the-builtins-functions\">how to know in Haskell the builtins functions?</a>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501710575, "post_id": 45463664, "comment_id": 77904164, "body": "What do you mean &quot;not in Prelude&quot;? Do you mean not in GHCi?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501720576, "post_id": 45463664, "comment_id": 77906932, "body": "To access the imports of a module as any sort of Haskell data structure, you must use the GHC API (See <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.2.1/index.html\" rel=\"nofollow noreferrer\">here</a> for latest version of the docs for the GHC API, which may differ significantly from whatever version you are using). This is a fairly involved and complicated process, and there may be a much simpler way of accomplishing whatever you are trying to accomplish (but you haven&#39;t stated what that is)."}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 10, "last_activity_date": 1501684369, "creation_date": 1501684369, "answer_id": 45463742, "question_id": 45463664, "link": "https://stackoverflow.com/questions/45463664/how-to-know-what-are-the-full-list-of-function-availlable-in-an-import/45463742#45463742", "title": "How to know what are the full list of function availlable in an import?", "body": "<p>You can use browse:</p>\n\n<pre><code>Prelude&gt; :browse Data.List\n</code></pre>\n\n<p>It will list all the methods available </p>\n"}, {"tags": [], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "is_accepted": false, "score": 1, "last_activity_date": 1501685724, "last_edit_date": 1501685724, "creation_date": 1501684793, "answer_id": 45463911, "question_id": 45463664, "link": "https://stackoverflow.com/questions/45463664/how-to-know-what-are-the-full-list-of-function-availlable-in-an-import/45463911#45463911", "title": "How to know what are the full list of function availlable in an import?", "body": "<p>There is online documentation available, for example <a href=\"https://www.stackage.org/haddock/lts-9.0/base-4.9.1.0/Data-List.html\" rel=\"nofollow noreferrer\">here</a>. It is generally best practice to use qualified imports like <code>import qualified Data.List as L</code> or <code>import Data.List (permutations, foldl')</code> to avoid this issue, though.</p>\n"}, {"comments": [{"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1501773180, "post_id": 45488210, "comment_id": 77937530, "body": "At the moment you cannot install <i>ghc-mod</i> with GHC 8.0.1 or 8.2.1. However It installes smoothly with GHC 8.0.2."}], "tags": [], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "is_accepted": false, "score": 2, "last_activity_date": 1501788022, "last_edit_date": 1501788022, "creation_date": 1501773053, "answer_id": 45488210, "question_id": 45463664, "link": "https://stackoverflow.com/questions/45463664/how-to-know-what-are-the-full-list-of-function-availlable-in-an-import/45488210#45488210", "title": "How to know what are the full list of function availlable in an import?", "body": "<p>From your Haskell program you can call <a href=\"http://hackage.haskell.org/package/ghc-mod\" rel=\"nofollow noreferrer\"><em>ghc-mod</em></a>. It is a standalone program that is able to do what you want:</p>\n\n<p>eg in the terminal the command  <code>ghc-mod browse Data.List</code> returns</p>\n\n<pre><code>all\nand\nany\nbreak\nconcat\nconcatMap\ncycle\n...\n</code></pre>\n\n<p>If you need the types of the functions you can use <code>ghc-mod browse -d Data.List</code>. It returns:</p>\n\n<pre><code>all :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\nand :: Foldable t =&gt; t Bool -&gt; Bool\nany :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\nbreak :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\nconcat :: Foldable t =&gt; t [a] -&gt; [a]\nconcatMap :: Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]\ncycle :: [a] -&gt; [a]\ndelete :: Eq a =&gt; a -&gt; [a] -&gt; [a]\n...\n</code></pre>\n\n<p>You can install <em>ghc-mod</em> with <em>cabal</em>. To call <em>ghc-mod</em> from your Haskell program, you can <a href=\"https://stackoverflow.com/questions/21464639/how-to-retrieve-output-of-external-program-executed-from-haskell\">follow the answers to this SO question</a>. The preferred wa\u0177 is to use the <em>shelly</em> library. </p>\n\n<p>Here is a small demo program:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Shelly\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = shelly $ silently $ do\n    out &lt;- run \"ghc-mod\" [\"browse\", \"-d\", \"Data.List\"] \n    -- lns will containes a list of lines with the function names and their types\n    let lns = T.lines out\n    -- Here we print out the number of functions and the first 5 functions\n    liftIO $ putStrLn $ show $ Prelude.length lns\n    liftIO $ mapM_ (putStrLn .T.unpack) $ take 5 lns\n</code></pre>\n"}], "owner": {"reputation": 5656, "user_id": 3313834, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1520bf35a582afbccf3c5c5db6135612?s=128&d=identicon&r=PG&f=1", "display_name": "user3313834", "link": "https://stackoverflow.com/users/3313834/user3313834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "answer_count": 3, "score": 9, "last_activity_date": 1572882951, "creation_date": 1501684147, "last_edit_date": 1572882951, "question_id": 45463664, "link": "https://stackoverflow.com/questions/45463664/how-to-know-what-are-the-full-list-of-function-availlable-in-an-import", "title": "How to know what are the full list of function availlable in an import?", "body": "<p>In Haskell if I import a module e.g.</p>\n\n<pre><code>import Data.List \n</code></pre>\n\n<p>How can I know what is the total method that Data.List made available ?</p>\n\n<p>In Prelude I can use completion like said here <a href=\"https://stackoverflow.com/questions/1698942/is-there-a-way-to-see-the-list-of-functions-in-a-module-in-ghci\">Is there a way to see the list of functions in a module, in GHCI?</a>::</p>\n\n<pre><code>Prelude&gt; :m +Data.List\nPrelude Data.List&gt; Data.List.&lt;PRESS TAB KEY HERE&gt;\n</code></pre>\n\n<p>But I want to get this in a list that be can manipulate, not in Prelude.</p>\n\n<p>This question is not about builtins <a href=\"https://stackoverflow.com/questions/45463573/how-to-know-in-haskell-the-builtins-functions\">how to know in Haskell the builtins functions?</a>, (I mean by builtins available functions we have without doing any import)</p>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 3, "creation_date": 1501684108, "post_id": 45463573, "comment_id": 77887900, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1698942/is-there-a-way-to-see-the-list-of-functions-in-a-module-in-ghci\">Is there a way to see the list of functions in a module, in GHCI?</a>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1501768063, "post_id": 45463573, "comment_id": 77932961, "body": "Well, you could copy paste the list from GHCI into a gigantic string and store that in your <code>.hs</code> file.  <i>Why</i> do you need such a list? What do you want to do with it?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501774882, "post_id": 45463573, "comment_id": 77938788, "body": "Define what you mean by \u201cbuiltin\u201d. Haskell doesn&#39;t really have \u201cbuiltins\u201d. You mean, the available definitions in an empty module or REPL? That&#39;s just <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html\" rel=\"nofollow noreferrer\">the <code>Prelude</code> module</a>, but nothing in there is really special language-wise \u2013 it&#39;s just what&#39;s imported unless you say<code>import Prelude ()</code> to prevent that. ..."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501775045, "post_id": 45463573, "comment_id": 77938914, "body": "...Or do you mean, the \u201cfundamental building blocks\u201d, the stuff you couldn&#39;t define yourself in a library but only by rebuilding the compiler? That would be <a href=\"http://hackage.haskell.org/package/ghc-prim-0.5.1.0/docs/GHC-Prim.html\" rel=\"nofollow noreferrer\"><code>GHC.Prim</code></a>, but in there are only very awkward to use low-level operations. It isn&#39;t supposed to be used in normal Haskell at all, and in fact isn&#39;t related to what the Haskell standard defines."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501775550, "post_id": 45463573, "comment_id": 77939275, "body": "IOW, <i>everything</i> in Haskell, excluding the (few) keywords, is just a library function/type/typeclass. Which is great, for instance it allows you to search for anything, including \u201cbuiltins\u201d, infix operators etc., with the specialised Haskell search engines, both <a href=\"https://hayoo.fh-wedel.de\" rel=\"nofollow noreferrer\">by name</a> and <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">by type</a>."}], "answers": [{"comments": [{"owner": {"reputation": 5656, "user_id": 3313834, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1520bf35a582afbccf3c5c5db6135612?s=128&d=identicon&r=PG&f=1", "display_name": "user3313834", "link": "https://stackoverflow.com/users/3313834/user3313834"}, "edited": false, "score": 0, "creation_date": 1501740918, "post_id": 45463646, "comment_id": 77912767, "body": "Yes In Prelude we have this help, but outside from prelude in a test.hs file I want to get the liste [&#39;odd&#39;, &#39;break&#39;, &#39;pi&#39;, ...]"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1501757734, "post_id": 45463646, "comment_id": 77924717, "body": "If you want to get a list of the names of available functions programmatically you&#39;ll have to go through the GHC api or a wrapper thereof; which shouldn&#39;t be too much of an issue because otherwise there&#39;s not very many useful things you could do with such a list."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 5656, "user_id": 3313834, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1520bf35a582afbccf3c5c5db6135612?s=128&d=identicon&r=PG&f=1", "display_name": "user3313834", "link": "https://stackoverflow.com/users/3313834/user3313834"}, "edited": false, "score": 0, "creation_date": 1501961536, "post_id": 45463646, "comment_id": 78011453, "body": "@user3313834 What do you want to do with that list? What&#39;s the larger problem you&#39;re working on solving?"}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 3, "last_activity_date": 1501684077, "creation_date": 1501684077, "answer_id": 45463646, "question_id": 45463573, "link": "https://stackoverflow.com/questions/45463573/how-to-know-in-haskell-the-builtins-functions/45463646#45463646", "title": "how to know in Haskell the builtins functions?", "body": "<p>In GHCi, you can type <code>:browse Prelude</code> to list everything exported by the <code>Prelude</code> module.</p>\n\n<p>Output from my local installation:</p>\n\n<pre><code>Prelude&gt; :browse Prelude\n(!!) :: [a] -&gt; Int -&gt; a\n($) ::\n  forall (r :: GHC.Types.RuntimeRep) a (b :: TYPE r).\n  (a -&gt; b) -&gt; a -&gt; b\n($!) :: (a -&gt; b) -&gt; a -&gt; b\n(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool\n(++) :: [a] -&gt; [a] -&gt; [a]\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n(=&lt;&lt;) :: Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b\nclass Functor f =&gt; Applicative (f :: * -&gt; *) where\n  pure :: a -&gt; f a\n  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n  (*&gt;) :: f a -&gt; f b -&gt; f b\n  (&lt;*) :: f a -&gt; f b -&gt; f a\n  {-# MINIMAL pure, (&lt;*&gt;) #-}\ndata Bool = False | True\nclass Bounded a where\n  minBound :: a\n  maxBound :: a\n  {-# MINIMAL minBound, maxBound #-}\ndata Char = GHC.Types.C# GHC.Prim.Char#\ndata Double = GHC.Types.D# GHC.Prim.Double#\ndata Either a b = Left a | Right b\nclass Enum a where\n  succ :: a -&gt; a\n  pred :: a -&gt; a\n  toEnum :: Int -&gt; a\n  fromEnum :: a -&gt; Int\n  enumFrom :: a -&gt; [a]\n  enumFromThen :: a -&gt; a -&gt; [a]\n  enumFromTo :: a -&gt; a -&gt; [a]\n  enumFromThenTo :: a -&gt; a -&gt; a -&gt; [a]\n  {-# MINIMAL toEnum, fromEnum #-}\nclass Eq a where\n  (==) :: a -&gt; a -&gt; Bool\n  (/=) :: a -&gt; a -&gt; Bool\n  {-# MINIMAL (==) | (/=) #-}\ntype FilePath = String\ndata Float = GHC.Types.F# GHC.Prim.Float#\nclass Fractional a =&gt; Floating a where\n  pi :: a\n  exp :: a -&gt; a\n  log :: a -&gt; a\n  sqrt :: a -&gt; a\n  (**) :: a -&gt; a -&gt; a\n  logBase :: a -&gt; a -&gt; a\n  sin :: a -&gt; a\n  cos :: a -&gt; a\n  tan :: a -&gt; a\n  asin :: a -&gt; a\n  acos :: a -&gt; a\n  atan :: a -&gt; a\n  sinh :: a -&gt; a\n  cosh :: a -&gt; a\n  tanh :: a -&gt; a\n  asinh :: a -&gt; a\n  acosh :: a -&gt; a\n  atanh :: a -&gt; a\n  GHC.Float.log1p :: a -&gt; a\n  GHC.Float.expm1 :: a -&gt; a\n  GHC.Float.log1pexp :: a -&gt; a\n  GHC.Float.log1mexp :: a -&gt; a\n  {-# MINIMAL pi, exp, log, sin, cos, asin, acos, atan, sinh, cosh,\n              asinh, acosh, atanh #-}\nclass Foldable (t :: * -&gt; *) where\n  Data.Foldable.fold :: Monoid m =&gt; t m -&gt; m\n  foldMap :: Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m\n  foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n  Data.Foldable.foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n  foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n  Data.Foldable.foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n  foldr1 :: (a -&gt; a -&gt; a) -&gt; t a -&gt; a\n  foldl1 :: (a -&gt; a -&gt; a) -&gt; t a -&gt; a\n  Data.Foldable.toList :: t a -&gt; [a]\n  null :: t a -&gt; Bool\n  length :: t a -&gt; Int\n  elem :: Eq a =&gt; a -&gt; t a -&gt; Bool\n  maximum :: Ord a =&gt; t a -&gt; a\n  minimum :: Ord a =&gt; t a -&gt; a\n  sum :: Num a =&gt; t a -&gt; a\n  product :: Num a =&gt; t a -&gt; a\n  {-# MINIMAL foldMap | foldr #-}\nclass Num a =&gt; Fractional a where\n  (/) :: a -&gt; a -&gt; a\n  recip :: a -&gt; a\n  fromRational :: Rational -&gt; a\n  {-# MINIMAL fromRational, (recip | (/)) #-}\nclass Functor (f :: * -&gt; *) where\n  fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n  (&lt;$) :: a -&gt; f b -&gt; f a\n  {-# MINIMAL fmap #-}\nnewtype IO a\n  = GHC.Types.IO (GHC.Prim.State# GHC.Prim.RealWorld\n                  -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, a #))\ntype IOError = GHC.IO.Exception.IOException\ndata Int = GHC.Types.I# GHC.Prim.Int#\ndata Integer\n  = integer-gmp-1.0.0.1:GHC.Integer.Type.S# !GHC.Prim.Int#\n  | integer-gmp-1.0.0.1:GHC.Integer.Type.Jp# {-# UNPACK #-}integer-gmp-1.0.0.1:GHC.Integer.Type.BigNat\n  | integer-gmp-1.0.0.1:GHC.Integer.Type.Jn# {-# UNPACK #-}integer-gmp-1.0.0.1:GHC.Integer.Type.BigNat\nclass (Real a, Enum a) =&gt; Integral a where\n  quot :: a -&gt; a -&gt; a\n  rem :: a -&gt; a -&gt; a\n  div :: a -&gt; a -&gt; a\n  mod :: a -&gt; a -&gt; a\n  quotRem :: a -&gt; a -&gt; (a, a)\n  divMod :: a -&gt; a -&gt; (a, a)\n  toInteger :: a -&gt; Integer\n  {-# MINIMAL quotRem, toInteger #-}\ndata Maybe a = Nothing | Just a\nclass Applicative m =&gt; Monad (m :: * -&gt; *) where\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n  (&gt;&gt;) :: m a -&gt; m b -&gt; m b\n  return :: a -&gt; m a\n  fail :: String -&gt; m a\n  {-# MINIMAL (&gt;&gt;=) #-}\nclass Monoid a where\n  mempty :: a\n  mappend :: a -&gt; a -&gt; a\n  mconcat :: [a] -&gt; a\n  {-# MINIMAL mempty, mappend #-}\nclass Num a where\n  (+) :: a -&gt; a -&gt; a\n  (-) :: a -&gt; a -&gt; a\n  (*) :: a -&gt; a -&gt; a\n  negate :: a -&gt; a\n  abs :: a -&gt; a\n  signum :: a -&gt; a\n  fromInteger :: Integer -&gt; a\n  {-# MINIMAL (+), (*), abs, signum, fromInteger, (negate | (-)) #-}\nclass Eq a =&gt; Ord a where\n  compare :: a -&gt; a -&gt; Ordering\n  (&lt;) :: a -&gt; a -&gt; Bool\n  (&lt;=) :: a -&gt; a -&gt; Bool\n  (&gt;) :: a -&gt; a -&gt; Bool\n  (&gt;=) :: a -&gt; a -&gt; Bool\n  max :: a -&gt; a -&gt; a\n  min :: a -&gt; a -&gt; a\n  {-# MINIMAL compare | (&lt;=) #-}\ndata Ordering = LT | EQ | GT\ntype Rational = GHC.Real.Ratio Integer\nclass Read a where\n  readsPrec :: Int -&gt; ReadS a\n  readList :: ReadS [a]\n  GHC.Read.readPrec :: Text.ParserCombinators.ReadPrec.ReadPrec a\n  GHC.Read.readListPrec :: Text.ParserCombinators.ReadPrec.ReadPrec\n                             [a]\n  {-# MINIMAL readsPrec | readPrec #-}\ntype ReadS a = String -&gt; [(a, String)]\nclass (Num a, Ord a) =&gt; Real a where\n  toRational :: a -&gt; Rational\n  {-# MINIMAL toRational #-}\nclass (RealFrac a, Floating a) =&gt; RealFloat a where\n  floatRadix :: a -&gt; Integer\n  floatDigits :: a -&gt; Int\n  floatRange :: a -&gt; (Int, Int)\n  decodeFloat :: a -&gt; (Integer, Int)\n  encodeFloat :: Integer -&gt; Int -&gt; a\n  exponent :: a -&gt; Int\n  significand :: a -&gt; a\n  scaleFloat :: Int -&gt; a -&gt; a\n  isNaN :: a -&gt; Bool\n  isInfinite :: a -&gt; Bool\n  isDenormalized :: a -&gt; Bool\n  isNegativeZero :: a -&gt; Bool\n  isIEEE :: a -&gt; Bool\n  atan2 :: a -&gt; a -&gt; a\n  {-# MINIMAL floatRadix, floatDigits, floatRange, decodeFloat,\n              encodeFloat, isNaN, isInfinite, isDenormalized, isNegativeZero,\n              isIEEE #-}\nclass (Real a, Fractional a) =&gt; RealFrac a where\n  properFraction :: Integral b =&gt; a -&gt; (b, a)\n  truncate :: Integral b =&gt; a -&gt; b\n  round :: Integral b =&gt; a -&gt; b\n  ceiling :: Integral b =&gt; a -&gt; b\n  floor :: Integral b =&gt; a -&gt; b\n  {-# MINIMAL properFraction #-}\nclass Show a where\n  showsPrec :: Int -&gt; a -&gt; ShowS\n  show :: a -&gt; String\n  showList :: [a] -&gt; ShowS\n  {-# MINIMAL showsPrec | show #-}\ntype ShowS = String -&gt; String\ntype String = [Char]\nclass (Functor t, Foldable t) =&gt; Traversable (t :: * -&gt; *) where\n  traverse :: Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n  sequenceA :: Applicative f =&gt; t (f a) -&gt; f (t a)\n  mapM :: Monad m =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n  sequence :: Monad m =&gt; t (m a) -&gt; m (t a)\n  {-# MINIMAL traverse | sequenceA #-}\ndata Word = GHC.Types.W# GHC.Prim.Word#\n(^) :: (Num a, Integral b) =&gt; a -&gt; b -&gt; a\n(^^) :: (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a\nall :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\nand :: Foldable t =&gt; t Bool -&gt; Bool\nany :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\nappendFile :: FilePath -&gt; String -&gt; IO ()\nasTypeOf :: a -&gt; a -&gt; a\nbreak :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\nconcat :: Foldable t =&gt; t [a] -&gt; [a]\nconcatMap :: Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]\nconst :: a -&gt; b -&gt; a\ncurry :: ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c\ncycle :: [a] -&gt; [a]\ndrop :: Int -&gt; [a] -&gt; [a]\ndropWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\neither :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c\nerror ::\n  forall (r :: GHC.Types.RuntimeRep) (a :: TYPE r).\n  GHC.Stack.Types.HasCallStack =&gt;\n  [Char] -&gt; a\nerrorWithoutStackTrace ::\n  forall (r :: GHC.Types.RuntimeRep) (a :: TYPE r). [Char] -&gt; a\neven :: Integral a =&gt; a -&gt; Bool\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nflip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c\nfromIntegral :: (Integral a, Num b) =&gt; a -&gt; b\nfst :: (a, b) -&gt; a\ngcd :: Integral a =&gt; a -&gt; a -&gt; a\ngetChar :: IO Char\ngetContents :: IO String\ngetLine :: IO String\nhead :: [a] -&gt; a\nid :: a -&gt; a\ninit :: [a] -&gt; [a]\ninteract :: (String -&gt; String) -&gt; IO ()\nioError :: IOError -&gt; IO a\niterate :: (a -&gt; a) -&gt; a -&gt; [a]\nlast :: [a] -&gt; a\nlcm :: Integral a =&gt; a -&gt; a -&gt; a\nlex :: ReadS String\nlines :: String -&gt; [String]\nlookup :: Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmapM_ :: (Foldable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m ()\nmaybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b\nnot :: Bool -&gt; Bool\nnotElem :: (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool\nodd :: Integral a =&gt; a -&gt; Bool\nor :: Foldable t =&gt; t Bool -&gt; Bool\notherwise :: Bool\nprint :: Show a =&gt; a -&gt; IO ()\nputChar :: Char -&gt; IO ()\nputStr :: String -&gt; IO ()\nputStrLn :: String -&gt; IO ()\nread :: Read a =&gt; String -&gt; a\nreadFile :: FilePath -&gt; IO String\nreadIO :: Read a =&gt; String -&gt; IO a\nreadLn :: Read a =&gt; IO a\nreadParen :: Bool -&gt; ReadS a -&gt; ReadS a\nreads :: Read a =&gt; ReadS a\nrealToFrac :: (Real a, Fractional b) =&gt; a -&gt; b\nrepeat :: a -&gt; [a]\nreplicate :: Int -&gt; a -&gt; [a]\nreverse :: [a] -&gt; [a]\nscanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\nscanl1 :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]\nscanr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\nscanr1 :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]\nseq :: a -&gt; b -&gt; b\nsequence_ :: (Foldable t, Monad m) =&gt; t (m a) -&gt; m ()\nshowChar :: Char -&gt; ShowS\nshowParen :: Bool -&gt; ShowS -&gt; ShowS\nshowString :: String -&gt; ShowS\nshows :: Show a =&gt; a -&gt; ShowS\nsnd :: (a, b) -&gt; b\nspan :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\nsplitAt :: Int -&gt; [a] -&gt; ([a], [a])\nsubtract :: Num a =&gt; a -&gt; a -&gt; a\ntail :: [a] -&gt; [a]\ntake :: Int -&gt; [a] -&gt; [a]\ntakeWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nuncurry :: (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c\nundefined ::\n  forall (r :: GHC.Types.RuntimeRep) (a :: TYPE r).\n  GHC.Stack.Types.HasCallStack =&gt;\n  a\nunlines :: [String] -&gt; String\nuntil :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a\nunwords :: [String] -&gt; String\nunzip :: [(a, b)] -&gt; ([a], [b])\nunzip3 :: [(a, b, c)] -&gt; ([a], [b], [c])\nuserError :: String -&gt; IOError\nwords :: String -&gt; [String]\nwriteFile :: FilePath -&gt; String -&gt; IO ()\nzip :: [a] -&gt; [b] -&gt; [(a, b)]\nzip3 :: [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]\nzipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith3 :: (a -&gt; b -&gt; c -&gt; d) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d]\n(||) :: Bool -&gt; Bool -&gt; Bool\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "is_accepted": false, "score": 0, "last_activity_date": 1501841099, "last_edit_date": 1501841099, "creation_date": 1501773793, "answer_id": 45488490, "question_id": 45463573, "link": "https://stackoverflow.com/questions/45463573/how-to-know-in-haskell-the-builtins-functions/45488490#45488490", "title": "how to know in Haskell the builtins functions?", "body": "<p>As I show in my answer to your question <a href=\"https://stackoverflow.com/questions/45463664/how-to-know-what-are-the-full-list-of-function-availlable-in-an-import/45488210#45488210\">How to know what are the full list of function availlable in an import?</a> you can use <em>ghc-mod</em>.</p>\n\n<p>Replace in the above referenced answer the line </p>\n\n<p><em>out &lt;- run \"ghc-mod\" [\"browse\", \"-d\", \"Data.List\"]</em> </p>\n\n<p>with </p>\n\n<p><code>out &lt;- run \"ghc-mod\" [\"browse\", \"-d\", \"Prelude\"]</code></p>\n"}], "owner": {"reputation": 5656, "user_id": 3313834, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1520bf35a582afbccf3c5c5db6135612?s=128&d=identicon&r=PG&f=1", "display_name": "user3313834", "link": "https://stackoverflow.com/users/3313834/user3313834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501841099, "creation_date": 1501683892, "last_edit_date": 1501685208, "question_id": 45463573, "link": "https://stackoverflow.com/questions/45463573/how-to-know-in-haskell-the-builtins-functions", "title": "how to know in Haskell the builtins functions?", "body": "<p>I look for a way to get all the builtins namespace of prelude Haskell.</p>\n\n<p>something equivalent to what we can have in Python doing this::</p>\n\n<pre><code>&gt;&gt;&gt; print([func for func in dir(__builtins__) if func[0].islower()])\n['abs', 'all', 'any', 'ascii', 'bin', 'bool', 'bytearray', 'bytes', 'callable', 'chr', 'classmethod', 'compile', 'complex', 'copyright', 'credits', 'delattr',\n 'dict', 'dir', 'divmod', 'enumerate', 'eval', 'exec', 'exit', 'filter', 'float', 'format', 'frozenset', 'getattr', 'globals', 'hasattr', 'hash', 'help', 'hex', 'id', 'input', 'int', 'isinstance', 'issubclass', 'iter', 'len',\n 'license', 'list', 'locals', 'map', 'max', 'memoryview', 'min', 'next', 'object', 'oct', 'open', 'ord', 'pow', 'print', 'property', 'quit', 'range', 'repr', 'reversed', 'round', 'set', 'setattr', 'slice', 'sorted', 'staticmethod',\n'str', 'sum', 'super', 'tuple', 'type', 'vars', 'zip']\n&gt;&gt;&gt; print(len.__doc__)\nReturn the number of items in a container.\n&gt;&gt;&gt; \n</code></pre>\n\n<p>This is not a question about \"how to get info from a library's contents\" like they talk here: <a href=\"https://stackoverflow.com/questions/1698942/is-there-a-way-to-see-the-list-of-functions-in-a-module-in-ghci\">Is there a way to see the list of functions in a module, in GHCI?</a></p>\n\n<p>It's about builtins, so about the language when you did not import any libray.</p>\n\n<p>I need to get the list of functions in a pro <code>program.hs</code> not in Prelude help system or in Prelude completion system.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501683680, "post_id": 45460820, "comment_id": 77887567, "body": "Note that the section <code>($ 2)</code> is distinct from the partial application <code>(($) 2)</code> -- the latter does apply the &quot;first&quot; argument to <code>($)</code>, the former is equivalent to <code>\\f -&gt; f $ 2</code> i.e. it applies the &quot;second&quot; argument."}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1501678154, "post_id": 45460997, "comment_id": 77882948, "body": "The signature of <code>($)</code> is <code>($) :: (a -&gt; b) -&gt; a -&gt; b</code>, why it is possible to pass a number to <code>($)</code> instead of function?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1501678294, "post_id": 45460997, "comment_id": 77883059, "body": "It <i>isn&#39;t</i> possible, that&#39;s not what you&#39;re doing there."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 2, "creation_date": 1501678502, "post_id": 45460997, "comment_id": 77883253, "body": "@zero_coding <code>$</code> is an infix operator, where the first parameter is written before it, and the second parameter is written after it. <code>($ 2)</code> isn&#39;t the same as <code>(2 $)</code>"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 1, "creation_date": 1501678847, "post_id": 45460997, "comment_id": 77883542, "body": "I tried following expression <code>Prelude&gt; ((+3) $ 3)</code> and now it is clear. Thanks"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1501678542, "last_edit_date": 1501678542, "creation_date": 1501677132, "answer_id": 45460997, "question_id": 45460820, "link": "https://stackoverflow.com/questions/45460820/why-does-it-apply-the-second-argument/45460997#45460997", "title": "Why does it apply the second argument?", "body": "<p>That's an <em>operator section</em>. A few simple examples:</p>\n\n<pre><code>Prelude&gt; (/2) &lt;$&gt; [1..8]\n[0.5,1.0,1.5,2.0,2.5,3.0,3.5,4.0]\nPrelude&gt; (:\"!\") &lt;$&gt; ['a'..'e']\n[\"a!\",\"b!\",\"c!\",\"d!\",\"e!\"]\n</code></pre>\n\n<p>The section <code>(:\"!\")</code> is syntactic sugar for <code>\\c -&gt; c:\"!\"</code>, i.e. it takes a character <code>c</code> and prepends it to the string <code>\"!\"</code>.</p>\n\n<p>Likewise, the section <code>($ 2)</code> takes a function <code>f</code> and simply <em>applies</em> it to the number <code>2</code>.</p>\n\n<p>Note that this is different from ordinary <em>partial application</em>:</p>\n\n<pre><code>Prelude&gt; ((/) 2) &lt;$&gt; [1..8]\n[2.0,1.0,0.6666666666666666,0.5,0.4,0.3333333333333333,0.2857142857142857,0.25]\n</code></pre>\n\n<p>Here, I've simply applied the function <code>(/)</code> to one fixed argument 2, the <em>dividend</em>. This can also be written as a <em>left section</em> <code>(2/)</code>. But the right section <code>(/2)</code> applies <code>2</code> as the <em>divisor</em> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1501680607, "post_id": 45461356, "comment_id": 77885049, "body": "Normal named functions can be made operators with backticks. Compare <code>(++&quot;foo&quot;)</code> and <code>(`mappend`&quot;foo&quot;)</code>."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501684221, "post_id": 45461356, "comment_id": 77888011, "body": "@DanielWagner Sure. But then you&#39;ve made it an operator. ;-) My point is there isn&#39;t a way to, say, miss out argument #6 or something..."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1501678206, "creation_date": 1501678206, "answer_id": 45461356, "question_id": 45460820, "link": "https://stackoverflow.com/questions/45460820/why-does-it-apply-the-second-argument/45461356#45461356", "title": "Why does it apply the second argument?", "body": "<p>You can do that with operator sections. For example:</p>\n\n<pre><code>(5+ )   -- Same as \\ x -&gt; 5+x\n( +5)   -- Same as \\ x -&gt; x+5\n</code></pre>\n\n<p>It's only <em>operators</em> you can do this with; normal named functions can only be curried from left to right.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1501948417, "last_edit_date": 1501948417, "creation_date": 1501703486, "answer_id": 45469802, "question_id": 45460820, "link": "https://stackoverflow.com/questions/45460820/why-does-it-apply-the-second-argument/45469802#45469802", "title": "Why does it apply the second argument?", "body": "<p>Haskell  cheat sheet <em>operator sections</em> entry could be:</p>\n\n<pre><code>(a `op` b)  =  (a `op`) b  =  (`op` b) a  =  (op) a b\n</code></pre>\n\n<p>When <code>op</code> is an actual operator (not an alpha-numerical name), backticks aren't needed. </p>\n\n<p>The above can be seen as partially applying implicitly defined lambda expressions:</p>\n\n<pre><code>(a `op`) b  =  (a `op` b)  =  (\\y -&gt; a `op` y) b  = (\\x y -&gt; x `op` y) a b  =  op a b\n(`op` b) a  =  (a `op` b)  =  (\\x -&gt; x `op` b) a  = (\\y x -&gt; x `op` y) b a  =  flip op b a\n</code></pre>\n\n<p>If a function <code>f</code> expects more than two arguments eventually, we can similarly create its curried version by partially applying an explicit lambda expression:</p>\n\n<pre><code>(\\y z x -&gt; f x y z) b c    -- = (\\x -&gt; f x b c) \n(\\x z y -&gt; f x y z) a c    -- = (\\y -&gt; f a y c) \n(\\x y z -&gt; f x y z) a b    -- = (\\z -&gt; f a b z)  \n</code></pre>\n\n<p>The last case is equivalent to just <code>f a b</code>, and the second to <code>(flip . f) a c</code>:</p>\n\n<pre><code>g b c a = f a b c = flip f b a c = flip (flip f b) c a = (flip . flip f) b c a\ng a c b = f a b c = flip (f a) c b = (flip . f) a c b\ng a b c = f a b c\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 45460997, "answer_count": 3, "score": 1, "last_activity_date": 1501948417, "creation_date": 1501676663, "question_id": 45460820, "link": "https://stackoverflow.com/questions/45460820/why-does-it-apply-the-second-argument", "title": "Why does it apply the second argument?", "body": "<p>I am trying to understand the Interchange law of applicative functor: </p>\n\n<pre><code>u &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u\n</code></pre>\n\n<p>What make me confuse is, the function application <code>$ y</code>, consider following example:  </p>\n\n<pre><code>($ 2) :: (a -&gt; b) -&gt; b \n</code></pre>\n\n<p>Why does the second argument get applied not the first?</p>\n"}, {"tags": ["windows", "haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501720931, "post_id": 45460406, "comment_id": 77907012, "body": "You should probably use the MinGW which is installed with GHC. There are minuscule differences between different versions of MinGW and the one shipping with GHC is the one it relies on getting (if you system version and the GHC version are identical, then I don&#39;t see how the behavior would differ). You&#39;ve stated the actual problem - &quot;issues with some native libraries .. [that] .. don&#39;t work when ran from Haskell code&quot; - it may be more fruitful to try to fix this problem rather than work around it. I&#39;ve had such a problem before, and that was the eventual solution (not using system MinGW)."}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501749829, "post_id": 45460406, "comment_id": 77918647, "body": "@user2407038 The solution in this case is replacing the zlib1.dll in GHC&#39;s MinGW with a newer version. I&#39;m fine with GHC using it&#39;s own DLLs, but there should be no reason to pollute the path. I&#39;m guessing a lot of packages wouldn&#39;t compile because they also rely on those DLLs, but why not at least APPEND to the PATH instead of prepending so there&#39;s a chance of overriding?"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501675531, "creation_date": 1501675531, "question_id": 45460406, "link": "https://stackoverflow.com/questions/45460406/instruct-stack-to-use-the-already-installed-mingw", "title": "Instruct stack to use the already installed MinGW", "body": "<p>I have msys2 installed separately from GHC. MinGW toolchain is installed inside of the msys environment. Now I'm running into issues with some native libraries that work when I use them outside of Haskell, but don't work when ran from Haskell code.</p>\n\n<p>The problem is that commands like <code>stack exec</code> and <code>stack repl</code> prepend GHC's MinGW folders to the PATH and then you get things like one dynamic library being found in my msys installation, while it's dependency is first found in GHC's MinGW installation and the whole thing doesn't work.</p>\n\n<p>Stack provides a <code>skip-msys</code> option to avoid using the msys environment that it installs, but as far as I can tell there's no way to skip the GHC-provided MinGW toolchain.</p>\n\n<p>What can I do about this?</p>\n"}, {"tags": ["haskell", "cardano"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1501674850, "post_id": 45460137, "comment_id": 77880260, "body": "<a href=\"https://stackoverflow.com/a/13481892/752976\">Relevant answer</a>"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1501678480, "post_id": 45460137, "comment_id": 77883230, "body": "For anybody else landing on this question via the search engine: <code>..</code> also has <i>another</i>, unrelated meaning in lists: <code>[1..5]</code>. Here it&#39;s syntax sugar for <code>enumFromTo</code>. You can probably find out about this if you search for &quot;list comprehensions&quot;."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1501694211, "post_id": 45460137, "comment_id": 77895126, "body": "Not just <code>enumFromTo</code>: that whole family of Enum functions have shorthand notations using <code>..</code> in different ways."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8400778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed079e2cba2a5886bcbdbf353bf9c2e?s=128&d=identicon&r=PG&f=1", "display_name": "user153438", "link": "https://stackoverflow.com/users/8400778/user153438"}, "edited": false, "score": 0, "creation_date": 1501674890, "post_id": 45460153, "comment_id": 77880291, "body": "Thanks for the answer, what if we don&#39;t use it?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 73, "user_id": 8400778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed079e2cba2a5886bcbdbf353bf9c2e?s=128&d=identicon&r=PG&f=1", "display_name": "user153438", "link": "https://stackoverflow.com/users/8400778/user153438"}, "edited": false, "score": 0, "creation_date": 1501675092, "post_id": 45460153, "comment_id": 77880438, "body": "@user153438 Then only the type itself is exported, but users can&#39;t see the constructors. It&#39;s an abstract type."}, {"owner": {"reputation": 73, "user_id": 8400778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed079e2cba2a5886bcbdbf353bf9c2e?s=128&d=identicon&r=PG&f=1", "display_name": "user153438", "link": "https://stackoverflow.com/users/8400778/user153438"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1501675259, "post_id": 45460153, "comment_id": 77880559, "body": "@melpomene thanks. Am I right it can still use the constructor?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 73, "user_id": 8400778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed079e2cba2a5886bcbdbf353bf9c2e?s=128&d=identicon&r=PG&f=1", "display_name": "user153438", "link": "https://stackoverflow.com/users/8400778/user153438"}, "edited": false, "score": 0, "creation_date": 1501675369, "post_id": 45460153, "comment_id": 77880658, "body": "@user153438 I&#39;ve added an example, hope it clarifies things a bit."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 3, "creation_date": 1501675738, "post_id": 45460153, "comment_id": 77880947, "body": "<i>export all constructors for this data type</i> \u2190 not only constructors, record fields as well."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501693871, "post_id": 45460153, "comment_id": 77894926, "body": "In general, you should either export <i>all</i> the constructors or <i>none</i> of them. The same syntax is used for class methods. It can make sense to (re-)export only some class methods."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 5, "last_activity_date": 1501687344, "last_edit_date": 1501687344, "creation_date": 1501674792, "answer_id": 45460153, "question_id": 45460137, "link": "https://stackoverflow.com/questions/45460137/what-does-mean/45460153#45460153", "title": "What does (..) mean?", "body": "<p>It means \"export all constructors and record fields for this data type\".</p>\n\n<p>When writing a module export list, there's three<sup>4</sup> ways you can export a data type:</p>\n\n<pre><code>module ModuleD(\n    D,       -- just the type, no constructors\n    D(..),   -- the type and all its constructors\n    D(DA)    -- the type and the specific constructor\n    ) where\n\ndata D = DA A | DB B\n</code></pre>\n\n<p>If you don't export any constructors, the type, well, can't be constructed, at least directly. This is useful if you e.g. want to enforce some runtime invariants on the data type:</p>\n\n<pre><code>module Even (evenInt, toInt) where\n\nnewtype EvenInt = EvenInt Int deriving (Show, Eq)\n\nevenInt :: Int -&gt; Maybe EvenInt\nevenInt x = if x `mod` 2 == 0 then Just x else Nothing\n\ntoInt :: EvenInt -&gt; Int\ntoInt (EvenInt x) = x\n</code></pre>\n\n<p>The caller code can now use this type, but only in the allowed manner:</p>\n\n<pre><code>x = evenInt 2\nputStrLn $ if isJust x then show . toInt . fromJust $ x else \"Not even!\"\n</code></pre>\n\n<hr>\n\n<p>As a side note, <code>toInt</code> is usually implemented indirectly via the record syntax for convenience:</p>\n\n<pre><code>data EvenInt = EvenInt { toInt :: Int }\n</code></pre>\n\n<p><sup>4</sup> See <a href=\"https://stackoverflow.com/a/45460532/752976\"><strong>@leftaroundabout</strong>'s answer</a></p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1501677029, "last_edit_date": 1501677029, "creation_date": 1501675859, "answer_id": 45460532, "question_id": 45460137, "link": "https://stackoverflow.com/questions/45460137/what-does-mean/45460532#45460532", "title": "What does (..) mean?", "body": "<p>The syntax of import/export lists has not much to do with the syntax of Haskell itself. It's just a comma-separated listing of everything you want to export from your module. Now, there's a problem there because Haskell really has two languages with symbols that may have the same name. This is particularly common with <code>newtype</code>s like the one in your example: you have a <em>type-level name</em> <code>SharedSeed :: *</code>, and also a value-level name (data constructor) <code>SharedSeed :: ByteString -&gt; SharedSeed</code>.</p>\n\n<p>This only happens with <em>uppercase</em> names, because lowercase at type level are always local type variables. Thus the convention in export lists that <em>uppercase names refer to types</em>.</p>\n\n<p>But just exporting the type does not allow users to actually <em>construct values of that type</em>. That's often prudent: not all internal-representation values might make legal values of the newtype (see <a href=\"https://stackoverflow.com/a/45460153/745903\">Bartek's example</a>), so then it's better to only export a safe <em>smart constructor</em> instead of the unsafe data constructor.</p>\n\n<p>But other times, you do want to make the data constructor available, certainly for multi-constructor types like <code>Maybe</code>. To that end, export lists have three syntaxes you can use:</p>\n\n<pre><code>module Pos.Core.Types(\n</code></pre>\n\n<ul>\n<li><p><code>SharedSeed (SharedSeed)</code> will export the constructor <code>SharedSeed</code>. In this case that's of course the only constructor anyway, but if there were other constructors they would <em>not</em> be exported with this syntax.</p></li>\n<li><p><code>SharedSeed (..)</code> will export <em>all</em> constructors. Again, in this case that's only <code>SharedSeed</code>, but for e.g. <code>Maybe</code> it would export both <code>Nothing</code> and <code>Just</code>.</p></li>\n<li><p><code>pattern SharedSeed</code> will export <code>ShareSeed</code> as a <em>standalone pattern</em> (independent of the export of the <code>ShareSeed</code> type). This requires the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/PatternSynonyms\" rel=\"noreferrer\"><code>-XPatternSynonyms</code> extension</a>.</p>\n\n<pre><code>)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 73, "user_id": 8400778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed079e2cba2a5886bcbdbf353bf9c2e?s=128&d=identicon&r=PG&f=1", "display_name": "user153438", "link": "https://stackoverflow.com/users/8400778/user153438"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1533751260, "creation_date": 1501674726, "last_edit_date": 1533751260, "question_id": 45460137, "link": "https://stackoverflow.com/questions/45460137/what-does-mean", "title": "What does (..) mean?", "body": "<p>I'm trying to learn Haskell.</p>\n\n<p>I'm reading the code on here[1]. I just copy and past some part of the code from lines:46 and 298-300. </p>\n\n<p><strong>Question</strong>: What does (..) mean? </p>\n\n<p>I Hoggled it but I got no result.</p>\n\n<pre><code>module Pos.Core.Types(\n-- something here\n\n SharedSeed (..) -- what does this mean?\n\n) where\n\n\nnewtype SharedSeed = SharedSeed\n{ getSharedSeed :: ByteString\n} deriving (Show, Eq, Ord, Generic, NFData, Typeable)\n</code></pre>\n\n<hr>\n\n<p>[1] <a href=\"https://github.com/input-output-hk/cardano-sl/blob/master/core/Pos/Core/Types.hs\" rel=\"nofollow noreferrer\">https://github.com/input-output-hk/cardano-sl/blob/master/core/Pos/Core/Types.hs</a></p>\n"}, {"tags": ["function", "haskell", "types", "polymorphism", "fibonacci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1501673474, "post_id": 45459637, "comment_id": 77879308, "body": "Because you do not use the input parameters in your output."}, {"owner": {"reputation": 215, "user_id": 8224815, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2e00dc51f47b166e66df0b3bb6eb849f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8224815/james"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501673672, "post_id": 45459637, "comment_id": 77879461, "body": "Sorry I didn&#39;t quite get what you said. @WillemVanOnsem"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1501674503, "last_edit_date": 1501674503, "creation_date": 1501673844, "answer_id": 45459823, "question_id": 45459637, "link": "https://stackoverflow.com/questions/45459637/how-can-two-similar-functions-have-different-polymorphic-types-in-haskell/45459823#45459823", "title": "How can two similar functions have different polymorphic types in Haskell?", "body": "<p>The difference is that in <code>fact</code>, you use the argument directly in an arithmetic expression which makes up the final result:</p>\n\n<pre><code>fact n | ...  = n * ...\n</code></pre>\n\n<p>IOW, if you write out the expanded arithmetic expression, <code>n</code> appears in it:</p>\n\n<pre><code>fact 3  \u2261  n * (n-1) * (n-2) * 1\n</code></pre>\n\n<p>This fixes that the argument must have the same type as the result, because</p>\n\n<pre><code>(*) :: Num n =&gt; n -&gt; n -&gt; n\n</code></pre>\n\n<p>Not so in <code>fib</code>: here the actual result is only composed of literals and of <em>sub</em>-results. IOW, the expanded expression looks like</p>\n\n<pre><code>fib 3  \u2261  (1 + 1) + 1\n</code></pre>\n\n<p>No <code>n</code> in here, so no unification between argument and result required.</p>\n\n<p>Of course, in both cases you also used <code>n</code> to decide how this arithmetic expression looks, but for that you've just used equality comparisons with literals, whose type is not connected to the final result.</p>\n\n<p>Note that you can also give <code>fib</code> a type-preservig signature: <code>(Eq a, Num a, Num t) =&gt; a -&gt; t</code> is strictly more general than <code>(Eq t, Num t) =&gt; t -&gt; t</code>. Conversely, you can make a <code>fact</code> that doesn't require input- and output to be the same type, by following it with a conversion function:</p>\n\n<pre><code>fact' :: (Eq a, Integral a, Num t) =&gt; a -&gt; t\nfact' = fromIntegral . fact\n</code></pre>\n\n<p>This doesn't make a lot of sense though, because <code>Integer</code> is pretty much the only type that can reliably be used in <code>fact</code>, but to achieve that in the above version you need to start out with <code>Integer</code>. Hence if anything, you should do the following:</p>\n\n<pre><code>fact'' :: (Eq t, Integral a, Num t) =&gt; a -&gt; t\nfact'' = fact . fromIntegral\n</code></pre>\n\n<p>This can then be used also as <code>Int -&gt; Integer</code>, which is somewhat sensible.</p>\n\n<p>I'd <em>recommend</em> to just keep the signature <code>(Eq t, Num t) =&gt; t -&gt; t</code> though, and only add conversion operations where it's actually needed. Or really, what I'd recommend is to <em>not use <code>fact</code> at all</em> \u2013 this is a very expensive function that's hardly ever really useful in practice; most applications that na\u00efvely end up with a factorial really just need something like <a href=\"https://en.wikipedia.org/wiki/Binomial_coefficient\" rel=\"nofollow noreferrer\">binomial coefficients</a>, and those can be implemented more efficiently without a factorial.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1501673922, "creation_date": 1501673922, "answer_id": 45459849, "question_id": 45459637, "link": "https://stackoverflow.com/questions/45459637/how-can-two-similar-functions-have-different-polymorphic-types-in-haskell/45459849#45459849", "title": "How can two similar functions have different polymorphic types in Haskell?", "body": "<p>Haskell always aims to derive the <em>most</em> generic type signature.</p>\n\n<p>Now for <code>fact</code>, we know that the <em>type of the output</em>, should be the same as the type of the input:</p>\n\n<pre><code>fact n | n == 0 = 1\n       | n &gt; 0  = n * (fact (n - 1))\n</code></pre>\n\n<p>This is due to the last line. We use <code>n * (fact (n-1))</code>. So we use a multiplication <code>(*) :: a -&gt; a -&gt; a</code>. Multiplication thus takes two members of the same type and returns a member of that type. Since we multiply with <code>n</code>, and <code>n</code> is input, the output is of the same type as the input. Since we use <code>n == 0</code>, we know that <code>(==) :: Eq a =&gt; a -&gt; a -&gt; Bool</code> so that means that that input type should have <code>Eq a =&gt;</code>, and furthermore <code>0 :: Num a =&gt; a</code>. So the resulting type is <code>fact :: (Num a, Eq a) =&gt; a -&gt; a</code>.</p>\n\n<p>Now for <code>fib</code>, we see:</p>\n\n<pre><code>fib n | n == 1 = 1\n      | n == 2 = 1\n      | n &gt; 2  = fib (n - 1) + fib (n - 2)\n</code></pre>\n\n<p>Now we know that for <code>n</code>, the type constraints are again <code>Eq a, Num a</code>, since we use <code>n == 1</code>, and <code>(==) :: Eq a =&gt; a -&gt; a -&gt; Bool</code> and <code>1 :: Num a =&gt; a</code>. But the <strong>input <code>n</code> is never directly used in the output</strong>. Indeed, the last line has <code>fib (n-1) + fib (n-2)</code>, but here <strong>we use <code>n-1</code> and <code>n-2</code> as input of a new call</strong>. So that means we can safely asume that the input type and the output type act independently. The output type, still has a type constraint: <code>Num t</code>: this is since we return <code>1</code> for the first two cases, and <code>1 :: Num t =&gt; t</code>, and we also return the addition of two outputs: <code>fib (n-1) + fib (n-2)</code>, so again <code>(+) :: Num t =&gt; t -&gt; t -&gt; t</code>.</p>\n"}], "owner": {"reputation": 215, "user_id": 8224815, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2e00dc51f47b166e66df0b3bb6eb849f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8224815/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 45459849, "answer_count": 2, "score": 4, "last_activity_date": 1501674503, "creation_date": 1501673382, "question_id": 45459637, "link": "https://stackoverflow.com/questions/45459637/how-can-two-similar-functions-have-different-polymorphic-types-in-haskell", "title": "How can two similar functions have different polymorphic types in Haskell?", "body": "<p>Im pretty much new to Haskell, so if Im missing key concept, please point it out.</p>\n\n<p>Lets say we have these two functions:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>fact n\n     | n == 0 = 1\n     | n &gt; 0  = n * (fact (n - 1))\n</code></pre>\n\n\n\n<p>The polymorphic type for <code>fact</code> is <strong><code>(Eq t, Num t) =&gt; t -&gt; t</code></strong> Because <code>n</code> is used in the if condition and n must be of valid type to do the <code>==</code> check. Therefor <code>t</code> must be a <code>Number</code> and <code>t</code> can be of any type within class constraint <code>Eq t</code> </p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>fib n\n    | n == 1 = 1\n    | n == 2 = 1\n    | n &gt; 2  = fib (n - 1) + fib (n - 2)\n</code></pre>\n\n\n\n<p>Then why is the polymorphic type of <code>fib</code> is <strong><code>(Eq a, Num a, Num t) =&gt; a -&gt; t</code></strong>?</p>\n\n<p>I don't understand, please help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501669359, "post_id": 45458087, "comment_id": 77876374, "body": "I don&#39;t understand your first question. As to the second: GHCi simply echoes the expression you asked about (<code>pure ((+1) 1) :: [Int]</code>) and then follows it with the inferred type (which is boring in this case, since you&#39;ve already written out explicitly what you want the type to be, leading to an exact duplication of the signature)."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501669667, "post_id": 45458087, "comment_id": 77876595, "body": "I edited my post. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1501670019, "creation_date": 1501670019, "answer_id": 45458393, "question_id": 45458087, "link": "https://stackoverflow.com/questions/45458087/confuse-about-pure-in-applicative-functor/45458393#45458393", "title": "Confuse about pure in applicative functor", "body": "<ol>\n<li><p><code>f</code> and <code>a</code> are both type variables. There is no concrete type. It will use whatever type is required by the surrounding context.</p></li>\n<li><p>When you type <code>:t EXPR</code>, ghci prints the type as <code>EXPR :: TYPE</code>. The first <code>:: [Int]</code> is part of the expression you typed; the second <code>:: [Int]</code> is the type computed by ghci.</p></li>\n</ol>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 45458393, "answer_count": 1, "score": 0, "last_activity_date": 1501670019, "creation_date": 1501669234, "last_edit_date": 1501669648, "question_id": 45458087, "link": "https://stackoverflow.com/questions/45458087/confuse-about-pure-in-applicative-functor", "title": "Confuse about pure in applicative functor", "body": "<p>I have following example with <code>pure</code> function:  </p>\n\n<pre><code>Prelude&gt; :t pure ((+1) 1)\npure ((+1) 1) :: (Num a, Applicative f) =&gt; f a\n</code></pre>\n\n<p>What is above the concrete type of <code>f</code> wrapped <code>a</code>?   </p>\n\n<p>For example, the <code>f</code>(structure) is here Maybe: </p>\n\n<pre><code>Prelude&gt; pure ((+1) 1) :: Maybe Int\nJust 2\n</code></pre>\n\n<p>and what is the structure of:</p>\n\n<pre><code>pure ((+1) 1)\n</code></pre>\n\n<p>?</p>\n\n<p><strong>The second example:</strong></p>\n\n<pre><code>Prelude&gt; :t pure ((+1) 1) :: [Int]\npure ((+1) 1) :: [Int] :: [Int]\n</code></pre>\n\n<p>Why does the GHCi show the type twice, namely <code>:: [Int] :: [Int]</code> not only <code>:: [Int]</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1501661196, "post_id": 45453841, "comment_id": 77870548, "body": "<a href=\"https://en.m.wikibooks.org/wiki/Haskell/Existentially_quantified_types\" rel=\"nofollow noreferrer\">en.m.wikibooks.org/wiki/Haskell/Existentially_quantified_typ&zwnj;&#8203;es</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1501664340, "post_id": 45453841, "comment_id": 77872723, "body": "While that wiki page gives an explanation of the meaning of <code>forall</code>, note well that the use of <code>forall</code> in the question does <i>not</i> construct an existential type as explained later on on in that page.  The only thing relevant to this question in that page is the &quot;The <code>forall</code> keyword&quot; section.  Just so you don&#39;t get confused."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1501686413, "post_id": 45453841, "comment_id": 77889807, "body": "From your profile it looks like you\u2019re familiar with C#? <code>Left :: forall a b. a -&gt; Either a b</code> is like <code>Either&lt;A, B&gt; Left&lt;A, B&gt; (A value)</code>. The Haskell <code>forall a b.</code> corresponds to the C# <code>&lt;A, B&gt;</code> in <code>Left&lt;A, B&gt;</code>\u2014it defines the scope of the generic type parameters. Ordinarily this is implicit in Haskell, but you can (and sometimes have to) write it explicitly with the <code>ExplicitForall</code>, <code>ScopedTypeVariables</code>, or <code>RankNTypes</code> extensions. Likewise, if you\u2019ve used C++, <code>forall a b.</code> is like <code>template&lt;typename A, typename B&gt;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1501668549, "last_edit_date": 1501668549, "creation_date": 1501667152, "answer_id": 45457279, "question_id": 45453841, "link": "https://stackoverflow.com/questions/45453841/forall-in-context-with-data-constructor/45457279#45457279", "title": "forall in Context with Data constructor", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Universal_quantification\" rel=\"noreferrer\"><code>\u2200</code> quantor, aka <code>forall</code></a>, is used implicitly in one way or another in <em>all</em> polymorphic Haskell signatures. For instance,</p>\n\n<pre><code>map :: \u2200 a b . (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>This is called <em>universal quantification</em>, and as you probably know it means that <em>for any</em> types <code>A</code> and <code>B</code> that you choose, <code>map</code> can be used as if it had the signature <code>(A -&gt; B) -&gt; [A] -&gt; [B]</code>.</p>\n\n<p>In Haskell98, this universal quantification with <code>\u2200 a b c ...</code> (all type variables that occur) right at the start of the signature was the <em>only</em> kind of polymorphism available, and it's still the most important. Hence this is implicit: when you see a signature with lowercase letters, the compiler knows that the signature really starts with <code>\u2200</code> over all these variables. So you can simply write</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>That also includes data constructors (which in expressions behave just like any other function. You'd normally write</p>\n\n<pre><code>Left :: a -&gt; Either a b\n</code></pre>\n\n<p>but as I said, this is really just shorthand for</p>\n\n<pre><code>Left :: \u2200 a b . a -&gt; Either a b\n</code></pre>\n\n<p>or indeed</p>\n\n<pre><code>Left :: forall a b . a -&gt; Either a b\n</code></pre>\n\n<p>In modern Haskell, it's sometimes necessary to use explicit quantors instead of the implicit ones. Namely,</p>\n\n<ul>\n<li><p>To \u201cre-use\u201d type variables from a top-level signature in a local signature. For instance, the following does not work:</p>\n\n<pre><code>foldl :: (b-&gt;a-&gt;b) -&gt; b -&gt; [a] -&gt; b\nfoldl f = go\n where go :: b -&gt; [a] -&gt; b\n       go acc [] = acc\n       go acc (x:xs) = go (f acc x) xs\n</code></pre>\n\n<p>The problem is that the local signature for <code>go</code>, due to the type variables therein, implies a new universal quantor, i.e. this really means</p>\n\n<pre><code>foldl :: \u2200 a b . (b-&gt;a-&gt;b) -&gt; b -&gt; [a] -&gt; b\nfoldl f = go\n where go :: \u2200 a' b' . b' -&gt; [a'] -&gt; b'\n       go acc [] = acc\n       go acc (x:xs) = go (f acc x) xs  -- error: could not match a with a'\n</code></pre>\n\n<p>However, <code>go</code> re-uses the same <code>f</code> that has already been bound in the <code>foldl f = ...</code> pattern, and that is <em>not</em> polymorphic (the types have already been fixed at that point), thus it's not possible to choose independent <code>a'</code> and <code>b'</code> type variables in <code>go</code>.<br>The solution is to enable <em>scoped type variables</em> and then write explicitly</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nfoldl :: \u2200 a b . (b-&gt;a-&gt;b) -&gt; b -&gt; [a] -&gt; b\nfoldl f = go\n where go :: b -&gt; [a] -&gt; b\n       go acc [] = acc\n       go acc (x:xs) = go (f acc x) xs\n</code></pre>\n\n<p>Here, GHC knows that I <em>don't</em> want implicit quantors (because I've already written one explicitly). Thus the <code>a</code> and <code>b</code> in the signature of <code>go</code> are now the same type as used on the top level.</p></li>\n<li><p>To allow parameters to be polymorphic. This is called higher-rank polymorphism. The problem is similar to the one above: as I said, the locally-bound <code>f</code> is <em>not</em> polymorphic. (It usually can't be \u2013 you want to be able to use <code>foldl</code> with a function that's specific to one particular element type!)<br>But in some application, a polymorphic function as and argument <em>is</em> what you want. For example, you might have a type that does arithmetic both in exact rational numbers and in quick-approximation floating point.</p>\n\n<pre><code>data ApproxAndExact = ApproxAndExact Double Rational\n</code></pre>\n\n<p>Now you want to perform operations on these numbers, but don't want to duplicate your code. So what you use is</p>\n\n<pre><code>onBothReprs :: (\u2200 n . Fractional n =&gt; n -&gt; n)\n         -&gt; ApproxAndExact -&gt; ApproxAndExact\nonBothReprs f (ApproxAndExact approx exact)\n          = ApproxAndExact (f approx) (f exact) -- note that both invocations\n                                                -- of f have different types!\n</code></pre>\n\n<p>This can then be used like</p>\n\n<pre><code>&gt; obBothReprs (+273) 1e+16\nApproxAndExact 1.0000000000000272e16 (10000000000000273 % 1)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 1, "accepted_answer_id": 45457279, "answer_count": 1, "score": 2, "last_activity_date": 1501668549, "creation_date": 1501657704, "question_id": 45453841, "link": "https://stackoverflow.com/questions/45453841/forall-in-context-with-data-constructor", "title": "forall in Context with Data constructor", "body": "<p>I read on <a href=\"https://wiki.haskell.org/Constructor#Data_constructor\" rel=\"nofollow noreferrer\">HaskellWiki</a> about Data constructor and consider following:</p>\n\n<blockquote>\n  <p>2.1 Data constructors as first class values  </p>\n  \n  <p>Data constructors are first class values in Haskell and actually have a type. For instance,\n  the type of the Left constructor of the Either data type is:   </p>\n  \n  <p><code>Left :: forall b a. a -&gt; Either a b</code>    </p>\n  \n  <p>As first class values, they may be passed\n  to functions, held in a list, be data elements of other algebraic data\n  types and so forth.</p>\n</blockquote>\n\n<p>What does <code>forall</code> above mean? </p>\n"}, {"tags": ["haskell", "encoding"], "comments": [{"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 0, "creation_date": 1501654899, "post_id": 45452696, "comment_id": 77866650, "body": "Why do you have <code>love,</code> with comma, but <code>like</code> without comma, though <code>like</code> is with comma in the sentence?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8257302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156c241fc481d03bd39b62950384727?s=128&d=identicon&r=PG&f=1", "display_name": "dsvjksv", "link": "https://stackoverflow.com/users/8257302/dsvjksv"}, "edited": false, "score": 0, "creation_date": 1501658033, "post_id": 45453628, "comment_id": 77868549, "body": "i wanted the function to take in the list of input from users not a specified words"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 1, "last_activity_date": 1501657682, "last_edit_date": 1501657682, "creation_date": 1501657103, "answer_id": 45453628, "question_id": 45452696, "link": "https://stackoverflow.com/questions/45452696/haskell-text-encoder/45453628#45453628", "title": "Haskell text encoder", "body": "<p>You can just iterate over the list of words and accumulate the unique words and its indexes. If the element is in the accumulated list, append the index to the accumulated list of indexes. If the element isn't in the list, append the new index (length of the list of words + 1).</p>\n\n<p>To be honest, <code>Haskell</code> code is more understandable, than my description:</p>\n\n<pre><code>import Data.List (findIndex)\n\nbuild :: ([String], [Int]) -&gt; String -&gt; ([String], [Int])\nbuild (words, indexes) word =\n  let\n    maybeIndex = findIndex (== word) words\n  in\n    case maybeIndex of\n      Just index -&gt;\n        (words, indexes ++ [index + 1])\n      Nothing -&gt;\n        (words ++ [word], indexes ++ [(+1) . length $ words])\n\nbuildIndexes =\n  let\n    listOfWords = words \"The more I like, the more I love. The more I love, the more I hate.\"\n  in\n    foldl build ([], []) listOfWords\n</code></pre>\n\n<p>Here I have a concatenated string as an input</p>\n\n<p><code>\"The more I like, the more I love. The more I love, the more I hate.\"</code></p>\n\n<p>Feel free to tailor the code for your needs.</p>\n\n<p>By the way, it might be more performant to insert the elements at the beginning of the lists and then reverse the resulting lists.</p>\n\n<pre><code>import Data.List (findIndex)\n\nbuild :: ([String], [Int]) -&gt; String -&gt; ([String], [Int])\nbuild (words, indexes) word =\n  let\n    maybeIndex = findIndex (== word) words\n  in\n    case maybeIndex of\n      Just index -&gt;\n        (words, (index + 1) : indexes)\n      Nothing -&gt;\n        (word : words, ((+1) . length $ words) : indexes)\n\nbuildIndexes =\n  let\n    listOfWords = words \"The more I like, the more I love. The more I love, the more I hate.\"\n    (listOfUniqueWords, listOfIndexes) = foldl build ([], []) listOfWords\n  in\n    (reverse listOfUniqueWords, reverse listOfIndexes)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1501688846, "creation_date": 1501688846, "answer_id": 45465425, "question_id": 45452696, "link": "https://stackoverflow.com/questions/45452696/haskell-text-encoder/45465425#45465425", "title": "Haskell text encoder", "body": "<p>I guess the <code>Data.Map</code> and <code>Data.Set</code> packages are ideal tools to solve this job efficiently. My implementation would be as follows;</p>\n\n<pre><code>import qualified Data.Map.Lazy as Map\nimport qualified Data.Set as Set\n\nencode :: [String] -&gt; ([String],[[Int]])\nencode wss = let dict = Map.fromList . zip (Set.toList . Set.unions . map (Set.fromList . words) $ wss) $ [1..]\n             in (map fst $ Map.toList dict, map (map (flip (Map.findWithDefault 0) dict) . words) wss)\n\n*Main&gt; encode [\"Are you allright\", \"Hey there how are you\", \"Hello there\", \"Do you like coffee\"]\n([\"Are\",\"Do\",\"Hello\",\"Hey\",\"allright\",\"are\",\"coffee\",\"how\",\"like\",\"there\",\"you\"],[[1,11,5],[4,10,8,6,11],[3,10],[2,11,9,7]])\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8257302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156c241fc481d03bd39b62950384727?s=128&d=identicon&r=PG&f=1", "display_name": "dsvjksv", "link": "https://stackoverflow.com/users/8257302/dsvjksv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1501688846, "creation_date": 1501654147, "last_edit_date": 1501654298, "question_id": 45452696, "link": "https://stackoverflow.com/questions/45452696/haskell-text-encoder", "title": "Haskell text encoder", "body": "<p>I am new to Haskell and would like some direction to solving my problem. I wanted to have a text encode function that list in which each word of the text is represented by its index. For e.g. : </p>\n\n<pre><code>[\"The more I like, the more I love.\",\"The more I love, the more I hate.\"]\n</code></pre>\n\n<p>the output might be</p>\n\n<pre><code>   ([\"The\", \"more\", \"I\", \"like\", \"the\", \"love.\", \"love,\", \"hate.\"],\n   [1, 2, 3, 4, 5, 2, 3, 6, 1, 2, 3, 7, 1, 2, 3, 8])\n</code></pre>\n\n<p>I have done the remove duplication part</p>\n\n<pre><code>removeDuplicates :: Eq a =&gt; [a] -&gt; [a]\nremoveDuplicates = rdHelper []\n  where rdHelper seen [] = seen\n          rdHelper seen (x:xs)\n            | x `elem` seen = rdHelper seen xs\n            | otherwise = rdHelper (seen ++ [x]) xs\n</code></pre>\n"}, {"tags": ["haskell", "web", "yesod"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501673448, "post_id": 45452065, "comment_id": 77879291, "body": "&quot;I can not publish proprietary application code&quot; - this does not relieve you of the requirement of creating a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. Without the code producing this problem, it is entirely impossible for anybody here to identify the cause (making the question off-topic)."}, {"owner": {"reputation": 223, "user_id": 8198583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2yJ0.png?s=128&g=1", "display_name": "ncaq", "link": "https://stackoverflow.com/users/8198583/ncaq"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1502078746, "post_id": 45452065, "comment_id": 78038529, "body": "It also happens with <a href=\"https://github.com/ncaq/try-pandoc-with-file\" rel=\"nofollow noreferrer\">ncaq/try-pandoc-with-file: try pandoc! With file</a>, but is not it?"}], "owner": {"reputation": 223, "user_id": 8198583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2yJ0.png?s=128&g=1", "display_name": "ncaq", "link": "https://stackoverflow.com/users/8198583/ncaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501651248, "creation_date": 1501651248, "question_id": 45452065, "link": "https://stackoverflow.com/questions/45452065/applications-written-by-yesod-sometimes-stop-responding", "title": "Applications written by Yesod sometimes stop responding", "body": "<p>Applications written by Yesod sometimes stop responding</p>\n\n<p>I write a proprietary web application with Yesod with <a href=\"https://github.com/ncaq/try-pandoc-with-file\" rel=\"nofollow noreferrer\">ncaq/try-pandoc-with-file: try pandoc! with file</a>.\nI can not publish proprietary application code.</p>\n\n<p>I am troubled that these applications sometimes stop responding.\nEspecially, proprietary applications will not respond at about once a day cycle.</p>\n\n<p>The process is still running, it is not finished, no error is seen even if you look at the log with journalctl, so I do not know the cause at all.</p>\n\n<p>I confirm that I have fallen by the health check of Route 53 now and restart it every time I fall.</p>\n\n<p>I am very embarrassed.</p>\n\n<p>Does anyone know the solution, or how to debug?</p>\n\n<p>Application deployment is done by starting application from stack from systemd and applying reverse proxy with nginx.</p>\n\n<p>Because I am not good at English, this sentence is subject to google translation.The original text is also shown below.</p>\n\n<hr>\n\n<p>Yesod\u3067\u66f8\u3044\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u6642\u3005\u5fdc\u7b54\u3057\u306a\u304f\u306a\u308b</p>\n\n<p>\u79c1\u306f<a href=\"https://github.com/ncaq/try-pandoc-with-file\" rel=\"nofollow noreferrer\">ncaq/try-pandoc-with-file: try pandoc! with file</a>\u3068,\u30d7\u30ed\u30d7\u30e9\u30a4\u30a8\u30bf\u30ea\u306eweb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092Yesod\u3067\u66f8\u3044\u3066\u3044\u307e\u3059.\n\u30d7\u30ed\u30d7\u30e9\u30a4\u30a8\u30bf\u30ea\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30b3\u30fc\u30c9\u306f\u516c\u958b\u3067\u304d\u307e\u305b\u3093.\u3054\u3081\u3093\u306a\u3055\u3044.</p>\n\n<p>\u3053\u308c\u3089\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u6642\u3005\u5fdc\u7b54\u3057\u306a\u304f\u306a\u308b\u3053\u3068\u306b\u56f0\u3063\u3066\u3044\u307e\u3059.\n\u7279\u306b,\u30d7\u30ed\u30d7\u30e9\u30a4\u30a8\u30bf\u30ea\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u65b9\u306f1\u65e5\u306b1\u56de\u7a0b\u5ea6\u306e\u5468\u671f\u3067\u5fdc\u7b54\u3057\u306a\u304f\u306a\u308a\u307e\u3059.</p>\n\n<p>\u30d7\u30ed\u30bb\u30b9\u306f\u52d5\u3044\u305f\u307e\u307e\u3067,\u7d42\u4e86\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3082\u306a\u304f,journalctl\u3067\u30ed\u30b0\u3092\u898b\u3066\u3082\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u306a\u3044\u306e\u3067,\u539f\u56e0\u304c\u5168\u7136\u308f\u304b\u308a\u307e\u305b\u3093.</p>\n\n<p>\u73fe\u5728Route53\u306e\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u3067\u843d\u3061\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066,\u843d\u3061\u308b\u305f\u3073\u306b\u518d\u8d77\u52d5\u3092\u3057\u3066\u3044\u307e\u3059.</p>\n\n<p>\u3068\u3066\u3082\u56f0\u3063\u3066\u3044\u307e\u3059.</p>\n\n<p>\u3069\u306a\u305f\u304b,\u89e3\u6c7a\u65b9\u6cd5,\u3082\u3057\u304f\u306f\u30c7\u30d0\u30c3\u30b0\u3059\u308b\u65b9\u6cd5\u3092\u77e5\u3089\u306a\u3044\u3067\u3057\u3087\u3046\u304b?</p>\n\n<p>\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d7\u30ed\u30a4\u306f,systemd\u304b\u3089stack\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3057\u3066,nginx\u3067\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3092\u304b\u3051\u308b\u3068\u3044\u3046\u65b9\u6cd5\u3067\u884c\u3063\u3066\u3044\u307e\u3059.</p>\n\n<p>\u79c1\u306f\u82f1\u8a9e\u304c\u5f97\u610f\u3067\u306f\u306a\u3044\u305f\u3081,\u3053\u306e\u6587\u7ae0\u306fgoogle\u7ffb\u8a33\u306b\u304b\u3051\u3089\u308c\u307e\u3059.\u539f\u6587\u3092\u4e0b\u306b\u4f75\u8a18\u3057\u307e\u3059.</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1501626243, "post_id": 45446696, "comment_id": 77858319, "body": "Snap is doing exactly what you asked. Consider setting the content type appropriately and sending a full HTML document. If you do both of those, your browser is more likely to do what you expect. However you&#39;re inspecting the browser state, it&#39;s telling you how it renders plaintext documents as DOM nodes"}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1501675380, "post_id": 45446696, "comment_id": 77880667, "body": "Thanks. I was way off. That did it."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1501697865, "post_id": 45446696, "comment_id": 77897301, "body": "Yikes. After re-reading my comment, it sounds way more curt than I meant. Sorry about that, and I&#39;m glad you sorted things out."}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1501699760, "post_id": 45446696, "comment_id": 77898443, "body": "Thanks for that, I did have to take a deep breath and read through a few times. In the end, it sorted me right out. So thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1501676831, "creation_date": 1501676831, "answer_id": 45460881, "question_id": 45446696, "link": "https://stackoverflow.com/questions/45446696/how-to-return-unescaped-response-in-snap-web-application/45460881#45460881", "title": "How to return unescaped response in Snap web application", "body": "<p>You don't. </p>\n\n<p>As Carl pointed out in the comment to my question, it was not \"escaped\" to begin with. What I was seeing was the browsers rendition of the plaintext document. Simply sending a properly formatted document gives me what I was expecting.</p>\n\n<pre><code>aPage :: Handler App App ()\naPage = do \n  writeText \"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;This is a page&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\"\n</code></pre>\n\n<p>After fiddling with Blaze-html and Lucid, two libraries for generating html, I was sure some sort of formatting was going on under the hood and thought some sort of <code>toHtmlRaw</code> function was needed. Not at all the answer I was expecting.</p>\n"}], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501676831, "creation_date": 1501617637, "question_id": 45446696, "link": "https://stackoverflow.com/questions/45446696/how-to-return-unescaped-response-in-snap-web-application", "title": "How to return unescaped response in Snap web application", "body": "<p>I want to return some preformatted html in a snap application. However, when the handler below is served,</p>\n\n<pre><code>aPage :: Handler App App ()\naPage = do \n  writeText \"&lt;p&gt;This is a page&lt;/p&gt;\"\n</code></pre>\n\n<p>The output is couched in &lt; pre > tags.</p>\n\n<pre><code>...&lt;body&gt;&lt;pre&gt;&lt;p&gt;This is a page&lt;/p&gt;&lt;/pre&gt;&lt;/body&gt; ...\n</code></pre>\n\n<p>Is there a simple way to add a verbatim string to the response body?</p>\n"}, {"tags": ["haskell", "combobox", "gtk2hs"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "edited": false, "score": 0, "creation_date": 1501624906, "post_id": 45447328, "comment_id": 77857857, "body": "Now the compilation fail with this: Couldn&#39;t match type \u2018T.Text\u2019                    with \u2018text-1.2.2.0:Data.Text.Internal.Text\u2019     NB: \u2018T.Text\u2019           is defined in \u2018Data.Text.Internal\u2019 in package \u2018text-1.2.2.2\u2019         \u2018text-1.2.2.0:Data.Text.Internal.Text\u2019           is defined in \u2018Data.Text.Internal\u2019 in package \u2018text-1.2.2.0\u2019     Expected type: ComboBoxText       Actual type: T.Text     In the second argument of \u2018comboBoxAppendText\u2019, namely       \u2018(T.pack &quot;Option 1&quot;)\u2019     In a stmt of a &#39;do&#39; block:       comboBoxAppendText cb (T.pack &quot;Option 1&quot;)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "edited": false, "score": 0, "creation_date": 1501630459, "post_id": 45447328, "comment_id": 77859522, "body": "@Hamburguesa66 That sounds like you have built gtk2hs with version 1.2.2.0 of the <code>text</code> package but are building your executable with version 1.2.2.2. If you are building with ghc, use <code>ghc-pkg</code> to hide all but version 1.2.2.0; if you are building with cabal, try adding <code>--constraint text=1.2.2.0</code> to your <code>configure</code>, <code>install</code>, or <code>new-build</code> command."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1501620098, "creation_date": 1501620098, "answer_id": 45447328, "question_id": 45445882, "link": "https://stackoverflow.com/questions/45445882/create-a-combobox-widget-in-gtk2hs/45447328#45447328", "title": "Create a ComboBox widget in Gtk2HS", "body": "<p>I recommend using the <a href=\"http://hackage.haskell.org/package/gtk3\" rel=\"nofollow noreferrer\">documentation on Hackage</a>. The documentation you linked is probably a decade stale by now.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/gtk3-0.14.6/docs/Graphics-UI-Gtk-MenuComboToolbar-ComboBox.html#t:ComboBoxText\" rel=\"nofollow noreferrer\">From that documentation</a>, we have</p>\n\n<pre><code>type ComboBoxText = Text\ncomboBoxAppendText :: ComboBoxClass self =&gt; self -&gt; ComboBoxText -&gt; IO Int\n</code></pre>\n\n<p>You are passing <code>\"Option 1\"</code> as the <code>ComboBoxText</code> argument. In vanilla Haskell, this is a <code>String</code> rather than a <code>Text</code> -- as the error says. You can either <code>pack</code> the <code>String</code>, as in</p>\n\n<pre><code>import qualified Data.Text as T\ncomboBoxAppendText cb (T.pack \"Option 1\")\n</code></pre>\n\n<p>or turn on <code>OverloadedStrings</code> to have this automatically done for <code>String</code> literals, as in:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\ncomboBoxAppendText cb \"Option 1\"\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501785149, "creation_date": 1501614575, "last_edit_date": 1501785149, "question_id": 45445882, "link": "https://stackoverflow.com/questions/45445882/create-a-combobox-widget-in-gtk2hs", "title": "Create a ComboBox widget in Gtk2HS", "body": "<p>I want to create a ComboBox widget with this code:</p>\n\n<pre><code>void initGUI\n  window &lt;- windowNew\n\n  ...\n\n  cb &lt;- comboBoxNewText\n  comboBoxAppendText cb \"Option 1\"\n  comboBoxAppendText cb \"Option 2\"\n  comboBoxSetActive cb 0\n  boxPackStart hb cb PackNatural 0\n\n  ...\n</code></pre>\n\n<p>But this error appears: </p>\n\n<pre><code>Couldn't match type \u2018[Char]\u2019\n                   with \u2018text-1.2.2.0:Data.Text.Internal.Text\u2019\n    Expected type: ComboBoxText\n      Actual type: [Char]\n    In the second argument of \u2018comboBoxAppendText\u2019, namely\n      \u2018\"Secuencial\"\u2019\n    In a stmt of a 'do' block: comboBoxAppendText cb \"Secuencial\"\n    In the expression:\n      do { void initGUI;\n           window &lt;- windowNew;\n           set\n             window\n             [windowTitle := \"A title\",\n              windowDefaultWidth := 1024, ....];\n           vb &lt;- vBoxNew False 7;\n           .... }\n</code></pre>\n\n<p>I am just following this tutorial (<a href=\"http://www.muitovar.com/gtk2hs/chap4-2.html\" rel=\"nofollow noreferrer\">http://www.muitovar.com/gtk2hs/chap4-2.html</a>) and reading the docs (<a href=\"http://projects.haskell.org/gtk2hs/docs/gtk2hs-docs-0.9.12/Graphics-UI-Gtk-ModelView-ComboBox.html#v%3AcomboBoxInsertText\" rel=\"nofollow noreferrer\">http://projects.haskell.org/gtk2hs/docs/gtk2hs-docs-0.9.12/Graphics-UI-Gtk-ModelView-ComboBox.html#v%3AcomboBoxInsertText</a>)</p>\n\n<p><strong>How can i make it work?</strong></p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1501611994, "post_id": 45444863, "comment_id": 77851206, "body": "@leftaroundabout This is really non-obvious duplicate..."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501613374, "post_id": 45444863, "comment_id": 77851976, "body": "@EugeneSh. you&#39;re right, this wasn&#39;t a very good match. I added a better one to the duplicates-list, we could certainly find more yet. The essential issue has been asked about plenty of times already, so I really rather wouldn&#39;t keep this question open."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1501614723, "post_id": 45444863, "comment_id": 77852772, "body": "Also compare <code>:t 1</code> to <code>:t &#39;a&#39;</code>, and look at <code>:t 1 + 2</code>.  Then try <code>:t (1::Int):2</code>."}, {"owner": {"reputation": 1, "user_id": 8401341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cbc3fc3df54327c25ef2a256f6a91b?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish ", "link": "https://stackoverflow.com/users/8401341/ashish"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1501638450, "post_id": 45444863, "comment_id": 77861461, "body": "So @molbdnilo, basically, the reason that we get no error with <code>Num</code> case is because its a typeclass and we can have some type in the numeric hierarchy with the given type while <code>Char</code> is a specific type and here the system knows its wrong to say <code>&#39;a&#39;:&#39;b&#39;</code> that&#39;s why it gave that error, right?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1501764371, "post_id": 45444863, "comment_id": 77929689, "body": "Yeah, something like that, I think. (I&#39;m not an expert). <i>If</i> you had a type <code>a</code> such that both <code>a</code> and <code>[a]</code> were instances of <code>Num</code>, the first would be valid. (Note that <code>1</code> and <code>2</code> have different types in <code>1:2</code>. Mysterious creature, that Haskell.)"}], "owner": {"reputation": 1, "user_id": 8401341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cbc3fc3df54327c25ef2a256f6a91b?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish ", "link": "https://stackoverflow.com/users/8401341/ashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "closed_date": 1501611116, "answer_count": 0, "score": 0, "last_activity_date": 1501613451, "creation_date": 1501610708, "last_edit_date": 1501613451, "question_id": 45444863, "link": "https://stackoverflow.com/questions/45444863/checking-the-type-in-ghci-gives-weird-output-why", "closed_reason": "Duplicate", "title": "Checking the type in GHCi gives weird output, why?", "body": "<p>On running the following in GHCi:</p>\n\n<pre><code>:t 1:2\n</code></pre>\n\n<p>I get as output:</p>\n\n<p><code>(Num [a], Num a) =&gt; [a]</code></p>\n\n<p>While, running the following:</p>\n\n<pre><code>:t 'a':'b'\n</code></pre>\n\n<p>Gives me an error.</p>\n\n<p>Personally, i fell that it should be a type error, but in case of <code>Num</code> that's not the case. Can anyone explain what's happening here?</p>\n\n<hr>\n\n<p>What I mean is that, of course it shouldn't work, but <strong><em>checking the type</em></strong> in the <code>Num</code> case gives a result while in case of <code>Char</code> it gives an error.</p>\n"}, {"tags": ["haskell", "monads", "state-monad"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1501584851, "post_id": 45435845, "comment_id": 77832364, "body": "Are you talking about anything other than <code>step 1 &gt;&gt; step 2 &gt;&gt; step 3</code>?"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1501586492, "post_id": 45435845, "comment_id": 77833459, "body": "@Cubic, I have amended my question."}], "answers": [{"comments": [{"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501589208, "post_id": 45437113, "comment_id": 77835496, "body": "my mistake, answered without testing, sorry. its only returning the outputs, will post fix."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501590288, "post_id": 45437113, "comment_id": 77836270, "body": "any chance you can explain how the traverse works in this case. Sorry, I have really hit a wall with State Monad just can&#39;t get my head around it. I don&#39;t get what is being (or how it is being) passed to <code>step</code> at each point."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501590454, "post_id": 45437113, "comment_id": 77836403, "body": "How do I get the  final value from the first result and use it for the second? I seem to only be able to access the state in this way?"}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501590681, "post_id": 45437113, "comment_id": 77836554, "body": "I shouldn&#39;t have brought up traverse, just more confusion for you. Traverse works the same as mapM in this case, but you can also use it for mapping monadic functions over things which are not lists, but are list like enough. For example Trees."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501591425, "post_id": 45437113, "comment_id": 77837141, "body": "what I mean re; traverse or mapM was that I dont see how it uses the previous value at each step. (and the results suggest it actually isnt??)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501593223, "post_id": 45437113, "comment_id": 77838597, "body": "@matthias <code>step n &gt;&gt; step m</code> makes <code>step m</code> be run on the state as modified by <code>stem n</code>. <code>traverse</code> and the like is not that different. The state monad always carries an implicit state mutable variable with it -- that&#39;s its goal."}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1501593311, "post_id": 45437113, "comment_id": 77838679, "body": "The inclusion of greedy in the question is helpful. I reimplemented go by just making the state the accumulator term."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501598503, "post_id": 45437113, "comment_id": 77842979, "body": "thank you! It helps. Although I think I am going to continue to struggle with the State Monad. (There seems to be no simple (enough) examples of its use) :( Thanks again."}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1501642549, "post_id": 45437113, "comment_id": 77862467, "body": "Yeah, it might take a while. You are"}], "tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": true, "score": 5, "last_activity_date": 1542268774, "last_edit_date": 1542268774, "creation_date": 1501588450, "answer_id": 45437113, "question_id": 45435845, "link": "https://stackoverflow.com/questions/45435845/chaining-state-monad/45437113#45437113", "title": "Chaining State Monad", "body": "<p>The function, </p>\n\n<pre><code>mapM step [25,10,5,1]\n</code></pre>\n\n<p>or the more general</p>\n\n<pre><code>traverse step [25,10,5,1]\n</code></pre>\n\n<p>runs <code>step</code> on each of the list of <code>[25,10,5,1]</code>. Invoking </p>\n\n<pre><code>runState  (mapM step [25,10,5,1]) 41\n</code></pre>\n\n<p>runs the function with the initial state set to <code>41</code>, returning the list of step outputs and the final state.</p>\n\n<pre><code>([16,1,0,0],0)\n</code></pre>\n\n<p>If you want to list the states along with the output, just modify <code>step</code> to include them.</p>\n\n<pre><code>step n = get &gt;&gt;= \\x -&gt;  put  (x `div` n) &gt;&gt; return ((x `mod` n),(x `div` n))\n</code></pre>\n\n<p>or, put another way</p>\n\n<pre><code>step n = do \n  x &lt;- get\n  let (r,x') = (x `mod` n,x `div` n)\n  put  x'\n  return (r,x')\n</code></pre>\n\n<p>The result is, <code>([(16,1),(1,0),(0,0),(0,0)],0)</code>, still not what you are looking for, but closer. I'm afraid I don't understand the particulars of your equation well enough to get what you are looking for, but this should help sort out the State part, allowing you to focus on the math.</p>\n\n<p>To make the above <code>go</code> function:</p>\n\n<pre><code>go n = do\n   (r,c) &lt;- get\n   let (r',c') = (r `mod` n, c + (r `div` n))\n   put (r',c')\n   return (r',c')\n</code></pre>\n\n<p>and </p>\n\n<pre><code>runState (mapM go [25,10,5,1]) (41,0)\n</code></pre>\n\n<p>yields,</p>\n\n<pre><code>([(16,1),(6,2),(1,3),(0,4)],(0,4))\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 45437113, "answer_count": 1, "score": 1, "last_activity_date": 1542268774, "creation_date": 1501584785, "last_edit_date": 1501601266, "question_id": 45435845, "link": "https://stackoverflow.com/questions/45435845/chaining-state-monad", "title": "Chaining State Monad", "body": "<p>I have a function </p>\n\n<pre><code>step :: Int -&gt; State Int Int\nstep n = get &gt;&gt;= \\x -&gt;  put  (x `div` n) &gt;&gt; return (x `mod` n)\n\n\u03bb&gt; runState (step 25) 41\n(16,1)\n</code></pre>\n\n<p>How do I run a sequence of <code>step</code>s, with different values of <code>n</code> and each step using the state from the last step?</p>\n\n<p>so for example the steps would be as follows</p>\n\n<p>step one  yields <code>(16,1)</code> which I then want to use as input for my next step with <code>n = 10</code> which should yield <code>(6, 2)</code>. With the 1 from the first step being added to and the 16 in step one being mod with the new n.</p>\n\n<pre><code>n = 25 gives (16,1) then\nn = 10 gives (6,2)  then\nn = 5  gives (1,3) then\nn = 1 gives (0,4)\n</code></pre>\n\n<p>I am aware that using <code>State</code> here might not be correct; but I am trying to use it as a way to learn.</p>\n\n<p>may aim is to implement this function with the state monad.</p>\n\n<pre><code>greedy :: Double -&gt; Int\ngreedy owed = snd $ foldl go (pennies,0) [25, 10, 5, 1]\n  where\n    pennies                     = floor . (*100) $ owed\n    go (remaining,counter) coin = (remaining',counter')\n      where\n        remaining' = remaining `mod` coin\n        counter'   = counter + remaining `div` coin\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1501540810, "post_id": 45426268, "comment_id": 77814037, "body": "The point is type families are not &#39;type-level functions&#39;. They are &#39;families of types&#39;. You should view the syntactic similarities between value-level pattern matching and type family instance declarations as a coincidence - the two have entirely different semantics (e.g. try writing the value-level function which matches on the constructor <code>Left :: a -&gt; Either a b</code>). You&#39;ve already witnessed a minimal example of the difference. The 2nd type family is basically just a type synonym, as it can only have a single instance. The 1st is a proper type family."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1501541485, "post_id": 45426268, "comment_id": 77814248, "body": "I wish I had a simple way of explaining the difference between a &#39;type-level function&#39; and a &#39;family of types&#39;, but I don&#39;t. The difference comes down to the fact that the 1st type family cannot be partially applied (nor can the 2nd, of course, but any use of the 2nd is a saturated application, as it takes 0 arguments) - in other words, the 1st type family doesn&#39;t have a kind which can be assigned to it in the Haskell type system."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 13, "last_activity_date": 1501543255, "creation_date": 1501543255, "answer_id": 45426700, "question_id": 45426268, "link": "https://stackoverflow.com/questions/45426268/kind-signatures-and-type-families/45426700#45426700", "title": "Kind signatures and Type families", "body": "<p>Yes, there is a subtle difference.</p>\n\n<p>Roughly, <code>type family F a :: *-&gt;*</code> states that, say, <code>F Int</code> is an <em>injective</em> type constructor like <code>[]</code>, <code>Maybe</code>. This is exploited by the compiler, which can type check the following code:</p>\n\n<pre><code>type family F a :: * -&gt; *\n\n-- these three examples can be removed / changed, if wished\ntype instance F Int = []\ntype instance F Char = Maybe\ntype instance F Bool = (,) String\n\nfoo :: (F Int a :~: F Int b) -&gt; (a :~: b)\nfoo Refl = Refl\n</code></pre>\n\n<p>To type check the above, the compiler exploited the fact that \n<code>F Int a ~ F Int b</code> implies <code>a ~ b</code>, which follows from injectivity.</p>\n\n<p>Instead, declaring <code>type family F a b :: *</code> does not ensure injectivity of <code>F Int</code>, since the following becomes legal.</p>\n\n<pre><code>type family F a b :: *\ntype instance F Int a = ()\n</code></pre>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 45426700, "answer_count": 1, "score": 6, "last_activity_date": 1501543255, "creation_date": 1501540181, "question_id": 45426268, "link": "https://stackoverflow.com/questions/45426268/kind-signatures-and-type-families", "title": "Kind signatures and Type families", "body": "<p>I expect</p>\n\n<pre><code>type family Rep a\n</code></pre>\n\n<p>and </p>\n\n<pre><code>type family Rep :: * -&gt; *\n</code></pre>\n\n<p>to be the same, but it seems there is a difference</p>\n\n<pre><code>type family   Rep a\ntype instance Rep Int  = Char\n-- ok\n\ntype family   Rep :: * -&gt; *\ntype instance Rep Int  = Char\n-- Expected kind * -&gt; *, but got 'Int' instead\n</code></pre>\n\n<p>Have I simply stumbled over an Haskell extension bug, or is there some point to this behavior?</p>\n"}, {"tags": ["haskell", "devil", "repa"], "comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1501538808, "post_id": 45425794, "comment_id": 77813436, "body": "Have you tried saving an image to a file that already exists? What happened in that case?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501538994, "post_id": 45425794, "comment_id": 77813514, "body": "If that doesn&#39;t work, you can check whether the file exists with <a href=\"http://hackage.haskell.org/package/directory-1.3.1.1/docs/System-Directory.html#v:doesFileExist\" rel=\"nofollow noreferrer\"><code>doesFileExist</code></a> and delete it before you save the new file."}, {"owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501543065, "post_id": 45425794, "comment_id": 77814637, "body": "When i save an image to a file that already exist, the program exits with a message (&quot;Unable to save file&quot;). I check the DevIL source code and i didnt get any answer. I will try what you said. Thanks!"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501543961, "post_id": 45425794, "comment_id": 77814836, "body": "I&#39;ll write up an answer then."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "edited": false, "score": 0, "creation_date": 1501550691, "post_id": 45426807, "comment_id": 77816394, "body": "I just got this error, &quot;Couldn&#39;t match expected type \u2018Bool\u2019 with actual type \u2018IO Bool\u2019&quot;. What can it be?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "edited": false, "score": 0, "creation_date": 1501550876, "post_id": 45426807, "comment_id": 77816443, "body": "My bad. It&#39;s an IO action rather than a pure functionm, so you have to extract the value or use something like <code>whenM</code>. I&#39;ll edit."}], "tags": [], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "is_accepted": true, "score": 0, "last_activity_date": 1501550921, "last_edit_date": 1501550921, "creation_date": 1501544158, "answer_id": 45426807, "question_id": 45425794, "link": "https://stackoverflow.com/questions/45425794/write-to-file-but-overwrite-it-if-it-exists-with-devil-and-repa/45426807#45426807", "title": "Write to file, but overwrite it if it exists with DevIL and REPA", "body": "<p>If the library won't let you replace an existing file directly, you can check whether the file exists with <a href=\"http://hackage.haskell.org/package/directory-1.3.1.1/docs/System-Directory.html#v:doesFileExist\" rel=\"nofollow noreferrer\"><code>doesFileExist</code></a> and delete it before you save the new file.</p>\n\n<pre><code>replace = do    \n  let fn = \"path/to/image/file/...\"\n  exists &lt;- doesFileExist fn\n  when exists $ removeFile fn\n  runIL $ writeImage fn (RGB rotated)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 45426807, "answer_count": 1, "score": 1, "last_activity_date": 1501550921, "creation_date": 1501537599, "last_edit_date": 1501549685, "question_id": 45425794, "link": "https://stackoverflow.com/questions/45425794/write-to-file-but-overwrite-it-if-it-exists-with-devil-and-repa", "title": "Write to file, but overwrite it if it exists with DevIL and REPA", "body": "<p>I am using the DevIL library to read and write images. The problems is that I want to <strong>overwrite</strong> the file if it already exists.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>(RGB v) &lt;- runIL $ readImage \"/foo/foo.png\"\nlet rotated = (computeS $ batman v) :: Array F DIM3 Word8\nrunIL $ writeImage (\"/foo/foo.png\") (RGB rotated)\n</code></pre>\n\n<p><strong>How can I achieve that? Can I do this or do I have to think of another way? It is something of the OS?</strong></p>\n\n<p>I am using that file as a temporary image until the user decides to save it (after some changes, like rotating it, expanding it, etc).</p>\n"}, {"tags": ["haskell", "set", "foldable"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 3, "creation_date": 1501534116, "post_id": 45424976, "comment_id": 77811466, "body": "<code>Data.IntSet</code> may not be <code>Foldable</code>, but it does provide <code>foldl</code> and <code>foldr</code> implementations. There&#39;s also a <code>member</code> function which performs your typical <code>find</code> operation. If you wanted to implement your own <code>find</code> function, there are <code>LookupLE</code>, <code>LookupGT</code> etc functions which would let you perform a binary search. Workaround though."}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 5, "creation_date": 1501534314, "post_id": 45424976, "comment_id": 77811562, "body": "<code>class Foldable</code> applies to <code>* -&gt; *</code> kinds, and <code>IntSet</code> is a <code>*</code> kind."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 2, "creation_date": 1501534480, "post_id": 45424976, "comment_id": 77811626, "body": "@ephemient you should post that as the answer. Relevant: <code>IntSet</code> <i>is</i> an instance of <a href=\"http://hackage.haskell.org/package/mono-traversable-1.0.2.1/docs/Data-MonoTraversable.html#t:MonoFoldable\" rel=\"nofollow noreferrer\"><code>MonoFoldable</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501553597, "post_id": 45425178, "comment_id": 77817053, "body": "<code>Element</code> should probably be an associated type family. :)"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501581707, "post_id": 45425178, "comment_id": 77830222, "body": "@Alec is there any reason why associated type family better? It&#39;s not obvious to me when to choose such option..."}, {"owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "edited": false, "score": 0, "creation_date": 1501591636, "post_id": 45425178, "comment_id": 77837322, "body": "Thank you for you answer. Can you add how to implement <code>find :: (a -&gt; Bool) -&gt; IntSet -&gt; Maybe a</code> ?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501597095, "post_id": 45425178, "comment_id": 77841903, "body": "@Shersh Associating the type family gives you a warning when you declare an instance of <code>ProperFoldable</code> without also the type family instance. Otherwise, you are much more likely to end up with stuck type family applications."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1501601872, "post_id": 45425178, "comment_id": 77845216, "body": "@Isund I&#39;ve updated answer with <code>find</code> implementation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1501604999, "post_id": 45425178, "comment_id": 77847159, "body": "To make associating the type pay, add a default definition. <code>type Element t :: a; type Element (f a) = a</code>. Personally, I prefer to make the element type the first class parameter as well, with an equality constraint."}, {"owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "edited": false, "score": 0, "creation_date": 1501686050, "post_id": 45425178, "comment_id": 77889531, "body": "I have to delete my previous comment saying everything is clear. I understand now that a datatype must have kind * -&gt; * to be foldable and that there exists a way to make <code>IntSet</code> foldable with <code>MonoFoldable</code>. What I don&#39;t understand is why you can&#39;t have a function that efficiently searches for the first <code>Int</code> in an <code>IntSet</code> that satisfies some predicate. In a procedural language, It would make no difference if the container was polymorphic or not. Sorry if this is a stupid question, I&#39;m new to haskell."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1501687303, "post_id": 45425178, "comment_id": 77890531, "body": "@Isund What your predicate exactly does? If you want to find number equals to some other number then there is and efficient way. But what if you want to find any prime number of just even number? You have function of type <code>Int -&gt; Bool</code> and you don&#39;t know anything about it inside <code>find</code> function. All you have is list of sorted <code>Int</code>s. For example, I don&#39;t know how to implement <code>find even</code> efficiently (faster than <i>O(n)</i>) for sorted list of integers."}, {"owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "edited": false, "score": 0, "creation_date": 1501698073, "post_id": 45425178, "comment_id": 77897436, "body": "The function can have linear complexity, I&#39;m not saying anything about the predicate. But your proposed version of <code>find</code> is first converting the set into a list so the complexity should be <i>2n</i> instead of <i>n</i> worst-case If I&#39;m not mistaken."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1501750699, "post_id": 45425178, "comment_id": 77919330, "body": "@Isund The complexity would be <i>2n</i> if first list was stored as an intermediate value and only then traversal of <code>find</code> function happen. But Haskell is lazy language. You can think of <code>IS.elems</code> as of lazy iterator which produces values of <code>IntSet</code> on demand and <code>find</code> function calling this iterator while necessary. So in practice there would be no <i>2n</i>. Always lower."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 7, "last_activity_date": 1501601848, "last_edit_date": 1501601848, "creation_date": 1501534710, "answer_id": 45425178, "question_id": 45424976, "link": "https://stackoverflow.com/questions/45424976/foldable-intset/45425178#45425178", "title": "Foldable IntSet", "body": "<p><code>IntSet</code> can't be <code>Foldable</code> from <code>base</code> package because it doesn't have kind <code>* -&gt; *</code>.</p>\n\n<pre><code>ghci&gt; :t foldr\nfoldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\nghci&gt; :k Foldable\nFoldable :: (* -&gt; *) -&gt; Constraint\nghci&gt; import Data.IntSet (IntSet)\nghci&gt; :k IntSet\nIntSet :: *\n</code></pre>\n\n<p>In simple words, to be instance of <code>Foldable</code> from <code>base</code> you data type should be parametrized by some type variable. If you want to use some operation on <code>IntSet</code> you should use some function from <code>Data.IntSet</code> module where all specialized versions implemented.</p>\n\n<p>But I want to add that there exist version of <code>Foldable</code> which <code>IntSet</code> can instantiate (and <a href=\"https://github.com/serokell/universum/blob/5ced025bfa522beba133d35e2093cd81dd21726e/src/Containers.hs#L172\" rel=\"nofollow noreferrer\">we actually did this in our library</a> and this was done earlier with <a href=\"http://hackage.haskell.org/package/mono-traversable-1.0.2.1/docs/Data-MonoTraversable.html#t:MonoFoldable\" rel=\"nofollow noreferrer\"><code>MonoFoldable</code></a>). You just need to implement your abstractions properly:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\ntype family Element t\ntype instance Element (f a)  = a\ntype instance Element Text   = Char\ntype instance Element IntSet = Int\n\nclass ProperFoldable t where\n    foldr :: (Element t -&gt; b -&gt; b) -&gt; b -&gt; t -&gt; b\n</code></pre>\n\n<p><strong>UPDATE</strong> (adding <code>find</code> by request):</p>\n\n<p>You can't implement <code>find :: (a -&gt; Bool) -&gt; IntSet -&gt; Maybe a</code> because of <code>a</code> type variable. Can you answer question \u00abWhat is <code>a</code>?\u00bb? <code>IntSet</code> is not polymorphic container. It contains only <code>Int</code>s. So maximum you can implement is <code>find :: (Int -&gt; Bool) -&gt; IntSet -&gt; Maybe Int</code>. And there's no efficient way to implement this function, only by converting <code>IntSet</code> to list like this:</p>\n\n<pre><code>import           Data.Foldable (find)\nimport           Data.IntSet (IntSet)\nimport qualified Data.IntSet as IS\n\nintSetFind :: (Int -&gt; Bool) -&gt; IntSet -&gt; Maybe Int\nintSetFind predicate = find predicate . IS.elems\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 45425178, "answer_count": 1, "score": 5, "last_activity_date": 1501601848, "creation_date": 1501533885, "last_edit_date": 1501545627, "question_id": 45424976, "link": "https://stackoverflow.com/questions/45424976/foldable-intset", "title": "Foldable IntSet", "body": "<p>For me, an integer set seems to be a foldable data structure.\nWhy is <code>Data.IntSet</code> not an instance of <code>Foldable</code>?</p>\n\n<p>My actual intention is to use <code>find</code> on an <code>IntSet</code>.\nHow can I implement find for <code>Data.IntSet</code>?</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "answers": [{"comments": [{"owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "edited": false, "score": 0, "creation_date": 1501599903, "post_id": 45437846, "comment_id": 77843892, "body": "This looks like it would do the job.  I was searching around for the &#39;pipe&#39; keyword and not finding anything.  Should have just searched more broadly for stderr."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 1, "last_activity_date": 1501590583, "creation_date": 1501590583, "answer_id": 45437846, "question_id": 45424273, "link": "https://stackoverflow.com/questions/45424273/how-to-pipe-stdout-stderr-to-the-stdin-of-another-command-in-turtle/45437846#45437846", "title": "How to pipe stdout/stderr to the stdin of another command in Turtle?", "body": "<p>Are you aware of the existence of <a href=\"https://hackage.haskell.org/package/turtle-1.4.1/docs/Turtle-Prelude.html#v:inshellWithErr\" rel=\"nofollow noreferrer\"><code>inshellWithErr</code></a>?</p>\n"}], "owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 45437846, "answer_count": 1, "score": 4, "last_activity_date": 1501590583, "creation_date": 1501530886, "last_edit_date": 1501535070, "question_id": 45424273, "link": "https://stackoverflow.com/questions/45424273/how-to-pipe-stdout-stderr-to-the-stdin-of-another-command-in-turtle", "title": "How to pipe stdout/stderr to the stdin of another command in Turtle?", "body": "<p>The title pretty much says it all, I couldn't locate this answer obviously worded in the docs.  I'm also unclear on how one would save-off stdout/stderr in a variable for later use to piping to stdin for multiple commands.  Something conceptually like the below where <code>x &lt;- shell a b</code> means getting the stdout from the shell command and storing it in <code>x</code></p>\n\n<hr>\n\n<pre><code>pipeThings = do\n  c1out &lt;- shell \"some-cmd\" empty\n  ... do some things\n  c1out `pipe` shell \"another-cmd\" empty\n  c1out `pipe` shell \"yet-another-cmd\" empty\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501530523, "post_id": 45424138, "comment_id": 77809611, "body": "Since <code>Control.Distributed.Process.Backend.SimpleLocalnet</code> comes from <code>distributed-process-simplelocalnet</code>, you should install that..."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1501530881, "post_id": 45424138, "comment_id": 77809801, "body": "are you using <code>stack</code> or <code>cabal</code>? - you write about cabal, but you added the tag <code>haskell-stack</code>? did you <code>cabal install distributed-process-simplelocalnet</code> ? which <code>ghc</code> and <code>cabal</code> version are you using? can you add the output of <code>ghc-pkg list</code>?"}, {"owner": {"reputation": 1, "user_id": 8395988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f9e9538c5ddbb97c7b63ef91ff7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Shreyas Ramnath", "link": "https://stackoverflow.com/users/8395988/shreyas-ramnath"}, "edited": false, "score": 0, "creation_date": 1501530984, "post_id": 45424138, "comment_id": 77809852, "body": "The package had been already installed. Guess it must have been broken. So I did a force reinstall and everything is working like a charm. Thank you so much Alec."}, {"owner": {"reputation": 1, "user_id": 8395988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f9e9538c5ddbb97c7b63ef91ff7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Shreyas Ramnath", "link": "https://stackoverflow.com/users/8395988/shreyas-ramnath"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1501531184, "post_id": 45424138, "comment_id": 77809952, "body": "@epsilonhalbe I used cabal, and the answer by Alec worked. Thanks a lot !!"}], "owner": {"reputation": 1, "user_id": 8395988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f9e9538c5ddbb97c7b63ef91ff7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Shreyas Ramnath", "link": "https://stackoverflow.com/users/8395988/shreyas-ramnath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501530486, "creation_date": 1501530355, "last_edit_date": 1501530486, "question_id": 45424138, "link": "https://stackoverflow.com/questions/45424138/cloud-haskell-query", "title": "Cloud Haskell query", "body": "<p>I am trying to execute the code on </p>\n\n<p><a href=\"https://hackage.haskell.org/package/distributed-process-simplelocalnet-0.2.3.3/docs/Control-Distributed-Process-Backend-SimpleLocalnet.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/distributed-process-simplelocalnet-0.2.3.3/docs/Control-Distributed-Process-Backend-SimpleLocalnet.html</a></p>\n\n<p>I get the following error </p>\n\n<pre><code>$ ghc -threaded Main.hs\n[1 of 1] Compiling Main             ( Main.hs, Main.o )\n\nMain.hs:4:1: error:\n    Failed to load interface for \u2018Control.Distributed.Process.Backend.SimpleLocalnet\u2019\n</code></pre>\n\n<p>I reinstalled the <code>cloud-haskell</code> and <code>distributed-process</code> package using cabal, still I got the same error. I am not able to figure out what I am doing wrong.\nI am using Ubuntu(latest version).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1501529096, "post_id": 45423782, "comment_id": 77808852, "body": "what is the error you get?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 8, "creation_date": 1501529381, "post_id": 45423782, "comment_id": 77809018, "body": "<a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List-NonEmpty.html#v:nonEmpty\" rel=\"nofollow noreferrer\"><code>nonEmpty :: [a] -&gt; Maybe (NonEmpty a)</code></a>, not <code>nonEmpty :: [a] -&gt; (NonEmpty a)</code>"}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501530419, "post_id": 45423782, "comment_id": 77809561, "body": "Do you mean I have to change function g&#39;s signature?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501530520, "post_id": 45423782, "comment_id": 77809609, "body": "You&#39;d also have to change the way it works, if you did that. There would essentially have to be two <code>fmap</code>s, or something similar."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1501533816, "post_id": 45423782, "comment_id": 77811322, "body": "Worth mentioning that you can directly construct <code>NonEmpty</code> using list syntax (so something just like <code>[2,3] :: NonEmpty Int</code>) by enabling <code>-XOverloadedLists</code>. The caveat is that an empty list literal results in a runtime (not compile time) error."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501531075, "post_id": 45423879, "comment_id": 77809892, "body": "Thanks, I tried the second solution but it&#39;s not compiling, so I replaced b= nonEmpty [2,3] with let (Just b) = nonEmpty [2,3] in main b. Also, if we have to define all manually, then why should we use NonEmpty?"}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501531197, "post_id": 45423879, "comment_id": 77809961, "body": "Can you provide a simple concrete example of how NonEmpty works and can be used?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501531420, "post_id": 45423879, "comment_id": 77810069, "body": "Done. Have you had a look at the <a href=\"https://hackage.haskell.org/package/semigroups-0.18.1/docs/Data-List-NonEmpty.html\" rel=\"nofollow noreferrer\">documentation</a> btw?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 1, "creation_date": 1501532247, "post_id": 45423879, "comment_id": 77810486, "body": "You&#39;d use <code>NonEmpty</code> whenever you need a sequence that cannot be empty. The reason you&#39;re having issues is that you were trying to convert a sequence that <i>can</i> be empty into one that cannot, without dealing with the case where the list is empty."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501532395, "post_id": 45423879, "comment_id": 77810568, "body": "Much obliged :)"}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501577335, "post_id": 45423879, "comment_id": 77827111, "body": "Also, we could do this way: main $ Data.List.NonEmpty.fromList [2,3]"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501599369, "post_id": 45423879, "comment_id": 77843564, "body": "Yes, that&#39;s the unsafe version of <code>nonEmpty</code>."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1501599494, "post_id": 45423879, "comment_id": 77843649, "body": "Again, I wouldn&#39;t recommend the route via lists."}], "tags": [], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "is_accepted": true, "score": 3, "last_activity_date": 1501531388, "last_edit_date": 1501531388, "creation_date": 1501529408, "answer_id": 45423879, "question_id": 45423782, "link": "https://stackoverflow.com/questions/45423782/haskell-nonempty/45423879#45423879", "title": "Haskell: NonEmpty", "body": "<p>Look at the type of <code>nonEmpty</code>. What should the result of <code>nonEmpty []</code> be?\n You're getting a type error, because <code>nonEmpty</code> <em>has</em> to return a <code>Maybe (NonEmpty a)</code>, or it would be a partial function (possibly crashing at runtime if you ever try to access the value).</p>\n\n<h2>Solution</h2>\n\n<p>There are a few ways to resolve the problem. One is to use <code>maybe</code> to choose an action depending on the outcome:</p>\n\n<pre><code>maybe (Left \"List is empty\") (Right . main) $ b\n</code></pre>\n\n<p>Another is to pattern match on the result, assuming it's never <code>Nothing</code>. If this assumption ever turns out to be wrong, your program will crash at runtime:</p>\n\n<pre><code>let (Just b) = nonEmpty [2,3] in main b\n</code></pre>\n\n<p>A third choice that I neglected to mention is to use the constructor for <code>NonEmpty</code> directly:</p>\n\n<pre><code>main $ 2 :| [3]\n</code></pre>\n\n<p>This is probably the solution you're looking for. The route via lists is simply an annoying detour, for the reasons I've stated above.</p>\n"}], "owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 45423879, "answer_count": 1, "score": -1, "last_activity_date": 1501531388, "creation_date": 1501529049, "last_edit_date": 1501529375, "question_id": 45423782, "link": "https://stackoverflow.com/questions/45423782/haskell-nonempty", "title": "Haskell: NonEmpty", "body": "<p>I'm learning Haskell and trying to see how NonEmpty works. I've written the following code.</p>\n\n<pre><code>module Mm (main, Bb, g) where\n\nimport Data.List.NonEmpty\n\ng :: NonEmpty Integer -&gt; NonEmpty Integer\ng  = fmap (+9) \nmain = g\n</code></pre>\n\n<p>It compiles, but when I do: </p>\n\n<pre><code>b= nonEmpty [2,3]\nmain b\n</code></pre>\n\n<p>an error shows up. I don't understand where I'm doing something wrong!</p>\n\n<p>Edit: I get the following error:</p>\n\n<pre><code>couldn't match expected type 'NonEmpty Integer' with actual type 'Maybe \n(NonEmpty Integer)'.  In the first argument of 'main' namely 'b'.\nIn the expression: main b\nIn an equation for 'it' : it = main b\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1501521246, "post_id": 45421681, "comment_id": 77804473, "body": "So.. maybe you will tell us about the <i>real</i> problem? Perhaps it can be solved without appending an element to the end of the list?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1501523399, "post_id": 45421681, "comment_id": 77805728, "body": "&quot;without appending an element&quot; often means using a different data structure or algorithm.  Lists are easy but commonly misused when other structures would be more fitting."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1501525921, "post_id": 45421681, "comment_id": 77807152, "body": "Sometimes it can be useful to build a list in reverse (with prepending), and then return the <code>reverse</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1501590405, "post_id": 45423378, "comment_id": 77836371, "body": "Nice answer, but <code>Set Int</code> contains only unique elements, so not a good list alternative."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1501602376, "post_id": 45423378, "comment_id": 77845542, "body": "Please be judicious with that Knuth quote. Since appending to the end of a list is not just overhead-slow but <i>complexity</i>-slow, avoiding this is something I&#39;d never call <i>premature optimisation</i>. I&#39;d call it perhaps YAGNI, and indeed I often use <code>++</code> myself, but this might be considered <i>always a hack</i>."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 8, "last_activity_date": 1501596835, "last_edit_date": 1501596835, "creation_date": 1501527465, "answer_id": 45423378, "question_id": 45421681, "link": "https://stackoverflow.com/questions/45421681/add-element-to-the-end-of-a-list-without-going-through-the-whole-list-haskell/45423378#45423378", "title": "Add element to the end of a list without going through the whole list (haskell)", "body": "<p>As @Jubobs already said in the comments - <strong>no you cannot</strong>, but this is not necessarily (always) inefficient.</p>\n\n<p>Before starting with some explanation I'd like to remind you of Donald Knuth and his saying that the root of all evil is premature optimization. So try to write a correct program and worry about performance later - when you run into bottlenecks (and be assured haskell has good tooling to detect bottlenecks!).</p>\n\n<h2>Example</h2>\n\n<p>Say you have an infinite list <code>[1..]</code> and you want to append <code>5</code> you can still do that in haskell. Let us fire up ghci and observe some things.</p>\n\n<pre><code>&gt; ghci\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let a = [1..] ++[5] :: [Int]\n</code></pre>\n\n<p>first of all we notice - that <code>let</code>-bindings work lazily and nothing is printed (yet). We can even go further and inspect how far <code>a</code> is evaluated.</p>\n\n<pre><code>Prelude&gt; :sprint a\na = _\n</code></pre>\n\n<p>while an expression like <code>filter (== 5) a</code> will never terminate, we still can do useful stuff with our list <code>a</code>.</p>\n\n<pre><code>Prelude&gt; let b = map (+2) a\nPrelude&gt; take 10 b\n[3,4,5,6,7,8,9,10,11,12]\n</code></pre>\n\n<p>and inspecting <code>a</code> again.</p>\n\n<pre><code>Prelude&gt; :sprint a\na = 1 : 2 : 3 : 4 : 5 : 6 : 7 : 8 : 9 : 10 : _\n</code></pre>\n\n<p>we have only evaluated the first ten elements.</p>\n\n<p>Concluding this example we see - even if you \"append\" <code>5</code> it might never be used - and thus the \"appending\" will have never happened, which is more efficient than if we had a cheap \"appending\" that had happened.</p>\n\n<p>(Note that this lazyness, introduces a bit of a memory overhead that can lead into troubles see <a href=\"https://stackoverflow.com/questions/28868636\">Lazy Evaluation - Space Leak</a> for more on that.)</p>\n\n<h2>Alternatives</h2>\n\n<p>As others have already said - there are alternatives to using good old lists.</p>\n\n<ol>\n<li>If you append often but use the list as an \"accumulator\" - it might be a good idea to just pre-pend and reverse the list before returning. which is <code>O(1)</code> for all <code>(:)</code> operations and <code>O(n)</code> for the reverse - compared to <code>O(n)</code> for each <code>(++)</code> step.</li>\n<li><p>Use different data structures:</p>\n\n<ul>\n<li><strong>difference list:</strong> which you can read up on <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"noreferrer\">Learn you a haskell for great good</a> quoting from there:\n\n<blockquote>\n  <p>The difference list equivalent of a list like <code>[1,2,3]</code> would be the function <code>\\xs -&gt; [1,2,3] ++ xs</code>. A normal empty list is <code>[]</code>, whereas an empty difference list is the function <code>\\xs -&gt; [] ++ xs</code>.</p>\n</blockquote></li>\n<li><p><strong><code>Sequence</code>:</strong> from <a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Sequence.html\" rel=\"noreferrer\">Data.Sequence</a> which supports efficient <code>prepend</code>/<code>append</code>-operations and lookup for elements at the edges.</p>\n\n<pre><code>$ stack ghci --package containers\nPrelude&gt; import Data.Sequence\nPrelude Data.Sequence&gt; let a = fromList [1..4] :: Seq Int\nPrelude Data.Sequence&gt; (a |&gt; 5)\nfromList [1,2,3,4,5]\nPrelude Data.Sequence&gt; 0 &lt;| (a |&gt; 5)\nfromList [0,1,2,3,4,5]\n</code></pre></li>\n<li><p><strong><a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Set.html\" rel=\"noreferrer\"><code>Set</code></a></strong> - which is not ordered like lists, but nevertheless supports efficient (<code>O(log n)</code>) inserts, but only allows for unique inserts.</p>\n\n<pre><code>$ stack ghci --package containers\nPrelude&gt; import Data.Set\nPrelude Data.Set&gt; let a = fromList [1..4] :: Set Int\nPrelude Data.Set&gt; insert 5 a\nfromList [1,2,3,4,5]\nPrelude Data.Set&gt; insert 4 a\nfromList [1,2,3,4]\n</code></pre></li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 337, "user_id": 7804993, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/12abcdce92eb5eaec0c7a4c2ee002060?s=128&d=identicon&r=PG&f=1", "display_name": "Sequinex", "link": "https://stackoverflow.com/users/7804993/sequinex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4694, "favorite_count": 0, "accepted_answer_id": 45423378, "answer_count": 1, "score": 2, "last_activity_date": 1501596835, "creation_date": 1501520957, "question_id": 45421681, "link": "https://stackoverflow.com/questions/45421681/add-element-to-the-end-of-a-list-without-going-through-the-whole-list-haskell", "title": "Add element to the end of a list without going through the whole list (haskell)", "body": "<p>Is there a way in Haskell to add an element to the end of a list without having to go through the whole list?</p>\n\n<p>Example if I have the list <code>[1,2,3,4]</code> and want to add 5 to the end like: <code>[1,2,3,4,5]</code></p>\n\n<p>As I understand, the ++ operator will have to unravel through the whole list, which is quite inefficient.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1501519241, "post_id": 45421127, "comment_id": 77803341, "body": "What&#39;s the type of <code>runSQL</code>? I assume it&#39;s not pure so you can&#39;t run it within a function returning a <code>Maybe (Int, Int)</code>."}, {"owner": {"reputation": 3317, "user_id": 631001, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c41622028455714e9f6352f789776091?s=128&d=identicon&r=PG", "display_name": "lbrndnr", "link": "https://stackoverflow.com/users/631001/lbrndnr"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1501519329, "post_id": 45421127, "comment_id": 77803394, "body": "It&#39;s from this tutorial: <a href=\"https://www.spock.li/tutorials/rest-api\" rel=\"nofollow noreferrer\">spock.li/tutorials/rest-api</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1501519945, "post_id": 45421127, "comment_id": 77803734, "body": "You can&#39;t do IO unless you return a value in the <code>IO</code> monad, possibly something like <code>IO (Maybe (Int, Int))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1501523352, "post_id": 45421578, "comment_id": 77805700, "body": "I don&#39;t buy that Maybe is the simplest monad there is. Arguably Reader is just as simple, but even if you disagree then Identity is clearly simpler."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1501523560, "post_id": 45421578, "comment_id": 77805830, "body": "Also the <code>vote</code> function needs more fixing than you suggest, because it tries to do some IO in the second branch. Instead of <code>return $ case ...</code>, it will have to look more like <code>case p of {Nothing -&gt; return Nothing; Just p -&gt; do ... return (nuv, ndv)}</code>."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 2, "last_activity_date": 1501530131, "last_edit_date": 1501530131, "creation_date": 1501520556, "answer_id": 45421578, "question_id": 45421127, "link": "https://stackoverflow.com/questions/45421127/return-case-of-in-a-do-block/45421578#45421578", "title": "Return case of in a do block", "body": "<p>Your first code sample does not need the <code>return</code>.</p>\n\n<p>Have you figured out what <code>return</code> means in Haskell? It is not like <code>return</code> in any other programming language. In most languages its a flow of control statement that returns control to the calling function with a value attached. In Haskell its just a function with a misleading name.</p>\n\n<p>In this case you should say:</p>\n\n<pre><code>asdf k =\n    case k of \n            Nothing -&gt; Nothing\n            Just x -&gt; Just x\n</code></pre>\n\n<p>In Haskell <code>do</code> notation is used with monads, like IO. Confusing the matter here is the fact that <code>Maybe</code> is actually a monad as well. In fact its the simplest monad there is. You only need to use monads when you want a daisy chain of functions that run in some kind of context, which isn't the case here.</p>\n\n<p>Moving on to your second example, the problem is that <code>runSQL</code> has to interact with the outside world, so it almost certainly returns something of type <code>IO a</code> for some type <code>a</code>. In this case you <em>are</em> doing a daisy-chain of functions in the context of the outside world, so using monads is necessary.</p>\n\n<p><code>return</code> is a function that, in this case, has the type</p>\n\n<pre><code>return :: a -&gt; IO a\n</code></pre>\n\n<p>It really should have been called <code>pure</code> because it takes a pure value and wraps it up in the monadic context. (When you get to Applicative Functors you will find a version of <code>return</code> that is called <code>pure</code>).</p>\n\n<p>A rule about monads is that once you are in a monadic context you can't get out; you can carry out pure computations on values within the context, but the results stay in the monadic context. That context is denoted by a type like \"IO\". So in this case your function type should be</p>\n\n<pre><code>vote :: PostId -&gt; Bool -&gt; IO (Maybe (Int, Int))\n</code></pre>\n\n<p>However if you try that you will find that it still doesn't work. The first branch of your <code>case</code> is fine, because it returns <code>Nothing</code>. But the second branch has a type error because it tries to return <code>(nuv, nvd)</code> after an IO action. You've tried to factor out the <code>return</code>, but actually you need to <code>return Nothing</code> in your first branch and then <code>return $ Just (nuv, nvd)</code> at the end of the second.</p>\n\n<p>Incidentally you don't need a new <code>let</code> for each value. You can say</p>\n\n<pre><code>let\n   foo = 1\n   bar = 2\nreturn (foo, bar)\n</code></pre>\n"}], "owner": {"reputation": 3317, "user_id": 631001, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c41622028455714e9f6352f789776091?s=128&d=identicon&r=PG", "display_name": "lbrndnr", "link": "https://stackoverflow.com/users/631001/lbrndnr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "accepted_answer_id": 45421578, "answer_count": 1, "score": 0, "last_activity_date": 1501530131, "creation_date": 1501518928, "question_id": 45421127, "link": "https://stackoverflow.com/questions/45421127/return-case-of-in-a-do-block", "title": "Return case of in a do block", "body": "<p>So I'm new to Haskell and probably asking a really silly question.\nI try to get the following code to run:</p>\n\n<pre><code>asdf :: Maybe a -&gt; Maybe a\nasdf k = do\n    return $ case k of \n                Nothing -&gt; Nothing\n                Just x -&gt; Just x\n</code></pre>\n\n<p>I know that this is basically <code>fmap</code> and that the do only with a return is non sense. What I actually want to do is the following</p>\n\n<pre><code>vote :: PostId -&gt; Bool -&gt; Maybe (Int, Int)\nvote id v = do\n  p &lt;- runSQL $ P.get id\n  return $ case p of\n    Nothing -&gt; Nothing\n    Just p -&gt; do\n                let uv = postUpvotes p\n                let dv = postDownvotes p\n                let nuv = if v then uv + 1 else uv\n                let ndv = if not v then dv + 1 else dv\n                runSQL $ update id [PostUpvotes =. nuv, PostDownvotes =. ndv]\n                (nuv, ndv)\n</code></pre>\n\n<p>I guess this has more than one issue to it. What exactly is wrong with my first example? Is the approach to the second problem entirely wrong or what's up with that? How would you write it?</p>\n"}, {"tags": ["javascript", "parsing", "haskell", "parsec", "parser-combinators"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1501522458, "post_id": 45420450, "comment_id": 77805199, "body": "Yes, that&#39;s a horribly inefficient regex. One would write <code>&#47;a{30,60}&#47;</code>. You can write your own expression optimiser, or expect the user of your library to be sensible."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1501522498, "post_id": 45420450, "comment_id": 77805226, "body": "If your <code>maybe</code> parser does not support backtracking, that&#39;s your implementation&#39;s fault."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1501526431, "post_id": 45420450, "comment_id": 77807447, "body": "Well... what&#39;s your implementation of <code>maybe</code>, <code>char</code>, and <code>sequence</code>? Also, for regexen, you may like the classic <a href=\"https://swtch.com/~rsc/regexp/regexp1.html\" rel=\"nofollow noreferrer\">Regular Expression Matching Can Be Simple And Fast</a> which explains why perl is so slow and how to be as fast as grep."}, {"owner": {"reputation": 729, "user_id": 3209558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004271564059/picture?type=large", "display_name": "Guillaume Badi", "link": "https://stackoverflow.com/users/3209558/guillaume-badi"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1501527192, "post_id": 45420450, "comment_id": 77807831, "body": "Yes it does support backtracking, but it makes it slow @Bergi."}, {"owner": {"reputation": 729, "user_id": 3209558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004271564059/picture?type=large", "display_name": "Guillaume Badi", "link": "https://stackoverflow.com/users/3209558/guillaume-badi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501527206, "post_id": 45420450, "comment_id": 77807840, "body": "Thanks @DanielWagner, this looks amazing !"}], "owner": {"reputation": 729, "user_id": 3209558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004271564059/picture?type=large", "display_name": "Guillaume Badi", "link": "https://stackoverflow.com/users/3209558/guillaume-badi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1501516692, "creation_date": 1501516692, "question_id": 45420450, "link": "https://stackoverflow.com/questions/45420450/how-to-use-maybe-to-parse-this-string-with-a-parser-combinator-library", "title": "How to use maybe to parse this string with a parser combinator library", "body": "<p>For learning purposes, I have implemented a small parser combinator library, which has a few parsers and combinators such as <code>char</code>, <code>maybe</code>, <code>sequence</code>, <code>many</code> etc.</p>\n\n<p>I am having hard time figuring out how to emulate the following regex with my library, and how to make it fast.</p>\n\n<p>Here is the regex:</p>\n\n<pre><code>/(a?){30}a{30}/\n</code></pre>\n\n<p>Here is the source:</p>\n\n<pre><code>const source = (new Array(30).fill('a')).join('')\n</code></pre>\n\n<p>Here is my solution (which does not work):</p>\n\n<pre><code>const parser = sequence(...[\n  ...(new Array(30).fill(maybe(char('a')))),\n  ...(new Array(30).fill(char('a'))),\n])\n</code></pre>\n\n<p>Which expands to:</p>\n\n<pre><code>sequence(maybe(char('a')), maybe(char('a')), ..., char('a'), char('a'), ...)\n</code></pre>\n\n<p>My solution is a bit naive as the <code>maybe</code>s consume the input, leaving nothing but an unexpected end of input to the final parsers.</p>\n\n<p>Questions:</p>\n\n<p>Is there a solution to that problem using parser combinators? (I have seen parsec uses <code>try</code>/<code>lookahead</code>, but I can't figure out how it would work in this situation)</p>\n\n<p>The perl version of this regex matches in 3 minutes (<code>perl -e '(\"a\" x 30) =~ /^(a?){30}(a){30}$/;'</code>), while grep manages it in a few miliseconds, Is there an efficient way to solve it ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1501513921, "post_id": 45419484, "comment_id": 77799904, "body": "Why do you think that should work?"}, {"owner": {"reputation": 41, "user_id": 1912005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cp4qG.jpg?s=128&g=1", "display_name": "dannybaobei", "link": "https://stackoverflow.com/users/1912005/dannybaobei"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501514175, "post_id": 45419484, "comment_id": 77800089, "body": "I got a mistake, now when I&#39;m typing fmap (+3) Sure 1, it shows Sure 4."}, {"owner": {"reputation": 41, "user_id": 1912005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cp4qG.jpg?s=128&g=1", "display_name": "dannybaobei", "link": "https://stackoverflow.com/users/1912005/dannybaobei"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501514349, "post_id": 45419484, "comment_id": 77800224, "body": "Actually I want a general way to unbox Unsure then I can do something such as fmap (==)  100 (Sure 100)."}, {"owner": {"reputation": 220, "user_id": 2059388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tlv20.jpg?s=128&g=1", "display_name": "cody", "link": "https://stackoverflow.com/users/2059388/cody"}, "edited": false, "score": 3, "creation_date": 1501515299, "post_id": 45419484, "comment_id": 77800903, "body": "This is an interesting error! If you had written <code>fmap (+3) (Sure 1)</code> things would have worked, as would have <code>fmap (+3) (+100) 1</code> (for subtle reasons). If you had written <code>fmap (+3) Sure 1</code> you might have gotten a reasonable error message, but <code>fmap (+3) (+100) Sure 1</code> is a perfect storm that creates a nasty error message."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1501515299, "post_id": 45419484, "comment_id": 77800905, "body": "You can already do this, you just need to bring the <code>100</code> inside the parentheses: <code>fmap (==100) (Sure 100)</code> &lt;-- returns <code>Sure True</code>."}, {"owner": {"reputation": 41, "user_id": 1912005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cp4qG.jpg?s=128&g=1", "display_name": "dannybaobei", "link": "https://stackoverflow.com/users/1912005/dannybaobei"}, "edited": false, "score": 0, "creation_date": 1501515967, "post_id": 45419484, "comment_id": 77801330, "body": "thank you, it works"}], "answers": [{"tags": [], "owner": {"reputation": 5027, "user_id": 2158495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/X1NAz.jpg?s=128&g=1", "display_name": "Bryan Olivier", "link": "https://stackoverflow.com/users/2158495/bryan-olivier"}, "is_accepted": false, "score": 3, "last_activity_date": 1501542451, "creation_date": 1501542451, "answer_id": 45426588, "question_id": 45419484, "link": "https://stackoverflow.com/questions/45419484/how-to-implement-a-instance-of-functor-for-a-self-defined-data-in-haskell/45426588#45426588", "title": "How to implement a instance of Functor for a self defined data in haskell", "body": "<p>You probably intended to write <code>fmap ((+3) . (+100)) (Sure 1)</code> or <code>fmap (+3) $ fmap (+100) (Sure 1)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "is_accepted": false, "score": 1, "last_activity_date": 1502197710, "creation_date": 1502197710, "answer_id": 45569239, "question_id": 45419484, "link": "https://stackoverflow.com/questions/45419484/how-to-implement-a-instance-of-functor-for-a-self-defined-data-in-haskell/45569239#45569239", "title": "How to implement a instance of Functor for a self defined data in haskell", "body": "<p><em>fmap</em> is a function that has the type <code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code>.</p>\n\n<p>In words, the function <em>fmap</em> takes <strong>two</strong> arguments: \nThe first argument is a function of from a type <code>a</code> to <code>b</code>.\nThe second argument is a value of a Functor of type <code>a</code>. The result is a Functor of type <code>b</code>.</p>\n\n<p>In your example you write: <code>fmap (+3) (+100) Sure 1</code>. In this example <em>fmap</em> has <strong>four</strong> arguments:\nFirst is <code>(+3)</code> , second is <code>(+100)</code>, third id <code>Sure</code> and fourth is <code>1</code>.</p>\n\n<p>As written  by @Brian Olivier to make one argument out of <code>(+3)</code> and <code>(+100)</code>\nyou can combine them with the (.) operator and put this expression into parenthesis. This then gives you the first argument of fmap. </p>\n\n<p>Then you have to put <code>Sure 1</code> into parenthesis \nto get the second argument of fmap.</p>\n\n<p>So all together you have to write <code>fmap ((+3) . (+100)) (Sure 1)</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 13132, "user_id": 2168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5e7e68e1cdaea224d93da209afb28e9d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2168/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1502249349, "creation_date": 1502249349, "answer_id": 45581231, "question_id": 45419484, "link": "https://stackoverflow.com/questions/45419484/how-to-implement-a-instance-of-functor-for-a-self-defined-data-in-haskell/45581231#45581231", "title": "How to implement a instance of Functor for a self defined data in haskell", "body": "<p>In addition to what others have said, if you add use the <code>DeriveFunctor</code> language extensions (eg via the <code>{-# LANGUAGE DeriveFunctor #-}</code> pragma) you can just derive functor:</p>\n\n<pre><code>data Unsure a = Sure a |Error [Char]\n  deriving (Show, Functor)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 1912005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cp4qG.jpg?s=128&g=1", "display_name": "dannybaobei", "link": "https://stackoverflow.com/users/1912005/dannybaobei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1502249349, "creation_date": 1501513848, "question_id": 45419484, "link": "https://stackoverflow.com/questions/45419484/how-to-implement-a-instance-of-functor-for-a-self-defined-data-in-haskell", "title": "How to implement a instance of Functor for a self defined data in haskell", "body": "<p>I'm a beginner of Haskell. Now I tried to define a data as following:</p>\n\n<pre><code>data Unsure a = Sure a |Error [Char]\n deriving (Show)\n</code></pre>\n\n<p>then tried to implement Functor like this:</p>\n\n<pre><code>instance Functor Unsure where\n    fmap f (Sure x) = Sure (f x)\n    fmap f (Error e) = Error e\n</code></pre>\n\n<p>In my opinion, fmap should work Once I implemented Functor for Unsure. So I can use fmap to do something like:</p>\n\n<pre><code>fmap (+3) (+100) Sure 1\n</code></pre>\n\n<p>The result was supposed to be <strong>Sure 104</strong> , in fact I got a error</p>\n\n<blockquote>\n  <p>\u2022 Non type-variable argument in the constraint: Num (Unsure a)\n        (Use FlexibleContexts to permit this)\n      \u2022 When checking the inferred type\n          it :: forall a. (Num (Unsure a), Num a) => Unsure a</p>\n</blockquote>\n\n<p>Any suggestion?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501513954, "post_id": 45419164, "comment_id": 77799931, "body": "I can&#39;t understand what you really want. The last list comprehenion amounts to &quot;generate all the decreasing n-long lists&quot;, but this is only an example, you say. I can&#39;t see how this relates to the hangman discussed above. Can you elaborate? What is your actual goal? Given which inputs, what output do you expect?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1501520298, "last_edit_date": 1501520298, "creation_date": 1501519880, "answer_id": 45421382, "question_id": 45419164, "link": "https://stackoverflow.com/questions/45419164/haskell-list-of-all-non-identical-unordered-lists-of-up-to-n-non-identical-inte/45421382#45421382", "title": "Haskell: list of all non-identical unordered lists of up to n non-identical integers", "body": "<p>You can do something like this:</p>\n\n<pre><code>increasingSequences :: Int -&gt; Int -&gt; Int -&gt; [[Int]]\nincreasingSequences min max 0 = [[]]\nincreasingSequences min max count | max-min+1 &lt; count = []\nincreasingSequences min max count = do\n    h &lt;- [min .. max]\n    t &lt;- increasingSequences (h+1) max (count-1)\n    return (h:t)\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; increasingSequences 1 5 3\n[[1,2,3],[1,2,4],[1,2,5],[1,3,4],[1,3,5],[1,4,5],[2,3,4],[2,3,5],[2,4,5],[3,4,5]]\n</code></pre>\n\n<p>Or like this, if you are just planning to use this to index into another list:</p>\n\n<pre><code>import Data.List\n\nsubsequencesOfLength n xs = go n xs where\n    go 0 _ = [[]]\n    go n xs = do\n        h:rest &lt;- tails xs\n        t &lt;- go (n-1) rest\n        return (h:t)\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; subsequencesOfLength 3 \"abcde\"\n[\"abc\",\"abd\",\"abe\",\"acd\",\"ace\",\"ade\",\"bcd\",\"bce\",\"bde\",\"cde\"]\n</code></pre>\n\n<p>But it's not really clear to me how either of these will be useful. It sounds to me like you would much rather directly compute the defining characteristic of the equivalence class from a string and a letter, e.g.</p>\n\n<pre><code>type Class = [Bool]\n\nclassCharacteristic :: Char -&gt; String -&gt; Class\nclassCharacteristic c s = map (c==) s\n</code></pre>\n\n<p>Then producing all the equivalence classes is easy:</p>\n\n<pre><code>import qualified Data.Map as M\n\nclasses :: Char -&gt; [String] -&gt; [[String]]\nclasses c ss = id\n    . M.elems\n    . M.fromListWith (++)\n    $ [(classCharacteristic c s, [s]) | s &lt;- ss]\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; classes 'e' [\"echo\", \"heal\", \"best\", \"lazy\"]\n[[\"lazy\"],[\"best\",\"heal\"],[\"echo\"]]\n</code></pre>\n\n<p>(I would probably even avoid defining <code>Class</code> and inline <code>classCharacteristic</code> if I were writing this myself -- splitting them out was just for pedagogy.)</p>\n"}], "owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 45421382, "answer_count": 1, "score": 0, "last_activity_date": 1501533712, "creation_date": 1501512882, "last_edit_date": 1501533712, "question_id": 45419164, "link": "https://stackoverflow.com/questions/45419164/haskell-list-of-all-non-identical-unordered-lists-of-up-to-n-non-identical-inte", "title": "Haskell: list of all non-identical unordered lists of up to n non-identical integers", "body": "<p>I am trying to partition a set of words into equivalence classes of words of the same length, where a given character, say 'e', is in particular positions.</p>\n\n<p>(I am trying to implement the Evil Hangman game which is specified here: <a href=\"http://nifty.stanford.edu/2011/schwarz-evil-hangman/\" rel=\"nofollow noreferrer\">http://nifty.stanford.edu/2011/schwarz-evil-hangman/</a>.)</p>\n\n<p>For example, given 'e', \"feel\" and \"peel\" would be in the same equivalance class, but \"bed\" and \"eat\" would not be. Words not containing the given character form their own equivalence class.</p>\n\n<p>For each condition specifying such equivalence class, I will then count the number of words in the wordbank which satisfies it. (and then select the equivalence class of largest size)</p>\n\n<p>At first, I considered using list comprehensions but I'm not sure how to specify to GHC what I want. </p>\n\n<p>It would be nice, for example, to be able to do the following:</p>\n\n<pre><code>[[x1...xn] | x1,..,xn &lt;- [1..10], xn&gt; x(n-1) &gt; ... &gt; x1]\n</code></pre>\n\n<p>Where the xns form an ordered datatype ordered by their indexes. n is an arbitrary parameter.</p>\n\n<p>Hence, I am hoping to receive suggestions on how I might proceed with deriving the lists I need for the creation of my conditions, by list comprehensions or otherwise.</p>\n\n<p>Edit: </p>\n\n<p>To provide additional details, here is the snippet of code I needed help on:</p>\n\n<pre><code>let countList = [(countSatisfy ((char, letterPositionList):listConditions) wordset , (char, letterPositionList) ) | letterPositionList &lt;- foldl (++) [] (map (increasingSequences 0 (wl-1)) [1..(wl-1)] )  ]\nlet countAndSelectedList = getMaxCount countList\n</code></pre>\n\n<p>Using the following functions (thanks Daniel for the increasing sequence list function):</p>\n\n<pre><code>countSatisfy :: [(Char, [Int])] -&gt; [[Char]] -&gt; Int\ncountSatisfy listConditions wordset =\n    foldl (+) 0 $ map (boolToBin . (foldl (&amp;&amp;) True)) (map (mapf (map checkCondTrue listConditions)) wordset)\n\ngetMaxCount :: [(Int, (Char, [Int]))] -&gt; (Int, (Char, [Int]))\ngetMaxCount ((x1, y1):(x2, y2):xs)\n    |x1 &gt; x2 = getMaxCount ((x1, y1):xs)\n    |otherwise = getMaxCount ((x2, y2):xs)\ngetMaxCount ((x, y):[]) = (x, y)\ngetMaxCount [] = error \"No conditions satisfied\"\n\nmapf :: [(a -&gt; b)] -&gt; a -&gt; [b]\nmapf (f:fs) x = f x : mapf fs x\nmapf [] _ = []\n\ncheckCondTrue :: (Char, [Int]) -&gt; [Char] -&gt; Bool\ncheckCondTrue (letterChar, letterPositionList) word = \n    (foldl (&amp;&amp;) True $ map (letterChar ==) (map (word !!) letterPositionList)) &amp;&amp; (not (letterChar `elem` (removeItemsInPositionList (quicksort letterPositionList) word) ) )\n\nincreasingSequences :: Int -&gt; Int -&gt; Int -&gt; [[Int]]\nincreasingSequences min max 0 = [[]]\nincreasingSequences min max count | max-min+1 &lt; count = []\nincreasingSequences min max count = do\n    h &lt;- [min .. max]\n    t &lt;- increasingSequences (h+1) max (count-1)\nreturn (h:t)\n</code></pre>\n\n<p>As is to be expected, this approach really suffers performance wise. I hadn't anticipated the combinatorial explosion resulting from multiple occurrences of a single letter. The code is also in pretty bad shape as this is my first program in Haskell.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501512469, "post_id": 45418909, "comment_id": 77798791, "body": "I really wish GHC would take a leaf out of Elm&#39;s playbook and put  <code>Probable cause: \u2018fromBaseRep\u2019 is applied to too few arguments</code> front and centre."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1501514338, "post_id": 45418909, "comment_id": 77800211, "body": "@SwiftsNamesake Well, sometimes that advice from GHC is a red herring, so GHC prefers to mention first the certain issue, and then follow with a probable cause."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1501514742, "post_id": 45418909, "comment_id": 77800485, "body": "Indeed. Also, I have a few time seen a \u201cprobable cause\u201d of <code>function foo is applied to 2 arguments, but its type ... has only 3</code>."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501515985, "post_id": 45418909, "comment_id": 77801347, "body": "That&#39;s just a <i>bad</i> message then. Which should be fixed. In general, GHC errors could be a lot better imo."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1501512510, "last_edit_date": 1501512510, "creation_date": 1501512107, "answer_id": 45418909, "question_id": 45418502, "link": "https://stackoverflow.com/questions/45418502/haskell-errors-when-trying-to-define-function-with-two-arguments/45418909#45418909", "title": "Haskell: errors when trying to define function with two arguments", "body": "<p>First, some general advice:</p>\n\n<ul>\n<li><p><strong>Always write type signatures</strong> for top-level functions. This has plenty of advantages (more on that later), but perhaps the most important is that somebody reading your code will understand what it's supposed to do. Your old fixed-base-10 function would be</p>\n\n<pre><code>fromBase10rep :: [Int] -&gt; Int\n</code></pre>\n\n<p>(You could also make it generic to work with other number types apart from <code>Int</code>, but I won't go into that to keep it simple.)</p></li>\n<li><p>Avoid unnecessary parentheses.</p>\n\n<pre><code>fromBase10Rep (a:y) = a * 10 ^ length y + calc_nr y\n</code></pre></li>\n<li><p>Avoid <code>length</code> and indexing into lists. This is inefficient (the entire list needs to be traversed every time you do it).</p></li>\n</ul>\n\n<p>If you just follow the first point, you'll probably be able to answer the question yourself...</p>\n\n<pre><code>fromBaseRep :: Int -&gt; [Int] -&gt; Int\nfromBaseRep b [] = 0\nfromBaseRep b (a:y) = a * b ^ length y + fromBaseRep y\n</code></pre>\n\n<p>because, thanks to the type signature, the compiler is now able to give a much clearer error message:</p>\n\n<pre><code>/tmp/wtmpf-file21653.hs:3:42: error:\n    \u2022 Couldn't match expected type \u2018Int\u2019\n                  with actual type \u2018[Int] -&gt; Int\u2019\n    \u2022 Probable cause: \u2018fromBaseRep\u2019 is applied to too few arguments\n      In the second argument of \u2018(+)\u2019, namely \u2018fromBaseRep y\u2019\n      In the expression: a * b ^ length y + fromBaseRep y\n      In an equation for \u2018fromBaseRep\u2019:\n          fromBaseRep b (a : y) = a * b ^ length y + fromBaseRep y\n  |\n3 | fromBaseRep b (a:y) = a * b ^ length y + fromBaseRep y\n  |                                          ^^^^^^^^^^^^^\n</code></pre>\n\n<p>Basically it tells you exactly what the problem is: you've applied <code>fromBaseRep</code> to too few arguments in the recursive call. It still needs to know which base to recompose the rest of the number in!</p>\n\n<p>So just pass it <code>b</code> again, and you'll be fine.</p>\n\n<pre><code>fromBaseRep b (a:y) = a * b ^ length y + fromBaseRep b y\n</code></pre>\n\n<p>As I said, this is still really inefficient due to the <code>length</code> call. A good way to get around this is to multiply out the left digits while recursing deeper into the list:</p>\n\n<pre><code>fromBaseRep b = go 0\n where go acc [] = acc\n       go acc (a:y) = go (b*acc + a) y\n</code></pre>\n\n<p>Note that delegating the recursion to a local \u201cloop function\u201d <code>go</code> also allowed me to omit explicitly passing on <code>b</code> \u2013 it's simply re-used from the <code>fromBaseRep b = ...</code> binding.</p>\n\n<p>This can also be written elegantly as a fold:</p>\n\n<pre><code>fromBaseRep b = foldl' ((+) . (b*)) 0\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3188092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe361d49d6095e5efeb61830de3f25c?s=128&d=identicon&r=PG&f=1", "display_name": "Ant&#243;nio Bezerra", "link": "https://stackoverflow.com/users/3188092/ant%c3%b3nio-bezerra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 45418909, "answer_count": 1, "score": 3, "last_activity_date": 1501532858, "creation_date": 1501510949, "last_edit_date": 1501532858, "question_id": 45418502, "link": "https://stackoverflow.com/questions/45418502/haskell-errors-when-trying-to-define-function-with-two-arguments", "title": "Haskell: errors when trying to define function with two arguments", "body": "<p>I'm trying to define a simple function that turns a list of single integers into one larger integer. For example, given the list [1,5,2,0] it would return 1520.\nTo do that in base 10 I used:</p>\n\n<pre><code>calc_nr [] = 0\ncalc_nr (a:y) = a * 10^(length y) + (calc_nr y)\n</code></pre>\n\n<p>Now, I wanted to extend that to different bases, which can be done by altering the base 10 power in the expression to the desired base. For that, I thought of taking in another argument, b, and replacing the base 10 power for a base b power.<br>\nHowever, I'm getting some errors when I try to do that. Writing:</p>\n\n<pre><code>calc_nr b [] = 0\ncalc_nr b (a:y) = a * b^(length y) + (calc_nr y)\n</code></pre>\n\n<p>Gives me the error:</p>\n\n<pre><code>* Occurs check: cannot construct the infinite type: t ~ [t]\n  Expected type: [t] -&gt; t\n    Actual type: t -&gt; [t] -&gt; t\n* Relevant bindings include\n    calc_nr :: [t] -&gt; t (bound at calc_nr.hs:39:1)\n</code></pre>\n\n<p>I'm new to Haskell, so maybe this is quite a stupid mistake, but any help would be really appreciated!</p>\n"}, {"tags": ["haskell", "typeclass", "either"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 5, "creation_date": 1501463575, "post_id": 45406239, "comment_id": 77773064, "body": "What you\u2019re asking for doesn\u2019t make sense unless the function is partial or you provide it with some extra information. What if the value on the outside is <code>Left</code>? Then you don\u2019t have a value of type <code>e2</code> <i>or</i> <code>a</code>, only of type <code>e1</code>, so you can\u2019t construct an <code>Either e2 a</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1501463864, "post_id": 45406239, "comment_id": 77773129, "body": "I would understand that you want to group the errors (for instance on the left), so that the resulting type is <code>Either (Either e1 e2) a</code>. But now you somehow wish to omit a certain type of errors."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1501478682, "post_id": 45406239, "comment_id": 77776309, "body": "So you want a function that takes an error and makes the error not happen?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8391174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/797a0860396f88883ef5fc0621c81f44?s=128&d=identicon&r=PG&f=1", "display_name": "plint", "link": "https://stackoverflow.com/users/8391174/plint"}, "edited": false, "score": 0, "creation_date": 1501577991, "post_id": 45406358, "comment_id": 77827589, "body": "Thanks, your post was very well written and helped to answer and clarify the question in my own mind as well.  To clarify, e1 and e2 have similar structure as errors, so I would be looking at mapping e1 errors to e2 errors, so solution 1 works very well for my case."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 6, "last_activity_date": 1501464763, "creation_date": 1501464763, "answer_id": 45406358, "question_id": 45406239, "link": "https://stackoverflow.com/questions/45406239/nested-eithers-with-different-error-types/45406358#45406358", "title": "Nested Eithers with different error types", "body": "<h1>Your function is impossible!</h1>\n\n<p>What you\u2019re asking for doesn\u2019t really make sense as it stands. Let\u2019s look at the type of your function:</p>\n\n<pre><code>f :: Either e1 (Either e2 a) -&gt; Either e2 a\n</code></pre>\n\n<p>Assuming this function is total (as the vast majority of functions in Haskell really ought to be), we need to produce a value of type <code>Either e2 a</code> for <em>any</em> input of type <code>Either e1 (Either e2 a)</code>. To try and implement this, let\u2019s consider all of the \u201cshapes\u201d the input can come in.</p>\n\n<p>It turns out that values of the type <code>Either e1 (Either e2 a)</code> can come in three possible shapes:</p>\n\n<pre><code>Left _\nRight (Left _)\nRight (Right _)\n</code></pre>\n\n<p>The bottom two shapes are easy to handle. In fact, we can just map any <code>Right</code> value to itself:</p>\n\n<pre><code>f (Right x) = x\n</code></pre>\n\n<p>However, this doesn\u2019t handle the outer <code>Left</code> case. We can start by writing the pattern:</p>\n\n<pre><code>f (Left x) = ???\n</code></pre>\n\n<p>In the above pattern, we get a single value, <code>x</code>, with type <code>e1</code>. We need to produce a value of type <code>Either e2 a</code>. This means we essentially need a function with the following type:</p>\n\n<pre><code>g :: e1 -&gt; Either e2 a\n</code></pre>\n\n<p>But wait! That type is clearly impossible to satisfy, since we need either an <code>e2</code> or an <code>a</code>, but all we have is an <code>e1</code>. Therefore, we <em>can\u2019t</em> implement that case (assuming we don\u2019t infinitely loop or use <code>error</code> or <code>undefined</code>). We\u2019re stuck.</p>\n\n<h1>Solution 1: provide more information</h1>\n\n<p>Without knowing what you\u2019re actually trying to do, it\u2019s hard to offer a good solution to this problem. I can at least offer a few possibilities, and maybe one of them will be relevant to your use case.</p>\n\n<p>One easy solution is to provide a way to map <code>e1</code> values to <code>e2</code>. That way, we can normalize all errors to <code>e2</code>. Implementing this is very easy with the help of the <code>either</code> function:</p>\n\n<pre><code>f :: (e1 -&gt; e2) -&gt; Either e1 (Either e2 a) -&gt; Either e2 a\nf g = either (Left . g) id\n</code></pre>\n\n<p>You could also do this by applying the mapping function to the left hand side of the outer <code>Either</code>, then using the monadic <code>join</code> function to merge the two layers:</p>\n\n<pre><code>import Data.Bifunctor\n\nf :: (e1 -&gt; e2) -&gt; Either e1 (Either e2 a) -&gt; Either e2 a\nf g = join . first g\n</code></pre>\n\n<h1>Solution 2: change the result type</h1>\n\n<p>Another way we could handle this would be to tweak the result to encode both possibilities. We could produce a value of type <code>Either (Either e1 e2) a</code> to hold either possible error. This is also fairly easy to write with the <code>either</code> function:</p>\n\n<pre><code>f :: Either e1 (Either e2 a) -&gt; Either (Either e1 e2) a\nf = either (Left . Left) (either (Left . Right) Right)\n</code></pre>\n\n<p>However, that\u2019s probably clearer written with pattern-matching instead of <code>either</code>:</p>\n\n<pre><code>f :: Either e1 (Either e2 a) -&gt; Either (Either e1 e2) a\nf (Left x) = Left (Left x)\nf (Right (Left x)) = Left (Right x)\nf (Right (Right x)) = Right x\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8391174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/797a0860396f88883ef5fc0621c81f44?s=128&d=identicon&r=PG&f=1", "display_name": "plint", "link": "https://stackoverflow.com/users/8391174/plint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 45406358, "answer_count": 1, "score": 0, "last_activity_date": 1501474644, "creation_date": 1501463281, "last_edit_date": 1501474644, "question_id": 45406239, "link": "https://stackoverflow.com/questions/45406239/nested-eithers-with-different-error-types", "title": "Nested Eithers with different error types", "body": "<p>I have a nested either with different error types, that looks like:</p>\n\n<pre><code>Either e1 (Either e2 a)\n</code></pre>\n\n<p>And I'd like a function that does something like:</p>\n\n<pre><code>Either e1 (Either e2 a) -&gt; Either e2 a\n</code></pre>\n\n<p>More generally, is there a typeclass that matches this pattern?</p>\n"}, {"tags": ["git", "haskell", "code-reuse"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1501450433, "post_id": 45404892, "comment_id": 77770056, "body": "What are you using to build your code? Stack or Cabal?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501450659, "post_id": 45404892, "comment_id": 77770131, "body": "You could make links (if your file system supports that) to the files, such that updating it on one place, means that it updated on other places as well."}, {"owner": {"reputation": 355, "user_id": 4348117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a88d7b140a8c1fec328e9d7ea4c0d0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Anastos", "link": "https://stackoverflow.com/users/4348117/mark-anastos"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1501450755, "post_id": 45404892, "comment_id": 77770161, "body": "@arrowd Cabal, though that could change I guess"}, {"owner": {"reputation": 355, "user_id": 4348117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a88d7b140a8c1fec328e9d7ea4c0d0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Anastos", "link": "https://stackoverflow.com/users/4348117/mark-anastos"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501451079, "post_id": 45404892, "comment_id": 77770220, "body": "@WillemVanOnsem I guess, but that would still require committing the changes in each repository, which isn&#39;t ideal (maybe unavoidable though, I don&#39;t know)."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1501451102, "post_id": 45404892, "comment_id": 77770226, "body": "In case of Cabal you can create cabal sandboxes and do <code>cabal sandbox add-source</code> to all of your libraries."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1501451250, "post_id": 45404892, "comment_id": 77770268, "body": "@arrowd sandboxes are largely obsolete with the advent of <a href=\"http://blog.ezyang.com/2016/05/announcing-cabal-new-build-nix-style-local-builds/\" rel=\"nofollow noreferrer\">Nix-style builds</a>. I wouldn&#39;t worry learning them as a beginner; even old-style global installs <i>usually</i> work fine."}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 4348117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a88d7b140a8c1fec328e9d7ea4c0d0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Anastos", "link": "https://stackoverflow.com/users/4348117/mark-anastos"}, "edited": false, "score": 0, "creation_date": 1501451774, "post_id": 45404999, "comment_id": 77770417, "body": "So the dependent package will be able to find <code>foo</code> because it is entered into this &quot;local package registry&quot;?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 355, "user_id": 4348117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a88d7b140a8c1fec328e9d7ea4c0d0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Anastos", "link": "https://stackoverflow.com/users/4348117/mark-anastos"}, "edited": false, "score": 0, "creation_date": 1501452474, "post_id": 45404999, "comment_id": 77770629, "body": "C o r r e c t ."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1501513700, "post_id": 45404999, "comment_id": 77799744, "body": "@SwiftsNamesake <code>stack</code> is a great tool for ensuring reproducable builds, but I could never see much point in using it for local hacking. Especially the Nix-style <code>cabal new-build</code> doesn&#39;t really leave anything to be desired that stack could fill, IMO. That said, if you add an answer focusing on how this can be done with Stack, it&#39;s certainly a worthwhile addition."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501515104, "post_id": 45404999, "comment_id": 77800761, "body": "Well, it&#39;s much easier to add local dependencies with <code>stack</code> in my experience, which is why I thought of it."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501515485, "post_id": 45404999, "comment_id": 77801021, "body": "Done. I&#39;ll look into <code>new-build</code> though."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1501452851, "last_edit_date": 1501452851, "creation_date": 1501451120, "answer_id": 45404999, "question_id": 45404892, "link": "https://stackoverflow.com/questions/45404892/reusing-haskell-code-in-multiple-projects/45404999#45404999", "title": "Reusing Haskell code in multiple projects", "body": "<p>Bundle the modules in packages (or possibly make single-module-packages). If you haven't done that before, <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#developing-packages\" rel=\"nofollow noreferrer\">read the Cabal user guide</a>. Each package, like any other code, should be under version control (git, darcs, whatever) though this isn't strictly speaking necessary for your need.</p>\n\n<p>Say you have one such package, <code>foo</code>, containing the modules <code>Common.Foo</code> and <code>Common.Foo.Types</code>, i.e. you have a folder containing <code>Common/Foo.hs</code> and <code>Common/Foo/Types.hs</code> and a <code>foo.cabal</code> file with <code>exposed-modules: Common.Foo Common.Foo.Types</code>.</p>\n\n<p>The projects in which you want to <em>use</em> <code>Common.Foo</code> should then also be cabal packages and, apart from the obvious <code>import Common.Foo</code> in the Haskell source files, should have a <code>.cabal</code> file with <code>build-depends: foo</code>.</p>\n\n<p>Then, whenever you've changed the modules of the <code>foo</code> package, you can just type <code>cabal install --force-reinstalls</code><sup>\u2020</sup> (from inside <code>foo</code>s directory). This will update the local package registry, and when you then <code>cabal configure</code> and <code>cabal build</code> another project using <code>foo</code>, it will have access to the changes.</p>\n\n<p>Consider also actually <a href=\"http://hackage.haskell.org/upload\" rel=\"nofollow noreferrer\">publishing your package on Hackage</a> (of course, make sure to actually give it a <em>clear, descriptive</em> name!), then you won't even have to worry about getting the source and compiling when you switch to another machine \u2013 cabal can do that for you.</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>The <code>--force-reinstalls</code> is only necessary after you've also <code>install</code>ed one of the packages that depend on <code>foo</code>. After reinstalling <code>foo</code>, you <em>must</em> then also rebuild these \u2013 that's a bit of a flaw in the way cabal-install registers installs. This will <a href=\"http://blog.ezyang.com/2016/05/announcing-cabal-new-build-nix-style-local-builds/\" rel=\"nofollow noreferrer\">become unnecessary</a> in the future.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "is_accepted": false, "score": 4, "last_activity_date": 1501515424, "creation_date": 1501515424, "answer_id": 45420036, "question_id": 45404892, "link": "https://stackoverflow.com/questions/45404892/reusing-haskell-code-in-multiple-projects/45420036#45420036", "title": "Reusing Haskell code in multiple projects", "body": "<p>In addition to @leftroundabout's excellent answer, there is another way of adding local dependencies using <code>stack</code> by adding the path to your <code>stack.yaml</code>:</p>\n\n<pre><code>flags: {}\npackages:\n- '.'\n- location: path/to/my/incredible/haskell/goodies\n- location:\n    git: url/to/my/fp/repository\n    commit: [commit-hash]\n  extra-dep: true\n[etc., etc.]\n</code></pre>\n\n<p>Assuming you haven't heard of this tool already (which <em>mostly</em> resolves the infamous cabal-hell problem), I highly recommend checking it out.</p>\n"}], "owner": {"reputation": 355, "user_id": 4348117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a88d7b140a8c1fec328e9d7ea4c0d0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Anastos", "link": "https://stackoverflow.com/users/4348117/mark-anastos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 1, "accepted_answer_id": 45404999, "answer_count": 2, "score": 0, "last_activity_date": 1501515424, "creation_date": 1501450239, "question_id": 45404892, "link": "https://stackoverflow.com/questions/45404892/reusing-haskell-code-in-multiple-projects", "title": "Reusing Haskell code in multiple projects", "body": "<p>There are a few modules I have written that I often want to copy into other projects to reuse the code. However, if I simply copy the modules, then if I ever want to improve them, I would have to update all of the copies in the various git repositories for the projects that use them.</p>\n\n<p>It seems like I should create some sort of library. How can I set up my projects such that I only need to update these modules once, and all of the repositories that depend on them will have access to the newest version?</p>\n"}, {"tags": ["haskell", "ffi", "osrm"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1501450614, "post_id": 45404620, "comment_id": 77770111, "body": "Well, you need to write bindings."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1501503596, "post_id": 45404620, "comment_id": 77792176, "body": "As said above, you need to write bindings. As to how to do this, what would be best and so on: Those would be fairly lengthy answers covering a wide range of topics, and would probably still end up being specific to your usecase. Check out the Haskell FFI documentation, SO isn&#39;t really the right place for this kind of question."}], "answers": [{"comments": [{"owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "edited": false, "score": 0, "creation_date": 1501483910, "post_id": 45407592, "comment_id": 77778490, "body": "I strictly told that I wanna use libosrm and FFI!"}], "tags": [], "owner": {"reputation": 84, "user_id": 8290164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2754acb2db7b32b63f5a462036dbf822?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Krasnyk", "link": "https://stackoverflow.com/users/8290164/michael-krasnyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1501476269, "creation_date": 1501476269, "answer_id": 45407592, "question_id": 45404620, "link": "https://stackoverflow.com/questions/45404620/how-can-we-use-haskell-with-osrm-libraries/45407592#45407592", "title": "How can we use Haskell with OSRM libraries?", "body": "<p>you can look at <a href=\"https://github.com/daniel-j-h/hosrm-qa\" rel=\"nofollow noreferrer\">https://github.com/daniel-j-h/hosrm-qa</a> The project is PoC-only and uses HTTP OSRM API instead of Haskell FFI.</p>\n"}, {"comments": [{"owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "edited": false, "score": 0, "creation_date": 1502049754, "post_id": 45535657, "comment_id": 78032247, "body": "Thanks for pointing the project. I have some question: DO we have to wrap OSRM in C and then use it in Haskell? Is it possible to use the dynamic library (so, dylib, dll) and create appropriate structs using hpp files? Another point: I guess it&#39;s worth of the trouble since OSRM is blazing fast and http-tcp overhead is a noticeable load !"}, {"owner": {"reputation": 21, "user_id": 8425729, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3c11343f6349fcb15caac6fb2afeea00?s=128&d=identicon&r=PG", "display_name": "daniel-j-h", "link": "https://stackoverflow.com/users/8425729/daniel-j-h"}, "reply_to_user": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "edited": false, "score": 0, "creation_date": 1502649850, "post_id": 45535657, "comment_id": 78285084, "body": "You need the C wrapper for the FFI bindings and to have a stable ABI and API. Wrapping the C++ libosrm directly is not what I can recommend."}], "tags": [], "owner": {"reputation": 21, "user_id": 8425729, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3c11343f6349fcb15caac6fb2afeea00?s=128&d=identicon&r=PG", "display_name": "daniel-j-h", "link": "https://stackoverflow.com/users/8425729/daniel-j-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1502046775, "creation_date": 1502046775, "answer_id": 45535657, "question_id": 45404620, "link": "https://stackoverflow.com/questions/45404620/how-can-we-use-haskell-with-osrm-libraries/45535657#45535657", "title": "How can we use Haskell with OSRM libraries?", "body": "<p>I prototyped some Haskell bindings going through an API and ABI compatible C wrapper: <a href=\"https://github.com/daniel-j-h/libosrmc\" rel=\"nofollow noreferrer\">libosrmc</a>.</p>\n\n<p>Feel free to give it a try and send in pull requests. It's exposing just a small part of the API and is based on OSRM version 5.4; you might need to invest some time. But the overall architecture and ideas still apply. <a href=\"https://github.com/daniel-j-h/libosrmc/blob/master/bindings/osrm_haskell.hs\" rel=\"nofollow noreferrer\">Here</a> are the Haskell bindings.</p>\n\n<p>I recommend thinking twice about going the libosrm/FFI way with Haskell instead of sending HTTP requests: benchmark up-front if it's worth the troubles.</p>\n"}], "owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502046775, "creation_date": 1501448111, "question_id": 45404620, "link": "https://stackoverflow.com/questions/45404620/how-can-we-use-haskell-with-osrm-libraries", "title": "How can we use Haskell with OSRM libraries?", "body": "<p>We want to use libOSRM for routing. Currently we are calling its http services. For better performance, I want to call its dynamic library. When reading Haskell FFI, I guess I can compile and links its source (instead of compiled dynamic library) with my Haskell code.\n1. Which method is better?\n2. How can I do each alternative? </p>\n\n<p>Note that OSRM is full of structs that I am not sure how to import into haskell. c2hsc does not install (cabal raises error!). I do not know how to link the whole source of OSRM, from the other hand. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501444810, "post_id": 45404126, "comment_id": 77768512, "body": "It is glued as a <code>let .. in </code> statement"}, {"owner": {"reputation": 293, "user_id": 6675961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46f11b114fe506c0a7b305e730a02a64?s=128&d=identicon&r=PG&f=1", "display_name": "northlane", "link": "https://stackoverflow.com/users/6675961/northlane"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501444864, "post_id": 45404126, "comment_id": 77768529, "body": "But what would that look like if it were &quot;desugared&quot;."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1501444933, "post_id": 45404126, "comment_id": 77768549, "body": "<code>putStrLn (&quot;I will now double &quot; ++ (show x)) &gt;&gt; let double = x*2 in putStrLn (&quot;The result is &quot; ++ (show double))</code>"}, {"owner": {"reputation": 293, "user_id": 6675961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46f11b114fe506c0a7b305e730a02a64?s=128&d=identicon&r=PG&f=1", "display_name": "northlane", "link": "https://stackoverflow.com/users/6675961/northlane"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1501445224, "post_id": 45404126, "comment_id": 77768630, "body": "Well now I feel dumb. I was thinking the let was a standalone expression that could be replaced with something like 1 + 2. This makes much more sense. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1501446857, "last_edit_date": 1501446857, "creation_date": 1501445211, "answer_id": 45404202, "question_id": 45404126, "link": "https://stackoverflow.com/questions/45404126/how-are-expressions-allowed-inside-haskell-do-blocks/45404202#45404202", "title": "How are expressions allowed inside Haskell do blocks", "body": "<p>I'm going to crib from my very similar answer <a href=\"https://stackoverflow.com/a/21959366/791604\">here</a> (though probably not a duplicate since that question doesn't explicitly deal with <code>let</code>).</p>\n\n<p>The <a href=\"http://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"noreferrer\">Report</a> gives a full translation from do syntax into kernel Haskell; the parts relevant to your question are:</p>\n\n<blockquote>\n<pre><code>do {e}                = e\ndo {e;stmts}          = e &gt;&gt; do {stmts}\ndo {let decls; stmts} = let decls in do {stmts}\n</code></pre>\n</blockquote>\n\n<p>So your code desugars like this:</p>\n\n<pre><code>doubleX x = do                                                                                                                                                                                                                    \n  putStrLn (\"I will now double \" ++ (show x))                                                                                                                                                                                     \n  let double = x * 2                                                                                                                                                                                                              \n  putStrLn (\"The result is \" ++ (show double))\n\n==&gt; do {e;stmts} rule\n\ndoubleX x =\n  putStrLn (\"I will now double \" ++ (show x)) &gt;&gt; do\n  let double = x * 2                                                                                                                                                                                                              \n  putStrLn (\"The result is \" ++ (show double))\n\n==&gt; do {let decls; stmts} rule\n\ndoubleX x =\n  putStrLn (\"I will now double \" ++ (show x)) &gt;&gt;\n  let double = x * 2 in do\n  putStrLn (\"The result is \" ++ (show double))\n\n==&gt; do {e} rule\n\ndoubleX x =\n  putStrLn (\"I will now double \" ++ (show x)) &gt;&gt;\n  let double = x * 2 in\n  putStrLn (\"The result is \" ++ (show double))\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 6675961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46f11b114fe506c0a7b305e730a02a64?s=128&d=identicon&r=PG&f=1", "display_name": "northlane", "link": "https://stackoverflow.com/users/6675961/northlane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 1, "accepted_answer_id": 45404202, "answer_count": 1, "score": 2, "last_activity_date": 1501446857, "creation_date": 1501444746, "question_id": 45404126, "link": "https://stackoverflow.com/questions/45404126/how-are-expressions-allowed-inside-haskell-do-blocks", "title": "How are expressions allowed inside Haskell do blocks", "body": "<p>In the following code, line 4, I have an expression sandwiched between two IO actions in a do block:</p>\n\n<pre><code>  1 doubleX :: (Show x, Num x) =&gt; x -&gt; IO ()                                                                                                                                                                                          \n  2 doubleX x = do                                                                                                                                                                                                                    \n  3   putStrLn (\"I will now double \" ++ (show x))                                                                                                                                                                                     \n  4   let double = x * 2                                                                                                                                                                                                              \n  5   putStrLn (\"The result is \" ++ (show double))\n</code></pre>\n\n<p>I understand do notation as chaining monadic operations together using >>= or >>. But how does that work when you have an expression in between? You couldn't just glue lines 3-5 together using >>.</p>\n"}, {"tags": ["arrays", "image", "haskell", "repa"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1501439983, "post_id": 45403243, "comment_id": 77766912, "body": "How you accomplish this depends largely on what you want to fill the &#39;extra&#39; space with. It&#39;s entirely ambiguous what you mean by &quot;fill the new array with the original&quot;. Do you want to duplicate adjacent elements (use <code>backpermute</code>)? Do you want to duplicate the entire array (use <code>extend</code>)? Do you want to fill the extra elements with values that don&#39;t appear in the original array (use <code>fromFunction</code> or <code>traverse</code>)? In any case, the last case is most general, but you may get better performance from a more specific transformation based on your intended semantics."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1501636657, "post_id": 45403243, "comment_id": 77861052, "body": "The &quot;something&quot; function you are looking for is one that does interpolation. Look at the implementation of scale function <a href=\"https://hackage.haskell.org/package/hip-1.5.3.0/docs/Graphics-Image-Processing.html#v:scale\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hip-1.5.3.0/docs/&hellip;</a> as well as Bilinear interpolation in the same library. This library uses repa as a computation backend, so you can get more ideas on how to use repa from it."}], "owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534882563, "creation_date": 1501439295, "last_edit_date": 1534882563, "question_id": 45403243, "link": "https://stackoverflow.com/questions/45403243/repa-resizing-an-image", "title": "REPA: Resizing an image", "body": "<p>I am trying to, given an image, <strong>generate a new one with twice the original width and height</strong>.</p>\n\n<p>I am using the haskell's REPA library (<a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html</a>), and following this tutorial (<a href=\"https://wiki.haskell.org/Numeric_Haskell:_A_Repa_Tutorial\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Numeric_Haskell:_A_Repa_Tutorial</a>).</p>\n\n<pre><code>main :: IO () \nmain = do\n    [f, path] &lt;- getArgs\n    (RGB v) &lt;- runIL $ readImage f\n        let newImage = (computeS $ twiceSize v) :: Array F DIM3 Word8\n        runIL $ writeImage (path) (RGB newImage)\n\ntwiceSize :: (Source r e) =&gt; Array r DIM3 e -&gt; Array D DIM3 e\ntwiceSize img = something img newImage\n   where\n      (Z :. originalWidth :. originalHeight  :. k) = extent img\n      newImage = (Z :. originalWidth*2 :. originalHeight*2 :. k)\n      something a b = ... \n</code></pre>\n\n<p>Now, these are my thoughts:</p>\n\n<ul>\n<li><p>1) Get the original image width an height</p></li>\n<li><p>2) Generate a new Array with the right size:</p></li>\n<li><p>3) Fill the new Array with the original, with some function.</p></li>\n</ul>\n\n<p>The thing is, I don't really know how to achieve points 2) and 3). What does the <em>\"<code>something</code>\"</em> function need to do in order to fill the new array? Should I use a map on the <code>newImage</code>?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "numbers", "instance"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501424227, "post_id": 45400746, "comment_id": 77761978, "body": "But <code>3</code> is not a <code>Nat</code>. Here you defined it as <code>Succ(Succ(Succ(Zero)))</code>..."}, {"owner": {"reputation": 520, "user_id": 8330953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870ab3fb82841742c965b45c107f0dfc?s=128&d=identicon&r=PG", "display_name": "Thomas Crowley", "link": "https://stackoverflow.com/users/8330953/thomas-crowley"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501424495, "post_id": 45400746, "comment_id": 77762073, "body": "@WillemVanOnsem, but I thought a Natural number was a positive integer?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1501424716, "post_id": 45400746, "comment_id": 77762129, "body": "Yes. It is, but why do you expect Haskell to autmatically map number literals on <code>Nat</code>s you define yourself?"}], "answers": [{"tags": [], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "is_accepted": false, "score": 3, "last_activity_date": 1501432442, "last_edit_date": 1501432442, "creation_date": 1501424472, "answer_id": 45400793, "question_id": 45400746, "link": "https://stackoverflow.com/questions/45400746/no-instance-for-num-nat-arising-from-the-literal-1/45400793#45400793", "title": "No instance for (Num Nat) arising from the literal \u20181\u2019", "body": "<p><strong>TL;DR</strong></p>\n\n<p>GHC is telling you exactly what you need to know: that your <code>Nat</code> type is not in fact an instance of <code>Num</code>. This is the typeclass that allows integer literals to be polymorphic (via <code>fromInteger</code>).</p>\n\n<hr>\n\n<p>Integer literals in Haskell are polymorphic, so <code>mult 3 5</code> <em>could</em> work. The problem is that you haven't explained how to turn <code>3</code> and <code>5</code> into <code>Nat</code>s.</p>\n\n<p>The most straight-forward way of solving the problem is to implement <code>Num</code> for your type. You could also create a separate <code>natFromInteger</code> if you don't wish to implement the entire set (such as subtraction, which is a partial function for natural numbers).</p>\n\n<p><strong><code>Num</code> solution</strong>:</p>\n\n<pre><code>instance Num Nat where\n  fromInteger 0 = Zero\n  fromInteger n = Succ . fromInteger $ n - 1\n</code></pre>\n\n<p>You could simplify the solution via <code>fromEnum</code> as @leftroundabout suggests.</p>\n\n<p><strong>A free standing <code>natFromInteger</code> solution looks about the sam</strong>e:</p>\n\n<pre><code>natFromInteger :: Integer -&gt; Nat\nnatFromInteger 0 = Zero\nnatFromInteger n = Succ . natFromInteger $ n - 1\n</code></pre>\n\n<p>This solution will not let you convert literals implicitly. On the other hand, it avoids the issue of having partial or unimplemented functions, as I mentioned before.</p>\n\n<p><strong>A compromise: RebindableSyntax</strong></p>\n\n<p>There is a third option, which let's you <em>override</em> <code>fromInteger</code> without implementing the remaining litany of mathematical functions and operators from <code>Num</code>: using the GHC extension <code>RebindableSyntax</code>. Have a look at <a href=\"https://stackoverflow.com/questions/13978395/overriding-frominteger-in-haskell\">this answer</a> for details.</p>\n"}, {"comments": [{"owner": {"reputation": 520, "user_id": 8330953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870ab3fb82841742c965b45c107f0dfc?s=128&d=identicon&r=PG", "display_name": "Thomas Crowley", "link": "https://stackoverflow.com/users/8330953/thomas-crowley"}, "edited": false, "score": 0, "creation_date": 1501426115, "post_id": 45400808, "comment_id": 77762576, "body": "Thanks, I was following some example from a book. I think I missed a key step somewhere."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 520, "user_id": 8330953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870ab3fb82841742c965b45c107f0dfc?s=128&d=identicon&r=PG", "display_name": "Thomas Crowley", "link": "https://stackoverflow.com/users/8330953/thomas-crowley"}, "edited": false, "score": 1, "creation_date": 1501427227, "post_id": 45400808, "comment_id": 77762964, "body": "@ThomasCrowley Great answer. One quibble though: <code>Num</code> has other members that can&#39;t be implemented properly for <code>Nat</code>, which could lead to runtime crashes if the OP isn&#39;t careful."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501446098, "post_id": 45400808, "comment_id": 77768880, "body": "You surely wouldn&#39;t want to define <code>fromInteger</code> using <code>toEnum</code> anyway, as the latter will break beyond <code>maxBound :: Int</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501580502, "post_id": 45400808, "comment_id": 77829354, "body": "@dfeuer you wouldn&#39;t want to express a number anywhere near <code>maxBound :: Int</code> in Peano arithmetic anyway, though..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501596589, "post_id": 45400808, "comment_id": 77841455, "body": "@leftaroundabout, what if it&#39;s a lazy over-estimate?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501597060, "post_id": 45400808, "comment_id": 77841868, "body": "@dfeuer then it shouldn&#39;t be expressed as any particular integer literal, but as <code>fix Succ</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501597390, "post_id": 45400808, "comment_id": 77842144, "body": "Which, incidentally, is exactly what would happen after an overflow to negative with a na&#239;ve definition."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1501429470, "last_edit_date": 1501429470, "creation_date": 1501424578, "answer_id": 45400808, "question_id": 45400746, "link": "https://stackoverflow.com/questions/45400746/no-instance-for-num-nat-arising-from-the-literal-1/45400808#45400808", "title": "No instance for (Num Nat) arising from the literal \u20181\u2019", "body": "<p>How is the compiler supposed to know that <code>Zero</code> is intended to represent the number <code>0</code>, as well as <code>Succ . Succ $ Zero</code> the number <code>2</code> and so on? It would have to more or less <em>blindly guess</em> that this is what you intend.</p>\n\n<p>You can explicitly tell it to handle number literals this way, though:</p>\n\n<pre><code>instance Num Nat where\n  fromInteger 0 = Zero\n  fromInteger n = Succ . fromInteger $ n - 1\n</code></pre>\n\n<p>Furthermore, even if the compiler thus knows how <code>Nat</code>s can be <em>defined</em> through number literals, it won't be able to <em>display</em> a given/computed <code>Nat</code> value. For that, there is a natural automatic fix, though:</p>\n\n<pre><code>data Nat = Zero | Succ Nat\n   deriving (Show)\n</code></pre>\n\n<p>You can also add <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#t:Eq\" rel=\"nofollow noreferrer\"><code>Eq</code></a>, <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#t:Ord\" rel=\"nofollow noreferrer\"><code>Ord</code></a> <del>and <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#t:Enum\" rel=\"nofollow noreferrer\"><code>Enum</code></a></del> to the <code>deriving</code> list; <del>in fact the derived <code>Enum</code> instance does pretty much that \u201cblind guessing\u201d as to what <code>Nat</code> value represents what number.</del> Actually I've just noticed that <code>Enum</code> can't be derived on recursive types like <code>Nat</code>; if that were possible you <em>could</em> write:</p>\n\n<pre><code>instance Num Nat where\n  fromInteger = toEnum . fromInteger\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 8330953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870ab3fb82841742c965b45c107f0dfc?s=128&d=identicon&r=PG", "display_name": "Thomas Crowley", "link": "https://stackoverflow.com/users/8330953/thomas-crowley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 45400808, "answer_count": 2, "score": 0, "last_activity_date": 1501432442, "creation_date": 1501424145, "question_id": 45400746, "link": "https://stackoverflow.com/questions/45400746/no-instance-for-num-nat-arising-from-the-literal-1", "title": "No instance for (Num Nat) arising from the literal \u20181\u2019", "body": "<p>I am trying to create some functions using natural numbers.</p>\n\n<pre><code>import Prelude\ndata Nat = Zero | Succ Nat\n\nadd:: Nat -&gt; Nat -&gt; Nat\nadd Zero n = n\nadd (Succ m) n = Succ (add m n)\n\nmult :: Nat -&gt; Nat -&gt; Nat\nmult x Zero = Zero\nmult x (Succ y) = add x (mult x y)\n</code></pre>\n\n<p>then when I run</p>\n\n<pre><code>mult 3 5\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>&lt;interactive&gt;:38:6: error:\n\u2022 No instance for (Num Nat) arising from the literal \u20183\u2019\n\u2022 In the first argument of \u2018mult\u2019, namely \u20183\u2019\n  In the expression: mult 3 5\n  In an equation for \u2018it\u2019: it = mult 3 5\n</code></pre>\n\n<p>I am relatively new to Haskell so any help would be appreciated. \nThanks in advance </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1501402849, "post_id": 45397761, "comment_id": 77756206, "body": "I&#39;m voting to close this question as off-topic because it&#39;s not a quesiton. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501424727, "post_id": 45397761, "comment_id": 77762133, "body": "<code>wordsLength = map length . words</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 6, "last_activity_date": 1501408347, "last_edit_date": 1501408347, "creation_date": 1501402941, "answer_id": 45397829, "question_id": 45397761, "link": "https://stackoverflow.com/questions/45397761/i-want-to-define-a-function-wordslength-that-will-calculate-the-length-of-the/45397829#45397829", "title": "I want to define a function \u2018wordsLength\u2019 that will calculate the length of the words in a given sentence", "body": "<p>This is the function you have:</p>\n\n<pre><code>length :: [a] -&gt; Int\n</code></pre>\n\n<p>What you would like to do is write <code>lengths</code> which preserves the structure of the input list and applies <code>length</code> to each one of its elements.</p>\n\n<pre><code>lengths :: [[a]] -&gt; [Int]\n</code></pre>\n\n<p>Now, look at the type of <code>map</code>, can you see how to combine <code>length</code> and <code>map</code> to get <code>lengths</code>?</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11950, "user_id": 576746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fd655b00d23f25a744dbd630b7fdd09d?s=128&d=identicon&r=PG", "display_name": "Blackbam", "link": "https://stackoverflow.com/users/576746/blackbam"}, "edited": false, "score": 0, "creation_date": 1501429899, "post_id": 45399936, "comment_id": 77763807, "body": "This does not provide an answer to the question. To critique or request clarification from an author, leave a comment below their post. - <a href=\"/review/low-quality-posts/16875848\">From Review</a>"}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1501434716, "post_id": 45399936, "comment_id": 77765308, "body": "Given that the original poster could not come up with this themselves,  it needs more explanation."}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "reply_to_user": {"reputation": 11950, "user_id": 576746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fd655b00d23f25a744dbd630b7fdd09d?s=128&d=identicon&r=PG", "display_name": "Blackbam", "link": "https://stackoverflow.com/users/576746/blackbam"}, "edited": false, "score": 0, "creation_date": 1501434806, "post_id": 45399936, "comment_id": 77765337, "body": "@Blackbam This does technically give the &quot;right&quot; answer, so I would leave it, rather than delete it. But it could be massively improved as an answer."}], "tags": [], "owner": {"reputation": 412, "user_id": 6593641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVNVQ.jpg?s=128&g=1", "display_name": "madnight", "link": "https://stackoverflow.com/users/6593641/madnight"}, "is_accepted": false, "score": 0, "last_activity_date": 1501418568, "creation_date": 1501418568, "answer_id": 45399936, "question_id": 45397761, "link": "https://stackoverflow.com/questions/45397761/i-want-to-define-a-function-wordslength-that-will-calculate-the-length-of-the/45399936#45399936", "title": "I want to define a function \u2018wordsLength\u2019 that will calculate the length of the words in a given sentence", "body": "<pre><code>length &lt;$&gt; words \"This is Arya\"\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4513510, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4741374a595068806ef1dd84fdfc8b4e?s=128&d=identicon&r=PG&f=1", "display_name": "bibek", "link": "https://stackoverflow.com/users/4513510/bibek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1501418568, "creation_date": 1501402365, "question_id": 45397761, "link": "https://stackoverflow.com/questions/45397761/i-want-to-define-a-function-wordslength-that-will-calculate-the-length-of-the", "title": "I want to define a function \u2018wordsLength\u2019 that will calculate the length of the words in a given sentence", "body": "<p>Sample Input \u2013 wordsLength \u201cThis is Arya\u201d, Sample output \u2013 [4,2,4]</p>\n\n<p>I can get the length for a list of string but not for the string itself.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1501433843, "post_id": 45396096, "comment_id": 77765011, "body": "Side note, with an empty class, you don\u2019t need the <code>where</code> at all: <code>class S s t | s -&gt; t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501401898, "post_id": 45396296, "comment_id": 77755984, "body": "The answers to the question you link seem to exploit bugs (?) to violate fundeps. I can&#39;t really see if there&#39;s some concrete reason which prevents GHC to augment <code>S s t1, S s t2</code> with <code>t1 ~ t2</code> every time it is found. Can you elaborate a bit further?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501434125, "post_id": 45396296, "comment_id": 77765103, "body": "@chi, I think that&#39;s better discussed on the linked question. I agree with you, though, that those should be considered undesirable features."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1501388066, "creation_date": 1501388066, "answer_id": 45396296, "question_id": 45396096, "link": "https://stackoverflow.com/questions/45396096/how-can-a-functional-type-dependence-be-used-to-derive-equality-of-type-paramete/45396296#45396296", "title": "How can a functional type dependence be used to derive equality of type parameters?", "body": "<p>You can't do it with the class as written. See <a href=\"https://stackoverflow.com/questions/34645745/can-i-magic-up-type-equality-from-a-functional-dependency\">Can I magic up type equality from a functional dependency?</a>. But you can do it with a different class:</p>\n\n<pre><code>class t ~ T s =&gt; S s t where\n  type T s :: *\n</code></pre>\n\n<p>You'll need to define <code>T</code> for each instance, but at least that's not hard. And you can provide a default definition of <code>T</code> if there's an appropriate one.</p>\n"}, {"tags": [], "owner": {"reputation": 5027, "user_id": 2158495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/X1NAz.jpg?s=128&g=1", "display_name": "Bryan Olivier", "link": "https://stackoverflow.com/users/2158495/bryan-olivier"}, "is_accepted": false, "score": 0, "last_activity_date": 1501539570, "creation_date": 1501539570, "answer_id": 45426146, "question_id": 45396096, "link": "https://stackoverflow.com/questions/45396096/how-can-a-functional-type-dependence-be-used-to-derive-equality-of-type-paramete/45426146#45426146", "title": "How can a functional type dependence be used to derive equality of type parameters?", "body": "<p>I ended up solving my problem differently, because I also had another problem with my approach that could <strong>not</strong> be solved this way. This other problem was the following:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, MultiParamTypeClasses, FunctionalDependencies #-}\n\ndata St t u = St\n    {       use_u :: u\n    ,       use_t :: t\n    }\n\nclass Monad m =&gt; S s m t | s -&gt; t\n\nnewtype P s u m a = P\n    {       unP :: forall b t. {-(Monad m,S s m t) =&gt; -- Adding this causes problems with f -}\n                    St t u\n            -&gt;      (a -&gt; St t u -&gt; m b)    -- pok\n            -&gt;      m b\n    }\n\nw :: a -&gt; P s u m a\nw x = P $ \\s pok -&gt; pok x s\n\nf :: (S s m t) =&gt; P s u m ()\nf = P $ \\s pok -&gt; unP (w ()) s pok\n\nmain = putStrLn \"Hello world!\"\n</code></pre>\n\n<p>Adding the type constraints in <code>unP</code> was essential for the other solution, but gave me trouble with this one. The <code>t</code> type parameter is only used in the <code>St</code> type, so I have now solved the problem there using GADTs. The solution to my original problem thus became:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, MultiParamTypeClasses, FunctionalDependencies, GADTs #-}\n{-# LANGUAGE RecordWildCards #-}\n\ndata St s where\n    St :: (S s t) =&gt;\n            {       use_t :: t\n            } -&gt; St s\n\nclass S s t | s -&gt; t\n\nnewtype P s = P\n    {       unP :: forall b.\n                    St s\n            -&gt;      (St s -&gt; b)     -- pok\n            -&gt;      b\n    }\n\n-- Apparently the record update syntax is not fully implemented for GADTs, especially when using polymorphic fields.\n-- See https://www.reddit.com/r/haskell/comments/3r30pp/updating_polymorphic_records/?st=j5sno89f&amp;sh=4ad675fb\n-- If you write your own update functions, trouble can be alleviated a bit using RecordWildCards .\nf :: (S s t) =&gt; t -&gt; P s\n-- f t = P $ \\s pok -&gt; pok s { use_t = t }\nf t = P $ \\s pok -&gt; pok $ update_use_t t s\n    where\n    update_use_t t = \\(St {..}) -&gt; St {use_t = t, ..}\n\nmain = putStrLn \"Hello world!\"\n</code></pre>\n\n<p>The solution to my second problem thus became:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, MultiParamTypeClasses, FunctionalDependencies, GADTs #-}\ndata St s u where\n    St :: (Monad  m,S s m t) =&gt;\n            {       use_u :: u\n            ,       use_t :: t\n            } -&gt; St s u\n\nclass Monad m =&gt; S s m t | s -&gt; t\n\nnewtype P s u m a = P\n    {       unP :: forall b.\n                    St s u\n            -&gt;      (a -&gt; St s u -&gt; m b)    -- pok\n            -&gt;      m b \n    }\n\nw :: a -&gt; P s u m a\nw x = P $ \\s pok -&gt; pok x s\n\nf :: (S s m t) =&gt; P s u m ()\nf = P $ \\s pok -&gt; unP (w ()) s pok\n\nmain = putStrLn \"Hello world!\"\n</code></pre>\n\n<p>This solution may eventually still benefit from the type equivalence constraints as suggested by dfeuer.</p>\n"}], "owner": {"reputation": 5027, "user_id": 2158495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/X1NAz.jpg?s=128&g=1", "display_name": "Bryan Olivier", "link": "https://stackoverflow.com/users/2158495/bryan-olivier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 45396296, "answer_count": 2, "score": 5, "last_activity_date": 1501539570, "creation_date": 1501385705, "question_id": 45396096, "link": "https://stackoverflow.com/questions/45396096/how-can-a-functional-type-dependence-be-used-to-derive-equality-of-type-paramete", "title": "How can a functional type dependence be used to derive equality of type parameters?", "body": "<p>Consider the following code:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, MultiParamTypeClasses, FunctionalDependencies #-}\n\ndata St t = St\n    {       use_t :: t\n    }\n\nclass S s t | s -&gt; t\n    where   -- Nothing really\n\nnewtype P s = P\n    {       unP :: forall b t. (S s t) =&gt;\n                    St t\n            -&gt;      (St t -&gt; b)     -- pok\n            -&gt;      b\n    }\n\nf :: (S s t) =&gt; t -&gt; P s\nf t = P $ \\s pok -&gt; pok s { use_t = t }\n</code></pre>\n\n<p>The code looks contrived, but the idea is that the class <code>S</code> is used to express that the type parameter <code>t</code> is determined by the type parameter <code>s</code>, so I don't have to add <code>t</code> as a type parameter to the type <code>P</code>.</p>\n\n<p>The above code however in short gives the following error <code>Could not deduce (t1 ~ t) from the context (S s t) or from (S s t1)</code>. This error message suggests that the compiler wants to use either one or the other of these contexts, whereas I would have hoped it would use both and conclude <code>t1 ~ t</code> from them.</p>\n\n<p>I would appreciate any suggestions to get this working without adding <code>t</code> as a type parameter to type <code>P</code>.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 7, "last_activity_date": 1501986114, "last_edit_date": 1501986114, "creation_date": 1501382220, "answer_id": 45395834, "question_id": 45395776, "link": "https://stackoverflow.com/questions/45395776/get-sum-of-int-or-integer-in-haskell/45395834#45395834", "title": "Get sum of int or integer in Haskell", "body": "<p>Typeclasses provide a way to be generic about types (they're literally groups of types). You can use a typeclass constraint instead of the explicit type <code>Integer</code>, like this:</p>\n\n<pre><code>myFunc :: Integral a =&gt; [a] -&gt; String\nmyFunc x = if (even (sum x)) then \"even\" else \"odd\"\n</code></pre>\n\n<p>What this will do is specify that it's a function from <code>[a]</code> to <code>String</code> where <code>a</code> is a type variable, and is constrained to be any type so long as it's a member of the <code>Integral</code> typeclass. Another way to say this is any type so long as it has an <em>instance</em> for the <code>Integral</code> typeclass. That means it has the typeclass's methods specified for that particular type.</p>\n\n<p>The <code>Integral</code> typeclass is for types whose values are whole numbers (ie the integrals).</p>\n\n<p>Happily both <code>Int</code> and <code>Integer</code> have an instance provided for <code>Integral</code>, so we can use that.</p>\n"}, {"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1501650062, "post_id": 45395880, "comment_id": 77864573, "body": "<code>Integral</code> is not a type, it is a typeclass. This is a pretty important thing to get right here."}, {"owner": {"reputation": 335, "user_id": 8387889, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ytIoDLa0WGg/AAAAAAAAAAI/AAAAAAAAAcg/PoU425sbyWw/photo.jpg?sz=128", "display_name": "Andrew Lei", "link": "https://stackoverflow.com/users/8387889/andrew-lei"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1501653985, "post_id": 45395880, "comment_id": 77866225, "body": "@ReinHenrichs Yes, my mistake, fixed it."}], "tags": [], "owner": {"reputation": 335, "user_id": 8387889, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ytIoDLa0WGg/AAAAAAAAAAI/AAAAAAAAAcg/PoU425sbyWw/photo.jpg?sz=128", "display_name": "Andrew Lei", "link": "https://stackoverflow.com/users/8387889/andrew-lei"}, "is_accepted": false, "score": 4, "last_activity_date": 1501653950, "last_edit_date": 1501653950, "creation_date": 1501382863, "answer_id": 45395880, "question_id": 45395776, "link": "https://stackoverflow.com/questions/45395776/get-sum-of-int-or-integer-in-haskell/45395880#45395880", "title": "Get sum of int or integer in Haskell", "body": "<p>Int and Integers are different types. They are both instances of the Integral typeclass, however, which has 'mod' as one of its functions.</p>\n\n<p>In order to let your function work for things other than a specific type, what you want to do here is to say that the function, instead of being [Integer] -> [Char] or [Int] -> [Char], the type should be less restrictive than just one of those; it should be [a] -> [Char]. But if you declared that instance, it wouldn't compile, because of two things:</p>\n\n<p>1) sum requires your x to be a list of numbers. That is,</p>\n\n<pre><code>sum :: Num a =&gt; [a] -&gt; a; \n</code></pre>\n\n<p>Num is another typeclass which requires any type that is an instance of Num <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#t:Num\" rel=\"nofollow noreferrer\">to include a definition for (+)</a>, among other things; this allows sum to use addition to add all the numbers.</p>\n\n<p>2) mod requires your sum of x to have a type that is of instance of Integral. So </p>\n\n<pre><code>mod (sum x) :: Integral a =&gt; a -&gt; a\n</code></pre>\n\n<p>It's technically also required that the type is an instance of Num, since sum x must be, but the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#t:Integral\" rel=\"nofollow noreferrer\">definition of Integral</a> requires any instance of Integral to also be an instance of Real, which in turn requires it to be of type Num - essentially you get the requirement that the number be of a type with instance Num for free.</p>\n\n<p>So, in the end, you need to let the first type be of a 'variable' (don't really know the term for it) type, but one that is required to be of type Integral:</p>\n\n<pre><code>myFunc :: Integral a =&gt; [a] -&gt; [Char]\nmyFunc x =  if (sum x `mod` 2 ==1) then \"odd\" else \"even\"\n</code></pre>\n\n<p>Also, if you don't include the type declaration, (i.e., myFunc :: Integral a => [a] -> [Char]), the compiler will automatically fill in the blanks by assuming all of this for you. The type declaration is used to either clarify the type of a function, limit the applicability of a function, or clarify to the compiler what type a variable is when it's unable to infer the type for some reason. But you typically don't have to declare the type if you don't want to.</p>\n"}], "owner": {"reputation": 1609, "user_id": 2698341, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/483f9eb419f9f31ede6b9ffec853c8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aryan Firouzian", "link": "https://stackoverflow.com/users/2698341/aryan-firouzian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "accepted_answer_id": 45395834, "answer_count": 2, "score": 5, "last_activity_date": 1501996046, "creation_date": 1501381446, "last_edit_date": 1501996046, "question_id": 45395776, "link": "https://stackoverflow.com/questions/45395776/get-sum-of-int-or-integer-in-haskell", "title": "Get sum of int or integer in Haskell", "body": "<p>This function should work for both lists of Int and lists of Integer:</p>\n\n<pre><code>myFunc :: [Integer] -&gt; [Char]\nmyFunc x =  if (sum x `mod` 2 ==1) then \"odd\" else \"even\"\n</code></pre>\n\n<p>But it only works on lists of Integers.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 4684686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5c42cb8794518f6a295e9c8667cff17?s=128&d=identicon&r=PG", "display_name": "Martoon", "link": "https://stackoverflow.com/users/4684686/martoon"}, "edited": false, "score": 0, "creation_date": 1542988077, "post_id": 45395103, "comment_id": 93771802, "body": "How can I run the test executable other than via <code>stack test</code>?"}], "tags": [], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "is_accepted": true, "score": 2, "last_activity_date": 1501372299, "creation_date": 1501372299, "answer_id": 45395103, "question_id": 45391236, "link": "https://stackoverflow.com/questions/45391236/how-to-add-memory-profiling-options-to-stack-test/45395103#45395103", "title": "How to add memory profiling options to stack test", "body": "<p>If I have to guess, you intend the +RTS options to be passed to the final  test program, but in your invocation above it might be that those options are being received by the ghc executable itself; like you are telling to ghc \"compile this code but please profile your memory while you do that\". My suggestion is to build the tests with profiling enabled (for example by running the tests first with <code>stack test --profile</code>, although probably you can also use some form of <code>stack build</code>) and then run the generated test executable (with profiling) passing the RTS options. </p>\n"}], "owner": {"reputation": 425, "user_id": 1536169, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9916cccffed7d7b75650389f8bece427?s=128&d=identicon&r=PG", "display_name": "whitehead1415", "link": "https://stackoverflow.com/users/1536169/whitehead1415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 45395103, "answer_count": 1, "score": 1, "last_activity_date": 1501372299, "creation_date": 1501343876, "question_id": 45391236, "link": "https://stackoverflow.com/questions/45391236/how-to-add-memory-profiling-options-to-stack-test", "title": "How to add memory profiling options to stack test", "body": "<p>when running <code>stack test --profile</code> it automatically adds the -p rts option.\nI am trying to do some memory profiling on my test suite and so would like to add the hc, or hy rts option.</p>\n\n<p>This doesn't seem to work</p>\n\n<p><code>stack test --profile --ghc-options=\"+RTS -hc -RTS\"</code></p>\n\n<p>it gives the error</p>\n\n<p><code>ghc: the flag -hc requires the program to be built with -prof</code></p>\n"}, {"tags": ["haskell", "lambda", "set", "combinations", "monads"], "comments": [{"owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 2, "creation_date": 1501339758, "post_id": 45390310, "comment_id": 77741702, "body": "Wait, what is the <i>non</i>-idiomatic way? Is this a disguised form of some common problem? Could you elaborate on the particular use case? Also I assume something like <code>sin (exp (sin 1))</code> is not allowed and you can only: either leave the element as is or apply one unary op?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501347582, "post_id": 45390310, "comment_id": 77744246, "body": "What do you mean by &quot;mathematically equivalent expressions&quot;? <code>sin(0)</code> is equal to <code>0+1+2-3</code>; does that make the expressions &quot;mathematically equivalent&quot; in your view? Do you expect to deal with exact equality, or some approximation? If the former, you may need to use something like <a href=\"https://hackage.haskell.org/package/symengine\" rel=\"nofollow noreferrer\">symengine</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1501347936, "post_id": 45390310, "comment_id": 77744355, "body": "Also, your current formulation seems to allow an infinite number of results: <code>[2, ln 2, ln (ln 2), ln (ln (ln 2)), ...]</code>. Did you mean to limit expressions to at most one use of each unary operator?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501348022, "post_id": 45390310, "comment_id": 77744389, "body": "Finally, once you get past all those questions, I suggest you consider something like the list monad, or perhaps the <code>Logic</code> monad (from the <code>logict</code> package)."}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "reply_to_user": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 0, "creation_date": 1501355356, "post_id": 45390310, "comment_id": 77746703, "body": "@user2847643 By saying &quot;idiomatic&quot; I meant to constrain the question so procedural and/or too low-level methods will be excluded, and will be more like monadic/functor oriented answer. And thanks! I updated the question!"}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501356053, "post_id": 45390310, "comment_id": 77746884, "body": "@dfeuer I specified what I meant by equivalent, and I am sorry for not being specific there at first. I have the list monad in mind, and actually tried this by constructing <code>String</code>s in the reverse polish notation, then evaluating them. However, using chains of functions seems to be a far better approach."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1501358584, "post_id": 45390310, "comment_id": 77747698, "body": "I don&#39;t think chains of functions or RPN is a good approach. I think you should instead use an AST for an expression. Something like <code>data Expr b u n = Lit n | Bin (Expr b u n) b (Expr b u n)  | App u (Expr b u n)</code>. When you&#39;re generating a <code>Bin</code>, you can generate the left argument and use it to limit the right argument. If the the right argument is constrained to be &quot;no smaller than&quot; the left one according to some total order (the one expressed by <code>deriving Ord</code> is probably the one you want) then you take care of commutativity. You can pass down the lists of available literals and unary ops."}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 0, "creation_date": 1501379708, "post_id": 45390310, "comment_id": 77752112, "body": "So, build up this <code>Expr</code> AST myself, then traverse through it? Seems like reinventing something, while the list monad gives some of the stuff I was looking for."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501388692, "post_id": 45390310, "comment_id": 77753441, "body": "I think you should use the list monad! I just think you should represent your expressions using an AST. You want to make lists of expressions, right?"}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 0, "creation_date": 1501434514, "post_id": 45390310, "comment_id": 77765244, "body": "Yes, lists of expressions."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501446005, "post_id": 45390310, "comment_id": 77768864, "body": "You might like to adapt <a href=\"http://pic.blog.plover.com/math/24-puzzle/blechschmidt-solver.txt\" rel=\"nofollow noreferrer\">this code for 24 puzzles</a>; there is also some <a href=\"http://blog.plover.com/math/24-puzzle.html\" rel=\"nofollow noreferrer\">discussion</a> of pitfalls to avoid when cooking up your own solution from scratch."}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501617372, "post_id": 45390310, "comment_id": 77854328, "body": "@DanielWagner The link you provided seems very close to what I was trying to implement, but I was looking for a much shorter, more ideally, a one-liner, approach to this (while being able to import standard modules)."}], "owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501355862, "creation_date": 1501338075, "last_edit_date": 1501355862, "question_id": 45390310, "link": "https://stackoverflow.com/questions/45390310/monadic-construction-of-a-chain-of-partial-functions-in-haskell", "title": "Monadic construction of a chain of partial functions in Haskell", "body": "<p>Consider a set of <code>n</code> numbers (e.g. 4 numbers<code>{1, 2, 3, 4}</code>), and a set of some binary <code>{+, -, *, /}</code> and unary operators <code>{ln, exp, sin}</code>. Combine these using each number <em>once</em>, using any operators where a number can be applied to a unary operator at most once. For example: <code>1+2+3-4</code> or <code>sin(1)*4 + log(2) + 3</code>. Now, <strong>compute</strong> all possible expressions, showing all expressions whose results are over <code>0</code>.</p>\n\n<p>We could chain them up as using prefix operations into point-free style functions like this in Haskell:</p>\n\n<pre><code>(+) 1 . (+) 2 . (-) 3 $ 4\n(+) 3 . (+) (log 2) . (*) 4 $ (sin 1)\n</code></pre>\n\n<p>Is there functor/monad/applicative oriented approach to get all possible chains that combine each number with all possible operators, without repeating mathematically equivalent expressions w.r.t. the commutative properties of those binary operators, for example, <code>1+2=2+1</code>, <code>2*3=3*2</code>?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1501457626, "post_id": 45402109, "comment_id": 77771811, "body": "solved using the data-files field! this is also yet another excuse to get going with exploring template haskell soon ^^"}, {"owner": {"reputation": 81, "user_id": 9220316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09ee7b4549066a7315ffe4d3b03246e?s=128&d=identicon&r=PG&f=1", "display_name": "s.kacer", "link": "https://stackoverflow.com/users/9220316/s-kacer"}, "edited": false, "score": 0, "creation_date": 1590826969, "post_id": 45402109, "comment_id": 109832200, "body": "@michael-snoyman could you also share how to do this with package.yaml file if I am using hpack? I&#39;ve been looking how to do it with that and haven&#39;t had any luck."}, {"owner": {"reputation": 81, "user_id": 9220316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09ee7b4549066a7315ffe4d3b03246e?s=128&d=identicon&r=PG&f=1", "display_name": "s.kacer", "link": "https://stackoverflow.com/users/9220316/s-kacer"}, "edited": false, "score": 1, "creation_date": 1590830850, "post_id": 45402109, "comment_id": 109833355, "body": "followup: I experimented a bit and found that adding data-dir: data is enough in package.yaml  I imported Paths_project into my code and everything compiles fine. But what I am confused by is that when I do <code>stack build</code>, it doesnt seem to copy the data files to .stack-work/install/... where the executable expects to find it when I use getDataFileName... furthermore when I <code>stack install</code>, it copies the built executable, which using its getDataFileName still expects to find the data file in .stack-work/install/...I am very confused. why doesn&#39;t stack build copy over the data files."}, {"owner": {"reputation": 12367, "user_id": 531179, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36b013eaaf1270f35e5157a5ea00ac22?s=128&d=identicon&r=PG", "display_name": "ulidtko", "link": "https://stackoverflow.com/users/531179/ulidtko"}, "reply_to_user": {"reputation": 81, "user_id": 9220316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09ee7b4549066a7315ffe4d3b03246e?s=128&d=identicon&r=PG&f=1", "display_name": "s.kacer", "link": "https://stackoverflow.com/users/9220316/s-kacer"}, "edited": false, "score": 0, "creation_date": 1603816407, "post_id": 45402109, "comment_id": 114154171, "body": "@s.kacer you aren&#39;t alone. See <a href=\"https://github.com/commercialhaskell/stack/issues/1005\" rel=\"nofollow noreferrer\">this Stack issue</a>, it&#39;s a bug... although I&#39;m still unsure if it&#39;s solved or not."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 10, "last_activity_date": 1610393938, "last_edit_date": 1610393938, "creation_date": 1501432206, "answer_id": 45402109, "question_id": 45390204, "link": "https://stackoverflow.com/questions/45390204/how-to-get-stack-build-install-to-include-resource-files-configs-images-etc/45402109#45402109", "title": "How to get stack build/install to include resource files (configs, images etc.)", "body": "<p>There are two options. The one I assume you're looking for is <a href=\"https://downloads.haskell.org/%7Eghc/7.0.4/docs/html/Cabal/authors.html#paths-module\" rel=\"nofollow noreferrer\">data files</a>. To do this, you'll essentially:</p>\n<ol>\n<li>Add the relevant files to the <code>data-files</code> field in your <code>.cabal</code> file so that they are installed when building your package</li>\n<li>Add the <code>Paths_package_name</code> module to your <code>other-modules</code> in your <code>.cabal</code> file (replace <code>package_name</code> with your package name)</li>\n<li>Import that <code>Paths_*</code> module where needed</li>\n<li>Use the generated <code>getDataFileName :: FilePath -&gt; IO FilePath</code> function to get the absolute path to the data file you need</li>\n</ol>\n<p>The alternative is to embed the data file contents inside the executable itself using Template Haskell, such as with the <a href=\"https://www.stackage.org/package/file-embed\" rel=\"nofollow noreferrer\">file-embed</a> package.</p>\n"}], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 45402109, "answer_count": 1, "score": 9, "last_activity_date": 1610393938, "creation_date": 1501337380, "last_edit_date": 1501414554, "question_id": 45390204, "link": "https://stackoverflow.com/questions/45390204/how-to-get-stack-build-install-to-include-resource-files-configs-images-etc", "title": "How to get stack build/install to include resource files (configs, images etc.)", "body": "<p>After having picked up stack as a step in starting to write non-trivial haskell programs (larger than a single file) I've run across the problem of not knowing how to get stack to recognize .ini files and such. It doesn't seem to fit anywhere in the .cabal or stack.yaml files.</p>\n\n<p>For clarification: after running stack build/install, the folder with the generated .exe doesn't have the resources, and so of course the program crashes with a bunch of IO errors (file not found).</p>\n"}, {"tags": ["list", "function", "haskell", "polymorphism"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1501324255, "post_id": 45388054, "comment_id": 77737021, "body": "<code>p</code> is not a list, it is a predicate, i.e. a function <code>a-&gt;Bool</code>. The second argument of <code>filter</code> is a list. The type can be asked to GHCi by loading your code and using <code>:t filter</code>. I think you should read some Haskell tutorial, and learn the language basics first: you seem to be quite confused by the code above, so you should try getting more familiar with more basic code, first."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7947407"}, "edited": false, "score": 0, "creation_date": 1501342197, "post_id": 45388650, "comment_id": 77742513, "body": "Thank you. Not only did you answer my questions, but also advised very well :)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1501327083, "creation_date": 1501327083, "answer_id": 45388650, "question_id": 45388054, "link": "https://stackoverflow.com/questions/45388054/how-do-you-pass-list-in-a-function-parameter-in-haskell/45388650#45388650", "title": "How do you pass list in a function parameter in haskell?", "body": "<p>Before getting into any details about the implementation, we should settle on what the type of <code>filter</code> should be. Indeed you should generally design the type signature of a function without ever writing any actual code... but the damage is done here already. (As chi remarks, you could at this point actually ask GHCi what the <em>type of your implementation</em> is... but again, that's backwards so I won't delve into it.)</p>\n\n<p>So what do you want <code>filter</code> to accomplish? Indeed it should take a list. You want to extract certain elements of that list depending on some property each of them might have; but <code>filter</code> shouldn't have any hard-baked assumptions what criteria to use, i.e. it should be the type of a list of <em>any type of element</em>. In Haskell, we write this <code>[a]</code> (which is actually shorthand for <code>\u2200 a . [a]</code>, read this as \u201cfor all element-types you might consider \u2013 say, <code>A</code> \u2013 it's a list of type <code>[A]</code>\u201d).</p>\n\n<p>What the actual criterion is should then be determined by an extra argument: the <em>filtering predicate</em>. For instance, you might want to filter all numbers smaller than <code>5</code> from a list of integers \u2013 you'd use the predicate <code>(&lt;5) :: Int -&gt; Bool</code>. In general, for your <code>[a]</code> list you need a predicate with the type <code>a -&gt; Bool</code>. The end result would have the same list-elements as you passes in, so then <code>filter</code> would have the signature</p>\n\n<pre><code>filter :: [a] -&gt; (a -&gt; Bool) -&gt; [a]\n</code></pre>\n\n<p>...except by convention, we put the predicate first, i.e.</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Let's check this makes sense... we'd want, for instance,</p>\n\n<pre><code>&gt; filter ((&lt;5) :: Int -&gt; Bool) ([4,9,3] :: [Int])\n</code></pre>\n\n<p>in which case <code>a ~ Int</code> so</p>\n\n<pre><code>filter :: (Int -&gt; Bool) -&gt; [Int] -&gt; [Int]\n</code></pre>\n\n<p>...yup, that makes sense.</p>\n\n<p><strong>Now</strong> you start actually worrying about the implementation. There are two general approaches:</p>\n\n<ul>\n<li>Use some pre-existing combinators from a library to define the function. This is very of preferrable to start dabbling with manual recursion etc., but for now let's do everything by hand.</li>\n<li><p><em>Deconstruct</em> the list. Basically, there are only two ways a list can look: it can either contain something, or be empty. Empty is easy, because in this case you can't possibly return anything but an empty list again. You can't even use the predicate because there <em>is</em> no element you could check with it, hence just discard it by matching to <code>_</code>:</p>\n\n<pre><code>filter _ [] = []\n</code></pre>\n\n<p>(Alternatively as you had it, you can also match the predicate as <code>p</code>, but then people will wonder: what happened to <del><a href=\"http://tvtropes.org/pmwiki/pmwiki.php/Main/WhatHappenedToTheMouse\" rel=\"nofollow noreferrer\">the mouse</a></del> <code>p</code>?)</p>\n\n<p>If the list is <em>not</em> empty, we can straight pop one element from it:</p>\n\n<pre><code>filter p (h:l) = \u2026\n</code></pre>\n\n<p>here, <code>h</code> is the head element and <code>l</code> is the rest of the list. So great, we now have an element of type <code>a</code>, let's see what the predicate tells us about it!</p>\n\n<pre><code>filter p (h:l) = if p h then \u2026 else \u2026\n</code></pre>\n\n<p>So if the predicate is fulfilled we want to see <code>h</code> again in the final result, won't we? In fact the final result should <em>start</em> with <code>h</code>, thus</p>\n\n<pre><code>filter p (h:l) = if p h then h : \u2026 else \u2026\n</code></pre>\n\n<p>The rest of the final result should have something to do with the rest of the input list. We could pass is as is <code>then h : l else \u2026</code>, but that would mean we would only ever control the condition for the head element. No, we still have to filter the rest of the list as well:</p>\n\n<pre><code>filter p (h:l) = if p h then h : filter p l else \u2026\n</code></pre>\n\n<p>Indeed we also want to do that even if the predicate is not fulfilled for <code>h</code>, except then we don't prepend it:</p>\n\n<pre><code>filter p (h:l) = if p h then h : filter p l else filter p l\n</code></pre></li>\n</ul>\n\n<p>And there you go:</p>\n\n<pre><code>filter _ [] = []\nfilter p (h:l) = if p h then h : filter p l else filter p l\n</code></pre>\n\n<p>This <code>if</code> looks a bit clunky, the preferred syntax are actually <em>guards</em> (which do the same thing)</p>\n\n<pre><code>filter _ [] = []\nfilter p (h:l)\n | p h        = h : filter p l\n | otherwise  = filter p l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "is_accepted": false, "score": 6, "last_activity_date": 1501327723, "creation_date": 1501327723, "answer_id": 45388744, "question_id": 45388054, "link": "https://stackoverflow.com/questions/45388054/how-do-you-pass-list-in-a-function-parameter-in-haskell/45388744#45388744", "title": "How do you pass list in a function parameter in haskell?", "body": "<p><code>p</code> is not a list. <code>p</code> is short for predicate - usual terminology for a function taking a value and returning <code>Bool</code>. A list is the <em>second</em> argument to <code>filter</code>.</p>\n\n<p>How do you call filter? You need to be reading one of the many haskell books out there. Right now. Some examples:</p>\n\n<pre><code>filter (&gt; 5) [1, 6, 2, 8, 9, 3] -- [6, 8, 9]\nfilter (== 'z') \"bazzz\" -- \"zzz\" (String === [Char])\n</code></pre>\n\n<p>Here <code>(&gt; 5) :: Int -&gt; Bool</code> and <code>(== 'z') :: Char -&gt; Bool</code> are predicates.</p>\n\n<p>Polymorphic very loosely means it has the same form for different types:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p><code>filter</code> must work for any type <code>a</code>. The particular <code>a</code> is thus unknown to the implementer and the function cannot assume anything about <code>a</code>. <code>a</code> is chosen by the function user at the call site. </p>\n\n<p>Btw. it's a fun little exercise to figure out what the following function is allowed to do:</p>\n\n<pre><code>:: a -&gt; a\n</code></pre>\n\n<p>(Hint: there's only one thing it can do, and the name gives it away so I left it out)</p>\n\n<p>You could also think of <code>filter</code> as a family of functions that are implemented exactly the same and only differ in <code>a</code>. Some of those could be:</p>\n\n<pre><code>:: (Int -&gt; Bool) -&gt; [Int] -&gt; [Int]\n:: (Char -&gt; Bool) -&gt; [Char] -&gt; [Char]\n:: (Foo -&gt; Bool) -&gt; [Foo] -&gt; [Foo]\n</code></pre>\n\n<p>SO is not really a great place to start when learning new concepts. You should really grab a good book.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7947407"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6816, "favorite_count": 0, "accepted_answer_id": 45388650, "answer_count": 2, "score": 0, "last_activity_date": 1501327723, "creation_date": 1501323389, "last_edit_date": 1501325388, "question_id": 45388054, "link": "https://stackoverflow.com/questions/45388054/how-do-you-pass-list-in-a-function-parameter-in-haskell", "title": "How do you pass list in a function parameter in haskell?", "body": "<p>I know this question has been asked previously many times, and I've carefully read them, but it doesn't help me answer my type of question. I'm very new to Haskell,</p>\n\n<p>Lets suppose we have the following:</p>\n\n<pre><code>filter p [] = []\nfilter p (h:l) = if (p h) then (h:(filter p l)) else (filter p l)\n</code></pre>\n\n<h1>I have two questions</h1>\n\n<ol>\n<li><p><strong>How can I call filter? All I know is that you pass <code>p</code> which is a list</strong></p></li>\n<li><p><strong>I honestly don't know what is polymorphic type in general, and I cant figure out the polymorphic type of filter function.</strong> </p></li>\n</ol>\n\n<p>I dont event understand what the function filter does in the if statement.</p>\n\n<p>I would really appreciate if you can assist me in these two question.</p>\n\n<p>There's plenty of resources to explain polymorphism, but I don't understand them.</p>\n"}, {"tags": ["string", "haskell", "partitioning"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1501309260, "post_id": 45385831, "comment_id": 77732981, "body": "I think this does the trick too... <code>partitionByFirstChar ss = fromListWith (++) [ (c,[s]) | (c:s) &lt;- ss ]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1501309196, "post_id": 45385999, "comment_id": 77732960, "body": "Thanks I will look into this tomorrow. What I am doing definitely lends itself to a multimap. I will probably change the type of the function at return a MultiMap."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501310474, "post_id": 45385999, "comment_id": 77733309, "body": "Actually, I reckon performance of the <code>fromListWith</code> variant can be fine with either <code>(&lt;&gt;)</code> or <code>(flip (&lt;&gt;))</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1501329966, "post_id": 45385999, "comment_id": 77738652, "body": "I decided to go with <code>MultiMap</code> as the return value of my function."}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1501309905, "last_edit_date": 1501309905, "creation_date": 1501308977, "answer_id": 45385999, "question_id": 45385831, "link": "https://stackoverflow.com/questions/45385831/partition-string-by-the-first-char-of-each-string/45385999#45385999", "title": "Partition `[String]` by the first `Char` of each `String`", "body": "<p>If you're willing to use the <a href=\"https://hackage.haskell.org/package/multimap\" rel=\"nofollow noreferrer\"><code>multimap</code></a> package, it solves this problem quite readily.</p>\n\n<pre><code>\u03bb&gt; import qualified Data.MultiMap as MM\n\n\u03bb&gt; MM.toMap . MM.fromList . fmap (\\(x:xs) -&gt; (x, xs)) $ [\"apple\", \"avocado\", \"bagel\"]\nfromList [('a',[\"pple\",\"vocado\"]),('b',[\"agel\"])]\n</code></pre>\n\n<p><code>fromListWith</code>, as @Alec's comment points out, is probably a better choice if you don't need to use the <code>MultiMap</code> type. Although the performance might not be great, due to the list concatenation.</p>\n\n<pre><code>\u03bb&gt; import qualified Data.Map as M\n\n\u03bb&gt; M.fromListWith (&lt;&gt;) . fmap (\\(x:xs) -&gt; (x, [xs])) $ [\"apple\", \"avocado\", \"bagel\"]\nfromList [('a',[\"vocado\",\"pple\"]),('b',[\"agel\"])]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1501320026, "creation_date": 1501320026, "answer_id": 45387588, "question_id": 45385831, "link": "https://stackoverflow.com/questions/45385831/partition-string-by-the-first-char-of-each-string/45387588#45387588", "title": "Partition `[String]` by the first `Char` of each `String`", "body": "<blockquote>\n  <p>Now <code>suffixes</code> can be either <code>Nothing</code> or <code>Just s</code>. If it is <code>Nothing</code>, I want to <code>insert x [xs] partitioned</code>. If it is <code>Just s</code>, then I want to <code>insert x (xs:s) partitioned</code>.</p>\n</blockquote>\n\n<p>A basic approach here is to use <code>case of</code>:</p>\n\n<pre><code>partitionByFirstChar [] = Map.empty\npartitionByFirstChar ((x:xs):xss) = let\n   partitioned = partitionByFirstChar xss\n   suffixes = partitioned !? x\n   in case suffixes of\n      Nothing -&gt; insert x [xs] partitioned\n      Just s -&gt; insert x (xs:s) partitioned\n</code></pre>\n\n<p>The code above still lacks a branch for the empty string, e.g.:</p>\n\n<pre><code>partitionByFirstChar (\"\":xss) = partitionByFirstChar xss\n</code></pre>\n"}], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 45385999, "answer_count": 2, "score": 0, "last_activity_date": 1501329272, "creation_date": 1501307777, "question_id": 45385831, "link": "https://stackoverflow.com/questions/45385831/partition-string-by-the-first-char-of-each-string", "title": "Partition `[String]` by the first `Char` of each `String`", "body": "<p>I am attempting to write a function with the following type:</p>\n\n<pre><code>partitionByFirstChar :: [String] -&gt; Map.Map Char [String]\n</code></pre>\n\n<p><code>partitionByFirstChar xs</code> will return a <code>Map</code> whose keys are the first character of each string in the list <code>xs</code> and whose values are a list of the suffixes (i.e. all but the first character) of those strings.</p>\n\n<p>My attempt to do this is as follows:</p>\n\n<pre><code>partitionByFirstChar [] = Map.empty\npartitionByFirstChar ((x:xs):xss)\n  = ???\n    where partitioned = partitionByFirstChar xss\n          suffixes = partitioned !? x\n</code></pre>\n\n<p>Now <code>suffixes</code> can be either <code>Nothing</code> or <code>Just s</code>. If it is <code>Nothing</code>, I want to <code>insert x [xs] partitioned</code>. If it is <code>Just s</code>, then I want to <code>insert x (xs:s) partitioned</code>.</p>\n\n<p>I'm having difficulty figuring out how to check what <code>suffixes</code> is. I think I need some kind of pattern matching for the <code>???</code> but can't quite figure it out.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 1, "creation_date": 1501309252, "post_id": 45385943, "comment_id": 77732978, "body": "Ah, I see how my example is using <code>String</code> as a data constructor for <code>B</code>, not as the type <code>String</code>."}, {"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 1, "creation_date": 1501313012, "post_id": 45385943, "comment_id": 77733923, "body": "I notice that the type constructor for functions, <code>(-&gt;)</code>, like <code>Void</code> is another type constructor which has no associated data constructor."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 2, "creation_date": 1501330273, "post_id": 45385943, "comment_id": 77738748, "body": "@mherzl Indeed, you defined a constructor <code>String</code> which has the same name as the type, but is completely unrelated to it. The functional types <code>a -&gt; b</code> also have no constructors: their values are introduced using lambdas <code>\\ x -&gt; ...</code> (or named function definitions) instead of constructors, and eliminated by application <code>f x</code> instead of pattern matching."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 12, "last_activity_date": 1501308621, "creation_date": 1501308621, "answer_id": 45385943, "question_id": 45385621, "link": "https://stackoverflow.com/questions/45385621/data-declaration-with-no-data-constructor-can-it-be-instantiated-why-does-it-c/45385943#45385943", "title": "Data declaration with no data constructor. Can it be instantiated? Why does it compile?", "body": "<blockquote>\n  <p>How would one create an instance of this type?</p>\n</blockquote>\n\n<p>The statement from your book is correct, but your example is not. <code>data B = String</code> defines a <em>type constructor</em> <code>B</code> and a <em>data constructor</em> <code>String</code>, both taking no arguments. Note that the <code>String</code> you define is in the value namespace, so is different from the usual <code>String</code> type constructor.</p>\n\n<pre><code>ghci&gt; data B = String\nghci&gt; x = String\nghci&gt; :t x\nx :: B\n</code></pre>\n\n<p>However, here is an example of a data definition without data constructors (so it cannot be instantiated).</p>\n\n<pre><code>ghci&gt; data B\n</code></pre>\n\n<p>Now, I have a new type constructor <code>B</code>, but no data constructors to produce values of type <code>B</code>. In fact, such a data type is declared in the Haskell <code>base</code>: it is called <code>Void</code>:</p>\n\n<pre><code>ghci&gt; import Data.Void\nghci&gt; :i Void\ndata Void   -- Defined in \u2018Data.Void\u2019\n</code></pre>\n\n<blockquote>\n  <p>Why is this data declaration permitted to compile if the type can never be instantiated?</p>\n</blockquote>\n\n<p>Being able to have uninhabited types turns out to be useful in a handful of places. The examples that I can think of right now are mostly passing in such a type as a type parameter to another type constructor. One more practical use case is in streaming libraries like <a href=\"https://hackage.haskell.org/package/conduit\" rel=\"noreferrer\"><code>conduit</code></a>.</p>\n\n<p>There is a <a href=\"https://hackage.haskell.org/package/conduit-1.2.11/docs/Data-Conduit.html#t:ConduitM\" rel=\"noreferrer\"><code>ConduitM i o m r</code></a> type constructor where: <code>i</code> is the type of the input stream elements, <code>o</code> the type of the output stream elements, <code>m</code> the monad in which actions are performed, <code>r</code> is the final result produced at the end.</p>\n\n<p>Then, it defines a <a href=\"https://hackage.haskell.org/package/conduit-1.2.11/docs/Data-Conduit.html#t:Sink\" rel=\"noreferrer\"><code>Sink</code></a> as</p>\n\n<pre><code>type Sink i m r = ConduitM i Void m r\n</code></pre>\n\n<p>since a <code>Sink</code> should never output any values. <code>Void</code> is a compile time guarantee that <code>Sink</code> <em>cannot</em> output any (non-bottom) values.</p>\n\n<p>Much like <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor-Identity.html#t:Identity\" rel=\"noreferrer\"><code>Identity</code></a>, <code>Void</code> is mostly useful in conjunction with other abstractions.</p>\n\n<blockquote>\n  <p>... type synonyms clearly do not use data constructors</p>\n</blockquote>\n\n<p>Yes, but they are not defining type constructors either. Synonyms are just some surface-level convenience renaming. Under the hood, nothing new is defined. </p>\n\n<blockquote>\n  <p>In the newtype case, it appears that types without data constructors cannot be created, as shown by the following error.</p>\n</blockquote>\n\n<p>I suggest you look up what <code>newtype</code> is for. The whole point of <code>newtype</code> is to provide a zero-cost wrapper around an <em>existing</em> type. That means you have one and exactly one constructor taking one and exactly one argument (the wrapped value). At compile time, the wrapping and unwrapping operations become NOPs.</p>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 45385943, "answer_count": 1, "score": 7, "last_activity_date": 1501308780, "creation_date": 1501305915, "last_edit_date": 1501308780, "question_id": 45385621, "link": "https://stackoverflow.com/questions/45385621/data-declaration-with-no-data-constructor-can-it-be-instantiated-why-does-it-c", "title": "Data declaration with no data constructor. Can it be instantiated? Why does it compile?", "body": "<p>Reading one of my Haskell books, I came across the sentence:</p>\n\n<blockquote>\n  <p>Data declarations <em>always</em> create a new type constructor, but may or <em>may not</em> create new data constructors.</p>\n</blockquote>\n\n<p>It sounded strange that one should be able to declare a data type with no data constructor, because it seems that then one could never instantiate the type. So I tried it out. The following data declaration compiles without error.</p>\n\n<pre><code>data B = String\n</code></pre>\n\n<p><strong>How would one create an instance of this type?</strong> Is it possible? I cannot seem to find a way.</p>\n\n<p>I thought maybe a data constructor with name matching the type constructor would be created automatically, but that does not appear to be the case, as shown by the error resulting from attempting to use <code>B</code> as a data constructor with the declaration in scope.</p>\n\n<pre><code>Prelude&gt; data B = String deriving Show\nPrelude&gt; B\n\n&lt;interactive&gt;:129:1: error: Data constructor not in scope: B\n</code></pre>\n\n<p><strong>Why is this data declaration permitted to  compile if the type can never be instantiated?</strong>\nIs it permitted solely for some formal reason despite not having a known practical application?</p>\n\n<hr>\n\n<p>I also wonder whether my book's statement about data types with no constructor might be referring to types declared via the <code>type</code> or <code>newtype</code> keywords instead of by <code>data</code>.</p>\n\n<ul>\n<li><p>In the <code>type</code> case, type synonyms clearly do not use data\nconstructors, as illustrated by the following.</p>\n\n<pre><code>Prelude&gt; type B = String\nPrelude&gt;\n</code></pre>\n\n<p>Type synonyms such as this can be instantiated by the constructors of\nthe type they are set to. But I am not convinced that this is what my\nbook is referring to as type synonyms do not seem to be declaring a new data type as much as\nsimply defining an new alias for an existing type.</p></li>\n<li><p>In the <code>newtype</code> case, it appears that types without data\nconstructors cannot be created, as shown by the following error.</p>\n\n<pre><code>Prelude&gt; newtype B = String\n\n&lt;interactive&gt;:132:13: error:\n    \u2022 The constructor of a newtype must have exactly one field\n        but \u2018String\u2019 has none\n    \u2022 In the definition of data constructor \u2018String\u2019\n      In the newtype declaration for \u2018B\u2019\n</code></pre></li>\n</ul>\n\n<p><code>type</code> and <code>newtype</code> do not appear to be what the book is referring to, which brings me back to my original question: why it is possible to declare a type using <code>data</code> with no data constructor?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1501301085, "post_id": 45385105, "comment_id": 77731352, "body": "That\u2019s pretty strange. Was there any output from <code>cabal install Heap</code>? Did you actually kill GHCi, or something else with a similar name (I don\u2019t think <code>cabal install</code> runs GHCi)?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1501302716, "post_id": 45385105, "comment_id": 77731635, "body": "I&#39;ve heard of this bug before.  It has something to do with the msys install ghc is using being messed up somehow, but I don&#39;t know how to fix it. I know it&#39;s more complicated than just reinstalling ghc."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1501320667, "post_id": 45385105, "comment_id": 77736029, "body": "Maybe you should use Haskell Stack? <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/README</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501363573, "post_id": 45391679, "comment_id": 77749123, "body": "That would help. Where/how do you file a feature request?"}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501381144, "post_id": 45391679, "comment_id": 77752308, "body": "Thanks for letting me know about the down-vote. I&#39;m disappointed that it seems unacceptable to express frustration. My rant was labelled as such. In addition it was expressed politely and without name-calling. I don&#39;t think it can be categorized as trolling or disruption."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501525226, "post_id": 45391679, "comment_id": 77806775, "body": "Removed the rant."}], "tags": [], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "is_accepted": false, "score": 0, "last_activity_date": 1501525178, "last_edit_date": 1501525178, "creation_date": 1501346537, "answer_id": 45391679, "question_id": 45385105, "link": "https://stackoverflow.com/questions/45385105/insert-disk-into-drive-d-blocks-haskell-from-starting/45391679#45391679", "title": "&quot;Insert disk into Drive D&quot; blocks Haskell from starting", "body": "<p>Apparently it's a long-standing problem. (See <a href=\"https://www.google.com/search?newwindow=1&amp;rlz=1C1GTPM_enUS696US702&amp;q=%22insert+disk+into+drive+d%22&amp;oq=%22insert+disk+into+drive+d%22&amp;gs_l=psy-ab.3..0i22i30k1l4.9554.10512.0.12304.2.2.0.0.0.0.93.180.2.2.0....0...1.1.64.psy-ab..0.2.179...0i7i30k1.8khjrUPt__0\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://www.google.com/search?newwindow=1&amp;rlz=1C1GTPM_enUS696US702&amp;q=please+insert+disk+into+drive+d&amp;oq=please+insert+disk+into+drive+d&amp;gs_l=psy-ab.12..0i20k1l2j0l2.5949.8667.0.12432.2.2.0.0.0.0.89.176.2.2.0....0...1.1.64.psy-ab..0.2.174...0i7i30k1j0i30k1.B31B5fzEbBc\" rel=\"nofollow noreferrer\">here</a>). It may have to do with gcc, and it may have to do with Microsoft. </p>\n\n<p>One solution is to go to Settings. (I'm on Windows 10.) Search for Disk Management. At the bottom scroll down to Disk D. Right click and select Change Drive Letter. Change it to something else(!). </p>\n\n<p>That seems to do the trick. Given how long this problem seems to have been around, I don't understand why it hasn't been fixed.</p>\n\n<p>I am now able to use Command Prompt to</p>\n\n<pre><code>&gt;cabal install Heap \n</code></pre>\n\n<p>and then in GHCi (REPL)</p>\n\n<pre><code>Prelude&gt; import Heap\n</code></pre>\n\n<p>That was the original problem.</p>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501525178, "creation_date": 1501300828, "last_edit_date": 1501382013, "question_id": 45385105, "link": "https://stackoverflow.com/questions/45385105/insert-disk-into-drive-d-blocks-haskell-from-starting", "title": "&quot;Insert disk into Drive D&quot; blocks Haskell from starting", "body": "<p>This question is an outgrowth of <a href=\"https://stackoverflow.com/questions/45362161/how-do-you-import-data-heap\">another question</a>. In that question I asked for advice for importing Data.Heap. I was told that I first had to install Heap. As instructed I ran</p>\n\n<pre><code>&gt; cabal install Heap\n</code></pre>\n\n<p>A Windows error box popped up telling me that there was no disk in Drive D and that I had to insert one. None of the three buttons (Ignore, Continue, or Try Again) worked. I had to kill GHCi from the task manager to get rid of the popup and to close the command prompt window. This happened whether or not GHCi was running when I tried to run the command. Now I can't start GHCi without getting that popup, which blocks everything.</p>\n\n<p>I tried turning the computer off and then on again later. Same popup. I even uninstalled the Haskell platform and reinstalled it. (It is version 8.0.2-a.) Still the same popup when I start GHCi. (I use the platform-installed shortcut WinGHCi to start GHCi.)</p>\n\n<p>I would appreciate advice for avoiding that popup. Otherwise I can't run GHCi at all.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501300745, "post_id": 45385040, "comment_id": 77731309, "body": "What have you tried? What went wrong?"}, {"owner": {"reputation": 13, "user_id": 8384725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7ace694c86cd91da5a8f491c33fa4?s=128&d=identicon&r=PG&f=1", "display_name": "notfounds", "link": "https://stackoverflow.com/users/8384725/notfounds"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501301228, "post_id": 45385040, "comment_id": 77731377, "body": "I tried to extract two values from [1 ... 10] and try to make equivalence judgment with the function eq, but I did not know how to pass a function with two arguments to <code>filter</code>."}, {"owner": {"reputation": 13, "user_id": 8384725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7ace694c86cd91da5a8f491c33fa4?s=128&d=identicon&r=PG&f=1", "display_name": "notfounds", "link": "https://stackoverflow.com/users/8384725/notfounds"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501301898, "post_id": 45385040, "comment_id": 77731503, "body": "I misunderstood about <code>Eq</code> and I will rethink."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501302117, "post_id": 45385040, "comment_id": 77731552, "body": "Related: <a href=\"//stackoverflow.com/q/12398458\">How to group similar items in a list using Haskell?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8384725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7ace694c86cd91da5a8f491c33fa4?s=128&d=identicon&r=PG&f=1", "display_name": "notfounds", "link": "https://stackoverflow.com/users/8384725/notfounds"}, "edited": false, "score": 0, "creation_date": 1501303223, "post_id": 45385271, "comment_id": 77731721, "body": "Thank you for your quick reply. I just started studying Haskell. Thanks again"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1501454463, "post_id": 45385271, "comment_id": 77771140, "body": "Sorting isn&#39;t the best you can do for the modular arithmetic example. Sorting is O(n log n), where n is the number of elements processed. If you use <code>Data.Map</code> with remainders as keys and lists of numbers as values, you can get O(n log m), where n is the number of values and m is the number of <i>distinct</i> remainders. When applicable, <code>Data.IntMap</code> will almost certainly be much faster with an O(n) bound that&#39;s not quite so easy to characterize tightly. (You can view it as O(n) with a fairly large constant factor, but in practice it typically performs much better than that would suggest)."}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1501304463, "last_edit_date": 1501304463, "creation_date": 1501302644, "answer_id": 45385271, "question_id": 45385040, "link": "https://stackoverflow.com/questions/45385040/haskell-creating-a-list-of-equivalents/45385271#45385271", "title": "Haskell: Creating a list of equivalents", "body": "<p>Here's a recursive solution.</p>\n\n<ol>\n<li>Pop off the first element of the list (<code>x</code>).</li>\n<li>Use <code>partition</code> to split the rest of the list into elements that <em>are</em> equivalent to <code>x</code> (<code>group</code>) and elements that <em>aren't</em> equivalent to <code>x</code> (<code>others</code>).</li>\n<li><code>x:group</code> is the first group we've found, and then we recurse on the <code>others</code>.</li>\n</ol>\n\n<hr>\n\n<pre><code>import Data.List (partition)\n\nequivalent :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\nequivalent eq = go\n  where\n    go [] = []\n    go (x:xs) =\n      let (group, others) = partition (eq x) xs\n      in  (x:group) : go others\n</code></pre>\n\n<p>Demonstrated use:</p>\n\n<pre><code>&gt;&gt;&gt; import Data.Function (on)\n&gt;&gt;&gt; equivalent ((==) `on` (`mod` 3)) [1..10]\n[[1,4,7,10],[2,5,8],[3,6,9]]\n</code></pre>\n\n<p>By the way, here's another way to accomplish the same thing, which I suspect is faster:</p>\n\n<pre><code>&gt;&gt;&gt; fmap (fmap snd) . groupBy ((==) `on` fst) . sort . fmap (\\i -&gt; (i `mod` 3, i)) $ [1..10]\n[[3,6,9],[1,4,7,10],[2,5,8]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1501454641, "last_edit_date": 1501454641, "creation_date": 1501453056, "answer_id": 45405256, "question_id": 45385040, "link": "https://stackoverflow.com/questions/45385040/haskell-creating-a-list-of-equivalents/45405256#45405256", "title": "Haskell: Creating a list of equivalents", "body": "<p>One other way of performing this job would be to use <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:filter\" rel=\"nofollow noreferrer\"><code>filter</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:-92--92-\" rel=\"nofollow noreferrer\"><code>(\\\\)</code> (difference)</a> functions over lists. So the following recursive code should suffice.</p>\n\n<pre><code>groupByRemaindersOf :: Integral a =&gt; a -&gt; [a] -&gt; [[a]]\ngroupByRemaindersOf _ []     = []\ngroupByRemaindersOf p (x:xs) = let ys = x : filter (\\y -&gt; y `rem` p == x `rem` p) xs in ys : groupByRemaindersOf p (xs \\\\ ys)\n\n*Main&gt; groupByRemaindersOf 3 [1..10]\n[[1,4,7,10],[2,5,8],[3,6,9]]\n</code></pre>\n\n<p>Although this seems to be faster than any algorithm involving <code>sort</code>, i believe folding with a <code>Map</code> type as an accumulator might still do better than this.</p>\n"}], "owner": {"reputation": 13, "user_id": 8384725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7ace694c86cd91da5a8f491c33fa4?s=128&d=identicon&r=PG&f=1", "display_name": "notfounds", "link": "https://stackoverflow.com/users/8384725/notfounds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 2, "accepted_answer_id": 45385271, "answer_count": 2, "score": 1, "last_activity_date": 1501454641, "creation_date": 1501300091, "last_edit_date": 1501301851, "question_id": 45385040, "link": "https://stackoverflow.com/questions/45385040/haskell-creating-a-list-of-equivalents", "title": "Haskell: Creating a list of equivalents", "body": "<p>I want to create a function with the following definition.</p>\n\n<pre><code>equivalent :: Eq a =&gt; (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>A definition of equivalent.<br>\nThree integers x, y, p<br>\nx mod p == y mod p then x and y are equivalent.<br>\nelse x and y are not equivalent. </p>\n\n<p>Case: p = 3,<br>\n<code>equivalent eq [1..10]</code> returns the list <code>[[3, 6, 9], [1, 4, 7, 10], [2, 5, 8]]</code><br>\n<code>eq</code> is a function that requires two integer and returns True/False.</p>\n\n<p>Would you guide me how to create the function in Haskell?</p>\n"}, {"tags": ["haskell", "testing", "hspec"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501298356, "post_id": 45384851, "comment_id": 77730987, "body": "well, I think I want a bit more than just the logic. I essentially want to test it from the end point ie I want to test my entire programs functionality against a set of possible inputs. I would indeed test <code>myFunc</code> and test <code>validateInput</code> ... however I want to test everything as a whole... if that is possible at all."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501299266, "post_id": 45384851, "comment_id": 77731107, "body": "I answered based on the output example you provided. I&#39;m not sure if you can test IO easily with HSpec, but if you want to test the &#39;plumbing&#39;, I suppose you could use a different monad that emulates IO, feeding data and recording output. Maybe something like the State monad."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501304909, "post_id": 45384851, "comment_id": 77732059, "body": "@matthias <a href=\"https://stackoverflow.com/a/41699338/2670439\">This answer</a> seems to suggest a similar approach."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1501327927, "post_id": 45384851, "comment_id": 77738117, "body": "@matthias Does that answer your question in full?"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 1, "creation_date": 1501369999, "post_id": 45384851, "comment_id": 77750521, "body": "sorry, have not been at a computer all day. I think your question answers enough and points me in the right direction. Thanks"}], "tags": [], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "is_accepted": true, "score": 2, "last_activity_date": 1501297870, "creation_date": 1501297870, "answer_id": 45384851, "question_id": 45384808, "link": "https://stackoverflow.com/questions/45384808/testing-user-input-with-hspec/45384851#45384851", "title": "Testing user input with Hspec", "body": "<p>Since you want to test the logic rather than the user interaction, I'd suggest that you simply factor out the input validation.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 45384851, "answer_count": 1, "score": 1, "last_activity_date": 1501302287, "creation_date": 1501297411, "last_edit_date": 1501302287, "question_id": 45384808, "link": "https://stackoverflow.com/questions/45384808/testing-user-input-with-hspec", "title": "Testing user input with Hspec", "body": "<p>I have a program that takes a user input from <code>getLine</code> then validates that it is all numbers. If it passes it runs a function of <code>String -&gt; String</code> and prints the result to screen. If not it repeats the <code>getLine</code>.</p>\n\n<pre><code>module Main where\n\nimport Control.Monad.Loops (untilJust)\nimport Data.Char           (isDigit)\n\nmain = do\n  let validateInput s = if all isDigit s then Just s else Nothing\n  putStrLn =&lt;&lt; myFunc &lt;$&gt; untilJust (validateInput &lt;$&gt; (putStr \"Number : \" &gt;&gt; getLine))\n\nmyFunc = id -- to do\n</code></pre>\n\n<p>How do I test the this main function with something like <code>Hspec</code> to check that it does the right thing with a number input vs other inputs (letters, empty etc)</p>\n\n<p>ie </p>\n\n<pre><code>test1 rejects a non-numeric input of \"abc\"\ntest2 returns 123 as 123\n</code></pre>\n"}, {"tags": ["image", "haskell", "repa"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501276784, "post_id": 45382548, "comment_id": 77726450, "body": "<code>computeS</code> does not occur in <code>IO</code> so you need to have <code>let rotated = (computeS $ rot180 v) :: Array F DIM3 Word8</code> instead of <code>rotated &lt;- (computeP $ rot180 v) :: IO (Array F DIM3 Word8)</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501277160, "post_id": 45382548, "comment_id": 77726580, "body": "What is <code>computeP</code>, anyway? I can&#39;t find anything of that name in the libraries you&#39;ve quoted. Please always add concrete links to tha hackage haddocks, like this: <a href=\"http://hackage.haskell.org/package/repa-array-4.2.3.1/docs/Data-Repa-Array-Generic-Load.html#v:computeS\" rel=\"nofollow noreferrer\"><code>computeS</code></a>."}, {"owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "edited": false, "score": 0, "creation_date": 1501277954, "post_id": 45382548, "comment_id": 77726864, "body": "Ok, i will do it next time. Thanks guys."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501279573, "post_id": 45382548, "comment_id": 77727391, "body": "@leftaroundabout To be fair, <code>computeP</code> and <code>computeS</code> are sort of at the centre of REPA. <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#v:computeP\" rel=\"nofollow noreferrer\">Here</a> they are in the main <code>Data.Array.Repa</code> module."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501636814, "post_id": 45382548, "comment_id": 77861090, "body": "@leftaroundabout, question is about repa3, while you added a link to repa4"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1501657997, "post_id": 45382548, "comment_id": 77868539, "body": "@AlexeyKuleshevich well, that underlines my point \u2013 a question should always link to the concrete versions of functions it asks about. Also, <code>computeP</code> is apparently obsolete then..."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501667138, "post_id": 45382548, "comment_id": 77874771, "body": "@leftaroundabout, your point was certainly a valid one. It&#39;s not that <code>computeP</code> is obsolete, it&#39;s that repa4 is still in experimental stage and doesn&#39;t have that function. Not sure if it does computation in parallel by default or simply doesn&#39;t support it, I&#39;ll have to figure it out."}], "answers": [{"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 1, "last_activity_date": 1501638227, "creation_date": 1501638227, "answer_id": 45450157, "question_id": 45382548, "link": "https://stackoverflow.com/questions/45382548/repa-computes-and-computep/45450157#45450157", "title": "REPA: computeS and computeP?", "body": "<p>You are doing everything almost right. The error you are getting is due to the fact that <code>computeP</code> is monadic, while <code>computeS</code> is not. If you compare their type signatures closely the difference that is biting you is the <code>Monad m</code> restriction and return type <code>m (Array r2 sh e)</code> for <code>computeP</code> vs <code>(Array r2 sh e)</code> for <code>computeS</code>. So long story short, just change</p>\n\n<pre><code>rotated &lt;- (computeP $ rot180 v) :: IO (Array F DIM3 Word8)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>let rotated = (computeS $ rot180 v) :: (Array F DIM3 Word8)\n</code></pre>\n\n<p>The reason why parallel computation in Repa must be monadic has to do partially with lazyness, but mostly with Repa's inability to deal with nested parallelism. Sequential property of a <code>Monad</code> solves it for the most part:</p>\n\n<pre><code>rotated1 &lt;- (computeP $ rot180 v) :: IO (Array F DIM3 Word8)\nrotated2 &lt;- (computeP $ rot180 rotated1) :: IO (Array F DIM3 Word8)\n</code></pre>\n\n<p>Using <code>do</code> notation above (and the fact that <code>computeP</code> uses <code>deepSeqArray</code> under the hood) makes sure <code>rotated1</code> is evaluated before getting to second call to <code>computeP</code>. But since <code>computeS</code> doesn't use Repa's parallel scheduler it doesn't have that issue, thus doesn't need to use that property of a <code>Monad</code> and this code will work just fine:</p>\n\n<pre><code>let rotated1 = computeS (rot180 v) :: Array F DIM3 Word8\n    rotated2 = computeS (rot180 rotated1) :: Array F DIM3 Word8\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8384050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a8b6d1c33bc8190ec941a85813e53b5?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburguesa66", "link": "https://stackoverflow.com/users/8384050/hamburguesa66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 45450157, "answer_count": 1, "score": 1, "last_activity_date": 1501638227, "creation_date": 1501276653, "last_edit_date": 1501302300, "question_id": 45382548, "link": "https://stackoverflow.com/questions/45382548/repa-computes-and-computep", "title": "REPA: computeS and computeP?", "body": "<p>I am trying this <strong>REPA</strong> library, and i want to process an image in both ways, <strong>parallel and sequentially</strong>.</p>\n\n<p>I can read the image (with other library, DevIL) and process it with <strong>computeP</strong> (parallel). Here is the code (is from a example on the wiki of haskell).</p>\n\n<pre><code>import Foreign.Ptr\nimport System.Environment\nimport Data.Word\nimport Data.Array.Repa hiding ((++))\nimport Data.Array.Repa.IO.DevIL\nimport Data.Array.Repa.Repr.ForeignPtr\n\nmain :: IO () \nmain = do\n    [f] &lt;- getArgs\n    (RGB v) &lt;- runIL $ readImage f\n    rotated &lt;- (computeP $ rot180 v) :: IO (Array F DIM3 Word8)\n    runIL $ writeImage (\"flip-\"++f) (RGB rotated)\n\nrot180 :: (Source r e) =&gt; Array r DIM3 e -&gt; Array D DIM3 e\nrot180 g = backpermute e flop g\n    where\n        e@(Z :. x :. y :. _)   = extent g\n        flop (Z :. i         :. j         :. k) =\n             (Z :. x - i - 1 :. y - j - 1 :. k)\n</code></pre>\n\n<p>Now i want to do it sequentially changing <strong>\"computeP\"</strong> with <strong>\"computeS\"</strong>.\nBut, when i try to compile it, this error appears:</p>\n\n<pre><code>Couldn't match expected type \u2018IO (Array F DIM3 Word8)\u2019\n                with actual type \u2018Array r20 DIM3 Word8\u2019\n    In a stmt of a 'do' block:\n      rotated &lt;- (computeS $ rot180 v) :: IO (Array F DIM3 Word8)\n</code></pre>\n\n<p>As you can probably guess, i am new at functional programming. I dont know why this error is happening. Any help would be great.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["list", "haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 13, "last_activity_date": 1501258277, "last_edit_date": 1501258277, "creation_date": 1501257956, "answer_id": 45377958, "question_id": 45377867, "link": "https://stackoverflow.com/questions/45377867/haskell-variable-scope-in-list-monad/45377958#45377958", "title": "Haskell: variable scope in list monad", "body": "<pre><code>[1,2] &gt;&gt;= \\n -&gt; ['a','b'] &gt;&gt;= \\ch -&gt; return (n,ch)  \n</code></pre>\n\n<p>is NOT parsed as</p>\n\n<pre><code>[1,2] &gt;&gt;= (\\n -&gt; ['a','b']) &gt;&gt;= (\\ch -&gt; return (n,ch))\n</code></pre>\n\n<p>but as  </p>\n\n<pre><code>[1,2] &gt;&gt;= \\n -&gt; (['a','b'] &gt;&gt;= (\\ch -&gt; return (n,ch)))\n</code></pre>\n\n<p>Your translation with <code>concat / map</code> reflects the \"wrong\" parsing. We can adapt that to the correct one.</p>\n\n<p>The first <code>&gt;&gt;=</code> becomes</p>\n\n<pre><code>concat (map (\\n -&gt; ???) [1,2])\n</code></pre>\n\n<p>and now we can translate the inner <code>&gt;&gt;=</code> replacing <code>???</code> as needed:</p>\n\n<pre><code>??? = concat (map (\\ch -&gt; ???2) ['a','b'])\n???2= return (n,ch)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>concat (map (\\n -&gt; concat (map (\\ch -&gt; return (n,ch)) ['a','b'])) [1,2])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1501274884, "post_id": 45377986, "comment_id": 77725749, "body": "The fixity of <code>&gt;&gt;=</code> is irrelevant, as are lists and monads. The real point is that the body of a lambda expression always extends as far to the right as possible."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501354145, "post_id": 45377986, "comment_id": 77746338, "body": "Well, as far to the right as possible ignoring fixity. If you write <code>\\x -&gt; x == 3 == 4</code>, it will be parsed as <code>\\x -&gt; (x == 3 == 4)</code> and then give an error because <code>==</code> is declared <code>infix</code> (non-associative) rather than <code>infixl</code> or <code>infixr</code>. Haskell 98 actually required that to be parsed as <code>(\\x -&gt; x == 3) == 4</code>, but GHC never implemented that and apparently Haskell 2010 no longer requires it."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 7, "last_activity_date": 1501419401, "last_edit_date": 1501419401, "creation_date": 1501258029, "answer_id": 45377986, "question_id": 45377867, "link": "https://stackoverflow.com/questions/45377867/haskell-variable-scope-in-list-monad/45377986#45377986", "title": "Haskell: variable scope in list monad", "body": "<p>Because your expression:</p>\n\n<pre><code>[1,2] &gt;&gt;= \\n -&gt; ['a','b'] &gt;&gt;= \\ch -&gt; return (n,ch)\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>--                  body of the lambda expression\n--                _________^_______________________\n--               /                                 \\\n[1,2] &gt;&gt;= (\\n -&gt; (['a','b'] &gt;&gt;= \\ch -&gt; return (n,ch)))\n--        \\________________ _________________________/\n--                         v\n--              entire right operand\n</code></pre>\n\n<p>So <strong>on the right of the first <code>&gt;&gt;=</code> you have written a lambda expression</strong>.</p>\n\n<p>The definition of the <code>[]</code> monad is:</p>\n\n<pre><code>instance Monad [] where  \n    return x = [x]  \n    xs &gt;&gt;= f = concat (map f xs)\n</code></pre>\n\n<p>So you have written:</p>\n\n<pre><code>[1,2] &gt;&gt;= (\\n -&gt; (['a','b'] &gt;&gt;= \\ch -&gt; return (n,ch)))\n -&gt; concat (map (\\n -&gt; (['a','b'] &gt;&gt;= \\ch -&gt; return (n,ch)) [1,2])\n -&gt; concat (map (\\n -&gt; concat (map (\\ch -&gt; return (n,ch)) ['a','b'])) [1,2])\n -&gt; concat (map (\\n -&gt; concat (map (\\ch -&gt; [(n,ch)]) ['a','b'])) [1,2])\n</code></pre>\n\n<p>So <code>n</code> is in the scope of the <code>\\ch -&gt; [(n,ch)]</code> expression. And with the last statement, we obtain:</p>\n\n<pre><code>Prelude&gt; concat (map (\\n -&gt; concat (map (\\ch -&gt; [(n,ch)]) ['a','b'])) [1,2])\n[(1,'a'),(1,'b'),(2,'a'),(2,'b')]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1501333664, "last_edit_date": 1501333664, "creation_date": 1501273892, "answer_id": 45381950, "question_id": 45377867, "link": "https://stackoverflow.com/questions/45377867/haskell-variable-scope-in-list-monad/45381950#45381950", "title": "Haskell: variable scope in list monad", "body": "<p>Well @chi and @Willem Van Onsem 's answers are perfectly at place yet just for variety i would like to mention that list comprehensions would just be a syntactical sugar for this monadic job as;</p>\n\n<pre><code>Prelude&gt; [(x,y) | x &lt;- [1,2], y &lt;- ['a', 'b']]\n[(1,'a'),(1,'b'),(2,'a'),(2,'b')]\n</code></pre>\n\n<p>However since lists are also instances of applicative functor class in Haskell another nice way of doing this job without touching monad instance would be;</p>\n\n<pre><code>Prelude&gt; (,) &lt;$&gt; [1,2] &lt;*&gt; ['a','b']\n[(1,'a'),(1,'b'),(2,'a'),(2,'b')]\n</code></pre>\n\n<p>I would like to elaborate the latter a little bit,</p>\n\n<p><code>(,)</code> is in fact a function which takes two arguments and with a type signature; <code>a -&gt; b -&gt; (a,b)</code>. Whereas <code>&lt;$&gt;</code> is the inline form of <code>fmap</code>. So when we apply <code>(,) &lt;$&gt; [1,2]</code> what we get is an applicative functor (a list of functions) like <code>[(,) 1, (,) 2]</code>. Now we can apply the applicative operator <code>&lt;*&gt;</code> which has the type signature <code>Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code> In the type signature <code>f</code> shouldn't be confused with function. It designates a functor which happens to be the <code>[]</code> (list) type here. Which says, <code>&lt;*&gt;</code> will unwrap the contained function(s) from the functor and apply it to the provided functor's contained value(s) to return the result(s) of these applications in the same functor type. So obviously since list applications are defined by all elements one to one the result turns out to be a list of tuples of all combinations.</p>\n"}], "owner": {"reputation": 1348, "user_id": 1133717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/205141334b10dfa55d0b31074cac74bf?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/1133717/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 45377958, "answer_count": 3, "score": 5, "last_activity_date": 1501419401, "creation_date": 1501257663, "question_id": 45377867, "link": "https://stackoverflow.com/questions/45377867/haskell-variable-scope-in-list-monad", "title": "Haskell: variable scope in list monad", "body": "<p>I was reading an online Haskell book about list monad. In the book, the list monad was defined like this:</p>\n\n<pre><code>instance Monad [] where  \n    return x = [x]  \n    xs &gt;&gt;= f = concat (map f xs)  \n    fail _ = []\n</code></pre>\n\n<p>And then there was an example of list monad usage like this:</p>\n\n<pre><code>Prelude&gt; [1,2] &gt;&gt;= \\n -&gt; ['a','b'] &gt;&gt;= \\ch -&gt; return (n,ch)  \n[(1,'a'),(1,'b'),(2,'a'),(2,'b')]\n</code></pre>\n\n<p>I'm new to Haskell and my question about the example is, how come the variable 'n' is available inside the lambda expression of <code>return (n,ch)</code>. <code>n</code> is defined in the other lambda expression and I don't understand why a variable defined in one lambda expression is available in subsequent lambda expressions. I tried converting the example like below according to the list monad definition:</p>\n\n<pre><code>Prelude&gt; concat (map (\\ch -&gt; return (n, ch)) (concat (map (\\n -&gt; ['a', 'b']) [1, 2])))\n\n&lt;interactive&gt;:32:29: error: Variable not in scope: n\n</code></pre>\n\n<p>But as you can see, I got an error saying that the variable <code>n</code> is not available in the scope of the other lambda expression. Maybe the book just presented a simplified version of list monad definition?</p>\n"}, {"tags": ["haskell", "shake-build-system"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501269251, "post_id": 45377013, "comment_id": 77723227, "body": "Can you generate Frontend.elm not in the current directory but in the _build? And can you move all source files to directory src (as example)?"}, {"owner": {"reputation": 529, "user_id": 7208627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ef91c31fe9a352ab3feb4cef3b8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Inc&#246;mplete", "link": "https://stackoverflow.com/users/7208627/inc%c3%b6mplete"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501288073, "post_id": 45377013, "comment_id": 77729372, "body": "@freestyle 1. no, I cannot move it to _build, because 1.1 Elm uses directory structure as module naming space and 1.2 it need to be version controlled. 2 you mean move all hand written source files to a <code>src</code>, but generated source files to somewhere else? no I cannot, because 1.1"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501317773, "post_id": 45377013, "comment_id": 77735208, "body": "1.1 Usually, there is a way to specify the search path for imports. For example, the GHC has an option -i. 1.2 Also usually there is no sense in keeping the generated file in the VCS, it is enough to keep the original data for generation and the build script itself. 2 I mean restructure like this: frontend\\_build -- contains all generated files; frontend\\src -- contains all source files (handwritten)."}], "answers": [{"comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501265761, "post_id": 45379441, "comment_id": 77721431, "body": "Here is problem. <code>getDirectoryFiles &quot;&quot; [&quot;&#47;&#47;*.elm&quot;]</code> depends on changes in CD and Frontend.elm is generated in CD."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501266102, "post_id": 45379441, "comment_id": 77721593, "body": "It is better to keep the source files (not generated) separately and separately the directory for the files that are being builded."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501266922, "post_id": 45379441, "comment_id": 77722016, "body": "@freestyle Ah, right, probably I should move the <code>need</code> a bit higher to deal with that infelicity. Modification incoming."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1501268362, "post_id": 45379441, "comment_id": 77722771, "body": "This can still lead to a problem. Let us imagine that the Frontend.elm depends (or will be in the future) <code>getDirectoryFiles &quot;&quot; [&quot;&#47;&#47;*.somthingelse&quot;]</code>. The shake doc talks about getDirectoryFiles: &quot;You should only call this function returning source files&quot;."}, {"owner": {"reputation": 529, "user_id": 7208627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ef91c31fe9a352ab3feb4cef3b8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Inc&#246;mplete", "link": "https://stackoverflow.com/users/7208627/inc%c3%b6mplete"}, "edited": false, "score": 0, "creation_date": 1501296416, "post_id": 45379441, "comment_id": 77730712, "body": "seems I can get away with <code>orderOnly</code>"}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1501428069, "post_id": 45379441, "comment_id": 77763249, "body": "The above <code>need [&quot;Frontend.elm&quot;]</code> situation is exactly what <code>orderOnly</code> was designed for. That said, if you <code>orderOnly</code> something then know you will later always <code>need</code> it then it&#39;s really no benefit (or harm) in using <code>orderOnly</code> the first time."}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1501430371, "post_id": 45379441, "comment_id": 77763958, "body": "It is safe to do <code>getDirectoryFiles</code> after <code>orderOnly</code> or <code>need</code>ing everything that might be added to the directory. I&#39;ve slightly weakened the docs to say &quot;You should normally only call...&quot; - your case is safe."}, {"owner": {"reputation": 529, "user_id": 7208627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ef91c31fe9a352ab3feb4cef3b8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Inc&#246;mplete", "link": "https://stackoverflow.com/users/7208627/inc%c3%b6mplete"}, "edited": false, "score": 0, "creation_date": 1501486239, "post_id": 45379441, "comment_id": 77779792, "body": "I&#39;m not sure if I understand you right, but if I <code>orderOnly [frontendElm]</code> then <code>need everyElmsIncludingFrontendElm</code>, the build works, if I just <code>need everyElmsIncludingFrontendElm</code>, then it will complain."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1501266950, "last_edit_date": 1501266950, "creation_date": 1501263680, "answer_id": 45379441, "question_id": 45377013, "link": "https://stackoverflow.com/questions/45377013/shake-how-do-i-depend-on-dynamically-generated-source-files/45379441#45379441", "title": "Shake: how do I depend on dynamically generated source files?", "body": "<p>You should probably:</p>\n\n<ol>\n<li>Switch from <code>getDirectoryFilesIO</code>, which does not track changes to the file system, to <code>getDirectoryFiles</code>, which does.</li>\n<li>Declare your dependence on <code>Frontend.elm</code>, which you know you need even if it does not exist in the filesystem yet (hence might not be visible to <code>getDirectoryFiles</code>).</li>\n<li>(Optional) Don't bother <code>want</code>ing <code>Frontend.elm</code>, since you only wanted it as a hack to enable <code>_build/index.js</code>.</li>\n</ol>\n\n<p>With these changes, it would look like this:</p>\n\n<pre><code>want [\"_build/index.js\"]\n\"_build/index.js\" %&gt; \\out -&gt; do\n    need [\"Frontend.elm\"]\n    elms &lt;- filter (not . elmStuff)\n            &lt;$&gt; getDirectoryFiles \"\" [\"//*.elm\"]\n    need elms\n    blah blah\n\n\"Frontend.elm\" %&gt; \\_out -&gt; do\n    cmd [\"protoc\", \"blah\", \"blah\"]\n</code></pre>\n\n<p>Caveat lector: I have not tested this solution.</p>\n"}], "owner": {"reputation": 529, "user_id": 7208627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ef91c31fe9a352ab3feb4cef3b8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Inc&#246;mplete", "link": "https://stackoverflow.com/users/7208627/inc%c3%b6mplete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1501266950, "creation_date": 1501254882, "last_edit_date": 1501255526, "question_id": 45377013, "link": "https://stackoverflow.com/questions/45377013/shake-how-do-i-depend-on-dynamically-generated-source-files", "title": "Shake: how do I depend on dynamically generated source files?", "body": "<p>Given a directory structure like this:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 frontend\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 _build/          -- build dir, all files produced by shake, except for Frontend.elm, go here\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Build.hs         -- the build script\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 build.sh         -- wrap Build.hs with `stack exec build -- $@`\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 other files ...\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Frontend.elm     -- generated by a rule in Build.hs, `protoc  -I../proto --elm_out=. ../proto/frontend.proto`\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Index.elm        -- hand written source file\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 other elms ...   -- hand written source files\n\u2514\u2500\u2500 proto\n \u00a0\u00a0 \u2514\u2500\u2500 frontend.proto   -- protocol buffer message defination, hand written\n</code></pre>\n\n<p>Target <code>_build/index.js</code> depends on all <code>.elm</code> files, including <code>Frontend.elm</code>,\nbut <code>Frontend.elm</code> is generated by a rule in <code>Build.hs</code>,\nif I blindly do:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>want [\"_build/index.js\"]\n\"_build/index.js\" %&gt; \\out -&gt; do\n    elms &lt;- filter (not . elmStuff)\n            &lt;$&gt; (liftIO $ getDirectoryFilesIO \"\" [\"//*.elm\"])\n    need elms\n    blah blah\n\nwant [\"Frontend.elm\"]\n\"Frontend.elm\" %&gt; \\_out -&gt; do\n    cmd [\"protoc\", \"blah\", \"blah\"]\n</code></pre>\n\n<p><code>build.sh clean</code> would give me:</p>\n\n<pre><code>Lint checking error - value has changed since being depended upon:\n  Key:  Frontend.elm\n  Old:  File {mod=0x608CAAF7,size=0x53D,digest=NEQ}\n  New:  File {mod=0x608CAB5B,size=0x53D,digest=NEQ}\n</code></pre>\n\n<p>Is there a way to tell shake to watch out for the dynamically generated <code>Frontend.elm</code>, maybe build it first so it doesn't change during the rest of the build, I tried <code>priority 100 (\"Frontend.elm\" %&gt; ...)</code>, doesn't work.</p>\n"}, {"tags": ["haskell", "compiler-errors"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501252187, "post_id": 45375994, "comment_id": 77713510, "body": "Why do you use <code>elemIndex</code> here?"}, {"owner": {"reputation": 57, "user_id": 8279308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xBPta.jpg?s=128&g=1", "display_name": "majorTom", "link": "https://stackoverflow.com/users/8279308/majortom"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501252435, "post_id": 45375994, "comment_id": 77713676, "body": "what should i use instead?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1501253668, "post_id": 45375994, "comment_id": 77714577, "body": "You may want to add type annotations for your functions. That should help you have a good mental model of what you&#39;re doing and can lead to better error messages if ghc infers something at odds with what you&#39;ve declared you wanted."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8279308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xBPta.jpg?s=128&g=1", "display_name": "majorTom", "link": "https://stackoverflow.com/users/8279308/majortom"}, "edited": false, "score": 0, "creation_date": 1501253033, "post_id": 45376212, "comment_id": 77714160, "body": "i would have sat there staring at this for the next ours THX for the quick answer!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1501255461, "last_edit_date": 1501255461, "creation_date": 1501252617, "answer_id": 45376212, "question_id": 45375994, "link": "https://stackoverflow.com/questions/45375994/haskell-non-type-variable-argument-error/45376212#45376212", "title": "Haskell Non type-variable argument Error", "body": "<pre><code>| p == x = noten !! (fromJust (elemIndex x p))\n</code></pre>\n\n<p>From <code>p == x</code>, <code>p</code> and <code>x</code> are of the same type. Let's name this <code>a</code>.</p>\n\n<p>From <code>elemIndex x p</code>, <code>p</code> must be of a list type, say <code>[b]</code>. Also <code>x</code> must be a potential element of <code>p</code>, so it must have type <code>b</code>.</p>\n\n<p>So, we get <code>a ~ [b] ~ [a]</code>, which is nonsense: a list can not contain elements of the same list type.</p>\n\n<p>Also, we strongly recommend to provide the intended type for every top-level definition. In that way, GHC will produce better type errors, pointing out the differences between what type we intend to define, and the type which instead results from our code.</p>\n"}], "owner": {"reputation": 57, "user_id": 8279308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xBPta.jpg?s=128&g=1", "display_name": "majorTom", "link": "https://stackoverflow.com/users/8279308/majortom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 45376212, "answer_count": 1, "score": 0, "last_activity_date": 1501255461, "creation_date": 1501252029, "question_id": 45375994, "link": "https://stackoverflow.com/questions/45375994/haskell-non-type-variable-argument-error", "title": "Haskell Non type-variable argument Error", "body": "<p>So the Function im writing is supposed to take in some amount of Points (punkte) and Bonus Points and then compair it to the punkte list and return the corresponding grade (noten list).</p>\n\n<p>Im fairly new to haskell and bad at interpreting errors.</p>\n\n<p>I get that Infinite type error fairly often i never really know why.\nCan you please explain that to me ?\nAnd maybe give a solution?</p>\n\n<p>Function:</p>\n\n<pre><code>import Data.Char -- i know i don't need this so far\nimport Data.List\nimport Data.Maybe\n\npunkte = [50,54..86] \nnoten = [4.0,3.7,3.3,3.0,2.7,2.3,2.0,1.7,1.3,1.0]\n\nberechneNote p bp\n    | bp &gt; 20 = error \"too many bonuspoints\"\n    | bp &lt; 0 = error \"you can't give negative points\"\n    | p &gt; 100 = error \"too many points\"\n    | p &lt; 0 = error \"you can't give negative points\"\n    | otherwise = berechneNote2 (p+bp) punkte\n\n-- this constructes an infinite type aparently ?\nberechneNote2 p (x:xs)\n    | p == x = noten !! (fromJust (elemIndex x p))\n    | p &gt; x = berechneNote2 p xs\n    | p &lt; x = noten !! (fromJust (elemIndex x p))\n</code></pre>\n\n<p>and this is the Error i get </p>\n\n<pre><code>blatt1.hs:17:48: error:\n\u2022 Occurs check: cannot construct the infinite type: a ~ [a]\n\u2022 In the second argument of \u2018elemIndex\u2019, namely \u2018p\u2019\n  In the first argument of \u2018fromJust\u2019, namely \u2018(elemIndex x p)\u2019\n  In the second argument of \u2018(!!)\u2019, namely\n    \u2018(fromJust (elemIndex x p))\u2019\n\u2022 Relevant bindings include\n    xs :: [a] (bound at blatt1.hs:16:20)\n    x :: a (bound at blatt1.hs:16:18)\n    p :: a (bound at blatt1.hs:16:15)\n    berechneNote2 :: a -&gt; [a] -&gt; Double (bound at blatt1.hs:16:1)\n</code></pre>\n"}, {"tags": ["json", "haskell", "lazy-evaluation", "decoding", "aeson"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 2, "creation_date": 1501253310, "post_id": 45374472, "comment_id": 77714345, "body": "This doesn&#39;t answer your question, but <a href=\"https://github.com/bos/aeson/issues/315\" rel=\"nofollow noreferrer\">there is an open issue on aeson asking about this difference.</a>"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1501253497, "post_id": 45374472, "comment_id": 77714459, "body": "@Li-yaoXia nice catch! I didn&#39;t found that issue."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1501279406, "post_id": 45374472, "comment_id": 77727333, "body": "Looking at the source of <code>aeson</code>, it looks like the only distinction is whether or not strings and numbers will be forced all the way (thereby allocating potentially expensive number or string data structures). That said, I haven&#39;t been able to trigger this behaviour yet..."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1501615067, "post_id": 45374472, "comment_id": 77853017, "body": "I think the intention looking at <code>value</code> and <code>value&#39;</code> is for the strict version to eagerly build any nested objects/arrays. In practice I&#39;m not sure the lazy version avoids much work since the parser would have to check whether any objects/arrays are well formed before moving to the next property, but I think the copying/processing to build the <code>HashMap</code>/<code>Vector</code> in <code>objectValues</code>/<code>arrayValues</code> would be avoided/deferred in the lazy version."}], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1501256888, "post_id": 45374842, "comment_id": 77716726, "body": "There are also <code>decodeStrict</code> and <code>decodeStrict&#39;</code> functions which are not the same as <code>decode</code> and <code>decode&#39;</code>. Things are not so trivial. Not clear what exactly is inside thunk and how it affects performance."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 2, "creation_date": 1501257124, "post_id": 45374842, "comment_id": 77716868, "body": "Yes, I already realized I&#39;ve misunderstood your question. At first it looked like you just didn&#39;t know the difference between strict and lazy, but now after reading some of your comments, I understand that you were looking for a deeper answer."}, {"owner": {"reputation": 1955, "user_id": 1211428, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c4514c5bec0f849d1a202dd4fb25a6dc?s=128&d=identicon&r=PG", "display_name": "zaquest", "link": "https://stackoverflow.com/users/1211428/zaquest"}, "edited": false, "score": 0, "creation_date": 1501486894, "post_id": 45374842, "comment_id": 77780149, "body": "The answer is correct. <code>decodeStrict</code> variants are for the strict <code>ByteString</code>s"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 1955, "user_id": 1211428, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c4514c5bec0f849d1a202dd4fb25a6dc?s=128&d=identicon&r=PG", "display_name": "zaquest", "link": "https://stackoverflow.com/users/1211428/zaquest"}, "edited": false, "score": 1, "creation_date": 1501503835, "post_id": 45374842, "comment_id": 77792363, "body": "@zaquest though this answer is technically correct, it is not the answer that the OP was looking for. But thank you for the upvote :-)"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 1, "last_activity_date": 1501250332, "last_edit_date": 1501250332, "creation_date": 1501248636, "answer_id": 45374842, "question_id": 45374472, "link": "https://stackoverflow.com/questions/45374472/what-is-difference-between-decode-and-decode-functions-from-aeson-package/45374842#45374842", "title": "What is difference between decode and decode&#39; functions from aeson package?", "body": "<p>Haskell is a lazy language. When you call a function, it doesn't actually execute right then, but instead the information about the call is \"remembered\" and returned up the stack (this remembered call information is referred to as \"thunk\" in the docs), and the actual call only happens if somebody up the stack actually tires to do something with the returned value.</p>\n\n<p>This is the default behavior, and this is how <code>json</code> and <code>decode</code> work. But there is a way to \"cheat\" the laziness and tell the compiler to execute code and evaluate values right then and there. And this is what <code>json'</code> and <code>decode'</code> do.</p>\n\n<p>The tradeoff there is obvious: <code>decode</code> saves computation time in case you never actually do anything with the value, while <code>decode'</code> saves the necessity to \"remember\" the call information (the \"thunk\") at the cost of executing everything in place.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1501626772, "post_id": 45448056, "comment_id": 77858491, "body": "I was going to make this same answer but wasn\u2019t certain about it\u2014still, I believe you\u2019re right. My impression is that it can also make a big difference if you\u2019re decoding to something <i>other</i> than <code>Value</code> that takes up considerably more memory than the <code>Value</code> would. For example, say you have an object whose values are run-length\u2013encoded arrays: <code>{&quot;data1&quot;: [10000, 0], &quot;data2&quot;: [1, 1]}</code>. If you only access <code>data2</code>, you don\u2019t want to decompress the whole <code>data1</code> value."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1501627142, "post_id": 45448056, "comment_id": 77858603, "body": "@JonPurdy I originally thought that, too, and I was going to include something about that, but I realized in truth it\u2019s entirely up to the <code>FromJSON</code> instance how lazy it wants to be. Ultimately, both <code>decode</code> and <code>decode&#39;</code> produce a <code>Value</code>, then provide it to <code>fromJSON</code>, which subsequently produces whatever the <code>Parser</code> produces. I don\u2019t believe strict production of <code>Value</code>s would change the strictness properties of the value produced by <code>fromJSON</code> in any significant way."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1501631912, "post_id": 45448056, "comment_id": 77859913, "body": "I&#39;d expect the laziness to be potentially beneficial only when it (effectively) delays the conversion of a bunch of slices into actual <code>Text</code> values. To win by delaying construction of results after parsing, the results have to be quite a bit bigger than the thunks representing them. That&#39;s often a tall order. Even worse, delaying construction can lead to space leaks; just one unforced result can easily keep a bytestring chunk live."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501634684, "post_id": 45448056, "comment_id": 77860586, "body": "@dfeuer I thought about writing some benchmarks for this, but that was considerably more work than I wanted to put in today. Another answer with raw numbers would be useful, though."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1501642544, "post_id": 45448056, "comment_id": 77862462, "body": "I&#39;ve worked with JSON values that are basically an object wrapper with a bunch of meta-data fields, and then one field with a large array of complex objects. It&#39;s not uncommon to need to process large collections of these outer objects where only the meta-data is relevant, so I can see this sort of distinction making a significant difference; you still need to recognise the JSON structure to know when the array that you&#39;re ignoring ends and start on the next set of metadata, but spending time converting the JSON text representing the array into nested Haskell values would be wasteful."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1501665650, "post_id": 45448056, "comment_id": 77873650, "body": "@AlexisKing Thank you for such detailed explanation and for your effort! Now the difference is crystal clear for me. I wonder, could this somehow go to the documentation of <code>aeson</code> package under corresponding issue posted in comments to my question?"}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 15, "last_activity_date": 1501624732, "last_edit_date": 1501624732, "creation_date": 1501623419, "answer_id": 45448056, "question_id": 45374472, "link": "https://stackoverflow.com/questions/45374472/what-is-difference-between-decode-and-decode-functions-from-aeson-package/45448056#45448056", "title": "What is difference between decode and decode&#39; functions from aeson package?", "body": "<p>The difference between these two is subtle. There <em>is</em> a difference, but it\u2019s a little complicated. We can start by taking a look at the types.</p>\n\n<h2>The <code>Value</code> type</h2>\n\n<p>It\u2019s important to note that the <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson-Types.html#t:Value\" rel=\"noreferrer\"><code>Value</code></a> type that aeson provides has been strict for a very long time (specifically, since version 0.4.0.0). This means that there cannot be any thunks between a constructor of <code>Value</code> and its internal representation. This immediately means that <code>Bool</code> (and, of course, <code>Null</code>) <em>must</em> be completely evaluated once a <code>Value</code> is evaluated to WHNF.</p>\n\n<p>Next, let\u2019s consider <code>String</code> and <code>Number</code>. The <code>String</code> constructor contains a value of type <strong>strict</strong> <code>Text</code>, so there can\u2019t be any laziness there, either. Similarly, the <code>Number</code> constructor contains a <code>Scientific</code> value, which is internally represented by two strict values. Both <code>String</code> and <code>Number</code> must <em>also</em> be completely evaluated once a <code>Value</code> is evaluated to WHNF.</p>\n\n<p>We can now turn our attention to <code>Object</code> and <code>Array</code>, the only nontrivial datatypes that JSON provides. These are more interesting. <code>Object</code>s are represented in aeson by a <strong>lazy</strong> <code>HashMap</code>. Lazy <code>HashMap</code>s only evaluate their keys to WHNF, not their values, so the values could very well remain unevaluated thunks. Similarly, <code>Array</code>s are <code>Vector</code>s, which are not strict in their values, either. Both of these sorts of <code>Value</code>s can contain thunks.</p>\n\n<p>With this in mind, we know that, once we have a <code>Value</code>, the <em>only</em> places that <code>decode</code> and <code>decode'</code> may differ is in the production of objects and arrays.</p>\n\n<h2>Observational differences</h2>\n\n<p>The next thing we can try is to actually evaluate some things in GHCi and see what happens. We\u2019ll start with a bunch of imports and definitions:</p>\n\n<pre><code>:seti -XOverloadedStrings\n\nimport Control.Exception\nimport Control.Monad\nimport Data.Aeson\nimport Data.ByteString.Lazy (ByteString)\nimport Data.List (foldl')\nimport qualified Data.HashMap.Lazy as M\nimport qualified Data.Vector as V\n\n:{\nforceSpine :: [a] -&gt; IO ()\nforceSpine = evaluate . foldl' const ()\n:}\n</code></pre>\n\n<p>Next, let\u2019s actually parse some JSON:</p>\n\n<pre><code>let jsonDocument = \"{ \\\"value\\\": [1, { \\\"value\\\": [2, 3] }] }\" :: ByteString\n\nlet !parsed = decode jsonDocument :: Maybe Value\nlet !parsed' = decode' jsonDocument :: Maybe Value\nforce parsed\nforce parsed'\n</code></pre>\n\n<p>Now we have two bindings, <code>parsed</code> and <code>parsed'</code>, one of which is parsed with <code>decode</code> and the other with <code>decode'</code>. They are forced to WHNF so we can at least see what they are, but we can use the <code>:sprint</code> command in GHCi to see how much of each value is actually evaluated:</p>\n\n<pre><code>ghci&gt; :sprint parsed\nparsed = Just _\nghci&gt; :sprint parsed'\nparsed' = Just\n            (Object\n               (unordered-containers-0.2.8.0:Data.HashMap.Base.Leaf\n                  15939318180211476069 (Data.Text.Internal.Text _ 0 5)\n                  (Array (Data.Vector.Vector 0 2 _))))\n</code></pre>\n\n<p>Would you look at that! The version parsed with <code>decode</code> is still unevaluated, but the one parsed with <code>decode'</code> has some data. This leads us to our first meaningful difference between the two: <code>decode'</code> forces its immediate result to WHNF, but <code>decode</code> defers it until it is needed.</p>\n\n<p>Let\u2019s look inside these values to see if we can\u2019t find more differences. What happens once we evaluate those outer objects? </p>\n\n<pre><code>let (Just outerObjValue) = parsed\nlet (Just outerObjValue') = parsed'\nforce outerObjValue\nforce outerObjValue'\n\nghci&gt; :sprint outerObjValue\nouterObjValue = Object\n                  (unordered-containers-0.2.8.0:Data.HashMap.Base.Leaf\n                     15939318180211476069 (Data.Text.Internal.Text _ 0 5)\n                     (Array (Data.Vector.Vector 0 2 _)))\n\nghci&gt; :sprint outerObjValue'\nouterObjValue' = Object\n                   (unordered-containers-0.2.8.0:Data.HashMap.Base.Leaf\n                      15939318180211476069 (Data.Text.Internal.Text _ 0 5)\n                      (Array (Data.Vector.Vector 0 2 _)))\n</code></pre>\n\n<p>This is pretty obvious. We explicitly forced both of the objects, so they are now both evaluated to hash maps. The real question is whether or not their <em>elements</em> are evaluated.</p>\n\n<pre><code>let (Array outerArr) = outerObj M.! \"value\"\nlet (Array outerArr') = outerObj' M.! \"value\"\nlet outerArrLst = V.toList outerArr\nlet outerArrLst' = V.toList outerArr'\n\nforceSpine outerArrLst\nforceSpine outerArrLst'\n\nghci&gt; :sprint outerArrLst\nouterArrLst = [_,_]\n\nghci&gt; :sprint outerArrLst'\nouterArrLst' = [Number (Data.Scientific.Scientific 1 0),\n                Object\n                  (unordered-containers-0.2.8.0:Data.HashMap.Base.Leaf\n                     15939318180211476069 (Data.Text.Internal.Text _ 0 5)\n                     (Array (Data.Vector.Vector 0 2 _)))]\n</code></pre>\n\n<p>Another difference! For the array decoded with <code>decode</code>, the values are not forced, but the ones decoded with <code>decode'</code> are. As you can see, this means <code>decode</code> doesn\u2019t actually perform conversion to Haskell values until they are actually needed, which is what the documentation means when it says it \u201cdefers conversion\u201d.</p>\n\n<h2>Impact</h2>\n\n<p>Clearly, these two functions are <em>slightly</em> different, and clearly, <code>decode'</code> is stricter than <code>decode</code>. What\u2019s the meaningful difference, though? When would you prefer one over the other?</p>\n\n<p>Well, it\u2019s worth mentioning that <code>decode</code> never does more work than <code>decode'</code>, so <code>decode</code> is probably the right default. Of course, <code>decode'</code> will never do significantly more work than <code>decode</code>, either, since the entire JSON document needs to be parsed before any value can be produced. The only significant difference is that <code>decode</code> avoids allocating <code>Value</code>s if only a small part of the JSON document is actually used.</p>\n\n<p>Of course, laziness is not free, either. Being lazy means adding thunks, which can cost space and time. If all of the thunks are going to be evaluated, anyway, then <code>decode</code> is simply wasting memory and runtime adding useless indirection.</p>\n\n<p>In this sense, the situations when you might want to use <code>decode'</code> are situations in which the whole <code>Value</code> structure is going to be forced, anyway, which is probably dependent on which <code>FromJSON</code> instance you\u2019re using. In general, I wouldn\u2019t worry about picking between them unless performance really matters <em>and</em> you\u2019re decoding a lot of JSON or doing JSON decoding in a tight loop. In either case, you should benchmark. Choosing between <code>decode</code> and <code>decode'</code> is a very specific manual optimization, and I would not feel very confident that either would actually improve the runtime characteristics of my program without benchmarks.</p>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 3, "accepted_answer_id": 45448056, "answer_count": 2, "score": 15, "last_activity_date": 1501624732, "creation_date": 1501247511, "last_edit_date": 1501257095, "question_id": 45374472, "link": "https://stackoverflow.com/questions/45374472/what-is-difference-between-decode-and-decode-functions-from-aeson-package", "title": "What is difference between decode and decode&#39; functions from aeson package?", "body": "<p>Functions <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson.html#v:decode\" rel=\"noreferrer\"><code>decode</code></a> and <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson.html#v:decode-39-\" rel=\"noreferrer\"><code>decode'</code></a> from <a href=\"http://hackage.haskell.org/package/aeson\" rel=\"noreferrer\"><code>aeson</code></a> package are almost identical. But they have subtle difference described in documentation (posting only interesting part of docs here):</p>\n\n<pre><code>-- This function parses immediately, but defers conversion.  See\n-- 'json' for details.\ndecode :: (FromJSON a) =&gt; L.ByteString -&gt; Maybe a\ndecode = decodeWith jsonEOF fromJSON\n\n-- This function parses and performs conversion immediately.  See\n-- 'json'' for details.\ndecode' :: (FromJSON a) =&gt; L.ByteString -&gt; Maybe a\ndecode' = decodeWith jsonEOF' fromJSON\n</code></pre>\n\n<p>I tried to read description of <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson.html#v:json\" rel=\"noreferrer\"><code>json</code></a> and <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson.html#v:json-39-\" rel=\"noreferrer\"><code>json'</code></a> functions but still don't understand which one and when I should use because documentation is not clear enough. Can anybody describe more precisely the difference between two functions and provide some example with behavior explanation if possible?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>There are also <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson.html#v:decodeStrict\" rel=\"noreferrer\"><code>decodeStrict</code></a> and <a href=\"http://hackage.haskell.org/package/aeson-1.2.1.0/docs/Data-Aeson.html#v:decodeStrict-39-\" rel=\"noreferrer\"><code>decodeStrict'</code></a> functions. I'm not asking what is difference between <code>decode'</code> and <code>decodeStrict</code> for example which by the way is an interesting question as well. But what's lazy and what's strict here in all these functions is not obvious at all.</p>\n"}, {"tags": ["haskell", "abstract-data-type"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1501238081, "post_id": 45371166, "comment_id": 77702973, "body": "What is <code>SomeBoxType</code>?"}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501238115, "post_id": 45371166, "comment_id": 77703006, "body": "That is the question, is there some sort of Box type that allows this behavior"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1501238167, "post_id": 45371166, "comment_id": 77703043, "body": "What&#39;s <code>Tree (SomeBoxType (any | Extention2))</code> again? What do you mean by <code>any | Extention2</code> there? It&#39;s a function signature, not a data declaration, and you&#39;re using data declaration syntax here."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1501238213, "post_id": 45371166, "comment_id": 77703079, "body": "And how do you <i>intend to use all of this</i>? That&#39;s generally the most useful piece of information."}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1501238458, "post_id": 45371166, "comment_id": 77703244, "body": "@BartekBanachewicz basicly &quot;This type can hold anything plus optionally the types from <code>Extention2</code>&quot;  @leftaroundabout A plugin based tree transforming application, the tree represents data that is in the payload. Depending on context, I need additional data that can be transformed to base data, so I have a plugin that takes the extended definition and transforms all extra data to the base data. As the base program should not be recompiled for every setting I cannot modify the base ADT, basicy it is a compiler"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1501238505, "post_id": 45371166, "comment_id": 77703288, "body": "If it can hold anything, then it can also hold Extention2, no? Why do you need to single it out? And to the comment above, why can&#39;t you just parametrize your tree type on that additional data? You need to build everything together anyway, no?"}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "edited": false, "score": 0, "creation_date": 1501238640, "post_id": 45371166, "comment_id": 77703381, "body": "Just to show that after the transformation it is not left in there, you are right, it should be <code>transform:: Tree (SomeBoxType any) -&gt; Tree (SomeBoxType (any without Extention2))</code> I do not care about the types that much, because this happens at runtime anyway. In theory <code>any -&gt; any</code> would be also fine, I just want to pattern match out the Extention2 types"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1501238738, "post_id": 45371166, "comment_id": 77703452, "body": "Well &quot;any&quot; type wrapper, while possible, is not very useful since you erase all type information that way. &quot;Any without extensions&quot; isn&#39;t very meaningful either. Again, why not <code>Tree AnnotatedData -&gt; Tree BaseData</code>? You can&#39;t &quot;pattern match&quot; on any value, that&#39;s essentially dynamic typing you&#39;re asking for."}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "edited": false, "score": 0, "creation_date": 1501238843, "post_id": 45371166, "comment_id": 77703531, "body": "Because the two plugins could be used together, so it would be <code>Tree AnnotatedData1and2 -&gt; Tree AnnotatedData2</code> and this with all possible permutations. Not possible, because I want to add plugins later on without modifying every other plugin"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1501239335, "post_id": 45371166, "comment_id": 77703883, "body": "Well if all of those can be combined into BaseData, you just need a class with a <code>class CombinesWithBase where combine :: a -&gt; BaseData -&gt; BaseData</code>. Then you can create a polywrapper for the extensions: <code>newtype Polyextension = forall a. CombinesWithBase a =&gt; Polyextension a</code>, make it an instance of <code>CombineWithBase</code>: <code>instance CombineWithBase Polyextension where combine (Polyextension a) b = combine a b</code>, and lastly store those in a list: <code>data ComplexData = CD BaseData [Polyextension]</code>. This is supposedly an antipattern (that&#39;s why it&#39;s not an answer), but has worked for me before."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501254991, "post_id": 45371166, "comment_id": 77715537, "body": "You may want to read &quot;Data types &#224; la carte&quot;. I suspect that&#39;s what you&#39;re reaching toward."}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501261513, "post_id": 45371166, "comment_id": 77719199, "body": "@dfeuer I think you are right, but currently I understand only half of the paper and can&#39;t transfer the technique to my tree example. I have to reread it a few times"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501267788, "post_id": 45371166, "comment_id": 77722443, "body": "You should also read some of what Oleg Kiselyov has written about <a href=\"http://okmij.org/ftp/tagless-final/index.html\" rel=\"nofollow noreferrer\">tagless final style</a> for an alternative approach."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1501276856, "creation_date": 1501276856, "answer_id": 45382595, "question_id": 45371166, "link": "https://stackoverflow.com/questions/45371166/is-it-possible-to-create-a-function-in-haskell-that-operates-on-a-set-of-types/45382595#45382595", "title": "Is it possible to create a function in Haskell that operates on a set of types?", "body": "<p>I suspect you just want a <code>Functor</code> instance. Thus:</p>\n\n<pre><code>instance Functor Tree where\n    fmap f (Node x children) = Node (f x) (fmap (fmap f) children)\n    fmap f Empty = Empty\n</code></pre>\n\n<p>Now <code>fmap</code> can be given any of these types:</p>\n\n<pre><code>fmap :: (Either any BasePayload -&gt; any) -&gt; Tree (Either any BasePayload) -&gt; Tree any\nfmap :: (Either any Extention1  -&gt; any) -&gt; Tree (Either any Extention1 ) -&gt; Tree any\nfmap :: (Either any Extention2  -&gt; any) -&gt; Tree (Either any Extention2 ) -&gt; Tree any\n</code></pre>\n\n<p>As an aside, I find the <code>Empty</code> constructor very suspicious. What's the difference between <code>Node 0 []</code> and <code>Node 0 [Empty]</code> for example? Is <code>Node 0 [Empty, Empty]</code> a sensible value to have at all? Consider using <a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Tree.html\" rel=\"nofollow noreferrer\"><code>Data.Tree</code></a>, which comes with your compiler, doesn't have this issue, and already has a <code>Functor</code> instance.</p>\n"}], "owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501276856, "creation_date": 1501237871, "last_edit_date": 1501238527, "question_id": 45371166, "link": "https://stackoverflow.com/questions/45371166/is-it-possible-to-create-a-function-in-haskell-that-operates-on-a-set-of-types", "title": "Is it possible to create a function in Haskell that operates on a set of types?", "body": "<p>I have been searching google for a while, but was not able to find an answer:</p>\n\n<p>Say I have Tree ADT that is polymorphic, a base payload sum type and two extention sum types:</p>\n\n<pre><code>--Base.hs\ndata Tree a = Node a [Tree a] | Empty\ndata BasePayload = BaseA String | BaseB Int\n\n--Extention1.hs\ndata Extention1 = Ext1A String String | Ext1B Int\n\n--Extention2.hs\ndata Extention2 = B | A\n</code></pre>\n\n<p>I cannot modify the base type, and I do not know if and how many extention types are used at compile time. Is it possible to create functions that work like this:</p>\n\n<pre><code>--Base.hs\ntype GeneralTree = Tree SomeBoxType\n\ntransform :: Tree (SomeBoxType (any | BasePayload)) -&gt; Tree (SomeBoxType any)\n\n--Extention1.hs\ntransform :: Tree (SomeBoxType (any | Extention1)) -&gt; Tree (SomeBoxType any)\n\n--Extention2.hs\ntransform :: Tree (SomeBoxType (any | Extention2)) -&gt; Tree (SomeBoxType any)\n</code></pre>\n\n<p>Is something like this possible? When I searched I found GADT, which is not what I need and DataKinds and TypeFamilies, which I did not  understand 100%, but dont think will help here. Is that Row Polymorphism?\nThanks for your help.</p>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1501219970, "post_id": 45365374, "comment_id": 77691687, "body": "In order to be a <code>Monad</code>, the type needs to be a type constructor like <code>data MyMonad a = Maybe a</code>. Currently, your type has kind <code>*</code>, so it can&#39;t be made into a monad."}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501220108, "post_id": 45365374, "comment_id": 77691737, "body": "@4castle: thanks fixed it but there&#39;s something more fundamental wrong with my syntax and i am not sure what"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1501220207, "post_id": 45365374, "comment_id": 77691773, "body": "<code>comb</code> in your second link <i>is</i> bind."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1501220376, "post_id": 45365374, "comment_id": 77691826, "body": "You haven&#39;t defined <code>Just</code> or <code>Nothing</code> as data constructors for <code>MyMonad</code>. Also, you&#39;re missing an <code>=</code> sign and a function variable in the definition for <code>&gt;&gt;=</code>. You can&#39;t pattern match on functions."}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501220586, "post_id": 45365374, "comment_id": 77691929, "body": "@4castle: can you say more about <code>&gt;&gt;=</code> use in this case? why do i need an equal sign? can&#39;t i define theoretically all my functions as lamdas and never use an equal sign?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501220755, "post_id": 45365374, "comment_id": 77691993, "body": "The <code>=</code> sign is required in order to define a value for a name. Your code already uses one when you defined <code>f</code> as <code>f = ...</code>. Similarly, you could do <code>(&gt;&gt;=) = \\x f -&gt; ...</code>, but it&#39;s a bit easier to read if you define <code>&gt;&gt;=</code> in infix form."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501221083, "post_id": 45365374, "comment_id": 77692138, "body": "I might also add that defining a &quot;monad that takes integers&quot; is an impossibility, because a monad needs to be able to &quot;hold&quot; any type of value. That&#39;s why <code>&gt;&gt;=</code> is generalized to <code>a</code> instead of just <code>Int</code> in its definition: <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>"}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501221133, "post_id": 45365374, "comment_id": 77692170, "body": "@4castle: based on <code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code> if i use infix notation can&#39;t i write: <code>m a &gt;&gt;= f</code>, where <code>f</code> is a function that takes an <code>a</code> and returns an <code>m b</code>?"}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1501221252, "post_id": 45365374, "comment_id": 77692233, "body": "@4castle: thanks for clarifying the generality of times. if you have an example of how to correctly write this simple operation that would help. i&#39;m just trying to correctly stick and unstick stuff in a monad but the syntax and all the different ways of writing it is hopelessly confusing."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1501221881, "post_id": 45365956, "comment_id": 77692574, "body": "And in particular note that there is no function of type <code>MyMonad a -&gt; a</code> defined anywhere in either of these. @user8379674 asserts several times that this is needed, but it simply isn&#39;t -- and indeed for the second definition of <code>MyMonad</code>, it&#39;s not <i>possible</i> to define a sensible function with that type!"}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501222446, "post_id": 45365956, "comment_id": 77692851, "body": "@DanielWagner: can you explain why it&#39;s not needed rather than just asserting it? if a monad is a way to take two processes with signature (a-&gt;ma) and compose them then how can you do this <i>without</i> ever taking the output of the process evaluated first and making it compatible with the distinct input type of the process evaluated second? unless you disagree with that characterization"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 2, "creation_date": 1501222763, "post_id": 45365956, "comment_id": 77693001, "body": "@user8379674 I&#39;m not sure I can explain <i>why</i> it&#39;s not needed, but I can provide some evidence that this is a bad way of thinking about the problem. To start with: if there isn&#39;t a function of type <code>MyMonad a -&gt; a</code> in the above code, and you agree that the above code fully implements a monad for <code>MyMonad</code>, then this should be 100% convincing evidence that a it isn&#39;t necessary to define a function of type <code>MyMonad a -&gt; a</code> in the process of implementing a monad. To take another tack: you seem to be thinking of <code>m a</code> as &quot;containing&quot; an <code>a</code>. (cont&#39;d)"}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 0, "creation_date": 1501222798, "post_id": 45365956, "comment_id": 77693026, "body": "@4castle: could you show how the <code>f = f x</code> notation after bind would look like in full lambda notation?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 1, "creation_date": 1501222942, "post_id": 45365956, "comment_id": 77693110, "body": "@user8379674 But this isn&#39;t necessarily true. In fact, for some sensible monads <code>m</code>, an <code>m a</code> doesn&#39;t have an <code>a</code> inside at all, and so <code>m a -&gt; a</code> doesn&#39;t make sense; or may &quot;contain&quot; <i>many</i> values of type <code>a</code>. In these situations, it need not be sensible to write a function of type <code>m a -&gt; a</code>, which would necessarily exalt one of these values above the others -- all values may be useful. In still other situations, values of type <code>m a</code> only latently &quot;contain&quot; an <code>a</code>. (cont&#39;d)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 5, "creation_date": 1501223042, "post_id": 45365956, "comment_id": 77693156, "body": "@user8379674 For example, the state monad can be thought of as &quot;containing&quot; a single <code>a</code>, but only after performing some computation on an unrelated type <code>s</code>. So it isn&#39;t sensible to demand a function of type <code>State s a -&gt; a</code>, because we must have an <code>s</code> to compute with before we can produce an <code>a</code>. Nevertheless, in all the situations I&#39;ve mentioned so far, it is possible to turn an <code>a -&gt; m b</code> into an <code>m a -&gt; m b</code> without first turning it into an <code>a -&gt; b</code>; and in some sense, the possibility of doing this is the entire point of the monad abstraction."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 3, "creation_date": 1501223305, "post_id": 45365956, "comment_id": 77693291, "body": "@user8379674 ...and, as a higher-level comment: though I could continue at length, I think speaking abstractly about monads at this point is a bit optimistic. You will get a much better intuition for what monads are about by implementing and using several different monads -- by getting specific and talking about concrete monads -- than you will by thinking about and discussing monads in their full generality."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": false, "score": 5, "last_activity_date": 1501223181, "last_edit_date": 1501223181, "creation_date": 1501221766, "answer_id": 45365956, "question_id": 45365374, "link": "https://stackoverflow.com/questions/45365374/simple-example-of-monad-that-takes-integers/45365956#45365956", "title": "simple example of monad that takes integers", "body": "<p>When you first start learning monads, the easiest one to learn is called the <code>Identity</code> monad. It looks like this is what you're actually trying to implement, but you're getting the word <code>Maybe</code> stuck in there somewhere, and it's throwing everything off. (That, or you actually are trying to implement the <code>Maybe</code> monad, but you've not defined <code>Just</code> or <code>Nothing</code> anywhere.)</p>\n\n<p>If <code>MyMonad</code> is like the <code>Identity</code> monad, the correct definition would be:</p>\n\n<pre><code>f :: Int -&gt; MyMonad Int\nf = \\x -&gt; MyIdentity x\n\ng :: Int -&gt; MyMonad Int\ng = \\x -&gt; MyIdentity x\n\ndata MyMonad a = MyIdentity a\n\ninstance Monad MyMonad where\n    return x = MyIdentity x     -- return = \\x -&gt; MyIdentity x\n    (MyIdentity x) &gt;&gt;= f = f x  -- (&gt;&gt;=) = \\(MyIdentity x) f -&gt; f x\n</code></pre>\n\n<p>If <code>MyMonad</code> is like the <code>Maybe</code> monad, the correct definition would be:</p>\n\n<pre><code>f :: Int -&gt; MyMonad Int\nf = \\x -&gt; MyJust x\n\ng :: Int -&gt; MyMonad Int\ng = \\x -&gt; MyJust x\n\ndata MyMonad a = MyNothing | MyJust a\n\ninstance Monad MyMonad where\n    return x = MyJust x\n    (MyJust x) &gt;&gt;= f = f x\n    MyNothing  &gt;&gt;= f = MyNothing\n</code></pre>\n\n<p>(Note, for these to compile, you need to also define an instance for <code>Functor</code> and <code>Applicative</code>.)</p>\n\n<p>P.S. To define <code>&gt;&gt;=</code> for the <code>Maybe</code> monad using lambda notation, you'll need a <code>case</code> expression:</p>\n\n<pre><code>(&gt;&gt;=) = \\m f -&gt; case m of\n    MyJust x  -&gt; f x\n    MyNothing -&gt; MyNothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 0, "creation_date": 1501251637, "post_id": 45374989, "comment_id": 77713113, "body": "can you explain the line <code>f &gt;=&gt; g $ 10</code>? it&#39;s just <code>(&gt;=&gt;) f g 10</code> it seems. what if <code>f</code> returned a <code>Nothing</code>? then you couldn&#39;t pass it to <code>g</code>"}, {"owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 0, "creation_date": 1501251763, "post_id": 45374989, "comment_id": 77713209, "body": "if we had <code>f :: Int -&gt; Maybe Int; f = \\x -&gt; if x &gt; 5 then (Just x) else Nothing</code> then <code>(&gt;=&gt;) f g 3</code> works it turns <code>Nothing</code> but it&#39;s like magic. shouldn&#39;t it give a type error because <code>f</code> returns <code>Nothing</code> and that gets passed to <code>g</code> which needs an <code>Int</code>?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "edited": false, "score": 0, "creation_date": 1501252668, "post_id": 45374989, "comment_id": 77713861, "body": "@user8379674 As per your second comment there is nothing magic. If you check the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/src/Control.Monad.html#%3E%3D%3E\" rel=\"nofollow noreferrer\">source</a> you will notice that <code>&gt;=&gt;</code> is in fact defined as <code>f &gt;=&gt; g = \\x -&gt; f x &gt;&gt;= g</code>. So obviously from the Monad typeclass instance of the <code>Maybe</code> type defines <code>&gt;&gt;=</code> as <code>Nothing &gt;&gt;= _ = Nothing</code> as far as i remember."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1501252092, "last_edit_date": 1501252092, "creation_date": 1501249072, "answer_id": 45374989, "question_id": 45365374, "link": "https://stackoverflow.com/questions/45365374/simple-example-of-monad-that-takes-integers/45374989#45374989", "title": "simple example of monad that takes integers", "body": "<p>I think you are looking for the fish (<code>&gt;=&gt;</code>) operator (i'd seen it was called fish at some places but nothing serious about the name). If i am not mistaken you want to compose two functions each taking a binary value to return a monadic value. So let's find the type of our compositing function</p>\n\n<pre><code>(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; (a -&gt; mc)\n</code></pre>\n\n<p>which happens to be <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad.html#v:-62--61--62-\" rel=\"nofollow noreferrer\"><code>&gt;=&gt;</code> in <code>Control.Monad</code></a>.</p>\n\n<p>so </p>\n\n<pre><code>f :: Int -&gt; Maybe Int\nf = \\x -&gt; (Just x)\n\ng :: Int -&gt; Maybe Int\ng = \\x -&gt; (Just x)\n\nf &gt;=&gt; g $ 10\nJust 10\n</code></pre>\n\n<p>or </p>\n\n<pre><code>f :: Int -&gt; [Int]\nf = \\x -&gt; replicate x x\n\ng :: Int -&gt; [Maybe Int]\ng = \\x -&gt; [Just x]\nf &gt;=&gt; g $ 10\n[Just 10,Just 10,Just 10,Just 10,Just 10,Just 10,Just 10,Just 10,Just 10,Just 10]\n</code></pre>\n\n<p>You also have another fish <code>&lt;=&lt;</code> swimming to left which is the flipped version of <code>&gt;=&gt;</code>. </p>\n"}], "owner": {"reputation": 11, "user_id": 8379674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd5100ab0654898d5e10840b231d90b?s=128&d=identicon&r=PG&f=1", "display_name": "user8379674", "link": "https://stackoverflow.com/users/8379674/user8379674"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501252092, "creation_date": 1501219094, "last_edit_date": 1501220080, "question_id": 45365374, "link": "https://stackoverflow.com/questions/45365374/simple-example-of-monad-that-takes-integers", "title": "simple example of monad that takes integers", "body": "<p>I am writing a Monad that composes functions, f and g, based on this explanation of Monads (<a href=\"https://www.youtube.com/watch?v=ZhuHCtR3xq8\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=ZhuHCtR3xq8</a>). the explanation stops at a crucial part: to compose a function (say f) <code>a -&gt; ma</code> with another (say g) <code>a -&gt; ma</code>, you need a way to convert <code>ma</code> to <code>a</code>, to take stuff out of the monad container (otherwise how could you feed the output of f into g??) and that is not addressed. </p>\n\n<p>assume we have f and g that map an Integer and return a Maybe:</p>\n\n<pre><code>f :: Int -&gt; Maybe Int\nf = \\x -&gt; (Just x)\n\ng :: Int -&gt; Maybe Int\ng = \\x -&gt; (Just x)\n</code></pre>\n\n<p>I want to make a Monad that allows me to compose f and g, so that <code>(g o f)(x)</code> (meaning <code>f(g(x))</code>) can be evaluated. for this to work we need a way to convert <code>Maybe Int</code> (the output of f) into <code>Int</code> so it can be sent to g. when the <code>Maybe</code> container has a value in it, we just pull out the value. when g's output is Nothing, we can consider the value 0 (I know g's output can't be Nothing the g above but lets assume it could for another f).</p>\n\n<p>this is my failed attempt to define a Monad MyMonad that does this:</p>\n\n<pre><code>f :: Int -&gt; Maybe Int\nf = \\x -&gt; (Just x)\n\ng :: Int -&gt; Maybe Int\ng = \\x -&gt; (Just x)\n\ndata MyMonad a = Maybe a\n\ninstance Monad MyMonad where\n  return x = MyMonad x\n  Just x &gt;&gt;= (\\x -&gt; MyMonad (Just x))\n  Nothing &gt;&gt;= (\\x -&gt; MyMonad (Just 0))\n</code></pre>\n\n<p>can someone clarify what is wrong here? from tutorials it's very hard to know what the right way to pattern match inside functions is (to handle case of Just vs. Nothing here) and to tease apart all the different syntaxes of instantiating a Monad. this example doesn't help (<a href=\"https://wiki.haskell.org/All_About_Monads#Maybe_a_monad\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/All_About_Monads#Maybe_a_monad</a>): after introducing bind <code>&gt;&gt;=</code> the sheep example doesn't even use it and uses a combinator instead.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 6, "creation_date": 1501210906, "post_id": 45364000, "comment_id": 77689221, "body": "You seem confused about what the <code>a</code> represents in the type signature. <code>Maybe</code> is not a type, it is a <i>type constructor</i>. You supply it with a type, and you get a new type, like <code>Maybe Int</code>, <code>Maybe Bool</code>, <code>Maybe [String]</code>, or <code>Maybe (Maybe Char)</code>. <code>Maybe</code> on its own is not a valid type, so <code>Maybe -&gt; Maybe</code> is not a valid type, either. The <code>a</code> is a <i>type variable</i>, which stands in for some caller-supplied type, so <code>Maybe a -&gt; Maybe a</code> means <code>a</code> can be any type, as long as it\u2019s the same on both sides. The <code>a</code> has no relation to the <code>a</code> in your lambda, which is in another namespace entirely."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 6, "creation_date": 1501211966, "post_id": 45364000, "comment_id": 77689484, "body": "Since nobody seems to have mentioned it yet, <code>Int 5</code> is only valid if <code>Int</code> is a constructor (like <code>Just</code>, <code>Left</code>) but it isn&#39;t. If you want to say that <code>5</code> is of type <code>Int</code>, you could use a type annotation (<code>5 :: Int</code>) but in this case it&#39;s not needed."}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 10, "last_activity_date": 1501211061, "creation_date": 1501211061, "answer_id": 45364185, "question_id": 45364000, "link": "https://stackoverflow.com/questions/45364000/defining-haskell-functions-that-have-maybe-in-signature/45364185#45364185", "title": "defining haskell functions that have Maybe in signature", "body": "<p>Seems like you are confused about type variables.  First of all, in </p>\n\n<pre><code>f :: Maybe a -&gt; Maybe a\nf = \\a -&gt; a\n</code></pre>\n\n<p>the <code>a</code>'s in the first line have nothing to do with the <code>a</code>'s in the second line, we could have written:</p>\n\n<pre><code>f :: Maybe a -&gt; Maybe a\nf = \\x -&gt; x\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>f :: Maybe foo -&gt; Maybe foo\nf = \\bar -&gt; bar\n</code></pre>\n\n<p>The <code>a</code>'s are variables that stand for types.  So <code>f</code> here is declaring that <code>f</code> has a whole bunch of types at once:</p>\n\n<pre><code>f :: Maybe Int -&gt; Maybe Int\nf :: Maybe String -&gt; Maybe String\nf :: Maybe (Maybe Bool) -&gt; Maybe (Maybe Bool)\n...\n</code></pre>\n\n<p>and so on.  It is not some \"labeling\" of the arguments as I suspect you think.  The fact that the two <code>a</code>'s are the same means that the argument type has to be the same result type.  If we had said <code>f :: Maybe a -&gt; Maybe b</code> we would get this family:</p>\n\n<pre><code>f :: Maybe Int -&gt; Maybe Bool\nf :: Maybe String -&gt; Maybe String\nf :: Maybe (Maybe Bool) -&gt; Maybe Int\n...\n</code></pre>\n\n<p>that is, the <code>a</code> and <code>b</code> can now stand for different types, but the argument and result still have to be <code>Maybe</code>.</p>\n\n<p>The reason you can't say</p>\n\n<pre><code>f :: Maybe -&gt; Maybe\n</code></pre>\n\n<p>is because <code>Maybe</code> is not a type -- it is a <em>type constructor</em>.  If you give it a type, it gives you back a type.  So <code>Maybe Int</code> and <code>Maybe String</code> are types, and in general <code>Maybe a</code> is a type as long as <code>a</code> is a type.</p>\n\n<p><code>Maybe Int a</code> (which is parsed <code>(Maybe Int) a</code>) has no meaning because <code>Maybe Int</code> is not a type constructor -- it does not accept any more arguments.</p>\n\n<p>Suggested reading: <a href=\"http://learnyouahaskell.com/types-and-typeclasses\" rel=\"noreferrer\">Types and Typeclasses</a> from LYAH.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 5, "last_activity_date": 1501211519, "creation_date": 1501211519, "answer_id": 45364258, "question_id": 45364000, "link": "https://stackoverflow.com/questions/45364000/defining-haskell-functions-that-have-maybe-in-signature/45364258#45364258", "title": "defining haskell functions that have Maybe in signature", "body": "<p><code>Maybe</code> is a type constructor, essentially a type-level function. It takes a type (such as <code>Int</code>) and returns a type (such as <code>Maybe Int</code>). The \u201ctypes\u201d of types are called <em>kinds</em>: the kind of a type that has values, like <code>Int</code>, is called <code>*</code>. The kind of a type constructor that takes one argument is <code>* -&gt; *</code>. You can see this in GHCi with the <code>:kind</code>/<code>:k</code> command:</p>\n\n<pre><code>&gt; :k Int\nInt :: *\n\n&gt; :k Maybe\nMaybe :: * -&gt; *\n\n&gt; :k Either\nEither :: * -&gt; * -&gt; *\n</code></pre>\n\n<p>In a signature like <code>Maybe a -&gt; Maybe a</code>, <code>a</code> is a <em>type variable</em> that gets replaced with a particular type when you call the function. (Implicitly, this means <code>forall a. Maybe a -&gt; Maybe a</code>, which you can write yourself if you enable extensions such as <code>ExplicitForall</code> or <code>ScopedTypeVariables</code>.)</p>\n\n<p>So if you call <code>f :: Maybe a -&gt; Maybe a</code> on a <code>Maybe Int</code>, then <code>f</code> has the type <code>Maybe Int -&gt; Maybe Int</code> at that call site, because <code>a</code> has been <em>instantiated</em> to <code>Int</code>.</p>\n\n<p>The compiler rejects <code>Maybe Int a</code> because you\u2019re supplying two parameters to <code>Maybe</code> when it only accepts one. (The <code>a</code> is not a name for the argument, but a parameter of the type.) Likewise, it rejects <code>Maybe -&gt; Maybe</code> because you\u2019ve given <code>Maybe</code> no arguments, so you\u2019re trying to pass two types of kind <code>* -&gt; *</code> to the function arrow constructor <code>(-&gt;)</code>, which takes arguments of kind <code>*</code>:</p>\n\n<pre><code>&gt; :k (-&gt;)\n(-&gt;) :: * -&gt; * -&gt; *\n</code></pre>\n\n<p>As an aside, it is possible to write something like <code>Maybe -&gt; Maybe</code> and have it expand to <code>Maybe a -&gt; Maybe a</code>, and this can be useful sometimes, but it\u2019s almost certainly not what you\u2019re intending to do right now.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE TypeOperators #-}\n\ntype (~&gt;) f g = forall a. f a -&gt; g a\n\nf :: Maybe ~&gt; Maybe\nf x = x\n</code></pre>\n\n<p>Here, the type synonym <code>Maybe ~&gt; Maybe</code> expands to <code>forall a. Maybe a -&gt; Maybe a</code>, which can be abbreviated to <code>Maybe a -&gt; Maybe a</code>, the signature you wrote before.</p>\n"}], "owner": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 45364185, "answer_count": 2, "score": 1, "last_activity_date": 1501211519, "creation_date": 1501209692, "question_id": 45364000, "link": "https://stackoverflow.com/questions/45364000/defining-haskell-functions-that-have-maybe-in-signature", "title": "defining haskell functions that have Maybe in signature", "body": "<p>i'm unclear about how to write function signatures in haskell, especially using <code>Maybe</code>. consider:</p>\n\n<pre><code>f :: Maybe a -&gt; Maybe a\nf = \\a -&gt; a\n\nmain = print (f (Just 5))\n</code></pre>\n\n<p>this works but why can't the function signature just be this?</p>\n\n<pre><code>f :: Maybe -&gt; Maybe \n</code></pre>\n\n<p>since <code>f</code> just takes a <code>Maybe</code> type and returns a <code>Maybe</code> type. </p>\n\n<p>related: if i wanted to have the Maybe type be more specific and be a <code>Maybe Int</code>, why doesn't this work?</p>\n\n<pre><code>f :: Maybe Int a -&gt; Maybe Int a\nf = \\a -&gt; a\n\nmain = print (f (Just (Int 5)))\n</code></pre>\n\n<p>(i'm running all code using <code>runhaskell test.hs</code>)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 0, "creation_date": 1501207209, "post_id": 45363623, "comment_id": 77688378, "body": "For comparison, you can look at the standard implementation of <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.List.html#splitAt\" rel=\"nofollow noreferrer\"><code>splitAt</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 760, "user_id": 8009379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c808a3b5c059f2b448f39970d384fd33?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8009379/alex"}, "is_accepted": true, "score": 3, "last_activity_date": 1501207364, "last_edit_date": 1592644375, "creation_date": 1501206960, "answer_id": 45363666, "question_id": 45363623, "link": "https://stackoverflow.com/questions/45363623/haskell-error-in-split-function/45363666#45363666", "title": "Haskell : Error in split function", "body": "<p>Put parentheses around the expression <code>n-1</code>:</p>\n<pre><code>splitH (n-1) xs (x:begin)\n</code></pre>\n<p>Look at section 7, &quot;Function Application Has Precedence over Operators&quot; of <a href=\"https://www.fpcomplete.com/blog/2012/09/ten-things-you-should-know-about-haskell-syntax\" rel=\"nofollow noreferrer\">this article</a> for an explanation:</p>\n<blockquote>\n<p>So if you see something like this:</p>\n<blockquote>\n<p>f a b c + g d e</p>\n</blockquote>\n<p>you know that you are adding the result of two function calls rather than calling one function with one of the arguments being the sum of two terms.</p>\n</blockquote>\n"}], "owner": {"reputation": 887, "user_id": 5651918, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63f1beb509753125879b1d07507d2a4f?s=128&d=identicon&r=PG&f=1", "display_name": "handkock", "link": "https://stackoverflow.com/users/5651918/handkock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 45363666, "answer_count": 1, "score": 0, "last_activity_date": 1501207364, "creation_date": 1501206692, "question_id": 45363623, "link": "https://stackoverflow.com/questions/45363623/haskell-error-in-split-function", "title": "Haskell : Error in split function", "body": "<p>I am very new at Haskell. I want to implement split function, which splites a list into two parts:</p>\n\n<pre><code>split 2 [1,2,3] \u2192 ([1,2], [3]) --means the first part has length 2, the second - length x-2\nsplit 2 [1] \u2192 ([1], [])\n\n\nsplit :: Int -&gt; [a] -&gt; ([a],[a])\nsplit 0 x = ([], x)\nsplit n x = splitH n x []\n\nsplitH :: Int -&gt; [a] -&gt; [a] -&gt; ([a], [a])\nsplitH n (x:xs) begin | n == 0 = (begin, xs)\n                      | otherwise = splitH n-1 xs (x:begin) -- here is the error\n\n    main = print(split 2 [1,2,3] )\n</code></pre>\n\n<p>But this code does not compile. I get an error</p>\n\n<pre><code>`Couldn't match expected type \u2018([a], [a])\u2019\n            with actual type \u2018[a0] -&gt; [a0] -&gt; ([a0], [a0])\u2019\nRelevant bindings include\n  begin :: [a] (bound at jdoodle.hs:6:17)\n  xs :: [a] (bound at jdoodle.hs:6:13)\n  x :: a (bound at jdoodle.hs:6:11)\n  splitH :: Int -&gt; [a] -&gt; [a] -&gt; ([a], [a]) (bound at jdoodle.hs:6:1)\nProbable cause: \u2018splitH\u2019 is applied to too few arguments\nIn the first argument of \u2018(-)\u2019, namely \u2018splitH n\u2019\nIn the expression: splitH n - 1 xs (x : begin)`\n</code></pre>\n\n<p>What could cause the error ? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 18511, "user_id": 865401, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/rB6Tb.png?s=128&g=1", "display_name": "Jeffrey Chung", "link": "https://stackoverflow.com/users/865401/jeffrey-chung"}, "is_accepted": true, "score": 3, "last_activity_date": 1501205609, "creation_date": 1501205609, "answer_id": 45363493, "question_id": 45363332, "link": "https://stackoverflow.com/questions/45363332/how-to-read-function-type-signatures-in-haskell/45363493#45363493", "title": "how to read function type signatures in Haskell?", "body": "<pre><code>anotherAddOne :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>The <code>=&gt;</code> here separates a class constraint and a type. In this example, <code>Num a</code> is the class constraint, which consists of a class <code>Num</code> and a type variable <code>a</code>. The full signature declares that for any type <code>a</code> that is a <code>Num</code>, the function <code>anotherAddOne</code> has the type <code>a -&gt; a</code>.</p>\n"}], "owner": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "closed_date": 1501209615, "accepted_answer_id": 45363493, "answer_count": 1, "score": 1, "last_activity_date": 1501205609, "creation_date": 1501204157, "question_id": 45363332, "link": "https://stackoverflow.com/questions/45363332/how-to-read-function-type-signatures-in-haskell", "closed_reason": "Duplicate", "title": "how to read function type signatures in Haskell?", "body": "<p>given a function that adds one to Int, we can see its type signature:</p>\n\n<pre><code>Prelude&gt; addOne :: Int -&gt; Int; addOne x = x + 1\nPrelude&gt; :t addOne\naddOne :: Int -&gt; Int\n</code></pre>\n\n<p>the signature means addOne takes an Int and returns an Int. simple enough. instead if we define a function without specifying a type:</p>\n\n<pre><code>Prelude&gt; anotherAddOne x = x + 1\nPrelude&gt; :t anotherAddOne\nanotherAddOne :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>it makes sense that now we are dealing with <code>Num</code> not <code>Int</code> but whats the way to read <code>Num a =&gt; a -&gt; a</code>? and what is the difference between <code>=&gt;</code> and <code>-&gt;</code> here?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1501289299, "post_id": 45362445, "comment_id": 77729574, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2846050/how-to-define-a-function-in-ghci-across-multiple-lines\">How to define a function in ghci across multiple lines?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "edited": false, "score": 0, "creation_date": 1501197726, "post_id": 45362467, "comment_id": 77686210, "body": "thank you. quick final followup: if i define it on one line, why can&#39;t i evaluate it after? <code>Prelude&gt; square</code> returns <code>Parse error: module header, import declaration or top-level declaration expected.</code>"}, {"owner": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "edited": false, "score": 0, "creation_date": 1501197886, "post_id": 45362467, "comment_id": 77686246, "body": "full trace: <code>Prelude&gt; square :: Int -&gt; Int; square x = x * x Prelude&gt; square  &lt;interactive&gt;:70:1: error:     \u2022 No instance for (Show (Int -&gt; Int)) arising from a use of \u2018print\u2019         (maybe you haven&#39;t applied a function to enough arguments?)     \u2022 In a stmt of an interactive GHCi command: print it Prelude&gt; square;;  &lt;interactive&gt;:71:1: error:     Parse error: module header, import declaration     or top-level declaration expected.</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "edited": false, "score": 0, "creation_date": 1501198023, "post_id": 45362467, "comment_id": 77686273, "body": "@jll: but why do you write two additional semi-colons? You can calculate a square like with for instance <code>square 3</code>. The reason why <code>square</code> errors is because it is a function, and Haskell - by default - can not show functions."}, {"owner": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "edited": false, "score": 0, "creation_date": 1501198409, "post_id": 45362467, "comment_id": 77686364, "body": "it&#39;s confusing to me because I can evaluate instances of other types like <code>1</code> so if functions are first class why can&#39;t i evaluate a function and haskell print its type? i expected something like <code>square :: Int -&gt; Int</code> as output"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "edited": false, "score": 1, "creation_date": 1501200105, "post_id": 45362467, "comment_id": 77686764, "body": "@jll: you can inspect the type of an expression with <code>:t</code>, so <code>:t square</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 25, "last_activity_date": 1501197317, "creation_date": 1501197317, "answer_id": 45362467, "question_id": 45362445, "link": "https://stackoverflow.com/questions/45362445/defining-function-signature-in-ghci/45362467#45362467", "title": "Defining function signature in GHCi", "body": "<p>You <strong>can</strong> define a function signature in the <code>ghc</code> interactive shell. The problem however is that you <strong>need to define functions in a single command</strong>.</p>\n\n<p>You can use a <em>semicolon</em> (<code>;</code>) to split between two parts:</p>\n\n<pre><code>Prelude&gt; <b>square :: Int -&gt; Int;</b> square x = x * x</code></pre>\n\n<p>Note that the same holds for a <strong>function with multiple clauses</strong>. If you write:</p>\n\n<pre><code>Prelude&gt; is_empty [] = True\nPrelude&gt; is_empty (_:_) = False\n</code></pre>\n\n<p>You have actually <strong>overwritten the previous <code>is_empty</code> function</strong> with the second statement. If we then query with an empty list, we get:</p>\n\n<pre><code>Prelude&gt; is_empty []\n*** Exception: &lt;interactive&gt;:4:1-22: Non-exhaustive patterns in function is_empty\n</code></pre>\n\n<p>So <code>ghci</code> took the last definition as a single clause function definition.</p>\n\n<p>Again you have to write it like:</p>\n\n<pre><code>Prelude&gt; is_empty[] = True<b>;</b> is_empty (_:_) = False</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 14, "last_activity_date": 1501197968, "creation_date": 1501197968, "answer_id": 45362567, "question_id": 45362445, "link": "https://stackoverflow.com/questions/45362445/defining-function-signature-in-ghci/45362567#45362567", "title": "Defining function signature in GHCi", "body": "<p>Multi-line input needs to be wrapped in the <code>:{</code> and <code>:}</code> commands.</p>\n\n<pre><code>\u03bb&gt; :{\n &gt; square :: Int -&gt; Int\n &gt; square x = x * x\n &gt; :}\nsquare :: Int -&gt; Int\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 8, "last_activity_date": 1501198648, "creation_date": 1501198648, "answer_id": 45362651, "question_id": 45362445, "link": "https://stackoverflow.com/questions/45362445/defining-function-signature-in-ghci/45362651#45362651", "title": "Defining function signature in GHCi", "body": "<p>Here are three ways:</p>\n\n<pre><code>&gt;&gt;&gt; square :: Int -&gt; Int; square = (^2)\n&gt;&gt;&gt; let square :: Int -&gt; Int\n...     square = (^2)\n...\n&gt;&gt;&gt; :{\n... square :: Int -&gt; Int\n... square = (^2)\n... :}\n</code></pre>\n\n<p>The second one requires you to <code>:set +m</code>; I include this in my <code>~/.ghci</code> so that it is always on.</p>\n"}], "owner": {"reputation": 645, "user_id": 7313632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1776e07640ca1eff51db2fa614e1449?s=128&d=identicon&r=PG&f=1", "display_name": "jll", "link": "https://stackoverflow.com/users/7313632/jll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3953, "favorite_count": 3, "accepted_answer_id": 45362467, "answer_count": 3, "score": 13, "last_activity_date": 1501199343, "creation_date": 1501197164, "last_edit_date": 1501199343, "question_id": 45362445, "link": "https://stackoverflow.com/questions/45362445/defining-function-signature-in-ghci", "title": "Defining function signature in GHCi", "body": "<p>Defining a function signature in Haskell's interpreter GHCi doesn't work. Copying an example from <a href=\"https://wiki.haskell.org/Function\" rel=\"noreferrer\">this page</a>:</p>\n\n<pre><code>Prelude&gt; square :: Int -&gt; Int\n\n&lt;interactive&gt;:60:1: error:\n    \u2022 No instance for (Show (Int -&gt; Int)) arising from a use of \u2018print\u2019\n        (maybe you haven't applied a function to enough arguments?)\n    \u2022 In a stmt of an interactive GHCi command: print it\nPrelude&gt; square x = x * x\n</code></pre>\n\n<p>How can I declare a function signature and then give function definition in Haskell interactively? also: why can't I simply evaluate the function and see its type (e.g. <code>Prelude&gt; square</code>) once it has been defined?</p>\n"}, {"tags": ["haskell", "functional-programming", "optional", "maybe"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1501196680, "post_id": 45362319, "comment_id": 77685915, "body": "&quot;Just&quot; can mean &quot;exactly or precisely&quot; (<a href=\"http://www.dictionary.com/browse/just?s=t\" rel=\"nofollow noreferrer\">Dictionary.com</a>). For example, &quot;That is just what the doctor ordered.&quot;"}, {"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 1, "creation_date": 1501196758, "post_id": 45362319, "comment_id": 77685936, "body": "Maybe because &quot;Definitely&quot; (which would be the perfect word for this) is a lot longer than &quot;Just&quot;?"}, {"owner": {"reputation": 971, "user_id": 2049443, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9c276d9862277956ce66657db45543e6?s=128&d=identicon&r=PG", "display_name": "vijrox", "link": "https://stackoverflow.com/users/2049443/vijrox"}, "reply_to_user": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1501196803, "post_id": 45362319, "comment_id": 77685951, "body": "@Libby Standard ML and OCaml use the word &quot;some&quot;, which I think carries the right meaning"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1501197650, "post_id": 45362319, "comment_id": 77686189, "body": "Q: What is the value of X? A: &quot;Nothing&quot; / &quot;Just 12&quot;. Would you answer &quot;None&quot; / &quot;Some 12&quot;? Anyway, I don&#39;t think this question can be answered objectively. Further, I believe it&#39;s quite common to have a preference for the first notation we met, since we consider that familiar and anything else feels alien."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1501198352, "post_id": 45362319, "comment_id": 77686354, "body": "@chi For what it\u2019s worth, I learned Haskell before I used any other language with optionals, and I found <code>Just</code> a fairly curious name. I agree this question isn\u2019t answerable without knowing what the person who named it was thinking, though."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1501234729, "post_id": 45362319, "comment_id": 77700539, "body": "FWIW, I would have named it <code>Something</code>. Then <code>Maybe x</code> is either <code>Something</code> or <code>Nothing</code>..."}], "owner": {"reputation": 971, "user_id": 2049443, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9c276d9862277956ce66657db45543e6?s=128&d=identicon&r=PG", "display_name": "vijrox", "link": "https://stackoverflow.com/users/2049443/vijrox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 1, "closed_date": 1501197835, "answer_count": 0, "score": 2, "last_activity_date": 1501199540, "creation_date": 1501196325, "last_edit_date": 1592644375, "question_id": 45362319, "link": "https://stackoverflow.com/questions/45362319/what-are-some-intuitions-that-support-calling-the-maybe-constructor-in-haskell", "closed_reason": "Opinion-based", "title": "What are some intuitions that support calling the Maybe constructor in Haskell &quot;Just&quot;?", "body": "<p>The intuition of an optional type like <code>Maybe Int</code> is that either there is <strong>no</strong> Int (thus, there's <code>Nothing</code> there) or that there is <strong>some</strong> Int; there is something there.</p>\n<p>It makes sense to me that we call the type constructor for the &quot;negative&quot; case <code>Nothing</code>, since it means exactly that -- that there's no <code>Int</code> there. But why use the word <strong>Just</strong> in the case where the emphasis is on something <strong>actually being there</strong>?</p>\n<p>To me, the word &quot;Just&quot; carries the connotation that the thing it's describing is <strong>less</strong> than the alternative; the opposite of something actually being there; for example,</p>\n<blockquote>\n<p>A: Are you doing anything tonight?</p>\n<p>B: No; I'm <strong>just</strong> gonna stay in and watch TV.</p>\n<p>A: Did you investigate the creepy ghost sounds around your house?</p>\n<p>B: yeah, turns out it was actually <strong>just</strong> an owl.</p>\n</blockquote>\n<p>Clearly I'm lacking whatever intuition this naming choice was based on. What is it? Because to me, the word <em>Just</em> means the opposite of how it's used in the <code>Maybe</code> type.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1501195508, "post_id": 45362161, "comment_id": 77685553, "body": "You have to install <code>Data.Heap</code>. There are two packages that have a <code>Data.Heap</code> module: <a href=\"https://hackage.haskell.org/package/heap-1.0.3/docs/Data-Heap.html\" rel=\"nofollow noreferrer\"><code>heap</code></a> and <a href=\"https://hackage.haskell.org/package/heaps-0.3.4.1/docs/Data-Heap.html\" rel=\"nofollow noreferrer\"><code>heaps</code></a>. If you for instance use <code>cabal</code> you can use <code>cabal install heap[s]</code> (pick one)."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1501214385, "post_id": 45362161, "comment_id": 77690018, "body": "Thanks. I tried: &quot;C:\\Users\\facuser&gt;cabal install Data.Heap&quot; and got &quot;cabal: The file does not exist &#39;Data.Heap&#39;.&quot; Same for &quot;Heaps&quot;"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1501231538, "post_id": 45362161, "comment_id": 77698280, "body": "Try <code>cabal install heaps</code>. Package names are case sensitive, although I don&#39;t know whether that changes under Windows."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1501234883, "post_id": 45362161, "comment_id": 77700648, "body": "<code>Data.Heap</code> is a <i>module name</i>. To install, you need to use the corresponding <i>package name</i>. They are different. (E.g., the <i>package</i> named <code>bytestring</code> contains several <i>modules</i> named <code>Data.ByteString</code>, <code>Data.ByteString.Char8</code>, etc.)"}], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1501283918, "post_id": 45382323, "comment_id": 77728581, "body": "When I tried &gt; cabal install heap I got a popup saying please insert a disk into drive D. None of the three buttons (Ignore, Continue, or Try Again) worked. I had to kill GHCi from the task manager to get rid of the popup and to close the command prompt window. This happened whether or not GHCi was running when I tried to run the command.  Now I can&#39;t start GHCi without getting that popup, which blocks everything."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1501284100, "post_id": 45382323, "comment_id": 77728621, "body": "You don&#39;t run the install from GHCi, you run it in your project directory, then start GHCi. If you&#39;re new, I&#39;d recommend just using stack as it simplifies this whole process."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1501284313, "post_id": 45382323, "comment_id": 77728665, "body": "I didn&#39;t try to run install from GHCi. I ran it from a command prompt window. I am new with respect to this sort of sys-admin-level stuff for Haskell. Telling me to run stack doesn&#39;t help since I&#39;ve never run stack. I&#39;ve always just downloaded the Haskell platform and installed it according to the directions. Never needed to do anything else."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1501285304, "post_id": 45382323, "comment_id": 77728862, "body": "This is getting to be a bit much. Even after restarting the computer I can no longer start GHCi without the popup requiring a disk in drive D: Can&#39;t get rid of the popup, and the popup blocks GHCi. This is terrible. I&#39;m in worse shape than when I started."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1501363460, "post_id": 45382323, "comment_id": 77749087, "body": "See <a href=\"https://stackoverflow.com/questions/45385105/cant-start-haskell\">stackoverflow.com/questions/45385105/cant-start-haskell</a> for a solution to the drive D issue."}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": false, "score": 0, "last_activity_date": 1501275539, "creation_date": 1501275539, "answer_id": 45382323, "question_id": 45362161, "link": "https://stackoverflow.com/questions/45362161/how-do-you-import-data-heap/45382323#45382323", "title": "How do you import Data.Heap?", "body": "<p>As was described in the comments, you need to install the package which contains the module <code>Data.Heap</code>. (See <a href=\"https://stackoverflow.com/questions/16997950/whats-the-difference-between-module-package-and-library-in-haskell\">this related</a> question on the difference between packages and modules in Haskell)</p>\n\n<p>On the <a href=\"https://hackage.haskell.org/package/heap-1.0.3/docs/Data-Heap.html\" rel=\"nofollow noreferrer\">Hackage page</a>, in the upper left-hand corner you will see the name and version of the package you are looking at:<br>\n<a href=\"https://i.stack.imgur.com/PjPFd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PjPFd.png\" alt=\"heap package name: heap-1.0.3\"></a><br>\nIf you are using stack, then add <code>heap</code> to your <code>build-depends</code> section of <code>project.cabal</code> file, and rebuild. If you are just using cabal, simply run <code>cabal install heap</code> to get the most recent version of the package installed on your system. </p>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1501275539, "creation_date": 1501195286, "question_id": 45362161, "link": "https://stackoverflow.com/questions/45362161/how-do-you-import-data-heap", "title": "How do you import Data.Heap?", "body": "<p>Sorry for such a dumb question. I'm trying to import <a href=\"https://hackage.haskell.org/package/heap-1.0.3/docs/Data-Heap.html#t:HeapT\" rel=\"nofollow noreferrer\">Data.Heap</a>, but I get this error message: </p>\n\n<pre><code>&gt; import Data.Heap\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018Data.Heap\u2019\n    Perhaps you meant\n      Data.Map (from containers-0.5.7.1@containers-0.5.7.1)\n</code></pre>\n\n<p>Haven't had trouble with other imports.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["windows", "git", "haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1501194851, "post_id": 45361812, "comment_id": 77685329, "body": "This looks like the old problem with deleting read-only files on Windows. Try removing the <code>indicies</code> folder. Find out where it is by <code>stack -v new proj</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1501195805, "post_id": 45361812, "comment_id": 77685639, "body": "Normally, it would be under <code>c:\\sr</code>."}], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1501193714, "creation_date": 1501193309, "last_edit_date": 1501193714, "question_id": 45361812, "link": "https://stackoverflow.com/questions/45361812/stack-and-git-are-incompatible-in-windows-7", "title": "Stack and git are incompatible in Windows 7?", "body": "<p>I have been using Stack for dependencies management and building system for Haskell programs in Windows 7 Pro without problems.</p>\n\n<pre><code>    stack --version\n    Version 1.3.2, Git revision 3f675146590da4f3edf768b89355f798229da2a5 x86_64 hpack-0.15.0\n</code></pre>\n\n<p>I have recently installed git for Windows, and Stack cannot download lts files anymore. It seems that Stack is trying using the new git client instead of the internal one.</p>\n\n<pre><code>git --version\ngit version 2.13.3.windows.1\n</code></pre>\n\n<p>The error I get when I try to create a new project is the following:</p>\n\n<pre><code>C:\\proj&gt;stack new newProject\nDownloading template \"new-template\" to create project \"newProject\" in newProject\\ ...\nLooking for .cabal or package.yaml files to use to init the project.\nUsing cabal packages:\n- newProject\\newProject.cabal\n\nSelecting the best among 11 snapshots...\n\nFetching package index ...fatal: Not a git repository: '.git'\nProcess exited with ExitFailure 128: C:\\dev\\git\\apps\\Git\\cmd\\git.EXE --git-dir=.git fetch --tags\nFailed to fetch package index, retrying.\nremoveDirectoryRecursive: permission denied (Acceso denegado.)\n</code></pre>\n\n<p>If I rename the directory where git is installed, Stack works again. But that is not a real solution.\nAny help will be apreciated</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1512721819, "post_id": 45361801, "comment_id": 82380517, "body": "For what it&#39;s worth: The corresponding function in <code>mono-traversable</code> is <a href=\"https://hackage.haskell.org/package/mono-traversable-1.0.5.0/docs/Data-MonoTraversable.html#v:oelem\" rel=\"nofollow noreferrer\"><code>oelem</code></a>, and as of version 1.0.5.0 it does have an efficient implementation for <code>Set</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1501195440, "post_id": 45362110, "comment_id": 77685530, "body": "I wonder if you could use a specialise pragma to provide a more efficient implementation for Ord instances"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 3, "creation_date": 1501195595, "post_id": 45362110, "comment_id": 77685578, "body": "@SwiftsNamesake, <code>SPECIALIZE</code> isn&#39;t strong enough medicine. You&#39;d need <code>RULES</code>, and you&#39;d need one rewrite rule <i>per type</i>. It&#39;s horrible."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501205585, "post_id": 45362110, "comment_id": 77688025, "body": "@dfeuer Spoken like a man who&#39;s been to hell and back. I wonder if anyone on the GHC team is working on this issue."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501212790, "post_id": 45362110, "comment_id": 77689656, "body": "@SwiftsNamesake, I don&#39;t think anyone really knows for sure what the right approach would even look like."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501255104, "post_id": 45362110, "comment_id": 77715616, "body": "@dfeuer mono-traversable seems to use RULES for this - what makes that same approach not work here? <a href=\"https://github.com/snoyberg/mono-traversable/blob/c41e5dc98457ea284a7d6f29faf3127b8f99f429/mono-traversable/src/Data/MonoTraversable.hs#L850\" rel=\"nofollow noreferrer\">github.com/snoyberg/mono-traversable/blob/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1501256569, "post_id": 45362110, "comment_id": 77716529, "body": "@ChrisMartin, there are two problems with <code>RULES</code>: 1. As I mention above, you need a rule for every <code>Ord</code> type you wish to optimize; as a corollary, users accustomed to the function being efficient may be surprised when they use a different type and suddenly it isn&#39;t. 2. Rules aren&#39;t guaranteed to fire, and never will do so unless optimizations are enabled; this could be bad for the edit/compile/test cycle."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1501314771, "post_id": 45362110, "comment_id": 77734461, "body": "How about this: <a href=\"https://stackoverflow.com/questions/5607372/how-to-make-specialized-type-classes-for-certain-types-default-implementation-f\" title=\"how to make specialized type classes for certain types default implementation f\">stackoverflow.com/questions/5607372/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 4, "last_activity_date": 1501194986, "creation_date": 1501194986, "answer_id": 45362110, "question_id": 45361801, "link": "https://stackoverflow.com/questions/45361801/implement-an-olog-n-foldable-elem-for-binary-search-trees-in-haskell/45362110#45362110", "title": "Implement an O(log n) Foldable.elem for binary search trees in Haskell", "body": "<p>You cannot use this <code>elem</code> method for the Foldable class, since the Foldable API requires the <code>elem</code> implementation for all of its instances to be able to search for any elements of any type with only an <code>Eq</code> instance.  \"An <code>elem</code> that is polymorphic for all <code>Eq</code>\" was an intentional choice in the design of the <code>Foldable</code> typeclass.</p>\n\n<p>Your <code>elem</code> function, while very useful, is not compatible with the <code>elem</code> method for the <code>Foldable</code> typeclass, since it is not generic enough for the typeclass's desires.  The best way to export an <code>elem</code> function for your type would be to define a separate function outside of the typeclass.</p>\n"}], "owner": {"reputation": 145, "user_id": 6840642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5097e226bafec8ac922e683f1ad195?s=128&d=identicon&r=PG&f=1", "display_name": "Hapal", "link": "https://stackoverflow.com/users/6840642/hapal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1501267390, "creation_date": 1501193258, "last_edit_date": 1501267390, "question_id": 45361801, "link": "https://stackoverflow.com/questions/45361801/implement-an-olog-n-foldable-elem-for-binary-search-trees-in-haskell", "title": "Implement an O(log n) Foldable.elem for binary search trees in Haskell", "body": "<p>Consider the following definition for binary trees:</p>\n\n<pre><code>data Tree a = Nil | Node (Tree a) a (Tree a)\n</code></pre>\n\n<p>The <code>Foldable</code> instance can be defined as follows:</p>\n\n<pre><code>instance Foldable Tree where\n  foldr _ z Nil = z\n  foldr f z (Node l d r) = foldr f (f d (foldr f z l)) r\n</code></pre>\n\n<p>But the problem is that the <code>elem</code> function runs in <code>O(n)</code> rather than <code>O(log n)</code>. When I try to implement a custom <code>elem</code>:</p>\n\n<pre><code>elem x Nil = False\nelem x (Node l d r)\n  | x == d = True\n  | x &lt; d = elem x l\n  | otherwise = elem x r\n</code></pre>\n\n<p>I get <code>Could not deduce (Ord a) arising from a use of \u2018&lt;\u2019</code>.\nHow can this problem be fixed?</p>\n"}, {"tags": ["haskell", "types", "type-theory"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1501190883, "post_id": 45361065, "comment_id": 77683904, "body": "Do you know about the standard <a href=\"https://byorgey.wordpress.com/2010/04/03/haskell-anti-pattern-incremental-ad-hoc-parameter-abstraction/\" rel=\"nofollow noreferrer\">record trick</a>? It will probably be a much better engineering tradeoff: much less implementation work, and a lot less cumbersome to use. Partial application can be achieved by leaving some fields uninitialized. The only thing you would be giving up is compiler support for noticing which fields still need values."}, {"owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1501191087, "post_id": 45361065, "comment_id": 77684008, "body": "@DanielWagner yes, I&#39;m aware of that trick. I&#39;d like to see how well this implementation can work as a proof of concept. (You might have guessed from the filename <code>Quoter.hs</code> that this originally contained a TH QuasiQuoter to make it less cumbersome to use. I&#39;ve removed that to make the example more self-contained/suitable for StackOverflow, but I&#39;ll add it back in once the types work.) EDIT: Compiler support for noticing which fields still need values is something I&#39;d love to have, hence this implementation. :)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1501195026, "post_id": 45361065, "comment_id": 77685388, "body": "<a href=\"http://nikita-volkov.github.io/record/\" rel=\"nofollow noreferrer\">nikita-volkov.github.io/record</a>"}, {"owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501320478, "post_id": 45361065, "comment_id": 77735984, "body": "@leftaroundabout does this support partial application? I couldn&#39;t see any discussion of that in the blog post. What I&#39;m trying to implement gives you partial application with soundness checking (no run-time exceptions)."}, {"owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 0, "creation_date": 1501320530, "post_id": 45361065, "comment_id": 77735996, "body": "Besides the practical aspects, I&#39;m also very interested in understanding the theory behind why what I&#39;m trying to do doesn&#39;t work, and learning the theory that will make it work."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1501321871, "post_id": 45361065, "comment_id": 77736332, "body": "@JeromeBaum indeed it doesn&#39;t. It&#39;s an interesting question you&#39;re asking, but I think it&#39;s really tricky type-wise. I&#39;ll attempt an answer."}], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 0, "creation_date": 1501341516, "post_id": 45388114, "comment_id": 77742305, "body": "Thanks for writing this up. I&#39;m still trying to understand it all. I agree that the instances are overlapping (and in fact, I think there are several instantiations of the first instance for my function <code>test</code>). I don&#39;t think either instance is a special case of the other one though (i.e. there are instances of each that have type parameters that won&#39;t unify with the corresponding parameters of the other). Is this understanding correct? (Although I agree that even the <code>test</code> example matches both instances.)  I&#39;ll try to understand type families and see if that gets me closer to a solution."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 0, "creation_date": 1501348705, "post_id": 45388114, "comment_id": 77744626, "body": "One often-misunderstood fact about class instances is <i>the constraint list isn&#39;t considered at all for resolution</i>. I.e. when the compiler typechecks an occurence of <code>runFun</code>, it just sees <code>instance Fun (a -&gt; f&#39;) a&#39;</code> and <code>instance Fun (Kwarg name t -&gt; b) (Kwarg name t)</code>. Only <i>after</i> deciding to pick the former will it then go on trying to resolve the extra <code>Fun f&#39; a&#39;</code> constraint. Thus you&#39;re right \u2013 in reality, the instances are different, but as far as instance <i>resolution</i> is concerned, <code>Fun f&#39; a&#39; =&gt; Fun (a -&gt; f&#39;) a&#39;</code> is strictly more general."}, {"owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 0, "creation_date": 1501351901, "post_id": 45388114, "comment_id": 77745649, "body": "Oh, I was referring to the comment about the original instances. Those have three parameters. Does the compiler not try to unify all the parameters (ignoring any constraints)? (Perhaps due to the FunDep?)"}, {"owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 0, "creation_date": 1501351967, "post_id": 45388114, "comment_id": 77745678, "body": "I guess I answered my own question in that last comment - the FunDep means that the compiler won&#39;t consider the third argument <code>b</code> when deciding what instance to pick, right?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 0, "creation_date": 1501364928, "post_id": 45388114, "comment_id": 77749492, "body": "Actually I&#39;m not sure about that, but yeah \u2013 it wouldn&#39;t really be a functional relation <code>f,a -&gt; b</code> if a-priori information about <code>b</code> could be used to decide what instance to pick."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "edited": false, "score": 1, "creation_date": 1501364951, "post_id": 45388114, "comment_id": 77749500, "body": "@JeromeBaum Correct, I think. You&#39;ve told it that there can only be one instance with a fixed <code>b</code> for any given <code>f</code> and <code>a</code>. If it ever needed the third argument to choose between two instances where the other two arguments could unify, the fundep would be a lie."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1501324493, "last_edit_date": 1501324493, "creation_date": 1501323770, "answer_id": 45388114, "question_id": 45361065, "link": "https://stackoverflow.com/questions/45361065/implementing-non-positional-keyword-arguments-in-haskell/45388114#45388114", "title": "Implementing non-positional keyword arguments in Haskell", "body": "<p>The problem is that your instances are overlapping:</p>\n\n<pre><code>instance (Fun f' a' b) =&gt; Fun (a -&gt; f') a' (a -&gt; b) where\n\ninstance Fun (Kwarg name t -&gt; b) (Kwarg name t) b\n  -- this is actually a special case of the above, with a ~ a' ~ KWarg name t\n</code></pre>\n\n<p>It becomes clearer if we replace the functional dependency (which is IMO usually a bit hard to reason about) with an equivalent associated type family:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass Fun f a where\n  type FRes f a :: *\n  runFun :: f -&gt; a -&gt; FRes f a\n\ninstance Fun f' a' =&gt; Fun (a -&gt; f') a' where\n  type FRes (a -&gt; f') a' = a -&gt; FRes f' a'\n  runFun f a' = \\a -&gt; runFun (f a) a'\n\ninstance Fun (Kwarg name t -&gt; b) (Kwarg name t) where\n  type FRes (Kwarg name t -&gt; b) (Kwarg name t) = b\n  runFun = id\n</code></pre>\n\n<p>In this case, the compiler message is pretty clear:</p>\n\n<pre><code>    Conflicting family instance declarations:\n      FRes (a -&gt; f') a' = a -&gt; FRes f' a'\n        -- Defined at /tmp/wtmpf-file10498.hs:20:8\n      FRes (Kwarg name t -&gt; b) (Kwarg name t) = b\n        -- Defined at /tmp/wtmpf-file10498.hs:24:8\n   |\n20 |   type FRes (a -&gt; f') a' = a -&gt; FRes f' a'\n   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Overlapping instances are a big problem, in particular when nontrivial type-level functions need to be resolved. However, it's not a problem that hasn't been encountered often before. A solution is to switch from the instance-clause-based type-level functions (i.e. FunDeps or associated type-families) to <a href=\"https://downloads.haskell.org/~ghc/7.8.2/docs/html/users_guide/type-families.html#closed-type-families\" rel=\"nofollow noreferrer\">closed type families</a>:</p>\n\n<pre><code>type family FRes f a where\n  FRes (Kwarg name t -&gt; b) (Kwarg name t) = b\n  FRes (a -&gt; f') a' = a -&gt; FRes f' a'\n</code></pre>\n\n<p>To actually implement <code>runFun</code>, you still need a class with overlapping instances, however these can now be hacked to worked with GHC pragmas:</p>\n\n<pre><code>class Fun f a where\n  runFun :: f -&gt; a -&gt; FRes f a\n\ninstance {-# OVERLAPPABLE #-} (Fun f' a', FRes (a -&gt; f') a' ~ (a-&gt;FRes f' a'))\n               =&gt; Fun (a -&gt; f') a' where\n  runFun f a' = \\a -&gt; runFun (f a) a'\n\ninstance {-# OVERLAPS #-} Fun (Kwarg name t -&gt; b) (Kwarg name t) where\n  runFun = id\n</code></pre>\n\n<p>As such, your test will now work.</p>\n\n<p>Unfortunately it will <em>not</em> do what it's actually supposed to though: allow the argument order to be changed.</p>\n\n<pre><code>main = putStrLn $ show\n  ( runFun test (Value 5 :: Kwarg \"some\" Int) (Value 6 :: Kwarg \"test\" Int)\n  , runFun test (Value 5 :: Kwarg \"test\" Int) (Value 6 :: Kwarg \"some\" Int) )\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>/tmp/wtmpf-file10498.hs:34:5: error:\n    \u2022 Couldn't match expected type \u2018Kwarg \"some\" Int -&gt; b0\u2019\n                  with actual type \u2018FRes\n                                      (Kwarg \"test\" a0 -&gt; Kwarg \"some\" a0 -&gt; a0) (Kwarg \"test\" Int)\u2019\n      The type variables \u2018a0\u2019, \u2018b0\u2019 are ambiguous\n    \u2022 The function \u2018runFun\u2019 is applied to three arguments,\n      but its type \u2018(Kwarg \"test\" a0 -&gt; Kwarg \"some\" a0 -&gt; a0)\n                    -&gt; Kwarg \"test\" Int\n                    -&gt; FRes\n                         (Kwarg \"test\" a0 -&gt; Kwarg \"some\" a0 -&gt; a0) (Kwarg \"test\" Int)\u2019\n      has only two\n      In the expression:\n        runFun\n          test (Value 5 :: Kwarg \"test\" Int) (Value 6 :: Kwarg \"some\" Int)\n      In the first argument of \u2018show\u2019, namely\n        \u2018(runFun\n            test (Value 5 :: Kwarg \"some\" Int) (Value 6 :: Kwarg \"test\" Int), \n          runFun\n            test (Value 5 :: Kwarg \"test\" Int) (Value 6 :: Kwarg \"some\" Int))\u2019\n   |\n34 |   , runFun test (Value 5 :: Kwarg \"test\" Int) (Value 6 :: Kwarg \"some\" Int) )\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>The essential problem is that type inference goes in the less favourable direction: from starting-values to end-results. This is the only avaible direction in most languages, but in Haskell it's almost always better to infer from the end result to the individual expressions, because only the outer result is always available for unification with the environment. In the end, that leads you to something like </p>\n\n<pre><code>type family FFun a b where\n</code></pre>\n\n<p>i.e. the type of function is determined from the result you want and the argument you can already supply. You would then not have overlapping instances based on whether the argument at hand happens to be the first one the function expects; rather you'd build up some sort of type-level map including all the keyed arguments and have the function accept one such map (or, equivalently, all the arguments in alphabetic order).</p>\n"}], "owner": {"reputation": 716, "user_id": 256434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49594bd3f61e3c9719288b9a66c19b49?s=128&d=identicon&r=PG", "display_name": "Jerome Baum", "link": "https://stackoverflow.com/users/256434/jerome-baum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 2, "accepted_answer_id": 45388114, "answer_count": 1, "score": 4, "last_activity_date": 1501324493, "creation_date": 1501189804, "question_id": 45361065, "link": "https://stackoverflow.com/questions/45361065/implementing-non-positional-keyword-arguments-in-haskell", "title": "Implementing non-positional keyword arguments in Haskell", "body": "<p>I am trying to implement keyword arguments in Haskell, similar to the ones found in Ocaml. My goal is to have arguments that can be passed in any order, and can be partially applied in a function call (yielding a new function that takes the remaining keyword arguments).</p>\n\n<p>I've tried to implement this using DataKinds and a type-class that represents \"a value that can be converted into a function <code>a -&gt; b</code>.\" The idea is that a function taking two keyword arguments, <code>foo</code> and <code>bar</code>, can be converted either to a function that looks like <code>foo -&gt; bar -&gt; x</code> or to a function that looks like <code>bar -&gt; foo -&gt; x</code>. This should be unambiguous so long as <code>foo</code> and <code>bar</code> have different types (and <code>x</code> isn't itself a function that takes <code>foo</code> or <code>bar</code>), which is what I've tried to achieve with the <code>Kwarg</code> GADT.</p>\n\n<p>The functional dependency in the <code>Fun</code> class was meant to make the relationship between <code>f</code>, <code>a</code>, and <code>b</code> more explicit, but I'm not sure whether this actually helped. I get a compiler error with and without it.</p>\n\n<p>I have enabled the following language extensions:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE UndecidableInstances #-}\n</code></pre>\n\n<p>Contents of <code>Quoter.hs</code>:</p>\n\n<pre><code>module Quoter where\n\nimport GHC.TypeLits (Symbol)\n\ndata Kwarg :: Symbol -&gt; * -&gt; * where\n  Value :: a -&gt; Kwarg b a\n\nclass Fun f a b | f a -&gt; b where\n  runFun :: f -&gt; a -&gt; b\n\ninstance (Fun f' a' b) =&gt; Fun (a -&gt; f') a' (a -&gt; b) where\n  runFun f a' = \\a -&gt; runFun (f a) a'\n\ninstance Fun (Kwarg name t -&gt; b) (Kwarg name t) b where\n  runFun = id\n</code></pre>\n\n<p>Contents of <code>Main.hs</code>:</p>\n\n<pre><code>module Main where\n\nimport Quoter\n\ntest :: (Num a) =&gt; Kwarg \"test\" a -&gt; Kwarg \"some\" a -&gt; a\ntest (Value i) (Value j) = i + j\n\nmain = putStrLn $ show $\n  runFun test (Value 5 :: Kwarg \"some\" Int) (Value 6 :: Kwarg \"test\" Int)\n</code></pre>\n\n<p>This is the error that I get when building with ghc:</p>\n\n<pre><code>Main.hs:18:3: error:\n    \u2022 Couldn't match type \u2018Kwarg \"some\" Int -&gt; b\u2019 with \u2018Int\u2019\n        arising from a functional dependency between:\n          constraint \u2018Fun (Kwarg \"some\" Int -&gt; Int) (Kwarg \"some\" Int) Int\u2019\n            arising from a use of \u2018runFun\u2019\n          instance \u2018Fun (a -&gt; f') a' (a -&gt; b1)\u2019 at &lt;no location info&gt;\n    \u2022 In the second argument of \u2018($)\u2019, namely\n        \u2018runFun\n           test (Value 5 :: Kwarg \"some\" Int) (Value 6 :: Kwarg \"test\" Int)\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018show\n         $ runFun\n             test (Value 5 :: Kwarg \"some\" Int) (Value 6 :: Kwarg \"test\" Int)\u2019\n      In the expression:\n        putStrLn\n        $ show\n          $ runFun\n              test (Value 5 :: Kwarg \"some\" Int) (Value 6 :: Kwarg \"test\" Int)\n</code></pre>\n\n<p>Do you know what I need to change in order to get this to compile? Is this general approach sensible, and what do I need to understand better in order to get this to work?</p>\n\n<p>Thanks!</p>\n\n<p>Output of <code>ghc --version</code>:</p>\n\n<pre><code>The Glorious Glasgow Haskell Compilation System, version 8.0.2\n</code></pre>\n"}, {"tags": ["haskell", "functional-dependencies", "type-families"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1501190087, "post_id": 45360959, "comment_id": 77683564, "body": "It&#39;d be nice to have a self-contained example to be able to explore hypotheses when trying to answer your question."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1501190140, "post_id": 45360959, "comment_id": 77683596, "body": "@gallais Do you mean a self-contained practical example? The code in my question, short as it may be, should compile."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1501191262, "post_id": 45360959, "comment_id": 77684101, "body": "I think you&#39;ve got it right. Ordinarily your second instance would be at risk of overlapping but here the fundep saves you, as you point out. I suspect the reason it hasn&#39;t been implemented in GHC is because one could argue that it&#39;s a counterintuitive/unexpected feature, which is only useful in specific situations, and which has a straightforward workaround. (To get a definitive answer you&#39;d have to ask a GHC developer, though.)"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1501192764, "post_id": 45360959, "comment_id": 77684694, "body": "I\u2019ve opened <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14046\" rel=\"nofollow noreferrer\">GHC ticket #14046</a> to track this issue. I\u2019ll probably delete this question if the answer is simply \u201cbecause it isn\u2019t implemented that way\u201d."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 8, "creation_date": 1501195847, "post_id": 45360959, "comment_id": 77685654, "body": "Please don&#39;t delete the question for such a reason."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501195992, "post_id": 45360959, "comment_id": 77685704, "body": "Also, some people would really like to make stuff like that actually work. The main impediments have to do with evil overlap and non-termination."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1501198593, "post_id": 45360959, "comment_id": 77686413, "body": "@dfeuer I\u2019m not sure this question can be answer all that usefully if there really isn\u2019t anything wrong with my suggestion, and this question has accumulated a downvote and a close vote. Anyway, IIUC, \u201cevil overlap\u201d isn\u2019t a problem here due to the fundep, and \u201cnon-termination\u201d is already allowed via <code>UndecideableInstances</code>, so I\u2019m not sure why that would be any different here, either."}], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1380, "favorite_count": 7, "answer_count": 0, "score": 21, "last_activity_date": 1501189336, "creation_date": 1501189336, "question_id": 45360959, "link": "https://stackoverflow.com/questions/45360959/illegal-type-synonym-family-application-in-instance-with-functional-dependency", "title": "\u201cIllegal type synonym family application in instance\u201d with functional dependency", "body": "<p>I have a multi-parameter typeclass with a functional dependency:</p>\n\n<pre><code>class Multi a b | a -&gt; b\n</code></pre>\n\n<p>I also have a simple, non-injective type synonym family:</p>\n\n<pre><code>type family Fam a\n</code></pre>\n\n<p>I want to write an instance of <code>Multi</code> that uses <code>Fam</code> in the second parameter, like this:</p>\n\n<pre><code>instance Multi (Maybe a) (Fam a)\n</code></pre>\n\n<p>However, this instance is not accepted. GHC complains with the following error message:</p>\n\n<pre><code>error:\n  \u2022 Illegal type synonym family application in instance: Fam a\n  \u2022 In the instance declaration for \u2018Multi (Maybe a) (Fam a)\u2019\n</code></pre>\n\n<p>Fortunately, there is a workaround. I can perform a usual trick for moving a type out of the instance head and into an equality constraint:</p>\n\n<pre><code>instance (b ~ Fam a) =&gt; Multi (Maybe a) b\n</code></pre>\n\n<p>This instance is accepted! However, I got to thinking, and I started to wonder why this transformation could not be applied to <em>all</em> instances of <code>Multi</code>. After all, doesn\u2019t the functional dependency imply that there can only be one <code>b</code> per <code>a</code>, anyway? In this situation, it seems like there is no reason that GHC should reject my first instance.</p>\n\n<p>I found <a href=\"https://ghc.haskell.org/trac/ghc/ticket/3485\" rel=\"noreferrer\">GHC Trac ticket #3485</a>, which describes a similar situation, but that typeclass did not involve a functional dependency, so the ticket was (rightfully) closed as invalid. In my situation, however, I think the functional dependency avoids the problem described in the ticket. Is there anything I\u2019m overlooking, or is this really an oversight/missing feature in GHC?</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1501186048, "post_id": 45359849, "comment_id": 77681557, "body": "I can&#39;t completely understand, but if you want to handle arbitrary nestings, you have to use recursion. Your type is essentially a nonempty list of <code>Maybe Int</code>, so one can recurse on the list-like type."}, {"owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501186255, "post_id": 45359849, "comment_id": 77681627, "body": "I understand that I need to use recursion. But I have been thinking a lot on this problem and could not completely understand how it can be achieved even with recursion (if can be achieved at all)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501186395, "post_id": 45359849, "comment_id": 77681707, "body": "What should the result be for 1) <code>x.x.4.x</code>, 2) <code>x.x</code>, 3) <code>1.2.x</code> ? I&#39;m not sure what&#39;s the general rule. (Maybe you should add the expected result in the question itself)"}, {"owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501186501, "post_id": 45359849, "comment_id": 77681751, "body": "<code>x.x.4.x</code> -&gt; <code>True</code>, <code>x.x</code> -&gt; <code>False</code>, <code>1.2.x</code> -&gt; <code>False</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501189380, "post_id": 45359849, "comment_id": 77683226, "body": "So, the general rule is: exactly one non-nothing number inside?"}, {"owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1501189553, "post_id": 45359849, "comment_id": 77683321, "body": "For <code>isReleaseBranch</code> yes, but there are other similar functions I didn&#39;t put into the question that use similar principle and require matching of arbitrary number of x&#39;s on the left hand side."}, {"owner": {"reputation": 760, "user_id": 8009379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c808a3b5c059f2b448f39970d384fd33?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8009379/alex"}, "edited": false, "score": 1, "creation_date": 1501189795, "post_id": 45359849, "comment_id": 77683427, "body": "You&#39;re essentially trying to parse strings and decide whether they are in or out of your definition. I don&#39;t think the pattern-matching language is going to do anything magical for you here, you just have to write the parsing program."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1501190187, "post_id": 45359849, "comment_id": 77683614, "body": "You&#39;re aware that your type is essentially <code>[Maybe Int]</code> (well, <code>NonEmpty (Maybe Int)</code>)? That should give you some ideas."}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501186649, "creation_date": 1501185057, "last_edit_date": 1501186649, "question_id": 45359849, "link": "https://stackoverflow.com/questions/45359849/nested-pattern-matching-in-haskell", "title": "Nested pattern matching in Haskell", "body": "<p>I have following data structure to simulate alternative version numbering approach in Haskell:</p>\n\n<pre><code>data VersionNumber = VC (Maybe Int) -- VersionCompound: x (Nothing), 1 (Just 1), 2 (Just 2), 3 (Just 3), 4, 5, ...\n        | VN VersionNumber (Maybe Int) -- VersionNumber: x.x, x.0, x.1, x.2, ... , 1.0, 1.1, 1.2, ... 1.x.x, 2.x.x, 3.x.x, ...\n        deriving (Show)\n\nversionCompoundToString :: (Maybe Int)-&gt; String\nversionCompoundToString (Just n) = (show n)\nversionCompoundToString Nothing = \"x\"\n\nversionNumberToString :: VersionNumber -&gt; String\nversionNumberToString (VN vn vc) = (versionNumberToString vn) ++ \".\" ++ (versionCompoundToString vc)\nversionNumberToString (VC vc) = (versionCompoundToString vc)\n</code></pre>\n\n<p>Following constructs are legitimate given the above definition:</p>\n\n<pre><code>*VersionNumber&gt; versionNumberToString (VN (VN (VC (Just 1)) Nothing) Nothing)\n\"1.x.x\"\n\n*VersionNumber&gt; versionNumberToString (VN (VC (Just 2)) Nothing)\n\"2.x\"\n\n*VersionNumber&gt; versionNumberToString (VN (VN (VN (VC Nothing) Nothing) (Just 3)) Nothing)\n\"x.x.3.x\"\n</code></pre>\n\n<p>I am trying to write functions that would detect different version numbering patterns. For example, following function <code>isReleaseBranch</code> should return <code>True</code> for such version numbers as <code>1.x</code>, <code>x.2.x</code>, <code>x.x.3.x</code>, <code>x.x.x.x.5.x</code>, etc. Similarly, following values should return corresponding results: <code>x.x.4.x</code> -> <code>True</code>, <code>x.x</code> -> <code>False</code>, <code>1.2.x</code> -> <code>False</code>. What I could come up with so far is just following pattern matching implementation:</p>\n\n<pre><code>isReleaseBranch (VN (VC (Just _)) Nothing) = True\nisReleaseBranch _ = False\n</code></pre>\n\n<p>I have no idea how to pattern match the nested pattern of arbitrary <strong>x</strong>'s on the left hand side of the version number: <code>VN (VC Nothing) Nothing</code> (<code>x.x</code>) of <code>(VN (VN (VN (VC Nothing) Nothing) (Just 3)) Nothing)</code> (<code>x.x.3.x</code>) or <code>VN (VN (VC Nothing) Nothing) Nothing</code> (<code>x.x.x</code>) of <code>VN (VN (VN (VN (VC Nothing) Nothing) Nothing) (Just 8)) Nothing</code> (<code>x.x.x.8.x</code>), etc. Is there any way to achieve such nested pattern matching in Haskell? </p>\n"}, {"tags": ["mysql", "haskell", "yesod"], "comments": [{"owner": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1501167810, "post_id": 45353893, "comment_id": 77670482, "body": "How did you check the autocommit setting? (It is a per-connection setting (and defaults to enabled), so if you use a different client, it might not have the same value). How did you check that the rows are there? (If you use the same connection, the rows will still exist until you close it)"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1501170823, "post_id": 45353893, "comment_id": 77672565, "body": "@Solarflare: I added <code>rawExecute &quot;show variables like &#39;autocommit&#39;</code> and print the result. That might be indeed irrelevant. However, looking at the code (<code>Persistent</code>) it looks like autocommit is set to false and runDB (which comes from Yesod scafholding) run thing in a transaction. I wonder if it&#39;s a problem in the actual MySQL package (used by Persistent)."}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1501875444, "creation_date": 1501166077, "last_edit_date": 1501875444, "question_id": 45353893, "link": "https://stackoverflow.com/questions/45353893/transaction-with-persistent", "title": "Transaction with Persistent", "body": "<p>I'm using Persisent with a MySQL database and it seems transaction are not working.</p>\n\n<p>I'm doing something similar to</p>\n\n<pre><code>runDB $ do\n    insertMany something\n    error \"should rollback\"\n    insertMany somethingElse\n</code></pre>\n\n<p>I expect <code>something</code> to not be in the database. The call to <code>error</code> should rollback the transaction, but when I do it, <code>something</code> is inserted in the database. Am I missing something ? (I've checked that autocommit is set to 0, and it is).</p>\n"}, {"tags": ["haskell", "vim", "ghc-mod"], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 4, "last_activity_date": 1501148642, "creation_date": 1501148642, "answer_id": 45347031, "question_id": 45346801, "link": "https://stackoverflow.com/questions/45346801/vim-call-function-on-save/45347031#45347031", "title": "vim: call function on save", "body": "<p>There are <a href=\"https://github.com/eagletmt/ghcmod-vim/wiki/Customize#customization-tips\" rel=\"nofollow noreferrer\">Customization tips</a> for ghcmod-vim</p>\n\n<p>One of them is</p>\n\n<pre><code>autocmd BufWritePost *.hs GhcModCheckAndLintAsync\n</code></pre>\n\n<p>Which is also the answer for the generic question about executing a specific command on save.</p>\n"}, {"tags": [], "owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "is_accepted": true, "score": 6, "last_activity_date": 1501148739, "creation_date": 1501148739, "answer_id": 45347070, "question_id": 45346801, "link": "https://stackoverflow.com/questions/45346801/vim-call-function-on-save/45347070#45347070", "title": "vim: call function on save", "body": "<p>You can hook into the <code>BufWritePost</code> event. Globally (i.e. for every file):</p>\n\n<pre><code>:autocmd BufWritePost * GhcModCheck\n</code></pre>\n\n<p>To do this only for Haskell files, you could modify the file pattern:</p>\n\n<pre><code>:autocmd BufWritePost *.hs GhcModCheck\n</code></pre>\n\n<p>But it's better to leverage Vim's built-in <em>filetype detection</em> and instead put this into <code>~/.vim/ftplugin/haskell_OnSave.vim</code>:</p>\n\n<pre><code>:autocmd! BufWritePost &lt;buffer&gt; GhcModCheck\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5715425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80175d4896bc5afa19d54b0a059ed115?s=128&d=identicon&r=PG&f=1", "display_name": "denys.fridman", "link": "https://stackoverflow.com/users/5715425/denys-fridman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 45347070, "answer_count": 2, "score": 7, "last_activity_date": 1501148739, "creation_date": 1501148062, "question_id": 45346801, "link": "https://stackoverflow.com/questions/45346801/vim-call-function-on-save", "title": "vim: call function on save", "body": "<p>I am using ghc-mod in vim and would like GhcModCheck (:GhcModCheck) to be called every time I save a file (:w). Could you please tell me how I can achieve that? I guess there's a more general question: how can I invoke a function on save?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["scala", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1501146742, "post_id": 45345623, "comment_id": 77653711, "body": "Thank you very much, jwvh! I don&#39;t know <code>Either.cond</code>. Actually I&#39;d like to use <code>EitherT</code> in scalaz instead of <code>Either</code>, so I searched for <code>Either.cond</code> alternative in <code>EitherT</code> but I couldn&#39;t find it. Could you tell me if you know?"}, {"owner": {"reputation": 46362, "user_id": 4993128, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QkaxJ.jpg?s=128&g=1", "display_name": "jwvh", "link": "https://stackoverflow.com/users/4993128/jwvh"}, "reply_to_user": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1501147213, "post_id": 45345623, "comment_id": 77654077, "body": "Sorry, don&#39;t know scalaz. It&#39;s on my TODO list."}], "tags": [], "owner": {"reputation": 46362, "user_id": 4993128, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QkaxJ.jpg?s=128&g=1", "display_name": "jwvh", "link": "https://stackoverflow.com/users/4993128/jwvh"}, "is_accepted": true, "score": 5, "last_activity_date": 1501145019, "creation_date": 1501145019, "answer_id": 45345623, "question_id": 45343417, "link": "https://stackoverflow.com/questions/45343417/how-to-write-haskell-do-notation-in-scala/45345623#45345623", "title": "How to write Haskell-do-notation in Scala", "body": "<p>It can be prettified some.</p>\n\n<pre><code>for {\n  v1  &lt;- e1\n  v2  &lt;- e2\n  res &lt;- Either.cond(v1 &lt; v2, 1.515151, \"some error\")\n} yield res\n</code></pre>\n\n<p>It would be nice to just throw in a guard condition but, according to the <a href=\"http://www.scala-lang.org/api/current/scala/util/Either.html\" rel=\"noreferrer\">Scala docs</a>, that's not supported because <code>Either</code> has no <code>withFilter</code> method.</p>\n"}, {"comments": [{"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1501199792, "post_id": 45352843, "comment_id": 77686681, "body": "Thank you very much Kolmar~ <code>p.either(a).or(b)</code> is what I want. Thank you!    &gt;&gt; I believe you just have to get used to how Scala does this. I want to do."}, {"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1501200141, "post_id": 45352843, "comment_id": 77686772, "body": "Are there <code>match-case</code> version? The last expression of my code is <code>if</code>, but are there any <code>match-case</code>  version in scalaz?"}, {"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1501200469, "post_id": 45352843, "comment_id": 77686828, "body": "<code>match-case</code> version means <code>v1 &lt; v2 match {case true =&gt; Right(1.515151); case false =&gt; Left(&quot;some error&quot;)}</code>. (This example can be replaced with <code>if</code>, but this is just an example.)"}], "tags": [], "owner": {"reputation": 13201, "user_id": 1098230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c8776a6aefb37bf25d866707973593e?s=128&d=identicon&r=PG", "display_name": "Kolmar", "link": "https://stackoverflow.com/users/1098230/kolmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1501163540, "creation_date": 1501163540, "answer_id": 45352843, "question_id": 45343417, "link": "https://stackoverflow.com/questions/45343417/how-to-write-haskell-do-notation-in-scala/45352843#45352843", "title": "How to write Haskell-do-notation in Scala", "body": "<p>(Disclaimer: I don't know Haskell, so I may be wrong with this)</p>\n\n<p>The difference between Haskell's <code>do</code> notation, and Scala's <code>for</code>/<code>yield</code> comprehension is that <code>do</code> sequence ends with a <code>bind</code> (i.e. <code>flatMap</code>), but <code>for</code>/<code>yield</code> ends with a normal <code>map</code>.</p>\n\n<p>So in Haskell if you have a pure value in the last step, you have to wrap it in <code>return</code>, but in Scala you can <code>yield</code> it directly. <code>yield</code> is a keyword, not a function like Haskell's <code>return</code>. On the other hand, when in the last step you have a monadic value, in Haskell you can just put it there, but in Scala you have to add a step with <code>result &lt;- monadicValue</code> and then <code>yield result</code>. </p>\n\n<p>This is just a difference in design in those two languages, and I believe you just have to get used to how Scala does this.</p>\n\n<hr>\n\n<p>As for your question in the comment to the other answer:</p>\n\n<p>In scalaz instead of <code>Either.cond(p, a, b)</code> you can use <code>p.either(a).or(b)</code>, which returns a disjunction:</p>\n\n<pre><code>scala&gt; import scalaz._, Scalaz._\n\nscala&gt; true.either(10).or(\"error\")\nres0: scalaz.\\/[String,Int] = \\/-(10)\n</code></pre>\n\n<p>Then you can wrap this disjunction in the monad you want, and then in <code>EitherT</code>. For example:</p>\n\n<pre><code>scala&gt; EitherT(true.either(10).or(\"error\").some)\nres1: scalaz.EitherT[Option,String,Int] = EitherT(Some(\\/-(10)))\n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 45345623, "answer_count": 2, "score": 4, "last_activity_date": 1501163540, "creation_date": 1501138605, "last_edit_date": 1501138977, "question_id": 45343417, "link": "https://stackoverflow.com/questions/45343417/how-to-write-haskell-do-notation-in-scala", "title": "How to write Haskell-do-notation in Scala", "body": "<p>I wrote the following Haskell code using do-nation.</p>\n\n<p>And I'd like to convert it to Scala code</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>main :: IO ()\nmain = do\n  print $ func1 (Right  1) (Right 2)\n  print $ func1 (Right 10) (Right 3)\n\n\nfunc1 :: Either String Int -&gt; Either String Int -&gt; Either String Double\nfunc1 e1 e2 = do\n  v1 &lt;- e1\n  v2 &lt;- e2\n  if v1 &lt; v2\n    then Right 1.515151  -- No meaning\n    else Left  \"some error\"\n</code></pre>\n\n<p>Here is output of Haskell</p>\n\n<pre><code>Right 1.515151\nLeft \"some error\"\n</code></pre>\n\n<p>I wrote Scala code like the following. But I feel weird when I look at <code>result &lt;- if(v1 &lt; v2)...</code> and <code>yield result</code>.</p>\n\n<pre><code>object Main {\n  def main(args: Array[String]): Unit = {\n    println(func1(Right(1))(Right(2)))\n    println(func1(Right(10))(Right(3)))\n  }\n\n  def func1(e1: Either[String, Int])(e2: Either[String, Int]): Either[String, Double] =\n    for{\n      v1 &lt;- e1\n      v2 &lt;- e2\n\n      // Weird...\n      result &lt;- if(v1 &lt; v2)\n                  Right(1.515151)\n                else\n                  Left(\"some error\")\n    } yield result\n}\n</code></pre>\n\n<p>Here is output of Scala</p>\n\n<pre><code>Right(1.515151)\nLeft(some error)\n</code></pre>\n\n<p>I'd like to write bellow. But Scala doesn't allow me to write.</p>\n\n<pre><code>  // Invalid Scala Code\n  def func1(e1: Either[String, Int])(e2: Either[String, Int]): Either[String, Double] =\n    for{\n      v1 &lt;- e1\n      v2 &lt;- e2\n    } {\n      if(v1 &lt; v2)\n          Right(1.515151)\n        else\n          Left(\"some error\")\n    }\n</code></pre>\n\n<p>Could you tell me your idea for writing in beautiful way?</p>\n"}, {"tags": ["haskell", "yi-editor"], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 6581912, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5f01ffd293668d9f604ab20986d4b247?s=128&d=identicon&r=PG&f=1", "display_name": "mc.robin", "link": "https://stackoverflow.com/users/6581912/mc-robin"}, "is_accepted": false, "score": 0, "last_activity_date": 1501130457, "creation_date": 1501130457, "answer_id": 45341557, "question_id": 45341524, "link": "https://stackoverflow.com/questions/45341524/confused-about-dynamic-configuration-of-yi/45341557#45341557", "title": "confused about dynamic-configuration of YI", "body": "<p>Because I also installed yi-0.12, uninstalling yi-0.12 will solve this problem</p>\n"}], "owner": {"reputation": 149, "user_id": 6581912, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5f01ffd293668d9f604ab20986d4b247?s=128&d=identicon&r=PG&f=1", "display_name": "mc.robin", "link": "https://stackoverflow.com/users/6581912/mc-robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501130457, "creation_date": 1501130242, "question_id": 45341524, "link": "https://stackoverflow.com/questions/45341524/confused-about-dynamic-configuration-of-yi", "title": "confused about dynamic-configuration of YI", "body": "<p>I have install yi-dynamic-configure. The ~/.config/yi/yi.hs is follows:</p>\n\n<pre><code>import Yi\n\nmain = yi $ defaultVimConfig\n</code></pre>\n\n<p>when i use yi, i get errors:</p>\n\n<pre><code>Ambiguous module name \u2018Yi\u2019:\nit was found in multiple packages: \nyi-0.12.3@yi_588IK8yeps1D4wHHrQVhy4 yi-core-0.14.0@Gh0PE0rnSjz5h4gEVk0B5B\n</code></pre>\n\n<p>How to solve this problem?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "logic"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1501118129, "post_id": 45339745, "comment_id": 77641522, "body": "I fail to see how you would get access to the outer loop variables in a language like Java if you don&#39;t know how deeply you&#39;ll need to nest. You&#39;d still have to use recursion in that case, no?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1501118175, "post_id": 45339745, "comment_id": 77641536, "body": "Oh, so you&#39;re trying to write <code>solve</code> without recursion?  I dunno, I mean I guess you could use <code>foldM</code> but I don&#39;t see a problem with how you&#39;ve done it."}, {"owner": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "edited": false, "score": 0, "creation_date": 1501118441, "post_id": 45339745, "comment_id": 77641609, "body": "The problem is with equivalence expressions; these are clues of the form &quot;The Brazilian lives in the Blue house.&quot; So to implement this constraint you need access to both the Nation list and the Color list. There are details over at: <a href=\"https://github.com/iabraham/logicpuzzleparser-simple/tree/master/report\" rel=\"nofollow noreferrer\">github.com/iabraham/logicpuzzleparser-simple/tree/master/rep&zwnj;&#8203;ort</a>  Some clues require you to interact with two lists"}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 2, "creation_date": 1501129210, "post_id": 45339745, "comment_id": 77644183, "body": "Recursion is the analogue of for loops. I sense the zebra puzzles are not essential to the question you are trying to ask. Can you come up with a trivial example that demonstrates the issue of interacting with two lists?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1501162035, "post_id": 45339745, "comment_id": 77665578, "body": "And add some actual code in an imperative language which displays the kind of thing you feel unable to do in Haskell right now!"}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1501162246, "last_edit_date": 1501162246, "creation_date": 1501161884, "answer_id": 45352153, "question_id": 45339745, "link": "https://stackoverflow.com/questions/45339745/recursion-with-access-to-prior-variables-nested-list-comprehension/45352153#45352153", "title": "Recursion with access to prior variables/nested list comprehension", "body": "<p><em>Note: this answer is half-serious. I don't really recommend writing Haskell code this way, but hopefully it'll provide some insight into the possibilities the language actually brings to the table. When solving problems that suggest an imperative approach, most often you can actually find a neater, functional way to solve them.</em></p>\n\n<hr>\n\n<p>Ironically, Haskell already has a \"loop\"; it's called <code>forM</code>.</p>\n\n<pre><code>forM :: (Traversable t, Monad m) =&gt; t a -&gt; (a -&gt; m b) -&gt; m (t b)\n</code></pre>\n\n<p>It's closer to the for-each concept, though, since it takes a <code>Traversable</code>. It can be executed in an arbitrary context, though. When people used to older style of programming say \"a for loop\" they typically think about a loop that goes over a numeric indices list. This is easy enough:</p>\n\n<pre><code>main = forM_ [1..10] print\n</code></pre>\n\n<p>At this point people would complain about lacking the ability to break out of it and do all kinds of weird manipulations. To allow that and more contrived expressions, you need to make the loop depend on the monadic expression itself:</p>\n\n<pre><code>realForM :: Monad m =&gt; (m Bool) -&gt; m () -&gt; m ()\n</code></pre>\n\n<p>If you wanted to provide \"slots\" for the init and increment, you could do that as well:</p>\n\n<pre><code>realForM :: Monad m =&gt;\n       a                 -- starting value\n    -&gt; (StateT a m Bool) -- end condition\n    -&gt; (StateT a m ())   -- increment (state change)\n    -&gt; (a -&gt; m ())       -- action to perform repeatedly\n    -&gt; m ()              -- ends up in one action\n</code></pre>\n\n<p>Use like any other loop!</p>\n\n<pre><code>realForM\n  (0 :: Int)\n  ((== 10) &lt;$&gt; get)\n  (modify (+1)) $ \\x -&gt; do\n      -- your loop body here\n</code></pre>\n\n<p>Even without implementing it, it's not hard to see that nesting is entirely possible:</p>\n\n<pre><code>realForM (0 :: Int) ((&lt; 4) &lt;$&gt; get) (modify (+1)) $ \\x -&gt;\n    realForM (0 :: Int) ((&lt; 4) &lt;$&gt; get) (modify (+1)) $ \\y -&gt; do\n        putStrLn $ show x ++ \", \" ++ show y\n</code></pre>\n\n<p>However, this still doesn't allow you to modify <code>x</code> from the inner loop, since the <code>State</code> is entirely hidden from the loop body! To allow that, we need to expose the loop body to the entire state with the counter, allowing it to modify it:</p>\n\n<pre><code>realForM' :: Monad m =&gt;\n       a                 -- starting value\n    -&gt; (StateT a m Bool) -- end condition\n    -&gt; (StateT a m ())   -- action to perform repeatedly\n    -&gt; m ()  \n</code></pre>\n\n<p>This way, we can actually get rid of the rather unnecessary increment parameter and just do the increment at the end of the loop body (This makes the implementation really neat; see below!):</p>\n\n<pre><code>realForM' (0 :: Int) ((&lt; 10) &lt;$&gt; get) $ \n    realForM' (0 :: Int) ((&lt; 3) &lt;$&gt; get) $ do\n        y &lt;- get\n        x &lt;- lift get            \n        lift . lift . putStrLn $ show x ++ \", \" ++ show y\n\n        modify (+1)\n        lift $ modify (+1)\n</code></pre>\n\n<p>As you can see, the nested state is clearly accessible. I suppose that's what you wanted all along.</p>\n\n<p>If <strong>specifying the nesting levels explicitely seems problematic</strong>, you can use tagged <code>MonadState</code>-like contexts to traverse the stack implicitly, or go back to the original implementation, but pass some references (eww) like <code>TVar</code> instead.</p>\n\n<hr>\n\n<p>Implementations:</p>\n\n<pre><code>realForM i end inc a = do\n    flip evalStateT i $ do\n        whileM_ end $ do \n            x &lt;- get\n            lift $ a x\n            inc\n\nrealForM' i end a = flip evalStateT i $ whileM_ end a\n</code></pre>\n\n<p>The <code>whileM_</code> helper is a part of <code>Control.Monad.Loops</code> package, but I typically just copy this one because I find it the most useful in practice:</p>\n\n<pre><code>whileM_ :: (Monad m) =&gt; m Bool -&gt; m a -&gt; m ()\nwhileM_ p f = go\n    where go = do\n            x &lt;- p\n            if x\n                then f &gt;&gt; go\n                else return ()\n</code></pre>\n"}], "owner": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501162246, "creation_date": 1501117684, "question_id": 45339745, "link": "https://stackoverflow.com/questions/45339745/recursion-with-access-to-prior-variables-nested-list-comprehension", "title": "Recursion with access to prior variables/nested list comprehension", "body": "<p><strong>Disclaimer</strong>: I am not a computer scientist, I have no formal computer science training (currently enrolled in my first CS course ever), and I have known Haskell for 2 months. Always had a love for tinkering with source code (C++ for 2 years in high school, MATLAB in undergraduate). </p>\n\n<p>The <strong>short version</strong> of the question I have is:</p>\n\n<p>What is the closest Haskell equivalent of nested for loops that give an <em>equivalent</em> amount of flexibility? </p>\n\n<p>I know the question has been asked many many times and the usual answer always is that list comprehension is the best bet. But this assumes that I know how many lists I have; what if I don\u2019t?  </p>\n\n<p>In a nested for loop for example, I have access to the the outer loops variables; and to some extend in a list comprehension, I do too; <strong>however</strong> I think we need to know exactly how many <code>&lt;-</code> binds we need to do apriori (in some ways this i think this is true of the for loops as well..i mean we do have to know how deep to nest..right? -- too many years of imperative or OOP programming.) </p>\n\n<p>The usual solution when you don\u2019t know how many elements are there is recursion with a well founded base case. But in this case we lose access to the the earlier stack variables. So what's the fix?</p>\n\n<p>Now I know this question is too vague to be answered without some concrete example. </p>\n\n<p>So here is the <strong>long version</strong>. </p>\n\n<p>I am building a simple logic puzzle parser/solver that can solve puzzles of the form over at: <a href=\"https://www.brainzilla.com/logic/zebra/\" rel=\"nofollow noreferrer\">https://www.brainzilla.com/logic/zebra/</a> </p>\n\n<p>I did a first attempt using Lazy Maps where I filtered the solution space myself; obviously this has efficiency problems and the program does not terminate for a large problem set. You can see this at: <a href=\"https://github.com/iabraham/logicpuzzleparser-simple\" rel=\"nofollow noreferrer\">https://github.com/iabraham/logicpuzzleparser-simple</a></p>\n\n<p>On the other hand why re-invent the wheel? So drawing inspiration from: <a href=\"https://rosettacode.org/wiki/Zebra_puzzle#Haskell\" rel=\"nofollow noreferrer\">https://rosettacode.org/wiki/Zebra_puzzle#Haskell</a></p>\n\n<p>I built my own ADTs and made them monads and all that (probably breaking a few laws in between) to use list comprehension-esque methods. Attaching a proof of concept: </p>\n\n<pre><code>module Main where\n\nimport           Control.Applicative\nimport           Control.Monad\nimport qualified Data.List           as L\nimport qualified Data.Map            as M\nimport           Debug.Trace\n\ndata Property a = Property String a deriving (Show, Eq)\ndata Properties a = Properties String [a] deriving (Show, Eq)\n\ninstance Functor (Property) where\n  fmap f (Property name prop) = Property name (f prop)\n\ninstance Functor (Properties) where\n  fmap f (Properties name prop) = Properties name (map f prop)\n\ninstance Applicative (Properties) where\n  pure a = Properties \"\" [a]\n  (Properties _ f) &lt;*&gt; (Properties _ b) = Properties \"\" (f &lt;*&gt; b)\n\ninstance Alternative (Properties) where\n  empty = Properties \"\" []\n  (Properties n1 v1) &lt;|&gt; (Properties n2 v2) = Properties (n1++n2) (v1++v2)\n\ninstance Monad (Properties) where\n  return = pure\n  (Properties _ prop) &gt;&gt;= f = Properties \"\" (aux f prop) where\n    aux _ []     = []\n    aux g (x:xs) = xss ++ aux g xs where\n      Properties _ xss = g x\n\ndata ClueExp = AlphaExp String String\n  | OmegaExp String String\n  | AtPosExp Int String String\n  | NotAtPosExp Int String String\n  | LeftOfExp String String String String\n  | DirLeftOfExp String String String String\n  | EquivExp String String String String\n  deriving (Show, Eq)\n\ndata Exp = ClueExp\n  | DefExp String [String]\n  | SolExp\n  | QuitExp\n  deriving (Show, Eq)\n\nmyPerms :: Property [a] -&gt; Properties [a]\nmyPerms p@(Property name _) = Properties name permlist where\n  Property _ permlist = fmap L.permutations p\n\ncolor = Property \"Color\" [\"Blue\", \"Green\", \"Red\"]\nnation= Property \"Nation\" [\"Brazillian\", \"German\", \"Australian\"]\nanimal= Property \"Animal\"[\"Dogs\", \"Cats\", \"Fishes\"]\nsport = Property \"Sport\" [\"Basketball\", \"Soccer\", \"Football\"]\n\nc1 = AtPosExp 2 \"Nation\" \"Brazillian\"\nc2 = OmegaExp \"Nation\" \"German\"\nc3 = AlphaExp \"Animal\" \"Dog\"\nc4 = AtPosExp 2 \"Animal\" \"Fishes\"\nc5 = OmegaExp \"Sport\" \"Football\"\nc6 = NotAtPosExp 2 \"Sport\" \"Soccer\"\nc7 = AlphaExp \"Color\" \"Green\"\nc8 = OmegaExp \"Color\" \"Red\"\n\n\nclues = [c1,c2,c3,c4,c5,c6,c7,c8]\n\npropEnv = [sport,color,nation,animal]\n\nsolution = solve propEnv clues\n\nsolve (p@(Property name prop):ps) cs =\n  do\n    x &lt;- myPerms p\n    eval x cs []\n    (solve ps cs ) &lt;|&gt; (return x)\n    where\n      eval ls (c:cs) usedvar = case c of\n        (AlphaExp list item) -&gt; case (list == name) of\n          True  -&gt; guard (head ls == item) &gt;&gt; eval ls cs (name:usedvar)\n          False -&gt; eval ls cs (name:usedvar)\n        (OmegaExp list item) -&gt; case (list == name) of\n          True  -&gt; guard (last ls == item) &gt;&gt; eval ls cs (name:usedvar)\n          False -&gt; eval ls cs (name:usedvar)\n        (AtPosExp n list item) -&gt; case (list == name) of\n          True -&gt; let \u03b7 p = (\\x -&gt; head (iterate tail x) !! p) in\n           (guard (\u03b7 (n-1) ls == item)) &gt;&gt; eval ls cs (name:usedvar)\n          False -&gt; eval ls cs (name:usedvar)\n        (NotAtPosExp n list item) -&gt; case (list == name) of\n          True -&gt; let \u03b7 p = (\\x -&gt; head (iterate tail x) !! p) in\n           (guard (\u03b7 (n-1) ls /= item)) &gt;&gt; eval ls cs (name:usedvar)\n          False -&gt; eval ls cs (name:usedvar)\n      eval ls [] vars = return ()\nsolve [] cs = return [\"Zilch\"]\n\nmain :: IO ()\nmain = putStrLn \"Hello World\"\n</code></pre>\n\n<p>As you might have guessed the problem is for <em>equivalence expressions</em> and all kinds of expressions involving two lists. Recursion denies me access to them, and list comprehension requires me to know in advance how many <code>Property</code> expressions the user is going to give my program. </p>\n\n<p>Any ideas/hints/advice?</p>\n"}]