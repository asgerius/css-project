[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457557519, "post_id": 35902438, "comment_id": 59465506, "body": "That should work, assuming <code>carMan</code> and <code>toLower</code> have correct types."}], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457557442, "post_id": 35902529, "comment_id": 59465448, "body": "This is something I tried but the program won&#39;t compile with the function like this."}, {"owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "reply_to_user": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457557491, "post_id": 35902529, "comment_id": 59465486, "body": "Can you show that error?"}, {"owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "reply_to_user": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457557669, "post_id": 35902529, "comment_id": 59465578, "body": "I see, it appears you are using the <code>toLower</code> from <code>Data.Char</code>, so that function works only for <code>Char</code>, whereas the first item from your <code>Car</code> data type is a <code>String</code>, which is a <i>list</i> of <code>Char</code>. You can map <code>toLower</code> across the string, or write that as a helper function. See my update."}, {"owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457557834, "post_id": 35902529, "comment_id": 59465677, "body": "Perfect. That&#39;s what solves it!"}], "tags": [], "owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "is_accepted": true, "score": 4, "last_activity_date": 1457557847, "last_edit_date": 1457557847, "creation_date": 1457557328, "answer_id": 35902529, "question_id": 35902438, "link": "https://stackoverflow.com/questions/35902438/apply-two-functions-to-a-list-of-tuples/35902529#35902529", "title": "Apply two functions to a list of tuples", "body": "<p>You can do this with function composition using <code>.</code></p>\n\n<pre><code>map ((map toLower) . carMan) cs\n</code></pre>\n\n<p>Or make it a helper function:</p>\n\n<pre><code>strLower :: String -&gt; String\nstrLower = map toLower\n\nmapTest :: [Car] -&gt; [String]\nmapTest = map (strLower . carMan)\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "closed_date": 1458194618, "accepted_answer_id": 35902529, "answer_count": 1, "score": 1, "last_activity_date": 1457557847, "creation_date": 1457557040, "last_edit_date": 1457557773, "question_id": 35902438, "link": "https://stackoverflow.com/questions/35902438/apply-two-functions-to-a-list-of-tuples", "closed_reason": "Not suitable for this site", "title": "Apply two functions to a list of tuples", "body": "<p>I have a list of tuples containing information in the following form as so:</p>\n\n<pre><code>carDatabase :: [Car]\ncarDatabase = [(\"Ford\", \"Focus\", 2003, [(\"Autotrader\", 9995), (\"Parkers\", 9495), (\"Motors\", 9995)]), (\"Vauxhall\", \"Corsa\", 2005, [(\"Autotrader\", 5995), (\"FOW\", 7000), (\"Gumtree\", 6500)]), ...]\n</code></pre>\n\n<p>And what I am trying to do is <code>map</code> this list to return a list of strings with the first element of each tuple (I have a function that does this with <code>carMan (x,_,_,_) = x)</code> but also using the <code>toLower</code> function and I cannot work out a way to combine them, be it with function compositions or mapping a map etc.</p>\n\n<p>This is the closest I've got.</p>\n\n<pre><code>mapTest :: [Car] -&gt; [String]\nmapTest cs = map toLower (map carMan cs)\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n\n<p>This is the error I get with:</p>\n\n<pre><code>mapTest :: [Car] -&gt; [String]\nmapTest cs = map (toLower . carMan) cs\n\nCouldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n    Expected type: Char -&gt; String\n      Actual type: Char -&gt; Char\n    In the first argument of \u2018(.)\u2019, namely \u2018toLower\u2019\n    In the first argument of \u2018map\u2019, namely \u2018(toLower . carMan)\u2019\n\ncars.hs:197:37:\n    Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019\n    Expected type: [(Char, String, Int, [(String, Int)])]\n      Actual type: [Car]\n    In the second argument of \u2018map\u2019, namely \u2018cs\u2019\n    In the expression: map (toLower . carMan) cs\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "compilation"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457557456, "post_id": 35902322, "comment_id": 59465461, "body": "You did look at <code>runParser</code>&#39;s documentation, right? It expects a <code>SourceName</code>, which can be empty. By the way, since you use <code>()</code> as state, you can use <code>parse</code> instead. Also, you don&#39;t want to define <code>database</code> in terms of <code>database</code> but <code>tempDatabase</code>. And depending on whether you actually parse all contents, you&#39;ll end up with your old problem from Monday(?)."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457557534, "post_id": 35902322, "comment_id": 59465513, "body": "okay so how can i write it? do you have any clue?"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457557793, "post_id": 35902322, "comment_id": 59465655, "body": "no i changed most of the code man at this point the only thing i want to do is to compile it and be able to just make some calls from some functional code ive written. This is btw a project of 400+ lines so please can you help me do that? it&#39;s been a week that i&#39;m working on it can you send me the exact call?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457557953, "post_id": 35902322, "comment_id": 59465753, "body": "Well, here&#39;s a clue: what&#39;s strange about the following line? <code>let database = runParser parser () database</code>"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457558006, "post_id": 35902322, "comment_id": 59465785, "body": "i only have database as a variable i use and there are 2 functions which take at least 1 variable each"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457558053, "post_id": 35902322, "comment_id": 59465811, "body": "Final hint (I&#39;m going off for today): <code>let ********database******** = runParser parser () ********database********</code>"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457558120, "post_id": 35902322, "comment_id": 59465843, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/105847/discussion-between-max-and-zeta\">continue this discussion in chat</a>."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457560078, "post_id": 35902322, "comment_id": 59466953, "body": "@Zeta Please help me runParser&#39;s documentation is very confusing. and i&#39;m kind of thinking that database should be first.` let database *** ` because it has not in scope errors"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1457565017, "post_id": 35902322, "comment_id": 59469374, "body": "The thing that the other commenter was trying to point out is that <code>database = runParser parser () database</code> is self-referential in a way that doesn&#39;t make any sense - the result of the parse is apparently the input to the parser as well. This is completely seperate from the fact that you haven&#39;t applied <code>runParser</code> to enough arguments - as the error tells you. You probably want <code>database = runParser parser () &quot;&quot; tempDatabase</code>"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457606817, "post_id": 35902322, "comment_id": 59487227, "body": "@user2407038 what arguments should i pass on this line afterwards instead of just database? <code>userInterface database username</code>  i get an error <code>Couldn&#39;t match expected type \u2018[Film]\u2019                 with actual type \u2018Either ParseError Film\u2019</code>"}], "owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1457745779, "answer_count": 0, "score": 0, "last_activity_date": 1457559973, "creation_date": 1457556707, "last_edit_date": 1457559973, "question_id": 35902322, "link": "https://stackoverflow.com/questions/35902322/proper-call-of-runparser-haskell", "closed_reason": "Duplicate", "title": "Proper Call of runParser Haskell", "body": "<p>I have written a set of parsing functions, but don't know how to call them properly.</p>\n\n<p>Here is how I am trying to invoke the <code>parser</code> function.</p>\n\n<pre><code>main :: IO ()\nmain = do \n    tempDatabase &lt;- readFile \"films.txt\"\n    let i = lines tempDatabase\n    let database = runParser parser () database\n    putStrLn \"Enter your name: \"\n    username &lt;- getLine\n    userInterface database username\n    appendFile \"films.txt\" (show database)\n    putStrLn \"Your changes to the database have been successfully saved.\"\n</code></pre>\n\n<p>I get the following type error:</p>\n\n<pre><code>Couldn't match type \u2018String -&gt; Either ParseError Film\u2019\n                   with \u2018[Char]\u2019\n    Expected type: SourceName\n      Actual type: String -&gt; Either ParseError Film\n\nCouldn't match expected type \u2018[Film]\u2019\n            with actual type \u2018String -&gt; Either ParseError Film\u2019\nProbable cause: \u2018database\u2019 is applied to too few arguments\n</code></pre>\n\n<p>For more context, these are all the functions for the parser (which are working correctly).</p>\n\n<pre><code>str :: Parser String\nstr = many1 (noneOf \",\")\n\nint :: Parser Int\nint = read &lt;$&gt; many1 digit\n\ntup :: Parser UserRatings\ntup = do user &lt;- str\n         _ &lt;- oneOf \",\"\n         rating &lt;- int\n         return (user, rating)\n\nparser :: Parser Film\nparser = do title &lt;- str\n            _ &lt;- oneOf \",\"\n            director &lt;- str\n            _ &lt;- oneOf \",\"\n            year &lt;- int\n            _ &lt;- oneOf \",\"\n            ratings &lt;- sepBy tup (oneOf \",\")\n            eof\n            return (title, director, year, ratings)\n</code></pre>\n\n<p>and this is the <code>userInterface</code></p>\n\n<pre><code>userInterface :: [Film] -&gt; String -&gt; IO()\nuserInterface filmList user = do\n                              putStrLn \"\\n............................\\n\"\n                              putStrLn \"Welcome to the Film web Database     \"\n                              putStrLn \"............................\"\n                              putStrLn \"1. - Add a new film to the database\\n\"\n                              putStrLn \"2. - Print all films in the database\\n\"\n                              putStrLn \"3. - Print all films that a particular user is a fan of\\n\"\n                              putStrLn \"4. - Print all fans of the film of your choice\\n\"\n                              putStrLn \"5. - Print all films that were released during a particular period\\n\"\n                              putStrLn \"6. - Be a fan of the film of your choice!\\n\"\n                              putStrLn \"7. - Print the average number of fans for the films starring a particular actor\\n\"\n                              putStrLn \"8. - Print the names of actors who have co-starred in at least one film\\n\"\n                              putStrLn \"0. - Quit and update database\\n\"\n                              putStrLn \"****************************************************************************\\n\"\n                              putStr \"Enter a number to perform an action or 0 to exit and save the database: \"\n                              userChoice &lt;-getLine\n                              case userChoice of\n                                  \"1\" -&gt; do\n                                         putStrLn $ displayAllFilmsString filmList\n                                         userInterface filmList user\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 6, "creation_date": 1457553697, "post_id": 35901320, "comment_id": 59463307, "body": "<code>read s_temp :: String</code> means that <code>s_temp</code> needs to be a string with the value <code>&quot;\\&quot;something\\&quot;&quot;</code> for it to parse correctly.  The string <code>&quot;something&quot;</code> is not equivalent.  I think you could just skip the <code>read</code> and pass the result of <code>getLine</code> directly through to <code>findAnagrams</code> and <code>length</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3681046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a51d5c3ce0b5dfca5709f5a2886742?s=128&d=identicon&r=PG&f=1", "display_name": "jaggedGoofy", "link": "https://stackoverflow.com/users/3681046/jaggedgoofy"}, "edited": false, "score": 0, "creation_date": 1457558932, "post_id": 35902823, "comment_id": 59466312, "body": "gah what an obvious error! (slap to forehead).  thanks!"}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 2, "last_activity_date": 1457558355, "creation_date": 1457558355, "answer_id": 35902823, "question_id": 35901320, "link": "https://stackoverflow.com/questions/35901320/why-am-i-getting-prelude-read-no-parse-on-reading-a-string-from-stdin/35902823#35902823", "title": "Why am I getting &quot;Prelude.read : no parse&quot; on reading a string from stdin", "body": "<p>As the comment states, you don't need to \"read\" your string -- its already a string!</p>\n\n<p>So change</p>\n\n<pre><code>    s_temp &lt;- getLine\n    let s = read s_temp :: String\n    putStrLn $ show $ findAnagrams s $ length s\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    s &lt;- getLine\n    putStrLn $ show $ findAnagrams s $ length s\n</code></pre>\n\n<p>And that error should be resolved.</p>\n"}], "owner": {"reputation": 25, "user_id": 3681046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a51d5c3ce0b5dfca5709f5a2886742?s=128&d=identicon&r=PG&f=1", "display_name": "jaggedGoofy", "link": "https://stackoverflow.com/users/3681046/jaggedgoofy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 35902823, "answer_count": 1, "score": 0, "last_activity_date": 1457558355, "creation_date": 1457553180, "last_edit_date": 1457558237, "question_id": 35901320, "link": "https://stackoverflow.com/questions/35901320/why-am-i-getting-prelude-read-no-parse-on-reading-a-string-from-stdin", "title": "Why am I getting &quot;Prelude.read : no parse&quot; on reading a string from stdin", "body": "<p>I'm running into an issue with printing results from my <code>forM_</code> loop.  I'm expecting the last <code>putStrLn</code> function to output the result.  For those that want the link to the problem - <a href=\"https://www.hackerrank.com/challenges/sherlock-and-anagrams\" rel=\"nofollow\">https://www.hackerrank.com/challenges/sherlock-and-anagrams</a></p>\n\n<pre><code>--Returns a sublist of xs from 'from' to 'to'\nslice from to xs = take (to - from + 1) (drop from xs)\n\n--Checks if all elements in list are identical\nallTheSame xs = and $ zipWith (==) xs (tail xs)\n\n--Handles validating an anagram\ncheckForTwoOccurences :: [Char] -&gt; [[Char]] -&gt; Bool\ncheckForTwoOccurences occ arr\n    | allTheSame occ == True = False \n    | reverse occ == occ = False\n    | (occ `elemIndex` arr /= Nothing) = True\n    | otherwise = False\n\n--Returns the count of anagrams that are substrings of s - n is length of s\nfindAnagrams s n = \n    let res = concat $ [ tail $ inits $ slice x (n-1) s | x &lt;- [0..n-1] ]\n    in foldl (\\acc x -&gt; if (checkForTwoOccurences (reverse x) res) then (succ acc) else acc) 0 res\n\n\nmain :: IO ()\nmain = do \n\n    t_temp &lt;- getLine\n    let t = read t_temp :: Int\n\n    forM_ [1..t] $ \\a0  -&gt; do\n        s_temp &lt;- getLine\n        let s = read s_temp :: String\n        putStrLn $ show $ findAnagrams s $ length s\n</code></pre>\n"}, {"tags": ["haskell", "compiler-construction", "algebraic-data-types", "type-constructor"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1457552996, "post_id": 35901088, "comment_id": 59462890, "body": "Perhaps GADTs can be used. However, even assuming that it is possible to encode this static guarantee in a GADT, I fear the difficulty bar will be raised significantly. I would first solve the exercise with runtime checks, only."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1457553487, "post_id": 35901088, "comment_id": 59463165, "body": "@chi: Thanks for the advice, but I can&#39;t figure out how would you implement that with GADTs, so I can&#39;t see how harder this is compared to runtime checking.   edit: Nevermind, I figured out"}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1457639079, "post_id": 35901418, "comment_id": 59509944, "body": "Since I need to use pattern matching on my constructor, I&#39;ll try sized vectors. If it is too complicated, I&#39;ll go for runtime checking. Thanks for the answer. Edit: I could use &quot;getters&quot; to access the values of my App constructor but I find the fancy solution more elegant."}], "tags": [], "owner": {"reputation": 379, "user_id": 1002175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3ed3ed86ef24b8f8bc1292327c5e6103?s=128&d=identicon&r=PG", "display_name": "walpen", "link": "https://stackoverflow.com/users/1002175/walpen"}, "is_accepted": true, "score": 3, "last_activity_date": 1457553490, "creation_date": 1457553490, "answer_id": 35901418, "question_id": 35901088, "link": "https://stackoverflow.com/questions/35901088/implementing-algebraic-data-types-to-my-compiler/35901418#35901418", "title": "Implementing algebraic data types to my compiler", "body": "<p>So there are a number of solutions. The fanciest is to use something like <a href=\"https://hackage.haskell.org/package/sized-vector\" rel=\"nofollow\">sized-vector</a> and <a href=\"https://hackage.haskell.org/package/type-natural-0.3.0.0/docs/Data-Type-Natural.html\" rel=\"nofollow\">type-natural</a> to constrain the arity of type constructors and arguments to match. If this approach interests you I would look at the source code of the linked libraries to see how it is done, but it involves a huge number of GHC extensions and quite a bit of work.</p>\n\n<p>A less fancy solution is to use create a family of constructor types and app types, as in.</p>\n\n<pre><code>data Const0 \ndata Const1\n-- etc.\ndata ConstN\n\ndata App0 = App0 Const0\ndata App1 = App1 Const1 Value\n-- etc.\ndata AppN = AppN ConstN Value Value ... Value\n\ndata AppI = AppI0 App0 | AppI1 App1 | ... | AppIN App1N\n</code></pre>\n\n<p>This requires producing either manually or automatically quite a bit of noise.</p>\n\n<p>To be frank, I expect the effort of enforcing this invariant in the type level is not worth the benefit. Instead I would suggest using <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow\">smart constructors</a> to enforce this at a value level.</p>\n"}], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 35901418, "answer_count": 1, "score": 2, "last_activity_date": 1457553490, "creation_date": 1457552435, "question_id": 35901088, "link": "https://stackoverflow.com/questions/35901088/implementing-algebraic-data-types-to-my-compiler", "title": "Implementing algebraic data types to my compiler", "body": "<p>I've been trying to write a small compiler for the past few weeks, while reading Stephen Diehl's great tutorial \"Write You A Haskell\". I'm currently writing an interpreter before writing the compiler.</p>\n\n<p>I have troubles to represent my values evaluated from an algebraic data type constructor application (e.g. in Haskell <code>Just 1</code>, <code>Left \"error\"</code>, etc...).</p>\n\n<p>My values are currently represented by the following type:</p>\n\n<pre><code>data Value\n    = Int Integer\n    | Flt Double\n    | Chr Char\n    | Str String\n    | Lam Name AST.Expr (Scope Value)\n    | HLam (Value -&gt; Value)\n</code></pre>\n\n<p>How would one implement type constructors ?</p>\n\n<p>So far I've thought of this:</p>\n\n<pre><code>data Value\n    = Int Integer\n    | Flt Double\n    | Chr Char\n    | Str String\n    | App Constr [Value]  -- Constr applied of [Value]\n    | Lam Name AST.Expr (Scope Value)\n    | HLam (Value -&gt; Value)\n\n-- Constructor ID and signature\n-- would be translated to a lambda abstraction\ndata Constr = Constr Name [Type]\n</code></pre>\n\n<p>But I would have to check every time I work with the constructor if the lengths of the signature and the number of applied values are equal.</p>\n\n<p>Is there another solution ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 2, "last_activity_date": 1457594174, "creation_date": 1457594174, "answer_id": 35909957, "question_id": 35900285, "link": "https://stackoverflow.com/questions/35900285/yesod-other-website-resource/35909957#35909957", "title": "Yesod other website resource", "body": "<p>You can do it with <code>#{}</code> interpolation:</p>\n\n<pre><code>let yesodHomePage = \"http://yesodweb.com\"\n\n[hamlet| &lt;a href=\"#{yesodHomePage}\"&gt;]\n</code></pre>\n\n<p>But if you really want to use URL interpolation, you can create a route for it and use <code>redirect</code> in its handler:</p>\n\n<pre><code>redirect \"http://yesodweb.com\"\n</code></pre>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 35909957, "answer_count": 1, "score": 0, "last_activity_date": 1457594174, "creation_date": 1457549875, "question_id": 35900285, "link": "https://stackoverflow.com/questions/35900285/yesod-other-website-resource", "title": "Yesod other website resource", "body": "<p>How can I define a resource which represents, for instance, <a href=\"http://www.yesodweb.com\" rel=\"nofollow\">http://www.yesodweb.com</a>? I'd call it like this:</p>\n\n<pre><code>&lt;a href=@{YesodHomePageR}&gt;\n</code></pre>\n"}, {"tags": ["haskell", "union", "intersect", "multiset"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1457550081, "post_id": 35899801, "comment_id": 59461110, "body": "Intersection of <code>[1,1,2,2]</code> with itself would be again <code>[1,1,2,2]</code>. I don&#39;t think <code>setUnique</code> would be very useful in computing the intersection, or in calculations with multisets in general."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457561942, "post_id": 35899801, "comment_id": 59467949, "body": "<code>setIntersect&#39;</code> is just reducing the union of two multisets to its underlying set."}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1457548820, "creation_date": 1457548820, "answer_id": 35899934, "question_id": 35899801, "link": "https://stackoverflow.com/questions/35899801/haskell-multiset-operations/35899934#35899934", "title": "Haskell Multiset Operations", "body": "<p>You are getting all the values because</p>\n\n<pre><code>xs ++ ys\n</code></pre>\n\n<p>has all elements ([1,2,2,3,3,3] ++ [1,2,2] = [1,2,2,3,3,3,1,2,2])</p>\n\n<p>and setUnique is just removing the extras</p>\n\n<pre><code>setUnique [1,2,2,3,3,3,1,2,2] = [3,1,2]\n</code></pre>\n\n<p>I think you want to use something other than (++) here (this is what you will want for Union, you will need to write something for intersect).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6040924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457548820, "creation_date": 1457548465, "question_id": 35899801, "link": "https://stackoverflow.com/questions/35899801/haskell-multiset-operations", "title": "Haskell Multiset Operations", "body": "<p>I am trying to create functions which can find the union and intersection of two multi sets in Haskell without the use of the Multiset module. I have a good understanding of basic intersections and unions in normal lists but multisets seem to throw me. So far for the intersect function I have:</p>\n\n<pre><code>setUnique :: (Eq a) =&gt; [a] -&gt; [a]\nsetUnique [] = []\nsetUnique (x:xs)\n    | elem x xs = setUnique xs\n    | otherwise = x : setUnique xs\n\nsetIntersect' :: (Eq a) =&gt; [a] -&gt; [a]\nsetIntersect' xs ys = setUnique (xs ++ ys)\n</code></pre>\n\n<p>The issue I have in the above code is that I am actually getting values that aren't a part of the intersect. eg [1,2,2,3,3,3] [1,2,2] = [3,1,2]</p>\n"}, {"tags": ["haskell", "io", "printf"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457547289, "post_id": 35899266, "comment_id": 59459309, "body": "i have also another error now.  Parse error in pattern: title     Possibly caused by a missing &#39;do&#39;? for this part after name,rating  <code>| title director year name rating &lt;- filmList]</code>"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457547672, "post_id": 35899266, "comment_id": 59459549, "body": "can you give me an example for how to use forM_ or mapM_for my program? because i&#39;m not familiar with them."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1457547114, "last_edit_date": 1457547114, "creation_date": 1457546809, "answer_id": 35899266, "question_id": 35899127, "link": "https://stackoverflow.com/questions/35899127/use-of-proper-printf-command-in-io-haskell/35899266#35899266", "title": "Use of Proper printF command in IO Haskell", "body": "<p>The snippet</p>\n\n<pre><code>printf(\"|%-25s| |%-65s| |%-10d| |(%s,%d) |\\n\") title director year [(name,rating)]\n</code></pre>\n\n<p>looks wrong: 5 format string <code>%</code> arguments, but 4 arguments. Maybe you want</p>\n\n<pre><code>printf(\"|%-25s| |%-65s| |%-10d| |(%s,%d) |\\n\") title director year name rating\n</code></pre>\n\n<p>?</p>\n\n<p>Also, the whole list comprehension looks wrong:</p>\n\n<pre><code>sequence_[printf | (title, director, year, [(name,rating)]) &lt;- filmList] \n</code></pre>\n\n<p>this will only handle those films in <code>filmList</code> having exactly one name and rating, silently ignoring everything else.</p>\n\n<p>Finally, check out <code>mapM_</code> and <code>forM_</code>: they are simpler than <code>sequence_</code> + list comprehension. E.g.</p>\n\n<pre><code>foo :: IO ()\nfoo = forM_ [1..10] $ \\i -&gt;\n         forM_ [1..i] $ \\j -&gt;\n            print (i,j)\n</code></pre>\n\n<p>You probably need some nested loop as the one above: one for scanning the films, and one to scan the associated name/ratings.</p>\n"}], "owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457547114, "creation_date": 1457546418, "question_id": 35899127, "link": "https://stackoverflow.com/questions/35899127/use-of-proper-printf-command-in-io-haskell", "title": "Use of Proper printF command in IO Haskell", "body": "<blockquote>\n  <p>type UserRatings = (String,Int)<br>\n  type Film = (Title, Director, Year ,\n  [UserRatings])</p>\n</blockquote>\n\n<p>I am trying to use proper the printF method for the IO but i cant figure out what is going wrong. I know the problem has to do  with the userRatings.</p>\n\n<p>In the neo.txt there are 25 films of type Film I am trying to print them in the user interface menu that I made. </p>\n\n<p>The user types main -> then his username -> then the option choice \"2\" and then the films are supposed to be displayed. </p>\n\n<pre><code>    displayFilmsIO :: Database -&gt; IO()\n    displayFilmsIO [] = putStrLn \"There are no films in the database\"\n    displayFilmsIO filmList = sequence_[printf(\"|%-25s| |%-65s| |%-10d| |(%s,%d) |\\n\") title director year [(name,rating)] | (title, director, year, [(name,rating)]) &lt;- filmList] \n\n    mainMenu :: [Film] -&gt; String -&gt; IO()\n    mainMenu list user  = do\n        putStrLn \"What do you want to do ?(choose one of the options below)\"\n        putStrLn \"[1] Add a film to the database \\n[2] View all Films \\n[3] View all films that you are fan of of\\n[4] View all fans of a particular film \\n[5] View all the films that were released during a particular period\\n[6] Be a fan of a particular film\\n[7] View the average number of fans for the films starring a particular actor \\n[8] View the names of actors who have co-starred in at least one film with a particular actor \\n[9] Save \\n[0] Exit\"\n        putStrLn \"__________________________________\"\n        choice &lt;-getLine\n        case choice of\n             \"2\" -&gt; do\n                printf (\"|%-25s| |%-65s| |%-10d| | %s,%d |\\n\") \"Title\" \"Cast\" \"Year\" \"Fans\"\n                displayFilmsIO list\n                mainMenu list user\n</code></pre>\n\n<p>And this is the main method. <strong>Nothing wrong with it</strong>, it compiles but just so you have more info.</p>\n\n<pre><code>main :: IO ()\nmain = do\n    films &lt;- loadFile2\n    getName2 films\n\nloadFile :: FilePath -&gt; IO (Either ParseError [Film])\nloadFile filename = do\n  handle &lt;- openFile filename ReadMode\n  !database &lt;- hGetContents handle\n  hClose handle\n  return $ parse films \"Films\" database\n\nloadFile2 :: IO [Film]\nloadFile2 = do\n    allFilms &lt;- readFile \"neo.txt\"\n    let films = read allFilms :: [Film]\n    return films\n\ngetName2 :: [Film] -&gt; IO ()\ngetName2 films = do\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457544791, "post_id": 35898523, "comment_id": 59457718, "body": "Haskell is lazy by default. You haven&#39;t added any bang or used any strict functions. So, yes your function is lazy."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457545411, "post_id": 35898523, "comment_id": 59458116, "body": "So, when function is not lazy ?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1457546311, "post_id": 35898523, "comment_id": 59458722, "body": "I think there is other better terminology for talking about the behavior of functions under lazy evaluation (like &quot;codata&quot;/&quot;corecursion&quot;). I don&#39;t think &quot;lazy&quot; is well-defined except as an evaluation strategy."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1457551159, "post_id": 35898523, "comment_id": 59461796, "body": "What do you want <code>partitions []</code> to be? Your current code has no base case. I think you&#39;d probably need to add <i>two</i> base cases to make it work the way you mean, unless you change the structure some."}], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457549457, "post_id": 35899027, "comment_id": 59460688, "body": "Are you sure the the above example is not lazy ? something like this works fine: <a href=\"http://lpaste.net/154356\" rel=\"nofollow noreferrer\">lpaste.net/154356</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457551162, "post_id": 35899027, "comment_id": 59461798, "body": "@Sibi: As does <code>length [undefined]</code>. chi&#39;s partition is spine strict, not element strict. Your example would fail on <code>[1,2,3,4,5] ++ undefined</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457551180, "post_id": 35899027, "comment_id": 59461808, "body": "@Sibi It is lazy in the elements, but strict in the spine. Parametricity makes it impossible to write an element-strict function without using <code>seq</code> or similar things (as you already noticed)."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457552988, "post_id": 35899027, "comment_id": 59462886, "body": "Thanks, that makes it clear. So, the only criteria for something to be called as lazy for it would be to have a non-strict spine ?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1457599797, "post_id": 35899027, "comment_id": 59482118, "body": "@Sibi it&#39;ll depend on the specifics of the function in question. What matters is <i>productivity</i>: that a finite portion of output is created in a finite amount of &quot;time&quot;. This obviously implies it&#39;ll be inspecting only a finite portion of its input. <code>partitions</code> inspect the whole of its input list before producing its first element, so if that list is infinite... etc. that&#39;s what it  means to say that it&#39;s strict in its input list&#39;s spine, I gather."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1457546647, "last_edit_date": 1457546647, "creation_date": 1457546087, "answer_id": 35899027, "question_id": 35898523, "link": "https://stackoverflow.com/questions/35898523/haskell-is-it-my-partitions-lazy/35899027#35899027", "title": "haskell - is it my partitions lazy?", "body": "<p>There are different degrees of laziness.</p>\n\n<p>One might say that your function is strict since <code>partitions undefined</code> triggers an exception, but that would be too pedantic.</p>\n\n<p>Chances are that by \"lazy\" you actually mean \"it will produce a part the output after having accessed only a part of the input\". Several degrees of laziness then arise, depending on how much input is needed for each part of the output.</p>\n\n<p>In your case, the shape of the function is as follows:</p>\n\n<pre><code>foo [] = (some constant value)\nfoo (x:xs) = C expression1 ... expressionN\n</code></pre>\n\n<p>where <code>C</code> is a value constructor. More precisely, <code>C = (:)</code> and <code>N=2</code>. Since Haskell constructors are lazy (unless bang annotations are involved), the result of <code>foo (x:xs)</code> will always be non-bottom: consuming an element in the input list is enough to produce an element of the output list.</p>\n\n<p>You might be confused by the output of <code>partitions [1..]</code> being an infinite list of pairs <code>(xs, ys)</code> where each <code>ys</code> is an infinite list. This makes the notion of laziness much more complex, since you might now wonder, e.g., \"how much input is accessed for me to take the 100th pair of the output, and then access the 500th element of its second component?\". Such questions are perfectly legitimate, and tricky to answer in general.</p>\n\n<p>Still, your code will never demand the full input list to output a finite portion of the output. This makes it \"lazy\".</p>\n\n<hr>\n\n<p>For completeness, let me show a <em>non</em> lazy function:</p>\n\n<pre><code>partitions (x:xs) = case partitions xs of\n   []     -&gt; expression0\n   (y:ys) -&gt; expression1 : expression2 \n</code></pre>\n\n<p>Above, the result of the recursive call is demanded <em>before</em> the head of the output list is produced. That will demand the whole input before any part of the output is generated.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 35899027, "answer_count": 1, "score": 2, "last_activity_date": 1457549783, "creation_date": 1457544494, "last_edit_date": 1457549783, "question_id": 35898523, "link": "https://stackoverflow.com/questions/35898523/haskell-is-it-my-partitions-lazy", "title": "haskell - is it my partitions lazy?", "body": "<p>For example</p>\n\n<pre><code>partitions [1,2,3] =\n  [([],[1,2,3])\n  ,([1],[2,3])\n  ,([1,2],[3])\n  ,([1,2,3],[])]\n</code></pre>\n\n\n\n<pre><code>partitions :: [a] -&gt; [([a], [a])]\npartitions (x:xs) = ([], x:xs):[(x:ys, rs) | (ys, rs) &lt;- partitions xs]\n</code></pre>\n\n<p>I wonder is it lazy solution. For example <code>partitions [1..]</code> is infinite. Additionally,  <code>take 5 $ partitions [1..]</code> is also infinite. I think that obvious given the fact that result of this function is infinite. However, I am not sure if it is lazy, if I correctly understand laziness.</p>\n"}, {"tags": ["haskell", "types", "polymorphism"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1457544333, "post_id": 35897570, "comment_id": 59457377, "body": "When quoting a source use <i>actual</i> quote blocks, not italics. The semantic structure can be exploited by, e.g., screen readers for blind people to better present the question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1457544530, "post_id": 35897570, "comment_id": 59457523, "body": "@Bakuriu, won&#39;t a screen reader recognize double quotes? I agree that quote blocks are definitely preferable for something this long, but I&#39;m curious."}, {"owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1457545268, "post_id": 35897570, "comment_id": 59458013, "body": "@Bakuriu, thanks for the hint!"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1457545909, "post_id": 35897570, "comment_id": 59458450, "body": "@dfeuer What about &quot;scary quotes&quot;? Anyway I prefer quote blocks especially for long quotations, since they also give a clear visual indicator of what part of the text is quoted."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457544709, "post_id": 35897708, "comment_id": 59457663, "body": "(Or a type constructor or class applied to one or more arguments. I tend to call all these &quot;first-class types&quot;, but I don&#39;t know the official terminology.) Safe coercions are sometimes sufficient, but often not."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1457543299, "last_edit_date": 1457543299, "creation_date": 1457542345, "answer_id": 35897708, "question_id": 35897570, "link": "https://stackoverflow.com/questions/35897570/type-level-polymorphism-in-haskell/35897708#35897708", "title": "Type-level Polymorphism in haskell", "body": "<p>I think that remark refers to the lack of type-level lambda abstraction. Concretely, the following is illegal, in Haskell.</p>\n\n<pre><code>data T m a = T (m a)\n\nfoo :: T (\\t -&gt; t) Int\nfoo = T 5\n</code></pre>\n\n<p>One might try to circumvent the issue using type synonyms or type families, but with no success. The following is not allowed:</p>\n\n<pre><code>type F t = t\nfoo :: T F Int\nfoo = T 5\n</code></pre>\n\n<p>Neither is this:</p>\n\n<pre><code>type family F a\ntype instance F a = a\nfoo :: T F Int\nfoo = T 5\n</code></pre>\n\n<p>In Haskell, the type equation <code>m Int ~ Int</code> has no solution: <code>m</code> must be a data type constructor. Indeed, among other things, the compiler relies on <code>m</code> being injective during unification, which could be easily violated with arbitrary type-level functions.</p>\n\n<p>One <em>can</em> however use <code>m ~ Identity</code> and obtain <code>Identity Int</code> which is different from <code>Int</code>, but isomorphic. </p>\n\n<p>At the moment, I believe <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Roles\" rel=\"nofollow\">safe coercions</a> are not powerful enough to coerce a type using <code>Identity Int</code> into the similar type which directly uses <code>Int</code>. Hence the <code>Identity</code> wrapper must be manually removed to obtain the type of the simpler fold.</p>\n"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 35897708, "answer_count": 1, "score": 4, "last_activity_date": 1457544258, "creation_date": 1457541918, "last_edit_date": 1457544258, "question_id": 35897570, "link": "https://stackoverflow.com/questions/35897570/type-level-polymorphism-in-haskell", "title": "Type-level Polymorphism in haskell", "body": "<p>I'm working through the paper <a href=\"https://www.cs.ox.ac.uk/richard.bird/online/BirdPaterson99DeBruijn.pdf\" rel=\"nofollow\">De bruijn notation as a nested datatype</a> by Richard Bird and Ross Paterson. At one one point a fold operation over a term gets defined:</p>\n\n<pre><code>infixl 9 :@\n\ndata Expr a =\n      Var a\n    | (Expr a) :@ (Expr a)\n    | Lam (Expr (Maybe a)\n\nfoldT ::\n    (forall a. a -&gt; n a) -&gt;\n    (forall a. n a -&gt; n a -&gt; n a) -&gt;\n    (forall a. n (Maybe a) -&gt; n a) -&gt;\n    Expr b -&gt; n b\nfoldT v _ _ (Var x) = v x\nfoldT v a l (fun :@ arg) = a (foldT v a l fun) (foldT v a l arg)\nfoldT v a l (Lam body) = l (foldT v a l body)\n</code></pre>\n\n<p>... and further a generalized version that allows manipulations of the values of free vars:</p>\n\n<pre><code>gfoldT ::\n    (forall a. m a -&gt; n a) -&gt;\n    (forall a. n a -&gt; n a -&gt; n a) -&gt;\n    (forall a. n (Maybe a) -&gt; n a) -&gt;\n    (forall a. (Maybe (m a)) -&gt;  m (Maybe a)) -&gt;    \n    Expr (m b) -&gt; n b                               \ngfoldT v _ _ _ (Var x) = v x\ngfoldT v a l t (fun :@ arg) = a (gfoldT v a l t fun) (gfoldT v a l t arg)\ngfoldT v a l t (Lam body) = l (gfoldT v a l t (mapT t body))\n</code></pre>\n\n<p>Then the authors state that:  </p>\n\n<blockquote>\n  <p>In theory, we can take <code>m = id</code>, the identity type constructor, and\n  so obtain <code>foldT v a l = gfoldT v a l id</code> . (...) However, type\n  constructor polymorphism in haskell is limited, in that type\n  constructor variables may only be instantiated to datatype\n  constructors.</p>\n</blockquote>\n\n<p>and further they state, that for this reason we need one-off specialized functions like <code>foldT</code> above.</p>\n\n<p>I was wondering what exactly <code>type constructor polymorphism</code> means in that context (something like full <code>System F</code>?) and if something like <code>foldT v a l = gfoldT v a l id</code> can be achieved by means of the newly added type level programming features like \n<code>DataKinds</code>, <code>PolyKinds</code> or <code>TypeFamilies</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1457540042, "post_id": 35896758, "comment_id": 59454323, "body": "maybe you can explain how you would want to do it? For example can you write a function that will merge two? Can you write one that decides if two are mergable? Start from there."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457545314, "post_id": 35898405, "comment_id": 59458043, "body": "so which queue is this? ... How do deal with Queues in Haskell? ... I don&#39;t think this will help dopatraman much ..."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 1, "creation_date": 1457549956, "post_id": 35898405, "comment_id": 59461032, "body": "Not sure I understand... while i can see a list of lists being treated as a map i believe such a metaphor is overkill. There is a way to frame the handshake problem using simple list functions like <code>head</code> and <code>cons</code>. Either way, i dont think I understand how your solution would solve the problem..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457716846, "post_id": 35898405, "comment_id": 59549028, "body": "@Carsten, there are some queues about, and <code>Data.Sequence</code> is available everywhere, and implementing Okasaki-style banker&#39;s queues is really easy."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457717261, "post_id": 35898405, "comment_id": 59549293, "body": "@dfeuer yeah I know - I just wanted to encourage Heimdell to improve on his answer - right now it does not seem to useful IMO - indeed it looked a bit like a slopy copy&amp;paste job to me - so I tried to ask for clarification (probably in a somewhat nasty and unclear way - sorry)"}], "tags": [], "owner": {"reputation": 607, "user_id": 2436412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07531356cc096dc9551e1ac5983f651d?s=128&d=identicon&r=PG", "display_name": "Heimdell", "link": "https://stackoverflow.com/users/2436412/heimdell"}, "is_accepted": false, "score": 1, "last_activity_date": 1457544202, "creation_date": 1457544202, "answer_id": 35898405, "question_id": 35896758, "link": "https://stackoverflow.com/questions/35896758/recursively-merge-list-of-lists-based-on-shared-elements/35898405#35898405", "title": "Recursively merge list of lists based on shared elements", "body": "<p>If there is a finite number of distinct elements, you can turn the task inside out and make a <code>Ord elem =&gt; Map elem [[elem]]</code> out of your <code>[[elem]]</code> and then start iteratively merging the elements by the next algorithm:</p>\n\n<ol>\n<li>while map isn't empty, take away a key, put it in the queue </li>\n<li>get all the groups containing key popped from the queue</li>\n<li>concat them and put into the queue (and in some accumulator, too)</li>\n<li>if the queue got empty, the group is finished; take another key from the map</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1457550689, "creation_date": 1457550689, "answer_id": 35900533, "question_id": 35896758, "link": "https://stackoverflow.com/questions/35896758/recursively-merge-list-of-lists-based-on-shared-elements/35900533#35900533", "title": "Recursively merge list of lists based on shared elements", "body": "<p><sup>Note: The following post is written in literate Haskell. Save it as <code>*.lhs</code> and load it in GHCi. Also note that the discussed algorithm has runtime O(n\u00b2) and isn't optimal. A better approach would use <a href=\"https://en.wikipedia.org/wiki/Disjoint-set_data_structure\" rel=\"nofollow\">union find</a> or similar.</sup></p>\n\n<p>First, let us think about the tools we need if we want to group a single list <code>x</code> with the rest of the lists <code>xs</code>. We need to separate between the lists from <code>xs</code> that have an element in common with <code>x</code>, and we need to build the <code>union</code> of such lists. Therefore, we should import some functions from <code>Data.List</code>:</p>\n\n<pre><code>&gt; import Data.List (partition, union)\n</code></pre>\n\n<p>Next, we need to check whether two lists are suitable to get merged: </p>\n\n<pre><code>&gt; intersects :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\n&gt; intersects xs ys = any (`elem` ys) xs\n</code></pre>\n\n<p>Now we have all the tools at hand to define <code>simUnion</code>. The empty case is clear: if we don't have any lists, the result doesn't have any list either:</p>\n\n<pre><code>&gt; simUnion :: Eq a =&gt; [[a]] -&gt; [[a]]\n&gt; simUnion []     = []\n</code></pre>\n\n<p>Suppose we have at least two lists. We take the first one and check whether they have any element in common with any other list. We can do so by using <code>partition</code>:</p>\n\n<pre><code>&gt; simUnion (x:xs) = \n&gt;   let (common, noncommon) = partition (intersects x) xs\n</code></pre>\n\n<p>Now, <code>common :: [[a]]</code> will only contain those lists that have at least one element in common. There can be two cases now: either <code>common</code> is empty, and our list <code>x</code> has no element in common with any list from <code>xs</code>:</p>\n\n<pre><code>&gt;   in if null common \n&gt;         then x : simUnion xs\n</code></pre>\n\n<p>We ignore <code>uncommon</code> here, since <code>xs == uncommon</code> in this case. In the other case, we need to build the union of all lists in <code>common</code> and <code>x</code>. This can be done with <code>foldr union</code>. However, this <em>new</em> list must be used in <code>simUnion</code> again, since it may have new intersections. For example, in</p>\n\n<pre><code>simUnion [[1,2], [2,3], [3,4]]\n</code></pre>\n\n<p>you want to end up with <code>[[1,2,3,4]]</code>, not <code>[[1,2,3],[3,4]]</code>:</p>\n\n<pre><code>&gt;          else simUnion (foldr union x common : noncommon)\n</code></pre>\n\n<p>Note that the result will be unsorted, but you can <code>map sort</code> over it as a last step.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1457639016, "creation_date": 1457639016, "answer_id": 35925791, "question_id": 35896758, "link": "https://stackoverflow.com/questions/35896758/recursively-merge-list-of-lists-based-on-shared-elements/35925791#35925791", "title": "Recursively merge list of lists based on shared elements", "body": "<p>I have two main recommendations:</p>\n\n<ol>\n<li>Don't think of it in terms of recursion!  Instead, make liberal use of library utility functions.</li>\n<li>Use appropriate data structures!  Since you're talking about membership tests and unions, sets (from the <code>Data.Set</code> module) sound like they would be a better choice.</li>\n</ol>\n\n<p>Applying those ideas, here's a fairly simple (though perhaps very na\u00efve and suboptimal) solution:</p>\n\n<pre><code>import Data.Set (Set)\nimport qualified Data.Set as Set\n\nsimUnion :: Set (Set Int) -&gt; Set (Set Int)\nsimUnion sets = Set.map outer sets\n  where outer :: Set Int -&gt; Set Int\n        outer set = unionMap middle set\n            where middle :: Int -&gt; Set Int\n                  middle i = unionMap inner sets\n                      where inner :: Set Int -&gt; Set Int\n                            inner set\n                                | i `Set.member` set = set\n                                | otherwise          = Set.empty\n\n-- | Utility function analogous to the 'concatMap' list function, but\n-- for sets.\nunionMap :: (Ord a, Ord b) =&gt; (a -&gt; Set b) -&gt; Set a -&gt; Set b\nunionMap f as = Set.unions (map f (Set.toList as))\n</code></pre>\n\n<p>Now using your example:    </p>\n\n<pre><code>-- | This evaluates to:\n--\n-- &gt;&gt;&gt; simUnion sampleData\n-- fromList [fromList [1,2,3,4,5,6],fromList [7,8,9]]\nsampleData :: Set (Set Int)\nsampleData = Set.fromList (map Set.fromList sampleData')\n    where sampleData' :: [[Int]]\n          sampleData' = [[2,3,4,5], [1,5,6], [7,8,9]]\n</code></pre>\n\n<blockquote>\n  <p>Ordinarily I'd accomplish this with a nested for loop, but how can I do this using Haskell's recursion?</p>\n</blockquote>\n\n<p>You don't use recursion directly.  You use higher-order functions like <code>Set.map</code> and <code>unionMap</code>.  Note that these functions are analogous to loops, and that we're using them in a nested manner.  Rule of thumb: imperative for loops very often translate to functional map, filter, reduce or similar operations.   Nested imperative loops correspondingly often translate to nested use of such functions.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1457639016, "creation_date": 1457539814, "question_id": 35896758, "link": "https://stackoverflow.com/questions/35896758/recursively-merge-list-of-lists-based-on-shared-elements", "title": "Recursively merge list of lists based on shared elements", "body": "<p>I don't know what the official technical name is for what I'm trying to do so I'll try to explain it as best I can.</p>\n\n<p>Given a list of lists:</p>\n\n<pre><code>[[2,3,4,5], [1,5,6], [7,8,9]]\n</code></pre>\n\n<p>I want to union only the lists that have atleast one common element. So basically something like this:</p>\n\n<pre><code>simUnion :: [[Int]] -&gt; [[Int]]\nsimUnion list = --...\n\n--Result\n-- [[1,2,3,4,5,6], [7,8,9]]\n</code></pre>\n\n<p>The problem I'm running into is running a match process between each element. Basically this is like the old math class problem where each person in a room must shake the hand of each other person. Ordinarily I'd accomplish this with a nested for loop, but how can I do this using Haskell's recursion?</p>\n\n<p>Any help at all would be great!</p>\n"}, {"tags": ["parsing", "haskell", "tuples"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457534001, "post_id": 35893862, "comment_id": 59449441, "body": "Why is every single word in the input separated by commas?"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457534065, "post_id": 35893862, "comment_id": 59449487, "body": "@chepner is there a better way to do this? If I change the file will it help me to parse it?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457534173, "post_id": 35893862, "comment_id": 59449562, "body": "I would imagine something like <code>Blade Runner,Ridley Scott,1982,...</code> would be better, so that you know where the title ends and the director begins (assuming, of course, that titles don&#39;t <i>contain</i> commas)."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457534304, "post_id": 35893862, "comment_id": 59449691, "body": "@chepner you are right that is how i have it it is a typo mistake sry do you have any ideas of how can i do it?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457534306, "post_id": 35893862, "comment_id": 59449695, "body": "if you want to keep <code>,</code> in your title/director you could change the separator to <code>;</code>"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457534395, "post_id": 35893862, "comment_id": 59449763, "body": "I am sorry guys that was a typo the separator is &quot;,&quot; but still I have problem with the types"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457534396, "post_id": 35893862, "comment_id": 59449766, "body": "Btw there have been asked many haskell + film questions lately - use the search function it might be helpful"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457534482, "post_id": 35893862, "comment_id": 59449837, "body": "@epsilonhalbe any example would be appreciated"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457534554, "post_id": 35893862, "comment_id": 59449889, "body": "<a href=\"https://stackoverflow.com/search?q=%5Bhaskell%5D+film\">stackoverflow.com/search?q=%5Bhaskell%5D+film</a>"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457534794, "post_id": 35893862, "comment_id": 59450080, "body": "@epsilonhalbe most of these i have seen already my question is purely about the reading from a text file correctly. it is different from all these other questions."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1457535127, "post_id": 35893862, "comment_id": 59450366, "body": "1. please make your file compile or provide the error message you cannot understand, 2. Ask a meaningful question - &quot;i get wrong types&quot; is not nearly specific enough, 3. the indentation of <code>parseLines</code> is wrong, 4. you have not defined everything - Author, Title, Year are missing - I can guess them. But please show at least as much effort in posting a question as you expect somebody responding to you. A valid but totally unhelpful answer to your question &quot;can somebody help me&quot; would be &quot;yes&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457554779, "post_id": 35895465, "comment_id": 59463905, "body": "I have a database though so &quot;testString&quot; is useless for me how can i fix this code here to put my database in the parser? <code>main :: IO () main = do      tempDatabase &lt;- readFile &quot;films.txt&quot;     let i = lines tempDatabase     let database = runParser parser () database     putStrLn &quot;Enter your name: &quot;     username &lt;- getLine     userInterface database username     appendFile &quot;films.txt&quot; (show database)     putStrLn &quot;Your changes to the database have been successfully saved.&quot;</code>"}, {"owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457697889, "post_id": 35895465, "comment_id": 59535676, "body": "Calling a text file a database is a bit of a stretch. <code>filmList &lt;- map (runParser parser () fileName) &lt;$&gt; lines &lt;$&gt; readFile fileName</code> should work."}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": false, "score": 3, "last_activity_date": 1457536490, "creation_date": 1457536490, "answer_id": 35895465, "question_id": 35893862, "link": "https://stackoverflow.com/questions/35893862/convert-a-string-to-custom-type-haskell/35895465#35895465", "title": "Convert a String to Custom Type Haskell", "body": "<p>Here's a solution using <code>Text.Parsec</code>:</p>\n\n<pre><code>import           Text.Parsec\nimport           Text.Parsec.String\n\ntype UserRatings = (String, Int)\ntype Title = String\ntype Director = String\ntype Year = Int\ntype Film = (Title, Director, Year, [UserRatings])\n\nstr :: Parser String\nstr = many1 (noneOf \",\")\n\nint :: Parser Int\nint = read &lt;$&gt; many1 digit\n\ntup :: Parser UserRatings\ntup = do user &lt;- str\n         _ &lt;- oneOf \",\"\n         rating &lt;- int\n         return (user, rating)\n\nparser :: Parser Film\nparser = do title &lt;- str\n            _ &lt;- oneOf \",\"\n            director &lt;- str\n            _ &lt;- oneOf \",\"\n            year &lt;- int\n            _ &lt;- oneOf \",\"\n            ratings &lt;- sepBy tup (oneOf \",\")\n            eof\n            return (title, director, year, ratings)\n\ntestString :: String\ntestString = \"Blade Runner,Ridley Scott,1982,Amy,5,Bill,8,Ian,7,Kevin,9,Emma,4,Sam,7,Megan,4\"\n\nmain :: IO ()\nmain = print $ runParser parser () \"testString\" testString\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "closed_date": 1457888670, "answer_count": 1, "score": 1, "last_activity_date": 1457536490, "creation_date": 1457532481, "last_edit_date": 1457534333, "question_id": 35893862, "link": "https://stackoverflow.com/questions/35893862/convert-a-string-to-custom-type-haskell", "closed_reason": "Duplicate", "title": "Convert a String to Custom Type Haskell", "body": "<p>Hello there I am trying to convert this String</p>\n\n<pre><code>Blade Runner,Ridley Scott,1982,Amy,5,Bill,8,Ian,7,Kevin,9,Emma,4,Sam,7,Megan,4\u200b\n</code></pre>\n\n<p>To a Film Type</p>\n\n<pre><code>type UserRatings = (String,Int) \ntype Film = (Title, Director, Year , [UserRatings])\n</code></pre>\n\n<p>from a text file that contains 25 films</p>\n\n<p>this is what i tried to do</p>\n\n<pre><code>maybeReadTup :: String -&gt;(String, Int)\nmaybeReadTup s = do\n  [(n, [c])] &lt;- return $ reads s\n  return [(n, [c])]\n\n    parseLines :: [String] -&gt; Film\n    parseLines list \n            |  isInt(list !! 3) = (list !! 0,(list !! 1), read (list !! 2), maybeReadTup [ (list!!1,read (list !! 2) )])\n\nisInt :: String -&gt;Bool\nisInt[] = True\nisInt (x:xs)\n    | isNumber x = True &amp;&amp; isInt xs\n    | otherwise = False\n\nparseChars :: String -&gt; String -&gt; [String]\nparseChars [] _ = []\nparseChars (x:xs) stringCount\n    | x == ',' = [stringCount] ++ parseChars xs \"\"\n    | otherwise = (parseChars xs (stringCount ++ [x]))\n\nparseAll :: [String] -&gt; [Film]\nparseAll [] = []\nparseAll (x:xs) = parseLines (parseChars x \"\") : (parseAll xs)\n</code></pre>\n\n<p>But i get wrong the types can someone please help me parse this UserRatings tuple type <code>[(String,Int)]</code> ? And can you help me understand how parseLines work? I'm new in Haskell</p>\n"}, {"tags": ["haskell", "memoization", "collatz"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457530101, "post_id": 35892751, "comment_id": 59446628, "body": "&quot;Please note that -O2 is not a desired answer.&quot; - are you saying you <i>aren&#39;t</i> compiling with optimizations? If you expect your Haskell code to be anywhere close to fast, you <i>must</i> compile with optimizations. Any time that <code>-O0</code> code runs fast is essentially a fluke. The next thing you can do is look at the <a href=\"https://hackage.haskell.org/package/ghc-core\" rel=\"nofollow noreferrer\">optimized core</a>."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457530273, "post_id": 35892751, "comment_id": 59446750, "body": "@user2407038 i&#39;ve shown my ghc argument. I need to understand what my program is going on. it&#39;s gonna help for my other programs too. I am not expecting every time I try to improve my program, i will have to come here and ask questions. so for haskell, it&#39;s very easy for people to say <code>try -O2</code>, no, i want to focus on improving the program itself instead of relying on some optimization."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1457530641, "post_id": 35892751, "comment_id": 59447012, "body": "I know nothing about the operational semantics of a <code>-O0</code> Haskell program - the compiler does whatever it wants, so it is incredibly unpredictable which core passes will fire. Your only recourse is to look at the output of <code>-v3</code> and the final generated core. If the code looks stupidly ridiculously bad.. might be because you really do have to use <code>-O2</code> with GHC. There&#39;s no conspiracy, <code>-O2</code> is not somehow &quot;cheating&quot; - your program may have <i>no</i> issues with it and the compiler generates a bad program because <code>-O0</code> means &quot;do this fast&quot;, not &quot;do this well&quot;."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1457533865, "post_id": 35892751, "comment_id": 59449351, "body": "There are all kinds of space leak in your program: mutual recursion between <code>collatzArr</code> and <code>collatz</code>,  a big long lazy array that cannot be GC&#39;d on fly, etc, but what is your <code>main</code>? What&#39;s the IO action been evaluated?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1457535532, "post_id": 35892751, "comment_id": 59450675, "body": "@zakyggaps no it&#39;s not leaked. I want to get all link lengths from 1 to n. It&#39;s not a secret already I believe, it&#39;s project Euler 14.I will need to find the longest link within n. But I think the finding longest won&#39;t be too interesting to optimize."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457538245, "post_id": 35892751, "comment_id": 59452920, "body": "As long as you don&#39;t provide your <code>main</code>, it&#39;s not possible to reproduce your behaviour in a way that will help others. For example, without changing your code, I get 70% productivity, compared to your less than 50% if I use <code>main = print $ maximum $ genColtzArr 500000</code> with 128 MB total memory usage."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457615764, "post_id": 35892751, "comment_id": 59493456, "body": "@Zeta you have my full code now. I hope you can identify something. but till, i think 128MB is too high. it shouldn&#39;t take more than 10MB."}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 2, "last_activity_date": 1457763289, "last_edit_date": 1457763289, "creation_date": 1457699174, "answer_id": 35940274, "question_id": 35892751, "link": "https://stackoverflow.com/questions/35892751/memoized-collatz-sequence/35940274#35940274", "title": "Memoized Collatz sequence", "body": "<p>As the other answer on CodeReview hints, it's alright for a 500000-element boxed array to comsume ~20MB memory, however it's not only the array but a lot of things all together:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1ACTT.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ACTT.gif\" alt=\"collatz 500000 +RTS -hr -L50\"></a></p>\n\n<p>Although you put bang patterns every where, array initialization itself is a lazy foldr:</p>\n\n<pre><code>-- from GHC.Arr\narray (l,u) ies\n    = let n = safeRangeSize (l,u)\n      in unsafeArray' (l,u) n\n                      [(safeIndex (l,u) n i, e) | (i, e) &lt;- ies]\n\nunsafeArray' :: Ix i =&gt; (i,i) -&gt; Int -&gt; [(Int, e)] -&gt; Array i e\nunsafeArray' (l,u) n@(I# n#) ies = runST (ST $ \\s1# -&gt;\n    case newArray# n# arrEleBottom s1# of\n        (# s2#, marr# #) -&gt;\n            foldr (fill marr#) (done l u n marr#) ies s2#)\n</code></pre>\n\n<p>So unless you evaluated the last bit of an array, it's holding reference to the list used in initialization. Usually the list can be GC'd on fly while you evaluating the array, but in your case the mutual references and self references disturbed the common GC pattern.</p>\n\n<ul>\n<li><code>llist</code> is self-referencing to produce every single element, so it will not be GC'd until you evaluated the last element of it</li>\n<li>it also holds a reference to <code>genColtzArr</code> so <code>genColtzArr</code> won't be GC'd until <code>llist</code> is fully evaluated</li>\n<li>you might think <code>collatz</code> is tail recursive but it's not, it's mutual recursive with <code>collatzArr</code> so again both of them won't be GC'd until fully evaluated</li>\n</ul>\n\n<p>Everything combined, your program will keep three 500000-element list-like structures in memory and results ~80MB peak heap size.</p>\n\n<hr>\n\n<h2>Solution</h2>\n\n<p>The obvious solution is to force every array / list to normal form before it's used in another so you won't keep multiple copys of the same data in the memory.</p>\n\n<pre><code>genLongestArr :: Int -&gt; Array Int Int\ngenLongestArr n =\n  let collatz = genColtzArr n\n  -- deepseq genColtzArr before mapping over it\n  -- this is equivalent to your recursive definition\n  in collatz `deepseq` (Arr.listArray (1,n) $ fmap fst $ scanl' (maxWith snd) (0, 0) $ Arr.assocs collatz)\n\nmaxWith :: Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; b\nmaxWith f b b' = case compare (f b) (f b') of\n  LT -&gt; b'\n  _  -&gt; b\n</code></pre>\n\n<p>And in <code>main</code>:</p>\n\n<pre><code>-- deepseq lar before mapping over it\n-- this is equivalent to your iter loop\nlar `deepseq` mapM_ (print . (lar Arr.!)) ns\n</code></pre>\n\n<p>Nothing can be done with <code>genColtzArr</code>, it's using itself for memorization so the mutual recursion is kind of necessary.</p>\n\n<p>Now the heap graph peaks at ~20MB as it should:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YpTXb.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YpTXb.gif\" alt=\"collatz2 500000 +RTS -hr -L50\"></a></p>\n\n<p><em>(Disclaimer: All programs in this answer were compiled with <code>-O0</code>)</em></p>\n"}], "owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457763289, "creation_date": 1457529608, "last_edit_date": 1457615687, "question_id": 35892751, "link": "https://stackoverflow.com/questions/35892751/memoized-collatz-sequence", "title": "Memoized Collatz sequence", "body": "<p>I've posted the same question in CodeReview but failed to get an answer. so I am trying my luck here in SO.</p>\n\n<p>Here is one of my programs that utilized memoization and array to improve performance and memory usage. The performance seems satisfactory but the memory usage is ridiculous and I can't figure out what's wrong:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nimport Data.Functor\nimport Data.Array (Array)\nimport qualified Data.Array as Arr\nimport Control.DeepSeq\n\ngenColtzArr n = collatzArr\n    where collatzArr = Arr.array (1, n) $ take n $ map (\\v -&gt; (v, collatz v 0)) [1..] \n          collatz 1 !acc  = 1 + acc\n          collatz !m !acc\n              | even m    = go (m `div` 2) acc\n              | otherwise = go (3 * m + 1) acc\n              where go !l !acc\n                      | l &lt;= n    = let !v = collatzArr Arr.! l in 1 + acc + v\n                      | otherwise = collatz l $ 1 + acc\n</code></pre>\n\n<p><code>collatz</code> here means <a href=\"https://en.wikipedia.org/wiki/Collatz_conjecture\" rel=\"nofollow\">this guy</a>. This function is supposed to receive a number <code>n</code>, and then return an array indexing from 1 to <code>n</code>, and in which each cell contains the length of the link from the index to 1 by applying Collatz formula.</p>\n\n<p>But the memory usage of this method is so high. Here is the profiler result (ghc option <code>-prof -fprof-auto -rtsopts</code>, run time option <code>+RTS -p</code>, <code>n == 500000</code>):</p>\n\n<pre><code>total alloc = 730,636,136 bytes  (excludes profiling overheads)\n\nCOST CENTRE              MODULE  %time %alloc\n\ngenColtzArr.collatz      Main     40.4   34.7\ngenColtzArr.collatz.go   Main     25.5   14.4\n\n\nCOST CENTRE                      MODULE                    no.     entries  %time %alloc   %time %alloc     \n\n      genColtzArr                Main                      105           1    0.0    0.0    74.7   72.1\n       genColtzArr.collatzArr    Main                      106           1    8.0   20.8    74.7   72.1\n        genColtzArr.collatzArr.\\ Main                      107      500000    0.9    2.2    66.8   51.3\n         genColtzArr.collatz     Main                      109     1182582   40.4   34.7    65.9   49.1\n          genColtzArr.collatz.go Main                      110     1182581   25.5   14.4    25.5   14.4\n</code></pre>\n\n<p>Please note that <code>-O2</code> is not a desired answer. I want to figure out what's the problem in this program and in general, how should I spot time and memory inefficiencies in Haskell code.  Specifically, I have no idea why this code, with tail recursion and bang pattern, can consume so much memory.</p>\n\nUPDATE1:\n\n<p>the same code with <code>-s</code> produces this:</p>\n\n<pre><code>   1,347,869,264 bytes allocated in the heap\n     595,901,528 bytes copied during GC\n     172,105,056 bytes maximum residency (7 sample(s))\n         897,704 bytes maximum slop\n             315 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0      2408 colls,     0 par    0.412s   0.427s     0.0002s    0.0075s\n  Gen  1         7 colls,     0 par    0.440s   0.531s     0.0759s    0.1835s\n\n  INIT    time    0.000s  (  0.000s elapsed)\n  MUT     time    0.828s  (  0.816s elapsed)\n  GC      time    0.852s  (  0.958s elapsed)\n  RP      time    0.000s  (  0.000s elapsed)\n  PROF    time    0.000s  (  0.000s elapsed)\n  EXIT    time    0.004s  (  0.017s elapsed)\n  Total   time    1.684s  (  1.791s elapsed)\n\n  %GC     time      50.6%  (53.5% elapsed)\n\n  Alloc rate    1,627,861,429 bytes per MUT second\n\n  Productivity  49.4% of total user, 46.4% of total elapsed\n</code></pre>\n\n<p>so it takes 300 meg. that is still too large. </p>\n\nUpdate2\n\n<p>full code</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nimport Data.Functor\nimport Data.Array (Array)\nimport qualified Data.Array as Arr\nimport Control.DeepSeq\n\ngenColtzArr n = collatzArr\n    where collatzArr = Arr.array (1, n) $ take n $ map (\\v -&gt; (v, collatz v 0)) [1..] \n          collatz 1 !acc  = 1 + acc\n          collatz !m !acc\n              | even m    = go (m `div` 2) acc\n              | otherwise = go (3 * m + 1) acc\n              where go !l !acc\n                      | l &lt;= n    = let !v = collatzArr Arr.! l in 1 + acc + v\n                      | otherwise = collatz l $ 1 + acc\n\n\ngenLongestArr n = Arr.array (1, n) llist\n    where colatz = genColtzArr n\n          llist  = (1, 1):zipWith (\\(n1, a1) l2 -&gt; \n                                    let l1 = colatz Arr.! a1\n                                     in (n1 + 1, if l2 &lt; l1 then a1 else n1 + 1)) \n                                  llist (tail $ Arr.elems colatz)\n\n\nmain :: IO ()\nmain = getLine &gt;&gt; do\n    ns &lt;- map read &lt;$&gt; lines &lt;$&gt; getContents\n    let m          = maximum ns\n    let lar        = genLongestArr m\n    let iter []    = return ()\n        iter (h:t) = (putStrLn $ show $ lar Arr.! h) &gt;&gt; iter t\n    iter ns\n</code></pre>\n"}, {"tags": ["http", "haskell"], "comments": [{"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 1, "creation_date": 1457549383, "post_id": 35892515, "comment_id": 59460635, "body": "Have you tried just calling <code>post</code> with a <code>ByteString</code> directly?"}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457614027, "post_id": 35892515, "comment_id": 59492199, "body": "@sclv, yep works. I found out that <code>Postable</code> class instances are documented under <code>Network.Wreq.Types</code> but only in older versions on hackage. That is why when searching for <code>Postable</code> instances in latest documentation, I found none :("}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457616899, "post_id": 35892515, "comment_id": 59494323, "body": "@sclv, you could post it as answer with link to relevant <code>Postable</code> instance documentation (even if old). Here is link to actual github source code with definition of <code>Postable</code> instances: <a href=\"https://github.com/bos/wreq/blob/master/Network/Wreq/Types.hs\" rel=\"nofollow noreferrer\">github.com/bos/wreq/blob/master/Network/Wreq/Types.hs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 2, "last_activity_date": 1457624685, "creation_date": 1457624685, "answer_id": 35921059, "question_id": 35892515, "link": "https://stackoverflow.com/questions/35892515/sending-data-not-form-in-wreq/35921059#35921059", "title": "Sending data (not form) in wreq", "body": "<p>While the <code>wreq</code> haddocks only <a href=\"http://hackage.haskell.org/package/wreq-0.4.1.0/docs/Network-Wreq.html#g:4\" rel=\"nofollow\">describe</a> <em>some</em> of the instances of <code>Postable</code>, there are in fact also <code>Postable</code> <a href=\"https://github.com/bos/wreq/blob/master/Network/Wreq/Types.hs#L56\" rel=\"nofollow\">instances</a> for plain lazy and strict bytestrings, and those should let you stream raw data directly.</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 35921059, "answer_count": 1, "score": 4, "last_activity_date": 1457624685, "creation_date": 1457528911, "question_id": 35892515, "link": "https://stackoverflow.com/questions/35892515/sending-data-not-form-in-wreq", "title": "Sending data (not form) in wreq", "body": "<p>Given a <code>curl</code> request of the form: </p>\n\n<pre><code>curl --header \"Content-Type: text/xml;charset=UTF-8\" --data @somefile.xml http://httpbin.org/post\n</code></pre>\n\n<p>How can we do that in <a href=\"http://www.serpentine.com/wreq/\" rel=\"nofollow\"><code>wreq</code></a>? I confirmed through echo from <a href=\"http://httpbin.org/post\" rel=\"nofollow\">httpbin</a> that the data is sent as \"data\" - below is snippet from <code>httpbin</code> post echo:</p>\n\n<pre><code>  {\n  \"args\": {}, \n  \"data\": \"&lt;file-contents here sent by curl --data option&gt;\", \n  \"files\": {}, \n  \"form\": {}, \n  \"headers\": {...\n  ...},\n  \"json\": null, \n  \"origin\": \"some_ip\", \n  \"url\": \"http://httpbin.org/post\"\n  }\n</code></pre>\n\n<p>So, basically, given the data from the file as a <code>Text</code> or <code>String</code>, how do we make it <code>Postable</code> in <code>wreq</code> without using <code>form</code> or <code>multi-part</code> (unless <code>data</code> option of curl is just a <code>form</code> or <code>multi-part</code> post in disguise)? I am digging around <code>wreq</code> documentation but haven't yet found anything about that. I will very much appreciate pointers on how to do this. Setting <code>headers</code> and other things are pretty straight-forward in <code>wreq</code> as shown in the tutorial.</p>\n"}, {"tags": ["haskell", "type-families"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457527481, "post_id": 35891663, "comment_id": 59444716, "body": "I&#39;m not sure but I think it just says that the pattern will only match if the symbols that are used multiple in places indeed are the same - in your <i>normal</i> pattern-matching something like <code>(a,a)</code> is not ok - you need to add a guard <code>(a,b) | a == b</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457527574, "post_id": 35891663, "comment_id": 59444799, "body": "in the case above it means that indeed the <i>pattern</i> will match <code>ElSymbol (S :&gt; E) S A</code> but not <code>ElSymbol (S :&gt; E) T A</code> - what I don&#39;t know is if <code>S ~ T</code> would be fine here"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1457529264, "post_id": 35891663, "comment_id": 59446021, "body": "See also <a href=\"http://stackoverflow.com/questions/12084593/implying-equality-in-a-haskell-pattern-match\">here</a>, in particular the first comment under the question."}], "answers": [{"comments": [{"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 0, "creation_date": 1457529269, "post_id": 35892473, "comment_id": 59446026, "body": "I guess this usage of &#39;linear&#39; comes from linear logic (where there are connectives that allow you to &quot;use&quot; a value only once as the premisse to an implication)?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 1, "creation_date": 1457529491, "post_id": 35892473, "comment_id": 59446181, "body": "@yatima2975 Yeah, it may come from that. In fact a function is quite similar to a logical implication (if you give me this [the argument], I give you that [the result]) and linear logic implication has that &quot;resource&quot; notion. But it&#39;s just an analogy, AFAIK Haskell and similar languages don&#39;t really have a very strict relationship with linear logic to suggest anything more than that."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 9, "last_activity_date": 1457529720, "last_edit_date": 1457529720, "creation_date": 1457528779, "answer_id": 35892473, "question_id": 35891663, "link": "https://stackoverflow.com/questions/35891663/what-are-nonlinear-patterns/35892473#35892473", "title": "What are nonlinear patterns", "body": "<p>A linear pattern is a patter where each variable appears at most one.</p>\n\n<p>A non-linear pattern allows reusing the same variable name implying that all the values matched by it must be equal.</p>\n\n<p>What the documentation is saying is that non linear patterns are accepted in type families definitions while they are <strong>not</strong> in normal function definitions:</p>\n\n<pre><code>Prelude&gt; let f x x = x\n\n&lt;interactive&gt;:2:7:\n    Conflicting definitions for \u2018x\u2019\n    Bound at: &lt;interactive&gt;:2:7\n              &lt;interactive&gt;:2:9\n    In an equation for \u2018f\u2019\n</code></pre>\n\n<p>There's nothing \"deep\" in this. There are other languages which allow \"non linear\" patterns in function definitions (e.g. Curry).</p>\n\n<p>So: no, type constructors have nothing to do with linearity/non linerity. Is just how you use variables in the pattern matching.</p>\n\n<hr>\n\n<p>As to why Haskell doesn't have non linear patterns for function definitions: there are cons. For example what should <code>\\x x -&gt; x</code> mean? <code>\\x -&gt; \\x -&gt; x</code>? Or <code>\\x y | x == y -&gt; x</code>?</p>\n\n<p>Also <code>f x x = 1</code> would <em>not</em> be a total function. There's an hidden guard, and thus <code>f [1..] [1..]</code> would loop forever instead of simply returning <code>1</code>.</p>\n\n<hr>\n\n<p>As has been pointed out in the comments, the <em>linear</em> term may come from <a href=\"https://en.wikipedia.org/wiki/Linear_logic\" rel=\"noreferrer\"><em>linear logic</em></a>. This logic has a <a href=\"https://en.wikipedia.org/wiki/Linear_logic#The_resource_interpretation\" rel=\"noreferrer\">\"resource interpretation\"</a> where, fundamentally, implication \"consumes\" its antecedent in order to produce the consequent.</p>\n\n<p>In its sequent calculus you cannot reuse an hypothesis multiple times as you do in classical logic. This is akin to linear patterns: you cannot reuse the same variable multiple times.\n<sub>Follow-up question: why is linear logic called <em>linear</em> logic? No idea.</sub></p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2160, "favorite_count": 1, "accepted_answer_id": 35892473, "answer_count": 1, "score": 7, "last_activity_date": 1457529720, "creation_date": 1457526623, "question_id": 35891663, "link": "https://stackoverflow.com/questions/35891663/what-are-nonlinear-patterns", "title": "What are nonlinear patterns", "body": "<p>I am reading the paper about the <code>servant</code>-api DSL (see pdf <a href=\"http://www.andres-loeh.de/Servant/servant-wgp.pdf\" rel=\"noreferrer\">here</a>)</p>\n\n<p>Quoting from <em>Section 5.2 Type safe Links</em> (emphasize added by me)</p>\n\n<blockquote>\n<pre><code>type family ElSymbol e (s :: Symbol) a :: Bool where\nElSymbol (s :&gt; e) s a = Elem e a\nElSymbol e s a = False\n</code></pre>\n  \n  <p>Note that type families in GHC \u2013 unlike normal function definitions \u2013\n  allow <strong>non-linear patterns</strong>, and the double occurrence of <code>s</code> on the left\n  hand side of the first case implies that both symbols must be equal.</p>\n</blockquote>\n\n<p><strong>What are non-linear patterns in haskell?</strong></p>\n\n<p>The fact that both occurrences of <code>s</code> need to be equal, is clear this is a consequence of the <code>ScopedTypeVariables</code>-pragma.</p>\n\n<p>I know linear/non-linear functions only from the context of mathematics where <code>y = kx + d</code> is a (1-dimensional) linear function and something like <code>y = x\u00b2 sin(x)</code> would be an example for a non-linear function.</p>\n\n<p>I guess the non-linearity comes from the type constructor (Quoting from <em>Section 3.3 Types are first-class citizens</em>)</p>\n\n<blockquote>\n<pre><code>data (item :: k) :&gt; api\ninfixr 9 :&gt;\n</code></pre>\n</blockquote>\n\n<p>but I cannot quite understand what makes this non-linear, and what would be an example of a linear constructor, if my guess is correct, that the constructor is introducing the non-linearity.</p>\n"}, {"tags": ["haskell", "zooming", "coroutine", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "edited": false, "score": 0, "creation_date": 1457555119, "post_id": 35897183, "comment_id": 59464108, "body": "Even though I can follow your explanation the definition is still bringing me trouble. So simply <code>zoom l (Coroutine m) = Coroutine (zoom l m)</code> doesn&#39;t work. I guess it&#39;s because we need to reach <code>State</code> in Coroutine stack. But I&#39;m having troubles figuring it out"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "edited": false, "score": 0, "creation_date": 1457575504, "post_id": 35897183, "comment_id": 59472749, "body": "@ksaveljev try <code>mapMonad</code> from monad coroutine package."}, {"owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "edited": false, "score": 0, "creation_date": 1457591821, "post_id": 35897183, "comment_id": 59477904, "body": "<code>zoom l m = mapMonad (zoom l) m</code> still gives me an error where it says that <code>Could not deduce (y ~ c)</code> and <code>Expected type: Control.Lens.Type.LensLike&#39; (Zoomed m y) t s       Actual type: Control.Lens.Type.LensLike&#39; (Zoomed (Coroutine f m) c) t s</code>"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "edited": false, "score": 0, "creation_date": 1457611900, "post_id": 35897183, "comment_id": 59490739, "body": "@ksaveljev my fault, I just realized it&#39;s somehow impossible to define a polymorphic <code>zoom</code> on <code>Coroutine</code> (as my restricted knowledge of <code>lens</code> suggests, sorry), but it will still work if you supply all the type parameters."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 2, "last_activity_date": 1457611996, "last_edit_date": 1457611996, "creation_date": 1457540883, "answer_id": 35897183, "question_id": 35891422, "link": "https://stackoverflow.com/questions/35891422/zoom-instance-for-coroutine-await-int-state-mystate-int/35897183#35897183", "title": "Zoom instance for Coroutine (Await Int) (State MyState) Int", "body": "<p>By error</p>\n\n<pre><code>Expecting one more argument to \u2018s\u2019\nThe third argument of \u2018Zoom\u2019 should have kind \u2018*\u2019,\n  but \u2018s\u2019 has kind \u2018* -&gt; *\u2019\nIn the instance declaration for\n  \u2018Zoom (Coroutine z s) (Coroutine z t) s t\u2019\n</code></pre>\n\n<p>GHC is complaining the kind mismatch here</p>\n\n<pre><code>  \u2018Zoom (Coroutine z s) (Coroutine z t) s t\u2019\n                     ^                  ^\n</code></pre>\n\n<p>The second type parameter of <code>Coroutine</code> should be a monad (<code>* -&gt; *</code>), while <code>s</code> is the type of the state (<code>*</code>) as the third type parameter of <code>Zoom</code>. The instance declaration should be</p>\n\n<pre><code>instance (Functor f, Zoom m n s t) =&gt; Zoom (Coroutine f m) (Coroutine f n) s t\n</code></pre>\n\n<p>Along with some boilerplate to satisfy the context of <code>Zoom</code>:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances     #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies          #-}\n{-# LANGUAGE UndecidableInstances  #-}\n\ninstance (Functor f, MonadState s m) =&gt; MonadState s (Coroutine f m) where\n  get = lift get\n  put = lift . put\n\ntype instance Zoomed (Coroutine s m) = Zoomed m\n</code></pre>\n\n<hr>\n\n<p>After a few hours of inspection I realized what I suggested above is impossible to implement, the type of <code>zoom</code> is too restricted to be used with <code>mapMonad</code> and I don't know a way to overcome it. However it still will work if everything is monomorphic:</p>\n\n<pre><code>data MyState = MyState\n  { _myRecord :: String }\n\n$(makeLenses ''MyState)\n\nzoomMyState :: Functor f =&gt; Coroutine f (State String) r -&gt; Coroutine f (State MyState) r\nzoomMyState = mapMonad (zoom myRecord)\n</code></pre>\n"}], "owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 35897183, "answer_count": 1, "score": 1, "last_activity_date": 1457611996, "creation_date": 1457525947, "question_id": 35891422, "link": "https://stackoverflow.com/questions/35891422/zoom-instance-for-coroutine-await-int-state-mystate-int", "title": "Zoom instance for Coroutine (Await Int) (State MyState) Int", "body": "<p>I have a deeply nested state <code>MyState</code> which is used inside a <code>Coroutine</code> (from <a href=\"https://hackage.haskell.org/package/monad-coroutine\" rel=\"nofollow\">monad-coroutine</a> package):</p>\n\n<pre><code>Coroutine (Await Int) (State MyState) Int\n</code></pre>\n\n<p>And I like the possibility of using zoom (from <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow\">lens</a>) to do some manipulation, because it allows me to write something like</p>\n\n<pre><code>zoom (company.assets) $ do\n   a.b = 3\n   c.d = 'good'\n   ...\n</code></pre>\n\n<p>Unfortunately for me I cannot come up with correct declaration of <code>instance Zoom</code> for the <code>Coroutine</code> I have.</p>\n\n<p>My attempt to do so was something like this:</p>\n\n<pre><code>instance Zoom (Coroutine z s) (Coroutine z t) s t where\n    zoom l (Coroutine m) = undefined\n</code></pre>\n\n<p>But already at this point GHC tells me</p>\n\n<pre><code>Expecting one more argument to \u2018s\u2019\nThe third argument of \u2018Zoom\u2019 should have kind \u2018*\u2019,\n  but \u2018s\u2019 has kind \u2018* -&gt; *\u2019\nIn the instance declaration for\n  \u2018Zoom (Coroutine z s) (Coroutine z t) s t\u2019\n</code></pre>\n\n<p>But if I do something like </p>\n\n<pre><code>instance Zoom (Coroutine z s) (Coroutine z t) (s a) (t a) where\n    zoom l (Coroutine m) = undefined\n</code></pre>\n\n<p>Then GHC is complaining:</p>\n\n<pre><code>Illegal instance declaration for\n  \u2018Zoom (Coroutine z s) (Coroutine z t) (s a) (t a)\u2019\n  The liberal coverage condition fails in class \u2018Zoom\u2019\n    for functional dependency: \u2018m -&gt; s\u2019\n  Reason: lhs type \u2018Coroutine z s\u2019 does not determine rhs type \u2018s a\u2019\nIn the instance declaration for\n  \u2018Zoom (Coroutine z s) (Coroutine z t) (s a) (t a)\u2019\n</code></pre>\n\n<p>Now I understand I'm attempting to do something blindly without understanding what is actually expected from me. Anyone could explain the way <code>Zoom</code> instance is defined for something like my <code>Coroutine</code> and why it is defined (so not only interested in the correct declaration but also some notes of the thinking process when constructing such declaration)?</p>\n"}, {"tags": ["templates", "haskell", "yesod"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457530268, "post_id": 35891019, "comment_id": 59446745, "body": "It looks like perhaps you haven&#39;t turned on <code>OverloadedStrings</code>? I believe that yesod uses this feature very heavily."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457604542, "post_id": 35902497, "comment_id": 59485541, "body": "How would I get it into my hamlet file? I&#39;d like to show it on my page."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457624811, "post_id": 35902497, "comment_id": 59500431, "body": "@Spacemoose What you want to do is not to override <code>maybeAuthId</code> but instead to <i>use</i> it, and do additional processing to turn the <code>AuthId</code> into  a piece of plain text containing the username, then use <i>that</i> text in your template."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457633048, "post_id": 35902497, "comment_id": 59506208, "body": "Well, do you have <code>maid</code> in scope at the point where you invoke the template? My impression is that should just work...?"}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457634387, "post_id": 35902497, "comment_id": 59507082, "body": "I did this in my .hs : <code>maid &lt;- defaultMaybeAuthId</code>. In my hamlet i did this: <code>&lt;p&gt;Your current auth ID: #{show maid}</code> and then i got this returned:  <code>Your current auth ID: Just (UserKey {unUserKey = SqlBackendKey {unSqlBackendKey = 1}})</code>"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457634921, "post_id": 35902497, "comment_id": 59507410, "body": "Looks like you need to use <code>getAuthEntity</code> to look up the actual user info in the db? <a href=\"https://hackage.haskell.org/package/yesod-auth-1.4.12/docs/Yesod-Auth.html#t:YesodAuthPersist\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/yesod-auth-1.4.12/docs/&hellip;</a> -- the <code>maybeAuth</code> function in the same file looks like it does it for you..."}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457635028, "post_id": 35902497, "comment_id": 59507476, "body": "<code>maid &lt;- lookupSession &quot;_ID&quot; </code> gives me Just &quot;1&quot;"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 1, "creation_date": 1457636948, "post_id": 35902497, "comment_id": 59508653, "body": "The suggestion is <code>maid &lt;- maybeAuth</code>"}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457637369, "post_id": 35902497, "comment_id": 59508900, "body": "I am getting <code>chat.hs:337:11:     No instance for (Show User) arising from a use of \u2018show\u2019     In the first argument of \u2018toHtml\u2019, namely \u2018show maid\u2019     In the first argument of \u2018asWidgetT . toWidget\u2019, namely       \u2018toHtml (show maid)\u2019     In a stmt of a &#39;do&#39; block:       (asWidgetT . toWidget) (toHtml (show maid))</code>"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457637878, "post_id": 35902497, "comment_id": 59509234, "body": "So, figure out what the User type is coming back from maybeAuth, and apply the appropriate function to it to extract the user id."}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457642510, "post_id": 35902497, "comment_id": 59512076, "body": "i get back <code>Just (UserKey {unUserKey = SqlBackendKey {unSqlBackendKey = 3}})</code> from <code>maybeAuthId</code>. I do not want the &quot;3&quot; though. Because that is the id.  I want the email.. How do i get it from my database?"}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457649723, "post_id": 35902497, "comment_id": 59516126, "body": "I would also take the Id though. How do i get the &quot;3&quot; only? Instead of the <code>Just (UserKey {unUserKey = SqlBackendKey {unSqlBackendKey = 3}})</code>"}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1457557226, "creation_date": 1457557226, "answer_id": 35902497, "question_id": 35891019, "link": "https://stackoverflow.com/questions/35891019/lookupsession-id-throws-error-using-yesod-haskell-for-authentication/35902497#35902497", "title": "lookupSession &quot;_ID&quot; throws error using Yesod / Haskell for authentication", "body": "<p>I think you shouldn't be setting <code>maybeAuthId</code> at all. There's a <a href=\"https://hackage.haskell.org/package/yesod-auth-1.4.12/docs/src/Yesod-Auth.html#maybeAuthId\" rel=\"nofollow\">default one</a> with a fair amount of extra logic to turn the returned <code>Text</code> into a proper <code>AuthId</code>:</p>\n\n<pre><code>-- | Retrieves user credentials from the session, if user is authenticated.\n--\n-- This function does /not/ confirm that the credentials are valid, see\n-- 'maybeAuthIdRaw' for more information.\n--\n-- Since 1.1.2\ndefaultMaybeAuthId\n    :: (YesodAuthPersist master, Typeable (AuthEntity master))\n    =&gt; HandlerT master IO (Maybe (AuthId master))\ndefaultMaybeAuthId = runMaybeT $ do\n    s   &lt;- MaybeT $ lookupSession credsKey\n    aid &lt;- MaybeT $ return $ fromPathPiece s\n    _   &lt;- MaybeT $ cachedAuth aid\n    return aid\n</code></pre>\n\n<p>If you don't set <code>maybeAuthId</code>then this default implementation will be used.</p>\n"}], "owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 35902497, "answer_count": 1, "score": 0, "last_activity_date": 1457557226, "creation_date": 1457524807, "last_edit_date": 1457554499, "question_id": 35891019, "link": "https://stackoverflow.com/questions/35891019/lookupsession-id-throws-error-using-yesod-haskell-for-authentication", "title": "lookupSession &quot;_ID&quot; throws error using Yesod / Haskell for authentication", "body": "<p>I have the following in my  <code>chat.hamlet</code> file, and want to show it whenever a user is logged in and we have a <code>maybeAuthId</code>.</p>\n\n<pre><code>&lt;div style=\"float:left\"&gt;\n    $maybe _ &lt;- maid\n        &lt;p&gt;Your current auth ID: #{show maid}\n        &lt;h3&gt;\n            &lt;a href=@{AuthR LogoutR}&gt;Logout\n    $nothing\n        &lt;h3&gt;\n            &lt;a href=@{AuthR LoginR}&gt;Register / Login\n&lt;br clear=\"all\"/&gt;\n</code></pre>\n\n<p>I tried to define <code>maybeAuthId = lookupSession \"_ID\"</code> but got a type error:</p>\n\n<pre><code>Couldn't match type \u2018Key User\u2019 with \u2018Text\u2019\n    Expected type: HandlerT App IO (Maybe (AuthId App))\n      Actual type: HandlerT App IO (Maybe Text)\n    In the expression: lookupSession \"_ID\"\n    In an equation for \u2018maybeAuthId\u2019: maybeAuthId = lookupSession \"_ID\"\n</code></pre>\n\n<p>Here's the relevant code:</p>\n\n<pre><code>instance YesodAuth App where\n    type AuthId App = UserId\n\n    loginDest _ = HomeR\n    logoutDest _ = HomeR\n    authPlugins _ = [ authBrowserId def\n        , authGoogleEmail clientId clientSecret\n        , authEmail\n        ]\n\n    -- Need to find the UserId for the given email address.\n    -- Take it from database\n    getAuthId creds = runDB $ do\n        x &lt;- insertBy $ User (credsIdent creds) Nothing Nothing False\n        return $ Just $\n            case x of\n                Left (Entity userid _) -&gt; userid -- newly added user\n                Right userid -&gt; userid -- existing user\n\n    authHttpManager = httpManager\n\n    maybeAuthId = lookupSession \"_ID\"\n</code></pre>\n\n<p>How can I fix this error?</p>\n"}, {"tags": ["javascript", "html", "haskell", "yesod", "hamlet"], "comments": [{"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457771327, "post_id": 35888227, "comment_id": 59566516, "body": "Why does nobody help me?"}], "owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1457519970, "creation_date": 1457517357, "last_edit_date": 1457519970, "question_id": 35888227, "link": "https://stackoverflow.com/questions/35888227/how-to-bind-haskell-pandoc-function-to-html-selector-with-yesodweb", "title": "How to bind Haskell Pandoc function to html selector with YesodWeb?", "body": "<p>My usecase is the followin:</p>\n\n<ul>\n<li>I have got a website setup with YesodWeb</li>\n<li>I can write Text to one area</li>\n<li>Pandoc transforms my text, and i receive a converted text in another textbox</li>\n<li>The question: How can i bind my command to a html selector? i need to be able to give different commands to my Pandoc function depending on the selector.</li>\n</ul>\n\n<p>My function in my.hs file:</p>\n\n<pre><code>pandocConverted :: String -&gt; IO String \npandocConverted input = do\n    (Just hIn, Just hOut, _, _) &lt;- createProcess (proc \"pandoc\" []) { std_in = CreatePipe, std_out = CreatePipe }\n    hPutStr hIn input    \n    converted  &lt;- hGetContents hOut\n    return converted\n</code></pre>\n\n<p>pandoc command line goes like this:</p>\n\n<p><code>(proc \"pandoc\" [\"-f\", variable1, \"-t\", variable2])</code>\n\"-f\" is input e.g. \"markup\"\n\"-t\" is output e.g. \"latex\"</p>\n\n<p>My selectors in chat.hamlet (html template):</p>\n\n<pre><code>&lt;div style=\"float:right; margin-top:5px\"&gt;\n                &lt;select id=\"selectorTo\" onchange=\"getSelected(this)\"&gt;\n                    &lt;option value=\"asciidoc\"&gt;AsciiDoc&lt;/option&gt;\n                    &lt;option value=\"context\"&gt;ConTeXt&lt;/option&gt;\n                    &lt;option value=\"docbook\"&gt;DocBook&lt;/option&gt;\n                    &lt;option value=\"dokuwiki\"&gt;DokuWiki&lt;/option&gt;\n...\n</code></pre>\n\n<p>for output</p>\n\n<p>and</p>\n\n<pre><code>&lt;div style=\"float:left;\"&gt; \n                &lt;p style=\"font-size:18px\"&gt; From: \n            &lt;div style=\"float:right; margin-top:5px\"&gt;\n                &lt;select id=\"selectorFrom\" onchange=\"getSelected(this)\"&gt;\n                    &lt;option value=\"docbook\"&gt;DocBook\n                    &lt;option value=\"haddock\"&gt;Haddock markup\n                    &lt;option value=\"html\"&gt;HTML\n                    &lt;option value=\"latex\"&gt;LaTeX\n                    &lt;option value=\"markdown\" selected=\"\"&gt;Markdown (pandoc)\n... \n</code></pre>\n\n<p>for input</p>\n\n<p>I wrote this javascript. How do i get the variables back to my .hs file?</p>\n\n<pre><code>url = url.replace(\"http:\", \"ws:\").replace(\"https:\", \"wss:\");\nconn = new WebSocket(url);\n\nfunction getSelected(e) {\n    var value = e.value;\n    var selector = '';\n\n    if(e.id == \"selectorFrom\"){\n        selector = e.id;\n    }\n    if(e.id == \"selectorTo\"){\n        selector = e.id;\n    }\n    console.log(selector + \": \" + value);\n    return (selector, value);\n    conn.send(e.id, e.value);\n }\n</code></pre>\n\n<p>My <code>conn.send(e.id, e.value)</code> does not do anything. How would i receive the message on server side?</p>\n\n<p>Please help me!</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "traversal"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1457516662, "post_id": 35887598, "comment_id": 59437193, "body": "You could add to a tuple with functions like <code>incVowel (v, c) = (v + 1)</code> and <code>incConsonant (v, c) = (v, c + 1)</code>. Obviously these functions are very specialised, but hopefully you get the picture."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1457516744, "creation_date": 1457516744, "answer_id": 35887995, "question_id": 35887598, "link": "https://stackoverflow.com/questions/35887598/how-do-you-keep-track-of-multiple-properties-of-a-string-without-traversing-it-m/35887995#35887995", "title": "How do you keep track of multiple properties of a string without traversing it multiple times?", "body": "<p>Using <code>foldr</code> with a state is somewhat simple:</p>\n\n<pre><code>countVCs :: String -&gt; (Int, Int)\ncountVCs str = foldr k (0, 0) str\n   where\n     k x (v, c) = if isVowel x then (v + 1, c ) else (v , c + 1 )\n</code></pre>\n\n<p>An alternative way would be <code>Data.List.partition</code> followed by <code>length</code> on both elements of the pair:</p>\n\n<pre><code>countVCs :: String -&gt; (Int, Int)\ncountVCs str = both length (partition isVowel str)\n  where \n    both f (x,y) = (f x, f y)\n</code></pre>\n\n<p>Yet another way is to use <code>foldMap</code> with <code>(Sum Int, Sum Int)</code>:</p>\n\n<pre><code>countVCs :: String -&gt; (Int, Int)\ncountVCs str = both getSum (foldMap k str)\n  where\n    k x          = if isVowel x then (Sum 1, Sum 0) else (Sum 0, Sum 1)\n    both f (x,y) = (f x, f y)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1457544074, "post_id": 35892173, "comment_id": 59457199, "body": "I&#39;m sure this is an extremely good answer, but for a beginner like me, it was a bit over my head. I really appreciate the answer though, and I&#39;ll definitely be looking back on it later when I&#39;m more experienced."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 3, "creation_date": 1457552315, "post_id": 35892173, "comment_id": 59462493, "body": "I&#39;m sorry it&#39;s a bit much. There&#39;s certainly a whole bunch of concepts and techniques coming together to produce that solution, and if most or all of them are new, it&#39;ll take quite some digestion. But there is one theme: we use types not only to describe valid data layouts, but also to identify computational structure that we can exploit (how to traverse, how to combine the things we compute from each element). Becoming aware of useful structure (often captured by type classes) is a really useful part of learning Haskell, because it&#39;s how you get the compiler to write code for you."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1457554968, "post_id": 35892173, "comment_id": 59464020, "body": "No need to apologize. I&#39;ll definitely keep that in mind, and it&#39;s interesting thinking of it as getting &quot;the compiler to write code for you.&quot;"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 14, "last_activity_date": 1457528026, "creation_date": 1457528026, "answer_id": 35892173, "question_id": 35887598, "link": "https://stackoverflow.com/questions/35887598/how-do-you-keep-track-of-multiple-properties-of-a-string-without-traversing-it-m/35892173#35892173", "title": "How do you keep track of multiple properties of a string without traversing it multiple times?", "body": "<p>I'd start by defining the traditional \"indicator function\"</p>\n\n<pre><code>indicate :: Num a =&gt; Bool -&gt; a\nindicate b = if b then 1 else 0\n</code></pre>\n\n<p>so that</p>\n\n<pre><code>indicate . isVowel :: Char -&gt; Integer\n</code></pre>\n\n<p>Next, I'd get hold of two key pieces of kit from <code>Control.Arrow</code></p>\n\n<pre><code>(&amp;&amp;&amp;) :: (x -&gt; y) -&gt; (x -&gt; z) -&gt; x -&gt; (y, z)\n(***) :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)\n</code></pre>\n\n<p>so (remembering that some characters are neither vowels nor consonants)</p>\n\n<pre><code>(indicate . isVowel) &amp;&amp;&amp; (indicate . isConsonant)\n  :: Char -&gt; (Integer, Integer)\n</code></pre>\n\n<p>And then I'd grab hold of <code>Sum</code> from <code>Data.Monoid</code>.</p>\n\n<pre><code>(Sum . indicate . isVowel) &amp;&amp;&amp; (Sum . indicate . isConsonant)\n  :: Char -&gt; (Sum Integer, Sum Integer)\ngetSum *** getSum :: (Sum Integer, Sum Integer) -&gt; (Integer, Integer)\n</code></pre>\n\n<p>Now I deploy <code>foldMap</code>, because we're doing some sort of monoidal \"crush\".</p>\n\n<pre><code>(getSum *** getSum) .\nfoldMap ((Sum . indicate . isVowel) &amp;&amp;&amp; (Sum . indicate . isConsonant))\n  :: String -&gt; (Integer, Integer)\n</code></pre>\n\n<p>Then I remember that I wrote some code which got turned into <code>Control.Newtype</code> and I discover the following is missing but should be there.</p>\n\n<pre><code>instance (Newtype n o, Newtype n' o') =&gt; Newtype (n, n') (o, o') where\n  pack = pack *** pack\n  unpack = unpack *** unpack\n</code></pre>\n\n<p>And now I need only write</p>\n\n<pre><code>ala' (Sum *** Sum) foldMap ((indicate . isVowel) &amp;&amp;&amp; (indicate . isConsonant))\n  :: String -&gt; (Integer, Integer)\n</code></pre>\n\n<p>The key gadget is</p>\n\n<pre><code>ala' :: (Newtype n o, Newtype n' o') =&gt;\n (o -&gt; n) -&gt; ((a -&gt; n) -&gt; b -&gt; n') -&gt; (a -&gt; o) -&gt; b -&gt; o'\n-- ^-packer    ^-higher-order operator  ^-action-on-elements\n</code></pre>\n\n<p>where the packer's job is to select the newtype with the correct behavioral instance and also determine the unpacker. It's exactly designed to support working locally at a more specific type that signals the intended structure.</p>\n"}, {"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1457564900, "post_id": 35904470, "comment_id": 59469310, "body": "I figured as much, but it was the fact that I didn&#39;t even know how to achieve single traversal even if I wanted to that bothered me."}], "tags": [], "owner": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "is_accepted": false, "score": 1, "last_activity_date": 1457564811, "creation_date": 1457564811, "answer_id": 35904470, "question_id": 35887598, "link": "https://stackoverflow.com/questions/35887598/how-do-you-keep-track-of-multiple-properties-of-a-string-without-traversing-it-m/35904470#35904470", "title": "How do you keep track of multiple properties of a string without traversing it multiple times?", "body": "<p>Frankly, the most idiomatic way in functional programming is to not worry about the extra traversal, and go for the improved readability and composability offered by the more simple solution.  Two traversals are still <code>O(n)</code>.  Unless your string is huge or read from a non-reversible source like a network stream, the performance difference of the two traversals is negligible.</p>\n\n<p>Also, you don't need to use recursion.  <code>countVowels</code> and <code>countConsonants</code> can be implemented as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>countVowels = length . filter isVowel\ncountConsonants = length . filter (not . isVowel)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1458283935, "post_id": 36075495, "comment_id": 59800746, "body": "I think this is the best practical answer."}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 2, "last_activity_date": 1458302276, "last_edit_date": 1458302276, "creation_date": 1458270946, "answer_id": 36075495, "question_id": 35887598, "link": "https://stackoverflow.com/questions/35887598/how-do-you-keep-track-of-multiple-properties-of-a-string-without-traversing-it-m/36075495#36075495", "title": "How do you keep track of multiple properties of a string without traversing it multiple times?", "body": "<p>Yet another way is to use a 'beautiful folding' library like <a href=\"http://hackage.haskell.org/package/foldl-1.1.6/docs/Control-Foldl.html\" rel=\"nofollow\"><code>foldl</code></a>. Then this problem basically reduces to writing a single expression. I will divide it up:</p>\n\n<pre><code>import qualified Control.Foldl as L\nimport Control.Lens\n\nisVowel :: Char -&gt; Bool\nisVowel c = c `elem` \"aeiou\"\n\ncountVowels, countConsonants :: L.Fold Char Int\ncountVowels = L.handles (filtered isVowel) L.length\ncountConsonants  = L.handles (filtered (not.isVowel)) L.length\n\nlessVowels :: L.Fold Char Bool\nlessVowels  = (&lt;) &lt;$&gt; countVowels &lt;*&gt; countConsonants \n\nmakeWord :: String -&gt; Maybe String\nmakeWord s =  if L.fold lessVowels s then Nothing else Just s\n</code></pre>\n\n<p>so then I have, say </p>\n\n<pre><code> &gt;&gt;&gt; makeWord \"aaa\"\n Just \"aaa\"\n &gt;&gt;&gt; makeWord \"ttt\"\n Nothing\n</code></pre>\n\n<p>With <code>foldl</code> you can run indefinitely many folds on the same material simultaneously. The sequence of elements can be a pure list, vector or array, or an effectful stream like a pipe or conduit. The composition of folds is indifferent to what, in the end, you fold it over. </p>\n\n<p>I used <code>handles</code> above, which is a little sophisticated, maybe, since it uses lenses, but this allows the different folds to take account of different sorts of elements. So here, one fold is only 'looking' at vowels, the other at consonants. It would be simple to write these folds by hand, and dispense with the <code>filtered isVowel</code> lens.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 1, "accepted_answer_id": 35887995, "answer_count": 4, "score": 4, "last_activity_date": 1458302276, "creation_date": 1457515645, "last_edit_date": 1457521538, "question_id": 35887598, "link": "https://stackoverflow.com/questions/35887598/how-do-you-keep-track-of-multiple-properties-of-a-string-without-traversing-it-m", "title": "How do you keep track of multiple properties of a string without traversing it multiple times?", "body": "<p>I recently did a practice problem for validating a string.</p>\n\n<blockquote>\n  <p>Use the <code>Maybe</code> type to write a function that counts the number of vowels\n  in a string and the number of consonants. If the number of vowels exceeds\n  the number of consonants, the function returns Nothing.</p>\n</blockquote>\n\n<p>I ended up two functions for each counting vowels and counting consonants:</p>\n\n<pre><code>isVowel :: Char -&gt; Bool\nisVowel c = c `elem` \"aeiou\"\n\ncountVowels :: String -&gt; Integer\ncountVowels []     = 0\ncountVowels (x:xs) =\n  if isVowel x\n  then countVowels xs + 1\n  else countVowels xs\n\ncountConsonants :: String -&gt; Integer\ncountConsonants []     = 0\ncountConsonants (x:xs) =\n  if not $ isVowel x\n  then countConsonants xs + 1\n  else countConsonants xs\n</code></pre>\n\n<p>And then just comparing the values of the two to get my answer.</p>\n\n<pre><code>makeWord :: String -&gt; Maybe String\nmakeWord [] = Nothing\nmakeWord s  =\n  if countVowels s &lt; countConsonants s\n  then Nothing\n  else Just s\n</code></pre>\n\n<p>My problem with this is that it traverses the string twice, once to get the number of vowels and another time to get the number of consonants.</p>\n\n<p>I thought perhaps I could fix this by subtracting the number of vowels from the length of the string to begin with, but that also takes two traversals.</p>\n\n<p>So I tried making a function that tracks both vowels and consonants at once, storing the results in a tuple, but since I didn't know adding tuples is actually pretty hard, the result was even more complex.</p>\n\n<pre><code>countVowelsAndConsonants :: String -&gt; [(Integer, Integer)]\ncountVowelsAndConsonants []     = []\ncountVowelsAndConsonants (x:xs) =\n  if isVowel x\n    then (1, 0) : countVowelsAndConsonants xs\n    else (0, 1) : countVowelsAndConsonants xs\n\nmakeWord :: String -&gt; Maybe String\nmakeWord [] = Nothing\nmakeWord s  =\n  if countVowels s &lt; countConsonants s\n    then Nothing\n    else Just s\n  where counts = let unzipped = unzip (countVowelsAndConsonants s)\n                 in (sum $ fst unzipped, sum $ snd unzipped)\n</code></pre>\n\n<p>and, to be honest, I think this is even worse than what I started off with.</p>\n\n<p>Also, what if I also had to keep track of uppercase and lowercase letters? Then I don't think the tuple approach would scale.</p>\n\n<p>In an imperative language, for example javascript, which I'm more used to, it would be as simple as this to traverse it just once.</p>\n\n\n\n<pre><code>const word        = \"somestring\"\nlet numVowels     = 0\nlet numConsonants = 0\n\nfor (var s of word) isVowel(s) ? numVowels++ : numConsonants++\n</code></pre>\n\n<p>I'm sure Haskell has a way that's just as simple, but unfortunately I'm unfamiliar.</p>\n\n<p>What's the idiomatic way of keeping tabs of multiple properties of a <code>String</code> without having to keep traversing it multiple times?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1457492896, "post_id": 35882098, "comment_id": 59427247, "body": "The exmple return value <code>[1,2,3,4,5]</code> doesn&#39;t have type <code>[[Int]]</code>.  It is not clear to me what you want the return value to be."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457492913, "post_id": 35882098, "comment_id": 59427251, "body": "<code>[1,2,3,4,5]</code> is a list of <code>Int</code>, not a list of list of <code>Int</code>. It&#39;s not clear what <code>linkStep</code> is supposed to be doing."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1457493059, "post_id": 35882098, "comment_id": 59427292, "body": "Oh sorry, typo. I&#39;ve updated the example."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1457500141, "post_id": 35882098, "comment_id": 59429221, "body": "It&#39;s still not clear what you mean by &quot;sequence&quot;, or what <code>linkStep</code> is supposed to do. Assuming <code>links</code> is correct, perhaps you could show a few examples of how <code>linkStep</code> is supposed to operate?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1457512685, "post_id": 35882098, "comment_id": 59434772, "body": "Why should the result be <code>[[1,2,3,4,5],[6,7,8]]</code> and not e.g. <code>[[1,2,3,4],[5,6,7,8]]</code> or <code>[[1,2,3],[4,5,6,7,8]]</code> or even <code>[[1,2],[3,4,5],[6,7],[8]]</code> ? What is the general criterion?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1457538971, "post_id": 35882098, "comment_id": 59453487, "body": "The tuples (1,5) (2,3) (3,4) (4,5) have overlapping elements. (6,7) (7,8) do not (with 1-5)"}], "answers": [{"tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": false, "score": 1, "last_activity_date": 1457499023, "creation_date": 1457499023, "answer_id": 35883134, "question_id": 35882098, "link": "https://stackoverflow.com/questions/35882098/how-do-i-sequence-a-list-of-tuples/35883134#35883134", "title": "How do I sequence a list of tuples?", "body": "<p>There are a couple of issues that I see:</p>\n\n<ol>\n<li><p>In <code>linkStep</code>, you only ever check if your tuple elements are members of the first inner list. From your example, it looks as if you're going to need to check all the lists, not just the first one.</p></li>\n<li><p>In the cases of <code>linkStep</code>, you always add <code>a</code>, <code>b</code>, or both <code>a</code> and <code>b</code> to the first inner list. Thus all elements will eventually end up in the first list. Maybe you meant to create a new list here instead? But it might also be a good place to consider other lists than the first.</p></li>\n</ol>\n\n<p>Hopefully this will help you to make progress.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1457499023, "creation_date": 1457492591, "last_edit_date": 1457493050, "question_id": 35882098, "link": "https://stackoverflow.com/questions/35882098/how-do-i-sequence-a-list-of-tuples", "title": "How do I sequence a list of tuples?", "body": "<p>I'm trying to sequence a list of <code>(Int, Int)</code> tuples into a list of int lists <code>[[Int]]</code></p>\n\n<p>Why? I've found many use cases for this. Basically given a list like so:</p>\n\n<pre><code>[(1,5), (2,3), (3,4), (4,5), (6,7), (7,8)]\n</code></pre>\n\n<p>I want to return a list:</p>\n\n<pre><code>[[1,2,3,4,5],[6,7,8]]\n</code></pre>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>pieces :: [(Int, Int)]\npieces = [(1,5), (2,3), (3,4), (4,5), (6,7), (7,8)]\n\nlinkStep :: [[Int]] -&gt; (Int, Int) -&gt; [[Int]]\nlinkStep (x:xs) (a, b)\n    | elem a x = (b : x) : xs\n    | elem b x = (a : x) : xs\n    | otherwise = (a : b : x) : xs\n\n-- Now I fold the linkStep function over the list\nlinks :: [(Int, Int)] -&gt; [[Int]]\nlinks list = foldl linkStep [[]] list\n</code></pre>\n\n<p>However when I call <code>links</code> with <code>pieces</code> I get</p>\n\n<pre><code>links pieces\n--[[8,6,7,5,4,2,3,1,5]]\n</code></pre>\n\n<p>I'm not really sure what I'm doing wrong. The <code>linkStep</code> function is supposed to concatenate a tuple element that is in the resulting list to the target list in the result. If the tuple element is not yet in the resulting list a new list with the tuple element is added. But its not working... Please help! </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1457487421, "post_id": 35881310, "comment_id": 59425748, "body": "Your <code>fizzBuzz</code> function essentially takes three integer arguments - but <code>getArgs</code> gives you a list of strings. You must convert from string to integer - the quick and dirty way would be <code>fizzBuzz (read a) (read b) (read c)</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1457489655, "post_id": 35881310, "comment_id": 59426349, "body": "I&#39;m confused by your comment, @Mephy. Don&#39;t all of the <code>if</code> expressions have the same type in their <code>then</code> and <code>else</code>, namely <code>IO ()</code>? Which expression doesn&#39;t satisfy that constraint?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6023159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbfdbfc806adf982e42e4182b8a77d41?s=128&d=identicon&r=PG&f=1", "display_name": "Xiphoen", "link": "https://stackoverflow.com/users/6023159/xiphoen"}, "edited": false, "score": 0, "creation_date": 1457588741, "post_id": 35883287, "comment_id": 59476571, "body": "Excellent advice, doing user2407038&#39;s suggestion worked, and this was a great explanation!"}], "tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": false, "score": 1, "last_activity_date": 1457499811, "creation_date": 1457499811, "answer_id": 35883287, "question_id": 35881310, "link": "https://stackoverflow.com/questions/35881310/calling-a-print-function-in-haskell/35883287#35883287", "title": "Calling a print function in Haskell", "body": "<p>When you get stuck like this, it's best to look at the types involved:</p>\n\n<ul>\n<li><p>The fizzBuzz function takes 3 numbers and returns an IO () action</p></li>\n<li><p>The getArgs function has type <code>getArgs :: IO [String]</code></p></li>\n</ul>\n\n<p>This means that in <code>main</code>, <code>div1</code> has type <code>String</code>; <code>div2</code> has type <code>String</code>; and <code>upBound</code> has type <code>String</code>.  You are passing them directly to <code>fizzBuzz</code>, but recall it is expecting numeric arguments!  This is why you get the error about <code>(Integral String)</code>; because numeric arguments can be any one of a <em>class</em> of types, it's telling you it can't find evidence of <code>String</code> being a member of the numeric class it's expecting.</p>\n\n<p>You need to somehow interpret the strings from your command line into numbers. The easiest way to do this is the <code>read</code> method, which has type <code>Read a =&gt; String -&gt; a</code>.  This means that if the type you would like to parse from the string is a member of the \"readable\" class of types, it can take a <code>String</code> and give you an instance of that type.</p>\n"}], "owner": {"reputation": 23, "user_id": 6023159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbfdbfc806adf982e42e4182b8a77d41?s=128&d=identicon&r=PG&f=1", "display_name": "Xiphoen", "link": "https://stackoverflow.com/users/6023159/xiphoen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457499811, "creation_date": 1457487002, "question_id": 35881310, "link": "https://stackoverflow.com/questions/35881310/calling-a-print-function-in-haskell", "title": "Calling a print function in Haskell", "body": "<p>I have a task that requires implementing a looped version of FizzBuzz utilizing command line arguments, comparing 2 divisors to a number, printing Fizz if upBound is divisible by div1, Buzz if upBound is divisible by div2 and the upBound if it isn't divisible by either. I've constructed the function and am able to use that independent of the main function, but in order to compile, I obviously need the main function, which I've tried implementing below</p>\n\n<pre><code>module Main( main ) where\nimport System.Environment\n\nfizzBuzz div1 div2 upBound = do if (upBound - 1) &gt; 1 \n                                then fizzBuzz div1 div2 (upBound - 1)\n                                else print \"\";\n                                if mod (upBound - 1) div1 &gt; 0 &amp;&amp; mod (upBound - 1) div2 &gt; 0\n                                then print (upBound - 1)\n                                else\n                                    print ((if mod (upBound - 1) div1 == 0 then \"Fizz\" else []) ++ (if mod (upBound - 1) div2 == 0 then \"Buzz\" else []))\n\nmain = do\n    [div1,div2,upBound] &lt;- getArgs\n    fizzBuzz div1 div2 upBound\n</code></pre>\n\n<p>I've scoured every tutorial and help site I can find and I just don't know enough about Haskell and it's syntax to determine exactly what is wrong. Currently I get the following error when attempting to compile:</p>\n\n<p>\"fizzbuzz.hs:14:9: No instance for (Integral String) arising from a use of 'fizzBuzz'\"</p>\n\n<p>My expected output for an example is something like</p>\n\n<blockquote>\n  <p>fizzbuzz 2 4 6</p>\n</blockquote>\n\n<p>is</p>\n\n<pre><code>1\nFizz\n3\nFizzBuzz\n5\nFizz\n</code></pre>\n\n<p>Unfortunately I can't seem to locate the right help resources to figure out how to fix the issue and am hoping someone can point me in the right direction.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "vim", "read-eval-print-loop", "archlinux", "ghci"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457488365, "post_id": 35881200, "comment_id": 59425999, "body": "After you <code>:set editor vi</code>, what happens when you try to <code>:edit</code> a file? What do you mean &quot;to no effect&quot;?"}, {"owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457489464, "post_id": 35881200, "comment_id": 59426297, "body": "I do not mean to edit a file. &quot;To no effect&quot; means I can&#39;t get vi editing mode to work in GHCi, like it does not work when I press ESC to get into command mode to navigate/edit a text. In Bash shell i can do it."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1457490080, "post_id": 35881200, "comment_id": 59426453, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1825547/how-to-customize-the-readline-keybindings-of-ghci\">How to customize the readline keybindings of ghci</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457500397, "post_id": 35881200, "comment_id": 59429335, "body": "there is some <i>VI editing mode</i> in GHCi? ... Or are you talking about setting up some GHCi REPL support for VI?"}, {"owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457501645, "post_id": 35881200, "comment_id": 59429804, "body": "@Carsten yes there is"}], "answers": [{"comments": [{"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1573672098, "post_id": 35883574, "comment_id": 103961674, "body": "I&#39;ve just started using it and I noticed that the <code>;</code> and <code>,</code> commands to repeat <code>f</code> or <code>F</code> commands in one or the other direction do not work..."}, {"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 1, "creation_date": 1573673860, "post_id": 35883574, "comment_id": 103962467, "body": "<a href=\"https://github.com/judah/haskeline/issues/60\" rel=\"nofollow noreferrer\">Issue #60</a> on GitHub is just about this."}], "tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": true, "score": 29, "last_activity_date": 1597512363, "last_edit_date": 1597512363, "creation_date": 1457501127, "answer_id": 35883574, "question_id": 35881200, "link": "https://stackoverflow.com/questions/35881200/set-vi-as-editor-in-ghci/35883574#35883574", "title": "Set vi as editor in GHCi", "body": "<p>GHCi now uses the <a href=\"https://hackage.haskell.org/package/haskeline\" rel=\"noreferrer\">Haskeline</a> library for command line editing (which has been true for quite a while now), and it does indeed have a vi mode. The configuration file is <code>~/.haskeline</code> and the line you want is:</p>\n<pre><code>editMode: Vi\n</code></pre>\n<p>Documented here: <a href=\"https://github.com/judah/haskeline/wiki/UserPreferences\" rel=\"noreferrer\">https://github.com/judah/haskeline/wiki/UserPreferences</a></p>\n"}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2635, "favorite_count": 2, "accepted_answer_id": 35883574, "answer_count": 1, "score": 18, "last_activity_date": 1597512363, "creation_date": 1457486304, "last_edit_date": 1457489528, "question_id": 35881200, "link": "https://stackoverflow.com/questions/35881200/set-vi-as-editor-in-ghci", "title": "Set vi as editor in GHCi", "body": "<p>How can I get vi editing mode to work in GHCi?</p>\n\n<p>I'm using version 7.10.3.</p>\n\n<p>I tried <code>Prelude&gt; :set editor vi</code>, but to no effect.</p>\n\n<p>I also have these lines in my <code>~/.inputrc</code>.</p>\n\n<pre><code>set editing-mode vi\nset keymap vi\n</code></pre>\n\n<p>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457478795, "post_id": 35879821, "comment_id": 59423066, "body": "yes that relates to <code>forall</code> as this keyword explicitly marks a scope - but I still believe the scope is only marked inside a function body and not the where clause, but I am no expert on <code>forall</code>."}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1457501774, "post_id": 35879821, "comment_id": 59429862, "body": "@epsilonhalbe has the right answer for you; you need the combination of <code>forall</code> and the <code>ScopedTypeVariables</code> extension. The explicit <code>forall</code> has other uses as well (via other extensions) such as creating existential types, or just to be explicit."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457513737, "post_id": 35879821, "comment_id": 59435359, "body": "I recommend <i>always</i> using <code>ScopedTypeVariables</code>."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457524876, "post_id": 35879821, "comment_id": 59442898, "body": "@dfeuer Can you explain why? (Also out of curiosity, what other extensions do you recommend always using, if any?)"}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "reply_to_user": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1457524947, "post_id": 35879821, "comment_id": 59442951, "body": "@LeviPearson But he didn&#39;t show code on how to use the <code>forall</code> with the <code>instance</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457538104, "post_id": 35879821, "comment_id": 59452808, "body": "@haskellHQ, <code>ScopedTypeVariables</code> brings some things into scope without that; maybe this is such a case? I think it brings into scope things that intuitively should be. I also expect its behavior when I write <code>forall</code>. It&#39;s invaluable for fixing type errors, etc. There aren&#39;t any other extensions I reflexively add all over the place, but <code>PolyKinds</code> is becoming more and more important."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 8, "last_activity_date": 1457478579, "creation_date": 1457478579, "answer_id": 35879873, "question_id": 35879821, "link": "https://stackoverflow.com/questions/35879821/why-cant-i-provide-a-type-within-a-typeclass-instance/35879873#35879873", "title": "Why can&#39;t I provide a type within a typeclass instance?", "body": "<p>the type checker does not know that the <code>a</code> in the last line is the same as the <code>a</code> given in the one above it, inside the <code>where</code> clause you have a new scope!</p>\n\n<p>If you want to turn that off (getting new scopes) you need to enable <code>ScopedTypeVariables</code> which you can do by adding</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n</code></pre>\n\n<p>to the top of your source file</p>\n\n<p>or type <code>:set -XScoped\u2026</code> inside ghci.</p>\n\n<p>or call ghci with that <code>ghci -XScoped\u2026 myfile.hs</code></p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457551701, "post_id": 35900489, "comment_id": 59462124, "body": "This works even without the <code>forall</code> keyword, as long as <code>ScopedTypeVariables</code> is active. I&#39;m not sure if this is intentional or a bug,  but it is true."}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1457553964, "post_id": 35900489, "comment_id": 59463467, "body": "I noticed that while testing the code as I wrote the answer; I just barely looked up the reason and updated the answer, though."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1457641469, "post_id": 35900489, "comment_id": 59511429, "body": "I have two more questions: What did you do, and how did you do it? :) All this knowledge... astounding! Final questions: What percentage of professional Haskell programmers actually know even half of what you wrote? Is this something every professional Haskell programmer should eventually learn?"}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 1, "creation_date": 1457663923, "post_id": 35900489, "comment_id": 59520306, "body": "Professional Haskell programmers don&#39;t really need to know the historical details; the bits they do need to know are mostly in the GHC manual links I provided and the rest of the relevant details would be picked up from coworkers or books.  I am mostly a professional C programmer in networking and embedded systems, so I can&#39;t speak to the general knowledge level of this sort of thing among Haskell developers. I am probably abnormally interested in the historical development of functional programming, though."}], "tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": true, "score": 3, "last_activity_date": 1457553907, "last_edit_date": 1457553907, "creation_date": 1457550580, "answer_id": 35900489, "question_id": 35879821, "link": "https://stackoverflow.com/questions/35879821/why-cant-i-provide-a-type-within-a-typeclass-instance/35900489#35900489", "title": "Why can&#39;t I provide a type within a typeclass instance?", "body": "<p>You're correct that the resolution to this has to do with the <code>forall</code> keyword. The reason requires a bit of explanation, though. If you don't care for quite that much explanation, go ahead and skip to the end. If you still want more, see the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html\" rel=\"nofollow\">Syntax Extensions</a> and <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/other-type-extensions.html\" rel=\"nofollow\">Other Type System Extensions</a> sections of the GHC Manual.</p>\n\n<p>Type declarations in Haskell that are parameterized by a type variable, such as <code>data Heh a = Heh a</code>, are essentially creating a type-level function (a type constructor) that takes a type as input and returns a new type. The \"kind\" of <code>Heh</code> (a kind is how we classify types, like types are how we classify values) is <code>* -&gt; *</code> while <code>Int</code> is of kind <code>*</code> and <code>Heh Int</code> (the <code>Heh</code> type constructor applied to the type <code>Int</code>) is of kind <code>*</code> as well. So a <code>* -&gt; *</code> applied to a <code>*</code> gives another <code>*</code>, which is the kind of normal types.</p>\n\n<p>Variables, whether they be at the value level or the type level, must be <em>bound</em> by some <em>binding form</em>, which defines the scope (region of the program text where the binding of name to specific variable is in effect) of the binding. At the value level, we're used to seeing these binders all over the place: some examples are the argument bindings in function definition patterns, the bindings in <code>let</code> expressions, and the bindings in lambda expressions (e.g. <code>\\x -&gt; x</code> binds the name <code>x</code> within the body of the expression).</p>\n\n<p>The confusion begins with type-level variables; they appear to have no binder at all, they're just <em>there</em> in the middle of type declarations. This is largely because Haskell's type system descends from the Hindley-Milner type system, which didn't originally have type annotations at all and used a somewhat different way of thinking about expressions that could take on multiple types. As notions of polymorphic types became more formalized, \"polytyped\" values from Hindley-Milner became \"polymorphic\" and the syntactically-typed version of the theory included type-level binders and corresponding value-level binders that would take a <em>type</em> and return an expression with the type substituted in the body of the expression for the type variable. Because these binders are resolved completely at compile time, they were left out of both the type- and value-level syntax. Since in the original system the binders can only ever occur in one position in a type declaration, there's no ambiguity there.</p>\n\n<p>If you didn't follow all that, don't worry about it; the gist is that things worked out the way they did for historical reasons as the underlying concepts and the way they were implemented in typed functional languages evolved.</p>\n\n<p>Anyway, the <code>forall</code> is the type-level variable binder, sort of like a lambda expression is a value-level variable binder. Without it, it is assumed that there's an implicit <code>forall</code> at the beginning of each type-level expression that binds all the free type variables. Explicitly binding the type variables makes it clearer that they're \"universally-quantified\" (see an intro to first-order logic if you're not familiar with the concept of universal quantification) and also opens the possibility of making \"existentially-quantified\" and higher-ranked polymorphic type variables (with the <code>RankNTypes</code> extension) as well. This may seem odd, since existential quantification is usually expressed via an \"exists\" binder, but if you put a <code>forall a</code> inside a <code>data</code> type declaration that doesn't bring the <code>a</code> into scope itself (e.g. <code>data Foo b = forall a. Foo (a, a -&gt; b)</code>) you get the same effect as an existential quantification on <code>a</code> (assuming you enable the <code>ExistentialQuantification</code> extension, of course).</p>\n\n<p>But what you're really concerned about is how to increase the scope of your type variable quantification to the entire <code>instance</code> declaration; this is what the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/other-type-extensions.html#scoped-type-variables\" rel=\"nofollow\"><code>ScopedTypeVariables</code></a> extension is for. As I said before, the Hindley-Milner type system originally didn't use the notion of bound and free type variables (there were type schemes (or polytypes) and monotypes, which played roles in a logical resolution algorithm) or even type annotations. When type annotations were first added in, they stood for \"unknown monotypes\" and referred to just the particular expression being annotated rather than being a scoped binding construct like a <code>forall</code> or lambda. Therefore, they were subject to renaming if the same name happened to show up more than once in a type environment. By turning on <code>ScopedTypeVariables</code>, any type variable expressed in the scope of an explicit <code>forall</code> binding that binds the same name is no longer an unknown monotype variable (i.e. \"rigid type variable\" from your error message) but instead a reference to the bound type variable of the same name in the nearest enclosing type binder for that name.</p>\n\n<p>Anyway, here's the end result required to resolve your conundrum:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\ndata Heh a = Heh a\ninstance forall a. (Eq a) =&gt; Eq (Heh a) where\n   (Heh a1) == (Heh a2) = (a1 :: a) == a2\n</code></pre>\n\n<p>The scope of the <code>forall</code> in the instance declaration extends throughout the instance declaration, and since <code>ScopedTypeVariables</code> is active, the reference to <code>a</code> in the type annotation on <code>a1</code> refers to the same <code>a</code> in the <code>forall</code> binding.</p>\n\n<p>If you look at the documentation, you'll find there are a few other syntactic constructs that bind type variables as well. In this case, <code>forall</code> is not actually necessary because the class and instance variables in the head of <code>class</code> and <code>instance</code> declarations automatically bind the type variables in the same manner as <code>forall</code> does when the extension is active. But if you have a standalone function with a type declaration that needs to be scoped across the whole body of the function, you'll need to know how to use <code>forall</code> to get the type variable scoping you want.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 1, "accepted_answer_id": 35900489, "answer_count": 2, "score": 1, "last_activity_date": 1457553907, "creation_date": 1457478310, "question_id": 35879821, "link": "https://stackoverflow.com/questions/35879821/why-cant-i-provide-a-type-within-a-typeclass-instance", "title": "Why can&#39;t I provide a type within a typeclass instance?", "body": "<p>This code works fine as expected:</p>\n\n<pre><code>data Heh a = Heh a\ninstance (Eq a) =&gt; Eq (Heh a) where\n    (Heh a1) == (Heh a2) = a1 == a2\n</code></pre>\n\n<p>Yet this gives an error:</p>\n\n<pre><code>data Heh a = Heh a\ninstance (Eq a) =&gt; Eq (Heh a) where\n    (Heh a1) == (Heh a2) = (a1 :: a) == a2\n    -- Error: Couldn't match expected type \u2018a1\u2019 with actual type \u2018a\u2019\n    --        ...\n</code></pre>\n\n<p>The only change is adding the <code>:: a</code>.</p>\n\n<p>But why would this fail? Isn't <code>a1</code> indeed <code>a</code>? What else could it possibly be?</p>\n\n<p>How does this relate to <code>forall</code>? I understand Haskell has a <code>forall</code> keyword to deal with this somehow. (By the way, if that won't be possible until GHC 8.0, feel free to let me know how to do it in the upcoming GHC 8.0 then.)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457474109, "post_id": 35878782, "comment_id": 59420891, "body": "<code>(&#47;)</code> is part of <code>Fractional</code>, not <code>Num</code>. I&#39;m having a rather hard time to decipher your question, tbh."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5960886"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457474658, "post_id": 35878782, "comment_id": 59421201, "body": "@Zeta I altered the text to make it clearer, but I am starting to think this might be a duplicate of <a href=\"http://stackoverflow.com/questions/8154722/haskell-how-to-make-div-or-simply-in-instance?rq=1\" title=\"haskell how to make div or simply in instance\">stackoverflow.com/questions/8154722/&hellip;</a>  or at least similar to it."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457474737, "post_id": 35878782, "comment_id": 59421245, "body": "if in doubt just open up GHCi and ask (for example <code>:i (&#47;)</code> it will tell you what class to implement"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457475170, "post_id": 35878782, "comment_id": 59421477, "body": "OT: you know that you will have a hard time making the ordering compatible with your addition/multiplication? (meaning you will not get an <a href=\"https://en.wikipedia.org/wiki/Ordered_ring\" rel=\"nofollow noreferrer\">ordered ring</a>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5960886"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457475911, "post_id": 35878782, "comment_id": 59421843, "body": "@Carsten No, I didn&#39;t know I am just starting to learn haskell so there are quite a few elements I don&#39;t know about it yet. If you have a reference that I can read to ensure I get an ordered ring and I will definitely do so."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457500055, "post_id": 35878782, "comment_id": 59429180, "body": "@user5960886 it&#39;s not really a Haskell thing (that&#39;s why I did put the <b>O</b>ff<b>T</b>opic there) - it&#39;s a math problem - if you define your operations element-wise then <code>(0,0)</code> and <code>(1,1)</code> will be the additive and multiplicative identities and both <code>(0,1)</code> and <code>(1,0)</code> will be <code>&gt; (0,0)</code> - but as in an ordered list you have <code>a &gt; b, c &gt; 0 =&gt; a*c &gt; b*c</code> you run into trouble with this: (example <code>(1,0) &gt; (0,1)</code> but <code>(1,0) * (0,1) = (0,0)</code>, <code>(0,1) * (0,1) = (0,1)</code> and <code>(0,0) &lt; (0,1)</code>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457500262, "post_id": 35878782, "comment_id": 59429259, "body": "@user5960886 you probably don&#39;t have to care but I found it strange that you want to implement <i>Ord</i> + <i>Num</i>  as I had the feeling you wanted to do math"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1457474850, "post_id": 35878962, "comment_id": 59421313, "body": "This kind of misses the question given in the title. It&#39;s not about overloading, but how user59...whatshisname can find out <i>which</i> instance needs to be written. You can still copy Carsten&#39;s comment, though."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457474995, "post_id": 35878962, "comment_id": 59421381, "body": "@Zeta Okay, I&#39;ve addressed that portion of the question now I think. Thanks for pointing out that I had missed that concern."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1457474968, "last_edit_date": 1457474968, "creation_date": 1457474721, "answer_id": 35878962, "question_id": 35878782, "link": "https://stackoverflow.com/questions/35878782/how-choose-which-classes-to-make-an-instance-of-when-overloading-operators-in-ha/35878962#35878962", "title": "How choose which classes to make an instance of when overloading operators in haskell?", "body": "<p>I think I'd probably write something like this:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\nimport Control.Applicative\n\ndata Pair a = Pair a a deriving (Eq, Ord, Read, Show, Functor)\ninstance Applicative Pair where\n    pure v = Pair v v\n    Pair f g &lt;*&gt; Pair x y = Pair (f x) (g y)\n\ninstance Num a =&gt; Num (Pair a) where\n    (+) = liftA2 (+)\n    (-) = liftA2 (-)\n    (*) = liftA2 (*)\n    negate = liftA negate\n    abs    = liftA abs\n    signum = liftA signum\n    fromInteger = pure . fromInteger\n\ninstance Fractional a =&gt; Fractional (Pair a) where\n    (/) = liftA2 (/)\n    recip = liftA recip\n    fromRational = pure . fromRational\n</code></pre>\n\n<p>You can learn which class a particular operation is related to by looking at its type:</p>\n\n<pre><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Hence if you want to support <code>(/)</code>, you should look into implementing the <code>Fractional</code> class.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1457480068, "last_edit_date": 1495535322, "creation_date": 1457478356, "answer_id": 35879829, "question_id": 35878782, "link": "https://stackoverflow.com/questions/35878782/how-choose-which-classes-to-make-an-instance-of-when-overloading-operators-in-ha/35879829#35879829", "title": "How choose which classes to make an instance of when overloading operators in haskell?", "body": "<h2>Some preliminary ranting</h2>\n\n<p>Generally in Haskell, you should avoid thinking of &ldquo;overloading an operator&rdquo;. Type classes are more than syntax for overloading operators; rather think of them as <em>abstract axiomatisations of data types</em>. Now if that sounds scary forget the word axiom and consider an example.</p>\n\n<p>A <em>number type</em> <code>N</code> is a type whose values <code>a</code>, <code>b</code>, <code>c</code>... fulfill properties (<em>laws</em>) such as</p>\n\n<pre><code>a + 0 = a\na * 1 = a\na + (b + c) = (a + b) + c\nabs a * signum a = a\n</code></pre>\n\n<p>It is properties like these which allow you to truely write num-polymorphic code (i.e. that'll work with <em>any</em> numerical type) and still be certain that you'll get meaningful results in the end for all of them. That really is the power of overloading. Just being able to re-use a nice short identifier such as <code>+</code> may be handy in itself, but really wouldn't gain you much over custom operators like <code>+.</code> for specialised num types (that's <a href=\"https://stackoverflow.com/questions/8017172/why-is-ocamls-not-polymorphic\">how O'Caml does it</a>).</p>\n\n<p>Now, for such laws to be formulable, you need to have <em>all</em> these operators available, and that's why we have classes which require us to not just overload whichever operator we fancy right now, but a whole coherent group of them.</p>\n\n<h2>Start reading here if you haven't already...</h2>\n\n<p>Classes aren't some special built-in magic. You can easily define your own classes<sup>&dagger;</sup>, or, for standard classes like <code>Num</code>, look up where they're defined. The easiest way to find class definitions (or any other library declarations) is the <a href=\"http://hayoo.fh-wedel.de/?query=%2B\" rel=\"nofollow noreferrer\">Hayoo seatch engine</a>. It will for e.g. <code>+</code> guide you right away to <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:-43-\" rel=\"nofollow noreferrer\">the <code>(+) :: a -&gt; a -&gt; a</code> Class Method on hackage</a>. There you see how <code>+</code> is contained in</p>\n\n<pre><code>class  Num a  where\n    {-# MINIMAL (+), (*), abs, signum, fromInteger, (negate | (-)) #-}\n    (+), (-), (*)       :: a -&gt; a -&gt; a\n    negate              :: a -&gt; a\n    abs                 :: a -&gt; a\n    signum              :: a -&gt; a\n    fromInteger         :: Integer -&gt; a\n</code></pre>\n\n<p>So if you want to overload the <code>+</code> operator you'll need to define all<sup>&ddagger;</sup> of <code>(+)</code>, <code>(-)</code>, <code>(*)</code>, <code>negate</code>, <code>abs</code>, <code>signum</code> and <code>fromInteger</code>.</p>\n\n<h2>Whoa, but maybe you didn't even want something like <code>abs</code>!</h2>\n\n<p>Very reasonable. But then your type is evidently not really a number type! IMO you shouldn't make anything a <code>Num</code> instance that's not just a representation of a single number. Note that there are simpler classes available: you probably want <a href=\"http://hackage.haskell.org/package/vector-space-0.10.2/docs/Data-AdditiveGroup.html\" rel=\"nofollow noreferrer\">AdditiveGroup</a></p>\n\n<pre><code>class AdditiveGroup v where\n  zeroV :: v\n  (^+^) :: v -&gt; v -&gt; v\n  negateV :: v -&gt; v\n  (^-^) :: v -&gt; v -&gt; v\n</code></pre>\n\n<p>This is a class for more general <em>vector spaces</em>. You can easily make your type an instance:</p>\n\n<pre><code>instance AdditiveGroup Pair where\n  zeroV = Pair (0,0)\n  Pair (a,b) ^+^ Pair (c,d) = Pair (a+c, b+d)\n  Pair (a,b) ^-^ Pair (c,d) = Pair (a-c, b-d)\n  negateV (Pair (a,b)) = Pair (-a ,-b)\n</code></pre>\n\n<p>You notice that this class doesn't have a multiplication. Well, it turns out that mathematically, multiplication doesn't really make all that much sense on tuples. There are <em>other</em> kind of multiplications though (scalar multiplications) that make sense on vector spaces. Browse the <a href=\"http://hackage.haskell.org/package/vector-space-0.10.2\" rel=\"nofollow noreferrer\">documentation of the vector-space package</a>.</p>\n\n<h2>On a different note</h2>\n\n<p>Also consider whether you even need AdditiveGroup instance. Daniel Wagner uses <a href=\"https://stackoverflow.com/a/35878962/745903\">in his answer</a> a class that's way more general than numbers, and can be used for all kinds of container-types. Argumably, your <code>Pair</code> is more of a <em>container for numbers</em>, than a number per se. Therefore, I recommend only implementing</p>\n\n<pre><code>data Pair a = Pair a a\ninstance Functor Pair where\n  fmap f (Pair x y) = Pair (f x) (f y)\ninstance Applicative Pair where\n    pure v = Pair v v\n    Pair f g &lt;*&gt; Pair x y = Pair (f x) (g y)\n</code></pre>\n\n<p><code>Functor</code> is really simple: it allows you to apply a function to all elements in a container. <code>Applicative</code> basically allows you to cross-apply functions between two containers.</p>\n\n<p>With these instances you can, instead of using numerical operators directly, add pairs by writing <code>liftA2 (+) (Pair 1 2) (Pair 3 4)</code> whenever you need that operation. A bit more verbose, but also a good deal more explicit!</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Frankly, it's better not to do that too often though. Classes as I said are meant to represent deep mathematical axiomatisations; this is not possible for anything that <em>OO programmers</em> would write a class for. Nor is it necessary to write custom classes all the time: <code>data</code> alone can get you pretty far in a functional language.</sub></p>\n\n<p><sup>&ddagger;</sup><sub>Actually it's sufficient to implement <em>either</em> <code>(-)</code> <em>or</em> <code>negate</code>. That's what the <code>MINIMAL</code> pragma tells you.</sub></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5960886"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 35879829, "answer_count": 2, "score": 1, "last_activity_date": 1457480068, "creation_date": 1457474013, "last_edit_date": 1457474880, "question_id": 35878782, "link": "https://stackoverflow.com/questions/35878782/how-choose-which-classes-to-make-an-instance-of-when-overloading-operators-in-ha", "title": "How choose which classes to make an instance of when overloading operators in haskell?", "body": "<p>I am currently trying to overload the basic math operators (+,-,*,/, negate) and ordering operators (&lt;,>, >=, &lt;=, ==) for the made up data type Pair. Currently, I have an instance of num which requires me to overload its visible members, but I am having hard time figuring out if I need to make multiple instances of different classes like Fractional, Ord, and so forth, or if there is a better method to overload these specific operators. </p>\n\n<p>Code Example:</p>\n\n<pre><code> data Pair = Pair (Int, Int) deriving (Eq, Show)\n instance Num Pair where\n    Pair (a,b) + Pair (c,d) = Pair (a+c,b+d)\n    Pair (a,b) * Pair (c,d) = Pair (a*c,b*d)\n    Pair (a,b) - Pair (c,d) = Pair (a-c,b-d)\n    Pair (a,b) / Pair (c,d) = Pair  (a/c , b/d) // throws an error for this line.\n    abs    (Pair (a,b)) = Pair (abs a,    abs b) \n    signum (Pair (a,b)) = Pair (signum a, signum b) \n    fromInteger i = Pair (fromInteger i, fromInteger i)\n</code></pre>\n"}, {"tags": ["haskell", "introspection"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1457474351, "post_id": 35878282, "comment_id": 59421021, "body": "What is <code>[(&quot;username&quot;, String), (&quot;password&quot;, String)]</code>? A type level list of pairs? Did you mean <code>[(&quot;username&quot;, &quot;String&quot;), (&quot;password&quot;, &quot;String&quot;)]</code> or something similar?"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457479529, "post_id": 35878282, "comment_id": 59423323, "body": "@Zeta I mean a string would work OK, but I phrased it that way because it could also be a more meaningful type. Such as something similar to <code>Data.Data.Constr</code> which can be inspected with other functions from <code>Data.Data</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457498237, "post_id": 35880558, "comment_id": 59428610, "body": "It should be noted that <code>Typeable</code> is likely to change <i>substantially</i> in GHC 8.2, and this may well need to be changed then."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1457543585, "post_id": 35880558, "comment_id": 59456838, "body": "Thank you! Would you mind showing me how you can also get the names of the fields. I know my example got those but I would love to be able to do it without creating an instance. Also how does this even work? When I do <code>:t</code> it says it is looking for a <code>Typeable a</code> but I thought the constructor was a function and the instance was the <code>Typeable a</code>, yet it lets me pass in the constructor."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1457548848, "post_id": 35880558, "comment_id": 59460285, "body": "@semicolon edited to show that portion of the solution. As to how it works,  we are using Typeable to get the type <i>of the constructor function</i> then inducting on it to turn it into a list of its arguments."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1457561500, "post_id": 35880558, "comment_id": 59467718, "body": "@sclv Alright that makes a lot of sense thanks. Also I realized that you don&#39;t actually need to derive Typeable, as it is the fact that Foo is a function and functions derive Typeable that makes the whole thing work, which makes a lot of sense, as I was still pretty confused about that whole thing. And the undefined cheat is pretty sweet."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 3, "last_activity_date": 1457548780, "last_edit_date": 1457548780, "creation_date": 1457482199, "answer_id": 35880558, "question_id": 35878282, "link": "https://stackoverflow.com/questions/35878282/haskell-get-types-of-data-constructor/35880558#35880558", "title": "Haskell get types of Data Constructor", "body": "<p>I just knocked out a function using <code>Data.Typeable</code> that lets you turn a constructor into a list of the <code>TypeRep</code>s of its arguments. In conjunction with the <code>constrFields</code> you found you can zip them together to get your desired result:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\n\nmodule Foo where\nimport Data.Typeable\nimport Data.Typeable.Internal(funTc)\n\ngetConsArguments c = go (typeOf c)\n   where go x = let (con, rest) = splitTyConApp x    \n                in if con == funTc         \n                   then case rest of (c:cs:[]) -&gt; c : go cs\n                                     _ -&gt; error \"arrows always take two arguments\"\n                   else []                      \n</code></pre>\n\n<p>given <code>data Foo = Foo {a :: String, b :: Int} deriving Typeable</code>, we get</p>\n\n<pre><code>*&gt; getConsArguments Foo\n[[Char],Int]\n</code></pre>\n\n<p>As one would hope.</p>\n\n<hr>\n\n<p>On how to get the field names without using a populated data type value itself, here is a solution:</p>\n\n<pre><code>constrFields . head . dataTypeConstrs $ dataTypeOf (undefined :: Foo)\n</code></pre>\n"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "accepted_answer_id": 35880558, "answer_count": 1, "score": 3, "last_activity_date": 1457548780, "creation_date": 1457472178, "last_edit_date": 1457472298, "question_id": 35878282, "link": "https://stackoverflow.com/questions/35878282/haskell-get-types-of-data-constructor", "title": "Haskell get types of Data Constructor", "body": "<p>I was wondering if given a constructor, such as:</p>\n\n<pre><code>data UserType = User\n  { username :: String\n  , password :: String\n  } -- deriving whatever necessary\n</code></pre>\n\n<p>What the easiest way is for me to get something on the lines of <code>[(\"username\", String), (\"password\", String)]</code>, short of just manually writing it. Now for this specific example it is fine to just write it but for a complex database model with lots of different fields it would be pretty annoying.</p>\n\n<p>So far I have looked through <code>Typeable</code> and <code>Data</code> but so far the closest thing I have found is:</p>\n\n<pre><code>user = User \"admin\" \"pass\"\nconstrFields (toConstr user)\n</code></pre>\n\n<p>But that doesn't tell me the types, it just returns <code>[\"username\", \"password\"]</code> and it also requires that I create an instance of User.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1457471654, "post_id": 35878018, "comment_id": 59419605, "body": "Hmm. <code>IntersectOSList &#39;[] list2 = list2</code> looks like a dodgy base case to me. Is there more to it?"}, {"owner": {"reputation": 597, "user_id": 512596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce84bd6e6f9723451f1daf95a6670874?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/512596/joey"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1457471663, "post_id": 35878018, "comment_id": 59419614, "body": "I stared at this too long seeing nothing, but just noticed that ElemOSList&#39;s type family is wrong.  The first parameter, in particular."}, {"owner": {"reputation": 597, "user_id": 512596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce84bd6e6f9723451f1daf95a6670874?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/512596/joey"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1457471691, "post_id": 35878018, "comment_id": 59419634, "body": "and yes, base case is wrong"}, {"owner": {"reputation": 597, "user_id": 512596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce84bd6e6f9723451f1daf95a6670874?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/512596/joey"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1457471762, "post_id": 35878018, "comment_id": 59419666, "body": "So, the thing I wasn&#39;t getting is, this sort of type error when working with type families means that the type checker has found a problem, not that the type checker is insuffiently intelligent."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457473995, "post_id": 35878018, "comment_id": 59420830, "body": "@Joey: You can answer your own questions if you found a solution (<code>type family ElemOSList (a :: b) (list :: [b]) :: Bool</code> fixed it in my case). By the way, <code>If cnd True els</code> is <code>cnd || els</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457478325, "post_id": 35878018, "comment_id": 59422885, "body": "There&#39;s a package for extensible effects that does a lot of stuff like this (specifically, I remember it takes type-level unions). You may want to look at it for inspiration."}], "answers": [{"tags": [], "owner": {"reputation": 597, "user_id": 512596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce84bd6e6f9723451f1daf95a6670874?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/512596/joey"}, "is_accepted": false, "score": 2, "last_activity_date": 1457475746, "creation_date": 1457475746, "answer_id": 35879210, "question_id": 35878018, "link": "https://stackoverflow.com/questions/35878018/how-to-write-an-intersection-function-for-type-level-lists/35879210#35879210", "title": "how to write an intersection function for type-level lists", "body": "<p>The main fix is as follows:</p>\n\n<pre><code>- type family ElemOSList a (list :: [b]) :: Bool\n+ type family ElemOSList (a :: SupportedOS) (list :: [SupportedOS]) :: Bool\n</code></pre>\n\n<p>Also as noted there was a wrong base case.</p>\n\n<p>Here's the fixed up code:</p>\n\n<pre><code>type family IntersectOSList (list1 :: [a]) (list2 :: [a]) :: [a]\ntype instance IntersectOSList '[] list2 = '[]\ntype instance IntersectOSList (a ': rest) list2 = \n    If (ElemOSList a list2)\n            (a ': IntersectOSList rest list2)\n            (IntersectOSList rest list2)\n\ntype family ElemOSList (a :: SupportedOS) (list :: [SupportedOS]) :: Bool\ntype instance ElemOSList a '[] = False\ntype instance ElemOSList a (b ': bs) = a == b || ElemOSList a bs\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 512596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce84bd6e6f9723451f1daf95a6670874?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/512596/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1457475746, "creation_date": 1457471242, "question_id": 35878018, "link": "https://stackoverflow.com/questions/35878018/how-to-write-an-intersection-function-for-type-level-lists", "title": "how to write an intersection function for type-level lists", "body": "<p>I'm working on type-level lists of operating systems, and I wrote two type-level functions, one to combine two lists, and the other to take their intersection. I'm having trouble getting the intersection function to work right.</p>\n\n<p>(ghc 7.10.3)</p>\n\n<p>Here's the combine function, working as expected:</p>\n\n<pre><code>*Main&gt; (combineSupportedOS debian freeBSD)  :: OSList '[OSDebian, OSFreeBSD]\nOSList [OSDebian,OSFreeBSD]\n</code></pre>\n\n<p>Here's the intersection function, not quite working:</p>\n\n<pre><code>*Main&gt; (intersectSupportedOS debian debian)  :: OSList '[OSDebian]\nCouldn't match expected type \u2018IntersectOSList ['OSDebian] '['OSDebian]\u2019\n            with actual type \u2018'['OSDebian]\u2019\n</code></pre>\n\n<p>How can I convince the type checker that this is well typed?</p>\n\n<p>Full code:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators, PolyKinds, DataKinds, TypeFamilies, UndecidableInstances #-}\n\nimport Data.Typeable\nimport Data.String\nimport Data.Type.Bool\nimport Data.Type.Equality\n\ndata SupportedOS = OSDebian | OSFreeBSD\n    deriving (Show, Eq)\n\ndata OSList (os :: [SupportedOS]) = OSList [SupportedOS]\n    deriving (Show, Eq)\n\ndebian :: OSList '[OSDebian]\ndebian = typeOS OSDebian\n\nfreeBSD :: OSList '[OSFreeBSD]\nfreeBSD = typeOS OSFreeBSD\n\ntypeOS :: SupportedOS -&gt; OSList os\ntypeOS o = OSList [o]\n\ncombineSupportedOS\n    :: (r ~ ConcatOSList l1 l2)\n    =&gt; OSList l1\n    -&gt; OSList l2\n    -&gt; OSList r\ncombineSupportedOS (OSList l1) (OSList l2) = OSList (l1 ++ l2)\n\ntype family ConcatOSList (list1 :: [a]) (list2 :: [a]) :: [a]\ntype instance ConcatOSList '[] list2 = list2\ntype instance ConcatOSList (a ': rest) list2 = a ': ConcatOSList rest list2\n\nintersectSupportedOS\n    :: (r ~ IntersectOSList l1 l2)\n    =&gt; OSList l1\n    -&gt; OSList l2\n    -&gt; OSList r\nintersectSupportedOS (OSList l1) (OSList l2) = OSList (filter (`elem` l2) l1)\n\ntype family IntersectOSList (list1 :: [a]) (list2 :: [a]) :: [a]\ntype instance IntersectOSList '[] list2 = list2\ntype instance IntersectOSList (a ': rest) list2 = \n    If (ElemOSList a list2)\n        (a ': IntersectOSList rest list2)\n        (IntersectOSList rest list2)\n\ntype family ElemOSList a (list :: [b]) :: Bool\ntype instance ElemOSList a '[] = False\ntype instance ElemOSList a (b ': bs) = \n    If (a == b)\n        True\n        (ElemOSList a bs)\n\ntype family EqOS (a :: SupportedOS) (b :: SupportedOS) where\n    EqOS a a = True\n    EqOS a b = False\ntype instance a == b = EqOS a b\n</code></pre>\n"}, {"tags": ["haskell", "monoids", "semigroup"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 5, "creation_date": 1457469104, "post_id": 35877261, "comment_id": 59418219, "body": "It doesn&#39;t seem like you actually have a monoid here, to be honest.  There <i>isn&#39;t</i> an identity element."}, {"owner": {"reputation": 22825, "user_id": 992687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0Da71.png?s=128&g=1", "display_name": "The Unfun Cat", "link": "https://stackoverflow.com/users/992687/the-unfun-cat"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1457500494, "post_id": 35877261, "comment_id": 59429372, "body": "Strange. Implementing a monoid for it is an exercise from the Haskell book, <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">haskellbook.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1457469879, "creation_date": 1457469879, "answer_id": 35877647, "question_id": 35877261, "link": "https://stackoverflow.com/questions/35877261/mempty-with-different-definition-depending-on-whether-mempty-is-left-or-right-ar/35877647#35877647", "title": "mempty with different definition depending on whether mempty is left or right arg?", "body": "<p>There is a perfectly good (and simpler) semigroup which always takes its first argument:</p>\n\n<pre><code>newtype FirstS a = FirstS a\ninstance Semigroup (FirstS a) where\n    a &lt;&gt; b = a\n</code></pre>\n\n<p>Unfortunately, it is not a monoid because -- except for trivial choices of wrapped type -- there is no left identity of this operation. The standard <code>First</code> type patches <code>FirstS</code> by adding a distinguished identity element, thus:</p>\n\n<pre><code>newtype First a = First (Maybe a)\ninstance Semigroup (First a) where\n    First Nothing &lt;&gt; b = b\n    a &lt;&gt; First Nothing = a\n    a &lt;&gt; b = a -- this clause is exactly as before\n</code></pre>\n\n<p>Then it is easy to write the <code>Monoid</code> instance by choosing <code>mempty = First Nothing</code>. You can pull a similar trick by adding a distinguished identity element to your type:</p>\n\n<pre><code>data Or a b = Fst a | Snd b | Neither\ninstance Semigroup (Or a b) where\n    Neither &lt;&gt; b = b\n    a &lt;&gt; Neither = a\n    -- the remainder of the clauses are as before\n</code></pre>\n\n<p>This makes the choice of <code>mempty = Neither</code> quite easy.</p>\n\n<p>This pattern is so frequently useful that it actually has a newtype wrapper in <a href=\"https://hackage.haskell.org/package/semigroups-0.18.1/docs/Data-Semigroup.html#t:Option\" rel=\"noreferrer\"><code>semigroups</code></a>, so that you could also write this patched type using your original <code>Or a b</code> type as simply <code>Option (Or a b)</code> and get the <code>Semigroup</code> and <code>Monoid</code> instances for free.</p>\n"}], "owner": {"reputation": 22825, "user_id": 992687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0Da71.png?s=128&g=1", "display_name": "The Unfun Cat", "link": "https://stackoverflow.com/users/992687/the-unfun-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 35877647, "answer_count": 1, "score": 0, "last_activity_date": 1457469879, "creation_date": 1457468478, "question_id": 35877261, "link": "https://stackoverflow.com/questions/35877261/mempty-with-different-definition-depending-on-whether-mempty-is-left-or-right-ar", "title": "mempty with different definition depending on whether mempty is left or right arg?", "body": "<p>I have the following datatype and semigroup instance:</p>\n\n<pre><code>data Or a b =\n  Fst a\n  | Snd b deriving (Eq, Show)\n\ninstance Semigroup (Or a b) where\n  (&lt;&gt;) (Fst a) (Fst b) = Fst b\n  (&lt;&gt;) (Snd a) (Fst b) = Snd a\n  (&lt;&gt;) (Fst a) (Snd b) = Snd b\n  (&lt;&gt;) (Snd a) (Snd b) = Snd a\n</code></pre>\n\n<p>I want to make a monoid instance for the type above, but I do not see how to do it. If I use the following definition</p>\n\n<pre><code>instance (Monoid a, Monoid b) =&gt; Monoid (Or a b) where\n  mempty = (Fst mempty)\n  mappend = (&lt;&gt;)\n</code></pre>\n\n<p>it will work on all pairs of input to <code>&lt;&gt;</code>, except the one where I <code>mappend</code></p>\n\n<pre><code>(Fst a) &lt;&gt; mempty\n</code></pre>\n\n<p>which will evaluate to <code>mempty</code>.</p>\n\n<p>How do I fix this so that the <code>mempty</code> is valid? It seems like it cannot be done without some new syntax or concepts since it hinges on whether the mempty is to the left or right...</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1457474520, "post_id": 35876972, "comment_id": 59421122, "body": "sorry I got your request wrong - why don&#39;t you have a look at the implementation of <a href=\"https://hackage.haskell.org/package/yesod-core-1.4.18.2/docs/src/Yesod-Core-Class-Yesod.html#defaultLayout\" rel=\"nofollow noreferrer\"><code>defaultLayout</code></a> - it&#39;s quite simple and you should be able to adapt it do your needs easily"}], "answers": [{"tags": [], "owner": {"reputation": 2878, "user_id": 655862, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bad65d3d7319025d73e065d7a29ee22a?s=128&d=identicon&r=PG", "display_name": "Greg Weber", "link": "https://stackoverflow.com/users/655862/greg-weber"}, "is_accepted": false, "score": 1, "last_activity_date": 1457591373, "creation_date": 1457591373, "answer_id": 35909184, "question_id": 35876972, "link": "https://stackoverflow.com/questions/35876972/yesod-angular-directive-templates/35909184#35909184", "title": "Yesod - Angular directive templates", "body": "<p>Using Angular with Yesod works well because angular templating happens inside valid html that hamlet can generate.</p>\n\n<p>Besides the current comment answer you might consider including a lot of templates using script tags inside a layout. I have done this before where there was a front page layout, an app layout, and an admin layout.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457591373, "creation_date": 1457467399, "question_id": 35876972, "link": "https://stackoverflow.com/questions/35876972/yesod-angular-directive-templates", "title": "Yesod - Angular directive templates", "body": "<p>How can I make a handler deliver HTML (using hamlet), whithout wrapping it inside <code>defaultLayout</code>?? They will have as root a <code>div</code> tag, not something inside a whole <code>html</code> tag. Such way should also consider internationalization.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457461856, "post_id": 35874824, "comment_id": 59413868, "body": "maybe the family/constraint kind stuff is a bit heavy - why don&#39;t you start with a multi-param typeclass and add the index type? then you can constraint the <i>index</i> type for your instance"}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 1, "last_activity_date": 1457461619, "creation_date": 1457461619, "answer_id": 35875125, "question_id": 35874824, "link": "https://stackoverflow.com/questions/35874824/haskell-instance-signatures/35875125#35875125", "title": "Haskell instance signatures", "body": "<p>You can use associated type families and constraint kinds:</p>\n\n<pre><code>import GHC.Exts(Constraint)\n\nclass Indexable i where\n  type IndexableCtr i :: * -&gt; Constraint \n  at :: IndexableCtr i p =&gt; i a p -&gt; p -&gt; a\n\ninstance Indexable Test where \n  type IndexableCtr Test = Integral \n  at (Test l) p = l `genericIndex` p\n</code></pre>\n\n<p>This defines the class <code>Indexable</code> with an associated type <code>IndexableCtr</code> which \nis used to constraint the type of <code>at</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1457545705, "last_edit_date": 1457545705, "creation_date": 1457462275, "answer_id": 35875332, "question_id": 35874824, "link": "https://stackoverflow.com/questions/35874824/haskell-instance-signatures/35875332#35875332", "title": "Haskell instance signatures", "body": "<p>You are actually trying to do something fairly advanced. If I understand what you want, you actually need a multiparameter typeclass here, because your type parameter \"p\" depends on \"i\": for a list indexed by integer you need \"p\" to be integral, but for a table indexed by strings you need it to be \"String\", or at least an instance of \"Ord\".</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE MultiParamTypeClasses #-}   -- Enable the language extensions.\n\nclass Indexable i p | i -&gt; p where\n   at :: i a -&gt; p -&gt; a\n</code></pre>\n\n<p>This says that the class is for two types, \"i\" and \"p\", and if you know \"i\" then \"p\" follows automatically. So if \"i\" is a list the \"p\" has to be Int, and if \"i\" is a \"Map String a\" then \"p\" has to be \"String\".</p>\n\n<pre><code>instance Indexable [a] Int where\n   at = (!!)\n</code></pre>\n\n<p>This declares the combination of [a] and Int as being an instance of Indexable.</p>\n\n<p>user2407038 has provided an alternative approach using \"type families\", which is a more recent and sophisticated version of multiparameter type classes.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 4, "last_activity_date": 1457462286, "creation_date": 1457462286, "answer_id": 35875335, "question_id": 35874824, "link": "https://stackoverflow.com/questions/35874824/haskell-instance-signatures/35875335#35875335", "title": "Haskell instance signatures", "body": "<p>here is a version where you add the index-type to the class using <code>MultiParamTypeClasses</code></p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE RankNTypes #-}\n\nmodule Index where\n\nimport Data.List (genericIndex)\n\nclass Indexable i f  where\n  at :: forall a . f a -&gt; i -&gt; a\n\ndata Test a = Test [a]\n\ninstance Integral i =&gt; Indexable i Test where\n  at (Test as) i = as `genericIndex` i\n</code></pre>\n\n<p>here I need the <code>FlexibleInstances</code> because of the way the instance is declared and <code>RankNTypes</code> for the <code>forall a .</code> ;)</p>\n\n<p>assuming this is your expected behavior:</p>\n\n<pre><code>\u03bb&gt; let test = Test [1..5]\n\u03bb&gt; test `at` 3\n4\n\u03bb&gt; test `at` 0\n1\n\u03bb&gt; test `at` (0 :: Int)\n1\n\u03bb&gt; test `at` (1 :: Integer)\n2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1457468735, "creation_date": 1457468735, "answer_id": 35877341, "question_id": 35874824, "link": "https://stackoverflow.com/questions/35874824/haskell-instance-signatures/35877341#35877341", "title": "Haskell instance signatures", "body": "<p>Just for fun, here's a very different solution which doesn't require any changes to your class declaration. (N.B. This answer is for fun only! I do not advocate keeping your class as-is; it seems a strange class definition to me.) The idea here is to push the burden of proof off from the class instance to the person constructing a value of type <code>Test p a</code>; we will demand that constructing such a value will require an <code>Integral p</code> instance in scope.</p>\n\n<p>All this code stays exactly the same (but with a new extension turned on):</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\nimport Data.List\n\nclass Indexable i where\n    at :: i a p -&gt; p -&gt; a\ninstance Indexable Test where\n    at (Test l) p = l `genericIndex` p\n</code></pre>\n\n<p>But the declaration of your data type changes just slightly to demand an <code>Integral p</code> instance:</p>\n\n<pre><code>data Test a p where\n    Test :: Integral p =&gt; [a] -&gt; Test a p\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6035740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/477f05f82e0102211d3672c8b09e6b11?s=128&d=identicon&r=PG&f=1", "display_name": "HaskellNewbie", "link": "https://stackoverflow.com/users/6035740/haskellnewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1534928007, "creation_date": 1457460648, "last_edit_date": 1534928007, "question_id": 35874824, "link": "https://stackoverflow.com/questions/35874824/haskell-instance-signatures", "title": "Haskell instance signatures", "body": "<p>I'm a complete newbie in Haskell so please be patient.</p>\n\n<p>Let's say I've got this class</p>\n\n<pre><code>class Indexable i where\n  at :: i a p -&gt; p -&gt; a\n</code></pre>\n\n<p>Now let's say I want to implement that typeclass for this data type:</p>\n\n<pre><code>data Test a p = Test [a]\n</code></pre>\n\n<p>What I tried is:</p>\n\n<pre><code>instance Indexable Test where\n    at (Test l) p = l `genericIndex` p\n</code></pre>\n\n<p>However it didn't compile, because <code>p</code> needs to be an Integral, however as far as I understand, it's impossibile to add the type signature to instances. I tried to use InstanceSigs, but failed.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457466694, "post_id": 35866910, "comment_id": 59416819, "body": "You should probably change your question and ask &quot;what is a deprecated function&quot; to avert downvotes."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457440673, "post_id": 35867505, "comment_id": 59398877, "body": "Sorry, rollback: it&#39;s still there, but not documented anymore: <a href=\"https://hackage.haskell.org/package/split-0.2.2/docs/src/Data-List-Split-Internals.html#splitEvery\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/split-0.2.2/docs/src/&hellip;</a>. But as you said, it&#39;s likely to get removed in the next <code>0.x</code> version."}, {"owner": {"reputation": 126, "user_id": 4561178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vgQ6U.jpg?s=128&g=1", "display_name": "Jake Matthews", "link": "https://stackoverflow.com/users/4561178/jake-matthews"}, "edited": false, "score": 0, "creation_date": 1457441665, "post_id": 35867505, "comment_id": 59399584, "body": "Thank you for both of your answers, I understand now."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1457444254, "last_edit_date": 1457444254, "creation_date": 1457440370, "answer_id": 35867505, "question_id": 35866910, "link": "https://stackoverflow.com/questions/35866910/haskell-what-is-a-deprecated-function/35867505#35867505", "title": "Haskell - what is a deprecated function", "body": "<p>The warning says <code>splitEvery</code> is deprecated. Probably, <code>splitEvery</code> is going to be removed in future versions of the library, so the library author is advising you not to use it, and use <code>chunksOf</code> instead.</p>\n\n<p>As a general guideline, modules ending with <code>....Internal</code> are not meant to be imported directly by library users. The interface of such modules is very unstable: the author will feel free to change it at every whim.</p>\n\n<p>Update: as Zeta says below, <code>splitEvery</code> <em>is</em> already removed from the current library.</p>\n"}], "owner": {"reputation": 126, "user_id": 4561178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vgQ6U.jpg?s=128&g=1", "display_name": "Jake Matthews", "link": "https://stackoverflow.com/users/4561178/jake-matthews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 35867505, "answer_count": 1, "score": -1, "last_activity_date": 1457469557, "creation_date": 1457438695, "last_edit_date": 1457469557, "question_id": 35866910, "link": "https://stackoverflow.com/questions/35866910/haskell-what-is-a-deprecated-function", "title": "Haskell - what is a deprecated function", "body": "<p>I'm using <code>splitEvery</code> in my Haskell code importing <code>Data.List.Split.Internals</code>. For every time I use <code>splitEvery</code> I get the following warning:</p>\n\n<pre><code>In the use of `splitEvery`\n(imported from Data.List.Split.Internals):\nDeprecated: \"Use chunksOf.\"\n</code></pre>\n\n<p>If I use <code>chunksOf</code> instead of <code>splitEvery</code> I get no warnings. Does anyone know the reason? (To note I only used <code>splitEvery</code>as I came across it first.</p>\n"}, {"tags": ["haskell", "pointfree"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1457433225, "post_id": 35864507, "comment_id": 59393902, "body": "You could simply use <a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree.io</a> which yields: <code>addToList = (. ((. return) . (:))) . (.) . (:)</code>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 6, "creation_date": 1457433349, "post_id": 35864507, "comment_id": 59393992, "body": "And that&#39;s so much more clear than <code>addToList a b c = [a,b,c]</code>. *sigh*"}], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1457435270, "creation_date": 1457435270, "answer_id": 35865722, "question_id": 35864507, "link": "https://stackoverflow.com/questions/35864507/pointfree-add-to-list-in-haskell/35865722#35865722", "title": "pointfree add to list in haskell", "body": "<p>Just playing with this a little, maybe it will give you some ideas...</p>\n\n<pre><code>-- | &gt;&gt;&gt; append [4,5] 6\n-- [4,5,6]\nappend :: [a] -&gt; a -&gt; [a]\nappend = flip (flip (++) . (: []))\n\n-- | &gt;&gt;&gt; f1 4\n-- [4]\nf1 :: a -&gt; [a]\nf1 = (:[])\n\n-- | &gt;&gt;&gt; f2 4 5\n-- [4,5]\nf2 :: a -&gt; a -&gt; [a]\nf2 = append . f1\n\n-- | &gt;&gt;&gt; f3 4 5 6\n-- [4,5,6]\nf3 :: a -&gt; a -&gt; a -&gt; [a]\nf3 = (append .) . f2\n\n-- | &gt;&gt;&gt; f4 4 5 6 7\n-- [4,5,6,7]\nf4 :: a -&gt; a -&gt; a -&gt; a -&gt; [a]\nf4 = ((append .) .) . f3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1457446026, "last_edit_date": 1457446026, "creation_date": 1457435295, "answer_id": 35865733, "question_id": 35864507, "link": "https://stackoverflow.com/questions/35864507/pointfree-add-to-list-in-haskell/35865733#35865733", "title": "pointfree add to list in haskell", "body": "<p>Let's have a look at a more general version, that uses three functions <code>f</code>, <code>g</code> and <code>h</code>:</p>\n\n<pre><code>func a b c = f a (g b (h c))\n</code></pre>\n\n<p>In our case, <code>f = (:)</code>, <code>g = (:)</code> and <code>h = return</code>, but we can use this for any triple of functions that follow the same scheme:</p>\n\n<pre><code>func a b c = (f a . g b . h) c\n</code></pre>\n\n<p>For the next step, write the first application of <code>(.)</code> in prefix form, so that it's easier to combine <code>(.) (f a)</code> and the rest later:</p>\n\n<pre><code>func a b = (.) (f a) (g b . h)\n         = (.) (f a) (g b . h)\n         = (.) (f a) ((.) (g b) h)\n         = (.) (f a) (flip (.) h (g b))\n         = (.) (f a) ((flip (.) h . g) b)\n         = (.) (f a) . (flip (.) h . g) b\n</code></pre>\n\n<p>We can now do the same for <code>a</code>:</p>\n\n<pre><code>func a = (.) (f a) . (flip (.) h . g)\n       = (.) ((.) (f a)) (flip (.) h . g)\n       = flip (.) (flip (.) h . g) ((.) (f a))\n       = flip (.) (flip (.) h . g) . (.) (f a)\n       = flip (.) (flip (.) h . g) . (.) . f a\n</code></pre>\n\n<p>Since <code>flip (.) x</code> is <code>(.x)</code> we can get rid of <code>flip</code>:</p>\n\n<pre><code>func = flip (.) (flip (.) h . g) . (.) . f\n     = flip (.) ((.h) . g) . (.) . f\n     = (.((.h) . g)) . (.) . f\n</code></pre>\n\n<p>All we have to do now is to insert the definitions of <code>f</code>, <code>g</code> and <code>h</code>:</p>\n\n<pre><code>func = (.((.return) . (:))) . (.) . (:)\n</code></pre>\n\n<p>I didn't check whether there is a shorter version, but since this is the same result as <a href=\"http://pointfree.io\" rel=\"nofollow\">pointfree.io</a> yields, it should be more or less optimal. </p>\n\n<p>That being said, if you compare</p>\n\n<pre><code>addToList = (.((.return) . (:))) . (.) . (:)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>addToList a b c = [a, b, c]\n</code></pre>\n\n<p>which one would you like to read in three months?</p>\n"}], "owner": {"reputation": 25, "user_id": 3099254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2ba7cb6a56c3828b5a333df3e55db5?s=128&d=identicon&r=PG&f=1", "display_name": "Agnis", "link": "https://stackoverflow.com/users/3099254/agnis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "accepted_answer_id": 35865733, "answer_count": 2, "score": 0, "last_activity_date": 1457446026, "creation_date": 1457431940, "question_id": 35864507, "link": "https://stackoverflow.com/questions/35864507/pointfree-add-to-list-in-haskell", "title": "pointfree add to list in haskell", "body": "<p>I'm trying to derive function of three args, using simple function chaining.\n<br>The function should be of type</p>\n\n<pre><code>addToList :: a -&gt; a -&gt; a -&gt; [a]\n</code></pre>\n\n<p>and be pointfree analogue of </p>\n\n<pre><code>addToList :: a b c = (a : (b : (c : [])))\n</code></pre>\n\n<p>So far, I've figured out</p>\n\n<pre><code>addToList = ((.)((.) (flip (:)) . (flip (:))) . (flip (:))) []\n</code></pre>\n\n<p>But it works in reverse: </p>\n\n<pre><code>Prelude&gt; addToList 4 5 6\n[6,5,4]\n</code></pre>\n\n<p>and looks bulky.</p>\n\n<p>How can one get something nice like</p>\n\n<pre><code>(.) (.) (.) (:) (:) (: [])\n</code></pre>\n\n<p>that works as follows:</p>\n\n<pre><code>Prelude&gt; addToList 4 5 6\n[4,5,6]\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1457431364, "post_id": 35864153, "comment_id": 59392635, "body": "How does GHC complain? (Always add the error message)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457513374, "post_id": 35864638, "comment_id": 59435165, "body": "There&#39;s <code>lifted-base</code> (IIRC) for lifted <code>IO</code> actions."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1457432273, "creation_date": 1457432273, "answer_id": 35864638, "question_id": 35864153, "link": "https://stackoverflow.com/questions/35864153/haskell-why-is-this-monad-transformation-wrong/35864638#35864638", "title": "Haskell: Why is this monad transformation wrong?", "body": "<blockquote>\n  <p>My thought was that MonadIO are monads in which IO can be embedded, and MonadWriter w are monads in which WriterT w can be embedded. </p>\n</blockquote>\n\n<p>That's not completely correct. <code>MonadIO</code>s can use <code>liftIO</code>, and <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Writer-Lazy.html\"><code>MonadWriter</code></a> can use <code>tell</code>. Therefore, if you want to use <code>liftIO</code>, <code>tell</code>, <code>ask</code> and <code>local</code> in the same context/monad without lifting, the <strong>single</strong> monad you use must be an instance of all of them:</p>\n\n<pre><code>f :: ( MonadWriter [String] m -- monad supports  tell   :: [String] -&gt; m ()\n     , MonadReader Int      m -- monad supports  ask    ::             m Int\n     , MonadIO              m -- monad supports  liftIO :: IO a     -&gt; m a\n     )         =&gt;  m Int      -- only a single m\n</code></pre>\n\n<p>Note that you cannot use <code>transformer</code>, but <code>mtl</code> to get automatic lifting. Therefore, the imports also change:</p>\n\n<pre><code>import Control.Monad.Reader (runReaderT, MonadReader)\nimport Control.Monad.Writer (runWriterT, MonadWriter)\nimport Control.Monad.IO.Class (liftIO, MonadIO)\n</code></pre>\n\n<p>The import of <code>MonadIO</code> does not change since <code>IO</code> actions never get lifted automatically.</p>\n\n<p>By the way, your use of <code>runWriterT</code> and <code>runReaderT</code> already removes all ambiguities the transformer stack, since this will use</p>\n\n<pre><code>ReaderT Int (WriterT [String] IO Int)\n</code></pre>\n"}], "owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "accepted_answer_id": 35864638, "answer_count": 1, "score": 3, "last_activity_date": 1457432273, "creation_date": 1457430932, "last_edit_date": 1495535281, "question_id": 35864153, "link": "https://stackoverflow.com/questions/35864153/haskell-why-is-this-monad-transformation-wrong", "title": "Haskell: Why is this monad transformation wrong?", "body": "<p>I am studying monad transformers, and I read <a href=\"https://stackoverflow.com/questions/9054731/avoiding-lift-with-monad-transformers\">this</a> SO post about how to avoid <code>lift</code>s.</p>\n\n<p>My thought was that <code>MonadIO</code> are monads in which <code>IO</code> can be embedded, and <code>MonadWriter w</code> are monads in which <code>WriterT w</code> can be embedded. So I wrote the code below (read, accumulate and record numbers until we get a zero), where a working version using explicit <code>lift</code> is in comments. But GHC complains. What am I doing wrong?</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nimport Control.Monad.IO.Class\nimport Control.Monad.Writer.Class (MonadWriter)\nimport Control.Monad.Trans.Reader\nimport Control.Monad.Trans.Writer\n\n-- f :: ReaderT Int (WriterT [String] IO) Int\n-- m1 = ReaderT, m2 = WriterT\nf :: (MonadWriter [String] m1, MonadIO m2) =&gt; m1 (m2 (IO Int))\nf = do\n    s &lt;- liftIO getLine\n    tell [\"Input: \" ++ s] -- lift $ tell [\"Input: \" ++ s]\n    let i = read s :: Int\n    if i == 0\n       then ask\n       else local (+i) f\n\nmain = do\n    rst &lt;- runWriterT $ runReaderT f 0\n    print rst\n</code></pre>\n"}, {"tags": ["haskell", "heist"], "answers": [{"comments": [{"owner": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "edited": false, "score": 0, "creation_date": 1457522988, "post_id": 35888016, "comment_id": 59441526, "body": "Indeed, it works now. Thanks a lot. But I&#39;m somewhat cofused now by load-time splices and compiled splices. What&#39;s the actual difference between them? In the few tutorials I found on the internet, they wrote only about interpreted splices as opposed to compiled ones, so I just assumed that complied splices are the same as load-time splices. Apparently they&#39;re not the same though."}, {"owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "reply_to_user": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "edited": false, "score": 0, "creation_date": 1457925615, "post_id": 35888016, "comment_id": 59612001, "body": "Check out the tutorial at <a href=\"http://snapframework.com/docs/tutorials/compiled-splices\" rel=\"nofollow noreferrer\">snapframework.com/docs/tutorials/compiled-splices</a>.  Specifically the paragraph that begins &quot;To get around this problem we added the concept of load time splices&quot;."}, {"owner": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "edited": false, "score": 0, "creation_date": 1458026431, "post_id": 35888016, "comment_id": 59661528, "body": "I see. Thank you very much."}], "tags": [], "owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "is_accepted": true, "score": 1, "last_activity_date": 1457516800, "creation_date": 1457516800, "answer_id": 35888016, "question_id": 35863727, "link": "https://stackoverflow.com/questions/35863727/heist-not-substituting-templates/35888016#35888016", "title": "Heist not substituting templates", "body": "<p>It looks like you are using <code>renderTemplate</code> from <code>Heist.Compiled</code>, but defining interpreted splices.  I believe if you change this line:</p>\n\n<pre><code>set hcInterpretedSplices defaultInterpretedSplices\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>set hcLoadTimeSplices defaultLoadTimeSplices\n</code></pre>\n\n<p>it should work</p>\n"}], "owner": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 35888016, "answer_count": 1, "score": 1, "last_activity_date": 1457516800, "creation_date": 1457429757, "last_edit_date": 1457430842, "question_id": 35863727, "link": "https://stackoverflow.com/questions/35863727/heist-not-substituting-templates", "title": "Heist not substituting templates", "body": "<p>I have the following code, just copy-pasted and modernised (the original example does not compile with recent versions of Heist anymore) from <a href=\"https://ocharles.org.uk/blog/posts/2013-12-11-24-days-of-hackage-heist.html\" rel=\"nofollow\">here</a>.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport qualified Data.ByteString.Char8 as BS\nimport Data.Monoid\nimport Data.Maybe\nimport Data.List\nimport Control.Applicative\nimport Control.Lens\nimport Control.Monad.Trans\nimport Control.Monad.Trans.Either\nimport Heist\nimport Heist.Compiled\nimport Blaze.ByteString.Builder\n\n\nconf :: HeistConfig IO\nconf =  set hcTemplateLocations [ loadTemplates \".\" ] $\n        set hcInterpretedSplices defaultInterpretedSplices $\n        emptyHeistConfig\n\n\nrunHeistConf :: Either [String] (HeistState IO) -&gt; IO (HeistState IO)\nrunHeistConf (Right hs) = return hs\nrunHeistConf (Left msgs) = error . intercalate \"\\n\" $ map (\"[Heist error]: \" ++) msgs\n\n\nmain :: IO ()\nmain = do\n    heist &lt;- id &lt;$&gt; (runEitherT $ initHeist conf) &gt;&gt;= runHeistConf\n    output &lt;- fst $ fromMaybe (error \"xxx\") $ renderTemplate heist \"billy\"\n\n    BS.putStrLn . toByteString $ output\n</code></pre>\n\n<p>And the following template:</p>\n\n<pre><code>&lt;!-- billy.tpl --&gt;\n&lt;bind tag=\"wanted\"&gt;Playstation 4&lt;/bind&gt;\n&lt;bind tag=\"got\"&gt;Monopoly board game&lt;/bind&gt;\n\n&lt;apply template=\"letter\"&gt;\n  &lt;bind tag=\"kiddo\"&gt;Billy&lt;/bind&gt;\n  I regret to inform you the \"&lt;wanted /&gt;\" you have requested is currently\n  unavailable. I have substituted this with \"&lt;got /&gt;\". I hope this does not\n  disappoint you.\n&lt;/apply&gt;\n</code></pre>\n\n<p>Running this program outputs to the console the whole template (almost) as is. No substistutions are made. Probably there's some function call missing, required by modern Hesit versions. I was trying to track it down in the documentation, but no luck. Why doesn't it work?</p>\n\n<p>Output:</p>\n\n<pre><code>&lt;!-- billy.tpl --&gt;&lt;bind tag='wanted'&gt;Playstation 4&lt;/bind&gt;&amp;#10;&lt;bind tag='got'&gt;Monopoly board game&lt;/bind&gt;&amp;#10;\n&lt;apply template='letter'&gt;\n  &lt;bind tag='kiddo'&gt;Billy&lt;/bind&gt;\n  I regret to inform you the \"&lt;wanted&gt;&lt;/wanted&gt;\" you have requested is currently\n  unavailable. I have substituted this with \"&lt;got&gt;&lt;/got&gt;\". I hope this does not\n  disappoint you.\n&lt;/apply&gt;&amp;#10;\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 3, "creation_date": 1457409837, "post_id": 35858682, "comment_id": 59382471, "body": "What&#39;s prompting you to use <code>ZipList</code> at all?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1457417091, "post_id": 35858682, "comment_id": 59384893, "body": "By the way, a terminology thing: usually these are called &quot;partially applied functions&quot;, not &quot;partial functions&quot;, and &quot;partial functions&quot; is reserved for functions which may throw an error or loop forever."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 4, "last_activity_date": 1457411569, "creation_date": 1457411569, "answer_id": 35859021, "question_id": 35858682, "link": "https://stackoverflow.com/questions/35858682/how-to-apply-partial-functions-to-list-of-tuples/35859021#35859021", "title": "How to apply partial functions to list of tuples", "body": "<p>There's a mismatch between the type you declared and the type the function actually has.</p>\n\n<p>Let's just check the body of the function</p>\n\n<pre><code>*&gt; :t \\(a, b) -&gt; ZipList [(+2), (-2)] &lt;*&gt; ZipList [a, b]\n\\(a, b) -&gt; ZipList [(+2), (-2)] &lt;*&gt; ZipList [a, b]\n  :: (Num (b -&gt; b), Num b) =&gt; (b, b) -&gt; ZipList b\n</code></pre>\n\n<p>Eep! That's not good at all.</p>\n\n<p>So let's fix the error. The first error is that <code>-2</code> trips you up, because it parses as negative two, not an operator section.</p>\n\n<p>You can see that by typechecking just that fragment:</p>\n\n<pre><code>*&gt; :t (-2)\n(-2) :: Num a =&gt; a\n</code></pre>\n\n<p>Ok, so we'll change it to an explicit lambda, and get closer:</p>\n\n<pre><code>*&gt; :t \\(a, b) -&gt; ZipList [(+2), (\\x -&gt; x - 2)] &lt;*&gt; ZipList [a, b]\n\\(a, b) -&gt; ZipList [(+2), (\\x -&gt; x - 2)] &lt;*&gt; ZipList [a, b]\n  :: Num b =&gt; (b, b) -&gt; ZipList b\n</code></pre>\n\n<p>Now we see the conceptual error (you can see even more if you test it). We're just getting back <code>[a+2,b-2]</code>. That's what ziplist <em>does</em> -- \"zips\" the lists together. It doesn't take the cross product.</p>\n\n<p>So now we see we're on the completely wrong track.</p>\n\n<p>When we want to take a \"producty\" combination, I find the most natural way is to use a list comprehension. So let's just do that instead.</p>\n\n<pre><code>makeTupleList (a,b) = let funs = [(+2),(\\x-&gt;x-2)]\n                      in [(f a, g b) | f &lt;- funs, g &lt;- funs]\n</code></pre>\n\n<p>And that seems to do it.</p>\n\n<pre><code>*&gt; makeTupleList (10,20)\n[(12,22),(12,18),(8,22),(8,18)]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1457426942, "post_id": 35859030, "comment_id": 59389718, "body": "<code>flip (-) 2</code> is <code>subtract 2</code>."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1457460062, "post_id": 35859030, "comment_id": 59412948, "body": "Is there a way to curry the <code>(-)</code> function without using <code>flip</code> or something weird like <code>(+(-2))</code>"}, {"owner": {"reputation": 434, "user_id": 266247, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/11439443530de0b6efc8a346374330e2?s=128&d=identicon&r=PG", "display_name": "TallerGhostWalt", "link": "https://stackoverflow.com/users/266247/tallerghostwalt"}, "edited": false, "score": 0, "creation_date": 1457488543, "post_id": 35859030, "comment_id": 59426038, "body": "The  lambda wrapper works and is probably the clearest."}], "tags": [], "owner": {"reputation": 434, "user_id": 266247, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/11439443530de0b6efc8a346374330e2?s=128&d=identicon&r=PG", "display_name": "TallerGhostWalt", "link": "https://stackoverflow.com/users/266247/tallerghostwalt"}, "is_accepted": false, "score": 4, "last_activity_date": 1457411612, "creation_date": 1457411612, "answer_id": 35859030, "question_id": 35858682, "link": "https://stackoverflow.com/questions/35858682/how-to-apply-partial-functions-to-list-of-tuples/35859030#35859030", "title": "How to apply partial functions to list of tuples", "body": "<p>I would drop the ZipList:</p>\n\n<pre><code>makeTupleList :: (Int, Int) -&gt; [(Int, Int )]\nmakeTupleList (a,b) = (,) &lt;$&gt; aList &lt;*&gt; bList\n where\n  functionList :: [Int -&gt; Int]\n  functionList = [flip (-) 2  ,(+ 2) ]\n  aList :: [Int]\n  aList = functionList &lt;*&gt; [a]\n  bList = functionList &lt;*&gt; [b]\n</code></pre>\n\n<p>Yielding:</p>\n\n<pre><code> \u03bb&gt; makeTupleList (1,1)\n [(-1,-1),(-1,3),(3,-1),(3,3)]\n</code></pre>\n\n<p>ZipList is for not generating permutations out of an applicative action.  </p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1457411612, "creation_date": 1457409495, "question_id": 35858682, "link": "https://stackoverflow.com/questions/35858682/how-to-apply-partial-functions-to-list-of-tuples", "title": "How to apply partial functions to list of tuples", "body": "<p>The title of this question might sound misleading, but I wasnt sure how else to explain what I'm trying to do.</p>\n\n<p>I'm experimenting with non-deterministic data structures. I'm trying to produce all possible combinations of a set of partially apply operators and a list of tuples:</p>\n\n<pre><code>-- test.hs\nmakeTupleList :: (Int, Int) -&gt; [(Int, Int)] \nmakeTupleList (a, b) = ZipList [(+2), (-2)] &lt;*&gt; ZipList [a, b]\n</code></pre>\n\n<p>I want <code>makeTupleList</code> to return something like:</p>\n\n<pre><code>[(a + 2, b + 2), (a + 2, b - 2), (a - 2, b + 2), (a - 2, b - 2)]\n</code></pre>\n\n<p>But I'm clearly doing something wrong because I keep getting this error:</p>\n\n<pre><code>Couldn't match type `ZipList' with `[]'\n</code></pre>\n\n<p>How do I get my desired result?</p>\n"}, {"tags": ["haskell", "functor", "applicative", "foldable", "traversable"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1457403661, "post_id": 35857733, "comment_id": 59380903, "body": "<code>Set</code> is a classic example of a <code>Foldable</code> that&#39;s not a <code>Functor</code>. So are unboxed vectors."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457403901, "post_id": 35857733, "comment_id": 59380963, "body": "@dfeuer I will read more about <code>Set</code> to understand why it isn&#39;t a <code>Functor</code>, but, Sets can be thought as containers of things that don&#39;t repeat... That being said, I cannot figure out quickly why it is not a <code>Functor</code> instance..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1457404320, "post_id": 35857733, "comment_id": 59381080, "body": "The trouble is that <code>Functor</code> doesn&#39;t give implementations the opportunity to constrain their type arguments. Imagine if someone wrote <code>fmap f s</code> where <code>f :: Int -&gt; Integer -&gt; Integer</code>. The type <code>Integer -&gt; Integer</code> is not even an instance of <code>Eq</code>, let alone <code>Ord</code>, so there&#39;s no way to check for duplicates when mapping. The function could map multiple elements to identical functions, and you&#39;d have no way of collapsing the duplicates."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457404609, "post_id": 35857733, "comment_id": 59381163, "body": "Unboxed vectors can only contain &quot;unboxable&quot; things, so if <code>xs :: U.Vector Int</code>, <code>fmap Just xs</code> would have to produce something of type <code>U.Vector (Maybe Int)</code>, which isn&#39;t a real thing."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1457465190, "post_id": 35857733, "comment_id": 59415891, "body": "As I understand things, the <code>Traversable</code> class was conceived first (e.g., McBride and Patterson, <a href=\"http://www.staff.city.ac.uk/~ross/papers/Applicative.html\" rel=\"nofollow noreferrer\">&quot;Applicative Programming with Effects&quot;</a>; Gibbons and Oliveira, <a href=\"https://www.cs.ox.ac.uk/jeremy.gibbons/publications/iterator.pdf\" rel=\"nofollow noreferrer\">&quot;The Essence of the Iterator Pattern&quot;</a>). <code>Foldable</code> was added as a superclass because of the &quot;containers that aren&#39;t <code>Functor</code>s&quot; problem. But <code>foldMap</code> falls out of <code>traverse</code>-ing with the <code>Const</code> applicative, as shown in Gibbons and Oliveira&#39;s paper."}], "answers": [{"comments": [{"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457405109, "post_id": 35857812, "comment_id": 59381275, "body": "what I think that is amazing is that mathematically it is a <code>Functor</code> but because of this constraint it cannot be an <code>instance</code> of the <code>Functor</code> typeclass... Don&#39;t you think that this resembles an &quot;imperfection&quot; in the language? (The language is really beautiful, concise, and powerful, anyway!)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457405569, "post_id": 35857812, "comment_id": 59381390, "body": "@FtheBuilder I edited my answer to describe more context."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457406012, "post_id": 35857812, "comment_id": 59381513, "body": "I know I should not say &quot;Thank you&quot; in a comment, but really, your explanations were veeeery interesting! :D"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1457414518, "post_id": 35857812, "comment_id": 59383976, "body": "The &quot;order-preserving maps as morphisms&quot; thing seems quite restrictive; naively I would think &quot;equality-preserving&quot; would be enough. Can you comment on that a bit?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1457415067, "post_id": 35857812, "comment_id": 59384185, "body": "@DanielWagner, I wondered the same thing. Order-preserving gets you efficiency, but I don&#39;t see it being absolutely essential."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457417116, "post_id": 35857812, "comment_id": 59384903, "body": "You&#39;re probably write that equality preserving is enough. I used order preserving because that&#39;s typically how it is presented (can&#39;t find a reference off hand) and because its typical to have ordered sets with order preserving maps, so its a more &quot;natural&quot; setting. But I can&#39;t think why its actually necessary."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1457439052, "post_id": 35857812, "comment_id": 59397710, "body": "Indeed order-preserving is not necessary. And \u201cequality-preserving\u201d is pretty much a <i>universal</i> requirement, at least when you&#39;re talking about actual semantic equalities (<code>==</code> is only a rough approximation to equality; if you use that as a benchmark then tough luck applying the monad laws to anything interesting). Thus, <code>Set</code> <b>is</b> a functor on the ord-constrained <b>Hask</b> category, or <a href=\"http://hackage.haskell.org/package/set-monad\" rel=\"nofollow noreferrer\">indeed a monad on all of <b>Hask</b></a> if you implement it cleverly."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 9, "last_activity_date": 1525556281, "last_edit_date": 1525556281, "creation_date": 1457404040, "answer_id": 35857812, "question_id": 35857733, "link": "https://stackoverflow.com/questions/35857733/foldable-vs-traversable/35857812#35857812", "title": "Foldable vs Traversable", "body": "<p>As dfeuer says, <code>Set</code> is a good example of a <code>Foldable</code> that isn't a <code>Functor</code>.</p>\n\n<p>Consider the type of <code>Set.map</code>:</p>\n\n<pre><code>map :: Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b\n</code></pre>\n\n<p>Notice that this is <em>almost</em> <code>fmap</code>, but it requires an additional <code>Ord b</code> constraint. Since you have this constraint, it can't be made an instance of <code>Functor</code>.</p>\n\n<p>Note that <code>Set</code> is not a functor on Haskell, even with this restriction. Given cleverly set-up <code>Eq</code> instances we can break the law that <code>fmap f . fmap g === fmap (f . g)</code>. See this <a href=\"https://stackoverflow.com/q/19177125/371753\">Stack Overflow question</a> for further discussion.</p>\n\n<p>As noted there, <code>Set</code> <em>is</em> an (endo) functor on the \"subcategory of <code>Hask</code>\" with ordered types as sets and with <em>order-preserving maps</em> as morphisms.</p>\n\n<p>So even if it isn't apparent, the fact that we can't make <code>Set</code> a functor actually hints at a genuine mathematical issue and not just a limitation of our typeclass machinery.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1863, "favorite_count": 3, "accepted_answer_id": 35857812, "answer_count": 1, "score": 11, "last_activity_date": 1525556281, "creation_date": 1457403506, "last_edit_date": 1525543033, "question_id": 35857733, "link": "https://stackoverflow.com/questions/35857733/foldable-vs-traversable", "title": "Foldable vs Traversable", "body": "<p>While studying <code>Applicative</code> deeper, I came to <code>Traversable</code>. Although I already knew <code>Foldable</code> from <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"noreferrer\">LYHGG</a>, I haven't seen the former yet, so I started reading the <a href=\"https://en.wikibooks.org/wiki/Haskell/Traversable\" rel=\"noreferrer\">Haskell wiki about Traversable</a>.</p>\n\n<p>While reading it, I understood why <code>Foldable.fold</code> is parallel to <code>Traversable.sequenceA</code> and <code>Foldable.foldMap</code> is parallel to <code>Traversable.traverse</code>.</p>\n\n<p>I've seen also that every <code>Traversable</code> is also a <code>Foldable</code> and a <code>Functor</code>, and <code>sequenceA</code> and <code>traversal</code> have a default implementation in terms of each other:</p>\n\n<pre><code>traverse f = sequenceA . fmap f\nsequenceA = traverse id\n</code></pre>\n\n<p>So, as I have seen in LYHGG that <code>foldMap</code> is a minimal complete definition for <code>Foldable</code>, I thought that, it is parallel to <code>traverse</code>, so <code>fold</code> (which is parallel to <code>sequenceA</code>) would be a minimal complete definition too (which it isn't)... <code>Foldable</code> is not a <code>Functor</code> like <code>Traversable</code> is, so we cannot apply this:</p>\n\n<pre><code>foldMap f = fold . fmap f\nfold = foldMap id -- this is ok\n</code></pre>\n\n<p>Why isn't every <code>Foldable</code> a <code>Functor</code>, and what would be an instance of <code>Foldable</code> that actually isn't a <code>Functor</code>?</p>\n"}, {"tags": ["xml", "haskell", "xml-conduit"], "answers": [{"tags": [], "owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1457474937, "last_edit_date": 1457474937, "creation_date": 1457472602, "answer_id": 35878414, "question_id": 35856841, "link": "https://stackoverflow.com/questions/35856841/parsing-elements-with-namespace-etc-in-xml/35878414#35878414", "title": "Parsing elements with namespace etc. in XML", "body": "<p>Together with <code>xml-conduit</code>, I would suggest the use of a tiny 'lens' package such as <a href=\"https://hackage.haskell.org/package/xml-html-conduit-lens\" rel=\"nofollow\">xml-html-conduit-lens</a> or <code>xml-lens</code> (both are quite similar but I have chosen the first after a quick browse at the source). Namespace is supported (see <a href=\"https://github.com/supki/xml-html-conduit-lens/issues/4\" rel=\"nofollow\">this issue</a>)  </p>\n\n<p>You can look at <a href=\"https://github.com/PierreR/vCloudApi/\" rel=\"nofollow\">one of my experimental project</a> if you need a more concrete example. From that project, here is a traversal to get the information of a specific machine from the VCloud API:</p>\n\n<pre><code>fetchVM :: AsXmlDocument t =&gt; Text -&gt; Traversal' t Element\nfetchVM n = xml...ovfNode \"VirtualSystem\".attributed (ix (nsName ovfNS \"id\").only n)\n</code></pre>\n\n<p>You can then combine traversals <a href=\"https://github.com/PierreR/vCloudApi/blob/master/src/vcloud.hs#L46\" rel=\"nofollow\">as such</a>:</p>\n\n<pre><code>vmId = raw ^. responseBody . fetchVM vmName . fetchVmId.text\n</code></pre>\n\n<p>Look at how <code>ovhNode</code> or <code>nsName</code> is defined to see how I handle namespace.</p>\n\n<p>Here is another interesting article on the subject:\n<a href=\"https://www.schoolofhaskell.com/user/chad/snippets/random-code-snippets/xml-conduit-lens\" rel=\"nofollow\">https://www.schoolofhaskell.com/user/chad/snippets/random-code-snippets/xml-conduit-lens</a></p>\n\n<p>Another tip is to stick with 'xml-conduit' (at least for now). Some have suggested <code>taggy</code> as a replacement but unfortunately it is currently not in an active development cycle (see <a href=\"https://github.com/alpmestan/taggy/issues/14\" rel=\"nofollow\">https://github.com/alpmestan/taggy/issues/14</a>)</p>\n\n<p>I hope it helps.</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457474937, "creation_date": 1457397366, "question_id": 35856841, "link": "https://stackoverflow.com/questions/35856841/parsing-elements-with-namespace-etc-in-xml", "title": "Parsing elements with namespace etc. in XML", "body": "<p>This question is about how to parse xml content with <code>xmlns</code> attributes etc. I wrote code to parse it which works. I will appreciate pointers on whether it can be done better.</p>\n\n<p>I have an XML file <code>test.xml</code> as below:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;&lt;soap:Body&gt;\n&lt;SomeResponse xmlns=\"https://testsomestuff.org/API/WS/\"&gt;\n &lt;SomeResult&gt;\n&amp;lt;html&amp;gt;\n    &amp;lt;head&amp;gt;\n        &amp;lt;title&amp;gt;My &amp;lt;b&amp;gt;Title&amp;lt;/b&amp;gt;&amp;lt;/title&amp;gt;\n    &amp;lt;/head&amp;gt;\n    &amp;lt;body&amp;gt;\n        &amp;lt;p&amp;gt;Foo bar baz&amp;lt;/p&amp;gt;\n    &amp;lt;/body&amp;gt;\n&amp;lt;/html&amp;gt;\n &lt;/SomeResult&gt;\n&lt;/SomeResponse&gt;\n&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\n</code></pre>\n\n<p>I wrote the code to parse the \"SomeResult\" content using <code>xml-conduit</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Prelude hiding (readFile)\nimport Text.XML\nimport Text.XML.Cursor\nimport qualified Data.Text as T\nimport Data.Text.Lazy.Builder (toLazyText)\nimport Data.Text.Lazy (fromStrict)\n\nmain :: IO ()\nmain = do\n    doc &lt;- readFile def \"test.xml\"\n    let cursor = fromDocument doc\n        res = fromStrict $ T.concat $ child cursor &gt;&gt;= laxElement \"Body\" &gt;&gt;= child &gt;&gt;= laxElement \"SomeResponse\" &gt;&gt;= child &gt;&gt;= laxElement \"SomeResult\" &gt;&gt;= descendant &gt;&gt;= content\n        pres = parseText_ def res\n        cursor2 = fromDocument pres\n        res2 = child cursor2 &gt;&gt;= element \"head\" &gt;&gt;= child &gt;&gt;= element \"title\" &gt;&gt;= descendant &gt;&gt;= content\n    print $ res2\n</code></pre>\n\n<p>Output in <code>ghci</code>: parses correctly:</p>\n\n<pre><code>*Main&gt; main\n[\"My \",\"Title\"]\n</code></pre>\n\n<p>Is <code>laxElement</code> approach to locate the <code>SomeResult</code> content good way to do it? If there is a better way, I will very much appreciate pointers on this. </p>\n\n<p>Also, I need to do http encoding in reverse direction (when building a request for the response above) where the inner body is escaped (like under <code>SomeResult</code> in <code>text.xml</code>). Is that something that is taken care of by default when building request using <code>Text.XML</code>, or do I have to convert the inner body to escaped http explicitly by using something like <a href=\"https://hackage.haskell.org/package/html-entities\" rel=\"nofollow\">html-entities</a> ?</p>\n"}, {"tags": ["postgresql", "haskell", "connection-pooling"], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1457403910, "creation_date": 1457403910, "answer_id": 35857793, "question_id": 35856664, "link": "https://stackoverflow.com/questions/35856664/haskell-get-table-count-with-postgresql-simple-with-connection-pool/35857793#35857793", "title": "Haskell: get table count(*) with postgresql.simple (with Connection Pool)", "body": "<p>If you only want to extract a single value, you don't do so directly. You wrap it in an <a href=\"https://hackage.haskell.org/package/postgresql-simple-0.5.1.2/docs/Database-PostgreSQL-Simple.html#t:Only\" rel=\"nofollow\">Only</a>.</p>\n\n<p>So try the annotation <code>:: IO [Only Int]</code></p>\n"}], "owner": {"reputation": 779, "user_id": 1829853, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/42a73b47c8415dbe221dec8838031132?s=128&d=identicon&r=PG&f=1", "display_name": "miro", "link": "https://stackoverflow.com/users/1829853/miro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 1, "accepted_answer_id": 35857793, "answer_count": 1, "score": 0, "last_activity_date": 1457403910, "creation_date": 1457396109, "question_id": 35856664, "link": "https://stackoverflow.com/questions/35856664/haskell-get-table-count-with-postgresql-simple-with-connection-pool", "title": "Haskell: get table count(*) with postgresql.simple (with Connection Pool)", "body": "<p>Please,.. how can I get count(*) from one table? I'm trying to connect some fragments of code,..but so far no success.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>fetchSimple :: FromRow r =&gt; Pool Connection -&gt; Query -&gt; IO [r]\nfetchSimple pool sql = withResource pool retrieve\n   where retrieve conn = query_ conn sql \n\ngetUsersCount :: Pool Connection -&gt; IO (Int)\ngetUsersCount pool = do\n   res &lt;- fetchSimple pool \"SELECT count(*) FROM article\" :: IO [Int]\n   let f = head res\n   return f\n</code></pre>\n\n<p>this gives me following error:</p>\n\n<pre><code>No instance for (FromRow Int) arising from a use of \u2018fetchSimple\u2019\nIn a stmt of a 'do' block:\n  res &lt;- fetchSimple pool \"SELECT count(*) FROM article\" :: IO [Int]\nIn the expression:\n  do { res &lt;- fetchSimple pool \"SELECT count(*) FROM article\" ::\n                IO [Int];\n       let f = head res;\n       return f }\nIn an equation for \u2018getUsersCount\u2019:\n    getUsersCount pool\n      = do { res &lt;- fetchSimple pool \"SELECT count(*) FROM article\" ::\n                      IO [Int];\n             let f = ...;\n             return f }\n</code></pre>\n"}, {"tags": ["haskell", "types", "infix-notation"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1457395407, "post_id": 35856261, "comment_id": 59378672, "body": "The definition of <code>[]</code> is full of magic; I&#39;d take anything GHCi says about it with a grain of salt."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 7, "creation_date": 1457417142, "post_id": 35856261, "comment_id": 59384915, "body": "I would call this a bug. Feel free to report it on the bug tracker."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1457426893, "post_id": 35856261, "comment_id": 59389692, "body": "Same issue with ghc 7.8.4."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1457479365, "post_id": 35856261, "comment_id": 59423278, "body": "@gallais can you provide that as an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1458691070, "post_id": 36167094, "comment_id": 59972108, "body": "Another one bites the dust! I wonder what got it fixed--if it only caused this one peculiarity, I doubt anyone would&#39;ve bothered. Perhaps the code was rewritten for some more substantial reason."}], "tags": [], "owner": {"reputation": 589, "user_id": 1486400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6c720fd6b86fdf2293eefb5188d46b?s=128&d=identicon&r=PG", "display_name": "int_index", "link": "https://stackoverflow.com/users/1486400/int-index"}, "is_accepted": true, "score": 3, "last_activity_date": 1458689154, "creation_date": 1458689154, "answer_id": 36167094, "question_id": 35856261, "link": "https://stackoverflow.com/questions/35856261/haskell-why-is-info-returns-the-definition-twice/36167094#36167094", "title": "Haskell. Why is :info (:) returns the definition twice?", "body": "<p>Pay no attention to this, it's certainly a bug. I can reproduce this behavior on GHC 7.10.3, but the current GHC 8.0 development snapshot doesn't suffer from this issue:</p>\n\n<pre><code>GHCi, version 8.0.0.20160316: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :info (:)\ndata [] a = ... | a : [a]   -- Defined in \u2018GHC.Types\u2019\ninfixr 5 :\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 1201917, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2bfbfc7322e119a59b09eefd2775e05e?s=128&d=identicon&r=PG", "display_name": "user1201917", "link": "https://stackoverflow.com/users/1201917/user1201917"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 36167094, "answer_count": 1, "score": 12, "last_activity_date": 1458689154, "creation_date": 1457393688, "question_id": 35856261, "link": "https://stackoverflow.com/questions/35856261/haskell-why-is-info-returns-the-definition-twice", "title": "Haskell. Why is :info (:) returns the definition twice?", "body": "<p>I'm new to haskell.</p>\n\n<p>If I type in GHCi (7.10.3):</p>\n\n<pre><code>:info (:)\n</code></pre>\n\n<p>I get result:</p>\n\n<pre><code>*** Parser:\ndata [] a = ... | a : [a]   -- Defined in \u2018GHC.Types\u2019\ninfixr 5 :\n\ndata [] a = ... | a : [a]   -- Defined in \u2018GHC.Types\u2019\ninfixr 5 :\n</code></pre>\n\n<p>Does it means that operator is defined twice?\nI didn't find any suspicious things in the source =/</p>\n"}, {"tags": ["haskell", "conduit", "xml-conduit"], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 1, "last_activity_date": 1457520518, "last_edit_date": 1457520518, "creation_date": 1457442536, "answer_id": 35868300, "question_id": 35855806, "link": "https://stackoverflow.com/questions/35855806/not-sure-how-to-parse-this-using-text-xml-cursor/35868300#35868300", "title": "Not sure how to parse this using Text.XML.Cursor", "body": "<p>You have to define your own XML Axis of a \"immediate sibling\" as <code>followingSibling</code> returns every node after the context. It's possible since <code>Axis</code> in <code>Text.XML.Cursor</code> are type synonym of <code>Cursor -&gt; [Cursor]</code>:</p>\n\n<pre><code>immediateSibling = take 1 . (anyElement &lt;=&lt; followingSibling)\n</code></pre>\n\n<p>And combining information from different level is just nested list comprehension:</p>\n\n<pre><code>selected = root $/ selector\nselector = element \"h2\" &gt;=&gt; toTuple\n\n-- replace tuple with your constructor\ntoTuple c = [ (coll, prop)\n            | coll &lt;- c $/ content\n            , prop &lt;- c $| (immediateSibling &gt;=&gt; element \"table\" &amp;/ element \"tr\" &amp;/ content) ]\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 154755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8011979162518805b3bb4364fc27f88?s=128&d=identicon&r=PG", "display_name": "davorb", "link": "https://stackoverflow.com/users/154755/davorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 35868300, "answer_count": 1, "score": 1, "last_activity_date": 1457520518, "creation_date": 1457391341, "question_id": 35855806, "link": "https://stackoverflow.com/questions/35855806/not-sure-how-to-parse-this-using-text-xml-cursor", "title": "Not sure how to parse this using Text.XML.Cursor", "body": "<p>I'm trying to parse XML that looks like this:</p>\n\n<pre><code>&lt;h1&gt;Collection A&lt;/h2&gt;\n&lt;table&gt;\n  &lt;tr&gt;Property 1&lt;/tr&gt;\n  &lt;tr&gt;Property 2&lt;/tr&gt;\n&lt;/table&gt;\n\n&lt;h2&gt;Collection 2&lt;/h2&gt;\n&lt;table&gt;\n  &lt;tr&gt;Property 1&lt;/tr&gt;\n  &lt;tr&gt;Property 88&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I would like to parse that info as such:</p>\n\n<pre><code>MyClass \"Collection 1\" \"Property 1\"\nMyClass \"Collection 1\" \"Property 2\"\nMyClass \"Collection 2\" \"Property 1\"\nMyClass \"Collection 2\" \"Property 88\"\n</code></pre>\n\n<p>I'm not sure how to go about doing this. My first thought was doing something like <code>element \"h1\" $| followingSibling &amp;// element \"tr\" &amp;/ content</code>, but that doesn't work, since it will capture all of the tr's, even the ones that don't \"belong\" to the table that I'm trying to read from, and I won't be able to know what properties belong to which collection.</p>\n\n<p>How do I go about solving this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1457390859, "post_id": 35855605, "comment_id": 59376858, "body": "Where is this code from? Does it work? What don&#39;t you understand?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1457391396, "post_id": 35855605, "comment_id": 59377100, "body": "Try to compute <code>inits4 [1,2,3]</code> by hand -- it will not take very long. Start by computing <code>inits4 []</code>, then <code>inits4 [3]</code>, then <code>inits4 [2,3]</code>, then <code>inits4 [1,2,3]</code>. Every step is used in the next one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1457395011, "post_id": 35855605, "comment_id": 59378529, "body": "inits4 [] = [[]], inits4[3] = []:[3:ys | ys &lt;- inits4[]] = []:[3:ys | ys&lt;-[[]] ] =[]:[3:[[]] ].  It doesn&#39;t match, 3:[[]] :("}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1457425404, "post_id": 35855605, "comment_id": 59388788, "body": "@HaskellFun You&#39;re almost there. However <code>y&lt;-[[]]</code> means that <code>y</code> is an element of <code>[[]]</code>, so the only choice is <code>y=[]</code>. Hence we get <code>inits4 [3] = ... = []:[3:[]] = [ [], [3] ]</code> which is the correct output."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457395266, "post_id": 35856061, "comment_id": 59378630, "body": "@HaskellFun, it&#39;s a generalization of  <code>return</code>. I made it consistent now."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1457395207, "last_edit_date": 1457395207, "creation_date": 1457392666, "answer_id": 35856061, "question_id": 35855605, "link": "https://stackoverflow.com/questions/35855605/haskell-own-version-inits-list-comprehensions/35856061#35856061", "title": "haskell - own version inits - list comprehensions", "body": "<p>You say</p>\n\n<pre><code>inits4 :: [a] -&gt; [[a]]\ninits4 [] = [[]]\ninits4 (x:xs) = []:[x:ys | ys &lt;- inits4 xs]\n</code></pre>\n\n<p>I hope you can figure out the first case yourself. The second can be translated mechanically to <code>do</code> notation:</p>\n\n<pre><code>inits4 (x : xs) = [] : do\n  ys &lt;- inits4 xs\n  return (x : ys)\n</code></pre>\n\n<p>This we can desugar to</p>\n\n<pre><code>inits4 (x : xs) =\n  [] : (inits4 xs &gt;&gt;= \\ys -&gt; return (x : ys))\n</code></pre>\n\n<p>We have a law that</p>\n\n<pre><code>m &gt;&gt;= \\a -&gt; return (f a) = fmap f m\n</code></pre>\n\n<p>so</p>\n\n<pre><code>inits4 (x : xs) =\n  [] : fmap (x :) (inits4 xs)\n</code></pre>\n\n<p>Since <code>inits4</code> produces a list, <code>fmap = map</code>, and the you should be able to work the rest out.</p>\n\n<hr>\n\n<p>Note that this implementation suffers from a serious efficiency problem and should not be used in real code. The simplest implementation with unconditionally asymptotically optimal performance is probably</p>\n\n<pre><code>inits xs = [] : zipWith (\\i _ -&gt; take i xs) [1..] xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1457425811, "creation_date": 1457425811, "answer_id": 35862454, "question_id": 35855605, "link": "https://stackoverflow.com/questions/35855605/haskell-own-version-inits-list-comprehensions/35862454#35862454", "title": "haskell - own version inits - list comprehensions", "body": "<p>To understand the recursive case, suppose that we want to compute</p>\n\n<pre><code>inits4 [x1,...,xn] =\n[ [], [x1], [x1, x2], [x1, x2, x3], ..., [x1, ..., xn] ]\n</code></pre>\n\n<p>We start by computing <code>inits4</code> on the tail of the list. By induction, we get</p>\n\n<pre><code>inits4 [x2,...,xn] =\n[ [], [x2], [x2, x3], ..., [x2, ..., xn] ]\n</code></pre>\n\n<p>How to turn the above into the wanted result. Well, we need to add <code>x1</code> to every list in the list of lists. We can do that with a list comprehension</p>\n\n<pre><code>[x1:y | y &lt;- inits4 [x2,...,xn]] =\n[ x1:[], x1:[x2], x1:[x2, x3], ..., x1:[x2, ..., xn] ] =\n[ [x1], [x1, x2], [x1, x2, x3], ..., [x1, x2, ..., xn] ] =\n</code></pre>\n\n<p>That's almost what we wanted! We only add to add the empty list:</p>\n\n<pre><code>[] : [x1:y | y &lt;- inits4 [x2,...,xn]] =\n[ [], [x1], [x1, x2], [x1, x2, x3], ..., [x1, x2, ..., xn] ]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 35862454, "answer_count": 2, "score": 0, "last_activity_date": 1457425811, "creation_date": 1457390528, "question_id": 35855605, "link": "https://stackoverflow.com/questions/35855605/haskell-own-version-inits-list-comprehensions", "title": "haskell - own version inits - list comprehensions", "body": "<p>Look at following version of inits:  </p>\n\n<pre><code>inits4 :: [a] -&gt; [[a]]\ninits4 [] = [[]]\ninits4 (x:xs) = []:[x:ys | ys &lt;- inits4 xs]\n</code></pre>\n\n<p>I know how to work comprehension list, but this case is horrible. Could somebody try to explain it, please ?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457393442, "post_id": 35855444, "comment_id": 59377922, "body": "@dfeuer You are correct. I&#39;ve changed it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457395757, "post_id": 35855444, "comment_id": 59378766, "body": "It would be helpful for you to clarify, yes. And I suspect you will need to use type families differently. I suspect it may help to &quot;warm up&quot; by using length-indexed heterogeneous lists and splitting them with <code>Fin</code> values."}], "answers": [{"comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1457448968, "post_id": 35865104, "comment_id": 59405126, "body": "Thanks. This solved the issue I was having. Your first suggestion ended up being completely sufficient for what I was doing and simplified things considerably."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 1, "last_activity_date": 1457433520, "creation_date": 1457433520, "answer_id": 35865104, "question_id": 35855444, "link": "https://stackoverflow.com/questions/35855444/splitting-a-type-level-list-in-ghc/35865104#35865104", "title": "Splitting a type-level list in GHC", "body": "<p>The problem with your representation is that you try to make the position of the split explicit, but don't enforce the validity of the position index. </p>\n\n<p>As it is currently <code>moveRight :: Parts n rs -&gt; Parts (S n) rs</code> can't be implemented, because if <code>n</code> is out of bounds, <code>Take</code> and the other type family applications cannot reduce and therefore no value can be given in the result. </p>\n\n<p>There are many ways to solve this issue. The simplest is to make the types in the left and right parts of the context explicit:</p>\n\n<pre><code>type HZipper xs ys = (HRec xs, HRec ys)\n\nmoveRight :: HZipper xs (y ': ys) -&gt; HZipper (y ': xs) ys\nmoveRight'(xs, HCons y ys) = (HCons y xs, ys)\n</code></pre>\n\n<p>This is actually just as strong representatation as your original <code>Parts</code>. provided that we enforce the bounds on the <code>n</code> index there. That's because both types indicate the whole list and the exact position of the split. From <code>HZipper xs ys</code>, the original type list can be computed as <code>Reverse xs ++ ys</code> with the appropriate <code>++</code> and <code>Reverse</code> type families. This is sometimes less convenient, but on the up side <code>HZipper</code> has much simpler internals.</p>\n\n<p>Alternatively, you can hide the position of split existentially. In any case, this requires proof writing for <code>moveRight</code>:</p>\n\n<pre><code>import Data.Type.Equality\nimport Data.Proxy\n\ndata HRec vs where\n  HNil  :: HRec '[]\n  HCons :: x -&gt; HRec xs -&gt; HRec (x ': xs)\n\ntype family (++) xs ys where\n  '[] ++ ys = ys\n  (x ': xs) ++ ys = x ': (xs ++ ys)\n\ntype family Reverse xs where\n  Reverse '[] = '[]\n  Reverse (x ': xs) = Reverse xs ++ '[x]\n\ndata HZipper xs where\n  HZipper :: HRec ys -&gt; HRec zs -&gt; HZipper (Reverse ys ++ zs)\n\nhcat :: HRec xs -&gt; HRec ys -&gt; HRec (xs ++ ys)\nhcat HNil         ys = ys\nhcat (HCons x xs) ys = HCons x (hcat xs ys)\n\nhreverse :: HRec xs -&gt; HRec (Reverse xs)\nhreverse HNil         = HNil\nhreverse (HCons x xs) = hreverse xs `hcat` (HCons x HNil)\n\ncatAssoc :: HRec xs -&gt; Proxy ys -&gt; Proxy zs -&gt; (xs ++ (ys ++ zs)) :~: ((xs ++ ys) ++ zs)\ncatAssoc HNil xs ys = Refl\ncatAssoc (HCons x xs) ys zs = case catAssoc xs ys zs of\n  Refl -&gt; Refl\n\nmoveRight :: HZipper xs -&gt; HZipper xs\nmoveRight (HZipper ls HNil) = HZipper ls HNil\nmoveRight (HZipper ls (HCons (x :: x) (xs :: HRec xs))) =\n  case catAssoc (hreverse ls) (Proxy :: Proxy '[x]) (Proxy :: Proxy xs) of\n    Refl -&gt; HZipper (HCons x ls) xs\n</code></pre>\n\n<p>There's a third possibility, namely adding an existential bounds check inside the original <code>Parts</code>, or having <code>moveRight :: InBounds (S n) rs -&gt; Parts n rs -&gt; Parts (S n) rs</code>, where <code>InBounds</code> is a proof of inbounds-ness. Or we could have <code>InBounds (S n) rs =&gt; ...</code> with <code>InBounds</code> a type family returning a class constraint. This approach would also require quite a bit of proof-writing though.</p>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 3, "accepted_answer_id": 35865104, "answer_count": 1, "score": 2, "last_activity_date": 1457433520, "creation_date": 1457389931, "last_edit_date": 1457393387, "question_id": 35855444, "link": "https://stackoverflow.com/questions/35855444/splitting-a-type-level-list-in-ghc", "title": "Splitting a type-level list in GHC", "body": "<p>I am having a difficult time convincing GHC that certain properties\nof list manipulation are true. Before I provide the code that I'm\nworking on, I'll give a brief example of the property I'm interested in.\nSuppose we have some type-level list <code>xs</code>:</p>\n\n<pre><code>xs ~ '[ 'A, 'B, 'C, 'D, 'E, 'F ]\n</code></pre>\n\n<p>And we drop some of the elements and also take the same number of\nelements:</p>\n\n<pre><code>Drop 2 xs ~ '[ 'C, 'D, 'E, 'F ]\nTakeReverse 2 xs ~ '[ 'B, 'A ]\n</code></pre>\n\n<p>It should be obvious that if I apply <code>Drop</code> and <code>TakeReverse</code> \nusing the successor of 2, then I can just pop the <code>'C</code> off of\n<code>Drop 2 xs</code> and put it on top of <code>TakeReverse 2 xs</code>:</p>\n\n<pre><code>Drop 3 xs ~ '[ 'D, 'E, 'F ]\nTakeReverse 3 xs ~ '[ 'C, 'B, 'A ]\n</code></pre>\n\n<p>The following code has a function named <code>moveRight</code> that attempts to\nuse this property. I have cut my actual code down to a somewhat small example that \nillustrates the issue and has no dependencies. </p>\n\n<pre><code>{-# LANGUAGE DataKinds            #-}\n{-# LANGUAGE FlexibleContexts     #-}\n{-# LANGUAGE OverloadedStrings    #-}\n{-# LANGUAGE PolyKinds            #-}\n{-# LANGUAGE ScopedTypeVariables  #-}\n{-# LANGUAGE TypeFamilies         #-}\n{-# LANGUAGE TypeOperators        #-}\n{-# LANGUAGE GADTs                #-}\n{-# LANGUAGE UndecidableInstances #-}\nmodule Minimal where\n\nimport Data.Type.Equality\n\ndata Nat = Z | S Nat\n\ndata Natty (n :: Nat) where\n  Zy :: Natty 'Z\n  Sy :: Natty n -&gt; Natty ('S n)\n\ndata HRec (vs :: [*]) where\n  HRecNil  :: HRec '[]\n  HRecCons :: x -&gt; HRec xs -&gt; HRec (x ': xs)\n\ndata HProxy (vs :: [k]) where\n  HProxyNil  :: HProxy '[]\n  HProxyCons :: HProxy xs -&gt; HProxy (x ': xs)\n\ndata Parts n rs = Parts\n  { partLeft  :: HRec (Drop n rs) \n  , partRight :: HRec (TakeReverse n rs)\n  , partNatty :: Natty n\n  , partProxy :: HProxy rs\n  }\n\n-- The type families Drop, Take, and TakeReverse\n-- are all partial.\ntype family Drop (n :: Nat) (xs :: [k]) :: [k] where\n  Drop 'Z xs = xs\n  Drop ('S n) (x ': xs) = Drop n xs\n\ntype family Take (n :: Nat) (xs :: [k]) :: [k] where\n  Take 'Z xs = '[]\n  Take ('S n) (x ': xs) = x ': Take n xs\n\ntype family TakeReverse (n :: Nat) (xs :: [k]) :: [k] where\n  TakeReverse n xs = TakeReverseHelper '[] n xs\n\ntype family TakeReverseHelper (ys :: [k]) (n :: Nat) (xs :: [k]) :: [k] where\n  TakeReverseHelper res 'Z xs = res\n  TakeReverseHelper res ('S n) (x ': xs) = TakeReverseHelper (x ': res) n xs\n\nmoveRight :: Parts n rs -&gt; Parts (S n) rs\nmoveRight (Parts pleft@(HRecCons pleftHead _) pright natty proxy) = \n  case dropOneProof natty proxy of\n    Refl -&gt; Parts (dropOne pleft) (HRecCons pleftHead pright) (Sy natty) proxy\n\ndropOneProof :: Natty n -&gt; HProxy rs -&gt; (Drop ('S n) rs :~: Drop ('S 'Z) (Drop n rs))\ndropOneProof Zy _ = Refl\ndropOneProof (Sy n) (HProxyCons rs) = case dropOneProof n rs of\n  Refl -&gt; Refl\n\ndropOne :: HRec rs -&gt; HRec (Drop ('S 'Z) rs)\ndropOne (HRecCons _ rs) = rs\n</code></pre>\n\n<p>This code does not compile because of <code>moveRight</code>. Basically, I'm able to\nprove that dropping an additional element from the left side gives it \nthe right type, but I can't show that adding this element to the right \nside makes it have the right type.</p>\n\n<p>I'm really open to any changes. I'm fine with changing the type families,\nintroducing extra witnesses, etc., as long as <code>moveRight</code> becomes \npossible to write.</p>\n\n<p>If I need to further clarify what I am trying to do, please let me know. Thanks.</p>\n"}, {"tags": ["haskell", "syntax", "whitespace", "indentation"], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 42, "last_activity_date": 1597213528, "last_edit_date": 1597213528, "creation_date": 1457388893, "answer_id": 35855171, "question_id": 35855170, "link": "https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces/35855171#35855171", "title": "Why shouldn&#39;t I mix tabs and spaces?", "body": "<p>The problem is twofold. First of all, Haskell is indentation sensitive, e.g. the following code isn't valid:</p>\n<pre><code>example = (a, b)\n  where\n    a = &quot;Hello&quot;\n     b = &quot;World&quot;\n</code></pre>\n<p>Both bindings need to be indented with the same number of spaces/tabs (see <a href=\"https://en.wikipedia.org/wiki/Off-side_rule\" rel=\"noreferrer\">off-side rule</a>). While it's obvious in this case, it's rather hidden in the following one, where I denote a space by <code>\u00b7</code> and a tab by <code>\u00bb</code>:</p>\n<pre><code>example = (a, b)\n\u00b7\u00b7where\n\u00b7\u00b7\u00b7\u00b7a = &quot;Hello&quot;\n\u00bb   b = &quot;World&quot;\n</code></pre>\n<p>This will look like valid Haskell code if the editor will show tabs aligned to multiples by four. But it isn't. Haskell tabs are aligned by multiples of eight, so the code will be interpreted like this:</p>\n<pre><code>example = (a, b)\n\u00b7\u00b7where\n\u00b7\u00b7\u00b7\u00b7a = &quot;Hello&quot;\n\u00bb       b = &quot;World&quot;\n</code></pre>\n<p>Second, if you use only tabs, you can end up with a layout that doesn't look right. For example, the following code looks correct if a tab gets displayed with six or more spaces (eight in this case):</p>\n<pre><code>example = (a, b)\n\u00bb       where\u00bb  a = &quot;Hello&quot;\n\u00bb       \u00bb       b = &quot;World&quot;\n</code></pre>\n<p>But in another editor that uses 4 spaces it won't look right anymore:</p>\n<pre><code>example = (a, b)\n\u00bb   where\u00bb  a = &quot;Hello&quot;\n\u00bb   \u00bb   b = &quot;World&quot;\n</code></pre>\n<p>It's still correct, though. However, someone who's used to spaces might reindent <code>b</code>' binding  with spaces and end up with a parser error.</p>\n<p>If you enforce a code convention throughout your code that makes sure that you only use tabs at the beginning of a line and use a newline after <code>where</code>, <code>let</code> or <code>do</code> you can avoid some of the problems (see <a href=\"http://dmwit.com/tabs/\" rel=\"noreferrer\">11</a>). However, current releases of <a href=\"https://downloads.haskell.org/ghc/latest/docs/html/users_guide/using-warnings.html\" rel=\"noreferrer\">GHC warn about tabs by default</a>, because they <a href=\"https://stackoverflow.com/questions/35853689/parse-error-on-input-function-haskell\">have</a> <a href=\"https://stackoverflow.com/questions/35060673/parse-error-in-nested-if-do-blocks\">been</a> <a href=\"https://stackoverflow.com/questions/33480140/parse-error-in-pattern-putstrln-possibly-caused-by-a-missing-do\">a</a> <a href=\"https://stackoverflow.com/questions/24842552/haskell-parse-error-on-input\">source</a> <a href=\"https://stackoverflow.com/questions/24372766/parse-error-in-valid-code\">of</a> <a href=\"https://stackoverflow.com/questions/16870038/haskell-syntax-error-for-where-statement\">many</a> parser errors in the past, so you probably want to get rid of them too.</p>\n<h2>See also</h2>\n<ul>\n<li><a href=\"https://www.reddit.com/r/haskell/comments/15gz8q/a_nondirty_shot_at_tabs_vs_spaces/\" rel=\"noreferrer\">A reddit thread on the topic</a> (majority pro spaces, but some pro tabs)</li>\n<li><a href=\"http://urchin.earth.li/%7Eian/style/haskell.html\" rel=\"noreferrer\">Good Haskell Style</a> (pro spaces)</li>\n<li><a href=\"http://dmwit.com/tabs/\" rel=\"noreferrer\">Yet Another Tabs v Space debate</a> (pro mixing)</li>\n</ul>\n"}], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4979, "favorite_count": 10, "accepted_answer_id": 35855171, "answer_count": 1, "score": 34, "last_activity_date": 1597213528, "creation_date": 1457388893, "last_edit_date": 1553771006, "question_id": 35855170, "link": "https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces", "title": "Why shouldn&#39;t I mix tabs and spaces?", "body": "<p>I often read that I shouldn't mix tabs and spaces in Haskell, or that I shouldn't use tabs at all. Why?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1457383785, "post_id": 35853647, "comment_id": 59373183, "body": "for an infinite list it won&#39;t terminate by the given requirement of finding all matches since you can never check all positions."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1457384503, "post_id": 35853647, "comment_id": 59373589, "body": "@karakfa: <code>head . positions &#39;a&#39;</code> <b>will</b> terminate for any list that contains an <code>a</code> at some point, even if the list is infinite and <code>position</code> is lazy enough. Still won&#39;t terminate for infinite lists that don&#39;t contain <code>a</code> of course."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1457384612, "post_id": 35853647, "comment_id": 59373645, "body": "right, didn&#39;t check the usage, I was commenting on the positions function."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1457383893, "post_id": 35853715, "comment_id": 59373239, "body": "thanks! it works! I couldn;t understand why. Could you explain it ?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457384535, "post_id": 35853715, "comment_id": 59373599, "body": "@HaskellFun: Sure, added an explanation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457388443, "post_id": 35853715, "comment_id": 59375648, "body": "FYI, it&#39;s probably best to <code>zip [1..] xs</code> for efficiency (swapping the argument order), particularly with recent GHC versions."}, {"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457388634, "post_id": 35853715, "comment_id": 59375762, "body": "@dfeuer: Could you point me to an explanation of your remark? I&#39;ve never heard of this before!"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 1, "creation_date": 1457389294, "post_id": 35853715, "comment_id": 59376093, "body": "@yatima2975: Probably due to <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.List.html#zip\" rel=\"nofollow noreferrer\"><code>zip</code> being right-lazy and special rules</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 1, "creation_date": 1457389676, "post_id": 35853715, "comment_id": 59376288, "body": "@yatima2975, Zeta got it right regarding the rules. See especially the comments below the <code>foldr2&#47;left</code> rule in the module Zeta linked to. Putting the enumeration first should ensure that the optimization rule fires; putting it second means it will only fire if <code>xs</code> is a &quot;good producer&quot;."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457389854, "post_id": 35853715, "comment_id": 59376383, "body": "Hm. Not sure whether I should change the <code>zip</code> above to reflect the right-lazyness."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 1, "creation_date": 1457389871, "post_id": 35853715, "comment_id": 59376393, "body": "@yatima, furthermore, if the result of your function is consumed by a good consumer, GHC may be able to unbox the <code>Int</code>s (I believe), but this will surely be impossible if <code>xs</code> gets the place of honor."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1457393554, "post_id": 35853715, "comment_id": 59377970, "body": "thanks you very much ! However, why you name zip lazy ? After all, for infinite list it is looping"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457417755, "post_id": 35853715, "comment_id": 59385131, "body": "@HaskellFun <code>take 100 (zip [1..] [1..])</code>"}, {"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457421376, "post_id": 35853715, "comment_id": 59386789, "body": "@dfeuer and Zeta: Thanks! I usually tune out the optimization rules :-)"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1457384120, "last_edit_date": 1457384120, "creation_date": 1457383684, "answer_id": 35853715, "question_id": 35853647, "link": "https://stackoverflow.com/questions/35853647/haskell-lazy-function-for-finding-positions-of-character-in-text/35853715#35853715", "title": "Haskell - lazy function for finding positions of character in text", "body": "<p><code>zip xs ys</code> will stop as soon as one of the two lists is exhausted. It's also lazy:</p>\n\n<pre><code>zip (x:xs) (y:ys) = (x,y) : zip xs ys\nzip _      _      = []\n</code></pre>\n\n<p>Therefore, you don't have to get the length first, you can just <code>zip</code> with an infinite list:</p>\n\n<pre><code>zip xs [1..]\n</code></pre>\n\n<p>If <code>xs</code> is finite, the result will be finite, and if <code>xs</code> is infinite, the result will also be an infinite list.</p>\n\n<p>By the way, you can simplify your function and make it more general:</p>\n\n<pre><code>positions :: Eq a =&gt; a -&gt; [a] -&gt; [Int]\npositions c xs = [n | (l, n) &lt;- zip xs [1..], l == c]\n</code></pre>\n\n<p>After all, if <code>xs</code> is empty, <code>zip xs [1..]</code> will be empty too, and the list comprehension is also the empty list in this case. Also, you want to have a look at <code>findIndices</code> in <code>Data.List</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 35853715, "answer_count": 1, "score": 1, "last_activity_date": 1457384120, "creation_date": 1457383460, "question_id": 35853647, "link": "https://stackoverflow.com/questions/35853647/haskell-lazy-function-for-finding-positions-of-character-in-text", "title": "Haskell - lazy function for finding positions of character in text", "body": "<p>It is correct proposition. </p>\n\n<pre><code>positions :: Char -&gt; String -&gt; [Int]\npositions c [] = []\npositions c xs = [x | (l, x) &lt;- zip xs [1..length xs], l == c]\n</code></pre>\n\n<p>It seems to be elegant and in haskell style. However, I consider is it possible to implement lazy function for this. I mean that for infinity list it also works. \nFor example, </p>\n\n<pre><code>let li = 'a':list\nhead $ positions 'a' li\n= 1\n</code></pre>\n\n<p>My solution is looping because of length (it is not possible count length for list - looping).</p>\n\n<p>Could you help me ?</p>\n"}, {"tags": ["sql", "haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457383579, "post_id": 35852910, "comment_id": 59373056, "body": "Do you know if there is any issue using this approach? I have to use a database which wasn&#39;t defined very well, but changing the column names now is unmanageable."}, {"owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "reply_to_user": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457384306, "post_id": 35852910, "comment_id": 59373476, "body": "@FtheBuilder I doubt there are downsides, it sounds like a rather simple operation. If you do find an issue, the persistent project does look quite actively developed so it&#39;s quite likely it&#39;ll get fixed."}], "tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 2, "last_activity_date": 1457380921, "creation_date": 1457380921, "answer_id": 35852910, "question_id": 35851372, "link": "https://stackoverflow.com/questions/35851372/yesod-persistent-using-two-names-for-a-column/35852910#35852910", "title": "Yesod Persistent - Using two names for a column", "body": "<p>From <a href=\"https://github.com/yesodweb/persistent/wiki/Persistent-entity-syntax#change-tablecollection-id-field-name-andor-type-persistent--21\" rel=\"nofollow\">https://github.com/yesodweb/persistent/wiki/Persistent-entity-syntax#change-tablecollection-id-field-name-andor-type-persistent--21</a>:</p>\n\n<pre><code>MyEntity\n    boo Text sql=foo\n</code></pre>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 35852910, "answer_count": 1, "score": 1, "last_activity_date": 1457380921, "creation_date": 1457375965, "question_id": 35851372, "link": "https://stackoverflow.com/questions/35851372/yesod-persistent-using-two-names-for-a-column", "title": "Yesod Persistent - Using two names for a column", "body": "<p>Suppose I have a column <code>foo</code> and I want to use it in Haskell as <code>boo</code>, how could I do something similar to this:</p>\n\n<pre><code>MyEntity\n  boo 'foo' Text\n</code></pre>\n\n<p>Is it even possible?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1457372481, "post_id": 35850211, "comment_id": 59366284, "body": "Not sure about ODBC, but try running <code>printMigration</code> instead of <code>runMigration</code>. That will tell you the query that you need to manually run."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1457373001, "post_id": 35850211, "comment_id": 59366609, "body": "@Sibi It solved my problem, I think you should make an answer"}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1457377934, "creation_date": 1457377934, "answer_id": 35851995, "question_id": 35850211, "link": "https://stackoverflow.com/questions/35850211/yesod-persistent-getting-migrations-sql-instructions/35851995#35851995", "title": "Yesod - Persistent - getting migrations sql instructions", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Sql.html#v:printMigration\" rel=\"nofollow\">printMigration</a> to see what migrations you have to manually run. Just replace the <code>runMigration</code> function with <code>printMigration</code> and it should do the job.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 35851995, "answer_count": 1, "score": 0, "last_activity_date": 1457377934, "creation_date": 1457372037, "question_id": 35850211, "link": "https://stackoverflow.com/questions/35850211/yesod-persistent-getting-migrations-sql-instructions", "title": "Yesod - Persistent - getting migrations sql instructions", "body": "<p>I am using <code>persistent-odbc</code>, and would like to know how to get the SQL instructions to run manually the create table instructions, instead of automatically doing the migrations.</p>\n"}, {"tags": ["list", "function", "haskell", "recursion", "list-comprehension"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1457370642, "post_id": 35849696, "comment_id": 59365108, "body": "<code>filter</code> and <code>map</code> ?"}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 2, "creation_date": 1457371223, "post_id": 35849696, "comment_id": 59365520, "body": "You don&#39;t need to use parentheses around function arguments in Haskell.  Instead of <code>snd(x)</code>, you should typically use <code>snd x</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1457373112, "post_id": 35849880, "comment_id": 59366673, "body": "There&#39;s also no base case for the empty list."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 3, "last_activity_date": 1457370977, "last_edit_date": 1457370977, "creation_date": 1457370958, "answer_id": 35849880, "question_id": 35849696, "link": "https://stackoverflow.com/questions/35849696/a-function-that-takes-a-list-and-an-integer-returns-an-element-of-the-list/35849880#35849880", "title": "A function that takes a list and an Integer returns an element of the list", "body": "<p>When you recursively call <code>findID'</code> in the otherwise, you are missing the <code>m</code> parameter.</p>\n\n<p>Also note, you are only returning the first matched value, not the full list, so this new function doesn't do the correct thing.</p>\n"}, {"tags": [], "owner": {"reputation": 19188, "user_id": 390708, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/34539ce56dfaf01d34a91861205f379d?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/390708/brian"}, "is_accepted": false, "score": 1, "last_activity_date": 1457374948, "creation_date": 1457374948, "answer_id": 35851059, "question_id": 35849696, "link": "https://stackoverflow.com/questions/35849696/a-function-that-takes-a-list-and-an-integer-returns-an-element-of-the-list/35851059#35851059", "title": "A function that takes a list and an Integer returns an element of the list", "body": "<p>Using <code>map</code> and <code>fitler</code> as @Carsten suggests:</p>\n\n<pre><code>import Data.String\nfindID :: [(String, Integer)] -&gt; String -&gt; [Integer]\nfindID xs name = map snd $ filter ((==name).fst) xs\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>*Main&gt; let xs = [(\"Smith\", 123), (\"Jones\", 456), (\"Tran\", 789), (\"Smith\", 012)]\n*Main&gt; findID xs \"Jones\"\n[456]\n*Main&gt; findID xs \"Smith\"\n[123,12]\n*Main&gt; findID xs []\n[]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5983921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205917323676135/picture?type=large", "display_name": "LukeshotFirst", "link": "https://stackoverflow.com/users/5983921/lukeshotfirst"}, "edited": false, "score": 0, "creation_date": 1457388042, "post_id": 35851901, "comment_id": 59375436, "body": "Thank you all this is very helpful!"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1457377609, "creation_date": 1457377609, "answer_id": 35851901, "question_id": 35849696, "link": "https://stackoverflow.com/questions/35849696/a-function-that-takes-a-list-and-an-integer-returns-an-element-of-the-list/35851901#35851901", "title": "A function that takes a list and an Integer returns an element of the list", "body": "<p>If you want to write your own recursive solution something like this will work</p>\n\n<pre><code>findId [] _ = []\nfindId ((n,i):xs) m | n==m =   i: findId xs m\n                    | otherwise = findId xs m\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5983921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205917323676135/picture?type=large", "display_name": "LukeshotFirst", "link": "https://stackoverflow.com/users/5983921/lukeshotfirst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1457388521, "creation_date": 1457370412, "last_edit_date": 1592644375, "question_id": 35849696, "link": "https://stackoverflow.com/questions/35849696/a-function-that-takes-a-list-and-an-integer-returns-an-element-of-the-list", "title": "A function that takes a list and an Integer returns an element of the list", "body": "<blockquote>\n<p>Write a function named <code>findID</code> that takes:</p>\n<ul>\n<li>a list of pairs of (student last names (String), student ids (3-digit integers)),</li>\n<li>a student name</li>\n</ul>\n<p>and returns:</p>\n<ul>\n<li>a list of student ids that match this name.</li>\n</ul>\n</blockquote>\n<p>this works:</p>\n<pre><code>findID xs m = [ snd(x) | x&lt;-xs, fst(x) ==  m]\n</code></pre>\n<p>result:</p>\n<pre><code>*Main&gt; findID [(&quot;josh&quot;,123),(&quot;becky&quot;,456)] &quot;josh&quot;\n[123]\n</code></pre>\n<p>but I want to not use list comprehension. via something like this:</p>\n<pre><code>findID' (x:xs) m \n    | fst(x) == m = snd(x)\n    | otherwise = findID' xs\n</code></pre>\n<p>what am I missing?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1457368560, "post_id": 35849007, "comment_id": 59363600, "body": "Take a list of numbers from 0 to <i>infinity</i>, map a function over it (iterate over it and, say, multiply all values by 2), then print out the first 10 numbers. \u2013 With laziness you can approach this task exactly as described; without it you&#39;d have to think and code it very differently."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1457368773, "post_id": 35849007, "comment_id": 59363757, "body": "Quote something from your tutorial that you are having a problem with: a definition, a statement, a code snippet \u2014 whatever mentions laziness. Explain what your specific dofficulty is."}], "answers": [{"tags": [], "owner": {"reputation": 2679, "user_id": 1812322, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ab68ec41682314f87def370d3ddbac1f?s=128&d=identicon&r=PG", "display_name": "Bonifacio2", "link": "https://stackoverflow.com/users/1812322/bonifacio2"}, "is_accepted": false, "score": 4, "last_activity_date": 1457368622, "creation_date": 1457368622, "answer_id": 35849089, "question_id": 35849007, "link": "https://stackoverflow.com/questions/35849007/essence-of-laziness-haskell/35849089#35849089", "title": "Essence of Laziness. Haskell", "body": "<p>In Haskell you can create an infinite list. For instance, all natural numbers:</p>\n\n<pre><code>[1,2..]\n</code></pre>\n\n<p>If Haskell loaded all the items in memory at once that wouldn't be possible. To do so you would need infinite memory.</p>\n\n<p>Laziness allows you to get the numbers as you need them.</p>\n"}, {"tags": [], "owner": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "is_accepted": false, "score": 2, "last_activity_date": 1457369031, "creation_date": 1457369031, "answer_id": 35849251, "question_id": 35849007, "link": "https://stackoverflow.com/questions/35849007/essence-of-laziness-haskell/35849251#35849251", "title": "Essence of Laziness. Haskell", "body": "<blockquote>\n  <p>So, I am asking for any excerise / example which show me what laziness is in the fact.</p>\n</blockquote>\n\n<p>Click on Lazy on <a href=\"http://haskell.org\" rel=\"nofollow\">haskell.org</a> to get the canonical example. There are many other examples just like it to illustrate the concept of delayed evaluation that benefits from not executing some parts of the program logic. Lazy is certainly not slow, but the opposite of eager evaluation common to most imperative programming languages.</p>\n"}, {"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1457427196, "post_id": 35849517, "comment_id": 59389878, "body": "&quot;Laziness is a consequence of non-strict function evaluation&quot; is not quite true. In your example, <code>ones</code> is not a function, it&#39;s an (infinite) list. And in an eager language (OCaml for instance) it would indeed lead to an infinite loop. But we could exploit the fact that evaluation is not performed under lambdas to model the same lazy list using e.g. <code>type &#39;a stream = Cons of &#39;a * (unit -&gt; &#39;a)</code> and defininig <code>let rec ones () = Cons (1, ones)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1457441252, "post_id": 35849517, "comment_id": 59399278, "body": "It&#39;s really a finite list with 1 and an unevaluated call to <code>ones</code> since <code>(:)</code> isn&#39;t strict. The &quot;infinite&quot; nature of the list only becomes apparent when you need to fully evaluate the tail with something like <code>tail ones</code> or <code>show ones</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1457370849, "last_edit_date": 1457370849, "creation_date": 1457369828, "answer_id": 35849517, "question_id": 35849007, "link": "https://stackoverflow.com/questions/35849007/essence-of-laziness-haskell/35849517#35849517", "title": "Essence of Laziness. Haskell", "body": "<p>Laziness is a consequence of non-strict function evaluation. Consider the \"infinite\" list of 1s:</p>\n\n<pre><code>ones = 1:ones\n</code></pre>\n\n<p>At the time of definition, the <code>(:)</code> function isn't evaluated; <code>ones</code> is just a promise to do so when it is necessary. Such a time would be when you pattern match:</p>\n\n<pre><code>myHead :: [a] -&gt; a\nmyHead (x:rest) = x\n</code></pre>\n\n<p>When <code>myHead ones</code> is called, <code>x</code> and <code>rest</code> are needed, but the pattern match against <code>1:ones</code> simply binds <code>x</code> to 1 and <code>rest</code> to <code>ones</code>; we don't need evaluate <code>ones</code> any further at this time, so we don't.</p>\n\n<p>The syntax for infinite lists, using the <code>..</code> \"operator\" for arithmetic sequences, is sugar for calls to <code>enumFrom</code> and <code>enumFromThen</code>. That is</p>\n\n<pre><code>-- An infintite list of ones\nones = [1,1..] -- enumFromThen 1 1\n\n-- The natural numbers\nnats = [1..] -- enumFrom 1\n</code></pre>\n\n<p>so again, laziness just comes from the non-strict evaluation of <code>enumFrom</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1457370631, "creation_date": 1457370631, "answer_id": 35849773, "question_id": 35849007, "link": "https://stackoverflow.com/questions/35849007/essence-of-laziness-haskell/35849773#35849773", "title": "Essence of Laziness. Haskell", "body": "<p>Unlike with other languages, Haskell decouples the creation and definition of an object....  You can easily watch this in action using <code>Debug.Trace</code>.</p>\n\n<p>You can define a variable like this</p>\n\n<pre><code>aValue = 100\n</code></pre>\n\n<p>(the value on the right hand side could include a complicated evaluation, but let's keep it simple)</p>\n\n<p>To see if this code ever gets called, you can wrap the expression in <code>Debug.Trace.trace</code> like this</p>\n\n<pre><code>import Debug.Trace\n\naValue = trace \"evaluating aValue\" 100\n</code></pre>\n\n<p>Note that this doesn't change the definition of <code>aValue</code>, it just forces the program to output \"evaluating aValue\" whenever this expression is actually created at runtime.</p>\n\n<p>(Also note that <code>trace</code> is considered unsafe for production code, and should only be used to debug).</p>\n\n<p>Now, try two experiments....  Write two different <code>main</code>s</p>\n\n<pre><code>main = putStrLn $ \"The value of aValue is \" ++ show aValue\n</code></pre>\n\n<p>and</p>\n\n<pre><code>main = putStrLn \"'sup\"\n</code></pre>\n\n<p>When run, you will see that the first program actually creates aValue (you will see the \"creating aValue\" message, while the second does not.</p>\n\n<p>This is the idea of laziness....  You can put as many definitions in a program as you want, but only those that are used will be actually created at runtime.</p>\n\n<p>The real use of this can be seen with objects of infinite size.  Many lists, trees, etc. have an infinite number of elements.  Your program will use only some finite number of values, but you don't want to muddy the definition of the object with this messy fact.  Take for instance the infinite lists given in other answers here....</p>\n\n<pre><code>[1..] -- = [1,2,3,4,....]\n</code></pre>\n\n<p>You can again see laziness in action here using trace, although you will have to write out a variant of [1..] in an expanded form to do this.</p>\n\n<pre><code>f::Int-&gt;[Int]\nf x = trace (\"creating \" ++ show x) (x:f (x+1)) --remember, the trace part doesn't change the expression, it is just used for debugging\n</code></pre>\n\n<p>Now you will see that only the elements you use are created.</p>\n\n<pre><code>main = putStrLn $ \"the list is \" ++ show (take 4 $ f 1)\n</code></pre>\n\n<p>yields\n    creating 1\n    creating 2\n    creating 3\n    creating 4\n    the list is [1,2,3,4]</p>\n\n<p>and</p>\n\n<pre><code>main = putStrLn \"yo\"\n</code></pre>\n\n<p>will not show any item being created.</p>\n"}, {"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 3, "last_activity_date": 1457370855, "creation_date": 1457370855, "answer_id": 35849846, "question_id": 35849007, "link": "https://stackoverflow.com/questions/35849007/essence-of-laziness-haskell/35849846#35849846", "title": "Essence of Laziness. Haskell", "body": "<p>Here's something interesting: dynamic programming, the bane of every intro. algorithms student, becomes <em>simple</em> and <em>natural</em> when written in a lazy and functional language. Take <a href=\"http://jelv.is/blog/Lazy-Dynamic-Programming/\" rel=\"nofollow\">the example of string edit distance</a>. This is the problem of measuring how similar two DNA strands are or how many bytes changed between two releases of a binary executable or just how 'different' two strings are. The dynamic programming algorithm, expressed mathematically, is simple:</p>\n\n<pre><code>let:\n\n\u2022 d_{i,j} be the edit distance of\n  the first string at index i, which has length m\n  and the second string at index j, which has length m\n\u2022\u00a0let a_i be the i^th character of the first string\n\u2022\u00a0let b_j be the j^th character of the second string\n\ndefine:\n\nd_{i,0} = i                   (0 &lt;= i &lt;= m)\nd_{0,j} = j                   (0 &lt;= j &lt;= n)\nd_{i,j} = d_{i - 1, j - 1}    if a_i == b_j\nd_{i,j} = min {               if a_i != b_j\n  d_{i - 1, j} + 1 (delete)\n  d_{i, j - 1} + 1 (insert)\n  d_{i - 1, j - 1} + 1 (modify)\n}\n\nreturn d_{m, n}\n</code></pre>\n\n<p>And the algorithm, expressed in Haskell, follows the same shape of the algorithm:</p>\n\n\n\n<pre><code>distance a b = d m n\n  where (m, n) = (length a, length b)\n        a'     = Array.listArray (1, m) a\n        b'     = Array.listArray (1, n) b\n\n        d i 0 = i\n        d 0 j = j\n        d i j\n          | a' ! i ==  b' ! j = ds ! (i - 1, j - 1)\n          | otherwise = minimum [ ds ! (i - 1, j)     + 1\n                                , ds ! (i, j - 1)     + 1\n                                , ds ! (i - 1, j - 1) + 1\n                                ]\n\n        ds = Array.listArray bounds\n               [d i j | (i, j) &lt;- Array.range bounds]\n        bounds = ((0, 0), (m, n))\n</code></pre>\n\n<p>In a strict language we wouldn't be able to define it so straightforwardly because the cells of the array would be strictly evaluated. In Haskell we're able to have the definition of each cell reference the definitions of other cells because Haskell is lazy \u2013 the definitions are only evaluated at the very end when <code>d m n</code> asks the array for the value of the last cell. \u0010A lazy language lets us set up a graph of standing dominoes; it's only when we ask for a value that we need to compute the value, which topples the first domino, which topples all the other dominoes. (In a strict language, we would have to set up an array of closures, doing the work that the Haskell compiler does for us automatically. It's easy to transform implementations between strict and lazy languages; it's all a matter of which language expresses which idea better.)</p>\n\n<p>The <a href=\"http://jelv.is/blog/Lazy-Dynamic-Programming/\" rel=\"nofollow\">blog post</a> does a much better job of explaining all this.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 1, "closed_date": 1457373428, "accepted_answer_id": 35849846, "answer_count": 5, "score": -2, "last_activity_date": 1457370855, "creation_date": 1457368382, "question_id": 35849007, "link": "https://stackoverflow.com/questions/35849007/essence-of-laziness-haskell", "closed_reason": "Needs more focus", "title": "Essence of Laziness. Haskell", "body": "<p>I am learning a haskell for a few days and the laziness is something like buzzword. Because of the fact I am not familiar with laziness ( I have been working mainly with non-functional languages ) it is not easy concept for me.</p>\n\n<p>So, I am asking for any excerise / example which show me what laziness is in the fact. </p>\n\n<p>Thanks in advance ;)</p>\n"}, {"tags": ["qt", "ubuntu", "haskell", "sublimetext3"], "comments": [{"owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "edited": false, "score": 0, "creation_date": 1457395540, "post_id": 35847550, "comment_id": 59378706, "body": "Not that I advocate using it, and it&#39;s not an answer to your question, but there&#39;s also a qt package for haskell."}], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1457366775, "post_id": 35847788, "comment_id": 59362267, "body": "thanks, it works! but please have a look at my edit."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "reply_to_user": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1457366910, "post_id": 35847788, "comment_id": 59362363, "body": "nice! give me a sec and I&#39;ll edit the answer to explain the typechecking process more deeply in this case"}], "tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 2, "last_activity_date": 1457367465, "last_edit_date": 1457367465, "creation_date": 1457365110, "answer_id": 35847788, "question_id": 35847550, "link": "https://stackoverflow.com/questions/35847550/qt-button-click-a-message-should-appear-in-a-haskell-program/35847788#35847788", "title": "Qt : button click =&gt; a message should appear in a haskell program", "body": "<p>There error tells you that GHC doesn't know what type the signal created by <a href=\"http://hackage.haskell.org/package/hsqml-0.3.4.0/docs/Graphics-QML-Objects.html#v:newSignalKey\" rel=\"nofollow\"><code>newSignalKey</code></a> should have (<code>newSignalKey :: SignalSuffix p =&gt; IO (SignalKey p)</code>. GHC does not know what <code>p</code> should be, since you don't specify it). Adding an explicit type signature like this:</p>\n\n<pre><code>skey &lt;- newSignalKey :: IO (SignalKey (IO ()))\n</code></pre>\n\n<p>should fix the error that you are seeing.</p>\n\n<p>Ok, so now why does it work in the second example? To understand that, we have to look at what GHC knows and what it can determine about the type of <code>skey</code>.</p>\n\n<p>In the first example and in the second example, <code>skey</code> is used as follows:</p>\n\n<pre><code>do\n  ...\n  fireSignal skey obj\n  ...\n</code></pre>\n\n<p>Because <code>fireSignal :: SignalKey p -&gt; ObjRef () -&gt; p</code> (simplified type, the full type of <code>fireSignal</code> is more general), GHC knows that <code>p</code> must be <code>IO something</code>, because it is used in a context where an <code>IO something</code> action is expected (as part of a do block in <code>IO</code>). It does not know what <code>something</code> is though, since the return value of that <code>IO</code> action is never used. So it is left with <code>skey :: SignalKey (IO something)</code>, and rightly reports an error that <code>something</code> is ambiguous (it doesn't know what type <code>something</code> should be).</p>\n\n<p>In the second example, skey is however also used in the following pattern:</p>\n\n<pre><code>forkIO $ do\n  ...\n  fireSignal skey obj\n</code></pre>\n\n<p>Since <code>forkIO</code> expects an <code>IO</code> action that returns a value of type <code>()</code>, GHC now knows that <code>fireSignal skey obj :: IO ()</code> (so in this case, it knows that <code>something</code> must be <code>()</code>). That means that <code>p</code> is no longer ambiguous, it must be <code>IO ()</code>.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 35847788, "answer_count": 1, "score": 2, "last_activity_date": 1457367465, "creation_date": 1457364508, "last_edit_date": 1457366724, "question_id": 35847550, "link": "https://stackoverflow.com/questions/35847550/qt-button-click-a-message-should-appear-in-a-haskell-program", "title": "Qt : button click =&gt; a message should appear in a haskell program", "body": "<p>I try to create a program which displays a text when a button is clicked, using haskell &amp; Qt, on ubuntu using sublime text 3.\nBut apparently there is a problem when defining the signal key (the key which will identify the signal called when the button is clicked).\nMoreover, it's hard to find a documentation about HsQML, the binding joining haskell &amp; Qt.</p>\n\n<p>code:</p>\n\n<pre><code>module Main where\n\nimport Graphics.QML\nimport Control.Concurrent\nimport Control.Exception\nimport Data.IORef\nimport Data.Text (Text)\nimport qualified Data.Text as T\n\n    main :: IO ()\n    main = do\n        state &lt;- newIORef $ T.pack \"\"\n        skey &lt;- newSignalKey\n        clazz &lt;- newClass [\n            defPropertySigRO' \"my_label\" skey (\\_ -&gt; readIORef state),\n            defMethod' \"sayHello\" (\\obj txt -&gt; do\n                writeIORef state txt\n                fireSignal skey obj\n                return ())]\n        ctx &lt;- newObject clazz ()\n        runEngineLoop defaultEngineConfig {\n            initialDocument = fileDocument \"exemple2.qml\",\n            contextObject = Just $ anyObjRef ctx}\n</code></pre>\n\n<p>error message:</p>\n\n<pre><code>Build FAILED\n\n/home/lowley/Documents/haskell/Qt/exemple-2.hs: line 13, column 10:\n  No instance for (SignalSuffix (IO a0))\n    arising from a use of `newSignalKey'\n  The type variable `a0' is ambiguous\n  Possible fix: add a type signature that fixes these type variable(s)\n  Note: there is a potential instance available:\n    instance SignalSuffix (IO ()) -- Defined in `Graphics.QML.Objects'\n  Possible fix:\n    add an instance declaration for (SignalSuffix (IO a0))\n  In a stmt of a 'do' block: skey &lt;- newSignalKey\n  In the expression:\n    do { state &lt;- newIORef $ T.pack \"\";\n         skey &lt;- newSignalKey;\n         clazz &lt;- newClass\n                    [defPropertySigRO' \"my_label\" skey (\\ _ -&gt; readIORef state),\n                     defMethod' \"sayHello\" (\\ obj txt -&gt; ...)];\n         ctx &lt;- newObject clazz ();\n         .... }\n  In an equation for `main':\n      main\n        = do { state &lt;- newIORef $ T.pack \"\";\n               skey &lt;- newSignalKey;\n               clazz &lt;- newClass\n                          [defPropertySigRO' \"my_label\" skey (\\ _ -&gt; ...), ....];\n               .... }\n</code></pre>\n\n<p>SOLVED!\nbut I wonder why this program can be compiled without the above error:</p>\n\n<pre><code>module Main where\n\nimport Graphics.QML\nimport Control.Concurrent\nimport Control.Exception\nimport Data.IORef\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = do\n    state &lt;- newIORef $ T.pack \"\"\n    skey &lt;- newSignalKey\n    clazz &lt;- newClass [\n        defPropertySigRO' \"result\" skey (\\_ -&gt;\n            readIORef state),\n        defMethod' \"factorial\" (\\obj txt -&gt; do\n            let n = read $ T.unpack txt :: Integer\n            writeIORef state $ T.pack \"Working...\"\n            fireSignal skey obj\n            forkIO $ do\n                let out = T.take 1000 . T.pack . show $ product [1..n]\n                evaluate out\n                writeIORef state out\n                fireSignal skey obj\n            return ())]\n    ctx &lt;- newObject clazz ()\n    runEngineLoop defaultEngineConfig {\n        initialDocument = fileDocument \"factorial2.qml\",\n        contextObject = Just $ anyObjRef ctx}\n</code></pre>\n"}, {"tags": ["haskell", "authentication", "authorization", "yesod", "templating"], "answers": [{"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 2, "last_activity_date": 1457366307, "creation_date": 1457366307, "answer_id": 35848264, "question_id": 35847208, "link": "https://stackoverflow.com/questions/35847208/adding-authentication-to-existing-yesod-project-with-haskell/35848264#35848264", "title": "Adding Authentication to existing Yesod project with Haskell", "body": "<p>Typically people make their <code>App</code> datatype a record with multiple fields. For example, the <a href=\"https://github.com/yesodweb/yesod-scaffold/blob/281e8a067b30da6b66d0a642213f2ad5fe6c6239/Foundation.hs#L19-L25\" rel=\"nofollow\">scaffolded Yesod project</a> uses this code:</p>\n\n<pre><code>data App = App\n    { appSettings    :: AppSettings\n    , appStatic      :: Static -- ^ Settings for static file serving.\n    , appConnPool    :: ConnectionPool -- ^ Database connection pool.\n    , appHttpManager :: Manager\n    , appLogger      :: Logger\n    }\n</code></pre>\n\n<p>The <a href=\"http://www.yesodweb.com/book/initializing-foundation-data#initializing-foundation-data_conclusion\" rel=\"nofollow\">example code</a> you linked to does that as well:</p>\n\n<pre><code>data App = App\n    { homepageContent :: Html\n    , visitorCount    :: IORef Int\n    }\n</code></pre>\n\n<p>So what about something like this:</p>\n\n<pre><code>-- Small caveat: this is code untested\ndata App = App\n        { backend :: SqlBackend\n        , chan    :: TChan Text\n        }\n\nmain :: IO ()\nmain = do\n    chan &lt;- newTChanIO\n    runNoLoggingT $ withSqliteConn \"email.db3\" $ \\conn -&gt; liftIO $ do\n        runSqlConn (runMigration migrateAll) conn\n        warp 3000 $ App { backend=conn, chan=chan}\n</code></pre>\n\n<p>You would have to change old code accessing your <code>TChan</code>, but once your App is a record, you can add more fields without making changes to the rest of your codebase.</p>\n\n<p>As a side note, have you considered using the <a href=\"http://www.yesodweb.com/book/scaffolding-and-the-site-template\" rel=\"nofollow\">Yesod scaffolding</a>? You'd start off with all this handled for you, with a bunch of other niceties and best practices already implemented for you.</p>\n"}], "owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 35848264, "answer_count": 1, "score": 0, "last_activity_date": 1457366307, "creation_date": 1457363571, "question_id": 35847208, "link": "https://stackoverflow.com/questions/35847208/adding-authentication-to-existing-yesod-project-with-haskell", "title": "Adding Authentication to existing Yesod project with Haskell", "body": "<p>I have been using <a href=\"http://www.yesodweb.com/book/authentication-and-authorization\" rel=\"nofollow\">this guide</a> in order to add authentication and authorisation to my project. I am new to Yesod and have been running into some problems:</p>\n\n<p>I am using the following foundation data:</p>\n\n<p><code>data App = App (TChan Text)</code></p>\n\n<p>For my authentication i need this data type:</p>\n\n<p><code>data App = App SqlBackend</code></p>\n\n<p>How can i combine the two? Do i then also have to change existing functions?</p>\n\n<p>In the end i run everything like this:</p>\n\n<pre><code>main :: IO ()\nmain = runNoLoggingT $ withSqliteConn \"email.db3\" $ \\conn -&gt; liftIO $ do\n    runSqlConn (runMigration migrateAll) conn\n    chan &lt;- newTChanIO\n    warp 3000 $ App chan\n-- Backend SqlBackend needs to be initilized with conn (see below)\n\n\n{- OLD\nmain = do\n    chan &lt;- newTChanIO\n    warp 3000 $ App chan\n-}\n\n{- NEW\nmain = runNoLoggingT $ withSqliteConn \"email.db3\" $ \\conn -&gt; liftIO $ do\n    runSqlConn (runMigration migrateAll) conn\n    warp 3000 $ App conn\n-}\n</code></pre>\n\n<p>I know that i have to combine the two. I read <a href=\"http://www.yesodweb.com/book/initializing-foundation-data\" rel=\"nofollow\">this article</a>. How do i get <code>chan</code> and also <code>conn</code> together? It might sound trivial, but there is little documentation out there.</p>\n\n<p>Please help me!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1457362601, "post_id": 35846753, "comment_id": 59359094, "body": "Try <code>take 5 [ (a,b,c) | a &lt;- [1..], b &lt;- [1..], c &lt;- [1..]]</code> and you should see why"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1457363693, "post_id": 35846753, "comment_id": 59359947, "body": "It <b>never</b> makes sense to have multiple generators (i.e. <code>&lt;-</code>) with infinite length... only the last one will ever produce more than one value."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 2, "creation_date": 1457374225, "post_id": 35846753, "comment_id": 59367349, "body": "See <a href=\"https://hackage.haskell.org/package/control-monad-omega-0.3.1\" rel=\"nofollow noreferrer\">omega</a>. It would make this work."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1457364387, "post_id": 35846849, "comment_id": 59360483, "body": "Depending on your expected answer, you might want <code>a&lt;-[1..c]</code> instead. This would allow both (3,4,5) and (4,3,5) to appear in the full list of solutions."}], "tags": [], "owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "is_accepted": true, "score": 7, "last_activity_date": 1457362906, "last_edit_date": 1457362906, "creation_date": 1457362599, "answer_id": 35846849, "question_id": 35846753, "link": "https://stackoverflow.com/questions/35846753/why-this-haskell-expression-wont-get-a-result/35846849#35846849", "title": "Why this Haskell expression won&#39;t get a result?", "body": "<p>You want the list for b to be related to c, and the list for a to be related to b.</p>\n\n<p>The reason for this is a is started at 1, b is starting at 1, and then c is just counting up indefinitely. There are no triangles that have sides 1, 1, x>1. </p>\n\n<p>A solution that should work would be \n<code>take 100 [(a,b,c) | c&lt;-[1..], b&lt;-[1..c], a&lt;-[1..b], a^2 + b^2 == c^2]</code></p>\n\n<p>This solution works because now a will count up from 1 to b, simultaneously, b will count up from 1 to c, and the c just counts up like normal. </p>\n"}, {"tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": false, "score": 1, "last_activity_date": 1457363745, "creation_date": 1457363745, "answer_id": 35847283, "question_id": 35846753, "link": "https://stackoverflow.com/questions/35846753/why-this-haskell-expression-wont-get-a-result/35847283#35847283", "title": "Why this Haskell expression won&#39;t get a result?", "body": "<p>It wont't work because you asking to generate triple in the following manner </p>\n\n<blockquote>\n  <p>[(1,1,1),(1,1,4),(1,1,9),(1,1,16),(1,1,25),(1,1,36),(1,1,49),(1,1,64),(1,1,81),(1,1,100),(1,1,121),(1,1,144),(1,1,169),(1,1,196),(1,1,225),(1,1,256),(1,1,289),(1,1,324),(1,1,361),(1,1,400),(1,1,441),(1,1,484),(1,1,529),(1,1,576),(1,1,625),(1,1,676),(1,1,729),(1,1,784),(1,1,841),(1,1,900),(1,1,961),(1,1,1024),(1,1,1089),(1,1,1156),(1,1,1225),(1,1,1296),(1,1,1369),(1,1,1444),(1,1,1521),(1,1,1600),(1,1,1681),(1,1,1764),(1,1,1849),(1,1,1936),(1,1,2025),(1,1,2116),(1,1,2209),(1,1,2304),(1,1,2401),(1,1,2500),(1,1,2601),(1,1,2704),(1,1,2809),(1,1,2916),(1,1,3025),(1,1,3136),(1,1,3249),(1,1,3364),(1,1,3481),(1,1,3600),(1,1,3721),(1,1,3844),(1,1,3969),(1,1,4096),(1,1,4225),(1,1,4356),(1,1,4489),(1,1,4624),(1,1,4761),(1,1,4900),(1,1,5041),(1,1,5184),(1,1,5329),(1,1,5476),(1,1,5625),(1,1,5776),(1,1,5929),(1,1,6084),(1,1,6241),(1,1,6400),(1,1,6561),(1,1,6724),(1,1,6889),(1,1,7056),(1,1,7225),(1,1,7396),(1,1,7569),(1,1,7744),(1,1,7921),(1,1,8100),(1,1,8281),(1,1,8464),(1,1,8649),(1,1,8836),(1,1,9025),(1,1,9216),(1,1,9409),(1,1,9604),(1,1,9801),(1,1,10000),(1,1,10201),(1,1,10404),(1,1,10609),(1,1,10816),(1,1,11025),(1,1,11236),(1,1,11449),(1,1,11664),(1,1,11881),(1,1,12100),(1,1,12321),(1,1,12544),(1,1,12769),(1,1,12996),(1,1,13225),(1,1,13456),(1,1,13689),(1,1,13924),(1,1,14161),(1,1,14400),(1,1,14641),(1,1,14884),(1,1,15129),(1,1,15376),(1,1,15625),(1,1,15876),(1,1,16129),(1,1,16384),(1,1,16641),(1,1,16900),(1,1,17161),(1,1,17424),(1,1,17689),(1,1,17956),(1,1,18225),(1,1,18496),(1,1,18769),(1,1,19044),(1,1,19321),(1,1,19600),(1,1,19881),(1,1,20164),(1,1,20449),(1,1,20736),(1,1,21025),(1,1,21316),(1,1,21609),(1,1,21904),(1,1,22201),(1,1,22500),(1,1,22801),(1,1,23104),(1,1,23409),(1,1,23716),(1,1,24025),(1,1,24336),(1,1,24649),(1,1,24964),(1,1,25281),(1,1,25600),(1,1,25921),(1,1,26244),(1,1,26569),(1,1,26896),(1,1,27225)</p>\n</blockquote>\n\n<p>There is not bound for C, so haskell clearly never finds 100 triple such that 1^2 +1^2 = c^2. </p>\n"}], "owner": {"reputation": 269, "user_id": 4733549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d097201f26670d655f8542121f3267c2?s=128&d=identicon&r=PG&f=1", "display_name": "Csaba Fity&#243;", "link": "https://stackoverflow.com/users/4733549/csaba-fity%c3%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 35846849, "answer_count": 2, "score": 3, "last_activity_date": 1457363745, "creation_date": 1457362347, "question_id": 35846753, "link": "https://stackoverflow.com/questions/35846753/why-this-haskell-expression-wont-get-a-result", "title": "Why this Haskell expression won&#39;t get a result?", "body": "<p>I try to run this in GHCi:</p>\n\n<pre><code>take 100 [ (a,b,c) | a &lt;- [1..], b &lt;- [1..], c &lt;- [1..], a^2 + b^2 == c^2, a&lt;b ]\n</code></pre>\n\n<p>I would expect it to be calculated because of the lazyness of take, but that's not the case. Why?</p>\n"}, {"tags": ["templates", "haskell", "yesod", "pandoc"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 3, "creation_date": 1457358642, "post_id": 35845294, "comment_id": 59356214, "body": "I haven&#39;t used Pandoc, but why not use the <a href=\"https://hackage.haskell.org/package/pandoc\" rel=\"nofollow noreferrer\">pandoc library</a> and call it from native Haskell, rather than calling out to an executable? It seems like that would make it easier to configure, more typesafe, easier to package, etc. etc."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457358895, "post_id": 35845488, "comment_id": 59356392, "body": "Thanks a lot! Where can i find out how to invoke and use it?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 1, "creation_date": 1457359452, "post_id": 35845488, "comment_id": 59356765, "body": "In <a href=\"http://hackage.haskell.org/package/pandoc\" rel=\"nofollow noreferrer\">the hackage documentation</a>. I also added a snippet that should work for something like your use case."}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457360325, "post_id": 35845488, "comment_id": 59357360, "body": "Great answer. Thank you so much!"}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457386186, "post_id": 35845488, "comment_id": 59374496, "body": "<code>Could not find module \u2018Text.Pandoc\u2019</code> do i have to cabal install or stack install or something?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "edited": false, "score": 0, "creation_date": 1457387403, "post_id": 35845488, "comment_id": 59375113, "body": "Yup. <code>cabal install pandoc</code>, if you didn&#39;t already do that to get pandoc in the first place. Stack should of course do the trick as well."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1457359271, "last_edit_date": 1457359271, "creation_date": 1457358652, "answer_id": 35845488, "question_id": 35845294, "link": "https://stackoverflow.com/questions/35845294/using-haskell-with-yesod-to-activate-pandoc/35845488#35845488", "title": "Using Haskell with Yesod to activate Pandoc", "body": "<p>You can use the <code>-f</code> and <code>-t</code> flags to specify source and target formats when using <code>pandoc</code> in a pipe.</p>\n\n<pre><code>  createProcess (proc \"pandoc\" [\"-f\", \"markdown\", \"-t\", \"latex\"])\n</code></pre>\n\n<p><em>However</em>, since <a href=\"http://hackage.haskell.org/package/pandoc\" rel=\"nofollow\">pandoc</a> is foremostly a Haskell library (to which the <code>pandoc</code> executable is merely a command-line interface), it would be more idiomatic to invoke the library directly within your Yesod program, instead of using <code>createProcess</code>.</p>\n\n<pre><code>import Text.Pandoc\nimport Text.Pandoc.Error (handleError)\nimport Control.Arrow\n\npandocConverted' :: String -&gt; String \npandocConverted' = readMarkdown def\n               &gt;&gt;&gt; fmap (writeLaTeX def {writerReferenceLinks = True})\n               &gt;&gt;&gt; handleError\n</code></pre>\n"}], "owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 35845488, "answer_count": 1, "score": 0, "last_activity_date": 1457373634, "creation_date": 1457357984, "last_edit_date": 1457373634, "question_id": 35845294, "link": "https://stackoverflow.com/questions/35845294/using-haskell-with-yesod-to-activate-pandoc", "title": "Using Haskell with Yesod to activate Pandoc", "body": "<p>I want to use Yesod and Haskell in order to call Pandoc, to translate some format into some other format.</p>\n\n<pre><code>pandocConverted :: String -&gt; IO String \npandocConverted input = do\n    (Just hIn, Just hOut, _, _) &lt;- createProcess (proc \"pandoc\" []) { std_in = CreatePipe, std_out = CreatePipe }\n    hPutStr hIn input    \n    converted  &lt;- hGetContents hOut\n    return converted\n</code></pre>\n\n<p>This works well. But how do I translate into a different format?</p>\n\n<p>e.g. how do I call pandoc like this?</p>\n\n<p><code>pandoc -s README -o example4.tex</code></p>\n\n<p>or this?</p>\n\n<p><code>pandoc -s -S -t docbook README -o example9.db</code></p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1457357397, "post_id": 35844835, "comment_id": 59355322, "body": "<code>-Wall</code> will point out errors like this."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1457357527, "post_id": 35844835, "comment_id": 59355427, "body": "You misspelled <code>addToDT</code> as <code>addtoDT</code> (lowercase &quot;t&quot;) in the empty-list case."}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 6026302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b2a57659daba9701e24faec9fa37321?s=128&d=identicon&r=PG&f=1", "display_name": "villou24", "link": "https://stackoverflow.com/users/6026302/villou24"}, "edited": false, "score": 0, "creation_date": 1457358096, "post_id": 35845067, "comment_id": 59355839, "body": "Mmmh\u2026 that&#39;s embarrassing. Thanks a lot!"}], "tags": [], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "is_accepted": true, "score": 1, "last_activity_date": 1457357365, "creation_date": 1457357365, "answer_id": 35845067, "question_id": 35844835, "link": "https://stackoverflow.com/questions/35844835/strange-pattern-matching-fail-in-haskell/35845067#35845067", "title": "Strange pattern-matching fail in Haskell", "body": "<p>Simply</p>\n\n<pre><code>addtoDT t [] = t    -- this is another function since `to` isn't `To`\n</code></pre>\n\n<p>:)</p>\n"}], "owner": {"reputation": 461, "user_id": 6026302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b2a57659daba9701e24faec9fa37321?s=128&d=identicon&r=PG&f=1", "display_name": "villou24", "link": "https://stackoverflow.com/users/6026302/villou24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1457405171, "accepted_answer_id": 35845067, "answer_count": 1, "score": 0, "last_activity_date": 1457357365, "creation_date": 1457356703, "question_id": 35844835, "link": "https://stackoverflow.com/questions/35844835/strange-pattern-matching-fail-in-haskell", "closed_reason": "Not suitable for this site", "title": "Strange pattern-matching fail in Haskell", "body": "<p>I've wrote the following function:</p>\n\n<pre><code>addToDT :: (Ord a) =&gt; DocumentTable a -&gt; [a] -&gt; DocumentTable a\naddtoDT t [] = t\naddToDT t (x:xs) =\n   addToDT DocumentTable { tableLength = tableLength t + maybe 0 (const 1) (M.lookup x (table t))\n                         , table = M.insertWith (+) x 1 (table t)\n                         } xs\n</code></pre>\n\n<p>A <code>DocumentTable</code> being a Map that stores its length:</p>\n\n<pre><code>data DocumentTable a = DocumentTable { table :: Map a Int\n                                     , tableLength :: Int\n                                     }  \n</code></pre>\n\n<p><code>addToDT</code> makes a map containing for each different <code>a</code> in the list its number of occurence.</p>\n\n<p>When I use it, I get <code>Non-exhaustive patterns in function addToDT</code>. <code>traceShow</code> showed me that it occured when addToDT is called with the empty list. If I replace addToDT by:</p>\n\n<pre><code>addToDT :: (Ord a) =&gt; DocumentTable a -&gt; [a] -&gt; DocumentTable a\naddToDT t xxx\n  | null xxx = t\n  | otherwise = addToDT DocumentTable { tableLength = tableLength t + maybe 0 (const 1)(M.lookup x (table t))\n                                      , table = M.insertWith (+) x 1 (table t)\n                                      } xs\n  where (x:xs) = xxx\n</code></pre>\n\n<p>Then it works\u2026 but I don't really understand why. Could someone explain to me why the pattern matching fails?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1457351741, "post_id": 35842436, "comment_id": 59351629, "body": "Can someone please explain why I got the downvote? Are these kind of questions not encouraged here?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457361399, "post_id": 35842436, "comment_id": 59358119, "body": "Are you aware of <a href=\"https://hackage.haskell.org/package/resourcet-1.1.7/docs/Control-Monad-Trans-Resource.html#v:resourceForkIO\" rel=\"nofollow noreferrer\"><code>resourceForkIO</code></a>. From the docs - &quot;If you are allocating a resource that should be shared by multiple threads, and will be held for a long time, you should allocate it at the beginning of a new ResourceT block and then call resourceForkIO from there.&quot; I believe it fits your use case - <code>forever</code> is a long time, and you are worried about concurrent access."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457361555, "post_id": 35842436, "comment_id": 59358234, "body": "To maybe more directly address your question - things will probably break eventually if you use &quot;raw&quot; concurrency in your program. But it seems like the designers of <code>persistent</code> have forseen this problem and included a <code>ResourceT</code> monad in the monad stack so users have an accepted way to deal with it."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457417257, "post_id": 35842436, "comment_id": 59384950, "body": "@user2407038 &quot;you should allocate it at the beginning of a new ResourceT block and then call resourceForkIO from there&quot; what does this mean? Speficially, what is &quot;the beginning of a new ResourceT block&quot;? In my example, is it <code>forever (processIncomingMessages chan)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1457351509, "post_id": 35842881, "comment_id": 59351498, "body": "because <code>startBot</code> is doing DB access."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1457352240, "post_id": 35842881, "comment_id": 59351920, "body": "thanks for updating your answer. Can you please elaborate with a code snippet? I&#39;m unable to understand."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1457354701, "post_id": 35842881, "comment_id": 59353511, "body": "Sorry, i was wrong about <code>forkFinally</code>. You probably need to use some primitive like <code>Chan</code> or <code>MVar</code>."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1457380926, "post_id": 35842881, "comment_id": 59371546, "body": "@SaurabhNanda Updated again. Hope this helps."}, {"owner": {"reputation": 2878, "user_id": 655862, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bad65d3d7319025d73e065d7a29ee22a?s=128&d=identicon&r=PG", "display_name": "Greg Weber", "link": "https://stackoverflow.com/users/655862/greg-weber"}, "edited": false, "score": 0, "creation_date": 1464702719, "post_id": 35842881, "comment_id": 62583839, "body": "If you keep in mind that all persistent operations are designed to work inside a transaction (SqlPersistM) than monad stack usage will make more sense."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 2, "last_activity_date": 1457497515, "last_edit_date": 1457497515, "creation_date": 1457351081, "answer_id": 35842881, "question_id": 35842436, "link": "https://stackoverflow.com/questions/35842436/how-to-compose-forkio-and-sqlpersistm/35842881#35842881", "title": "How to compose forkIO and SqlPersistM", "body": "<p>Yes, for running <code>SqlPersistM</code> you need <code>runSqlite</code>. As for getting race conditions, i think it depends on sqlite itself. Check whether it allows concurrent access.</p>\n\n<p>Because <code>forkIO</code> and other async stuff work only in <code>IO</code> there is no way to drag <code>SqlPersistM</code> inside. Well, since it's basically a <code>ReaderT</code>, you probably can, but i bet it's not how it is intended to be used. So, IMO, you need to fork threads first and then use <code>runSqlite</code> to run persistent actions inside.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1457497515, "creation_date": 1457349829, "last_edit_date": 1457361782, "question_id": 35842436, "link": "https://stackoverflow.com/questions/35842436/how-to-compose-forkio-and-sqlpersistm", "title": "How to compose forkIO and SqlPersistM", "body": "<p>I'm struggling with the best approach to compose <code>forkIO</code> with DB action (<code>SqlPersistM</code>). Note: <code>SqlPersistM</code> is defined <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Sql.html#t:SqlPersistM\" rel=\"nofollow\">here</a>, and is basically a <code>ReaderT SqlBackend (NoLoggingT (ResourceT IO))</code>. Here's a simplified version of the problematic code:</p>\n\n<pre><code>startBot :: SqlPersistM ()\nstartBot = do\n  chan &lt;- liftIO newChan\n  forkIO $ forever (processIncomingMessages chan) -- How to do do this?\n  forkIO $ forever (processOutgoingMessages chan) -- And this?\n  return ()\n\nprocessIncomingMessages :: Chan -&gt; SqlPersistM ()\n\nprocessOutgoingMessages :: Chan -&gt; SqlPersistM ()\n\nmain = runSqlite \":memory:\" startBot\n</code></pre>\n\n<p>Is it even possible to fork <strong>inside</strong> the <code>SqlPersistM</code> action being passed to <code>runSqlite</code>? Or should one be putting the <code>runSqlite</code> action inside the fork? Will the former result in \"race conditions\" sort? Will bot the threads be able to synchronize their use of the underlying DB connection?</p>\n\n<p><strong>More context:</strong> <code>processIncomingMessages</code> receives input from a network API, parses them, and pushes them on to <code>chan</code>. <code>processOutgoingMessages</code> reads from <code>chan</code>, runs some transformations and send data out to a different network API. Both the functions interact with the data while processing the incoming/outgoing messages.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": true, "score": 3, "last_activity_date": 1457353146, "creation_date": 1457353146, "answer_id": 35843591, "question_id": 35841849, "link": "https://stackoverflow.com/questions/35841849/the-conflict-with-expected-and-actual-argument/35843591#35843591", "title": "The conflict with expected and actual argument", "body": "<p>Are you trying to force a function call with the lambda and the extra parenthesis <code>((\\e new_list -&gt; ...)(x new_list))</code>? If so, that doesn't work for one, and even if that syntax would work then your parenthesis would be mismatched.</p>\n\n<p>Forego the 'attempted function call' and the lambda and just use <code>x</code> and <code>new_list</code> directly in <code>nub'</code>, or if you really want to rename use a <code>let e = x in</code> to bind <code>e</code>. That should fix the type errors.</p>\n\n<p>If you really want the lambda, then you should know that function application is done using spaces and not parenthesis, so like <code>(\\x -&gt; x + 1) 3</code>.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 35843591, "answer_count": 1, "score": 0, "last_activity_date": 1457353146, "creation_date": 1457347920, "last_edit_date": 1457351510, "question_id": 35841849, "link": "https://stackoverflow.com/questions/35841849/the-conflict-with-expected-and-actual-argument", "title": "The conflict with expected and actual argument", "body": "<pre><code>belongs :: Eq a =&gt; a -&gt; [a] -&gt; [a]\n\nbelongs e (h:t) = if ( h == e) then [] else belongs e t\nbelongs e [] = [e]\n\n\n\n\nnub :: Eq a =&gt; [a] -&gt; [a]\nnub l = nub' l [] \n    where \n        nub' [] new_list = new_list\n        nub' (x:xs) new_list = (nub' xs ((\\ e new_list -&gt;  \n            case (belongs e new_list) of\n            []    -&gt;  new_list\n            (h:t) -&gt;  (h:new_list))(x new_list)))\n</code></pre>\n\n<blockquote>\n  <p>Couldn't match expected type <code>[a]</code> with actual type <code>[a0] -&gt; [a0]</code> In\n  the return type of a call of <code>nub'</code> Probable cause: <code>nub'</code> is applied to\n  too few arguments In the expression: <code>nub' l []</code> In an equation for\n  <code>nub</code>:</p>\n\n<pre><code> nub l\n  = nub' l []\n  where\n      nub' [] new_list = new_list\n      nub' (x : xs) new_list\n        = (nub'\n             xs\n             ((\\ e new_list\n                 -&gt; case (belongs e new_list) of {\n                      [] -&gt; ...\n                      (h : t) -&gt; ... })\n                (x new_list)))\n</code></pre>\n  \n  <p>Couldn't match expected type <code>[a0] -&gt; [a0]</code> with actual type <code>[a1]</code> In\n  the second argument of <code>nub'</code>, namely <code>[]</code> In the expression: <code>nub' l []</code>\n  In an equation for <code>nub</code>:</p>\n\n<pre><code>nub l\n  = nub' l []\n  where\n      nub' [] new_list = new_list\n      nub' (x : xs) new_list\n        = (nub'\n             xs\n             ((\\ e new_list\n                 -&gt; case (belongs e new_list) of {\n                      [] -&gt; ...\n                      (h : t) -&gt; ... })\n                (x new_list)))\n</code></pre>\n</blockquote>\n\n<p>Why it doesn't work? I cannot understand. Please give me a hand.\nThe errors are understandable but I don't know their causes.</p>\n"}, {"tags": ["file", "haskell", "exception", "locked"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457350962, "post_id": 35842633, "comment_id": 59351174, "body": "i tried to do that but still it tries to load and this happens again. Loaded 0 films. *Main&gt; *** Exception: neo.txt: openFile: resource busy (file is locked)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457361655, "post_id": 35842633, "comment_id": 59358304, "body": "Small remark: if <code>parse</code> in <code>loadFile</code> does not consume the whole input, the handle will still be open."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457363817, "post_id": 35842633, "comment_id": 59360029, "body": "@Zeta Hmm, yes... that&#39;s possibly the problem."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1457350410, "creation_date": 1457350410, "answer_id": 35842633, "question_id": 35840685, "link": "https://stackoverflow.com/questions/35840685/how-do-i-read-and-parse-a-file-and-then-append-to-the-same-file-without-gettin/35842633#35842633", "title": "How do I read (and parse) a file and then append to the same file without getting an exception?", "body": "<p>The problem is that <code>readFile</code> doesn't actually read the entire file into memory immediately; it opens the file and instantly returns a string. As you \"look at\" the string, behind the scenes the file is being read. So when <code>readFile</code> returns, the file it still open for reading, and you can't do anything else with it. This is called \"lazy I/O\", and many people consider it to be \"evil\" precisely because it tends to cause problems like the one you currently have.</p>\n\n<p>There are several ways you can go about fixing this. Probably the simplest is to just force the whole string into memory before continuing. Calculating the <code>length</code> of the string will do that &mdash; but only if you \"use\" the length for something, because the length itself is lazy. (See how this rapidly becomes messy? This is why people avoid lazy I/O.)</p>\n\n<p>The simplest thing you could try is printing the number of films loaded right before you try to append to the database.</p>\n\n<pre><code>main = do\n  putStr \"Enter your Username:  \"\n  name &lt;- getLine\n  filmsDatabase &lt;- loadFile \"neo.txt\"\n  putStrLn $ \"Loaded \" ++ show (length filmsDatabase) ++ \" films.\"\n  appendFile \"neo.txt\" (show filmsDatabase)\n  putStrLn \"Your changes to the database have been successfully saved.\"\n</code></pre>\n\n<p>It's kind of evil that what looks like a simple print message is actually fundamental to making the code work though!</p>\n\n<p>The other alternative is to save the new database under a different name, and then delete the old file and rename the new one over the top of the old one. This does have the advantage that if the program were to crash half way through saving, you haven't just lost all your stuff.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457357567, "post_id": 35844504, "comment_id": 59355461, "body": "fn and runParserT are not in scope though :/"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457357664, "post_id": 35844504, "comment_id": 59355520, "body": "@Max: While <code>fn</code> was a typo, <code>runParserT</code> is exported by <code>Text.Parsec</code>. You have to add it to the import list."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457357673, "post_id": 35844504, "comment_id": 59355528, "body": "i made it work using the answer Sibi said but still the films are not been read do you know what is causing this?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457357816, "post_id": 35844504, "comment_id": 59355631, "body": "@Max: Sure. Your parser and your file format don&#39;t match. But that&#39;s a question for another post, since you never actually showed the content of &quot;neo.txt&quot;."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457357920, "post_id": 35844504, "comment_id": 59355698, "body": "i did the other txt above  please look as your answer is more correct and i want to do yours but it has 25 films instead."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457358305, "post_id": 35844504, "comment_id": 59355971, "body": "@Max: Whoops, sorry. I didn&#39;t see the contents. The thing is, all answers here concern the error (<code>*** Exception: neo.txt: openFile: resource busy (file is locked)</code>). While your parser is part of your question, the <b>parser error</b> (not the exception) wasn&#39;t the original topic. Changing the topic of a question is discouraged. Instead, open a new one. To get more feedback sooner, try to make the code a little bit shorter in the new question, e.g. just post your parser and the original string, not the functions that concern file handling."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457358434, "post_id": 35844504, "comment_id": 59356062, "body": "but still i cannot move to a new post because this answer gives this error \u2018Parsec\u2019 is applied to too many type arguments     In the type signature for \u2018parseFile\u2019:       parseFile :: Parsec String () IO a                    -&gt; FilePath -&gt; IO (Either ParseError a) if you help me get over that i will make a new question so you can come and i will also tick your answer :) so please help me."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457359070, "post_id": 35844504, "comment_id": 59356508, "body": "The <code>T</code> in <code>ParsecT</code> isn&#39;t a typo. <code>Parsec s u a</code> is actually <code>ParsecT s u Identity a</code>, and in this case I want to use <code>IO</code> instead of <code>Identity</code>, therefore <code>ParsecT</code>, not <code>Parsec</code>."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457359457, "post_id": 35844504, "comment_id": 59356769, "body": "when i do that i get like 2 very big errors  <code>Couldn&#39;t match expected type \u2018IO (Either ParseError a)\u2019                 with actual type \u2018IOMode -&gt; (Handle -&gt; IO r0) -&gt; IO r0\u2019     Relevant bindings include</code>   <code>Couldn&#39;t match expected type \u2018Handle -&gt; IO (Either ParseError a)\u2019                 with actual type \u2018[Char]\u2019</code>  I am really sorry that I am so pain for you but i don&#39;t have the experience :/"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457360521, "post_id": 35844504, "comment_id": 59357490, "body": "That&#39;s because I missed the <code>ReadMode</code> as second parameter in <code>withFile</code>. Sorry."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457362697, "post_id": 35844504, "comment_id": 59359162, "body": "can you copy the parseFile here again please? :/"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457366857, "post_id": 35844504, "comment_id": 59362326, "body": "@Max: I did, see <a href=\"https://stackoverflow.com/posts/35844504/revisions\">the latest revision</a>."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457367190, "post_id": 35844504, "comment_id": 59362552, "body": "thank you Zeta i will open a new topic for the parse problem what should i post the parser and the neo.txt?"}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457367214, "post_id": 35844504, "comment_id": 59362571, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/105578/discussion-between-max-and-zeta\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 10, "last_activity_date": 1457360455, "last_edit_date": 1457360455, "creation_date": 1457355816, "answer_id": 35844504, "question_id": 35840685, "link": "https://stackoverflow.com/questions/35840685/how-do-i-read-and-parse-a-file-and-then-append-to-the-same-file-without-gettin/35844504#35844504", "title": "How do I read (and parse) a file and then append to the same file without getting an exception?", "body": "<p>Whoopsy daisy, being lazy<br>\ntends <a href=\"https://stackoverflow.com/questions/5892653/whats-so-bad-about-lazy-i-o\">to make file changes crazy</a>.<br>\nFile's <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO.html#v:hGetContents\">not closed</a>, <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO.html#g:8\">as supposed</a><br>\nthus <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO-Error.html#v:isAlreadyInUseError\">the error</a> gets imposed.<br>\nThis small guile, by <code>loadFile</code><br>\nis what you must reconcile.<br>\nBut don't fret, least not yet,<br>\nI will show you, let's get set.</p>\n\n<hr>\n\n<p>As many other functions that work with <code>IO</code> in <code>System.IO</code>, <code>readFile</code> doesn't actually consume any input. It's lazy. Therefore, the file <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO.html#v:readFile\">doesn't get closed</a>, unless all its content has been consumed (it's then half-closed):</p>\n\n<blockquote>\n  <p>The file is read lazily, on demand, as with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO.html#v:getContents\"><code>getContents</code></a>.</p>\n</blockquote>\n\n<p>We can demonstrate this on a shorter example:</p>\n\n<pre><code>main = do\n  let filename = \"/tmp/example\"\n  writeFile filename \"Hello \"\n  contents &lt;- readFile filename\n  appendFile filename \"world!\"   -- error here\n</code></pre>\n\n<p>This will fail, since we never actually checked <code>contents</code> (entirely). If you get all the content (for example with printing, <code>length</code> or similar), it won't fail anymore:</p>\n\n<pre><code>main = do\n  let filename = \"/tmp/example2\"\n  writeFile filename \"Hello \"\n  content &lt;- readFile filename\n  putStrLn content\n  appendFile filename \"world!\"   -- no error\n</code></pre>\n\n<p>Therefore, we need either something that <strong>really</strong> closes the file, or we need to make sure that we've read all the contents before we try to append to the file.</p>\n\n<p>For example, you can use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO.html#v:withFile\"><code>withFile</code></a> together with some \"magic\" function <code>force</code> that makes sure that the content really gets evaluated:</p>\n\n<pre><code>readFile' filename = withFile filename ReadMode $ \\handle -&gt; do\n  theContent &lt;- hGetContents handle\n  force theContent\n</code></pre>\n\n<p>However, <code>force</code> is tricky to achieve. You could use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/bang-patterns.html\">bang patterns</a>, but this will evaluate the list only to WHNF (basically just the first character). You could use the functions by <a href=\"https://hackage.haskell.org/package/deepseq\"><code>deepseq</code></a>, but that adds another dependency and is probably not allowed in your assignment/exercise.</p>\n\n<p>Or you could use any function that will somehow make sure that all elements are evaluated or sequenced. In this case, we can use a small trick and <code>mapM return</code>:</p>\n\n<pre><code>readFile' filename = withFile filename ReadMode $ \\handle -&gt; do\n  theContent &lt;- hGetContents handle\n  mapM return theContent\n</code></pre>\n\n<p>It's good enough, but you would use something like <code>pipes</code> or <code>conduit</code> instead in production.</p>\n\n<p>The other method is to make sure that we've really used all the contents. This can be done by using another parsec parser method instead, namely <code>runParserT</code>. We can combine this with our <code>withFile</code> approach from above:</p>\n\n<pre><code>parseFile :: ParsecT String () IO a -&gt; FilePath -&gt; IO (Either ParseError a) \nparseFile p filename = withFile filename ReadMode $ \\handle -&gt;\n  hGetContents handle &gt;&gt;= runParserT p () filename\n</code></pre>\n\n<p>Again, <code>withFile</code> makes sure that we close the file. We can use this now in your <code>loadFilm</code>:</p>\n\n<pre><code>loadFile :: FilePath -&gt; IO (Either ParseError [Film])\nloadFile filename = parseFile films filename\n</code></pre>\n\n<p>This version of <code>loadFile</code> won't keep the file locked anymore.</p>\n"}], "owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 3, "accepted_answer_id": 35844504, "answer_count": 2, "score": 4, "last_activity_date": 1457360455, "creation_date": 1457344703, "last_edit_date": 1457357268, "question_id": 35840685, "link": "https://stackoverflow.com/questions/35840685/how-do-i-read-and-parse-a-file-and-then-append-to-the-same-file-without-gettin", "title": "How do I read (and parse) a file and then append to the same file without getting an exception?", "body": "<p>I am trying to read from a file correctly in Haskell but I seem to get this error.</p>\n\n<p>*** Exception: neo.txt: openFile: resource busy (file is locked)\nThis is my code.</p>\n\n<pre><code>import Data.Char\nimport Prelude\nimport Data.List\nimport Text.Printf\nimport Data.Tuple\nimport Data.Ord\nimport Control.Monad\nimport Control.Applicative((&lt;*))\n\nimport Text.Parsec\n    ( Parsec, ParseError, parse        -- Types and parser\n    , between, noneOf, sepBy, many1    -- Combinators\n    , char, spaces, digit, newline     -- Simple parsers\n    )\n</code></pre>\n\n<p>These are the movie fields.</p>\n\n<pre><code>type Title = String\ntype Director = String\ntype Year = Int\ntype UserRatings = (String,Int) \ntype Film = (Title, Director, Year , [UserRatings])\ntype Period = (Year, Year)\ntype Database = [Film]\n</code></pre>\n\n<p>This is the Parsing of all the types in order to read correctly from the file</p>\n\n<pre><code>-- Parse a string to a string\nstringLit :: Parsec String u String\nstringLit = between (char '\"') (char '\"') $ many1 $ noneOf \"\\\"\\n\"\n\n-- Parse a string to a list of strings\nlistOfStrings :: Parsec String u [String]\nlistOfStrings = stringLit `sepBy` (char ',' &gt;&gt; spaces)\n\n-- Parse a string to an int\nintLit :: Parsec String u Int\nintLit = fmap read $ many1 digit\n-- Or `read &lt;$&gt; many1 digit` with Control.Applicative\nstringIntTuple :: Parsec  String u (String  , Int)\nstringIntTuple = liftM2 (,) stringLit intLit\n\nfilm :: Parsec String u Film\nfilm = do\n    -- alternatively `title &lt;- stringLit &lt;* newline` with Control.Applicative\n    title &lt;- stringLit\n    newline\n    director &lt;- stringLit\n    newline\n    year &lt;- intLit\n    newline\n    userRatings &lt;- stringIntTuple\n    newline\n    return (title, director, year, [userRatings])\n\nfilms :: Parsec String u [Film]\nfilms = film `sepBy` newline\n</code></pre>\n\n<p>This is the main program (write \"main\" in winghci to start the program)     </p>\n\n<pre><code>-- The Main\nmain :: IO ()\nmain = do\n    putStr \"Enter your Username:  \"\n    name &lt;- getLine\n    filmsDatabase &lt;- loadFile \"neo.txt\"\n    appendFile \"neo.txt\" (show filmsDatabase)\n    putStrLn \"Your changes to the database have been successfully saved.\"\n</code></pre>\n\n<p>This is the loadFile function</p>\n\n<pre><code>loadFile :: FilePath -&gt; IO (Either ParseError [Film])\nloadFile filename = do\ndatabase &lt;- readFile filename \nreturn $ parse films \"Films\" database\n</code></pre>\n\n<p>the other txt file name is neo and includes some movies like this</p>\n\n<pre><code>\"Blade Runner\"\n\"Ridley Scott\"\n1982\n(\"Amy\",5), (\"Bill\",8), (\"Ian\",7), (\"Kevin\",9), (\"Emma\",4), (\"Sam\",7), (\"Megan\",4)\n\n\"The Fly\"\n\"David Cronenberg\"\n1986\n(\"Megan\",4), (\"Fred\",7), (\"Chris\",5), (\"Ian\",0), (\"Amy\",6)\n</code></pre>\n\n<p>Just copy paste everything include a txt file in the same directory and test it to see the error i described.</p>\n"}, {"tags": ["url", "haskell", "routing", "url-routing", "scotty"], "comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 1, "creation_date": 1457344307, "post_id": 35839463, "comment_id": 59347099, "body": "What error do you have? I don&#39;t see anything wrong. Be careful that <code>id</code> is already bound to a function"}, {"owner": {"reputation": 1819, "user_id": 2059662, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/995b46d292bdd2e74f81d247a14cf8bc?s=128&d=identicon&r=PG", "display_name": "Ludwik", "link": "https://stackoverflow.com/users/2059662/ludwik"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1457360310, "post_id": 35839463, "comment_id": 59357350, "body": "No error, just that the routes weren&#39;t being served (ok, so error 404 I guess) . Which one is the correct according to you?"}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1457361066, "post_id": 35839463, "comment_id": 59357878, "body": "first one should be working. I&#39;m not aware of a <code>{param}</code> syntax. Maybe there is something wrong somewhere else. What url are you triyng?"}, {"owner": {"reputation": 1819, "user_id": 2059662, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/995b46d292bdd2e74f81d247a14cf8bc?s=128&d=identicon&r=PG", "display_name": "Ludwik", "link": "https://stackoverflow.com/users/2059662/ludwik"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1457361205, "post_id": 35839463, "comment_id": 59357975, "body": "Found the bracket syntax somewhere else. I&#39;m try again in a few hours. Url was for example localhost:1337/newuser/3/bob"}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1457361377, "post_id": 35839463, "comment_id": 59358099, "body": "are you sure you are sending a <code>POST</code> request? You can test with <code>curl -i -XPOST http:&#47;&#47;localhost:1337&#47;newuser&#47;3&#47;bob</code>"}, {"owner": {"reputation": 1819, "user_id": 2059662, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/995b46d292bdd2e74f81d247a14cf8bc?s=128&d=identicon&r=PG", "display_name": "Ludwik", "link": "https://stackoverflow.com/users/2059662/ludwik"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1457362043, "post_id": 35839463, "comment_id": 59358599, "body": "Ow, that&#39;s it, I forgot that, thanks."}, {"owner": {"reputation": 1819, "user_id": 2059662, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/995b46d292bdd2e74f81d247a14cf8bc?s=128&d=identicon&r=PG", "display_name": "Ludwik", "link": "https://stackoverflow.com/users/2059662/ludwik"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1457362151, "post_id": 35839463, "comment_id": 59358693, "body": "Add an answer if you want to, else I&#39;ll add one explaining my error"}], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": true, "score": 1, "last_activity_date": 1457364612, "creation_date": 1457364612, "answer_id": 35847593, "question_id": 35839463, "link": "https://stackoverflow.com/questions/35839463/unexpected-404-from-scotty/35847593#35847593", "title": "Unexpected 404 from Scotty", "body": "<p>HTTP method is part of route matching in Scotty.\nTo match your <code>POST</code> route, you have to test it with a <code>POST</code> request, or Scotty will answer with a 404 http error.</p>\n"}], "owner": {"reputation": 1819, "user_id": 2059662, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/995b46d292bdd2e74f81d247a14cf8bc?s=128&d=identicon&r=PG", "display_name": "Ludwik", "link": "https://stackoverflow.com/users/2059662/ludwik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 1, "accepted_answer_id": 35847593, "answer_count": 1, "score": 3, "last_activity_date": 1577617534, "creation_date": 1457340374, "last_edit_date": 1577617534, "question_id": 35839463, "link": "https://stackoverflow.com/questions/35839463/unexpected-404-from-scotty", "title": "Unexpected 404 from Scotty", "body": "<p>I'm trying to use Scotty in Haskell, and following a tutorial, I could route a url like so: </p>\n\n<pre><code>get \"/hello/:name\" $ do\n            name &lt;- param \"name\"\n            text (\"Hello \" &lt;&gt; name &lt;&gt; \"!!\")\n</code></pre>\n\n<p>However, what is the syntax to capture multiple route parameters? Neither of the following worked:</p>\n\n<pre><code>post \"/newuser/:id/:name\" $ do\n            id &lt;- param \"id\"\n            name &lt;- param \"name\"\n            json $ User {userId = id, userName = name}\n\nget \"/users/{id}\" $ do\n            id &lt;- param \"id\"\n            json $ filter (matchesId id) allUsers\n</code></pre>\n"}, {"tags": ["haskell", "data-structures", "set"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1457358016, "post_id": 35837199, "comment_id": 59355766, "body": "Keep in mind that Haskell classes are not OOP classes. Indeed, OOP classes are <i>types</i>, while Haskell classes are not types. E.g. you can&#39;t have a variable <code>x</code> of &quot;type&quot; <code>Show</code> or <code>Eq</code>."}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "is_accepted": true, "score": 4, "last_activity_date": 1457333247, "creation_date": 1457333247, "answer_id": 35837741, "question_id": 35837199, "link": "https://stackoverflow.com/questions/35837199/making-a-set-data-type-with-list-data-structure-in-haskell/35837741#35837741", "title": "Making a set data type with list data structure in Haskell", "body": "<p>Your data type here is <code>[a]</code>, which already has such instances available, including <code>Eq</code> and <code>Show</code> (that by the way do the right thing).</p>\n\n<p>If you want to have write your own instances, you should <code>newtype</code> the underlying type, in a fashion similar to:</p>\n\n<pre><code>newtype Set a = Set { getSet :: [a] }\n</code></pre>\n\n<p>Then you can write:</p>\n\n<pre><code>instance Show a =&gt; Show (Set a) where\n    show (Set a) = ...\n\ninstance Eq a =&gt; Eq (Set a) where\n    Set a == Set b = ...\n</code></pre>\n"}], "owner": {"reputation": 539, "user_id": 2763868, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/koC6K.jpg?s=128&g=1", "display_name": "Lucky", "link": "https://stackoverflow.com/users/2763868/lucky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 1, "accepted_answer_id": 35837741, "answer_count": 1, "score": 0, "last_activity_date": 1457333247, "creation_date": 1457330741, "question_id": 35837199, "link": "https://stackoverflow.com/questions/35837199/making-a-set-data-type-with-list-data-structure-in-haskell", "title": "Making a set data type with list data structure in Haskell", "body": "<blockquote>\n  <p>Write insert and member operations in Haskell. Make sure that in ML\n  and Haskell your Set data type is distinct from a list. In Haskell,\n  define your Set type to be an instance of classes Eq and Show.</p>\n</blockquote>\n\n<pre><code>let setAdd l n = if (elem l n) then l else l ++ [n]\nlet setMember l i = l !! i\n</code></pre>\n\n<p>The code I written above just makes it have functions that perform on lists. </p>\n\n<p>Is there a way to make this into a class? Sorry, I'm just learning functional programming. Is there a way to actually make a Set class that has member variables with such as a list?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 1, "creation_date": 1457323867, "post_id": 35836031, "comment_id": 59338803, "body": "The error is that you have defined your own (+) operator, which conflicts with the standard one from the prelude...."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5960886"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1457324033, "post_id": 35836031, "comment_id": 59338836, "body": "@jamshidh So how can I tell the complier when adding these data types it should use the Main.+ or do I have to go MyFloat (a,b) Main.+ MyFloat (b,c) each time?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1457324080, "post_id": 35836031, "comment_id": 59338849, "body": "You can import Prelude hiding (+), but this is considered bad form.  See below for another way."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1457357755, "post_id": 35836031, "comment_id": 59355593, "body": "There&#39;s no operator overloading in Haskell. You can only add new instances to typeclasses, with similar consequences."}], "answers": [{"comments": [{"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1457413975, "post_id": 35836051, "comment_id": 59383776, "body": "As @chi points out, &quot;typical&quot; isn&#39;t strong enough; you can <i>only</i> &quot;overload&quot; functions with typeclasses. Even then overloading isn&#39;t really a particularly helpful way of thinking about what&#39;s going on."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 3, "last_activity_date": 1457323949, "creation_date": 1457323949, "answer_id": 35836051, "question_id": 35836031, "link": "https://stackoverflow.com/questions/35836031/how-to-resolve-an-issue-with-overloading-operators-in-haskell/35836051#35836051", "title": "How to resolve an issue with overloading operators in haskell?", "body": "<p>What you really want to do is make your class an instance of Num</p>\n\n<pre><code>instance Num MyFloat where\n    x + y = &lt;put in your definition here&gt;\n</code></pre>\n\n<p>Note that Num will require a definition of (*), abs, signum, fromInteger, (negate | (-)) also</p>\n\n<p>In haskell, one typically overloads functions using class definitions.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5960886"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 35836051, "answer_count": 1, "score": 0, "last_activity_date": 1457324068, "creation_date": 1457323711, "last_edit_date": 1457324068, "question_id": 35836031, "link": "https://stackoverflow.com/questions/35836031/how-to-resolve-an-issue-with-overloading-operators-in-haskell", "title": "How to resolve an issue with overloading operators in haskell?", "body": "<p>I can get the file to compile fine. However, when I try to test if the operator is overloaded correctly I get the error message: </p>\n\n<pre><code>*Main&gt; MyFloat (2,3) + MyFloat(3,3)\n\n&lt;interactive&gt;:19:15:\nAmbiguous occurrence `+'\nIt could refer to either `Main.+', defined at problem1.hs:3:16\n                      or `Prelude.+',\n                         imported from `Prelude' at problem1.hs:1:1\n                         (and originally defined in `GHC.Num')\n</code></pre>\n\n<p>The code I am using is: </p>\n\n<pre><code>data MyFloat = MyFloat (Int, Int)\n\nMyFloat (a, b) + MyFloat (c, d) = ((fromIntegral a)/ (fromIntegral(order a)) * 10^b) \nPrelude.+ ((fromIntegral c)/ (fromIntegral(order c)) * 10^d)\n\n\n\norder :: Int -&gt; Int \norder b | b == 0 = 0 \n        | otherwise = ((ceiling ((logBase 10 (abs (fromIntegral b))))) Prelude.+ 1)\n</code></pre>\n\n<p>Am I misunderstanding how overload operators correctly, or is there a different problem entirely?</p>\n"}, {"tags": ["haskell", "haskell-wai"], "comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 4, "creation_date": 1457312705, "post_id": 35834514, "comment_id": 59336244, "body": "My guess would be &quot;lazy ByteString&quot;."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1457312978, "post_id": 35834514, "comment_id": 59336297, "body": "It is almost definitely what @DerekElkins said....  If you go to the hackage documentation, you can see that the input param is a lazy Bytestring <a href=\"https://hackage.haskell.org/package/wai-3.0.5.0/docs/Network-Wai.html#t:Response\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/wai-3.0.5.0/docs/&hellip;</a>, whereas there are other functions that create responses from non-lazy Bytestrings."}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 3, "last_activity_date": 1457333799, "last_edit_date": 1457333799, "creation_date": 1457313097, "answer_id": 35834690, "question_id": 35834514, "link": "https://stackoverflow.com/questions/35834514/what-does-lbs-mean-in-the-context-of-wai/35834690#35834690", "title": "What does &quot;LBS&quot; mean in the context of WAI?", "body": "<p>From <a href=\"https://hackage.haskell.org/package/wai-3.0.4.0/docs/Network-Wai.html\" rel=\"nofollow\">the Hackage documentation</a>:</p>\n\n<blockquote>\n  <p>The overriding design principles here are performance and generality. \n      To address performance, this library is built on top of the <code>conduit</code> \n      and <code>blaze-builder</code> packages. The advantages of conduits over lazy IO \n      have been debated elsewhere and so will not be addressed here. \n      However, helper functions like <code>responseLBS</code> allow you to continue using \n      lazy IO if you so desire.</p>\n</blockquote>\n\n<p>so, yes, LBS does stand for <a href=\"https://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString-Lazy.html\" rel=\"nofollow\">Lazy ByteString</a>.</p>\n"}], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 35834690, "answer_count": 1, "score": 1, "last_activity_date": 1457333799, "creation_date": 1457311593, "question_id": 35834514, "link": "https://stackoverflow.com/questions/35834514/what-does-lbs-mean-in-the-context-of-wai", "title": "What does &quot;LBS&quot; mean in the context of WAI?", "body": "<p>There are several identifiers in <a href=\"https://hackage.haskell.org/package/wai\" rel=\"nofollow\">WAI</a> containing \"LBS\":</p>\n\n<ul>\n<li><p><a href=\"https://hackage.haskell.org/package/wai-0.4.3/docs/Network-Wai.html#v:responseLBS\" rel=\"nofollow\"><code>Network.Wai.responseLBS</code></a><code>:: Status -&gt; ResponseHeaders -&gt; ByteString -&gt; Response</code></p></li>\n<li><p><code>-- | Store uploaded files in memory</code><br>\n<a href=\"https://github.com/yesodweb/wai/blob/b6d2e3cb525a61d7150600f9957002bb755bcb25/wai-extra/Network/Wai/Parse.hs#L78\" rel=\"nofollow\"><code>lbsBackEnd</code></a><code>:: Monad m =&gt; ignored1 -&gt; ignored2 -&gt; m S.ByteString -&gt; m L.ByteString</code></p></li>\n</ul>\n\n<p>I can't find anything in the WAI documentation that mentions \"LBS\". What does it mean?</p>\n"}, {"tags": ["string", "haskell", "readfile"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1457307829, "post_id": 35833767, "comment_id": 59335001, "body": "Is it a typo or you&#39;re missing a <code>]</code> at the end of your file? If so, that&#39;s the reason <code>read</code> is throwing an incorrect parse. Make sure the string provided to <code>read</code> is valid Haskell code."}, {"owner": {"reputation": 1, "user_id": 6026761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80051bf545a40e0b079ba98577823b11?s=128&d=identicon&r=PG&f=1", "display_name": "stingy", "link": "https://stackoverflow.com/users/6026761/stingy"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1457308028, "post_id": 35833767, "comment_id": 59335056, "body": "no sorry, there is more in the database i just cut it to show part of it. but thank you for looking."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6026761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80051bf545a40e0b079ba98577823b11?s=128&d=identicon&r=PG&f=1", "display_name": "stingy", "link": "https://stackoverflow.com/users/6026761/stingy"}, "edited": false, "score": 0, "creation_date": 1457307240, "post_id": 35833854, "comment_id": 59334878, "body": "Thanks for posting, umm but i&#39;ve tried something similar before and well i get the message \\\\Prelude.read: no parse//  if i try to view(print) the [film] to see if it has worked"}, {"owner": {"reputation": 5636, "user_id": 243581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d196ce09c988b9e2782f5a04a987aa?s=128&d=identicon&r=PG", "display_name": "AtnNn", "link": "https://stackoverflow.com/users/243581/atnnn"}, "reply_to_user": {"reputation": 1, "user_id": 6026761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80051bf545a40e0b079ba98577823b11?s=128&d=identicon&r=PG&f=1", "display_name": "stingy", "link": "https://stackoverflow.com/users/6026761/stingy"}, "edited": false, "score": 0, "creation_date": 1457308122, "post_id": 35833854, "comment_id": 59335079, "body": "There may be something wrong with your data. It works for me with your example: <code>read &quot;[(\\&quot;Blade Runner\\&quot;,\\&quot;Ridley Scott\\&quot;,1982,[(\\&quot;Amy\\&quot;,5), (\\&quot;Bill\\&quot;,8), (\\&quot;Ian\\&quot;,7), (\\&quot;Kevin\\&quot;,9), (\\&quot;Emma\\&quot;,4), (\\&quot;Sam\\&quot;,7), (\\&quot;Megan\\&quot;,4)]),(\\&quot;The Fly\\&quot;,\\&quot;David Cronenberg\\&quot;,1986,[(\\&quot;Megan\\&quot;,4), (\\&quot;Fred\\&quot;,7), (\\&quot;Chris\\&quot;,5), (\\&quot;Ian\\&quot;,0), (\\&quot;Amy\\&quot;,6)])]&quot; :: [Film]</code>"}, {"owner": {"reputation": 1, "user_id": 6026761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80051bf545a40e0b079ba98577823b11?s=128&d=identicon&r=PG&f=1", "display_name": "stingy", "link": "https://stackoverflow.com/users/6026761/stingy"}, "edited": false, "score": 0, "creation_date": 1457308453, "post_id": 35833854, "comment_id": 59335160, "body": "You Are a legend, You are right, something must be wrong with my data, i made a separate txt file and tried it with the data and it worked, thank you, i hope you have a great week."}], "tags": [], "owner": {"reputation": 5636, "user_id": 243581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d196ce09c988b9e2782f5a04a987aa?s=128&d=identicon&r=PG", "display_name": "AtnNn", "link": "https://stackoverflow.com/users/243581/atnnn"}, "is_accepted": true, "score": 0, "last_activity_date": 1457306402, "creation_date": 1457306402, "answer_id": 35833854, "question_id": 35833767, "link": "https://stackoverflow.com/questions/35833767/haskell-divide-string-into-lists/35833854#35833854", "title": "Haskell divide String into Lists", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Read.html#v:read\" rel=\"nofollow\"><code>read</code></a>:</p>\n\n<pre><code>main = do\n  string &lt;- readfile \"data.txt\"\n  let testDatabase = read string :: [Film]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6026761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80051bf545a40e0b079ba98577823b11?s=128&d=identicon&r=PG&f=1", "display_name": "stingy", "link": "https://stackoverflow.com/users/6026761/stingy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1457352352, "accepted_answer_id": 35833854, "answer_count": 1, "score": -2, "last_activity_date": 1457306402, "creation_date": 1457305739, "last_edit_date": 1457306176, "question_id": 35833767, "link": "https://stackoverflow.com/questions/35833767/haskell-divide-string-into-lists", "closed_reason": "Not suitable for this site", "title": "Haskell divide String into Lists", "body": "<p>I've been working for quite a while on this project and just want to ask if it is possible to divide a string into a set list. At the moment I have</p>\n\n<pre><code>type Rate = (String,Int)\ntype Film  =  (String,String,Int,[Rate])\n\ntestDatabase :: [Film]\ntestDatabase = [(\"Blade Runner\",\"Ridley Scott\",1982,[(\"Amy\",5), (\"Bill\",8), (\"Ian\",7), (\"Kevin\",9), (\"Emma\",4), (\"Sam\",7), (\"Megan\",4)]),(\"The Fly\",\"David Cronenberg\",1986,[(\"Megan\",4), (\"Fred\",7), (\"Chris\",5), (\"Ian\",0), (\"Amy\",6)])...\n</code></pre>\n\n<p>And I have tailored a lot of functions to be able to work with the <code>[Film]</code> type.</p>\n\n<p>My problem arose when I tried to import the data from a text file.</p>\n\n<p>Using <code>readFile</code> I am only able to read</p>\n\n<pre><code>[(\"Blade Runner\",\"Ridley Scott\",1982,[(\"Amy\",5), (\"Bill\",8), (\"Ian\",7), (\"Kevin\",9), (\"Emma\",4), (\"Sam\",7), (\"Megan\",4)]),(\"The Fly\",\"David Cronenberg\",1986,[(\"Megan\",4), (\"Fred\",7), (\"Chris\",5), (\"Ian\",0), (\"Amy\",6)]) \n</code></pre>\n\n<p>as </p>\n\n<pre><code>\"[(\"Blade Runner\",\"Ridley Scott\",1982,[(\"Amy\",5), (\"Bill\",8), (\"Ian\",7), (\"Kevin\",9), (\"Emma\",4), (\"Sam\",7), (\"Megan\",4)]),(\"The Fly\",\"David Cronenberg\",1986,[(\"Megan\",4), (\"Fred\",7), (\"Chris\",5), (\"Ian\",0), (\"Amy\",6)])\" \n</code></pre>\n\n<p>and I don't know if there is a way to make the <code>readFile</code> read to a different data type rather than string or to convert this string to fit in the datatype.</p>\n\n<p>Any advice would be really appreciated. Sorry if I didn't phrase the question well. In summary, is there a way to make a string into just data to be able to implement into a type or is there a way to <code>readFile</code> as something other than <code>String</code>?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 2, "last_activity_date": 1457334262, "last_edit_date": 1457334262, "creation_date": 1457296663, "answer_id": 35832243, "question_id": 35832148, "link": "https://stackoverflow.com/questions/35832148/head-to-end-of-list-and-back-and-move-elem-to-index/35832243#35832243", "title": "Head to end of list and back and move elem to index", "body": "<p>Instead of <code>(:)</code>, you need to move the head to the end using (++)</p>\n\n<pre><code>head_to_end x = tail x ++ [head x]\n</code></pre>\n\n<p>Remember, <code>(:)</code> is of type <code>a-&gt;[a]-&gt;[a]</code>....  You would need a single element on the left side, and a list on the right.  Your types were the reverse.</p>\n\n<p>Also note that moving the head to the tail of a list like this is an expensive operation, the code will have to rebuild the full list.</p>\n"}, {"comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1458121250, "post_id": 36026788, "comment_id": 59713141, "body": "While this code snippet may solve the question, <a href=\"http://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion. Please also try not to crowd your code with explanatory comments, this reduces the readability of both the code and the explanations!"}, {"owner": {"reputation": 4129, "user_id": 2081133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/KDQEz.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2081133/james"}, "reply_to_user": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1458132288, "post_id": 36026788, "comment_id": 59721028, "body": "@SmokeDispenser Thanks for pointing that out. Explanations added."}], "tags": [], "owner": {"reputation": 4129, "user_id": 2081133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/KDQEz.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2081133/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1458132474, "last_edit_date": 1458132474, "creation_date": 1458102409, "answer_id": 36026788, "question_id": 35832148, "link": "https://stackoverflow.com/questions/35832148/head-to-end-of-list-and-back-and-move-elem-to-index/36026788#36026788", "title": "Head to end of list and back and move elem to index", "body": "<p>You can use pattern matching to access the head and tail of the list separately, then append the head (as a singleton list) to the end of the tail of the list using the <code>++</code> operator.</p>\n\n<pre><code>headToEnd :: [a] -&gt; [a]\nheadToEnd []     = []\nheadToEnd (x:xs) = xs ++ [x]\n</code></pre>\n\n<p>To move the last element of the list to the beginning, we can not use pattern matching, but we can use the <code>last</code> and <code>init</code> functions (imported with <code>Prelude</code> by default) in the <code>Data.List</code> module (from the base library) to access these values. This is where you would use the cons operator, <code>(:)</code>, to construct the new list with the values from <code>last</code> and <code>init</code>.</p>\n\n<pre><code>lastToHead :: [a] -&gt; [a]\nlastToHead [] = []\nlastToHead xs = last xs : init xs\n</code></pre>\n\n<p>Look up the types of each operator <code>(:)</code> and <code>(++)</code> in GHCI. It makes it very clear why your examples do not work.</p>\n\n<pre><code>\u03bb :t (++)\n(++) :: [a] -&gt; [a] -&gt; [a]\n\u03bb :t (:)\n(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Here's the reference on <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html\" rel=\"nofollow\"><code>Data.List</code></a> for info on the functions and operators I just mentioned. I found this page myself by visiting <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow\">Hoogle</a>, then searching for \"Data.List\", then clicked on \"base Data.List\" which was the first result.</p>\n"}], "owner": {"reputation": 500, "user_id": 847984, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/V9dwi.jpg?s=128&g=1", "display_name": "Andrew Nodermann", "link": "https://stackoverflow.com/users/847984/andrew-nodermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1392, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458132474, "creation_date": 1457296203, "question_id": 35832148, "link": "https://stackoverflow.com/questions/35832148/head-to-end-of-list-and-back-and-move-elem-to-index", "title": "Head to end of list and back and move elem to index", "body": "<p>I have list of strings</p>\n\n<pre><code>[\"1\", \"2\", \"3\", \"4\", \"5\"]\n</code></pre>\n\n<p>I wrote a first function, but it doesn't work</p>\n\n<pre><code>head_to_end :: [String] -&gt; [String]\nhead_to_end x = t : h\n    where h = `head` x\n          t = `tail` x\n</code></pre>\n\n<p>I should get something like this</p>\n\n<pre><code>head_to_end [\"1\", \"2\", \"3\", \"4\", \"5\"] -&gt; [\"2\", \"3\", \"4\", \"5\", \"1\"]\nlast_to_head [\"1\", \"2\", \"3\", \"4\", \"5\"] -&gt; [\"5\", \"1\", \"2\", \"3\", \"4\"]\n\nmove_elem_1_to_4 :: Int -&gt; Int -&gt; [String] -&gt; [String]\nmove_elem_1_to_4 [\"a\", \"b\", \"c\", \"d\", \"e\"] -&gt; [\"b\", \"c\", \"d\", \"a\", \"e\"]\n</code></pre>\n"}, {"tags": ["templates", "haskell", "ghc", "yesod", "hamlet"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457296007, "post_id": 35831703, "comment_id": 59331078, "body": "Try compiling or interpreting with the flag <code>-ddump-splices</code> - it will print code generated by TH (it seems the errors are in the generated code). Potentially the <code>do</code> is breaking it? Try without it."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1457337188, "post_id": 35831703, "comment_id": 59343435, "body": "Your code looks OK. Try using <code>$(widgetFile &quot;chat&quot;)</code> instead of three separate calls."}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1457337591, "post_id": 35831703, "comment_id": 59343643, "body": "@arrowd i have tried doing it at first. It gives a &quot;not in scope:&quot; error. Do i have to import widgetfile? And where exactly do i have to call it?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1457340854, "post_id": 35831703, "comment_id": 59345263, "body": "@Spacemoose <code>widgetFile</code> is usually created when you scaffold your project with <code>yesod init</code>. If you created it by hand, then you need to use <code>widgetFileReload</code>/<code>widgetFileNoReload</code> from <code>Yesod.Default.Util</code>. Use it inside your do-block in place of those three calls."}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1457341367, "post_id": 35831703, "comment_id": 59345535, "body": "@arrowd i used this : <code>$(widgetFileNoReload &quot;chat&quot;)</code> Got the following error:  Couldn&#39;t match type \u2018FilePath -&gt; Q Exp\u2019 with \u2018Q Exp\u2019     Expected type: ExpQ       Actual type: FilePath -&gt; Q Exp"}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1457341810, "post_id": 35831703, "comment_id": 59345757, "body": "@arrowd <code>widgetFileReload &#47; widgetfileNoReload</code> takes two arguments. it seems i have to edit WidgetFileSettings in my Settings.hs. Do i have to somehow import this setting? How does it have to look?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1457342087, "post_id": 35831703, "comment_id": 59345905, "body": "Ah, right. Use <code>(def :: WidgetFileSettings)</code> as its first argument. It is defined in <code>Data.Default</code>."}, {"owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1457344135, "post_id": 35831703, "comment_id": 59346999, "body": "@arrowd this is actually working!!! Thank you so much Mr.Arrow !"}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 2, "last_activity_date": 1457346534, "creation_date": 1457346534, "answer_id": 35841350, "question_id": 35831703, "link": "https://stackoverflow.com/questions/35831703/how-to-import-shakespearean-templates-in-yesod/35841350#35841350", "title": "How to import Shakespearean Templates in Yesod?", "body": "<p>It seems that <code>hamletFile</code> and others treat templates as self-contained, while yours are referencing something from each other. You can play with order of <code>*File</code> calls, or use <code>widgetFile*</code> from <code>Yesod.Default.Util</code> module:</p>\n\n<pre><code>$(widgetFileNoReload def \"chat\")\n</code></pre>\n\n<p>The <code>Reload</code> variant is useful for development - it would make <code>yesod devel</code> to watch for file changes and reload them.</p>\n"}], "owner": {"reputation": 1108, "user_id": 4874369, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7f0c00f3ee451d087667b41fc9bbcf61?s=128&d=identicon&r=PG&f=1", "display_name": "Spacemoose", "link": "https://stackoverflow.com/users/4874369/spacemoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 35841350, "answer_count": 1, "score": 5, "last_activity_date": 1457346534, "creation_date": 1457293835, "last_edit_date": 1457297563, "question_id": 35831703, "link": "https://stackoverflow.com/questions/35831703/how-to-import-shakespearean-templates-in-yesod", "title": "How to import Shakespearean Templates in Yesod?", "body": "<p>I was using QuasiQuotations in Yesod, and everything worked fine. BUT my file became very large and not nice to look at. Also, my TextEditor does not highlight this syntax correctly. That is why is split my files like so:</p>\n\n<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    webSockets chatApp\n    defaultLayout $ do\n        $(luciusFile \"templates/chat.lucius\")\n        $(juliusFile \"templates/chat.julius\")\n        $(hamletFile \"templates/chat.hamlet\")\n</code></pre>\n\n<p>If this is wrong, please do tell. Doing <code>runghc myFile.hs</code> throws many errors like this:</p>\n\n<pre><code>chat_new.hs:115:9:\n    Couldn't match expected type \u2018t0 -&gt; Css\u2019\n                with actual type \u2018WidgetT App IO a0\u2019\n    The lambda expression \u2018\\ _render_ajFK\n                             -&gt; (shakespeare-2.0.7:Text.Css.CssNoWhitespace . (foldr ($) ...))\n                                  ...\u2019\n    has one argument,\n    but its type \u2018WidgetT App IO a0\u2019 has none\n    In a stmt of a 'do' block:\n      \\ _render_ajFK\n      ...\n</code></pre>\n\n<p>And this.</p>\n\n<pre><code>chat_new.hs:116:9:\n    Couldn't match type \u2018(url0 -&gt; [(Text, Text)] -&gt; Text)\n                         -&gt; Javascript\u2019\n                   with \u2018WidgetT App IO a1\u2019\n    Expected type: WidgetT App IO a1\n      Actual type: JavascriptUrl url0\n    Probable cause: \u2018asJavascriptUrl\u2019 is applied to too few arguments\n    ...\n</code></pre>\n\n<p>And also one for the HTML (Hamlet).</p>\n\n<p>Thus, one per template.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457293736, "post_id": 35831639, "comment_id": 59330207, "body": "well you count up from 0 to k ... what if you count down from k to 0 instead? Maybe you can get rid of <code>i</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1457293951, "post_id": 35831639, "comment_id": 59330292, "body": "btw: the first line will force your result type into <code>Num a</code> which is not necessary - <code>(!!)</code> is partial and will fail if the list is empty - so maybe yours should do as well - you can use <code>undefined</code> or <code>error  &quot;empty list&quot;</code> instead of <code>-1</code> on the right hand side there or just remove the case completely if you like! Also you should think about nasty users who probably would ask you for <code>kth xs (-1)</code> - maybe this should be an error instead of an never-returning call as well?"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457294079, "post_id": 35831639, "comment_id": 59330330, "body": "Thanks! <code>let kth (x:xs) k = if k == 0 then x else kth xs (k - 1); kth [] _ = -1</code> Now I just need to handle errors"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457294499, "post_id": 35831639, "comment_id": 59330493, "body": "Now I have <code>let kth (x:xs) k = if k == 0 then x else if k &lt; 0 then error &quot;out of bounds&quot; else  kth xs (k - 1); kth [] _ = error &quot;out of bounds&quot;</code>, which works for positive indices, but <code>kth [0..5] -1</code> returns: <code>Non type-variable argument in the constraint: Num (a -&gt; t)</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457294860, "post_id": 35831639, "comment_id": 59330636, "body": "you have to input it with <code>kth [0..5] (-1)</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457295016, "post_id": 35831639, "comment_id": 59330695, "body": "also please edit your question instead of putting the code inside comments - maybe it&#39;s a problem with your indentation which we cannot see"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457295629, "post_id": 35831639, "comment_id": 59330933, "body": "<code>kth [0..5] (-1)</code> works, thanks!"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457295758, "post_id": 35831639, "comment_id": 59330979, "body": "@Carsten You can write an answer, and I&#39;ll be glad to accept it."}], "answers": [{"comments": [{"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1457296116, "post_id": 35832084, "comment_id": 59331111, "body": "Why is the type declaration necessary, isn&#39;t it inferred by the compiler?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 1, "creation_date": 1457296242, "post_id": 35832084, "comment_id": 59331157, "body": "yes it is (indeed the compiler would make it even more generic by getting rid of the <code>Integer</code>) - but it&#39;s good advice to add signatures to the top-level definitions - the compiler will even warn you if you don&#39;t - it will help you often with type errors (if you do something wrong) and it&#39;s valuable documentation ;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 1, "creation_date": 1457324968, "post_id": 35832084, "comment_id": 59339073, "body": "@dimid, it turns out that the inferred signature will be <i>too general</i> in a sense--it will allow you to use numeric types like <code>Double</code> and <code>Rational</code> that will lead to weird behavior. It&#39;s best to constrain it a bit. Typically, the &quot;generic&quot; version of this function would be given the signature <code>kth :: Integral i =&gt; [a] -&gt; i -&gt; a</code>."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1457295820, "creation_date": 1457295820, "answer_id": 35832084, "question_id": 35831639, "link": "https://stackoverflow.com/questions/35831639/k-th-elemnt-of-list-in-haskell/35832084#35832084", "title": "K-th elemnt of list in haskell", "body": "<p>So I guess you found your solution but allow me to make it a bit nicer for you:</p>\n\n<pre><code>kth :: [a] -&gt; Integer -&gt; a\nkth (x:xs) i\n   | i &lt; 0  = error \"out of bounds\"\n   | i == 0 = x\n   | i &gt; 0  = kth xs (i-1)\nkth [] _    = error \"empty list\"\n</code></pre>\n\n<p>this uses <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow\"><em>guards</em></a> instead of the <code>if</code>s - so if you did not see those before you should probably follow the link and read the wiki</p>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457296137, "post_id": 35832112, "comment_id": 59331119, "body": "I think the question was how to get rid of <code>kth_i</code> which is a second function but yes of course this works..."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1457296246, "post_id": 35832112, "comment_id": 59331161, "body": "You don&#39;t want to limit yourself to lists of ints."}, {"owner": {"reputation": 2559, "user_id": 2660970, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/31deb30c1f8cf14c92fdf597e38568a8?s=128&d=identicon&r=PG", "display_name": "ig-melnyk", "link": "https://stackoverflow.com/users/2660970/ig-melnyk"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457296382, "post_id": 35832112, "comment_id": 59331223, "body": "@Carsten thanks! I thought OP is talking about not using pattern matching. Updated the answer"}], "tags": [], "owner": {"reputation": 2559, "user_id": 2660970, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/31deb30c1f8cf14c92fdf597e38568a8?s=128&d=identicon&r=PG", "display_name": "ig-melnyk", "link": "https://stackoverflow.com/users/2660970/ig-melnyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1457296331, "last_edit_date": 1457296331, "creation_date": 1457295984, "answer_id": 35832112, "question_id": 35831639, "link": "https://stackoverflow.com/questions/35831639/k-th-elemnt-of-list-in-haskell/35832112#35832112", "title": "K-th elemnt of list in haskell", "body": "<p><strong>UPDATED:</strong> Here is the solution that uses pattern matching. You can also look at the implementation of the Haskell (!!) functions which is quite similar to this code : <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.List.html#%21%21\" rel=\"nofollow\">!!</a> </p>\n\n<pre><code>nth::[a]-&gt;Int-&gt;a\nnth [] _ = error \"out of bounds\"\nnth (x:xs) 0 = x\nnth (x:xs) n = nth xs (n-1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1457335243, "last_edit_date": 1457335243, "creation_date": 1457314685, "answer_id": 35834897, "question_id": 35831639, "link": "https://stackoverflow.com/questions/35831639/k-th-elemnt-of-list-in-haskell/35834897#35834897", "title": "K-th elemnt of list in haskell", "body": "<p>A simple definition, assuming the list <em>has</em> at least <code>k + 1</code> items:</p>\n\n<pre><code>kth :: Integer -&gt; [a] -&gt; a\nkth k = head . drop k\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1457351234, "post_id": 35836536, "comment_id": 59351338, "body": "Thanks a lot for the detailed answer! (wish I could upvote twice :) If I understood correctly, all versions in your answer are partial functions. If so, what would the total function look like? Also, why is the first version &#39;awkward to use&#39;?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 1, "creation_date": 1457363801, "post_id": 35836536, "comment_id": 59360019, "body": "@dimid, the first is total. The second and third could be made total by replacing <code>error ...</code> with <code>Nothing</code>, but then <code>Nothing</code> would have two potential meanings."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1457363943, "post_id": 35836536, "comment_id": 59360128, "body": "@dimid, there are a lot more tools for <code>Maybe</code> than that weird type. You could fix that, I suppose, by declaring <code>data BadNth = NegativeIx | TooShort</code> and then using <code>Either BadNth a</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1457327164, "creation_date": 1457327164, "answer_id": 35836536, "question_id": 35831639, "link": "https://stackoverflow.com/questions/35831639/k-th-elemnt-of-list-in-haskell/35836536#35836536", "title": "K-th elemnt of list in haskell", "body": "<p>Since no one else mentioned this, I figure I should: partial functions (ones that sometimes give rise to error messages or infinite loops) are typically discouraged in Haskell. We tend to prefer to deal with total functions, expressing failure using types like <code>Maybe</code> and <code>Either</code>. Even when we deal with partial functions, we tend to try to limit hard-to-handle errors. The most extreme version might be something like this:</p>\n\n<pre><code>data Kth a = NegativeIndex | ShortList | Kth a\n\nkth :: Integral i =&gt; [a] -&gt; i -&gt; Kth a\nkth _ k | k &lt; 0 = NegativeIndex\nkth [] _ = ShortList\nkth (x : _) 0 = Kth x\nkth (_ : xs) k = kth xs (k - 1)\n</code></pre>\n\n<p>This gives very informative results, but it's pretty awkward to use. If you're confident the index given will never be negative, you can use this one instead:</p>\n\n<pre><code>kth :: Integral i =&gt; [a] -&gt; i -&gt; Maybe a\nkth _ k | k &lt; 0 = error \"Negative index\"\nkth [] _ = Nothing\nkth (x : _) 0 = Just x\nkth (_ : xs) k = kth xs (k - 1)\n</code></pre>\n\n<p>Note that if you specialize this version to the <code>Natural</code> type from <code>Numeric.Natural</code> (available in recent versions of GHC), then you can leave out the <code>&lt; 0</code> test because natural numbers really <em>can't</em> be negative!</p>\n\n<p>Sticking to the polymorphic code for now, you can see that there's a minor inefficiency: <code>kth</code> will check for <code>k &lt; 0</code> on every recursive call, even though it's only possible for that to happen on the first one. You can avoid that by using a helper function:</p>\n\n<pre><code>kth :: Integral i =&gt; [a] -&gt; i -&gt; Maybe a\nkth xs k | k &lt; 0 = error \"Negative index\"\n         | otherwise = kth' xs k\n  where\n    kth' [] _ = Nothing\n    kth' (x : _) 0 = Just x\n    kth' (_ : xs) k = kth' xs (k - 1)\n</code></pre>\n\n<p>Once we've gone this far, we might as well have a bit more fun. The helper function matches the <code>foldr</code> \"design pattern\", so we can write it like this:</p>\n\n<pre><code>kth' xs = foldr go (const Nothing) xs where\n  go x _ 0 = Just x\n  go _ r i = r (i - 1)\n</code></pre>\n\n<p>Inlining this version of <code>kth'</code>, we get</p>\n\n<pre><code>kth xs k | k &lt; 0 = error \"Negative index\"\n         | otherwise = foldr go (const Nothing) xs k\n  where\n    go x _ 0 = Just x\n    go _ r i = r (i - 1)\n</code></pre>\n\n<p>For optimization purposes, it's probably best to replace <code>(const Nothing)</code> with <code>(`seq` Nothing)</code>, and to replace <code>r (i - 1)</code> with <code>r $! i - 1</code>, but it's probably not a good idea to go into the full details of why just now. </p>\n"}], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 35832084, "answer_count": 4, "score": 1, "last_activity_date": 1457335243, "creation_date": 1457293462, "last_edit_date": 1457295572, "question_id": 35831639, "link": "https://stackoverflow.com/questions/35831639/k-th-elemnt-of-list-in-haskell", "title": "K-th elemnt of list in haskell", "body": "<p>I'M a beginner in haskell, and trying to implement a function which returns the k-th element of a list without using the prelude <code>!!</code> built-in.</p>\n\n<pre><code>kth_i [] _ _ = -1\nkth_i (x:xs) i k = if i == k then x else kth_i xs (i + 1) k\nkth xs k = kth_i xs 0 k\n</code></pre>\n\n<p>This code works, but is too verbose. I'd like to use just one function.</p>\n\n<p>Edit: I ended up with:</p>\n\n<pre><code>let kth (x:xs) k = if k == 0 then x else if k &lt; 0 then error \"out of bounds\" else  kth xs (k - 1); kth [] _ = error \"out of bounds\"\n</code></pre>\n\n<p>As per @Carsten's suggestion. </p>\n"}, {"tags": ["haskell", "binary-tree", "inorder"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1457291684, "post_id": 35831163, "comment_id": 59329477, "body": "Your question would be more appropriate on <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a>. However, here is a tip: you can make <a href=\"http://homepages.inf.ed.ac.uk/wadler/papers/vanish/vanish.pdf\" rel=\"nofollow noreferrer\">the concatenate vanish</a> in the last equation."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1458260015, "post_id": 35831388, "comment_id": 59793871, "body": "I am not sure if I correctly understand you. For perfect balanced tree my algorithm is linear ?"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 3, "last_activity_date": 1457293800, "last_edit_date": 1457293800, "creation_date": 1457292097, "answer_id": 35831388, "question_id": 35831163, "link": "https://stackoverflow.com/questions/35831163/can-this-implementation-of-in-order-traversal-of-a-binary-tree-be-improved/35831388#35831388", "title": "Can this implementation of in-order traversal of a binary tree be improved?", "body": "<p>Haskell's append <code>++</code> performs linearly in the length of its left argument, which means that you may get <em>quadratic</em> performance if the tree <em>leans left</em>. \nOne possibility would be to use <a href=\"https://wiki.haskell.org/Difference_list\" rel=\"nofollow\"><strong>difference list</strong></a>. </p>\n\n<p>Another one would be to define a <a href=\"https://en.wikibooks.org/wiki/Haskell/Foldable\" rel=\"nofollow\"><strong>Foldable</strong></a> instance:</p>\n\n<pre><code>data Tree a = Empty | Node a (Tree a) (Tree a)\n\ninstance Foldable Tree where\n    foldr f z Empty = z\n    foldr f z (Node a l r) = foldr f (f a (foldr f z r)) l\n</code></pre>\n\n<p>then, in-order-traversal comes out naturally:</p>\n\n<pre><code>toList :: Tree a -&gt; [a]\ntoList = foldr (:) []\n</code></pre>\n\n<p>and</p>\n\n<pre><code>\\&gt; let tr = Node \"root\" (Node \"left\" Empty Empty) (Node \"right\" Empty Empty)\n\\&gt; toList tr\n[\"left\",\"root\",\"right\"]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 35831388, "answer_count": 1, "score": 2, "last_activity_date": 1457293800, "creation_date": 1457290913, "last_edit_date": 1457291845, "question_id": 35831163, "link": "https://stackoverflow.com/questions/35831163/can-this-implementation-of-in-order-traversal-of-a-binary-tree-be-improved", "title": "Can this implementation of in-order traversal of a binary tree be improved?", "body": "<p>I wrote a straightforward in-order-traversal function (<code>toList1</code>) for a binary tree. However, I worry about its complexity (memory / time). Is there a better way to implement it?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Tree a = Empty | Node a (Tree a) (Tree a) \ntoList1 :: (Tree a) -&gt; [a]\ntoList1 Empty = []\ntoList1 (Node x lx rx) = (toList lx) ++ [x] ++ (toList rx)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1457295219, "post_id": 35830696, "comment_id": 59330777, "body": "thanks, so no longer can create projects via Haskell online ide ? advises to use &#39;The Haskell Tool Stack&#39; which is OS (non browser) based."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 1, "creation_date": 1457355820, "post_id": 35830696, "comment_id": 59354269, "body": "No, you can&#39;t create projects (or work with existing projects)."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 1, "last_activity_date": 1457288534, "creation_date": 1457288534, "answer_id": 35830696, "question_id": 35830625, "link": "https://stackoverflow.com/questions/35830625/create-new-project-with-fpcomplete/35830696#35830696", "title": "Create new project with fpcomplete", "body": "<p>FP Complete's Haskell Center is no longer available: <a href=\"https://www.fpcomplete.com/blog/2015/10/retiring-fphc\" rel=\"nofollow\">https://www.fpcomplete.com/blog/2015/10/retiring-fphc</a></p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 35830696, "answer_count": 1, "score": 1, "last_activity_date": 1478637422, "creation_date": 1457288193, "last_edit_date": 1478637422, "question_id": 35830625, "link": "https://stackoverflow.com/questions/35830625/create-new-project-with-fpcomplete", "title": "Create new project with fpcomplete", "body": "<p>When I try to create a new haskell project using <a href=\"https://www.schoolofhaskell.com/new-project\" rel=\"nofollow\">https://www.schoolofhaskell.com/new-project</a> I receive page not found exception. Is this the correct url for creating a new project with fpcomplete? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1457287216, "post_id": 35830060, "comment_id": 59327751, "body": "you meant <code>new_list ++ Data.Maybe.maybeToList (belongs h new_list)</code>."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 5, "creation_date": 1457287754, "post_id": 35830060, "comment_id": 59327972, "body": "Not wanting to sound pedantic, but the way you write type class constraints is quite unidiomatic and I am sure, disturbing for many. You can just drop the () around a type variable, there is nothing to parenthesize."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1457287776, "post_id": 35830285, "comment_id": 59327978, "body": "the matching and conditional appending that you describe can be nicely done with <code>new_list ++ [a | Just a &lt;- [belongs h new_list]]</code>. --- btw <i>appending</i> at the right is not inefficient; it&#39;s <a href=\"http://stackoverflow.com/a/14942678/849891\">the subsequent retrieval that&#39;s inefficient</a>. Each element will be retrieved in O(n) time."}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1457591209, "post_id": 35830285, "comment_id": 59477625, "body": "Very good point. I was being lazy (pun not intended) and inaccurate. I&#39;ll edit my answer."}], "tags": [], "owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "is_accepted": true, "score": 6, "last_activity_date": 1457593369, "last_edit_date": 1457593369, "creation_date": 1457286562, "answer_id": 35830285, "question_id": 35830060, "link": "https://stackoverflow.com/questions/35830060/haskell-maybe-a-vs-a/35830285#35830285", "title": "Haskell. (Maybe a) vs a", "body": "<p>Imagine what would happen on that line if you instantiated <code>a</code> as a concrete type, e.g. <code>Int</code>. <code>belongs</code> would give you back a <code>Maybe Int</code> which you would wrap to make a <code>[Maybe Int]</code> and immediately try to concatenate it with <code>new_list</code>, which because you passed to <code>belongs</code> must be a <code>[Int]</code>. This is what the compiler is telling you; you are simultaneously trying to use one value as two different types.</p>\n\n<p>To fix this you can match on the result of <code>belongs</code> before wrapping it in a list and appending it. If it's <code>Just a</code> append the <code>a</code>. If it's <code>Nothing</code> don't append anything. Side note: appending elements to the back of a list is very inefficient*. You might want to add everything to the front and then reverse at the end. </p>\n\n<p>You have one other problem. Your definition of <code>nub'</code> simultaneously treats <code>new_list</code> as of type <code>Maybe [a]</code> (by returning a <code>new_list</code> in one case) and as of type <code>[Maybe a]</code> (if you fix the above). <strong>Edit</strong>: Not anymore after your edit.</p>\n\n<p>* As @WillNess points out, this is a bit of a fiction. Because of the pervasive laziness of Haskell, most operations that are commonly said to be \"expensive\" are not expensive at creation time, but only when elements are being used. A lot of quadratic time slow-downs vs optimal linear time operations occur because an incorrect order of associating operations causes the <em>retrieval</em> of an element to incur linear time cost. His answer that he <a href=\"https://stackoverflow.com/questions/14938584/haskell-foldl-poor-performance-with/14942678#14942678\">linked</a> is a good explanation of this.</p>\n"}, {"tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": false, "score": 2, "last_activity_date": 1457318914, "creation_date": 1457318914, "answer_id": 35835401, "question_id": 35830060, "link": "https://stackoverflow.com/questions/35830060/haskell-maybe-a-vs-a/35835401#35835401", "title": "Haskell. (Maybe a) vs a", "body": "<p>You have created a pair of functions; one claims to accept a list of any type (<code>[a]</code>) and return a list of the <em>same</em> type; the other takes a value of any type, a list of the same type, and returns a <code>Maybe</code> value of that same type.</p>\n\n<p>A type and that type applied to <code>Maybe</code> are not the same type. But in the function that claims to be <code>[a] -&gt; [a]</code>, you are trying to combine <code>[a]</code> and <code>[Maybe a]</code> and get an <code>[a]</code> as a result. That's just not going to work.</p>\n\n<p>In order to end up with the claimed <code>[a] -&gt; [a]</code> signature, it will be necessary to remove the <code>Maybe</code> from the result of the call to <code>belongs</code>, which introduces it. You can do this in one of two ways: Either change <code>belongs</code> to no longer use <code>Maybe</code>, or do some sort of case-analysis on the <code>Maybe</code> to extract the underlying value and then wrap it in a list.</p>\n\n<p>If you look at how the types for list and <code>Maybe</code> are defined, you may see a similarity:</p>\n\n<pre><code>data Maybe a = Nothing | Just a\n\ndata [a] = [] | a :: [a]\n</code></pre>\n\n<p>Both are sum types that have a case that represents absence of value! So you can simply replace <code>Nothing</code> in <code>belongs</code> with <code>[]</code> and <code>Just e</code> with <code>[e]</code>. Now the result can be directly concatenated with <code>new_list</code> in the second clause of <code>nub'</code>.</p>\n\n<p>Alternatively, you can use <code>belongs</code> as it is, and take advantage of the correspondence between <code>Maybe</code> and the 1-element list to write a helper function that maps <code>Nothing</code> to <code>[]</code> and <code>Just elem</code> to <code>[elem]</code>. Or, as @Will Ness has pointed out, you could use the existing function from <code>Data.Maybe</code> called <code>maybeToList</code> that does exactly this.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 35830285, "answer_count": 2, "score": 1, "last_activity_date": 1457593369, "creation_date": 1457285507, "last_edit_date": 1457286392, "question_id": 35830060, "link": "https://stackoverflow.com/questions/35830060/haskell-maybe-a-vs-a", "title": "Haskell. (Maybe a) vs a", "body": "<pre><code>belongs :: Eq(a) =&gt; a -&gt; [a] -&gt; Maybe a\n\nbelongs e (h:t) = if ( h == e) then Nothing else belongs e t\nbelongs e [] = Just e\n\n\nnub :: Eq(a) =&gt; [a] -&gt; [a]\nnub l = nub' l [] \n    where \n        nub' [] new_list = new_list\n        nub' (h:t) new_list = nub' t (new_list ++ [(belongs h new_list)])\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Occurs check: cannot construct the infinite type: a0 = Maybe a0\nExpected type: [a0]\n  Actual type: [Maybe a0]\nIn the second argument of `belongs', namely `new_list'\nIn the expression: (belongs h new_list)\nIn the second argument of `(++)', namely `[(belongs h new_list)]'\n</code></pre>\n\n<p>I understand error. But I don't know how to repair it. I don't understand why <code>Maybe Eq(a)</code> cannot be matched with <code>a</code>.  So how to repair it. I would like use Maybe here if is it possible.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1457285843, "post_id": 35829969, "comment_id": 59327149, "body": "If you enable the <code>DeriveFunctor</code> extension in GHC you can have the compiler derive the Functor instance for you by if you change your definition to <code>data Tree a = Empty | Node a (Tree a) (Tree  a) deriving (Functor)</code>. Your implementation is pretty standard though so I doubt you can make a more &#39;elegant&#39; one yourself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1457286256, "post_id": 35829969, "comment_id": 59327325, "body": "What about signature ?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1457286356, "post_id": 35829969, "comment_id": 59327372, "body": "I don&#39;t understand your signature problem, the type of <code>fmap</code> is <code>(a -&gt; b) -&gt; f a -&gt; fb</code> which is what you have there, where <code>f</code> is <code>Tree</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1457286531, "post_id": 35829969, "comment_id": 59327451, "body": "You answer is ok for me. Why it is written f instead of Tree ?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1457287344, "post_id": 35829969, "comment_id": 59327803, "body": "The <code>Functor</code> class definition states that some type constructor <code>f</code> is a functor if it implements the function <code>fmap</code>. A type constructor is a type-level function which is used to construct types, e.g. <code>List</code>, <code>Maybe</code>, <code>IO</code> etc. Those type constructors take a single argument, like your <code>Tree</code> type, and like the <code>f</code> constructor in the definition of <code>Functor</code>. Your instance for <code>Tree</code> therefore defines how <code>fmap</code> works for your <code>Tree</code> type by substituting <code>f</code> for <code>Tree</code>. So <code>f</code> is a type constructor variable in the definition of the <code>Functor</code> class."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1457304825, "post_id": 35829969, "comment_id": 59334198, "body": "@HaskellFun: Don&#39;t forget that Lee&#39;s signature of <code>fmap</code> is incomplete, it&#39;s missing the <code>Functor f =&gt;</code> constraint."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457338170, "post_id": 35829969, "comment_id": 59343911, "body": "By the way, your first question is better suited for <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1457339071, "creation_date": 1457339071, "answer_id": 35839160, "question_id": 35829969, "link": "https://stackoverflow.com/questions/35829969/haskell-functor-for-data-binary-tree/35839160#35839160", "title": "haskell, Functor for Data Binary Tree", "body": "<blockquote>\n  <p>what about more elegant [...] solutions?</p>\n</blockquote>\n\n<p>It's perfectly fine. All other solutions that aren't using any helper functions will look more or less the same. The only thing I would change is the alignment of the <code>=</code>s and the names <code>x</code> and <code>y</code> as <code>l</code> and <code>r</code> (referring to the left and right branch):</p>\n\n<pre><code>instance Functor Tree where\n  fmap _ Empty        = Empty\n  fmap f (Node a l r) = Node (f a) (fmap f l) (fmap f r)\n</code></pre>\n\n<p>However, that's my personal opinion. Let's get to the real question, <code>fmap</code>'s type:</p>\n\n<blockquote>\n  <p>The second issue is that lecturer wrote signature: <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code> [\u2026]</p>\n</blockquote>\n\n<p>First of all, the lecturer's signature is <em>somewhat</em> wrong. <code>fmap</code>'s complete signature is</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>The constraint <code>Functor f</code> is important. It limits the use of <code>fmap</code> to the instances of <code>Functor</code>. Now that's not the problem you've encountered:</p>\n\n<blockquote>\n  <p>for me, it is <code>(a-&gt;b) -&gt; Tree a -&gt;  Tree b</code>, but it is not accepted by compiler ghci. Where is the point?</p>\n</blockquote>\n\n<p>Ah, you've tried to specify a type signature for <code>fmap</code> in the <code>Functor Tree</code> instance, right?</p>\n\n<pre><code>instance Functor Tree where\n  fmap :: (a -&gt; b) -&gt; Tree a -&gt; Tree b\n  fmap = ...\n</code></pre>\n\n<p>Well, that's not allowed. After all, <code>fmap</code>'s type <em>isn't</em> <code>(a -&gt; b) -&gt; Tree a -&gt; Tree b</code>, but the more general one above. It's somewhat&mdash;but not entirely&mdash;similar to using two type signatures for a single binding:</p>\n\n<pre><code>foo :: Eq a =&gt; a -&gt;  a -&gt; Bool\nfoo ::        () -&gt; () -&gt; Bool\n</code></pre>\n\n<p>That's not allowed either. Note that you can enable instance signatures <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-class-extensions.html#instance-sigs\" rel=\"nofollow\">with an extension</a> if you really want to. If you just want to do it for documentation, a comment can be used instead of <code>-XInstanceSigs</code>:</p>\n\n<pre><code>instance Functor Tree where\n  -- fmap :: (a -&gt; b) -&gt; Tree a -&gt; Tree b\n  fmap = ...\n</code></pre>\n\n<p><strong>TL;DR</strong>: <code>fmap</code>'s type is given by it's declaration in <code>class Functor</code>, it's already specified by your choice of <code>f</code> in the <code>instance</code> definition.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1457340042, "creation_date": 1457340042, "answer_id": 35839381, "question_id": 35829969, "link": "https://stackoverflow.com/questions/35829969/haskell-functor-for-data-binary-tree/35839381#35839381", "title": "haskell, Functor for Data Binary Tree", "body": "<p>Your solution is quite elegant. Another option is to define <code>fmap</code> using <code>traverse</code>:</p>\n\n<pre><code>import Data.Traversable\n\n-- Preorder traversal based on the way you defined the Node constructor. Could use any traversal.\ninstance Traversable Tree where\n  traverse _ Empty = pure Empty\n  traverse f (Node v l r) = Node &lt;$&gt; f v &lt;*&gt; traverse f l &lt;*&gt; traverse f r \n\ninstance Functor Tree where\n  fmap = fmapDefault\n\ninstance Foldable Tree where\n  foldMap = foldMapDefault\n</code></pre>\n\n<p>I wouldn't say this is more elegant, but if you want all these instances, and don't want to <code>derive</code> them it's a pithy way to do it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 1, "accepted_answer_id": 35839160, "answer_count": 2, "score": 3, "last_activity_date": 1457340042, "creation_date": 1457284937, "question_id": 35829969, "link": "https://stackoverflow.com/questions/35829969/haskell-functor-for-data-binary-tree", "title": "haskell, Functor for Data Binary Tree", "body": "<p>I am trying to write functor for Tree (form of this type is given below)</p>\n\n<pre><code>data Tree a = Empty | Node a (Tree a) (Tree a) \n\ninstance Functor Tree where\n    fmap f Empty = Empty\n    fmap f (Node a x y) =  Node (f a) (fmap f x) (fmap f y)\n</code></pre>\n\n<p>It seems to be working, but what about more elegant (I am newbie in haskell) solutions? \nThe second issue is that lecturer wrote signature:  <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>\nfor me, it is <code>(a-&gt;b) -&gt; Tree a -&gt;  Tree b</code>, but it is not accepted by compiler ghci. Where is the point ?</p>\n"}, {"tags": ["qt", "haskell", "hsqml"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457277713, "post_id": 35828435, "comment_id": 59323943, "body": "This is simply a Haskell parse error, nothing to do with QT (so if you QT code is broken as well, I wouldn&#39;t know). As you can see in the error, it believe that the indendation is wrong: &quot;    state &lt;- ...&quot; vs &quot;&gt;     skey &lt;-...&quot;. If the indentation looks write to you, its probably because you are mixing tabs and spaces - pick one or the other, you must be consistent in your choice."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457278255, "post_id": 35828435, "comment_id": 59324180, "body": "ok, that was the problem."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457278963, "post_id": 35828435, "comment_id": 59324501, "body": "For the 2nd error: GHC complains because you <i>have</i> applied it to 6 arguments. Replace <code>(\\obj txt-&gt;</code> with <code>(\\obj txt-&gt; do</code>."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457283581, "post_id": 35828435, "comment_id": 59326287, "body": "thanks! but I&#39;ve got another error!"}, {"owner": {"reputation": 115993, "user_id": 24587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/859e513beefbf5b330a8842d9d39b00e?s=128&d=identicon&r=PG&f=1", "display_name": "Georg Sch&#246;lly", "link": "https://stackoverflow.com/users/24587/georg-sch%c3%b6lly"}, "edited": false, "score": 0, "creation_date": 1457364070, "post_id": 35828435, "comment_id": 59360228, "body": "@lolveley: If you have a new problem, ask a new question. :-) If you want, link to it in the comment section of this question."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1457364540, "post_id": 35828435, "comment_id": 59360616, "body": "ok! Here is the link : <a href=\"http://stackoverflow.com/questions/35847550/button-click-a-message-does-not-appear-in-a-haskell-program\" title=\"button click a message does not appear in a haskell program\">stackoverflow.com/questions/35847550/&hellip;</a>"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457363811, "creation_date": 1457276559, "last_edit_date": 1457363811, "question_id": 35828435, "link": "https://stackoverflow.com/questions/35828435/haskell-qt-how-to-display-a-text-when-a-button-is-clicked", "title": "Haskell &amp; Qt : how to display a text when a button is clicked?", "body": "<p>I am trying to create a program which displays \"hello\" when one clicks on a button, using Qt and haskell (with HsQML).</p>\n\n<p>PLEASE GO DIRECTLY TO THE LAST UPDATE : you will see the last error I have made :-) </p>\n\n<p>I've got a base which works but in my own program I already have an error</p>\n\n<pre><code>/home/lowley/Documents/haskell/Qt/exemple-2.hs: line 13, column 5:\nparse error on input `skey'\n/home/lowley/Documents/haskell/Qt/exemple-2.hs: line 13, column 5:\nWarning: Parse error: Last statement in a do-block must be an\nexpression\nFound:\n  main = do\n    state &lt;- newIORef $ T.pack \"\"\n&gt;     skey &lt;- newSignalKey\n      clazz &lt;- newClass [\n        defPropertySigRO' \"my_label\" skey (\\_ -&gt;)\n</code></pre>\n\n<p>here is my program:</p>\n\n<pre><code>module Main where\n\nimport Graphics.QML\nimport Control.Concurrent\nimport Control.Exception\nimport Data.IORef\nimport Data.Text (Text)\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = do\n    state &lt;- newIORef $ T.pack \"\"\n    skey &lt;- newSignalKey\n    clazz &lt;- newClass [\n        defPropertySigRO' \"my_label\" skey (\\_ -&gt;\n            readIORef state),\n        defMethod' \"sayHello\" (\\obj txt-&gt;\n            writeIORef state $ T.pack txt\n            fireSignal skey obj\n            return ())]\n    ctx &lt;- newObject clazz ()\n    runEngineLoop defaultEngineConfig {\n        initialDocument = fileDocument \"exemple2.qml\",\n        contextObject = Just $ anyObjRef ctx}\n</code></pre>\n\n<p>and here is the QML file:</p>\n\n<pre><code>import QtQuick 2.0\nimport QtQuick.Controls 1.3\n\nItem {\n    height: 266\n    Button {\n        id: bouton\n        x: 278\n        y: 77\n        text: qsTr(\"click me!\")\n        onClicked: sayHello(\"Hello!!\")\n    }\n\n    Text {\n        x: 166\n        y: 147\n        width: 309\n        height: 87\n        text: my_label\n        horizontalAlignment: Text.AlignHCenter\n        font.pixelSize: 76\n    }\n\n}\n</code></pre>\n\n<p>for information, here is an example which works, it is in the same directory and is also compiled with sublime text:</p>\n\n<p>HS file:</p>\n\n<pre><code>module Main where\n\nimport Graphics.QML\nimport Control.Concurrent\nimport Control.Exception\nimport Data.IORef\nimport Data.Text (Text)\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = do\n    state &lt;- newIORef $ T.pack \"\"\n    skey &lt;- newSignalKey\n    clazz &lt;- newClass [\n        defPropertySigRO' \"result\" skey (\\_ -&gt;\n            readIORef state),\n        defMethod' \"factorial\" (\\obj txt -&gt; do\n            let n = read $ T.unpack txt :: Integer\n            writeIORef state $ T.pack \"Working...\"\n            fireSignal skey obj\n            forkIO $ do\n                let out = T.take 1000 . T.pack . show $ product [1..n]\n                evaluate out\n                writeIORef state out\n                fireSignal skey obj\n            return ())]\n    ctx &lt;- newObject clazz ()\n    runEngineLoop defaultEngineConfig {\n        initialDocument = fileDocument \"factorial2.qml\",\n        contextObject = Just $ anyObjRef ctx}\n</code></pre>\n\n<p>QML file:</p>\n\n<pre><code>import QtQuick 2.0\n\nColumn {\n    height: 300;\n    TextInput {\n        id: input; width: 300; font.pixelSize: 30; focus: true;\n    }\n    Rectangle {\n        color: \"red\"; width: childrenRect.width; height: childrenRect.height;\n        Text {\n            width: 300; font.pixelSize: 30;\n            text: \"Calculate Factorial\"; color: \"white\";\n        }\n        MouseArea {\n            anchors.fill: parent;\n            onClicked: factorial(input.text);\n        }\n    }\n    Text {\n        width: 300; wrapMode: Text.WrapAnywhere; font.pixelSize: 30;\n        text: result;\n    }\n}\n</code></pre>\n\n<p>If you can see a difference between them, I am highly interested.</p>\n\n<p>UPDATE:\nnow that I changed all the spaces by tabs, I am faced to an other error :</p>\n\n<pre><code>Couldn't match expected type `(skv0\n                                 -&gt; tt0 -&gt; Graphics.QML.Objects.SignalValueParams skv0)\n                                -&gt; SignalKey p0 -&gt; ObjRef () -&gt; (a0 -&gt; m0 a0) -&gt; () -&gt; Text'\n              with actual type `Text'\n  The function `T.pack' is applied to six arguments,\n  but its type `String -&gt; Text' has only one\n  In the second argument of `($)', namely\n    `T.pack \"hello\" fireSignal skey obj return ()'\n  In the expression:\n    writeIORef state $ T.pack \"hello\" fireSignal skey obj return ()\n</code></pre>\n\n<p>I don't understand why ghc complains about pack which would applied to 6 arguments...</p>\n\n<p>UPDATE:\nthis code:</p>\n\n<pre><code>module Main where\n\nimport Graphics.QML\nimport Control.Concurrent\nimport Control.Exception\nimport Data.IORef\nimport Data.Text (Text)\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = do\n    state &lt;- newIORef $ T.pack \"\"\n    skey &lt;- newSignalKey\n    clazz &lt;- newClass [\n        defPropertySigRO' \"my_label\" skey (\\_ -&gt; readIORef state),\n        defMethod' \"sayHello\" (\\obj txt -&gt; do\n            writeIORef state $ T.pack txt\n            fireSignal skey obj\n            return ())]\n    ctx &lt;- newObject clazz ()\n    runEngineLoop defaultEngineConfig {\n        initialDocument = fileDocument \"exemple2.qml\",\n        contextObject = Just $ anyObjRef ctx}\n</code></pre>\n\n<p>leads to this error, still not understandable:</p>\n\n<pre><code>exemple-2.hs:16:17:\n    Couldn't match type `MarshalMode Char ICanGetFrom ()' with `Yes'\n    In the expression:\n      defMethod'\n        \"sayHello\"\n        (\\ obj txt\n           -&gt; do { writeIORef state $ T.pack txt;\n                   fireSignal skey obj;\n                   return () })\n    In the first argument of `newClass', namely\n      `[defPropertySigRO' \"my_label\" skey (\\ _ -&gt; readIORef state),\n        defMethod'\n          \"sayHello\"\n          (\\ obj txt\n             -&gt; do { writeIORef state $ T.pack txt;\n                     .... })]'\n    In a stmt of a 'do' block:\n      clazz &lt;- newClass\n                 [defPropertySigRO' \"my_label\" skey (\\ _ -&gt; readIORef state),\n                  defMethod'\n                    \"sayHello\"\n                    (\\ obj txt\n                       -&gt; do { writeIORef state $ T.pack txt;\n                               .... })]\n</code></pre>\n\n<p>EDIT : new code, new error message...</p>\n\n<p>code:</p>\n\n<pre><code>module Main where\n\nimport Graphics.QML\nimport Control.Concurrent\nimport Control.Exception\nimport Data.IORef\nimport Data.Text (Text)\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = do\n    state &lt;- newIORef $ T.pack \"\"\n    skey &lt;- newSignalKey\n    clazz &lt;- newClass [\n        defPropertySigRO' \"my_label\" skey (\\_ -&gt; readIORef state),\n        defMethod' \"sayHello\" (\\obj txt -&gt; do\n            writeIORef state txt\n            fireSignal skey obj\n            return ())]\n    ctx &lt;- newObject clazz ()\n    runEngineLoop defaultEngineConfig {\n        initialDocument = fileDocument \"exemple2.qml\",\n        contextObject = Just $ anyObjRef ctx}\n</code></pre>\n\n<p>error message:</p>\n\n<pre><code>Build FAILED\n\n/home/lowley/Documents/haskell/Qt/exemple-2.hs: line 13, column 10:\n  No instance for (SignalSuffix (IO a0))\n    arising from a use of `newSignalKey'\n  The type variable `a0' is ambiguous\n  Possible fix: add a type signature that fixes these type variable(s)\n  Note: there is a potential instance available:\n    instance SignalSuffix (IO ()) -- Defined in `Graphics.QML.Objects'\n  Possible fix:\n    add an instance declaration for (SignalSuffix (IO a0))\n  In a stmt of a 'do' block: skey &lt;- newSignalKey\n  In the expression:\n    do { state &lt;- newIORef $ T.pack \"\";\n         skey &lt;- newSignalKey;\n         clazz &lt;- newClass\n                    [defPropertySigRO' \"my_label\" skey (\\ _ -&gt; readIORef state),\n                     defMethod' \"sayHello\" (\\ obj txt -&gt; ...)];\n         ctx &lt;- newObject clazz ();\n         .... }\n  In an equation for `main':\n      main\n        = do { state &lt;- newIORef $ T.pack \"\";\n               skey &lt;- newSignalKey;\n               clazz &lt;- newClass\n                          [defPropertySigRO' \"my_label\" skey (\\ _ -&gt; ...), ....];\n               .... }\n</code></pre>\n"}, {"tags": ["haskell", "monads", "applicative", "io-monad", "lifting"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1457275688, "post_id": 35828128, "comment_id": 59323109, "body": "In the last expression, the <code>if</code> statement only controls the value that is returned - both branches must be executed in order to even compute those values, because it uses the applicative interface to IO. You probably want <code>return True &gt;&gt;= \\b -&gt; if&#39; b (putStrLn &quot;yes&quot;) (putStrLn &quot;no&quot;)</code> - note how <code>if&#39;</code> is applied <i>directly</i> to the different branches."}], "answers": [{"comments": [{"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 1, "creation_date": 1457287287, "post_id": 35828261, "comment_id": 59327782, "body": "@Carl has a great answer pertaining to this at <a href=\"https://stackoverflow.com/questions/17409260/what-advantage-does-monad-give-us-over-an-applicative\">https://stackoverflow.com/questions/17409260/what-advantage-&zwnj;&#8203;does-monad-give-us-o&zwnj;&#8203;ver-an-applicative</a>"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1457275582, "creation_date": 1457275582, "answer_id": 35828261, "question_id": 35828128, "link": "https://stackoverflow.com/questions/35828128/lifted-if-function-behaves-unexpectedly/35828261#35828261", "title": "Lifted \u201eif\u201c-function behaves unexpectedly", "body": "<p><code>(&lt;*&gt;)</code> evaluates both of its arguments, so it effectively a pipeline of applications lifted over some applicative. The ability to inspect values and change the future of the computation is the extra power that the <code>Monad</code> class has over <code>Applicative</code> so you need to use that instead e.g.</p>\n\n<pre><code>mif' :: Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a\nmif' bm xm ym = bm &gt;&gt;= (\\b -&gt; if b then xm else ym)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6025517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c004e2bd49fa5abde678b8c7269d5f55?s=128&d=identicon&r=PG&f=1", "display_name": "Xyzzy1201", "link": "https://stackoverflow.com/users/6025517/xyzzy1201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 35828261, "answer_count": 1, "score": 2, "last_activity_date": 1457277541, "creation_date": 1457274856, "last_edit_date": 1457277541, "question_id": 35828128, "link": "https://stackoverflow.com/questions/35828128/lifted-if-function-behaves-unexpectedly", "title": "Lifted \u201eif\u201c-function behaves unexpectedly", "body": "<p>in my program I use a function <code>if'</code> defined in one of the modules instead of the built-in <code>if-then-else</code> construct. It is defined trivially and works just fine.</p>\n\n<p>However, there's one place in code where I need to apply it to monad values (<code>IO</code> in my case), i.e. the type signature should look somewhat like <code>IO Bool -&gt; IO a -&gt; IO a -&gt; IO a</code>.\nNaturally, I tried to lift it.</p>\n\n<pre><code>if' &lt;$&gt; mb &lt;*&gt; action1 &lt;*&gt; action2\n</code></pre>\n\n<p>But when I try to evaluate the expression, I don't get what I expect.</p>\n\n<pre><code>*Main&gt; if' &lt;$&gt; return True &lt;*&gt; putStrLn \"yes\" &lt;*&gt; putStrLn \"no\"\nyes\nno\n</code></pre>\n\n<p>I know that <code>&lt;*&gt;</code> description reads \u201esequential application\u201c, so maybe it's that. But what is happening here? Can I fix it without writing a whole new dedicated function?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1457281137, "post_id": 35827652, "comment_id": 59325400, "body": "This is not really true. <code>interact</code> prints the result of applying the function to the whole input, but thanks to lazy IO, this does not in general mean that the whole input is read first, before anything is printed. It is true for the particular <code>f</code> in this question though because <code>f</code> is strict in its entire input string."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1457282393, "post_id": 35827652, "comment_id": 59325875, "body": "@ReidBarton I&#39;m not so sure that it is demanded to implement <code>interact</code> with lazy I/O, or that lazy I/O needs to exist at all. Hence what you describe is an implementation detail of a particular haskell implementation."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1457283299, "post_id": 35827652, "comment_id": 59326184, "body": "The Haskell Report says &quot;The <code>getContents</code> operation returns all user input as a single string, which is read lazily as it is needed&quot;, and the specification of <code>interact</code> is in terms of <code>getContents</code>. (Anyways what particular Haskell implementation did you have in mind that behaves as you described?)"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1457285483, "post_id": 35827652, "comment_id": 59327005, "body": "None in particular, @ReidBarton, but I thought that lazy I/O is a GHC speciality. Looks like I&#39;m wrong."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1457287496, "post_id": 35827652, "comment_id": 59327870, "body": "@ReidBarton  I hope my edit makes it more correct now. I tried to avoid technical terms like &quot;lazy IO&quot; though."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1457300842, "post_id": 35827652, "comment_id": 59332932, "body": "It&#39;s mostly the words &quot;first, then&quot; that I object to; &quot;and&quot; would be fine."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 0, "last_activity_date": 1457287416, "last_edit_date": 1457287416, "creation_date": 1457272240, "answer_id": 35827652, "question_id": 35827615, "link": "https://stackoverflow.com/questions/35827615/interact-function-waiting-non-stop-haskell/35827652#35827652", "title": "interact function waiting non-stop. Haskell", "body": "<p><code>interact</code> reads the whole input first, then prints the result of passing the whole input to the function. And unless the working function needs only an initial portion of the input, the Haskell run time needs to read until the end of input. Your function consumes the whole string, so that is what happens.</p>\n\n<p>Hence, you won't get a result until you finish input (i.e. CTRL+D in Unix).</p>\n"}, {"tags": [], "owner": {"reputation": 4455, "user_id": 1460448, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0dd5a0fbb2b5d5592a49d2e60ef98f0a?s=128&d=identicon&r=PG&f=1", "display_name": "xji", "link": "https://stackoverflow.com/users/1460448/xji"}, "is_accepted": false, "score": 0, "last_activity_date": 1463129951, "creation_date": 1463129951, "answer_id": 37205614, "question_id": 35827615, "link": "https://stackoverflow.com/questions/35827615/interact-function-waiting-non-stop-haskell/37205614#37205614", "title": "interact function waiting non-stop. Haskell", "body": "<p>There's an answer already at <a href=\"https://stackoverflow.com/questions/16799755/haskell-interact-function\">Haskell interact function</a>. The IO is lazy by default. If you want the function to deal with your input line-by-line what you can do is to use the <code>unline</code> function:</p>\n\n<p><code>interact (unlines . map (show . length) . lines)</code></p>\n\n<p>With a helper function</p>\n\n<pre><code>eachLine :: (String -&gt; String) -&gt; (String -&gt; String)\neachLine f = unlines . map f . lines\n</code></pre>\n\n<p>Then you can:</p>\n\n<p><code>main = interact (eachLine inputLength)</code></p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "closed_date": 1463132689, "accepted_answer_id": 35827652, "answer_count": 2, "score": 0, "last_activity_date": 1463129951, "creation_date": 1457272011, "question_id": 35827615, "link": "https://stackoverflow.com/questions/35827615/interact-function-waiting-non-stop-haskell", "closed_reason": "Duplicate", "title": "interact function waiting non-stop. Haskell", "body": "<p>Let's consider  the function:\n    import Data.Char</p>\n\n<pre><code>convertStringToInt :: String -&gt; Int\nconvertStringToInt s = convertStringToInt' s 1 0\n    where \n          convertStringToInt'  [] _ res    = res\n          convertStringToInt' (h:t) m res = convertStringToInt' t (m*10) (res + (((ord h) - 48)*m))\n\nf :: String -&gt; String \nf s = (show . convertStringToInt)s\n\nmain = interact f\n</code></pre>\n\n<p>When I input \"1212\" it will happen nothing. Just prompt is still waiting.\nWhy?</p>\n"}, {"tags": ["haskell", "zipper", "comonad"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1457297309, "post_id": 35827436, "comment_id": 59331551, "body": "FYI, you may be interested in other bits. See <a href=\"http://stackoverflow.com/a/25572148/1477667\">stackoverflow.com/a/25572148/1477667</a>"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1457339715, "post_id": 35827436, "comment_id": 59344708, "body": "And <a href=\"http://stackoverflow.com/questions/12963733/writing-cojoin-or-cobind-for-n-dimensional-grid-type/13100857#13100857\">this one</a> which addresses your question specifically. I somehow missed it, and my answer is rather redundant in its light, but at least I had the opportunity to figure part of it out for myself."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1457347798, "post_id": 35827436, "comment_id": 59349334, "body": "@Andr&#225;sKov&#225;cs D&#39;oh, my question seems to be an exact duplicate of that one. Don&#39;t know why I didn&#39;t find it when I was searching. I&#39;ll do the right thing and close this one."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1457349093, "post_id": 35827436, "comment_id": 59350130, "body": "@Benjamin Hodgson, your question is simpler and very well-written. It&#39;s easier to understand it and answers to it, so I don&#39;t think it should be closed."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1457349653, "post_id": 35827436, "comment_id": 59350451, "body": "@user3237465 This question and its answers are still here for future generations to search and read. There just won&#39;t be any new answers, and there&#39;s now a handy link to the duplicated question."}], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 5, "last_activity_date": 1457286437, "last_edit_date": 1457286437, "creation_date": 1457285947, "answer_id": 35830162, "question_id": 35827436, "link": "https://stackoverflow.com/questions/35827436/comonadically-finding-all-the-ways-to-focus-on-a-grid/35830162#35830162", "title": "Comonadically finding all the ways to focus on a grid", "body": "<p>So there's a closely related comonad that may help guide you.  We have:</p>\n\n<pre><code>newtype MC m a = MC { unMC :: m -&gt; a }\n\ninstance Monoid m =&gt; Comonad (MC m) where\n    extract (MC f) = f mempty\n    duplicate (MC f) = MC (\\x -&gt; MC (\\y -&gt; f (x &lt;&gt; y)))\n\ninstance Functor (MC m) where\n    fmap f (MC g) = MC (f . g) \n</code></pre>\n\n<p>So a bidirectionally infinite array would be <code>MC (Sum Integer) a</code> and a bidirectionally infinite grid would be <code>MC (Sum Integer, Sum Integer) a</code>.  And of course, <code>MC m (MC n a)</code> is isomorphic to <code>MC (m,n) a</code> via currying.</p>\n\n<p>At any rate, your desired duplicate grid function would be analogous (ignoring newtype wrappers and currying) to:</p>\n\n<pre><code>duplicateGrid g x y dx dy = g (x + dx) (y + dy)\n</code></pre>\n\n<p><code>duplicate</code> for the 1D array looks like:</p>\n\n<pre><code>duplicate f x y = f (x+y)\n</code></pre>\n\n<p>So <code>duplicate . duplicate</code> is:</p>\n\n<pre><code>(duplicate . duplicate) f x y z \n    = duplicate (duplicate f) x y z\n    = duplicate f (x+y) z\n    = f (x + y + z)\n</code></pre>\n\n<p>Not what is wanted.  What does <code>fmap duplicate</code> look like:</p>\n\n<pre><code>fmap duplicate f x y z = f x (y + z)\n</code></pre>\n\n<p>It's clear doing <code>duplicate</code> again will give us the same thing as <code>duplicate . duplicate</code> (which it should as this is a comonad law).  Nevertheless, this is a bit more promising.  If we did <em>two</em> <code>fmap</code>s ...</p>\n\n<pre><code>fmap (fmap duplicate) f x y z w\n    = fmap duplicate (f x) y z w\n    = f x y (z + w)\n</code></pre>\n\n<p>Now if we did <code>duplicate</code> we'd get</p>\n\n<pre><code>(duplicate . fmap (fmap duplicate)) f x y z w = f (x+y) (z+w)\n</code></pre>\n\n<p>But this is still wrong.  Changing variable names, its <code>f (x+y) (dx + dy)</code>.  So we need something to swap the two inner variables...  The category theory name for what we want is a distributive law.  The Haskell name is <code>Traversable</code>.  What does <code>sequenceA</code> look like for functions (functions form an <code>Applicative</code> functor and in fact a <code>Monad</code>, the <code>Reader</code> monad) look like?  The type says all.</p>\n\n<pre><code>sequenceA :: (a -&gt; b -&gt; c) -&gt; (b -&gt; a -&gt; c)\nsequenceA f x y = f y x \n</code></pre>\n\n<p>So finally:</p>\n\n<pre><code>fmap sequenceA g x y z = g x z y\n\n(duplicate . fmap (fmap duplicate) . fmap sequenceA) g x y dx dy\n    = (duplicate . fmap (fmap duplicate)) g x dx y dy\n    = g (x + dx) (y + dy)\n</code></pre>\n\n<p>I haven't actually tried the analogous code so I don't know if it works, but math says it should.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457301216, "post_id": 35831150, "comment_id": 59333064, "body": "Why not assume a &quot;dummy list&quot; is available? I believe you get one of those any time you can write a generalized <code>replicate</code>, and I don&#39;t think what you&#39;re doing will make sense outside that context."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1457303846, "post_id": 35831150, "comment_id": 59333911, "body": "I didn&#39;t think much about that, I just tend to reach for the weakest hypotheses, as habit. Now that you point this out, I had to think a bit to come up with convoluted counterexamples. So far I came up with this one: if <code>f</code> is a constant functor, then we should be able to <code>distribute</code> with any length.  But if the <code>a</code> in <code>f [a]</code> is bottom, we can only ever produce <code>[]</code>  as dummy list (in a total language)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1457348267, "post_id": 35831150, "comment_id": 59349631, "body": "Your trick of allowing the comonads to differ was illuminating; I wasn&#39;t thinking of <code>Grid</code> as the <i>composition</i> of <code>Zipper</code> with itself (and the corresponding <code>Comonad</code> instance). Your solution of duplicating twice and then distributing seems to coincide with <a href=\"http://stackoverflow.com/a/13100857/1523776\">@pigworker&#39;s answer</a>, given that if you have access to the stronger <code>Applicative</code> and <code>Traversable</code> constraints - which we do - then <code>distribute</code> is <code>sequenceA</code>."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 9, "last_activity_date": 1470306454, "last_edit_date": 1470306454, "creation_date": 1457290874, "answer_id": 35831150, "question_id": 35827436, "link": "https://stackoverflow.com/questions/35827436/comonadically-finding-all-the-ways-to-focus-on-a-grid/35831150#35831150", "title": "Comonadically finding all the ways to focus on a grid", "body": "<p>It's a bit of an issue here that we're trying to compose <code>Grid</code> with itself, because this setup gives us way too many incorrect ways to implement a <code>duplicate</code> with the right type. It's useful to consider the general case where the composed comonads aren't necessarily the same.</p>\n\n<p>Suppose we have <code>f</code> and <code>g</code> comonads. The type of <code>duplicate</code> becomes:</p>\n\n<pre><code>duplicate :: f (g a) -&gt; f (g (f (g a)))\n</code></pre>\n\n<p>We can get the following solely using the <code>Comonad</code> instances:</p>\n\n<pre><code>duplicate . fmap duplicate :: f (g a) -&gt; f (f (g (g a)))\n</code></pre>\n\n<p>From this it becomes apparent that we need to swap <code>f</code> and <code>g</code> in the middle. </p>\n\n<p>There's a type class called <a href=\"https://hackage.haskell.org/package/distributive-0.5.0.2/docs/Data-Distributive.html\" rel=\"nofollow\"><code>Distributive</code></a> that has the method we want.</p>\n\n<pre><code>class Functor g =&gt; Distributive g where\n    distribute :: Functor f =&gt; f (g a) -&gt; g (f a)\n</code></pre>\n\n<p>In particular, we need to implement <code>Distributive g</code>, and then <code>duplicate</code> for the composed comonad can be implemented as:</p>\n\n<pre><code>duplicate = fmap distribute . duplicate . fmap duplicate\n</code></pre>\n\n<p>However, the documentation in <code>Distributive</code> says that values of <code>g</code> must have the exact same shape, so we can zip together an arbitrary number of copies without loss of information. </p>\n\n<p>To illustrate this, if <code>Vec n a</code> is an <code>n</code>-sized vector, then <code>distribute :: [Vec n a] -&gt; Vec n [a]</code> is just matrix transposition. It's necessary to pin the down size of the inner vector beforehand, because transposition on a \"ragged\" matrix must drop some elements, and that's not lawful behavior. Infinite streams and zippers also distribute fine, as they too have just one possible size. </p>\n\n<p><code>Zipper</code> is not a lawful <code>Distributive</code> because <code>Zipper</code> contains values with differently sized contexts. Still, we can implement improper distribution that supposes uniform context sizes. </p>\n\n<p>Below I'll implement <code>duplicate</code> for <code>Grid</code> in terms of improper distribution for the underlying lists. </p>\n\n<p>Alternatively, one could just roll up their sleeves and implement a transposition function on <code>Zipper (Zipper a)</code> directly. I actually did this, but it gave me a headache and I'm far from being confident that it's correct. It's better to make the types as general as possible, in order to narrow down the space of possible implementations, so there's less room for errors. </p>\n\n<p>I'm going to omit <code>Reverse</code> in order to reduce syntactic noise; I hope you excuse me.</p>\n\n<pre><code>{-# language DeriveFunctor #-}\n\nimport Control.Comonad\nimport Data.List\nimport Control.Monad\n\ndata Zipper a = Zipper [a] a [a] deriving (Eq, Show, Functor)\n\nlefts, rights :: Zipper a -&gt; [a]\nlefts  (Zipper ls _ _) = ls\nrights (Zipper _ _ rs) = rs\n\nbwd :: Zipper a -&gt; Maybe (Zipper a)\nbwd (Zipper [] _ _) = Nothing\nbwd (Zipper (l:ls) a rs) = Just $ Zipper ls l (a:rs)\n\nfwd :: Zipper a -&gt; Maybe (Zipper a)\nfwd (Zipper _ _ []) = Nothing\nfwd (Zipper ls a (r:rs)) = Just $ Zipper (a:ls) r rs\n\ninstance Comonad Zipper where\n  extract (Zipper _ a _) = a\n  duplicate z =\n    Zipper (unfoldr (fmap (join (,)) . bwd) z) z (unfoldr (fmap (join (,)) . fwd) z)\n</code></pre>\n\n<p>We can distribute lists if we know their length beforehand. Since Haskell lists can be infinite, we should measure length with possibly infinite lazy naturals. An alternative solution to measuring length would be using a \"guide\" list along which we can zip other lists. However, I would rather not assume in the distribution functions that such a dummy list is always available. </p>\n\n<pre><code>data Nat = Z | S Nat\n\nlength' :: [a] -&gt; Nat\nlength' = foldr (const S) Z\n\ndistList :: Functor f =&gt; Nat -&gt; f [a] -&gt; [f a]\ndistList Z     fas = []\ndistList (S n) fas = (head &lt;$&gt; fas) : distList n (tail &lt;$&gt; fas)\n</code></pre>\n\n<p>Of course, this fails with runtime exceptions if our length assumption is incorrect. </p>\n\n<p>We can distribute <code>Zipper</code>s by distributing their focuses and contexts, provided that we know the lengths of the contexts:</p>\n\n<pre><code>distZipper :: Functor f =&gt; Nat -&gt; Nat -&gt; f (Zipper a) -&gt; Zipper (f a)\ndistZipper l r fz = Zipper\n  (distList l (lefts &lt;$&gt; fz)) (extract &lt;$&gt; fz) (distList r (rights &lt;$&gt; fz))\n</code></pre>\n\n<p>Finally, we can duplicate <code>Grid</code>s in the way we saw before, but first we have to determine the shape of the inner <code>Zipper</code>s. Since we assume that all inner <code>Zipper</code>s have the same shape, we only look at the <code>Zipper</code> in the focus:</p>\n\n<pre><code>duplicateGrid :: Grid a -&gt; Grid (Grid a)\nduplicateGrid grid@(Zipper _ (Zipper ls _ rs) _) = \n    fmap (distZipper (length' ls) (length' rs)) $ duplicate $ fmap duplicate grid\n</code></pre>\n\n<p>Testing this (as you must have already experienced) is pretty awful, and I haven't yet gotten around to check even a two-by-two case by hand. </p>\n\n<p>Still, I'm fairly confident in the above implementation, since the definitions are highly constrained by the types. </p>\n"}, {"tags": [], "owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "is_accepted": false, "score": 7, "last_activity_date": 1457310351, "last_edit_date": 1457310351, "creation_date": 1457296487, "answer_id": 35832200, "question_id": 35827436, "link": "https://stackoverflow.com/questions/35827436/comonadically-finding-all-the-ways-to-focus-on-a-grid/35832200#35832200", "title": "Comonadically finding all the ways to focus on a grid", "body": "<p>The fundamental problem you're running into is that <a href=\"https://stackoverflow.com/questions/8905030/two-dimensional-zipper\">zippers don't natively support 2-d structures</a>. The answer there is great (the other answer is basically exactly your definition of <code>Grid</code>) and I would encourage you to read it, but the gist is that zippers identify elements with paths to get there and in a 2-d space such an identification is problematic because there are many paths to get to a point.</p>\n\n<p>Hence you'll notice that while your <code>up</code> and <code>down</code> functions for <code>Grid</code>s was completely defined in terms of Zippers, you needed to use <code>Traversable</code> machinery to define <code>left</code> and <code>right</code>. This also means that <code>left</code> and <code>right</code> don't enjoy the same performance properties as <code>up</code> and <code>down</code> since you're \"going against the grain\" so to speak.</p>\n\n<p>Since your <code>Comonad</code> instance was defined only using your zipper functions, it can only <code>duplicate</code> in the direction that is defined by your zipper, namely <code>fwd</code> and <code>bwd</code> (and by extension <code>up</code> and <code>down</code>).</p>\n\n<p><strong>Edit</strong>: After some more thought I think that your approach is going to be fundamentally problematic. I've preserved my original text below, but there's a more glaring problem.</p>\n\n<p>If you're trying to traverse your zippers as if they were like any 2-d other structure, you're going to keep getting <code>Nothing</code> with your <code>duplicate</code>. Let's note what happens if you actually try to use your <code>up, down, left, right</code> functions on the ostensibly non-problematic <code>duplicate (mkZipper 'a' \"bc\")</code>.</p>\n\n<pre><code>*Main&gt; let allRows = duplicate $ mkZipper 'a' \"bc\"\n*Main&gt; down allRows -- This is fine since we're following the zipper normally\nJust (LZipper (Backwards [LZipper (Backwards \"\") 'a' \"bc\"]) (LZipper (Backwards \"a\") 'b' \"c\") [LZipper (Backwards \"ba\") 'c' \"\"])\n*Main&gt; right allRows\nNothing -- That's bad...\n*Main&gt; down allRows &gt;&gt;= right\nNothing -- Still nothing\n</code></pre>\n\n<p>Moving <code>right</code> and <code>left</code> requires (as you duly note with your mention of the invariant) that every single one of your sub-zippers is homogeneous in structure, otherwise the <code>traverse</code> will fail out prematurely. This means that if you actually want to use <code>left</code> and <code>right</code>, the only way this is going to play nice with <code>duplicate</code> is if you use the most uniform <code>duplicate</code> possible.</p>\n\n<pre><code>duplicate z @ (LZipper left focus right) = \n    LZipper (fmap (const z) left) z (fmap (const z) right)\n</code></pre>\n\n<p>The alternative is to only use the functions that comes with the zipper. That means only using <code>fwd</code> and <code>bwd</code>, and then <code>extract</code>ing the focus and continuing to use <code>fwd</code> and <code>bwd</code> to get the same thing as <code>left</code> and <code>right</code>. Of course that means giving up the ability to say both \"right then down\" and \"down then right,\" but as we've already seen, zippers don't play with multiple paths well.</p>\n\n<p>Now let's double-check your intuitions about how best to interpret what was going on with <code>duplicate . duplicate $ myGrid</code>. A nice square isn't really the best way of thinking about what's happening (and you'll see why if you restrict yourself to just <code>extract</code> and <code>fwd</code> and <code>bwd</code>).</p>\n\n<pre><code>*Main&gt; let allRows = duplicate . duplicate $ myGrid\n*Main&gt; fwd $ extract allRows -- Makes sense\nJust ...\n-- This *should* be the bottom-left of the grid\n*Main&gt; let bottomLeft = extract &lt;$&gt; fwd allRows &gt;&gt;= fwd\n*Main&gt; bottomLeft &gt;&gt;= fwd\nNothing -- Nope!\n*Main&gt; bottomLeft &gt;&gt;= bwd\nJust ... -- Wait a minute...\n</code></pre>\n\n<p>We've actually got a ragged structure.</p>\n\n<pre><code>+---------------------------------------------------+\n|                     ********* +-------+ +-------+ |\n|                     * A b c * | a b c | | a b c | |\n|                     * d e f * | D e f | | d e f | |\n|                     * g h i * | g h i | | G h i | |\n|                     ********* +-------+ +-------+ |\n|           +-------+ +-------+ +-------+           |\n|           | A b c | | a b c | | a b c |           |\n|           | d e f | | D e f | | d e f |           |\n|           | g h i | | g h i | | G h i |           |\n|           +-------+ +-------+ +-------+           |\n| +-------+ +-------+ +-------+                     |\n| | A b c | | a b c | | a b c |                     |\n| | d e f | | D e f | | d e f |                     |\n| | g h i | | g h i | | G h i |                     |\n| +-------+ +-------+ +-------+                     |\n+---------------------------------------------------+\n</code></pre>\n\n<p>The squares inside of this ragged structure aren't actually squares either, they'll be ragged as well. Equivalently you could think of <code>fwd</code> as going diagonally. Or just drop zippers for 2-d structures altogether.</p>\n\n<p><strong>In my experience, zippers really work best when paired with tree-like things.</strong> I wouldn't be surprised if a Haskell expert could come up with a way of using zippers and all the update / access goodness that comes with them for things like cyclic graphs or even just plain old DAGs, but I can't think of any off the top of my meager head :).</p>\n\n<p>So moral of the story, zippers are quite a bit of a headache for 2-d structures. (Idle thought: maybe lenses might be interesting?)</p>\n\n<p>For the curious, my approach below also only works if you keep in mind the raggedness of the structure we're dealing with; that is <code>fwd</code>ing twice and then extracting will get you the equivalent of what OP wants at the bottom-right-hand corner of his grid, not at the bottom left-hand side.</p>\n\n<p><strong>Original</strong>:</p>\n\n<p>So what you need is some way to switch between your purely zipper-based <code>duplicate</code> and your <code>Traversable</code>-based duplicate. The easiest way is to take your <code>duplicate</code> function you've already written and simply add a <code>traverse</code> in the middle.</p>\n\n<pre><code>duplicateT :: Traversable t =&gt; t (LZipper a) -&gt; LZipper (t (LZipper a))\nduplicateT z = LZipper (Backwards $ unfoldr (step bwd) z) z (unfoldr (step fwd) z)\n    -- Everything's the exact same except for that extra traverse\n    where step move = fmap (\\y -&gt; (y, y)) . (traverse move)\n</code></pre>\n\n<p>Now that we have a more general <code>duplicateT</code> we can get rid of some nasty code duplication by redefining <code>duplicate</code> in your <code>Comonad</code> instance to be:</p>\n\n<pre><code>-- requires import Data.Functor.Identity\nduplicate = fmap runIdentity (duplicate' (Identity z))\n</code></pre>\n\n<p>Then the following gets you what you want</p>\n\n<pre><code>duplicateGrid = duplicate . duplicateT\n</code></pre>\n\n<p>Or if you want to switch the order of the columns and rows, you can do the opposite.</p>\n\n<p>Note: It would be even nicer if Haskell let you natively define type constraints on typeclasses so that you could have different instances of Comonad (all mediated with <code>newtype</code>s perhaps) for your <code>LZipper</code> that change the direction of your <code>duplicate</code>. The problem is that you would want something like <code>instance Comonad LZipper (LZipper a) where ...</code> or the equivalent <code>newtype</code> which you simply can't write in Haskell. You could conceivably do something like <a href=\"https://hackage.haskell.org/package/rmonad-0.8.0.2\" rel=\"nofollow\">this</a> with type families, but I suspect that that's probably overkill for this particular instance.</p>\n\n<p><strong>Edit</strong>: In fact you don't even need <code>duplicateT</code> if you give the appropriate <code>Applicative</code> instance for <code>LZipper</code>.</p>\n\n<pre><code>instance Applicative LZipper where\n    pure x = LZipper (Backwards (repeat x)) x (repeat x)\n    (LZipper leftF f rightF) &lt;*&gt; (LZipper left x right) = LZipper newLeft (f x) newRight\n      where\n        newLeft = (Backwards (zipWith ($) (forwards leftF) (forwards left)))\n        newRight = (zipWith ($) rightF right)\n</code></pre>\n\n<p>Now simply take the original <code>duplicate</code> you had before and use <code>traverse</code>.</p>\n\n<pre><code>duplicateGrid = duplicate . (traverse duplicate)\n</code></pre>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 2, "closed_date": 1457347854, "accepted_answer_id": 35831150, "answer_count": 3, "score": 17, "last_activity_date": 1470306454, "creation_date": 1457270956, "last_edit_date": 1470267128, "question_id": 35827436, "link": "https://stackoverflow.com/questions/35827436/comonadically-finding-all-the-ways-to-focus-on-a-grid", "closed_reason": "Duplicate", "title": "Comonadically finding all the ways to focus on a grid", "body": "<pre><code>{-# LANGUAGE DeriveFoldable #-}\n{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE DeriveTraversable #-}\nimport Control.Comonad\nimport Data.Functor.Reverse\nimport Data.List (unfoldr)\n</code></pre>\n\n<p>First some context (ha ha). I have a <a href=\"https://www.st.cs.uni-saarland.de/edu/seminare/2005/advanced-fp/docs/huet-zipper.pdf\" rel=\"nofollow\">zipper</a> over non-empty lists.</p>\n\n<pre><code>data LZipper a = LZipper (Reverse [] a) a [a]\n    deriving (Eq, Ord, Show, Read, Functor, Foldable, Traversable)\n\nmkZipper :: a -&gt; [a] -&gt; LZipper a\nmkZipper = LZipper (Reverse [])\n</code></pre>\n\n<p>You can step in either direction along the zipper, but you might fall off the end.</p>\n\n<pre><code>fwd, bwd :: LZipper a -&gt; Maybe (LZipper a)\nfwd (LZipper _ _ []) = Nothing\nfwd (LZipper (Reverse xs) e (y:ys)) = Just $ LZipper (Reverse (e:xs)) y ys\nbwd (LZipper (Reverse []) _ _) = Nothing\nbwd (LZipper (Reverse (x:xs)) e ys) = Just $ LZipper (Reverse xs) x (e:ys)\n</code></pre>\n\n<p>Duplicating a zipper shows you all the ways you could look at it, with the focus on the way you're looking at it currently.</p>\n\n<pre><code>instance Comonad LZipper where\n    extract (LZipper _ x _) = x\n    duplicate z = LZipper (Reverse $ unfoldr (step bwd) z) z (unfoldr (step fwd) z)\n        where step move = fmap (\\y -&gt; (y, y)) . move\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>ghci&gt; duplicate (mkZipper 'a' \"bc\")\nLZipper (Reverse [])\n        (LZipper (Reverse \"\") 'a' \"bc\")\n        [LZipper (Reverse \"a\") 'b' \"c\",LZipper (Reverse \"ba\") 'c' \"\"]\n-- Abc -&gt; *Abc* aBc abC\n\nghci&gt; fmap duplicate (fwd $ mkZipper 'a' \"bc\")\nJust (LZipper (Reverse [LZipper (Reverse \"\") 'a' \"bc\"])\n              (LZipper (Reverse \"a\") 'b' \"c\")\n              [LZipper (Reverse \"ba\") 'c' \"\"])\n-- aBc -&gt; Abc *aBc* abC\n</code></pre>\n\n<p>(I'm using capitals and asterisks to indicate the focal point of the zipper.)</p>\n\n<hr>\n\n<p>I'm trying to work with two-dimensional grids with a focus, represented as a zipper of zippers. Each inner zipper is a row of the grid. My end goal is to find paths through a grid by hopping from neighbour to neighbour.</p>\n\n<p>Moving through the grid maintains the invariant that all the rows are focused on the same index. This makes it easy to focus on any of your neighbours.</p>\n\n<pre><code>type Grid a = LZipper (LZipper a)\n\nup, down, left, right :: Grid a -&gt; Maybe (Grid a)\nup = bwd\ndown = fwd\nleft = traverse bwd\nright = traverse fwd\n\nextractGrid :: Grid a -&gt; a\nextractGrid = extract . extract\nmkGrid :: (a, [a]) -&gt; [(a, [a])] -&gt; Grid a\nmkGrid (x, xs) xss = mkZipper (mkZipper x xs) $ map (uncurry mkZipper) xss\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>ghci&gt; let myGrid = mkGrid ('a', \"bc\") [('d', \"ef\"), ('g', \"hi\")]\nghci&gt; myGrid\nLZipper (Reverse [])\n        (LZipper (Reverse \"\") 'a' \"bc\")\n        [LZipper (Reverse \"\") 'd' \"ef\",LZipper (Reverse \"\") 'g' \"hi\"]\n-- +-------+ \n-- | A b c |\n-- | d e f |\n-- | g h i |\n-- +-------+\n\nghci&gt; return myGrid &gt;&gt;= right &gt;&gt;= down\nJust (LZipper (Reverse [LZipper (Reverse \"a\") 'b' \"c\"])\n              (LZipper (Reverse \"d\") 'e' \"f\")\n              [LZipper (Reverse \"g\") 'h' \"i\"])\n-- +-------+ \n-- | a b c |\n-- | d E f |\n-- | g h i |\n-- +-------+\n</code></pre>\n\n<p>What I want is the equivalent of <code>LZipper</code>'s <code>duplicate</code> for grids: a function that takes a grid and produces a grid of all the ways you could look at the grid, with the focus on the <em>current</em> way you're looking at it.</p>\n\n<pre><code>duplicateGrid :: Grid a -&gt; Grid (Grid a)\n</code></pre>\n\n<p>What I'm expecting:</p>\n\n<pre><code>duplicateGrid myGrid\n+-------------------------------+\n| ********* +-------+ +-------+ |\n| * A b c * | a B c | | a b C | |\n| * d e f * | d e f | | d e f | |\n| * g h i * | g h i | | g h i | |\n| ********* +-------+ +-------+ |\n| +-------+ +-------+ +-------+ |\n| | a b c | | a b c | | a b c | |\n| | D e f | | d E f | | d e F | |\n| | g h i | | g h i | | g h i | |\n| +-------+ +-------+ +-------+ |\n| +-------+ +-------+ +-------+ |\n| | a b c | | a b c | | a b c | |\n| | d e f | | d e f | | d e f | |\n| | G h i | | g H i | | g h I | |\n| +-------+ +-------+ +-------+ |\n+-------------------------------+\n</code></pre>\n\n<p>I tried <code>duplicateGrid = duplicate . duplicate</code>. This has the correct type, but (assuming that I interpreted the <code>show</code> output correctly, which I probably didn't) it only gives me grids focused somewhere on the first column:</p>\n\n<pre><code>(duplicate . duplicate) myGrid\n+-------------------------------+\n| ********* +-------+ +-------+ |\n| * A b c * | a b c | | a b c | |\n| * d e f * | D e f | | d e f | |\n| * g h i * | g h i | | G h i | |\n| ********* +-------+ +-------+ |\n| +-------+ +-------+ +-------+ |\n| | A b c | | a b c | | a b c | |\n| | d e f | | D e f | | d e f | |\n| | g h i | | g h i | | G h i | |\n| +-------+ +-------+ +-------+ |\n| +-------+ +-------+ +-------+ |\n| | A b c | | a b c | | a b c | |\n| | d e f | | D e f | | d e f | |\n| | g h i | | g h i | | G h i | |\n| +-------+ +-------+ +-------+ |\n+-------------------------------+\n</code></pre>\n\n<p>I also tried <code>duplicateGrid = duplicate . fmap duplicate</code>. Assuming once again that I'm capable of interpreting the <code>show</code> output, this gave me something that both contained the wrong grids and had the focuses of the rows misaligned, such that moving down would also move you along:</p>\n\n<pre><code>(duplicate . fmap duplicate) myGrid\n+-------------------------------+\n| ********* +-------+ +-------+ |\n| * A b c * | D e f | | G h i | |\n| * a B c * | d E f | | g H i | |\n| * a b C * | d e F | | g h I | |\n| ********* +-------+ +-------+ |\n| +-------+ ********* +-------+ |\n| | A b c | * D e f * | G h i | |\n| | a B c | * d E f * | g H i | |\n| | a b C | * d e F * | g h I | |\n| +-------+ ********* +-------+ |\n| +-------+ +-------+ ********* |\n| | A b c | | D e f | * G h i * |\n| | a B c | | d E f | * g H i * |\n| | a b C | | d e F | * g h I * |\n| +-------+ +-------+ ********* |\n+-------------------------------+\n</code></pre>\n\n<p>This feels like it'd be an easy question for those in the know, but it's making my head spin. I suppose I could hand-crank a function which calls <code>up</code>, <code>down</code>, <code>left</code> and <code>right</code>, but I feel like the comonadic machinery ought to be able to do it for me. What is the correct implementation of <code>duplicateGrid</code>?</p>\n"}, {"tags": ["parsing", "haskell", "tuples", "monads", "parsec"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1457281460, "post_id": 35826482, "comment_id": 59325541, "body": "Please do not post the same question multiple times. Stack Overflow has mechanisms to attract attention to an existing question."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457270442, "post_id": 35826633, "comment_id": 59321257, "body": "thank you! so obvious though :P"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 0, "last_activity_date": 1457265898, "creation_date": 1457265898, "answer_id": 35826633, "question_id": 35826482, "link": "https://stackoverflow.com/questions/35826482/parsing-a-tuple-string-int-in-haskell/35826633#35826633", "title": "Parsing a Tuple (String,Int) in Haskell", "body": "<p>The error message is basically saying that you did not supply enough type arguments. And if you compare the signature of your tuple parser with the others you'll see why:</p>\n\n<pre><code>stringLit :: Parsec String u String\nlistOfStrings :: Parsec String u [String]\nstringIntTuple :: Parsec (String , Int)\n</code></pre>\n\n<p>In all other cases you supply three type arguments, but for <code>stringIntTuple</code> you only supply one.</p>\n\n<p>So just add <code>String</code> and <code>u</code> as the first two arguments, like you did for the others, and it'll work.</p>\n"}], "owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "closed_date": 1457325330, "accepted_answer_id": 35826633, "answer_count": 1, "score": 0, "last_activity_date": 1457265898, "creation_date": 1457264874, "last_edit_date": 1457265631, "question_id": 35826482, "link": "https://stackoverflow.com/questions/35826482/parsing-a-tuple-string-int-in-haskell", "closed_reason": "Duplicate", "title": "Parsing a Tuple (String,Int) in Haskell", "body": "<p>I  need to parse a <code>(String,Int)</code> type as <code>userRatings</code> is in order to read from a <code>textFile</code> correctly and I am using <code>Parsec</code>. This is the Parsing along with the import, my <code>stringInt</code> tuple function has this error.</p>\n\n<blockquote>\n  <p>Expecting two more arguments to \u2018Parsec (String, Int)\u2019\n      Expected a type, but \u2018Parsec (String, Int)\u2019 has kind \u2018* -> * -> *\u2019\n      In the type signature for \u2018stringIntTuple\u2019:\n        stringIntTuple :: Parsec (String, Int)</p>\n</blockquote>\n\n<pre><code>    import Control.Monad\n    import Control.Applicative((&lt;*))\n    import Text.Parsec\n        ( Parsec, ParseError, parse        -- Types and parser\n        , between, noneOf, sepBy, many1    -- Combinators\n        , char, spaces, digit, newline     -- Simple parsers\n        )\n    -- Types\n    type Title = String\n    type Director = String\n    type Year = Int\n    type UserRatings = (String,Int) \n    type Film = (Title, Director, Year , [UserRatings])\n    type Period = (Year, Year)\n    type Database = [Film]\n\n\n    -- Parse a string to a string\n    stringLit :: Parsec String u String\n    stringLit = between (char '\"') (char '\"') $ many1 $ noneOf \"\\\"\\n\"\n\n    -- Parse a string to a list of strings\n   listOfStrings :: Parsec String u [String]\n   listOfStrings = stringLit `sepBy` (char ',' &gt;&gt; spaces)\n\n   -- Parse a string to an int\n   intLit :: Parsec String u Int\n   intLit = fmap read $ many1 digit\n   -- Or `read &lt;$&gt; many1 digit` with Control.Applicative\n   stringIntTuple :: Parsec (String , Int)\n   stringIntTuple = liftM2 (,) stringLit intLit\n\n   film :: Parsec String u Film\n   film = do\n\ntitle &lt;- stringLit\nnewline\ndirector &lt;- stringLit\nnewline\nyear &lt;- intLit\nnewline\nuserRatings &lt;- stringIntTuple\nnewline\nreturn (title, director, year, userRatings)\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "persistent"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457263474, "post_id": 35826229, "comment_id": 59319193, "body": "as all your functions deal with <code>User</code> it should be simple to refactor out a function like <code>updateTimes :: User -&gt; IO User</code> and just use this - if you want to do this for more than <code>User</code> then you probably want to introduce some type-class for this"}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 3, "last_activity_date": 1457265461, "last_edit_date": 1457265461, "creation_date": 1457264974, "answer_id": 35826493, "question_id": 35826229, "link": "https://stackoverflow.com/questions/35826229/how-to-deal-with-housekeeping-fields-in-record-types/35826493#35826493", "title": "How to deal with &quot;housekeeping&quot; fields in record types?", "body": "<blockquote>\n  <p>However, this would mean that every call-site for createUserFromX will need to call getCurrentTime and set the createdAt and updatedAt house-keeping fields.</p>\n</blockquote>\n\n<p>It's not true. The definition of <code>SqlPersistM</code> is:</p>\n\n<pre><code>type SqlPersistM = SqlPersistT (NoLoggingT (ResourceT IO))\ntype SqlPersistT = ReaderT SqlBackend\n</code></pre>\n\n<p>So <code>SqlPersistM</code> has an instance of MonadIO, you can perform any IO action inside your <code>createUserFromX</code> by <code>liftIO your_io_action</code>:</p>\n\n<pre><code>createUserFromX :: User -&gt; SqlPersistM (Entity User)\ncreateUserFromX user = do\n    utctime &lt;- liftIO getCurrentTime\n    let user' = user { createdAt = utctime, updatedAt = utctime }\n    -- your codes\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457265461, "creation_date": 1457263236, "question_id": 35826229, "link": "https://stackoverflow.com/questions/35826229/how-to-deal-with-housekeeping-fields-in-record-types", "title": "How to deal with &quot;housekeeping&quot; fields in record types?", "body": "<p>Every table in my DB needs to have a <code>created_at</code> and <code>updated_at</code> field for general hygiene and housekeeping. This leads to Persistent models which look like this:</p>\n\n<pre><code>User\n  email String Maybe\n  name String Maybe\n  tgramUserId TgramUserId Maybe\n  createdAt UTCTime\n  updatedAt UTCTime\n  deriving Show\n</code></pre>\n\n<p>Now, I have a bunch of APIs for creating users, based on different business cases. For example:</p>\n\n<ul>\n<li>createUserFromWebForm</li>\n<li>createUserFromTelegram</li>\n<li>createUserFromOAuth</li>\n</ul>\n\n<p>I'd like the type-signatures of each of these APIs to be:</p>\n\n<pre><code>createUserFromX :: User -&gt; SqlPersistM (Entity User)\n</code></pre>\n\n<p>However, this would mean that every call-site for <code>createUserFromX</code> will need to call <code>getCurrentTime</code> and set the <code>createdAt</code> and <code>updatedAt</code> house-keeping fields. What's the way to localize this complexity within these APIs itself?</p>\n\n<p>One unclean (IMO) solution is to change the signature to:</p>\n\n<pre><code>createUserFromTelegram :: Maybe TgramUserId -&gt; SqlPersistM (Entity User)\n</code></pre>\n\n<p>... but that defeats the purpose of using record-types in the first place (In this particular example, you can probably argue in-favour of this approach, but what if the record-type had 10 fields)?</p>\n"}, {"tags": ["file", "haskell", "io", "parsec"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1457256369, "post_id": 35825148, "comment_id": 59317238, "body": "Make your code self-contained (see <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>); in particular, add your imports."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1457256508, "post_id": 35825148, "comment_id": 59317273, "body": "you need to import this in order to see the problem  import Text.Parsec     ( Parsec, ParseError, parse        -- Types and parser     , between, noneOf, sepBy, many1    -- Combinators     , char, spaces, digit, newline     -- Simple parsers     )"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457256890, "post_id": 35825200, "comment_id": 59317385, "body": "i am still getting this error Expecting two more arguments to \u2018Parsec (String, Int)\u2019     Expected a type, but \u2018Parsec (String, Int)\u2019 has kind \u2018* -&gt; * -&gt; *\u2019     In the type signature for \u2018stringIntTuple\u2019:       stringIntTuple :: Parsec (String, Int)"}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457266931, "post_id": 35825200, "comment_id": 59320201, "body": "That&#39;s because you&#39;re using <code>Parsec</code> instead of <code>Parser</code>."}, {"owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "edited": false, "score": 0, "creation_date": 1457269546, "post_id": 35825200, "comment_id": 59320960, "body": "when i change everything to Parser it says not in scope  Not in scope: type constructor or class \u2018Parser\u2019     Perhaps you meant \u2018Parsec\u2019 (imported from Text.Parsec)"}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 1, "last_activity_date": 1457256352, "creation_date": 1457256352, "answer_id": 35825200, "question_id": 35825148, "link": "https://stackoverflow.com/questions/35825148/how-to-parse-a-tuple-string-int-in-haskell-using-parsec/35825200#35825200", "title": "How to parse a Tuple (String,Int) in Haskell using parsec", "body": "<p>You can do this by composing from existing parsers using either the <code>Applicative</code> or the <code>Monad</code> interface. <code>Parser</code> has instances of both.</p>\n\n<p>Using <code>Applicative</code>:</p>\n\n<pre><code>stringIntTuple :: Parser (String, Int)\nstringIntTuple = (,) &lt;$&gt; yourStringParser &lt;*&gt; yourIntParser\n</code></pre>\n\n<p>Which is the same as the following:</p>\n\n<pre><code>stringIntTuple :: Parser (String, Int)\nstringIntTuple = liftA2 (,) yourStringParser yourIntParser\n</code></pre>\n\n<p>Using <code>Monad</code>:</p>\n\n<pre><code>stringIntTuple :: Parser (String, Int)\nstringIntTuple =\n  do\n    theString &lt;- yourStringParser\n    theInt &lt;- yourIntParser\n    return (theString, theInt)\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6024818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bec01f3c820aa4b188b0295c68e046?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6024818/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1457256582, "creation_date": 1457256052, "last_edit_date": 1457256582, "question_id": 35825148, "link": "https://stackoverflow.com/questions/35825148/how-to-parse-a-tuple-string-int-in-haskell-using-parsec", "title": "How to parse a Tuple (String,Int) in Haskell using parsec", "body": "<p>I think i already managed to parse strings to strings and strings to Ints but I also need to parse a (String,Int) type as userRatings is in order to read from a textFile correctly and I am using Parsec</p>\n\n<p>This is the Parsing along with the import</p>\n\n<pre><code>import Text.Parsec\n( Parsec, ParseError, parse        -- Types and parser\n, between, noneOf, sepBy, many1    -- Combinators\n, char, spaces, digit, newline     -- Simple parsers\n)\n\n-- Parse a string to a string\nstringLit :: Parsec String u String\nstringLit = between (char '\"') (char '\"') $ many1 $ noneOf \"\\\"\\n\"\n\n-- Parse a string to a list of strings\nlistOfStrings :: Parsec String u [String]\nlistOfStrings = stringLit `sepBy` (char ',' &gt;&gt; spaces)\n\n-- Parse a string to an int\nintLit :: Parsec String u Int\nintLit = fmap read $ many1 digit\n-- Or `read &lt;$&gt; many1 digit` with Control.Applicative\n\nfilm :: Parsec String u Film\nfilm = do\n-- alternatively `title &lt;- stringLit &lt;* newline` with Control.Applicative\ntitle &lt;- stringLit\nnewline\ndirector &lt;- stringLit\nnewline\nyear &lt;- intLit\nnewline\nuserRatings &lt;- listOfStrings\nnewline\nreturn (title, director, year, userRatings)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1457245719, "post_id": 35823809, "comment_id": 59314745, "body": "Still how do I parse the value out of an <code>Either</code> type?"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1457246802, "post_id": 35823809, "comment_id": 59314921, "body": "First thing that you need to understand is that the <code>Either Bool Int</code> value may have no <code>Int</code> in it, but <code>Bool</code>. Do you know what you want to do in this case? You can use <code>case</code> with pattern matching or <a href=\"http://haddock.stackage.org/nightly-2016-03-04/base-4.8.2.0/Data-Either.html#v:either\" rel=\"nofollow noreferrer\"><code>either</code></a> function to write <code>myFunc</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1457248416, "post_id": 35823809, "comment_id": 59315209, "body": "Funnily enough, you actually <i>can</i> write a total function of type <code>MyType -&gt; Int</code>, but I think not for the reason you&#39;re expecting! You have defined a new data constructor named <code>Either</code> -- completely unrelated to the type constructor named <code>Either</code> -- which contains a <code>Bool</code> and an <code>Int</code>..."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 3, "creation_date": 1457251500, "post_id": 35823809, "comment_id": 59315890, "body": "Side note: &quot;parse&quot; usually means converting a <i>string</i> into something."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1457251529, "last_edit_date": 1457251529, "creation_date": 1457251204, "answer_id": 35824505, "question_id": 35823809, "link": "https://stackoverflow.com/questions/35823809/how-to-parse-concrete-value-out-of-either-type/35824505#35824505", "title": "How to parse concrete value out of Either type", "body": "<p>first note that you <code>data</code> definition is of as Cactus and Daniel mentioned - for now I assume you wanted</p>\n\n<pre><code>type MyType = Either Bool Int\n</code></pre>\n\n<hr>\n\n<p>if you really wanted <code>data MyType = Either Bool Int</code> then the situation is the same as I describe bellow with <code>data MyType = MyType ...</code></p>\n\n<hr>\n\n<p>as an <code>Either Bool Int</code> can have either a <code>Bool</code> value (for example <code>Left True</code>) <strong>or</strong> an <code>Int</code> value (for example <code>Right 42</code>) your choice is basically to <em>either</em> write a partial function:</p>\n\n<pre><code>myFunc :: MyType -&gt; Int\nmyFunc (Right number) = number\nmyFunc (Left _)       = error \"oho ... there is no number\"\n</code></pre>\n\n<p>or you write a total-one with a default value for the bool case:</p>\n\n<pre><code>myFunc :: MyType -&gt; Int\nmyFunc (Right number) = number\nmyFunc (Left True)    = 1\nmyFunc (Left False)   = 2\n</code></pre>\n\n<p>or you change the result type to reflect the incapability of getting some number out (using <code>Maybe</code>):</p>\n\n<pre><code>myFunc :: MyType -&gt; Maybe Int\nmyFunc (Right number) = Just number\nmyFunc (Left _)       = Nothing\n</code></pre>\n\n<hr>\n\n<p>of course maybe you did want to have a type with <strong>both</strong> an <code>Bool</code> and an <code>Int</code> part - in this case change your type into:</p>\n\n<pre><code>data MyType = MyType Bool Int\n</code></pre>\n\n<p>and write</p>\n\n<pre><code>myFunc :: MyType -&gt; Int\nmyFunc (MyType _ nr) = nr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 0, "last_activity_date": 1457251403, "creation_date": 1457251403, "answer_id": 35824531, "question_id": 35823809, "link": "https://stackoverflow.com/questions/35823809/how-to-parse-concrete-value-out-of-either-type/35824531#35824531", "title": "How to parse concrete value out of Either type", "body": "<pre><code>data MyType = Either Bool Int\n</code></pre>\n\n<p>This does <strong>not</strong> mean what you think it does. This creates a new algebraic data type called <code>MyType</code>, with a single constructor called <code>Either</code> that takes a <code>Bool</code> and an <code>Int</code>. So you'll have e.g.</p>\n\n<pre><code>Either True 42 :: MyType\n</code></pre>\n\n<p>What you want is the ability to refer to the existing type <code>Either Bool Int</code> using a new name <code>MyType</code>, i.e. a type synonym. You can define type synonyms using <code>type</code> instead of <code>data</code>, i.e.</p>\n\n<pre><code>type MyType = Either Bool Int\n</code></pre>\n\n<p>this will yield</p>\n\n<pre><code>Left True :: MyType\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Right 42 :: MyType\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1457251529, "creation_date": 1457244949, "last_edit_date": 1457245792, "question_id": 35823809, "link": "https://stackoverflow.com/questions/35823809/how-to-parse-concrete-value-out-of-either-type", "title": "How to parse concrete value out of Either type", "body": "<p>I have a data structure like so:</p>\n\n<pre><code>data MyType = Either Bool Int\n</code></pre>\n\n<p>Now I have a function like so:</p>\n\n<pre><code>myFunc :: MyType -&gt; Int\nmyFunc mt = Right mt\n</code></pre>\n\n<p>My goal is to get the <code>Int</code> value out of the <code>myType</code> but when I try to compile this function I get the following error:</p>\n\n<pre><code>Couldn't match expected type `Int'\n            with actual type `Either a0 MyType'\nIn the expression: Right mt\nIn an equation for `myFunc': myFunc mt = Right mt\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 12, "last_activity_date": 1457295081, "last_edit_date": 1457295081, "creation_date": 1457242278, "answer_id": 35823503, "question_id": 35823465, "link": "https://stackoverflow.com/questions/35823465/haskell-cannot-parse-data-constructor-in-a-data-newtype-declaration-either-i/35823503#35823503", "title": "haskell - Cannot parse data constructor in a data/newtype declaration: [Either Int Int]", "body": "<p><code>data</code> is for defining new algebraic data types, which must each have their own constructor(s). So you could write</p>\n\n<pre><code>data EitherInts = EitherInts [Either Int Int]\n</code></pre>\n\n<p>But you probably don't mean this: you want some kind of type synonym. The simplest would be a type alias:</p>\n\n<pre><code>type EitherInts = [Either Int Int]\n</code></pre>\n\n<p>which acts exactly like <code>[Either Int Int]</code> - it's just a new, abbreviated name for that existing type. </p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5037, "favorite_count": 0, "accepted_answer_id": 35823503, "answer_count": 1, "score": 5, "last_activity_date": 1457295081, "creation_date": 1457241893, "question_id": 35823465, "link": "https://stackoverflow.com/questions/35823465/haskell-cannot-parse-data-constructor-in-a-data-newtype-declaration-either-i", "title": "haskell - Cannot parse data constructor in a data/newtype declaration: [Either Int Int]", "body": "<p>I'm trying to declare a datatype that is a list of <code>Either</code> types.</p>\n\n<pre><code>data EitherInts = [Either Int Int]\n</code></pre>\n\n<p>But when I try to compile this type I get an error:</p>\n\n<pre><code>Cannot parse data constructor in a data/newtype declaration: [Either Int Int]\n</code></pre>\n\n<p>I have no idea why. What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5493, "user_id": 13271, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84a0902d23f23c6784e34e3d20288933?s=128&d=identicon&r=PG", "display_name": "kes", "link": "https://stackoverflow.com/users/13271/kes"}, "edited": false, "score": 0, "creation_date": 1457238262, "post_id": 35822436, "comment_id": 59313363, "body": "<code>checkRateRerate</code> doesn&#39;t handle all cases.  For example, what if the 4th argument (<code>[UserRating]</code>) is an empty list, but <code>user</code> is not an empty string?"}, {"owner": {"reputation": 13, "user_id": 6015788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344788a13cfeed30d187ff8134914f01?s=128&d=identicon&r=PG&f=1", "display_name": "mirage206wrc", "link": "https://stackoverflow.com/users/6015788/mirage206wrc"}, "reply_to_user": {"reputation": 5493, "user_id": 13271, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84a0902d23f23c6784e34e3d20288933?s=128&d=identicon&r=PG", "display_name": "kes", "link": "https://stackoverflow.com/users/13271/kes"}, "edited": false, "score": 0, "creation_date": 1457315835, "post_id": 35822436, "comment_id": 59336996, "body": "I have made some corrections to the coding but need a bit of a helping hand to fix the cases of swapRate, so that both demo 1 &amp; 11 can work. If you could help, it would be nice. Thanks for your time."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6015788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344788a13cfeed30d187ff8134914f01?s=128&d=identicon&r=PG&f=1", "display_name": "mirage206wrc", "link": "https://stackoverflow.com/users/6015788/mirage206wrc"}, "edited": false, "score": 0, "creation_date": 1457315695, "post_id": 35822939, "comment_id": 59336961, "body": "I made corrections to the coding above and updated it according to your suggestion. But still having an issue with the swapRate function. If you have any clue, it would be awesome. Thanks for your time."}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "reply_to_user": {"reputation": 13, "user_id": 6015788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344788a13cfeed30d187ff8134914f01?s=128&d=identicon&r=PG&f=1", "display_name": "mirage206wrc", "link": "https://stackoverflow.com/users/6015788/mirage206wrc"}, "edited": false, "score": 0, "creation_date": 1457323912, "post_id": 35822939, "comment_id": 59338813, "body": "There&#39;s a couple of ways around this. The cleanest is probably to use an alternative data structure (such as <code>Data.Map</code>). Alternatively you can make a new function that searches for whether a given user already exists in a list of user ratings and remove if that&#39;s the case (think <code>filter</code>). Then add your new rating. This will effectively update any old ratings."}], "tags": [], "owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "is_accepted": false, "score": 1, "last_activity_date": 1457238025, "last_edit_date": 1457238025, "creation_date": 1457236702, "answer_id": 35822939, "question_id": 35822436, "link": "https://stackoverflow.com/questions/35822436/haskell-rate-or-rerate-a-film-in-a-database/35822939#35822939", "title": "Haskell - Rate or Rerate a film in a Database", "body": "<p>To get rid of the warnings, changing your pattern matches on the empty string <code>\"\"</code> to just <code>_</code> does the trick for both <code>checkRateRerate</code> and <code>swapRate</code> (which also warns on my machine).</p>\n\n<p>Your specific problem is that the case you were missing is \"What happens if the list is empty, but the strings are not all the empty string?\" Both of those functions would fail out in that case. It seems to be the case that really you just care about handling what happens when the list is empty.</p>\n\n<p>As for what to do about your outputs, I would suggest that you use a <code>map</code> instead of a <code>filter</code>. Fundamentally what you're doing is changing elements of <code>testDatabase</code>, not stripping elements out. To do so you'll have to change <code>checkRateRerating</code> to output a <code>Film</code> not a <code>Bool</code> (and perhaps change <code>checkRateRerate</code> to output <code>[UserRatings]</code> not a <code>Bool</code>).</p>\n"}], "owner": {"reputation": 13, "user_id": 6015788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344788a13cfeed30d187ff8134914f01?s=128&d=identicon&r=PG&f=1", "display_name": "mirage206wrc", "link": "https://stackoverflow.com/users/6015788/mirage206wrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1457323889, "creation_date": 1457231708, "last_edit_date": 1457323889, "question_id": 35822436, "link": "https://stackoverflow.com/questions/35822436/haskell-rate-or-rerate-a-film-in-a-database", "title": "Haskell - Rate or Rerate a film in a Database", "body": "<p>My coding is robust but for some reason at <code>swapRate</code> function, it needs some fixing to bring the correct results.</p>\n\n<pre><code>import Prelude\nimport Data.Char\nimport Data.List\nimport Text.Printf\nimport Data.Ord\n\n-- Types\ntype Title = String\ntype Director = String\ntype Year = Int\ntype UserRatings = (String,Int)\n\n-- Define Film type here \ntype Film = (Title,Director,Year,[UserRatings])\n\n-- Database Type\ntype Database = [Film]\ntestDatabase = [    \n(\"Blade Runner\", \"Ridley Scott\", 1982, [(\"Amy\",5), (\"Bill\",8), (\"Ian\",7), (\"Kevin\",9), (\"Emma\",4), (\"Sam\",7), (\"Megan\",4)]),\n(\"The Fly\", \"David Cronenberg\", 1986, [(\"Megan\",4), (\"Fred\",7), (\"Chris\",5), (\"Ian\",0), (\"Amy\",6)]),\n(\"Psycho\", \"Alfred Hitchcock\", 1960, [(\"Bill\",4), (\"Jo\",4), (\"Garry\",8), (\"Kevin\",7), (\"Olga\",8), (\"Liz\",10), (\"Ian\",9)]),\n(\"Body Of Lies\", \"Ridley Scott\", 2008, [(\"Sam\",3), (\"Neal\",7), (\"Kevin\",2), (\"Chris\",5), (\"Olga\",6)]),\n(\"Avatar\", \"James Cameron\", 2009, [(\"Olga\",1), (\"Wally\",8), (\"Megan\",9), (\"Tim\",5), (\"Zoe\",8), (\"Emma\",3)]),\n(\"Hugo\", \"Martin Scorsese\", 2011, [(\"Sam\",9), (\"Wally\",3), (\"Zoe\",5), (\"Liz\",7)])\n               ]\n\nswapRate :: String -&gt; Int -&gt; String -&gt; Title -&gt; [UserRatings] -&gt; [UserRatings]\nswapRate _ _ _ _ [] = []\nswapRate user newRate film title ((name, rate):xs)\n    | user==name &amp;&amp; film==title  = (user,newRate):xs -- Does demo 11\n    -- | user/=name &amp;&amp; film==title = (user,newRate):xs -- Does demo 1\n    | otherwise = (name,rate) : (swapRate user newRate film title xs)\n-- * Outputs an updated list\n\nprintSwappedFilmRating :: String -&gt; Int -&gt; String -&gt; Film -&gt; String\nprintSwappedFilmRating user newRate film (t,d,y,u) = \"Title: \" ++ t ++ \"\\nDirector: \" ++ d ++ \"\\nYear: \" ++ show y ++ \"\\nUser's Rating: \" ++ (show (swapRate user newRate film t u)) ++ \"\\n\" ++ \"\\n\"\n-- * Formatting the output of Title, Director, Year and the tuple UserRatings\n\nprintSwappedFilmRate :: String -&gt; Int -&gt; String -&gt; Database -&gt; String\nprintSwappedFilmRate user newRate film database = concat (map (printSwappedFilmRating user newRate film) database)\n-- * Applies the printSwappedFilmRating funtion to the database and the list is concatenated as String\n\n\n----- Main Function -----\n\nrateOrRerate :: String -&gt; Int -&gt; String -&gt; Database -&gt; String\nrateOrRerate user newRate film database = printSwappedFilmRate user newRate film database\n\n-- * Receives two Strings and an Int and with the use of printSwappedFilmRate, \n-- it prints all the movies and the updated rating of a particular user with nice formatting    \n\n\n----- DEMO FUNCTIONS -----\ndemo :: Int -&gt; IO ()\n\n----- Demo 1 -----\ndemo 1  = putStrLn (rateOrRerate \"Emma\" 10 \"Hugo\" testDatabase)\n-- * All films after Emma rates \"Hugo\" 10\n\n----- Demo 11 -----\ndemo 11 = putStrLn (rateOrRerate \"Emma\" 10 \"Avatar\" testDatabase) \n-- * All films after Emma rates \"Avatar\" 10\n</code></pre>\n\n<p>What's to do:<br>\n - The 1st guard overwrites in \"Avatar\" film the rate of [\"Emma\",3] to [\"Emma\",10]<br>\n - The 2nd guard adds [\"Emma\",10] to \"Hugo\" film    </p>\n\n<p>So in the <code>swapRate</code> function, I can't bring both guards to work at the same time. If I comment the first guard, the second one works and vice versa. Looking for a way to make <strong>both</strong> work.</p>\n"}, {"tags": ["haskell", "types", "ghci", "type-systems"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1457267898, "post_id": 35822295, "comment_id": 59320494, "body": "About the dreaded Monomorphism Restriction: <a href=\"http://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\" title=\"what is the monomorphism restriction\">stackoverflow.com/questions/32496864/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 0, "creation_date": 1457232334, "post_id": 35822345, "comment_id": 59312227, "body": "This works when copied verbatim, but I have a follow-up question regarding your first solution. Why does it fail when I provide the type signature in the same line, like <code>where print&#39; = (putStr . show) :: Show a =&gt; a -&gt; IO ()</code> ?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 1, "creation_date": 1457242559, "post_id": 35822345, "comment_id": 59314164, "body": "@ApproachingDarknessFish That&#39;s annotating the value on the right-hand side of the = sign, leaving GHC to infer the type of the name on the left-hand side. GHC infers monomorphic types for patterns without explicit function arguments, and declaring a polymorphic type on the right doesn&#39;t change that rule."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 1, "last_activity_date": 1457232115, "last_edit_date": 1457232115, "creation_date": 1457230918, "answer_id": 35822345, "question_id": 35822295, "link": "https://stackoverflow.com/questions/35822295/types-required-to-be-equivalent-across-two-separate-function-calls/35822345#35822345", "title": "Types required to be equivalent across two separate function calls", "body": "<p>add an explicit type signature:</p>\n\n<pre><code>printSequence' :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\nprintSequence' x y = print' x &gt;&gt; print' y\n    where\n    print' :: Show a =&gt; a -&gt; IO ()\n    print' = putStr . show\n</code></pre>\n\n<p>or use <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\"><strong><code>NoMonomorphismRestriction</code></strong></a>:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nprintSequence' :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\nprintSequence' x y = print' x &gt;&gt; print' y\n    where\n    print' = putStr . show\n</code></pre>\n\n<p>then,</p>\n\n<pre><code>\\&gt; printSequence' 5 \"five\"\n5\"five\"\n</code></pre>\n"}], "owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 35822345, "answer_count": 1, "score": 2, "last_activity_date": 1457232115, "creation_date": 1457230580, "question_id": 35822295, "link": "https://stackoverflow.com/questions/35822295/types-required-to-be-equivalent-across-two-separate-function-calls", "title": "Types required to be equivalent across two separate function calls", "body": "<p>Consider the following two functions in Haskell (a minimal example of my real code):</p>\n\n<pre><code>printSequence :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\nprintSequence x y = (putStr . show) x &gt;&gt; (putStr . show) y\n\nprintSequence' :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\nprintSequence' x y = print' x &gt;&gt; print' y\n    where print' = putStr . show\n</code></pre>\n\n<p>The first compiles fine, but the second produces the error:</p>\n\n<pre><code> Could not deduce (a ~ b)\n    from the context (Show a, Show b)\n      bound by the type signature for\n                 printSequence' :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\n      at test.hs:8:19-53\n      `a' is a rigid type variable bound by\n          the type signature for\n            printSequence' :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\n          at test.hs:8:19\n      `b' is a rigid type variable bound by\n          the type signature for\n            printSequence' :: (Show a, Show b) =&gt; a -&gt; b -&gt; IO ()\n          at test.hs:8:19\n    In the first argument of print', namely `y'\n    In the second argument of `(&gt;&gt;)', namely `(print' y)'\n    In the expression: (print' x) &gt;&gt; (print' y)\n</code></pre>\n\n<p>I understand this error to mean that GHC is requiring <code>x</code> and <code>y</code> to be of equivalent type. What I do not understand is WHY. Statements like <code>print \"fish\" &gt;&gt; print 3.14</code> work perfectly fine in the interpreter, so why does GHC complain about <code>x</code> and <code>y</code> being different types when I call my <code>print'</code> function two separate times?</p>\n"}, {"tags": ["qt", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457220694, "post_id": 35821093, "comment_id": 59309690, "body": "Could you show the output of <code>ghc --version</code> and <code>ghc-pkg list</code> do you use <code>stack</code>?"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457221222, "post_id": 35821093, "comment_id": 59309812, "body": "hello, thanks. I don&#39;t use stack and the answers are in an edit of my question."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457251776, "post_id": 35821093, "comment_id": 59315943, "body": "sidenote: 7.6.3 is really old - shame on you ubuntu - thankfully you can get newer versions using <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow noreferrer\">Herbert V. Riedels - ppa</a> - also you should consider switching to <a href=\"http://docs.haskellstack.org/en/stable/install_and_upgrade/#ubuntu\" rel=\"nofollow noreferrer\"><i>stack</i></a> so you never have to worry about those things again (well at least in almost all cases)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457251938, "post_id": 35821093, "comment_id": 59315983, "body": "to the problem at hand: here I think you are missing some Qt dependencies unrelated to Haskell(bindings) - did you install all <code>qt*.dev</code> versions/packages? - <a href=\"https://stackoverflow.com/questions/30010184/qtquick-controls-version-1-2-is-not-installed-when-compiling-the-example-for-q\">see this question</a> for a similar problem"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457252100, "post_id": 35821093, "comment_id": 59316025, "body": "<a href=\"https://doc.qt.io/qt-5/qtquick-controls-styles-qmlmodule.html\" rel=\"nofollow noreferrer\">here are docs to the missing module</a> - see the <a href=\"https://doc.qt.io/qt-5/linux.html\" rel=\"nofollow noreferrer\">setup instructions here</a> - as far as I can thell there are <a href=\"https://www.qt.io/download-open-source/\" rel=\"nofollow noreferrer\">offline installers here</a> but you have to choose your licence carefully there (at least they ask for it)"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457267384, "post_id": 35821093, "comment_id": 59320356, "body": "@Carsten : I&#39;d rather focus on making the Qt libs available, so I entered &quot;sudo apt-get install qt*.dev&quot; and I saw there are conflicts between libxs-compat-libzmq-dev and libzmq-dev. Do you know how I can fix this? The whole result is in an edit of my question. Anyway, is it really so important to download these libs? I mean, I downloaded Qt binaries from Qt site, but ran the setup and selected the destination path as a subfolder of my home directory. Maybe the problem comes from this."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457267571, "post_id": 35821093, "comment_id": 59320400, "body": "I never tried building something with Qt so I sadly cannot tell you - but the missing module seems to be development related and usually you get rid of similar problems by looking at the right <code>...-dev</code> package - but you are right if you did grab the development binaries form the Qt side then those should be in there - I was not suggesting you install <i>all</i> of those for Qt though - the <code>*</code>in there was my ignorance of which is the right one showing :("}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457267741, "post_id": 35821093, "comment_id": 59320455, "body": "@Carsten : I have an other question : do you know if stack could autolmatically download the right Qt libraries?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457268992, "post_id": 35821093, "comment_id": 59320780, "body": "I don&#39;t think so - seems like <code>hsqml</code> is not even on stackage so it will probably use the same setup vanilla cabal uses"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1457274722, "post_id": 35821093, "comment_id": 59322753, "body": "well, it seems it is more or less resloved : I can compile my hs file with the statement &quot;ghc mon-exemple.hs&quot;, but then it is a sublime text issue. Thanks !"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457267556, "creation_date": 1457219750, "last_edit_date": 1457267556, "question_id": 35821093, "link": "https://stackoverflow.com/questions/35821093/error-with-haskell-qt5-quick-on-ubuntu", "title": "error with haskell &amp; Qt5 quick on ubuntu", "body": "<p>I installed haskell on ubuntu (with sublime text 3) and I can get examples here working, using Qt (which I installed on ubuntu too) and the binding package hsqml.</p>\n\n<p>but I tried to add a button to change a little the example and it does not work.</p>\n\n<p>here is my qml file :</p>\n\n<pre><code>import QtQuick 2.0\nimport QtQuick.Controls 1.3\n\nItem {\nheight: 266\nButton {\n    id: bouton\n    x: 278\n    y: 77\n    text: qsTr(\"click me!\")\n    onClicked: texte.text=\"Hello!\"\n}\n\nText {\n    id: texte\n    x: 166\n    y: 147\n    width: 309\n    height: 87\n    text: qsTr(\"Text\")\n    horizontalAlignment: Text.AlignHCenter\n    font.pixelSize: 76\n}\n\n}\n</code></pre>\n\n<hr>\n\n<p>and here is my haskell file:</p>\n\n<hr>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Graphics.QML\nimport Data.Text (Text)\nimport qualified Data.Text as T\n\nmain :: IO ()\nmain = do\nclazz &lt;- newClass [\n    defMethod' \"factorial\" (\\_ txt -&gt;\n        let n = read $ T.unpack txt :: Integer\n        in return . T.pack . show $ product [1..n] :: IO Text)]\nctx &lt;- newObject clazz ()\nrunEngineLoop defaultEngineConfig {\n    initialDocument = fileDocument \"exemple1.qml\",\n    contextObject = Just $ anyObjRef ctx}\n</code></pre>\n\n<p>the error, when I launch the hs file from sublime text is:</p>\n\n<pre><code> HsQML: file:///home/lowley/Documents/haskell/Qt/exemple1.qml:2:1: module \"QtQuick.Controls\" version 1.3 is not installed\n</code></pre>\n\n<p>I tried to find some clues on the net, but without success. 2 ways that did not succeeded were to search an ubuntu package containing the required libraries and to provide the good path to the good (ubuntu file?/sublime config file?) </p>\n\n<p>can you help me?</p>\n\n<p>EDIT : ANSWERS</p>\n\n<pre><code>lowley@lowley-GB-BXCE-3205:~$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.6.3\n\nlowley@lowley-GB-BXCE-3205:~$ ghc-pkg list\nWARNING: there are broken packages.  Run 'ghc-pkg check' for more details.\n/var/lib/ghc/package.conf.d\n   Cabal-1.16.0\n   GLURaw-1.3.0.0\n   GLUT-2.4.0.0\n   HTTP-4000.2.8\n   HUnit-1.2.5.2\n   MonadCatchIO-mtl-0.3.0.5\n   OpenGL-2.8.0.0\n   OpenGLRaw-1.3.0.0\n   QuickCheck-2.6\n   array-0.4.0.1\n   async-2.0.1.4\n   attoparsec-0.10.4.0\n   base-4.6.0.1\n   bin-package-db-0.0.0.0\n   binary-0.5.1.1\n   bytestring-0.10.0.2\n   case-insensitive-1.1.0.2\n   cgi-3001.1.8.3\n   containers-0.5.0.0\n   deepseq-1.3.0.1\n   directory-1.2.0.1\n   extensible-exceptions-0.1.1.4\n   fgl-5.4.2.4\n   filepath-1.3.0.1\n   ghc-7.6.3\n   ghc-prim-0.3.0.0\n   hashable-1.2.1.0\n   haskell-src-1.0.1.5\n   haskell2010-1.1.1.0\n   haskell98-2.0.0.2\n   hoopl-3.9.0.0\n   hpc-0.6.0.0\n   html-1.0.1.2\n   integer-gmp-0.5.0.0\n   mtl-2.1.2\n   network-2.4.1.2\n   old-locale-1.0.0.5\n   old-time-1.1.0.1\n   parallel-3.2.0.3\n   parsec-3.1.3\n   pretty-1.1.1.0\n   primitive-0.5.0.1\n   process-1.1.0.2\n   random-1.0.1.1\n   regex-base-0.93.2\n   regex-compat-0.95.1\n   regex-posix-0.95.2\n   rts-1.0\n   split-0.2.2\n   stm-2.4.2\n   syb-0.4.0\n   template-haskell-2.8.0.0\n   text-0.11.3.1\n   time-1.4.0.1\n   transformers-0.3.0.0\n   unix-2.6.0.1\n   unordered-containers-0.2.3.0\n   vector-0.10.0.1\n   xhtml-3000.2.1\n   zlib-0.5.4.1\n/home/lowley/.ghc/x86_64-linux-7.6.3/package.conf.d\n   Cabal-1.22.4.0\n   Cabal-1.22.7.0\n   GLURaw-1.4.0.2\n   GLURaw-1.5.0.3\n   HCodecs-0.5\n   MonadRandom-0.4\n   ObjectName-1.1.0.0\n   OpenGL-2.9.2.0\n   OpenGL-2.13.1.0\n   OpenGLRaw-1.5.0.1\n   OpenGLRaw-2.5.5.0\n   StateVar-1.1.0.1\n   aeson-0.7.0.6\n   aeson-pretty-0.7.2\n   ansi-terminal-0.6.2.3\n   appar-0.1.4\n   asn1-encoding-0.9.3\n   asn1-parse-0.9.4\n   asn1-types-0.3.1\n   attoparsec-0.11.3.4\n   auto-update-0.1.2.2\n   base-orphans-0.4.4\n   base16-bytestring-0.1.1.6\n   base64-bytestring-1.0.0.1\n   bifunctors-5\n   binary-0.7.6.1\n   blaze-builder-0.4.0.1\n   blaze-html-0.8.1.1\n   blaze-markup-0.7.0.3\n   buildwrapper-0.9.1\n   byteable-0.1.1\n   byteorder-1.0.4\n   bytestring-builder-0.10.6.0.0\n   cabal-helper-0.6.1.0\n   cabal-meta-0.4.1.3\n   cairo-0.12.5.3\n   cairo-0.13.1.0\n   cereal-0.5.0.0\n   cmdargs-0.10.13\n   comonad-4.2.7.2\n   conduit-1.2.5.1\n   conduit-extra-1.1.9.1\n   connection-0.2.5\n   constraints-0.4.1.3\n   contravariant-1.3.3\n   control-monad-free-0.5.3\n   convertible-1.1.0.0\n   cookie-0.4.1.6\n   cpphs-1.19.3\n   cryptohash-0.11.6\n   cryptonite-0.9\n   data-default-0.5.3\n   data-default-class-0.0.1\n   data-default-instances-base-0.0.1\n   data-default-instances-containers-0.0.1\n   data-default-instances-dlist-0.0.1\n   data-default-instances-old-locale-0.0.1\n   derive-2.5.22\n   distributive-0.4.4\n   djinn-ghc-0.0.2.3\n   djinn-lib-0.0.1.2\n   dlist-0.7.1.2\n   dynamic-cabal-0.3.5\n   either-4.4.1\n   enclosed-exceptions-1.0.1.1\n   exceptions-0.8.0.2\n   extra-1.4.2\n   fast-logger-2.4.1\n   fclabels-2.0.2.3\n   free-4.12.1\n   ghc-mod-5.4.0.0\n   ghc-paths-0.1.0.9\n   ghc-pkg-lib-0.3.1\n   ghc-syb-utils-0.2.3\n   gio-0.12.5.3\n   gio-0.13.1.0\n   glade-0.12.5.0\n   glib-0.12.5.4\n   glib-0.13.2.1\n   gtk-0.12.5.7\n   haddock-2.13.2.1\n   half-0.2.2.1\n   haskell-docs-4.2.6\n   haskell-generate-0.2.3\n   haskell-src-exts-1.16.0.1\n   haskell-src-exts-1.17.0\n   hasktags-0.69.1\n   heap-0.6.0\n   hex-0.1.2\n   hlint-1.9.22\n   hlint-1.9.23\n   hlint-1.9.26\n   honk-1.3.0.0\n   hoogle-4.2.42\n   hoogle-4.2.43\n   hourglass-0.2.9\n   hscolour-1.23\n   hsqml-0.3.3.0\n   hsqml-0.3.4.0\n   http-api-data-0.2.1\n   http-client-0.4.24\n   http-client-tls-0.2.2\n   http-conduit-2.1.8\n   http-date-0.0.6.1\n   http-types-0.9\n   http2-1.2.0\n   iproute-1.7.0\n   js-flot-0.8.3\n   js-jquery-1.11.3\n   json-0.9.1\n   lazysmallcheck-0.6\n   lifted-async-0.7.0.1\n   lifted-base-0.2.3.6\n   markov-chain-0.0.3.3\n   memory-0.10\n   mime-types-0.1.0.6\n   mmorph-1.0.4\n   monad-control-1.0.0.4\n   monad-journal-0.7.1\n   monad-logger-0.3.15\n   monad-loops-0.4.3\n   mtl-2.2.1\n   mwc-random-0.13.3.2\n   nats-1.1\n   newtype-0.2\n   pango-0.12.5.3\n   pango-0.13.1.0\n   parallel-io-0.3.3\n   path-pieces-0.2.1\n   pem-0.2.2\n   persistent-2.2.2.1\n   persistent-sqlite-2.2\n   persistent-template-2.1.3.6\n   pipes-4.1.6\n   polyparse-1.11\n   portaudio-0.2.4\n   prelude-extras-0.4.0.2\n   profunctors-5.1.1\n   psqueues-0.2.0.3\n   pure-fft-0.2.0\n   refact-0.3.0.1\n   regex-tdfa-1.2.1\n   resource-pool-0.2.3.2\n   resourcet-1.1.6\n   safe-0.3.9\n   sarasvati-0.3.0.0\n   scientific-0.3.4.2\n   semigroupoids-5.0.0.4\n   semigroups-0.18\n   shake-0.15.5\n   shelly-1.6.4\n   silently-1.2.5\n   simple-sendfile-0.2.21\n   socks-0.5.4\n   stm-chans-3.0.0.4\n   streaming-commons-0.1.14.2\n   strict-0.3.2\n   stylish-haskell-0.5.14.3\n   stylish-haskell-0.5.14.4\n   system-fileio-0.3.16.3\n   system-filepath-0.4.13.4\n   tagged-0.7.3\n   tagged-0.8.2\n   tagsoup-0.13.5\n   tar-0.4.2.2\n   temporary-1.2.0.3\n   text-1.2.1.3\n   tls-1.3.3\n   transformers-0.4.3.0\n   transformers-base-0.4.4\n   transformers-compat-0.4.0.4\n   uniplate-1.6.12\n   unix-compat-0.4.1.4\n   utf8-string-0.3.8\n   utf8-string-1.0.1.1\n   vault-0.3.0.4\n   vector-algorithms-0.7.0.1\n   void-0.7.1\n   wai-3.0.4.0\n   warp-3.1.8\n   word8-0.1.2\n   x509-1.6.3\n   x509-store-1.6.1\n   x509-system-1.6.1\n   x509-validation-1.6.3\n   yaml-0.8.15.1\n</code></pre>\n\n<p>here are the other results:</p>\n\n<pre><code>lowley@lowley-GB-BXCE-3205:~$ sudo apt-get install qt*.dev\nLecture des listes de paquets... Fait\nConstruction de l'arbre des d\u00e9pendances       \nLecture des informations d'\u00e9tat... Fait\nNote\u00a0: s\u00e9lection de libnetworkmanagerqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libdconf-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libmygpo-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libibus-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de licq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libprojectm-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libxs-compat-libzmq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libdbusmenu-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libmodemmanagerqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libbpp-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libofono-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libindicate-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libcpufreq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libsoqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libsignon-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libbpp-seq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libdaq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de liblightdm-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de sqldeveloper-package pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libpythonqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libpq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libgsettings-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libsoqt-dev-common pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libzmq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libmumps-seq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libaccounts-qt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de librabbitmq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libghc-postgresql-libpq-dev-0.8.2.1-3c6b0 pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libpaq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libghc-deepseq-dev-1.3.0.1-5cc4c pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de golang-pq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libghc-deepseq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de perlqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libghc-postgresql-libpq-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libsvnqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de libzbarqt-dev pour l'expression rationnelle \u00ab\u00a0qt*.dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de \u00ab\u00a0ghc\u00a0\u00bb au lieu de \u00ab\u00a0libghc-deepseq-dev\u00a0\u00bb\nNote\u00a0: s\u00e9lection de \u00ab\u00a0ghc\u00a0\u00bb au lieu de \u00ab\u00a0libghc-deepseq-dev-1.3.0.1-5cc4c\u00a0\u00bb\nNote\u00a0: s\u00e9lection de \u00ab\u00a0libghc-postgresql-libpq-dev\u00a0\u00bb au lieu de \u00ab\u00a0libghc-postgresql-libpq-dev-0.8.2.1-3c6b0\u00a0\u00bb\nNote\u00a0: s\u00e9lection de \u00ab\u00a0libsoqt4-dev\u00a0\u00bb au lieu de \u00ab\u00a0libsoqt-dev\u00a0\u00bb\nghc est d\u00e9j\u00e0 la plus r\u00e9cente version disponible.\nghc pass\u00e9 en \u00ab\u00a0install\u00e9 manuellement\u00a0\u00bb.\nCertains paquets ne peuvent \u00eatre install\u00e9s. Ceci peut signifier\nque vous avez demand\u00e9 l'impossible, ou bien, si vous utilisez\nla distribution unstable, que certains paquets n'ont pas encore\n\u00e9t\u00e9 cr\u00e9\u00e9s ou ne sont pas sortis d'Incoming.\nL'information suivante devrait vous aider \u00e0 r\u00e9soudre la situation\u00a0: \n\nLes paquets suivants contiennent des d\u00e9pendances non satisfaites\u00a0:\n libxs-compat-libzmq-dev : Est en conflit avec: libzmq-dev\nE: Impossible de corriger les probl\u00e8mes, des paquets d\u00e9fectueux sont en mode \u00ab\u00a0garder en l'\u00e9tat\u00a0\u00bb.\n</code></pre>\n"}, {"tags": ["haskell", "dictionary", "newline"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1457219691, "post_id": 35820970, "comment_id": 59309441, "body": "What&#39;s your question...?"}, {"owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1457219893, "post_id": 35820970, "comment_id": 59309476, "body": "@DanielWagner How can I use the <code>map</code>, <code>mapM</code> or <code>mapM_</code> function to do this?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1457220095, "post_id": 35820970, "comment_id": 59309532, "body": "You haven&#39;t said what &quot;this&quot; is yet! Show us your code."}], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457221325, "post_id": 35821215, "comment_id": 59309839, "body": "I am given a database of cars called <code>listOfCars</code> and am looking for a way to use just one function to prepare the list for the <code>putStrLn</code> function... The way the <code>main</code> function works is by simply calling <code>putStrLn(f1 listOfCars)</code> so while yours works it&#39;s not quite appropriate to my task."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457221439, "post_id": 35821215, "comment_id": 59309869, "body": "What you want is actually in my answer, I&#39;ll update to make it more clear."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1457221611, "post_id": 35821215, "comment_id": 59309913, "body": "I&#39;ve added a section that shows you how to derive f1 from the first method."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 1, "last_activity_date": 1457221575, "last_edit_date": 1457221575, "creation_date": 1457220637, "answer_id": 35821215, "question_id": 35820970, "link": "https://stackoverflow.com/questions/35820970/using-the-map-mapm-function-to-return-a-string-ready-for-putstrln-to-separate-li/35821215#35821215", "title": "Using the map/mapM function to return a String ready for putStrLn to separate list elements", "body": "<p>You will first need to create a new function that converts a single car to a viewable string</p>\n\n<pre><code>carToString::Car-&gt;String\ncarToString car = &lt;fill this in as you would like&gt;\n</code></pre>\n\n<p>Note that this function is way more reusable than f1 above!  It can be used as a building block to work with Cars stored in any container (trees, etc).</p>\n\n<p>Once you have this, you can print the whole thing as follows</p>\n\n<pre><code>putStrLn $ unlines $ map carToString listOfCars\n</code></pre>\n\n<p>Alternatively, you can use forM_ (which is just <code>flip mapM_</code>) as follows</p>\n\n<pre><code>forM_ listOfCars $ \\car -&gt; do\n    putStrLn $ carToString car\n</code></pre>\n\n<p>or if you prefer terseness,</p>\n\n<pre><code>forM_ listOfCars $ putStrLn . carToString\n</code></pre>\n\n<hr>\n\n<p>Note that the first method can be modified to give an alternate definition of f1....</p>\n\n<pre><code>putStrLn $ unlines $ map carToString listOfCars\n</code></pre>\n\n<p>is the same thing as</p>\n\n<pre><code>putStrLn (unlines . map carToString $ listOfCars)\n</code></pre>\n\n<p>so, f1 can be defined as</p>\n\n<pre><code>f1 = unlines . map carToString\n</code></pre>\n\n<p>which is a very clean way to define f1.</p>\n"}], "owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 35821215, "answer_count": 1, "score": 0, "last_activity_date": 1457221575, "creation_date": 1457218778, "last_edit_date": 1457220972, "question_id": 35820970, "link": "https://stackoverflow.com/questions/35820970/using-the-map-mapm-function-to-return-a-string-ready-for-putstrln-to-separate-li", "title": "Using the map/mapM function to return a String ready for putStrLn to separate list elements", "body": "<p>I am trying to create a function of the type:</p>\n\n<pre><code>f1 :: [Car] -&gt; String\n</code></pre>\n\n<p>where Car is a declared type that is a tuple containing a String, an Int and a List of further tuples. I want to use a <code>map</code> function in order to return a String which will be passed into the <code>main</code> function, and then output as separated strings.</p>\n\n<p>Anyway, I have a main function that calls on the function f1 as follows:</p>\n\n<pre><code>putStrLn(f1 listOfCars)\n</code></pre>\n\n<p>where listOfCars is declared as you'd expect...</p>\n\n<pre><code>[(\"Ford\", \"Mondeo\", 2009, [(\"Autotrader\", 12000), (\"Parkers\", 11500)]), \n\n(\"VW\", \"Golf\", 2011, [(\"Autotrader\", 16000), (\"Parkers\", 15250)]),...]\n</code></pre>\n\n<p>I did this successfully using a recursive function with patterns and guards and the <code>show</code> function, but having looked into both the <code>map</code> and <code>mapM</code>/<code>mapM_</code> function I'm certain I can use one of them, somehow, to do this in a far more efficient manner. I was looking for some help on how to use one of those functions.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1457222148, "post_id": 35820593, "comment_id": 59310018, "body": "Haskell functions are called <code>function a b c ...</code> not <code>function(a,b,c,...)</code>. The structure <code>(a,b,c,...)</code> is called a tuple, but the function defined doesn&#39;t take one."}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457219493, "post_id": 35820641, "comment_id": 59309388, "body": "Thanks a lot again. You said that I am mixing a currying and tuples. I cannot see it. If I understand correctly: In your example you used a currying. Am I right?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1457220386, "post_id": 35820641, "comment_id": 59309617, "body": "<code>y(\\ ff c (h:t) pos -&gt; ...)(c, l, 0)</code> calls <code>y</code> with one argument, not three as you intend. <code>(c, l, 0)</code> is a three-tuple, remember."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457220938, "post_id": 35820641, "comment_id": 59309749, "body": "@Gilgamesz Carsten showed how to use tuples both in the lambda patterns and the arguments: <code>y(\\ff (ls, pos) -&gt; ...)(ls, 0)</code>. You can also use a curried version simply removing tuples in both places: <code>y(\\ff ls pos -&gt; ...) ls 0</code>. Both are fine, but mixing the two approaches will cause a type mismatch."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457221634, "post_id": 35820641, "comment_id": 59309920, "body": "@Carsten, I appreciated your piece of code. A lot of knowledge for me, as beginner!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1457216788, "last_edit_date": 1457216788, "creation_date": 1457216256, "answer_id": 35820641, "question_id": 35820593, "link": "https://stackoverflow.com/questions/35820593/haskell-recursive-lambda-errors/35820641#35820641", "title": "Haskell. Recursive Lambda. Errors", "body": "<p>the problem here is that you mix <em>tuples</em> and curried arguments (you should try to stay with the basic form of two curried arguments if you don't want to change <code>y</code>) - but your thinking is quite good!</p>\n\n<p>indeed it's only a few small changes to get it working:</p>\n\n<pre><code>indexOf :: Char -&gt; String -&gt; Maybe Int\nindexOf c ls = \n    y(\\ ff (ls, pos) -&gt;\n       case ls of\n         (h:t)\n           | h == c -&gt; Just pos\n           | otherwise -&gt; ff (t, pos+1)\n         [] -&gt; Nothing\n     )(ls, 0)\n</code></pre>\n\n<p>as you can see I did:</p>\n\n<ul>\n<li>moved the case-split inside</li>\n<li>rewrote the arguments into a tuple of the <em>rest</em>-list and the position</li>\n<li>reused the <code>c</code> from the closure you get for free ;)</li>\n</ul>\n\n<p>here is it in action:</p>\n\n<pre><code>\u03bb&gt; indexOf 'l' \"Hello\"\nJust 2\n\u03bb&gt; indexOf 'a' \"Hello\"\nNothing\n</code></pre>\n\n<hr>\n\n<p>of course while this is a good exercise you should not really write Haskell this way - the obvious direct recursion is a lot more readable:</p>\n\n<pre><code>indexOf :: Char -&gt; String -&gt; Maybe Int\nindexOf c = indexOf' 0\n  where \n    indexOf' _ [] = Nothing\n    indexOf' pos (h:t)\n      | c == h = Just pos\n      | otherwise = indexOf' (pos+1) t\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 35820641, "answer_count": 1, "score": 1, "last_activity_date": 1457216788, "creation_date": 1457215956, "question_id": 35820593, "link": "https://stackoverflow.com/questions/35820593/haskell-recursive-lambda-errors", "title": "Haskell. Recursive Lambda. Errors", "body": "<pre><code>y :: (f-&gt;f) -&gt; f\ny f = f (y f)\n\nindexOf :: Char -&gt; String -&gt; Maybe Int\nindexOf c l = \n    y(\\ ff c (h:t) pos -&gt; \n        if ( c == h) then Just pos\n            else ff c t (pos + 1)\n        )(c, l, 0)\n\nindexOf c [] = Nothing\n</code></pre>\n\n<p>It gives me two compilation errors:\nThe code should find position of char c in string. For example:\nindexOf('a', 'lamp') = 2</p>\n\n<pre><code> Couldn't match expected type `[(Char, String, Integer)]\n                                  -&gt; Integer -&gt; Maybe Integer'\n                with actual type `Maybe Int'\n    The lambda expression `\\ ff c (h : t) pos -&gt; ...'\n    has four arguments,\n    but its type `((Char, String, Integer) -&gt; Maybe Int)\n                  -&gt; (Char, String, Integer) -&gt; Maybe Int'\n    has only two\n    In the first argument of `y', namely\n      `(\\ ff c (h : t) pos\n          -&gt; if (c == h) then Just pos else ff c t (pos + 1))'\n    In the expression:\n      y (\\ ff c (h : t) pos\n           -&gt; if (c == h) then Just pos else ff c t (pos + 1))\n        (c, l, 0)\n\n\n    Couldn't match expected type `[(Char, String, Integer)]\n                                  -&gt; Integer -&gt; Maybe Integer'\n                with actual type `Maybe Int'\n    The function `ff' is applied to three arguments,\n    but its type `(Char, String, Integer) -&gt; Maybe Int' has only one\n    In the expression: ff c t (pos + 1)\n    In the expression: if (c == h) then Just pos else ff c t (pos + 1)\n</code></pre>\n\n<p>I don't know how to repair it. Please give me a hand :)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 2, "creation_date": 1457214770, "post_id": 35820349, "comment_id": 59308078, "body": "remove parentheses, <code>( x == y )</code> should be just <code>x == y</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1457214921, "post_id": 35820349, "comment_id": 59308126, "body": "Thanks, is it ok generally way ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1457216215, "post_id": 35820349, "comment_id": 59308548, "body": "Note: you <i>must</i> remove the parentheses around the outermost patterns, but you <i>should</i> remove all the parentheses in the code except the ones around the type <code>Tree a</code>. None of them are necessary."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1457221434, "post_id": 35820349, "comment_id": 59309868, "body": "Yes, it works. From what I know I should know when parentheses are needed?"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 1, "creation_date": 1457240240, "post_id": 35820349, "comment_id": 59313748, "body": "in pattern matches (the left hand side of definitions), parenthesis are used to group the structure of <i>individual</i> arguments. Since <code>==</code> is a function with two arguments, then you shouldn&#39;t have parens that group everything including that function name, otherwise the compiler gets confused."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1457290753, "last_edit_date": 1457290753, "creation_date": 1457263349, "answer_id": 35826250, "question_id": 35820349, "link": "https://stackoverflow.com/questions/35820349/own-eq-instance-for-binary-trees/35826250#35826250", "title": "Own Eq instance for binary trees", "body": "<p>You must not use parentheses while defining an operator or a function. Keep in mind that</p>\n\n<pre><code>a ???? b\n</code></pre>\n\n<p>is just syntactical sugar for</p>\n\n<pre><code>(????) a b\n</code></pre>\n\n<p>Therefore, your patterns should be like this:</p>\n\n<pre><code>Empty == Empty = True\nEmpty == _     = False\n_ == Empty     = False\nNode x xl xr == Node y yl yr = ...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "closed_date": 1457263356, "accepted_answer_id": 35826250, "answer_count": 1, "score": 1, "last_activity_date": 1457290753, "creation_date": 1457214627, "last_edit_date": 1457216040, "question_id": 35820349, "link": "https://stackoverflow.com/questions/35820349/own-eq-instance-for-binary-trees", "closed_reason": "Not suitable for this site", "title": "Own Eq instance for binary trees", "body": "<p>I am trying to create my own <code>Eq</code> instance for binary trees:</p>\n\n<pre><code>data Tree a = Empty | Node a (Tree a) (Tree a) \ninstance Eq a =&gt; Eq (Tree a) where\n    (Empty == Empty) = True\n    (Empty == _)     = False\n    (_ == Empty)     = False\n    (Node x xl xr) == (Node y yl yr) = (x == y) &amp;&amp; xl == yl &amp;&amp; xr == yr\n</code></pre>\n\n<p>I get the following error message:</p>\n\n<pre><code>Parse error in pattern: Empty == Empty\n</code></pre>\n\n<p>Could you tell me where I am wrong?</p>\n"}, {"tags": ["haskell", "functional-programming", "haskell-platform"], "answers": [{"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 5, "last_activity_date": 1457213903, "creation_date": 1457213903, "answer_id": 35820218, "question_id": 35820160, "link": "https://stackoverflow.com/questions/35820160/haskell-defining-map-function-using-unfold/35820218#35820218", "title": "Haskell: Defining map function using unfold", "body": "<p>If you define:</p>\n\n<pre><code>map' :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap' f = unfold null (f.head) tail\n</code></pre>\n\n<p>then</p>\n\n<pre><code>\\&gt; map' show [1..5]\n[\"1\",\"2\",\"3\",\"4\",\"5\"]\n\\&gt; map' (+1) []\n[]\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5482605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f914c92ef19812cd509c67fd3c2b81?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5482605/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 35820218, "answer_count": 1, "score": -3, "last_activity_date": 1457216163, "creation_date": 1457213558, "last_edit_date": 1457216163, "question_id": 35820160, "link": "https://stackoverflow.com/questions/35820160/haskell-defining-map-function-using-unfold", "title": "Haskell: Defining map function using unfold", "body": "<p>I have the following Haskell method </p>\n\n<pre><code>unfold :: (a -&gt; Bool) -&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; [b]\nunfold p h t x\n    | p x       = []\n    | otherwise = (h x):(unfold p h t (t x))\n</code></pre>\n\n<p>How can i define the regular prelude map f x method using this given unfold method.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 5464538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MGHR8.jpg?s=128&g=1", "display_name": "pioupiou1211", "link": "https://stackoverflow.com/users/5464538/pioupiou1211"}, "edited": false, "score": 0, "creation_date": 1457213628, "post_id": 35820044, "comment_id": 59307726, "body": "I edited my code but the errors are the same. For me, my <code>i</code> is the <code>Int</code>, my <code>x</code> is the <code>[Int]</code> and the output is the <code>[Case]</code>. Maybe my syntaxe is wrong?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 221, "user_id": 5464538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MGHR8.jpg?s=128&g=1", "display_name": "pioupiou1211", "link": "https://stackoverflow.com/users/5464538/pioupiou1211"}, "edited": false, "score": 0, "creation_date": 1457213830, "post_id": 35820044, "comment_id": 59307780, "body": "I am not sure what edits you have applied, but I can tell you this....  From what you wrote above, it is <code>(x:xs)</code>, not <code>x</code> that is the type <code>[Int]</code>.  If this is not what you want, you will have to change this, either by changing the type, or the pattern matching."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1457212810, "creation_date": 1457212810, "answer_id": 35820044, "question_id": 35819970, "link": "https://stackoverflow.com/questions/35819970/couldnt-match-expected-type-haskell/35820044#35820044", "title": "Couldn&#39;t match expected type Haskell", "body": "<p><code>last</code> expects a list, but you have defined it in the pattern match as and <code>Int</code></p>\n\n<pre><code>lignebn :: Int -&gt; [Int] -&gt; [Case]\nlignebn i (x:xs) = ....\n</code></pre>\n\n<p>implies that</p>\n\n<pre><code>(x:xs)::[Int]\n</code></pre>\n\n<p>which implies that x is an Int.</p>\n\n<hr>\n\n<p>On an unrelated note, in Haskell you do not need to put parens around function calls.  Don't call last like this <code>last(x)</code>, instead use <code>last x</code>.  It will work, but isn't idiomatic Haskell.</p>\n"}, {"comments": [{"owner": {"reputation": 221, "user_id": 5464538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MGHR8.jpg?s=128&g=1", "display_name": "pioupiou1211", "link": "https://stackoverflow.com/users/5464538/pioupiou1211"}, "edited": false, "score": 0, "creation_date": 1457215171, "post_id": 35820316, "comment_id": 59308202, "body": "Thanks it was obvious!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1457215893, "last_edit_date": 1457215893, "creation_date": 1457214441, "answer_id": 35820316, "question_id": 35819970, "link": "https://stackoverflow.com/questions/35819970/couldnt-match-expected-type-haskell/35820316#35820316", "title": "Couldn&#39;t match expected type Haskell", "body": "<p>In your recursive calls you need parentheses around <code>init x</code>. As it is, you are passing the <code>init</code> function and <code>x</code>. You probably also want a list of <code>N</code> and <code>B</code> rather than a list of lists of them, but it's hard to say for sure since you don't include the definition of your <code>Case</code> type.</p>\n\n<pre><code>lignebn :: Int -&gt; [Int] -&gt; [Case]\nlignebn i [] = []\nlignebn i x \n    | i == last x = N : lignebn (i-1) (init x) -- line 101\n    | otherwise = B : lignebn (i-1) (init x)\n</code></pre>\n\n<p>Note also that partial functions like <code>last</code> are widely discouraged. Better would be something like this (untested):</p>\n\n<pre><code>unsnoc :: [a] -&gt; Maybe ([a], a)\nunsnoc [] = Nothing\nunsnoc (x : xs) = Just ps where\n   ps = case unsnoc xs of\n          Nothing -&gt; ([], x)\n          Just (~(ys, y)) -&gt; Just (x : ys, y)\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 5464538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MGHR8.jpg?s=128&g=1", "display_name": "pioupiou1211", "link": "https://stackoverflow.com/users/5464538/pioupiou1211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 0, "accepted_answer_id": 35820316, "answer_count": 2, "score": -1, "last_activity_date": 1457215893, "creation_date": 1457212400, "last_edit_date": 1457214116, "question_id": 35819970, "link": "https://stackoverflow.com/questions/35819970/couldnt-match-expected-type-haskell", "title": "Couldn&#39;t match expected type Haskell", "body": "<p>I need to make a list of case like <code>[B,N,N]</code> with a list that contain the index of the <code>N</code>like <code>[1,2]</code> here, and an int that represent the length of the final list.</p>\n\n<p>Here's my program:</p>\n\n<pre><code>lignebn :: Int -&gt; [Int] -&gt; [Case]\nlignebn i [] = []\nlignebn i x \n    | i == last x = [N] : lignebn (i-1) init x -- line 101\n    | otherwise = [B] : lignebn (i-1) init x\n</code></pre>\n\n<p>Here are the errors:</p>\n\n<pre><code>devoir.hs:101:17:\n    Couldn't match expected type \u2018[Int]\u2019 with actual type \u2018Int\u2019\n    In the first argument of \u2018last\u2019, namely \u2018(x)\u2019\n    In the second argument of \u2018(==)\u2019, namely \u2018last (x)\u2019\n\ndevoir.hs:101:29:\n    Couldn't match expected type \u2018Int -&gt; [Case]\u2019\n                with actual type \u2018[Case]\u2019\n    The function \u2018lignebn\u2019 is applied to three arguments,\n    but its type \u2018Int -&gt; [Int] -&gt; [Case]\u2019 has only two\n    In the second argument of \u2018(++)\u2019, namely \u2018lignebn (i - 1) init (x)\u2019\n    In the expression: [N] ++ lignebn (i - 1) init (x)\n\ndevoir.hs:101:43:\n    Couldn't match expected type \u2018[Int]\u2019\n                with actual type \u2018[a0] -&gt; [a0]\u2019\n    Probable cause: \u2018init\u2019 is applied to too few arguments\n    In the second argument of \u2018lignebn\u2019, namely \u2018init\u2019\n    In the second argument of \u2018(++)\u2019, namely \u2018lignebn (i - 1) init (x)\u2019\n\ndevoir.hs:102:26:\n    Couldn't match expected type \u2018Int -&gt; [Case]\u2019\n                with actual type \u2018[Case]\u2019\n    The function \u2018lignebn\u2019 is applied to three arguments,\n    but its type \u2018Int -&gt; [Int] -&gt; [Case]\u2019 has only two\n    In the second argument of \u2018(++)\u2019, namely \u2018lignebn (i - 1) init (x)\u2019\n    In the expression: [B] ++ lignebn (i - 1) init (x)\n\ndevoir.hs:102:40:\n    Couldn't match expected type \u2018[Int]\u2019\n                with actual type \u2018[a1] -&gt; [a1]\u2019\n    Probable cause: \u2018init\u2019 is applied to too few arguments\n    In the second argument of \u2018lignebn\u2019, namely \u2018init\u2019\n    In the second argument of \u2018(++)\u2019, namely \u2018lignebn (i - 1) init (x)\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I don't understand what's going on, the code seems ok to me...</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 1, "last_activity_date": 1457263684, "creation_date": 1457263684, "answer_id": 35826314, "question_id": 35819813, "link": "https://stackoverflow.com/questions/35819813/how-to-version-imports-for-cabal-hook/35826314#35826314", "title": "How to Version Imports for Cabal Hook", "body": "<p>Usually yes, code that is dependent on a version of a library manages it via CPP macros, using macros defined by Cabal itself. See <a href=\"http://www.edsko.net/2014/09/13/haskell-cpp-macros/\" rel=\"nofollow\">http://www.edsko.net/2014/09/13/haskell-cpp-macros/</a> for some examples. In your case:</p>\n\n<pre><code>#if MIN_VERSION_Cabal(1,22,0)\n    -- something working in Cabal 1.22 or above\n#else\n    -- something working in Cabal versions prior to 1.22\n#endif\n</code></pre>\n\n<p>It's not ideal, I'll give you that.</p>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 35826314, "answer_count": 1, "score": 1, "last_activity_date": 1457273120, "creation_date": 1457211366, "last_edit_date": 1457273120, "question_id": 35819813, "link": "https://stackoverflow.com/questions/35819813/how-to-version-imports-for-cabal-hook", "title": "How to Version Imports for Cabal Hook", "body": "<p>I am writing a very simple \"hook\" for Cabal which works fine with the last version but it stops to work when I \"downgrade\" Cabal to older versions 1.22, 1.20, etc.</p>\n\n<p>The cause looks due to the path of some modules that keep on change, like for example: <code>import Distribution.Simple.LocalBuildInfo</code></p>\n\n<p>Is there any way to manage those changes across different versions? Do I need a \"CPP\" macro (in case which one) or there are better ways to manage it?</p>\n"}, {"tags": ["haskell", "installation", "ghc-mod"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1457218491, "post_id": 35819659, "comment_id": 59309134, "body": "I know it is a bit more to learn, but consider using either <code>stack</code> or <code>cabal sandboxes</code>, for the latter you best do a <code>cabal get ghc-mod</code> then cd into the ghcmod directory and there you do <code>cabal sandbox init</code> this will make your life with Haskell way more easier. Using <code>stack</code> is even better, but there&#39;s already answers recommending that."}], "answers": [{"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": false, "score": 5, "last_activity_date": 1457211522, "creation_date": 1457211522, "answer_id": 35819840, "question_id": 35819659, "link": "https://stackoverflow.com/questions/35819659/cannot-install-ghc-mod-due-to-happy-cannot-be-installed/35819840#35819840", "title": "Cannot install ghc-mod due to &#39;happy&#39; cannot be installed?", "body": "<p>it seems the program <code>happy</code> is not installed in your system, therefore the package <code>haskell-src-exts-1.17.1</code> (a dependency of a dependency of ghc-mod) which depends on it fails to install.</p>\n\n<p>The common wisdom today, especially for beginners, is to not use the tool <code>cabal-install</code>, but to use <a href=\"http://haskellstack.com\" rel=\"noreferrer\">stack</a> for everything you need instead. including installing ghc itself. after downloading stack I think all you have to do is run <code>stack install ghc-mod</code> to install <code>ghc-mod</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 11, "last_activity_date": 1457211531, "creation_date": 1457211531, "answer_id": 35819842, "question_id": 35819659, "link": "https://stackoverflow.com/questions/35819659/cannot-install-ghc-mod-due-to-happy-cannot-be-installed/35819842#35819842", "title": "Cannot install ghc-mod due to &#39;happy&#39; cannot be installed?", "body": "<p>For some reason, cabal doesn't install executable dependencies, but you can get around this by installing by hand.</p>\n\n<pre><code>cabal install happy\n</code></pre>\n\n<p>then proceed with the original installation.</p>\n\n<hr>\n\n<p>This problem generally doesn't go away with stack either, but the solution is similar</p>\n\n<pre><code>stack install happy\n</code></pre>\n\n<p>then continue with the installation.</p>\n"}], "owner": {"reputation": 21270, "user_id": 1150778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6b2790c74560690d1a476d9ee079a50b?s=128&d=identicon&r=PG&f=1", "display_name": "qazwsx", "link": "https://stackoverflow.com/users/1150778/qazwsx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1641, "favorite_count": 2, "accepted_answer_id": 35819842, "answer_count": 2, "score": 7, "last_activity_date": 1457211531, "creation_date": 1457210423, "question_id": 35819659, "link": "https://stackoverflow.com/questions/35819659/cannot-install-ghc-mod-due-to-happy-cannot-be-installed", "title": "Cannot install ghc-mod due to &#39;happy&#39; cannot be installed?", "body": "<p>On Mac OS X, I'm not able to install <code>ghc-mod</code> due to that a dependency called 'happy' cannot be installed:</p>\n\n<pre><code>bash&gt; cabal install ghc-mod                                                                                           \nResolving dependencies...\nConfiguring haskell-src-exts-1.17.1...\nFailed to install haskell-src-exts-1.17.1\nBuild log ( /Users/meng/.cabal/logs/haskell-src-exts-1.17.1.log ):\nConfiguring haskell-src-exts-1.17.1...\nsetup-Simple-Cabal-1.22.5.0-x86_64-osx-ghc-7.10.3: The program 'happy' version\n&gt;=1.19 is required but it could not be found.\ncabal: Error: some packages failed to install:\nghc-mod-5.5.0.0 depends on haskell-src-exts-1.17.1 which failed to install.\nhaskell-src-exts-1.17.1 failed during the configure step. The exception was:\nExitFailure 1\nhlint-1.9.31 depends on haskell-src-exts-1.17.1 which failed to install.\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1457210989, "post_id": 35818996, "comment_id": 59306848, "body": "Note the lambda itself is not recursive; it just takes a function which it applies to <code>n - 1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457213002, "post_id": 35819096, "comment_id": 59307542, "body": "Ok, I have a doubt with that: t(n-1). t is our lambda function. t ( lambda)  gets TWO arguments while we give one argument ( n -1). My guess is that is connected with laziness of Haskell? Can you explain me it in more details? If you suggest, I&#39;ll create a new subject,"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 1, "creation_date": 1457214427, "post_id": 35819096, "comment_id": 59307954, "body": "no <code>t</code> has only one argument and if you look closely we only call it ever with one - the lambda part is the <code>\\ t n -&gt; ...</code> - see this (unnamed) function takes two arguments: one is <code>t</code> and the other is <code>n</code> - this is the tricky mind-bending part as this enables us to define recursive with only the <code>y</code>-fix point combinator"}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457214933, "post_id": 35819096, "comment_id": 59308131, "body": "It it is caused by the fact that the recursion will be infinitely ( to stop constraint)  expanded and there is no &#39;place for t argument&#39;.  Am I right?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 1, "creation_date": 1457215188, "post_id": 35819096, "comment_id": 59308207, "body": "I am not sure I understand what you are trying to say - the recursion here will stop because you finally hit the <code>then</code> branch where you don&#39;t use <code>t</code> again (the part where <code>y</code> brings in the recursive call into the computation) - although I talked about laziness at first it&#39;s not really needed here as <code>if</code> will evaluate only one branch in most lang. I know (in ML/F#, etc. it will work as is) and I decided it might confuse to much here"}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457215291, "post_id": 35819096, "comment_id": 59308240, "body": "Thanks you very much for your help and patience! :)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1457214655, "last_edit_date": 1457214655, "creation_date": 1457207682, "answer_id": 35819096, "question_id": 35818996, "link": "https://stackoverflow.com/questions/35818996/recursive-lambda-in-haskell/35819096#35819096", "title": "Recursive lambda in Haskell", "body": "<p>the <code>f</code>in <code>factorial</code> is the <code>(\\t n -&gt; if n == 1 ...)</code> <em>lambda</em></p>\n\n<p><code>y</code> is a so called <a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator\" rel=\"nofollow\">fix-point combinator</a> and it's used to enable recursive definitions in the lambda-calculus (it applies <code>f</code> to it's argument again and again recursively)</p>\n\n<p>to understand how it works you can just do some <em>evaluation by hand</em>:</p>\n\n<pre><code>factorial 3\n= y (\\t n -&gt; ...) 3\n{ def y and y (\\t n -&gt; ...) = factorial by eta-red. }\n= (\\t n -&gt; ...) factorial 3\n{ t = factorial, n = 3 -&gt; else case }\n= 3 * factorial 2\n= 3 * (y (\\t n -&gt; ...) 2)\n= 3 * ((\\t n -&gt; ...) factorial 2)\n= { t = factorial, n = 2 -&gt; else case }\n= 3 * (2 * factorial 1)\n= 3 * (2 * (y (\\t n -&gt; ...) 1))\n= 3 * (2 * ((\\t n -&gt; ...) factorial 1)))\n{ t = factorial n = 1 -&gt; then case }\n= 3 * (2 * 1)\n= 6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1457207767, "creation_date": 1457207767, "answer_id": 35819109, "question_id": 35818996, "link": "https://stackoverflow.com/questions/35818996/recursive-lambda-in-haskell/35819109#35819109", "title": "Recursive lambda in Haskell", "body": "<p><code>y</code> is the <a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator\" rel=\"nofollow\">fixed-point combinator</a>, also known as the y-combinator. In</p>\n\n<pre><code>factorial = y (\\t n -&gt; if n == 1 then 1 else n * t(n-1))\n</code></pre>\n\n<p>the lambda <code>(\\t n -&gt; if n == 1 then 1 else n * t(n-1))</code> is bound to <code>f</code> in the definition of <code>y</code>. You can then do the expansion:</p>\n\n<pre><code>(\\t n -&gt; if n == 1 then 1 else n * t(n-1)) (y (\\t n -&gt; if n == 1 then 1 else n * t(n-1)))\n</code></pre>\n\n<p>so inside the lambda, <code>t</code> will be bound to the lambda itself, which allows it to call itself recursively.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 0, "last_activity_date": 1457207842, "creation_date": 1457207842, "answer_id": 35819126, "question_id": 35818996, "link": "https://stackoverflow.com/questions/35818996/recursive-lambda-in-haskell/35819126#35819126", "title": "Recursive lambda in Haskell", "body": "<p>Perhaps it's easier if you write out the <em>y</em> combinator thus, with two eta-expansions:</p>\n\n<pre><code>y :: ((a-&gt;b) -&gt; a-&gt;b) -&gt; a-&gt;b\ny f x a = f (\\q a' -&gt; y f q a') x a\n</code></pre>\n\n<p>So <code>f</code> basically gets the recursive call (with <code>a'</code> in place of <code>a</code>) as its first argument.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "accepted_answer_id": 35819096, "answer_count": 3, "score": 1, "last_activity_date": 1457214655, "creation_date": 1457207221, "question_id": 35818996, "link": "https://stackoverflow.com/questions/35818996/recursive-lambda-in-haskell", "title": "Recursive lambda in Haskell", "body": "<p>Let's see analyse code for factorial in Haskell using lambda function:</p>\n\n<pre><code>y f x = f (y f) x\n\nfactorial = y (\\t n -&gt; if n == 1 then 1 else n * t(n-1))\n</code></pre>\n\n<p>And I cannot understand how does it works. I know that it is connected with lambda calculus but nowadays I am not familiar with that so I have to understand without it or with minimal knowledge.\nMy doubt is:\nWhat is f in definition of factorial? I mean this f: y <strong>f</strong> x = f (y f) x.</p>\n\n<p>So what is f here?  y (\\t n -> if n == 1 then 1 else n * t(n-1))</p>\n\n<p>Please explain me that, maybe expand recursion?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1457206853, "post_id": 35818761, "comment_id": 59305334, "body": "It&#39;s possible to do something like this, but there&#39;s a rather easier way: instead of enumerating the positive and negative numbers separately, enumerate only positive, but yield both the number and its negative."}, {"owner": {"reputation": 2418, "user_id": 1232832, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c492983af89b49d44250c79579a2641?s=128&d=identicon&r=PG", "display_name": "Shou Ya", "link": "https://stackoverflow.com/users/1232832/shou-ya"}, "edited": false, "score": 0, "creation_date": 1457206866, "post_id": 35818761, "comment_id": 59305337, "body": "I think <code>[(2*a+1)*b | a &lt;- [0..], b &lt;- [1,-1]]</code> will do the job."}], "answers": [{"comments": [{"owner": {"reputation": 256, "user_id": 6023118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfec4c8c4e305738006b35dc26ec0b2?s=128&d=identicon&r=PG&f=1", "display_name": "AME", "link": "https://stackoverflow.com/users/6023118/ame"}, "edited": false, "score": 0, "creation_date": 1458146893, "post_id": 35818909, "comment_id": 59732725, "body": "Thank you, you helped me a lot, sorry for being late with the answer."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 4, "last_activity_date": 1457209540, "last_edit_date": 1457209540, "creation_date": 1457206741, "answer_id": 35818909, "question_id": 35818761, "link": "https://stackoverflow.com/questions/35818761/how-can-i-put-together-two-sequence-with-a-list-generator-in-haskell/35818909#35818909", "title": "How can i put together two sequence with a list generator in Haskell", "body": "<p>I'll give you an hint.</p>\n\n<p>A list generator of the form:</p>\n\n<pre><code>[f x y | x &lt;- xs, y &lt;- ys]\n</code></pre>\n\n<p>Will perform the <em>cartesian product</em> of lists <code>xs</code> and <code>ys</code> (well, it will apply <code>f</code> to each element of the product). Assume <code>xs = [1,2,3]</code> and <code>ys = ['a', 'b']</code> the above list-comprehension is equivalent to:</p>\n\n<pre><code>[f 1 'a', f 1 'b', f 2 'a', f 2 'b', f 3 'a', f 3 'b']\n</code></pre>\n\n<p>so for each element <code>x</code> of <code>xs</code> the <em>whole</em> <code>ys</code> is iterated over thus producing all the <code>f x y0</code>, <code>f x y1</code>, ..., <code>f x yN</code> values.</p>\n\n<p>Ask yourself:</p>\n\n<ul>\n<li>what happens when <code>ys</code> is infinite? </li>\n<li>Hence is your approach in anyway feasible with that structure?</li>\n<li>Can you think of an other technique of generating <code>1</code> and <code>-1</code>, then <code>3</code> and <code>-3</code> which doesn't require two infinite lists but only one infinite list?</li>\n</ul>\n\n<p>Now try hard to answer these questions yourself, since there's no point in doing exercises if not for actually exercising your mind. I'll provide the answer in spoiler quotes so that if you give up you can have <em>a possible</em> solution:</p>\n\n<blockquote class=\"spoiler\">\n  <p> <code>[x*y | x &lt;- [1, 3..], y &lt;- [1,-1]]</code></p>\n</blockquote>\n"}], "owner": {"reputation": 256, "user_id": 6023118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfec4c8c4e305738006b35dc26ec0b2?s=128&d=identicon&r=PG&f=1", "display_name": "AME", "link": "https://stackoverflow.com/users/6023118/ame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 35818909, "answer_count": 1, "score": 1, "last_activity_date": 1457209540, "creation_date": 1457205907, "last_edit_date": 1457206352, "question_id": 35818761, "link": "https://stackoverflow.com/questions/35818761/how-can-i-put-together-two-sequence-with-a-list-generator-in-haskell", "title": "How can i put together two sequence with a list generator in Haskell", "body": "<p>I am new in haskell and i got an exercise. In theory i know how i should to do it, but i dont know how can i do it in Haskell. My exercise is create a list generator which generate the following infinite list : <code>[1,-1,3,-3,5,-5..]</code>. I would like to do it with two different sequence.</p>\n\n<p>Is there any way to solve this problem something like that:</p>\n\n<pre><code>[ something [a,b,a,b..] | a&lt;-[1,3..], b&lt;-[-1,-3..] ]\n</code></pre>\n\n<p>I have already tried to search the solution, but I couldn't find any about list generator.</p>\n"}, {"tags": ["haskell", "monads", "applicative"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1457206005, "post_id": 35818686, "comment_id": 59305041, "body": "see <code>return True</code> in <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/interactive-evaluation.html\" rel=\"nofollow noreferrer\">I/O actions at the prompt</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457206085, "post_id": 35818759, "comment_id": 59305066, "body": "So, actually it has something to do with Monad/Applicative instances, because IO is a Monad/Applicative/Functor... Am I right??"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 1, "creation_date": 1457206508, "post_id": 35818759, "comment_id": 59305216, "body": "Well, if IO weren&#39;t applicative then this clearly wouldn&#39;t work. I&#39;m not sure how GHCi decides to interpret an expression as <code>IO</code>; apparently it first tries to unify any type with <code>IO a</code> and only if that fails goes the print-only route. This wouldn&#39;t really have anything to do with monads."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1457206155, "last_edit_date": 1457206155, "creation_date": 1457205906, "answer_id": 35818759, "question_id": 35818686, "link": "https://stackoverflow.com/questions/35818686/haskell-applicative-monad-instances/35818759#35818759", "title": "Haskell - Applicative/Monad instances", "body": "<p>That's a peculiarity of ghci. It has special handling for <code>IO</code> actions, which aren't just &ldquo;computed&rdquo; and printed (you can't print an IO action anyway), but executed and <em>the result</em><sup>&dagger;</sup> printed. So,</p>\n\n<pre><code>Prelude&gt; pure 1 :: IO Integer\n1\n</code></pre>\n\n<p>As per behzad.nouri's comment, <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/interactive-evaluation.html\" rel=\"nofollow\">here's the relevant manual section</a>.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Provided it's <code>IO a</code> with <code>Show a</code> and not <code>a~()</code>, otherwise <em>only</em> the action is executed.</sub></p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 35818759, "answer_count": 1, "score": 2, "last_activity_date": 1457206155, "creation_date": 1457205576, "question_id": 35818686, "link": "https://stackoverflow.com/questions/35818686/haskell-applicative-monad-instances", "title": "Haskell - Applicative/Monad instances", "body": "<p>I've seen that the type of <code>pure 1</code> is <code>(Num a, Applicative f) =&gt; f a</code>, which is quite obvious. \nSo if I would like to make it a <code>Maybe Int</code>:</p>\n\n<pre><code>Prelude&gt; pure 1 :: Maybe Int\nJust 1\n</code></pre>\n\n<p>What about this?</p>\n\n<pre><code>Prelude&gt; pure 1\n1\nPrelude&gt; return 1\n1\n</code></pre>\n\n<p>What is going on? Why doesn't it complain about not knowing which instance to choose??</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I think that this behaviour actually has nothing to do with monads or applicatives, but this was the context I came to it... </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457202283, "post_id": 35817860, "comment_id": 59303571, "body": "what are you trying to do here - you don&#39;t add anything!"}, {"owner": {"reputation": 126, "user_id": 4561178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vgQ6U.jpg?s=128&g=1", "display_name": "Jake Matthews", "link": "https://stackoverflow.com/users/4561178/jake-matthews"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457203290, "post_id": 35817860, "comment_id": 59303986, "body": "@Carsten I&#39;m trying get the Ints stored in Nodes of a Tree and add each score up for each branch of the first level of the tree after the initial node."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1457210238, "post_id": 35817860, "comment_id": 59306588, "body": "Please paste a code snippet rather than a screenshot."}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 4561178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vgQ6U.jpg?s=128&g=1", "display_name": "Jake Matthews", "link": "https://stackoverflow.com/users/4561178/jake-matthews"}, "edited": false, "score": 0, "creation_date": 1457203903, "post_id": 35817956, "comment_id": 59304232, "body": "Thank you for your helpful answer!"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1457202431, "last_edit_date": 1457202431, "creation_date": 1457202196, "answer_id": 35817956, "question_id": 35817860, "link": "https://stackoverflow.com/questions/35817860/haskell-couldnt-match-type-int-with-int/35817956#35817956", "title": "Haskell: Couldn&#39;t match type [Int] with Int", "body": "<p>The error is simply telling you there is one too many (or one too few) layers of lists somewhere.</p>\n\n<p>Why are you putting <code>map ...</code> as a single element of a list:</p>\n\n<pre><code>[(map (add_score (n-1)) xs)]\n</code></pre>\n\n<p>At first blush, it appears you want:</p>\n\n<pre><code>(map (add_score (n-1)) xs)\n</code></pre>\n\n<p>But then since <code>add_source</code> fully applied yields a <code>[[Int]]</code>, mapping it will be of type <code>[[[Int]]]</code> (thanks @Carsten).  You might be after:</p>\n\n<pre><code>concatMap (add_score (n-1)) xs\n</code></pre>\n\n<p>That will concatenate the list and yield a result of type <code>[[Int]]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 126, "user_id": 4561178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vgQ6U.jpg?s=128&g=1", "display_name": "Jake Matthews", "link": "https://stackoverflow.com/users/4561178/jake-matthews"}, "edited": false, "score": 0, "creation_date": 1457203840, "post_id": 35818015, "comment_id": 59304203, "body": "Thank you for solving my problem!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1457202468, "creation_date": 1457202468, "answer_id": 35818015, "question_id": 35817860, "link": "https://stackoverflow.com/questions/35817860/haskell-couldnt-match-type-int-with-int/35818015#35818015", "title": "Haskell: Couldn&#39;t match type [Int] with Int", "body": "<p><code>xs</code> has type <code>[TreeOf a]</code>. Clearly, you <em>can</em> map <code>add_score (n-1)</code> over such a list as you did, since this takes <code>TreeOf a</code> as an argument.</p>\n\n<p>But what's the result? Well, a list of whatever the result of a single <code>add_score (n-1)</code> is. But that's already a <code>[[Int]]</code>, so you get</p>\n\n<pre><code>map (add_score $ n-1) xs :: [ [[Int]] ]\n</code></pre>\n\n<p>which is one nesting level too much. Now wrapping this in another singleton list is clearly counterproductive. On the contrary, you need to <em>flatten</em> one list level. There are at least three ways to do this:</p>\n\n<ul>\n<li><p>Concatenate the outer lists.</p>\n\n<pre><code>   [i] : (concat $ map (add_score $ n-1) xs)\n</code></pre>\n\n<p>this can be more nicely written with <code>=&lt;&lt;</code> (aka <code>concatMap</code>), as</p>\n\n<pre><code>   [i] : (add_score (n-1) =&lt;&lt; xs)\n</code></pre></li>\n<li><p>Concatenate the <em>inner</em> lists.</p>\n\n<pre><code>   [i] : (map (concat . add_score (n-1)) xs)\n</code></pre></li>\n<li><p>Sum up the innermost list.</p>\n\n<pre><code>   [i] : (map (map sum . add_score (n-1)) xs)\n</code></pre></li>\n</ul>\n\n<p>You must know yourself which behaviour you want; the first seems most useful to me.</p>\n"}], "owner": {"reputation": 126, "user_id": 4561178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vgQ6U.jpg?s=128&g=1", "display_name": "Jake Matthews", "link": "https://stackoverflow.com/users/4561178/jake-matthews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 35818015, "answer_count": 2, "score": -2, "last_activity_date": 1457813252, "creation_date": 1457201679, "last_edit_date": 1457813252, "question_id": 35817860, "link": "https://stackoverflow.com/questions/35817860/haskell-couldnt-match-type-int-with-int", "title": "Haskell: Couldn&#39;t match type [Int] with Int", "body": "<p>Hi here is my code below.</p>\n\n<pre><code>data Treeof a = Node Int a [Treeof a]  deriving (Eq,Show)\n\nadd_score :: Int -&gt; Treeof a -&gt; [[Int]]\nadd_score 0 (Node i a xs) = [[0]]\nadd_score n (Node i a xs) = [i]:[(map (add_score (n-1)) xs)]\n</code></pre>\n\n<p>I trying to obtain the Int stored in each Node of a Tree and store it in a list of lists but get the error shown below and I'm unsure why.</p>\n\n<pre><code>    Couldn't match type `[[Int]]' with `Int'\n    Expected type: Treeof a -&gt; Int\n      Actual type: Treeof a -&gt; [[Int]]\n    In the first argument of `map', namely `(add_score (n - 1))'\n    In the expression: (map (add_score (n - 1)) xs)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>EDIT: Changed [i]:[(map (add_score (n-1)) xs)] to [i]:(map (add_score (n-1)) xs)</p>\n\n<p>And getting a similar error </p>\n\n<pre><code>    Couldn't match type `[Int]' with `Int'\n    Expected type: Treeof a -&gt; [Int]\n      Actual type: Treeof a -&gt; [[Int]]\n    In the first argument of `map', namely `(add_score (n - 1))'\n    In the second argument of `(:)', namely\n      `(map (add_score (n - 1)) xs)\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["list", "haskell", "indexing"], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 5464538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MGHR8.jpg?s=128&g=1", "display_name": "pioupiou1211", "link": "https://stackoverflow.com/users/5464538/pioupiou1211"}, "edited": false, "score": 1, "creation_date": 1457204758, "post_id": 35818060, "comment_id": 59304558, "body": "Thanks a lot, I had the idea to use an accumulator but I did not know how to do it!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1457202668, "creation_date": 1457202668, "answer_id": 35818060, "question_id": 35817848, "link": "https://stackoverflow.com/questions/35817848/get-the-index-of-multiples-elements-in-a-haskell-list/35818060#35818060", "title": "Get the index of multiples elements in a haskell list", "body": "<p>The are some problems with your source code: the most important is that the case of <code>B</code> and the empty list generate lists with items as well:</p>\n\n<pre><code>indice :: [Case] -&gt; [Int]\nindice [] = [0]  -- &lt;- list with elements?\nindice (x:xs)\n    | x == N = [1 + head(indice(xs))] ++ indice(xs)\n    | x == B = [1]  -- &lt;- list with elements?\n</code></pre>\n\n<p>Nevertheless, I think for this case you better use an <em>accumulator</em>: a variable you update during recursive calls. The accumulator in this case is <code>i</code>: the index at which our \"<em>cursor</em>\" is located. We can use an accumulator, by making <code>indice</code> call a helper function:</p>\n\n<pre><code>indice :: [Case] -&gt; [Int]\nindice = helper 0\n    where helper --...\n</code></pre>\n\n<p>Now we still need to define our <code>helper</code> function.</p>\n\n<p>Furthermore there are three cases we have to take care of:</p>\n\n<ul>\n<li><p>we reached the end of the list, in which case we return an empty list as well:</p>\n\n<pre><code>helper _ [] = []\n</code></pre></li>\n<li><p>the cursor is located at an <code>N</code>, we \"<em>emit</em>\" the index and make a recursive call updating the index:</p>\n\n<pre><code>helper i (N:xs) = i : helper (i+1) xs\n</code></pre></li>\n<li><p>the cursor is located at another character, we simply move the cursor forward and update the index:</p>\n\n<pre><code>helper i (_:xs) = helper (i+1) xs\n</code></pre></li>\n</ul>\n\n<p>Putting it all together, we obtain:</p>\n\n<pre><code>indice :: [Case] -&gt; [Int]\nindice = helper 0\n    where helper _ [] = []\n          helper i (N:xs) = i : helper (i+1) xs\n          helper i (_:xs) = helper (i+1) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 3, "last_activity_date": 1457203832, "last_edit_date": 1457203832, "creation_date": 1457203199, "answer_id": 35818196, "question_id": 35817848, "link": "https://stackoverflow.com/questions/35817848/get-the-index-of-multiples-elements-in-a-haskell-list/35818196#35818196", "title": "Get the index of multiples elements in a haskell list", "body": "<p>You can tag each element with its index using <code>zip</code>, filter the elements that match your criteria, and then strip the values, leaving only the indexes:</p>\n\n<pre><code>indexesOf :: Eq a =&gt; a -&gt; [a] -&gt; [Int]\nindexesOf v = map fst . filter ((== v) . snd) . zip [0..]\n</code></pre>\n\n<p>So, assuming the type inhabited by <code>N</code> and <code>B</code> is an instance of <code>Eq</code>, you can do:</p>\n\n<pre><code>indexesOf N [B,B,N,B,N]\n</code></pre>\n\n<p>and get the answer:</p>\n\n<pre><code>[2,4]\n</code></pre>\n\n<p>But, this is just <code>elemIndices</code> from <code>Data.List</code></p>\n"}], "owner": {"reputation": 221, "user_id": 5464538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MGHR8.jpg?s=128&g=1", "display_name": "pioupiou1211", "link": "https://stackoverflow.com/users/5464538/pioupiou1211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "accepted_answer_id": 35818060, "answer_count": 2, "score": 0, "last_activity_date": 1457203832, "creation_date": 1457201630, "last_edit_date": 1457202283, "question_id": 35817848, "link": "https://stackoverflow.com/questions/35817848/get-the-index-of-multiples-elements-in-a-haskell-list", "title": "Get the index of multiples elements in a haskell list", "body": "<p>I have a list like <code>[B,B,N,B,N]</code> and I want to retrieve all the index of the <code>N</code>. So, in this example it would be <code>[2,4]</code>.</p>\n\n<p>I don't really know how to do it... I tried with <code>elemIndex</code> but in fact I don't think that in my case it's allowed, because that's all the point of the exercise.</p>\n\n<p>I did this for now but I do know that it doesn't work:</p>\n\n<pre><code>indice :: [Case] -&gt; [Int]\nindice [] = [0]\nindice (x:xs)\n    | x == N = [1 + head(indice(xs))] ++ indice(xs)\n    | x == B = [1]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1457200205, "post_id": 35817537, "comment_id": 59302741, "body": "no - <code>persistLowerCase</code> will prepend the <code>person...</code> for you ;) - so you will end up with a <code>Person</code> and getters <code>personName</code>, <code>personAge</code> and <code>personId</code> anyway ;)"}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457200377, "post_id": 35817537, "comment_id": 59302808, "body": "Ohh, cool then, thanks"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457200379, "post_id": 35817537, "comment_id": 59302811, "body": "but note that you still have to give the types - so you should do <code>Person ... name Text ... age Int</code> or something similar"}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457200408, "post_id": 35817537, "comment_id": 59302824, "body": "Oh Yeah, I forgot to put on the example"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1457200748, "creation_date": 1457200748, "answer_id": 35817685, "question_id": 35817537, "link": "https://stackoverflow.com/questions/35817537/record-practice-with-persistent/35817685#35817685", "title": "Record practice with persistent", "body": "<p>I'll make my comment into an answer - I hope you don't mind</p>\n\n<hr>\n\n<p>you don't have to prepend the <code>person</code> - <em>persistent</em>  will do this for you</p>\n\n<p>so you will end up with a <code>Person</code> type and getters <code>personName</code>, <code>personAge</code> and <code>personId</code> when you use something like</p>\n\n<pre><code>mkPersist mySqlSettings [persistLowerCase|\nPerson\n    name Text\n    age  Int\n|]\n</code></pre>\n\n<p>there is a rather good <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow\">documentation</a> explaining this in detail on the  online yesod-book.</p>\n\n<hr>\n\n<p>PS: of course <code>age Text</code> is ok too - but it seems a bit odd</p>\n"}], "owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 35817685, "answer_count": 1, "score": 1, "last_activity_date": 1457200748, "creation_date": 1457199992, "last_edit_date": 1457200431, "question_id": 35817537, "link": "https://stackoverflow.com/questions/35817537/record-practice-with-persistent", "title": "Record practice with persistent", "body": "<p>I am starting to use Persistent, and I have a question. How should we create records with Persistent? For example:</p>\n\n<pre><code>share [..] [persistLowerCase|\nPerson\n    name Text\n    age  Text\n|]\n-- or\nshare [..] [persistLowerCase|\nPerson\n    personName Text\n    personAge  Text\n|]\n</code></pre>\n\n<p>In this case, is it good practice to \"namespace\" the fields of the record?</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1457200251, "post_id": 35817514, "comment_id": 59302750, "body": "Something like <code>instance Epsilon e =&gt; Arbitrary (BigFloat e) where arbitrary = fromRational &lt;$&gt; arbitrary</code> should do it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1458312967, "post_id": 35817514, "comment_id": 59819463, "body": "Never depend on <code>Arbitrary</code> instances giving any particularly nice statistical distributions. They tend to be designed based on what their authors think will be most helpful for testing, rather than any theoretical considerations."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1458313272, "post_id": 35817514, "comment_id": 59819684, "body": "Also, orphan instances are kind of evil, so it&#39;s usually best to make an instance for a newtype instead."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1458285508, "creation_date": 1458285508, "answer_id": 36078350, "question_id": 35817514, "link": "https://stackoverflow.com/questions/35817514/how-do-i-make-bigfloat-an-instance-of-arbitrary-for-quickcheck/36078350#36078350", "title": "How do I make BigFloat an instance of Arbitrary (for QuickCheck)?", "body": "<p>Posting the answer from the comments as a community-wiki answer:</p>\n\n<p>Something like:</p>\n\n<pre><code>instance Epsilon e =&gt; Arbitrary (BigFloat e) where arbitrary = fromRational &lt;$&gt; arbitrary\n</code></pre>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 36078350, "answer_count": 1, "score": 2, "last_activity_date": 1458311287, "creation_date": 1457199891, "last_edit_date": 1458311287, "question_id": 35817514, "link": "https://stackoverflow.com/questions/35817514/how-do-i-make-bigfloat-an-instance-of-arbitrary-for-quickcheck", "title": "How do I make BigFloat an instance of Arbitrary (for QuickCheck)?", "body": "<p>The numbers package has the <a href=\"https://hackage.haskell.org/package/numbers-3000.2.0.1/docs/Data-Number-BigFloat.html\" rel=\"nofollow\"><code>BigFloat</code></a> type.</p>\n\n<p>QuickCheck has the <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck-Arbitrary.html\" rel=\"nofollow\"><code>Arbitrary</code></a> typeclass.</p>\n\n<p>Because <code>Double</code> is an instance of <code>Arbitrary</code>, I can already do this:</p>\n\n<pre><code>sample (arbitrary :: Gen Double)\n</code></pre>\n\n<p>But I can't do this because <code>BigFloat e</code> isn't an instance of <code>Arbitrary</code>:</p>\n\n<pre><code>sample (arbitrary :: Gen (BigFloat Prec10))\n</code></pre>\n\n<p>How do I make <code>BigFloat e</code> an instance of <code>Arbitrary</code>?</p>\n\n<p><strong>Update</strong>. I'd love some additional information. See the comment in the bounty.</p>\n"}, {"tags": ["haskell", "ghc", "dependent-type", "existential-type", "data-kinds"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1457196432, "post_id": 35816742, "comment_id": 59301306, "body": "You can&#39;t yet mix types and kinds in the concrete syntax. The best you can do is <code>data Type (tp :: KProxy t) = forall (a :: t) . Type (Proxy a)</code> (although I don&#39;t see how useful this data type would be, but that&#39;s a different issue altogether."}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1457196385, "creation_date": 1457196385, "answer_id": 35816838, "question_id": 35816742, "link": "https://stackoverflow.com/questions/35816742/why-arent-existential-quantification-and-datakinds-working-together/35816838#35816838", "title": "Why aren&#39;t existential quantification and datakinds working together?", "body": "<p>The arguments of type constructors are types, not kinds. So <code>data Type t = ...</code> means <code>t</code> is a type variable.</p>\n\n<p>In GHC 8.0 the TypeInType extension removes the distinction between types and kinds, allowing your program to be accepted if you enable it (and GHC will suggest enabling the extension if you don't).</p>\n"}, {"comments": [{"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1457196652, "post_id": 35816849, "comment_id": 59301408, "body": "I&#39;m not quite sure if that exact definition works in GHC 8 though, since Type is builtin in that version."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1457197155, "post_id": 35816849, "comment_id": 59301581, "body": "I just tried it and it works in ghci. We only get <code>Type</code> if we import <code>Data.Kind</code>."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 9, "last_activity_date": 1457196446, "creation_date": 1457196446, "answer_id": 35816849, "question_id": 35816742, "link": "https://stackoverflow.com/questions/35816742/why-arent-existential-quantification-and-datakinds-working-together/35816849#35816849", "title": "Why aren&#39;t existential quantification and datakinds working together?", "body": "<p>Prior to GHC 8, there are no kind bindings allowed, anywhere. Here, we have to use kind proxies. In this case we can do:</p>\n\n<pre><code>import Data.Proxy\n\ndata Type (kp :: KProxy k) = forall (a :: k). Type (Proxy a)\n</code></pre>\n\n<p>With GHC 8, you can indeed write your original version:</p>\n\n<pre><code>{-# language TypeInType #-}\n\ndata Type t = forall (a :: t). Type (Proxy a)\n</code></pre>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1457196446, "creation_date": 1457195930, "question_id": 35816742, "link": "https://stackoverflow.com/questions/35816742/why-arent-existential-quantification-and-datakinds-working-together", "title": "Why aren&#39;t existential quantification and datakinds working together?", "body": "<pre><code>{-# LANGUAGE DataKinds, ExistentialQuantification, KindSignatures #-}\nimport Data.Proxy\n\ndata Type t= forall (a :: t). Type (Proxy a)\n</code></pre>\n\n<p>gives the error</p>\n\n<pre><code>Type variable \u2018t\u2019 used in a kind\nIn the kind \u2018t\u2019\nIn the definition of data constructor \u2018Type\u2019\nIn the data declaration for \u2018Type\u2019\n</code></pre>\n\n<p>But <code>t</code> is a Kind variable, not a type variable. What's going on?</p>\n"}, {"tags": ["haskell", "yesod", "aeson"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457193393, "post_id": 35816074, "comment_id": 59300082, "body": "I think the obvious way would be to use a simple wrapper and make it an instance of <code>FromJSON</code>"}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1457196068, "post_id": 35816074, "comment_id": 59301142, "body": "I am not familiar with Yesod, but have you considered <a href=\"https://hackage.haskell.org/package/lens-aeson-1.0.0.5/docs/Data-Aeson-Lens.html\" rel=\"nofollow noreferrer\">aeson-lens</a> ? The doc on Hackage gives you a pretty nice idea of what you can do. You don&#39;t need to provide a parser; you just lookup (or do any lens magic you want with) the json field."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457198090, "post_id": 35816815, "comment_id": 59301902, "body": "while this is a nice way to do it I don&#39;t think it will work as is with <code>requireJsonBody</code> - that&#39;s why I would write a simple <code>data Wrapper = Wrapper { data :: MyEntity }</code> and make it an instance - the instance for <code>MyEntity</code> should already be there - yesod handles these things using TH"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 1, "creation_date": 1457212700, "post_id": 35816815, "comment_id": 59307437, "body": "The <a href=\"http://haddock.stackage.org/lts-5.5/yesod-core-1.4.19/src/Yesod-Core-Json.html#requireJsonBody\" rel=\"nofollow noreferrer\">implementation</a> of <code>requireJsonBody</code> is really short though. You could write your own function that parsed an aeson <code>Value</code> and if parsing failed threw an <code>invalidArgs </code> exception"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1457213035, "post_id": 35816815, "comment_id": 59307547, "body": "This is very likely negligible for @FtheBuilder&#39;s use case, but I think  using a small wrapper would be more memory/CPU efficient because aeson could parse a <code>ByteString</code> <a href=\"https://hackage.haskell.org/package/aeson-0.11.1.0/docs/Data-Aeson.html#g:7\" rel=\"nofollow noreferrer\">directly into the record as of aeson-0.10</a>, whereas with aeson-lens you&#39;re working with the intermediate <code>Value</code> data structure. Again, though, likely negligible for most use cases."}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1457213626, "post_id": 35816815, "comment_id": 59307724, "body": "I&#39;m glad I posted this answer, I learnt more than I was able to share! thanks for the tip."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457233721, "post_id": 35816815, "comment_id": 59312527, "body": "@Carsten - Your way is interesting, but it would require to write a lot of simple Wrappers (because it is a pattern which will appear frequently)... I think that only extracting the part that I need and then using it is a better approach in my case...That&#39;s why I liked Nicolas Mattia&#39;s comment."}], "tags": [], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "is_accepted": false, "score": 2, "last_activity_date": 1457227567, "last_edit_date": 1457227567, "creation_date": 1457196281, "answer_id": 35816815, "question_id": 35816074, "link": "https://stackoverflow.com/questions/35816074/haskell-yesod-extracting-a-object-inside-a-json-before-converting-it-to-a-mode/35816815#35816815", "title": "Haskell Yesod - extracting a object inside a json before converting it to a model", "body": "<p>This was too large to fit in my comment above (using <a href=\"https://hackage.haskell.org/package/lens-aeson-1.0.0.5/docs/Data-Aeson-Lens.html\" rel=\"nofollow\">lens-aeson</a>)</p>\n\n<pre><code>\u03bb: import Control.Lens\n\u03bb: import Data.Aeson.Lens\n\u03bb: let e = \"{ \\\"data\\\": [1,2,3] }\"\n\u03bb: e ^? key \"data\"\nJust (Array [Number 1.0,Number 2.0,Number 3.0])\n</code></pre>\n\n<p>and as Carsten mentioned, you'll still need to provide a FromJSON instance of your model</p>\n"}, {"comments": [{"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457451901, "post_id": 35868248, "comment_id": 59407427, "body": "You can bind this functions into one, which will take a single like."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1457460276, "post_id": 35868248, "comment_id": 59413039, "body": "That&#39;s a good point, this is pretty clean: <code>(comment :: Comment) &lt;- requireJsonBody&#39; &gt;&gt;= requireJsonKey &quot;data&quot; &gt;&gt;= requireJsonParse</code>"}], "tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 2, "last_activity_date": 1457442428, "creation_date": 1457442428, "answer_id": 35868248, "question_id": 35816074, "link": "https://stackoverflow.com/questions/35816074/haskell-yesod-extracting-a-object-inside-a-json-before-converting-it-to-a-mode/35868248#35868248", "title": "Haskell Yesod - extracting a object inside a json before converting it to a model", "body": "<p>There was some more discussion of this question on a <a href=\"https://github.com/yesodweb/yesod/issues/1177\" rel=\"nofollow\">Github Issue</a>, which I'm adding as an answer here because it's more fleshed out. Here's what we arrive at for the Handler function using the helper functions defined below:</p>\n\n<pre><code>postDataCommentR :: Handler Value\npostDataCommentR = do\n  value &lt;- requireJsonBody' -- Parse request body into Value\n  commentJson &lt;- requireJsonKey \"data\" value -- Lookup a key from the Value\n  comment &lt;- (requireJsonParse commentJson :: Handler Comment) -- Parse the Value into a comment record\n\n  insertedComment &lt;- runDB $ insertEntity comment\n  returnJson insertedComment\n</code></pre>\n\n<p>These functions take the request body and parse it into an aeson <code>Value</code>:</p>\n\n<pre><code>import qualified Data.Aeson as J\nimport qualified Data.Aeson.Parser as JP\nimport Data.Conduit.Attoparsec (sinkParser)\n\n-- These two functions were written by @FtheBuilder\nparseJsonBody' :: (MonadHandler m) =&gt; m (J.Result Value)\nparseJsonBody' = do\n    eValue &lt;- rawRequestBody $$ runCatchC (sinkParser JP.value')\n    return $ case eValue of\n        Left e -&gt; J.Error $ show e\n        Right value -&gt; J.Success value\n\n-- | Same as 'parseJsonBody', but return an invalid args response on a parse\n-- error.\nrequireJsonBody' :: (MonadHandler m) =&gt; m Value\nrequireJsonBody' = do\n    ra &lt;- parseJsonBody'\n    case ra of\n        J.Error s -&gt; invalidArgs [pack s]\n        J.Success a -&gt; return a\n</code></pre>\n\n<p>These helper functions are used to parse that <code>Value</code> into a record:</p>\n\n<pre><code>requireJsonParse :: (MonadHandler m, FromJSON a) =&gt; Value -&gt; m a\nrequireJsonParse v = case J.fromJSON v of\n  J.Error s -&gt; invalidArgs [pack s]\n  J.Success a -&gt; return a\n\nrequireJsonKey :: (MonadHandler m) =&gt; Text -&gt; Value -&gt; m Value\nrequireJsonKey key jObject@(Object hashMap) = case lookup key hashMap of\n                                    Nothing -&gt; invalidArgs [\"Couldn't find a value when looking up the key \" &lt;&gt; key &lt;&gt; \" in the object: \" &lt;&gt; (pack (show jObject))]\n                                    Just v -&gt; return v\nrequireJsonKey key invalid = invalidArgs [\"When looking up the key \" &lt;&gt; key &lt;&gt; \", expected an object but got a \" ++ (pack (show invalid))]\n</code></pre>\n\n<h2>Commentary</h2>\n\n<h3>aeson-lens</h3>\n\n<p>I didn't use <code>aeson-lens</code>, but the code is pretty similar with or without it, since we're just going one key deep. <code>aeson-lens</code> would make things nicer if we were traversing deeper into the JSON.</p>\n\n<h3>Comparison to wrapper definition</h3>\n\n<p>Once you get the helper functions defined, you still have a couple lines to parse a <code>Value</code>, then lookup the <code>data</code> key, then create your record. You can do things to make this shorter, but ultimately the wrapper that @Carsten recommended would be of similar length with less complexity, imo.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 35868248, "answer_count": 2, "score": 1, "last_activity_date": 1457442428, "creation_date": 1457192517, "last_edit_date": 1457192897, "question_id": 35816074, "link": "https://stackoverflow.com/questions/35816074/haskell-yesod-extracting-a-object-inside-a-json-before-converting-it-to-a-mode", "title": "Haskell Yesod - extracting a object inside a json before converting it to a model", "body": "<p>Suppose I have a JSON like this:</p>\n\n<pre><code>{\n  data: {...}\n}\n</code></pre>\n\n<p>and <code>{...}</code> represents a model of mine. How could \nget my model in this case in the Handler? For instance, the following will not work obviously:</p>\n\n<pre><code>putMyEntityR :: Handler ()\nputMyEntityR = do\n  (Entity id _) &lt;- (...) -- getting the Key\n  e &lt;- requireJsonBody :: Handler MyEntity\n  runDB $ replace id e\n  sendResponseStatus status204 (\"UPDATED\" :: Text)\n</code></pre>\n\n<p>How can I read the <code>JSON</code>, take the <code>data</code> object, and only then decode it?</p>\n"}, {"tags": ["haskell", "state-monad", "haskell-lens"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457214223, "post_id": 35816019, "comment_id": 59307903, "body": "That <code>let eval ...</code> is a bit odd. Why not skip that and just write <code>if a &gt;= b then return Win else return Defeat</code>?"}, {"owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457256296, "post_id": 35816019, "comment_id": 59317213, "body": "@dfeuer, if I need more cases (for example &gt;, &lt;, and ==), I have to use this <code>let</code> expression. Do you know any other ways to implement guards inside a <code>do</code> block?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1457284435, "post_id": 35816019, "comment_id": 59326608, "body": "<code>case () of _ | ...</code> is classic. GHC <code>MultiWayIf</code> offers better syntax for it."}], "answers": [{"comments": [{"owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "edited": false, "score": 0, "creation_date": 1457202626, "post_id": 35816442, "comment_id": 59303702, "body": "One more question. When I attempt to place line <code>defender.troops.=0</code> in a nested <code>do</code> block before <code>return Win</code>, the compiler throws an error and suggests to use <code>FlexibleContexts</code> again. How can do it without this extension?"}, {"owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "edited": false, "score": 0, "creation_date": 1457203360, "post_id": 35816442, "comment_id": 59304009, "body": "And is there something better than <code>preuse</code>? Do I use it at a proper place?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "edited": false, "score": 1, "creation_date": 1457203504, "post_id": 35816442, "comment_id": 59304072, "body": "Really? Nested <code>do</code> blocks shouldn&#39;t make much difference here... but if it makes the compiler happy, heck, just turn on <code>-XFlexibleContexts</code>, as I said I see no good reason not to. \u2014 <code>preuse</code> is fine here, it&#39;s what I&#39;d use too."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1457195471, "last_edit_date": 1457195471, "creation_date": 1457194245, "answer_id": 35816442, "question_id": 35816019, "link": "https://stackoverflow.com/questions/35816019/pass-a-lens-into-a-funciton/35816442#35816442", "title": "Pass a lens into a funciton", "body": "<p><em>Just use type signatures!</em></p>\n\n<p>What's going on here: if you don't supply a signature, GHC will only be able to infer a Rank-1 type<sup>&dagger;</sup>. In this example, you're using <code>defender.troops</code> as a getter<sup>&ddagger;</sup>; the compiler therefore infers a getter type for <code>defender</code>. This is the ugly thing in the error message with <code>Const</code> in it.</p>\n\n<p>However, you also want to use it as a setter. This is only possible if <code>defender</code> is polymorphic (so you can use an <code>Identity</code> functor instead of <code>Const</code>), and for an argument to be polymorphic you need Rank-2 polymorphism.</p>\n\n<p>You don't really need to worry about this kind of category-theory magic though, since the lens library supplies easy to use synonyms. Just write the signature <em>as you should <strong>always</strong> do anyway</em>,</p>\n\n<pre><code>offend :: Traversal' Game Army -&gt; Traversal' Game Army -&gt; State Game BattleResult\n</code></pre>\n\n<p>and you get the proper polymorphic arguments. Ah, and of course you need the <code>-XRankNTypes</code> extension. <code>-XFlexibleContexts</code> is actually not required (it is completely harmless though, no reason not to use it).</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Hindley-Milner is quite a marvel anyway if you ask me, but it only works because there's a well-defined <em>most general possible</em> signature for any expression. This is only the case for Rank-1 code though: with Rank-N, you could always toss in yet another layer of universal quantification. The compiler can't know when to end this!</sub></p>\n\n<p><sup>&ddagger;</sup><sub>Actually a <code>Getting</code>, which is a traversal-getter. The difference beteween <code>Getter</code> and <code>Getting</code> is that the latter can be partial (which is necessary because you use <code>ix</code>; the compiler can't prove there is actually an element at index 1 in the armies list).</sub></p>\n"}], "owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "accepted_answer_id": 35816442, "answer_count": 1, "score": 3, "last_activity_date": 1457195471, "creation_date": 1457192214, "question_id": 35816019, "link": "https://stackoverflow.com/questions/35816019/pass-a-lens-into-a-funciton", "title": "Pass a lens into a funciton", "body": "<p>How to pass properly a lens into a function with state? Let us consider the next code:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nimport Control.Lens\nimport Control.Monad.State\n\ndata Game = Game { _armies :: [Army]\n                 } deriving (Show)\n\ndata Army = Army { _troops :: Int\n                 } deriving (Show)\n\nmakeLenses ''Game\nmakeLenses ''Army\n\ndata BattleResult = Win | Defeat deriving (Show)\n\noffend offender defender = do\n  Just ot &lt;- preuse $ offender.troops\n  Just dt &lt;- preuse $ defender.troops\n  defender.troops.=0 -- doesn't work\n  let eval a b\n        | a &gt;= b    = return Win\n        | otherwise = return Defeat\n  eval ot dt\n\ngame :: State Game ()\ngame = do\n    armies %= (:) (Army 100)\n    armies %= (:) (Army 200)\n    q &lt;- offend (armies.ix 0) (armies.ix 1)\n    return ()\n</code></pre>\n\n<p>The marked line leads to the next error:</p>\n\n<pre><code>Lens.hs:21:3:\n    Couldn't match type \u2018Const (Data.Monoid.First Int) s\u2019\n                   with \u2018Identity s\u2019\n    Expected type: (Army -&gt; Const (Data.Monoid.First Int) Army)\n                   -&gt; s -&gt; Identity s\n      Actual type: (Army -&gt; Const (Data.Monoid.First Int) Army)\n                   -&gt; s -&gt; Const (Data.Monoid.First Int) s\n    Relevant bindings include\n      defender :: (Army -&gt; Const (Data.Monoid.First Int) Army)\n                  -&gt; s -&gt; Const (Data.Monoid.First Int) s\n        (bound at Lens.hs:18:17)\n      offender :: (Army -&gt; Const (Data.Monoid.First Int) Army)\n                  -&gt; s -&gt; Const (Data.Monoid.First Int) s\n        (bound at Lens.hs:18:8)\n      offend :: ((Army -&gt; Const (Data.Monoid.First Int) Army)\n                 -&gt; s -&gt; Const (Data.Monoid.First Int) s)\n                -&gt; ((Army -&gt; Const (Data.Monoid.First Int) Army)\n                    -&gt; s -&gt; Const (Data.Monoid.First Int) s)\n                -&gt; m BattleResult\n        (bound at Lens.hs:18:1)\n    In the first argument of \u2018(.)\u2019, namely \u2018defender\u2019\n    In the first argument of \u2018(.=)\u2019, namely \u2018defender . troops\u2019\n\nLens.hs:21:12:\n    Couldn't match type \u2018Identity Integer\u2019\n                   with \u2018Const (Data.Monoid.First Int) Int\u2019\n    Expected type: (Int -&gt; Identity Integer)\n                   -&gt; Army -&gt; Const (Data.Monoid.First Int) Army\n      Actual type: (Int -&gt; Const (Data.Monoid.First Int) Int)\n                   -&gt; Army -&gt; Const (Data.Monoid.First Int) Army\n    In the second argument of \u2018(.)\u2019, namely \u2018troops\u2019\n    In the first argument of \u2018(.=)\u2019, namely \u2018defender . troops\u2019\n</code></pre>\n\n<p>If replace the line with something like <code>armies.ix 0.troops.=0</code> the code is normally compiled. Are there some standard tools to walk around the problem? And could the same algorithm be implemented without using <code>FlexibleContexts</code>?</p>\n"}, {"tags": ["haskell", "optimization", "ghc"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1457189583, "post_id": 35815503, "comment_id": 59298710, "body": "Are you 100% sure it&#39;s an optimization at all? I&#39;ve always thought that Core&#39;s <code>case</code> statement was limited to perform one pattern match at a time, and thus this kind of nested <code>case</code>s is necessary when handling multiple patterns in a definition."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1457189716, "post_id": 35815503, "comment_id": 59298771, "body": "Oh hmm, I swear it generated something else without optimization. But now that I&#39;m trying to reproduce, it doesn&#39;t anymore. Let me check..."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457221509, "post_id": 35815694, "comment_id": 59309885, "body": "This doesn&#39;t fully explain it, I don&#39;t think. Case-of-case only comes into play because <code>max</code> and <code>min</code> are inlined. I believe you could interrupt this by defining <code>{-# NOINLINE max&#39; #-}</code> <code>max&#39; :: Int -&gt; Int -&gt; Int</code> <code>max&#39; = max</code> and similarly for <code>min</code> and using those."}], "tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 5, "last_activity_date": 1457190423, "creation_date": 1457190423, "answer_id": 35815694, "question_id": 35815503, "link": "https://stackoverflow.com/questions/35815503/what-ghc-optimization-is-responsible-for-duplicating-case-expressions/35815694#35815694", "title": "What GHC optimization is responsible for duplicating case expressions?", "body": "<p>After some research, I've found that the optimization responsible for this is the so called \"case-of-case\" transformation, that GHC does presumably in the simplifier, so it cannot be deactivated (since it is necessary for a lot of what GHC does and the simplifier is an integral part of GHC's optimization pipeline).</p>\n\n<p>The following link explains how case of case leads to the duplication: <a href=\"http://lambda.jstolarek.com/2013/01/taking-magic-out-of-ghc-or-tracing-compilation-by-transformation/\" rel=\"noreferrer\">http://lambda.jstolarek.com/2013/01/taking-magic-out-of-ghc-or-tracing-compilation-by-transformation/</a></p>\n\n<p>In particular, case-of-case turns this:</p>\n\n<pre><code>case ( \n  case C of \n      B1 -&gt; F1\n      B2 -&gt; F2\n ) of\n    A1 -&gt; E1\n    A2 -&gt; E2\n</code></pre>\n\n<p>into the following:</p>\n\n<pre><code>case C of    \n    B1 -&gt; case F1 of\n              A1 -&gt; E1\n              A2 -&gt; E2\n    B2 -&gt; case F2 of\n              A1 -&gt; E1\n              A2 -&gt; E2\n</code></pre>\n\n<p>where the outer case has been duplicated and pushed into the branches.</p>\n"}], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 35815694, "answer_count": 1, "score": 7, "last_activity_date": 1457190423, "creation_date": 1457189408, "last_edit_date": 1457190275, "question_id": 35815503, "link": "https://stackoverflow.com/questions/35815503/what-ghc-optimization-is-responsible-for-duplicating-case-expressions", "title": "What GHC optimization is responsible for duplicating case expressions?", "body": "<p>Given the following code:</p>\n\n<pre><code>{-# OPTIONS_GHC -funbox-strict-fields #-}\nmodule Test where\n\ndata X = X !Int !Int\n\ntest (X a b) (X c d) = X (max a c) (max b d)\n</code></pre>\n\n<p>GHC generates this core when compiling with optimizations (renamed to make reading easier):</p>\n\n<pre><code>test\ntest =\n  \\ u v -&gt;\n    case u of x { X y z -&gt;\n    case v of c { X d e -&gt;\n    case tagToEnum# (&lt;=# y d) of _ {\n      False -&gt;\n        case tagToEnum# (&lt;=# z e) of _ {\n          False -&gt; x;\n          True -&gt; X y e\n        };\n      True -&gt;\n        case tagToEnum# (&lt;=# z e) of _ {\n          False -&gt; X d z;\n          True -&gt; c\n        }\n    }\n    }\n    }\n</code></pre>\n\n<p>Note how GHC has generated in total <strong>4</strong> different code paths. In general, the number of code paths grows exponentially with the number of conditions. </p>\n\n<p>What GHC optimization leads to that behavior? Is there a flag to control this optimization? In my case, this generates huge code bloat, and makes core dumps very hard to read because of deeply nested case expressions.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457188894, "post_id": 35815377, "comment_id": 59298492, "body": "<code>foo</code>, <code>bar</code>, <code>...</code> - I guess you&#39;ll have to try to put it into some more words - I see no way to actually find the question or the problem here as obviously this will not compile"}, {"owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457189906, "post_id": 35815377, "comment_id": 59298844, "body": "Thank you, I added some more explanation."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 1, "creation_date": 1457192734, "post_id": 35815377, "comment_id": 59299813, "body": "You will have to keep extracting the constituent parts of the <code>DnsMessage</code> and serialising the primitive types they are made out up of (<code>Bool</code>, <code>Int</code>, ...). Do you need to serialise it to a particular binary format, or are you also in control of the deserialiser too?"}, {"owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "edited": false, "score": 0, "creation_date": 1457199276, "post_id": 35815377, "comment_id": 59302369, "body": "Yes I do need to serialize this to a particular binary format because I am writing a DNS cache client program, and Yes I am in control of the deserializer."}], "owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457199401, "creation_date": 1457188635, "last_edit_date": 1457199401, "question_id": 35815377, "link": "https://stackoverflow.com/questions/35815377/how-to-use-data-binary-bitput", "title": "How to use Data.Binary.BitPut", "body": "<p>I want to pack data (:: <a href=\"https://hackage.haskell.org/package/dns-2.0.1/docs/Network-DNS-Types.html#g:5\" rel=\"nofollow\">DnsMessage</a>) into ByteString. From a little web search, I learned I can pack data like Bool or Int into ByteString by using Data.Binary.BitPut Library. Now I'm struggling with passing an argument.</p>\n\n<p>This code works fine.</p>\n\n<pre><code>import qualified Data.Binary.BitPut as BP\nimport qualified Data.ByteString.Internal as BSI\n\nmain :: IO()\nmain = do\n  let res = BP.runBitPut makePacket\n  print res\n\nmakePacket :: BP.BitPut\nmakePacket = do\n  BP.putBit True\n  BP.putNBits 7 $ BSI.c2w 'A'\n  BP.putByteString $ BS.pack $ map BSI.c2w \"AAAA\"\n</code></pre>\n\n<p>Now I want to do like this.</p>\n\n<pre><code>defaultQuery :: DnsMessage\n\nmain :: IO()\nmain = do\n  let res = defaultQuery BP.runBitPut makePacket\n  print res\n\nmakePacket :: DnsMessage -&gt; BP.BitPut\nmakePacket msg = do\n  BP.putBit $ foo msg\n  BP.putNBits 5 $ bar msg\n  BP.putByteString ...\n</code></pre>\n\n<p>How can I make this work ?</p>\n\n<p><a href=\"https://hackage.haskell.org/package/binary-strict-0.4.8.3/docs/Data-Binary-BitPut.html\" rel=\"nofollow\">https://hackage.haskell.org/package/binary-strict-0.4.8.3/docs/Data-Binary-BitPut.html</a></p>\n\n<pre><code>data DnsMessage = DnsMessage {\n  header      :: DnsHeader,\n  question    :: DnsQuestion,\n  answer      :: [DnsResourceRecord],\n  authority   :: [DnsResourceRecord],\n  additional  :: [DnsResourceRecord]\n}\n\ndata DnsHeader = DnsHeader {\n  mid     :: Word16,\n  flags   :: DnsFlags,\n  qdcount :: Word16,\n  ancount :: Word16,\n  nscount :: Word16,\n  arcount :: Word16\n}\n\ndata DnsFlags = DnsFlags {\n  isres   :: Bool,\n  opcode  :: Word8,\n  aa      :: Bool,\n  tc      :: Bool,\n  rd      :: Bool,\n  ra      :: Bool,\n  z       :: Word8,\n  rcode   :: Word8\n}\n\ndata DnsQuestion = DnsQuestion {\n  qname   :: [Word8],\n  qtype   :: Word16,\n  qclass  :: Word16\n}\n\n--The answer, authority, and additional sections all share this format\ndata DnsResourceRecord = DnsResourceRecord {\n  rrname        :: [Word8],\n  rrtype        :: Word16,\n  rrclass       :: Word16,\n  rrttl         :: Word32,\n  rdatalength   :: Word16,\n  rdata         :: [Word8]\n}\n</code></pre>\n"}, {"tags": ["haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457187445, "post_id": 35815096, "comment_id": 59298032, "body": "maybe you should at least link to your previous question (<a href=\"https://stackoverflow.com/questions/35684605/function-that-gets-an-int-and-returns-a-list\">this one</a> right?) - but depending on if your <code>imapF</code> and <code>singleF</code> are correct this seems to be ok - maybe you could argue that you want to return empty buckets for ever other integer in <code>singleE&#39;</code> (not making it partial) but that might depend on your specs here"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1457187890, "post_id": 35815096, "comment_id": 59298177, "body": "What do you mean by <i>correct</i>? What you say makes sense and the functions typecheck and everything, so I&#39;d say <i>there&#39;s nothing wrong</i> here. But to discuss whether it&#39;s <i>right</i>, you&#39;d need to specify what you&#39;re actually trying to achieve. \u2014 What I&#39;d remark already is that this kind of container will exhibit subpar performance in many circumstances, but for some applications it may do pretty well."}, {"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457188886, "post_id": 35815096, "comment_id": 59298487, "body": "@Carsten @leftaroundabout I&#39;ve updated the question, with instructions I&#39;ve got on plusE, and another function called timesE, because of the instructions I feel like I didn&#39;t understand the type of <code>Enumeration</code> correctly."}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1457226278, "post_id": 35815096, "comment_id": 59310969, "body": "@leftaroundabout, @EliBraginskiy I have the feeling whomever is giving these exercises is trying to build up to some constructive proofs that sum types and product types preserve enumerability/countability, e.g. prove from enumerations of the natural numbers that you can enumerate rational numbers. That&#39;s probably why you have <code>k + j = i</code> (the classic counting method of rational numbers)."}], "answers": [{"comments": [{"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 0, "creation_date": 1457189633, "post_id": 35815427, "comment_id": 59298733, "body": "If I understand, <code>enumerationToLists</code> should give you the same list for every number? so you get an infinite list of lists, but they are all the same list? (As I wrote in question 3)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 0, "creation_date": 1457189784, "post_id": 35815427, "comment_id": 59298791, "body": "@EliBraginskiy No. For each index <code>i</code> it returns whatever value <code>f i</code> is.  For example an enumeration could be <code>f = \\i -&gt; case i of 0 -&gt; []; 1 -&gt; [1], 2 -&gt; [2], _ -&gt; []</code> and <code>enumerationToLists f = [[], [1], [2], [], [], ....]</code>   Take <i>any</i> list of lists, i.e. <code>[[1,2,3], [1,2], [3]]</code> then <code>listsToEnumeration [[1,2,3], [1,2], [3]]</code> returns an equivalent <code>Enumeration</code>.   So definitely <code>Enumeration</code> is just a different representation for lists of lists, and the formal proof is in this answer: there is a bijection between the two."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 0, "creation_date": 1457190560, "post_id": 35815427, "comment_id": 59299071, "body": "@EliBraginskiy I don&#39;t know. I didn&#39;t read that tutorial and thus I have no idea what the author  wants you to do.  Obviously if you impose that an <code>Enumeration</code> is always empty except for the index <code>0</code> you get something that resembles flat lists... with a lot of redundant stuff. Is this text freely available somewhere?"}, {"owner": {"reputation": 4685, "user_id": 5180989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gxpck.jpg?s=128&g=1", "display_name": "Helder Pereira", "link": "https://stackoverflow.com/users/5180989/helder-pereira"}, "edited": false, "score": 0, "creation_date": 1457195655, "post_id": 35815427, "comment_id": 59300971, "body": "Just as a side note, you could have used <code>repeat []</code> instead of writing the function <code>empties</code>."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 2, "last_activity_date": 1457190614, "last_edit_date": 1457190614, "creation_date": 1457188954, "answer_id": 35815427, "question_id": 35815096, "link": "https://stackoverflow.com/questions/35815096/not-sure-i-understand-this-type-in-haskell/35815427#35815427", "title": "Not sure I understand this type in Haskell", "body": "<p>We can prove that <code>Enumeration a</code> is (mostly) isomorphic to lists of lists.\nThe \"isomorphism\" is given by the following functions:</p>\n\n<pre><code>enumerationToLists :: Enumeration a -&gt; [[a]]\nenumerationToLists f = map f [0..]\n\nlistsToEnumeration :: [[a]] -&gt; Enumeration a\nlistsToEnumeration xss i = head $ drop i (xss++empties)\n</code></pre>\n\n<p>Where:</p>\n\n<pre><code>empties :: [[a]]\nempties = []:empties\n</code></pre>\n\n<p>Thanks to referential transparency we can use \"equational reasoning\" as done in mathematics to prove that they form indeed an \"isomorphism\"</p>\n\n<p>Proof that <code>listsToEnumeration . enumerationToLists = id</code>:</p>\n\n<pre><code>    (listsToEnumeration . enumerationToLists) f\nby definition of .\n    = listsToEnumeration (enumerationToLists f)\nby definition of enumerationToLists\n    = listsToEnumeration (map f [0..])\nby definition of map\n    = listsToEnumeration [f 0, f 1, f 2, ...]\nby definition of listsToEnumeration\n    = \\i -&gt; head $ drop i ([f 0, f 1, f 2, ...]++empties)\nconcatenation of infinite lists\n    = \\i -&gt; head $ drop i [f 0, f 1, f 2, ...]\nby definition of drop and of the argument\n    = \\i -&gt; head $ [f i, f (i+1), f (i+2), ...]\nby definition of head\n    = \\i -&gt; f i\neta reduction  (i.e. \\x -&gt; f x = f)\n    = f\n</code></pre>\n\n<p>And now that, given <code>xss = [xs1, xs2, ..., xsN]</code> and <code>empties = []:empties</code>, we have <code>(enumerationToLists . listsToEnumeration) (xss++empties) = xss++empties</code></p>\n\n<pre><code>    (enumerationToLists . listsToEnumeration) (xss++empties)\nby definition of .\n    = enumerationToLists (listsToEnumeration (xss++empties))\nby definition of listsToEnumeration\n    = enumerationToLists (\\i -&gt; head $ drop i (xss++empties++empties))\nconcatenation of infinite lists\n    = enumerationToLists (\\i -&gt; head $ drop i (xss++empties))\nby definition of empties\n    = enumerationToLists (\\i -&gt; head $ drop i [xs1, xs2, ..., xsN, [], [], ...])\nby definition of enumerationToLists\n    = map (\\i -&gt; head $ drop i [xs1, xs2, ..., xsN, [], [], ...]) [0..]\nby definition of map\n    = let f = (\\i -&gt; head $ drop i [xs1, xs2, ..., xsN, [], [], ...]) in [f 0, f 1, ...]\nby definition of f\n    = [head $ drop 0 [xs1, xs2, ..., xsN, [], ...], head $ drop 1 [xs1, xs2, ..., xsN, [], ...], ...]\nby definition of drop\n    = [head [xs1, xs2, xsN, [], ...], head [xs2, ... xsN, [], ..], ..., head [xsN, [],...], head [[], ...], ..]\nby definition of head\n    = [xs1, xs2, ..., xsN, [], [], ...]\nby definition of xss, empties and ++\n    = xss ++ empties\n</code></pre>\n\n<p>Obviously we have assumed that <code>Enumeration a</code> is total (it should return <code>[]</code> for \"non defined indices\"). The two functions above are an isomorphism if we restrict to infinite lists of list, otherwise it only holds \"up to <code>++empties</code>\" (if <code>xss</code> is infinite we have <code>xss = xss++empties</code> because we will never be able to access the empties part).</p>\n\n<p>So if you care to maintain this \"isomorphism\" you should make sure that all your functions are total (looking at <code>singleE'</code>...), but except for this they look fine.</p>\n\n<p>I hope the example above gives you an hint on how to reason about whether or not the functions you define are correct.</p>\n"}], "owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 35815427, "answer_count": 1, "score": 2, "last_activity_date": 1457473789, "creation_date": 1457186802, "last_edit_date": 1495540228, "question_id": 35815096, "link": "https://stackoverflow.com/questions/35815096/not-sure-i-understand-this-type-in-haskell", "title": "Not sure I understand this type in Haskell", "body": "<p>Ok , So to continue <a href=\"https://stackoverflow.com/questions/35684605/function-that-gets-an-int-and-returns-a-list\">my previous</a> <a href=\"https://stackoverflow.com/questions/35688404/get-function-as-parameter-in-haskell\">questions</a>, I have a type called <code>Enumeration</code>, It is described as </p>\n\n<blockquote>\n  <p>Now, an enumeration is an infinite sequence of finite buckets,\n  indexed by natural numbers</p>\n</blockquote>\n\n<p>And defined as so:</p>\n\n<pre><code>&gt; type Nat = Int \n&gt; type Enumeration a = Nat -&gt; Finite a\n</code></pre>\n\n<p>this is a <code>Finite Bucket</code></p>\n\n<pre><code>&gt; type Finite a = [a]\n</code></pre>\n\n<p>So if I understand correctly, an <code>Enumeration</code> is something like a list of lists? it is a function from an Int to a list, and it should take an int like an index, and return a list.</p>\n\n<p>But what I can't understand is if it is indeed a list of lists, where does it store it \"lists\" so it can later return them with the <code>index</code> I provide.</p>\n\n<p>I've defined some functions over this <code>Enumeration</code> type, but I'm not sure if they are correct because I'm not sure if I understand what <code>Enumeration</code> really is.</p>\n\n<p>For example:</p>\n\n<p>Define a function to make a singleton enumeration.\nI suggest for simplicity that you put the sole item in bucket 0.</p>\n\n<pre><code>&gt; singleE' :: a -&gt; Enumeration a\n&gt; singleE' a 0 = singleF a\n</code></pre>\n\n<p>Define mapping over enumerations:</p>\n\n<pre><code>&gt; imapE :: (a -&gt; b) -&gt; Enumeration a -&gt; Enumeration b\n&gt; imapE f g = (imapF f) . g\n</code></pre>\n\n<p>Define disjoint union of enumerations:</p>\n\n<blockquote>\n  <p>For simplicity, you can do this bucket by bucket: the items in bucket i of the result enumeration should be drawn from buckets i of\n  the two argument enumerations.</p>\n</blockquote>\n\n<pre><code>&gt; plusE :: Enumeration a -&gt; Enumeration b -&gt; Enumeration (Either a b)\n&gt; plusE f g = \\n -&gt; [Left x | x &lt;- f n] ++ [Right y | y &lt;- g n]\n</code></pre>\n\n<p>Define cartesian product of enumerations</p>\n\n<blockquote>\n  <p>This is trickier, because you can\u2019t do it bucket by bucket any more,\n  as you did for plusE (why not?). The simplest technique is to perform\n  a kind of convolution: the items in bucket i of the result enumeration\n  should be con- structed from those in bucket j of the first argument\n  and in bucket k of the second, where j + k = i.</p>\n</blockquote>\n\n<pre><code>&gt; timesE :: Enumeration a -&gt; Enumeration b -&gt; Enumeration (a,b)\n&gt; timesE f g = \\n -&gt; timesF (f n) (g n)\n</code></pre>\n\n<p>So my questions are:</p>\n\n<ol>\n<li><p>Did I understand the type of <code>Enumeration</code> correctly</p></li>\n<li><p>If I did, are the functions I defined correct?</p></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 5, "creation_date": 1457175908, "post_id": 35813257, "comment_id": 59294644, "body": "You mean <code>_foldr (+) 0 [1]</code>? Also you are missing the pattern for when the list passed is empty. Also you keep padding <code>z</code> around ignoring the result of <code>(op)</code>. That function seems to always return the accumulator you passed."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1457176181, "post_id": 35813257, "comment_id": 59294712, "body": "the error there is just because of the <code>+</code> vs <code>(+)</code> problem Shoe mentioned - the other part would have bitten you at runtime"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1457176418, "post_id": 35813257, "comment_id": 59294794, "body": "of course it is - you still have <code>_foldr + </code> instead of  <code>_foldr (+)</code>! - if you want to pass an operator as a function you have to wrap it in <code>(..)</code> - just like you can make a function into an operator by writing <code>x `op` ..</code> (as you did now)"}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1457177117, "post_id": 35813257, "comment_id": 59295028, "body": "Thank you, you alright. But, I can&#39;t understand why: _foldr op z (x:xs) = x  <code>op</code> _foldr op z xs is correct and why _foldr op z (x:xs) = x  op _foldr op z xs is not correct"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1457177590, "post_id": 35813257, "comment_id": 59295166, "body": "Haskell has two kind of names: operators (like <code>+</code>, <code>*</code>, <code>%</code> etc.) and <code>other_names</code>.  Operators are considered infix by default and you must use sections, i.e. <code>(+)</code>, to use them in prefix form. The <code>other_names</code> do the opposite: by default they are considered prefix and you use backticks as in <code>\u200b`op`\u200b</code> to make them prefix. So <code>f op z</code> is parsed as a call to <code>f</code> with two arguments <code>op</code> and <code>z</code>, while <code>f `op` z</code> is parsed as operator <code>\u200b`op`\u200b</code> apply to two arguments <code>f</code> and <code>z</code>.  Conversely for <code>+</code>: <code>f + z</code> is parsed as <code>+</code> applied to <code>f</code> and <code>z</code> while <code>f (+) z</code> is a call to <code>f</code>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1457177891, "post_id": 35813257, "comment_id": 59295235, "body": "(If you are asking how I typed the backticks-inside backs in the comment above note that you can use triple backticks for inline code that contains backticks, however if you have a piece of code that starts with a backtick (thus you&#39;d have 4 backticks in a row) you must add something in-between such as a zero-width unicode 0x200b character. a normal space doesn&#39;t seem to work.)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1457178885, "post_id": 35813257, "comment_id": 59295519, "body": "@Bakuriu it works with two backticks at the start too - you basically have to start with more backticks than you want to display ;)"}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 4, "creation_date": 1457180453, "post_id": 35813815, "comment_id": 59295989, "body": "What fixed the error was adding parentheses around <code>+</code>, not adding the <code>::Int</code>. <code>_foldr (+) 0 [1]</code> works fine."}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 0, "last_activity_date": 1457179071, "creation_date": 1457179071, "answer_id": 35813815, "question_id": 35813257, "link": "https://stackoverflow.com/questions/35813257/ambiguity-of-types-in-haskell/35813815#35813815", "title": "Ambiguity of types in Haskell", "body": "<p>Regardless of whether your _foldr method does what you want, you can fix the issue in the question (no instance for (Num t0)), not by changing the signature of your function (you're right, this function can stay polymorphic), but by specifying what type you want to use for the call in GHCi. GHCi doesn't know what Num type you want when you typed <code>1</code>; do you want integers, or double? So you can annotate the 1 with a type to indicate, something like</p>\n\n<pre><code>_foldr (+) 0 [1::Int]\n</code></pre>\n\n<p>To work with Ints, for example.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 35813815, "answer_count": 1, "score": 0, "last_activity_date": 1457179071, "creation_date": 1457175638, "last_edit_date": 1457176269, "question_id": 35813257, "link": "https://stackoverflow.com/questions/35813257/ambiguity-of-types-in-haskell", "title": "Ambiguity of types in Haskell", "body": "<pre><code>_foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b  \n_foldr op z [] = z\n_foldr op z (x:xs) = x  `op` _foldr op z xs\n</code></pre>\n\n<p>Hi, let's consider above code.\nAfter:</p>\n\n<pre><code>ghci&gt; _foldr + 0 [1]\n</code></pre>\n\n<p>I got error:</p>\n\n<pre><code>   No instance for (Num t0) arising from the literal `1'\n    The type variable `t0' is ambiguous\n    Possible fix: add a type signature that fixes these type variable(s)\n    Note: there are several potential instances:\n      instance Num Double -- Defined in `GHC.Float'\n      instance Num Float -- Defined in `GHC.Float'\n      instance Integral a =&gt; Num (GHC.Real.Ratio a)\n        -- Defined in `GHC.Real'\n      ...plus three others\n</code></pre>\n\n<p>Basically I understand  what it means and I suppose that changing of signature of function can repair that. </p>\n\n<p>But, I don't want change a signature. How to solve it in another way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 5, "creation_date": 1457173228, "post_id": 35812865, "comment_id": 59293796, "body": "<a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\"><code>readMaybe</code></a> ;) ... you can always <a href=\"https://www.haskell.org/hoogle/?hoogle=String+-%3E+Maybe+a\" rel=\"nofollow noreferrer\">Hoogle</a> for those (although <a href=\"http://hayoo.fh-wedel.de/?query=Read+a+%3D%3E+String+-%3E+Maybe+a\" rel=\"nofollow noreferrer\">Hayoo</a> does better here)"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1457173385, "post_id": 35812865, "comment_id": 59293847, "body": "@Carsten Why doesn&#39;t <code>readMaybe</code> show up in the Hoogle results for that query though?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1457173471, "post_id": 35812865, "comment_id": 59293880, "body": "@ChrisMartin I have honestly no clue - seems Hoogle does not <i>see</i> <code>Text.Read</code> even though it&#39;s in base"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1457173737, "post_id": 35812865, "comment_id": 59293955, "body": "An alternative answer, if you don&#39;t want to use <code>Text</code>, is given by <a href=\"https://hackage.haskell.org/package/cgi-3001.3.0.0/docs/src/Network-CGI-Protocol.html#maybeRead\" rel=\"nofollow noreferrer\">the first Hoogle result</a>: <code>maybeRead = fmap fst . listToMaybe . reads</code>"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1457173903, "post_id": 35812865, "comment_id": 59294003, "body": "There&#39;s things like <code>Hoogle</code>?! Oh.... thanks guys"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1457173948, "post_id": 35812865, "comment_id": 59294011, "body": "yeah - but it&#39;s better to look for it on Bing ;) ... Google will just think that you misspelled it&#39;s name ^^"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1457174003, "post_id": 35812865, "comment_id": 59294039, "body": "@ChrisMartin They may have cached the <code>base</code> package a long time ago, any function marked as <code>Since 4.6.*.*</code> won&#39;t show up."}], "answers": [{"comments": [{"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1457175618, "post_id": 35812963, "comment_id": 59294552, "body": "and <code>readEither</code> which will give you the reason why it failed (parse error)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1457175888, "post_id": 35812963, "comment_id": 59294634, "body": "well <code>Left &quot;Prelude.read: no parse&quot;</code> might not be as surprising here ^^ (and yes it might be ambiguous too but I never saw this <i>in the wild</i>)"}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1457176538, "post_id": 35812963, "comment_id": 59294836, "body": "oh, I guess I never really checked what Left was :) good to know, thanks!"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1457187370, "post_id": 35812963, "comment_id": 59298017, "body": "@Carsten It can also be <code>Left &quot;Prelude.read: ambiguous parse&quot;</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1457187526, "post_id": 35812963, "comment_id": 59298066, "body": "@PyRulez yes that was my comment in (...) - but as I said: I never saw this actually happen - and I think there was an question here or on reddit where nobody could produce one with the usual <code>Read</code> instances as well (last time I checked - but probably some smart guy found some way)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1457173740, "creation_date": 1457173740, "answer_id": 35812963, "question_id": 35812865, "link": "https://stackoverflow.com/questions/35812865/is-there-an-alternative-to-read-that-returns-maybe/35812963#35812963", "title": "Is there an alternative to `read` that returns Maybe?", "body": "<p>There is <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow\"><code>readMaybe</code></a> right in <code>Text.Read</code> which should do exactly what you asked for:</p>\n\n<pre><code>Prelude&gt; import Text.Read(readMaybe)\nPrelude Text.Read&gt; readMaybe \"3241\" :: Maybe Int\nJust 3241\nPrelude Text.Read&gt; readMaybe \"Hello\" :: Maybe Int\nNothing\n</code></pre>\n"}], "owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 35812963, "answer_count": 1, "score": 1, "last_activity_date": 1457173740, "creation_date": 1457173064, "last_edit_date": 1457173505, "question_id": 35812865, "link": "https://stackoverflow.com/questions/35812865/is-there-an-alternative-to-read-that-returns-maybe", "title": "Is there an alternative to `read` that returns Maybe?", "body": "<p>I'm trying to get a number from IO like this:</p>\n\n<pre><code>numberString &lt;- getLine\nprint 3 + read numberString\n</code></pre>\n\n<p>This works if <code>numberString</code> is a good string of number (like \"3241\"), but when it's not something that good (like \"124gjh\"), it throws an exception:</p>\n\n<pre><code>*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>There's a <code>reads</code> function which returns a <code>[(a0, String)]</code> and when nothing is matched this would be a <code>[]</code>. Is there an easy way that I have something like this:</p>\n\n<pre><code>read' :: String -&gt; Maybe a\n</code></pre>\n\n<p>so that I just get a <code>Nothing</code> if things doesn't work instead of just stopping abruptly?</p>\n"}]