[{"tags": ["haskell", "vector", "parallel-processing"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1513813561, "post_id": 47915883, "comment_id": 82799893, "body": "What exactly doesn&#39;t work here? Is there an error? If so please write it here."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1513814096, "post_id": 47915883, "comment_id": 82800022, "body": "Consider using the <a href=\"https://hackage.haskell.org/package/vector-strategies-0.4/docs/Data-Vector-Strategies.html\" rel=\"nofollow noreferrer\">vector strategies</a> package."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1513820835, "post_id": 47915883, "comment_id": 82801633, "body": "@ThomasM.DuBuisson Why is there a need for a package here? The package has exactly one function, whose body is one line long..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1513829563, "post_id": 47915883, "comment_id": 82803532, "body": "@Alec The need for a package is because the question comes up.  I&#39;m not saying the question shouldn&#39;t come up - it&#39;s a great question - but if people want to get something that works and delay understanding for another day then the package helps."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1513857244, "post_id": 47915883, "comment_id": 82816360, "body": "@Alec wow, the implementation of <code>parVector</code> is rather dumb. But I think this could be improved to something that makes proper use of the tight array structure. <code>parMapVec</code> could actually also be done on unboxed vectors, though I&#39;m not sure if it would require manual concurrency juggling, perhaps <code>unsafeDupablePerformIO</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513857742, "post_id": 47915883, "comment_id": 82816637, "body": "@ThomasM.DuBuisson have you checked that converting to and from a list actually gives sensible performance? I doubt it is acceptable, unless the computation time is completely dominated by the calculations for the individual elements (but in that case, you could just as well simply <i>work with lists</i>, rather than vectors)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513884174, "post_id": 47915883, "comment_id": 82831778, "body": "It was sensible for a target benchmark when I made it.  Patches welcome!"}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1513890638, "post_id": 47915883, "comment_id": 82834551, "body": "Am I being stupid, or is <code>Vector</code> from <code>vector</code> already a <code>Traversable</code>? <a href=\"https://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector.html#control.i:id:Vector:Traversable:5\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/vector-0.12.0.1/docs/&hellip;</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1513981537, "post_id": 47915883, "comment_id": 82866005, "body": "@lierdakil It&#39;s not you. Boxed vectors are traversable so for this question a parallel traversable strategy should work fine. Sometimes people want API&#39;s that work over all instances of <code>Data.Vector.Generic.Vector</code>, which would require something different."}], "answers": [{"tags": [], "owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "is_accepted": false, "score": 1, "last_activity_date": 1514009844, "last_edit_date": 1592644375, "creation_date": 1514009844, "answer_id": 47950263, "question_id": 47915883, "link": "https://stackoverflow.com/questions/47915883/parallel-mapping-over-vectors-in-haskell/47950263#47950263", "title": "Parallel mapping over vectors in Haskell", "body": "<p><code>Vector</code> is indeed an instance of <code>Taversable</code>, as pointed out by lierdakil. I thought that it wasn't because it isn't listed as an instance on the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html#t:Traversable\" rel=\"nofollow noreferrer\">Data.Traversable page.</a></p>\n<p>Knowing this, I ran some tests:</p>\n<pre><code>import Control.Parallel.Strategies\nimport Data.Vector as V\nimport Data.Maybe\n\nparMapVec :: (a -&gt; b) -&gt; Vector a -&gt; Vector b\nparMapVec f v = runEval $ evalTraversable rpar $ V.map f v\n\nrange :: Integer -&gt; Integer -&gt; Vector Integer\nrange x y\n  | x == y = x `cons` empty\n  | x &lt; y  = x `cons` (range (x + 1) y)\n  | x &gt; y  = (range x (y + 1)) `snoc` y\n\nfac :: Integer -&gt; Integer\nfac n\n  | n &lt; 2     = 1\n  | otherwise = n * (fac $ n - 1)\n\nmain :: IO ()\nmain = do\n  let result = runEval $ do\n        let calc = parMapVec fac $ 80000 `range` 80007\n        rseq calc\n        return calc\n  putStrLn $ show result\n</code></pre>\n<p>I compiled this with <code>ghc --make ParVectorTest.hs -threaded -rtsopts</code> and ran it with <code>./ParVectorTest -s</code> and found that</p>\n<pre><code>SPARKS: 8 (7 converted, 0 overflowed, 0 dud, 0 GC'd, 1 fizzled)\n\nINIT    time    0.001s  (  0.001s elapsed)\nMUT     time    5.460s  (  5.447s elapsed)\nGC      time   15.916s  ( 15.893s elapsed)\nEXIT    time    0.000s  (  0.000s elapsed)\nTotal   time   21.380s  ( 21.342s elapsed)\n</code></pre>\n<p>Which is good, except that I watched the process execute on my system monitor and saw that the cores were, instead of all calculating a factorial at the same time, trading off between computations.</p>\n<p>This is concerning, so I did a test where <code>main</code> was modified in the following way:</p>\n<pre><code>main = do\n  let result = runEval $ do\n        let calc = parMap rpar fac [80000..80007]\n        rseq calc\n        return calc\n  putStrLn $ show result\n</code></pre>\n<p>I compiled and ran in the same way to find that:</p>\n<pre><code>SPARKS: 16 (14 converted, 0 overflowed, 0 dud, 1 GC'd, 1 fizzled)\n\nINIT    time    0.001s  (  0.001s elapsed)\nMUT     time    5.412s  (  5.418s elapsed)\nGC      time   18.583s  ( 18.537s elapsed)\nEXIT    time    0.001s  (  0.000s elapsed)\nTotal   time   23.999s  ( 23.957s elapsed)\n</code></pre>\n<p>I'm not sure why there are were 16 sparks instead of 8, but I suppose that's besides the point. This version also demonstrated the same behavior of the computation being passed between processors instead of actually being performed in parallel.</p>\n<p>So, I've got a version of <code>parMap rpar</code> for vectors that is slightly faster, although the fact that neither the program using lists nor the one using vectors fully ran in parallel is concerning.</p>\n<p>EDIT: I should add that I ran the same test using my original version of <code>parMapVec</code> and all the sparks fizzled, although I can't explain why.</p>\n"}], "owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1514009844, "creation_date": 1513813287, "question_id": 47915883, "link": "https://stackoverflow.com/questions/47915883/parallel-mapping-over-vectors-in-haskell", "title": "Parallel mapping over vectors in Haskell", "body": "<p>I want a function that does for vectors what <code>parMap rpar</code> does for lists. Here's what I've got:</p>\n\n<pre><code>import Data.Vector\nimport Control.Parallel.Strategies\n\nparMapVec :: (a -&gt; b) -&gt; Vector a -&gt; Vector b\nparMapVec f = map (runEval . rpar . f)\n</code></pre>\n\n<p>I can't fully reason out how or why this will or won't work.</p>\n\n<p>Another solution might be to make <code>Vector</code> an instance of <code>Traversable</code> and then use <code>parTraversable</code>, but that seems like a lot of work just to get something like <code>parMap rpar</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1513812027, "post_id": 47915706, "comment_id": 82799487, "body": "what about symlinks?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1513812155, "post_id": 47915706, "comment_id": 82799521, "body": "You can stick an extra letter or two on the front. I don&#39;t think there&#39;s any real way around the need to match file names to module names."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513812282, "post_id": 47915706, "comment_id": 82799563, "body": "It might make sense to expand the lexical syntax to accommodate more module names, but I doubt anyone would care enough to think it worth the trouble to implement."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1513813416, "post_id": 47915706, "comment_id": 82799859, "body": "@HuStmpHrrr That&#39;s a detour slightly unsatisfactory, but I agree that can be one of the solutions."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513813933, "post_id": 47915706, "comment_id": 82799980, "body": "@dfeuer Then you say there&#39;s no direct method to handle this and <code>P03Caramel.hs</code> would be the best compromise. I can accept that as a answer."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1513814336, "post_id": 47915706, "comment_id": 82800078, "body": "I wonder what&#39;s supposed to be convenient about this naming scheme, anyway."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513819849, "post_id": 47915706, "comment_id": 82801378, "body": "@leftaroundabout For brevity?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513847467, "post_id": 47915706, "comment_id": 82810477, "body": "Um, it would be even briefer if you just omitted the prefix numbers..."}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 1, "last_activity_date": 1513861705, "creation_date": 1513861705, "answer_id": 47925715, "question_id": 47915706, "link": "https://stackoverflow.com/questions/47915706/can-i-use-number-prefix-in-haskell-source-file-name/47925715#47925715", "title": "Can I use number prefix in haskell source file name?", "body": "<p>You cannot start a Haskell module with a number as modules must start with a capital letter. <a href=\"https://en.wikibooks.org/wiki/Haskell/Modules#Modules\" rel=\"nofollow noreferrer\">(Source)</a></p>\n\n<p>You can have numbers in the filename as long as they are not first so <code>Apple01.hs</code> is just fine.</p>\n\n<p>Haskell files themselves do not have these restrictions, GHC will have no issues compiling <code>01-apple.hs</code>.</p>\n"}], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 47925715, "answer_count": 1, "score": 1, "last_activity_date": 1513861705, "creation_date": 1513811874, "question_id": 47915706, "link": "https://stackoverflow.com/questions/47915706/can-i-use-number-prefix-in-haskell-source-file-name", "title": "Can I use number prefix in haskell source file name?", "body": "<p>I tried solving programming problems with haskell.\nFor convenience, I used filename like <code>01-apple.hs</code>, <code>02-banana.hs</code>, <code>03-caramel.hs</code>.</p>\n\n<p>But I don't know how can I use these files as modules. Module identifiers are not likely to be prefixed with numbers. Can't I use these kind of filenames?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1016, "user_id": 8456454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f627dc7d8a375702876cbfc2a22f168?s=128&d=identicon&r=PG&f=1", "display_name": "gsquaredxc", "link": "https://stackoverflow.com/users/8456454/gsquaredxc"}, "edited": false, "score": 4, "creation_date": 1513810876, "post_id": 47915569, "comment_id": 82799188, "body": "Please attempt before asking someone to help. If you have code, please post it."}, {"owner": {"reputation": 388, "user_id": 6707099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-piJ3cVj_PMs/AAAAAAAAAAI/AAAAAAAAAGo/IynFN5k_OAI/photo.jpg?sz=128", "display_name": "oBit91", "link": "https://stackoverflow.com/users/6707099/obit91"}, "edited": false, "score": 0, "creation_date": 1513811000, "post_id": 47915569, "comment_id": 82799226, "body": "You can use regex, search this site for more info: <a href=\"https://docs.python.org/3/library/re.html\" rel=\"nofollow noreferrer\">docs.python.org/3/library/re.html</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513811149, "post_id": 47915569, "comment_id": 82799269, "body": "What is a &quot;special character&quot;? You should edit your within to explain properly. You may find some of the functions in <code>Data.Char</code> helpful."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 388, "user_id": 6707099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-piJ3cVj_PMs/AAAAAAAAAAI/AAAAAAAAAGo/IynFN5k_OAI/photo.jpg?sz=128", "display_name": "oBit91", "link": "https://stackoverflow.com/users/6707099/obit91"}, "edited": false, "score": 1, "creation_date": 1513811285, "post_id": 47915569, "comment_id": 82799296, "body": "@oBit91 regex is really not needed here and is generally rarely needed in Haskell."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 388, "user_id": 6707099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-piJ3cVj_PMs/AAAAAAAAAAI/AAAAAAAAAGo/IynFN5k_OAI/photo.jpg?sz=128", "display_name": "oBit91", "link": "https://stackoverflow.com/users/6707099/obit91"}, "edited": false, "score": 1, "creation_date": 1513811310, "post_id": 47915569, "comment_id": 82799303, "body": "@oBit91, while you probably <i>could</i>, that would definitely <i>not</i> be the idiomatic approach in Haskell."}, {"owner": {"reputation": 388, "user_id": 6707099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-piJ3cVj_PMs/AAAAAAAAAAI/AAAAAAAAAGo/IynFN5k_OAI/photo.jpg?sz=128", "display_name": "oBit91", "link": "https://stackoverflow.com/users/6707099/obit91"}, "edited": false, "score": 0, "creation_date": 1513811350, "post_id": 47915569, "comment_id": 82799311, "body": "I just realized this isn&#39;t the java forum.. my bad ._."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513811407, "post_id": 47915569, "comment_id": 82799322, "body": "@ReinHenrichs, well, regular expressions are pretty reasonable to use for lexing, Haskell or no."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1513813174, "creation_date": 1513813174, "answer_id": 47915863, "question_id": 47915569, "link": "https://stackoverflow.com/questions/47915569/how-can-i-remove-special-charactes-from-string-and-lowercase-it-and-return-it-as/47915863#47915863", "title": "How can i remove special charactes from string and lowercase it and return it as list in haskell", "body": "<p>I will not answer your question entirely, but I will give you some pointers using <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">hoogle</a>:</p>\n\n<ul>\n<li>How will we check for special characters? Maybe there's some function of type <a href=\"https://www.haskell.org/hoogle/?hoogle=%3A%3A+Char+-%3E+Bool\" rel=\"nofollow noreferrer\"><code>Char -&gt; Bool</code></a> that can help. Possibly <code>isAlphaNum</code>?</li>\n<li>How will we convert to lowercase? Maybe there's a function of type <a href=\"https://www.haskell.org/hoogle/?hoogle=%3A%3A+Char+-%3E+Char\" rel=\"nofollow noreferrer\"><code>Char -&gt; Char</code></a> that can help.</li>\n<li>How will we apply a function on just <code>Char</code>s to an entire <code>String</code>? Maybe there's a function of type <a href=\"https://www.haskell.org/hoogle/?hoogle=%3A%3A+%28Char+-%3E+Char%29+-%3E+String+-%3E+String\" rel=\"nofollow noreferrer\"><code>(Char -&gt; Char) -&gt; String -&gt; String</code></a>. Maybe there's a more general function that can help us?</li>\n<li>How will we split a string at special characters? This is a tough one, so I'll give you the function <a href=\"https://www.haskell.org/hoogle/?hoogle=%28Char+-%3E+Bool%29+-%3E+String+-%3E+%28String%2C+String%29\" rel=\"nofollow noreferrer\"><code>break :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])</code></a> for free.</li>\n</ul>\n\n<p>Now, given these functions, you can build the complete function you're looking for, by using recursion. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 781, "user_id": 5057805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9USavIbjP-M/AAAAAAAAAAI/AAAAAAAAADk/5fj7tZo247s/photo.jpg?sz=128", "display_name": "Paul Parker", "link": "https://stackoverflow.com/users/5057805/paul-parker"}, "is_accepted": false, "score": 3, "last_activity_date": 1513832072, "last_edit_date": 1513832072, "creation_date": 1513824527, "answer_id": 47917226, "question_id": 47915569, "link": "https://stackoverflow.com/questions/47915569/how-can-i-remove-special-charactes-from-string-and-lowercase-it-and-return-it-as/47917226#47917226", "title": "How can i remove special charactes from string and lowercase it and return it as list in haskell", "body": "<h2>Advice</h2>\n\n<p>First off, change your question. It currently reads as though you've been assigned homework and you want to take the shortest route to a grade. I would suggest wording it as \"<em>How do I approach simple problem solving in Haskell?</em>\" Then give your question as an exemplar of a problem that could be solved. The alternative is to take a hit to your reputation, remembering that even if you delete this question the bad reputation will still <a href=\"https://meta.stackoverflow.com/questions/255583/what-can-i-do-when-getting-we-are-no-longer-accepting-questions-answers-from-th\">haunt you</a>.</p>\n\n<h2>Problem Solving</h2>\n\n<h3><strong>First step:</strong> define the problem</h3>\n\n<p>Two things need to happen to that string.</p>\n\n<ol>\n<li>Convert all uppercase [A-Z] to lowercase [a-z]</li>\n<li>Select out any string of [a-zA-Z] into it's own substring, maintaining the order\n\n<blockquote>\n  <p>This merits the mention of a fundemental rule of any question answering scenario. Read the question, <strong>read the question</strong>, <em><strong>read the bloody question!</strong></em></p>\n</blockquote></li>\n</ol>\n\n<p>Looks pretty easy, doesn't it? Of course I am being a little disingenuous, because I selected those two things, and in that order, because I know it'll be easier that way. That's plain old knowledge of Haskell.</p>\n\n<h3>Divide and Conquer</h3>\n\n<p><em>How do we search for a solution to number 1?</em></p>\n\n<ul>\n<li>Do it by first principles</li>\n<li>Google or SOF search</li>\n<li>Hoogle it! I.e. search for a type signature.</li>\n</ul>\n\n<p><strong>Do it by first principles?</strong> No, not on a common problem like this. Sure, if you have some weird custom type and data structure, you'd be forced to. Though you would, if you chose your types carefully, have access to abstractions like Semigroup, Monoid, Functor, Applicative, etc., to make that job easier.</p>\n\n<p><strong>Google or SOF search?</strong> \u00a1S\u00ed, S\u00ed, Se\u00f1or! This is a good bet. Find someone who has already done the problem. Don't be an idiot! Of course look for an easy way first if it looks like an option. In this case, yes, there is an answer, and it's close at hand. <a href=\"https://stackoverflow.com/a/8700650/5057805\">SOF: Converting lowercase to uppercase</a>. Not an exact match, but it does not take a lot of imagination to change <code>toUpper</code> into <code>toLower</code>.</p>\n\n<pre><code># Give a monkey a fish...\nimport Data.Char (toLower)\n\nuncapitalize = map toLower\n</code></pre>\n\n<p><strong>Hoogle it?</strong>\nThis is a good solution, but you need to have a good grasp of type signatures (essential if you're working with Haskell) to use it effectively. I got the solution real fast by searching at <a href=\"https://www.haskell.org/hoogle/?hoogle=Char+-%3E+Char\" rel=\"nofollow noreferrer\">hoogle</a> with the following:</p>\n\n<pre><code>Char -&gt; Char\n</code></pre>\n\n<p>NOT <code>char -&gt; char</code>. The first is a type signature of a function that takes a concrete type Char and returns a concrete type Char. The second is the type signature of a function that take ANY type and returns that same type. The first is very specific, the second VERY general. Anyway, you've followed the link by now and you see that the function you were looking for was the first result. Amazing!</p>\n\n<pre><code>toLower :: Char -&gt; Char\n</code></pre>\n\n<p>Along with the module it is imported from. Noice! But still not as helpful as the SOF answer, since that scaffolds everything for a newbie.</p>\n\n<p>We're not done on this one yet. Just because two sources say that a thing is possible, doesn't mean that you can do it. Jump out to <code>ghci</code> to do some testing. Hopefully with <code>stack ghci</code>. Then from the ghci prompt <code>&gt;</code></p>\n\n<pre><code>toLower 'A'\n</code></pre>\n\n<p>will give you <code>'a'</code>. Where <code>'A' :: Char</code>. Good. Now to get <code>toLower</code> to work on a list. List brings to mind <code>map</code> immediately, but don't take my word for it. From <code>ghci</code>, try <code>:t map</code> and <code>:t toLower</code> to check their types and how you can <em>chuck</em> them together. You'll probably need to import <code>Data.Char</code> with <code>import Data.Char</code>. Now we're ready to do some <em>chucking and shoving</em><sup>1</sup>:</p>\n\n<pre><code>map toLower \"AnyThing\"\n</code></pre>\n\n<p>and it may or may not fail depending on if you have <code>:set -XOverloadedStrings</code> in ghci. To be sure, be explicit:</p>\n\n<pre><code>map toLower (\"I'm 25, working in Switzerland;;\" :: [Char])\n</code></pre>\n\n<p>and out pops <code>\"i'm 25, working in switzerland;;\"</code>. We're halfway done. By the way, <code>ghci</code> is a common way of working through problems in haskell. Shoving things together like a monkey is how we are wired. Embrace it. Indeed, why think when you can shove away in a consequence free environment? It's a no-brainer.</p>\n\n<p><strong>How do we search for a solution to number 2?</strong>\nThis is a tougher problem, but using the same search options we used above.</p>\n\n<p><strong>Do it by first principles?</strong> Yes, probably. Though lets search Google and SOF first.</p>\n\n<p>Luckily, it's a problem others have considered before. We get a <a href=\"https://stackoverflow.com/a/4981265/5057805\">general solution</a> for free. </p>\n\n<pre><code>wordsWhen     :: (Char -&gt; Bool) -&gt; String -&gt; [String]\nwordsWhen p s =  case dropWhile p s of\n                   \"\" -&gt; []\n                   s' -&gt; w : wordsWhen p s''\n                         where (w, s'') = break p s'\n</code></pre>\n\n<p>This is a general solution to our problem. It takes a predicate (hence the <code>p</code>) function <code>(Char -&gt; Bool)</code> and drops anything that matches it, and saves the rest. <code>break</code> works by breaking any chunk of <code>Char</code>s that <em>do not match the predicate</em> into <code>w</code> of the tuple <code>(w, s'')</code>.</p>\n\n<p>Note on convention: the apostrophe superscript in <code>s'</code> refers to <code>s'</code> being somehow derivative of, or coming from <code>s</code>.</p>\n\n<p>The function <code>wordsWhen</code> calls itself recursively on whatever remains of the string i.e. <code>s''</code>, until it is empty (the first case match).</p>\n\n<p><em>How do we test this in <code>ghci</code>?</em>\nI'm glad you asked. To enter a multi-line definition directly into <code>ghci</code> use this bracketing, <code>:{</code> begins the code block, and <code>:}</code> ends it. Or use <code>:set +m</code>. Both of which are outlined <a href=\"https://stackoverflow.com/a/8443096/5057805\">here</a>.</p>\n\n<p>Since the predicate chooses which characters to drop, the logical choice is for it to be <code>(not . isLower)</code>. You should have encountered <code>isLower</code> when rooting around in <code>Date.Char</code>. The <code>not</code> is logical negation, and the <code>.</code> is function composition.</p>\n\n<p>Therefore:</p>\n\n<pre><code>wordsWhen (not . isLower) \"i'm 25, working in switzerland;;\"\n</code></pre>\n\n<p>solves the second part. Resolving these two into a solution is a job for any monkey who can shove things together using <code>ghci</code>.</p>\n\n<hr>\n\n<p>[1]: Absolutely no one's formal definition of this activity.</p>\n"}], "owner": {"reputation": 1, "user_id": 9124795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0892b8c8e7b047f8206f84ef72d15439?s=128&d=identicon&r=PG&f=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/9124795/james-burton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1513832072, "creation_date": 1513810792, "question_id": 47915569, "link": "https://stackoverflow.com/questions/47915569/how-can-i-remove-special-charactes-from-string-and-lowercase-it-and-return-it-as", "title": "How can i remove special charactes from string and lowercase it and return it as list in haskell", "body": "<p>How can i remove special characters from string and lowercase it and return it as list in Haskell</p>\n\n<p>for example a sample string :</p>\n\n<pre><code>\"I'm 25, working in Switzerland;;\"\n</code></pre>\n\n<p>and get output like</p>\n\n<pre><code>['i','m','working','in','switzerland']\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1513810997, "post_id": 47915501, "comment_id": 82799225, "body": "You have to import <code>comparing</code> from <code>Data.Ord</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513811526, "post_id": 47915501, "comment_id": 82799350, "body": "Or import <code>Data.Function</code> and use <code>compare `on` snd</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1513813286, "post_id": 47915501, "comment_id": 82799818, "body": "Or use <code>sortOn snd</code>. Btw please don&#39;t use <code>sort</code> as a name for the argument on <code>sortOccurrences</code> as it is the name of a very common function, whereas here it is a list - highly confusing."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1513813365, "creation_date": 1513813365, "answer_id": 47915896, "question_id": 47915501, "link": "https://stackoverflow.com/questions/47915501/how-can-i-get-the-function-result-in-orderd-format-haskell/47915896#47915896", "title": "How can i get the function result in orderd format haskell", "body": "<p>As <a href=\"https://stackoverflow.com/users/2225384/rein-henrichs\">@ReinHenrichs</a> pointed out, this is simply a case of not importing <code>comparing</code> from <code>Data.Ord</code>. You can rectify this by adding this line at the top of your file:</p>\n\n<pre><code>import Data.Ord (comparing)\n</code></pre>\n\n<p>In general, when the compiler says <code>Variable not in scope (...)</code>, it  means that you've written something that the compiler doesn't know about, and in some way you have to make it aware of what you are referring to. Since <code>comparing</code> comes from the module <code>Data.Ord</code>, it's not imported by default.</p>\n"}], "owner": {"reputation": 1, "user_id": 9124771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35a2b97f42605a07f26dd9547237e81?s=128&d=identicon&r=PG&f=1", "display_name": "Jahi Tabu", "link": "https://stackoverflow.com/users/9124771/jahi-tabu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513813365, "creation_date": 1513810373, "question_id": 47915501, "link": "https://stackoverflow.com/questions/47915501/how-can-i-get-the-function-result-in-orderd-format-haskell", "title": "How can i get the function result in orderd format haskell", "body": "<p>I have two function first one take list</p>\n\n<p>List can be something like :</p>\n\n<pre><code>['Sunyy','day',etc','etc']\n\ncountOccurrences :: [String] -&gt; [(String, Int)]\ncountOccurrences xs = map (\\xs -&gt; (head xs, length xs)) . group . sort $ xs\n</code></pre>\n\n<p>this function returns something like <code>[(\"sunny\",1),(\"etc\",2)]</code></p>\n\n<p>But I want to call the sortOccurence function with the value that I got from the first function so I can get the value like : <code>[(\"etc\",2),(\"sunny\",2)]</code></p>\n\n<pre><code>sortOccurrences :: [(String, Int)] -&gt; [(String, Int)]\nsortOccurrences sort = sortBy (comparing snd) sort\n</code></pre>\n\n<p>while I execute this function I get an error like :</p>\n\n<pre><code>main.hs:13:32: error:\n    Variable not in scope:\n      comparing\n        :: ((a0, b0) -&gt; b0) -&gt; (String, Int) -&gt; (String, Int) -&gt; Ordering\n</code></pre>\n"}, {"tags": ["haskell", "atom-editor"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 3, "creation_date": 1513811468, "post_id": 47915421, "comment_id": 82799334, "body": "Is there any plugin to install that provides Haskell support? Maybe it&#39;s just not bundled."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 7, "last_activity_date": 1513812276, "creation_date": 1513812276, "answer_id": 47915766, "question_id": 47915421, "link": "https://stackoverflow.com/questions/47915421/atom-is-not-highlighting-haskell-syntax/47915766#47915766", "title": "Atom is not highlighting Haskell syntax?", "body": "<p>Haskell support unfortunately doesn't come packaged with atom. Use the <a href=\"https://atom.io/packages/language-haskell\" rel=\"noreferrer\"><code>language-haskell</code></a> package.</p>\n\n<p>The <a href=\"https://atom.io/packages/language-haskell\" rel=\"noreferrer\"><code>language-haskell</code></a> package, according to the page <em>'Adds syntax highlighting and snippets to Haskell files in Atom.'</em> It comes with support for <code>.hs</code>, <code>.lhs</code>, and <code>.cabal</code> files.</p>\n\n<p>You can find help on installing atom packages <a href=\"https://flight-manual.atom.io/using-atom/sections/atom-packages/\" rel=\"noreferrer\">here</a>.</p>\n\n<p>If you want to talk about adding Haskell support, or changing atom features, it seems that <a href=\"https://discuss.atom.io/\" rel=\"noreferrer\">the atom forum</a> would be the best place to do so.</p>\n"}], "owner": {"reputation": 968, "user_id": 6774746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/70d280e468a87e6efb7f21c92ff52bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Big Smile", "link": "https://stackoverflow.com/users/6774746/big-smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 0, "accepted_answer_id": 47915766, "answer_count": 1, "score": 6, "last_activity_date": 1513812276, "creation_date": 1513809821, "last_edit_date": 1513810210, "question_id": 47915421, "link": "https://stackoverflow.com/questions/47915421/atom-is-not-highlighting-haskell-syntax", "title": "Atom is not highlighting Haskell syntax?", "body": "<p>I am using Haskell in Atom text editor <code>version 1.23.1</code> on Mac. Other languages syntax is highlighted correctly but when I code in Haskell the text editor does not highlight the syntax correctly and shows it as plain text. I have tried searching for it and found that in Atom pressing <strong><em><code>ctrl-shift-L</code></em></strong> I can temporarily change the grammar. However, there is no option for Haskell as can be seen in the screenshot below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/OgBRK.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/OgBRK.png\" alt=\"No option for Haskell\"></a></p>\n\n<p>The screenshot below shows what I am expecting. </p>\n\n<p><a href=\"https://i.stack.imgur.com/g6LNY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/g6LNY.png\" alt=\"What I am expecting \"></a></p>\n\n<p>Is there anything that I might have done wrong? Can anyone give me a clear and easy solution to this problem. Thank you</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1513809305, "post_id": 47915300, "comment_id": 82798696, "body": "<i>&quot;Do I have to define separate functions (...)&quot;</i>  Yes. These are called <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow noreferrer\">smart constructors</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "edited": false, "score": 0, "creation_date": 1513810960, "post_id": 47915455, "comment_id": 82799214, "body": "Hi Rein, thank you for your answer. I added an addendum emphasizing that I am indeed interested in a general, idiomatic approach to do this in Haskell."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "edited": false, "score": 1, "creation_date": 1513811050, "post_id": 47915455, "comment_id": 82799247, "body": "Creating an <code>X</code> from a <code>Y</code> is what functions do. If you have an <code>X</code> and you want a <code>Y</code>, write a function of type <code>X -&gt; Y</code> and apply it to your <code>X</code>."}, {"owner": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "edited": false, "score": 0, "creation_date": 1513811451, "post_id": 47915455, "comment_id": 82799329, "body": "I haven&#39;t worked through the answers thoroughly yet, so maybe you already mentioned it, but what &quot;puts me off&quot; in the mere creation of functions is that they are not &quot;bundled&quot; with the type. I understand that the image of a functions creates a relation between the function and the type. Is that all there is?  The only other thing I can come up with is to also use a typeclass as a constraint. Maybe it&#39;s just the oo thinking that makes we want to bundle it all in one place."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "edited": false, "score": 1, "creation_date": 1513811745, "post_id": 47915455, "comment_id": 82799411, "body": "If that is what puts you off then the only solution is to stop thinking about it that way. &quot;Bundling the functions with the type&quot; is OOP thinking."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "edited": false, "score": 0, "creation_date": 1513811805, "post_id": 47915455, "comment_id": 82799430, "body": "(I mixed up my Xs and Ys a bit there, oops)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "edited": false, "score": 3, "creation_date": 1513811878, "post_id": 47915455, "comment_id": 82799447, "body": "This doesn&#39;t mean that there&#39;s no way of organizing similar functions and types together. That&#39;s what modules are for."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 2, "last_activity_date": 1513810065, "creation_date": 1513810065, "answer_id": 47915455, "question_id": 47915300, "link": "https://stackoverflow.com/questions/47915300/in-haskell-what-is-the-analogous-pattern-to-setting-up-objects-with-construct/47915455#47915455", "title": "In Haskell, what is the analogous pattern to setting up &quot;objects&quot; with constructors?", "body": "<p>In your example, <code>MyInteger</code> always contains an <code>int</code> but is sometimes constructed from a <code>String</code> by parsing the string into an int first. This is not equivalent to <code>data MyInteger = Integer Int | String String</code> but to <code>newtype MyInteger = MyInteger Int</code> with a <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow noreferrer\">smart constructor</a> for constructing from a string:</p>\n\n<pre><code>newtype MyInteger = MyInteger Int\n\nmkMyIntegerStr :: String -&gt; MyInteger\nmkMyIntegerStr = MyInteger . read\n</code></pre>\n\n<p>with the caveat that not all strings have a valid parse as an int and that acknowledging this failure mode in the type system would be more robust:</p>\n\n<pre><code>mkMyIntegerStr :: String -&gt; Maybe MyInteger\nmkMyIntegerStr = fmap MyInteger . readMaybe\n</code></pre>\n\n<p>with <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\"><code>readMaybe</code></a> from the <code>Text.Read</code> module.</p>\n\n<p>In general, though, I think it is best to approach Haskell with fresh eyes rather than to try to map familiar concepts from OOP onto it. Trying to treat FP as a weird form of OOP has lead many learners astray.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1513812060, "last_edit_date": 1513812060, "creation_date": 1513810267, "answer_id": 47915486, "question_id": 47915300, "link": "https://stackoverflow.com/questions/47915300/in-haskell-what-is-the-analogous-pattern-to-setting-up-objects-with-construct/47915486#47915486", "title": "In Haskell, what is the analogous pattern to setting up &quot;objects&quot; with constructors?", "body": "<p>Haskell programmers use the <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow noreferrer\">'smart constructor'</a> pattern to do this. To be clear, this isn't a design <em>choice</em>, this is a design <em>necessity</em>. It is simply not possible to do exactly what you do in your OOP example in Haskell.</p>\n\n<p>In fact, you can see this style in the <a href=\"http://hackage.haskell.org/package/text-1.2.2.2/docs/Data-Text.html\" rel=\"nofollow noreferrer\"><code>Data.Text</code></a> module. Here's the raw definition of the <code>Text</code> type:</p>\n\n<pre><code>data Text = Text\n    {-# UNPACK #-} !A.Array\n    {-# UNPACK #-} !Int\n    {-# UNPACK #-} !Int\n    deriving (Typeable)\n</code></pre>\n\n<p>I wouldn't want to touch that even if I were an expert. However, there is a nice little smart constructor right there: (though admittedly it doesn't perform checks)</p>\n\n<pre><code>pack :: String -&gt; Text\npack = unstream . S.map safe . S.streamList -- Scary internals handled cleanly.\n</code></pre>\n\n<p>But why don't we have this kind of object-oriented style built in? Because the internal workings of the constructor is hidden from you, you don't know exactly what might be going on when you write <code>new MyInteger(\"123\")</code>. This is in direct violation of one of Haskell's fundamental principles, <em>Referential Transparency</em>.</p>\n\n<p>So instead, a Haskell programmer would probably translate the above class as:</p>\n\n<pre><code>newtype MyInteger = MyInteger Integer\n\nparseMyInteger :: String -&gt; MyInteger\nparseMyInteger = -- (whatever implementation here)\n</code></pre>\n\n<p>In conclusion, forget object-oriented programming when writing Haskell (except if you're <a href=\"https://github.com/andorp/oo-haskell/blob/master/src/Store.hs\" rel=\"nofollow noreferrer\">being experimental</a>). Haskell has an entirely different paradigm, so use that instead of OOP concepts.</p>\n\n<hr>\n\n<p>Some optional reading: <a href=\"https://stackoverflow.com/questions/210835/what-is-referential-transparency\">What is referential transparency?</a></p>\n"}], "owner": {"reputation": 1462, "user_id": 502727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6c07fe787983eb74760c354b554ed90f?s=128&d=identicon&r=PG", "display_name": "problemofficer", "link": "https://stackoverflow.com/users/502727/problemofficer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1513812060, "creation_date": 1513809086, "last_edit_date": 1513810868, "question_id": 47915300, "link": "https://stackoverflow.com/questions/47915300/in-haskell-what-is-the-analogous-pattern-to-setting-up-objects-with-construct", "title": "In Haskell, what is the analogous pattern to setting up &quot;objects&quot; with constructors?", "body": "<p>In object oriented programming languages you often have multiple constructors that set up objects of a class, for example a <code>MyInteger</code> object could be constructed from an built-in int or a string:</p>\n\n<pre><code>class MyInteger {\n    int _value;\n\n    MyInteger (int value) {\n        _value = value;\n    }\n\n    MyInteger (String value) {\n        _value = String.parseInt(value);\n    }\n}\n</code></pre>\n\n<p><strong>What would be the idomatic way to do this in Haskell?</strong> As far as I understand in Haskell the sum type</p>\n\n<pre><code>data MyInteger = Integer Int | String String\n</code></pre>\n\n<p>is either an <code>Integer</code> or <code>String</code> and not a single type like in the oo-example above. And I can't define a logic for the value constructor <code>String</code> that would take a <code>String</code> and \"return\" a <code>MyInteger</code>.</p>\n\n<p>Do I have to define separate functions like this:</p>\n\n<pre><code>myIntegerFromString :: String -&gt; MyInteger\nmyintegerFromString inputString = ...&lt;parsing logic on inputString&gt;....\n</code></pre>\n\n<p>and then call it whenever I want to create a <code>MyInteger</code> from a string</p>\n\n<pre><code> main = do\n     ...\n     let aMyInteger = myIntegerFromString \"4\"\n     ...\n</code></pre>\n\n<p><strong>Addendum</strong>:\nThe creation of an \"object\" from <code>Int</code> and <code>String</code> was merely meant as a minimal example. I am more interested in the general approach of having variables of a type X that can be created from various other types Y,Z,... and how this would be solved in Haskell. Precisely because I don't want to misuse Haskell while thinking in object-oriented ways, I am asking for an idiomatic pattern to model this in Haskell. This is why a solution that solves the parsing of <code>Int</code>s from <code>String</code>s is too specific.</p>\n"}, {"tags": ["haskell", "time", "timestamp"], "answers": [{"tags": [], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1513807439, "creation_date": 1513807439, "answer_id": 47915000, "question_id": 47914893, "link": "https://stackoverflow.com/questions/47914893/haskell-convert-day-to-unix-timestamp/47915000#47915000", "title": "Haskell: convert Day to UNIX timestamp", "body": "<p>The solution I just came up with is to use <code>UTCTime day 0</code> to convert the day value back to time.</p>\n\n<pre><code>import Data.Time\n...\noneWeekAgo = toTimestamp . toTime . addDays (-7) &lt;$&gt; now\n  where now = utctDay &lt;$&gt; getCurrentTime\n        toTimestamp = formatTime defaultTimeLocale \"%s\"\n        toTime day = UTCTime day 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "edited": false, "score": 0, "creation_date": 1513868345, "post_id": 47916131, "comment_id": 82823360, "body": "The later is short and sweet, but can we get away with <code>7 * 24 * 60 * 60</code>? I like writing <code>-7</code> as it is immediately obvious what we are trying to do."}], "tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": false, "score": 2, "last_activity_date": 1513815207, "creation_date": 1513815207, "answer_id": 47916131, "question_id": 47914893, "link": "https://stackoverflow.com/questions/47914893/haskell-convert-day-to-unix-timestamp/47916131#47916131", "title": "Haskell: convert Day to UNIX timestamp", "body": "<p>I'm not sure what exactly you want, but you may want to modify <code>utctDay</code> and use <code>utcTimeToPOSIXSeconds</code> to convert <code>UTCTime</code> to a posix timestamp.</p>\n\n<pre><code>import Data.Time\nimport Data.Time.Clock.POSIX\n\noneWeekAgo = do now &lt;- getCurrentTime\n                let oneWeekAgo = now { utctDay = addDays (-7) $ utctDay now }\n                return $ utcTimeToPOSIXSeconds oneWeekAgo\n</code></pre>\n\n<p>Or just subtracting the seconds would be fine too.</p>\n\n<pre><code>oneWeekAgo = ((subtract (7 * 24 * 60 * 60)) . utcTimeToPOSIXSeconds) &lt;$&gt; getCurrentTime\n</code></pre>\n"}], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513815207, "creation_date": 1513806854, "question_id": 47914893, "link": "https://stackoverflow.com/questions/47914893/haskell-convert-day-to-unix-timestamp", "title": "Haskell: convert Day to UNIX timestamp", "body": "<p>How do I get the UNIX timestamp for \"one week ago\"? Currently I do:</p>\n\n<pre><code>import Data.Time\n...\noneWeekAgo = toTimestamp . addDays (-7) &lt;$&gt; now\n  where now = utctDay &lt;$&gt; getCurrentTime\n        toTimestamp = formatTime defaultTimeLocale \"%s\"\n</code></pre>\n\n<p>But this doesn't work because <code>formatTime</code> is returning an <em>empty</em> string.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1513805394, "post_id": 47914587, "comment_id": 82797207, "body": "Where are you stuck? By the looks of it you&#39;ve done exactly that. Why doesn&#39;t the solution you have here work?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1513805436, "post_id": 47914587, "comment_id": 82797233, "body": "@AJFarmar Seems like this&#39;ll trigger errors about overlapping instances"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1513805525, "post_id": 47914587, "comment_id": 82797277, "body": "@gallais True, but this can be solved with <code>-XOverlappingInstances</code> or <code>-XIncoherentInstances</code>. This error wasn&#39;t addressed in the question, so I assumed that the problem was elsewhere. So, what is the goal here?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1513806407, "post_id": 47914587, "comment_id": 82797611, "body": "Thank you for your edit. However, in your error, I can see that you&#39;ve left out crucial code, specifically that you defined a <code>Num</code> instance for <code>Maybe</code>s. I&#39;ve managed to get your code to work, with a few changes; I&#39;ll post this as an answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1513811684, "post_id": 47914587, "comment_id": 82799391, "body": "I suggest you avoid all this overlapping business. Just use <code>inc &lt;$&gt; x</code> to get under the functor and save everyone the overlapping headaches."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1513819182, "post_id": 47914587, "comment_id": 82801232, "body": "Unless you are explicitly trying to see what you can do with type classes, I would recommend using a regular function <code>inc&#39; :: Num a =&gt; a -&gt; a</code> defined as <code>inc n = n + 1</code>, then using <code>maybe 1 inc</code> to operate on <code>Num a =&gt; Maybe a</code> values."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 2626567, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f4d63ca109a469d48af2ed5e55aba219?s=128&d=identicon&r=PG", "display_name": "Praetore", "link": "https://stackoverflow.com/users/2626567/praetore"}, "edited": false, "score": 1, "creation_date": 1513808146, "post_id": 47914978, "comment_id": 82798322, "body": "I&#39;m halfway through the Learn You a Haskell for Great Good book, so I wasn&#39;t yet familiar with the concept of pragma&#39;s. This is what I was trying to do. Thank you!"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 91, "user_id": 2626567, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f4d63ca109a469d48af2ed5e55aba219?s=128&d=identicon&r=PG", "display_name": "Praetore", "link": "https://stackoverflow.com/users/2626567/praetore"}, "edited": false, "score": 0, "creation_date": 1513808814, "post_id": 47914978, "comment_id": 82798550, "body": "@Praetore I&#39;m very glad I could help."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1513807305, "creation_date": 1513807305, "answer_id": 47914978, "question_id": 47914587, "link": "https://stackoverflow.com/questions/47914587/how-can-i-create-a-function-that-will-accept-both-num-and-maybe-num/47914978#47914978", "title": "How can I create a function that will accept both Num and Maybe Num?", "body": "<p>Here is the adjusted code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, UndecidableInstances #-}\n\nclass SomeNum a where\n  inc' :: a -&gt; Int\n\ninstance {-# OVERLAPPABLE #-} Integral a =&gt; SomeNum a where\n  inc' n = fromIntegral n + 1\n\ninstance Integral a =&gt; SomeNum (Maybe a) where\n  inc' Nothing  = 1\n  inc' (Just n) = fromIntegral n + 1\n</code></pre>\n\n<p>This works as I think you intended:</p>\n\n<pre><code>\u03bb&gt; inc' 1\n2\n\u03bb&gt; inc' (Just 1)\n2\n\u03bb&gt; inc' Nothing\n1\n</code></pre>\n\n<hr>\n\n<p>I have made a few changes based on what I think you intended with this code. Here is an explanation of each:</p>\n\n<h2>The first change: <code>{-# OVERLAPPABLE #-}</code>:</h2>\n\n<p>You were right to say that <code>-XOverlappingInstances</code> is deprecated, but you didn't notice that it was deprecated in favour of <code>{#- OVERLAPPABLE #-}</code>. This is what I've added:</p>\n\n<pre><code>instance {-# OVERLAPPABLE #-} (...)</code></pre>\n\n<p>This is a necessary addition since you have defined a separate instance of <code>Num</code> for <code>Maybe</code>s, which causes the clash you experience. This isn't actually necessary with the changes I've made, but if you do indeed change the restriction back from <code>Integral</code> to <code>Num</code> again, this will save your fall.</p>\n\n<h2>The second change: <code>Integral a =&gt;</code></h2>\n\n<p>You can't just convert from a <code>Num</code> to an <code>Int</code>, as your <code>inc'</code> function seems to suggest (remember that <code>Float</code> is an instance of <code>Num</code>.) So, I adjusted the restriction:</p>\n\n<pre><code>instance {-# OVERLAPPABLE #-} Integral a => SomeNum a where\n  inc' n = fromIntegral n + 1</code></pre>\n\n<p>This also noticeable simplifies the <code>inc'</code> implementation. Note the use of <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code>. I'm not entirely sure if this is intended, but I you haven't specified so I'm guessing.</p>\n\n<hr>\n\n<p>I hope this helps. If this isn't exactly as you intended it to be, please try to adjust it on your own and explore how these language extensions behave.</p>\n"}], "owner": {"reputation": 91, "user_id": 2626567, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f4d63ca109a469d48af2ed5e55aba219?s=128&d=identicon&r=PG", "display_name": "Praetore", "link": "https://stackoverflow.com/users/2626567/praetore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47914978, "answer_count": 1, "score": 0, "last_activity_date": 1513807305, "creation_date": 1513805200, "last_edit_date": 1513806246, "question_id": 47914587, "link": "https://stackoverflow.com/questions/47914587/how-can-i-create-a-function-that-will-accept-both-num-and-maybe-num", "title": "How can I create a function that will accept both Num and Maybe Num?", "body": "<p>I'm currently learning about typeclasses in Haskell, and now im trying to create a increment function that works on both Maybe's and Num's. However, I'm kinda stuck at the moment. Can someone help me in the right direction? (error below)</p>\n\n<p>Edit: I'm using -XUndecidableInstances and -XFlexibleInstances as arguments during compilation as recommended by the compiler, considering -XOverlappingInstances (as suggested in the comments) is both deprecated and doesn't seem to work.</p>\n\n<pre><code>-- maybenum.hs\nclass SomeNum a where\n  inc' :: a -&gt; Int\n\ninstance Num a =&gt; SomeNum a where\n  inc' n = inc' (Just n)\n\ninstance Num a =&gt; SomeNum (Maybe a) where\n  inc' Nothing = 1\n  inc' (Just n) = n + 1\n\nmain :: IO ()\nmain = do\n  print $ inc' (Just 0)\n  print $ inc' 5\n  print $ inc' Nothing\n</code></pre>\n\n<p>This is the error I'm getting:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( maybenum.hs, maybenum.o )\n\nmaybenum.hs:5:12: error:\n    \u2022 Overlapping instances for SomeNum (Maybe a)\n        arising from a use of \u2018inc'\u2019\n      Matching instances:\n        instance Num a =&gt; SomeNum a -- Defined at maybenum.hs:4:10\n        instance Num a =&gt; SomeNum (Maybe a) -- Defined at maybenum.hs:7:10\n    \u2022 In the expression: inc' (Just n)\n      In an equation for \u2018inc'\u2019: inc' n = inc' (Just n)\n      In the instance declaration for \u2018SomeNum a\u2019\n\nmaybenum.hs:9:19: error:\n    \u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the instance declaration at maybenum.hs:7:10\n    \u2022 In the expression: n + 1\n      In an equation for \u2018inc'\u2019: inc' (Just n) = n + 1\n      In the instance declaration for \u2018SomeNum (Maybe a)\u2019\n    \u2022 Relevant bindings include\n        n :: a (bound at maybenum.hs:9:14)\n        inc' :: Maybe a -&gt; Int (bound at maybenum.hs:8:3)\n\nmaybenum.hs:13:11: error:\n    \u2022 Overlapping instances for SomeNum (Maybe a1)\n        arising from a use of \u2018inc'\u2019\n      Matching instances:\n        instance Num a =&gt; SomeNum a -- Defined at maybenum.hs:4:10\n        instance Num a =&gt; SomeNum (Maybe a) -- Defined at maybenum.hs:7:10\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018inc' (Just 0)\u2019\n      In a stmt of a 'do' block: print $ inc' (Just 0)\n      In the expression:\n        do { print $ inc' (Just 0);\n             print $ inc' 5;\n             print $ inc' Nothing }\n\nmaybenum.hs:13:22: error:\n    \u2022 Ambiguous type variable \u2018a1\u2019 arising from the literal \u20180\u2019\n      prevents the constraint \u2018(Num a1)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a1\u2019 should be.\n      These potential instances exist:\n        instance Num Integer -- Defined in \u2018GHC.Num\u2019\n        instance Num Double -- Defined in \u2018GHC.Float\u2019\n        instance Num Float -- Defined in \u2018GHC.Float\u2019\n        ...plus two others\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the first argument of \u2018Just\u2019, namely \u20180\u2019\n      In the first argument of \u2018inc'\u2019, namely \u2018(Just 0)\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018inc' (Just 0)\u2019\n\nmaybenum.hs:14:11: error:\n    \u2022 Overlapping instances for SomeNum a0 arising from a use of \u2018inc'\u2019\n      Matching instances:\n        instance Num a =&gt; SomeNum a -- Defined at maybenum.hs:4:10\n        instance Num a =&gt; SomeNum (Maybe a) -- Defined at maybenum.hs:7:10\n      (The choice depends on the instantiation of \u2018a0\u2019\n       To pick the first instance above, use IncoherentInstances\n       when compiling the other instance declarations)\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018inc' 5\u2019\n      In a stmt of a 'do' block: print $ inc' 5\n      In the expression:\n        do { print $ inc' (Just 0);\n             print $ inc' 5;\n             print $ inc' Nothing }\n\nmaybenum.hs:14:16: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from the literal \u20185\u2019\n      prevents the constraint \u2018(Num a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance Num Integer -- Defined in \u2018GHC.Num\u2019\n        instance Num Double -- Defined in \u2018GHC.Float\u2019\n        instance Num Float -- Defined in \u2018GHC.Float\u2019\n        ...plus two others\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the first argument of \u2018inc'\u2019, namely \u20185\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018inc' 5\u2019\n      In a stmt of a 'do' block: print $ inc' 5\n\nmaybenum.hs:15:11: error:\n    \u2022 Overlapping instances for SomeNum (Maybe a2)\n        arising from a use of \u2018inc'\u2019\n      Matching instances:\n        instance Num a =&gt; SomeNum a -- Defined at maybenum.hs:4:10\n        instance Num a =&gt; SomeNum (Maybe a) -- Defined at maybenum.hs:7:10\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018inc' Nothing\u2019\n      In a stmt of a 'do' block: print $ inc' Nothing\n      In the expression:\n        do { print $ inc' (Just 0);\n             print $ inc' 5;\n             print $ inc' Nothing }\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513782250, "post_id": 47908822, "comment_id": 82785187, "body": "You have to explicitly bring the instance into scope with e.g. <code>inst</code>"}, {"owner": {"reputation": 1378, "user_id": 2195721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37ff0c10acb6603393e11b44132b23cb?s=128&d=identicon&r=PG", "display_name": "Cthulhu", "link": "https://stackoverflow.com/users/2195721/cthulhu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513783012, "post_id": 47908822, "comment_id": 82785716, "body": "@user2407038 Can you link something were I can read more about this? I can&#39;t seem to google what you mean."}, {"owner": {"reputation": 1378, "user_id": 2195721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37ff0c10acb6603393e11b44132b23cb?s=128&d=identicon&r=PG", "display_name": "Cthulhu", "link": "https://stackoverflow.com/users/2195721/cthulhu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513784986, "post_id": 47908822, "comment_id": 82787028, "body": "I got it to typecheck with <code>testfun = foldMap \\\\ (inst :: Forall (MonoidalFunctor f) :- MonoidalFunctor f a)</code> which is cool, still would be interested to learn more about that area in Haskell, do I miss something or is there just not a whole lot of documentation on that?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513785654, "post_id": 47908822, "comment_id": 82787485, "body": "I think the <code>constraints</code> package is very well documented, although it is full of category theory jargon so you may not find that to be the case. But there are plenty of tutorials/blog posts about the subject (&quot;constraint kinds&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1513794918, "post_id": 47910187, "comment_id": 82792375, "body": "hmm... that&#39;s interesting. in fact, in intuitionistic logic, entailment and implication are interchangeable. so that indeed is function composition."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 4, "last_activity_date": 1513786189, "creation_date": 1513786189, "answer_id": 47910187, "question_id": 47908822, "link": "https://stackoverflow.com/questions/47908822/the-use-of-forall-in-haskell/47910187#47910187", "title": "The use of Forall in Haskell", "body": "<p>Use <code>inst</code></p>\n\n<pre><code>inst :: forall p a. Forall p a :- p a\n</code></pre>\n\n<p><code>inst</code> witness that, if you have <code>forall a. p a</code>, then you can set <code>a</code> to whatever you please and get <code>p a</code> out.</p>\n\n<p>An entailment (<code>:-</code>) is</p>\n\n<pre><code>newtype a :- b = Sub (a =&gt; Dict b)\ndata Dict a = a =&gt; Dict\n</code></pre>\n\n<p>so, by pattern-matching on it, you can reveal the instance within it:</p>\n\n<pre><code>testfun :: forall f a. Forall (MonoidalFunctor f) =&gt; (a -&gt; f a) -&gt; [a] -&gt; f a\ntestfun = case inst @(MonoidalFunctor f) @a of Sub Dict -&gt; foldMap\n</code></pre>\n\n<p>(type applications/signatures necessary) or you can use <code>(\\\\)</code>:</p>\n\n<pre><code>(\\\\) :: a =&gt; (b =&gt; r) -&gt; a :- b -&gt; r\ntestfun = foldMap \\\\ inst @(MonoidalFunctor f) @a\n</code></pre>\n\n<p>which reads \"given that <code>a</code> is true and a value of <code>r</code> that also needs <code>b</code> to be true, followed by a value that can prove that <code>b</code> is true given <code>a</code>, make an <code>r</code>. If you rearrange a bit</p>\n\n<pre><code>(\\\\) :: (b =&gt; c) -&gt; (a :- b) -&gt; (a =&gt; c)\n</code></pre>\n\n<p>it looks quite a bit like function composition.</p>\n\n<p>The reason for this dance is simply because it's beyond the reach of GHC to infer that <code>Forall c</code> means it can derive <code>c a</code> for any <code>a</code>; after all, that's why <code>constraints</code> exists. So, you have to be a bit more explicit about it.</p>\n"}], "owner": {"reputation": 1378, "user_id": 2195721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37ff0c10acb6603393e11b44132b23cb?s=128&d=identicon&r=PG", "display_name": "Cthulhu", "link": "https://stackoverflow.com/users/2195721/cthulhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 2, "accepted_answer_id": 47910187, "answer_count": 1, "score": 1, "last_activity_date": 1513786189, "creation_date": 1513781887, "question_id": 47908822, "link": "https://stackoverflow.com/questions/47908822/the-use-of-forall-in-haskell", "title": "The use of Forall in Haskell", "body": "<p><code>Data.Constraint.Forall</code> provides some quantification over constraints, however I fail to see how it can be used. Consider the following:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nmodule Forall where\n\nimport Prelude\nimport Data.Constraint.Forall\n\nclass Monoid (f a) =&gt; MonoidalFunctor f a\n\ntestfun :: Forall (MonoidalFunctor f) =&gt; (a -&gt; f a) -&gt; [a] -&gt; f a\ntestfun = foldMap\n\ntestfun' :: Monoid (f a) =&gt; (a -&gt; f a) -&gt; [a] -&gt; f a\ntestfun' = foldMap\n</code></pre>\n\n<p>I thought <code>testfun</code> would typecheck because <code>Forall (MetaMonoid f)</code> would work like <code>forall a. Metamonoid f a</code>, implying <code>forall a. Monoid (f a)</code> because of superclass constraint, but it doesn't.</p>\n\n<p>Why does it not work and is there any workaround? I want to avoid having to write a lot of constraints like <code>MyClass (f MyData)</code> for different <code>MyData</code> types in my function where I know that any useful <code>f</code> will have instances for any <code>f MyData</code> anyway.</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1513780562, "post_id": 47908295, "comment_id": 82783967, "body": "<code>foldl ((. return) . (++))</code>. But it is better to use <code>flip (foldr (:))</code>."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513780904, "post_id": 47908295, "comment_id": 82784228, "body": "Thanks! That much abour <code>foldr</code> I already figured out :) . I&#39;ve been just grokking."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1513781145, "post_id": 47908295, "comment_id": 82784395, "body": "If you care about performance, know that <code>foldl</code> is quite inefficient, in general. <code>foldl&#39;</code> is better, but it should only be used when the resulting type is small (e.g. a single <code>Int</code>). <code>foldr</code> is also OK, provided that the folding function is non-strict."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513781223, "post_id": 47908295, "comment_id": 82784454, "body": "@WillemVanOnsem If we are going to use <code>(++)</code> anyway, we can replace <code>foldl (\\xs x -&gt; ...)</code> with <code>(++)</code>, avoiding the folds."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513781467, "post_id": 47908295, "comment_id": 82784654, "body": "Thanks, but no, I don&#39;t care for efficiency. It&#39;s just doodles, I&#39;m studying."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513781754, "post_id": 47908295, "comment_id": 82784864, "body": "@WillemVanOnsem Would you mind expounding a bit on this particular kind of composition?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1513786792, "post_id": 47908295, "comment_id": 82788145, "body": "You can <a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">mechanically reduce</a> any lambda expression to make it into pure composition. This usually involves <code>(.)</code>, <code>flip</code> to manage argument order, and <code>const</code> and <code>(&lt;*&gt;)</code> to ignore/duplicate arguments, respectively. It might help to add points to the function and simplify if you want to see how it works: <code>\\hd tl -&gt; ((. return) . (++)) hd tl = \\hd tl -&gt; ((. return) (hd ++)) tl = \\hd tl -&gt; ((hd ++) . return) tl = \\hd tl -&gt; hd ++ return tl = \\hd tl -&gt; hd ++ [tl]</code>. Forms like <code>(. x) . y</code> and <code>(x .) . y</code> compose functions with different numbers of arguments."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513787946, "post_id": 47908295, "comment_id": 82788805, "body": "Kinda magnificent. I&#39;ll have to think a bit."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513788939, "post_id": 47908295, "comment_id": 82789349, "body": "Somehow can&#39;t figure out the entity meant between the dot and the parenthesis. Must be another function, of course, but..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513805833, "post_id": 47908295, "comment_id": 82797401, "body": "<code>(. x)</code> is an <a href=\"https://stackoverflow.com/a/13147064/849891\">operator section</a>: a <a href=\"https://stackoverflow.com/a/37979558/849891\">partially applied operator</a>, here <code>(.)</code>: <code>(. x) y = (y . x) = (y .) x = (.) y x</code>, by definition. it&#39;s just <i>syntax</i>. And <code>(. x) y z = (y . x) z = y (x z)</code>. Similarly, <code>((. x) . y) z w = (. x) (y z) w = ((y z) . x) w = (y z) (x w) = y z (x w)</code>. The manipulations of the equations are purely syntactical."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513806281, "post_id": 47908295, "comment_id": 82797571, "body": "also, <code>(. x) y = (y . x) = (.) y x = flip (.) x y</code>, <i>hence</i> <code>(. x) = flip (.)</code> by <i>&quot;eta contraction&quot;</i>. Similarly  <code>(y .) = (.) y</code>. --- and, what you&#39;re asking about is known as <i><a href=\"https://stackoverflow.com/questions/tagged/pointfree\">pointfree</a> programming</i>."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513824768, "post_id": 47908295, "comment_id": 82802456, "body": "Thank you very much! It amounts to exhaustive answer. BTW, is there a way to partially apply to arguments not starting with the first one? Only third and fourth to a function of five args, for instance? Operator section rules suggest such possibility. Or is it just <code>flip</code> over two arguments? And how am I supposed to  declare this post answered?"}], "answers": [{"tags": [], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "is_accepted": true, "score": 1, "last_activity_date": 1513833385, "creation_date": 1513833385, "answer_id": 47918356, "question_id": 47908295, "link": "https://stackoverflow.com/questions/47908295/haskell-a-case-of-composition/47918356#47918356", "title": "Haskell: a case of composition", "body": "<p>This is just a better readable summary extracted from the comments by <a href=\"https://stackoverflow.com/users/5684257/htnw\">HTNW</a> and <a href=\"https://stackoverflow.com/users/849891/will-ness\">Will Ness</a>:</p>\n\n<pre><code>-- Reduction to poinfree\na = \\xs x -&gt; xs ++ [x]\nb = \\xs x -&gt; xs ++ return x\nc = \\xs x -&gt; ((xs ++) . return) x\nd = \\xs x -&gt; ((. return) (xs ++)) x\ne = \\xs x -&gt; ((. return) . (++)) xs x\n</code></pre>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47918356, "answer_count": 1, "score": 0, "last_activity_date": 1513833385, "creation_date": 1513780323, "question_id": 47908295, "link": "https://stackoverflow.com/questions/47908295/haskell-a-case-of-composition", "title": "Haskell: a case of composition", "body": "<p>This is a useless case of concatenation via <code>foldl</code>, purely educational (for me):</p>\n\n<pre><code>foldl (\\xs x -&gt; xs ++ [x]) [1,2] [11,12,13]\n[1,2,11,12,13]\n</code></pre>\n\n<p>Is there a way to pack it even tighter, using composition instead of the lambda?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513750426, "post_id": 47898872, "comment_id": 82766122, "body": "By choosing a function that matches."}, {"owner": {"reputation": 698, "user_id": 981405, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7de874a683e805c5c45bfce7c985522d?s=128&d=identicon&r=PG", "display_name": "jgon", "link": "https://stackoverflow.com/users/981405/jgon"}, "edited": false, "score": 0, "creation_date": 1513750940, "post_id": 47898872, "comment_id": 82766326, "body": "For example <code>\\x -&gt; (*2)</code>, or equivalently <code>const (*2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "edited": false, "score": 0, "creation_date": 1513791924, "post_id": 47900067, "comment_id": 82790887, "body": "So, in words, my understanding is now: When one sees ([a] -&gt; a -&gt; b) it means that contrivedMap requires one function that takes a list of type a&#39;s, and returns a single value of type a, and then takes that a and returns a single value of type b,  meaning it may or may not be of type a.  The composition ((*) .sum) operating on [1,23] does exactly that.  I must say that I will be studying your reply for some time as I think it is the key to understanding Haskell syntax.  Much appreciated."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513808502, "post_id": 47900067, "comment_id": 82798450, "body": "No, <code>[a] -&gt; a -&gt; b</code> means that it takes <i>two</i> arguments, an <code>[a]</code> and an <code>a</code>, and returns a <code>b</code>. To be pedantic, it actually takes a <code>[a]</code> and returns a function that takes an <code>a</code> and returns a <code>b</code>."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1513751625, "creation_date": 1513751625, "answer_id": 47900067, "question_id": 47898872, "link": "https://stackoverflow.com/questions/47898872/as-pattern-contrivedmap-example-not-working/47900067#47900067", "title": "As-pattern &quot;contrivedMap&quot; example not working", "body": "<blockquote>\n  <p>I see they don't match, but how do I fix it?</p>\n</blockquote>\n\n<p>You can fix it by proper usage of this function.</p>\n\n<p>You've defined a function <code>mapEx</code> which iterates over the elements of a list and applies the provided function on <strong>every element</strong>, i. e. you need to provide a function, that takes an element of a list and returns a result. For example <code>(*2)</code> - takes a <code>Num</code> and returns a doubled value.</p>\n\n<p>Expectedly:</p>\n\n<p><code>mapEx (*2) [1,2,3]</code> evaluates as <code>[2, 4, 6]</code></p>\n\n<p>But the <code>contrivedMap</code> function is slightly different. It also iterates over the elements of a list, but the provided function takes <strong>2</strong> arguments <strong>the list of elements from the iterated element to the end</strong> and <strong>the iterated element</strong></p>\n\n<p><code>contrivedMap f [1,2,3]</code> is going to contain:</p>\n\n<pre><code>[(f [1,2,3] 1), (f [2,3] 2), (f [3] 3)]\n</code></pre>\n\n<p>Thus, you'll want to provide the function, which works correctly with these arguments, i. e. has the type <code>([a] -&gt; a -&gt; b)</code>. For example, <code>f list x = (sum list) * x</code> or just <code>f = (*) . sum</code></p>\n\n<p><code>contrivedMap ((*) . sum) [1,2,3]</code> returns <code>[6,10,9]</code>, which is:</p>\n\n<pre><code>[(sum [1,2,3]) * 1, (sum [2,3]) * 2, (sum [3]) * 3]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8942073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c836f1905feee2d4e7eed88128fb49?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/8942073/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 47900067, "answer_count": 1, "score": -1, "last_activity_date": 1513751671, "creation_date": 1513744701, "last_edit_date": 1513751671, "question_id": 47898872, "link": "https://stackoverflow.com/questions/47898872/as-pattern-contrivedmap-example-not-working", "title": "As-pattern &quot;contrivedMap&quot; example not working", "body": "<p><a href=\"http://en.wikibooks.org/wiki/Haskell/Pattern_matching\" rel=\"nofollow noreferrer\">Haskell Wikibook</a> defines this function:</p>\n\n<pre><code>contrivedMap :: ([a] -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\ncontrivedMap f [] = []\ncontrivedMap f list@(x:xs) = f list x : contrivedMap f xs\n</code></pre>\n\n<p>I am getting an error when I try to use it:</p>\n\n<pre><code>&gt; contrivedMap (*2) [1,2,3]\n\n&lt;interactive&gt;:4:15: error:\n\u2022 Couldn't match type \u2018[a0]\u2019 with \u2018a0 -&gt; b\u2019\n  Expected type: [a0] -&gt; a0 -&gt; b\n    Actual type: (a0 -&gt; b) -&gt; a0 -&gt; b\n\u2022 In the first argument of \u2018contrivedMap\u2019, namely \u2018(* 2)\u2019\n  In the expression: contrivedMap (* 2) [1, 2, 3]\n  In an equation for \u2018it\u2019: it = contrivedMap (* 2) [1, 2, 3]\n\u2022 Relevant bindings include it :: [b] (bound at &lt;interactive&gt;:4:1)\n</code></pre>\n\n<p>I see that the types don't match:</p>\n\n<pre><code>&gt; :t (*2) \n(*2) :: Num a =&gt; a -&gt; a\n\n&gt; :t contrivedMap\ncontrivedMap :: ([a] -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>But how do I fix it? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1513731113, "post_id": 47897291, "comment_id": 82761451, "body": "Okay, now we know that you want an <code>IO</code> type. What <code>IO</code> do you want to do?"}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 6, "last_activity_date": 1513732818, "last_edit_date": 1513732818, "creation_date": 1513731152, "answer_id": 47897344, "question_id": 47897291, "link": "https://stackoverflow.com/questions/47897291/define-return-type-io-a-haskell/47897344#47897344", "title": "Define return type IO [a] Haskell", "body": "<p>If you have a pure value, the way to convert to into a monadic value is with the <code>return</code> (aka <code>pure</code>) function:</p>\n\n<pre><code>fc :: [a] -&gt; IO [a]\nfc list = return list\n</code></pre>\n\n<p>But if you want to map the <code>show</code> function over your list, the result will be <code>[String]</code>, because the function <code>show :: a -&gt; String</code> turns any value into a <code>String</code>, so:</p>\n\n<pre><code>fc :: Show a =&gt; [a] -&gt; IO [String]\nfc list = return $ map show list\n</code></pre>\n\n<p>Notice the <code>Show a</code> constraint. It tells the compiler that the type <code>a</code>, whatever it is, must support function <code>show</code>. Without it, such function won't type check.</p>\n\n<p>The <code>sequence</code> function is beside the point completely, since it turns a list of monadic values into one monadic value that is a list. If you wanted to use that function, then the list you pass to it must be a list of monadic values, for example:</p>\n\n<pre><code>fc :: Show a =&gt; [a] -&gt; IO [()]\nfc list = sequence $ map print list\n</code></pre>\n\n<p>Here, <code>print</code> is an <code>IO ()</code> action that prints out a value.</p>\n\n<p>If you want a more precise answer, you'd need to specify more clearly what you're trying to do.</p>\n"}], "owner": {"reputation": 41, "user_id": 8972834, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1084d7ea140fbad38f6db15e43552489?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyPire", "link": "https://stackoverflow.com/users/8972834/johnnypire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 47897344, "answer_count": 1, "score": 1, "last_activity_date": 1513732818, "creation_date": 1513730621, "last_edit_date": 1513730925, "question_id": 47897291, "link": "https://stackoverflow.com/questions/47897291/define-return-type-io-a-haskell", "title": "Define return type IO [a] Haskell", "body": "<p>I want to return the expected type IO [a]</p>\n\n<p>I tried:\nType that I want</p>\n\n<pre><code>fc :: [a] -&gt; IO [a]\nfc a = sequence $ map show list\n\n&gt; fc [1,2,3]\n&gt; [1,2,3]\n</code></pre>\n\n<p>What can I do? </p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1513728058, "post_id": 47896790, "comment_id": 82760720, "body": "Nice deck of cards... what is your question?"}, {"owner": {"reputation": 13, "user_id": 9120267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f48d59bb983c26696bd144760bbc832?s=128&d=identicon&r=PG&f=1", "display_name": "Filipe Capela", "link": "https://stackoverflow.com/users/9120267/filipe-capela"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513728639, "post_id": 47896790, "comment_id": 82760830, "body": "@WillemVanOnsem i need to instance it to arbitrary in order to be able to use Test.QuickCheck, but i don&#39;t know how to do it"}], "answers": [{"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": true, "score": 1, "last_activity_date": 1513764485, "last_edit_date": 1513764485, "creation_date": 1513764045, "answer_id": 47903324, "question_id": 47896790, "link": "https://stackoverflow.com/questions/47896790/instance-of-arbitrary-haskell/47903324#47903324", "title": "Instance of Arbitrary Haskell", "body": "<p>A very basic instance for <code>Carta</code> could be:</p>\n\n<pre><code>instance Arbitrary Carta where\n  arbitrary = Carta &lt;$&gt; vn\n    where\n      vn = (,) &lt;$&gt; v &lt;*&gt; n\n      v  = elements [Paus .. Espadas]\n      n  = elements [As .. Rei]\n</code></pre>\n\n<p>The <code>elements</code> function from module <code>Test.QuickCheck</code> takes a list of values and returns a generator for those values (i.e. something to select one of those values at random):</p>\n\n<pre><code>elements :: [a] -&gt; Gen a\n</code></pre>\n\n<p>The instance above uses this to independently generate a random <code>Valor</code> and a random <code>Naipe</code> for a card. Those to values are then combined to a tuple (<code>vn</code> is a generator for a tuple, type <code>Gen (Valor,Naipe)</code>). After that wrap this to a generator for the <code>Carta</code> itself.</p>\n\n<p>To generate a random deck of cards (where you don't want to have duplicates), have a look at the function:</p>\n\n<pre><code>shuffle :: [a] -&gt; Gen [a]\n</code></pre>\n\n<p>in <code>Test.QuickCheck</code>. It generates random permutations of a list of items. It will also be helpful to make <code>Carta</code>, <code>Valor</code> and <code>Naipe</code> elements of <code>Enum</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9120267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f48d59bb983c26696bd144760bbc832?s=128&d=identicon&r=PG&f=1", "display_name": "Filipe Capela", "link": "https://stackoverflow.com/users/9120267/filipe-capela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 47903324, "answer_count": 1, "score": -3, "last_activity_date": 1513800406, "creation_date": 1513726631, "last_edit_date": 1513800406, "question_id": 47896790, "link": "https://stackoverflow.com/questions/47896790/instance-of-arbitrary-haskell", "title": "Instance of Arbitrary Haskell", "body": "<p>I need to make an instance of arbitrary on my Haskell program, I'm creating a deck of cards (which is of type deck), and deck is a list of Cards, in order to make a new deck the program uses a mkStdGen and a number to prompt a seed, in order to randomize the new deck.</p>\n\n<p>This deck needs to have an instance of arbitrary to pass the QuickTest property tests.</p>\n\n<p>Here's some code</p>\n\n<pre><code> data Carta = C (Valor,Naipe) deriving (Eq,Ord)\n\n instance Show Carta where\n show (C (v,n)) =show v ++ show n\n\n data Baralho = B [Carta] \n\n  instance Show Baralho where\n  show (B []) = \"\"\n  show (B [c]) = show c\n  show (B (c:cs)) = show c ++ \",\" ++ show (B cs)\n\n  type Mao = [Carta]\n\n  baralho40 :: Baralho\n\n  baralho40 = B [C (x,y)|y&lt;-[Paus .. Espadas],x&lt;-[As .. Rei]]\n\n  baralhar :: StdGen -&gt; Baralho -&gt; Baralho\n\n  baralhar g (B baralho) = B $ map snd $ sort $ zip (randomRs (1,(length       baralho)^3) g) baralho\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1513720665, "post_id": 47895739, "comment_id": 82758360, "body": "Define &quot;common words&quot; - words that are the same? If so, what does the <code>10</code> in your proposed <code>count</code> function signify? Please expand your examples more to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that we can work with."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513721490, "post_id": 47895739, "comment_id": 82758669, "body": "<code>drop (10, xs)</code> is a type error. The first argument to <code>drop</code> must be a number, not a tuple."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9120094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c633766627137db8e57b6e371aeb0804?s=128&d=identicon&r=PG&f=1", "display_name": "Napi Cobin", "link": "https://stackoverflow.com/users/9120094/napi-cobin"}, "edited": false, "score": 0, "creation_date": 1513724527, "post_id": 47895995, "comment_id": 82759754, "body": "Thanks buddy it will certainly help thanks"}, {"owner": {"reputation": 5, "user_id": 9120094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c633766627137db8e57b6e371aeb0804?s=128&d=identicon&r=PG&f=1", "display_name": "Napi Cobin", "link": "https://stackoverflow.com/users/9120094/napi-cobin"}, "edited": false, "score": 0, "creation_date": 1513801778, "post_id": 47895995, "comment_id": 82795548, "body": "can you please let me know how can i find 10 most frequently used words appeared in the text?"}, {"owner": {"reputation": 5, "user_id": 9120094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c633766627137db8e57b6e371aeb0804?s=128&d=identicon&r=PG&f=1", "display_name": "Napi Cobin", "link": "https://stackoverflow.com/users/9120094/napi-cobin"}, "edited": false, "score": 0, "creation_date": 1513801807, "post_id": 47895995, "comment_id": 82795561, "body": "For example i should get the out put in integer for e.g 12"}, {"owner": {"reputation": 5, "user_id": 9120094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c633766627137db8e57b6e371aeb0804?s=128&d=identicon&r=PG&f=1", "display_name": "Napi Cobin", "link": "https://stackoverflow.com/users/9120094/napi-cobin"}, "edited": false, "score": 0, "creation_date": 1513808793, "post_id": 47895995, "comment_id": 82798540, "body": "Thank you so much, i have got one more little question as well, i just want to know how can we get the number of times altogether the most common 20 words appeared."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 5, "user_id": 9120094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c633766627137db8e57b6e371aeb0804?s=128&d=identicon&r=PG&f=1", "display_name": "Napi Cobin", "link": "https://stackoverflow.com/users/9120094/napi-cobin"}, "edited": false, "score": 0, "creation_date": 1513813787, "post_id": 47895995, "comment_id": 82799948, "body": "that will require a new function since we drop the counts after sorting, but check the first function, remove <code>snd</code> and instead write a <code>sum</code> on the <code>fst</code>.  If this is a homework I already past the limit. Try-error is part of learning.  Ask again if you can&#39;t get anywhere..."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 2, "last_activity_date": 1513804606, "last_edit_date": 1513804606, "creation_date": 1513721856, "answer_id": 47895995, "question_id": 47895739, "link": "https://stackoverflow.com/questions/47895739/how-to-find-common-words-from-a-list-in-haskell/47895995#47895995", "title": "how to find common words from a list in haskell", "body": "<p>this may get you started</p>\n\n<pre><code>commonwords n = snd . unzip . take n . reverse . sort . map pair . group . sort\n     where pair x = (length x, head x)\n</code></pre>\n\n<p>to filter out blacklisted words </p>\n\n<pre><code>filterBlackList = filter (`notElem` blacklist)\n</code></pre>\n\n<p>you need to combine the two...</p>\n\n<p>Here is one trivial way to connect the two functions</p>\n\n<pre><code>removecommon :: Ord a =&gt; Int -&gt; [a] -&gt; [a]\nremovecommon n ws = filter (`notElem` commonwords n ws) ws\n</code></pre>\n\n<p>for example</p>\n\n<pre><code>&gt; let ws = words \"she sells seashells by the seashore the shells she sells are surely seashells so if she sells shells on the seashore I'm sure she sells seashore shells\"\n\n&gt; removecommon 6  ws\n</code></pre>\n\n<p>gives back</p>\n\n<pre><code>[\"by\",\"are\",\"surely\",\"so\",\"if\",\"on\",\"I'm\",\"sure\"]\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9120094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c633766627137db8e57b6e371aeb0804?s=128&d=identicon&r=PG&f=1", "display_name": "Napi Cobin", "link": "https://stackoverflow.com/users/9120094/napi-cobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "closed_date": 1513729734, "accepted_answer_id": 47895995, "answer_count": 1, "score": -3, "last_activity_date": 1513804606, "creation_date": 1513720449, "last_edit_date": 1513720836, "question_id": 47895739, "link": "https://stackoverflow.com/questions/47895739/how-to-find-common-words-from-a-list-in-haskell", "closed_reason": "Needs details or clarity", "title": "how to find common words from a list in haskell", "body": "<p>Hi I am a bit new to Haskell programming. I just wanted to know how I can find 10 common words from a list in Haskell.</p>\n\n<p>Example of a list:</p>\n\n<pre><code>[\"there\", \"is\", \"is\", \"a\", \"man\", ...]\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>getCommonWords xs = count(10, xs)\n</code></pre>\n\n<p>And how can I drop 10 common words from the list:</p>\n\n<pre><code>removeCommonWords xs = drop(10, xs)\n</code></pre>\n\n<p>Any help or right direction would very thankful.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 8, "creation_date": 1513701536, "post_id": 47891327, "comment_id": 82749184, "body": "I don&#39;t know how the course (?) is organized, but if this is one of the first examples, then the course should probably restructured a bit, since it introduces too much concepts at once."}], "answers": [{"comments": [{"owner": {"reputation": 971, "user_id": 253884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KuV26.jpg?s=128&g=1", "display_name": "Pawel Szulc", "link": "https://stackoverflow.com/users/253884/pawel-szulc"}, "edited": false, "score": 0, "creation_date": 1513702255, "post_id": 47891530, "comment_id": 82749648, "body": "this question was asked 11 min ago, 3 min ago we have awesome answer :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 376, "user_id": 7271772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eef9b3cffd3ca044729a43c23f7232d9?s=128&d=identicon&r=PG&f=1", "display_name": "George Morris", "link": "https://stackoverflow.com/users/7271772/george-morris"}, "edited": false, "score": 0, "creation_date": 1513702914, "post_id": 47891530, "comment_id": 82750037, "body": "@GeorgeMorris see my edit, I&#39;ve fixed a couple of bugs in your original function :)"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 15, "last_activity_date": 1513733416, "last_edit_date": 1513733416, "creation_date": 1513701977, "answer_id": 47891530, "question_id": 47891327, "link": "https://stackoverflow.com/questions/47891327/haskell-what-does-following-function-do/47891530#47891530", "title": "Haskell what does following function do?", "body": "<p>All good questions!</p>\n\n<blockquote>\n  <ul>\n  <li>What does <code>l@</code> do?</li>\n  </ul>\n</blockquote>\n\n<p>That's called an <em>as-pattern</em>. It gives a name to a whole pattern. <code>l@(x:_)</code> is a pattern which matches a list with at least one element. It name the head of the list <code>x</code>, discards the tail of the list, and names the whole list (that is, the value of the expression <code>x:_</code>) <code>l</code>.</p>\n\n<blockquote>\n  <ul>\n  <li>What does <code>dropWhile (/= e) l of</code> stand for, especially the <code>/=</code> operator</li>\n  </ul>\n</blockquote>\n\n<p><code>/=</code> is how Haskell spells \"not equal\". It's the same as <code>!=</code> in eg Java. The syntax <code>(/= e)</code>, where an infix operator is given one argument in parentheses, is called a <em>section</em>. It stands for <code>(\\x -&gt; x /= e)</code>. So <code>dropWhile (/= e) l</code> drops elements from <code>l</code> as long as they don't equal <code>e</code>.</p>\n\n<blockquote>\n  <ul>\n  <li>What does <code>of</code> mean in this context?</li>\n  </ul>\n</blockquote>\n\n<p>It's just part of the <code>case</code> expression syntax. It separates the scrutinee from the branches:</p>\n\n<pre><code>case foo of\n    bar -&gt; ...\n    baz -&gt; ...\n    ...\n</code></pre>\n\n<blockquote>\n  <ul>\n  <li>What does <code>(_:y:_)</code> do? I know <code>(x:xs)</code> will allow you to grab head or tail but what is in <code>y</code> variable?</li>\n  </ul>\n</blockquote>\n\n<p>That's just a more complex pattern. In this instance it's matching lists with at least two elements and naming the second element <code>y</code>.</p>\n\n<p><code>x:xs</code> separates the head from the tail; <code>x:(y:ys)</code> separates the first two elements from the rest. Since <code>(:)</code> is right-associative, you can drop the parentheses (<code>x:y:ys</code>), and the <code>_</code>s just mean \"I'm not interested in this\".</p>\n\n<blockquote>\n  <ul>\n  <li>What will the arrow do? <code>_ -&gt; x</code></li>\n  </ul>\n</blockquote>\n\n<p>Again, it's just part of the <code>case</code> expression syntax. It separates patterns from return values. In this case the pattern is a catch-all wildcard pattern and the return value is <code>x</code>.</p>\n\n<hr>\n\n<p>To summarise: this function is supposed to look for <code>e</code> in <code>l</code> and return the following element. That said, it's not an especially great implementation of that idea. I spy two particular problems.</p>\n\n<ol>\n<li>It'll fail with an exception (and crash your program!) if the input list is empty, because there's no clause for the <code>[]</code> case in <code>next</code>'s declaration. <code>next</code> is a <em>partial</em> function.</li>\n<li>If <code>dropWhile (/= e) l</code> doesn't return a list with at least two elements (so that the <code>_:y:_</code> pattern doesn't match), it'll return <code>x</code>, the first element of the list. (This could happen if <code>e</code> is missing from the list or if it's the last element.) This seems like a very strange thing to do.</li>\n</ol>\n\n<p>I'd probably fix it by accounting for the possibility that there may not even be a <code>next</code> element of <code>l</code>. <code>e</code> could be the last element of <code>l</code>, or it might not be in <code>l</code> at all. This is a fundamental part of the meaning of this function, not just a bug in the implementation, so we should account for it in the type.</p>\n\n<pre><code>next :: Eq a =&gt; [a] -&gt; a -&gt; Maybe a\n</code></pre>\n\n<p>By giving <code>next</code> a return type of <code>Maybe a</code>, I'm indicating that it might not return anything.</p>\n\n<pre><code>next l e = case dropWhile (/= e) l of\n                (_:x:_) -&gt; Just x\n                _ -&gt; Nothing\n</code></pre>\n\n<p>So this implementation says: if <code>dropWhile (/= e) l</code> returns a list of at least two elements, return the second one. (I'm using <code>Just :: a -&gt; Maybe a</code> to wrap the value into a <code>Maybe</code>.) Otherwise return <code>Nothing</code> at all.</p>\n\n<p>Don't worry too much about this, but for what it's worth, we can make this function slightly shorter using one of Haskell's more advanced features. The <code>ViewPatterns</code> language extension is designed to simplify functions like this one which just perform <code>case</code> analysis on a secondary value.</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\nnext :: Eq a =&gt; a -&gt; [a] -&gt; Maybe a  -- I've flipped the arguments\nnext e (dropWhile (/= e) -&gt; _:x:_) = Just x\nnext _ _ = Nothing\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 7271772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eef9b3cffd3ca044729a43c23f7232d9?s=128&d=identicon&r=PG&f=1", "display_name": "George Morris", "link": "https://stackoverflow.com/users/7271772/george-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 1, "accepted_answer_id": 47891530, "answer_count": 1, "score": 3, "last_activity_date": 1513733416, "creation_date": 1513701342, "last_edit_date": 1513703235, "question_id": 47891327, "link": "https://stackoverflow.com/questions/47891327/haskell-what-does-following-function-do", "title": "Haskell what does following function do?", "body": "<p>I am quite new to haskell but fortunately I need to implement just a few functions.\nI do have questions about the following function</p>\n\n<pre><code>next :: Eq a =&gt; [a] -&gt; a -&gt;  a\nnext l@(x:_) e = case dropWhile (/= e) l of\n                   (_:y:_) -&gt; y\n                   _ -&gt; x\n</code></pre>\n\n<ul>\n<li>What does <code>l@</code> do?</li>\n<li>What does <code>dropWhile (/= e) l of</code> stand for, especially the <code>/=</code> operator</li>\n<li>What does <code>of</code> mean in this context?</li>\n<li>What does <code>(_:y:_)</code> do? I know <code>(x:xs)</code> will allow you to grab head or tail but what is in <code>y</code> variable?</li>\n<li>What will the arrow do? <code>_ -&gt; x</code></li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513701409, "post_id": 47891219, "comment_id": 82749095, "body": "Try providing a list of values (<code>list</code>) and a list of tuples (<code>dict</code>) such as <code>main = aa [1::Int,2,3] [(2,3),(4,9),(5,1)]</code>.  If that doesn&#39;t answer your question then perhaps you can say more about what you are doing and what you want."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1513701496, "post_id": 47891219, "comment_id": 82749157, "body": "You mean from <i>user</i> input? You are maybe looking for <code>readLn</code>"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1513701733, "post_id": 47891219, "comment_id": 82749311, "body": "To answer this question, you first need to decide what the format of the user input is."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 1, "last_activity_date": 1513782002, "last_edit_date": 1513782002, "creation_date": 1513781540, "answer_id": 47908689, "question_id": 47891219, "link": "https://stackoverflow.com/questions/47891219/haskell-call-function-from-input/47908689#47908689", "title": "Haskell: call function from input?", "body": "<p>You may actually read and auto-parse things in Haskell using readLn IO.</p>\n\n<pre><code>main = do\n    (l1 :: [Int]) &lt;- readLn\n    (l2 :: [(Int, Int)]) &lt;- readLn\n    aa l1 l2\n</code></pre>\n\n<p>Or even with one-liner</p>\n\n<pre><code>main = join $ aa &lt;$&gt; readLn &lt;*&gt; readLn\n</code></pre>\n"}], "owner": {"reputation": 1665, "user_id": 5798559, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-7Mh4gd1G0qo/AAAAAAAAAAI/AAAAAAAAABM/0Ie0uLopJKQ/photo.jpg?sz=128", "display_name": "Coffee", "link": "https://stackoverflow.com/users/5798559/coffee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513782002, "creation_date": 1513700968, "last_edit_date": 1513701834, "question_id": 47891219, "link": "https://stackoverflow.com/questions/47891219/haskell-call-function-from-input", "title": "Haskell: call function from input?", "body": "<p>I'm using <a href=\"http://rextester.com/l/haskell_online_compiler\" rel=\"nofollow noreferrer\">this</a> online compiler.</p>\n\n<p>I have this code:</p>\n\n<pre><code>main = do\n    aa    \naa list lib = print (translate list lib)    \ntranslate ls dict = [ b | (a,b) &lt;- dict, a `elem` ls ]\n</code></pre>\n\n<p>And this user input:</p>\n\n<pre><code>aa [1,2,3] [(1,2), (1,4), (2,4), (2,5)]\n</code></pre>\n\n<p>And now I get error, because <code>main</code> calls <code>aa</code> without arguments</p>\n\n<p>How do I call this <code>aa</code> function with these arguments from input? What should I put in <code>main</code>?</p>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1513699711, "post_id": 47890786, "comment_id": 82748113, "body": "If you have <code>DeriveAnyClass</code> on too, you can jump straight to <code>data EPSG a = EPSG { epsg3857 :: a } deriving (Generic, FromJSON)</code>."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1513699998, "post_id": 47890786, "comment_id": 82748275, "body": "@Alec Thanks for the tip! Does that replace <code>DeriveGeneric</code>? Or in addition to it?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1513700079, "post_id": 47890786, "comment_id": 82748318, "body": "Nope, you still need \u2018DeriveGeneric\u2019 too. The features are sort of orthogonal."}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 5, "last_activity_date": 1513699318, "creation_date": 1513699318, "answer_id": 47890786, "question_id": 47890435, "link": "https://stackoverflow.com/questions/47890435/use-derivegeneric-for-parameterized-type/47890786#47890786", "title": "Use DeriveGeneric for parameterized type", "body": "<p>Your definition of <code>EPSG</code> needs to derive generic as well, and then you need to constrain your instance to have a <code>FromJSON</code> instance for <code>a</code> as well.</p>\n\n<pre><code>data EPSG a = EPSG { epsg3857 :: a } deriving Generic\n</code></pre>\n\n<p>...</p>\n\n<pre><code>instance FromJSON a =&gt; FromJSON (EPSG a)\n</code></pre>\n"}], "owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 47890786, "answer_count": 1, "score": 2, "last_activity_date": 1513699318, "creation_date": 1513698077, "question_id": 47890435, "link": "https://stackoverflow.com/questions/47890435/use-derivegeneric-for-parameterized-type", "title": "Use DeriveGeneric for parameterized type", "body": "<p>I want to use automated DeriveGeneric for my parameterized type. I get error. I want to decode a yaml file ino FromJSON type.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE TypeFamilies  #-}\n\nimport Web.Scotty\nimport Data.ByteString.Char8 (pack, unpack)\nimport Data.ByteString.Lazy (toStrict, fromStrict)\nimport Data.List\nimport Data.Yaml\nimport GHC.Generics\n\ndata EPSG a = EPSG { epsg3857 :: a }\n\ndata Resolution = Resolution { max :: Int, items :: [Double]}\n\ndata Config = Config { minX :: EPSG Double, minY :: EPSG Double, maxX :: EPSG Double, maxY :: EPSG Double\n                   , resolution :: EPSG Resolution\n                   , metersPerUnit :: EPSG Double\n                   , pixelSize :: EPSG Double\n                   , scaleNames :: EPSG [String]\n                   , tileWidth :: EPSG Double\n                   , tileHeight :: EPSG Double\n                   , subdirBit :: EPSG [Int]\n                   , subdirShiftBit :: EPSG [Int]\n                   , subdirNumSize :: EPSG [Int]\n                   , fileNameNumSize :: EPSG [Int] } deriving Generic\n\ninstance FromJSON EPSG *\ninstance FromJSON Resolution\ninstance FromJSON Config\n</code></pre>\n\n<p>Line EPSG * raises error. How should I fix it?</p>\n"}, {"tags": ["haskell", "path", "environment-variables"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1515166697, "post_id": 47889770, "comment_id": 83209644, "body": "I don&#39;t think this questions should be closed. In case you&#39;re still interested in Haskell solution, I discovered this library which can help you to deal with environment variables: <a href=\"https://github.com/stackbuilders/dotenv-hs\" rel=\"nofollow noreferrer\">github.com/stackbuilders/dotenv-hs</a>"}], "owner": {"reputation": 731, "user_id": 1214547, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9cb4c009ced93d992fe9ce0d845c641c?s=128&d=identicon&r=PG", "display_name": "Pastafarianist", "link": "https://stackoverflow.com/users/1214547/pastafarianist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "closed_date": 1513784786, "answer_count": 0, "score": 4, "last_activity_date": 1513696483, "creation_date": 1513695770, "last_edit_date": 1513696483, "question_id": 47889770, "link": "https://stackoverflow.com/questions/47889770/standard-haskell-function-to-expand-environment-variables", "closed_reason": "Not suitable for this site", "title": "Standard Haskell function to expand environment variables", "body": "<p>I'm looking for something similar to Python's <code>os.path.expandvars</code> in Haskell, i.e., a <code>FilePath -&gt; IO FilePath</code> function that is</p>\n\n<ul>\n<li>Cross-platform (supports both Windows <code>%VAR%</code> and Unix <code>$VAR</code> styles)</li>\n<li>Standard (I don't want to write my own function for that).</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>&gt; expandVars \"$HOME/foo/bar\"\n\"/home/someuser/foo/bar\"\n</code></pre>\n\n<p>I've searched on Hoogle, Hayoo and Google but found nothing, which is surprising given the number of cross-platform Haskell tools. The closest I found is <a href=\"https://hackage.haskell.org/package/chatty-0.7.0.1/docs/src/Text-Chatty-Expansion-Vars.html\" rel=\"nofollow noreferrer\">this Unix-only implementation</a>. Perhaps there is some project which implements this as a subroutine?</p>\n"}, {"tags": ["haskell", "signature", "fold", "type-mismatch"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1513688297, "post_id": 47887574, "comment_id": 82740788, "body": "No it does not, since the type depends on the value <i>at runtime</i> whereas types are something statically <i>at compile time</i>. If I make the list one element longer, it will be a different type."}, {"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513688558, "post_id": 47887574, "comment_id": 82740979, "body": "which type is the one you are referring to now?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513688578, "post_id": 47887574, "comment_id": 82740994, "body": "The output type of the hypthetical <code>foldl</code> function."}, {"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513688754, "post_id": 47887574, "comment_id": 82741113, "body": "Okay, so you mean because the tuple would be one element longer and tuple type is determined also by the arity of the tuple, yes?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1513688834, "post_id": 47887574, "comment_id": 82741165, "body": "The arity will not be different. But for three elements, the output type would be <code>((a,a),a)</code> whereas for four, it would be <code>(((a,a),a),a)</code>. Those are two different types."}, {"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513688926, "post_id": 47887574, "comment_id": 82741246, "body": "oh yea, right. But is this function that I have in mind possible at all then?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1513688974, "post_id": 47887574, "comment_id": 82741269, "body": "@Iotolmence: not with a tuple, but with a list-like data structure."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1513747311, "post_id": 47887574, "comment_id": 82765081, "body": "This isn&#39;t an exact duplicate, but it shares a lot of features of the recent question <a href=\"https://stackoverflow.com/q/47844729/625403\">stackoverflow.com/q/47844729/625403</a> - you may find some useful ideas there."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 6, "last_activity_date": 1513690622, "creation_date": 1513690622, "answer_id": 47888232, "question_id": 47887574, "link": "https://stackoverflow.com/questions/47887574/use-fold-with-a-function-that-does-not-have-the-correct-signature/47888232#47888232", "title": "Use fold with a function that does not have the correct signature", "body": "<p>The issue here is to do with types, namely that this leads to conflicting type signatures.</p>\n\n<p>Let's take an example. If we take this:</p>\n\n<pre><code>foldl brace_it 0 [1] = (0,1) --(Not correct Haskell)\n</code></pre>\n\n<p>So, clearly, <code>foldl  brace_it 0 :: [Int] -&gt; (Int, Int)</code>. However:</p>\n\n<pre><code>foldl brace_it 0 [1,2] = ((0,1),2) --(Not correct Haskell)\n</code></pre>\n\n<p>So, clearly, <code>foldl  brace_it 0 :: [Int] -&gt; ((Int, Int), Int)</code>. This is spurious.</p>\n\n<hr>\n\n<p>So, why isn't this theoretically possible? Because Haskell programs require you to know all types at compile time - you can't make a function that <em>could</em> construct an <code>(Int, Int)</code> or and <code>((Int, Int), Int)</code> - you need to do some acrobatics with types. For instance, you might construct a type that allows you to pair arbitrarily many things together:</p>\n\n<pre><code>data Pairs a = None | Pair a (Pairs a)\n</code></pre>\n\n<p>Then your <code>brace_it</code> function would become <code>brace_it a b = Pair a (Pair b None)</code>.</p>\n\n<p>However, this is exactly equivalent to a normal Haskell list. So use a list.</p>\n"}], "owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 47888232, "answer_count": 1, "score": 2, "last_activity_date": 1513690622, "creation_date": 1513688195, "question_id": 47887574, "link": "https://stackoverflow.com/questions/47887574/use-fold-with-a-function-that-does-not-have-the-correct-signature", "title": "Use fold with a function that does not have the correct signature", "body": "<p>I have the following function:</p>\n\n<pre><code>brace_it :: a -&gt; b -&gt; (a, b)\nbrace_it a b = (a, b)\n</code></pre>\n\n<p>I can do <code>brace_it (brace_it (brace_it 1 2) 3) 4</code> with it an correctly get <code>(((1,2),3),4)</code>.</p>\n\n<p>But I'd like to do  <code>foldl brace_it 0 [1,2,3,4]</code>. This is not possible however, as <code>brace_it</code> does not have the correct signature (it needs <code>b -&gt; a -&gt; b</code>). However conceptually it makes sense to fold a list with it, I think, to get the same result as manually applying it to <code>1</code>,...,<code>4</code>. Is it possible to build something to plug in-between <code>foldl</code>/ <code>foldr</code> and a function that does not actually have the correct type but still would in a way make sense to apply folds to?</p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1513685830, "post_id": 47886628, "comment_id": 82739288, "body": "Um, <code>module Hart   ( module Hart   , ask   )</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 1, "last_activity_date": 1513707871, "creation_date": 1513707871, "answer_id": 47893060, "question_id": 47886628, "link": "https://stackoverflow.com/questions/47886628/how-do-i-export-a-function-from-an-imported-module/47893060#47893060", "title": "How do I export a function from an imported module?", "body": "<p>As @leftaroundabout mentioned in the comments, to re-export functions, you simply include that function in your export list: </p>\n\n<pre><code>module Hart \n  ( module Hart\n  , ask \n  ) where \n...\nimport Control.Monad.Trans.Reader (ask)\n</code></pre>\n\n<p>This will also work for qualified imports with the caveat that the namespace is not captured in the export. </p>\n\n<pre><code>module Hart \n  ( module Hart\n  , ask \n  , T.null\n  ) where \n...\nimport Control.Monad.Trans.Reader (ask)\nimport qualified Data.Text as T\n</code></pre>\n\n<p>And in some other file: </p>\n\n<pre><code>  module Other where \n\n  import Hart (ask, null)\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 47893060, "answer_count": 1, "score": 1, "last_activity_date": 1513707871, "creation_date": 1513685095, "question_id": 47886628, "link": "https://stackoverflow.com/questions/47886628/how-do-i-export-a-function-from-an-imported-module", "title": "How do I export a function from an imported module?", "body": "<pre><code>module Hart\n  ( module Hart\n  )\n where\n\nimport Control.Monad.Trans.Reader (runReaderT, ReaderT, ask)\nimport Control.Monad.Trans (lift)\n</code></pre>\n\n<p>I currently have the above defined. How can I export <strong>only</strong> the <code>ask</code> function from <code>Control.Monad.Trans.Reader</code> in addition to the <code>Hart</code> module?</p>\n\n<p>I was thinking I could do the below - but it generates an error:</p>\n\n<pre><code>module Hart\n  ( module Hart\n  , module Control.Monad.Trans.Reader (ask)\n  ) where\n</code></pre>\n"}, {"tags": ["sql", "haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1513679632, "post_id": 47883943, "comment_id": 82735614, "body": "Can you add a simplified DB schema, along with a minified working example (with Stack interpreter if possible) ?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1513679878, "post_id": 47883943, "comment_id": 82735788, "body": "Have you read this? <a href=\"https://www.yesodweb.com/book/persistent\" rel=\"nofollow noreferrer\">yesodweb.com/book/persistent</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 0, "last_activity_date": 1513683224, "creation_date": 1513683224, "answer_id": 47886104, "question_id": 47883943, "link": "https://stackoverflow.com/questions/47883943/select-records-in-date-range-using-yesod-persist/47886104#47886104", "title": "Select records in date range using Yesod.Persist", "body": "<p>So I found out you can get the records before and after a date by adding a filter </p>\n\n<p><code>[TableDateColumn &lt;=. UTCTime]</code></p>\n\n<p>To get the records with a date before now you can use</p>\n\n<pre><code>getBeforeDate = do\n    now &lt;- liftIO getCurrentTime\n    selectList [TableDateColumn &lt;=. Just now] []\n</code></pre>\n\n<p>I haven't verified this yet but as <code>selectList</code> takes a list of filters it would make sense for selecting between a range to be</p>\n\n<pre><code>selectList [TableDateColumn &gt;=. timeStart, TableDateColumn &lt;=. timeEnd] []\n</code></pre>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 47886104, "answer_count": 1, "score": 0, "last_activity_date": 1513828817, "creation_date": 1513676342, "last_edit_date": 1513828817, "question_id": 47883943, "link": "https://stackoverflow.com/questions/47883943/select-records-in-date-range-using-yesod-persist", "title": "Select records in date range using Yesod.Persist", "body": "<p>I need to select all records in a table where a columns date is between 2 dates, before a date or after a date.</p>\n\n<p>I can see the <a href=\"https://hackage.haskell.org/package/persistent-0.9.0.4/docs/Database-Persist.html#v:selectList\" rel=\"nofollow noreferrer\"><code>selectList</code></a> function takes a parameter <a href=\"https://hackage.haskell.org/package/persistent-0.9.0.4/docs/Database-Persist.html#t:Filter\" rel=\"nofollow noreferrer\"><code>Filter</code></a> which seems to be what I would need to select records by a date range but I can't work out what I would need to put in the filter parameter to select by a range or before and after a date.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513745916, "post_id": 47881480, "comment_id": 82764684, "body": "I don&#39;t like <code>fromListWith</code> because it&#39;s too hard to remember which way the combining function is applied. I&#39;d much rather see something like <code>(a -&gt; b) -&gt; (a -&gt; b -&gt; b) -&gt; [(k, a)] -&gt; Map k b</code>, but even that needs to specify the order in which list elements are added to the <code>Map</code>. Hrmph. Maybe you&#39;ll have a good idea, in which case I can add it to <code>Data.Map</code>."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513820918, "post_id": 47881480, "comment_id": 82801655, "body": "@dfeuer, I actually <i>do</i> have an idea.  Consider: <code>fromFold :: (Ord k, Monoid m, Foldable t) =&gt; t (k, m) -&gt; Map k m</code> . By implicitly using the associative monoid op, it doesn&#39;t matter which argument is the value being &quot;inserted&quot; -- ultimately, each key is mapped to the <code>mconcat</code> of the list of values for the key (with values ordered the same as the input list).  Add <code>fromFoldr :: (Ord k, Foldable t) =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t (k, a) -&gt; Map k b</code> (and <code>fromFoldl</code>) to avoid explicit monoid instances, and it starts looking pretty good.  Maybe I should propose something to libraries@haskell.org?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513824917, "post_id": 47881480, "comment_id": 82802495, "body": "Consider the performance impact of <code>a++(b++c)</code> vs <code>(a++b)++c</code>."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513831612, "post_id": 47881480, "comment_id": 82804045, "body": "I&#39;m not sure I follow -- isn&#39;t this the same as the need to consider the performance impact of <code>foldMap</code> versus <code>foldr</code> versus <code>foldl</code> versus various strict variants?  Can you provide more detail?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513838908, "post_id": 47881480, "comment_id": 82806301, "body": "Right. You need to be aware how the fold associates the operations. And you&#39;ll often want multiple options."}, {"owner": {"reputation": 28880, "user_id": 471136, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70505981ff01b23b2d6da7ccb3c67785?s=128&d=identicon&r=PG", "display_name": "pathikrit", "link": "https://stackoverflow.com/users/471136/pathikrit"}, "edited": false, "score": 0, "creation_date": 1513868295, "post_id": 47881480, "comment_id": 82823327, "body": "Shall I accept this answer or is there a cleaner/better alternative?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 28880, "user_id": 471136, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70505981ff01b23b2d6da7ccb3c67785?s=128&d=identicon&r=PG", "display_name": "pathikrit", "link": "https://stackoverflow.com/users/471136/pathikrit"}, "edited": false, "score": 0, "creation_date": 1513879078, "post_id": 47881480, "comment_id": 82829231, "body": "@pathikrit, sorry for hijacking your question with these comments.  I think @dfeuer and I are both lamenting the fact that <code>fromListWith</code> is a little awkward and unintuitive, but right now it seems to be the best approach with current <code>Data.Map</code> API."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 8, "last_activity_date": 1513666467, "creation_date": 1513666467, "answer_id": 47881480, "question_id": 47881350, "link": "https://stackoverflow.com/questions/47881350/groupbykey-in-haskell-how-to-group-items-in-a-list-by-a-function/47881480#47881480", "title": "groupByKey in Haskell - How to group items in a list by a function?", "body": "<p>You can use <code>fromListWith</code>, like so:</p>\n\n<pre><code>import Data.Map\ngroupByKey :: (Ord k) =&gt; (v -&gt; k) -&gt; [v] -&gt; Map k [v]\ngroupByKey getkey\n  = fromListWith (++) . fmap (\\val -&gt; (getkey val, [val]))\n</code></pre>\n\n<p>so that:</p>\n\n<pre><code>&gt; groupByKey length $ words \"hello there my good friend\"\nfromList [(2,[\"my\"]),(4,[\"good\"]),(5,[\"there\",\"hello\"]),(6,[\"friend\"])]\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 28880, "user_id": 471136, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70505981ff01b23b2d6da7ccb3c67785?s=128&d=identicon&r=PG", "display_name": "pathikrit", "link": "https://stackoverflow.com/users/471136/pathikrit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 47881480, "answer_count": 1, "score": 4, "last_activity_date": 1513681611, "creation_date": 1513665843, "last_edit_date": 1513681611, "question_id": 47881350, "link": "https://stackoverflow.com/questions/47881350/groupbykey-in-haskell-how-to-group-items-in-a-list-by-a-function", "title": "groupByKey in Haskell - How to group items in a list by a function?", "body": "<p>Given a list <code>[v]</code> and a keying function <code>f :: v -&gt; k</code>, I want to generate a map <code>Map k [v]</code>. Does something like this exist in Haskell?</p>\n\n<pre><code>import Data.Map\n\ngroupByKey :: (v -&gt; k) -&gt; [v] -&gt; Map k [v]\n</code></pre>\n"}, {"tags": ["haskell", "sdl"], "answers": [{"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 1, "last_activity_date": 1513684605, "creation_date": 1513684605, "answer_id": 47886486, "question_id": 47880351, "link": "https://stackoverflow.com/questions/47880351/sdl-cairo-canvas-not-found-even-if-the-newest-version-of-sdl0-6-6-0-has-been-i/47886486#47886486", "title": "SDL.Cairo.Canvas not found even if the newest version of SDL(0.6.6.0) has been installed", "body": "<p><code>SDL.Cairo.Canvas</code> is not in the sdl2 package. It is in older versions of the <a href=\"https://hackage.haskell.org/package/sdl2-cairo\" rel=\"nofollow noreferrer\">sdl2-cairo</a> package (before 0.2). You can install that with cabal or stack or whatever else you use to install packages.</p>\n\n<p>Alternatively one can find the equivalent module in <a href=\"https://hackage.haskell.org/package/cairo-canvas\" rel=\"nofollow noreferrer\">cairo-canvas</a> as <code>Graphics.Rendering.Cairo.Canvas</code>.</p>\n"}], "owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 47886486, "answer_count": 1, "score": 0, "last_activity_date": 1513684605, "creation_date": 1513660243, "last_edit_date": 1513660918, "question_id": 47880351, "link": "https://stackoverflow.com/questions/47880351/sdl-cairo-canvas-not-found-even-if-the-newest-version-of-sdl0-6-6-0-has-been-i", "title": "SDL.Cairo.Canvas not found even if the newest version of SDL(0.6.6.0) has been installed", "body": "<p>Right after I installed the newest version of haskell binding version of SDL(0.6.6.0), though I can import SDL.Cairo, I still can not import SDL.Cairo.Canvas:</p>\n\n<pre><code>Prelude&gt; install SDL.Cairo.Canvas\n\n&lt;interactive&gt;:1:9: error:\n    Not in scope: data constructor \u2018SDL.Cairo.Canvas\u2019\n    No module named \u2018SDL.Cairo\u2019 is imported.\nPrelude&gt; import SDL.Cairo.Canvas as Canvas\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018SDL.Cairo.Canvas\u2019\n    It is not a module in the current program, or in any known package.\n</code></pre>\n\n<p>So, is SDL.Cairo.Canvas only available in the older versions? Or is it caused by incorrect installation?</p>\n"}, {"tags": ["haskell", "gtk3"], "comments": [{"owner": {"reputation": 1291, "user_id": 6813490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/suHzE.jpg?s=128&g=1", "display_name": "Zach Valenta", "link": "https://stackoverflow.com/users/6813490/zach-valenta"}, "edited": false, "score": 0, "creation_date": 1513712991, "post_id": 47879456, "comment_id": 82755060, "body": "can you post error msg?"}], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513716256, "post_id": 47894852, "comment_id": 82756498, "body": "The constructor \u2018Just\u2019 should have 1 argument, but has been given none"}, {"owner": {"reputation": 811, "user_id": 605690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80f25d1101931a7a7b92d642647359d?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Rezvov", "link": "https://stackoverflow.com/users/605690/ilya-rezvov"}, "reply_to_user": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513716557, "post_id": 47894852, "comment_id": 82756628, "body": "@ruby_object Forgotten parentheses around pattern in lambda. I updated the answer"}, {"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513716797, "post_id": 47894852, "comment_id": 82756722, "body": "We are getting somewhere, I got this error now: Couldn&#39;t match type \u2018GHC.Int.Int32\u2019 with \u2018Char\u2019   Expected type: String     Actual type: [GHC.Int.Int32]"}, {"owner": {"reputation": 811, "user_id": 605690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80f25d1101931a7a7b92d642647359d?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Rezvov", "link": "https://stackoverflow.com/users/605690/ilya-rezvov"}, "reply_to_user": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513717023, "post_id": 47894852, "comment_id": 82756816, "body": "@ruby_object We are almost there. Error message is pretty explicit <code>listBoxRowGetIndex</code> returns list of numbers but <code>putStrLn</code> waits for <code>String</code>. You can &quot;cast&quot; anything showable to <code>String</code> with <code>show</code> - <code>putStrLn $ show $ listBoxRowGetIndex row</code> or you can use <code>print</code> as shortcut <code>print $ listBoxRowGetIndex row</code>"}, {"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513717203, "post_id": 47894852, "comment_id": 82756889, "body": "onListBoxRowSelected listbox2 (&#40;Just row) -&gt; putStrLn $ show $ listBoxRowGetIndex row)  gives this error: Ambiguous type variable \u2018m0\u2019 arising from a use of \u2018show\u2019   prevents the constraint \u2018(Show                               (m0 GHC.Int.Int32))\u2019 from being solved.   Probable fix: use a type annotation to specify what \u2018m0\u2019 should be."}, {"owner": {"reputation": 811, "user_id": 605690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80f25d1101931a7a7b92d642647359d?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Rezvov", "link": "https://stackoverflow.com/users/605690/ilya-rezvov"}, "reply_to_user": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513717503, "post_id": 47894852, "comment_id": 82757020, "body": "@ruby_object I checked Hackage doc. <code>listBoxRowGetIndex</code> is not pure function. So we have to use IO monad - <code>onListBoxRowSelected listbox2 (\\(Just row) -&gt; listBoxRowGetIndex row &gt;&gt;= print)</code>"}, {"owner": {"reputation": 811, "user_id": 605690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80f25d1101931a7a7b92d642647359d?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Rezvov", "link": "https://stackoverflow.com/users/605690/ilya-rezvov"}, "reply_to_user": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513717665, "post_id": 47894852, "comment_id": 82757093, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/161555/discussion-between-ilya-rezvov-and-ruby-object\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "edited": false, "score": 0, "creation_date": 1513719518, "post_id": 47894852, "comment_id": 82757870, "body": "Ilya Rzvov&#39;s suggestions have worked. How should I update the question so it helps the next person with the same question?"}], "tags": [], "owner": {"reputation": 811, "user_id": 605690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80f25d1101931a7a7b92d642647359d?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Rezvov", "link": "https://stackoverflow.com/users/605690/ilya-rezvov"}, "is_accepted": true, "score": 1, "last_activity_date": 1513718353, "last_edit_date": 1513718353, "creation_date": 1513716041, "answer_id": 47894852, "question_id": 47879456, "link": "https://stackoverflow.com/questions/47879456/how-do-i-handle-clicks-on-a-listbox-in-haskells-gi-gtk-library/47894852#47894852", "title": "How do I handle clicks on a listBox in Haskells gi-gtk library", "body": "<p>Callback argument type is <code>Maybe GI.Gtk.Objects.ListBoxRow.ListBoxRow</code>. It could be <code>Nothing</code> if nothing is selected. <code>listBoxRowGetIndex</code> has polymorphic type for its argument, so it tries to find instance for <code>Maybe GI.Gtk.Objects.ListBoxRow.ListBoxRow</code>, but there is no such instance. Minimal working code is</p>\n\n<pre><code>onListBoxRowSelected listbox2 (\\(Just row) -&gt; listBoxRowGetIndex row &gt;&gt;= print)\n</code></pre>\n\n<p>But it is better to handle <code>Nothing</code> case properly considering application logic.</p>\n"}], "owner": {"reputation": 1059, "user_id": 1395810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/434085debcc69044679269ce84d5dad1?s=128&d=identicon&r=PG", "display_name": "ruby_object", "link": "https://stackoverflow.com/users/1395810/ruby-object"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 47894852, "answer_count": 1, "score": -1, "last_activity_date": 1513718353, "creation_date": 1513652668, "last_edit_date": 1513715507, "question_id": 47879456, "link": "https://stackoverflow.com/questions/47879456/how-do-i-handle-clicks-on-a-listbox-in-haskells-gi-gtk-library", "title": "How do I handle clicks on a listBox in Haskells gi-gtk library", "body": "<p>I am experimenting with using Gtk and Haskell. And I got stuck. This link shows my experiments.\n<a href=\"https://github.com/bigos/my-haskell-gtk-3-tutorial/blob/master/5-layout-containers.org#edit-the-source-2\" rel=\"nofollow noreferrer\">https://github.com/bigos/my-haskell-gtk-3-tutorial/blob/master/5-layout-containers.org#edit-the-source-2</a></p>\n\n<p>I am trying to print the index of clicked list box row. The following code gives me a type error that I do not understand.</p>\n\n<pre><code> onListBoxRowSelected listbox2 (\\row -&gt; putStrLn (listBoxRowGetIndex row))\n</code></pre>\n\n<p>I need an example where I can see how someone can properly handle the click events on the listBox rows.</p>\n\n<h2>the error message</h2>\n\n<blockquote>\n  <p>Required ancestor \u2018GI.Gtk.Objects.ListBoxRow.ListBoxRow\u2019 not found for\n  type \u2018Maybe GI.Gtk.Objects.ListBoxRow.ListBoxRow\u2019. \u2022 In the first\n  argument of \u2018putStrLn\u2019, namely \u2018(listBoxRowGetIndex row)\u2019 In the\n  expression: putStrLn (listBoxRowGetIndex row) In the second argument\n  of \u2018onListBoxRowSelected\u2019, namely</p>\n</blockquote>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 5, "last_activity_date": 1513655081, "creation_date": 1513655081, "answer_id": 47879743, "question_id": 47878829, "link": "https://stackoverflow.com/questions/47878829/how-do-i-build-a-package-against-multiple-resolvers/47879743#47879743", "title": "How do I build a package against multiple resolvers", "body": "<p>Set the resolver from the command line, overriding whatever is in <code>stack.yaml</code>:</p>\n\n<pre><code>stack --resolver lts-X.Y [build|test|exec|...]\n</code></pre>\n\n<p>A more persistent solution is to have different <code>.yaml</code> configurations in your repository, that you can select using <code>--stack-yaml</code></p>\n\n<pre><code>stack build   # default is stack.yaml\nstack --stack-yaml my-stack-lts-X.Y.yaml build\nstack --stack-yaml my-stack-nightly-X-Y-Z.yaml build\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513655081, "creation_date": 1513647005, "question_id": 47878829, "link": "https://stackoverflow.com/questions/47878829/how-do-i-build-a-package-against-multiple-resolvers", "title": "How do I build a package against multiple resolvers", "body": "<p>How can I use <code>stack</code> to build and test a package against multiple resolvers?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513642230, "post_id": 47878216, "comment_id": 82722486, "body": "The type of <code>weaveHunks</code> says it produces a <code>[a]</code>. If you leave out the type signature and load that up in ghci, what does it tell you the type is?"}, {"owner": {"reputation": 113, "user_id": 7238559, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fd639a30f08a5db20e2e956e428eb20b?s=128&d=identicon&r=PG&f=1", "display_name": "daveyjones", "link": "https://stackoverflow.com/users/7238559/daveyjones"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513642892, "post_id": 47878216, "comment_id": 82722682, "body": "I removed the type signature and :t gave me &#39;weaveHunks :: p -&gt; [a] -&gt; [a] -&gt; [a]&#39;"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513643218, "post_id": 47878216, "comment_id": 82722754, "body": "Oh, sorry, I missed something; you&#39;ll have to delete the first two lines to get that type info. Anyway, you got your answer."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7238559, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fd639a30f08a5db20e2e956e428eb20b?s=128&d=identicon&r=PG&f=1", "display_name": "daveyjones", "link": "https://stackoverflow.com/users/7238559/daveyjones"}, "edited": false, "score": 0, "creation_date": 1513642530, "post_id": 47878253, "comment_id": 82722573, "body": "Ah, I see, thank you. Can I ask also, what does &lt;$&gt; mean?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1513642615, "post_id": 47878253, "comment_id": 82722606, "body": "It\u2019s fmap but as an infix operator. For lists, fmap = map for historical reasons."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1513642089, "creation_date": 1513642089, "answer_id": 47878253, "question_id": 47878216, "link": "https://stackoverflow.com/questions/47878216/haskell-weave-two-lists-together-in-chunks-of-n-size/47878253#47878253", "title": "Haskell - Weave two lists together in chunks of n size?", "body": "<p>You're very close!</p>\n\n<p>By using the <code>:</code> operator to prepend the hunks, you're expressing that <code>take n xs</code> is one element of the result list, <code>take n ys</code> the next, and so on. But actually in both cases it's <em>multiple</em> elements you're prepending. That's the <code>[a]</code> that should actually be just <code>a</code>.</p>\n\n<p>The solution is to use the <code>++</code> operator instead, which prepends an entire list rather than just a single element.</p>\n\n<p>This is the full solution as I'd write it:</p>\n\n<pre><code>weaveHunks :: Int -&gt; [a] -&gt; [a] -&gt; [a]\nweaveHunks _ xs [] = xs\nweaveHunks _ [] ys = ys\nweaveHunks n xs ys = xHunk ++ yHunk ++ weaveHunks n xRemain yRemain\n where [(xHunk, xRemain), (yHunk, yRemain)] = splitAt n &lt;$&gt; [xs,ys]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1513679630, "post_id": 47884605, "comment_id": 82735613, "body": "have you tested your 2nd solution with two lists of radically different sizes? zip tends to cut off a dangling tail on size mismatch."}], "tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1513678374, "creation_date": 1513678374, "answer_id": 47884605, "question_id": 47878216, "link": "https://stackoverflow.com/questions/47878216/haskell-weave-two-lists-together-in-chunks-of-n-size/47884605#47884605", "title": "Haskell - Weave two lists together in chunks of n size?", "body": "<p>As @leftaroundabout said, since your appending lists of type <code>[a]</code>, you need to use <code>++</code> instead of <code>:</code>. With this in mind, your code would then look like this:</p>\n\n<pre><code>weaveHunks :: Int -&gt; [a] -&gt; [a] -&gt; [a]\nweaveHunks _ xs [] = xs\nweaveHunks _ [] ys = ys\nweaveHunks n xs ys = (take n xs) ++ (take n ys) ++ weaveHunks n (drop n xs) (drop n ys)\n</code></pre>\n\n<p>If your interested, you can also use library functions to do this task:</p>\n\n<pre><code>import Data.List.Split\n\nweaveHunks :: Int -&gt; [a] -&gt; [a] -&gt; [a]\nweaveHunks n xs ys = concat $ zipWith (++) (chunksOf n xs) (chunksOf n ys)\n</code></pre>\n\n<p><strong>Note:</strong> <a href=\"https://hackage.haskell.org/package/split-0.2.3.2/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\"><code>chunksOf</code></a> is from <code>Data.List.Split</code>, which splits the list into sublists of length <code>n</code>, so the type of this function is <code>Int -&gt; [a] -&gt; [[a]]</code>. <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:zipWith\" rel=\"nofollow noreferrer\"><code>zipWith</code></a> zips two lists based on a condition, in this case concatenation <code>++</code>. <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:concat\" rel=\"nofollow noreferrer\"><code>concat</code></a> turns a list of <code>[[a]]</code> into <code>[a]</code>. </p>\n"}], "owner": {"reputation": 113, "user_id": 7238559, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fd639a30f08a5db20e2e956e428eb20b?s=128&d=identicon&r=PG&f=1", "display_name": "daveyjones", "link": "https://stackoverflow.com/users/7238559/daveyjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 47878253, "answer_count": 2, "score": 1, "last_activity_date": 1513678374, "creation_date": 1513641789, "question_id": 47878216, "link": "https://stackoverflow.com/questions/47878216/haskell-weave-two-lists-together-in-chunks-of-n-size", "title": "Haskell - Weave two lists together in chunks of n size?", "body": "<p>I am practicing some Haskell exam paper questions, and have come across the following</p>\n\n<p>Define a Haskell function weaveHunks which takes an int and\ntwo lists and weaves them together in hunks of the given size.\nBe sure to declare its type signature.</p>\n\n<p>Example:</p>\n\n<p>weaveHunks 3 \"abcdefghijklmno\" \"ABCDEFGHIJKLMNO\"</p>\n\n<p>=> \"abcABCdefDEFghiGHIjklJKLmnoMNO\"</p>\n\n<p>I have found the following on Stack Overflow, which is just too weave two lists together but only in chunks of 1</p>\n\n<pre><code>weaveHunks :: [a] -&gt; [a] -&gt; [a]\nweaveHunks xs [] = xs\nweaveHunks [] ys = ys\nweaveHunks (x:xs) (y:ys) = x : y : weaveHunks xs ys\n</code></pre>\n\n<p>I am having problems adjusting this to take chunks fo n size, I am very new to Haskell but this is what I have so far</p>\n\n<pre><code>weaveHunks :: Int -&gt; [a] -&gt; [a] -&gt; [a]\nweaveHunks n xs [] = xs\nweaveHunks n [] ys = ys\nweaveHunks n xs ys = (take n xs) : (take n ys) : weaveHunks n (drop n xs) (drop n ys)\n</code></pre>\n\n<p>I am getting an error on the last line</p>\n\n<blockquote>\n  <p>(Couldn't match type <code>a' with</code>[a]')</p>\n</blockquote>\n\n<p>Is <code>(drop n xs)</code> not a list? </p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1513632800, "post_id": 47876711, "comment_id": 82719017, "body": "Why are you using <code>do</code> notation? What Monad do you think you are using?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1513633321, "post_id": 47876711, "comment_id": 82719284, "body": "Please do not use <code>do</code> notation, unless you are convinced that you need <i>monads</i> (you do not need these here), and furthermore the same applis for <code>return</code>."}, {"owner": {"reputation": 24913, "user_id": 1300910, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/se92W.jpg?s=128&g=1", "display_name": "huysentruitw", "link": "https://stackoverflow.com/users/1300910/huysentruitw"}, "edited": false, "score": 0, "creation_date": 1513633496, "post_id": 47876711, "comment_id": 82719370, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7376937/fastest-way-to-get-the-last-element-of-a-list-in-haskell\">Fastest way to get the last element of a list in Haskell</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513640135, "post_id": 47876711, "comment_id": 82721918, "body": "<code>==</code> is a library function (actually, a class method). Although there&#39;s no reason to avoid library functions in general, you actually want to avoid <code>==</code> here because using it the way you do imposes an <code>Eq</code> constraint on the elements of the list. You could replace <code>xs == []</code> with <code>null xs</code> to solve the problem, but it seems a bit nicer to just do more pattern matching."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513640843, "post_id": 47876711, "comment_id": 82722109, "body": "Importing <code>Data.Monoid (Last (..))</code> and <code>Data.Maybe (fromJust)</code>, we can write <code>last = fromJust . getLast . foldMap (Last . Just)</code>. As everyone knows, <code>fromJust</code> is a terrible idea, so we should instead write <code>last = getLast . foldMap (Last . Just)</code>. That gives us a somewhat different (but better!) type for <code>last</code>."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 1, "creation_date": 1513670923, "post_id": 47876711, "comment_id": 82730640, "body": "I think you should check what actually <code>return</code> does. It is <i>not</i> that return you know from other languages. In Haskell you should understand it as &quot;return to the monad&quot;, so <code>return :: a -&gt; [a]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1513644133, "creation_date": 1513644133, "answer_id": 47878506, "question_id": 47876711, "link": "https://stackoverflow.com/questions/47876711/find-last-element-of-a-list-in-haskell/47878506#47878506", "title": "find last element of a list in haskell", "body": "<p>let's start with the signature of your function</p>\n\n<pre><code>myLast :: [a] -&gt; a\n</code></pre>\n\n<p>now, for an empty list input, what can be expected as the output?  How you can make up an instance of an arbitrary type <code>a</code>?  </p>\n\n<p>Alternatively, you can defer the handling of missing last element to the callers of your function.</p>\n\n<pre><code>myLast :: [a] -&gt; Maybe a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1513713236, "creation_date": 1513713236, "answer_id": 47894263, "question_id": 47876711, "link": "https://stackoverflow.com/questions/47876711/find-last-element-of-a-list-in-haskell/47894263#47894263", "title": "find last element of a list in haskell", "body": "<p>You want</p>\n\n<pre><code>myLast (x:xs) =\n</code></pre>\n\n<p>to be equal to</p>\n\n<pre><code>                if xs == [] then x else (myLast xs)\n</code></pre>\n\n<p>Great, <code>xs == []</code>, so let's just put it back in:</p>\n\n<pre><code>myLast (x:[]) =                  x \n</code></pre>\n\n<p>but what about the <code>else</code> part? Well, let's add another equation for that,</p>\n\n<pre><code>myLast (_:xs) =                          myLast xs\n</code></pre>\n\n<p>and we're golden. </p>\n\n<p>What if we call it with an empty list <code>[]</code> though? No definition case will <em>match</em>, and we will get some kind of a run-time error. Well, same thing happens with the built-in function <code>last</code> too, so we're no better and <em>no worse</em> than Haskell itself here.</p>\n\n<p>What is that <em>match</em> that I mentioned, you ask? That's how Haskell functions get invoked. Each function definition can have several clauses, starting with the function's  name, and containing a <em>pattern</em> for each expected argument.</p>\n\n<p>In a left hand side of an equation,</p>\n\n<ul>\n<li><p><code>(x:[])</code> is a pattern, matching any singleton list. It can also be written <code>[x]</code>. <code>x</code> will  refer to the list's only element, if used in the right-hand side of the equation.</p></li>\n<li><p><code>[]</code> is a pattern, matching any empty list.</p></li>\n<li><p><code>(x:xs)</code> is a pattern, matching any non-empty list.  <code>x</code> will  refer to the list's <em>head</em> (i.e. first) element, if used in the right-hand side of the equation; and <code>xs</code> will refer to the <em>rest</em> of the elements in a list (which are also, a list -- also known as its <em>tail</em>).</p></li>\n</ul>\n\n<p>But wait, you ask. Wouldn't <em>both</em> clauses <em>match</em> for a singleton list, the first for the pattern <code>[x]</code> and the second for <code>(_:xs)</code> with <code>xs</code> matched up with an <em>empty list</em>, <code>[]</code>?</p>\n\n<p>Why yes, they both <em>would</em> match indeed; <code>(x:[])</code> and <code>(_:xs)</code> are <em>not</em> mutually exclusive. </p>\n\n<p>But that's OK, because in Haskell, if the first clause has matched, that's it -- <em>that</em> is the clause that gets executed, and no other attempts at any additional pattern matching and clause selection are made.</p>\n\n<p>That would be Prolog, and that's quite another language.</p>\n"}], "owner": {"reputation": 377, "user_id": 8140404, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f1c26015079511b622e275f01e7e105a?s=128&d=identicon&r=PG&f=1", "display_name": "plx", "link": "https://stackoverflow.com/users/8140404/plx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1952, "favorite_count": 0, "accepted_answer_id": 47894263, "answer_count": 2, "score": 1, "last_activity_date": 1513713236, "creation_date": 1513632741, "last_edit_date": 1513638218, "question_id": 47876711, "link": "https://stackoverflow.com/questions/47876711/find-last-element-of-a-list-in-haskell", "title": "find last element of a list in haskell", "body": "<p>I wrote the following code to find the last element of a list in haskell:</p>\n\n<pre><code>myLast (x:xs) = do\n    ret &lt;- if xs == [] then x else (myLast xs)\n    return ret\n</code></pre>\n\n<p>The idea is to traverse the list until we are at an element which has the empty list as its next element. When we find it we set <code>ret</code> to that element.\nIt makes sense for me but when I run the code inside the interactive shell I get the following error:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: error:\n    \u2022 No instance for (Num (m0 b0)) arising from a use of \u2018it\u2019\n    \u2022 In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p><strong>edit 1</strong></p>\n\n<p>The reason I used <code>do</code> was because I saw that pattern being used somewhere  to also traverse a list, so I thought I could do the same here. I'am avoiding libraries for now to get comfortable with the language.\nI wrote the function avoiding the do keyword and now it works:</p>\n\n<pre><code>myLast(x:xs) = if xs == [] then x else (myLast xs)\n</code></pre>\n\n<p>There's now just an issue with the empty list case. How to approach this in haskell?</p>\n"}, {"tags": ["class", "haskell", "types", "ambiguous"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1513656984, "last_edit_date": 1513656984, "creation_date": 1513636456, "answer_id": 47877413, "question_id": 47876673, "link": "https://stackoverflow.com/questions/47876673/why-does-haskell-says-this-is-ambiguous/47877413#47877413", "title": "Why does Haskell says this is ambiguous?", "body": "<p><code>Test</code> is injective, since it is a type constructor.</p>\n\n<p><code>Relation</code> is not injective, since it is a type family.</p>\n\n<p>Hence the ambiguity.</p>\n\n<p>Silly example:</p>\n\n<pre><code>type instance Relation Bool = ()\ntype instance Relation String = ()\n\ninstance Repo Bool Ne where\n   eTable :: Table ()\n   eTable = someEtable1\n\ninstance Repo String Ne where\n   eTable :: Table ()\n   eTable = someEtable2\n</code></pre>\n\n<p>Now, what is <code>eTable :: Table ()</code> ? It could be the one from the first or the second instance. It is ambiguous since <code>Relation</code> is not injective.</p>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 3, "last_activity_date": 1513644276, "creation_date": 1513644276, "answer_id": 47878526, "question_id": 47876673, "link": "https://stackoverflow.com/questions/47876673/why-does-haskell-says-this-is-ambiguous/47878526#47878526", "title": "Why does Haskell says this is ambiguous?", "body": "<p>The source of the ambiguity actually has nothing to do with <code>ne</code> not being used in the class (which you headed off by using functional dependencies).</p>\n\n<p>The key part of the error message is:</p>\n\n<pre><code>  Expected type: Table (Relation e)\n    Actual type: Table (Relation e0)\n  NB: `Database.Selda.Generic.Rel' is a type function, and may not be injective\n</code></pre>\n\n<p>Note that it's the <code>e</code> that it's having trouble matching up, and the NB message drawing your attention to the issue of type functions and injectivity (you really have to know what that all means for the message to be useful, but it has all the terms you need to look up to understand what's going on, so it's quite good as programming error messages go).</p>\n\n<p>The issue it's complaining about is a key difference between type constructors and type families. Type <strong>constructors</strong> are always injective, while type functions in general (and type families in particular) do not have to be.</p>\n\n<p>In standard Haskell with no extensions, the only way you can build compound type expressions was using type <em>constructors</em>, such as the left-hand side <code>Test</code> in your <code>data Test a = Test a</code>. I can apply <code>Test</code> (of kind <code>* -&gt; *</code>) to a type like <code>Int</code> (of kind <code>*</code>) to get a type <code>Test Int</code> (of kind <code>*</code>). Type constructors are <a href=\"https://en.wikipedia.org/wiki/Injective_function\" rel=\"nofollow noreferrer\">injective</a>, which means for any two distinct types <code>a</code> and <code>b</code>, <code>Test a</code> is a distinct type from <code>Test b</code><sup>1</sup>. This means that when type checking you can \"run them backwards\"; if I've got two types <code>t1</code> and <code>t2</code> that are each the result of applying <code>Test</code>, and I know that <code>t1</code> and <code>t2</code> are supposed to be equal, then I can \"unapply\" <code>Test</code> to get the argument types and check whether those are equal (or infer what one of them is if it was something I hadn't figured out yet and the other is known, or etc).</p>\n\n<p>Type families (or any other form of type function that isn't known to be injective) don't provide us that guarantee. If I have two types <code>t1</code> and <code>t2</code> that are supposed to be equal, and they're both the result of applying some <code>TypeFamily</code>, there's no way to go from the resulting types to the types that <code>TypeFamily</code> was applied to. And in particular, there's no way to conclude from the fact that <code>TypeFamily a</code> and <code>TypeFamily b</code> are equal that <code>a</code> and <code>b</code> are equal as well; the type family might just happen to map two distinct types <code>a</code> and <code>b</code> to the same result (the <em>definition</em> of injectivitiy is that it doesn't do that). So if I knew which type <code>a</code> was but didn't know <code>b</code>, knowing that <code>TypeFamily a</code> and <code>TypeFamily b</code> are equal doesn't give me any more information about what type <code>b</code> should be.</p>\n\n<p>Unfortunately, since standard Haskell only has type constructors, Haskell programmers get well-trained to just presume that the type checker can work backwards through compound types to connect up the components. We often don't even notice that the type checker <em>needs</em> to work backwards, we're so used to just looking at type expressions with similar structure and leaping to the obvious conclusions without working through all the steps that the type checker has to go through. But because type checking is based on working out the type of every expression both bottom-up<sup>2</sup> and top-down<sup>3</sup> and confirming that they are consistent, type checking expressions whose types involve type families can easily run into ambiguity problems where it looks \"obviously\" unambiguous to us humans.</p>\n\n<p>In your <code>Repo</code> example, consider how the type checker will deal with a position where you use <code>eTable</code>, with <code>(Int, Bool)</code> for <code>e</code>, say. The top-down view will see that it's used in a context where some <code>Table (Relation (Int, Bool))</code> is required. It'll compute what <code>Relation (Int, Bool)</code> evaluates to: say it's  <code>Set Int</code>, so we need <code>Table (Set Int)</code>. The bottom-up pass just says <code>eTable</code> can be <code>Table (Relation e)</code> for any <code>e</code>.</p>\n\n<p>All of our experience with standard Haskell tells us that this is obvious, we just instantiate <code>e</code> to <code>(Int, Bool)</code>, <code>Relation (Int, Bool)</code> evaluates to <code>Set Int</code> again and we're done. But that's not actually how it works. Because <code>Relation</code> isn't injective there could be some other choice for <code>e</code> for which gives us <code>Set Int</code> for <code>Relation e</code>: perhaps <code>Int</code>. But if we choose <code>e</code> to be <code>(Int, Bool)</code> or <code>Int</code> we need to look for two different <code>Repo</code> instances, which will have different <em>implementations</em> for <code>eTable</code>, even though their type is the same.</p>\n\n<p>Even adding a type annotation every time you use <code>eTable</code> like <code>eTable :: Table (Relation (Int, Bool))</code> doesn't help. The type annotation only adds extra information to the top-down view, which we often already have anyway. The type-checker is still stuck with the problem that there could be (whether or not there actually are) other choices of <code>e</code> than <code>(Int, Bool)</code> which lead to <code>eTable</code> matching that type annotation, so it doesn't know which instance to use. <strong>Any</strong> possible use of <code>eTable</code> will have this problem, so it gets reported as an error when you're defining the class. It's basically for the same reason you get problems when you have a class with some members whose types don't use all of the type variables in the class head; you have to consider \"variable only used under a type family\" as much the same as \"variable isn't used at all\".</p>\n\n<p>You could address this by adding a <code>Proxy</code> argument to <code>eTable</code> so that there's something fixing the type variable <code>e</code> that the type checker <em>can</em> \"run backwards\". So <code>eTable :: Proxy e -&gt; Table (Relation e)</code>.</p>\n\n<p>Alternatively, with the <code>TypeApplications</code> extension you now <em>can</em> do as the error message suggests and turn on <code>AllowAmbiguousTypes</code> to get the class accepted, and then use things like <code>eTable @(Int, Bool)</code> to <em>tell</em> the compiler which choice for <code>e</code> you want. The reason this works where the type annotation <code>eTable :: Table (Relation (Int, Bool))</code> doesn't work is the type annotation is extra information added to the context when the type checker is looking top-down, but the type application adds extra information when the type checker is looking bottom-up. Instead of \"this expression is required to have a type that unifies with this type\" it's \"this polymorphic function <strong>is</strong> instantiated at this type\".</p>\n\n<hr>\n\n<p><sup>1</sup> Type constructors are actually even more restricted than just injectivity; applying <code>Test</code> to any type <code>a</code> results in a type with known structure <code>Test a</code>, so the entire universe of Haskell types is straightforwardly mirrored in types of the form <code>Test t</code>. A more general injective type function could instead do more \"rearranging\", such as mapping <code>Int</code> to <code>Bool</code> so long as it didn't also map <code>Bool</code> to <code>Bool</code>.</p>\n\n<p><sup>2</sup> From the type produced by combining the sub-parts of the expression</p>\n\n<p><sup>3</sup> From the type required of the context in which it is used</p>\n"}], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 47878526, "answer_count": 2, "score": 2, "last_activity_date": 1513656984, "creation_date": 1513632519, "question_id": 47876673, "link": "https://stackoverflow.com/questions/47876673/why-does-haskell-says-this-is-ambiguous", "title": "Why does Haskell says this is ambiguous?", "body": "<p>I have a type class defined like this :</p>\n\n<pre><code>class Repo e ne | ne -&gt; e, e -&gt; ne where\n  eTable :: Table (Relation e)\n</code></pre>\n\n<p>And when I try to compile it I get this :</p>\n\n<pre><code>* Couldn't match type `Database.Selda.Generic.Rel\n                             (GHC.Generics.Rep e0)'\n                     with `Database.Selda.Generic.Rel (GHC.Generics.Rep e)'\n      Expected type: Table (Relation e)\n        Actual type: Table (Relation e0)\n      NB: `Database.Selda.Generic.Rel' is a type function, and may not be injective\n      The type variable `e0' is ambiguous\n    * In the ambiguity check for `eTable'\n      To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n      When checking the class method:\n        eTable :: forall e ne. Repo e ne =&gt; Table (Relation e)\n      In the class declaration for `Repo'\n   |\n41 |   eTable :: Table (Relation e)\n   |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I was expecting everything to be unambiguous since I've explicitly stated that <code>e</code> determines <code>ne</code> and vice versa.</p>\n\n<p>However, if I try to define my class like this just for the testing purposes, it compiles :</p>\n\n<pre><code>data Test a = Test a\nclass Repo e ne | ne -&gt; e, e -&gt; ne where\n    eTable :: Maybe (Test e)\n</code></pre>\n\n<p>I'm not quite sure what is the deal with <a href=\"https://hackage.haskell.org/package/selda-0.1.11.2/docs/Database-Selda.html#t:Table\" rel=\"nofollow noreferrer\"><code>Table</code></a> and <a href=\"https://hackage.haskell.org/package/selda-0.1.11.2/docs/Database-Selda-Generic.html#t:Relation\" rel=\"nofollow noreferrer\"><code>Relation</code></a> types that causes this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "edited": false, "score": 0, "creation_date": 1513630909, "post_id": 47876071, "comment_id": 82718169, "body": "Try <code>toLowerAndFilterString = filter (`elem` [&#39;a&#39;..&#39;z&#39;]) . map toLower</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1513630915, "post_id": 47876071, "comment_id": 82718171, "body": "fyi, <code>Data.List.Utils.countElem</code>"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513635710, "post_id": 47876354, "comment_id": 82720362, "body": "The switch from a list comprehension to <code>map</code> is not an optimization; the compiled code (and thus the performance) should be identical. But it is clearer."}, {"owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513635825, "post_id": 47876354, "comment_id": 82720411, "body": "you&#39;re right, I meant that. Maybe I wasn&#39;t clear enough."}, {"owner": {"reputation": 37, "user_id": 4518225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/--S_LeXUszjY/AAAAAAAAAAI/AAAAAAAAAK4/mElJWJ9_V7M/photo.jpg?sz=128", "display_name": "zacchi", "link": "https://stackoverflow.com/users/4518225/zacchi"}, "edited": false, "score": 0, "creation_date": 1513639978, "post_id": 47876354, "comment_id": 82721861, "body": "Thanks @Radek for the very good explanation. If I decide to use percentage instead of count. Ie. [(t, 0.25), (h, 0.12) ..] as in t = 25% and h = 12%. Could I use similar approach ? I am getting confused when have to combine functions together and your approach seems quite clear"}, {"owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "edited": false, "score": 0, "creation_date": 1513640373, "post_id": 47876354, "comment_id": 82721983, "body": "Yes, you can easily modify my solution to calculate the percentages. Do you want to calculate percentages related to the total number of characters of just the number of letters? e.g. with <code>aaaa1234</code> the letter a should get 50% or 100%? If you let me know, I&#39;ll extend my answer."}, {"owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "edited": false, "score": 0, "creation_date": 1513640948, "post_id": 47876354, "comment_id": 82722139, "body": "Short explanation: to get the percentages, basically all you have to do is to calculate the length of <code>str</code> or <code>filteredStr</code> (depending whether you want non-letter symbols to be taken into account or not -- 50% vs 100% above): <code>lengthOfStr = length str</code> Then modify the last expression as follows: <code>[(h, fromIntegral (length fragment) &#47; lengthOfStr) | fragment@(h:_) &lt;- groupedStr]</code>"}, {"owner": {"reputation": 37, "user_id": 4518225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/--S_LeXUszjY/AAAAAAAAAAI/AAAAAAAAAK4/mElJWJ9_V7M/photo.jpg?sz=128", "display_name": "zacchi", "link": "https://stackoverflow.com/users/4518225/zacchi"}, "edited": false, "score": 0, "creation_date": 1513714226, "post_id": 47876354, "comment_id": 82755573, "body": "Thanks @radek yes, so basically I want to only read letters ignoring any other characters or numbers and have the percentage of it, if possible in two decimals only ie. &quot;(t, 0.12)&quot;  = 12%. I have tried using floating before and had trouble making it to display in two decimals float instead of 0.12213123. If you extend your answer I&#39;ll mark as accepted answer!"}, {"owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "reply_to_user": {"reputation": 37, "user_id": 4518225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/--S_LeXUszjY/AAAAAAAAAAI/AAAAAAAAAK4/mElJWJ9_V7M/photo.jpg?sz=128", "display_name": "zacchi", "link": "https://stackoverflow.com/users/4518225/zacchi"}, "edited": false, "score": 0, "creation_date": 1513718729, "post_id": 47876354, "comment_id": 82757513, "body": "@VictorAngelo Here&#39;s your modified version with percentages: <a href=\"https://repl.it/repls/StridentYummyFinnishspitz\" rel=\"nofollow noreferrer\">repl.it/repls/StridentYummyFinnishspitz</a>"}], "tags": [], "owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "is_accepted": true, "score": 2, "last_activity_date": 1513637855, "last_edit_date": 1513637855, "creation_date": 1513630889, "answer_id": 47876354, "question_id": 47876071, "link": "https://stackoverflow.com/questions/47876071/convert-uppercase-letters-to-lower-case-and-count-strings-in-haskell/47876354#47876354", "title": "Convert uppercase letters to lower case and count strings in Haskell", "body": "<p>There is some space for optimizations in your solution.</p>\n\n<p><strong>First</strong> of all, the function <code>letter_count</code> runs in O(n^2) time: when the result of <code>[(c, countL s c) | c &lt;- s]</code> is computed, for each character of the n letter string a O(n) lookup is performed by <code>countL</code>. This is not the optimal time complexity -- counting letters can be done faster.</p>\n\n<p>If you only want to consider letters [a, ..., z], then counting can be done in O(n) time using arrays from <code>Data.Array</code> (or, as @dfeuer mentioned in a comment, in O(n log k) time using <code>Data.IntMap.Strict</code>. If you want to stick to lists -- which will result with simpler code (which is desired especially for beginners), you can achieve O(n log(n)) complexity by sorting the list first and then counting the letters.</p>\n\n<p>After sorting you are sure that same letters will appear in consecutive blocks, so you can easily group them and count them in linear time.</p>\n\n<p><strong>Second</strong> optimization is far less important, but it may improve the clarity of your code. Look at your definition of <code>toLowerString</code>:</p>\n\n<pre><code>toLowerString :: [Char] -&gt; [Char]\ntoLowerString str = [ toLower x | x &lt;- str]\n</code></pre>\n\n<p>what you do in the fragment <code>[ toLower x | x &lt;- str]</code> is exactly what <code>map</code> function is made for -- you are replacing each element of some list with a result of some function (here: <code>toLower</code>). You can rewrite this part like this:</p>\n\n<pre><code>toLowerString :: [Char] -&gt; [Char]\ntoLowerString str = map toLower str\n</code></pre>\n\n<p>Moreover, now you may observe, that it is possible to omit the <code>str</code> argument in the definition -- the code gets even shorter:</p>\n\n<pre><code>toLowerString :: [Char] -&gt; [Char]\ntoLowerString = map toLower\n</code></pre>\n\n<hr>\n\n<p>My solution to your problem would look as follows:</p>\n\n<pre><code>import Data.Char (isLetter, toLower)\nimport Data.List (sort, group)\n\ncountLetters str = \n  let \n    filteredStr = filter isLetter str\n    lowerCaseStr = map toLower filteredStr\n    sortedStr = sort lowerCaseStr\n    groupedStr = group sortedStr\n  in\n  [(h, length fragment) | fragment@(h:_) &lt;- groupedStr]\n\nmain = do\n  putStrLn \"Type the string to count letters in:\"\n  string &lt;- getLine\n  let result = countLetters string\n  print result\n</code></pre>\n\n<p>You can try it here:\n<a href=\"https://repl.it/repls/GrubbyUnnaturalKitty\" rel=\"nofollow noreferrer\">https://repl.it/repls/GrubbyUnnaturalKitty</a></p>\n\n<p>If you'd like to make this solution even shorter, you could write it this way:</p>\n\n<pre><code>countLetters str = \n  let \n    groupedStr = group . sort . map toLower . filter isLetter $ str\n  in\n  [(head fragment, length fragment) | fragment &lt;- groupedStr]\n</code></pre>\n\n<p>using function composition operator <code>.</code>. The tricky bit may be the usage of <code>$</code> operator, which... in fact does nothing -- it applies the function on the left to the parameter given on the right. Its only role is to help to avoid writing too many parentheses -- without it, the line would look like this:</p>\n\n<pre><code>    groupedStr = (group . sort . map toLower . filter isLetter) str\n</code></pre>\n\n<p>Please also notice two different ways of extracting the head of the group of letters, while also binding the name <code>fragment</code> to the whole group:</p>\n\n<p><strong>A.</strong> name the whole group as <code>fragment</code> and use function <code>head</code> in the definition of the resulting tuple:</p>\n\n<pre><code>  [(head fragment, length fragment) | fragment &lt;- groupedStr]\n</code></pre>\n\n<p><strong>B.</strong> name the whole group as fragment, but also name its head as <code>h</code> using <code>@</code> notation:</p>\n\n<pre><code>  [(h, length fragment) | fragment@(h:_) &lt;- groupedStr]\n</code></pre>\n\n<p>Essentially <code>@</code> allows you to perform the pattern matching, while also introducing the name for the whole thing before matching takes place.</p>\n"}, {"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": false, "score": 3, "last_activity_date": 1513632253, "creation_date": 1513632253, "answer_id": 47876620, "question_id": 47876071, "link": "https://stackoverflow.com/questions/47876071/convert-uppercase-letters-to-lower-case-and-count-strings-in-haskell/47876620#47876620", "title": "Convert uppercase letters to lower case and count strings in Haskell", "body": "<p>A nice and short solution to count the letters would be to use the function <code>group</code> from the module <code>Data.List</code> (<a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-List.html#v:group\" rel=\"nofollow noreferrer\">link</a>). It takes a list and returns a list of its grouped elements. To get unique groups, simply sort your input string first. E.g.:</p>\n\n<pre><code>group (sort \"Hello World\")\n</code></pre>\n\n<p>will give you:</p>\n\n<pre><code>[\" \",\"H\",\"W\",\"d\",\"e\",\"lll\",\"oo\",\"r\"]\n</code></pre>\n\n<p>All you need to do is to convert each of those substrings, into a tuple of its length and its first letter:</p>\n\n<pre><code>map (\\s -&gt; (head s, length s))\n</code></pre>\n\n<p>So your <code>letter_count</code> will be:</p>\n\n<pre><code>letter_count :: [Char] -&gt; [(Char, Int)]\nletter_count = map (\\s -&gt; (head s, length s)) . group . sort\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1513639404, "last_edit_date": 1513639404, "creation_date": 1513638800, "answer_id": 47877797, "question_id": 47876071, "link": "https://stackoverflow.com/questions/47876071/convert-uppercase-letters-to-lower-case-and-count-strings-in-haskell/47877797#47877797", "title": "Convert uppercase letters to lower case and count strings in Haskell", "body": "<p>The array solution Radek mentioned looks like this:</p>\n\n<pre><code>import qualified Data.Array.Unboxed as A\nimport Data.Char ( isAsciiLower )\n\ncountLettersArr :: [Char] -&gt; [(Char, Int)]\ncountLettersArr cs = filter ((/= 0) . snd) (A.assocs arr)\n  where\n    arr :: A.UArray Char Int\n    arr = A.accumArray (+) 0 ('a', 'z')\n          [(c, 1 :: Int) | c &lt;- cs, isAsciiLower c]\n</code></pre>\n\n<p><code>countLettersArr</code> will simply drop any characters that are not lower-case letters. This can be generalized somewhat. Enabling <code>{-# LANGUAGE ScopedTypeVariables #-}</code>,</p>\n\n<pre><code>countIxesArr :: forall c. A.Ix c =&gt; (c,c) -&gt; [c] -&gt; [(c, Int)]\ncountIxesArr (lo,hi) cs = filter ((/= 0) . snd) (A.assocs arr)\n  where\n    arr :: A.UArray c Int\n    arr = A.accumArray (+) 0 (lo, hi)\n          [(c, 1::Int) | c &lt;- cs, A.inRange (lo,hi) c]\n</code></pre>\n\n<p>A somewhat less efficient approach is to use an <code>IntMap</code> instead of an array. This is slightly painful because <code>IntMap</code> only accepts <code>Int</code> indices, but it works in pretty much the same way: <code>fromListWith</code> is very similar to <code>accumArray</code>. This version will record <em>whatever</em> characters you throw at it, lower-case letters or not. You could easily change this by adding a guard to the list comprehension in the definition of <code>im</code>.</p>\n\n<pre><code>import qualified Data.IntMap.Strict as M\nimport Data.Char (ord, chr)\nimport Data.Bifunctor (first)\n\n-- Count how many of each letter appear in a string.\ncountLettersIM :: [Char] -&gt; [(Char, Int)]\ncountLettersIM cs = map (first chr) . M.toList $ im\n  where\n    im :: M.IntMap Int\n    im = M.fromListWith (+) [(ord c, 1) | c &lt;- cs]\n</code></pre>\n\n<p>If you like, you can generalize this as well, in a slightly different direction:</p>\n\n<pre><code>countEnumsIM :: Enum a =&gt; [a] -&gt; [(a, Int)]\ncountEnumsIM cs = map (first toEnum) . M.toList $ im\n  where\n    im = M.fromListWith (+) [(fromEnum c,1) | c &lt;- cs]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4518225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/--S_LeXUszjY/AAAAAAAAAAI/AAAAAAAAAK4/mElJWJ9_V7M/photo.jpg?sz=128", "display_name": "zacchi", "link": "https://stackoverflow.com/users/4518225/zacchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4750, "favorite_count": 0, "accepted_answer_id": 47876354, "answer_count": 3, "score": 1, "last_activity_date": 1513639404, "creation_date": 1513629527, "question_id": 47876071, "link": "https://stackoverflow.com/questions/47876071/convert-uppercase-letters-to-lower-case-and-count-strings-in-haskell", "title": "Convert uppercase letters to lower case and count strings in Haskell", "body": "<p>I'm new to Haskell and I'm trying to convert a inputted string to lower case letters. After converting I would like to do a count of all the lower case letters that are from ['a'..'z'].</p>\n\n<p>For example: \"This is a TES3T \"\nresult: [(t, 3), (h, 1), (i, 2), (s,2), (a,1) (e,1)]</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>countL :: [Char] -&gt; Char -&gt; Int\ncountL s c = length ( [x | x &lt;- s, x == c])\n\nletter_count :: [Char] -&gt; [(Char, Int)]\nletter_count s = nub [(c, countL s c) | c &lt;- s]\n</code></pre>\n\n<p>I have found the below to convert a given string into lower case:</p>\n\n<pre><code>toLowerString :: [Char] -&gt; [Char]\ntoLowerString str = [ toLower x | x &lt;- str]\n</code></pre>\n\n<p>But I'm not sure how to use the \"toLowerString\" with my \"letter_count\" function and to only read ['a'..'z'].</p>\n\n<p>Am I going completely wrong? Is there an simple way to do this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["linux", "sockets", "haskell", "nonblocking", "datagram"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1513626435, "post_id": 47874846, "comment_id": 82716200, "body": "STREAM and DGRAM sockets work very differently. A DGRAM socket doesn&#39;t know nor care if anything is actually listening on the other side. It just fires whatever you pass to it into interstellar space."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513629469, "post_id": 47874846, "comment_id": 82717495, "body": "It looks like the <code>MSG_DONTWAIT</code> flag to <code>send</code> is likely relevant. The Haskell interface passes the flags through, and presumably defines the constants somewhere. But my understanding of these things is probably shallower than yours."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1513632299, "post_id": 47874846, "comment_id": 82718817, "body": "A <code>DGRAM</code>  socket doesn&#39;t block a send. It just dumps a packet onto the network, and if the receiver&#39;s buffer is full then the packet is discarded. There is no connection, so nothing to block on."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1513633809, "post_id": 47874846, "comment_id": 82719544, "body": "Maybe there&#39;s something peculiar happening then... when the metric collector (which I&#39;m running with <code>docker</code>; perhaps that&#39;s part of the issue) is not running I get &quot;connection refused&quot; exceptions for every other send in my application, when testing in ghci"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1513639513, "post_id": 47874846, "comment_id": 82721709, "body": "@n.m. do you have any ideas re. edit?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1513639524, "post_id": 47874846, "comment_id": 82721712, "body": "@jberryman You cannot possibly get &#39;connection refused&#39; with UDP. You must be using TCP."}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1513719111, "post_id": 47894488, "comment_id": 82757685, "body": "Awesome thanks, would you say this is what&#39;s happening: the second <code>send</code> call is failing early with the asynchronous error from the first call (and so the third call doesn&#39;t raise an error, but the fourth call will, and so on...)? I&#39;ve come across this guide now, which I&#39;ll be consulting for these kinds of questions from now on: <a href=\"http://www.masterraghu.com/subjects/np/introduction/unix_network_programming_v1.3/ch08lev1sec11.html\" rel=\"nofollow noreferrer\">masterraghu.com/subjects/np/introduction/&hellip;</a>"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1513733298, "post_id": 47894488, "comment_id": 82761990, "body": "Yes, I believe that&#39;s correct:  the first call actually sends a UDP packet and returns success.  Internally, this generates an ICMP unreachable error which the second call reports <i>instead</i> of sending a UDP packet, so the third call can send a UDP packet and repeat the process.  Because this is the loopback interface, it&#39;s entirely reliable -- send, error, send, error.  On a real network interface, you&#39;d see something similar but less predictably."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1513714250, "creation_date": 1513714250, "answer_id": 47894488, "question_id": 47874846, "link": "https://stackoverflow.com/questions/47874846/sending-to-a-datagram-socket-without-blocking-indefinitely/47894488#47894488", "title": "Sending to a Datagram socket, without blocking indefinitely", "body": "<p>This isn't a Haskell issue -- it's expected behavior on Linux when sending two UDP packets to a localhost port with no listening process.  The following C program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/udp.h&gt;\n\nint main()\n{\n    int s = socket(AF_INET, SOCK_DGRAM, 0);\n    struct sockaddr_in dstaddr = { AF_INET, htons(6565), {htonl(0x7f000001)} };\n    if (connect(s, (struct sockaddr*) &amp;dstaddr, sizeof(dstaddr)))\n        perror(\"connect\");\n    if (send(s, \"FOO\", 3, 0) == -1)\n        perror(\"first send\");\n    if (send(s, \"BAR\", 3, 0) == -1)\n        perror(\"second send\");\n    return 0;\n}\n</code></pre>\n\n<p>will print <code>second send: Connection refused</code>, assuming nothing is listening on localhost port 6565.</p>\n\n<p>If you do any one of the following -- (i) send to a non-local host, (ii) drop the <code>connect</code> call and replace the <code>send</code>s with <code>sendto</code>s, or (iii) send packets to a port with a process listening for UDP packets -- then you won't get the error.</p>\n\n<p>The behavior is a little complex and not well documented anywhere, though the manpages for <code>udp(7)</code> hint at it.</p>\n\n<p>You may find the discussion <a href=\"https://stackoverflow.com/questions/41231270/econnrefused-errors-on-udp-sendto\">in this Stack Overflow question</a> helpful.</p>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "accepted_answer_id": 47894488, "answer_count": 1, "score": 3, "last_activity_date": 1513714250, "creation_date": 1513623870, "last_edit_date": 1513698853, "question_id": 47874846, "link": "https://stackoverflow.com/questions/47874846/sending-to-a-datagram-socket-without-blocking-indefinitely", "title": "Sending to a Datagram socket, without blocking indefinitely", "body": "<p>We have some code to send metrics to a <code>SOCK_DGRAM</code> where another daemon listens and aggregates/proxies these messages. Opening the socket looks like:</p>\n\n<pre><code>sock &lt;- socket\n(ai :: AddressInfo Inet Datagram UDP):_ &lt;- getAddressInfo (Just \"127.0.0.1\") Nothing aiNumericHost\nconnect s (socketAddress ai) { port }\nreturn sock\n</code></pre>\n\n<p>And at the moment we write to it like:</p>\n\n<pre><code>send sock payload mempty\n</code></pre>\n\n<p>I want to ensure the call above doesn't block for very long (or at the very least doesn't block indefinitely), but my understanding of unix sockets is not very deep and I'm having trouble understanding how exactly <code>send</code> blocks, looking at internals <a href=\"https://hackage.haskell.org/package/socket-0.8.0.1/docs/src/System-Socket-Unsafe.html#unsafeSend\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/lpeterse/haskell-socket/blob/bade04065eaadc1a701d2b67cd928ec289226fd9/platform/linux/src/System/Socket/Internal/Platform.hsc\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>There is a related question here that was helpful: <a href=\"https://stackoverflow.com/questions/19391208/when-a-non-blocking-send-only-transfers-partial-data-can-we-assume-it-would-r\">When a non-blocking send() only transfers partial data, can we assume it would return EWOULDBLOCK the next call?</a></p>\n\n<p>So my questions specifically are:</p>\n\n<ul>\n<li>General socket question: I see in this implementation <code>send</code> is going to block (after busy-waiting) until there is room in the buffer. How exactly is this buffer related to the consumer? Does this mean <code>send</code> may block indefinitely if our <code>listen</code>-ing daemon is slow or stalls?</li>\n<li>If I would rather abort and never block, do I need to make my own fork of <code>System.Socket.Unsafe</code>, or am I missing something? </li>\n</ul>\n\n<p>I'm only concerned with linux here.</p>\n\n<p><strong>EDIT</strong>: Also, and what probably got me started with all of this is I find that when the metrics collector is not running, that every other of my <code>send</code> calls above throws a \"connection refused\" exception. So why that is, or whether it's normal is another question I have.</p>\n\n<p><strong>EDIT2</strong>: Here's a complete example illustrating the connection refused issue if anyone would like to help repro:</p>\n\n<pre><code>import Data.Functor\nimport System.Socket\nimport System.Socket.Family.Inet\n\nrepro :: IO ()\nrepro = do\n  let port = 6565\n  (s :: Socket Inet Datagram UDP) &lt;- socket\n  (ai :: AddressInfo Inet Datagram UDP):_ &lt;- getAddressInfo (Just \"127.0.0.1\") Nothing aiNumericHost\n  connect s (socketAddress ai) { port }\n\n  putStrLn \"Starting send\"\n  void $ send s \"FOO\" mempty\n  void $ send s \"BAR\" mempty\n  putStrLn \"done\"\n</code></pre>\n\n<p>I'm using <code>socket-0.5.3.0</code>.</p>\n\n<p><strong>EDIT3</strong>: this seems to be due to the <code>connect</code> call, somehow. (Testing on <code>sockets</code> latest):</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, OverloadedStrings, NamedFieldPuns #-}\nimport Data.Functor\nimport System.Socket\nimport System.Socket.Protocol.UDP\nimport System.Socket.Type.Datagram\nimport System.Socket.Family.Inet\n\nrepro :: IO ()\nrepro = do\n  (s :: Socket Inet Datagram UDP) &lt;- socket\n\n  -- Uncommenting raises eConnectionRefused, everytime:\n  -- connect s (SocketAddressInet  inetLoopback  6565     :: SocketAddress Inet)\n  putStrLn \"Starting send\"\n  void $ sendTo s \"FOO\" mempty (SocketAddressInet  inetLoopback  6565     :: SocketAddress Inet)\n  void $ sendTo s \"BAR\" mempty (SocketAddressInet  inetLoopback  6565     :: SocketAddress Inet)\n  putStrLn \"done\"\n</code></pre>\n\n<p>As I understand it we should be able to use <code>connect</code> (at least the underlying syscall) to set the default send address. I haven't dug into the implementation of <code>connect</code> in the library yet.</p>\n\n<p>I've opened this: <a href=\"https://github.com/lpeterse/haskell-socket/issues/55\" rel=\"nofollow noreferrer\">https://github.com/lpeterse/haskell-socket/issues/55</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1513625850, "post_id": 47874803, "comment_id": 82715926, "body": "Btw. please don&#39;t use pictures to show &#39;text&#39; based information - just copy paste the error message and add it like you did your source code. It is easier for search engines to index your content and it makes your question self-contained, if the hosting service of your picture is down the question cannot be answered/understood."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 4, "last_activity_date": 1513625650, "creation_date": 1513625650, "answer_id": 47875234, "question_id": 47874803, "link": "https://stackoverflow.com/questions/47874803/let-block-gives-indentation-error/47875234#47875234", "title": "Let block gives indentation error", "body": "<p>There is more wrong to your code than just the <code>Indentation Errors</code> - so my first suggestion would be reading a bit of <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">learn you a haskell for great good</a>.</p>\n\n<p>Next there are two assignment operators in haskell - one <em>bind</em>s the result of an action <code>\u2026 &lt;- \u2026</code> and the other one is a local definition/declaration of a pure computation <code>let \u2026 = \u2026</code>.</p>\n\n<p>Moreover you can improve your <code>read</code>ing a value by taking account of the possible false input, that someone could give you (intentionally and unintentionally) by replacing <code>read</code> with <code>readMaybe</code>, where the latter returns a <code>Maybe something</code>, for example  <code>readMaybe \"1\" = Just 1 :: Maybe Int</code> or <code>readMaybe \"foo\" = Nothing :: Maybe Int</code>.</p>\n\n<p>Regarding your indentation it is best that you compare one solution to your program with yours own:</p>\n\n<pre><code>import Text.Read (readMaybe)\n\ndata Type = Saving | Checking\n  deriving (Show)\n\ndata Account = Account (String,Int,Int) Type\n  deriving (Show)\n\nmain :: IO ()\nmain = do\n        putStrLn \"Press one to create a new account\"\n        g &lt;- getLine\n        let enteredValue = readMaybe g :: Maybe Int\n</code></pre>\n\n<blockquote>\n  <p>here the result of <code>getLine</code> and entered value have the same scope so they have the same indentation - we only change the scope after the next <code>if</code> where the <code>then</code>-block - and the <code>else</code>-block do not share the 'declarations' of each branch, so you couldn't use <code>name</code> in the <code>else</code>-block, but <code>enteredValue</code> can be used in both.</p>\n</blockquote>\n\n<pre><code>        if enteredValue == Just 1\n            then do putStrLn \"Enter your name \"\n                    name &lt;- getLine\n                    putStrLn \"Enter the initial amount\"\n                    amount' &lt;- fmap readMaybe getLine\n</code></pre>\n\n<blockquote>\n  <p>here again <code>name</code> and <code>amount'</code> share the same scope, and pattern matching on <code>amount'</code> creates a new scope where <code>amount</code> is visible and the match on <code>Nothing</code> where you cannot use this variable.</p>\n</blockquote>\n\n<pre><code>                    case amount' of\n                      Just amount -&gt; print $ Account (name,1,amount) Saving\n                      Nothing -&gt; putStrLn \"Nothing\"\n            else putStrLn \"Nothing\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 8, "last_activity_date": 1513625695, "creation_date": 1513625695, "answer_id": 47875243, "question_id": 47874803, "link": "https://stackoverflow.com/questions/47874803/let-block-gives-indentation-error/47875243#47875243", "title": "Let block gives indentation error", "body": "<p>The problem is here:</p>\n\n<pre><code>--                  |&lt;---- \"column 0\" of this 'do' block \n            then do putStrLn $ \"Enter your name \"\n--                  | still good; a 'let' statement:\n                    let name = getLine\n--                      |&lt;---- \"column 0\" of this 'let' block\n                        putStrLn $ \"Enter the initial amount\"\n--                      | Huh, there's no '=' in ^this^ declaration?\n                        let amount = readLn :: IO Int\n--                      ^^^ Why is there a 'let' within another let binding?\n--                          I still haven't seen a '='. Better throw a parse error.\n</code></pre>\n\n<p>Basically, <code>putStrLn $ \"Enter the initial amount\"</code> is aligned with <code>name = ...</code> in the preceding line, so the compiler reads it as a declaration (part of the same <code>let</code> block).</p>\n\n<p>To fix your indentation errors, it should be:</p>\n\n<pre><code>main = do\n            putStrLn $ \"Press one to create a new account\"\n            let g = getLine\n                enteredValue = read g :: Int\n            if g == 1\n                then do putStrLn $ \"Enter your name \"\n                        let name = getLine\n                        putStrLn $ \"Enter the initial amount\"\n                        let amount = readLn :: IO Int\n                            value  = Account (name,1,amount) Saving\n                        show value\n                else do putStrLn $ \"Nothing\"\n</code></pre>\n\n<p>But then you'll run into type errors:</p>\n\n<ul>\n<li><code>read g</code> is wrong: <code>read</code> takes a <code>String</code>, but <code>g :: IO String</code></li>\n<li><code>g == 1</code> is wrong: <code>1</code> is an <code>Int</code>, but <code>g :: IO String</code></li>\n<li><code>show value</code> is wrong: <code>show</code> returns a <code>String</code>, but you're using it as an <code>IO</code> action</li>\n<li>You haven't shown the declaration of <code>Account</code>, but you're likely going to have issues with <code>name</code> and <code>amount</code>, too</li>\n</ul>\n\n<p>You probably want something like:</p>\n\n<pre><code>main = do\n            putStrLn $ \"Press one to create a new account\"\n            g &lt;- getLine\n            let enteredValue = read g :: Int\n            if enteredValue == 1\n                then do putStrLn $ \"Enter your name \"\n                        name &lt;- getLine\n                        putStrLn $ \"Enter the initial amount\"\n                        amount &lt;- readLn :: IO Int\n                        let value  = Account (name,1,amount) Saving\n                        putStrLn (show value)\n                else do putStrLn $ \"Nothing\"\n</code></pre>\n\n<p>Basically, use <code>v &lt;- expr</code> to go from <code>expr :: IO Something</code> to <code>v :: Something</code>.</p>\n\n<p>Other notes:</p>\n\n<ul>\n<li><code>g &lt;- getLine; let enteredValue = read g :: Int</code> better written as <code>enteredValue &lt;- readLn :: IO Int</code></li>\n<li><code>putStrLn (show value)</code> can be shortened to <code>print value</code></li>\n<li>you don't need <code>do</code> for a single expression (nor <code>$</code> for a single operand): <code>... else putStrLn \"Nothing\"</code> </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 4, "last_activity_date": 1513625870, "creation_date": 1513625870, "answer_id": 47875289, "question_id": 47874803, "link": "https://stackoverflow.com/questions/47874803/let-block-gives-indentation-error/47875289#47875289", "title": "Let block gives indentation error", "body": "<p><code>let</code> is for binding values, which is done in the form <code>let x = y+z</code>, where <code>x</code> is the name (aka \"identifier\") being bound, and <code>y+z</code> is the expression to which it is being bound.</p>\n\n<p>In your example, I see three bindings: <code>name</code>, <code>amount</code>, and <code>value</code>. The rest are not value bindings, but <em>actions</em>. </p>\n\n<p>In the <code>do</code> notation, actions do not need a <code>let</code>. You just write them one after another. So:</p>\n\n<pre><code>let name = getLine\nputStrLn $ \"Enter the initial amount\"\nlet amount = readLn :: IO Int\nlet value  = Account (name,1,amount) Saving\nshow value\n</code></pre>\n\n<p>But wait! This is not all!</p>\n\n<p><code>getLine</code> is not actually an expression of type <code>String</code>, as you seem to be hoping here. Rather, <code>getLine</code> is an <em>action</em>. In order to get it to \"run\" and \"produce\" a <code>String</code> value, you need to use the <code>&lt;-</code> construct instead of <code>let</code>:</p>\n\n<pre><code>name &lt;- getLine\n</code></pre>\n\n<p>Similarly with <code>readLn</code>:</p>\n\n<pre><code>amount &lt;- readLn :: IO Int\n</code></pre>\n\n<p>Finally, <code>show value</code> is not actually an action that would print the value to the screen. <code>show</code> is a function that takes a value and return a <code>String</code>. It doesn't \"do\" anything (i.e. doesn't produce any outside effects), so you can't use it in place of an action in the <code>do</code> notation. If you wanted an <em>action</em> that would print a value to the screen, that would be <code>print</code>:</p>\n\n<pre><code>print value\n</code></pre>\n\n<p>Gathering everything together:</p>\n\n<pre><code>name &lt;- getLine\nputStrLn $ \"Enter the initial amount\"\namount &lt;- readLn :: IO Int\nlet value = Account (name,1,amount) Saving\nprint value\n</code></pre>\n\n<p>And after fixing all of that, you'll have similar difficulties with the first part of your program, where you have <code>let g = getLine</code> instead of <code>g &lt;- getLine</code>.</p>\n"}], "owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 47875243, "answer_count": 3, "score": 0, "last_activity_date": 1513626000, "creation_date": 1513623688, "last_edit_date": 1513626000, "question_id": 47874803, "link": "https://stackoverflow.com/questions/47874803/let-block-gives-indentation-error", "title": "Let block gives indentation error", "body": "<p>I know what an indentation error is, but I have no idea why I'm getting this error here, while every is aligned, trying to solve it for 2 hours.</p>\n\n<pre><code>Account.hs:40:25: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n   |\n40 |                         let amount = readLn :: IO Int\n   |                         ^\nFailed, 0 modules loaded.\n</code></pre>\n\n\n\n<pre><code>main = do\n            putStrLn $ \"Press one to create a new account\"\n            let g = getLine\n                enteredValue = read g :: Int\n            if g == 1\n                then do putStrLn $ \"Enter your name \"\n                        let name = getLine\n                            putStrLn $ \"Enter the initial amount\"\n                            let amount = readLn :: IO Int\n                                value  = Account (name,1,amount) Saving\n                                show value\n                else do putStrLn $ \"Nothing\"\n</code></pre>\n\n<p>I also tried this version but this also gives <code>incorrect indentation or mismatched brackets</code>:</p>\n\n<pre><code>main = do\n        putStrLn $ \"Press one to create a new account\"\n        let g = getLine\n            enteredValue = read g :: Int\n        if g == 1\n            then do putStrLn $ \"Enter your name \"\n                    let name = getLine\n                        putStrLn $ \"Enter the initial amount\"\n                        amount = readLn :: IO Int\n                        value  = Account (name,1,amount) Saving\n                        show value\n            else do putStrLn $ \"Nothing\"\n</code></pre>\n"}, {"tags": ["haskell", "default", "typeclass", "multiparameter"], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 11, "last_activity_date": 1513613715, "creation_date": 1513613715, "answer_id": 47872350, "question_id": 47872101, "link": "https://stackoverflow.com/questions/47872101/in-haskell-is-it-possible-to-provide-default-implementation-for-partially-appli/47872350#47872350", "title": "In Haskell, is it possible to provide default implementation for partially applied multi-param type class?", "body": "<p>There is no such extension, but you can achieve this functionality simply by splitting your class into two classes:</p>\n\n<pre><code>class MyClass1 a b c where\n    fun03 :: a -&gt; b -&gt; c -&gt; ()\n    fun04 :: a -&gt; WhatEver\n\nclass MyClass1 a b c =&gt; MyClass2 a b c where    \n    fun01 :: a -&gt; b\n    fun02 :: a -&gt; c\n</code></pre>\n\n<p>Then your instances will work the way you want:</p>\n\n<pre><code>-- NB: need the MyClass2 constraint if you use `fun01` or `fun02` in the definitions\n-- This requires UndecidableInstances\ninstance MyClass2 BaseDataType b c =&gt; MyClass1 BaseDataType b c where\n    fun03 = fun01 &lt;$&gt; fun02 ...\n    fun04 = fun02 ...\n\ninstance MyClass2 BaseDataType Int Char where\n    fun01 = 1\n    fun02 = 'C'\n</code></pre>\n\n<p>Users of your class are not affected; they can continue to consume <code>MyClass2</code> where they used <code>MyClass</code> before and get the exact same functionality.</p>\n\n<hr>\n\n<p>Aside: the original definition of <code>MyClass</code>, and <code>MyClass1</code> and <code>MyClass2</code> don't even compile due to several ambiguous type errors (<code>c</code> is not mentioned in the type of <code>fun01</code>, etc.) - I assume this class was defined just for demonstration purposes and I haven't tried to fix this.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1513639426, "post_id": 47877846, "comment_id": 82721681, "body": "+1, but I don&#39;t reckon this is usuable for the OP because the default is <i>for all</i> <code>MyClass</code> instances, not just for the <code>MyClass BaseDataType</code> specialisation. (In other cases, the default implementation will just give a obscure-ish type error to indicate that a custom instance must be replaced.)"}], "tags": [], "owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "is_accepted": false, "score": 5, "last_activity_date": 1513639060, "creation_date": 1513639060, "answer_id": 47877846, "question_id": 47872101, "link": "https://stackoverflow.com/questions/47872101/in-haskell-is-it-possible-to-provide-default-implementation-for-partially-appli/47877846#47877846", "title": "In Haskell, is it possible to provide default implementation for partially applied multi-param type class?", "body": "<p>You can use DefaultSignatures like this</p>\n\n<pre><code>class MyClass a b c where\n    fun01 :: a -&gt; b\n    fun02 :: a -&gt; c\n\n    fun03 :: a -&gt; b -&gt; c -&gt; ()\n    default fun03 :: (a ~ BaseDataType) =&gt; a -&gt; b -&gt; c -&gt; ()\n    fun03 = fun01 &lt;$&gt; fun02 ...\n\n    fun04 :: a -&gt; WhatEver\n    default fun04 :: (a ~ BaseDataType) =&gt; a -&gt; WhatEver\n    fun04 = fun02 ...\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 47872350, "answer_count": 2, "score": 10, "last_activity_date": 1529038072, "creation_date": 1513612904, "last_edit_date": 1529038072, "question_id": 47872101, "link": "https://stackoverflow.com/questions/47872101/in-haskell-is-it-possible-to-provide-default-implementation-for-partially-appli", "title": "In Haskell, is it possible to provide default implementation for partially applied multi-param type class?", "body": "<p>For example, I have a type class :</p>\n\n<pre><code>class MyClass a b c where\n    fun01 :: a -&gt; b\n    fun02 :: a -&gt; c\n\n    fun03 :: a -&gt; b -&gt; c -&gt; ()\n    fun04 :: a -&gt; WhatEver\n</code></pre>\n\n<p>I'd like to provide a default implementation for my, let's call it <code>BaseDataType</code> which defines implementations of <code>fun03</code> in terms of it self and <code>fun01</code> and <code>fun02</code>. Then I'd have something like this :</p>\n\n<pre><code>class MyClass BaseDataType b c where\n    fun03 = fun01 &lt;$&gt; fun02 ...\n    fun04 = fun02 ...\n</code></pre>\n\n<p>And than to finalize my class instance and avoid all the boilerplate code for <code>fun03</code> and <code>fun04</code> I'd just provide <code>fun01</code> and <code>fun02</code> like this :</p>\n\n<pre><code>instance MyClass BaseDataType Int Char where\n    fun01 = 1\n    fun02 = 'C'\n</code></pre>\n\n<p>Is there possibly some language extension that allows this kind of behaviour? I couldn't find anything on this topic.</p>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 1, "creation_date": 1513608189, "post_id": 47870762, "comment_id": 82706709, "body": "What do you want to have happen for an empty list?  Just filter/ignore it?  Why does filter not do what you want?"}, {"owner": {"reputation": 483, "user_id": 8953741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/118643528911159/picture?type=large", "display_name": "Aron Lee", "link": "https://stackoverflow.com/users/8953741/aron-lee"}, "reply_to_user": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 0, "creation_date": 1513622879, "post_id": 47870762, "comment_id": 82714599, "body": "filter only removes the empty list, but I want to use &#39;head&#39; and do something on the head element."}, {"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 0, "creation_date": 1513623282, "post_id": 47870762, "comment_id": 82714774, "body": "But an empty list has no head.  What did you need that map + filter doesn&#39;t do?  If you only concern was iterating the list twice, it doesn&#39;t.  Those operations are evaluated lazily."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1513623420, "post_id": 47870762, "comment_id": 82714828, "body": "Never use <code>head, tail, !!</code>. Just pretend they don&#39;t exist. <code>length</code> is another function which is often abused, hence best avoided when possible. The code above also suffers from &quot;boolean blindness&quot; (you can google that): instead of checking if a list is nonempty and taking its first element in the same step, it checks for non-emptiness only to build a boolean (<code>length x &gt; 0</code>), effectively discarding the first element. Later on, we need that, but it&#39;s too late. Pattern matching helps us avoid booleans, and retaining the crucial information at hand."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1513622914, "post_id": 47870817, "comment_id": 82714614, "body": "Another fun spelling of the same idea: <code>heads = concatMap (take 1)</code>. A completely different idea: <code>heads = head . (++[[]]) . transpose</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1513624443, "post_id": 47870817, "comment_id": 82715264, "body": "@DanielWagner: I really like these :) , especially the first one."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1513679951, "last_edit_date": 1513679951, "creation_date": 1513608225, "answer_id": 47870817, "question_id": 47870762, "link": "https://stackoverflow.com/questions/47870762/head-function-for-empty-list-issue/47870817#47870817", "title": "head function for empty list issue", "body": "<p>Yes, in fact you can write it as a <em>list comprehension</em> statement, and use <em>pattern matching instead</em>:</p>\n\n<pre><code>result = [ h | (h:_) &lt;- ll ]\n</code></pre>\n\n<p>or as a function:</p>\n\n<pre><code>heads :: [[a]] -&gt; [a]\nheads ll = [ h | (h:_) &lt;- ll ]\n</code></pre>\n\n<p>So here we use the pattern <code>(h:_)</code> which matches all non-empty lists, and we directly obtain the head <code>h</code> of such list and add it to the list. If you use a pattern in list comprehension (on the left side of the left arrow <code>&lt;-</code>, it will skip the elements that do not match the pattern).</p>\n\n<p>This is also <em>more</em> safe than using <code>length</code>, since <code>length</code> will get stuck into an infinite loop if you are working with <em>infinite</em> lists. Furthermore by using patterns over the non-total <code>head</code> function, we have more <em>syntactical</em> guarantees that this function will work (yes, once the non-empty elements are filtered, we are of course certain that <code>head</code> will not result in errors, but we only know this because we have information about the <code>head</code> function).</p>\n\n<p>Note that your attempt will result in a syntax error, since you use an <code>if</code>, without a <code>then</code> and <code>else</code> part.</p>\n\n<p>Alternatively, we can, like <a href=\"https://stackoverflow.com/questions/47870762/head-function-for-empty-list-issue/47870817?noredirect=1#comment82714614_47870817\">@DanielWagner</a> says, write the <code>heads</code> function differently, for instance using:</p>\n\n<pre><code>heads :: [[a]] -&gt; [a]\nheads ll = concatMap (take 1) ll\n</code></pre>\n\n<p>or by using the <em>bind</em> of the list monad:</p>\n\n<pre><code>heads :: [[a]] -&gt; [a]\nheads = (take 1 =&lt;&lt;)\n</code></pre>\n\n<p>or we can transpose the 2d list. In that case the first row contains all the heads of the lists. Since it is however not guaranteed that there is such a row, we can append an empty list at the end, like:</p>\n\n<pre><code>heads :: [[a]] -&gt; [a]\nheads = head . (++ [[]]) . transpose\n</code></pre>\n"}], "owner": {"reputation": 483, "user_id": 8953741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/118643528911159/picture?type=large", "display_name": "Aron Lee", "link": "https://stackoverflow.com/users/8953741/aron-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 1, "accepted_answer_id": 47870817, "answer_count": 1, "score": 1, "last_activity_date": 1513679951, "creation_date": 1513608029, "last_edit_date": 1513608367, "question_id": 47870762, "link": "https://stackoverflow.com/questions/47870762/head-function-for-empty-list-issue", "title": "head function for empty list issue", "body": "<p>I want to use 'head' function inside map.\nThe problem is the 'head' function only accepts non-empty list.\nI have list of list:</p>\n\n<pre><code>let ll =[[\"dog\", \"cat\"], [\"pig\", \"cow\"], []]\n</code></pre>\n\n<p>I need to iterate the list of list twice</p>\n\n<pre><code>let listOne = filter(\\x -&gt; if length x &gt; 0) ll\nmap(\\x -&gt; head x) listOne\n</code></pre>\n\n<p>I'm wondering whether I can iterate the list of list once or put a \"if condition\" inside the map without the 'filter'</p>\n\n<p>Any suggestion would be appreciated.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 811, "user_id": 605690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80f25d1101931a7a7b92d642647359d?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Rezvov", "link": "https://stackoverflow.com/users/605690/ilya-rezvov"}, "is_accepted": true, "score": 2, "last_activity_date": 1513608858, "last_edit_date": 1513608858, "creation_date": 1513608511, "answer_id": 47870897, "question_id": 47870188, "link": "https://stackoverflow.com/questions/47870188/haskell-type-error-when-attempting-to-split-function-into-two-functions-involvin/47870897#47870897", "title": "Haskell type error when attempting to split function into two functions involving multiparamtypeclasses", "body": "<p>This definition doesn't work because compiler cannot deduce intermediate type.\nYou promise to compiler <code>a</code> and <code>b</code> are convertible to <code>Text</code>, but when you call <code>cs a</code> result type defined by calling place, and only after deriving type on calling site compiler checks constraints. Here you immediately call <code>cs</code> again on polymorphic result and GHC doesn't know what type you imply.</p>\n\n<pre><code>singleFunction :: (\n  ConvertibleStrings a Text,\n  ConvertibleStrings b Text,\n  ConvertibleStrings Text c,\n  Monoid Text) =&gt; a -&gt; b -&gt; c\nsingleFunction a b = cs (cs a &lt;&gt; cs b)\n</code></pre>\n\n<p>The case with two functions works because <code>++&lt;&gt;</code> explicityly has <code>Text</code> in return type.</p>\n\n<p>So if you want to use <code>Text</code> as intermediate monoid you should be more explicit</p>\n\n<pre><code>singleFunction :: (\n      ConvertibleStrings a Text,\n      ConvertibleStrings b Text,\n      ConvertibleStrings Text c) =&gt; a -&gt; b -&gt; c\nsingleFunction a b = cs ((cs a &lt;&gt; cs b) :: Text)\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 47870897, "answer_count": 1, "score": 1, "last_activity_date": 1525245505, "creation_date": 1513606027, "last_edit_date": 1525245505, "question_id": 47870188, "link": "https://stackoverflow.com/questions/47870188/haskell-type-error-when-attempting-to-split-function-into-two-functions-involvin", "title": "Haskell type error when attempting to split function into two functions involving multiparamtypeclasses", "body": "<p>The following imports / languages pragmas are required </p>\n\n<pre><code>{-# language FlexibleContexts, MultiParamTypeClasses, TypeSynonymInstances, FlexibleInstances, CPP #-}\nimport Data.String.Conversions\n</code></pre>\n\n<p>The following two functions typechecks fine (<strong>* kind of</strong>):</p>\n\n<pre><code>(++&lt;&gt;) :: (\n  ConvertibleStrings a Text,\n  ConvertibleStrings b Text\n  )\n  =&gt; a -&gt; b -&gt; Text\na ++&lt;&gt; b = cs a &lt;&gt; cs b\n\ncsappend :: (\n  ConvertibleStrings a Text,\n  ConvertibleStrings b Text,\n  ConvertibleStrings Text c)\n  =&gt; a -&gt; b -&gt; c\ncsappend a b = cs ( a ++&lt;&gt; b)\n</code></pre>\n\n<p>I tried to define the above two functions as a single function:</p>\n\n<pre><code>singleFunction :: (\n  ConvertibleStrings a Text,\n  ConvertibleStrings b Text,\n  ConvertibleStrings Text c,\n  Monoid Text) =&gt; a -&gt; b -&gt; c\nsingleFunction a b = cs (cs a &lt;&gt; cs b)\n</code></pre>\n\n<hr>\n\n<p>*</p>\n\n<pre><code>xyz :: String\nxyz = do\n  let s = \"test\"                      :: String\n  csappend (csappend s s :: String) s :: String -- this typechecks\n  csappend (csappend s s) s           :: String -- this does not typechecks\n</code></pre>\n\n<hr>\n\n<p>Which gives me an error (below). I don't understand the reason for the errors - the type constraints seem identical, and I'm wondering if perhaps something else is the cause of the error?</p>\n\n<pre><code>    \u2022 Could not deduce (ConvertibleStrings a0 c)\n        arising from a use of \u2018cs\u2019\n      from the context: (ConvertibleStrings a Text,\n                         ConvertibleStrings b Text,\n                         ConvertibleStrings Text c)\n        bound by the type signature for:\n                   singleFunction :: (ConvertibleStrings a Text,\n                                      ConvertibleStrings b Text, ConvertibleStrings Text c) =&gt;\n                                     a -&gt; b -&gt; c\n        at /home/chris/Projects/Haskell/Hart/Hart.hs:(37,1)-(40,43)\n      The type variable \u2018a0\u2019 is ambiguous\n      Relevant bindings include\n        singleFunction :: a -&gt; b -&gt; c\n          (bound at /home/chris/Projects/Haskell/Hart/Hart.hs:41:1)\n      These potential instances exist:\n        instance [safe] ConvertibleStrings StrictText StrictText\n          -- Defined in \u2018Data.String.Conversions\u2019\n        instance [safe] ConvertibleStrings StrictText String\n          -- Defined in \u2018Data.String.Conversions\u2019\n        instance [safe] ConvertibleStrings String StrictText\n          -- Defined in \u2018Data.String.Conversions\u2019\n        ...plus one other\n        ...plus 21 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the expression: cs (cs a &lt;&gt; cs b)\n      In an equation for \u2018singleFunction\u2019:\n          singleFunction a b = cs (cs a &lt;&gt; cs b)\n\n/home/chris/Projects/Haskell/Hart/Hart.hs:41:26: error:\n    \u2022 Could not deduce (ConvertibleStrings a a0)\n        arising from a use of \u2018cs\u2019\n      from the context: (ConvertibleStrings a Text,\n                         ConvertibleStrings b Text,\n                         ConvertibleStrings Text c)\n        bound by the type signature for:\n                   singleFunction :: (ConvertibleStrings a Text,\n                                      ConvertibleStrings b Text, ConvertibleStrings Text c) =&gt;\n                                     a -&gt; b -&gt; c\n        at /home/chris/Projects/Haskell/Hart/Hart.hs:(37,1)-(40,43)\n      The type variable \u2018a0\u2019 is ambiguous\n      Relevant bindings include\n        a :: a (bound at /home/chris/Projects/Haskell/Hart/Hart.hs:41:16)\n        singleFunction :: a -&gt; b -&gt; c\n          (bound at /home/chris/Projects/Haskell/Hart/Hart.hs:41:1)\n      These potential instances exist:\n        instance [safe] ConvertibleStrings StrictText StrictText\n          -- Defined in \u2018Data.String.Conversions\u2019\n        instance [safe] ConvertibleStrings StrictText String\n          -- Defined in \u2018Data.String.Conversions\u2019\n        instance [safe] ConvertibleStrings String StrictText\n          -- Defined in \u2018Data.String.Conversions\u2019\n        ...plus one other\n        ...plus 21 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the first argument of \u2018(&lt;&gt;)\u2019, namely \u2018cs a\u2019\n      In the first argument of \u2018cs\u2019, namely \u2018(cs a &lt;&gt; cs b)\u2019\n      In the expression: cs (cs a &lt;&gt; cs b)\n\n/home/chris/Projects/Haskell/Hart/Hart.hs:41:26: error:\n    \u2022 Could not deduce (Monoid a0) arising from a use of \u2018&lt;&gt;\u2019\n      from the context: (ConvertibleStrings a Text,\n                         ConvertibleStrings b Text,\n                         ConvertibleStrings Text c)\n        bound by the type signature for:\n                   singleFunction :: (ConvertibleStrings a Text,\n                                      ConvertibleStrings b Text, ConvertibleStrings Text c) =&gt;\n                                     a -&gt; b -&gt; c\n        at /home/chris/Projects/Haskell/Hart/Hart.hs:(37,1)-(40,43)\n      The type variable \u2018a0\u2019 is ambiguous\n      These potential instances exist:\n        instance Monoid a =&gt; Monoid (IO a) -- Defined in \u2018GHC.Base\u2019\n        instance Monoid Ordering -- Defined in \u2018GHC.Base\u2019\n        instance Monoid Text -- Defined in \u2018Data.Text\u2019\n        ...plus 8 others\n        ...plus 19 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the first argument of \u2018cs\u2019, namely \u2018(cs a &lt;&gt; cs b)\u2019\n      In the expression: cs (cs a &lt;&gt; cs b)\n      In an equation for \u2018singleFunction\u2019:\n          singleFunction a b = cs (cs a &lt;&gt; cs b)\n\n/home/chris/Projects/Haskell/Hart/Hart.hs:41:34: error:\n    \u2022 Could not deduce (ConvertibleStrings b a0)\n        arising from a use of \u2018cs\u2019\n      from the context: (ConvertibleStrings a Text,\n                         ConvertibleStrings b Text,\n                         ConvertibleStrings Text c)\n        bound by the type signature for:\n                   singleFunction :: (ConvertibleStrings a Text,\n                                      ConvertibleStrings b Text, ConvertibleStrings Text c) =&gt;\n                                     a -&gt; b -&gt; c\n        at /home/chris/Projects/Haskell/Hart/Hart.hs:(37,1)-(40,43)\n      The type variable \u2018a0\u2019 is ambiguous\n      Relevant bindings include\n        b :: b (bound at /home/chris/Projects/Haskell/Hart/Hart.hs:41:18)\n        singleFunction :: a -&gt; b -&gt; c\n          (bound at /home/chris/Projects/Haskell/Hart/Hart.hs:41:1)\n      These potential instances exist:\n        instance [safe] ConvertibleStrings StrictText StrictText\n          -- Defined in \u2018Data.String.Conversions\u2019\n        instance [safe] ConvertibleStrings StrictText String\n          -- Defined in \u2018Data.String.Conversions\u2019\n        instance [safe] ConvertibleStrings String StrictText\n          -- Defined in \u2018Data.String.Conversions\u2019\n        ...plus one other\n        ...plus 21 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the second argument of \u2018(&lt;&gt;)\u2019, namely \u2018cs b\u2019\n      In the first argument of \u2018cs\u2019, namely \u2018(cs a &lt;&gt; cs b)\u2019\n      In the expression: cs (cs a &lt;&gt; cs b)\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1513593306, "post_id": 47866464, "comment_id": 82698063, "body": "So where are you stuck in your attempts? Please note this site geared towards answering specific questions. Requests like &quot;here&#39;s my assignment, help me out I have no idea where to start&quot; are frowned upon."}, {"owner": {"reputation": 9, "user_id": 9112913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a604dcd99281c49b50bbb9df7aef1c?s=128&d=identicon&r=PG&f=1", "display_name": "kefir", "link": "https://stackoverflow.com/users/9112913/kefir"}, "edited": false, "score": 0, "creation_date": 1513593799, "post_id": 47866464, "comment_id": 82698340, "body": "I was trying something like this <code>result = [x | x &lt;- (head first), x fst == x scd ]</code> take element and check the statement but is it not working. I am working with [[]] and I got the [] so this is a first problem, and I think the way that I am trying to &#39;iterate&#39; is wrong"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513593966, "post_id": 47866464, "comment_id": 82698458, "body": "Well this is not a <code>[[]]</code>, but a <code>[(a,a)]</code>..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1513593968, "post_id": 47866464, "comment_id": 82698460, "body": "First, remove the <code>head</code> -- it&#39;s dangerous, and not even needed here. Second, why do you apply function <code>x</code> to argument <code>fst</code> ? That makes no sense, you want <code>fst x</code> instead."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513593993, "post_id": 47866464, "comment_id": 82698480, "body": "and <code>snd</code> to obtain the second item."}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1513594108, "post_id": 47866464, "comment_id": 82698568, "body": "Edit your attempt into your question! Then all those questions in the comments are not relevant for later visitors."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1513594102, "creation_date": 1513594102, "answer_id": 47866833, "question_id": 47866464, "link": "https://stackoverflow.com/questions/47866464/how-to-compare-elements-in-a/47866833#47866833", "title": "How to compare elements in a [[]]?", "body": "<p>You can do this for instance with list comprehension. We iterate over every tuple <code>f,s)</code> in <code>first</code>, so we write <code>(f,s) &lt;- first</code> in the right side of the list comprehension, and need to filter on the fact that <code>f</code> and <code>s</code> are equal, so <code>f == s</code>. In that case we add <code>f</code> (or <code>s</code>) to the <code>result</code>. So:</p>\n\n<pre><code>result = [ f | (f,s) &lt;- first, f == s ]\n</code></pre>\n\n<p>We can turn this into a function that takes as input a list of 2-tuples <code>[(a,a)]</code>, and compares these two elements, and returns a list <code>[a]</code>:</p>\n\n<pre><code>f :: Eq a =&gt; [(a,a)] -&gt; [a]\nf dat = [f | (f,s) &lt;- dat, f == s ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1513597819, "post_id": 47866834, "comment_id": 82700662, "body": "<code>findIdentical = filter (uncurry (==)) . map fst</code>"}, {"owner": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1513602849, "post_id": 47866834, "comment_id": 82703559, "body": "What is your point, that a problem has an infinite amount of possible solutions? To be honest I prefer my function as it is very explicit while yours uses 5 functions in 1 line. It does reduce 50% of the lines of code, which is nice."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1513603758, "post_id": 47866834, "comment_id": 82704078, "body": "@SebastianRedl Your solution does not even typecheck"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1513618370, "post_id": 47866834, "comment_id": 82712528, "body": "@Glubus I prefer something like this: <code>findIdentical xs = map fst $ filter (\\(a, b) -&gt; a == b) xs</code>. Although the recursive solution is always clear and easy to read."}, {"owner": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "reply_to_user": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1513682272, "post_id": 47866834, "comment_id": 82737137, "body": "@RoadRunner Your function is also perfectly explicit, I might even prefer it actually."}], "tags": [], "owner": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "is_accepted": true, "score": 3, "last_activity_date": 1513620235, "last_edit_date": 1513620235, "creation_date": 1513594113, "answer_id": 47866834, "question_id": 47866464, "link": "https://stackoverflow.com/questions/47866464/how-to-compare-elements-in-a/47866834#47866834", "title": "How to compare elements in a [[]]?", "body": "<p>Even though you appear to have not made the most minimal amount of effort to solve this question by yourself, I will give you the answer because it is so trivial and because Haskell is a great language.</p>\n\n<p>Create a function with this signature:</p>\n\n<pre><code>findIdentical :: [(Int, Int)] -&gt; [Int]\n</code></pre>\n\n<p>It takes a list of tuples and returns a list of ints.</p>\n\n<p>Implement it like this:</p>\n\n<pre><code>findIdentical [] = []\nfindIdentical ((a,b) : xs)\n    | a == b = a : (findIdentical xs)\n    | otherwise = findIdentical xs\n</code></pre>\n\n<p>As you can see, <code>findIdentical</code> is a recursive function that compares a tuple for equality between both items, and then adds it to the result list if there is found equality.</p>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1513618421, "last_edit_date": 1513618421, "creation_date": 1513596625, "answer_id": 47867575, "question_id": 47866464, "link": "https://stackoverflow.com/questions/47866464/how-to-compare-elements-in-a/47867575#47867575", "title": "How to compare elements in a [[]]?", "body": "<p>An easy way to do this is to use the Prelude's <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\"><code>filter</code></a> function, which has the type definition:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>All you need to do is supply predicate on how to filter the elements in the list, and the list to filter. You can accomplish this easily below:</p>\n\n<pre><code>filterList :: (Eq a) =&gt; [(a, a)] -&gt; [a]\nfilterList xs = [x | (x, y) &lt;- filter (\\(a, b) -&gt; a == b) xs]\n</code></pre>\n\n<p>Which behaves as expected:</p>\n\n<pre><code>*Main&gt; filterList [(3,3),(4,6),(7,7),(5,43),(9,9),(32,1),(43,43)]\n[3,7,9,43]\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9112913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a604dcd99281c49b50bbb9df7aef1c?s=128&d=identicon&r=PG&f=1", "display_name": "kefir", "link": "https://stackoverflow.com/users/9112913/kefir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1146, "favorite_count": 0, "accepted_answer_id": 47866834, "answer_count": 3, "score": -1, "last_activity_date": 1557081767, "creation_date": 1513592922, "last_edit_date": 1557081767, "question_id": 47866464, "link": "https://stackoverflow.com/questions/47866464/how-to-compare-elements-in-a", "title": "How to compare elements in a [[]]?", "body": "<p>I am dealing with small program with Haskell. Probably the answer is really simple but I try and get no result.</p>\n\n<p>So one of the part in my program is the list: </p>\n\n<pre><code>first = [(3,3),(4,6),(7,7),(5,43),(9,9),(32,1),(43,43) ..]\n</code></pre>\n\n<p>and according to that list I want to make new one with element that are equal in the <code>() =</code>:</p>\n\n<pre><code>result = [3,7,9,43, ..]\n</code></pre>\n"}, {"tags": ["list", "haskell", "functional-programming", "prolog", "map-function"], "comments": [{"owner": {"reputation": 1362, "user_id": 7131301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95feecfe61cbcdf86514a34cdc248623?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas By", "link": "https://stackoverflow.com/users/7131301/tomas-by"}, "edited": false, "score": 1, "creation_date": 1513596398, "post_id": 47864088, "comment_id": 82699889, "body": "Wrong approach I think. Haskell is lazy, so mapping over a list is fine as the whole list never exists at one time. In Prolog you should do a recursive predicate that just updates an integer."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1513601717, "last_edit_date": 1513601717, "creation_date": 1513601323, "answer_id": 47868877, "question_id": 47864088, "link": "https://stackoverflow.com/questions/47864088/is-there-an-equivalent-of-haskells-enumfromto-in-prolog/47868877#47868877", "title": "Is there an equivalent of Haskell&#39;s enumFromTo in Prolog?", "body": "<pre class=\"lang-hs prettyprint-override\"><code>-- % f p n = map (p) [0..n] = [p 0, p 1, p 2, ..., p n]\n</code></pre>\n\n<p>is translated into Prolog as</p>\n\n\n\n<pre class=\"lang-erlang prettyprint-override\"><code>f(P,N,L):- f(P,0,N,L).\nf(P,I,N,[]):- I &gt; N.\nf(P,I,N,L):- call(P,I,X), \n             ( N =:= I -&gt; L = [X]\n             ; L = [X|T], J is I+1, f(P,J,N,T) ).\n</code></pre>\n\n<p>This assumes <code>p :: Int -&gt; a</code> for some <code>a</code>, as implied by the Haskell code. </p>\n\n<p>This also assumes you are given a concrete (\"ground\") callable two-argument predicate <code>P</code> and an integer number <code>N</code>.</p>\n\n<p>Another possibility is </p>\n\n<pre class=\"lang-erlang prettyprint-override\"><code>g(P,N,L):- findall(X, (between(0, N, I), call(P,I,X)), L).\n</code></pre>\n\n<p>This finds all <code>X</code>s such that <em>(<code>0 &lt;= I &lt;= N</code></em>  <strong>and</strong>  <em><code>P(I,X)</code>)</em> holds.</p>\n\n<p>Tested in SWI-Prolog:</p>\n\n<blockquote>\n<pre class=\"lang-erlang prettyprint-override\"><code>11 ?- [user].\nadd1(X,Y):- Y is X+1.\n|: \n\n12 ?- f(add1,5,L).\nL = [1, 2, 3, 4, 5, 6].\n\n13 ?- g(add1,5,L).\nL = [1, 2, 3, 4, 5, 6].\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 57498, "user_id": 874024, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ZZtwe.jpg?s=128&g=1", "display_name": "CapelliC", "link": "https://stackoverflow.com/users/874024/capellic"}, "is_accepted": false, "score": 2, "last_activity_date": 1513756881, "creation_date": 1513756881, "answer_id": 47901319, "question_id": 47864088, "link": "https://stackoverflow.com/questions/47864088/is-there-an-equivalent-of-haskells-enumfromto-in-prolog/47901319#47901319", "title": "Is there an equivalent of Haskell&#39;s enumFromTo in Prolog?", "body": "<p>When I was trying to code in Prolog a solution to N queens problem, as stated from <a href=\"http://picat-lang.org/\" rel=\"nofollow noreferrer\">Picat</a> home (see Example 5, near end of page), I faced a similar problem. Here is my final outcome, with commented some alternatives:</p>\n\n<pre><code>:- use_module(library(clpfd)).\n\nqueens(N, Q) :-\n    length(Q, N),\n    Q ins 1..N,\n    all_different(Q),\n    maplist_index([I,V,P]&gt;&gt;(P#=V+I),1,Q,Ps),all_different(Ps),\n    maplist_index([I,V,M]&gt;&gt;(M#=V-I),1,Q,Ms),all_different(Ms),\n    /* no\n    bagof(P, (nth1(I,Q,V), P #= V + I), Ps), all_different(Ps),\n    bagof(M, (nth1(I,Q,V), M #= V - I), Ms), all_different(Ms),\n    */\n    /* ok\n    all_different_p(Q, 1, P), all_different(P),\n    all_different_m(Q, 1, M), all_different(M),\n    */\n    label(Q).\n\nall_different_p([Q|Qs], I, [P|Ps]) :-\n    P #= Q + I,\n    succ(I, J),\n    all_different_p(Qs, J, Ps).\nall_different_p([], _I, []).\n\nall_different_m([Q|Qs], I, [P|Ps]) :-\n    P #= Q - I,\n    succ(I, J),\n    all_different_m(Qs, J, Ps).\nall_different_m([], _I, []).\n\nmaplist_index(P, I, [X|Xs], [Y|Ys]) :-\n    call(P, I, X, Y),\n    succ(I, J),\n    maplist_index(P, J, Xs, Ys).\nmaplist_index(_, _, [], []).\n</code></pre>\n\n<p>maplist_index/4 is an example of what you need. It's worth to note that bagof/3 doesn't work well in presence of attributed variables.</p>\n"}], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 47868877, "answer_count": 2, "score": 3, "last_activity_date": 1513756881, "creation_date": 1513583464, "last_edit_date": 1513679204, "question_id": 47864088, "link": "https://stackoverflow.com/questions/47864088/is-there-an-equivalent-of-haskells-enumfromto-in-prolog", "title": "Is there an equivalent of Haskell&#39;s enumFromTo in Prolog?", "body": "<p>I've just been starting out in Prolog and I was hoping to perform the following task:</p>\n\n<blockquote>\n  <p>Make a predicate <code>A(P,N,L)</code> such that for all <code>C</code> which is nth element of <code>L</code>, <code>P(N,C)</code>.</p>\n</blockquote>\n\n<p>Basically I want to perform a map on the range <code>[0..N]</code>.\nIn Haskell, the language I am most familiar with, this would look like</p>\n\n<pre><code>f p n = map(p)[0..n]\n</code></pre>\n\n<p><em>(Haskell doesn't quite have predicates so I'm taking some liberties here)</em></p>\n\n<p>or in pointfree</p>\n\n<pre><code>f = (.enumFromTo 0).map\n</code></pre>\n\n<p>And it seems like I should be able to do it in Prolog easily enough.  Prolog's <code>maplist/3</code> is basically already that so it should be a trivial modification. My definition should look something like:</p>\n\n<pre><code>A(P,N,L) :- maplist(P, ??? , L).\n</code></pre>\n\n<p>However I can't really figure out what to put in the blank.  In Haskell I would use a function like <code>enumFromTo</code>, but it seems that such a thing doesn't exist in Prolog.  The closes equivalent would be <code>between/3</code>, but that isn't a list so I can't use for <code>maplist</code>.</p>\n\n<p>Alternatively I could make my own range predicate.</p>\n\n<p>The first thing I tried was:</p>\n\n<pre><code>range(0,[0]).\nrange(N,[N|T]) :- range(N-1,T).\nA(P,N,L) :- range(N,rangeN), maplist(P, rangeN, L).\n</code></pre>\n\n<p>But I can't get that to resolve at all.  I also tried</p>\n\n<pre><code>range(N,L):-findall(X,between(0,N,X),L),sort(L,L).\nA(P,N,L) :- range(N,rangeN), maplist(P, rangeN, L).\n</code></pre>\n\n<p>But that just seems really clunky for such a small problem.</p>\n\n<p>How might I fill in the gap in my <code>maplist</code>?  Am I approaching the problem in the wrong way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1513575198, "post_id": 47862463, "comment_id": 82690194, "body": "Uh. Since <code>S</code> and <code>T</code> have terms of different types in them, you&#39;re going to need (or at least want) different <code>f</code>s. How are you picturing the selection of <code>f</code>s going?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1513575743, "post_id": 47862463, "comment_id": 82690348, "body": "Could you use a more concrete example of what you&#39;re trying to do? I&#39;m not sure what you mean by <i>&quot;assuming S and T are lists of arguments&quot;</i>."}, {"owner": {"reputation": 43, "user_id": 7475947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81cabfb282248310cbc00b9eb744400?s=128&d=identicon&r=PG", "display_name": "Daniel Satanove", "link": "https://stackoverflow.com/users/7475947/daniel-satanove"}, "edited": false, "score": 0, "creation_date": 1513577390, "post_id": 47862463, "comment_id": 82690825, "body": "Actually in the case I would want, those lists are actually going to be of a single type. I&#39;m editing with example"}, {"owner": {"reputation": 43, "user_id": 7475947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81cabfb282248310cbc00b9eb744400?s=128&d=identicon&r=PG", "display_name": "Daniel Satanove", "link": "https://stackoverflow.com/users/7475947/daniel-satanove"}, "edited": false, "score": 0, "creation_date": 1513578440, "post_id": 47862463, "comment_id": 82691165, "body": "I don&#39;t think my original question is well defined, but I clarify what sort of thing I&#39;m trying to do, so perhaps someone might have some idea of how to do this."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1513579591, "post_id": 47862463, "comment_id": 82691568, "body": "I think you want to look into generic programming. See e.g. <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/GHC-Generics.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.10.1.0/docs/&hellip;</a> (or <a href=\"https://wiki.haskell.org/Generics\" rel=\"nofollow noreferrer\">wiki.haskell.org/Generics</a> for more libraries, but it isn&#39;t exhaustive)."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1513579831, "post_id": 47862463, "comment_id": 82691645, "body": "Ah, the answers to the original question already send you to <code>Data.Data</code>."}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 0, "last_activity_date": 1513662407, "creation_date": 1513662407, "answer_id": 47880700, "question_id": 47862463, "link": "https://stackoverflow.com/questions/47862463/collecting-the-arguments-of-a-constructor-for-some-type/47880700#47880700", "title": "Collecting the arguments of a constructor for some type", "body": "<p>Here's how it would look like with the <a href=\"https://hackage.haskell.org/package/one-liner-0.9.1\" rel=\"nofollow noreferrer\">one-liner</a> library for generic programming. There is a bit of boilerplate that could be packaged up somewhere, one-liner perhaps.</p>\n\n<p>The argument of <code>zipWithA</code> that makes the recursive call to <code>match'</code> has type <code>forall s. Typeable s =&gt; s -&gt; s -&gt; ZeroA Unifier s</code>, where <code>ZeroA</code> is a certain applicative functor. Ideally, we would like <code>s</code> to be equal to <code>Term</code>, but <code>one-liner</code> expects a function that can handle all fields of the generic type (you get to choose a constraint that must hold for all of them); we use <code>Typeable</code> (via <code>withType</code>) to filter out the invalid cases.</p>\n\n<p><code>main.hs</code>:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, TypeApplications #-}\n\nimport Data.Typeable (Typeable)\nimport Generics.OneLiner (zipWithA)\nimport GHC.Generics (Generic)\n\nimport MyLibrary  -- Some setup that should probably go in a library\n\n-- Some arbitrary syntax\ntype V = Int\ndata Term = Var V | C | UnOp Term | BinOp Term Term\n  deriving (Show, Generic)\n\ntype Unifier = [(Int, Term)]\n\nmatch :: Term -&gt; Term -&gt; Maybe Unifier\nmatch t1 t2 = unZeroA (match' t1 t2)\n\n-- ZeroA is a wrapper around the applicative functor Const\nmatch' :: Term -&gt; Term -&gt; ZeroA Unifier Term\nmatch' (Var v1) t2 = write (v1, t2)\nmatch' t1 (Var v2) = write (v2, t1)\nmatch' t1 t2 = zipWithA @Typeable f t1 t2\n  where\n    f :: Typeable s =&gt; s -&gt; s -&gt; ZeroA Unifier s\n    f s1 s2 = withType @Term s1 (match' s1 s2)\n\nmain = do\n  print (match (BinOp (Var 0) (UnOp (UnOp (Var 1))))\n               (BinOp C       (UnOp (Var 4))))\n  -- Just [(0,C),(4,UnOp (Var 1))]\n  print (match (BinOp C C) (UnOp C))\n  -- Nothing\n</code></pre>\n\n<p><code>MyLibrary.hs</code>:</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes, DeriveGeneric, FlexibleInstances, GADTs, RankNTypes, ScopedTypeVariables, TypeOperators #-}\n\nmodule MyLibrary where\n\nimport Control.Applicative (Alternative(..), Const(..))\nimport Data.Typeable (Typeable, eqT, (:~:)(..))\n\n-- Add an absorbing element to any Monoid b\nnewtype Zero b = Zero { unZero :: Maybe b }\n\nnil :: Zero b\nnil = Zero Nothing\n\ntoZero :: b -&gt; Zero b\ntoZero b = Zero (Just b)\n\ninstance Monoid b =&gt; Monoid (Zero b) where\n  mempty = Zero (Just mempty)\n  Zero Nothing `mappend` _            = nil\n  _            `mappend` Zero Nothing = nil\n  Zero a       `mappend` Zero b       = Zero (a `mappend` b)  -- reusing the Maybe Monoid.\n\n-- Every monoid induces an Applicative functor via Const.\ntype ZeroA b = Const (Zero b)\n\nunZeroA :: ZeroA b a -&gt; Maybe b\nunZeroA = unZero . getConst\n\n-- A writer-like action.\nwrite :: b -&gt; ZeroA [b] a\nwrite b = Const (toZero [b])\n\n-- A monoid with an absorbing element induces an Alternative functor\ninstance Monoid b =&gt; Alternative (ZeroA b) where\n  empty = Const nil\n  Const (Zero Nothing) &lt;|&gt; y = y\n  x &lt;|&gt; _ = x\n\n-- Typeable helper\n\n-- withType @t x (body x):\n-- the body may assume that the type of x is equal to t.\n--\n-- If that is actually the case, then\n-- withType @t x (body x) = body x\n-- otherwise\n-- withType @t x (body x) = empty\nwithType\n  :: forall t s f a\n  . (Typeable s, Typeable t, Alternative f)\n  =&gt; s -&gt; ((t ~ s) =&gt; f a) -&gt; f a\nwithType _ body = case eqT :: Maybe (s :~: t) of\n  Nothing -&gt; empty\n  Just Refl -&gt; body\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7475947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81cabfb282248310cbc00b9eb744400?s=128&d=identicon&r=PG", "display_name": "Daniel Satanove", "link": "https://stackoverflow.com/users/7475947/daniel-satanove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513662407, "creation_date": 1513574009, "last_edit_date": 1513578831, "question_id": 47862463, "link": "https://stackoverflow.com/questions/47862463/collecting-the-arguments-of-a-constructor-for-some-type", "title": "Collecting the arguments of a constructor for some type", "body": "<p>A followup question to <a href=\"https://stackoverflow.com/questions/47861648/a-general-way-of-comparing-constructors-of-two-terms-in-haskell\">this</a>, suppose I have two terms t1 and t2 of some algebraic datatype, and I have checked that the constructor for t1 and t2 are the same. That is, (informally), t1 = F(S) and t2 = G(T), and I've checked that F = G. Now I want to compute </p>\n\n<pre><code>map f (zip S T)\n</code></pre>\n\n<p>assuming S and T are lists of arguments. This naive code would require that everything in S is of some singular type though, which isn't going to be true in general. </p>\n\n<p>At this point I'm just curious if there is a way to do this. It seems like casing over the constructors is going to be a much simpler solution. I would like to write this for a generic type, but I only need it for some specific type.</p>\n\n<hr>\n\n<p>Edit: My specification of the problem wasn't quite right. The type I'm using is something like</p>\n\n<pre><code>data Term v = F (Term v) (Term v)\n            | G (Term v)\n            | C\n            | Var v\n</code></pre>\n\n<p>For constructors with zero or more arguments of type <code>Term v</code> (like <code>(F x y, F z w)</code>), I want to apply a function to each of them and collect a list of results: <code>[f (x,z), f (y,w)]</code>, and I want to ignore the variables. </p>\n\n<p>I'm assuming the type <code>Term v</code> is of some class <code>Unifiable v</code> which has a method <code>isVar</code> which picks out which terms of my type are variables. But given that types can have constructors with arbitrary arguments, I'm not sure in what generality I could have for this in the first place. I'd need something like for there to be a specific <code>Var</code> constructor, and all other constructors to be of the form <code>F [Term v]</code>, or some such, and I'm not sure what constraints I would need to guarantee that.</p>\n\n<hr>\n\n<p>Edit: More specifically, I'm trying to define a function (in fake haskell)</p>\n\n<pre><code>match :: (Variable v) =&gt; Term v -&gt; Term v -&gt; Maybe [(v, Term v)]\nmatch t1 t2 = case t1 of\n  Var v -&gt; Just (check v t2)\n  f xs -&gt; case t2 of\n    Var v -&gt; Just (check t1 v)\n    g ys -&gt; if f == g then flatten(map match (zip (xs,ys)))\n              else Nothing\n</code></pre>\n\n<p>Of course, you can't use case like that, and this assumes every constructor (except Var) takes a list as its argument.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "edited": false, "score": 0, "creation_date": 1513567500, "post_id": 47861648, "comment_id": 82688456, "body": "Maybe you could use <a href=\"https://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Prism.html\" rel=\"nofollow noreferrer\">Prisms</a> from the <a href=\"https://hackage.haskell.org/package/lens-4.15.4\" rel=\"nofollow noreferrer\">Lens package</a> for that, might be worth a shot."}], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": false, "score": 3, "last_activity_date": 1513568426, "last_edit_date": 1513568426, "creation_date": 1513567621, "answer_id": 47861765, "question_id": 47861648, "link": "https://stackoverflow.com/questions/47861648/a-general-way-of-comparing-constructors-of-two-terms-in-haskell/47861765#47861765", "title": "A general way of comparing constructors of two terms in Haskell", "body": "<p>You could use some kind of intermediate type which can uniquely distinguish each constructor and has an <code>Eq</code> instance. For example, you could use an <code>Int</code> to distinguish each data constructor, and then compare the values.</p>\n\n<pre><code>checkConst x y = toInt x == toInt y\n  where\n    toInt (Left _)  = 1 :: Int\n    toInt (Right _) = 2\n</code></pre>\n\n<p>If your type implements <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Data.html#t:Data\" rel=\"nofollow noreferrer\"><code>Data</code></a> from <code>Data.Data</code>, you could use <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Data.html#v:toConstr\" rel=\"nofollow noreferrer\"><code>toConstr</code></a> to use <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Data.html#t:Constr\" rel=\"nofollow noreferrer\"><code>Constr</code></a> as your intermediate type. In the case of <code>Either</code> this isn't necessary because you could use <code>isRight x == isRight y</code>, but for a data type with 10 constructors, this would be cleaner.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 6, "last_activity_date": 1513568194, "creation_date": 1513568194, "answer_id": 47861824, "question_id": 47861648, "link": "https://stackoverflow.com/questions/47861648/a-general-way-of-comparing-constructors-of-two-terms-in-haskell/47861824#47861824", "title": "A general way of comparing constructors of two terms in Haskell", "body": "<p>You are probably looking for the generics functionality available in the <code>Data.Data</code> module.  If you define a data type with a derived <code>Data</code> instance, like so:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\nimport Data.Data\ndata Foo = Bar1 Int\n         | Bar2 String String\n         | Bar3 Double\n         deriving (Data)\n</code></pre>\n\n<p>then you can retrieve the constructor for a value with <code>toConstr</code>:</p>\n\n<pre><code>&gt; toConstr (Bar1 1)\nBar1\n&gt; toConstr (Bar2 \"hello\" \"there\")\nBar2\n&gt;\n</code></pre>\n\n<p>These are values of type <code>Constr</code> that can be compared for equality, so you can define:</p>\n\n<pre><code>checkConst :: (Data g) =&gt; g -&gt; g -&gt; Bool\ncheckConst x y = toConstr x == toConstr y\n</code></pre>\n\n<p>and get:</p>\n\n<pre><code>&gt; checkConst (Bar1 10) (Bar1 20)\nTrue\n&gt; checkConst (Bar1 10) (Bar3 20)\nFalse\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7475947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81cabfb282248310cbc00b9eb744400?s=128&d=identicon&r=PG", "display_name": "Daniel Satanove", "link": "https://stackoverflow.com/users/7475947/daniel-satanove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "closed_date": 1513589509, "accepted_answer_id": 47861824, "answer_count": 2, "score": 4, "last_activity_date": 1513568426, "creation_date": 1513566570, "question_id": 47861648, "link": "https://stackoverflow.com/questions/47861648/a-general-way-of-comparing-constructors-of-two-terms-in-haskell", "closed_reason": "Duplicate", "title": "A general way of comparing constructors of two terms in Haskell", "body": "<p>Given two terms t1 t2 of some data type, is there some way to check if t1 and t2 start with the same constructor, without doing some exhaustive case or pattern matching over constructors? Like if my type is Either a b, then I want  </p>\n\n<pre><code>checkConst (Left x) (Left y) = True\ncheckConst (Right x) (Left y) = False\n...\n</code></pre>\n\n<p>and so on without actually doing that pattern matching, and in a way that is generalizable to other types with on the order of 10 constructors. Is there a nice way to do this?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "edited": false, "score": 0, "creation_date": 1513562321, "post_id": 47861158, "comment_id": 82687303, "body": "The implementation of <code>selectA</code> explicitly returns a <code>Maybe A&#39;</code>, how do you expect it to return anything else? You can define a polymorphic function that behaves the way you want if your class <code>A</code> has such polymorphic methods, like <code>toEnum</code>, <code>read</code>, etc, and you define your function in terms of such a function."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1513562732, "post_id": 47861158, "comment_id": 82687379, "body": "Then why not <code>selectA _ = Just a</code>?"}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "reply_to_user": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "edited": false, "score": 0, "creation_date": 1513563649, "post_id": 47861158, "comment_id": 82687567, "body": "@kuoytfouy Adding another type that implements <code>A</code> and adding a case for it in the definition of <code>selectA</code> changes nothing. I tried to make this a minimal working example, and another type would be just extra noise in the question. Also, <code>toEnum</code> and <code>read</code> function fundamentally differently - the caller is able to specify the exact type. I don&#39;t want that - the caller should only be able to access the functionality <code>A</code> and not any actual types, such as <code>A&#39;</code>."}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513563747, "post_id": 47861158, "comment_id": 82687582, "body": "@ReinHenrichs What&#39;s <code>a</code>? In my question it&#39;s a type, but it&#39;s not possible to return types - only values. Besides, that&#39;s not what I want. I don&#39;t want a <i>type</i> that implements <code>A</code>; I want a <i>value</i> whose type implements <code>A</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1513563870, "post_id": 47861158, "comment_id": 82687604, "body": "@Xiyng You defined the value <code>a</code>: <code>class A a where a :: a</code>. FWIW, your code would compile with my suggested change."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1513563970, "post_id": 47861158, "comment_id": 82687624, "body": "Also FWIW, it might be less confusing for you if you hadn&#39;t named literally everything &quot;a&quot;."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513566416, "post_id": 47861158, "comment_id": 82688176, "body": "Based on &quot;the caller should only be able to access the functionality A and not any actual types, such as A&#39;&quot; you want the type <code>newtype SomeA = SomeA (forall a . A a =&gt; a)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1513572784, "post_id": 47861158, "comment_id": 82689572, "body": "@user2407038, don&#39;t you mean <code>data SomeA = forall a. A a =&gt; SomeA a</code>?"}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513573243, "post_id": 47861158, "comment_id": 82689678, "body": "@ReinHenrichs I originally had more letters but it was kind of hard to keep track of them all. I suppose there could have been a middle ground though... Anyway, now I see what you meant. I guess I meant the example <i>too</i> minimal, because to me, it seems like your solution breaks as soon as I add more complex class methods (e.g. of type <code>a -&gt; b</code>). Do you think I should edit the question to reflect this possibility?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513573307, "post_id": 47861158, "comment_id": 82689694, "body": "@Xiyng Yes, my solution only does what you asked it to do, not what you didn&#39;t ask it to do."}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513573745, "post_id": 47861158, "comment_id": 82689800, "body": "@dfeuer This seems to work, and aside from having an annoying wrapper type, it seems like a pretty neat solution. Depending on other suggested solutions, I might look into using this one."}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1513564917, "post_id": 47861431, "comment_id": 82687839, "body": "The first code snippet won&#39;t compile, since <code>A&#39;</code> and <code>A&#39;&#39;</code> aren&#39;t of the same type. Imagine what would happen if someone did <code>let (Just (A&#39; x)) = selectA 1 in x</code>"}, {"owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1513565860, "post_id": 47861431, "comment_id": 82688051, "body": "I know, this is just supposed to portray what I think OP wants to achieve. But I&#39;ll add a note saying that it does not actually compile and should be seen as &quot;Pseudo-Haskell&quot;."}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "edited": false, "score": 0, "creation_date": 1513572463, "post_id": 47861431, "comment_id": 82689485, "body": "Choosing the return value based on the <code>Int</code> argument is indeed what I want to do. Basically I&#39;m trying to create a parser for a data format, where I have a (slightly different) type for each version of the format but each version has a common interface, i.e. they all implement the same typeclass. Thus one version of the format is parsed by a parser of type <code>Parser P</code>, another by <code>Parser Q</code>, etc., and I want to determine the parser to use from the version number specified at the beginning of the file I&#39;m parsing. This approach has a weakness though, and I might not end up using it."}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "edited": false, "score": 0, "creation_date": 1513572757, "post_id": 47861431, "comment_id": 82689562, "body": "I kind of like this approach because it&#39;s simple and does just about what I want. I was actually thinking of it myself, but I was hoping to find a more extensible approach. Typeclasses are nice because you can always implement more instances, but you can&#39;t do the same with algebraic data types."}], "tags": [], "owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "is_accepted": false, "score": 3, "last_activity_date": 1513565973, "last_edit_date": 1513565973, "creation_date": 1513564348, "answer_id": 47861431, "question_id": 47861158, "link": "https://stackoverflow.com/questions/47861158/returning-a-value-of-any-type-that-implements-a-specific-typeclass/47861431#47861431", "title": "Returning a value of any type that implements a specific typeclass", "body": "<p>You probably want to be able to have the caller select the return type of <code>selectA</code> via the <code>Int</code> argument which you currently just ignore.</p>\n\n<p>Something like:</p>\n\n<pre><code>data A'  = A' Int\ndata A'' = A'' Char\n\ninstance A A' where\n    a = A' 0\n\ninstance A A'' where\n    a = A'' '0'\n\nselectA :: (A a) =&gt; Int -&gt; Maybe a\nselectA 0 = Just (A' 0)\nselectA 1 = Just (A'' '0')\nselectA _ = Nothing\n</code></pre>\n\n<p>(Note: This does not compile - it's just \"Pseudo Haskell\" to portray what I think you want to achieve)</p>\n\n<p>If you don't feel free to ignore this. If you do however, consider not using a typeclass <code>A</code> for that but a data type <code>A</code> which has multiple constructors.</p>\n\n<pre><code>data A = A' Int | A'' Char\n\nselectA :: Int -&gt; Maybe A\nselectA 0 = Just $ A' 0\nselectA 1 = Just $ A'' '0'\nselectA _ = Nothing\n</code></pre>\n\n<p>Why exactly you want to do this, though, is something I wonder.</p>\n"}, {"comments": [{"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "edited": false, "score": 0, "creation_date": 1513574535, "post_id": 47862377, "comment_id": 82690016, "body": "Aside from having an annoying wrapper type, this seems to be exactly what I was looking for. By the way, your last code block seems to compile just fine on my system with <code>GADTs</code> instead of <code>ExistentialQuantification</code>, at least without the rest of your code. Also, strictly speaking I&#39;m not <i>quite</i> trying to have a superclass. Rather, I have a set of data types that are similar but structurally slightly different, and trying to provide a common interface for accessing their data due to how similar they are. It&#39;s a bit ugly but I haven&#39;t come up with anything better, at least yet."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "edited": false, "score": 0, "creation_date": 1513633745, "post_id": 47862377, "comment_id": 82719514, "body": "It looks like <code>GADTs</code> plus some other extension (e.g., <code>RankNTypes</code>) will allow the other syntax, though <code>GADTs</code> alone doesn&#39;t, at least with GHC 8.0.2."}, {"owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "edited": false, "score": 0, "creation_date": 1513635317, "post_id": 47862377, "comment_id": 82720200, "body": "Ah, you&#39;re right. I had <code>RankNTypes</code> enabled due to testing stuff."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1513573329, "creation_date": 1513573329, "answer_id": 47862377, "question_id": 47861158, "link": "https://stackoverflow.com/questions/47861158/returning-a-value-of-any-type-that-implements-a-specific-typeclass/47862377#47862377", "title": "Returning a value of any type that implements a specific typeclass", "body": "<p>In object oriented languages, it's very common to take an object of a specific concrete class, like say a <code>Circle</code>, and \"upcast\" it to an abstract superclass (like <code>Shape</code>) or an interface (like <code>Drawable</code>) where it will be manipulated using a restricted set of methods (e.g., <code>extent()</code>, <code>draw()</code>, etc.) applicable to that superclass / interface.</p>\n\n<p>If you are trying to take this pattern and translate it into Haskell typeclasses, you are probably going to end up with a horrible design.</p>\n\n<p>But who am I to stop you?</p>\n\n<p>You can more or less accomplish what you want with GADTs:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n</code></pre>\n\n<p>Given the following class with two instances:</p>\n\n<pre><code>class A a where\n  name :: a -&gt; String\n\ndata A1 = A1 Int\ndata A2 = A2 Double\n\ninstance A A1 where name _ = \"A1\"\ninstance A A2 where name _ = \"A2\"\n</code></pre>\n\n<p>you can define a GADT that will wrap any type with an <code>A</code> instance:</p>\n\n<pre><code>data SomeA where\n  SomeA :: A a =&gt; a -&gt; SomeA\n</code></pre>\n\n<p>together with an instance to bridge the methods to the wrapped type:</p>\n\n<pre><code>instance A SomeA where\n  name (SomeA x) = name x\n</code></pre>\n\n<p>and now <code>selectA</code> can return any (wrapped) type that's an instance of <code>A</code>:</p>\n\n<pre><code>selectA :: Int -&gt; Maybe SomeA\nselectA 1 = Just (SomeA (A1 0))\nselectA 2 = Just (SomeA (A2 0))\n</code></pre>\n\n<p>which can be used through the methods for typeclass <code>A</code>:</p>\n\n<pre><code>test :: IO ()\ntest = do putStrLn $ name (fromJust (selectA 1))\n          putStrLn $ name (fromJust (selectA 2))\n</code></pre>\n\n<p>Note that the GADT above is equivalent to the existential type being discussed in the comments:</p>\n\n<pre><code>data SomeA = forall a . A a =&gt; SomeA a\n</code></pre>\n\n<p>Using this syntax requires enabling the <code>ExistentialQuantification</code> extentsion instead of <code>GADTs</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1513607144, "creation_date": 1513607144, "answer_id": 47870514, "question_id": 47861158, "link": "https://stackoverflow.com/questions/47861158/returning-a-value-of-any-type-that-implements-a-specific-typeclass/47870514#47870514", "title": "Returning a value of any type that implements a specific typeclass", "body": "<p>You are requesting an <a href=\"https://wiki.haskell.org/Existential_type\" rel=\"nofollow noreferrer\"><em>existential type</em></a>.  These are not directly supported in Haskell's type system the way universals are, but there are two common encodings:</p>\n\n<ul>\n<li><p>A wrapper</p>\n\n<pre><code>data SomeA where\n    SomeA :: A a =&gt; a -&gt; SomeA\nselectA :: Int -&gt; SomeA\nselectA _ = SomeA (A' 0)\n</code></pre></li>\n<li><p>Continuation passing style</p>\n\n<pre><code>selectA :: Int -&gt; (forall a. A a =&gt; a -&gt; z) -&gt; z\nselectA _ c = c (A' 0)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 260, "user_id": 5005157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR4eM.png?s=128&g=1", "display_name": "Xiyng", "link": "https://stackoverflow.com/users/5005157/xiyng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 47862377, "answer_count": 3, "score": 1, "last_activity_date": 1513607144, "creation_date": 1513561730, "last_edit_date": 1513574738, "question_id": 47861158, "link": "https://stackoverflow.com/questions/47861158/returning-a-value-of-any-type-that-implements-a-specific-typeclass", "title": "Returning a value of any type that implements a specific typeclass", "body": "<p>Suppose I have</p>\n\n<pre><code>class A a where\n    a :: a\n\ndata A' = A' Int\n\ninstance A A' where\n    a = A' 0\n\nselectA :: A a =&gt; Int -&gt; Maybe a\nselectA _ = Just (A' 0)\n</code></pre>\n\n<p>As you can see, <code>selectA</code> is supposed to select some value whose type implements <code>A</code>. Note: The type of <code>a</code> doesn't have to be <code>a</code>, and it could be something else, e.g. <code>a -&gt; Char</code>. Anyway, considering that <code>A'</code> is a member of the class <code>A</code>, I would expect this implementation of <code>selectA</code> to work. However, compiling this gives the following error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u2022 Couldn't match type \u2018a\u2019 with \u2018A'\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n    the type signature for:\n      selectA :: forall a. A a =&gt; Int -&gt; Maybe a\n    at --\n  Expected type: Maybe a\n    Actual type: Maybe A'\n\u2022 In the expression: Just (A' 0)\n  In an equation for \u2018selectA\u2019: selectA _ = Just (A' 0)\n\u2022 Relevant bindings include\n    selectA :: Int -&gt; Maybe a (bound at --)\n</code></pre>\n\n<p>My undestanding is that this problem arises from the caller of <code>selectA</code> being able to decide the exact type of <code>a</code>. I'm only interested in getting <em>something</em> that implements <code>A</code>. This would solve the problem if it was possible:</p>\n\n<pre><code>selectA :: Int -&gt; Maybe (A a =&gt; a)\n</code></pre>\n\n<p>Unfortunately this is not possible. How do I get similar functionality?</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513538594, "post_id": 47858606, "comment_id": 82681720, "body": "You can use <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Debug-Trace.html\" rel=\"nofollow noreferrer\"><b><code>Debug.Trace</code></b></a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9110663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655bd1f3416369c4240e3ecfd822ac83?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoeIT", "link": "https://stackoverflow.com/users/9110663/johndoeit"}, "edited": false, "score": 0, "creation_date": 1513539319, "post_id": 47858678, "comment_id": 82681946, "body": "As far as i understood it, i need the function to give out its normal result and also the number of steps it took for it to terminate/reach this result. Also i think your first type is more correct, as i&#39;ve been leaning towards something like that too."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 1, "user_id": 9110663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655bd1f3416369c4240e3ecfd822ac83?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoeIT", "link": "https://stackoverflow.com/users/9110663/johndoeit"}, "edited": false, "score": 1, "creation_date": 1513540805, "post_id": 47858678, "comment_id": 82682424, "body": "Okay so if you want to output <i>number of steps</i> then an appropriate type would probably be: <code>Tree a -&gt; (Int, [a])</code>"}, {"owner": {"reputation": 1, "user_id": 9110663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655bd1f3416369c4240e3ecfd822ac83?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoeIT", "link": "https://stackoverflow.com/users/9110663/johndoeit"}, "edited": false, "score": 0, "creation_date": 1513542518, "post_id": 47858678, "comment_id": 82682938, "body": "Yeah, that seems right, and having the steps as output for an empty list and just one Leaf should be easy, because, as far as i understood it, they should both be one so all i gotta do is change them to  ([], 1) and ([a],1) , but i&#39;m having trouble doing the last part, leaves l ++ leaves r, as i still need to find out exactly how long that would take and how to fit the types correctly"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 1, "user_id": 9110663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655bd1f3416369c4240e3ecfd822ac83?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoeIT", "link": "https://stackoverflow.com/users/9110663/johndoeit"}, "edited": false, "score": 0, "creation_date": 1513545287, "post_id": 47858678, "comment_id": 82683747, "body": "Please take a look at <code>splitAt</code> as I suggested. I think you can figure it out. You&#39;re trying to translate the following into code: &quot;<code>leaves</code> of a branch is (the sum of the steps for the right and left branches, the concatenation of the leaves for the right and left branches)&quot;. You&#39;ll want to do: <code>let (stepsLeft, leavesLeft) = leaves l ... in ...</code>."}, {"owner": {"reputation": 1, "user_id": 9110663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655bd1f3416369c4240e3ecfd822ac83?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoeIT", "link": "https://stackoverflow.com/users/9110663/johndoeit"}, "edited": false, "score": 0, "creation_date": 1513551480, "post_id": 47858678, "comment_id": 82685287, "body": "Thank you for your help, but i keep getting the same type errors and i still don&#39;t know how long it takes for the function to terminate all before i even made it to the second function, so i think i&#39;m gonna give up. Maybe its because i missed a bunch of lectures recently or maybe i&#39;m just not cut out for Computer science. Still thank you though you&#39;ve helped a lot."}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 2, "last_activity_date": 1513539014, "creation_date": 1513539014, "answer_id": 47858678, "question_id": 47858606, "link": "https://stackoverflow.com/questions/47858606/rewriting-a-haskell-tree-leaves-function-so-that-it-gives-out-its-computing-step/47858678#47858678", "title": "Rewriting a Haskell Tree leaves function so that it gives out its computing steps as well as its result", "body": "<blockquote>\n  <p>I don't really even know how to begin</p>\n</blockquote>\n\n<p>I would start by defining what you mean by \"give out their computing steps\". Is your program supposed to print some output in a particular format?</p>\n\n<p>The next thing you should do is decide what the new type of <code>leaves</code> ought to be. Not knowing the answer to the first question, one possibility is:</p>\n\n<pre><code>leaves :: Tree a -&gt; ([ComputingStep], [a])\n</code></pre>\n\n<p>Or maybe you need to return the \"steps\" interleaved with the leaf elements?:</p>\n\n<pre><code>leaves :: Tree a -&gt; [Either ComputingStep a]\n</code></pre>\n\n<p>From here, start with your base cases and go from there. You might like to look at a function like <code>splitAt</code> from <code>Data.List</code> for inspiration (an example of a recursive function that returns a tuple).</p>\n"}, {"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513587109, "post_id": 47863976, "comment_id": 82694568, "body": "If you use an accumulator in <code>go</code>, why do you fall back to calling <code>leaves</code> in the <code>Br</code> case?"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513588991, "post_id": 47863976, "comment_id": 82695514, "body": "@gallais My God, my mistake. Fixed. Thanks!"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513589757, "post_id": 47863976, "comment_id": 82695937, "body": "I&#39;m still not sure what the point of the accumulator is: you could simply have <code>(1, [])</code> and <code>(1, [a])</code> in the base cases and <code>(n1 + n2 + 1, resl ++ resr)</code> in the branch case."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513590127, "post_id": 47863976, "comment_id": 82696141, "body": "Yes, it is not necessary, I&#39;m just much more used to this style. I will rewrite my answer because in this case it is overkill"}], "tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": -1, "last_activity_date": 1513590645, "last_edit_date": 1513590645, "creation_date": 1513582945, "answer_id": 47863976, "question_id": 47858606, "link": "https://stackoverflow.com/questions/47858606/rewriting-a-haskell-tree-leaves-function-so-that-it-gives-out-its-computing-step/47863976#47863976", "title": "Rewriting a Haskell Tree leaves function so that it gives out its computing steps as well as its result", "body": "<p>From comments I guessed you only need information how many function calls did you make. You may just sum them in pretty simple way:</p>\n\n<pre><code>leaves :: Tree a -&gt; (Int, [a])\nleaves''' Nil = (1, [])\nleaves''' (Leaf a) = (1, [a])\nleaves''' (Br l r) = let (n1, resl) = leaves''' l\n                         (n2, resr) = leaves''' r\n                     in (n1 + n2 + 1, resl ++ resr)\n</code></pre>\n\n<p>(and second variant in similar way)</p>\n"}], "owner": {"reputation": 1, "user_id": 9110663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655bd1f3416369c4240e3ecfd822ac83?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoeIT", "link": "https://stackoverflow.com/users/9110663/johndoeit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513608145, "creation_date": 1513538497, "last_edit_date": 1513608145, "question_id": 47858606, "link": "https://stackoverflow.com/questions/47858606/rewriting-a-haskell-tree-leaves-function-so-that-it-gives-out-its-computing-step", "title": "Rewriting a Haskell Tree leaves function so that it gives out its computing steps as well as its result", "body": "<p>I have the task of rewriting two Haskell functions of the Tree Datatype so that they also give out their computing steps.\nThe Functions are </p>\n\n<pre><code>leaves :: Tree a -&gt; [a]\nleaves Nil   = []\nleaves (Leaf a) = [a]\nleaves (Br l r) = leaves l ++ leaves r\n</code></pre>\n\n<p>and</p>\n\n<pre><code>leaves'' :: Tree a -&gt; [a]\nleaves'' Nil       = []\nleaves'' (Leaf a)    = [a]\nleaves'' (Br Nil r)   = leaves'' r\nleaves'' (Br (Leaf a) r) = a: leaves'' r\nleaves'' (Br (Br l' r') r) = leaves'' (Br l' (Br r' r))\n</code></pre>\n\n<p>The Datatype is</p>\n\n<pre><code>data Tree a = Leaf a              |\n              Br (Tree a) (Tree a)|\n              Nil\n                deriving Show\n</code></pre>\n\n<p>I don't really even know how to begin</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1513541058, "post_id": 47858883, "comment_id": 82682498, "body": "I was under the impression that even providing a type signature wouldn&#39;t help without <code>ScopedTypeVariables</code> enabled, would it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1513542856, "post_id": 47858883, "comment_id": 82683031, "body": "@FyodorSoikin Correct. IMO, that extension should be on by default. However, even without that, writing a signature would provide a better error message, at least."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1513543748, "post_id": 47858883, "comment_id": 82683308, "body": "But then, even with the extension enabled, don&#39;t you need an explicit <code>forall</code> as well? As far as I understand, a type signature doesn&#39;t automatically create a new type scope, does it?"}, {"owner": {"reputation": 538, "user_id": 4875652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea513cad32d33ca70db6369d6277875?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Losilla", "link": "https://stackoverflow.com/users/4875652/sergio-losilla"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1513545039, "post_id": 47858883, "comment_id": 82683673, "body": "I think I am missing something. Adding <code>ScopedTypeVariables</code> and the type signature          shuffle ::(RandomGen g) =&gt;  g -&gt; [a] -&gt; ([a], g)  still does not work.  Thanks for the explanation though!  EDIT: I read now @FyodorSoikin &#39;s reply, that includes the explicit forall that fixes the whole thing."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1513586874, "post_id": 47858883, "comment_id": 82694458, "body": "@FyodorSoikin Yes, you need that, otherwise the extension has no effect."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1513586953, "last_edit_date": 1513586953, "creation_date": 1513540515, "answer_id": 47858883, "question_id": 47858381, "link": "https://stackoverflow.com/questions/47858381/why-does-binding-to-an-unrestricted-type-variable-make-a-variable-rigid/47858883#47858883", "title": "Why does binding to an &quot;unrestricted&quot; type variable make a variable rigid?", "body": "<blockquote>\n  <p>Here is the question: [...]</p>\n  \n  <p>If the type variable is something as general as \"g\", how come the compiler is not able to match it with whatever other type?</p>\n</blockquote>\n\n<p>First of all, note that providing a type annotation to <code>shuffle</code> would have prevented this error message. Indeed, this is why most Haskellers strongly recommend adding type annotations for all top-level bindings (at least).</p>\n\n<p>Without an explicit type providing GHC with your intent, GHC has to guess -- using its inference engine to do so.</p>\n\n<pre><code>shuffle gen stuff = ...\n</code></pre>\n\n<p>What type is <code>gen</code>? GHC does not know that, so it generates a fresh type variable, <code>t1</code>, to represent its type. This variable is not rigid, meaning that later on GHC might choose to unify <code>t1</code> with some other type. E.g. If your code contained <code>gen == \"hi\"</code> then GHC would unify <code>t1 ~ String</code>.</p>\n\n<p>Later on we find</p>\n\n<pre><code>randomN gen (length stuff) :: ([Int], g)\n</code></pre>\n\n<p>which actually means</p>\n\n<pre><code>randomN gen (length stuff) :: forall g. ([Int], g)\n</code></pre>\n\n<p>meaning that such expression is of type <code>([Int], String)</code> and <code>([Int], Bool)</code> and <code>([Int], Whatever)</code>. The implicit universal quantification on <code>g</code> makes it stand for \"any arbitrary type\". Here <code>g</code> is rigid: GHC can't just pick only one type -- the signature demands <em>all</em> types!</p>\n\n<p>However, the expression is of type <code>([Int], t1)</code> since its second pair returns a new generator of the same type as <code>gen</code>. This would make <code>t1</code> unify with <code>g</code> -- but this makes no sense! Indeed, <code>t1</code> stands for a single type, and <code>g</code> stands for an \"arbitrary\" type: choosing <code>t1 ~ g</code> would implicitly fix <code>g</code> to a single type. Or in other words, we can't choose <code>t1</code> to be \"equal to all types <code>g</code>\" -- it would be nonsense.</p>\n\n<p>GHC prevents this wrong unification by comparing the scopes of <code>g</code> and <code>t1</code>: since the non-rigid <code>t1</code> has a larger scope, it can't be unified with the rigid <code>g</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1513541186, "post_id": 47858933, "comment_id": 82682532, "body": "Also, it might be worth noting that <code>ScopedTypeVariables</code> enables <code>ExplicitForAll</code> automatically."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1513548771, "last_edit_date": 1513548771, "creation_date": 1513540909, "answer_id": 47858933, "question_id": 47858381, "link": "https://stackoverflow.com/questions/47858381/why-does-binding-to-an-unrestricted-type-variable-make-a-variable-rigid/47858933#47858933", "title": "Why does binding to an &quot;unrestricted&quot; type variable make a variable rigid?", "body": "<p>Because it's not the same <code>g</code>. </p>\n\n<p>The inferred type of <code>shuffle</code> in your definition looks like this:</p>\n\n<pre><code> shuffle :: (RandomGen t1) =&gt; t1 -&gt; [a] -&gt; [a]\n shuffle gen stuff = ...\n      where \n          (res, gen') = ... :: (Int, g)\n</code></pre>\n\n<p>The type of generator in the <code>shuffle</code> type signature <code>t1</code> and the type of generator in the <code>gen'</code> signature <code>g</code> are different types from the compiler's point of view. There is nothing in your code to say that they are the same type. So the compiler complains.</p>\n\n<p>The first obvious solution would be to give them the same name explicitly:</p>\n\n<pre><code> shuffle :: (RandomGen g) =&gt; g -&gt; [a] -&gt; [a]\n shuffle gen stuff = ...\n      where \n          (res, gen') = ... :: (Int, g)\n</code></pre>\n\n<p>However, that will not work either. Due to some complicated historic reasons, even when declared like that, the two <code>g</code> types will still not be considered the same type.</p>\n\n<p>Yes, this is frustrating. So modern GHC offers a couple of handy extensions to fix it: <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/other-type-extensions.html\" rel=\"nofollow noreferrer\"><code>ExplicitForAll</code></a> and <a href=\"https://prime.haskell.org/wiki/ScopedTypeVariables\" rel=\"nofollow noreferrer\"><code>ScopedTypeVariables</code></a> (enabling the latter automatically enables the former). </p>\n\n<p>With these extensions enabled, you can amend your function like this:</p>\n\n<pre><code> shuffle :: forall g a. (RandomGen g) =&gt; g -&gt; [a] -&gt; [a]\n shuffle gen stuff = ...\n      where \n          (res, gen') = ... :: (Int, g)\n</code></pre>\n\n<p>The <code>forall</code> in the signature (enabled by the <code>ExplicitForAll</code> extension) is important: it opens a new <em>scope</em> for type variables and says that the variables <code>g</code> and <code>a</code> are two fresh types in that scope. The scope size is the whole function body, and with <code>ScopedTypeVariables</code> enabled, any mention of these type variables in that scope will mean a reference to these same types, rather than a fresh type.</p>\n"}], "owner": {"reputation": 538, "user_id": 4875652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea513cad32d33ca70db6369d6277875?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Losilla", "link": "https://stackoverflow.com/users/4875652/sergio-losilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 47858933, "answer_count": 2, "score": 2, "last_activity_date": 1513586953, "creation_date": 1513536727, "question_id": 47858381, "link": "https://stackoverflow.com/questions/47858381/why-does-binding-to-an-unrestricted-type-variable-make-a-variable-rigid", "title": "Why does binding to an &quot;unrestricted&quot; type variable make a variable rigid?", "body": "<p>I have this function to generate a list of random values and get the generator back (if anyone knows a better way, feel free to leave it in the comments):</p>\n\n<pre><code>-- randomN :: (Random a, RandomGen g) =&gt; g -&gt; Int -&gt; ([a], g)\nrandomN gen n = (map fst rs, snd (last rs)) where\n    rs = take n (pool gen)\n    pool g = (r, g'):(pool g') where (r, g') = random g\n</code></pre>\n\n<p>I want to use it to shuffle lists. I created this function:</p>\n\n<pre><code>shuffle gen stuff = (map snd $ sortOn fst $ zip rs stuff, gen') where\n    rs :: [Int]\n    (rs, gen') = randomN gen (length stuff)\n</code></pre>\n\n<p>I understand that I need to explicitly instantiate rs, GHC will not magically figure how I want to sort the list.</p>\n\n<p>Here is the question: my original attempt looked like this: </p>\n\n<pre><code>shuffle gen stuff = (map snd $ sortOn fst $ zip rs stuff, gen') where\n    (rs, gen') = randomN gen (length stuff) :: ([Int], g)\n</code></pre>\n\n<p>But that failed with the following error:</p>\n\n<pre><code>shuffle_minimal.hs:11:18: error:\n    \u2022 Couldn't match type \u2018t1\u2019 with \u2018g\u2019\n        because type variable \u2018g\u2019 would escape its scope\n      This (rigid, skolem) type variable is bound by\n        an expression type signature:\n          ([Int], g)\n        at shuffle_minimal.hs:11:18-57\n      Expected type: ([Int], g)\n        Actual type: ([Int], t1)\n    \u2022 In the expression: randomN gen (length stuff) :: ([Int], g)\n      In a pattern binding:\n        (rs, gen') = randomN gen (length stuff) :: ([Int], g)\n      In an equation for \u2018shuffle\u2019:\n          shuffle gen stuff\n            = (map snd $ sortOn fst $ zip rs stuff, gen')\n            where\n                (rs, gen') = randomN gen (length stuff) :: ([Int], g)\n    \u2022 Relevant bindings include\n        gen :: t1 (bound at shuffle_minimal.hs:10:9)\n        shuffle :: t1 -&gt; [b] -&gt; ([b], t) (bound at shuffle_minimal.hs:10:1)\n</code></pre>\n\n<p>If the type variable is something as general as \"g\", how come the compiler is not able to match it with whatever other type?</p>\n\n<p>What does \"because type variable \u2018g\u2019 would escape its scope\"? I have tried reading <a href=\"https://stackoverflow.com/questions/27247620/type-variable-would-escape-its-scope\">some other post</a> but I do not really understand it :-(</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "data-structures", "tree"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1513533242, "post_id": 47857512, "comment_id": 82680135, "body": "Note that from a practical standpoint, you don&#39;t have to define <code>maxElem</code> yourself; using the <code>DeriveFoldable</code> extension, you can simply write <code>data Tree a = ... deriving (Show, Foldable)</code>, and then something like <code>maximum (Node 5 [])</code> would correctly return 5."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1513531183, "creation_date": 1513531183, "answer_id": 47857594, "question_id": 47857512, "link": "https://stackoverflow.com/questions/47857512/maximum-element-on-a-tree-in-haskell/47857594#47857594", "title": "Maximum element on a Tree in haskell?", "body": "<p>There are three potential problems here:</p>\n\n<ol>\n<li>if a tree contains one or many <code>Empty</code>s, it will error. So a <code>Node 1 [Node 4 [], Empty, Node 2 [Node 5 []]]</code>, will raise an error since there is an <code>Empty</code> in the tree, and we will eventually call <code>maxElem</code> on that <code>Empty</code> whereas we can ignore the <code>Empty</code> and thus return <code>5</code>;</li>\n<li>you also do not take <code>a</code> into account when you calculate the maximum of a <code>Node</code> with children, whereas the <code>a</code> can be the maximum as well;</li>\n<li>the result is an <code>a</code> as well, not per se an <code>Int</code>.</li>\n</ol>\n\n<p>There are in fact two cases here:\n 1. the <code>Empty</code> tree, that raises an error; and\n 2. the maximum of a <code>Node x cs</code> is the maximum of <code>x</code> and the <code>maxElem</code> of the children, <em>ignoring the <code>Empty</code>s</em>.</p>\n\n<p>So we can write it as:</p>\n\n<pre><code>maxElem:: Ord a =&gt; Tree a -&gt; <b>a</b>\nmaxElem Empty = error \"maxElem on Empty\"\nmaxElem <b>(Node x cs)</b> = maximum <b>(x :</b> map maxElem <b>[c | c@(Node _ _) &lt;- cs]</b>)</code></pre>\n\n<p>Or we can write the <code>map maxElem</code> in the list comprehension:</p>\n\n<pre><code>maxElem:: Ord a =&gt; Tree a -&gt; a\nmaxElem Empty = error \"maxElem on Empty\"\nmaxElem (Node x cs) = maximum (x : [<b>maxElem c</b> | c@(Node _ _) &lt;- cs])</code></pre>\n\n<p>So the base case is the same, but the case of <code>Node x cs</code> calculates the <code>maximum</code> of a list with <code>x</code> as head, and <code>map MaxElem</code> as tail, but not on <em>all</em> children, but only the children that match the <code>Node _ _</code> pattern. Since this list contains at least one element <code>x</code>, <code>maximum</code> can <em>not</em> error on the empty list, and we calculate only <code>maxElem</code> on <code>Node</code> instances.</p>\n"}], "owner": {"reputation": 45, "user_id": 8714704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb1fe871ad1f544f13cb5402a782609?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio M. Burgue&#241;o", "link": "https://stackoverflow.com/users/8714704/antonio-m-burgue%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 47857594, "answer_count": 1, "score": 3, "last_activity_date": 1513531183, "creation_date": 1513530662, "last_edit_date": 1513530691, "question_id": 47857512, "link": "https://stackoverflow.com/questions/47857512/maximum-element-on-a-tree-in-haskell", "title": "Maximum element on a Tree in haskell?", "body": "<p>Given a Tree : </p>\n\n<pre><code>data Tree a = Empty | Node a [Tree a] deriving Show\n</code></pre>\n\n<p>I am trying to get the maximum element so I've tried:</p>\n\n<pre><code>maxElem:: (Ord a) =&gt; Tree a -&gt; Int\nmaxElem Empty = error \"maxElem on empty Tree\"\nmaxElem (Node a []) = a\nmaxElem (Node a x ) = maximum [ maxElem h | h&lt;-x]\n</code></pre>\n\n<p>But I get an error and I don't find it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1513529994, "post_id": 47856856, "comment_id": 82679076, "body": "I can&#39;t duplicate your problem.  If I turn your code fragments into a compilable example, then compiling with GHC 8.0.2 and <code>-Wincomplete-uni-patterns</code> generates a non-exhaustive pattern match warning, as expected.  Can you provide a <i>complete</i> compilable example that fails to generate the warning?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513545312, "post_id": 47856856, "comment_id": 82683753, "body": "<a href=\"https://repl.it/repls/WateryShamelessCottonmouth\" rel=\"nofollow noreferrer\">Here</a> is a minimal example which shows that GHC does indeed issue the appropriate warning. However, <code>-Wall</code> is not enough here - the user guide explicitly lists <code>-Wincomplete-uni-patterns</code> as one of the warnings <i>not</i> enabled by <code>-Wall</code> (<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using-warnings.html\" rel=\"nofollow noreferrer\">ref</a>)."}, {"owner": {"reputation": 113, "user_id": 6120011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0df99be1207446c9f4126b0f9d2ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Foong", "link": "https://stackoverflow.com/users/6120011/darren-foong"}, "edited": false, "score": 0, "creation_date": 1513598242, "post_id": 47856856, "comment_id": 82700901, "body": "I realised that it&#39;s because <code>ghc</code> wasn&#39;t even compiling: the source file had already been compiled previously and remained unchanged. Thanks for all your help!"}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513614965, "post_id": 47868000, "comment_id": 82710708, "body": "You can also pass the <code>-fforce-recomp</code> to GHC to make it recompile everything."}], "tags": [], "owner": {"reputation": 113, "user_id": 6120011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0df99be1207446c9f4126b0f9d2ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Foong", "link": "https://stackoverflow.com/users/6120011/darren-foong"}, "is_accepted": false, "score": 0, "last_activity_date": 1513598173, "creation_date": 1513598173, "answer_id": 47868000, "question_id": 47856856, "link": "https://stackoverflow.com/questions/47856856/ghc-warning-for-irrefutable-pattern-in-let-binding/47868000#47868000", "title": "GHC warning for irrefutable pattern in let binding", "body": "<p>My mistake; <code>ghc</code> runs in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using.html#make-mode\" rel=\"nofollow noreferrer\">make mode</a> by default, and while trying the different switches, I had run:</p>\n\n<pre><code>$ ghc -Wall file.hs\n$ ghc -Wall -Wincomplete-uni-patterns file.hs\n</code></pre>\n\n<p>consecutively. The second invocation of <code>ghc</code> would not compile <code>file.hs</code> because it had already been compiled and unmodified since the first invocation.</p>\n\n<p>Running</p>\n\n<pre><code>$ touch file.hs\n$ ghc -Wall -Wincomplete-uni-patterns file.hs\n</code></pre>\n\n<p>to update the timestamp of the source file followed by compilation produces the <code>Pattern match(es) are non-exhaustive</code> warning as I had wanted.</p>\n"}], "owner": {"reputation": 113, "user_id": 6120011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0df99be1207446c9f4126b0f9d2ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Foong", "link": "https://stackoverflow.com/users/6120011/darren-foong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513598173, "creation_date": 1513526263, "question_id": 47856856, "link": "https://stackoverflow.com/questions/47856856/ghc-warning-for-irrefutable-pattern-in-let-binding", "title": "GHC warning for irrefutable pattern in let binding", "body": "<p>I'm writing a chess program in Haskell, and while testing at runtime, I encountered an <code>Irrefutable pattern failed...</code> error.</p>\n\n<p>I have the following datatypes:</p>\n\n<pre><code>data Color = ...\ndata Piece = ...\ndata CPiece = CP Color Piece | Null\n</code></pre>\n\n<p>And the problem occurs at:</p>\n\n<pre><code>let startPiece = getPiece board start in\n  let CP startColor _ = startPiece in\n</code></pre>\n\n<p><code>getPiece</code> returns <code>CPiece</code>, and I know I didn't account for the <code>Null</code> constructor and should use a <code>case getPiece board start of ...</code> statement instead.</p>\n\n<p>However, why isn't GHC producing any warning? I have turned on <code>-Wall</code> and <code>-Wincomplete-uni-patterns</code>, and I'm using GHC 8.0.2 on Debian.</p>\n"}, {"tags": ["haskell", "yesod", "yesod-test"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1513517744, "post_id": 47855057, "comment_id": 82675359, "body": "How is your <code>PostR</code> defined?"}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1513564870, "post_id": 47855057, "comment_id": 82687827, "body": "@FyodorSoikin Edited to show the info."}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 1, "last_activity_date": 1513718912, "creation_date": 1513718912, "answer_id": 47895460, "question_id": 47855057, "link": "https://stackoverflow.com/questions/47855057/couldnt-match-expected-type-post-with-actual-type-route-app/47895460#47895460", "title": "Couldn&#39;t match expected type \u2018Post\u2019 with actual type \u2018Route App\u2019", "body": "<p>The problem ended up being that in the posts table there was a column body so Yesod created postBody for this which conflicted with the postBody from Yesod.Test.</p>\n\n<p>The solution is using a qualified import on yesod test</p>\n\n<pre><code>import qualified Yesod.Test as T\n</code></pre>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47895460, "answer_count": 1, "score": 0, "last_activity_date": 1513718912, "creation_date": 1513513329, "last_edit_date": 1513564854, "question_id": 47855057, "link": "https://stackoverflow.com/questions/47855057/couldnt-match-expected-type-post-with-actual-type-route-app", "title": "Couldn&#39;t match expected type \u2018Post\u2019 with actual type \u2018Route App\u2019", "body": "<p>I'm trying to use the function <code>postBody</code></p>\n\n<pre><code>postBody :: (Yesod site, RedirectUrl site url) =&gt; url -&gt; ByteString -&gt; YesodExample site () \n</code></pre>\n\n<p>from the <a href=\"https://hackage.haskell.org/package/yesod-test-1.4.3.1/docs/Yesod-Test.html\" rel=\"nofollow noreferrer\">Yesod.Test</a> package. The documentation says it can be used like this</p>\n\n<pre><code>import Data.Aeson\npostBody HomeR (encode $ object [\"age\" .= (1 :: Integer)])\n</code></pre>\n\n<p>However when I tried to use it in my app</p>\n\n<pre><code>    describe \"Posts\" $ do\n        it \"posts post and returns post\" $ do\n            postBody PostR (encode $ object [\n                \"body\" .= (\"test post\" :: Text),\n                \"title\" .= (\"test post\" :: Text),\n                \"coverImage\" .= (\"test post\" :: Text),\n                \"author\" .= (0 :: Int)\n                ])\n            statusIs 200\n</code></pre>\n\n<p>I got the error</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Post\u2019 with actual type \u2018Route App\u2019\n\u2022 In the first argument of \u2018postBody\u2019, namely \u2018PostR\u2019\n  In a stmt of a 'do' block:\n    postBody\n      PostR\n      (encode\n       $ object\n           [\"body\" .= (\"test post\" :: Text), \"title\" .= (\"test post\" :: Text),\n\n            \"coverImage\" .= (\"test post\" :: Text), \"author\" .= (0 :: Int)])\n  In the second argument of \u2018($)\u2019, namely\n    \u2018do { postBody\n            PostR\n            (encode\n             $ object\n                 [\"body\" .= (\"test post\" :: Text), \"title\" .= (\"test post\" :: Text),\n                  ....]);\n          statusIs 200 }\u2019\n</code></pre>\n\n<p>My usage seems to be the same as the example so I can't see why it would fail.</p>\n\n<p>PostR is in the routes file here </p>\n\n<p><code>/posts PostR POST</code></p>\n\n<p>and the handler for it</p>\n\n<pre><code>postPostR :: Handler Value\npostPostR = do\n    post &lt;- requireJsonBody :: Handler Post\n    maybeUserID &lt;- maybeAuthId\n    case maybeUserID of\n        Just userID -&gt; do\n            let post' = post {postAuthor = userID}\n            inserted &lt;- runDB $ insertEntity post'\n            returnJson inserted\n        Nothing -&gt; sendResponseStatus status403 (\"Unauthorized\" :: Text)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1513506664, "post_id": 47854167, "comment_id": 82672476, "body": "<code>Integral</code> is a <i>type class</i>, whereas <code>Bool</code> is a <i>specific</i> type."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1513594377, "post_id": 47854167, "comment_id": 82698719, "body": "C-like languages do not usually have (Haskell-style) constraints."}], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "edited": false, "score": 0, "creation_date": 1513507323, "post_id": 47854256, "comment_id": 82672637, "body": "so in other words there is no real use case for someFunction :: (Integral a, Bool b), if I just want the 2nd argument to be a Bool type??  do I understand it correctly?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "edited": false, "score": 1, "creation_date": 1513507573, "post_id": 47854256, "comment_id": 82672680, "body": "@ChenSturmweizen No, it&#39;s just nonsensical. If you want the 2nd argument to be a <code>Bool</code>, just write <code>Bool</code>."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 7, "creation_date": 1513508309, "post_id": 47854256, "comment_id": 82672843, "body": "Saying there&#39;s no real use case for <code>someFunction :: (Integral a, Bool b)</code> is like saying there&#39;s no real use case for a ladder that is chocolate meters long. It&#39;s a mismatch in domains and doesn&#39;t make sense. The problem is that <code>(Integral a, Bool b)</code> looks like a function signature in C-like languages, but it really has very little to do with that."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 4, "last_activity_date": 1513507082, "creation_date": 1513507082, "answer_id": 47854256, "question_id": 47854167, "link": "https://stackoverflow.com/questions/47854167/the-difference-in-haskell-function-argument-type-declaration/47854256#47854256", "title": "The difference in Haskell function argument type declaration", "body": "<p><code>Integral</code> is not a type: it is a typeclass. It describes a constraint on a type.</p>\n\n<p>So, the signature:</p>\n\n<pre><code>someFunction :: (Integral a) =&gt; a -&gt; Bool -&gt; a \n</code></pre>\n\n<p>means that <em>\"As long as <code>a</code> is an instance of <code>Integral</code>, this function can work on it\"</em>.</p>\n\n<p>Your second example of  <code>(Integral a, Bool b) =&gt; a -&gt; b -&gt; a</code> does not make sense, because <code>Bool</code> is a type, not a typeclass.</p>\n\n<p>What does it mean to be an instance of <code>Integral</code>? Well, it means that somewhere, someone has written, for some type, for instance <code>Int</code>:</p>\n\n<pre><code>instance Integral Int where\n    -- (declarations here)\n</code></pre>\n\n<hr>\n\n<p>Here's an example of your own typeclass: <code>Sizeable</code>:</p>\n\n<pre><code>class Sizeable s where\n    size :: s -&gt; Int\n</code></pre>\n\n<p>We can see this as types which have an associated size, which is defined by the <code>size</code> function. So, we can add some instances:</p>\n\n<pre><code>instance Sizeable [a] where\n    size = length\n\ninstance Sizeable (a,b) where\n    size _ = 2\n\ninstance Sizeable (a,b,c) where\n    size _ = 3\n</code></pre>\n\n<p>So, we could write the function:</p>\n\n<pre><code>sizePlusOne s = (size s) + 1\n</code></pre>\n\n<p>And this would have the type:</p>\n\n<pre><code>sizePlusOne :: (Sizeable s) =&gt; s -&gt; Int\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "edited": false, "score": 0, "creation_date": 1513510703, "post_id": 47854390, "comment_id": 82673397, "body": "Thanks for the answer.  My next question would be: what are the thoughts behind having argument constraints to be in different places in the declaration?  (vs C-like languages the constraints, abstract or concrete, are mixed in the declaration)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "edited": false, "score": 0, "creation_date": 1513511617, "post_id": 47854390, "comment_id": 82673644, "body": "@ChenSturmweizen: type classes are more flexible. Some extensions also for instance allow multiple parameters, etc. For instance we can define a <code>class Convertible a b where convert :: a -&gt; b</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "edited": false, "score": 0, "creation_date": 1513531917, "post_id": 47854390, "comment_id": 82679715, "body": "@ChenSturmweizen You could draw a very vague comparison with Java generics <code>&lt;A extends Integral&gt; A foo(A x, bool y)</code>. The correspondence is not exact, but at least should make it clear that we talking about type variables, with some constraint on them."}, {"owner": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1513541633, "post_id": 47854390, "comment_id": 82682653, "body": "@chi actually this is exactly my question.  A more accurate comparison would be doing: foo(A x) &lt;- bool y (this doesnt make sense syntactically in java  though).  Is any thought behind doing so?"}, {"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "reply_to_user": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "edited": false, "score": 0, "creation_date": 1513609595, "post_id": 47854390, "comment_id": 82707619, "body": "@ChenSturmweizen I don&#39;t understand your example, what is it supposed to mean? (it isn&#39;t valid Java or Haskell).  Why is it more accurate than chi&#39;s analogy?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1513508328, "creation_date": 1513508328, "answer_id": 47854390, "question_id": 47854167, "link": "https://stackoverflow.com/questions/47854167/the-difference-in-haskell-function-argument-type-declaration/47854390#47854390", "title": "The difference in Haskell function argument type declaration", "body": "<p>The items on the left of the <code>=&gt;</code> are <strong>type constraints</strong>. Haskell uses <strong>type classes</strong> for it. A type class is best seen as an <em>interface</em> in programming languages like Java, etc.</p>\n\n<p>For instance in Haskell there is a class <code>Eq</code>:</p>\n\n<blockquote>\n<pre><code>class Eq a where\n  (==) :: a -&gt; a -&gt; Bool\n  (/=) :: a -&gt; a -&gt; Bool\n</code></pre>\n</blockquote>\n\n<p>Now we can make a type <code>Int</code> a \"<em>member</em>\" of the <code>Num</code> typeclass, by declaring it an <code>instance</code> of <code>Num</code>, and **implement the functions that are part of the <code>class</code>. Say for instance we want to make the (positive) <em>Peano numbers</em> an instance of <code>Eq</code>, we then first define the Peano numbers as:</p>\n\n<pre><code>data Peano = Zero | Succ Peano\n</code></pre>\n\n<p>and now we can make it an instance of <code>Eq</code>:</p>\n\n<pre><code>instance Eq Peano where\n    Zero == Zero = True\n    s(x) == s(y) = x == y\n    _ == _ = False\n\n    Zero /= Zero = False\n    s(x) /= s(y) = x /= y\n    _ /= _ = True\n</code></pre>\n\n<p>So now we can compare two <code>Peano</code> instances with <code>==</code>, and <code>Peano</code> is registered as an instance of <code>Eq</code>. So that means that if we write something like:</p>\n\n<pre><code>someFunction :: Eq a =&gt; a -&gt; a -&gt; a -&gt; Bool\nsomeFunction x y z = x == y &amp;&amp; y == z\n</code></pre>\n\n<p>then <code>a</code> can be <code>Peano</code>, since we require that <code>Eq Peano</code> (on the left side) holds.</p>\n\n<p>Type classes are thus used to allow you to use <em>abstract</em> functions (like for instance <code>==</code> and <code>/=</code>), without knowing how these are defined for the concrete type.</p>\n\n<p><code>Bool</code> on the other hand is <em>not</em> a typeclass, it is a concrete type. So you can not write <code>Bool b</code>. It also makes no sense syntactically, since a type class <em>requires a parameter</em> (i.e. <code>Eq <b>Peano</b></code>), whereas <code>Bool</code> is a type with no type parameter).</p>\n"}], "owner": {"reputation": 599, "user_id": 2083396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QuIfd.jpg?s=128&g=1", "display_name": "Chen Sturmweizen", "link": "https://stackoverflow.com/users/2083396/chen-sturmweizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 47854256, "answer_count": 2, "score": 4, "last_activity_date": 1513510813, "creation_date": 1513506400, "last_edit_date": 1513510813, "question_id": 47854167, "link": "https://stackoverflow.com/questions/47854167/the-difference-in-haskell-function-argument-type-declaration", "title": "The difference in Haskell function argument type declaration", "body": "<p>I am new to Haskell.\nI am just confused by the difference between the argument type declarations here:</p>\n\n<pre><code>someFunction :: (Integral a) =&gt; a -&gt; Bool -&gt; a \n</code></pre>\n\n<p>This will compile.</p>\n\n<pre><code>someFunction :: (Integral a, Bool b) =&gt; a -&gt; b -&gt; a \n</code></pre>\n\n<p>Yet given this, the compiler will complain:</p>\n\n<blockquote>\n<pre><code>\u2022 Expecting one fewer arguments to \u2018Bool\u2019\n  Expected kind \u2018* -&gt; Constraint\u2019, but \u2018Bool\u2019 has kind \u2018*\u2019\n\u2022 In the type signature:\n    someFunction :: (Integral a, Bool b) =&gt; a -&gt; b -&gt; a\n</code></pre>\n</blockquote>\n\n<p>What is the difference between the two declarations?  I tried to search with Google but it seems there is no direct answer to this one.</p>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p>Thanks for the quick answers guys. And they lead me to the next question: what are the thoughts behind having argument constraints to be in different places in the declaration? (vs C-like languages where the constraints, abstract or concrete, are mixed together in the declaration) </p>\n"}, {"tags": ["haskell", "records", "ambiguous-call"], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1513521303, "post_id": 47854987, "comment_id": 82676376, "body": "With <code>-XNamedFieldPuns</code>, we can also write <code>combine a B{ name } = a{ name = name }</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1513522028, "post_id": 47854987, "comment_id": 82676550, "body": "@danidiaz <i>can</i> we do this? Well, if you say so. IMO we <i>shouldn&#39;t</i>, at any rate; <code>{ name = name }</code> looks utterly confusing. All these extensions are unidiomatic hacks within the old record system that just doesn&#39;t work well this way. When <code>OverloadedRecordFields</code> will properly work via the <code>HasField</code> class and magic-hash syntax, that will be a different pair of shoes, but until then I&#39;d stick to what the lens library has to offer."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1513512787, "creation_date": 1513512787, "answer_id": 47854987, "question_id": 47854019, "link": "https://stackoverflow.com/questions/47854019/disambiguate-record-update-with-duplicaterecordfields/47854987#47854987", "title": "Disambiguate record update with DuplicateRecordFields", "body": "<p>You could match the name from a pattern:</p>\n\n<pre><code>data A = A { name :: String }\ndata B = B { name :: String }\n\ncombine :: A -&gt; B -&gt; A\ncombine a B{name = nb} = a { name = nb }\n</code></pre>\n\n<p>I'm not a fan of <code>DuplicateRecordFields</code> though. Why not instead go <a href=\"http://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-TH.html#v:makeFields\" rel=\"nofollow noreferrer\">the lens route</a>?</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, FlexibleInstances, FunctionalDependencies #-}\n\nimport Control.Lens\nimport Control.Lens.TH\n\ndata A = A { _aName :: String }\nmakeFields ''A\ndata B = B { _bName :: String }\nmakeFields ''B\n\ncombine :: A -&gt; B -&gt; A\ncombine a b = a &amp; name .~ b^.name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1515942802, "last_edit_date": 1515942802, "creation_date": 1513563168, "answer_id": 47861306, "question_id": 47854019, "link": "https://stackoverflow.com/questions/47854019/disambiguate-record-update-with-duplicaterecordfields/47861306#47861306", "title": "Disambiguate record update with DuplicateRecordFields", "body": "<p>I answered in one of the previous questions about <code>-XDuplicateRecordFields</code> that currently GHC doesn't infer type of record field from its argument:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/44714711/silly-duplicated-record-fields-error/44716184#44716184\">Silly duplicated record fields error</a></li>\n</ul>\n\n<p>What you can do now is to specify type of <code>name</code> extractor explicitly, like this:</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n\ndata A = A { name :: String }\ndata B = B { name :: String }\n\ncombine :: A -&gt; B -&gt; A\ncombine a b = a { name = (name :: B -&gt; String) b }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1210, "user_id": 437583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/227b1832ae8d065bfdce3b5c92d0792b?s=128&d=identicon&r=PG", "display_name": "Linus Arver", "link": "https://stackoverflow.com/users/437583/linus-arver"}, "is_accepted": false, "score": 2, "last_activity_date": 1557556149, "creation_date": 1557556149, "answer_id": 56087823, "question_id": 47854019, "link": "https://stackoverflow.com/questions/47854019/disambiguate-record-update-with-duplicaterecordfields/56087823#56087823", "title": "Disambiguate record update with DuplicateRecordFields", "body": "<p>Alternatively, you can mechanically use <code>getField</code> from <code>GHC.Records</code> to disambiguate, like this:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}                                                                                                                                                         \n{-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE TypeApplications #-}\n\nmodule DRF where\n\nimport GHC.Records (getField)\n\ndata A = A { name :: String } deriving Show\ndata B = B { name :: String }\n\ncombine :: A -&gt; B -&gt; A\ncombine a b = a { name = getField @\"name\" b }\n\n{- in ghci\n\nPrelude DRF&gt; a = A \"Alice\"  \nPrelude DRF&gt; b = B \"Bob\"    \nPrelude DRF&gt; DRF.combine a b\nA {name = \"Bob\"}\n\n-}\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://www.reddit.com/r/haskell/comments/8693a3/usefulness_of_duplicaterecordfields/dw3fe8u/\" rel=\"nofollow noreferrer\">https://www.reddit.com/r/haskell/comments/8693a3/usefulness_of_duplicaterecordfields/dw3fe8u/</a></li>\n<li><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-Records.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-Records.html</a></li>\n</ul>\n"}], "owner": {"reputation": 2692, "user_id": 625791, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/996a20b9eae1def21e8db462e9bf1cf7?s=128&d=identicon&r=PG", "display_name": "theduke", "link": "https://stackoverflow.com/users/625791/theduke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1557556149, "creation_date": 1513504979, "last_edit_date": 1513563091, "question_id": 47854019, "link": "https://stackoverflow.com/questions/47854019/disambiguate-record-update-with-duplicaterecordfields", "title": "Disambiguate record update with DuplicateRecordFields", "body": "<p>I'm using the DuplicateRecordFields (+OverloadedLabels) extension, and I've run into a situation where I can't figure out how to disambiguate in a record update.</p>\n\n<p>Here is a simplified example:</p>\n\n<pre><code>data A = A { name :: String }\ndata B = B { name :: String }\n\ncombine :: A -&gt; B -&gt; A\ncombine a b = a { name = name b }\n</code></pre>\n\n<p>Is there any way to make this work?</p>\n"}, {"tags": ["haskell", "path", "executable", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513494954, "post_id": 47852970, "comment_id": 82670294, "body": "Thank you very much! Pretty obvious in hindsight, isn&#39;t it?"}], "tags": [], "owner": {"reputation": 738, "user_id": 8075159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8709365a90d8a840b976b0f132f912e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hogeyama", "link": "https://stackoverflow.com/users/8075159/hogeyama"}, "is_accepted": true, "score": 7, "last_activity_date": 1513494587, "creation_date": 1513494587, "answer_id": 47852970, "question_id": 47852911, "link": "https://stackoverflow.com/questions/47852911/haskell-stack-locate-the-executable/47852970#47852970", "title": "Haskell, stack: locate the executable", "body": "<p><code>stack exec -- whereis hasktags</code> will do.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4074877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4674b26d71a05f7d571ddf613bd482b5?s=128&d=identicon&r=PG&f=1", "display_name": "bens", "link": "https://stackoverflow.com/users/4074877/bens"}, "is_accepted": false, "score": 0, "last_activity_date": 1517540868, "last_edit_date": 1517540868, "creation_date": 1517499993, "answer_id": 48566655, "question_id": 47852911, "link": "https://stackoverflow.com/questions/47852911/haskell-stack-locate-the-executable/48566655#48566655", "title": "Haskell, stack: locate the executable", "body": "<p><code>stack exec -- whereis yourprogramname</code> works for me on a Linux box, but I have to use <code>stack exec -- which yourprogramname</code> on Mac OS X.</p>\n\n<p>(<code>which</code> also works on Linux, of course.)</p>\n\n<p>Note that neither of these are useful for automating deployments when the executable name is the same as one on the build machine -- not likely, but not impossible.</p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 1, "accepted_answer_id": 47852970, "answer_count": 2, "score": 3, "last_activity_date": 1517540868, "creation_date": 1513493921, "question_id": 47852911, "link": "https://stackoverflow.com/questions/47852911/haskell-stack-locate-the-executable", "title": "Haskell, stack: locate the executable", "body": "<p>I'm looking for something like</p>\n\n<pre><code>$ stack whereis hasktags\n</code></pre>\n\n<p>where <code>whereis</code> acts more or less like UNIX <code>whereis</code> command. <code>hasktags</code> is to be run like this:</p>\n\n<pre><code>$ stack exec -- hasktags\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "edited": false, "score": 0, "creation_date": 1513483915, "post_id": 47852123, "comment_id": 82668617, "body": "Thanks! That, of course, makes sense. I should have figured this out. Will accept the answer when it allows me to do so."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 5, "last_activity_date": 1513483919, "last_edit_date": 1513483919, "creation_date": 1513483736, "answer_id": 47852123, "question_id": 47852098, "link": "https://stackoverflow.com/questions/47852098/error-specified-for-negative-numbers-displayed-when-function-applied-to-a-fracti/47852123#47852123", "title": "Error specified for negative numbers displayed when function applied to a Fractional. Why?", "body": "<p>If you give it 10.5 as argument, then the third case is valid, and the function calls itself recursively with <code>n = 10.5 - 1 = 9.5</code>. </p>\n\n<p>That input also triggers the third case, making a recursive call with <code>n = 8.5</code>.</p>\n\n<p>And so on: 7.5, then 6.5, then 5.5, 4.5, 3.5, 2.5, 1.5, 0.5</p>\n\n<p>And then, on the next iteration, <code>n = -0.5</code>, which triggers the first case and produces the error. Everything exactly as coded.</p>\n\n<p>If you want your function to work for fractional numbers, you have to (a) define what is a factorial of <code>n</code> for <code>0 &lt; n &lt; 1</code>, and then (b) encode that case.</p>\n\n<p>For example, if I were to define factorial of a number between zero and one to be equal to one, then the function would look like this:</p>\n\n<pre><code>fact n | n &lt; 0 = error \"fact only valid for non-negative integers\"\n       | n &gt;= 0 &amp;&amp; n &lt;= 1 = 1\n       | n &gt; 0 = n * fact(n-1)\n</code></pre>\n\n<p>Also, a side note: I think the above code should give you a warning that the function is partial. This is because the compiler cannot prove that one of the cases should always hold (and in all fairness, depending on the argument type and the definition of <code>Num</code> and <code>Ord</code> for it, it might not hold). To avoid this, one should use an <code>otherwise</code> clause:</p>\n\n<pre><code>fact n | n &lt; 0 = error \"fact only valid for non-negative integers\"\n       | n &gt;= 0 &amp;&amp; n &lt;= 1 = 1\n       | otherwise = n * fact(n-1)\n</code></pre>\n"}], "owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 47852123, "answer_count": 1, "score": 0, "last_activity_date": 1513491967, "creation_date": 1513483335, "last_edit_date": 1513491967, "question_id": 47852098, "link": "https://stackoverflow.com/questions/47852098/error-specified-for-negative-numbers-displayed-when-function-applied-to-a-fracti", "title": "Error specified for negative numbers displayed when function applied to a Fractional. Why?", "body": "<p>I am trying to learn Haskell, and I defined the following simple recursive function to calculate the factorial.</p>\n\n<pre><code>fact n | n &lt; 0 = error \"fact only valid for non-negative integers\"\n       | n == 0 = 1\n       | n &gt; 0 = n * fact(n-1)\n</code></pre>\n\n<p>It works fine for a positive integer, and as expected when invoked with a negative integer, it throws the error that I have specified. </p>\n\n<p><strong>What is the problem?</strong>: It gives me the same error (\"fact only valid for non-negative integers\") when I try to apply it to a Fractional, such as <code>fact 10.5</code>. Why does it give me that same error that I have clearly specified should apply for only the case of n &lt; 0.</p>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 13, "last_activity_date": 1513476591, "creation_date": 1513476591, "answer_id": 47851645, "question_id": 47851644, "link": "https://stackoverflow.com/questions/47851644/executable-named-yesod-not-found-on-path/47851645#47851645", "title": "Executable named yesod not found on path", "body": "<p>Turns out <code>yeosd-bin</code> needs to be compiled separately.</p>\n\n<p>Running <code>$ stack build yesod-bin</code> solves the issue.</p>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 47851645, "answer_count": 1, "score": 5, "last_activity_date": 1513476591, "creation_date": 1513476591, "question_id": 47851644, "link": "https://stackoverflow.com/questions/47851644/executable-named-yesod-not-found-on-path", "title": "Executable named yesod not found on path", "body": "<p>Getting this issue while trying to run my Yesod application. <code>stack build</code> has already been run and gives no output anymore.</p>\n\n<pre><code>$ stack exec -- yesod devel\nExecutable named yesod not found on path: [\"path/to/app\"]\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1513455581, "post_id": 47849603, "comment_id": 82663647, "body": "The pattern <code>x:_:xs</code> matches a list with at least two elements; the first element is named <code>x</code>, the second element is discarded, and the rest of the list (all but first two elements) is named <code>xs</code>. Does this clarify what this pattern means?"}, {"owner": {"reputation": 21, "user_id": 9108087, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c8YQL1L-hM4/AAAAAAAAAAI/AAAAAAAAB6c/cQnhsZyjx9o/photo.jpg?sz=128", "display_name": "ProShifu", "link": "https://stackoverflow.com/users/9108087/proshifu"}, "edited": false, "score": 2, "creation_date": 1513455946, "post_id": 47849603, "comment_id": 82663740, "body": "Yeah, that explains it. Feel stupid now since I missed that the second one is discarded... Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9108087, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c8YQL1L-hM4/AAAAAAAAAAI/AAAAAAAAB6c/cQnhsZyjx9o/photo.jpg?sz=128", "display_name": "ProShifu", "link": "https://stackoverflow.com/users/9108087/proshifu"}, "edited": false, "score": 1, "creation_date": 1513456601, "post_id": 47849680, "comment_id": 82663940, "body": "Damn this was a very good a thorough answer! I had not understood that we would go though odd indices before asking but now it makes perfect sense why I get 5! Much obliged for taking the time to answer this!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513458313, "post_id": 47849680, "comment_id": 82664380, "body": "... and then you say that <code>q3 . map abs</code> is <a href=\"https://en.wikipedia.org/wiki/Bird%E2%80%93Meertens_formalism#The_homomorphism_lemma_and_its_applications_to_parallel_implementations\" rel=\"nofollow noreferrer\">a list homomorphism</a> over <a href=\"https://hackage.haskell.org/package/split-0.2.3.2/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\"><code>chunksOf 2</code></a>&#39;ed lists, and so is equivalent to <code>maximum . (0:) . map (abs . head) . chunksOf 2</code> or something."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513458408, "post_id": 47849680, "comment_id": 82664410, "body": "@WillNess: sure, but the last section is more meant as a comment on the fact that <code>q</code> is simply not a good function, not meant to go in much design of a better function, only a brief overview of two options in Layman&#39;s terms :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513508893, "post_id": 47849680, "comment_id": 82672986, "body": "BTW the <code>0</code> thing means that <code>q1</code> expects (nay demands) its arguments in a list to all be non-negative, that this is an essential part of its interface (<i>not</i> captured by its type). Goes well with the <code>map abs</code>, too."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513509980, "post_id": 47849680, "comment_id": 82673209, "body": "@WillNess: exactly and the fact that it is not constrained by the type nor that it performs an <code>abs</code> itself, nor that it always uses zero makes it completely horrible function."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513510212, "post_id": 47849680, "comment_id": 82673265, "body": "yes, the old efficiency/correctness trade-off. the programmer thinks, &quot;if I already have only the non-zero numbers in my list I could skip calling the <code>(abs &lt;$&gt;)</code> on it.&quot; this is a real problem BTW, sometimes the ensuring of correctness is a very heavy calculation, not to be taken lightly (the repeating of it, I mean)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 7, "last_activity_date": 1513456497, "last_edit_date": 1513456497, "creation_date": 1513456133, "answer_id": 47849680, "question_id": 47849603, "link": "https://stackoverflow.com/questions/47849603/haskell-a-very-simple-function/47849680#47849680", "title": "Haskell - a very simple function", "body": "<p>A list in Haskell is - at least conceptually - a <em>linked list</em>. there are two possibilities:</p>\n\n<ul>\n<li>an empty list <code>[]</code>; or</li>\n<li>a \"cons\" <code>(x:xs)</code> where <code>x</code> is the <em>head</em> (first item), and <code>xs</code> the <em>tail</em> (the rest of the list).</li>\n</ul>\n\n<p>Haskell also uses <em>syntactical sugar</em>. For instance <code>[1]</code> is behind the curtains translated to <code>(1:[])</code>, and <code>[1,4,2,5]</code> to <code>(1:(4:(2:(5:[]))))</code>.</p>\n\n<p>Why is this important? We first will try to understand the <code>q1</code> function. If we look at the type, we see that <code>q1</code> takes as input a list of <code>Int</code>s, and returns an <code>Int</code>. It is defined recursively as:</p>\n\n<pre><code>q1 :: [Int]  -&gt; Int\nq1 [] = 0\nq1 [x] = x\nq1 (x:_:xs) = max x (q1 xs)\n</code></pre>\n\n<p>This means that <code>q1</code> for an empty list is zero (<code>0</code>); that the <code>q1</code> for a list with one element <code>x</code> is <code>x</code>. For a list with <em>two</em> or more elements is the <code>maximum</code> of the first item of that list <code>x</code>, and <em>tail of the tail</em> of that list. This is because we pattern match with <code>(x:_:xs)</code> which is short for <code>(x:(_:xs))</code>. The underscore basically means \"<em>don't care</em>\". So the list should be a <em>cons</em> where the tail is a <em>cons</em> as well, and we are interested in the head of the list <code>x</code>, and the tail of the tail of the list <code>xs</code>.</p>\n\n<p>If we reason about this, we thus find out that <code>q1</code> returns the <em>maximum</em> of the elements at <em>odd indices</em> (so the first, third, fifth, etc. element). In case the list has an <em>even</em> length, we also calculate the maximum with zero (so in case the all elements at odd indices are negative, the function will return zero, but this <em>only</em> in the case we have a list of <em>even</em> length).</p>\n\n<p>Now if wel call it with <code>q1 (map abs [-1,-6,-5,7])</code>, it thus means that we will call <code>q1</code> on the <em>result</em> of <code>map abs</code> on <code>[-1, -6, -5, 7]</code>. <code>map abs</code> constructs a list where <code>abs</code> is applied to all elements of the list (although it is applied lazily). So after the <code>map abs [-1, -6, -5, 7]</code>, we obtain the list <code>[1, 6, 5, 7]</code>. Now the elements at the odd indices are <code>1</code> and <code>5</code>. So <code>q1</code> will calculate the maximum of these elements and zero (since the length of the list is four, which is even). And <em>max(0, 1, 5)</em> is <em>5</em>.</p>\n\n<p>Personally, especially the fact that we also consider zero but only in case the list has an <em>even</em> length, is very \"<em>unstable</em>\". It can result in bugs that are hard to understand, since it can be the result of a detail of the function. We can for instance calculate the maximum with zero, regardless of the length of the list:</p>\n\n<pre><code>q2 :: (Num a, Ord a) =&gt; [a] -&gt; a\nq2 [] = 0\nq2 [x] = max 0 x\nq2 (x:_:xs) = max x (q2 xs)\n</code></pre>\n\n<p>Or we can decide to not use zero at all, and not define maximum over an empty list, like for instance:</p>\n\n<pre><code>q3 :: Ord a =&gt; [a] -&gt; a\nq3 [x] = x\nq3 [x,_] = x\nq3 (x:_:xs) = max x (q3 xs)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9108087, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c8YQL1L-hM4/AAAAAAAAAAI/AAAAAAAAB6c/cQnhsZyjx9o/photo.jpg?sz=128", "display_name": "ProShifu", "link": "https://stackoverflow.com/users/9108087/proshifu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513461494, "creation_date": 1513455403, "last_edit_date": 1513461494, "question_id": 47849603, "link": "https://stackoverflow.com/questions/47849603/haskell-a-very-simple-function", "title": "Haskell - a very simple function", "body": "<p>I'm trying to understand the following function:</p>\n\n<pre><code>q1 :: [Int]  -&gt; Int\nq1 []                    = 0\nq1 [x]                   = x\nq1 (x:_:xs)              = max x (q1 xs)\n</code></pre>\n\n<p>When inputting this: q1 (map abs [-1,-6,-5,7]), it gets me 5. Can someone walk me through why this happens? I understand how map functions, but the pattern matching (x:_xs) is a bit confusing. Thanks!</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513456051, "post_id": 47849407, "comment_id": 82663773, "body": "You need the Coarbitrary constraint because the Arbitrary instance for functions requires it (to see why, look at how the Arbitrary instance is defined). However, there is nothing preventing a type from being both Arbitrary and Coarbitrary (indeed, most types have both instances). Why does this seem contradictory to you?"}, {"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513625187, "post_id": 47849407, "comment_id": 82715611, "body": "I think I got confused with ` Arbitrary (Comp a)`  I assumed the <code>a</code> was a type like in <code>Comp String</code>, as is used in <code>CompAssoc</code>, but the <code>a</code> here represents the function that you pass when constructing a <code>Comp</code>. You only use the concrete types when declaring functions. I guess I mixed up type constructors and data constructors."}, {"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513625512, "post_id": 47849407, "comment_id": 82715763, "body": "Still confused. I changed the data constructor to <code>Compp</code> and it still requires the type constructor for the Arbitrary declaration. but the Type Constructor takes a type like <code>String</code> or whatever has a Semigroup instance. But here we are trying to generate functions, i.e. the thing passed to the data constructor. How can we limit <code>Comp a</code> (the data constructor to need <code>CoArbitrary</code> when it expects something like <code>String</code> which is something that has a Semigroup instance?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513628044, "post_id": 47849407, "comment_id": 82716873, "body": "I&#39;m afraid I don&#39;t see where your confusion lies. Is there a specific thing you are trying to accomplish which you are having trouble with?"}, {"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513641347, "post_id": 47849407, "comment_id": 82722250, "body": "no, just understand why the test passes. I think I am understanding that by putting the CoArbitrary restraint on the <code>a</code> going to <code>Comp</code>, that is restraining the arg and return type of the <code>unComp</code> function, saying that I must be able to generate a function that takes a <code>type a</code>"}, {"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513641525, "post_id": 47849407, "comment_id": 82722299, "body": "or more broadly, if I were to not have <code>CoArbitrary a</code> as a restraint, but just <code>Arbitrary a</code>, then I can return a random <code>a</code> value. But when I add <code>CoArbitrary a</code>, the random value that is returned is a function that can accept an <code>a</code>. That is, <code>CoArbitrary</code> speaks about returning a function that <i>accepts</i> values of a certain type."}], "answers": [{"tags": [], "owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "is_accepted": true, "score": 3, "last_activity_date": 1513790027, "last_edit_date": 1513790027, "creation_date": 1513788799, "answer_id": 47910875, "question_id": 47849407, "link": "https://stackoverflow.com/questions/47849407/coarbitrary-in-haskell/47910875#47910875", "title": "CoArbitrary in Haskell", "body": "<p>This is a <em>beginner's, high-level</em>, very probably <strong>incorrect in the underlying details</strong> explanation of the relationship between <code>Arbitrary</code> and <code>CoArbitrary</code>. </p>\n\n<p>The article <a href=\"https://begriffs.com/posts/2017-01-14-design-use-quickcheck.html\" rel=\"nofollow noreferrer\">https://begriffs.com/posts/2017-01-14-design-use-quickcheck.html</a> gives you a better explanation but it uses Applicative and Functor and I haven't gotten there yet as I am still on the SemiGroup chapter of \"The Haskell Book\".</p>\n\n<p>If you want to generate a function from <code>a -&gt; b</code>, <code>b</code> must have an instance of <code>Arbitrary</code>. We're going to be generating random stuff anyways, so we need a <code>Gen b</code> as usual. But we need to <em>vary</em> this <code>b</code> just like a normal function would, that is, in the sense of if I pass a different value to a function like <code>double</code>, I'd expect a different response. But how can we <em>vary</em> a generator based on some random <code>a</code>? Well, if we think about the way we generate random <code>b</code>s in the first place, it has to do with <code>numbers</code>. I.e. if I want a random <code>b</code> (say, Int), I just generate a random number. Easy peasy. Random string? Start with random numbers, convert them to ASCII chars. Same with any other data type you want, and quickcheck provides a lot of <code>Arbitrary</code> instances that do just that. </p>\n\n<p>OK, so at the base it is numbers. \nWe could change those numbers by getting some other number and then, say, multiplying/subtracting/adding/dividing. Or any other math operation. But how do we get that other number? That's where <code>CoArbitrary</code> comes in! If I mark a type as needing to have an instance of <code>CoArbitrary</code>, effectively I am saying \"I need to be able to reduce your type down to a number so that I can <strong>vary</strong> (add/mult/etc) the Generator for type <code>b</code>. So if type <code>a</code> is a string, for ex., reduce that string to a number, pass it to the gen for <code>type b</code> in order to let the Gen for type <code>b</code> do the <code>mult/add/etc</code> operation on the <strong>number(s)</strong> it would use to generate a <code>b</code>.</p>\n"}], "owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 47910875, "answer_count": 1, "score": 4, "last_activity_date": 1513790027, "creation_date": 1513453786, "question_id": 47849407, "link": "https://stackoverflow.com/questions/47849407/coarbitrary-in-haskell", "title": "CoArbitrary in Haskell", "body": "<p>I am working through the Haskell Book and have come to the point of writing an Arbitrary instance for <code>newType Comp</code>. The code is below</p>\n\n<pre><code>instance Show (Comp a) where\n    show f = \"Unicorns!!\"\n\nnewtype Comp a =\n    Comp { unComp :: (a -&gt; a) }\n\ninstance (Semigroup a) =&gt; S.Semigroup (Comp a) where\n    (Comp fx) &lt;&gt; (Comp fy) = Comp (fx . fy)\n\ninstance (CoArbitrary a, Arbitrary a) =&gt; Arbitrary (Comp a) where\n    arbitrary = do\n        f &lt;- Test.QuickCheck.arbitrary\n        return (Comp f)\n\ntype CompAssoc = String -&gt; Comp String -&gt; Comp String -&gt; Comp String -&gt; Bool\n\ncompAssoc :: (S.Semigroup a, Eq a) =&gt; a -&gt; Comp a -&gt; Comp a -&gt; Comp a -&gt; Bool\ncompAssoc v a b c = (unComp (a &lt;&gt; (b &lt;&gt; c)) $ v) == (unComp ((a &lt;&gt; b) &lt;&gt; c) $ v)\n</code></pre>\n\n<p>and tested with</p>\n\n<pre><code>main :: IO ()\nmain = do\n    quickCheck (compAssoc :: CompAssoc)\n</code></pre>\n\n<p>My question revolves around the Arbitrary instance. It is generating a function to be passed to <code>return (Comp f)</code>. I understand (though not fully why) that this has to be scoped to CoArbitrary. But if that thing passed to <code>return (Comp f)</code> is <code>CoArbitrary</code>, how can it also be <code>Arbitrary</code>? I guess it seems to be like these constraints both refer to the pass/return type of the function <em>and the function itself</em>. I'm a little confused.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1513452812, "post_id": 47849144, "comment_id": 82662889, "body": "Do you mean a <code>Vector</code> from <code>Data.Vector</code>? Can you show us your attempt?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1513457808, "post_id": 47849144, "comment_id": 82664241, "body": "<a href=\"https://hackage.haskell.org/package/split-0.2.3.2/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\"><code>chunksOf :: Int -&gt; [e] -&gt; [[e]]</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1513547105, "creation_date": 1513547105, "answer_id": 47859781, "question_id": 47849144, "link": "https://stackoverflow.com/questions/47849144/idiomatic-haskell-for-transforming-a-vector-into-a-2d-matrix/47859781#47859781", "title": "Idiomatic Haskell for transforming a vector into a 2D matrix?", "body": "<p>Assuming you mean turning a \"vector\" represented as a Haskell list into a \"matrix\" represented as a list of lists, then an idiomatic solution is likely to use <code>splitAt</code> to break off each row, building the list of rows <strong>EITHER</strong> using straightforward pattern matching and recursion:</p>\n\n<pre><code>chunksOf :: Int -&gt; [a] -&gt; [[a]]\nchunksOf _ [] = []\nchunksOf n xs =\n  let (row, rest) = splitAt n xs\n  in  row : chunksOf n rest\n</code></pre>\n\n<p>possibly with a guard to avoid embarrassing endless loops:</p>\n\n<pre><code>chunksOf :: Int -&gt; [a] -&gt; [[a]]\nchunksOf n | n &gt; 0 = chunks\n  where\n    chunks [] = []\n    chunks xs =\n      let (row, rest) = splitAt n xs\n      in  row : chunks rest\n</code></pre>\n\n<p><strong>OR ELSE</strong> using <code>unfoldr</code>:</p>\n\n<pre><code>import Data.List\nchunksOf :: Int -&gt; [a] -&gt; [[a]]\nchunksOf n | n &gt; 0 = unfoldr chunk\n  where\n    chunk [] = Nothing\n    chunk xs = Just (splitAt n xs)\n</code></pre>\n\n<p>If the length is not a multiple of the row length, the final row will be shorter than the rest.  To allow a fill character for the final incomplete row, you might write:</p>\n\n<pre><code>import Data.List\nchunksOfWithFill :: Int -&gt; a -&gt; [a] -&gt; [[a]]\nchunksOfWithFill n filler | n &gt; 0 = unfoldr chunk\n  where\n    chunk xs = case splitAt n xs of\n      ([],[]) -&gt; Nothing\n      (xs,[]) -&gt; Just (fill xs, [])\n      result  -&gt; Just result\n    fill xs = take n (xs ++ repeat filler)\n</code></pre>\n\n<p>As @Will Ness notes in the comments, <code>chunksOf</code> is already available in the <code>Data.List.Split</code> module of the <code>split</code> package.</p>\n"}], "owner": {"reputation": 7010, "user_id": 279104, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tIiI9.jpg?s=128&g=1", "display_name": "guidoism", "link": "https://stackoverflow.com/users/279104/guidoism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 47859781, "answer_count": 1, "score": -2, "last_activity_date": 1513547105, "creation_date": 1513451981, "question_id": 47849144, "link": "https://stackoverflow.com/questions/47849144/idiomatic-haskell-for-transforming-a-vector-into-a-2d-matrix", "title": "Idiomatic Haskell for transforming a vector into a 2D matrix?", "body": "<p>I have a vector of Integers that I'd like to convert into an two-dimensional matrix. The input is guaranteed to be divisible by the row size. What's the most idiomatic way to do this in Haskell?</p>\n\n<p>In Python I would do this:</p>\n\n<pre><code># Taken from itertools docs.\ndef grouper(iterable, n, fillvalue=None):\n    \"Collect data into fixed-length chunks or blocks\"\n    # grouper('ABCDEFG', 3, 'x') --&gt; ABC DEF Gxx\n    args = [iter(iterable)] * n\n    return itertools.izip_longest(fillvalue=fillvalue, *args)\n\nm = list(grouper(v, n))\n</code></pre>\n"}, {"tags": ["haskell", "ffi", "ghci"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513458812, "post_id": 47849032, "comment_id": 82664516, "body": "This is quite vague - you ahould include a minimal example which shows the problem. Note, for FFI to work at all in GHCi you must pass <code>-fobejct-code</code>. However, without this option the error you will get is different, so I don&#39;t know if this is your problem."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513461308, "post_id": 47849032, "comment_id": 82665107, "body": "@user2407038 Yep, sorry for the vagueness but this problem doesn&#39;t occur for a small code. My code is <a href=\"https://github.com/stla/owenqp\" rel=\"nofollow noreferrer\">here</a> but I&#39;m afraid nobody will look at such a piece of code."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513476709, "post_id": 47849032, "comment_id": 82667656, "body": "@St&#233;phaneLaurent, if small code works, and large code doesn&#39;t, start simplifying the large code you have until it works.  It might even show you exactly what the problem is"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513481413, "post_id": 47849032, "comment_id": 82668239, "body": "@luqui That&#39;s what I did previously. But that does not lead to anything because of the random behavior. Currently my program works like a charm in GHCI."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513491082, "post_id": 47849032, "comment_id": 82669680, "body": "@St&#233;phaneLaurent, oh man, I didn&#39;t notice &quot;doesn&#39;t always work&quot;. Maybe try loading up <code>ghci</code> in <code>gdb</code> so you can see where it goes wrong specifically (hoping that it&#39;s in the C++ code)?"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513451015, "creation_date": 1513451015, "question_id": 47849032, "link": "https://stackoverflow.com/questions/47849032/access-violation-in-ghci", "title": "Access violation in GHCI", "body": "<p>I have a Haskell program using the FFI to import C++ functions. I'm using Windows. When I compile to an executable or to a DLL, this works. But when I load a module in GHCI, this doesn't always work: sometimes this works, sometimes I get <em>Access violation in generated code when reading 0000000000000000</em> whenever I call a function from the module (even if this function has nothing to do with the C++). Do you know how to prevent that?</p>\n"}, {"tags": ["haskell", "text-editor", "ctags", "kate"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513451271, "post_id": 47848818, "comment_id": 82662475, "body": "Any reason you want to use ctags instead of hasktags, which works with Haskell?"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513465955, "post_id": 47848818, "comment_id": 82665995, "body": "No reason at all, except for total inexperience. How am I supposed to employ <code>hasktags</code>? Is it a command line tool, or something else?"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513467844, "post_id": 47848818, "comment_id": 82666327, "body": "Yes, it looks like a command line tool. See the UPD. Sorry, I can&#39;t make much sense out of <code>hasktags</code> readme."}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513494409, "post_id": 47851064, "comment_id": 82670204, "body": "Thanks! I&#39;m having trouble with my environment so far: Kate does not see the executable, despite it being visible from the Kate Current Project Path. For troubleshooting I need this answered: <a href=\"https://stackoverflow.com/questions/47852911/haskell-stack-locate-the-executable\" title=\"haskell stack locate the executable\">stackoverflow.com/questions/47852911/&hellip;</a>"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513495895, "post_id": 47851064, "comment_id": 82670443, "body": "For some reason, Kate does not look into Project for ctags executable, where it is located in my case. This is inner workings of CTags Kate plugin, though. What would happen if I just run <code>hasktags</code> manually in my project directory? Well, it runs silently, no error messages (with the suggested command line arguments), no obvious result."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513499177, "post_id": 47851064, "comment_id": 82670952, "body": "Put a soft link into <code>&#47;usr&#47;local&#47;bin</code>, now it runs, all wrong: The CTags program exited with code 1: hasktags: ./spaces/hehe/hehe/dbdata/mysql: getDirectoryContents:openDirStream: permission denied (Permission denied). The path in the error message has nothing to do with anything. CTags inner workings again."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513505590, "post_id": 47851064, "comment_id": 82672212, "body": "FWIW: The tags file generated initially by <code>ctags</code> utility with all default options weighs 205M; generated manually with <code>stack exec -- hasktags --ignore-close-implementation --ctags .</code> 1.3K. Both are text files, the latter clean and perfectly understandable. Which makes no difference functionally, though."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1513470159, "last_edit_date": 1513470159, "creation_date": 1513468750, "answer_id": 47851064, "question_id": 47848818, "link": "https://stackoverflow.com/questions/47848818/haskell-ctags-and-kate-editor/47851064#47851064", "title": "Haskell: ctags (and Kate editor)", "body": "<p>I use hasktags and a shell function in my <code>.zshrc</code> to simplify things:</p>\n\n<pre><code>hasktags --ignore-close-implementation --ctags .\n</code></pre>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513470159, "creation_date": 1513449351, "last_edit_date": 1513468056, "question_id": 47848818, "link": "https://stackoverflow.com/questions/47848818/haskell-ctags-and-kate-editor", "title": "Haskell: ctags (and Kate editor)", "body": "<p>I tried CTags plugin for Kate editor. It kinda works, index builds silently (no error messages), database file along with the necessary menu entries appears. Then <code>Go to definition</code> - <code>No hits found</code>.</p>\n\n<p>I am not surprised too much. Apparently, Kate builds the index this way:</p>\n\n<pre><code>ctags -R --c++-types=+px --extra=+q --excmd=pattern --exclude=Makefile --exclude=.\n</code></pre>\n\n<p>It is suggestive of C++; I cannot tell more. What is the correct command line for Haskell ctags?</p>\n\n<p>UPD:</p>\n\n<p><code>hasktags</code> has been suggested. I managed to install and run it tentatively:</p>\n\n<pre><code>$ stack exec hasktags\nUsage: hasktags [OPTION...] [files or directories...]\ndirectories will be replaced by DIR/**/*.hs DIR/**/*.lhs\nThus hasktags . tags all important files in the current\ndirectory.\n\n    If directories are symlinks they will not be followed\nunless you pass -L.\n\nA special file \"STDIN\" will make hasktags read the line separated file\nlist to be tagged from STDIN.\n\n  -c            --ctags                        generate CTAGS file (ctags)\n  -e            --etags                        generate ETAGS file (etags)\n  -b            --both                         generate both CTAGS and ETAGS\n  -a            --append                       append to existing CTAGS and/or ETAGS file(s). Afterward this file will no longer be sorted!\n                --ignore-close-implementation  ignores found implementation if it is closer than 7 lines - so you can jump to definition in one shot\n  -o            --output=                      output to given file, instead of 'tags', '-' file is stdout\n  -f            --file=                        same as -o, but used as compatibility with ctags\n  -x            --extendedctag                 Generate additional information in ctag file.\n                --cache                        Cache file data.\n  -L            --follow-symlinks              follow symlinks when recursing directories\n  -S[.hs,.lhs]  --suffixes[=.hs,.lhs]          list of hs suffixes including \".\"\n  -R            --tags-absolute                make tags paths absolute. Useful when setting tags files in other directories\n  -h            --help                         This help\n</code></pre>\n\n<p>There is also some path in Kate <code>CTags database file</code>:</p>\n\n<pre><code>/home/alexey/.local/share/kate/katectags/session_db_20171216_180641\n</code></pre>\n\n<p>I can't make much out of <code>hasktags</code> readme.</p>\n"}, {"tags": ["haskell", "postgresql-simple"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1513443397, "post_id": 47847961, "comment_id": 82660142, "body": "What do you get when your use <code>i &lt;- query_ conn &quot;SELECT url FROM feed WHERE id = 1&quot;</code>? In that case you can inspect what value you obtained and why it is not matching."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1513444080, "post_id": 47847961, "comment_id": 82660384, "body": "if you do <code>i &lt;- query_ conn &quot;select ...&quot;</code> change the <code>hello :: IO String</code> to <code>hello :: IO [String]</code>"}], "owner": {"reputation": 2703, "user_id": 240976, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/bfef10a428769701aeee1db978951461?s=128&d=identicon&r=PG", "display_name": "Thomas Koch", "link": "https://stackoverflow.com/users/240976/thomas-koch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513455077, "creation_date": 1513443258, "last_edit_date": 1513455077, "question_id": 47847961, "link": "https://stackoverflow.com/questions/47847961/user-error-pattern-match-failure-in-do-expression-with-postgresql-simple", "title": "user error (Pattern match failure in do expression) with PostgreSQL.Simple", "body": "<p>My schema:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS feed (\n  id SERIAL PRIMARY KEY CHECK (id &gt; 0),\n  name TEXT NOT NULL,\n  url TEXT NOT NULL\n);\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport           Database.PostgreSQL.Simple\n\nhello :: IO String\nhello = do\n  conn &lt;- connectPostgreSQL \"\"\n  [Only i] &lt;- query_ conn \"SELECT url FROM feed WHERE id = 1\"\n  return i\n\nmain :: IO ()\nmain = hello &gt;&gt;= print\n</code></pre>\n\n<p>My error:</p>\n\n<pre><code>user error (Pattern match failure in do expression at src/Main.hs:8:3-10)\n</code></pre>\n\n<p>My questions:</p>\n\n<ul>\n<li>How do I fix this error?</li>\n<li>How could I get a more informative error message?</li>\n</ul>\n\n<p><strong>Update:</strong> I connected to the wrong database and therefor my assumption about the result set was wrong. It contained zero lines instead of one line and thus it tried to match <code>[]</code> against <code>[Only i]</code>. I found it out by executing the query in ghci:</p>\n\n<pre><code>:set -XOverloadedStrings\nimport Database.PostgreSQL.Simple\ndo;  conn &lt;- connectPostgreSQL \"\" ;query_ conn \"SELECT url FROM feed WHERE id = 1\"\n</code></pre>\n"}, {"tags": ["haskell", "iteration"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1513421410, "post_id": 47844729, "comment_id": 82653742, "body": "If the number of iterations <code>n</code> is statically known, maybe something can be done using type families (<code>Apply n [] a</code>), possibly exploiting singletons for naturals. Otherwise, you could create a large enough sum type to denote a nesting of lists, e.g. <code>data Value a = V a | L [Value a]</code> (which is a rose tree, roughly)."}, {"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1513421719, "post_id": 47844729, "comment_id": 82653833, "body": "Thank you. I will check these options."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513422199, "post_id": 47844729, "comment_id": 82653962, "body": "You can not create this as a list. So in that case you need to define a recursive data type (something like a tree, where you do not place values in the inodes)."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1513431695, "post_id": 47844729, "comment_id": 82656516, "body": "Justin Le&#39;s posts on dependent types in Haskell are quite informative: <a href=\"https://blog.jle.im/entry/practical-dependent-types-in-haskell-1.html\" rel=\"nofollow noreferrer\">blog.jle.im/entry/practical-dependent-types-in-haskell-1.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513432208, "post_id": 47844729, "comment_id": 82656686, "body": ".Thank you for providing a site with excellent Haskell resources."}], "answers": [{"comments": [{"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513431684, "post_id": 47846130, "comment_id": 82656514, "body": "Thank you,  I will check this out and try to work out the problem that is mentioned at the end of my post."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 4, "last_activity_date": 1513431548, "last_edit_date": 1513431548, "creation_date": 1513430576, "answer_id": 47846130, "question_id": 47844729, "link": "https://stackoverflow.com/questions/47844729/how-to-iterate-over-a-function-whose-type-changes-among-iteration-but-the-form/47846130#47846130", "title": "How to &quot;iterate&quot; over a function whose type changes among iteration but the formal definition is the same", "body": "<p>This problem indeed requires somewhat advanced type-level programming.</p>\n\n<p>I followed @chi's suggestion in the comments, and searched for a library that provided inductive type-level naturals with their corresponding singletons. I found the <a href=\"http://hackage.haskell.org/package/fin-0\" rel=\"nofollow noreferrer\"><em>fin</em></a> library, which is used in the answer.</p>\n\n<p>The usual extensions for type-level trickery:</p>\n\n<pre><code>{-# language DataKinds, PolyKinds, KindSignatures, ScopedTypeVariables, TypeFamilies #-}\n</code></pre>\n\n<p>Here's a <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=type%20families#ghc-flag--XTypeFamilies\" rel=\"nofollow noreferrer\">type family</a> that maps a type-level natural and an element type to the type of the corresponding nested list:</p>\n\n<pre><code>import Data.Type.Nat\n\ntype family Nested (n::Nat) a where\n    Nested Z a = [a]\n    Nested (S n) a = [Nested n a]\n</code></pre>\n\n<p>For example, we can test <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html?highlight=%3Akind#ghci-cmd-:kind\" rel=\"nofollow noreferrer\">from ghci</a> that</p>\n\n<pre><code>*Main&gt; :kind! Nested Nat3 Int\nNested Nat3 Int :: *\n= [[[[Int]]]]\n</code></pre>\n\n<p>(<a href=\"http://hackage.haskell.org/package/fin-0/docs/Data-Type-Nat.html#t:Nat3\" rel=\"nofollow noreferrer\"><code>Nat3</code></a> is a convenient alias defined in <code>Data.Type.Nat</code>.)</p>\n\n<p>And here's a newtype that wraps the function we want to construct. It uses the type family to express the level of nesting</p>\n\n<pre><code>newtype Iterate (n::Nat) a = Iterate { runIterate :: (a -&gt; [a]) -&gt; a -&gt; Nested n a }\n</code></pre>\n\n<p>The <em>fin</em> library provides a really nifty <a href=\"http://hackage.haskell.org/package/fin-0/docs/Data-Type-Nat.html#v:induction1\" rel=\"nofollow noreferrer\"><code>induction1</code></a> function that lets us compute a result by induction on <code>Nat</code>. We can use it to compute the <code>Iterate</code> that corresponds to every <code>Nat</code>. The <code>Nat</code> is passed <em>implicitly</em>, as a <a href=\"http://hackage.haskell.org/package/fin-0/docs/Data-Type-Nat.html#t:SNatI\" rel=\"nofollow noreferrer\">constraint</a>:</p>\n\n<pre><code>iterate' :: forall n a. SNatI n =&gt; Iterate (n::Nat) a\niterate' =\n    let step :: forall m. SNatI m =&gt; Iterate m a -&gt; Iterate (S m) a\n        step (Iterate recN) = Iterate (\\f a -&gt; [recN f a])\n    in  induction1 (Iterate id) step\n</code></pre>\n\n<p>Testing the function in ghci (using <code>-XTypeApplications</code> to supply the <code>Nat</code>):</p>\n\n<pre><code>*Main&gt; runIterate (iterate' @Nat3) pure True\n[[[[True]]]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513431914, "post_id": 47846278, "comment_id": 82656588, "body": "I checked in GHCi, I cannot put them in the same list. <code>a=(8 :: Int); b=[a,[a]]</code> is not allowed and GHCi complains about mismatching type."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 1, "creation_date": 1513431981, "post_id": 47846278, "comment_id": 82656605, "body": "Well, yeah, that&#39;s just what I said... Haskell lists are by design \u201cflat-typed\u201d, which IMO expresses naturally what the concept of a list <i>is</i>. But it&#39;s easy to define your own data types to support just the right amount of nesting possibility."}, {"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513432092, "post_id": 47846278, "comment_id": 82656641, "body": "Thank you. I have misunderstood what you said at first glance."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1513431652, "creation_date": 1513431652, "answer_id": 47846278, "question_id": 47844729, "link": "https://stackoverflow.com/questions/47844729/how-to-iterate-over-a-function-whose-type-changes-among-iteration-but-the-form/47846278#47846278", "title": "How to &quot;iterate&quot; over a function whose type changes among iteration but the formal definition is the same", "body": "<p>You'll certainly agree that <code>2 :: Int</code> and <code>4 :: Int</code> have the same type. Because Haskell is not <a href=\"https://en.wikipedia.org/wiki/Dependent_type\" rel=\"noreferrer\">dependently typed</a><sup>&dagger;</sup>, that means <code>foldr1 (.) (replicate 2 (\\x-&gt;[x])) (8 :: Int)</code> and <code>foldr1 (.) (replicate 4 (\\x-&gt;[x])) (8 :: Int)</code> must have the same type, in contradiction with your idea that the former should give <code>[[8]] :: [[Int]]</code> and the latter <code>[[[[8]]]] :: [[[[Int]]]]</code>. In particular, it should be possible to put both of these expressions in a single list (Haskell lists need to have the same type for all their elements). But this just doesn't work.</p>\n\n<p>The point is that you don't really want a Haskell list type: you <em>want</em> to be able to have different-depth branches in a single structure. Well, you <em>can</em> have that, and it doesn't require any clever type system hacks &ndash; we just need to be clear that this is not a list, but a <em>tree</em>. Something like this:</p>\n\n<pre><code>data Tree a = Leaf a | Rose [Tree a]\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>Prelude&gt; foldr1 (.) (replicate 2 (\\x-&gt;Rose [x])) $ Leaf (8 :: Int)\nRose [Rose [Leaf 8]]\nPrelude&gt; foldr1 (.) (replicate 4 (\\x-&gt;Rose [x])) $ Leaf (8 :: Int)\nRose [Rose [Rose [Rose [Leaf 8]]]]\n</code></pre>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Actually, modern GHC Haskell has quite a bunch of dependently-typed features (see DaniDiaz' answer), but these are still quite clearly separated from the value-level language.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513454118, "post_id": 47849181, "comment_id": 82663267, "body": "Thank you very much. This is yet another way to view the problem. As for the natural number, I want to get the explicit expression in the form of sets, with sets replaced by lists. Your implementation is simple but does not provide any detail about the <code>Succ</code>. I will also try to write an explicit <code>show</code> for your data type so that I can see [[[[[8]]]]] without the  parentheses and constructor names. However if I <b>really</b> want to get &quot;8&quot; nested in the list for 100 times rather than something that looks similar but is not really a list, @danidiaz&#39;s answer still seems the only option so far."}, {"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513455418, "post_id": 47849181, "comment_id": 82663601, "body": "Again I have to say that this construction is very clever, and elegant."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513456028, "post_id": 47849181, "comment_id": 82663768, "body": "@WeijunZhou I&#39;m not sure I understand your &quot;if I <b>really</b> want to get &#39;8&#39; nested in the list for 100 times rather than something that looks similar but is not really a list&quot; objection. There <b>really</b> is a list, nested 100-deep, with an <code>8</code> in the inner-most list here!"}, {"owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "edited": false, "score": 0, "creation_date": 1513456292, "post_id": 47849181, "comment_id": 82663845, "body": "Yes, I can see it, although it is wrapped by some constructors. Maybe I should consider rewording."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1513452212, "creation_date": 1513452212, "answer_id": 47849181, "question_id": 47844729, "link": "https://stackoverflow.com/questions/47844729/how-to-iterate-over-a-function-whose-type-changes-among-iteration-but-the-form/47849181#47849181", "title": "How to &quot;iterate&quot; over a function whose type changes among iteration but the formal definition is the same", "body": "<p>I'd like to propose a very simple alternative which doesn't require any extensions or trickery: <em>don't</em> use different types.</p>\n\n<p>Here is a type which can hold lists with any number of nestings, provided you say how many up front:</p>\n\n<pre><code>data NestList a = Zero a | Succ (NestList [a]) deriving Show\ninstance Functor NestList where\n    fmap f (Zero a) = Zero (f a)\n    fmap f (Succ as) = Succ (fmap (map f) as)\n</code></pre>\n\n<p>A value of this type is a church numeral indicating how many layers of nesting there are, followed by a value with that many layers of nesting; for example,</p>\n\n<pre><code>Succ (Succ (Zero [['a']])) :: NestList Char\n</code></pre>\n\n<p>It's now easy-cheesy to write your <code>\\x -&gt; [x]</code> iteration; since we want one more layer of nesting, we add one <code>Succ</code>.</p>\n\n<pre><code>&gt; iterate (\\x -&gt; Succ (fmap (:[]) x)) (Zero 8) !! 5\nSucc (Succ (Succ (Succ (Succ (Zero [[[[[8]]]]])))))\n</code></pre>\n\n<p>Your proposal for how to implement natural numbers can be modified similarly to use a simple recursive type. But the standard way is even cleaner: just take the above <code>NestList</code> and drop all the arguments.</p>\n\n<pre><code>data Nat = Zero | Succ Nat\n</code></pre>\n"}], "owner": {"reputation": 356, "user_id": 3966456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1677e4fdd3c56cfca9d2711064876394?s=128&d=identicon&r=PG&f=1", "display_name": "Weijun Zhou", "link": "https://stackoverflow.com/users/3966456/weijun-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 1, "accepted_answer_id": 47846130, "answer_count": 3, "score": 4, "last_activity_date": 1513455021, "creation_date": 1513420537, "last_edit_date": 1513455021, "question_id": 47844729, "link": "https://stackoverflow.com/questions/47844729/how-to-iterate-over-a-function-whose-type-changes-among-iteration-but-the-form", "title": "How to &quot;iterate&quot; over a function whose type changes among iteration but the formal definition is the same", "body": "<p>I have just started learning Haskell and I come across the following problem. I try to \"iterate\" the function <code>\\x-&gt;[x]</code>. I expect to get the result <code>[[8]]</code> by</p>\n\n<pre><code>foldr1 (.) (replicate 2 (\\x-&gt;[x])) $ (8 :: Int)\n</code></pre>\n\n<p>This does not work, and gives the following error message:</p>\n\n<blockquote>\n  <p>Occurs check: cannot construct the infinite type: <code>a ~ [a]</code></p>\n  \n  <p>Expected type: <code>[a -&gt; a]</code></p>\n  \n  <p>Actual type: <code>[a -&gt; [a]]</code></p>\n</blockquote>\n\n<p>I can understand why it doesn't work. It is because that <code>foldr1</code> has type signature <code>foldr1 :: Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; t a -&gt; a</code>, and takes <code>a -&gt; a -&gt; a</code> as the type signature of its first parameter, not <code>a -&gt; a -&gt; b</code></p>\n\n<p>Neither does this, for the same reason:</p>\n\n<pre><code>((!! 2) $ iterate (\\x-&gt;[x]) .) id) (8 :: Int)\n</code></pre>\n\n<p>However, this works:</p>\n\n<pre><code>(\\x-&gt;[x]) $ (\\x-&gt;[x]) $ (8 :: Int)\n</code></pre>\n\n<p>and I understand that the first <code>(\\x-&gt;[x])</code> and the second one are of different type (namely <code>[Int]-&gt;[[Int]]</code> and <code>Int-&gt;[Int]</code>), although formally they look the same.</p>\n\n<p>Now say that I need to change the 2 to a large number, say 100. </p>\n\n<p><strong>My question is</strong>, is there a way to construct such a list? Do I have to resort to meta-programming techniques such as Template Haskell? If I have to resort to meta-programming, how can I do it?</p>\n\n<p>As a side node, I have also tried to construct the string representation of such a list and <code>read</code> it. Although the string is much easier to construct, I don't know how to <code>read</code> such a string. For example,</p>\n\n<pre><code>read \"[[[[[8]]]]]\" :: ??\n</code></pre>\n\n<p>I don't know how to construct the <code>??</code> part when the number of nested layers is not known <em>a priori</em>. The only way I can think of is resorting to meta-programming.</p>\n\n<p>The question above may not seem interesting enough, and I have a \"real-life\" case. Consider the following function:</p>\n\n<pre><code>natSucc x = [Left x,Right [x]]\n</code></pre>\n\n<p>This is the <code>succ</code> function used in the <a href=\"https://en.wikipedia.org/wiki/Set-theoretic_definition_of_natural_numbers\" rel=\"nofollow noreferrer\">formal definition of natural numbers</a>. Again, I cannot simply <code>foldr1-replicate</code> or <code>!!-iterate</code> it.</p>\n\n<p>Any help will be appreciated. Suggestions on code styles are also welcome.</p>\n\n<p><strong>Edit</strong>:\nAfter viewing the 3 answers given so far (again, thank you all very much for your time and efforts) I realized this is a more general problem that is not limited to lists. A similar type of problem can be composed for each valid type of functor (what if I want to get <code>Just Just Just 8</code>, although that may not make much sense on its own?).</p>\n"}, {"tags": ["haskell", "scotty", "hspec"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513471778, "post_id": 47843958, "comment_id": 82666972, "body": "<a href=\"https://hackage.haskell.org/package/hspec-2.4.4/docs/Test-Hspec.html#v:beforeWith\" rel=\"nofollow noreferrer\"><code>beforeWith</code></a>? e.g. <code>before newEmptyRepository . beforeWith app</code>"}, {"owner": {"reputation": 28942, "user_id": 398441, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a8950160c2b3d7d0bf948d8c1f937e7f?s=128&d=identicon&r=PG", "display_name": "Johan", "link": "https://stackoverflow.com/users/398441/johan"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513503424, "post_id": 47843958, "comment_id": 82671736, "body": "I still don&#39;t understand how I can get a hold of the <code>newEmptyRepository</code> instance from this?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513544437, "post_id": 47843958, "comment_id": 82683505, "body": "I&#39;m not sure I understand. With that code, the result of <code>newEmptyRepository</code> is passed to <code>app</code> - that is now you access it (by manipulating the argument to <code>app</code>). Or maybe you mean you want to access both the <code>InMemoryGameRepository</code> and the <code>Application</code> in your test definitions - then just use <code>app&#39; r = (,) r &lt;$&gt; app r</code>. Aside: you shouldn&#39;t use <code>liftIO $ startGame repo</code> in the test definition; use <code>before_</code> for this (or just call <code>startGame</code> in <code>app</code>)."}, {"owner": {"reputation": 28942, "user_id": 398441, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a8950160c2b3d7d0bf948d8c1f937e7f?s=128&d=identicon&r=PG", "display_name": "Johan", "link": "https://stackoverflow.com/users/398441/johan"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513573434, "post_id": 47843958, "comment_id": 82689717, "body": "Maybe you could add it as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 2, "last_activity_date": 1513614568, "creation_date": 1513614568, "answer_id": 47872574, "question_id": 47843958, "link": "https://stackoverflow.com/questions/47843958/multiple-before-functions-in-hspec/47872574#47872574", "title": "Multiple before functions in HSpec?", "body": "<p>You should use <a href=\"https://hackage.haskell.org/package/hspec-2.4.4/docs/Test-Hspec.html#v:beforeWith\" rel=\"nofollow noreferrer\">beforeWith</a> which has the type</p>\n\n<pre><code>beforeWith :: (b -&gt; IO a) -&gt; SpecWith a -&gt; SpecWith b\n</code></pre>\n\n<p>Use it as e.g. <code>before newEmptyRepository . beforeWith app</code> whose type is <code>SpecWith Application -&gt; Spec</code>.</p>\n\n<p>If you want to access both the <code>InMemoryGameRepository</code> and the <code>Application</code> in your test cases, defined a helper function</p>\n\n<pre><code>withArg f a = (,) a &lt;$&gt; f a\nwithArg :: Functor f =&gt; (t -&gt; f b) -&gt; t -&gt; f (t, b)\n</code></pre>\n\n<p>then use</p>\n\n<pre><code>before newEmptyRepository . beforeWith (withArg app)\n    :: SpecWith (InMemoryGameRepository, Application) -&gt; Spec\n</code></pre>\n\n<p>Finally, you shouldn't use <code>liftIO $ startGame repo</code> in the definition of your tests - this runs <code>startGame</code> every time the test tree is built (although, this may actually be what you want, it doesn't seem to be the case). Instead, if you use the <code>before</code> family of functions, <code>startGame</code> will run once before the tests are actually run. You can even access the <code>Game</code> returned by <code>startGame</code> using the same technique as above:</p>\n\n<pre><code>  before newEmptyRepository \n. beforeWith (withArg startGame) \n. beforeWith (withArg $ app . fst)\n:: SpecWith ((InMemoryGameRepository, Game), Application) -&gt; Spec\n</code></pre>\n"}], "owner": {"reputation": 28942, "user_id": 398441, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a8950160c2b3d7d0bf948d8c1f937e7f?s=128&d=identicon&r=PG", "display_name": "Johan", "link": "https://stackoverflow.com/users/398441/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 47872574, "answer_count": 1, "score": 1, "last_activity_date": 1513614568, "creation_date": 1513413472, "last_edit_date": 1513415339, "question_id": 47843958, "link": "https://stackoverflow.com/questions/47843958/multiple-before-functions-in-hspec", "title": "Multiple before functions in HSpec?", "body": "<p>I have an in-memory repository that I can create by calling this function:</p>\n\n<pre><code>newEmptyRepository :: IO InMemoryGameRepository\n</code></pre>\n\n<p>where <code>InMemoryGameRepository</code> is defined like this:</p>\n\n<pre><code>type State = (HashMap GameId Game)\ntype IORefState = IORef State\nnewtype InMemoryGameRepository = InMemoryGameRepository IORefState\n</code></pre>\n\n<p>When writing tests for my Scotty application I've seen examples of using this approach:</p>\n\n<pre><code>spec =\n  before app $ do\n    describe \"GET /\" $ do\n      it \"responds with 200\" $ get \"/\" `shouldRespondWith` 200\n      it \"responds with 'hello'\" $ get \"/\" `shouldRespondWith` \"hello\"\n    ...\n</code></pre>\n\n<p>This is all fine but I need to somehow also initialize the InMemoryGameRepository (by calling <code>newEmptyRepository</code>) and use the created instance in my tests. Thus I've changed <code>app</code> to:</p>\n\n<pre><code>app :: InMemoryGameRepository -&gt; IO Application\napp repo = scottyApp $ routes repo\n</code></pre>\n\n<p>And I'm trying to create a test that uses the repository AND the <code>IO Application</code>, for example like this (which doesn't work):</p>\n\n<pre><code>spec = \n    before (do repo &lt;- newEmptyRepository\n               app repo) $ \n      -- API Tests\n      describe \"GET /api/games\" $ \n        it \"responds with \" $ do\n          liftIO $ startGame repo\n          get \"/api/games\" `shouldRespondWith` singleGameResponse\n</code></pre>\n\n<p>where <code>startGame</code> is defined like this:</p>\n\n<pre><code>startGame :: InMemoryGameRepository -&gt; IO Game\n</code></pre>\n\n<p>Here the compiler says (obviously) that <code>repo</code> is not in scope. But how can I achieve this? I.e. I want to share a single instance of <code>newEmptyRepository</code> both for the <code>app</code> and in the test?</p>\n\n<p>Ps: you can see the full application on <a href=\"https://github.com/johanhaleby/rps-haskell\" rel=\"nofollow noreferrer\">github</a>.</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1513439997, "post_id": 47843803, "comment_id": 82659045, "body": "Technically, the type just has to be some sort of <code>IO</code> value, not necessarily <code>IO ()</code>. There&#39;s just usually no <i>reason</i> to wrap any type other than <code>()</code>."}], "tags": [], "owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "is_accepted": true, "score": 6, "last_activity_date": 1513412284, "last_edit_date": 1513412284, "creation_date": 1513411979, "answer_id": 47843803, "question_id": 47843776, "link": "https://stackoverflow.com/questions/47843776/main-function-wont-take-any-arguments-in-haskell/47843803#47843803", "title": "main function won&#39;t take any arguments in haskell", "body": "<p>An Haskell program's entry point has the type of <code>IO ()</code>, not <code>String -&gt; IO ()</code>.</p>\n\n<p>To get the command-line arguments, use <code>System.Environment</code>'s <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/System-Environment.html#v:getArgs\" rel=\"noreferrer\"><code>getArgs</code></a>.</p>\n\n<p>Using do-notation:</p>\n\n<pre><code>import System.Environment (getArgs)\n\nmain :: IO ()\nmain = do\n  args &lt;- getArgs\n  print args\n</code></pre>\n\n<p>(Note that <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:print\" rel=\"noreferrer\"><code>print</code></a> is used instead of <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:putStrLn\" rel=\"noreferrer\"><code>putStrLn</code></a>, since <code>args</code> have the type of <code>[String]</code>, and not <code>String</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "is_accepted": false, "score": 0, "last_activity_date": 1605530870, "creation_date": 1605530870, "answer_id": 64858313, "question_id": 47843776, "link": "https://stackoverflow.com/questions/47843776/main-function-wont-take-any-arguments-in-haskell/64858313#64858313", "title": "main function won&#39;t take any arguments in haskell", "body": "<p>I also found this very useful.</p>\n<pre><code>main :: IO ()\nmain =\n    do\n        input &lt;- getContents\n        solve input\n</code></pre>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 47843803, "answer_count": 2, "score": 3, "last_activity_date": 1605530870, "creation_date": 1513411714, "last_edit_date": 1590834373, "question_id": 47843776, "link": "https://stackoverflow.com/questions/47843776/main-function-wont-take-any-arguments-in-haskell", "title": "main function won&#39;t take any arguments in haskell", "body": "<p>Hi I want to define a main function in haskell, similar to the main-function in java</p>\n\n<pre><code>main :: String -&gt; IO()\nmain args = do\n            putStrLn args\n</code></pre>\n\n<p>But this gives me an error when I try to run the program.</p>\n"}, {"tags": ["parsing", "haskell", "refactoring", "trifecta"], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1513443026, "post_id": 47843605, "comment_id": 82660020, "body": "Is your <code>Parser</code> type a synonym of <code>ReadP</code>?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1513463570, "post_id": 47843605, "comment_id": 82665528, "body": "Also known as <code>replicateM :: Applicative m =&gt; Int -&gt; m a -&gt; m [a]</code>."}, {"owner": {"reputation": 11471, "user_id": 25427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/099d66a10b0770e6aef499c89e25845e?s=128&d=identicon&r=PG", "display_name": "Alex Gyoshev", "link": "https://stackoverflow.com/users/25427/alex-gyoshev"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1513466144, "post_id": 47843605, "comment_id": 82666036, "body": "@4castle it is a <code>Text.Trifecta.Parser</code>; I&#39;ve updated the question. If I understand correctly, it is not related to <code>ReadP</code>, but has a very similar API. Since <code>count</code> comes from <code>Applicative</code>, I believe the same approach should work with <code>ReadP</code>."}], "tags": [], "owner": {"reputation": 11471, "user_id": 25427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/099d66a10b0770e6aef499c89e25845e?s=128&d=identicon&r=PG", "display_name": "Alex Gyoshev", "link": "https://stackoverflow.com/users/25427/alex-gyoshev"}, "is_accepted": true, "score": 1, "last_activity_date": 1513409960, "creation_date": 1513409960, "answer_id": 47843605, "question_id": 47843604, "link": "https://stackoverflow.com/questions/47843604/most-concise-way-to-parse-a-three-digit-number-in-haskell-trifecta/47843605#47843605", "title": "Most concise way to parse a three-digit number in Haskell (Trifecta)", "body": "<p>Use <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Text-ParserCombinators-ReadP.html#v:count\" rel=\"nofollow noreferrer\"><code>count</code></a>.</p>\n\n<pre><code>digits :: Int -&gt; Parser Int\ndigits n = read &lt;$&gt; count n digit\n</code></pre>\n"}], "owner": {"reputation": 11471, "user_id": 25427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/099d66a10b0770e6aef499c89e25845e?s=128&d=identicon&r=PG", "display_name": "Alex Gyoshev", "link": "https://stackoverflow.com/users/25427/alex-gyoshev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 47843605, "answer_count": 1, "score": 1, "last_activity_date": 1513465262, "creation_date": 1513409960, "last_edit_date": 1513465262, "question_id": 47843604, "link": "https://stackoverflow.com/questions/47843604/most-concise-way-to-parse-a-three-digit-number-in-haskell-trifecta", "title": "Most concise way to parse a three-digit number in Haskell (Trifecta)", "body": "<p>What is the idiomatic way parse three consecutive digits into a string?</p>\n\n<p>The following works, but does not scale:</p>\n\n<pre><code>threeDigits :: Parser Int\nthreeDigits = do\n    d1 &lt;- digit\n    d2 &lt;- digit\n    d3 &lt;- digit\n    return (digitToInt d1 * 100 + digitToInt d2 * 10 + digitToInt d3)\n</code></pre>\n\n<p>More generally, how can this scale for N numbers?</p>\n"}, {"tags": ["haskell", "unicode"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1513403003, "post_id": 47842808, "comment_id": 82649783, "body": "Take a look at <a href=\"https://hackage.haskell.org/package/system-filepath-0.4.13.4/docs/Filesystem-Path-Rules.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/system-filepath-0.4.13.4/docs/&hellip;</a> for less hacky ways to convert between stringy things and paths."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1513403332, "post_id": 47842808, "comment_id": 82649839, "body": "What is <code>strp</code> supposed to do? <code>show</code> is definitely the wrong way to implement it."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513410876, "post_id": 47842808, "comment_id": 82651291, "body": "<code>show</code> was ugly right from the start. I just knew no better. See UPD. I am still very much interested in turning off escaping optionally. <code>print</code>, for instance, is often quite useless because of escaping."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513448802, "post_id": 47842808, "comment_id": 82661821, "body": "@AlexeyOrlov, what exactly do you want in terms of escaping, that <code>putStrLn</code> does not satisfy?"}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513405422, "post_id": 47842961, "comment_id": 82650219, "body": "Looks like you are right. I use <code>show</code> because of this: <a href=\"https://stackoverflow.com/questions/34659580/with-haskells-turtle-library-how-to-extract-filename-as-string-from-filepath\" title=\"with haskells turtle library how to extract filename as string from filepath\">stackoverflow.com/questions/34659580/&hellip;</a> . Unfortunately, it is not just tracing: I have to mangle some file/path names, so I can&#39;t dispense with conversion. Do I have to use another i/o library to get rid of escaping?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513409083, "post_id": 47842961, "comment_id": 82650915, "body": "Wow, huh, there doesn&#39;t seem to be a way to convert a <a href=\"https://hackage.haskell.org/package/system-filepath-0.4.13.4/docs/Filesystem-Path.html\" rel=\"nofollow noreferrer\"><code>FilePath</code></a> to a string.. at all.  I see why you did that <code>show</code> hack.  From a comment on the question you linked, it looks like that system-filepath library is deprecated anyway, and it recommends using ndmitchell&#39;s <a href=\"http://hackage.haskell.org/package/filepath\" rel=\"nofollow noreferrer\">filepath</a> library instead.  I&#39;m not familiar enough with Turtle to know if it would be compatible."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513409398, "post_id": 47842961, "comment_id": 82650974, "body": "AHA!  You <i>can</i> convert a <code>FilePath</code> to a string, using <a href=\"https://hackage.haskell.org/package/system-filepath-0.4.13.4/docs/Filesystem-Path-Rules.html#v:toText\" rel=\"nofollow noreferrer\"><code>toText</code></a> (or I guess technically <a href=\"https://hackage.haskell.org/package/text-1.2.0.4/docs/Data-Text.html#v:unpack\" rel=\"nofollow noreferrer\"><code>unpack</code></a><code>. toText</code>) from the <code>System.FilePath.Rules</code> module.  The trick is, you need to use a <code>Rules</code> object to specify the platform flavor the string should be in.  (Oh, dfeuer beat me to this realization an hour ago.  But my comment is more singsongy, innit?)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513432071, "post_id": 47842961, "comment_id": 82656633, "body": "@luqui, there&#39;s also an <code>IsString</code> instance."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513497282, "post_id": 47842961, "comment_id": 82670627, "body": "I&#39;d still like to know whether it is possible to turn off escaping generally. If the definitive answer is NO, some explanation or a link to authoritative source is welcome."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513538870, "post_id": 47842961, "comment_id": 82681816, "body": "@AlexeyOrlov Perhaps you had better open a fresh question with the details of what you mean by &quot;turn off escaping&quot;, especially if other folks&#39; comments here aren&#39;t sufficient; they seem like they should be to me, so you need to post some clarifying details about what&#39;s wrong with the proposed alternatives to <code>show</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 0, "last_activity_date": 1513403549, "creation_date": 1513403549, "answer_id": 47842961, "question_id": 47842808, "link": "https://stackoverflow.com/questions/47842808/haskell-unsolicited-unicode-character-escaping-in-i-o/47842961#47842961", "title": "Haskell: unsolicited unicode character escaping in i/o", "body": "<p>The substring <code>\"\\\\8211\"</code> is produced by <code>show</code> (in <code>let parts = splitOn \"\\\"\" (show path)</code>), not by <code>realpath</code>. Probably you should just delete the call to <code>show</code>, though it's not 100% clear what you wanted the tracing code to do.</p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 47842961, "answer_count": 1, "score": 0, "last_activity_date": 1513412275, "creation_date": 1513402098, "last_edit_date": 1513412275, "question_id": 47842808, "link": "https://stackoverflow.com/questions/47842808/haskell-unsolicited-unicode-character-escaping-in-i-o", "title": "Haskell: unsolicited unicode character escaping in i/o", "body": "<p>I've got a CLI utility for copying files, basically.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n...\nimport Turtle\n...\n{- Command line parser -}\n-- | Represents command line options.\ndata Settings = Settings\n  { sVerbose           :: Bool\n...\n  , sSrc               :: FilePath\n  , sDst               :: FilePath\n  }\n...\n</code></pre>\n\n<p>Tracing code:</p>\n\n<pre><code>...\n-- | Extracts String From FilePath (unsafe and unofficial).\n-- No double quotes allowed in paths.\nstrp :: FilePath -&gt; String\nstrp path =\n  let parts = splitOn \"\\\"\" (show path)\n in  parts !! 1\n...\n  putStrLn \"\u041d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c \u044e\u043d\u0438\u043a\u043e\u0434\"\n  putStrLn $ strp (sSrc args)\n  putStrLn $ strp src\n...\n</code></pre>\n\n<p>Working code:</p>\n\n<pre><code>...\nsrc         &lt;- realpath (sSrc args)\n...\n</code></pre>\n\n<p>Console input for <code>sSrc</code> is actually <code>.</code></p>\n\n<p>Console output:</p>\n\n<pre><code>\u041d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c \u044e\u043d\u0438\u043a\u043e\u0434\n./\n/home/alexey/common/Downloads/UpDown/Books/Audio/_Nonfiction_/Moral Combat \\8211 Good and Evil in World War II [Unabridged]/\n 1/26 /home/alexey/dir-dst/Moral Combat \\\\8211 Good and Evil in World War II [Unabridged]/01-Moral Combat \\\\8211 Part 01.mp3\n</code></pre>\n\n<p><code>\\8211</code> is some kind of dash. The escaped path is produced by <code>realpath</code> right out of the <code>.</code>. I don't know the reason why. Is it the particular i/o library? Is it compiler options? The only thing so far that wouldn't escape unicode characters is <code>putStrLn</code>.</p>\n\n<p>I want the original path intact.</p>\n\n<p>UPD:</p>\n\n<p><a href=\"https://github.com/Gabriel439/Haskell-Turtle-Library/issues/97\" rel=\"nofollow noreferrer\">Make it easy to extract a file path as Text from a FilePath</a></p>\n\n<p>The hack now looks prettier:</p>\n\n<pre><code>import qualified Filesystem.Path.CurrentOS as FPS\nimport Data.Either.Extra\n...\n-- | Extracts String From FilePath\n-- (good until deprecated system-filepath removed).\nstrp :: FilePath -&gt; String\nstrp path = T.unpack $ fromRight \"\" (FPS.toText path)\n</code></pre>\n\n<p>And it works, for the time being. Still, I like the idea of mandatory escaping not at all. <code>show</code> and <code>print</code> are very helpful generally, and often rendered useless by escaping. No way to turn this off?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1513374846, "post_id": 47840355, "comment_id": 82644861, "body": "Use a <code>let file = ...</code> line inside the <code>do</code> instead. <code>where</code> can not access the bindings like <code>fileName</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1513374879, "post_id": 47840355, "comment_id": 82644881, "body": "You may also like <a href=\"https://hackage.haskell.org/package/filepath-1.4.1.2/docs/System-FilePath-Posix.html#v:-60-.-62-\" rel=\"nofollow noreferrer\">(&lt;.&gt;)</a>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1513382567, "post_id": 47840355, "comment_id": 82646850, "body": "I think it would be a really nice feature if a <code>where</code> clause could be used in this way with a <code>do</code> block. As it is I sometimes need to choose between creating a big <code>let</code> statement inline, or move a chunk of code into the <code>where</code> clause with a bunch of parameters which will just be bound to the same names and values in the <code>do</code> block. Both make the code more difficult to understand."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1513401241, "post_id": 47840355, "comment_id": 82649561, "body": "@jberryman yeah I have that same experience.  Though there are a bunch of difficult questions in the corner cases, which, when I put on my language design hat, I have no idea how to answer."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 9, "last_activity_date": 1513374841, "creation_date": 1513374841, "answer_id": 47840369, "question_id": 47840355, "link": "https://stackoverflow.com/questions/47840355/using-where-statements-in-do-notation/47840369#47840369", "title": "Using where statements in do notation", "body": "<p><code>where</code>, no. <code>let</code>, yes:</p>\n\n<pre><code>x = do\n  putStrLn \"Enter file name\"\n  fileName  &lt;- getLine\n  putStrLn \"Enter file extension\"\n  fileExt   &lt;- getLine\n  let file = fileName ++ \".\" ++ fileExt\n  doIO file\n  doSomeMoreIO file\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513375635, "creation_date": 1513375635, "answer_id": 47840498, "question_id": 47840355, "link": "https://stackoverflow.com/questions/47840355/using-where-statements-in-do-notation/47840498#47840498", "title": "Using where statements in do notation", "body": "<p><code>let</code> is the most straightforward way, but another option may be to use a separate function:</p>\n\n<pre><code>x = do\n  putStrLn \"Enter file name\"\n  fileName  &lt;- getLine\n  putStrLn \"Enter file extension\"\n  fileExt   &lt;- getLine\n  doFileIO $ fileName ++ \".\" ++ fileExt\n  where\n     doFileIO file = do\n        doIO file\n        doSomeMoreIO file\n</code></pre>\n\n<p>Depending on specific circumstances, this option may be preferable due to increased readability.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1513375635, "creation_date": 1513374748, "question_id": 47840355, "link": "https://stackoverflow.com/questions/47840355/using-where-statements-in-do-notation", "title": "Using where statements in do notation", "body": "<p>Is there some way to use where statements in do notation without inconveniences:</p>\n\n<pre><code>x = do\n  putStrLn \"Enter file name\"\n  fileName  &lt;- getLine\n  putStrLn \"Enter file extension\"\n  fileExt   &lt;- getLine\n  doIO $ fileName ++ \".\" ++ fileExt\n  doSomeMoreIO $ fileName ++ \".\" ++ fileExt\n</code></pre>\n\n<p>It would be nice to have <code>where file = fileName ++ \".\" ++ fileExt</code>. Is there some way to do it?</p>\n\n<p>I guess one way would be to have <code>file &lt;- return $ fileName ++ \".\" ++ fileExt</code>, but this feels kind of weird, because I'm mixing business logic with convenience of writing.</p>\n"}, {"tags": ["haskell", "arguments"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1513367517, "post_id": 47838986, "comment_id": 82641966, "body": "function call is the highest precedence operator hence..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1513368815, "post_id": 47838986, "comment_id": 82642432, "body": "<code>map</code> is applied to <code>Just</code> and <code>ys</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1513369429, "post_id": 47838986, "comment_id": 82642664, "body": "It&#39;s <code>(map Just ys) ++ (replicate k Nothing)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 1, "creation_date": 1513374693, "post_id": 47839460, "comment_id": 82644797, "body": "I feel compelled to add: ++ is an operator and takes arguments just like a function, too, but - as infix operator - with very low precedence."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1513369790, "creation_date": 1513369790, "answer_id": 47839460, "question_id": 47838986, "link": "https://stackoverflow.com/questions/47838986/haskell-which-parameters-in-this-function/47839460#47839460", "title": "Haskell - Which parameters in this function?", "body": "<p>Function application binds quite tightly:</p>\n\n<pre><code>map Just ys ++ replicate k Nothing\n</code></pre>\n\n<p>parses as:</p>\n\n<pre><code>(map Just ys) ++ (replicate k Nothing)\n</code></pre>\n\n<p>That is, the function is the constructor <code>Just</code> and the container/list is <code>ys</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513370316, "creation_date": 1513370316, "answer_id": 47839568, "question_id": 47838986, "link": "https://stackoverflow.com/questions/47838986/haskell-which-parameters-in-this-function/47839568#47839568", "title": "Haskell - Which parameters in this function?", "body": "<p>In this case, you can figure it out by considering the type:</p>\n\n<pre><code>Prelude&gt; pad n ys = map Just ys ++ replicate n Nothing\nPrelude&gt; :t pad\npad :: Int -&gt; [a] -&gt; [Maybe a]\n\nPrelude&gt; pad n ys = map Just (ys ++ replicate n Nothing)\nPrelude&gt; :t pad\npad :: Int -&gt; [Maybe a] -&gt; [Maybe (Maybe a)]\n\nPrelude&gt; pad n ys = (map Just ys) ++ (replicate n Nothing)\nPrelude&gt; :t pad\npad :: Int -&gt; [a] -&gt; [Maybe a]\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 8906596, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10207778167811470/picture?type=large", "display_name": "Adrien Varet", "link": "https://stackoverflow.com/users/8906596/adrien-varet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513370316, "creation_date": 1513367218, "last_edit_date": 1513368688, "question_id": 47838986, "link": "https://stackoverflow.com/questions/47838986/haskell-which-parameters-in-this-function", "title": "Haskell - Which parameters in this function?", "body": "<p>can someone tell me the two parameters applied to map in this function, or add parenthesis to this please ? </p>\n\n<pre><code>pad n ys = map Just ys ++ replicate k Nothing\n    where k = n - (length ys `mod` n)\n</code></pre>\n\n<p>Thanks !</p>\n"}, {"tags": ["haskell", "yesod", "bytestring"], "answers": [{"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 9, "last_activity_date": 1513370387, "last_edit_date": 1513370387, "creation_date": 1513363158, "answer_id": 47838114, "question_id": 47838113, "link": "https://stackoverflow.com/questions/47838113/why-cant-i-return-a-bytestring-from-a-handler-in-yesod/47838114#47838114", "title": "Why can&#39;t I return a ByteString from a Handler in Yesod?", "body": "<p>The <code>ToTypedContent</code> class describes what the <code>content-type</code> is of the data. So types that have an associated content type (e.g. UTF 8 for <code>Text</code> or <code>Value</code> (JSON)) can have a natural <code>ToTypedContent</code> instance.</p>\n\n<p>The problem with <code>ByteString</code> is that it describes any binary data\u2014your <code>ByteString</code> could be a PNG, a JPEG, or anything, so it's unclear what content type to give it.</p>\n\n<p>If you really just want to return binary data, the <code>octet-stream</code> content type is appropriate:</p>\n\n<pre><code>getHomeR :: Handler TypedContent\ngetHomeR = return $ TypedContent typeOctet $ toContent (\"x\" :: ByteString)\n</code></pre>\n\n<p>But you should try for a better content type if possible (e.g. <code>image/jpeg</code> for JPEG).</p>\n\n<p>In that case, you can either use the <code>TypedContent</code> manually as above, or write your own instance of <code>ToTypedContent</code> for a newtype over <code>ByteString</code></p>\n\n<pre><code>newtype Jpeg = Jpeg ByteString deriving (Show, ToContent)\n\ninstance ToTypedContent Jpeg where\n    toTypedContent h = TypedContent \"image/jpeg\" (toContent h)\n</code></pre>\n"}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 47838114, "answer_count": 1, "score": 5, "last_activity_date": 1513370387, "creation_date": 1513363158, "question_id": 47838113, "link": "https://stackoverflow.com/questions/47838113/why-cant-i-return-a-bytestring-from-a-handler-in-yesod", "title": "Why can&#39;t I return a ByteString from a Handler in Yesod?", "body": "<p>I'm trying to return a <code>ByteString</code> from my <code>Handler</code> function in Yesod:</p>\n\n<pre><code>getHomeR :: Handler ByteString\ngetHomeR = return \"foo\"\n</code></pre>\n\n<p>but I'm getting this error:</p>\n\n<pre><code>/Users/maximiliantagher/Documents/Mercury/hs/mercury-web-backend/src/Application.hs:48:1: error:\n    \u2022 No instance for (ToTypedContent ByteString)\n        arising from a use of \u2018yesodRunner\u2019\n    \u2022 In the expression:\n        yesodRunner getHomeR env1404_axwe (Just HomeR) req1404_axwf\n      In a case alternative:\n          \"GET\"\n            -&gt; yesodRunner getHomeR env1404_axwe (Just HomeR) req1404_axwf\n      In the expression:\n        case Network.Wai.Internal.requestMethod req1404_axwf of {\n          \"GET\"\n            -&gt; yesodRunner getHomeR env1404_axwe (Just HomeR) req1404_axwf\n          _ -&gt; yesodRunner\n                 (void badMethod) env1404_axwe (Just HomeR) req1404_axwf }\n</code></pre>\n\n<p>Why is this happening and why doesn't <code>ByteString</code> have a <code>ToTypedContent</code> instance?</p>\n"}, {"tags": ["haskell", "ffi"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513360746, "post_id": 47837516, "comment_id": 82638866, "body": "Why are you using the low level interface and not the higher level <code>Data.Vector.Storable.generate</code> and <code>(!)</code> (or <code>unsafeIndex</code>)?  It isn&#39;t necessary to use the pointers manually, we have an API for that."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513361191, "post_id": 47837516, "comment_id": 82639054, "body": "@ThomasM.DuBuisson Sorry I don&#39;t see what you mean. Why are you talking about indexing?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513361429, "post_id": 47837516, "comment_id": 82639156, "body": "I talk about the API you typically use to construct a vector, that API includes generate and index.  See my answer for a more idiomatic solution that doesn&#39;t use pointers explicitly."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513361722, "post_id": 47837516, "comment_id": 82639261, "body": "Nevermind, my brain must not be working right - I entirely missed the foreign import of <code>c_f</code> and what the actual problem is.   The function you want is likely <code>generateM</code> instead."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513361802, "post_id": 47837516, "comment_id": 82639299, "body": "@ThomasM.DuBuisson Ok :)"}], "answers": [{"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": true, "score": 1, "last_activity_date": 1513368389, "creation_date": 1513368389, "answer_id": 47839189, "question_id": 47837516, "link": "https://stackoverflow.com/questions/47837516/how-to-poke-two-vectors/47839189#47839189", "title": "How to poke two vectors?", "body": "<p>Simply:</p>\n\n<pre><code>f :: V.Vector CDouble -&gt; V.Vector CDouble -&gt; IO (V.Vector CDouble)\nf input1 input2 = do\n    fptr &lt;- mallocForeignPtrArray n\n    V.unsafeWith input1 $ \n      \\v1 -&gt; V.unsafeWith input2 $\n        \\v2 -&gt; withForeignPtr fptr $ c_f v1 v2 (fromIntegral n)\n    return $ V.unsafeFromForeignPtr0 fptr n\n  where n = V.length input\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 47839189, "answer_count": 1, "score": 1, "last_activity_date": 1513368389, "creation_date": 1513360477, "question_id": 47837516, "link": "https://stackoverflow.com/questions/47837516/how-to-poke-two-vectors", "title": "How to poke two vectors?", "body": "<p>I have a C function like this:</p>\n\n<pre><code>double* f(double* input, size_t n, double* result){\n  for(int i=0; i&lt;n; i++){\n    result[i] = ***something***\n  }\n  return result;\n}\n</code></pre>\n\n<p>I import it in Haskell like this (thanks to <a href=\"https://codereview.stackexchange.com/questions/176490/transform-a-vector-with-the-ffi-in-haskell\">@Zeta</a>):</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nimport qualified Data.Vector.Storable         as V\nimport           Foreign\nimport           Foreign.C.Types\n\nforeign import ccall unsafe \"f\" c_f :: Ptr CDouble -&gt; CSize -&gt; Ptr CDouble -&gt; IO (Ptr CDouble)\n\nf :: V.Vector CDouble -&gt; IO (V.Vector CDouble)\nf input = do\n    fptr &lt;- mallocForeignPtrArray n\n    V.unsafeWith input $\n      \\v -&gt; withForeignPtr fptr $ c_f v (fromIntegral n)\n    return $ V.unsafeFromForeignPtr0 fptr n\n  where n = V.length input\n</code></pre>\n\n<p>Very nice.</p>\n\n<p>But now I have a function taking two pointers as input:</p>\n\n<pre><code>double* f(double* input1, double* input2, size_t n, double* result){\n  for(int i=0; i&lt;n; i++){\n    result[i] = ***something***\n  }\n  return result;\n}\n</code></pre>\n\n<p>How can I import it to have <code>f :: V.Vector CDouble -&gt; V.Vector CDouble -&gt; IO (V.Vector CDouble)</code> ?</p>\n\n<p>Perhaps it's easy but I'm still not comfortable with <code>withForeignPtr</code>.</p>\n"}, {"tags": ["haskell", "functional-programming", "coq", "agda", "idris"], "comments": [{"owner": {"reputation": 6459, "user_id": 1955696, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/y94S4.jpg?s=128&g=1", "display_name": "ejgallego", "link": "https://stackoverflow.com/users/1955696/ejgallego"}, "edited": false, "score": 1, "creation_date": 1513364646, "post_id": 47837387, "comment_id": 82640609, "body": "IMHO you need to make your question more precise, in particular what are the conditions for you &quot;extraction&quot;. Obviously, if my calculus is inconsistent I can extract whatever I want by means of bottom-elimination."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 6459, "user_id": 1955696, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/y94S4.jpg?s=128&g=1", "display_name": "ejgallego", "link": "https://stackoverflow.com/users/1955696/ejgallego"}, "edited": false, "score": 0, "creation_date": 1513368927, "post_id": 47837387, "comment_id": 82642471, "body": "@ejgallego may be obvious to you, but it isn&#39;t to me! I&#39;ve made the question more precise as requested."}, {"owner": {"reputation": 6459, "user_id": 1955696, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/y94S4.jpg?s=128&g=1", "display_name": "ejgallego", "link": "https://stackoverflow.com/users/1955696/ejgallego"}, "edited": false, "score": 0, "creation_date": 1513371025, "post_id": 47837387, "comment_id": 82643319, "body": "Indeed the question is now more precise as you want extraction to recover the original term modulo the reduction rules. I didn&#39;t mean the question was obvious, but indeed that adding inconsistent axioms usually implies that you can define a trivial extraction function so one has to be careful with the exact definition."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1513531889, "post_id": 47840634, "comment_id": 82679708, "body": "Ah, insightful and answers the question. I wonder what kind of axiom is used to extract it, though. On Coq, it is possible, but I&#39;m not sure what is the logic behind it. But thanks for the answer, that&#39;s what I asked."}, {"owner": {"reputation": 20092, "user_id": 1633770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756c8a42111c3cb893e90cd17d115a36?s=128&d=identicon&r=PG", "display_name": "Arthur Azevedo De Amorim", "link": "https://stackoverflow.com/users/1633770/arthur-azevedo-de-amorim"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1513570329, "post_id": 47840634, "comment_id": 82688997, "body": "@MaiaVictor Added some more details."}], "tags": [], "owner": {"reputation": 20092, "user_id": 1633770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756c8a42111c3cb893e90cd17d115a36?s=128&d=identicon&r=PG", "display_name": "Arthur Azevedo De Amorim", "link": "https://stackoverflow.com/users/1633770/arthur-azevedo-de-amorim"}, "is_accepted": true, "score": 4, "last_activity_date": 1513572241, "last_edit_date": 1513572241, "creation_date": 1513376517, "answer_id": 47840634, "question_id": 47837387, "link": "https://stackoverflow.com/questions/47837387/is-it-possible-to-extract-the-second-element-of-sigma-on-the-calculus-of-constru/47840634#47840634", "title": "Is it possible to extract the second element of Sigma on the calculus of constructions with simple inconsistent axioms?", "body": "<p>In the context of a type theory such as Martin-L\u00f6f type theory or the Calculus of Constructions, by \"inconsistency\" we usually mean <em>logical inconsistency</em>: being able to derive a term <code>contra</code> of type <code>forall T : Type, T</code>.  In this case, any other type <code>T</code> becomes inhabited: it suffices to apply <code>contra</code> to it.</p>\n\n<p>Unfortunately, in most type theories, being inhabited tells us nothing about convertibility, or definitional equality, because there is no type expresses that two terms <code>x</code> and <code>y</code> are convertible.  This means \nthat there is no way of deriving terms</p>\n\n<pre><code>fst : Sigma A B -&gt; A\nsnd : forall s : Sigma A B, B (fst s)\n</code></pre>\n\n<p>such that <code>fst (Sigma _ _ x y)</code> simplifies to <code>x</code> and <code>snd (Sigma _ _ x y)</code>\n simplifies to <code>y</code> by appealing to a logical contradiction.  (I have abused notation a bit and used <code>Sigma</code> for both the constructor and the type.)  You can, however, use <code>contra</code> to postulate the existence of <code>fst</code> and <code>snd</code> and assert that the corresponding equations hold <em>propositionally</em>.</p>\n\n<p>In plain CoC, we say that two terms <code>x1</code> and <code>x2</code> are propositionally equal if there is a term of type</p>\n\n<pre><code>forall T, T x1 -&gt; T x2\n</code></pre>\n\n<p>(This is sometimes known as Leibniz equality: two terms are equal if every predicate that holds of the first one holds of the second one.)  Stating a similar for <code>snd</code> is somewhat more complicated, because <code>snd (Sigma _ _ x y)</code> and <code>y</code> do not have the same types (the former is of type <code>B (fst (Sigma _ _ x y))</code>, while the latter is of type <code>B x</code>).  We can remedy this by asserting simplification lemmas for <code>fst</code> and <code>snd</code> simultaneously:</p>\n\n<pre><code>forall (T : forall x : A, B x -&gt; Type),\n  T (fst (Sigma _ _ x y)) (snd (Sigma _ _ x y)) -&gt; \n  T x y\n</code></pre>\n\n<h1>Edit</h1>\n\n<p>Concerning your comment: since convertibility usually cannot be expressed with a type, we need to modify its definition in the type theory to have a true sigma type with first and second projections -- a more delicate operation than simply positing that certain axioms hold.  There are some systems that allow this, such as <a href=\"https://deducteam.github.io/\" rel=\"nofollow noreferrer\">Dedukti</a>, a proof checker developed at Inria.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 47840634, "answer_count": 1, "score": 3, "last_activity_date": 1513572241, "creation_date": 1513359861, "last_edit_date": 1513368901, "question_id": 47837387, "link": "https://stackoverflow.com/questions/47837387/is-it-possible-to-extract-the-second-element-of-sigma-on-the-calculus-of-constru", "title": "Is it possible to extract the second element of Sigma on the calculus of constructions with simple inconsistent axioms?", "body": "<p>It <a href=\"https://stackoverflow.com/questions/43957592/how-to-extract-the-second-element-of-sigma-on-the-calculus-of-constructions\">seems to be impossible</a> to extract the second element of Sigma on the Calculus of Constructions. Moreover, it seems like there is no known, simple way to extend the Calculus of Constructions with dependent eliminations without losing consistency. How can one, thus, exploit a simple <strong>but inconsistent</strong> axiom (such as <code>Type : Type</code> or unrestricted recursion such as <code>\u03bc</code>) to extract the second element of Sigma?</p>\n\n<p>That is, given the following Sigma constructor:</p>\n\n<pre><code>Sigma =\n  \u03bb A : *\n  \u03bb B : A -&gt; *\n  \u03bb a : A\n  \u03bb b : B\n  \u03bb Data : *\n  \u03bb Sigma :\n    \u2200 fst : A\n    \u2200 snd : B fst\n    Data\n  Sigma a b\n</code></pre>\n\n<p>In a language equivalent to the Calculus of Constructions, except with <code>Type : Type</code> or some other simple inconsistent axiom, is it possible to implement a function that, given a term such as <code>Sigma Nat (\\x -&gt; Nat) 3\u00a06</code>, extracts the second value, <code>6</code>?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 8, "creation_date": 1513353885, "post_id": 47835902, "comment_id": 82635384, "body": "I&#39;m confused: it&#39;s not."}, {"owner": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "edited": false, "score": 1, "creation_date": 1513353964, "post_id": 47835902, "comment_id": 82635436, "body": "Can you provide a self-contained example code, along with how you ran it and what output you find confusing?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1513354046, "post_id": 47835902, "comment_id": 82635484, "body": "What gave you the impression that it&#39;s equal to <code>(1:[]):[]</code>? It just isn&#39;t; actually this is interpreted as <code>1:([]:[])</code>, which is quite something different. (And not really well-typed.)"}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513354137, "post_id": 47835902, "comment_id": 82635533, "body": "@gallais: It can very well be that <i>I</i> am understanding that very wrong!"}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "reply_to_user": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "edited": false, "score": 0, "creation_date": 1513354232, "post_id": 47835902, "comment_id": 82635581, "body": "@Isaac: yes sure; I was trying to define my own list-partioning function and after several trials and errors got it working with part&#39;::[a] -&gt; [[a]] part&#39; [] = [[]] part&#39; (x:xs) = p ++ [x:ys | ys &lt;- p]     where p = part&#39; xs   Now my confusion comes from &#39;p ++ [x:ys | ys &lt;- p]&#39;, wouldn&#39;t that in the end be &#39;[[]] ++ x:[[]]&#39; ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1513354443, "post_id": 47835902, "comment_id": 82635723, "body": "<code>(1:[]):[]</code> is <code>[[1]] :: Num a =&gt; [[a]]</code>. Instead, <code>1:[[]]</code> is <code>[1,[]] :: Num [a] =&gt; [[a]]</code> which leads to a type error unless there is some <code>Num</code> instance for lists around."}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 0, "creation_date": 1513354455, "post_id": 47835902, "comment_id": 82635729, "body": "Oh and to leftaroundabout and isaac how I came to that conclusion; trying 1:[[]] or 1:([]:[]) in ghci just returns a type error"}, {"owner": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "edited": false, "score": 4, "creation_date": 1513354561, "post_id": 47835902, "comment_id": 82635789, "body": "Right, <code>1:[[]]</code> is a type error, and <code>(1:[]):[]</code> is not, so they cannot be the same... Maybe I&#39;m not sure what you&#39;re asking."}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "reply_to_user": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "edited": false, "score": 0, "creation_date": 1513354987, "post_id": 47835902, "comment_id": 82636054, "body": "@Isaac I edited with a concrete example, hopefully that clears up what I&#39;m confused about?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 0, "creation_date": 1513356513, "post_id": 47836568, "comment_id": 82636881, "body": "Does that mean, if e.g. <code>p=[1,2,3]</code> then <code>[1:ys | ys &lt;- p]</code> would be <code>1:1:2:3:[]</code> ? (Instead of <code>1:[1,2,3]</code>)"}, {"owner": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "reply_to_user": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 1, "creation_date": 1513356601, "post_id": 47836568, "comment_id": 82636925, "body": "No. Again, <code>ys</code> would stand in for each element of p in turn, so you&#39;d be trying to do <code>[1:1, 1:2, 1:3]</code>, which doesn&#39;t make sense. You&#39;d get a type error."}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 0, "creation_date": 1513357197, "post_id": 47836568, "comment_id": 82637211, "body": "Oh, I think I understood where my confusion came from; so basically <code>[1:ys | ys &lt;- [*[]*] ]</code> becomes <code>1: *[]*</code> where they then form an element of the &#39;inner layer&#39; list to make <code>[1]</code> because the empty item isn&#39;t shown in a non-empty list?"}, {"owner": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "reply_to_user": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 1, "creation_date": 1513360739, "post_id": 47836568, "comment_id": 82638864, "body": "I&#39;m not sure what you mean by &quot;the empty item is not shown;&quot; I think you may be misunderstanding how lists work in general. When you have <code>1:2:3:[]</code>, that list does <b>not contain</b> <code>[]</code>; <code>[]</code> simply represents the empty list, into which you&#39;re inserting those other elements. You can think of the <code>:</code> operator as saying &quot;put the element on my left inside the list on my right,&quot; and because it is right-associative you get <code>1:2:[] = 1:(2:([])) = 1:([2]) = [1,2]</code>. Does that make sense?"}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 0, "creation_date": 1513361845, "post_id": 47836568, "comment_id": 82639319, "body": "I&#39;m really sorry for all that inconvenience,...  I <i>thought</i> I understood how lists work, but I always thought the <code>:[]</code> in the end represented an empty list, as in a list that is empty including a placeholder <i>empty</i> element. And adding an element to an empty list would replace that <i>empty element</i> ... I don&#39;t know if that makes sense? - But yeah your example makes total sense."}, {"owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 0, "creation_date": 1513361944, "post_id": 47836568, "comment_id": 82639369, "body": "And so what I was trying to say is that since we add the &#39;1&#39; to the empty list, it would replace that placeholder empty element, and it doesn&#39;t show up ! (which wouldn&#39;t be the same as the empty liste we concatenate in the full example using ++)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "edited": false, "score": 3, "creation_date": 1513363451, "post_id": 47836568, "comment_id": 82640048, "body": "@user452306 there is no placeholder. An empty list is a list which is empty, it has no elements. Prepending (&quot;consing&quot;) an element like <i>1</i> to an empty list means creating new list which has <i>1</i> in it, and then all the elements of the previous list - which in this case is <i>no more elements</i>. So in all, the new list contains <i>1</i> as its only element. Or in Haskell <code>1 : [ ] = [ 1 ]</code>. This follows from the type of <code>(:)</code> operator: <code>(:) :: a -&gt; [ a ] -&gt; [ a ]</code>. I.e. it takes an element, and a list of similar elements, and creates a combined list of similar elements."}], "tags": [], "owner": {"reputation": 3536, "user_id": 1371116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e179a755e44f07873b2ccd75771123?s=128&d=identicon&r=PG", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1371116/isaac"}, "is_accepted": true, "score": 8, "last_activity_date": 1513356262, "creation_date": 1513356262, "answer_id": 47836568, "question_id": 47835902, "link": "https://stackoverflow.com/questions/47835902/why-is-1-equal-to-1/47836568#47836568", "title": "Why is 1:[[]] equal to (1:[]):[]?", "body": "<p>It seems like you're misunderstanding the <code>[... | ys &lt;- p]</code> syntax. In this case, <code>ys</code> is a stand-in for <em>each element</em> of the list <code>p</code>, not for the whole list. The equational reasoning in the last part of your question should be</p>\n\n<pre><code>part' [1] = (part' []) ++ [1:ys | ys &lt;- p]\n-- = [[]] ++ [1:ys | ys &lt;- [[]]]\n-- = [[]] ++ [1 : []]\n-- = [[], [1]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "is_accepted": false, "score": 2, "last_activity_date": 1513377579, "last_edit_date": 1513377579, "creation_date": 1513376136, "answer_id": 47840573, "question_id": 47835902, "link": "https://stackoverflow.com/questions/47835902/why-is-1-equal-to-1/47840573#47840573", "title": "Why is 1:[[]] equal to (1:[]):[]?", "body": "<p>The <code>[]</code> in Haskell can be quite confusing.</p>\n\n<p>The empty brackets <code>[]</code> by themselves are the constructor for an empty list. Usually this is explained by this alternative (isomorphic) list definition, where <code>[]</code> is called <code>Nil</code> and <code>:</code> is called <code>Cons</code>.</p>\n\n<pre><code>data List a\n  = Nil\n  | Cons a (List a)\n</code></pre>\n\n<p>Things don't exactly get easier when you consider that any <em>finite list</em> has <code>Nil</code> in the end. It's the only possible way to end the recursion, e.g.:</p>\n\n<pre><code>Cons 3 (Cons 4 (Cons 5 Nil))\n</code></pre>\n\n<p>or, equivalently:</p>\n\n<pre><code>3 : (4 : (5 : []))\n</code></pre>\n\n<p>Some confusion comes from this handy syntax, which expresses again the same:</p>\n\n<pre><code>[3, 4, 5]\n</code></pre>\n\n<p>Now someone might read <code>[]</code> as simply the <code>empty list</code> without any clue about <code>Cons</code> and <code>Nil</code>.</p>\n\n<p>Yet there's more: In type signatures, you encounter things like <code>[Int]</code> or <code>[a]</code> which means <code>List Int</code> or <code>List a</code>, thus the brackets - again - express an entirely different thing.</p>\n\n<p>There's the risk of a false intuition regarding the meaning of the brackets in Haskell and suddenly you have to think hard about the exact meaning of things like <code>[1]</code> and <code>[[1]]</code>, or <code>1:[]</code> and <code>(1:[]):[]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1513378672, "creation_date": 1513378672, "answer_id": 47840910, "question_id": 47835902, "link": "https://stackoverflow.com/questions/47835902/why-is-1-equal-to-1/47840910#47840910", "title": "Why is 1:[[]] equal to (1:[]):[]?", "body": "<p>Behold, the Lists:</p>\n\n<pre><code>[a,b,c] ++ [d,e,f] =\n[a,b] ++ [c,d,e,f] =\n[a] ++ [b,c,d,e,f] =\n[] ++ [a,b,c,d,e,f] =\na : [b,c,d,e,f] =\na : b : [c,d,e,f] =\na : b : c : [d,e,f] =\na : b : c : d : [e,f] =\na : b : c : d : e : [f] =\na : b : c : d : e : f : [] =\n[a,b,c,d,e,f] ++ [] =\n[a,b,c,d,e] ++ [f] =\n[a,b,c,d] ++ [e,f] =\n[a,b,c] ++ [d,e,f] \n</code></pre>\n\n<p>and list comprehensions:</p>\n\n<pre><code>[[a, 0] | a &lt;- [1,2,3]] =\n     [r | a &lt;- [1,2,3], r &lt;- [[a, 0]]] =\n            concatMap (\\a -&gt; [[a, 0]]) [1,2,3] =\n[[1, 0]] ++ [[2, 0]] ++ [[3, 0]] =\n[[1, 0],     [2, 0],     [3, 0]] \n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 8516144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0198a9c2725ebfde72f1b5538948d0ec?s=128&d=identicon&r=PG", "display_name": "user452306", "link": "https://stackoverflow.com/users/8516144/user452306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 47836568, "answer_count": 3, "score": 1, "last_activity_date": 1513532888, "creation_date": 1513353692, "last_edit_date": 1513532888, "question_id": 47835902, "link": "https://stackoverflow.com/questions/47835902/why-is-1-equal-to-1", "title": "Why is 1:[[]] equal to (1:[]):[]?", "body": "<p>As title says, I'm not fully grasping how haskell interprets </p>\n\n<pre><code>1:[[]]\n</code></pre>\n\n<p>Why does it seem to do<code>(1:[]):[]</code> ?</p>\n\n<p>E: I got this thought from:</p>\n\n<pre><code>part'::[a] -&gt; [[a]]\npart' [] = [[]]\npart' (x:xs) = p ++ [x:ys | ys &lt;- p]\n    where p = part' xs\n</code></pre>\n\n<p>Specifically from <code>p ++ [x:ys | ys &lt;- p]</code></p>\n\n<p>E.g. for <code>part'[1]</code>: is my train of thoughts correct ?:</p>\n\n<pre><code>part'[1] = (part'[]) ++ [1:ys | ys &lt;- part'[]]\n--&gt; = [[]] ++ [1:[[]]]\n</code></pre>\n\n<p>Hope this makes it clear.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1513359594, "post_id": 47835844, "comment_id": 82638341, "body": "Why this fascination with <code>unsafe</code> stuff? What are you actually trying to achieve?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513365271, "post_id": 47835844, "comment_id": 82640910, "body": "As others have said, none of this really makes much sense. You may find it interesting to check out the <code>Coercible</code> pseudo-class in <code>Data.Coerce</code>; that&#39;s some fairly powerful coercion machinery. There are some additional tools for working with it in <code>Data.Type.Coercion</code>. Note also <code>coerce</code>-related rewrite rules; the <code>containers</code> package has several good examples I wrote a few years ago. Unsafe coercions can (unfortunately) be useful with some type family-based constraints and also with rewrite rules that erase proofs."}, {"owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "edited": false, "score": 0, "creation_date": 1513399315, "post_id": 47835844, "comment_id": 82649260, "body": "I&#39;m trying to re-organize a lib&#39;s interface having many similar functions. I&#39;d like it to follow a bit more closely the spec and at the same time touch the surface as little as possible. (It might well be that the interface is best left intact.) I&#39;m actually relieved for the clear answer to not use unsafe-stuff."}], "answers": [{"comments": [{"owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "edited": false, "score": 0, "creation_date": 1513398716, "post_id": 47836595, "comment_id": 82649173, "body": "ok, this helps me to close one path. I&#39;m still trying out different ways to &quot;classify a function set&quot; (you answered a q couple of days ago that is related)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1513356376, "creation_date": 1513356376, "answer_id": 47836595, "question_id": 47835844, "link": "https://stackoverflow.com/questions/47835844/how-to-get-rid-of-possibly-superfluous-function-constraints/47836595#47836595", "title": "How to get rid of possibly superfluous function constraints?", "body": "<p>This is <em><strong>absolutely not</strong> a safe use</em> of <code>unsafeCoerce</code>. Basically, <code>f5</code> can by signature convert any two types into one another, provided each of them has an instance of certain classes. But knowing that doesn't tell you anything about the relation <em>between</em> the types <code>m</code> and <code>m1</code>. The only way this could be safe is if there is only one type with a <code>Hmm</code> instance &ndash; say, <code>Int</code> &ndash; because then it would effectively be just</p>\n\n<pre><code>f5 :: (m1 ~ Int, m ~ Int) =&gt; m -&gt; m1\n</code></pre>\n\n<p>aka</p>\n\n<pre><code>f5 :: Int -&gt; Int\nf5 = unsafeCoerce\n</code></pre>\n\n<p>...and that's in fact guaranteed to work, albeit obviously not very useful. But as soon as you add any other instance, say, <code>SHmm String</code>, you get a complete bogus &ldquo;conversion function&rdquo; between <code>Int</code> and <code>String</code>.</p>\n\n<p>Whether the classes <code>Hmm</code> and <code>SHmm</code> have any methods is irrelevant here, unless it's methods that only a type isomorphic to <a href=\"http://hackage.haskell.org/package/base/docs/Data-Void.html#t:Void\" rel=\"noreferrer\"><code>Void</code></a> can ever fulfill (in which case all these functions are safe, but also completely absurd).</p>\n\n<p>So, as <code>f5</code> and <code>f6</code> don't work to begin with, I don't know what to answer to the rest. I fail to see how any of this makes sense even on a conceptual level.</p>\n"}], "owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 47836595, "answer_count": 1, "score": 0, "last_activity_date": 1513356376, "creation_date": 1513353413, "question_id": 47835844, "link": "https://stackoverflow.com/questions/47835844/how-to-get-rid-of-possibly-superfluous-function-constraints", "title": "How to get rid of possibly superfluous function constraints?", "body": "<p>Let's us have two classes without any methods, the other being a sub-class. \nFurther, let's assume functions <code>f5</code> and <code>f6</code> that do <code>unsafeCoerce</code> from type to other. </p>\n\n<p>Now, ghci can compose those functions and find their signatures (with the help of ScopedTypeVariables), see <code>f56, f56b and f56'</code> below. \nThese are essentially functions having constraint <code>Hmm</code>. </p>\n\n<ol>\n<li><p>Is it possible to write <code>f56c</code>, that is, write it without\nreferring to class <code>SHmm</code> in the constraints? E.g. can ghci compile this \nwith the help of some language-pragma?</p></li>\n<li><p>What kind of danger there is in using <code>unsafeCoerce</code> when the\nclasses don't have any methods? (Or when the sub-class <code>SHmm</code>\ndoesn't have any methods?) Is there other way / recommended way to\nwrite <code>f5</code> and <code>f6</code>?</p></li>\n</ol>\n\n<p>And as a last one, in the code below <code>f5</code> and <code>f6</code> have their signatures so why it is not possible to just write <code>f56 = f5 . f6</code>? (Especially in the case when <code>SHmm</code> is empty, which is the reason it is so easy to think that constraint <code>SHmm</code> is not needed when writing <code>f56</code>.)</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, KindSignatures, MultiParamTypeClasses #-}\n{-# LANGUAGE RankNTypes, FlexibleInstances, FlexibleContexts #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n\nimport Unsafe.Coerce\n\nclass Hmm (f :: *)\nclass Hmm f =&gt; SHmm f\n\nf5 :: (Hmm m1, SHmm m) =&gt; m -&gt; m1\nf5 = unsafeCoerce\n\nf6 :: (Hmm m, SHmm m1) =&gt; m -&gt; m1\nf6 = unsafeCoerce\n\nf56 :: forall m1 m2 m3. (Hmm m3, Hmm m2, SHmm m1) =&gt; m3 -&gt; m2\nf56 = f5 . (f6 :: m3 -&gt; m1)\n\nf56b :: forall m1 m2. (Hmm m2, SHmm m1) =&gt; m2 -&gt; m2\nf56b = f5 . (f6 :: m2 -&gt; m1)\n\n-- f56c :: forall m2. Hmm m2 =&gt; m2 -&gt; m2\n-- f56c = f5 . (f6 :: SHmm m1 =&gt; m2 -&gt; m1)\n\nf56' :: forall m1 m2 m3. (Hmm m3, Hmm m2, SHmm m1) =&gt; m3 -&gt; m2\nf56' a = f5 $ (f6 :: m3 -&gt; m1) a\n</code></pre>\n"}, {"tags": ["haskell", "data-structures", "monads", "monadfix"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1513350235, "post_id": 47833188, "comment_id": 82633115, "body": "What would the <code>Monad (Tree m)</code> look like to begin with?"}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513350962, "post_id": 47833188, "comment_id": 82633561, "body": "See <a href=\"http://hackage.haskell.org/package/hedgehog-0.5.1/docs/Hedgehog-Internal-Tree.html#t:Tree\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hedgehog-0.5.1/docs/&hellip;</a> - this is the <code>Tree</code> I&#39;m trying to add <code>MonadFix</code> to."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1513352243, "post_id": 47833188, "comment_id": 82634364, "body": "Ok, <a href=\"https://gist.github.com/gallais/4c59b949c743c0a85cab55dcb73aaf7c\" rel=\"nofollow noreferrer\">I may have something for you</a> then. It is based on my understanding of <code>MonadFix []</code>: use <code>fix</code> on <code>f</code> to grab the shape of the top layer, and generate the subtrees by calling <code>mfix</code> recursively on the subpositions with a modified <code>f</code> that targets each position precisely. I&#39;m pretty confident that it does the right thing for <code>Tree Identity</code> however I&#39;m not convinced I&#39;m not forcing some <code>m</code> actions too early wrt what I infer is the <code>Tree m</code>&#39;s semantics."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513352808, "post_id": 47833188, "comment_id": 82634745, "body": "Very interesting, I&#39;ll give that a try and see what the behavior is."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513427059, "post_id": 47833188, "comment_id": 82655284, "body": "Unfortunately @gallais that doesn&#39;t seem quite right. I tried out your file and then ran: <code>nodeValue &lt;$&gt; runTree (mfix (const (return ()))</code>, which I believe should just be <code>()</code> (using <code>return</code> for <code>Tree</code> just creates a <code>Node</code> with a value and no children). In fact, it actually just blows the stack with a stack overflow exception (how appropriate)."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513427611, "post_id": 47833188, "comment_id": 82655446, "body": "It indeed doesn&#39;t work with <code>m</code> equal to <code>IO</code> but I tested it with <code>Identity</code> or <code>State Int</code> and it seems to be working out. I wonder what&#39;s special about <code>IO</code> (or whether we can find other failing examples)."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1513428231, "post_id": 47833188, "comment_id": 82655600, "body": "@gallais I think this is the fix: <a href=\"https://gist.github.com/ocharles/9b6fb71669de4533373a9c7f1f3ce8f9\" rel=\"nofollow noreferrer\">gist.github.com/ocharles/9b6fb71669de4533373a9c7f1f3ce8f9</a>. You need to <code>mfix</code> rather <code>fix</code>, and hence <code>m</code> must also be <code>MonadFix</code>. That at least satisfies my above example in <code>IO</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513466707, "post_id": 47833188, "comment_id": 82666122, "body": "This type smells a lot like <code>FreeT []</code>. Is it? If so, and if the instance you give is valid, under what circumstances can <code>FreeT f m</code> have a valid <code>MonadFix</code> instance?"}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513469200, "post_id": 47833188, "comment_id": 82666572, "body": "@dfeuer more like CofreeT [], no?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1513472491, "post_id": 47833188, "comment_id": 82667095, "body": "@ocharles, ah, yes, I mixed sums with products. Please apply my question to the type I should have meant!"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1517610481, "post_id": 47833188, "comment_id": 84180755, "body": "@ocharles since you have the solution, mind posting it as an answer and accepting it?"}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1517829680, "post_id": 47833188, "comment_id": 84239240, "body": "@sclv done, thanks for the reminder."}], "answers": [{"tags": [], "owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "is_accepted": true, "score": 2, "last_activity_date": 1517829663, "creation_date": 1517829663, "answer_id": 48621472, "question_id": 47833188, "link": "https://stackoverflow.com/questions/47833188/can-a-monadic-rose-tree-have-a-monadfix-instance/48621472#48621472", "title": "Can a monadic rose tree have a MonadFix instance?", "body": "<p>The real solution really comes from <a href=\"https://stackoverflow.com/users/727667/gallais\" title=\"gallais\">gallais</a> with a small modification. We lifted the core idea out into the <code>containers</code> library too, with <code>MonadFix Tree</code> instance <a href=\"https://hackage.haskell.org/package/containers-0.5.11.0/docs/src/Data.Tree.html#line-182\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nmodule MonadTree where\n\nimport Control.Monad\nimport Control.Monad.Fix\n\nnewtype Tree m a = Tree { runTree :: m (Node m a) }\n  deriving (Functor)\n\ndata Node m a = Node\n  { nodeValue :: a\n  , nodeChildren :: [Tree m a]\n  } deriving (Functor)\n\nvalueM :: Functor m =&gt; Tree m a -&gt; m a\nvalueM = fmap nodeValue . runTree\n\nchildrenM :: Functor m =&gt; Tree m a -&gt; m [Tree m a]\nchildrenM = fmap nodeChildren . runTree\n\njoinTree :: Monad m =&gt; m (Tree m a) -&gt; Tree m a\njoinTree = Tree . join . fmap runTree\n\ninstance Monad m =&gt; Applicative (Tree m) where\n  pure a = Tree $ pure $ Node a []\n  (&lt;*&gt;)  = ap\ninstance Monad m =&gt; Monad (Tree m) where\n  return = pure\n  m &gt;&gt;= k =\n    Tree $ do\n      Node x xs &lt;- runTree m\n      Node y ys &lt;- runTree (k x)\n      pure . Node y $\n        fmap (&gt;&gt;= k) xs ++ ys\n\ninstance MonadFix m =&gt; MonadFix (Tree m) where\n  mfix f = Tree $ do\n    node &lt;- mfix $ \\a -&gt; do\n      runTree (f (nodeValue a))\n    let value = nodeValue node\n    let trees = nodeChildren node\n    let children = zipWith (\\ k _ -&gt; mfix (joinTree . fmap (!! k) . childrenM . f)) [0..] trees\n    return $ Node value children\n</code></pre>\n"}], "owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 2, "accepted_answer_id": 48621472, "answer_count": 1, "score": 13, "last_activity_date": 1517829663, "creation_date": 1513343809, "question_id": 47833188, "link": "https://stackoverflow.com/questions/47833188/can-a-monadic-rose-tree-have-a-monadfix-instance", "title": "Can a monadic rose tree have a MonadFix instance?", "body": "<p>Given </p>\n\n<pre><code>newtype Tree m a = Tree { runTree :: m (Node m a) }\ndata Node m a = Node\n  { nodeValue :: a\n  , nodeChildren :: [Tree m a] \n  }\n</code></pre>\n\n<p>Is there a valid <code>MonadFix</code> instance?</p>\n\n<p>My attempt was</p>\n\n<pre><code>instance MonadFix m =&gt; MonadFix (Tree m) where\n  mfix f = Tree $ do\n    Node\n      &lt;$&gt; mfix (runTree . f . nodeValue) \n      &lt;*&gt; fmap nodeChildren (runTree (mfix f))\n</code></pre>\n\n<p>Yet this doesn't seem to terminate when I actually try and use it. The instance is somewhat inspired by the <code>MonadFix</code> instance for lists.</p>\n"}, {"tags": ["haskell", "testing", "doctest"], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1513343080, "creation_date": 1513343080, "question_id": 47832998, "link": "https://stackoverflow.com/questions/47832998/only-doctests-on-immediate-module", "title": "Only doctests on immediate module", "body": "<p>If I have three modules:</p>\n\n<pre><code>-- A.hs\nmodule A where\n-- $\n-- &gt;&gt;&gt; True\n-- True\n\n-- B.hs\nmodule B where\nimport A\n-- $\n-- &gt;&gt;&gt; True\n-- True\n\n-- C.hs\nmodule C where\nimport B\n-- $\n-- &gt;&gt;&gt; True\n-- True\n</code></pre>\n\n<p>Running <code>doctest C.hs</code> will run all the doctests in all three files.</p>\n\n<pre><code>$ doctest C.hs\nExamples: 3  Tried: 3  Errors: 0  Failures: 0\n</code></pre>\n\n<p>Is there a way to run <code>doctest</code> on only the top-level module - that is, have it not recursively search for tests in included modules?</p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513353424, "post_id": 47832502, "comment_id": 82635109, "body": "Are you sure you have exactly <code>.|.</code> in your file (i.e. <code>&quot;\\46\\124\\46&quot;</code>), and not perhaps some strange non-ASCII lookalike? Also, make sure all your files are UTF-8 encoded. (<a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">Always</a>!)"}, {"owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513360373, "post_id": 47832502, "comment_id": 82638720, "body": "Yes, there is exactly byte sequence \\46\\124\\46 in the file on that line. Also everywhere else where it should be. And it&#39;s already UTF-8 encoded."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1513362183, "post_id": 47832502, "comment_id": 82639495, "body": "Then I really wonder how this strange <code>&#226;\\200\\230,&#226;\\200\\231</code> can creep in. Are those perhaps terminal escape codes which have somehow been mangled to plaintext? What terminal are you using? \u2014 Generally, it would of course also be useful to post a full configuration file, i.e. a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513404124, "post_id": 47832502, "comment_id": 82649981, "body": "I concur with @leftaroundabout. Keep deleting unrelated lines until you get down to as small a file as possible. Then post the file along with the output of running <code>xxd</code> on the file (or similar)."}, {"owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513448477, "post_id": 47832502, "comment_id": 82661702, "body": "I went straight to absolute minimal one, still no luck. I updated question with gist link to that minimal config. @leftaroundabout I am using gnome-terminal on one machine and xfce4-terminal on another. I tried editing config file with vim and VS Code."}, {"owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1513448492, "post_id": 47832502, "comment_id": 82661708, "body": "@DanielWagner I added xxd output is in the gist comments"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1513448814, "post_id": 47832502, "comment_id": 82661824, "body": "Oh, lol, &#226;\\200\\230 and &#226;\\200\\231 is your terminal not printing forward and backward single quotes correctly. The complaint is about the <i>comma</i>, not the pipe. This has to be included as part of a keybindings section, it can&#39;t just go anywhere..."}, {"owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "edited": false, "score": 0, "creation_date": 1513453249, "post_id": 47832502, "comment_id": 82663012, "body": "I was simply recompiling using xmonad restart keybind. I will use <code>~ $ xmonad --recompile</code> from now."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513455357, "post_id": 47832502, "comment_id": 82663582, "body": "...and better figure out what&#39;s wrong with your terminal, this would drive me crazy. What does a simple bash command like <code>echo \u201cfoobar\u201d</code> yield? Perhaps this is a font issue?"}, {"owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "edited": false, "score": 0, "creation_date": 1513459788, "post_id": 47832502, "comment_id": 82664769, "body": "Terminal works correctly, as I said above I was recompiling by restart keybind, so I only saw some weird error message window (probably some generic X stuff, cant tell, I have never seen this). When I try compile it with <code>~$ xmonad --recompile</code> terminal command, the error is printed correctly in terminal window."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "edited": false, "score": 0, "creation_date": 1513452924, "post_id": 47848784, "comment_id": 82662915, "body": "Thanks, the <code>Graphics.X11.ExtraTypes.XorgDefault</code> helped, now the &quot;more compact&quot; style workspace keybind works perfectly.  However, I can&#39;t compile your example above. When I add <code>import qualified Data.Map as M</code> to minimal config I get 3 errors:  <code>Couldn&#39;t match expected type \u2018M.Map (ButtonMask, KeySym) (X ())\u2019 with actual type \u2018XConfig Layout -&gt; M.Map (ButtonMask, KeySym) (X ())\u2019</code> and  <code>Couldn&#39;t match type \u2018XConfig l0 -&gt; KeyMask\u2019 with \u2018Foreign.C.Types.CUInt\u2019 </code> which is repeated."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "edited": false, "score": 1, "creation_date": 1513454861, "post_id": 47848784, "comment_id": 82663443, "body": "@Lyarenei Oops, yes, I forgot to bind <code>modMask</code>, so it&#39;s getting the record selector instead of the value from <code>conf</code>. You can change <code>\\conf -&gt; keys conf</code> to <code>\\conf@(XConfig { modMask = modMask }) -&gt; keys def conf</code> to fix that. Probably. (Sorry, I don&#39;t have xmonad installed on this machine to test for sure.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "edited": false, "score": 0, "creation_date": 1513733183, "post_id": 47848784, "comment_id": 82761952, "body": "(Future readers can ignore my previous comment: I have modified the answer to include the correction posted in it.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1513733158, "last_edit_date": 1513733158, "creation_date": 1513449027, "answer_id": 47848784, "question_id": 47832502, "link": "https://stackoverflow.com/questions/47832502/how-to-rebind-workspace-switching-to-accented-keys-in-xmonad/47848784#47848784", "title": "How to rebind workspace switching to accented keys in xmonad?", "body": "<p>In your minimal config,</p>\n\n<pre><code>import XMonad\nimport qualified XMonad.StackSet as W\n\n--bind xK_plus to workspace 1\n    , ((0 .|. modMask, xK_plus), windows $ W.greedyView \"1\")\n    , ((shiftMask .|. modMask, xK_plus), windows $ W.shift \"1\")\n\nmain = xmonad def\n    { terminal    = \"gnome-terminal\"\n    }\n</code></pre>\n\n<p>...you have bare keybindings in the middle of your file. Those have to appear as part of a keybindings list; the commas are list element separators. So:</p>\n\n<pre><code>main = xmonad def\n    { terminal    = \"gnome-terminal\"\n    , keys        = \\conf@(XConfig { modMask = modMask }) -&gt; keys def conf `mappend` M.fromList\n        [ ((0 .|. modMask, xK_plus), windows $ W.greedyView \"1\")\n        , ((shiftMask .|. modMask, xK_plus), windows $ W.shift \"1\")\n        ]\n    }\n</code></pre>\n\n<p>(Or similar.)</p>\n\n<p>For your other question, <code>xK_ecaron</code> is available from <code>Graphics.X11.ExtraTypes.XorgDefault</code>. You can see a list of all available keysyms (and which module to import to get them) <a href=\"http://hackage.haskell.org/package/X11-1.8/docs/doc-index-X.html\" rel=\"nofollow noreferrer\">here</a>, or you can search for a specific one <a href=\"http://hoogle.haskell.org/?hoogle=xK_ecaron\" rel=\"nofollow noreferrer\">on Hoogle</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7837466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae28e66a286492f8909129754abb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Lyarenei", "link": "https://stackoverflow.com/users/7837466/lyarenei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 47848784, "answer_count": 1, "score": 0, "last_activity_date": 1513733158, "creation_date": 1513341096, "last_edit_date": 1592644375, "question_id": 47832502, "link": "https://stackoverflow.com/questions/47832502/how-to-rebind-workspace-switching-to-accented-keys-in-xmonad", "title": "How to rebind workspace switching to accented keys in xmonad?", "body": "<p>I recently decided to switch from i3wm to xmonad. I found <a href=\"https://github.com/vicfryzel/xmonad-config\" rel=\"nofollow noreferrer\">this configuration</a> and decided to try it out. The config works without any problem straight out of the box.</p>\n<p>The problem is, I cannot switch desktop workspaces, because I don't use english keyboard layout. I have accented characters instead of numbers under F-key row.</p>\n<p>So I searched for xK_ names for these keys and put them in to config file like this:</p>\n<pre><code>[((m .|. modMask, k), windows $ f i)\n    | (i, k) &lt;- zip (XMonad.workspaces conf) [xK_plus, xK_ecaron, xK_scaron, xK_ccaron, xK_rcaron, xK_zcaron, xK_yacute, xK_aacute, xK_iacute]\n    , (f, m) &lt;- [(W.greedyView, 0), (W.shift, shiftMask)]]\n</code></pre>\n<p>However, this didn't work. So I tried to bind at least one key (according to <a href=\"https://unix.stackexchange.com/a/68709\">this answer</a>) to see if that will at least work (with that code above commented out):</p>\n<pre><code>    , ((0 .|. modMask, xK_plus), windows $ W.greedyView &quot;1&quot;)\n    , ((shiftMask .|. modMask, xK_plus), windows $ W.shift &quot;1&quot;)\n</code></pre>\n<p>But it didn't. In both cases, the error message was:</p>\n<blockquote>\n<p>xmonad.hs:292:9: parse error on input \u00e2\\200\\230,\u00e2\\200\\231</p>\n</blockquote>\n<p>Which refers to this line: <code>    , ((0 .|. modMask, xK_plus), windows $ W.greedyView &quot;1&quot;)</code>, specifically to <code>|</code> if I am not mistaken.</p>\n<p>When I try</p>\n<pre><code>[((m .|. modMask, k), windows $ f i)\n    | (i, k) &lt;- zip (XMonad.workspaces conf) [xK_1, xK_2, xK_3, xK_4, xK_5, xK_6, xK_7, xK_8, xK_9]\n    , (f, m) &lt;- [(W.greedyView, 0), (W.shift, shiftMask)]]\n</code></pre>\n<p>It goes without any problems, however, when I try</p>\n<pre><code>    , ((0 .|. modMask, xK_1), windows $ W.greedyView &quot;1&quot;)\n    , ((shiftMask .|. modMask, xK_1), windows $ W.shift &quot;1&quot;)\n</code></pre>\n<p>The same error is thrown.</p>\n<p>I am using Czech QWERTY layout and xmonad 0.12.</p>\n<p>Could you please tell me what am I doing wrong? Thanks.</p>\n<p>Edit:</p>\n<p><a href=\"https://gist.github.com/lyarenei/e5d40214efe37a4334b6cc5a041d372f\" rel=\"nofollow noreferrer\">Here</a> is minimal config file.</p>\n<p>I also made some progress when I was trying my luck with another machine. With</p>\n<pre><code>[((m .|. modMask, k), windows $ f i)\n    | (i, k) &lt;- zip (XMonad.workspaces conf) [xK_plus, xK_ecaron, xK_scaron, xK_ccaron, xK_rcaron, xK_zcaron, xK_yacute, xK_aacute, xK_iacute]\n    , (f, m) &lt;- [(W.greedyView, 0), (W.shift, shiftMask)]]\n</code></pre>\n<p>I got different error message which said (for all caron keys):</p>\n<blockquote>\n<p>Not in scope: \u00e2\\200\\230xK_ecaron\u00e2\\200\\231</p>\n<p>Perhaps you meant \u00e2\\200\\230xK_macron\u00e2\\200\\231 (imported from XMonad)</p>\n</blockquote>\n<p>As the suggested solution is totally different key, I simply proceeded to remove all xK_~caron and it surprisingly compiled. Now I am able to switch workspaces, but switching to 2nd workspace with <code>\u00fd</code> key which is 7th in the row is kinda strange.</p>\n<p>Now i don't understand why aren't caron keys accepted as xK_ecaron is totally valid key:</p>\n<pre><code>~ $ cat /usr/include/X11/keysymdef.h |grep ecaron\n#define XK_ecaron                        0x01ec  /* U+011B LATIN SMALL LETTER E WITH CARON */\n</code></pre>\n"}, {"tags": ["haskell", "emacs"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1513337940, "post_id": 47831582, "comment_id": 82625925, "body": "If you define a multi-line function in an interactive shell, you have to use <code>:{</code> and <code>:}</code> or other measures."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1513341271, "post_id": 47831582, "comment_id": 82627839, "body": "Write your code in a .hs file, and load all of it from GHCi (or compile it)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513353313, "post_id": 47831582, "comment_id": 82635033, "body": "I voted to close as &quot;unclear&quot; because the issue is omitted.  Between &quot;the code:&quot; and &quot;the error:&quot; should be &quot;I ran:&quot; and what you ran is undoubtably the issue since the code is fine."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 7, "last_activity_date": 1546515643, "last_edit_date": 1546515643, "creation_date": 1513584710, "answer_id": 47864344, "question_id": 47831582, "link": "https://stackoverflow.com/questions/47831582/haskell-error-variable-not-in-scope/47864344#47864344", "title": "Haskell error variable not in scope", "body": "<p>I see you are defining your function in interactive shell. Most of Haskell's REPLs read and eval instructions line-by-line, so when you type <code>potencia :: Integer -&gt; Integer -&gt; Integer</code> it is interpreted <strong>right at this moment</strong>, so compiler complains that potencia is lacking implementation. You should either:</p>\n\n<ul>\n<li>Define it in external file and load it using <code>:l</code> (recommended)</li>\n<li>Type <code>:set +m</code> and use <code>let</code> statement to define variable with respect to indentation </li>\n<li>Surround your definition with <code>:{</code> and <code>:}</code></li>\n<li>Put whole definition and declaration in one line separating each part with <code>;</code></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 9103326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecf4ace65db2cadae9d359929a0f36f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel V&#225;zquez Caraballo", "link": "https://stackoverflow.com/users/9103326/miguel-v%c3%a1zquez-caraballo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14642, "favorite_count": 3, "answer_count": 1, "score": 3, "last_activity_date": 1546515643, "creation_date": 1513337840, "last_edit_date": 1513347065, "question_id": 47831582, "link": "https://stackoverflow.com/questions/47831582/haskell-error-variable-not-in-scope", "title": "Haskell error variable not in scope", "body": "<p>I have programmed a really basic recursive function, but when I try to use it Haskell gives me an error.</p>\n\n<p>This is the code: </p>\n\n<pre><code>import Data.Char\nimport Test.QuickCheck\npotencia :: Integer -&gt; Integer -&gt; Integer\npotencia x 0 = 1\npotencia x n = x*(potencia x (n-1))\n</code></pre>\n\n<p>And this is the error:</p>\n\n<pre><code>&lt;interactive&gt;:27:1-8: error:\n    Variable not in scope: potencia :: Integer -&gt; Integer -&gt; t\n</code></pre>\n\n<p>If I delete the import of libreries it doesn\u00b4t give me the error anymore but I need them for later. I`m using the last update of haskell platform and the emacs editor.\nThanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 6105, "user_id": 212676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd65ca1abdc609150206045c8a9c13a?s=128&d=identicon&r=PG", "display_name": "N3dst4", "link": "https://stackoverflow.com/users/212676/n3dst4"}, "edited": false, "score": 0, "creation_date": 1513336989, "post_id": 47831349, "comment_id": 82625367, "body": "I&#39;m 99% sure I have an AB problem here but I can&#39;t see what the B is :)"}], "answers": [{"comments": [{"owner": {"reputation": 6105, "user_id": 212676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd65ca1abdc609150206045c8a9c13a?s=128&d=identicon&r=PG", "display_name": "N3dst4", "link": "https://stackoverflow.com/users/212676/n3dst4"}, "edited": false, "score": 0, "creation_date": 1513369012, "post_id": 47834745, "comment_id": 82642497, "body": "Ah, Data.Proxy is great. I ended up with <code>Arbitrary (a Int), Show (a Int), Eq (a Int)</code> in my constraints to get QuickCheck going, but apart from that it&#39;s perfect."}], "tags": [], "owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "is_accepted": true, "score": 3, "last_activity_date": 1513349977, "last_edit_date": 1513349977, "creation_date": 1513349437, "answer_id": 47834745, "question_id": 47831349, "link": "https://stackoverflow.com/questions/47831349/type-constructor-as-argument-to-expression/47834745#47834745", "title": "Type constructor as argument to expression", "body": "<p>What you could do is to explicitly pass the desired type to <code>testFunctorness</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Proxy\n\ntestFunctorness :: forall a. Functor a =&gt; Proxy a -&gt; IO ()\ntestFunctorness _ =\n  hspec $ do\n    describe \"the type\" $ do\n      it \"should obey functor identity\" $ do\n        property (functorIdentity :: a Int -&gt; Bool)\n      it \"should obey functor composition\" $ do\n        property\n          (functorComposition :: (Fun Int String) -&gt; (Fun String Int) -&gt; a Int -&gt; Bool)\n</code></pre>\n\n<p>The call would look like <code>testFunctorness (Proxy :: Proxy [])</code>.</p>\n\n<p>You will need to enable <code>{-# LANGUAGE ScopedTypeVariables #-}</code> so that the <code>a</code> inside the function refers to the <code>a</code> in the type signature. The <code>forall</code> is then needed to let the typechecker know this <code>a</code> should be lexically scoped.</p>\n"}], "owner": {"reputation": 6105, "user_id": 212676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd65ca1abdc609150206045c8a9c13a?s=128&d=identicon&r=PG", "display_name": "N3dst4", "link": "https://stackoverflow.com/users/212676/n3dst4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 47834745, "answer_count": 1, "score": 2, "last_activity_date": 1513617361, "creation_date": 1513336934, "last_edit_date": 1513617361, "question_id": 47831349, "link": "https://stackoverflow.com/questions/47831349/type-constructor-as-argument-to-expression", "title": "Type constructor as argument to expression", "body": "<p>I'm using hspec and QuickCheck to validate functor laws for instances of Functor. I have functions </p>\n\n<pre><code>functorIdentity :: (Functor f, Eq (f a)) =&gt; f a -&gt; Bool\n</code></pre>\n\n<p>and</p>\n\n<pre><code>functorComposition :: (Functor f, Eq (f c)) =&gt; (Fun a b) -&gt; (Fun b c) -&gt; f a -&gt; Bool\n</code></pre>\n\n<p>I'm then testing these two using blocks of code like this:</p>\n\n<pre><code>testListFunctorness :: IO ()\ntestListFunctorness =\n  hspec $ do\n    describe \"list\" $ do\n      it \"should obey functor identity\" $ do\n        property (functorIdentity :: [Int] -&gt; Bool)\n      it \"should obey functor composition\" $ do\n        property\n          (functorComposition :: (Fun Int String) -&gt; (Fun String Int) -&gt; [Int] -&gt; Bool)\n</code></pre>\n\n<p>The thing is, to test the same properties for a different Functor instance, I need to copy everything except the <code>[Int]</code>s:</p>\n\n<pre><code>testMaybeFunctorness :: IO ()\ntestMaybeFunctorness =\n  hspec $ do\n    describe \"maybe\" $ do\n      it \"should obey functor identity\" $ do\n        property (functorIdentity :: Maybe Int -&gt; Bool)\n      it \"should obey functor composition\" $ do\n        property\n          (functorComposition :: (Fun Int String) -&gt; (Fun String Int) -&gt; Maybe Int -&gt; Bool)\n</code></pre>\n\n<p>It feels like I should be able to write an expression which is in some way polymorphic over different <code>Functor</code> instances, but I can't even think how to begin that.</p>\n\n<p>How can I conveniently reuse that block of test logic for multiple different <code>Functor</code>s?</p>\n"}, {"tags": ["haskell", "random"], "answers": [{"comments": [{"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 1, "creation_date": 1513345112, "post_id": 47831399, "comment_id": 82629984, "body": "Thank you for the detailed answer, I didn&#39;t even know you could access the source!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1513337113, "creation_date": 1513337113, "answer_id": 47831399, "question_id": 47830807, "link": "https://stackoverflow.com/questions/47830807/does-randomio-from-system-random-ever-produce-0/47831399#47831399", "title": "Does randomIO (from System.Random) ever produce 0?", "body": "<p><strong>Short answer</strong>: the range is <strong>[0, 1)</strong>.</p>\n\n<p>Yes. The implementation of <code>Random</code> for a <code>Float</code> is <a href=\"http://hackage.haskell.org/package/random-1.1/docs/src/System-Random.html\" rel=\"noreferrer\">[source]</a>:</p>\n\n<pre><code>instance Random Float where\n  randomR = randomRFloating\n  random rng = \n    -- TODO: Faster to just use 'next' IF it generates enough bits of randomness.   \n    case random rng of \n      (x,rng') -&gt; \n          -- We use 24 bits of randomness corresponding to the 24 bit significand:\n          ((fromIntegral (mask24 .&amp;. (x::Int32)) :: Float) \n       /  fromIntegral twoto24, rng')\n     -- Note, encodeFloat is another option, but I'm not seeing slightly\n     --  worse performance with the following [2011.06.25]:\n--         (encodeFloat rand (-24), rng')\n   where\n     mask24 = twoto24 - 1\n     twoto24 = (2::Int32) ^ (24::Int32)\n</code></pre>\n\n<p>It uses a random 32-bit integer <code>x</code> (where zero is a possible value), it masks out the first 8 bits, and divides that value by <em>2<sup>24</sup></em>. As a result the range is 0 (included) to 1 (excluded). The largest value it can represent is <code>0.999999940395</code>. </p>\n\n<p>The reason it works that way is because a <code>Float</code> has a 24-bit mantisse (as well as 7-bit exponent and a sign bit). By transforming it in that range, we guarantee that every <code>Float</code> value is equally probable: the last 24 bits are first copied into the mantisse of the <code>Float</code>, then the float is normalized, and the exponent altered such that the values are in the [0, 1) range.</p>\n"}], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "accepted_answer_id": 47831399, "answer_count": 1, "score": 5, "last_activity_date": 1513346035, "creation_date": 1513335181, "last_edit_date": 1513346035, "question_id": 47830807, "link": "https://stackoverflow.com/questions/47830807/does-randomio-from-system-random-ever-produce-0", "title": "Does randomIO (from System.Random) ever produce 0?", "body": "<p>I understand that <code>randomIO::IO Float</code> produces uniformly distributed <code>Float</code> numbers, but my question is in what range? Is it <code>[0,1]</code>, <code>(0,1)</code> or anything in between (<code>[0,1)</code> or <code>(0,1]</code>)?</p>\n\n<p>I couldn't find anything about it on <a href=\"https://hackage.haskell.org/package/random-1.1/docs/System-Random.html\" rel=\"nofollow noreferrer\">hackage</a>, and the referenced paper is behind a paywall.</p>\n\n<p>The reason I'm asking is because you might want to transform the random number, and if you want to evaluate <code>1/myRandomNumber</code> it would be helpful to know whether you will ever run into <code>Infinity</code> or not.</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>import System.Random\nmain=(randomIO::IO Float)&gt;&gt;=print\n</code></pre>\n\n<p><a href=\"https://tio.run/##y0gszk7Nyfn/PzO3IL@oRCG4srgkNVcvKDEvJT@XKzcxM89WowjM8fS3svL0V3DLyU8s0bSzsy0oyswr@f8fAA\" rel=\"nofollow noreferrer\" title=\"Haskell \u2013 Try It Online\">Try it online!</a></p>\n"}, {"tags": ["haskell", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1513331475, "post_id": 47829007, "comment_id": 82621912, "body": "If you&#39;re explicitly using <code>WriterT</code> and <code>State</code> in order to learn, then that may make sense, but otherwise, that particular puzzle can be solved with <code>unfoldr</code> and <code>zip</code>. FWIW, here&#39;s my solution: <a href=\"https://github.com/ploeh/advent-of-code-2017/blob/master/Day15/Solution.hs\" rel=\"nofollow noreferrer\">github.com/ploeh/advent-of-code-2017/blob/master/Day15/&hellip;</a>"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1513331802, "post_id": 47829007, "comment_id": 82622119, "body": "If I didn&#39;t know any better, I&#39;d suspect it&#39;s to do with <code>generate</code> rather than anything about the writer monad. But, really, I guess you need to actually <i>profile</i> it to find out where it&#39;s really taking the space..."}, {"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1513346352, "post_id": 47829007, "comment_id": 82630710, "body": "@MathematicalOrchid you are right that generate shows up heavy.  Do you have suggestions to make it lighter?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1513347904, "post_id": 47829007, "comment_id": 82631605, "body": "@bdecaf Making the fields of <code>Generator</code> strict would be my first guess, off the top of my head..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1513370489, "post_id": 47829007, "comment_id": 82643105, "body": "For a longer discussion on the way in which writer is lazy see <a href=\"https://blog.infinitenegativeutility.com/2016/7/writer-monads-and-space-leaks\" rel=\"nofollow noreferrer\">blog.infinitenegativeutility.com/2016/7/&hellip;</a>"}, {"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1513431978, "post_id": 47829007, "comment_id": 82656604, "body": "@ThomasM.DuBuisson thanks that hit the spot. I was just blindly expecting strictness is what I need."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1513420779, "last_edit_date": 1513420779, "creation_date": 1513369123, "answer_id": 47839335, "question_id": 47829007, "link": "https://stackoverflow.com/questions/47829007/why-do-i-need-so-much-memory-for-writert-state/47839335#47839335", "title": "Why do I need so much memory for WriterT State?", "body": "<p>The cause is likely to be the <code>WriterT</code> layer.</p>\n\n<p>Even the \"strict\" <code>WriterT</code> is <em>completely lazy</em> in the accumulator \u2014it is strict in another sense unrelated to the accumulator.</p>\n\n<p>For example, this program runs without errors:</p>\n\n<pre><code>import Data.Monoid\nimport Control.Monad.Trans.Writer\nimport Control.Exception\n\nmain :: IO ()\nmain = do\n  let (x,_) = runWriter $ do\n        tell $ Sum (1::Float)\n        tell (throw $ AssertionFailed \"oops\")\n        tell (error \"oops\")\n        tell undefined\n        tell (let z = z in z)\n        return True\n  print x\n</code></pre>\n\n<p>Furthermore, it is impossible to \"strictify\" the accumulator from within <code>WriterT</code>, because there's no way to get to it.</p>\n\n<p>For long computations, thunks will accumulate and consume a lot of memory.</p>\n\n<p>One solution is to store the counter in a <code>StateT</code> layer instead. The strict <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-State-Lazy.html#v:modify-39-\" rel=\"nofollow noreferrer\"><code>modify'</code></a> function is helpful here.</p>\n\n<hr>\n\n<p>Using <code>StateT</code> for an append-only accumulator is a bit unsatisfactory though. Another option is to use <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Accum.html#t:Accum\" rel=\"nofollow noreferrer\"><code>Accum</code></a> with judiciously positioned <code>BangPatterns</code>. This program throws an error:</p>\n\n<pre><code>import Control.Monad.Trans.Accum\n\nmain :: IO ()\nmain = do\n  let (x,_) = flip runAccum mempty $ do\n        add $ Sum (1::Float)\n        add $ error \"oops\"\n        !_ &lt;- look\n        return True\n  print x\n</code></pre>\n\n<p><code>Accum</code> is like a <code>Writer</code> that lets you access the accumulator. It doesn't let you change it at will, only add to it. But getting hold of it is enough to introduce strictness.</p>\n"}], "owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 47839335, "answer_count": 1, "score": 0, "last_activity_date": 1513420779, "creation_date": 1513328921, "last_edit_date": 1513353223, "question_id": 47829007, "link": "https://stackoverflow.com/questions/47829007/why-do-i-need-so-much-memory-for-writert-state", "title": "Why do I need so much memory for WriterT State?", "body": "<p>Trying to get to grips with the concepts I am trying to solve an exercise in Haskell using WriterT and State (it's <a href=\"http://adventofcode.com/2017/day/15\" rel=\"nofollow noreferrer\">advent of code day 15</a>).  For some reason I do not understand I end up using loads of memory and my notebook (just 4G Ram) comes to a halt.</p>\n\n<p>My first idea was to use strictness and sprinkle bangs around - but the issue persists.</p>\n\n<p>Could someone explain me where I did go wrong?</p>\n\n<p>Here's cleaned up code:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nmodule Main where\nimport Control.Monad.State.Strict\nimport Control.Monad.Writer.Strict\n\nmain = do\n  let generators = (Generator 65 16807, Generator 8921 48271)\n      res1 = compute generators (4*10^7) \n  putStrLn \"Answer 1\"\n  print res1\n\ndata Generator = Generator { _value :: Int\n                           , _factor :: Int\n                           }\n    deriving Show\n\nnewtype Value = Value Int\n  deriving (Show, Eq)\n\nnewtype Counter = Counter Int\n  deriving (Show, Eq)\n\ninstance Monoid Counter where\n  mempty = Counter 0\n  mappend (Counter !a) (Counter !b) = Counter (a+b)\n\ngenerate :: Generator -&gt; (Value, Generator)\ngenerate (Generator v f) = (Value newval, Generator newval f)\n  where newval = (v * f) `mod` 2147483647\n\nagree (Value a) (Value b) = (a `mod` mf) == (b `mod` mf)\n  where mf = 2^16\n\noneComp :: State (Generator, Generator) Bool\noneComp = do\n  (!ga, !gb) &lt;- get\n  let (va, gan) = generate ga\n      (vb, gbn) = generate gb\n      !ag = agree va vb\n  put (gan, gbn)\n  pure ag\n\ncounterStep :: WriterT Counter (State (Generator, Generator)) ()\ncounterStep = do\n  !ag &lt;- lift oneComp\n  when ag $ tell (Counter 1)\n\nafterN :: Int -&gt; WriterT Counter (State (Generator, Generator)) ()\nafterN n = replicateM_ n counterStep\n\ncompute s0 n = evalState (execWriterT (afterN n)) s0\n</code></pre>\n\n<p>I compile it with stack. The entry in the cabal file is:</p>\n\n<pre><code>executable day15\n  hs-source-dirs:      app\n  main-is:             day15.hs\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N \n  build-depends:       base\n                     , advent\n                     , hspec\n                     , mtl\n  default-language:    Haskell2010\n</code></pre>\n\n<p><strong>update</strong></p>\n\n<p>I had a little more time and followed the suggestion to make Generator strict.  However still something is using too much memory.</p>\n\n<p>Here's the part of the prof file that I think may be relevant.</p>\n\n<pre><code>            Fri Dec 15 16:28 2017 Time and Allocation Profiling Report  (Final)\n\n       day15 +RTS -N -p -RTS\n\n    total time  =       71.66 secs   (71662 ticks @ 1000 us, 1 processor)\n    total alloc = 17,600,423,088 bytes  (excludes profiling overheads)\n\nCOST CENTRE    MODULE    SRC                          %time %alloc\n\nafterN         Main      app/day15.hs:79:1-36          41.1   20.0\nmappend        Main      app/day15.hs:51:3-51          31.0    3.6\noneComp        Main      app/day15.hs:(64,1)-(71,9)     9.2   49.1\ngenerate.(...) Main      app/day15.hs:55:9-42           8.5   14.5\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 8780296, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/500900040263704/picture?type=large", "display_name": "Vitas", "link": "https://stackoverflow.com/users/8780296/vitas"}, "is_accepted": false, "score": 0, "last_activity_date": 1513319369, "creation_date": 1513319369, "answer_id": 47826955, "question_id": 47826685, "link": "https://stackoverflow.com/questions/47826685/haskell-using-frominteger-a-div-b-1-a-b-as-guard/47826955#47826955", "title": "Haskell: using (fromInteger (a `div` b) / 1 == a / b) as guard?", "body": "<p>i found a solution!</p>\n\n<pre><code>gCF :: Integer -&gt; Integer -&gt; Integer;\ngCF n p\n    | (p &lt;= 0 || n &lt;= 0) = error \"Input should be positive\"\n    | (p &gt; n) = floor (f (fromInteger p) (fromInteger n) (fromInteger n))\n    | otherwise = floor (f (fromInteger n) (fromInteger p) (fromInteger p))\n    where \n        f :: Float -&gt; Float -&gt; Float -&gt; Float;\n        f a b c\n            | (fromInteger (floor (a / c)) == a / c) &amp;&amp; (fromInteger (floor (b / c)) == b / c) = c\n            | otherwise = f a b (c - 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1513330136, "creation_date": 1513330136, "answer_id": 47829320, "question_id": 47826685, "link": "https://stackoverflow.com/questions/47826685/haskell-using-frominteger-a-div-b-1-a-b-as-guard/47829320#47829320", "title": "Haskell: using (fromInteger (a `div` b) / 1 == a / b) as guard?", "body": "<p>I think you make it the function more complex that necessary. Converting numbers between the <code>Int</code>eger and <code>Float</code>ing world can be dangerous, since it introduces rounding problems.</p>\n\n<p>If I understand it correctly, you want to check if <code>a</code> is dividable by <code>b</code>. You can check this by verifying that <code>mod a b == 0</code>, and we are still in the integer worlds. So we can rewrite the program to:</p>\n\n<pre><code>gCF :: Integer -&gt; Integer -&gt; Integer\ngCF n p | p &lt;= 0 || n &lt;= 0 = error \"Input should be positive\"\n        | p &gt; n = f p n\n        | otherwise = f n p\n    where f a b | mod a b == 0 = b\n                | otherwise = f a (b-1)\n</code></pre>\n\n<p>Since <code>a</code> does not change in the recursive calls, we can factor that out:</p>\n\n<pre><code>gCF :: Integer -&gt; Integer -&gt; Integer\ngCF n p | p &lt;= 0 || n &lt;= 0 = error \"Input should be positive\"\n        | otherwise = f (min p n)\n    where a = max p n\n          f b | mod a b == 0 = b\n              | otherwise = f (b-1)\n</code></pre>\n\n<p>We can also generalize the signature to let it work with any <code>Integral</code> type:</p>\n\n<pre><code>gCF :: Integral i =&gt; i -&gt; i -&gt; i\ngCF n p | p &lt;= 0 || n &lt;= 0 = error \"Input should be positive\"\n        | otherwise = f (min p n)\n    where a = max p n\n          f b | mod a b == 0 = b\n              | otherwise = f (b-1)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 8780296, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/500900040263704/picture?type=large", "display_name": "Vitas", "link": "https://stackoverflow.com/users/8780296/vitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1513337529, "creation_date": 1513317906, "last_edit_date": 1513337529, "question_id": 47826685, "link": "https://stackoverflow.com/questions/47826685/haskell-using-frominteger-a-div-b-1-a-b-as-guard", "title": "Haskell: using (fromInteger (a `div` b) / 1 == a / b) as guard?", "body": "<p>I'm new to Haskell and i don't understand why my guard won't accept it. here's my code. The guard should fire in case <code>b</code> is a divider of <code>a</code>.</p>\n\n<pre><code>gCF :: Integer -&gt; Integer -&gt; Integer;\ngCF n p\n    | (p &lt;= 0 || n &lt;= 0) = error \"Input should be positive\"\n    | (p &gt; n) = f p n\n    | otherwise = f n p\n    where \n        f :: Integer -&gt; Integer -&gt; Integer;\n        f a b\n            | (fromInteger (a `div` b) / 1 == a / b) = b\n            | otherwise = f a (b - 1)\n</code></pre>\n\n<p>Here's the error shown.</p>\n\n<pre><code>testscript.hs:168:28: error:\n\u2022 No instance for (Fractional Integer) arising from a use of \u2018/\u2019\n\u2022 In the first argument of \u2018(==)\u2019, namely\n    \u2018fromInteger (a `div` b) / 1\u2019\n  In the expression: (fromInteger (a `div` b) / 1 == a / b)\n  In a stmt of a pattern guard for\n                 an equation for \u2018f\u2019:\n    (fromInteger (a `div` b) / 1 == a / b)\n    |\n168 |                         | (fromInteger (a `div` b) / 1 == a / b) =      b     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "polymorphism"], "comments": [{"owner": {"reputation": 1159, "user_id": 3953988, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/803352198cc6f048e409a07eefa19d7b?s=128&d=identicon&r=PG", "display_name": "Rahul Manne", "link": "https://stackoverflow.com/users/3953988/rahul-manne"}, "edited": false, "score": 0, "creation_date": 1513297177, "post_id": 47823931, "comment_id": 82610820, "body": "I think you&#39;d have to leave it as a universal. (eg: getRoot :: a -&gt; b, or more explicitly, getRoot :: forall b. a -&gt; b). Unless you know that the data type itself takes a typevariable, you can&#39;t really know the internal type. So you don&#39;t really have a choice but to just make &quot;b&quot; universally quantified."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1513308057, "post_id": 47823931, "comment_id": 82613125, "body": "Independent of answering this question, it is worth pushing back a bit. Why do you want a type class at all? I suspect you are bringing another language&#39;s idioms with you as you learn a new language. If you try to continue that way, you will be fighting the language the whole way."}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "is_accepted": false, "score": 1, "last_activity_date": 1513429708, "last_edit_date": 1513429708, "creation_date": 1513297520, "answer_id": 47824144, "question_id": 47823931, "link": "https://stackoverflow.com/questions/47823931/haskell-class-with-instance-of-polymorph-data-definition/47824144#47824144", "title": "Haskell class with instance of polymorph data definition", "body": "<p>First things first, keep in mind that your <code>BTree</code> is a type with kind <code>* -&gt; *</code>, which basically means it needs another type as argument to be created - your <code>a</code>. Because of that, having the type variable of your class called <code>a</code> as well can lead to confusion. Let's exchange that for <code>outer</code> to put it more clearly.</p>\n\n<p>You'd then have:</p>\n\n<pre><code>class Tree outer where\n    getRoot :: ???\n</code></pre>\n\n<p>On to the quest of finding that function's type. Knowing that the tree-type needs another type, we know <code>getRoot</code> must be passed something like <code>BTree Int</code>, which would be <code>outer inner</code> in variables. You want the function to return something which has that inner type, so your class would be:</p>\n\n<pre><code>class Tree outer where\n    getRoot :: outer inner -&gt; inner\n</code></pre>\n\n<p>Now that makes sense! You pass a tree to that function, and it presents you something with that inner type. </p>\n\n<p>You'd then implement your instance as before:</p>\n\n<pre><code>instance Tree (BTree a) where\n    getRoot (BLeaf x)     = x\n    getRoot (BNode x _ _) = x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 6, "last_activity_date": 1513298072, "creation_date": 1513298072, "answer_id": 47824201, "question_id": 47823931, "link": "https://stackoverflow.com/questions/47823931/haskell-class-with-instance-of-polymorph-data-definition/47824201#47824201", "title": "Haskell class with instance of polymorph data definition", "body": "<p>Make the type variable in the <code>class Tree</code> declaration refer to a type constructor of kind <code>* -&gt; *</code>, and then you can refer to the type of the values of the tree in the type signature of <code>getRoot</code>.</p>\n\n<pre><code>class Tree t where\n    getRoot :: t a -&gt; a\n\ninstance Tree BTree where\n    getRoot (BLeaf a)     = a\n    getRoot (BNode a _ _) = a\n</code></pre>\n\n<p>Another, slightly more complex solution that allows the tree structure to be of kind <code>*</code> would be to use a <a href=\"https://wiki.haskell.org/Multi-parameter_type_class\" rel=\"noreferrer\">multi-parameter type class</a> along with <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"noreferrer\">functional dependencies</a>.</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies, FlexibleInstances #-}\n\nclass Tree t a | t -&gt; a where\n    getRoot :: t -&gt; a\n\ninstance Tree (BTree a) a where\n    getRoot (BLeaf a)     = a\n    getRoot (BNode a _ _) = a\n</code></pre>\n\n<p>Or you could use a <a href=\"https://wiki.haskell.org/Type_families\" rel=\"noreferrer\">type family</a>.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass Tree t where\n    type Value t\n    getRoot :: t -&gt; Value t\n\ninstance Tree (BTree a) where\n    type Value (BTree a) = a\n    getRoot (BLeaf a)     = a\n    getRoot (BNode a _ _) = a\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 7581695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10212338111949666/picture?type=large", "display_name": "Julian ", "link": "https://stackoverflow.com/users/7581695/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47824201, "answer_count": 2, "score": 1, "last_activity_date": 1513429708, "creation_date": 1513295944, "question_id": 47823931, "link": "https://stackoverflow.com/questions/47823931/haskell-class-with-instance-of-polymorph-data-definition", "title": "Haskell class with instance of polymorph data definition", "body": "<p>I have a question regarding class definition with polymorphic data types. Lets say the defined datatype is:</p>\n\n<pre><code>data BTree a = BLeaf a | BNode a (BTree a) (BTree a) deriving(Show)\n</code></pre>\n\n<p>Lets say I want to retrieve the value of the root of the tree, but within an instance of a class called Tree:</p>\n\n<pre><code>class Tree a where\n             getRoot:: a -&gt; (?)  --&lt;- Type of Leave value as return type\n</code></pre>\n\n<p>and an instance:</p>\n\n<pre><code>instance Tree (BTree a) where\n                        getRoot BLeaf a = a\n                        getRoot BNode a _ _ = a\n</code></pre>\n\n<p>I can't figure out the type of the function (see questionmark), since its not a and the class doesn't know the parameter of the instance.</p>\n"}, {"tags": ["haskell", "haskell-stack", "nix"], "answers": [{"tags": [], "owner": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "is_accepted": true, "score": 3, "last_activity_date": 1513306863, "creation_date": 1513306863, "answer_id": 47825202, "question_id": 47823825, "link": "https://stackoverflow.com/questions/47823825/missing-c-library-error-during-stack-build-with-nix/47825202#47825202", "title": "Missing C library error during stack build with nix", "body": "<p>You need to add <code>sqlite</code> to your packages section in <code>stack.yaml</code> as follows:</p>\n\n<pre><code>nix:\n  enable: false\n  packages:\n    - sqlite\n</code></pre>\n\n<p>The <code>enable: false</code> is there so that Stack doesn't try to build with Nix by default. If you want this behaviour, remove that line.</p>\n\n<p>There's an example of this <a href=\"https://github.com/gibiansky/IHaskell/blob/b0b5236d684757b021b58fcea3719a00b708831d/stack.yaml#L23-L35\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1959, "user_id": 2520530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MUfpY.jpg?s=128&g=1", "display_name": "Erik Cupal", "link": "https://stackoverflow.com/users/2520530/erik-cupal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 47825202, "answer_count": 1, "score": 0, "last_activity_date": 1513306863, "creation_date": 1513295179, "question_id": 47823825, "link": "https://stackoverflow.com/questions/47823825/missing-c-library-error-during-stack-build-with-nix", "title": "Missing C library error during stack build with nix", "body": "<p>In my project I'm using a library that depends on two C packages: <code>sqlite3</code> and <code>libsqlite3-dev</code>. I installed them using <code>apt-get install</code> and then build the project with <code>stack build</code> and everything works fine.</p>\n\n<p>However, the <code>stack build</code> fails when used with nix with error message \"* Missing C library: sqlite3\". I understand that the nix enviroment is isolated and that I have to install it there. I tried installing it using <code>nix-env -i sqlite3</code> but it returns <code>error: selector \u2018sqlite3\u2019 matches no derivations</code>. It looks it is missing in the channel (using nixpkgs-unstable).</p>\n\n<p>Is there any way how use to use C libraries with stack and nix that are missing in the channel?</p>\n\n<p>I am using nix because of a <a href=\"https://github.com/gibiansky/IHaskell/issues/741\" rel=\"nofollow noreferrer\">bug in IHaskell</a>, otherwise I would be fine with just stack.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513293370, "post_id": 47823512, "comment_id": 82609789, "body": "Are you sure you need <i>a polymorphic <code>TVar</code></i>? That seems a really daring approach... you certainly can&#39;t create one just with <code>newTVarIO</code>. What is the purpose of all this universally-quantified <code>Affection</code> anyway? If the <code>us</code> argument is completely phantom, this <i>might</i> be a use case for <code>unsafeCoerce</code>, but make sure you know very well why you want that foo at all."}, {"owner": {"reputation": 36, "user_id": 4366908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXY4B.png?s=128&g=1", "display_name": "nek0", "link": "https://stackoverflow.com/users/4366908/nek0"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513293535, "post_id": 47823512, "comment_id": 82609829, "body": "if you mean the <code>us</code> type parameter, then yes, I need it. This is the games&#39; state, which is supplied by the implementor of the game. <code>Affection</code> is the state transformer monad holding the state."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513293852, "post_id": 47823512, "comment_id": 82609923, "body": "But surely it will be sufficient to parameterise the <code>AffectionWindow</code> to a single value, at compile-time? Why don&#39;t you just use that parameter, but quantify a new one in the <code>windowSubscriber</code> field?"}, {"owner": {"reputation": 36, "user_id": 4366908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXY4B.png?s=128&g=1", "display_name": "nek0", "link": "https://stackoverflow.com/users/4366908/nek0"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513294759, "post_id": 47823512, "comment_id": 82610195, "body": "I just learned that I can omit the <code>us</code> paramater totally from the <code>AffectionWindow</code>, but the paramater stays in the subscriber function. I tried it out, but it still fails to compile. How do I tell the Compiler, that the type variable <code>us</code> equals <code>StateData</code> in the example application?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1513295276, "post_id": 47823512, "comment_id": 82610331, "body": "You <i>can&#39;t</i> tell the compiler that <code>us</code> equals anything particular, because the field <code>windowSubscribers :: \u2200 us. TVar [(UUID, WindowMessage -&gt; Affection us ())]</code> must by signature always contain a fully polymorphic value. Which is, I reckon, not really what you want though."}, {"owner": {"reputation": 36, "user_id": 4366908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXY4B.png?s=128&g=1", "display_name": "nek0", "link": "https://stackoverflow.com/users/4366908/nek0"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513295954, "post_id": 47823512, "comment_id": 82610502, "body": "You are right, This is not what I want."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513296194, "post_id": 47823512, "comment_id": 82610560, "body": "Well, why did you put in the universal quantifier then?"}, {"owner": {"reputation": 36, "user_id": 4366908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXY4B.png?s=128&g=1", "display_name": "nek0", "link": "https://stackoverflow.com/users/4366908/nek0"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513296543, "post_id": 47823512, "comment_id": 82610650, "body": "Because the compiler told me it needs it. I see that I made an error wit the whole <code>data AffectionWindow</code> business. I can&#39;t implement the type on the engine side, this is something the game implementation must do."}], "owner": {"reputation": 36, "user_id": 4366908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXY4B.png?s=128&g=1", "display_name": "nek0", "link": "https://stackoverflow.com/users/4366908/nek0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513293706, "creation_date": 1513293008, "last_edit_date": 1513293706, "question_id": 47823512, "link": "https://stackoverflow.com/questions/47823512/type-variable-error", "title": "Type variable error", "body": "<p>I am currently working on a game engine in Haskell and now I am trying to implement a messaging system between subsystems of this engine (I am using a Publisher-Subscriber pattern). You can check out the code as a whole at <a href=\"https://github.com/nek0/affection\" rel=\"nofollow noreferrer\">here on my github profile</a>. I implemented a \"Participant\" typeclass for all datatypes participating in my Messaging system as follows:</p>\n\n<pre><code>class (Show m, Message m) =&gt; Participant prt m where\n  -- | Function to get the lsit of subscribers from the participant\n  partSubscribers\n    :: prt\n    -- ^ the participant\n    -&gt; forall us. Affection us [(m -&gt; Affection us ())]\n    -- ^ List of Subscriber functions\n\n  -- | Subscribe to the 'Participant''s events\n  partSubscribe\n    :: prt\n    -- ^ The 'Participant' to subscribe to\n    -&gt; (forall us. m -&gt; Affection us ())\n    -- ^ What to do in case of a 'Message'\n    -- (Subscriber function)\n    -&gt; Affection us UUID\n    -- ^ 'UUID' of the registered subscriber Function\n\n  -- | Unsubscribe a Subscriber function from Participant\n  partUnSubscribe\n    :: prt             -- ^ The 'Participant' to unsubscribe from\n    -&gt; UUID            -- ^ The subscriber function's 'UUID'\n    -&gt; Affection us ()\n\n  -- | Get the 'Participant' to emit a 'Message' on all of its subscribers\n  partEmit\n    :: prt             -- ^ The 'Participant'\n    -&gt; m               -- ^ The 'Message' to emit\n    -&gt; Affection us ()\n  partEmit p m = do\n    liftIO $ logIO Debug $ \"Emitting message: \" ++ show m\n    l &lt;- partSubscribers p\n    mapM_ ($ m) l\n</code></pre>\n\n<p>A concrete implementation of this Typeclass looks like this. I'm making the use of the Package <code>stm</code>:</p>\n\n<pre><code>data AffectionWindow us = AffectionWindow\n  { windowSubscribers\n      :: forall us. TVar [(UUID, WindowMessage -&gt; Affection us ())]\n  }\n\ninstance Participant (AffectionWindow us) WindowMessage where\n  partSubscribe p funct = do\n    uuid &lt;- genUUID\n    liftIO $ atomically $ modifyTVar' (windowSubscribers p) ((uuid, funct) :)\n    return uuid\n\n  partUnSubscribe p uuid =\n    liftIO $ atomically $ modifyTVar' (windowSubscribers p)\n      (filter (\\(u, _) -&gt; u /= uuid))\n\n  partSubscribers p = do\n    subTups &lt;- liftIO $ readTVarIO $ windowSubscribers p\n    return $ map snd subTups\n</code></pre>\n\n<p>This code compiles fine as a library, but when I try to use this in a minimal example, it fails to compile. The code, where it fails looks like this:</p>\n\n<pre><code>load :: IO StateData\nload = do\n  empty1 &lt;- newTVarIO []\n  -- ([] :: [(UUID, WindowMessage -&gt; Affection StateData ())])\n  empty2 &lt;- newTVarIO []\n  -- ([] :: [(UUID, MouseMessage -&gt; Affection StateData ())])\n  empty3 &lt;- newTVarIO []\n  -- ([] :: [(UUID, KeyboardMessage -&gt; Affection StateData ())])\n  return $ StateData $ Subsystems\n    (AffectionWindow empty1)\n    (AffectionMouse empty2)\n    (AffectionKeyboard empty3)\n</code></pre>\n\n<p>and the error message is:</p>\n\n<pre><code>examples/example00.hs:43:22: error:\n    \u2022 Couldn't match type \u2018a0\u2019\n                     with \u2018(UUID, WindowMessage -&gt; Affection us1 ())\u2019\n        because type variable \u2018us1\u2019 would escape its scope\n      This (rigid, skolem) type variable is bound by\n        a type expected by the context:\n          forall us1. TVar [(UUID, WindowMessage -&gt; Affection us1 ())]\n        at examples/example00.hs:43:6-27\n      Expected type: TVar [(UUID, WindowMessage -&gt; Affection us1 ())]\n        Actual type: TVar [a0]\n    \u2022 In the first argument of \u2018AffectionWindow\u2019, namely \u2018empty1\u2019\n      In the first argument of \u2018Subsystems\u2019, namely\n        \u2018(AffectionWindow empty1)\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018Subsystems\n           (AffectionWindow empty1)\n           (AffectionMouse empty2)\n           (AffectionKeyboard empty3)\u2019\n    \u2022 Relevant bindings include\n        empty1 :: TVar [a0] (bound at examples/example00.hs:39:3)\n   |\n43 |     (AffectionWindow empty1)\n   |                      ^^^^^^\n</code></pre>\n\n<p>I have never encountered any error like this and I'm at my wits end.\nHopefully somebody in here knows the solution.</p>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 3, "creation_date": 1513291762, "post_id": 47823293, "comment_id": 82609304, "body": "If you add lens to your package.yaml then do <code>stack install</code>, it will automatically install the dependencies first, so if you sync it to another machine along with the package.yaml, it will always install lens if needed."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1513349129, "creation_date": 1513349129, "answer_id": 47834675, "question_id": 47823293, "link": "https://stackoverflow.com/questions/47823293/how-to-install-a-package-and-save-the-setting/47834675#47834675", "title": "How to install a package and save the setting?", "body": "<p>This has not been implemented yet in Stack.</p>\n\n<p>This is the relevant issue for it: <a href=\"https://github.com/commercialhaskell/stack/issues/1933\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/1933</a></p>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526334575, "creation_date": 1513291577, "last_edit_date": 1526334575, "question_id": 47823293, "link": "https://stackoverflow.com/questions/47823293/how-to-install-a-package-and-save-the-setting", "title": "How to install a package and save the setting?", "body": "<p>I created a new project using <code>stack</code>. </p>\n\n<pre><code>stack new myproj\n</code></pre>\n\n<p>I want to install a package <code>lens</code>. If I use the following command, the package will be installed, but it's not being added to <code>package.yml</code></p>\n\n<pre><code>stack install lens\n</code></pre>\n\n<p>The problem is that if I sync the code somewhere else, and run <code>stack install</code>, <code>lens</code> won't be installed.</p>\n\n<p>Is there something similar to what nodejs provides, like <code>npm install --save lens</code>, so that <code>stack install --save lens</code> will automatically add <code>lens</code> into <code>package.yml</code></p>\n"}, {"tags": ["haskell", "lambda", "functional-programming", "lambda-calculus"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1513291148, "creation_date": 1513291148, "answer_id": 47823201, "question_id": 47822874, "link": "https://stackoverflow.com/questions/47822874/scope-of-variables-in-lambda-calculus-haskell/47823201#47823201", "title": "Scope of variables in lambda calculus / haskell", "body": "<p>This question is basically unanswerable. It would be easy to define a concrete syntax with either proposed abstract syntax tree, and I don't really think there's such a strong convention one way or the other that you would want to assume one without seeing explicit text in the syntax definition for the document you were reading.</p>\n\n<p>Since this is explicitly tagged Haskell: in this specific case it is simply a parse error, and you are required to add parentheses to disambiguate. Without the first <code>\\x y z -&gt; x y z</code> function, though, the default would be to parse as <code>\\x y -&gt; (x (\\y z -&gt; z))</code>, and you would need to add parentheses to get the other option of <code>(\\x y -&gt; x) (\\y z -&gt; z)</code>. (The parentheses around <code>\\y z -&gt; z</code> are not optional.)</p>\n"}], "owner": {"reputation": 147, "user_id": 7581695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10212338111949666/picture?type=large", "display_name": "Julian ", "link": "https://stackoverflow.com/users/7581695/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 47823201, "answer_count": 1, "score": 0, "last_activity_date": 1513291148, "creation_date": 1513289560, "question_id": 47822874, "link": "https://stackoverflow.com/questions/47822874/scope-of-variables-in-lambda-calculus-haskell", "title": "Scope of variables in lambda calculus / haskell", "body": "<p>Given an expression like s := (\u03bbx, y, z.x y z) \u03bbx, y.x \u03bby, z.z, is the scope of the bound variables </p>\n\n<p>s := (\u03bbx, y, z.x y z) (\u03bbx, y.x) (\u03bby, z.z)</p>\n\n<p>or </p>\n\n<p>s := (\u03bbx, y, z.x y z) (\u03bbx, y.x (\u03bby, z.z))</p>\n\n<p>I am guessing it is the 2nd option.</p>\n"}, {"tags": ["haskell", "equality", "fold"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 7, "creation_date": 1513281288, "post_id": 47821071, "comment_id": 82604600, "body": "<code>==</code> is a binary operator. When you write <code>False == False == False</code>, you\u2019re really writing <code>(False == False) == False</code>, which is <code>True == False</code>. Perhaps now you can understand what\u2019s happening."}, {"owner": {"reputation": 61, "user_id": 9100648, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2g3WrP6-emw/AAAAAAAAAAI/AAAAAAAAACc/pZaS9JhD2CE/photo.jpg?sz=128", "display_name": "Daniel Philpott", "link": "https://stackoverflow.com/users/9100648/daniel-philpott"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1513281360, "post_id": 47821071, "comment_id": 82604634, "body": "Of course! Thanks so much."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1513281446, "post_id": 47821071, "comment_id": 82604680, "body": "If you are familiar with Python, you might have confused this with Python&#39;s comparison chaining, where <code>False == False == ... == False</code> is, indeed, equivalent to <code>(False == False) and (False == False) and ... and (False == False)</code>."}, {"owner": {"reputation": 61, "user_id": 9100648, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2g3WrP6-emw/AAAAAAAAAAI/AAAAAAAAACc/pZaS9JhD2CE/photo.jpg?sz=128", "display_name": "Daniel Philpott", "link": "https://stackoverflow.com/users/9100648/daniel-philpott"}, "edited": false, "score": 0, "creation_date": 1513281762, "post_id": 47821071, "comment_id": 82604826, "body": "Yes, and I misunderstood the fold function&#39;s bracketing."}, {"owner": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "edited": false, "score": 0, "creation_date": 1513287882, "post_id": 47821071, "comment_id": 82607693, "body": "FYI, to check if all the elements are <code>False</code>, use <code>all (==False) [False, False,False]</code>."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1513353871, "post_id": 47821071, "comment_id": 82635372, "body": "It&#39;s actually telling you if you have an odd number of <code>False</code>s in the list."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 9100648, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2g3WrP6-emw/AAAAAAAAAAI/AAAAAAAAACc/pZaS9JhD2CE/photo.jpg?sz=128", "display_name": "Daniel Philpott", "link": "https://stackoverflow.com/users/9100648/daniel-philpott"}, "is_accepted": true, "score": 4, "last_activity_date": 1513283198, "creation_date": 1513283198, "answer_id": 47821500, "question_id": 47821071, "link": "https://stackoverflow.com/questions/47821071/haskell-confusion-over-foldl-with-parenthesized-operator/47821500#47821500", "title": "Haskell: Confusion over &#39;foldl&#39; with parenthesized operator (==)", "body": "<p><em>== is a binary operator. When you write False == False == False, you\u2019re really writing (False == False) == False, which is True == False. Perhaps now you can understand what\u2019s happening.</em></p>\n\n<p>Answer submitted in comments by 'Alexis King'</p>\n"}], "owner": {"reputation": 61, "user_id": 9100648, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2g3WrP6-emw/AAAAAAAAAAI/AAAAAAAAACc/pZaS9JhD2CE/photo.jpg?sz=128", "display_name": "Daniel Philpott", "link": "https://stackoverflow.com/users/9100648/daniel-philpott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 47821500, "answer_count": 1, "score": 2, "last_activity_date": 1513283198, "creation_date": 1513281167, "question_id": 47821071, "link": "https://stackoverflow.com/questions/47821071/haskell-confusion-over-foldl-with-parenthesized-operator", "title": "Haskell: Confusion over &#39;foldl&#39; with parenthesized operator (==)", "body": "<p>Here are a few results of applying 'foldl' to this particular equality operator. I do not understand them - I thought that each line should return true, since \"False == False == False ...\" is true regardless of the length of the list. I am fairly new to Haskell.</p>\n\n<pre><code>Prelude&gt; foldl (==) False [False]\nTrue\nPrelude&gt; foldl (==) False [False,False,False]\nTrue\nPrelude&gt; foldl (==) False [False,False,False,False]\nFalse\nPrelude&gt; foldl (==) False [False,False,False,False,False]\nTrue\nPrelude&gt; foldl (==) False [False,False,False,False,False,False]\nFalse\n</code></pre>\n\n<p>I found these results when trying to write a function that tests whether a list of functions give the same result when applied to a common argument (returning a Boolean).</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9100632, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7d9e4330b31df99d14f50e92ad0ff51c?s=128&d=identicon&r=PG&f=1", "display_name": "nwelch", "link": "https://stackoverflow.com/users/9100632/nwelch"}, "edited": false, "score": 0, "creation_date": 1513282635, "post_id": 47821164, "comment_id": 82605254, "body": "I&#39;ll have to see if I can mess around with these helper functions. Would list comprehension work in this instead of going your route or?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 79, "user_id": 9100632, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7d9e4330b31df99d14f50e92ad0ff51c?s=128&d=identicon&r=PG&f=1", "display_name": "nwelch", "link": "https://stackoverflow.com/users/9100632/nwelch"}, "edited": false, "score": 0, "creation_date": 1513285094, "post_id": 47821164, "comment_id": 82606377, "body": "Sure, a list comprehension is fine too."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 2, "last_activity_date": 1513281569, "creation_date": 1513281569, "answer_id": 47821164, "question_id": 47821023, "link": "https://stackoverflow.com/questions/47821023/haskell-searching-list-of-tuples-returning-second-elements/47821164#47821164", "title": "Haskell - Searching list of Tuples, returning second elements", "body": "<p>filter could indeed be used to return only those edges in the graph that are of interest to you (ie, those leading out from the target node). Then you'd have a list of edges, when what you really want is a list of nodes. Can you think of a function that can transform a list of edges into a list of nodes, after you've filtered down to only the edges you want? </p>\n\n<pre><code>edges :: [Edge]\nf :: Edge -&gt; Bool\nfilter f edges :: [Edge]\ng :: [Edge] -&gt; [Node]\ng (filter f edges) :: [Node]\n</code></pre>\n\n<p>Above is a reasonable set of steps you could take, if you can think of appropriate <code>f</code> and <code>g</code> functions.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 9100632, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7d9e4330b31df99d14f50e92ad0ff51c?s=128&d=identicon&r=PG&f=1", "display_name": "nwelch", "link": "https://stackoverflow.com/users/9100632/nwelch"}, "edited": false, "score": 0, "creation_date": 1513301811, "post_id": 47822274, "comment_id": 82611809, "body": "Would you be able to explain your list comprehension a little further. The solution I was attempting to work was almost identical to this but the part I had wrong was I had neigh nd gr = [y | y &lt;- map snd gr, y == nd] And was trying to figure out how to return the second element instead of the first. I guess I&#39;m just confused on the (x,y) pair so basically does it just mean that if x value is equal to the node we passed in we care only about the y value even though we are grabbing the whole pair to check"}, {"owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "reply_to_user": {"reputation": 79, "user_id": 9100632, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7d9e4330b31df99d14f50e92ad0ff51c?s=128&d=identicon&r=PG&f=1", "display_name": "nwelch", "link": "https://stackoverflow.com/users/9100632/nwelch"}, "edited": false, "score": 0, "creation_date": 1513302952, "post_id": 47822274, "comment_id": 82612029, "body": "You can read <code>[ y | (x,y) &lt;- gr, x==nd ]</code> as following: a list of all <code>y</code>, where a pair <code>(x,y)</code> is taken from list <code>gr</code> such that <code>x == nd</code>"}], "tags": [], "owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "is_accepted": false, "score": 4, "last_activity_date": 1513286615, "creation_date": 1513286615, "answer_id": 47822274, "question_id": 47821023, "link": "https://stackoverflow.com/questions/47821023/haskell-searching-list-of-tuples-returning-second-elements/47822274#47822274", "title": "Haskell - Searching list of Tuples, returning second elements", "body": "<p>You can indeed use filter to find edges that leaves from a given node.   Then you need to take second element of each of this edge. You need map for that. So you write:</p>\n\n<pre><code>neighbors nd gr = map snd $ filter (\\x -&gt; fst x == nd) gr \n</code></pre>\n\n<p>(Note that Haskell would not allow you to start name of the function with capital letter).\nIf you want to be cool you can write it in almost point-free way:</p>\n\n<pre><code>neighbors nd  = map snd . filter ((==nd) . fst ) \n</code></pre>\n\n<p>And if you want to make it easier to read you can use list comprehensions:</p>\n\n<pre><code>neighbors nd gr = [ y | (x,y) &lt;- gr, x==nd ]\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 9100632, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7d9e4330b31df99d14f50e92ad0ff51c?s=128&d=identicon&r=PG&f=1", "display_name": "nwelch", "link": "https://stackoverflow.com/users/9100632/nwelch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1513286615, "creation_date": 1513280992, "question_id": 47821023, "link": "https://stackoverflow.com/questions/47821023/haskell-searching-list-of-tuples-returning-second-elements", "title": "Haskell - Searching list of Tuples, returning second elements", "body": "<p>So I know many variations of this question have been asked but I've been reading posts for hours and I'm just stuck. I'm getting better at haskell but not fully comprehending everything. </p>\n\n<p>For starters, this is an assignment so while I don't want the answer looking for some guidance.</p>\n\n<p>We have these 4 types declared for this assignment: </p>\n\n<pre><code>type Node = Integer\ntype Edge = (Integer, Integer)\ntype Graph = [Edge]\ntype Path = [Node]\n</code></pre>\n\n<p>What I am currently working is a function which takes a Node and a Graph and returns a list of Nodes that are connected to the Node passed in. </p>\n\n<p>I'm really struggling with how to recursively return the second element in the tuple once I've found the source node i'm looking for. I know I need to be using fst to grab the first element of each tuple for comparison but then I get lost here, I'm stuck on how to correctly return the second element (add it to my list) and then proceed through the remaining list of tuples.</p>\n\n<pre><code>Neighbors :: Node -&gt; Graph -&gt; [Node]\nNeighbors nd gr = \n</code></pre>\n\n<p>I've been reading about filter but I'm not sure that would work in this scenario as that returns pairs if I understand correctly. Looking for any guidance, thank you</p>\n"}, {"tags": ["haskell", "scope", "pattern-matching", "mergesort"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1513279311, "post_id": 47819946, "comment_id": 82603624, "body": "<code>d == [a]</code> is not pattern matching (its an expression) so of course it may not bind variables. You probably want <code>| [a] &lt;- d = ...</code> which <i>is</i> pattern matching. Aside: even though <code>d == []</code> compiles, you should write <code>[] &lt;- d</code> (or <code>null d</code>) instead."}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 8568658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aa526c0635301ba6229e26ff6516a08d?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew S.", "link": "https://stackoverflow.com/users/8568658/andrew-s"}, "edited": false, "score": 0, "creation_date": 1513277148, "post_id": 47820053, "comment_id": 82602521, "body": "Thanks, surprisingly the difference between <code>length(d) == 1</code> and <code>length(d) == a</code> was never important in previous 30+ problems i solved, so I&#39;m kinda lucky to stumble upon this. Could be a big misunderstanding in the future(("}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 425, "user_id": 8568658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aa526c0635301ba6229e26ff6516a08d?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew S.", "link": "https://stackoverflow.com/users/8568658/andrew-s"}, "edited": false, "score": 0, "creation_date": 1513279001, "post_id": 47820053, "comment_id": 82603466, "body": "@AndrewS. I find your comment a bit confusing. <code>length d == 1</code> and <code>length d == a</code> are pretty significantly different; and also my answer doesn&#39;t mention <code>length</code> at all!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513279376, "post_id": 47820053, "comment_id": 82603656, "body": "&quot;a guard, which must be an expression of type Bool&quot; - technically false, due to <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow noreferrer\">pattern guards</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513279676, "post_id": 47820053, "comment_id": 82603811, "body": "@user2407038 Okay, that&#39;s fair. I&#39;m not sure adding the language to be precise there will make the explanatory power of the answer better, though, so I&#39;ll leave it and upvote your comment to encourage the interested reader to dive into the precise rules."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1513276667, "creation_date": 1513276667, "answer_id": 47820053, "question_id": 47819946, "link": "https://stackoverflow.com/questions/47819946/variable-not-in-scope-a/47820053#47820053", "title": "Variable not in scope: a", "body": "<blockquote>\n  <p>Is there some really obvious problem with pattern matching I'm not seeing?</p>\n</blockquote>\n\n<p>Yes, sure: you haven't written a pattern match! (Okay, you wrote a trivial one, <code>d</code>, which matches anything and names it <code>d</code>.) What you wrote instead was a guard, which must be an expression of type <code>Bool</code>. While <code>d == [a]</code> is syntactically okay, and could potentially have type <code>Bool</code> if <code>d</code> and <code>a</code> have appropriate types, it doesn't work here because you don't have any <code>a</code> to compare <code>d</code> to.</p>\n\n<p>You probably wanted this instead:</p>\n\n<pre><code>m_sort [] = []\nm_sort [a] = [a]\nm_sort d = merge ...\n</code></pre>\n\n<p>Now instead of having an expression that has the term <code>[a]</code> in it referring to some variable named <code>a</code>, this will be a pattern match, which looks for a term with the shape of a one-element list and binds <code>a</code> to that element.</p>\n"}, {"comments": [{"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 2, "creation_date": 1513276929, "post_id": 47820055, "comment_id": 82602388, "body": "you probably want something like <code>null . tail $ d</code> instead of <code>length d</code> since <code>length</code> needs to evaluate the entire list while we only care if it has more than one element."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 0, "creation_date": 1513277027, "post_id": 47820055, "comment_id": 82602448, "body": "@puhlen Oooh, nice - I won&#39;t edit, as I think <code>length</code> is clearer and efficiency probably isn&#39;t of much concern here, but +1 so they&#39;ll hopefully see the more efficient way. Proper pattern matching is the best approach in this case, this is just hopefully explaining why OP&#39;s current approach <i>doesn&#39;t</i> work."}, {"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 0, "creation_date": 1513277401, "post_id": 47820055, "comment_id": 82602653, "body": "<code>length</code> is clear but it&#39;s inefficient.  There might be a better way than my suggestion as it was just off the top of my head, but I would use pattern matching for this anyway.  If I needed some sort of length check like this I&#39;d probably write an appropriately named function for it (if one doesn&#39;t already exist) so I can have both clarity and efficiency."}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 0, "last_activity_date": 1515433760, "last_edit_date": 1515433760, "creation_date": 1513276682, "answer_id": 47820055, "question_id": 47819946, "link": "https://stackoverflow.com/questions/47819946/variable-not-in-scope-a/47820055#47820055", "title": "Variable not in scope: a", "body": "<p>Iirc, that's not pattern matching - you're asking if <code>d</code> is equal to <code>[a]</code>, and as you've not defined what <code>a</code> is that's causing issues.</p>\n\n<p>Remember you need an expression evaluating to <code>Bool</code> as the condition in a guard, so something like <code>length(d) == 1</code> should work:</p>\n\n<pre><code>m_sort :: (Ord a) =&gt; [a] -&gt; [a]\nm_sort d\n     | d == []        = []\n     | length d  == 1 = d\n     | otherwise      = merge (m_sort (fst $ split d)) (m_sort (snd $ split d))\n</code></pre>\n\n<p>Alternatively you can declare your function as multiple pieces (which I think is better practice anyway), as in @DanielWagner's answer, which will let you use pattern matching like you're trying to.</p>\n"}], "owner": {"reputation": 425, "user_id": 8568658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aa526c0635301ba6229e26ff6516a08d?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew S.", "link": "https://stackoverflow.com/users/8568658/andrew-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 47820053, "answer_count": 2, "score": 1, "last_activity_date": 1515433760, "creation_date": 1513276220, "last_edit_date": 1513277974, "question_id": 47819946, "link": "https://stackoverflow.com/questions/47819946/variable-not-in-scope-a", "title": "Variable not in scope: a", "body": "<p>I m trying to make a simple merge sort function. Almost finished with the code, but:</p>\n\n<pre><code>m_sort :: (Ord a) =&gt; [a] -&gt; [a]\nm_sort d\n     | d == [] = []\n     | d == [a] = [a]\n     | otherwise = merge (m_sort (fst $ split d)) (m_sort (snd $ split d))\n</code></pre>\n\n<p>for some reason here i get <code>Haskell_training.hs:137:21: error: Variable not in scope: a</code>. Excluding the <code>| d == [a] = [a]</code> leads to nice compilation, but it won't work without it. Is there some really obvious problem with pattern matching I'm not seeing?</p>\n"}, {"tags": ["haskell", "dependencies", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1513274060, "post_id": 47819202, "comment_id": 82600821, "body": "My guess is that your cabal file is being controlled via <code>hpack</code>. There will be a file named <code>package.yaml</code> - which you have to edit for dependency and other information. Your cabal file will be generated based on that."}, {"owner": {"reputation": 51, "user_id": 2805058, "user_type": "registered", "profile_image": "https://graph.facebook.com/631560582/picture?type=large", "display_name": "bleakcon", "link": "https://stackoverflow.com/users/2805058/bleakcon"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1513275223, "post_id": 47819202, "comment_id": 82601427, "body": "Thank you, my first use of stack means I totally missed this, been driving me nuts, I knew something like this was happening but not what."}, {"owner": {"reputation": 486, "user_id": 854672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eda4f03accf45734865ea7e6c6de010?s=128&d=identicon&r=PG", "display_name": "MauganRa", "link": "https://stackoverflow.com/users/854672/mauganra"}, "edited": false, "score": 0, "creation_date": 1527499081, "post_id": 47819202, "comment_id": 88136240, "body": "You can delete <code>package.yaml</code> if you want it to do the normal way. Honestly, the stack project templates should be documented with more than maybe a one-liner in the output of <code>stack templates</code>..."}], "owner": {"reputation": 51, "user_id": 2805058, "user_type": "registered", "profile_image": "https://graph.facebook.com/631560582/picture?type=large", "display_name": "bleakcon", "link": "https://stackoverflow.com/users/2805058/bleakcon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1513283846, "answer_count": 0, "score": 2, "last_activity_date": 1513277615, "creation_date": 1513273135, "last_edit_date": 1513277615, "question_id": 47819202, "link": "https://stackoverflow.com/questions/47819202/stack-is-overwriting-my-cabal-file-when-i-added-a-dependency-and-run-stack-bui", "closed_reason": "Duplicate", "title": "stack is overwriting my .cabal file when i added a dependency and run &#39;stack build&#39;", "body": "<p>I have used stack to create a new project.</p>\n\n<p>I see it has created a stack.yaml file and a myproject.cabal file, when i tried to add a dependency (split) in my .cabal file like so:</p>\n\n<pre><code>    library\n      hs-source-dirs:\n        src\n      build-depends:\n        base &gt;= 4.7 &amp;&amp; &lt; 5, split\n      exposed-modules:\n        Lib\n      default-language: Haskell2010\n</code></pre>\n\n<p>i then run stack build and i get a failure message:</p>\n\n<pre><code>Failed to load interface for `Data.List.Split'\nUse -v to see a list of the files searched for\n</code></pre>\n\n<p>i then go back to my .cabal file and find that there is no split dependency listed anymore as the file has been overwritten.</p>\n\n<p>Any idea why this is happening?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513275775, "post_id": 47819124, "comment_id": 82601719, "body": "An imperative program is (basically) one which has an intrinsic notion of global state. To avoid imperative thinking is simply to avoid designing algorithms which make use of some sort of global state. Haskell has no notion of global state (outside of <code>IO</code> at least) so it makes sense to avoid relying on something which your language doesn&#39;t provide. Although, even in imperative languages, it is much easier to reason about programs which don&#39;t use any global state. Similar things can be said about &#39;mutability&#39;."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1513276621, "post_id": 47819124, "comment_id": 82602220, "body": "I would say that &quot;imperative thinking&quot; is to think of everything as a sequence of steps or statements that would be evaluated in order. So instead of &quot;compute a from b from c&quot; one would say &quot;compute c <i>then</i> compute b from that <i>then</i> compute a from that&quot;. Which is just unnecessary."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1513473872, "post_id": 47819124, "comment_id": 82667340, "body": "\u201cWith enough effort, it is possible to write Fortran code in any language.\u201d"}], "owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 836, "favorite_count": 0, "closed_date": 1513278445, "answer_count": 0, "score": 3, "last_activity_date": 1513272903, "creation_date": 1513272903, "question_id": 47819124, "link": "https://stackoverflow.com/questions/47819124/what-does-imperative-thinking-mean", "closed_reason": "Opinion-based", "title": "What does &#39;imperative thinking&#39; mean?", "body": "<p>I have seen this a lot that someone is criticized for thinking imperatively regarding their algorithm/solution, even though they seem to be experienced with functional programming. </p>\n\n<p>So I want to know what 'imperative thinking' means, and how one can avoid thinking imperatively?</p>\n"}, {"tags": ["haskell", "recursion", "mapping"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513267541, "post_id": 47817370, "comment_id": 82596829, "body": "Please always add type signatures and reference or definitions for all data you&#39;re dealing with."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513268432, "post_id": 47817370, "comment_id": 82597459, "body": "This is pseudocode, isn&#39;t it? <code>root</code> is a tree node, <code>dsc</code> is a list of its immediate descendants, <code>step</code> is something else yet subject to change and passing on."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1513270180, "post_id": 47817370, "comment_id": 82598597, "body": "It&#39;s ok to post pseudocode for your solution attempt, but we still need to know properly what data structures you&#39;re talking about, and what the <i>purpose</i> (i.e. type signature) of your algorithm would be."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1513270614, "post_id": 47817370, "comment_id": 82598872, "body": "what does it mean to <code>increase</code> a descendant? Or do you <code>increase</code> a <code>step</code>? what does it mean?"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513271105, "post_id": 47817370, "comment_id": 82599158, "body": "I <code>increase</code> just <code>step</code>. <code>step</code> is something which gets changed on every iteration via <code>increase</code>. Let us forget about <code>d</code> as the second argument to <code>increase</code> for the time being. See the UPD"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513271346, "post_id": 47817370, "comment_id": 82599305, "body": "The pseudocode just looks like <code>mapM (\\d -&gt; let nextStep = increase step d in walkTree nextStep d) dsc</code> to me. If this doesn&#39;t work, then I would guess it is your algorithm (and not your implementation) which is wrong. It&#39;s unclear what function you&#39;re actually trying to implement though; &quot;recursive tree walking&quot; is not very standard terminology (is it DFS? BFS? something else?)"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1513272106, "post_id": 47817370, "comment_id": 82599715, "body": "Looks very much like it. I&#39;m going to try and make a report"}], "answers": [{"tags": [], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "is_accepted": true, "score": 1, "last_activity_date": 1513277534, "creation_date": 1513277534, "answer_id": 47820264, "question_id": 47817370, "link": "https://stackoverflow.com/questions/47817370/haskell-recursive-mapping-difficulty/47820264#47820264", "title": "Haskell: recursive mapping difficulty", "body": "<p>Final solution, courtesy of <a href=\"https://stackoverflow.com/users/2407038/user2407038\">user2407038</a> (see comments to the question). This is a snippet of running code (is it DFS?):</p>\n\n<pre><code>-- | Walks the source tree, recreates source tree at destination.\ntraverseTreeDst :: Settings -&gt; FilePath -&gt; Int -&gt; Int -&gt; Counter -&gt; FilePath -&gt; FilePath -&gt; IO ()\ntraverseTreeDst args dstRoot total totw counter dstStep srcDir = do\n  (dirs, files)        &lt;- listDir args srcDir\n\n  let traverse dir = do\n        let step = dstStep &lt;/&gt; basename dir\n        mkdir (dstRoot &lt;/&gt; step)\n        traverseTreeDst   args dstRoot total totw counter step dir\n\n  mapM_ traverse                                                   dirs\n  mapM_ (copyFile         args dstRoot total totw counter dstStep) files\n</code></pre>\n\n<p>You probably see why I resorted to pseudocode. Lots of unnecessary detail, yet this is it. The thing copies audio files, mangles their names, and sets tags. Nothing much.</p>\n\n<p>I wouldn't mind discussing the relevant terminology. How do you describe this kind of problem and this kind of solution?</p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 47820264, "answer_count": 1, "score": 1, "last_activity_date": 1513277534, "creation_date": 1513266732, "last_edit_date": 1513270866, "question_id": 47817370, "link": "https://stackoverflow.com/questions/47817370/haskell-recursive-mapping-difficulty", "title": "Haskell: recursive mapping difficulty", "body": "<p>I'm working on recursive tree walking. I want something like the following (Haskell pseudocode):</p>\n\n<pre><code>walkTree step root = do\n  dsc &lt;- getDescendants root\n  for d in dsc\n    nextStep = increase step d\n    walkTree nextStep d\n</code></pre>\n\n<p>No iteration for me, of course. I can't figure out the mapping solution, though. How can I manage the <code>step</code> thing?</p>\n\n<p>UPD:</p>\n\n<p>Let's try the mapping:</p>\n\n<pre><code>walkTree step root = do\n  dsc &lt;- getDescendants root\n  nextStep = increase step d\n  mapM (walkTree nextStep) dsc\n</code></pre>\n\n<p>Two problems: <code>nextStep</code> is frozen for the mapping; also cannot get <code>d</code> (which is secondary)</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1513267622, "post_id": 47817114, "comment_id": 82596892, "body": "The other part of that particular error message should tell you how to fix it. You can enable what it suggests with a <code>{-# LANGUAGE ... #-}</code> pragma."}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1513267868, "post_id": 47817114, "comment_id": 82597058, "body": "It tells me to allow FlexibleContexts. But why is that even necessary? I fulfill all constraints?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1513268027, "post_id": 47817114, "comment_id": 82597166, "body": "There&#39;s actually no problem here. You do fulfill all the constraints.  The reason GHCi won&#39;t print out any result is that it doesn&#39;t know what exact type the whole thing is supposed to be \u2013 you didn&#39;t specify that. Indeed, generally it&#39;s not necessary because the type will be inferred from the context, but only if there <i>is</i> some context (e.g. wrap the entire thing in <code>runWriter</code>)."}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1513268302, "post_id": 47817114, "comment_id": 82597356, "body": "Yes, enforcing the type <code>writer (5,&quot;foo&quot;) :: Writer String Char</code> works. But why this behavior? All the other monads in <code>Control.Monad.</code> don&#39;t have this behavior..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513271580, "post_id": 47817114, "comment_id": 82599421, "body": "Without <code>FlexibleContexts</code>, <code>MonadWriter [Char] m</code> simply isn&#39;t a valid type (but it is the constraint of the inferred type of the given expression, so the given expression is not type correct). The same thing happens with other monad transformers (e.g. <code>put &quot;x&quot;</code> or <code>(&#39;a&#39;:) &lt;$&gt; ask</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 0, "last_activity_date": 1513273810, "creation_date": 1513273810, "answer_id": 47819365, "question_id": 47817114, "link": "https://stackoverflow.com/questions/47817114/non-type-variable-argument-for-monadwriter/47819365#47819365", "title": "Non type-variable argument for MonadWriter", "body": "<p>It\u2019s just a check to keep type checking \u201csimple\u201d</p>\n\n<pre><code>writer (5, \"Hello world\") :: (MonadWriter String m, Num n) =&gt; m n\n</code></pre>\n\n<p>which is a perfectly sensible type. However, by default, it is not allowed, because the constraint <code>MonadWriter String m</code> contains a type argument <code>String</code>, which isn\u2019t a variable. This was done with the intent that it would stop the delaying of type errors:</p>\n\n<pre><code>class C c where c :: c -&gt; c\n-- no instance C Int\nx :: C Int =&gt; Int\nx = c (5 :: Int)\n-- illegal with above restriction\n-- missing instance error (maybe) delayed to user without\n</code></pre>\n\n<p>Simply set <code>-XFlexibleContexts</code> to disable the check.</p>\n\n<p>As for other monads, I\u2019m pretty sure <code>Reader</code>, <code>State</code>, and <code>Free</code> will do this too.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513273810, "creation_date": 1513266008, "last_edit_date": 1513270779, "question_id": 47817114, "link": "https://stackoverflow.com/questions/47817114/non-type-variable-argument-for-monadwriter", "title": "Non type-variable argument for MonadWriter", "body": "<p>I just tried to use <code>writer</code>:</p>\n\n<pre><code>writer (5, \"Hello, World\")\n</code></pre>\n\n<p>But I noticed I get an error:</p>\n\n<blockquote>\n  <p>Non type-variable argument in the constraint <code>MonadWriter [Char] m</code></p>\n</blockquote>\n\n<p>But I wonder what constraint I don't fulfill? <code>[a]</code> after all is a Monoid...</p>\n"}, {"tags": ["haskell", "exception", "exception-handling"], "answers": [{"comments": [{"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 0, "creation_date": 1513268414, "post_id": 47817769, "comment_id": 82597444, "body": "I know it. My question was to stay pure. <code>error&#47;ErrorCall</code> from <code>toEnum</code> keeps hidden IO and no way to see this in signatures, and type-checking is OK, but exception is leaking :) Good news. So, no way to make it without <code>IO</code> involving, right?"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 1, "creation_date": 1513268511, "post_id": 47817769, "comment_id": 82597497, "body": "Yes, no way. In Haskell you can throw IO exceptions in pure code (via <code>error</code>), but not catch them. I share the frustration, but whatchagonnado :-)"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 0, "creation_date": 1513268715, "post_id": 47817769, "comment_id": 82597639, "body": "But I don&#39;t understand in this case signature of <code>catch</code> from &quot;exceptions&quot; <code>catch :: Exception e =&gt; m a -&gt; (e -&gt; m a) -&gt; m a</code>, and <code>m</code> can be <code>Either</code> <a href=\"https://hackage.haskell.org/package/exceptions-0.8.3/docs/Control-Monad-Catch.html\" rel=\"nofollow noreferrer\">here</a>. And no any <code>IO</code>. What am I missing?"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 0, "creation_date": 1513268820, "post_id": 47817769, "comment_id": 82597719, "body": "I tried also &quot;errors&quot; package <code>catchEither</code>, result is the same. No <code>IO</code>, no catching :)"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 2, "creation_date": 1513269095, "post_id": 47817769, "comment_id": 82597905, "body": "Yes, <code>Either</code> is an instance of <code>Monad</code>, and also an instance of <code>MonadError</code>, but that&#39;s all beside the point: being an instance of <code>Monad</code> or <code>MonadError</code> simply means to implement certain functions in a certain way. You can look at the way <code>catch</code> <a href=\"https://www.stackage.org/haddock/lts-9.18/mtl-2.2.1/src/Control.Monad.Error.Class.html#line-107\" rel=\"nofollow noreferrer\">is implemented for <code>Either</code></a>: it simply translates <code>Left</code> and <code>Right</code> into &quot;error&quot; and &quot;normal&quot; cases respectively. There is no magic there, nothing special is happening."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 1, "creation_date": 1513269100, "post_id": 47817769, "comment_id": 82597907, "body": "The <code>IO</code> monad, on the other hand, is &quot;magic&quot;. It is a window from Haskell into the real world, and so there are certain things associated with it, which are impossible to reproduce in pure code."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 1, "last_activity_date": 1513268331, "last_edit_date": 1513268331, "creation_date": 1513268008, "answer_id": 47817769, "question_id": 47816571, "link": "https://stackoverflow.com/questions/47816571/why-exception-is-not-catching-by-catch/47817769#47817769", "title": "Why exception is not catching by `catch`?", "body": "<p>Haskell exceptions are somewhat different than, say, Java or C++: \"true\" exceptions work in <code>IO</code> monad, and then there is an imitation of exceptions via pure means, as in <a href=\"https://www.stackage.org/haddock/lts-9.18/transformers-0.5.2.0/Control-Monad-Trans-Except.html#t:ExceptT\" rel=\"nofollow noreferrer\"><code>ExceptT</code></a>.</p>\n\n<p>The <code>toEnum</code> function throws the first kind - <code>IO</code> exceptions, - which cannot be caught in pure code. They fly out to the nearest <code>IO</code> place, which in your case is apparently GHCi.</p>\n\n<p>In order to catch such exceptions, you first need to wrap the throwing expression in <code>IO</code> via <a href=\"https://www.stackage.org/haddock/lts-9.18/base-4.9.1.0/Control-Exception.html#v:evaluate\" rel=\"nofollow noreferrer\"><code>Control.Exception.evaluate</code></a>. Then you can catch such exceptions with <code>catch</code>, or, if you just want to convert it to an <code>Either exception A</code> (as you seem to be doing), there is an app for that! - it's called <a href=\"https://www.stackage.org/haddock/lts-9.18/base-4.9.1.0/Control-Exception.html#g:7\" rel=\"nofollow noreferrer\"><code>try</code></a>.</p>\n\n<p>Further, when using either <code>catch</code> or <code>try</code>, you need to specify the specific <em>type</em> of the exception you're trying to catch. But <a href=\"https://www.stackage.org/haddock/lts-9.18/base-4.9.1.0/Control-Exception.html#g:4\" rel=\"nofollow noreferrer\">it is possible to catch <em>all</em> exceptions</a> regardless of type by using the existential type <code>SomeException</code>.</p>\n\n<p>So, wrapping up all of that, we get this code:</p>\n\n<pre><code>import qualified Control.Exception as E\n\ndata A = A1|A2 deriving (Enum, Show)\ndata B = B1|B2|B3 deriving (Enum, Show)\n\nconv :: Enum b =&gt; b -&gt; IO (Either E.SomeException A)\nconv b = E.try . E.evaluate . toEnum $ fromEnum b\n</code></pre>\n\n<p><strong>NOTE 1</strong>: The type annotation on <code>conv</code> is necessary in order to specify <code>E.SomeException</code> as the type of exception to catch. Without it, GHC will complain that the type of exception is ambiguous.</p>\n\n<p><strong>NOTE 2</strong>: Because our type annotation on <code>conv</code> already specifies the target type <code>A</code>, the type annotation on <code>toEnum $ fromEnum b</code> is no longer necessary.</p>\n\n<p><strong>NOTE 3</strong>: I have replaced your import of <code>Control.Monad.Catch</code> with <code>Control.Exception</code>, because that's where <code>evaluate</code> and <code>SomeException</code> are.</p>\n"}, {"tags": [], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "is_accepted": false, "score": -1, "last_activity_date": 1513336960, "creation_date": 1513336960, "answer_id": 47831355, "question_id": 47816571, "link": "https://stackoverflow.com/questions/47816571/why-exception-is-not-catching-by-catch/47831355#47831355", "title": "Why exception is not catching by `catch`?", "body": "<p>I'll leave it here if someone needs a solution. To keep function pure, conversion should be:</p>\n\n<pre><code>unsafeConvEnum :: (Enum a, Enum b) =&gt; a -&gt; b\nunsafeConvEnum = toEnum . fromEnum\n\nconvEnum :: (Enum a, Enum b) =&gt; a -&gt; Maybe b\nconvEnum e = unsafePerformIO conv'\n  where onError (_::SomeException) = pure Nothing\n        conv' = (Just &lt;$&gt; evaluate (unsafeConvEnum e)) `catch` onError\n</code></pre>\n\n<p>No any IO :)</p>\n"}], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 47817769, "answer_count": 2, "score": 0, "last_activity_date": 1513336960, "creation_date": 1513264246, "question_id": 47816571, "link": "https://stackoverflow.com/questions/47816571/why-exception-is-not-catching-by-catch", "title": "Why exception is not catching by `catch`?", "body": "<p>Why does not this catch exception of conversion <code>conv B3</code> ?!</p>\n\n<pre><code>import qualified Control.Monad.Catch as E\ndata A = A1|A2 deriving (Enum, Show)\ndata B = B1|B2|B3 deriving (Enum, Show)\nconv b = safeConv\n  where\n    catchError e = Left e\n    safeConv = (Right $ (toEnum $ fromEnum b :: A)) `E.catch` catchError\n</code></pre>\n\n<p>I got:</p>\n\n<pre><code>Right *** Exception: toEnum{A}: tag (2) is outside of enumeration's range (0,1)\nCallStack (from HasCallStack):\n  error, called at xxx.hs:227:26 in main:Main\n</code></pre>\n"}, {"tags": ["csv", "haskell", "data-import"], "comments": [{"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1513263750, "post_id": 47816332, "comment_id": 82594287, "body": "sorry I could not. It was a typo"}], "answers": [{"comments": [{"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 0, "creation_date": 1513265948, "post_id": 47816733, "comment_id": 82595774, "body": "Thanks do you mind to add a first step. Where you read the data from file into an haskell str. I&#39;m not sure what is the best way to do that"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 0, "creation_date": 1513266096, "post_id": 47816733, "comment_id": 82595880, "body": "@Donbeo, we aren&#39;t writing full programs from scratch here. Reading files isn&#39;t that hard, actually: <a href=\"http://learnyouahaskell.com/input-and-output#files-and-streams\" rel=\"nofollow noreferrer\">learnyouahaskell.com/input-and-output#files-and-streams</a>"}, {"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 0, "creation_date": 1513269198, "post_id": 47816733, "comment_id": 82597973, "body": "actually my main problem is to load the data from file to haskell string.  As all the methods I have tried to read it did not return a string  but other values such as: <code>Prelude Data.Csv BL LP System.IO&gt; :t s s :: IO ()</code>"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 0, "creation_date": 1513269361, "post_id": 47816733, "comment_id": 82598078, "body": "@Donbeo, if the data in the file looks like the example in your question, just follow the link in my previous comment: it&#39;ll help you learn how to read data from files in Haskell. Otherwise, it&#39;s a whole new different problem."}, {"owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "edited": false, "score": 0, "creation_date": 1513272477, "post_id": 47816733, "comment_id": 82599927, "body": "if I understand correctly this answer assume an input of type string. When reading a file the input is instead <code>IO-&gt;Str</code>. So I do not know what is the right way to do it"}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": true, "score": 0, "last_activity_date": 1513265206, "last_edit_date": 1513265206, "creation_date": 1513264788, "answer_id": 47816733, "question_id": 47816332, "link": "https://stackoverflow.com/questions/47816332/haskell-tls-file-to-list-of-list/47816733#47816733", "title": "haskell tls file to list of list", "body": "<ul>\n<li><p>First break your input into lines using <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:lines\" rel=\"nofollow noreferrer\"><code>lines</code></a>:</p>\n\n<pre><code>let test = \"1 2 3 4\\n 5 6 7 \\n 4 2 5\"\nlet rows = lines test --literally \"lines test\"! Beautiful, eh?\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[\"1 2 3 4\",\" 5 6 7 \",\" 4 2 5\"] :: [[Char]]\n</code></pre></li>\n<li><p>Then, extract individual numbers as strings using <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:words\" rel=\"nofollow noreferrer\"><code>words</code></a>:</p>\n\n<pre><code>let nums_as_strings = map words rows\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[[\"1\",\"2\",\"3\",\"4\"],[\"5\",\"6\",\"7\"],[\"4\",\"2\",\"5\"]] :: :: [[[Char]]]\n</code></pre></li>\n<li><p>The last thing to do is convert these strings to integers with <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:read\" rel=\"nofollow noreferrer\"><code>read</code></a>:</p>\n\n<pre><code>let numbers = map (map read) nums_as_strings :: [[Int]]\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[[1,2,3,4],[5,6,7],[4,2,5]] :: [[Int]]\n</code></pre></li>\n</ul>\n\n<p>Or, squashed into one line:</p>\n\n<pre><code>let numbers = map (map read) (map words $ lines test) :: [[Int]]\n</code></pre>\n\n<hr>\n\n<p>Example with your data:</p>\n\n<pre><code>Prelude&gt; let test = \"1224    926 1380    688 845 109 118 88  1275    1306    91  796 102 1361    27  995\\n1928    2097    138 1824    198 117 1532    2000    1478    539 1982    125 1856    139 475 1338\"\nPrelude&gt; map (map read) (map words $ lines test) :: [[Int]]\n[[1224,926,1380,688,845,109,118,88,1275,1306,91,796,102,1361,27,995],[1928,2097,138,1824,198,117,1532,2000,1478,539,1982,125,1856,139,475,1338]]\n</code></pre>\n\n<p>You may need to take care of empty lines, but that's really simple.</p>\n"}, {"tags": [], "owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "is_accepted": false, "score": 0, "last_activity_date": 1513291341, "last_edit_date": 1513291341, "creation_date": 1513290646, "answer_id": 47823112, "question_id": 47816332, "link": "https://stackoverflow.com/questions/47816332/haskell-tls-file-to-list-of-list/47823112#47823112", "title": "haskell tls file to list of list", "body": "<pre><code>import System.IO\n\nreadListOfLists :: Handle -&gt; IO [[Int]]\nreadListOfLists handle = do \n    contents &lt;- hGetContents handle\n    let ls :: [String] \n        ls = lines contents\n        ws :: [[String]]\n        ws= map words ls\n        res :: [[Int]]\n        res = map (map read) ws\n    return res;  \n</code></pre>\n\n<p>or you can write the same code in one line:</p>\n\n<pre><code>readListOfLists :: Handle -&gt; IO [[Int]]\nreadListOfLists = fmap (map (map read . words) . lines) . hGetContents \n</code></pre>\n\n<p>To use it:</p>\n\n<pre><code>do\n    handle &lt;- openFile fileName ReadMode\n    table &lt;- readListOfLists handle\n    hClose handle \n    print table\n</code></pre>\n"}], "owner": {"reputation": 14057, "user_id": 2411173, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=128&d=identicon&r=PG", "display_name": "Donbeo", "link": "https://stackoverflow.com/users/2411173/donbeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 47816733, "answer_count": 2, "score": 0, "last_activity_date": 1513291341, "creation_date": 1513263475, "last_edit_date": 1513269812, "question_id": 47816332, "link": "https://stackoverflow.com/questions/47816332/haskell-tls-file-to-list-of-list", "title": "haskell tls file to list of list", "body": "<p>I have a tls file such as:</p>\n\n<pre><code>1224    926 1380    688 845 109 118 88  1275    1306    91  796 102 1361    27  995\n1928    2097    138 1824    198 117 1532    2000    1478    539 1982    125 1856    139 475 1338\n848 202 1116    791 1114    236 183 186 150 1016    1258    84  952 1202    988 866\n946 155 210 980 896 875 925 613 209 746 147 170 577 942 475 850\n1500    322 43  95  74  210 1817    1631    1762    128 181 716 171 1740    145 1123\n3074    827 117 2509    161 206 2739    253 2884    248 3307    2760    2239    1676    1137    3055\n183 85  143 197 243 72  291 279 99  189 30  101 211 209 77  198\n175 149 259 372 140 250 168 142 146 284 273 74  162 112 78  29\n169 578 97  589 473 317 123 102 445 217 144 398 510 464 247 109\n3291    216 185 1214    167 495 1859    194 1030    3456    2021    1622    3511    222 3534    1580\n2066    2418    2324    93  1073    82  102 538 1552    962 91  836 1628    2154    2144    1378\n149 963 1242    849 726 1158    164 1134    658 161 1148    336 826 1303    811 178\n3421    1404    2360    2643    3186    3352    1112    171 168 177 146 1945    319 185 2927    2289\n543 462 111 459 107 353 2006    116 2528    56  2436    1539    1770    125 2697    2432\n1356    208 5013    4231    193 169 3152    2543    4430    4070    4031    145 4433    4187    4394    1754\n5278    113 4427    569 5167    175 192 3903    155 1051    4121    5140    2328    203 5653    3233\n</code></pre>\n\n<p>how can I read it in a list of list of int in haskell?</p>\n\n<p>I have tried few options but I could not manage to do it.  I am very new to haskell so please be patience. </p>\n"}, {"tags": ["haskell", "type-families"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513273470, "post_id": 47816268, "comment_id": 82600471, "body": "You can&#39;t - open type families are not allowed to overlap. You could use a multiparameter typeclass. However, I don&#39;t see the purpose of the <code>WrappedList</code> instance."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1513274534, "post_id": 47816268, "comment_id": 82601054, "body": "@user240738 I\u2019m going to guess it\u2019s a simple sanity check to make sure a marginally complicated type can be an instance as well as simple ones."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513276940, "post_id": 47816268, "comment_id": 82602392, "body": "@user2407038 Another solution that can satisfy me is to have default implementation of <code>type Element</code> type family and have an ability to override this implementation. @HTNW point regarding sanity check is true :) But in my case I have <code>class ToList t =&gt; Container t</code> where <code>Container</code> has ~15 methods. And this <code>WrappedList</code> wrapper implements all <code>Container</code> methods through <code>Container</code> instance for <code>[a]</code>. Might be useful if you want to use <code>Container</code> methods but don&#39;t want to implement ~15 methods for your data type."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1513278003, "post_id": 47816268, "comment_id": 82602966, "body": "@user2407038 Answer to this questions suggests to use _ default associated injective type family_ but I don&#39;t see how can I use it: <a href=\"https://stackoverflow.com/questions/46206079/associated-data-families-and-overlapping-instances\" title=\"associated data families and overlapping instances\">stackoverflow.com/questions/46206079/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1513281178, "post_id": 47820616, "comment_id": 82604538, "body": "Thanks! That was very useful. Now I see the problem."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 6, "last_activity_date": 1513278947, "creation_date": 1513278947, "answer_id": 47820616, "question_id": 47816268, "link": "https://stackoverflow.com/questions/47816268/how-to-implement-default-associated-type-family-for-overlappable-instance-monom/47820616#47820616", "title": "How to implement default associated type family for OVERLAPPABLE instance, monomorphic container and newtype wrapper?", "body": "<p>The essential problem is that you can't use to type class overlap to make type families which overlap. It simply doesn't make sense - a type family computes a type from an input type, and the resulting type may not depend on how the compiler picks a type class instance (or else it wouldn't be a function - since the output of a function may only depend on the input). This problem is quite common, but how you solve it depends entirely on your specific use case.</p>\n\n<p>The simplest solution is to give your default implementation using <code>DefaultSignatures</code>. Note that associated type families can have defaults as well:</p>\n\n<pre><code>type family ElementDefault (t :: *) :: * where\n  ElementDefault (f a) = a\n\nclass ToList t where\n    type Element t :: *\n    type Element t = ElementDefault t\n\n    toList :: t -&gt; [Element t]\n    default toList :: (Foldable f, t ~ f a, Element t ~ a) =&gt; t -&gt; [Element t]\n    toList = Foldable.toList\n</code></pre>\n\n<p>This allows you to write instances for all <code>Foldable</code> types without giving the implementation:</p>\n\n<pre><code>instance ToList [a]\ninstance ToList (Maybe a)\n-- etc...\n</code></pre>\n\n<hr>\n\n<p>If you want to avoid writing such instances (even the instance heads), you need to move the associated type into the class instance head. Since it is only classes which may overlap, not open type families, doing so allows the 'element' type to also be overlapping. </p>\n\n<pre><code>class ToList t e | t -&gt; e where\n  toList :: t -&gt; [e]\n\ninstance {-# OVERLAPPABLE #-} (a ~ a', Foldable f) =&gt; ToList (f a) a' where\n  toList = Foldable.toList\n\ninstance ToList Text Char where\n  toList = unpack\n\ninstance ToList l a =&gt; ToList (WrappedList l) a where\n  toList (WrappedList l) = toList l\n</code></pre>\n\n<hr>\n\n<p>The simplest way to provide multiple default definitions is to provide them outside of the class. If you have 15 class functions, this indeed can be tedious. In such a situation, I would implement the class with a record:</p>\n\n<pre><code>data ToList' t e = ToList'\n  { toList' :: t -&gt; [e] {- 14 more fields... -} }\n\nclass ToList t where\n  type Element t \n  toList_impl :: ToList' t (Element t)\n\n-- For consumers of ToList\ntoList :: ToList t =&gt; t -&gt; [Element t]\ntoList = toList' toList_impl\n\ninstance ToList Text where\n  type Element Text = Char\n  toList_impl = ToList' unpack\n\ntoList_Foldable_default :: Foldable f =&gt; ToList' (f a) a\ntoList_Foldable_default = ToList' Foldable.toList\n\ntoList_Wrapped_list :: ToList l =&gt; ToList' l (Element l)\ntoList_Wrapped_list = ToList' toList\n</code></pre>\n\n<p>With this approach, you can dispense with the typeclass entirely; its only remaining use is to get instance uniqueness.</p>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 1, "accepted_answer_id": 47820616, "answer_count": 1, "score": 2, "last_activity_date": 1513278947, "creation_date": 1513263272, "question_id": 47816268, "link": "https://stackoverflow.com/questions/47816268/how-to-implement-default-associated-type-family-for-overlappable-instance-monom", "title": "How to implement default associated type family for OVERLAPPABLE instance, monomorphic container and newtype wrapper?", "body": "<p>I had the following Haskell code:</p>\n\n<pre><code>type family Element t\n\nclass ToList t where\n    toList :: t -&gt; [Element t]\n</code></pre>\n\n<p>It was suggested to me earlier to make <code>Element</code> an associated type family: <a href=\"https://stackoverflow.com/questions/45424976/foldable-intset/45425178\">Foldable IntSet</a></p>\n\n<p>I tried to implement this approach. But it doesn't work for my case. Here is the whole code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TypeFamilies #-}\n\nimport Prelude hiding (toList)\nimport qualified Data.Foldable as Foldable (toList)\nimport Data.Text (Text, unpack)\n\nclass ToList t where\n    type Element t :: *\n    toList :: t -&gt; [Element t]\n\n-- | This instance makes 'ToList' compatible and overlappable by 'Foldable'.\ninstance {-# OVERLAPPABLE #-} Foldable f =&gt; ToList (f a) where\n    type Element (f a) = a\n    toList = Foldable.toList\n\ninstance ToList Text where\n    type Element Text = Char\n    toList = unpack\n\nnewtype WrappedList l = WrappedList l\n\ninstance ToList l =&gt; ToList (WrappedList l) where\n    type Element (WrappedList l) = Element l\n    toList (WrappedList l) = toList l\n</code></pre>\n\n<p>When I compile this code with <code>GHC-8.2.2</code> I see the following error:</p>\n\n<pre><code>Element.hs:14:10: error:\n    Conflicting family instance declarations:\n      Element (f a) = a -- Defined at Element.hs:14:10\n      Element (WrappedList l) = Element l -- Defined at Element.hs:24:10\n   |\n14 |     type Element (f a) = a\n   |          ^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>How I can fix this error? I have no idea how make this compilable with associated type family...</p>\n"}, {"tags": ["haskell", "compiler-errors", "delay", "sleep"], "answers": [{"comments": [{"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "edited": false, "score": 1, "creation_date": 1513263854, "post_id": 47816305, "comment_id": 82594350, "body": "Ok, not very useful error message. I would expect something like <code>unknown symbol &quot;delay&quot;</code>... in fact, it does seem to know the symbol, as it knowns the function&#39;s signature. So then why do I need to import the definition? And also... what would I need to import to use that actual <code>delay</code> function rather than <code>threadDelay</code>?"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "edited": false, "score": 10, "creation_date": 1513264082, "post_id": 47816305, "comment_id": 82594491, "body": "It knows the type because of <i>type inference</i>. The function with the <i>required</i> signature doesn&#39;t exist, though, so you get an error message. Then, the <code>delay</code> function is non-standard, and you need to install a 3rd party package called <code>concurrent-extra</code>, as the link suggests. Then you <code>import Control.Concurrent.Thread.Delay</code>, and that&#39;s it. I&#39;m not sure why you need that specific function since <code>threadDelay</code> is the standard way to suspend program execution in Haskell."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1513269388, "post_id": 47816305, "comment_id": 82598095, "body": "@ForceBru When I first started looking for a delay function, the first search term which came up was this extra package, and I mistakenly used that for a while before realising there was a version in Control.Concurrent. So possibly just search engines turning up the wrong thing."}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": true, "score": 16, "last_activity_date": 1513263407, "creation_date": 1513263407, "answer_id": 47816305, "question_id": 47816174, "link": "https://stackoverflow.com/questions/47816174/how-to-sleep-or-delay-the-thread-in-haskell/47816305#47816305", "title": "How to sleep or delay the thread in Haskell?", "body": "<p>Well, you have to import <code>Control.Concurrent</code> first:</p>\n\n<pre><code>import Control.Concurrent\n\nthreadDelay 1000000 --sleep for a million microseconds, or one second\n</code></pre>\n"}], "owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4122, "favorite_count": 0, "accepted_answer_id": 47816305, "answer_count": 1, "score": 9, "last_activity_date": 1596022767, "creation_date": 1513263005, "last_edit_date": 1596022767, "question_id": 47816174, "link": "https://stackoverflow.com/questions/47816174/how-to-sleep-or-delay-the-thread-in-haskell", "title": "How to sleep or delay the thread in Haskell?", "body": "<p>This really shouldn't be so difficult to find an answer to, but alas I don't... I want to delay the next execution step in a <code>do</code> block. I have found the functions\n<code>delay</code>,\n<code>sleep</code>,\n<code>nanosleep</code> and\n<code>usleep</code>.</p>\n\n<p>And also this question, that doesn't cover how to use any of these, however: <a href=\"https://stackoverflow.com/questions/25576184/sleep-in-haskell\">Sleep in Haskell</a>.</p>\n\n<p>I am getting the same error for all of these, so probably I am doing something wrong fundamentally:</p>\n\n<blockquote>\n  <p><code>Variable not in scope: delay :: Integer -&gt; IO a0</code></p>\n</blockquote>\n\n<p>This is my test snippet:</p>\n\n<pre><code>main = do\n  {\n    putStrLn \"line 1\"\n  ; delay 2\n  ; putStrLn \"line 2\"\n  }\n</code></pre>\n\n<p>Googling the error does not actually yield anything useful for some reason.</p>\n"}, {"tags": ["haskell", "continuations"], "comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1513262675, "post_id": 47815941, "comment_id": 82593504, "body": "If you define <code>join</code> by <code>&gt;&gt;= id</code>, isn&#39;t it always trivial?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 1, "creation_date": 1513262979, "post_id": 47815941, "comment_id": 82593719, "body": "@JoshLee if you define <code>a + b = a - negate b</code>, isn&#39;t it always trivial?"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1513263206, "post_id": 47815941, "comment_id": 82593874, "body": "This would imply <code>Cont r (Cont r a) = Cont r a</code>, but e.g. for <code>Maybe</code>, we could not say that (because the outer Maybe could be Nothing)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513276565, "post_id": 47815941, "comment_id": 82602190, "body": "<code>Cont r a</code> is <i>not</i> isomorphic to <code>a</code>. <code>foo :: Cont Int a; foo = cont (\\_ -&gt; 8)</code> is a good example."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1513277097, "post_id": 47815941, "comment_id": 82602490, "body": "Given <code>newtype Yoneda f a = Yoneda {runYoneda :: forall r. (a -&gt; r) -&gt; f r}</code>, <code>Yoneda f</code> is isomorphic to <code>f</code> for any <code>Functor</code> <code>f</code>. So in particular, <code>Yoneda Identity a ~= a</code>. But while <code>Yoneda</code> looks an awful lot like <code>ContT</code>, that quantified result type makes it behave very differently."}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1513262362, "creation_date": 1513262362, "question_id": 47815941, "link": "https://stackoverflow.com/questions/47815941/is-join-for-a-continuation-monad-always-trivial", "title": "Is `join` for a continuation monad always trivial?", "body": "<p>Continuations are pretty trivial because <code>Cont r a ~ a</code>.</p>\n\n<p>I have worked out <code>join</code> to be:</p>\n\n<pre><code>join :: Cont r (Cont r a) -&gt; Cont r a\njoin m = cont $ runCont m (\\x -&gt; runCont x)\n</code></pre>\n\n<p>Basically <code>join</code> transforms: <code>(((a -&gt; r) -&gt; r) -&gt; r) -&gt; r</code> to: <code>(a -&gt; r) -&gt; r</code>. So it seems to be that <code>join</code> doesn't really do anything at all, but reduce redundancy. Is this correct?</p>\n"}, {"tags": ["haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513255047, "post_id": 47813540, "comment_id": 82588336, "body": "<code>k</code> is the <code>k</code> typeparameter that binds with <code>Assoc</code>, so <code>k</code> is the &quot;key&quot; type."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1513290569, "last_edit_date": 1513290569, "creation_date": 1513255460, "answer_id": 47813702, "question_id": 47813540, "link": "https://stackoverflow.com/questions/47813540/haskell-datatypes-with-unknown-types/47813702#47813702", "title": "Haskell Datatypes with unknown types", "body": "<p>The <code>i</code> in <code>class Index i</code> stands for a type constructor of kind <code>* -&gt; *</code>. That is, <code>i</code> can be something like <code>Maybe</code>, <code>[]</code>, <code>IO</code>. More to the point <code>i</code> can also be <code>Assoc</code>.</p>\n\n<p>Note that <code>i</code> on its own is not a type, but a type constructor, like <code>Assoc</code> on its own is not a type. Instead <code>i k</code> is a type like <code>Assoc k</code> is a type.</p>\n\n<p>The instance you need to write has the following methods to be defined:</p>\n\n<pre><code>instance Index Assoc where\n  findEntry :: Eq k =&gt; k -&gt; Assoc k -&gt; Maybe Entry\n  empty     :: Eq k =&gt; Assoc k\n  singleton :: Eq k =&gt; k -&gt; Entry -&gt; Assoc k\n  (&lt;+&gt;)     :: Eq k =&gt; Assoc k -&gt; Assoc k -&gt; Assoc k\n</code></pre>\n\n<p>You should now be able to fill in the actual definitions.</p>\n"}], "owner": {"reputation": 1375, "user_id": 1881719, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f9d319fb5c2669d9bab860c9b2227505?s=128&d=identicon&r=PG", "display_name": "Wouter Vandenputte", "link": "https://stackoverflow.com/users/1881719/wouter-vandenputte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 47813702, "answer_count": 1, "score": 0, "last_activity_date": 1513290569, "creation_date": 1513254932, "last_edit_date": 1513261932, "question_id": 47813540, "link": "https://stackoverflow.com/questions/47813540/haskell-datatypes-with-unknown-types", "title": "Haskell Datatypes with unknown types", "body": "<p>For an assignment, the following codes was given</p>\n\n<pre><code>-- 2. Index\n\nclass Index i where\n  findEntry :: Eq k =&gt; k -&gt; i k -&gt; Maybe Entry\n  empty     :: Eq k =&gt; i k\n  singleton :: Eq k =&gt; k -&gt; Entry -&gt; i k\n  (&lt;+&gt;)     :: Eq k =&gt; i k -&gt; i k -&gt; i k\n\n-- a. Complete the definition of Assoc\ndata Assoc k\n  = MkAssoc [(k,Entry)]\n  deriving (Eq,Show)\n\n-- b. Complete the instance of Index for Assoc\ninstance Index Assoc where\n</code></pre>\n\n<p>I'm now completely stuck at question 2.b. How do I make the empty and findEntry and the other things? Where does the 'k' come from in index? How come the output of some functions is (i k)? That't not even a type.</p>\n"}, {"tags": ["c++", "linux", "haskell", "haskell-ffi"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1513262575, "post_id": 47813267, "comment_id": 82593422, "body": "Cabal has <code>foreign-library</code> stanza, but I dunno how to express it in terms of <code>ghc</code>."}], "owner": {"reputation": 2903, "user_id": 2999490, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b7f26ca67a6c76bc65e02045892c6a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2999490/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513254400, "creation_date": 1513254113, "last_edit_date": 1513254400, "question_id": 47813267, "link": "https://stackoverflow.com/questions/47813267/how-to-generate-static-library-with-haskell-ffi", "title": "how to generate static library with Haskell FFI?", "body": "<p>to compile a haskell library to use in C++ today I use stack ghc:</p>\n\n<pre><code>stack ghc -- -c -dynamic -fPIC -XHaskell2010 -XOverloadedStrings TestFFI.hs\n\nstack ghc -- --make -dynamic -shared -fPIC -XHaskell2010 -XOverloadedStrings TestFFI.hs -o libTestFFI.so\n\ngcc -fPIC -c test.c -I`stack ghc -- --print-libdir`/include\n\nstack ghc --package Test -- -o libTest.so -shared -dynamic -fPIC TestFFI.o -lHSrts-ghc8.0.2 -lHStimezone-olson-0.1.7-Ib9s8yi63Kn858Rr44Ixqe-ghc8.0.2 test.o\n</code></pre>\n\n<p>It works, but it has a problem for deploy, when I use ldd command on generated library, all the path is pointing for my HOME folder, I would like to generate a static library, with static dependencies, to avoid install Haskell on the user system.</p>\n\n<p>Ps: I will use Haskell library on C++ code, but Haskell FFI works only with C.</p>\n"}, {"tags": ["haskell", "category-theory"], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 1, "last_activity_date": 1513257225, "creation_date": 1513257225, "answer_id": 47814265, "question_id": 47812823, "link": "https://stackoverflow.com/questions/47812823/overview-of-edward-kmetts-packages-for-haskell/47814265#47814265", "title": "Overview of Edward Kmetts packages for Haskell", "body": "<p><a href=\"http://hackage.haskell.org/package/category-extras\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/category-extras</a> \u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47814265, "answer_count": 1, "score": -2, "last_activity_date": 1513257225, "creation_date": 1513252646, "question_id": 47812823, "link": "https://stackoverflow.com/questions/47812823/overview-of-edward-kmetts-packages-for-haskell", "title": "Overview of Edward Kmetts packages for Haskell", "body": "<p>I remember at one point seeing an overview of Kmetts packages in some Haskell package, but I don't find it anymore.</p>\n\n<p>It showed all of Kmetts packages (or at least a significant subset) and all the dependencies between them.</p>\n\n<p>Can somebody direct me to where I can find it?</p>\n"}, {"tags": ["json", "haskell", "integration-testing", "yesod", "yesod-test"], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1513258268, "creation_date": 1513258268, "answer_id": 47814568, "question_id": 47812758, "link": "https://stackoverflow.com/questions/47812758/assert-json-matches-using-yesod-test/47814568#47814568", "title": "Assert json matches using Yesod.Test", "body": "<p>It looks to me like you acquire an <code>SResponse</code> in a <code>Session</code> do block as per <a href=\"https://hackage.haskell.org/package/wai-test-0.1.1/docs/Network-Wai-Test.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/wai-test-0.1.1/docs/Network-Wai-Test.html</a> (googled <code>SResponse</code> and checked that the module matched one imported by <a href=\"https://hackage.haskell.org/package/yesod-test-json-0.2.0.0/docs/src/Yesod-Test-Json.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/yesod-test-json-0.2.0.0/docs/src/Yesod-Test-Json.html</a>), choose a type <code>a</code> that you want to assert the JSON to encode, construct a function <code>a -&gt; (String, Bool)</code> whose second argument specifies whether your desired property holds and whose first argument specifies the error to output otherwise (should have been <code>a -&gt; Either String Bool</code> imo) (checked the source), then apply <code>assertJSON</code> to the function and the <code>SResponse</code> within that same do block to express the assertion.</p>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513258268, "creation_date": 1513252450, "question_id": 47812758, "link": "https://stackoverflow.com/questions/47812758/assert-json-matches-using-yesod-test", "title": "Assert json matches using Yesod.Test", "body": "<p>I wan't to get a resource from my yesod app and assert it matches a known JSON value.</p>\n\n<p>I can see that in <code>Yesod.Test.Json</code> there is the function <code>assertJSON</code> with the type </p>\n\n<pre><code>assertJSON :: (ToJSON a, FromJSON a) =&gt; (a -&gt; (String, Bool)) -&gt; SResponse -&gt; Session ()\n</code></pre>\n\n<p>But there is no example usage and I can't work out how this is used from the type alone.</p>\n\n<p>How would I be able to check that the JSON returned from my yesod app matches?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1513243378, "post_id": 47809765, "comment_id": 82580699, "body": "An <code>Ordering</code> has three values <code>LT</code>, <code>GT</code> and <code>EQ</code>, so that would mean that the negation of <code>LT</code> is <code>GT</code> <b>or</b> <code>EQ</code>, but we can not represent such union as an <code>Ordering</code>."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1513244330, "post_id": 47809765, "comment_id": 82581267, "body": "So it is not possible to make <code>LT</code> into <code>GT</code>, <code>GT</code> into <code>LT</code>, leaving <code>EQ</code> intact, all in one operation?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1513244629, "post_id": 47809765, "comment_id": 82581489, "body": "Sure that is possible, but it makes no sense that <code>EQ = not EQ</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "is_accepted": true, "score": 12, "last_activity_date": 1513244381, "creation_date": 1513244381, "answer_id": 47810136, "question_id": 47809765, "link": "https://stackoverflow.com/questions/47809765/haskell-negate-a-value-of-type-ordering/47810136#47810136", "title": "Haskell: negate a value of type Ordering", "body": "<p>If you are getting the Ordering from <code>compare</code>, then you can change\nit to <code>flip compare</code>:</p>\n\n<pre><code>&gt; flip compare 3 4\nGT\n</code></pre>\n\n<p>Or you can wrap the values in <code>Down</code> from <code>Data.Ord</code>, a newtype that\nexists to reverse the ordering of things:</p>\n\n<pre><code>&gt; compare (Down 3) (Down 4)\nGT\n</code></pre>\n\n<p>If you can't or don't want to change the place that the Ordering comes\nfrom, you'll need a function to invert it and I don't know of a\nbuilt-in one.  You can write the obvious pattern match, or since\nOrdering is itself ordered:</p>\n\n<pre><code>inv :: Ordering -&gt; Ordering\ninv = compare EQ\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9098992, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/23db07bc591cda0e40320f7cad7db5c7?s=128&d=identicon&r=PG", "display_name": "wiegert", "link": "https://stackoverflow.com/users/9098992/wiegert"}, "is_accepted": false, "score": -1, "last_activity_date": 1513264486, "last_edit_date": 1513264486, "creation_date": 1513256318, "answer_id": 47813981, "question_id": 47809765, "link": "https://stackoverflow.com/questions/47809765/haskell-negate-a-value-of-type-ordering/47813981#47813981", "title": "Haskell: negate a value of type Ordering", "body": "<p>Yes it is contained in Data.Ord and is a type called <code>Down</code>.</p>\n\n<p>I cite:</p>\n\n<blockquote>\n  <p>\"If a has an Ord instance associated with it then comparing two values\n  thus wrapped will give you the opposite of their normal sort order.\"</p>\n</blockquote>\n\n<p>Reference: \n<a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Ord.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Ord.html</a></p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 47810136, "answer_count": 2, "score": 1, "last_activity_date": 1513264486, "creation_date": 1513243124, "question_id": 47809765, "link": "https://stackoverflow.com/questions/47809765/haskell-negate-a-value-of-type-ordering", "title": "Haskell: negate a value of type Ordering", "body": "<p>Is there a way to negate or invert a value of type Ordering? Something like this:</p>\n\n<pre><code>inv = not compare\n</code></pre>\n"}, {"tags": ["haskell", "dependent-type"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513239480, "post_id": 47808108, "comment_id": 82578522, "body": "BTW <code>data Iso a b = Iso { toA :: b -&gt; a, toB :: a -&gt; b }</code> will serve you much better than your class -- not in solving this problem, just in general."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1513271036, "post_id": 47808108, "comment_id": 82599113, "body": "<code>Vec (&#39;S n) a</code> and <code>Cofree (&#39;S n) Maybe a</code> are not isomorphic, so you&#39;ll have quite a bit of difficulty proving they are."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1513272068, "post_id": 47808108, "comment_id": 82599693, "body": "Please provide an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> with the right imports, language extensions, etc."}, {"owner": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513289774, "post_id": 47808108, "comment_id": 82608542, "body": "@luqui Why is that data structure more useful? Classes seem more intuitive to me, but my intuition could definitely be wrong on this (I&#39;m a bit of a beginner)."}, {"owner": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1513289778, "post_id": 47808108, "comment_id": 82608544, "body": "@gallais Thank you for the link, that was very useful. I think I&#39;ve added everything I needed."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1513320109, "post_id": 47808108, "comment_id": 82616396, "body": "@JackBrandt, just take it as a suggestion, it&#39;s worth experimenting with both ways to understand the ins and outs."}, {"owner": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "edited": false, "score": 0, "creation_date": 1513369427, "post_id": 47808108, "comment_id": 82642663, "body": "Ok, cool. I&#39;ve tried both before, but never really compared the two. Was mostly wondering the differences."}], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1513272839, "post_id": 47808678, "comment_id": 82600134, "body": "Typo: <code>VCons x VNil</code> has type <code>Vec (&#39;S &#39;Z) a</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1513272888, "last_edit_date": 1513272888, "creation_date": 1513239203, "answer_id": 47808678, "question_id": 47808108, "link": "https://stackoverflow.com/questions/47808108/could-not-deduce-with-dependent-typing/47808678#47808678", "title": "Could Not Deduce with Dependent Typing", "body": "<p>You don't get to choose the value of <code>n</code>. The caller of <code>toA</code> chooses that, and the definition of <code>toA</code> must be compatible with any choice.</p>\n\n<p>Since there is no guarantee that the caller chooses <code>n ~ 'Z</code>, the type checker complains.</p>\n\n<p>Indeed, <code>x :&lt;&lt; Nothing</code> can have type <code>Cofree ('S n) Maybe a</code>\nbut <code>VCons x VNil</code> only has type <code>Vec ('S 'Z) a</code> and not <code>Vec ('S n) a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "edited": false, "score": 0, "creation_date": 1513289618, "post_id": 47819100, "comment_id": 82608461, "body": "So if I was planning on doing this with other functors, like Either and [], would I need to use dependently typed versions of them?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "edited": false, "score": 1, "creation_date": 1513289842, "post_id": 47819100, "comment_id": 82608569, "body": "Probably, yeah."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 1, "last_activity_date": 1513272799, "creation_date": 1513272799, "answer_id": 47819100, "question_id": 47808108, "link": "https://stackoverflow.com/questions/47808108/could-not-deduce-with-dependent-typing/47819100#47819100", "title": "Could Not Deduce with Dependent Typing", "body": "<p>The problem here is that you may pick <code>Maybe</code>'s <code>Nothing</code> constructor whenever you want but you can only use <code>Vec</code>'s <code>VNil</code> constructor when the index is <code>Z</code>. This mismatch makes the isomorphism impossible to implement.</p>\n\n<p>You can however salvage the situation by:</p>\n\n<ul>\n<li>changing the definition of indexed <code>Cofree</code> so that its argument <code>f</code> is also indexed</li>\n<li>introducing a variant of <code>Maybe</code> where you may only use the <code>Nothing</code> constructor when the index is <code>Z</code></li>\n</ul>\n\n<p>In other words:</p>\n\n<pre><code>data ICofree (n :: Nat) f a where\n  (:&lt;&lt;) :: a -&gt; f n (ICofree n f a) -&gt; ICofree ('S n) f a\n\ndata IMaybe (n :: Nat) a where\n  INothing :: IMaybe 'Z a\n  IJust    :: a -&gt; IMaybe ('S n) a\n\ninstance Iso (Vec n a) (ICofree n IMaybe a) where\n  toA (x :&lt;&lt; INothing) = VCons x VNil\n  toA (x :&lt;&lt; IJust xs) = VCons x (toA xs)\n\n  toB (VCons x VNil)       = x :&lt;&lt; INothing\n  toB (VCons x xs@VCons{}) = x :&lt;&lt; IJust (toB xs)\n</code></pre>\n\n<p>And <a href=\"https://gist.github.com/gallais/673b6e175032eef9f5fed1734b777912\" rel=\"nofollow noreferrer\">a self-contained gist</a> with the right imports, language extensions and definitions.</p>\n"}], "owner": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513289524, "creation_date": 1513236964, "last_edit_date": 1513289524, "question_id": 47808108, "link": "https://stackoverflow.com/questions/47808108/could-not-deduce-with-dependent-typing", "title": "Could Not Deduce with Dependent Typing", "body": "<p>I've been playing around with some cofree isomporphisms with dependent typing, and am getting an error message that just seems to be nonsense for me. </p>\n\n<p>My dependently typed cofree</p>\n\n<pre><code>data Cofree (n :: Nat) f a where\n  (:&lt;&lt;) :: a -&gt; f (Cofree n f a) -&gt; Cofree ('S n) f a\n</code></pre>\n\n<p>and isomorphism code</p>\n\n<pre><code>class Iso a b where\n  toA :: b -&gt; a\n  toB :: a -&gt; b\n</code></pre>\n\n<p>and my (very basic) instance (it's missing a lot of stuff but I want to just take care of the basics first)</p>\n\n<pre><code>instance Iso (Vec ('S n) a) (Cofree ('S n) Maybe a) where\n  toA :: Cofree ('S n) Maybe a -&gt; Vec ('S n) a\n  toA (x :&lt;&lt; Nothing) = VCons x VNil\n</code></pre>\n\n<p>I figured that'd be the most basic thing possible, but it still type errors.</p>\n\n<p>The error itself:</p>\n\n<pre><code>interactive&gt;:224:127: error:\n    * Could not deduce: n1 ~ 'Z\n      from the context: 'S n ~ 'S n1\n        bound by a pattern with constructor:\n               :&lt;&lt; :: forall (f :: * -&gt; *) a (n :: Nat).\n                      a -&gt; f (Cofree n f a) -&gt; Cofree ('S n) f a,\n             in an equation for `toA'\n    at &lt;interactive&gt;:224:112-122\n  `n1' is a rigid type variable bound by\n    a pattern with constructor:\n      :&lt;&lt; :: forall (f :: * -&gt; *) a (n :: Nat).\n             a -&gt; f (Cofree n f a) -&gt; Cofree ('S n) f a,\n    in an equation for `toA'\n    at &lt;interactive&gt;:224:112\n  Expected type: Vec ('S n) a\n    Actual type: Vec ('S 'Z) a\n* In the expression: VCons x VNil\n  In an equation for `toA': toA (x :&lt;&lt; Nothing) = VCons x VNil\n  In the instance declaration for\n    `Iso (Vec ('S n) a) (Cofree ('S n) Maybe a)' \n</code></pre>\n\n<p>which seems weird, since I don't get why it can't substitute 'Z in for n1 in the type equation, since that seems to solve it. </p>\n\n<p>I tried doing the hole thing (so instead in my definition I had:</p>\n\n<pre><code>= _ $ VCons x VNil\n</code></pre>\n\n<p>which returned </p>\n\n<pre><code> Found hole: _ :: Vec ('S 'Z) a -&gt; Vec ('S n) a\n</code></pre>\n\n<p>which seems weird, since why couldn't I just supply id in there, it matches 'Z with n, and boom, solved?</p>\n\n<p>By the way, the definitions for Nat and Vec I think are pretty normal so I didn't want to clutter up this post with more code than I needed, so I can provide them if it would be easier for somebody. </p>\n\n<p>EDIT:\nThe Nat I used was </p>\n\n<pre><code>data Nat = Z | S Nat\n</code></pre>\n\n<p>and the Vec I used was</p>\n\n<pre><code>data Vec (n :: Nat) a where\n  VNil :: Vec 'Z a\n  VCons :: a -&gt; Vec n a -&gt; Vec ('S n) a\n</code></pre>\n\n<p>and no imports necessary, but GADTs, DataKinds, MultiParamTypeClasses, KindSignatures, and FlexibleInstances are necessary, and maybe PolyKinds? I don't quite remember. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1513218370, "post_id": 47804537, "comment_id": 82571499, "body": "Using <a href=\"https://hackage.haskell.org/package/multimap-1.2.1/docs/Data-MultiMap.html\" rel=\"nofollow noreferrer\"><code>Data.MultiMap</code></a> you could do <code>assocs . fromList</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1513223210, "post_id": 47804537, "comment_id": 82572582, "body": "Even with just <code>Data.Map</code>, you could use <code>assocs . (unionsWith (++)) . map (\\(x,y) -&gt; M.singleton x [y])</code>"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1513227437, "post_id": 47804537, "comment_id": 82573618, "body": "<code>assocs . fromListWith (++) . (map . fmap) (:[])</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18168, "user_id": 47552, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/20c0f42cfd92cb56a020ef5bce95621d?s=128&d=identicon&r=PG", "display_name": "Matt McHenry", "link": "https://stackoverflow.com/users/47552/matt-mchenry"}, "is_accepted": false, "score": 4, "last_activity_date": 1513219270, "last_edit_date": 1513219270, "creation_date": 1513215696, "answer_id": 47804683, "question_id": 47804537, "link": "https://stackoverflow.com/questions/47804537/combining-the-second-element-of-a-tuple-into-a-list-based-on-the-first-element/47804683#47804683", "title": "Combining the second element of a tuple into a list based on the first element", "body": "<p>I didn't understand what you were trying to do in your code, so I had to build up to it myself.  Here's how I approached it: We'll put our starting list in <code>x</code> to make testing simple:</p>\n\n<pre><code>&gt; x = [('a', \"Hello\"),('b', \"Goodbye\"), ('a', \"World\"), ('b', \"World\")] \n</code></pre>\n\n<p>and then import the <code>groupBy</code> function:</p>\n\n<pre><code>Prelude&gt; import Data.List\nPrelude Data.List&gt; :t groupBy\ngroupBy :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>So we can start with grouping by the first element of the tuple:</p>\n\n<pre><code>&gt; groupBy (\\x y -&gt; fst x == fst y) x\n[[('a',\"Hello\")],[('b',\"Goodbye\")],[('a',\"World\")],[('b',\"World\")]]\n</code></pre>\n\n<p>Ah, but that didn't work because the matching elements aren't next to each other, so we need a <code>sort</code>:</p>\n\n<pre><code>&gt; groupBy (\\x y -&gt; fst x == fst y) $ sort x\n[[('a',\"Hello\"),('a',\"World\")],[('b',\"Goodbye\"),('b',\"World\")]]\n</code></pre>\n\n<p>There is another nice function that lets us make this more succinct, <code>on</code>:</p>\n\n<pre><code>Prelude Data.List&gt; import Data.Function\nPrelude Data.List Data.Function&gt; :t on\non :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c\n</code></pre>\n\n<p>Which lets us do this:</p>\n\n<pre><code>&gt; groupBy ((==) `on` fst) $ sort x\n[[('a',\"Hello\"),('a',\"World\")],[('b',\"Goodbye\"),('b',\"World\")]]\n</code></pre>\n\n<p>The lists we want are just the second halves of those tuples:</p>\n\n<pre><code>&gt; map (snd) $ map unzip $ groupBy ((==) `on` fst) $ sort x\n[[\"Hello\",\"World\"],[\"Goodbye\",\"World\"]]\n</code></pre>\n\n<p>And the letters are the first halves -- they're all grouped, so we can just take the <code>head</code> of them:</p>\n\n<pre><code>&gt; map (head . fst) $ map unzip $ groupBy ((==) `on` fst) $ sort x\n\"ab\"\n</code></pre>\n\n<p>(read that result as <code>['a', 'b']</code> -- a string is just a list of characters.)  Now we're very close, and it seems like there ought to be a way to compose the <code>(,)</code> function (tuple construction) with our two <code>head . fst</code> and <code>snd</code> functions.  But I haven't come up with that yet.</p>\n\n<p>Instead, inspired by <a href=\"https://stackoverflow.com/a/47804730/47552\">@karakfa's answer</a>, I made use of a helper:</p>\n\n<pre><code>&gt; mapFst f (a, b) = (f a, b)\n&gt; :t mapFst\nmapFst :: (t2 -&gt; t1) -&gt; (t2, t) -&gt; (t1, t)\n</code></pre>\n\n<p>To arrive at:</p>\n\n<pre><code>&gt; map (mapFst head) $ map unzip $ groupBy ((==) `on` fst) $ sort x\n[('a',[\"Hello\",\"World\"]),('b',[\"Goodbye\",\"World\"])]\n</code></pre>\n\n<p>Swapping out <code>.</code> for <code>$</code> yields an actual function w/o explicit reference to our <code>x</code> test value:</p>\n\n<pre><code>&gt; (map (mapFst head) . map unzip . groupBy ((==) `on` fst) . sort) x\n[('a',[\"Hello\",\"World\"]),('b',[\"Goodbye\",\"World\"])]\n</code></pre>\n\n<p>And finally, two <code>map</code> composed together can be collapsed:</p>\n\n<pre><code>&gt; (map (mapFst head . unzip) . groupBy ((==) `on` fst) . sort) x\n[('a',[\"Hello\",\"World\"]),('b',[\"Goodbye\",\"World\"])]\n</code></pre>\n\n<p>And its type is as we'd expect:</p>\n\n<pre><code>&gt; :t (map (mapFst head . unzip) . groupBy ((==) `on` fst) . sort)\n(map (mapFst head . unzip) . groupBy ((==) `on` fst) . sort)\n  :: (Ord b, Ord t1) =&gt; [(t1, b)] -&gt; [(t1, [b])]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1513216029, "creation_date": 1513216029, "answer_id": 47804730, "question_id": 47804537, "link": "https://stackoverflow.com/questions/47804537/combining-the-second-element-of-a-tuple-into-a-list-based-on-the-first-element/47804730#47804730", "title": "Combining the second element of a tuple into a list based on the first element", "body": "<p>you have name mix-up (foo vs edge)</p>\n\n<p>essentially the same code</p>\n\n<pre><code>import Data.List(sort,groupBy)\nimport Data.Function(on)\n\nmap (mapFst head . unzip) . groupBy ((==) `on` fst) . sort \n    where mapFst f (a, b) = (f a, b)\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>[('a',[\"Hello\",\"World\"]),('b',[\"Goodbye\",\"World\"])]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 0, "last_activity_date": 1513228985, "last_edit_date": 1513228985, "creation_date": 1513225117, "answer_id": 47805851, "question_id": 47804537, "link": "https://stackoverflow.com/questions/47804537/combining-the-second-element-of-a-tuple-into-a-list-based-on-the-first-element/47805851#47805851", "title": "Combining the second element of a tuple into a list based on the first element", "body": "<p>You could also use <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-IntMap-Strict.html#v:fromListWith\" rel=\"nofollow noreferrer\"><code>fromListWith</code></a> from <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-IntMap-Strict.html\" rel=\"nofollow noreferrer\"><code>Data.Map.Strict</code></a> to do this:</p>\n\n<pre><code>import Data.Map.Strict (fromListWith, toList)\nimport Data.List (sort)\n\ngroupTuples :: [(Char, String)] -&gt; [(Char, [String])]\ngroupTuples tuples = [(k, sort v) | (k, v) &lt;- grouped]\n    where grouped = toList $ fromListWith (++) [(k, [v]) | (k, v) &lt;- tuples]\n</code></pre>\n\n<p>Which works as follows:</p>\n\n<pre><code>*Main&gt; groupTuples [('a', \"Hello\"),('b', \"Goodbye\"), ('a', \"World\"), ('b', \"World\")]\n[('a',[\"Hello\",\"World\"]),('b',[\"Goodbye\",\"World\"])]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8566256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3c79cd07c6ade981058759288c6abfcf?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/8566256/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "closed_date": 1513227957, "answer_count": 3, "score": 3, "last_activity_date": 1513228985, "creation_date": 1513214549, "last_edit_date": 1513215622, "question_id": 47804537, "link": "https://stackoverflow.com/questions/47804537/combining-the-second-element-of-a-tuple-into-a-list-based-on-the-first-element", "closed_reason": "Duplicate", "title": "Combining the second element of a tuple into a list based on the first element", "body": "<p>I've been working on trying to get a list of strings together based on the first element in my tuple. </p>\n\n<pre><code>Ex: \n[('a', \"Hello\"),('b', \"Goodbye\"), ('a', \"World\"), ('b', \"World\")] \n-&gt; \n[('a', [\"Hello\",\"World\"]),('b',[\"Goodbye\",\"World\"])]\n</code></pre>\n\n<p>I've think I've gotten pretty close, but I'm not getting the correct output.</p>\n\n<pre><code>map (foo . unzip) . groupBy (\\st en -&gt; fst st == fst en) . sort \n     where edge (name, futureList) = (head name, futureList)\n</code></pre>\n\n<p>I'm guessing that it has something to do with the futureList at the end. I think that there needs to be a function attached to it.</p>\n"}]