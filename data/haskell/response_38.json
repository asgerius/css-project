[{"tags": ["string", "haskell", "split"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1443654469, "post_id": 32876911, "comment_id": 53585213, "body": "What&#39;s the reasoning behind leaving two <code>&#39;</code>s in the last example?"}, {"owner": {"reputation": 832, "user_id": 5395234, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/h9mdP.jpg?s=128&g=1", "display_name": "vestlen", "link": "https://stackoverflow.com/users/5395234/vestlen"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1443657086, "post_id": 32876911, "comment_id": 53585887, "body": "So the idea is parsing a very long string of any chars into words, entirely letter words <i>unless</i> the word either contains or ends with a single apostrophe, which counts as part of the word. I have most of it completed but I end up with strings like the above where my functions don&#39;t handle that particular case."}], "answers": [{"comments": [{"owner": {"reputation": 832, "user_id": 5395234, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/h9mdP.jpg?s=128&g=1", "display_name": "vestlen", "link": "https://stackoverflow.com/users/5395234/vestlen"}, "edited": false, "score": 0, "creation_date": 1443656924, "post_id": 32877091, "comment_id": 53585838, "body": "Thank you. Could you explain what&#39;s happening here? What are the * &gt; and &lt; * operators?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 832, "user_id": 5395234, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/h9mdP.jpg?s=128&g=1", "display_name": "vestlen", "link": "https://stackoverflow.com/users/5395234/vestlen"}, "edited": false, "score": 0, "creation_date": 1443657265, "post_id": 32877091, "comment_id": 53585932, "body": "<code>*&gt;</code> and <code>&lt;*</code> combine two <code>Applicative f =&gt; f x</code> values together by discarding one of the values. The value they keep is the one pointed at by the <code>&gt;</code> or <code>&lt;</code>. For parsers, the <code>char &#39;\\&#39;&#39;</code> parser requires that a <code>&#39;</code> be present in the input. The <code>*&gt;</code> and <code>&lt;*</code> operators are building a parser that still looks for those characters, but discards them and just results in the <code>many letter</code> inbetween."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 6, "last_activity_date": 1443655395, "creation_date": 1443655395, "answer_id": 32877091, "question_id": 32876911, "link": "https://stackoverflow.com/questions/32876911/haskell-how-can-i-split-a-string-whenever-there-are-two-adjacent-apostrophes/32877091#32877091", "title": "Haskell: how can I split a string whenever there are two adjacent apostrophes?", "body": "<p>Depending on exactly what you are doing, it might be easier to make a real parser.</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n\nimport Text.Parsec\nimport Text.Parsec.Char\n\nsingleQuotedStrings = many (char '\\'' *&gt; many letter &lt;* char '\\'')\n\nmain = print $ parse singleQuotedStrings [] \"'all''your''base''belong'\"\n</code></pre>\n"}], "owner": {"reputation": 832, "user_id": 5395234, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/h9mdP.jpg?s=128&g=1", "display_name": "vestlen", "link": "https://stackoverflow.com/users/5395234/vestlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 2, "accepted_answer_id": 32877091, "answer_count": 1, "score": 1, "last_activity_date": 1443671229, "creation_date": 1443654198, "last_edit_date": 1443671229, "question_id": 32876911, "link": "https://stackoverflow.com/questions/32876911/haskell-how-can-i-split-a-string-whenever-there-are-two-adjacent-apostrophes", "title": "Haskell: how can I split a string whenever there are two adjacent apostrophes?", "body": "<p>I am doing some string work that leaves me with some repeated-single-quote strings like:</p>\n\n<pre><code>all''your''base''belong\n</code></pre>\n\n<p>and I want to separate the string in between the apostrophes to get a list:</p>\n\n<pre><code>all'\n'your'\n'base'\n'belong\n</code></pre>\n\n<p>Or, even better, that would trim each word of the apostrophes <em>unless</em> it has an apostrophe only at the end, so the end result would be:</p>\n\n<pre><code>all'\nyour\nbase\nbelong\n</code></pre>\n\n<p>How could I go about doing this cleanly?</p>\n"}, {"tags": ["haskell", "haskell-lens", "category-theory", "vocabulary", "lenses"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 3, "creation_date": 1443654261, "post_id": 32876700, "comment_id": 53585159, "body": "If you reword this question to ask what the origin or meaning of the vocabulary is it won&#39;t be confused as asking for an off-site resource."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 1, "creation_date": 1443676429, "post_id": 32876700, "comment_id": 53590402, "body": "I always liked Bartosz&#39;s series, <a href=\"http://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/\" rel=\"nofollow noreferrer\">bartoszmilewski.com/2014/10/28/&hellip;</a>"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 1, "creation_date": 1443686483, "post_id": 32876700, "comment_id": 53595178, "body": "I found the lecture notes of <a href=\"http://ocw.mit.edu/courses/mathematics/18-s996-category-theory-for-scientists-spring-2013/\" rel=\"nofollow noreferrer\">&quot;Category theory for the Sciences&quot; on MIT OCW</a> very useful. The (by now slightly renewed) textbook is also available in print with exercise solutions."}], "answers": [{"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1443659272, "post_id": 32877215, "comment_id": 53586379, "body": "They&#39;re a bit more advanced (relative to <i>Conceptual Mathematics</i>), but the <a href=\"https://byorgey.wordpress.com/catsters-guide-2/#introduction\" rel=\"nofollow noreferrer\">Catsters videos</a> can make a nice addition to <i>Conceptual Mathematics</i> and <i>Category Theory</i>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1443659313, "post_id": 32877215, "comment_id": 53586390, "body": "The Catsters videos are great!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1443659922, "post_id": 32877215, "comment_id": 53586501, "body": "Definitely agreed! I&#39;ve been reading Dr. Cheng&#39;s latest book (<i>How to Bake \u03c0</i>) and, even though it is written for a primarily non-mathematical audience, it does talk about some general ideas and terminology of category theory (along with some nice baking recipes) written in her entertaining, enthusiastic style. That could be another potential resource to get some ideas about the categorical way of looking at things and some categorical topics, but it is a bit less on the technical side. Also it has, in my opinion, a very effective and clear defense of (applied and pure) mathematics."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1443667076, "post_id": 32877215, "comment_id": 53588063, "body": "@DavidYoung Her book on n-categories is also great."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 7, "last_activity_date": 1443656062, "creation_date": 1443656062, "answer_id": 32877215, "question_id": 32876700, "link": "https://stackoverflow.com/questions/32876700/resource-that-explains-vocabulary-used-in-edward-kmetts-lens-package/32877215#32877215", "title": "resource that explains vocabulary used in Edward Kmett&#39;s lens package", "body": "<p>These are terms from <a href=\"https://en.wikipedia.org/wiki/Category_theory\" rel=\"noreferrer\">category theory</a>. As for resources, Ed himself has <a href=\"https://www.quora.com/What-is-the-best-textbook-for-Category-theory\" rel=\"noreferrer\">some suggestions</a>. Personally, I second his recommendations of <a href=\"https://rads.stackoverflow.com/amzn/click/com/052171916X\" rel=\"noreferrer\" rel=\"nofollow noreferrer\">Conceptual Mathematics</a> by Lawvere and Awodey's <a href=\"https://rads.stackoverflow.com/amzn/click/com/0199237182\" rel=\"noreferrer\" rel=\"nofollow noreferrer\">Category Theory</a>.</p>\n"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 3, "accepted_answer_id": 32877215, "answer_count": 1, "score": 6, "last_activity_date": 1443656062, "creation_date": 1443652838, "question_id": 32876700, "link": "https://stackoverflow.com/questions/32876700/resource-that-explains-vocabulary-used-in-edward-kmetts-lens-package", "title": "resource that explains vocabulary used in Edward Kmett&#39;s lens package", "body": "<p>I am trying to read the documentation in  <a href=\"https://github.com/ekmett\">Edward Kmett</a>'s <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens.html\">Lens</a> package.  I am not familiar with a lot of the terms used (profunctor, isomorphism, monomorphic, contravariant, bifunctor, etc...)</p>\n\n<p>What would be a good resource to go to learn some of this vocabulary as it is used in this library. </p>\n"}, {"tags": ["haskell", "ghc", "cabal", "osx-elcapitan"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443646457, "post_id": 32874888, "comment_id": 53582283, "body": "If you can, please create an issue for this on the HP github site so it can be tracked: <a href=\"https://github.com/haskell/haskell-platform/issues\" rel=\"nofollow noreferrer\">github.com/haskell/haskell-platform/issues</a> Also - do the programs still exist in /usr/bin (but are not executable) or has upgrading completely removed them?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443646701, "post_id": 32874888, "comment_id": 53582411, "body": "Upgrading purges all of <code>&#47;usr</code> (except <code>&#47;usr&#47;local</code>) of anything not from Apple."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443646337, "post_id": 32875384, "comment_id": 53582217, "body": "Any idea whether an update of GHC or Cabal is planned that will address this. Manually moving things around seems a bit fragile."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443646383, "post_id": 32875384, "comment_id": 53582242, "body": "BTW: Copying isn&#39;t an option since it appears the EC install removes anything it dislikes in <code>&#47;usr</code>."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1443646211, "creation_date": 1443646211, "answer_id": 32875384, "question_id": 32874888, "link": "https://stackoverflow.com/questions/32874888/haskell-and-cabal-missing-after-el-capitan-update/32875384#32875384", "title": "Haskell and Cabal missing after El Capitan update", "body": "<p>I believe El Capitan does not allow users to change <code>/usr</code> anymore which is where the Haskell binaries are installed.</p>\n\n<p>If you can copy/install the programs into <code>/usr/local/bin</code> they should work from there.</p>\n\n<p>If the programs are not visible anymore in /usr/bin, I would suggest reinstalling the HP into a different partition. Then copy them to /usr/local.</p>\n\n<p>Let me know how it goes.</p>\n"}, {"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443646839, "post_id": 32875466, "comment_id": 53582467, "body": "That&#39;s a good idea. How do I get rid of my existing Haskell Platform installation (I&#39;d like to clean that up first)? Will my existing packages in <code>&#47;Users&#47;Roy&#47;Library&#47;Haskell&#47;ghc-7.10.2-x86_64&#47;lib</code> remain, and can I still use them?"}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 2, "creation_date": 1443647549, "post_id": 32875466, "comment_id": 53582767, "body": "You can simply delete the files (the installation and package dirs) in case there&#39;s no better way. I wouldn&#39;t expect any conflicts to arise though even if you don&#39;t do anything. The Brew-installed Cabal uses a different directory structure, so you&#39;d have to mess around a little to keep the packages, but I&#39;d rather just drop them and let Cabal do its job and install them when required."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443650242, "post_id": 32875466, "comment_id": 53583911, "body": "Sounds promising. Where does Homebrew put installed packages? For that matter where did it put the executables for <code>stylish-haskell</code> and <code>hlint</code>\u2014 I can&#39;t find them?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443650695, "post_id": 32875466, "comment_id": 53584083, "body": "I also seem to have a <code>~&#47;Library&#47;Haskell</code> still around, which I assume I should remove (Homebrew <code>cabal install</code> shouldn&#39;t be putting things there right?)"}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1443676831, "post_id": 32875466, "comment_id": 53590530, "body": "Right. You can just drop the old stuff. Both libraries and executables of the &quot;homebrewed&quot; setup get installed in subdirs of <code>~&#47;.cabal</code>."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 12, "last_activity_date": 1449257897, "last_edit_date": 1449257897, "creation_date": 1443646576, "answer_id": 32875466, "question_id": 32874888, "link": "https://stackoverflow.com/questions/32874888/haskell-and-cabal-missing-after-el-capitan-update/32875466#32875466", "title": "Haskell and Cabal missing after El Capitan update", "body": "<p>I've found the following approach most reliable on all versions of OSX including El Capitan.</p>\n\n<ol>\n<li><p><a href=\"http://brew.sh/\">Install Homebrew</a></p></li>\n<li><p>Run <code>brew install ghc</code></p></li>\n<li><p>Run <code>brew install cabal-install</code></p></li>\n</ol>\n\n<p>This approach allows you to easily install the latest versions and have multiple versions installed and easily switch between them using the <code>brew switch</code> command. Haskell Platform lacks these properties, which is why the advanced users tend to avoid it any way.</p>\n"}, {"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1443704583, "post_id": 32876226, "comment_id": 53606325, "body": "FWIW, I tested the candidate out last night, and it seems to work perfectly. (And I already reported this to sclv last night, so this doesn&#39;t count as an extra report of success.)"}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 10, "last_activity_date": 1450116786, "last_edit_date": 1492087506, "creation_date": 1443649987, "answer_id": 32876226, "question_id": 32874888, "link": "https://stackoverflow.com/questions/32874888/haskell-and-cabal-missing-after-el-capitan-update/32876226#32876226", "title": "Haskell and Cabal missing after El Capitan update", "body": "<p><strong>Edit: There is now a <a href=\"https://www.haskell.org/platform/mac.html#osx-none\" rel=\"nofollow noreferrer\">released version</a> that fixes these issues.</strong></p>\n\n<p>This is all caused by the new \"<a href=\"https://apple.stackexchange.com/questions/193368/what-is-the-rootless-feature-in-el-capitan-really\">rootless security</a>\" features in El Capitan.</p>\n\n<p>You don't need to copy or reinstall the programs -- the files in <code>/usr/bin</code> were always just symlinks, to things available in <code>/Library/Frameworks/GHC.framework/</code> and <code>/Library/Frameworks/HaskellPlatform.framework</code>. So you should be able to symlink them again (to <code>/usr/local/bin</code> this time) from there.</p>\n\n<p>See also <a href=\"https://github.com/haskell/haskell-platform/issues/205\" rel=\"nofollow noreferrer\">https://github.com/haskell/haskell-platform/issues/205</a></p>\n\n<p>Hopefully a new platform release that fixes these issues will be out soon.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3452, "favorite_count": 6, "accepted_answer_id": 32875466, "answer_count": 3, "score": 7, "last_activity_date": 1450116786, "creation_date": 1443644356, "question_id": 32874888, "link": "https://stackoverflow.com/questions/32874888/haskell-and-cabal-missing-after-el-capitan-update", "title": "Haskell and Cabal missing after El Capitan update", "body": "<p>Following an upgrade to OS X El Capitan, Cabal and GHC are no longer found on my system:</p>\n\n<pre><code>-bash: ghc: command not found\n-bash: cabal: command not found\n</code></pre>\n\n<p>What do I need to do to get Cabal and GHC working on OS X El Capitan?</p>\n"}, {"tags": ["haskell", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443645111, "post_id": 32874921, "comment_id": 53581620, "body": "I like this answer, though! I guess I wasn&#39;t really looking for Applicative answers specifically, so much as ways to use the standard library to remove the duplication."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 22, "last_activity_date": 1443644484, "creation_date": 1443644484, "answer_id": 32874921, "question_id": 32874688, "link": "https://stackoverflow.com/questions/32874688/removing-duplication-with-applicative-t-perhaps/32874921#32874921", "title": "Removing duplication (with Applicative ((-&gt;) t), perhaps?)", "body": "<p>You could do</p>\n\n<pre><code>((++) `on` f a) x y\n</code></pre>\n\n<p>That doesn't use <code>Applicative</code>, though (sorry).</p>\n"}, {"comments": [{"owner": {"reputation": 1974, "user_id": 248662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c075988439e97288bed94e944686689?s=128&d=identicon&r=PG", "display_name": "Stone Mason", "link": "https://stackoverflow.com/users/248662/stone-mason"}, "edited": false, "score": 0, "creation_date": 1443651755, "post_id": 32875968, "comment_id": 53584428, "body": "It&#39;s worth noting that <code>=&lt;&lt;</code> is the same as <code>concatMap</code> in this situation, so if you want to think about this in terms of list manipulations instead of monads, that&#39;s the function to use."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 1974, "user_id": 248662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c075988439e97288bed94e944686689?s=128&d=identicon&r=PG", "display_name": "Stone Mason", "link": "https://stackoverflow.com/users/248662/stone-mason"}, "edited": false, "score": 0, "creation_date": 1443679377, "post_id": 32875968, "comment_id": 53591397, "body": "@cool_me5000 Sure, but I wanted to emphasize the monadic aspect of the operation."}], "tags": [], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "is_accepted": false, "score": 21, "last_activity_date": 1443649323, "last_edit_date": 1443649323, "creation_date": 1443648644, "answer_id": 32875968, "question_id": 32874688, "link": "https://stackoverflow.com/questions/32874688/removing-duplication-with-applicative-t-perhaps/32875968#32875968", "title": "Removing duplication (with Applicative ((-&gt;) t), perhaps?)", "body": "<blockquote>\n  <p>[...] maybe you can remove that with the Applicative instance for functions.</p>\n</blockquote>\n\n<p>Do you have to use the <code>Applicative</code> instance of <code>((-&gt;) t)</code>? If you just want to get rid of the duplicated <code>f a</code>, why not use the list monad, instead?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[x, y] &gt;&gt;= f a\n</code></pre>\n\n<p>or, equivalently,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f a =&lt;&lt; [x, y]\n</code></pre>\n\n<p>Example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; let f :: Int -&gt; Int -&gt; [Int]; f a x = [a .. x]\n\n\u03bb&gt; f 1 2 ++ f 1 3\n[1,2,1,2,3]\n\n\u03bb&gt; [2, 3] &gt;&gt;= f 1\n[1,2,1,2,3]\n\n\u03bb&gt; f 1 =&lt;&lt; [2, 3]\n[1,2,1,2,3]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1443661217, "post_id": 32876858, "comment_id": 53586785, "body": "I don&#39;t understand this one. Isn&#39;t <code>mappend</code> composition, for functions? And what happened to the <code>++</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443664366, "post_id": 32876858, "comment_id": 53587468, "body": "@amalloy For functions, <code>mappend</code> is pointwise appending: <code>mappend f g x = mappend (f x) (g x)</code>. The <code>(++)</code> disappears because it is the <code>mappend</code> that happens at each point."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 15, "last_activity_date": 1443653795, "creation_date": 1443653795, "answer_id": 32876858, "question_id": 32874688, "link": "https://stackoverflow.com/questions/32874688/removing-duplication-with-applicative-t-perhaps/32876858#32876858", "title": "Removing duplication (with Applicative ((-&gt;) t), perhaps?)", "body": "<p>Bikeshedding is fun! Another option would be to use the <code>Monoid</code> instance for functions:</p>\n\n<pre><code>(($x) &lt;&gt; ($y)) (f a)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1443710778, "post_id": 32888702, "comment_id": 53610663, "body": "If you want to get rid of some parentheses, you can write: <code>(++) &lt;$&gt; ($ x) &lt;*&gt; ($ y) $ f a</code>."}, {"owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1443771749, "post_id": 32888702, "comment_id": 53633644, "body": "@Jubobs I&#39;m not sure if he&#39;s right or not, but I&#39;ve decided to road-test Gabriel Gonzalez&#39;s advice on making Haskell code more readable to non-Haskellers: <a href=\"http://www.haskellforall.com/2015/09/how-to-make-your-haskell-code-more.html\" rel=\"nofollow noreferrer\">haskellforall.com/2015/09/&hellip;</a>.  Avoiding <code>($)</code> is his top recommendation."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1443775717, "post_id": 32888702, "comment_id": 53635629, "body": "Thanks for the link <code>:)</code>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1475092812, "post_id": 32888702, "comment_id": 66809078, "body": "@frasertweedale I personally find the version with <code>$</code> much more readable, parenthesis are annoying as you have to match them up with each other, and so as you get more and more of them it becomes progressively more of a pain in the ass to decipher the order of operations. Whereas <code>$</code> doesn&#39;t need to be matched with anything. It really doesn&#39;t take long to figure out how <code>$</code> works and I consider that to be a perfectly acceptable small barrier to reading Haskell code."}], "tags": [], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "is_accepted": false, "score": 3, "last_activity_date": 1443705697, "creation_date": 1443705697, "answer_id": 32888702, "question_id": 32874688, "link": "https://stackoverflow.com/questions/32874688/removing-duplication-with-applicative-t-perhaps/32888702#32888702", "title": "Removing duplication (with Applicative ((-&gt;) t), perhaps?)", "body": "<p>Since the question hinted at a solution using Applicative (although other answers are more elegant)...</p>\n\n<pre><code>((++) &lt;$&gt; ($ x) &lt;*&gt; ($ y)) (f a)\n</code></pre>\n"}], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 1, "accepted_answer_id": 32874921, "answer_count": 4, "score": 15, "last_activity_date": 1443705697, "creation_date": 1443643583, "last_edit_date": 1443649138, "question_id": 32874688, "link": "https://stackoverflow.com/questions/32874688/removing-duplication-with-applicative-t-perhaps", "title": "Removing duplication (with Applicative ((-&gt;) t), perhaps?)", "body": "<p>I was playing around with a simple function for someone else's Stack Overflow question, and wrote the expression:</p>\n\n<pre><code>f a x ++ f a y\n</code></pre>\n\n<p>Obviously this is the best way to write that expression in real life, given I have all those variables in scope anyway, but I saw the duplication of <code>f a</code>, and thought \"Hey, maybe you can remove that with the Applicative instance for functions\". I wound up with: </p>\n\n<pre><code>liftA2 (++) (flip f x) (flip f y) a\n</code></pre>\n\n<p>which is just awful. Is there some nicer way to remove this duplication?Obviously I could also remove the duplication by binding <code>f a</code> to something in a <code>where</code> clause, but this was intended as an exercise in using built-in functions.</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1443640377, "post_id": 32873768, "comment_id": 53579414, "body": "<code>treemp :: (a -&gt; b) -&gt; Tree a -&gt; Tree b</code>. It&#39;s essentially the implementation of <code>fmap</code> that corresponds to your <code>Tree</code> type. In other words, <code>treemp</code> is to <code>Tree</code> what <code>map</code> is to lists."}], "answers": [{"tags": [], "owner": {"reputation": 1483, "user_id": 1308994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af0c47efb3b6f309f253b6e8bd038076?s=128&d=identicon&r=PG&f=1", "display_name": "cassandracomar", "link": "https://stackoverflow.com/users/1308994/cassandracomar"}, "is_accepted": false, "score": 1, "last_activity_date": 1443640658, "last_edit_date": 1443640658, "creation_date": 1443640319, "answer_id": 32873903, "question_id": 32873768, "link": "https://stackoverflow.com/questions/32873768/what-does-the-treemp-function-do-here/32873903#32873903", "title": "What does the treemp function do, here?", "body": "<p>Let's start by looking at the type.</p>\n\n<pre><code>treemp :: (a -&gt; b) -&gt; Tree a -&gt; Tree b\n</code></pre>\n\n<p>So <code>treemp f</code> lifts the function <code>f</code> over <code>Tree</code>s. It's analogous to <code>map</code> for lists and is <code>fmap</code> for this <code>Tree a</code> type.</p>\n\n<p>How did I work out the type? Let's look at the first case:</p>\n\n<pre><code>treemp f (Leaf a) = Leaf $ f a\n</code></pre>\n\n<p>We know <code>(Leaf a)</code> must have type <code>Tree a</code>. And we know that because the <code>Leaf</code> constructor is applied to an argument the return type must be a <code>Tree b</code>. Further, we know that <code>f</code> must be a function that can take an <code>a</code> as an argument and it's return type must match <code>b</code>. So <code>f :: a -&gt; b</code>. We can plug these pieces back together and get back to the type I put up above. The type matches the type of <code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code> so we know it must lift the function over the <code>Tree a</code> type.</p>\n"}, {"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 1, "last_activity_date": 1443640333, "creation_date": 1443640333, "answer_id": 32873908, "question_id": 32873768, "link": "https://stackoverflow.com/questions/32873768/what-does-the-treemp-function-do-here/32873908#32873908", "title": "What does the treemp function do, here?", "body": "<p>It looks to me like an <code>fmap</code> definition for <code>Tree</code>. Given an <code>f :: a -&gt; b</code>, it would apply <code>f</code> to every <code>a</code> in a <code>Tree a</code> (in the <code>Leaf</code> and <code>Root</code>, and recursively to each <code>Tree</code> in <code>Root</code>), returning a <code>Tree b</code></p>\n"}], "owner": {"reputation": 5, "user_id": 5367539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/416bbbc5c0b2c32247a1f4992fd5c456?s=128&d=identicon&r=PG&f=1", "display_name": "paul", "link": "https://stackoverflow.com/users/5367539/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443642493, "creation_date": 1443639863, "last_edit_date": 1443642493, "question_id": 32873768, "link": "https://stackoverflow.com/questions/32873768/what-does-the-treemp-function-do-here", "title": "What does the treemp function do, here?", "body": "<p>What does the treemp function does, here? What do the input and output correspond to?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Word\nimport Data.Char\nimport Data.List\n\n\nimport System.Environment\n\ndata Tree a = Leaf a | Root a [Tree a] deriving (Eq, Show)\n\ntreemp f (Leaf a) = Leaf $ f a\ntreemp f (Root a ts) = Root (f a) $ map (treemp f) ts\n\n\nt0 = Root 0 [t1,t2,t3,t4,t5]\n\nt1 = Leaf 1\n\nt2 = Root 2 [Leaf 6, Leaf 7, Root 11 [Leaf 12, Leaf 13]]\n\nt3 = Root 3 [Leaf 8, Leaf 9]\n\nt4 = Root 4 [Leaf 10]\n\nt5 = Leaf 5\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1443637422, "post_id": 32873037, "comment_id": 53577890, "body": "that&#39;s not all of your code."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1443637504, "post_id": 32873037, "comment_id": 53577931, "body": "This is a bad definition, it doesn&#39;t admit empty trees or trees with 2 integers in them."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1443637544, "post_id": 32873037, "comment_id": 53577964, "body": "You defined <code>isBst</code> but tried to use <code>isBST</code> (uppercase)."}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 3, "creation_date": 1443637598, "post_id": 32873037, "comment_id": 53577992, "body": "Side note: <code>if (x &gt;  (val l )) &amp;&amp; (x &lt; (val r)) then True else False</code> is equivalent to <code>x &gt;  (val l ) &amp;&amp; x &lt; (val r)</code> because boolean expressions are of type <code>Bool</code>."}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 2, "creation_date": 1443638576, "post_id": 32873037, "comment_id": 53578499, "body": "I suggest a different approach: Do you already know how to check if a list is sorted? Convert your Tree into a list!"}], "answers": [{"comments": [{"owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "edited": false, "score": 0, "creation_date": 1443637768, "post_id": 32873201, "comment_id": 53578081, "body": "How to make it exhaustive ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "edited": false, "score": 1, "creation_date": 1443638370, "post_id": 32873201, "comment_id": 53578398, "body": "@Newbie As sepp2k suggested above, add a definition for the <code>Node</code> case. E.g. <code>val (Node i _ _) = i</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443639613, "post_id": 32873201, "comment_id": 53579058, "body": "n.m.&#39;s point about the definition of the type seems important enough to justify expansion in the answer."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1443637601, "creation_date": 1443637601, "answer_id": 32873201, "question_id": 32873037, "link": "https://stackoverflow.com/questions/32873037/verifty-if-a-tree-is-bst-or-not-using-haskell/32873201#32873201", "title": "Verifty if a tree is BST or not using Haskell", "body": "<p>Your immediate problem is that you named your function <code>isBst</code> (with a lower case <code>s</code> and <code>t</code>), but tried to use it as <code>isBST</code> (with capital <code>S</code> and <code>T</code>).</p>\n\n<p>Beyond that your <code>val</code> function is not exhaustive and will cause an exception when called with a <code>Node</code> as its argument. You'll need to add a case that accepts a <code>Node</code> and returns its value.</p>\n\n<p>Additionally your <code>isBst</code> function will only ever look at the root of the tree, that is it will return <code>True</code> if the value of the root is between the values of its subtrees without caring whether the subtrees themselves are sorted. To work properly it should invoke itself recursively on the subtrees.</p>\n\n<p>Your function will also return <code>False</code> if the value of the node is the same as that of one of the subtrees. This doesn't matter if the tree is constructed in such a way that it will never contain duplicated, but otherwise this should be fixed.</p>\n"}], "owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1279, "favorite_count": 0, "accepted_answer_id": 32873201, "answer_count": 1, "score": 1, "last_activity_date": 1443637724, "creation_date": 1443636963, "last_edit_date": 1443637724, "question_id": 32873037, "link": "https://stackoverflow.com/questions/32873037/verifty-if-a-tree-is-bst-or-not-using-haskell", "title": "Verifty if a tree is BST or not using Haskell", "body": "<p>Hello I am new to Haskell and trying to write a function to check if a tree is binary search tree or not . </p>\n\n<p>Below is my code :-</p>\n\n<pre><code> data Tree = Node Int Tree Tree   \n                | Leaf Int            \n      deriving (Eq,Show)\n\nval :: Tree -&gt; Int\nval (Leaf i) = i\n\nisBst :: Tree -&gt; Bool\nisBst (Leaf i) = True\nisBst (Node x l r) = if (x &gt;  (val l )) &amp;&amp; (x &lt; (val r)) then True else False\n</code></pre>\n\n<p>But I get the following error when I execute it . </p>\n\n<pre><code>&lt;interactive&gt;:10:1: Not in scope: \u2018isBST\u2019\n</code></pre>\n\n<p>Can anyone please help me fix this or help me write a method to <code>determine if a tree is bst or not using haskell</code>.</p>\n\n<p>Can you also please help to <code>make this code exhaustive</code> ?</p>\n"}, {"tags": ["debugging", "haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443636679, "post_id": 32872761, "comment_id": 53577492, "body": "The backslashes are there to escape the double quotes. See, for instance, <a href=\"http://stackoverflow.com/a/28555403/2751851\">this answer</a>. As for the &quot;long error&quot;, what is it exactly? When I try it in GHCi I get a simple <code>*** Exception: Prelude.read: no parse</code>, which goes away if I specify the type of the value being read, as in <code>read &quot;Board --etc.&quot; :: Board</code>."}, {"owner": {"reputation": 501, "user_id": 4681998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e983411d6b657a245740031a55ed4b3?s=128&d=identicon&r=PG", "display_name": "preferred_anon", "link": "https://stackoverflow.com/users/4681998/preferred-anon"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443636812, "post_id": 32872761, "comment_id": 53577573, "body": "I&#39;ve realised the problem. I was actually calling <code>read &quot;Board{size=(4,7),pieces=[[&quot;OA&quot;,&quot;AA&quot;,&quot;AA&quot;],[&quot;BBB&quot;,&quot;BOO&quot;],[&quot;O&zwnj;&#8203;CCC&quot;,&quot;CCCO&quot;,&quot;OOCO&quot;]]&zwnj;&#8203;}&quot;</code> manually which has the issue of double quotes"}], "answers": [{"tags": [], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "is_accepted": false, "score": 5, "last_activity_date": 1443636559, "creation_date": 1443636559, "answer_id": 32872934, "question_id": 32872761, "link": "https://stackoverflow.com/questions/32872761/haskell-breaks-my-type-when-i-call-show-read/32872934#32872934", "title": "Haskell breaks my type when I call show/read", "body": "<p>GHCI already calls <code>show</code>. When you type <code>show something</code> under GHCI, it\u2019s as if you called <code>show $ show something</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 4681998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e983411d6b657a245740031a55ed4b3?s=128&d=identicon&r=PG", "display_name": "preferred_anon", "link": "https://stackoverflow.com/users/4681998/preferred-anon"}, "edited": false, "score": 0, "creation_date": 1443638155, "post_id": 32872972, "comment_id": 53578263, "body": "Thanks very much! Part of it was me making a stupid mistake, and part of it was this."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1443636736, "creation_date": 1443636736, "answer_id": 32872972, "question_id": 32872761, "link": "https://stackoverflow.com/questions/32872761/haskell-breaks-my-type-when-i-call-show-read/32872972#32872972", "title": "Haskell breaks my type when I call show/read", "body": "<p>Given</p>\n\n<pre><code>&gt; data Board = Board { size :: (Int, Int), pieces :: [[String]] } deriving (Show, Read)\n&gt; let b = Board{size=(4,7),pieces=[[\"OA\",\"AA\",\"AA\"],[\"BBB\",\"BOO\"],[\"OCCC\",\"CCCO\",\"OOCO\"]]}\n</code></pre>\n\n<p>The result of <code>show b</code> is a <code>String</code></p>\n\n<pre><code>&gt; show b\n\"Board {size = (4,7), pieces = [[\\\"OA\\\",\\\"AA\\\",\\\"AA\\\"],[\\\"BBB\\\",\\\"BOO\\\"],[\\\"OCCC\\\",\\\"CCCO\\\",\\\"OOCO\\\"]]}\"\n</code></pre>\n\n<p>The quotes in any <code>String</code> are escaped when <code>show</code>-ing a string. If you output the string instead you'll see that it doesn't contain the <code>\\</code> characters.</p>\n\n<pre><code>&gt; putStrLn $ show b\nBoard {size = (4,7), pieces = [[\"OA\",\"AA\",\"AA\"],[\"BBB\",\"BOO\"],[\"OCCC\",\"CCCO\",\"OOCO\"]]}\n</code></pre>\n\n<p>The string produced by <code>show</code> can be read back in again as a board by <code>read</code></p>\n\n<pre><code>&gt; (read . show $ b) :: Board\nBoard {size = (4,7), pieces = [[\"OA\",\"AA\",\"AA\"],[\"BBB\",\"BOO\"],[\"OCCC\",\"CCCO\",\"OOCO\"]]}\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 4681998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e983411d6b657a245740031a55ed4b3?s=128&d=identicon&r=PG", "display_name": "preferred_anon", "link": "https://stackoverflow.com/users/4681998/preferred-anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32872972, "answer_count": 2, "score": 0, "last_activity_date": 1443637321, "creation_date": 1443635918, "question_id": 32872761, "link": "https://stackoverflow.com/questions/32872761/haskell-breaks-my-type-when-i-call-show-read", "title": "Haskell breaks my type when I call show/read", "body": "<p>I have defined a new type in my haskell code, which takes a list of lists of strings as a record. An example might be<br>\n<code>Board{size=(4,7),pieces=[[\"OA\",\"AA\",\"AA\"],[\"BBB\",\"BOO\"],[\"OCCC\",\"CCCO\",\"OOCO\"]]}</code>  </p>\n\n<p>I've set it up as a derived instance of <code>Show</code> and <code>Read</code>. If I just input the code above into ghci, then I get out exactly what I put in, which is fine. However, if I call it with show, I get<br>\n<code>\"Board {size = (4,7), pieces = [[\\\"OA\\\",\\\"AA\\\",\\\"AA\\\"],[\\\"BBB\\\",\\\"BOO\\\"],[\\\"OCCC\\\",\\\"CCCO\\\",\\\"OOCO\\\"]]}\"</code><br>\nThe speech marks are fine, but I've no idea why the backslashes are there. Are you not allowed to next speech marks or something? In any case, this now totally breaks if I try to call <code>read</code> to get it back. I get a long error trying to tell me that none of the strings are data constructors - I don't know why it thinks they are.  </p>\n\n<p>Is there any way round this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1443632497, "post_id": 32871532, "comment_id": 53575314, "body": "Write an auxiliary function <code>freeVars :: Exp -&gt; [Id]</code> to collect al the free variables of an <code>Exp</code>. Then, writing <code>isClosed</code> becomes trivial."}, {"owner": {"reputation": 93, "user_id": 3373360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6609c270726f8d90ab6ba223f3edf459?s=128&d=identicon&r=PG&f=1", "display_name": "user3373360", "link": "https://stackoverflow.com/users/3373360/user3373360"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443633233, "post_id": 32871532, "comment_id": 53575690, "body": "@chi I was thinking about doing so but I&#39;m not exactly sure how. I know that&#39;d be easy as we could just use freeVars in isClosed to determine if there are any free variables or not."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443638066, "post_id": 32872420, "comment_id": 53578222, "body": "The alternative version can also avoid the auxiliary <code>go</code> if we exploit <code>delete</code> in the <code>Lam</code> case, following the mathematical definition of free variable."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1443644319, "post_id": 32872420, "comment_id": 53581228, "body": "Why does the <code>acc</code> arg to <code>go</code> need to exist at all? I wrote <code>freeVars</code> myself in much the same way, and never found any use for it: it just seems simpler to use <code>[]</code> as the base case: <a href=\"https://gist.github.com/amalloy/e385053eea25e3743c90\" rel=\"nofollow noreferrer\">gist.github.com/amalloy/e385053eea25e3743c90</a>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443644929, "post_id": 32872420, "comment_id": 53581512, "body": "@chi I think you have to do a little more than use <code>delete</code>, right? Consider <code>Lam &quot;f&quot; $ App (Var &quot;f&quot;) (Var &quot;f&quot;)</code>: in the lambda body <code>f</code> may appear free any number of times, so you either need to <code>nub</code> it or else <code>filter</code> out all instances of <code>f</code>. That is, I assume you were proposing something like <a href=\"https://gist.github.com/amalloy/d22145a4d2bd6bfea96f\" rel=\"nofollow noreferrer\">gist.github.com/amalloy/d22145a4d2bd6bfea96f</a>, which doesn&#39;t work unless you make one of the commented substitutions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443645037, "post_id": 32872420, "comment_id": 53581588, "body": "@amalloy You are correct. <code>delete</code> only removes the first, so <code>filter</code> is the right thing here."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443647664, "post_id": 32872420, "comment_id": 53582817, "body": "@amalloy: oh man, you&#39;re right... I must have been tired or something. fixed."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 2, "last_activity_date": 1443647648, "last_edit_date": 1443647648, "creation_date": 1443634586, "answer_id": 32872420, "question_id": 32871532, "link": "https://stackoverflow.com/questions/32871532/determining-if-an-exp-e-isclosed-based-on-free-variables/32872420#32872420", "title": "Determining if an Exp &#39;e&#39; isClosed based on free variables?", "body": "\n\n<p>How about something like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isClosed :: Exp -&gt; Bool\nisClosed exp = go [] exp where\n  go bindings (Var id)     = id `elem` bindings\n  go _        (Nat _)      = True\n  go _        (Op _)       = True\n  go bindings (Lam id exp) = go (id:bindings) exp\n  go bindings (App fn arg) = go bindings fn &amp;&amp; go bindings arg\n</code></pre>\n\n<p>let's give it a test ride:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Main&gt; isClosed (Var \"e\")\nFalse\n*Main&gt; isClosed (Lam \"e\" (Var \"e\"))\nTrue\n*Main&gt; isClosed (Lam \"e\" (Var \"x\"))\nFalse\n*Main&gt; isClosed (App (Lam \"e\" (Var \"x\")) (Nat 3))\nFalse\n*Main&gt; isClosed (App (Lam \"e\" (Var \"e\")) (Nat 3))\nTrue\n</code></pre>\n\n<hr>\n\n<p><strong>Alternatively</strong>, you can also first write a <code>freeVars</code> helper and implement <code>isClosed</code> via that:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isClosed :: Exp -&gt; Bool\nisClosed = null . freeVars\n\nfreeVars :: Exp -&gt; [Id]\nfreeVars exp = go [] exp where\n  go bindings (Var id)\n    | id `elem` bindings   = []\n    | otherwise            = [id]\n  go _        (Nat _)      = []\n  go _        (Op _)       = []\n  go bindings (Lam id exp) = go (id:bindings) exp\n  go bindings (App fn arg) = go bindings fn ++ go bindings arg\n</code></pre>\n\n<p>and then</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Main&gt; freeVars (Var \"e\")\n[\"e\"]\n*Main&gt; freeVars (Lam \"e\" (Var \"x\"))\n[\"x\"]\n*Main&gt; freeVars (Lam \"e\" (Var \"e\"))\n[]\n*Main&gt; freeVars (App (Lam \"e\" (Var \"x\")) (Nat 3))\n[\"x\"]\n*Main&gt; freeVars (App (Lam \"e\" (Var \"e\")) (Nat 3))\n[]\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 3373360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6609c270726f8d90ab6ba223f3edf459?s=128&d=identicon&r=PG&f=1", "display_name": "user3373360", "link": "https://stackoverflow.com/users/3373360/user3373360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 32872420, "answer_count": 1, "score": 1, "last_activity_date": 1443647648, "creation_date": 1443631503, "last_edit_date": 1443633776, "question_id": 32871532, "link": "https://stackoverflow.com/questions/32871532/determining-if-an-exp-e-isclosed-based-on-free-variables", "title": "Determining if an Exp &#39;e&#39; isClosed based on free variables?", "body": "<p>I'm not sure where to start or how to write the <code>isClosed</code> function below. All help is greatly appreciated! Below is what I have so far.</p>\n\n<p><code>isClosed</code> is supposed to take in a value <code>e</code> of type <code>Exp</code> and determine if it's closed or not by evaluating as below:</p>\n\n<pre><code>-- Identifiers for % expressions and variables\ntype Id = String\n\n-- The \"builtin\" functions.\ndata Op = Succ | Pred | IfZero\n           deriving (Show, Ord, Eq)\n\n-- Expressions of L\ndata Exp = Var Id\n         | Nat Integer\n         | Op Op\n         | Lam Id Exp\n         | App Exp Exp\n           deriving (Ord, Eq, Show)\n\n-- isClosed e is true if and only if there are no free variables in e\n-- \"Free\" means that the variable it is not declared by a surrounding %.       \n-- For example, in the expression\n\n-- x (%x. x (%y.xz)) (%y.x)\n\n-- there are 5 occurrences of x.  The first is \"free\".  The second is\n-- the parameter for the % expression and is never substituted for.\n-- The third and fourth occurrences refer to the parameter of the\n-- enclosing % expression.  The fifth is free.\n\n-- Examples: (%x. %y. x y) is closed; (%x. y %y. x y) is not since the\n-- first occurrence of y is free.\n\nisClosed :: Exp -&gt; Bool\nisClosed Lam{} = True\nisClosed _ = False\n</code></pre>\n"}, {"tags": ["haskell", "types", "algebraic-data-types", "phantom-types"], "comments": [{"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1443630322, "post_id": 32871086, "comment_id": 53574062, "body": "It looks like it&#39;s very possible to write the above using GADTs, but I&#39;m still interested in what Ralf intended. Is there a special keyword with? Can you express this without GADTs?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1443630799, "post_id": 32871086, "comment_id": 53574356, "body": "&gt; &quot;If only we had the means to constrain the type argument of Term to a certain type. Now, this is exactly what the aforementioned \u2018mild\u2019 extension allows us to do. Given this extension we declare the Term data type as follows...&quot; Maybe I missred but I think this is a <i>imagined</i> extension that does not really exist (or so <b>I</b> think) but yeah GADTs will do ;)"}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 8, "last_activity_date": 1443632040, "creation_date": 1443632040, "answer_id": 32871688, "question_id": 32871086, "link": "https://stackoverflow.com/questions/32871086/defining-phantom-types-cant-compile-examples/32871688#32871688", "title": "Defining Phantom Types - can&#39;t compile examples", "body": "<p>Although ugly, the following will work and might be considered slightly closer to that notation in spirit. This is essentially desugaring a GADT into type equalities (which seem not to have their own extension so you need <em>either</em> <code>GADTs</code> or <code>TypeFamilies</code> enabled to use them) and existentials.</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification, TypeFamilies #-}\n\ndata Type t = t ~ Int =&gt; RInt\n            | t ~ Char =&gt; RChar\n            | forall a. t ~ [a] =&gt; RList (Type a)\n            | forall a b. t ~ (a, b) =&gt; RPair (Type a) (Type b)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1443667366, "last_edit_date": 1443667366, "creation_date": 1443632261, "answer_id": 32871757, "question_id": 32871086, "link": "https://stackoverflow.com/questions/32871086/defining-phantom-types-cant-compile-examples/32871757#32871757", "title": "Defining Phantom Types - can&#39;t compile examples", "body": "<p>My guess is that the definition sans-<code>with</code> suggested in the paper is</p>\n\n<pre><code>data Type t = RInt\n            | RChar\n            | RList (Type t)\n            | RPair (Type t) (Type t)\n</code></pre>\n\n<p>Above, the parameter <code>t</code> is never used. It is, indeed, phantom.</p>\n\n<p>This implies that, e.g.</p>\n\n<pre><code>RInt :: Type a\n</code></pre>\n\n<p>for <em>any</em> type <code>a</code>. By contrast, if the <code>with</code> constraints were followed, it would be impossible to have <code>RInt :: Type t</code> for any t but for <code>t ~ Int</code>.</p>\n\n<p>The <code>with</code> syntax is not present in GHC, but GADTs play essentially the same role.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\ndata Type t where\n   RInt  :: t ~ Int   =&gt; Type t\n   RChar :: t ~ Char  =&gt; Type t\n   RList :: t ~ [a]   =&gt; Type a -&gt; Type t\n   RPair :: t ~ (a,b) =&gt; Type a -&gt; Type b -&gt; Type t\n</code></pre>\n\n<p>Note how <code>with</code> is replaced by an equality constraint in each constructor. It's basically the same thing, written differently.</p>\n\n<p>More compactly, we can rewrite the above into</p>\n\n<pre><code>data Type t where\n   RInt  :: Type Int\n   RChar :: Type Char\n   RList :: Type a -&gt; Type [a]\n   RPair :: Type a -&gt; Type b -&gt; Type (a,b)\n</code></pre>\n\n<p>where the constraints have been \"inlined\" in the final type.</p>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 32871757, "answer_count": 2, "score": 7, "last_activity_date": 1443667366, "creation_date": 1443630044, "question_id": 32871086, "link": "https://stackoverflow.com/questions/32871086/defining-phantom-types-cant-compile-examples", "title": "Defining Phantom Types - can&#39;t compile examples", "body": "<p>I'm trying to learn more about Phantom Types. I'm trying to read through <a href=\"http://www.cs.ox.ac.uk/ralf.hinze/publications/With.pdf\" rel=\"noreferrer\">Fun with Phantom Types</a> by Ralf Hinze. He's using a keyword <code>with</code> I haven't seen before and that I can't get to compile. I get a parse error on <code>=</code> when I try this. </p>\n\n<pre><code>data Type t = RInt                    with t = Int\n            | RChar                   with t = Char\n            | RList (Type a)          with t = [a ]\n            | RPair (Type a) (Type b) with t = (a, b)\n</code></pre>\n\n<p>Earlier in the paper, he says that the \"with\" statements aren't strictly necessary, that you can set <code>a = t</code> instead, but I can't figure out how to define this data type without them. The following errors with: <code>Not in scope: type variable 'a'</code></p>\n\n<pre><code>data Type t = RInt\n            | RChar\n            | RList (Type a)\n            | RPair (Type a) (Type b)\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["haskell", "yesod", "blaze-html"], "answers": [{"comments": [{"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1443689773, "post_id": 32872844, "comment_id": 53597008, "body": "Thanks, this makes me think that performing this kind of transformation when the page is rendered is a bad idea. I should rather sanitise this content before storing it in the database"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1443636221, "creation_date": 1443636221, "answer_id": 32872844, "question_id": 32871016, "link": "https://stackoverflow.com/questions/32871016/how-to-transform-some-blaze-html-before-rendering-it-with-yesod/32872844#32872844", "title": "How to transform some Blaze `Html` before rendering it with Yesod?", "body": "<p>You have to render to Text or ByteString first, blaze provides no means of analyzing content. Then you can process the data with a library like html-conduit or tagsoup (which is what <a href=\"http://www.stackage.org/package/xss-sanitize\" rel=\"nofollow\">xss-sanitize</a> does).</p>\n"}], "owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 32872844, "answer_count": 1, "score": 1, "last_activity_date": 1443636221, "creation_date": 1443629767, "question_id": 32871016, "link": "https://stackoverflow.com/questions/32871016/how-to-transform-some-blaze-html-before-rendering-it-with-yesod", "title": "How to transform some Blaze `Html` before rendering it with Yesod?", "body": "<p>I have some HTML entered by the user which is displayed in a Yesod template. I would like to transform this HTML, stripping out <code>style</code> attributes from it before it gets rendered, but i cannot find out how.</p>\n\n<p>If my template contains <code>#{ html }</code> i can pass <code>html</code> as a value through a function simply writing <code>#{ transform html }</code>, if the <code>transform</code> function has a signature: <code>transform :: Html -&gt; Html</code> where <code>Html</code> is the type defined by <code>blaze-html</code> <a href=\"https://hackage.haskell.org/package/blaze-html-0.8.1.1/docs/Text-Blaze-Html.html\" rel=\"nofollow\">here</a>. The problem i see is that Blaze does not seem to expose functionalities useful in order to walk an HTML tree, or even just get the descendents of a given <code>Html</code>. So which strategies would you suggest? Should i try to get into the Blaze internals?</p>\n\n<p>I am not sure whether this should be considered purely an issue with Blaze. Transforming <code>Html</code> elements is not one of the main use cases of Blaze, so this problem needs to be tackled in the context of rendering with Yesod</p>\n"}, {"tags": ["haskell", "cabal", "wxhaskell"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443625899, "post_id": 32868334, "comment_id": 53571100, "body": "you could give Stackage/<code>stack</code> a try \u2014 it is able to take a <code>.cabal</code> file and compute a working set of dependencies, based on the GHC/LTS Stackage/Nightly version you specify. I was able to get some sample code that depends on WX to build without hassle on OS X."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5535395, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b65f9086c4aae463d0736942fbd93020?s=128&d=identicon&r=PG", "display_name": "Anon", "link": "https://stackoverflow.com/users/5535395/anon"}, "is_accepted": false, "score": 1, "last_activity_date": 1446850490, "creation_date": 1446850490, "answer_id": 33576984, "question_id": 32868334, "link": "https://stackoverflow.com/questions/32868334/haskell-cabal-install-wx-missing-c-library-wx-gtk2u-webview-3-0/33576984#33576984", "title": "Haskell cabal install wx: missing C library wx_gtk2u_webview-3.0", "body": "<p>I just ran into the same problem on Arch; when I tried running cabal with <code>--verbose=3</code>, it looked like <code>libwx_gtk2u_webview-3.0</code> was present, but it was complaining about <code>libwebkitgtk-1.0</code> being missing. After I installed the <code>webkitgtk2</code> package, which provides <code>libwebkitgtk-1.0</code>, wxHaskell installed with no problems.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4225872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b755f62704710f79a1bf8ffb56e1e07?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/4225872/rakesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1449676755, "creation_date": 1449676755, "answer_id": 34183317, "question_id": 32868334, "link": "https://stackoverflow.com/questions/32868334/haskell-cabal-install-wx-missing-c-library-wx-gtk2u-webview-3-0/34183317#34183317", "title": "Haskell cabal install wx: missing C library wx_gtk2u_webview-3.0", "body": "<p>Try \"sudo apt-get install libwxgtk-webview3.0-dev\". It worked for me.</p>\n"}], "owner": {"reputation": 73, "user_id": 3526864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9c4e424382992c6bf83f81af1fe412?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3526864/nishant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1449676755, "creation_date": 1443622232, "last_edit_date": 1495540320, "question_id": 32868334, "link": "https://stackoverflow.com/questions/32868334/haskell-cabal-install-wx-missing-c-library-wx-gtk2u-webview-3-0", "title": "Haskell cabal install wx: missing C library wx_gtk2u_webview-3.0", "body": "<p>I am trying to install wx by <code>cabal install wx</code></p>\n\n<pre><code>Configuring wxc to build against wxWidgets 3.0\nsetup: Missing dependency on a foreign library:\n* Missing C library: wx_gtk2u_webview-3.0\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.\ncabal: Error: some packages failed to install :\nwx-0.92.0.0 depends on wxc-0.92.0.0 which failed to install.\nwxc-0.92.0.0 failed during the configure step. The exception was:\nExitFailure 1\nwxcore-0.92.0.0 depends on wxc-0.92.0.0 which failed to install.\n</code></pre>\n\n<p>but I have following files in <code>/usr/lib</code> :</p>\n\n<pre><code>/usr/lib/libwx_gtk2u_webview-3.0.so\n/usr/lib/libwx_gtk2u_webview-3.0.so.0\n/usr/lib/libwx_gtk2u_webview-3.0.so.0.2.0\n</code></pre>\n\n<p>I have also tried <code>cabal install --extra-lib-dirs=/usr/lib/ wx</code> but to no avail.</p>\n\n<p>I have also tried all the suggestions in <a href=\"https://stackoverflow.com/questions/9756088/cabal-install-wx-missing-c-library\">cabal install wx Missing C library</a></p>\n\n<p>I am on archlinux and I have both wxgtk-3.0 and wxgtk-2.8 multilib and normal versions. I also tried reinstalling them.</p>\n"}, {"tags": ["python", "algorithm", "haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1443601908, "post_id": 32861367, "comment_id": 53555477, "body": "The message <i>says</i> that you have mismatched levels of list nesting. Try adding an explicit type signature to your function; then GHC will know what you <i>intended</i> the type to be, and might be able to give you a better idea where the error is."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1443601952, "post_id": 32861367, "comment_id": 53555501, "body": "My personal theory is that you don&#39;t need the square brackets in <code>map (\\x -&gt; [(take n ys)]:x)</code>, but I haven&#39;t checked that."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1443606738, "post_id": 32861367, "comment_id": 53558517, "body": "just for the record: the definition of <code>subdivideList</code> in your Python code is missing."}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 0, "creation_date": 1443618509, "post_id": 32861367, "comment_id": 53565906, "body": "ahh my mistake, it&#39;s a recursive call."}], "answers": [{"comments": [{"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 0, "creation_date": 1443619334, "post_id": 32862899, "comment_id": 53566494, "body": "This is a good answer. The problem is when I run the corrected code with [(take n ys)]:x replaced with (take n ys):x it does not compile for me. Additionally I think doing so will yield incorrect results. This part of the haskell, &quot;[(take n ys)]:x&quot;, was translated from &quot;[xs[:i]] + j&quot; in the python code (which is verified to work). I am literally doing a one to one transformation from python to a haskell tail recursive iteration. That&#39;s what bugs me about this code. What&#39;s even more strange is that the error message mentions infinite type. Most answers haven&#39;t addressed that."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 1, "creation_date": 1443621161, "post_id": 32862899, "comment_id": 53567796, "body": "I did not say replace with <code>(take n ys):x</code> but <code>take n ys</code>. but also that doesn&#39;t mean the code will then do what you expect. try e.g. <code>take n ys ++ x</code>. you are the one who understands the domain, I only provided generic, type related help."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 1, "creation_date": 1443621362, "post_id": 32862899, "comment_id": 53567960, "body": "FYI: the <code>:</code> prepends an ELEMENT to a list; it is not list concatenation (<code>++</code> in Haskell == <code>+</code> in Python)."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 9, "last_activity_date": 1443653957, "last_edit_date": 1443653957, "creation_date": 1443606251, "answer_id": 32862899, "question_id": 32861367, "link": "https://stackoverflow.com/questions/32861367/infinite-type-error-in-haskell-when-trying-to-translate-python-function-into-has/32862899#32862899", "title": "infinite type error in haskell when trying to translate python function into haskell. Why?", "body": "\n\n<p>First of all, I've made your Haskell code a little bit more comprehensible:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getNPartitionPermutations :: [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n      where iter ys n acc\n              | length xs == n = acc\n              | otherwise      =\n                  iter ys (n+1) (elem:acc)\n                    where elem = map (\\x -&gt; [(take n ys)]:x) rec'\n                          rec' = getNPartitionPermutations (drop n ys) (n-1)\n</code></pre>\n\n<p>It looks like the type problem is coming from this expression in the definition of <code>elem</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[(take n ys)]:x\n</code></pre>\n\n<p>if you replace it with <code>head x</code> or <code>take n ys</code> or <code>take n ys ++ x</code>, the code compiles. This indicates that somehow you are providing a value of type <code>[[[a]]]</code> instead of a value of type <code>[a]</code>. That is, you have 2 extra wrappings with <code>[]</code>.</p>\n\n<p>And whereas I didn't take the time to fully understand what your code is meant to do, I'm quite sure given these hints you can figure out where the problem is.</p>\n\n<p>EDIT: the problem was the use of <code>:</code> instead of <code>++</code>, as well as the unnecessary wrapping in <code>[take n ys]</code>, so replacing with <code>take n ys ++ x</code> is the way to go. (just incorporating the comments into the answer)</p>\n\n<hr>\n\n<p><strong>General advice:</strong></p>\n\n<p>The way to go about tracking down/pinpointing type errors is by first refactoring the code the way I did, i.e. splitting up large expressions and giving names to subexpressions so their meanings become more visible and so you could temporarily replace certain parts of the overall expression with <code>undefined</code>, because <code>undefined</code> has any type you like and thus allows you to get your code to compile without having to figure out all of it in one go. For example, this is where I ended up before trying <code>head x</code> and <code>take n ys</code> (note the <code>(\\x -&gt; undefined)</code> bit):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getNPartitionPermutations :: [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n      where iter ys n acc\n              | length xs == n = acc\n              | otherwise      =\n                  iter ys (n+1) (elem:acc)\n                    where elem = map (\\x -&gt; undefined) rec'\n                          rec' = getNPartitionPermutations (drop n ys) (n-1)\n</code></pre>\n\n<p>\u2014 this was the largest subset of the original code that still compiled.</p>\n\n<p>And before that, I had:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getNPartitionPermutations :: [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n      where iter ys n acc = undefined\n</code></pre>\n\n<p>after which I gradually started reintroducing the original bits, moving the <code>undefined</code> bit further down the code tree:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getNPartitionPermutations :: [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n      where iter ys n acc\n              | length xs == n = acc\n              | otherwise      = undefined\n</code></pre>\n\n<p>then</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getNPartitionPermutations :: [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n      where iter ys n acc\n              | length xs == n = acc\n              | otherwise      =\n                  iter ys (n+1) (elem:acc)\n                    where elem = undefined\n                          rec' = undefined\n</code></pre>\n\n<p>and so on.</p>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443622821, "post_id": 32868443, "comment_id": 53568951, "body": "you can just accept my answer instead of redirecting the votes :)"}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443623057, "post_id": 32868443, "comment_id": 53569127, "body": "Your answer isn&#39;t the final or correct answer though.  Edit: I did it anyway. Thanks."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1443623178, "post_id": 32868443, "comment_id": 53569215, "body": "well actually it is the correct answer: your question was WHY the error was occurring not what the working solution is, just for the record."}], "tags": [], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "is_accepted": false, "score": 0, "last_activity_date": 1443622556, "creation_date": 1443622556, "answer_id": 32868443, "question_id": 32861367, "link": "https://stackoverflow.com/questions/32861367/infinite-type-error-in-haskell-when-trying-to-translate-python-function-into-has/32868443#32868443", "title": "infinite type error in haskell when trying to translate python function into haskell. Why?", "body": "<pre><code>getNPartitionPermutations :: Num a =&gt; [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n      where iter ys i acc\n              | length xs == i = acc\n              | otherwise      =\n                  iter ys (i+1) (elem' ++ acc)\n                    where elem' = map (\\x -&gt; take i ys : x) rec'\n                          rec' = getNPartitionPermutations (drop i ys) (n-1)\n</code></pre>\n\n<p>The code above will work. The mistake is largely because I'm using (:) when a (++) is more appropriate. Erik Allik really helped me out in deriving this answer so please direct your points towards him as his explanation of debugging haskell and pointing out (++) instead of (:) was equivalent to pythons (+) was instrumental in helping me solve this problem. </p>\n"}], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 32862899, "answer_count": 2, "score": 4, "last_activity_date": 1443653957, "creation_date": 1443601654, "last_edit_date": 1443620597, "question_id": 32861367, "link": "https://stackoverflow.com/questions/32861367/infinite-type-error-in-haskell-when-trying-to-translate-python-function-into-has", "title": "infinite type error in haskell when trying to translate python function into haskell. Why?", "body": "<pre class=\"lang-py prettyprint-override\"><code>def get_N_Partition_Permutations(xs, n):\n    if n == 1:\n        return [[xs]]\n    acc = []\n    for i in xrange(1,len(xs)):\n        acc += [[xs[:i]] + j for j in get_N_Partition_Permutations(xs[i:], n-1)]\n    return acc\n</code></pre>\n\n<p>I'm trying to implement the function above (which is in Python) in haskell below.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getNPartitionPermutations :: [a] -&gt; Int -&gt; [[[a]]]\ngetNPartitionPermutations xs 1 = [[xs]]\ngetNPartitionPermutations xs n = iter xs 1 []\n  where iter ys i acc\n          | length xs == i = acc\n          | otherwise      =\n              iter ys (i+1) (elem':acc)\n                where elem' = map (\\x -&gt; [(take i ys)]:x) rec'\n                      rec' = getNPartitionPermutations (drop i ys) (n-1)\n</code></pre>\n\n<p>I'm getting a strange error that I don't fully understand. Why does this code work in python but not in haskell? The error message is below</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>partitionArr.hs|23 col 104 error| Occurs check: cannot construct the infinite type: a ~ [[a]]\nExpected type: [[[a]]]\nActual type: [a]\nRelevant bindings include\n  acc :: [[[[[a]]]]] (bound at partitionArr.hs:21:19)\n  ys :: [a] (bound at partitionArr.hs:21:14)\n  iter :: [a] -&gt; GHC.Types.Int -&gt; [[[[[a]]]]] -&gt; [[[[[a]]]]] (bound at partitionArr.hs:21:9)\n  xs :: [[[a]]] (bound at partitionArr.hs:20:27)\n  getNPartitionPermutations :: [[[a]]] -&gt; GHC.Types.Int -&gt; [[[[[a]]]]]\n  (bound at partitionArr.hs:19:1)\n  In the first argument of \u2018Algo.getNPartitionPermutations\u2019,\n    namely \u2018(GHC.List.drop n ys)\u2019\n  In the second argument of \u2018(GHC.Base.$!)\u2019,\n    namely \u2018Algo.getNPartitionPermutations (GHC.List.drop n ys) (n\n    GHC.Num.- 1)\u2019\n\npartitionArr.hs|20 col 39 error| Occurs check: cannot construct the infinite type: a ~ [[a]]\nExpected type: [a]\nActual type: [[[a]]]\nRelevant bindings include\n  iter :: [a] -&gt; GHC.Types.Int -&gt; [[[[[a]]]]] -&gt; [[[[[a]]]]] (bound at partitionArr.hs:21:9)\n  xs :: [[[a]]] (bound at partitionArr.hs:20:27)\n  getNPartitionPermutations :: [[[a]]] -&gt; GHC.Types.Int -&gt; [[[[[a]]]]]\n  (bound at partitionArr.hs:19:1)\n\nIn the first argument of \u2018iter\u2019, namely \u2018xs\u2019In the expression: iter xs 1 []\n</code></pre>\n\n<p>Edit: Because I wasn't clear. What the python function does is return all possible n partitions of a list. so parameters [1,2,3,4],2 gives [[[1],[2,3,4]],[[1,2],[3,4]],[[1,2,3][4]]]</p>\n\n<p>type signature of the haskell function is [a] -> Int -> [[[a]]]</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3611, "user_id": 1029158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YmuXk.jpg?s=128&g=1", "display_name": "DiegoNolan", "link": "https://stackoverflow.com/users/1029158/diegonolan"}, "edited": false, "score": 3, "creation_date": 1443594188, "post_id": 32859010, "comment_id": 53551432, "body": "<code>c (i,xs) = map (\\v -&gt; (i,v)) xs</code>"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 5, "creation_date": 1443594503, "post_id": 32859010, "comment_id": 53551553, "body": "Also known as <code>sequence</code>."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443613196, "post_id": 32859010, "comment_id": 53562287, "body": "your terminology &quot;static element&quot; and &quot;constant&quot; (as opposed to a list) makes little sense. you could use &quot;single value&quot;, but even that&#39;s dubious as that single value could itself be a list, depending on context."}], "answers": [{"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443608362, "post_id": 32860539, "comment_id": 53559430, "body": "a trivial error but the type of your <code>f</code> does not unify with the type expected by the OP."}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1443598922, "creation_date": 1443598922, "answer_id": 32860539, "question_id": 32859010, "link": "https://stackoverflow.com/questions/32859010/haskell-create-a-list-of-tuples-from-a-tuple-with-a-static-element-and-a-list/32860539#32860539", "title": "Haskell: Create a list of tuples from a tuple with a static element and a list", "body": "<p>Do you want the <code>Int</code> to always be the same, just feed <code>zip</code> with an infinite list. You can use <code>repeat</code> for that.</p>\n\n<pre><code>f i xs = zip (repeat i) xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443608504, "post_id": 32861583, "comment_id": 53559524, "body": "no downvote but the first example relies on currying, which the OP might not be familiar with; the second example uses a fold where a simple <code>map</code> would do, and it uses a generally contraindicated type of fold, <code>foldl</code>, which is prone to space leaks; the third example uses recursion which is even more unnecessarily complicated than a fold, when compared to a simple <code>map</code>."}, {"owner": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1443608782, "post_id": 32861583, "comment_id": 53559692, "body": "Why should we expect the user to not know about currying? In any case it is time to start learning it because it is crucial to understanding Haskell."}], "tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 2, "last_activity_date": 1443603074, "last_edit_date": 1443603074, "creation_date": 1443602368, "answer_id": 32861583, "question_id": 32859010, "link": "https://stackoverflow.com/questions/32859010/haskell-create-a-list-of-tuples-from-a-tuple-with-a-static-element-and-a-list/32861583#32861583", "title": "Haskell: Create a list of tuples from a tuple with a static element and a list", "body": "<p>For completeness, consider also <code>cycle</code>,</p>\n\n<pre><code>f i = zip (cycle [i])\n</code></pre>\n\n<p>Using <code>foldl</code>,</p>\n\n<pre><code>f i = foldl (\\a v -&gt; (i,v) : a ) []\n</code></pre>\n\n<p>Using a recursive function that illustrates how to divide the problem,</p>\n\n<pre><code>f :: Int -&gt; [a] -&gt; [(Int,a)]\nf _ [] = []\nf i (x:xs) = (i,x) : f i xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 4, "last_activity_date": 1443625765, "last_edit_date": 1443625765, "creation_date": 1443607324, "answer_id": 32863251, "question_id": 32859010, "link": "https://stackoverflow.com/questions/32859010/haskell-create-a-list-of-tuples-from-a-tuple-with-a-static-element-and-a-list/32863251#32863251", "title": "Haskell: Create a list of tuples from a tuple with a static element and a list", "body": "\n\n<p>I think this is the most direct and easy to understand solution (you already seem to be acquainted with <code>map</code> anyway):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: (Int, [String]) -&gt; [(Int, String)]\nf (i, xs) = map (\\x -&gt; (i, x)) xs\n</code></pre>\n\n<p>(which also happens to be the desugared version of <code>[(i, x) | x &lt; xs]</code>, which Landei proposed)</p>\n\n<p>then</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; f (3, [\"a\", \"b\", \"c\"])\n[(3,\"a\"),(3,\"b\"),(3,\"c\")]\n</code></pre>\n\n<p>This solution uses pattern matching to \"unpack\" the tuple argument, so that the first tuple element is <code>i</code> and the second element is <code>xs</code>. It then does a simple <code>map</code> over the elements of <code>xs</code> to convert each element <code>x</code> to the tuple <code>(i, x)</code>, which I think is what you're after. Without pattern matching it would be slightly more verbose:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f pair = let i  = fst pair  -- get the FIRST element\n             xs = snd pair  -- get the SECOND element\n         in map (\\x -&gt; (i, x)) xs\n</code></pre>\n\n<hr>\n\n<p><strong>Furthermore:</strong></p>\n\n<p>The algorithm is no way specific to <code>(Int, [String])</code>, so you can safely generalize the function by replacing <code>Int</code> and <code>String</code> with type parameters <code>a</code> and <code>b</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: (a, [b]) -&gt; [(a, b)]\nf (i, xs) = map (\\x -&gt; (i, x)) xs\n</code></pre>\n\n<p>this way you can do</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; f (True, [1.2, 2.3, 3.4])\n[(True,1.2),(True,2.3),(True,3.4)]\n</code></pre>\n\n<p>and of course if you simply get rid of the type annotation altogether, the type <code>(a, [b]) -&gt; [(a, b)]</code> is exactly the type that Haskell infers (only with different names):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; let f (i, xs) = map (\\x -&gt; (i, x)) xs\nPrelude&gt; :t f\nf :: (t, [t1]) -&gt; [(t, t1)]\n</code></pre>\n\n<hr>\n\n<p><strong>Bonus:</strong> you can also shorten <code>\\x -&gt; (i, x)</code> to just <code>(i,)</code> using the <code>TupleSections</code> language extension:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TupleSections #-}\n\nf :: (a, [b]) -&gt; [(a, b)]\nf (i, xs) = map (i,) xs\n</code></pre>\n\n<p>Also, as \u00d8rjan Johansen has pointed out, the function <code>sequence</code> does indeed generalize this even further, but the mechanisms thereof are a bit beyond the scope.</p>\n"}, {"tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": false, "score": 2, "last_activity_date": 1545682558, "last_edit_date": 1545682558, "creation_date": 1443624630, "answer_id": 32869214, "question_id": 32859010, "link": "https://stackoverflow.com/questions/32859010/haskell-create-a-list-of-tuples-from-a-tuple-with-a-static-element-and-a-list/32869214#32869214", "title": "Haskell: Create a list of tuples from a tuple with a static element and a list", "body": "<p>A list comprehension would be quite intuitive and readable:</p>\n\n<pre><code>f (i,xs) = [(i,x) | x &lt;- xs]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5391297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baec81f39d6e728fb05bd6750dcee85c?s=128&d=identicon&r=PG&f=1", "display_name": "Will Christiansen", "link": "https://stackoverflow.com/users/5391297/will-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1545682558, "creation_date": 1443593560, "last_edit_date": 1443613115, "question_id": 32859010, "link": "https://stackoverflow.com/questions/32859010/haskell-create-a-list-of-tuples-from-a-tuple-with-a-static-element-and-a-list", "title": "Haskell: Create a list of tuples from a tuple with a static element and a list", "body": "<p>Need to create a list of tuples from a tuple with a static element and a list. Such as:  </p>\n\n<pre><code>(Int, [String]) -&gt; [(Int, String)]\n</code></pre>\n\n<p>Feel like this should be a simple <code>map</code> call but am having trouble actually getting it to output a tuple as <code>zip</code> would need a list input, not a constant.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 4, "creation_date": 1443584773, "post_id": 32857279, "comment_id": 53548273, "body": "What have you tried so far?  What didn&#39;t work?  Hint: check out the functions in Data.List on Hackage."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443585001, "post_id": 32857279, "comment_id": 53548332, "body": "If you can&#39;t use Data.List, then think recursion."}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1443590457, "post_id": 32857279, "comment_id": 53549979, "body": "Why start with <code>1</code>? Why not <code>0</code>? Or 42? Think about it, I am trying to lead you to a solution with this question!"}, {"owner": {"reputation": 1974, "user_id": 248662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c075988439e97288bed94e944686689?s=128&d=identicon&r=PG", "display_name": "Stone Mason", "link": "https://stackoverflow.com/users/248662/stone-mason"}, "edited": false, "score": 0, "creation_date": 1443594625, "post_id": 32857279, "comment_id": 53551604, "body": "I&#39;d argue that this question is sufficiently different to not be a duplicate. The other question specifically desired to implement their own function, whereas this question is easily answered with Haskell&#39;s default functions."}], "answers": [{"tags": [], "owner": {"reputation": 1974, "user_id": 248662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c075988439e97288bed94e944686689?s=128&d=identicon&r=PG", "display_name": "Stone Mason", "link": "https://stackoverflow.com/users/248662/stone-mason"}, "is_accepted": true, "score": 3, "last_activity_date": 1443590833, "last_edit_date": 1443590833, "creation_date": 1443590086, "answer_id": 32858278, "question_id": 32857279, "link": "https://stackoverflow.com/questions/32857279/haskell-how-to-convert-a-list-to-a-list-where-each-element-is-a-tuple-of-its-lo/32858278#32858278", "title": "Haskell: How to convert a list to a list where each element is a tuple of its location in the list and the original data?", "body": "<p>The easiest method I can conceive of is using the <code>zip</code> function. It takes two lists as arguments and returns a list of tuples. Pair that with a range <code>[1..]</code> and you have what you desire:</p>\n\n<pre><code>zip [1..] [a,b,c,d]\n</code></pre>\n\n<p>Will return</p>\n\n<pre><code>[(1,a),(2,b),(3,c),(4,d)]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5391297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baec81f39d6e728fb05bd6750dcee85c?s=128&d=identicon&r=PG&f=1", "display_name": "Will Christiansen", "link": "https://stackoverflow.com/users/5391297/will-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1443591931, "accepted_answer_id": 32858278, "answer_count": 1, "score": 0, "last_activity_date": 1443590833, "creation_date": 1443583803, "question_id": 32857279, "link": "https://stackoverflow.com/questions/32857279/haskell-how-to-convert-a-list-to-a-list-where-each-element-is-a-tuple-of-its-lo", "closed_reason": "Duplicate", "title": "Haskell: How to convert a list to a list where each element is a tuple of its location in the list and the original data?", "body": "<p>I need to convert a list to a list where each element is a tuple of its location in the list and the original data.Such as  </p>\n\n<pre><code>[a,b,c,d] -&gt; [(1,a),(2,b),(3,c),(4,d)]\n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "scotty"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 6, "creation_date": 1443566565, "post_id": 32854747, "comment_id": 53543553, "body": "Perhaps the question is &quot;Is <code>ScottyT</code> a monad transformer if it isn&#39;t an instance of <code>MonadTrans</code>?&quot;"}, {"owner": {"reputation": 2539, "user_id": 196666, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74847cb8c532cd2cf822ad049194645a?s=128&d=identicon&r=PG", "display_name": "forker", "link": "https://stackoverflow.com/users/196666/forker"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1443567485, "post_id": 32854747, "comment_id": 53543828, "body": "Thanks, Eric, I had it popping in my head, but if you look f.x. at <a href=\"https://en.wikibooks.org/wiki/Haskell/Monad_transformers\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Monad_transformers</a> it never states that MonadTrans is a prerequisite for somethingT to be a monad tranformer. It is more phrased as nice to have. check the line:   <code>Technically, this is all we need; however, it is convenient to make MaybeT an instance of a few other classes</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2539, "user_id": 196666, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74847cb8c532cd2cf822ad049194645a?s=128&d=identicon&r=PG", "display_name": "forker", "link": "https://stackoverflow.com/users/196666/forker"}, "edited": false, "score": 1, "creation_date": 1443571532, "post_id": 32855191, "comment_id": 53544966, "body": "thank you for the answer! It&#39;s a lot clearer to me now. Do you mind fixing/rephrasing the second sentence? I think either a junction is missing or I&#39;m too much of a newbie to parse it."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1443568741, "last_edit_date": 1443568741, "creation_date": 1443568168, "answer_id": 32855191, "question_id": 32854747, "link": "https://stackoverflow.com/questions/32854747/is-it-really-a-default-practice-to-make-every-monad-transformer-an-instance-of-m/32855191#32855191", "title": "Is it really a default practice to make every monad transformer an instance of MonadTrans?", "body": "<p><code>ScottyT</code> is not a monad transformer. Let's inline the (simplified) definition:</p>\n\n<pre><code>newtype ScottyT' m a = ScottyT' {\n   runS :: State [ (Request-&gt;m Response) -&gt; Request-&gt;m Response ] a\n  }\n</code></pre>\n\n<p>To define <code>lift</code> for this you would need, from a general <code>m a</code> action and such a middlewares list, have to obtain an actual <code>a</code> value, because <code>State s</code> yields actual unmonadic values. There's no way to do that.</p>\n\n<p>Now, if you argue that <code>MonadTrans</code> isn't actually required for something to be a monad transformer: mathematically speaking, monad transformers correspond to a composition of functors, but <code>ScottyT</code> doesn't actually implement such a composition.</p>\n"}], "owner": {"reputation": 2539, "user_id": 196666, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74847cb8c532cd2cf822ad049194645a?s=128&d=identicon&r=PG", "display_name": "forker", "link": "https://stackoverflow.com/users/196666/forker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "accepted_answer_id": 32855191, "answer_count": 1, "score": 9, "last_activity_date": 1443568741, "creation_date": 1443565405, "last_edit_date": 1443566436, "question_id": 32854747, "link": "https://stackoverflow.com/questions/32854747/is-it-really-a-default-practice-to-make-every-monad-transformer-an-instance-of-m", "title": "Is it really a default practice to make every monad transformer an instance of MonadTrans?", "body": "<p>So <em>Real World Haskell</em> says:</p>\n\n<blockquote>\n  <p>Every monad transformer is an instance of MonadTrans</p>\n</blockquote>\n\n<p>but I'm playing with <em>Scotty</em> and found out that its base monad transformer <code>ScottyT</code> is <em>not</em> an instance of <code>MonadTrans</code>.</p>\n\n<p>Looking at the release notes it seems that it is a deliberate design decision: <a href=\"https://github.com/scotty-web/scotty/blob/master/changelog.md#0100\">here</a>. Quote:</p>\n\n<blockquote>\n  <p>The monad parameters to ScottyT have been decoupled, causing the type of the ScottyT constructor to change. As a result, ScottyT is no longer a MonadTrans instance ...</p>\n</blockquote>\n\n<p>I hope you understand my confusion. Nevertheless, I will try to formulate strict questions:</p>\n\n<ul>\n<li>Why would one not want a monad transformer to be an instance of <code>MonadTrans</code>?</li>\n<li>How would you explain the aforementioned change in ScottyT design?</li>\n</ul>\n\n<p>P.S.: I do understand that I can define an instance of <code>MonadTrans ScottyT</code> myself, but should I? (links back to questions)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1443568394, "post_id": 32854390, "comment_id": 53544126, "body": "<code>interleave</code> would be a more accurate name than <code>intercalate</code>; there is an <code>intercalate</code> function in the library whose type and purpose is different"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1443585288, "post_id": 32854390, "comment_id": 53548397, "body": "Although this advice is dangerous here, because you should follow the accepted answer, in a situation in which you really truly are certain your patterns are exhaustive, you can put at the bottom a catch-all clause that evaluates to <code>error</code> and print an error message saying where and how your assumed invariants were violated. If you can genuinely prove correctness, you can write this error message correctly. This will shut the compiler up and possibly help you debug."}], "answers": [{"comments": [{"owner": {"reputation": 1974, "user_id": 248662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c075988439e97288bed94e944686689?s=128&d=identicon&r=PG", "display_name": "Stone Mason", "link": "https://stackoverflow.com/users/248662/stone-mason"}, "edited": false, "score": 1, "creation_date": 1443590440, "post_id": 32854535, "comment_id": 53549971, "body": "And since the asker accepted this answer, I assume they learnt from it and I&#39;m free to provide the actual answer here. The asker did not consider the case where the two lists were different sizes and thus one or the other lists is eventually empty, but not both."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1443564295, "creation_date": 1443564295, "answer_id": 32854535, "question_id": 32854390, "link": "https://stackoverflow.com/questions/32854390/intercalate-function-giving-non-exhaustive-patterns/32854535#32854535", "title": "Intercalate function giving Non-exhaustive patterns", "body": "<p>A hint should be enough here:</p>\n\n<p>You handle the case in which both lists are empty.</p>\n\n<p>You handle the case in which both lists are nonempty.</p>\n\n<p>Can you think about two more cases?</p>\n"}], "owner": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 32854535, "answer_count": 1, "score": -1, "last_activity_date": 1443564295, "creation_date": 1443563564, "question_id": 32854390, "link": "https://stackoverflow.com/questions/32854390/intercalate-function-giving-non-exhaustive-patterns", "title": "Intercalate function giving Non-exhaustive patterns", "body": "<p>I'm trying to intercalate two lists like this:</p>\n\n<pre><code>intercalate [0, 2, 4] [1, 3, 5]\n[0, 1, 2, 3, 4, 5]\n</code></pre>\n\n<p>So I created this function:</p>\n\n<pre><code>intercalate (x:xs) (y:ys) = x:(y:(intercalate xs ys))\nintercalate [] [] = []\n</code></pre>\n\n<p>However I always get this error:</p>\n\n<pre><code> Exception: &lt;interactive&gt;:3:5-57: Non-exhaustive patterns in function intercalate\n</code></pre>\n\n<p>I can't understand why!</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 2, "creation_date": 1443556244, "post_id": 32852565, "comment_id": 53538690, "body": "just dropping this note here that some people like <code>&lt;$&gt;</code> for <code>`fmap`</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443556354, "post_id": 32852565, "comment_id": 53538755, "body": "@JustinL. Indeed, I was going to use that! But I stepped back since it requires to <code>import Control.Applicative</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1443556567, "post_id": 32852565, "comment_id": 53538870, "body": "@chi In GHC 7.10 that import isn&#39;t necessary anymore. By the way, a fourth way of writing it is <code>print =&lt;&lt; take 50 . randomW1 &lt;$&gt; getStdGen</code>, which maps quite neatly to the different parts of the original do-block."}, {"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1443556892, "post_id": 32852565, "comment_id": 53539055, "body": "I am getting Precedence parsing error cannot mix \u2018.\u2019 [infixr 9] and \u2018fmap\u2019 [infixl 9] in the same infix expression from main =  do  \tw1 &lt;- take 50 . randomW1 <code>fmap</code> getStdGen \tprint w1"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1443556982, "post_id": 32852565, "comment_id": 53539118, "body": "@hotGopher Right. Added a few parentheses."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1443557455, "last_edit_date": 1443557455, "creation_date": 1443556121, "answer_id": 32852565, "question_id": 32852441, "link": "https://stackoverflow.com/questions/32852441/how-to-correctly-use-to-replace-the-do-and-in-this-code/32852565#32852565", "title": "how to correctly use &gt;&gt;= to replace the do and &lt;- in this code?", "body": "<pre><code>main = do  \n    w1 &lt;- getStdGen &gt;&gt;= (return . take 50 . randomW1)\n    print w1 \n</code></pre>\n\n<p>(parentheses not actually needed)</p>\n\n<p>Personally, I dislike the style above, since <code>&gt;&gt;= (return . f)</code> can be achieved with <code>fmap f</code> in a simpler way, as follows:</p>\n\n<pre><code>main = do  \n    w1 &lt;- (take 50 . randomW1) `fmap` getStdGen\n    -- or: w1 &lt;- take 50 . randomW1 &lt;$&gt; getStdGen\n    print w1 \n</code></pre>\n\n<p>Removing the last <code>&lt;-</code>, we get:</p>\n\n<pre><code>main = print . take 50 . randomW1 =&lt;&lt; getStdGen\n</code></pre>\n\n<hr>\n\n<p>Here's a more systematic approach to derive the last one, step by step. Start from the beginning:</p>\n\n<pre><code>main = do  \n    randomGen &lt;- getStdGen\n    let w1 = take 50 (randomW1 randomGen)\n    print w1 \n</code></pre>\n\n<p>Inline <code>w1</code>:</p>\n\n<pre><code>main = do  \n    randomGen &lt;- getStdGen\n    print (take 50 (randomW1 randomGen))\n</code></pre>\n\n<p>Desugar <code>do x &lt;- m ; e</code> into <code>m &gt;&gt;= \\x -&gt; e</code>. This is how the <code>do</code> syntax  is defined.</p>\n\n<pre><code>main = getStdGen &gt;&gt;= \\randomGen -&gt; print (take 50 (randomW1 randomGen))\n</code></pre>\n\n<p>Use composition for the last lambda:</p>\n\n<pre><code>main = getStdGen &gt;&gt;= print . take 50 . randomW1\n</code></pre>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 32852565, "answer_count": 1, "score": 4, "last_activity_date": 1443613967, "creation_date": 1443555645, "last_edit_date": 1443613967, "question_id": 32852441, "link": "https://stackoverflow.com/questions/32852441/how-to-correctly-use-to-replace-the-do-and-in-this-code", "title": "how to correctly use &gt;&gt;= to replace the do and &lt;- in this code?", "body": "<p>I have a question that goes on how to work with monads. I have the following code: </p>\n\n<pre><code>import System.Random\nimport Data.Random.Normal\nimport Graphics.EasyPlot\nimport Data.List\nimport Data.Function \n\nrandom' mean randomGen = zip x y \n    where                \n       x = normals' (mean, 0.2) randomGen :: [Float]\n       y = normals' (mean, 0.2) randomGen :: [Float]\n\nrandomW1 randomGen = [[x,y] | (x,y) &lt;- random' 1.0 randomGen]\n\nmain = do  \n    randomGen &lt;- getStdGen\n    let w1 = take 50 (randomW1 randomGen)\n    print w1 \n</code></pre>\n\n<p>and it works fine. However, I think its limiting to bind the output of <code>getStdGen</code> outside of <code>randomW1</code>, and thought I could be able to bind the <code>getStdGen</code> more directly to <code>randomW1</code> by writing</p>\n\n<pre><code>w1 = take 50 (randomW1 =&lt;&lt; getStdGen) \n</code></pre>\n\n<p>I believe I have utilised the <code>&gt;&gt;=</code> or <code>=&lt;&lt;</code> to \"pipe\" monadic structures together, and replacing the use of <code>do</code> and <code>&lt;-</code>. When I am doing as I suggest I discover that it </p>\n\n<pre><code>Couldn't match type \u2018IO\u2019 with \u2018[]\u2019\nExpected type: [StdGen]\n  Actual type: IO StdGen  \n</code></pre>\n\n<p>is there a way to use <code>&gt;&gt;=</code> to replace the <code>do</code> and <code>&lt;-</code> in this code? </p>\n"}, {"tags": ["haskell", "lambda-calculus"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1443555832, "post_id": 32852429, "comment_id": 53538480, "body": "We&#39;ll be able to give better hints if you show us what you&#39;ve tried so far."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443558019, "post_id": 32852429, "comment_id": 53539692, "body": "One uses to pattern matching to examine the possible cases (abstraction, application, ...). When doing <code>subst x e1 e2</code>, do we really need to consider the cases for <code>e1</code>? And for <code>e2</code>? Once you decide which is the interesting one to consider, you will need one equation for every case (look at the definition of <code>Exp</code>)."}, {"owner": {"reputation": 55, "user_id": 5357736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b319f086ca2471700d7396a6f135e04a?s=128&d=identicon&r=PG&f=1", "display_name": "user_9", "link": "https://stackoverflow.com/users/5357736/user-9"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443569423, "post_id": 32852429, "comment_id": 53544425, "body": "@chi well, I understand that I need to use recursion to check whether each variable in expression e2 is free and if it&#39;s free and it&#39;s x we substitute it by e1. I just don&#39;t really understand how to implement it with recursion in haskell"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1443578902, "post_id": 32852429, "comment_id": 53546838, "body": "Lambda calculus is actually rather subtle if you&#39;re going to do it properly, because of variable shadowing: what if you try to subst <code>y</code> instead of <code>0</code> in your example? You then need to rename the variable <code>y</code> in the original expression."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1443596431, "post_id": 32858639, "comment_id": 53552422, "body": "As &#216;rjan said, you do have to be careful about free variables in the expression you substitute in."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1443599980, "post_id": 32858639, "comment_id": 53554413, "body": "The <code>Lam z new_e</code> case can not be completed as it is. Consider <code>\\x.y</code> where <code>y</code> is substituted with <code>(a (b x))</code>. The result should be something like <code>\\z.a(b x)</code> -- note the fresh variable <code>z</code>."}, {"owner": {"reputation": 423, "user_id": 8188875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Iy6Su.jpg?s=128&g=1", "display_name": "arracso", "link": "https://stackoverflow.com/users/8188875/arracso"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1617449382, "post_id": 32858639, "comment_id": 118309417, "body": "@chi I&#39;m strugling trying to do what you are saying (avoiding to capture variables). How do you select this new variable z? Would you have a  list of variables and pick the first one not used?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 423, "user_id": 8188875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Iy6Su.jpg?s=128&g=1", "display_name": "arracso", "link": "https://stackoverflow.com/users/8188875/arracso"}, "edited": false, "score": 1, "creation_date": 1617451484, "post_id": 32858639, "comment_id": 118309911, "body": "@arracso Yes. You need to generate a variable name which is not in use. Typically you compute the list of variables in use and choose the &quot;first one&quot; (according to some numbering) which is not there."}], "tags": [], "owner": {"reputation": 1974, "user_id": 248662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c075988439e97288bed94e944686689?s=128&d=identicon&r=PG", "display_name": "Stone Mason", "link": "https://stackoverflow.com/users/248662/stone-mason"}, "is_accepted": false, "score": 2, "last_activity_date": 1443592384, "last_edit_date": 1443592384, "creation_date": 1443591937, "answer_id": 32858639, "question_id": 32852429, "link": "https://stackoverflow.com/questions/32852429/how-to-substitute-a-variable-in-an-expression-in-haskell/32858639#32858639", "title": "How to substitute a variable in an expression in haskell?", "body": "<p>I'd like to first point out that the pattern matching (<code>subst x (App z z') (App e e')</code>) is non-exhaustive. (Most of) the other patterns are trivial, so it's easy to forget them. I'd suggest against pattern matching the third argument, because if all you're doing is subsituting it into the second argument, you don't care if it's an <code>App</code>lication or <code>Nat</code>ural.</p>\n\n<p>The first step in most recursive functions is to consider cases. What's the base case? In this situation, it's where the second argument is equal to <code>Var x</code>:</p>\n\n<pre><code>-- Replace x with y in a Var. If the Var is equal to x, replace\n-- otherwise, leave alone.\nsubst x (Var a) y\n    | a == x    = y\n    | otherwise = (Var a)\n</code></pre>\n\n<p>Then we need to consider the step cases, what if it's an application, and what if it's a lambda abstraction?</p>\n\n<pre><code>-- Replace x with y in an application. We just need to replace\n-- x with y in z and in z', because an application doesn't\n-- bind x (x stays free in z and z').\nsubst x (App z z') y = (App new_z new_z')\n    where new_z  = -- Recursively call subst here.\n          new_z' = -- And recursively call subst here, too.\n\n-- Replace x with y in a lambda abstraction. We *do* need to\n-- check to make sure that the lambda doesn't bind x. If the\n-- lambda does bind x, then there's no possibility of x being\n-- free in e, and we can leave the whole lambda as-is.\nsubst x (Lam z e) y\n    | z == x    = (Lam z e)\n    | otherwise = (Lam z new_e)\n                  where new_e = -- Recursively call subst here.\n</code></pre>\n\n<p>Finally, all the trivial cases are the same (we leave alone both Nat and Op, since there's no chance we would be substituting them):</p>\n\n<pre><code>subst :: Id -&gt; Exp -&gt; Exp -&gt; Exp\nsubst _ nat_or_op _ = nat_or_op\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5357736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b319f086ca2471700d7396a6f135e04a?s=128&d=identicon&r=PG&f=1", "display_name": "user_9", "link": "https://stackoverflow.com/users/5357736/user-9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2523, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1443614071, "creation_date": 1443555593, "last_edit_date": 1443614071, "question_id": 32852429, "link": "https://stackoverflow.com/questions/32852429/how-to-substitute-a-variable-in-an-expression-in-haskell", "title": "How to substitute a variable in an expression in haskell?", "body": "<p>I'm working with the lambda calculus implemented in haskell. Expressions: </p>\n\n<pre><code>%x.e  -- lambda abstraction, like \\x-&gt;e in Haskell\ne e'  -- application\nx,y,z -- variables\nsucc, pred, ifzero, 0, 1, 2....\n</code></pre>\n\n<p>Syntax: </p>\n\n<pre><code>type Id = String\n\n-- The \"builtin\" functions.\ndata Op = Succ | Pred | IfZero\n       deriving (Show, Ord, Eq)\n\n-- Expressions of L\ndata Exp = Var Id\n     | Nat Integer\n     | Op Op\n     | Lam Id Exp\n     | App Exp Exp\n       deriving (Ord, Eq, Show)\n</code></pre>\n\n<p>There's also a function that converts the usual representation into <code>Exp</code>:</p>\n\n<pre><code>    parse \"%f. f 1 2\" = Lam \"f\" App (App (Var \"f\") (Nat 1)) (Nat 2)`\n</code></pre>\n\n<p>And I have to write the function <code>subst x e e'</code> that will substitute <code>e</code> for all \"free\" occurrences of <code>(Var x)</code> in <code>e'</code>. \"Free\" means that the variable it is not declared by a surrounding <code>%</code>. For example, in the expression</p>\n\n<pre><code>x (%x. x (%y.xz)) (%y.x)\n</code></pre>\n\n<p>there are 5 occurrences of <code>x</code>.  The first is \"free\".  The second is the parameter for the <code>%</code> expression and is never substituted for. The third and fourth occurrences refer to the parameter of the enclosing <code>%</code> expression.  The fifth is free.  Therefore if we substitute <code>0</code> for <code>x</code> we get <code>0 (%x. x (%y.xz)) (%y.0)</code>. </p>\n\n<p>All I need to use is pattern-matching and recursion. All I was able to write is the function prototype as </p>\n\n<pre><code>subst :: Id -&gt; Exp -&gt; Exp -&gt; Exp\nsubst x (App z z') (App e e') =\n</code></pre>\n\n<p>If somebody could give me a hint how to implement the function it would be great. Any help is highly appreciated  </p>\n"}, {"tags": ["haskell", "functional-programming", "list-processing"], "answers": [{"comments": [{"owner": {"reputation": 997, "user_id": 2085282, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7f3c60909c612ccd978a2e381c4ac45?s=128&d=identicon&r=PG", "display_name": "user2085282", "link": "https://stackoverflow.com/users/2085282/user2085282"}, "edited": false, "score": 0, "creation_date": 1443553195, "post_id": 32851609, "comment_id": 53537127, "body": "Precisely what I was looking for. One thing to note is that your initial value needs to be a list of lists, equal in length to the input list, otherwise it won&#39;t actually get to any of the rows, i.e. <code>let reGrid2 xs = foldr (zipWith (++)) (replicate (length xs) []) xs</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 997, "user_id": 2085282, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7f3c60909c612ccd978a2e381c4ac45?s=128&d=identicon&r=PG", "display_name": "user2085282", "link": "https://stackoverflow.com/users/2085282/user2085282"}, "edited": false, "score": 0, "creation_date": 1443553556, "post_id": 32851609, "comment_id": 53537293, "body": "@user2085282, fixed, but differently."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1443558023, "last_edit_date": 1443558023, "creation_date": 1443552568, "answer_id": 32851609, "question_id": 32851340, "link": "https://stackoverflow.com/questions/32851340/is-there-a-standard-name-for-this-operation/32851609#32851609", "title": "Is there a standard name for this operation?", "body": "<p>You have a bunch of things, and you want to turn them into one thing. The usual way to do that is with a fold of some sort. So let's start off with that:</p>\n\n<pre><code>regrid [] = []\nregrid xs = foldr go (repeat []) xs\n</code></pre>\n\n<p>Now suppose you have one matrix and you also have the result of re-gridding the rest. How can you combine them? Well, you want to merge the rows together until one runs out, which sounds like a job for <code>zipWith</code>. So putting everything together,</p>\n\n<pre><code>regrid = foldr (zipWith (++)) []\n</code></pre>\n\n<p>That's not one standard function, but it's short and doesn't monkey around with partial functions. It does, however, have an efficiency problem if the list is long. To fix that, you could switch to a left fold, but getting the strictness right will be tricky. I can write that up later.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1443553901, "creation_date": 1443553901, "answer_id": 32852002, "question_id": 32851340, "link": "https://stackoverflow.com/questions/32851340/is-there-a-standard-name-for-this-operation/32852002#32852002", "title": "Is there a standard name for this operation?", "body": "<p>Your function is very similar (but not identical) to this one:</p>\n\n<pre><code>reGrid' = map concat . transpose\n</code></pre>\n\n<p>For example, my QuickCheck property <code>\\xs -&gt; reGrid xs == reGrid' xs</code> turns up this difference:</p>\n\n<pre><code>*Main&gt; reGrid [[[]],[]]\n[]\n*Main&gt; reGrid' [[[]],[]]\n[[]]\n</code></pre>\n\n<p>In short, your version will \"cut off\" more stuff that you might actually care about (or not). For a more telling example:</p>\n\n<pre><code>*Main&gt; reGrid [[\"abc\"],[]]\n[]\n*Main&gt; reGrid' [[\"abc\"],[]]\n[\"abc\"]\n</code></pre>\n\n<p>You can judge for yourself whether the cases where they differ matter to you.</p>\n"}], "owner": {"reputation": 997, "user_id": 2085282, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7f3c60909c612ccd978a2e381c4ac45?s=128&d=identicon&r=PG", "display_name": "user2085282", "link": "https://stackoverflow.com/users/2085282/user2085282"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 32851609, "answer_count": 2, "score": 2, "last_activity_date": 1443558023, "creation_date": 1443551540, "question_id": 32851340, "link": "https://stackoverflow.com/questions/32851340/is-there-a-standard-name-for-this-operation", "title": "Is there a standard name for this operation?", "body": "<p>So in working on a Haskell project, I've ended up writing the following function</p>\n\n<pre><code>reGrid :: [[[a]]] -&gt; [[a]]\nreGrid [] = []\nreGrid xs | any null xs = []\n          | otherwise = (concat $ map head xs) : reGrid (map tail xs)\n</code></pre>\n\n<p>For those who don't speak Haskell, this takes a list of matrices, and joins the corresponding rows into a new matrix.</p>\n\n<p>Its popped up several times in this project, and I the feeling that this is some kind of common operation that I've missed.</p>\n\n<p>Is there a standard name for this operation? Searching Hoogle for</p>\n\n<pre><code>[[[a]]] -&gt; [[a]\n</code></pre>\n\n<p>Yields nothing useful.</p>\n"}, {"tags": ["haskell", "package", "cabal", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 3, "creation_date": 1443560893, "post_id": 32852774, "comment_id": 53541249, "body": "I know this method. However, I would like to put the netwire library at a more convenient place, isolated from the source. Doing what you said makes me feel like compiling a bunch of softwares under /usr and keep the sources right there."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1443560936, "post_id": 32852774, "comment_id": 53541275, "body": "Or say, I&#39;d like it if I use <code>stack ghci</code> anywhere, I can just import <code>Control.Wire</code>"}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "reply_to_user": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1443561042, "post_id": 32852774, "comment_id": 53541330, "body": "I&#39;m not 100% but I don&#39;t think that is a supported use case."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1443562507, "post_id": 32852774, "comment_id": 53542031, "body": "Does that mean I have to keep the source then? I think it is better to just take the libraries"}, {"owner": {"reputation": 1407, "user_id": 4930992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108ce448671bef8443fcd64efb3012fa?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Armstrong", "link": "https://stackoverflow.com/users/4930992/christopher-armstrong"}, "edited": false, "score": 4, "creation_date": 1443563024, "post_id": 32852774, "comment_id": 53542258, "body": "You can specify a git location as a package. See the docs on stack.yaml. That way you don&#39;t need to put the source in your project&#39;s directory. Sorry for no links, I&#39;m on my phone."}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1443563195, "post_id": 32852774, "comment_id": 53542343, "body": "AFAIK stack is a tool for building collections of packages from <i>source</i>, with the ability to cache some of the build artifiacts (the ones that are part of the Stackage nightlies/lts-s). Since Netwire is not part of Stackage I don&#39;t think you have any hope of it ending up in the cache."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1443563260, "post_id": 32852774, "comment_id": 53542370, "body": "OK, I guess for now I will just find a nice place to put the sources."}, {"owner": {"reputation": 452, "user_id": 250992, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90b8fb9faf69878242370162687878e7?s=128&d=identicon&r=PG", "display_name": "triplepoint217", "link": "https://stackoverflow.com/users/250992/triplepoint217"}, "edited": false, "score": 2, "creation_date": 1516896429, "post_id": 32852774, "comment_id": 83886651, "body": "You can get around needing to have netwire as a subdirectory with a symlink. Just put it wherever you want and drop a symlink to it into your package. It&#39;s kind of a hack, but it will get the job done."}, {"owner": {"reputation": 491, "user_id": 4518482, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2e9ccd1af4190abf1b0dac86a7f38a97?s=128&d=identicon&r=PG&f=1", "display_name": "chansey", "link": "https://stackoverflow.com/users/4518482/chansey"}, "edited": false, "score": 0, "creation_date": 1587462746, "post_id": 32852774, "comment_id": 108514502, "body": "&quot;You can also put the modified source online (if the license permits) and refer to the source using either a tarball URL&quot; It seems that &quot;packages&quot; does not support this syntax in &quot;stack.yaml&quot;? it prompt InvalidAbsDir."}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": false, "score": 26, "last_activity_date": 1537601447, "last_edit_date": 1537601447, "creation_date": 1443556839, "answer_id": 32852774, "question_id": 32849269, "link": "https://stackoverflow.com/questions/32849269/how-to-install-use-a-local-version-of-package-using-stack/32852774#32852774", "title": "How to install/use a local version of package using Stack?", "body": "<p>So you have a project where you want to use your locally patched Netwire version and in your project you have a <code>stack.yml</code>, as an example:</p>\n\n<pre class=\"lang-yaml prettyprint-override\"><code>flags: {}\npackages:\n- '.'\nextra-deps: {}\nresolver: lts-3.7\n</code></pre>\n\n<p>You also have an dependency on <code>netwire</code> declared in your cabal file.</p>\n\n<p>To use you patched Netwire in this project of yours you simply put the patched Netwire package in a subdirectory of your project, perhaps called <code>netwire</code>, and update your <code>stack.yml</code> as such:</p>\n\n<pre class=\"lang-yaml prettyprint-override\"><code>flags: {}\npackages:\n- '.'\n- netwire\nextra-deps: {}\nresolver: lts-3.7\n</code></pre>\n\n<p>Now <code>stack build</code> will build your project with the patched Netwire version.</p>\n\n<p>You can also put the modified source online (if the license permits) and refer to the <em>source</em> using either a tarball URL</p>\n\n<pre><code>- https://example.com/netwire.tar.gz\n</code></pre>\n\n<p>or a git repository and commit reference:</p>\n\n<pre><code>- location:\n    git: git@example.com/netwire\n    commit: 6a86ee32e5b869a877151f74064572225e1a0398\n</code></pre>\n\n<p>(Check out the documentation for more info: <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#packages-and-extra-deps\" rel=\"noreferrer\">https://docs.haskellstack.org/en/stable/yaml_configuration/#packages-and-extra-deps</a>)</p>\n"}], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6200, "favorite_count": 5, "answer_count": 1, "score": 37, "last_activity_date": 1537601447, "creation_date": 1443544356, "last_edit_date": 1443845316, "question_id": 32849269, "link": "https://stackoverflow.com/questions/32849269/how-to-install-use-a-local-version-of-package-using-stack", "title": "How to install/use a local version of package using Stack?", "body": "<p>The situation is, I am trying to install Netwire using Stack. However, there is a problem in the latest netwire 5.0.1, as reported by dhobbs: <a href=\"http://hub.darcs.net/ertes/netwire/issue/13\" rel=\"noreferrer\">http://hub.darcs.net/ertes/netwire/issue/13</a> </p>\n\n<p>Since I don't know when the problem will ever be fixed, I downloaded the repo and made the change myself. However, I don't understand how to install such a locally patched version. <code>stack install</code> does not install that into <code>~/.stack</code>. Does anyone have an idea?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Now I am developing some other libraries using Stack. How do I make another project use that libraries? Hard coding a relative path looks incredibly ugly.</p>\n"}, {"tags": ["javascript", "mongodb", "haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1443548611, "post_id": 32841765, "comment_id": 53534729, "body": "One does not simply remove a value from an <code>IO</code>... unless you&#39;re willing to use the black magic of <code>unsafePerformIO</code>... but that&#39;s generally frowned upon. You need <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\"><i>monads</i></a>!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443561888, "post_id": 32841765, "comment_id": 53541757, "body": "Taking the <code>Value</code> out of an <code>IO Value</code> makes as much sense as taking the cake out of a cake recipe. You need to use the cake recipe to put together a plan for making a meal, then hand the plan to the chef (named Run Time System or RTS) by giving it the name <code>main</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1443558082, "last_edit_date": 1443558082, "creation_date": 1443525456, "answer_id": 32842519, "question_id": 32841765, "link": "https://stackoverflow.com/questions/32841765/haskell-mongodb-eval-javascript/32842519#32842519", "title": "Haskell, MongoDB, eval JavaScript", "body": "<p>You can't do what you ask, but chances are you do not need to. You can do the following, instead</p>\n\n<pre><code>foo :: Action IO SomeOtherType\nfoo = do value &lt;- action -- where action :: Action IO SomeType\n      -- here value :: SomeType can be used normally\n      ...\n      lastAction\n</code></pre>\n\n<p>with the only restriction that the <code>lastAction</code> has type <code>Action IO SomeOtherType</code>.</p>\n\n<p>The thumb rule is, you can't extract a value from a monad forever, but you can extract it \"temporarily\" as long as you eventually produce another value inside the same monad. This is (arguably) what monads are all about, from a purely practical point of view.</p>\n\n<p>I'd suggest you read some monad tutorial. <a href=\"http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html\" rel=\"nofollow\">Monads in pictures</a> is among the easiest, and one of my favourites. The one in <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow\">LYAH</a> is also good, and informative.</p>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 32842519, "answer_count": 1, "score": 1, "last_activity_date": 1449837915, "creation_date": 1443523040, "last_edit_date": 1449837915, "question_id": 32841765, "link": "https://stackoverflow.com/questions/32841765/haskell-mongodb-eval-javascript", "title": "Haskell, MongoDB, eval JavaScript", "body": "<p>I wrote a method to execute JavaScript code by using <code>eval</code> method in Haskell driver for MongoDB.</p>\n\n<pre><code>toolsDB_GenerateID :: Action IO Value\ntoolsDB_GenerateID = \n        eval (Javascript ([] :: [Field]) \"var ret_id = db.counters.findAndModify({query: { _id: \\'my_id\\' },update: { $inc: { seq: 1 } },new: true}); return {id:ret_id.seq};\")::Action IO Value\n</code></pre>\n\n<p>It works!!!</p>\n\n<p>I use that in the following:</p>\n\n<pre><code>inserData :: Action IO () \ninserData = do resultEval &lt;-toolsDB_GenerateID \n               insert \"test\" [\"id\" =: resultEval]\n               liftIO $ return ()\n</code></pre>\n\n<p>I just can not understand how I can get a real value from <code>Action IO Value</code>?</p>\n\n<p>Like this: </p>\n\n<pre><code>Action IO Value -&gt; Value \n</code></pre>\n\n<p>or</p>\n\n<pre><code>Action IO Value -&gt; Int\n</code></pre>\n\n<p>How can I release that?</p>\n"}, {"tags": ["haskell", "singleton-type"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1443516194, "post_id": 32839389, "comment_id": 53513755, "body": "No, you can&#39;t. If you can give some more context about what you&#39;re trying to accomplish, someone may be able to help."}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 2, "creation_date": 1443541879, "post_id": 32839389, "comment_id": 53530733, "body": "Try writing a Short, Self Contained, Correct (Compilable), Example (sscce.org), so we can try it ourselves."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443548236, "post_id": 32839389, "comment_id": 53534533, "body": "@dfeuer added concrete examples with what I think are adequate explanations of motivations for design decisions.  thanks!"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1443548854, "post_id": 32839389, "comment_id": 53534883, "body": "Do you do heavy computation with <code>Nat</code>? If not, then singleton Peano naturals would be a much better choice."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1443549564, "post_id": 32839389, "comment_id": 53535288, "body": "Two critical things are missing with <code>GHC.TypeLits</code>: induction and the singleton versions of the builtin <code>Nat</code> type families. The latter could be implemented with unsafe tricks, but the former seems hopeless to me."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1443550991, "post_id": 32839389, "comment_id": 53536037, "body": "@Andr&#225;sKov&#225;cs, if you&#39;re willing to do unsafe tricks you might be able to fake induction with an explicit eliminator."}], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443548418, "post_id": 32845010, "comment_id": 53534637, "body": "It looks like <code>reflectNat</code>&#39;s definition in <code>reflections</code> is basically similar (it uses <code>unsafeCoerce</code>), so this might be an okay road to go down :)  I&#39;ll look into <code>singletons</code>...do you know how I&#39;d write <code>reflectNat</code> in <code>singletons</code> fashion?  <code>Sing Nat</code> seems to provide something that I can&#39;t pattern match on/a single constructor like <code>Proxy</code>, so I&#39;m not sure how to wrangle with it."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443551927, "post_id": 32845010, "comment_id": 53536511, "body": "Can&#39;t say about <code>singleton-2.0</code> as there aren&#39;t haddocks online, but for <code>singletons-1.1.2.1</code> seems that it uses <code>SNat :: KnownNat n =&gt; Sing Nat n</code> - so actually no difference. I was in my simple <i>PeanoNat</i> world :("}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 0, "last_activity_date": 1443532998, "last_edit_date": 1443532998, "creation_date": 1443532531, "answer_id": 32845010, "question_id": 32839389, "link": "https://stackoverflow.com/questions/32839389/can-i-get-knownnat-n-to-imply-knownnat-n-3-etc/32845010#32845010", "title": "Can I get KnownNat n to imply KnownNat (n * 3), etc?", "body": "<p>Your question isn't very descriptive, so I'll try my best to feel blanks:</p>\n\n<p>Let's assume that <code>Blah n</code> is <code>Proxy n</code>.</p>\n\n<p>I also assume that <code>reflectNat</code> is a way to call universally quantified (over typelevel <code>Nat</code>) function, using term-level natural number.</p>\n\n<p>I don't know better way than writing your own <code>reflectNat</code> providing that </p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport GHC.TypeLits\nimport Data.Proxy\n\ndata Vec a (n :: Nat) where\n  Nil  :: Vec a 0\n  Cons :: a -&gt; Vec a n -&gt; Vec a (1 + n)\n\nvecToList :: Vec a n -&gt; [a]\nvecToList Nil = []\nvecToList (Cons h t) = h : vecToList t\n\nrepl :: forall n a. KnownNat n =&gt; Proxy n -&gt; a -&gt; Vec a n\nrepl p x = undefined -- this is a bit tricky with Nat from GHC.TypeLits, but possible\n\nfoo :: forall (n :: Nat). KnownNat (1 + n) =&gt; Proxy n -&gt; Vec Bool (1 + n)\nfoo _ = repl (Proxy :: Proxy (1 + n)) True\n\n-- Here we have to write our own version of 'reflectNat' providing right 'KnownNat' instances\n-- so we can call `foo`\nreflectNat :: Integer -&gt; (forall n. KnownNat (1 + n) =&gt; Proxy (n :: Nat) -&gt; a) -&gt; a\nreflectNat = undefined\n\ntest :: [Bool]\ntest = reflectNat 5 $ \\p -&gt; vecToList (foo p)\n</code></pre>\n\n<hr>\n\n<p>Alternatively, using <code>singletons</code> you can use <code>SomeSing</code>. Then types will be different</p>\n\n<pre><code>reflectNat :: Integer -&gt; (forall (n :: Nat). SomeSing (n :: Nat) -&gt; a) -&gt; a\n</code></pre>\n\n<p>I.e. instead of magic dict <code>KnownNat</code> you have concrete singleton value. Thus in <code>foo</code> you'd need to construct <code>SomeSing (1 + n)</code> explicitly, given <code>SomeSing n</code> -- which is quite simple.</p>\n\n<p>In run-time both <code>KnownNat</code> dictionary and <code>SomeSing</code> value will be passed around carring the number value, and explicit is IMHO better in this situation.p)</p>\n"}, {"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443601899, "post_id": 32860983, "comment_id": 53555472, "body": "Thanks for taking the time to answer.  It&#39;s &quot;sound&quot;, but it looks like this can only work if <code>trickValue</code>, the function, is the same as whatever type family you&#39;re applying to <code>m</code> in the type signature of <code>trick</code> (in this case, <code>(*3)</code>).  As far as I can see, the compiler won&#39;t help me if i have <code>trickValue = (*4)</code> instead.  Is there any formulation where I can&#39;t do something silly like this?"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443627679, "post_id": 32860983, "comment_id": 53572308, "body": "@JustinL. I&#39;m afraid you&#39;ll need a fully dependent language there. Either you&#39;d have inefficient <code>Nat</code> representation with singletons, or you have to use <code>unsafeCoerce</code> and verify the correctness by other means than type system."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443647691, "post_id": 32860983, "comment_id": 53582828, "body": "So sad.  Well, I think I can get <code>V</code> from <i>linear</i> to work with arbitrary peano nats that I can cook up or use from singletons, but I lose the nice type lits syntax.  If only there was a way to have type lits also be polymorphic like term numerical lits.  thanks for your patience and help!"}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 4, "last_activity_date": 1443600384, "creation_date": 1443600384, "answer_id": 32860983, "question_id": 32839389, "link": "https://stackoverflow.com/questions/32839389/can-i-get-knownnat-n-to-imply-knownnat-n-3-etc/32860983#32860983", "title": "Can I get KnownNat n to imply KnownNat (n * 3), etc?", "body": "<p>I post another answer as it is more direct, editing the previous won't make sense.</p>\n\n<p>In fact using the trick (popularised if not invented by Edward Kmett), from <a href=\"https://hackage.haskell.org/package/reflection-2.1/docs/Data-Reflection.html\" rel=\"nofollow\">reflections</a> <code>reifyNat</code>:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport GHC.TypeLits\nimport Data.Proxy\nimport Unsafe.Coerce\n\nnewtype MagicNat3 r = MagicNat3 (forall (n :: Nat). KnownNat (n * 3) =&gt; Proxy n -&gt; r)\n\ntrickValue :: Integer -&gt; Integer\ntrickValue = (*3)\n\n-- No type-level garantee that the function will be called with (n * 3)\n-- you have to believe us\ntrick :: forall a n. KnownNat n =&gt; Proxy n -&gt; (forall m. KnownNat (m * 3) =&gt; Proxy m -&gt; a) -&gt; a\ntrick p f = unsafeCoerce (MagicNat3 f :: MagicNat3 a) (trickValue (natVal p)) Proxy\n\ntest :: forall m. KnownNat (m * 3) =&gt; Proxy m -&gt; Integer\ntest _ = natVal (Proxy :: Proxy (m * 3))\n</code></pre>\n\n<p>So when you run it:</p>\n\n<pre><code>\u03bb *Main &gt; :t trick (Proxy :: Proxy 4) test :: Integer\ntrick (Proxy :: Proxy 4) test :: Integer :: Integer\n\u03bb *Main &gt; trick (Proxy :: Proxy 4) test :: Integer\n12\n</code></pre>\n\n<p>The trick is based on the fact that in GHC the one member class dictionaries (like <code>KnownNat</code>) are represented by the member itself. In <code>KnownNat</code> situation it turns out to be <code>Integer</code>. So we just <code>unsafeCoerce</code> it there. Universal quantification makes it sound from the outside.</p>\n"}, {"tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 5, "last_activity_date": 1450663036, "creation_date": 1450663036, "answer_id": 34387963, "question_id": 32839389, "link": "https://stackoverflow.com/questions/32839389/can-i-get-knownnat-n-to-imply-knownnat-n-3-etc/34387963#34387963", "title": "Can I get KnownNat n to imply KnownNat (n * 3), etc?", "body": "<p>So, three months later, I have been going back and forth on good ways to accomplish this, but I finally settled on an actual very succinct trick that doesn't require any throwaway newtypes; it involves using a <code>Dict</code> from the <em><a href=\"http://hackage.haskell.org/package/constraints\" rel=\"noreferrer\">constraints</a></em> library;  you could easily write a:</p>\n\n<pre><code>natDict :: KnownNat n =&gt; Proxy n -&gt; Dict (KnownNat n)\nnatDict _ = Dict\n\ntriple :: KnownNat n =&gt; Proxy n -&gt; Dict (KnownNat (n * 3))\ntriple p = reifyNat (natVal p * 3) $\n             \\p3 -&gt; unsafeCoerce (natDict p3)\n</code></pre>\n\n<p>And once you get <code>Dict (KnownNat (n * 3)</code>, you can pattern match on it to get the <code>(n * 3)</code> instance in scope:</p>\n\n<pre><code>case triple (Proxy :: Proxy n) of\n  Dict -&gt; -- KnownNat (n * 3) is in scope\n</code></pre>\n\n<p>You can actually set these up as generic, too:</p>\n\n<pre><code>addNats :: (KnownNat n, KnownNat m) =&gt; Proxy n -&gt; Proxy m -&gt; Dict (KnownNat (n * m))\naddNats px py = reifyNat (natVal px + natVal py) $\n                  \\pz -&gt; unsafeCoerce (natDict pz)\n</code></pre>\n\n<p>Or, you can make them operators and you can use them to \"combine\" Dicts:</p>\n\n<pre><code>infixl 6 %+\ninfixl 7 %*\n(%+) :: Dict (KnownNat n) -&gt; Dict (KnownNat m) -&gt; Dict (KnownNat (n + m))\n(%*) :: Dict (KnownNat n) -&gt; Dict (KnownNat m) -&gt; Dict (KnownNat (n * m))\n</code></pre>\n\n<p>And you can do things like:</p>\n\n<pre><code>case d1 %* d2 %+ d3 of\n  Dict -&gt; -- in here, KnownNat (n1 * n2 + n3) is in scope\n</code></pre>\n\n<p>I've wrapped this up in a nice library, <strong><a href=\"https://hackage.haskell.org/package/typelits-witnesses\" rel=\"noreferrer\">typelits-witnesses</a></strong> that I've been using.  Thank you all for your help!</p>\n"}], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 1, "accepted_answer_id": 32860983, "answer_count": 3, "score": 10, "last_activity_date": 1450663036, "creation_date": 1443515628, "last_edit_date": 1443552984, "question_id": 32839389, "link": "https://stackoverflow.com/questions/32839389/can-i-get-knownnat-n-to-imply-knownnat-n-3-etc", "title": "Can I get KnownNat n to imply KnownNat (n * 3), etc?", "body": "<p>I'm working with data types of this shape, using <code>V</code> from <code>linear</code>:</p>\n\n<pre><code>type Foo n = V (n * 3) Double -&gt; Double\n</code></pre>\n\n<p>Having it fixed on <code>n</code> is pretty important, because I want to be able to ensure that I'm passing in the right number of elements at compile-time.  This is a part of my program that already works well, independent of what I'm doing here.</p>\n\n<p>For any <code>KnownNat n</code>, I can generate a <code>Foo n</code> satisfying the behavior that my program needs.  For the purposes of this question it can be something silly like</p>\n\n<pre><code>mkFoo :: KnownNat (n * 3) =&gt; Foo n\nmkFoo = sum\n</code></pre>\n\n<p>Or for a more meaningful example, it can generate a random <code>V</code> of the same length and use <code>dot</code> on the two.  The <code>KnownNat</code> constraint here is redundant, but in reality, it's needed to do make a <code>Foo</code>.  I make one <code>Foo</code> and use it for my entire program (or with multiple inputs), so this guarantees me that whenever I use it, I'm using on things with the same length, and on things that the structure of the <code>Foo</code> dictates.</p>\n\n<p>And finally, I have a function that makes inputs for a <code>Foo</code>:</p>\n\n<pre><code>bar :: KnownNat (n * 3) =&gt; Proxy n -&gt; [V (n * 3) Double]\n</code></pre>\n\n<p><em>bar</em> is actually the reason why i'm using <code>n * 3</code> as a type function, instead of just manually expanding it out.  The reason is that <code>bar</code> might do its job by using three vectors of length <code>n</code> and appending them all together as a vector of length <code>n * 3</code>.  Also, <code>n</code> is a much more meaningful parameter to the function, semantically, than <code>n * 3</code>.  This also lets me disallow improper values like <code>n</code>'s that aren't multiples of 3, etc.</p>\n\n<p>Now, before, everything worked fine as long as I defined a type synonym at the beginning:</p>\n\n<pre><code>type N = 5\n</code></pre>\n\n<p>And I can just then pass in <code>Proxy :: Proxy N</code> to <code>bar</code>, and use <code>mkFoo :: Foo N</code>.  And everything worked fine.</p>\n\n<pre><code>-- works fine\ndoStuff :: [Double]\ndoStuff = let inps = bar (Proxy :: Proxy N)\n          in  map (mkFoo :: Foo N) inps\n</code></pre>\n\n<p>But now I want to be able to adjust <code>N</code> during runtime by loading information from a file, or from command line arguments.</p>\n\n<p>I tried doing it by calling <code>reflectNat</code>:</p>\n\n<pre><code>doStuff :: Integer -&gt; Double\ndoStuff n = reflectNat 5 $ \\pn@(Proxy :: Proxy n) -&gt;\n              let inps = bar (Proxy :: Proxy n)\n              in  map (mkFoo :: Foo n) inps\n</code></pre>\n\n<p>But...<code>bar</code> and <code>mkFoo</code> require <code>KnownNat (n * 3)</code>, but <code>reflectNat</code> just gives me <code>KnownNat n</code>.</p>\n\n<p>Is there any way I can generalize the proof that <code>reflectNat</code> gives me to satisfy <code>foo</code> ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 7, "creation_date": 1443519414, "post_id": 32838869, "comment_id": 53515762, "body": "So, these are no backslashes, they are lambdas in disguise. Interesting."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1443550070, "post_id": 32838869, "comment_id": 53535579, "body": "@chi: Not even much of a disguise since that&#39;s the syntax we normally have for lambdas :)."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 2, "creation_date": 1443561784, "post_id": 32838869, "comment_id": 53541710, "body": "Thanks for the great answer. On a side note, I realized that the <code>.(...)</code> after some <code>.&#47;</code> represents a let statement with pattern matching (which means it involves computation). For example, when you say <code>let (a, b) = myFunc</code> or <code>let Just x = lookup ...</code> etc."}], "tags": [], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "is_accepted": true, "score": 17, "last_activity_date": 1443597035, "last_edit_date": 1443597035, "creation_date": 1443514021, "answer_id": 32838869, "question_id": 32838177, "link": "https://stackoverflow.com/questions/32838177/why-are-there-so-many-backslashes-in-the-prof-file/32838869#32838869", "title": "Why are there so many backslashes (\\) in the *.prof file?", "body": "<p>Let</p>\n\n<pre><code>import Control.Monad\n\nmain = do\n    forM_ [1..1000] $ \\i -&gt;\n        if mod i 2 == 0 then putStrLn \"Foo\"\n                        else print i\n</code></pre>\n\n<p>and run with</p>\n\n<pre><code>ghc -rtsopts -prof -fprof-auto z.hs &amp;&amp; ./z +RTS -p &amp;&amp; cat z.prof\n</code></pre>\n\n<p>then, following <a href=\"https://downloads.haskell.org/~ghc/7.2.1/docs/html/users_guide/profiling.html#prof-rules\" rel=\"nofollow\">rules to set cost centres</a></p>\n\n<pre><code>COST CENTRE MODULE           %time %alloc\nmain.\\      Main              80.0   84.4\nmain        Main              20.0   13.2\nCAF         GHC.IO.Handle.FD   0.0    2.1\n</code></pre>\n\n<p>the backslashes show that stack level, <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html#scc-pragma\" rel=\"nofollow\">you can set names for each one</a></p>\n\n<pre><code>forM_ [1..1000] $ \\i -&gt;\n    {-# SCC \"myBranch\" #-}\n    if mod i 2 == 0 then putStrLn \"Foo\"\n                    else print i\n</code></pre>\n\n<p>and now</p>\n\n<pre><code>COST CENTRE MODULE           %time %alloc\nmyBranch    Main              90.0   84.4\nmain        Main              10.0   13.2\nCAF         GHC.IO.Handle.FD   0.0    2.1\n</code></pre>\n\n<p>(Added @trVoldemort comment)</p>\n\n<p>Also, <code>(...)</code> seems to be used for <code>let</code> assignments with computations involved</p>\n\n<pre><code>data T = T Int (IO ()) (IO ())\nmain =\n   forM_ [T (mod i 2) (putStrLn \"Foo\") (print i) | i &lt;- [1..1000]] $ \\q -&gt;\n        let T a b c = q -- Will be `(...)`\n        in  if a == 0 then b else c\n</code></pre>\n\n<p>with profile output</p>\n\n<pre><code>main.\\        Main\n main.\\.b     Main\n main.\\.c     Main\n main.\\.(...) Main\n main.\\.a     Main\n</code></pre>\n\n<p>with SCC pragma</p>\n\n<pre><code>forM_ [T (mod i 2) (putStrLn \"Foo\") (print i) | i &lt;- [1..1000]] $ \\q -&gt;\n     let T a b c = {-# SCC \"myBind\" #-} q\n     in  if a == 0 then b else c\n</code></pre>\n\n<p>and output</p>\n\n<pre><code>main.\\.b     Main\nmain.\\.c     Main\nmain.\\.(...) Main\n myBind      Main\nmain.\\.a     Main\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 32838869, "answer_count": 1, "score": 16, "last_activity_date": 1443597035, "creation_date": 1443511817, "question_id": 32838177, "link": "https://stackoverflow.com/questions/32838177/why-are-there-so-many-backslashes-in-the-prof-file", "title": "Why are there so many backslashes (\\) in the *.prof file?", "body": "<p>Looking into the <code>*.prof</code> file generated using <code>+RTS -p</code> with profiling enabled compilation, I see a lot of these sub-routines that named <code>\\</code>:</p>\n\n<pre><code>COST CENTRE           MODULE                         %time %alloc\n\nmain.\\.\\.\\            Main                            74.1   85.8\nunstreamChunks/inner  Data.Text.Internal.Lazy.Fusion  11.9    8.6 \ninverseLetters.\\      Main                             4.5    1.7 \nmain.\\.\\.\\.(...)      Main                             2.9    1.0 \nmain.\\.\\.\\.(...)      Main                             2.8    1.0 \nunstreamChunks/resize Data.Text.Internal.Lazy.Fusion   1.2    0.8 \nunstreamChunks/outer  Data.Text.Internal.Lazy.Fusion   1.1    0.5 \n</code></pre>\n\n<p>which looks cryptic to me. What do these represent?</p>\n"}, {"tags": ["haskell", "data-structures", "functional-programming"], "comments": [{"owner": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "edited": false, "score": 0, "creation_date": 1443506750, "post_id": 32836715, "comment_id": 53508743, "body": "Could you use union here, intending to use either key1 or key2 in this MyData struct?"}, {"owner": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "reply_to_user": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "edited": false, "score": 0, "creation_date": 1443506850, "post_id": 32836715, "comment_id": 53508799, "body": "No. If you use key1 to search the object, you may also want to know what&#39;s the corresponding key2 value of the object."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1443509309, "post_id": 32836715, "comment_id": 53509957, "body": "You only want to lookup the values? Or also modify them? Mutation does make things a bit more complicated in the functional settings. In imperative languages the changes are automatically propogated between the shared values of the two structures, this is not so in the functional approach at least if you don&#39;t use some special data structure."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1443512830, "post_id": 32836715, "comment_id": 53511835, "body": "@Bakuriu: there is also little need for such change propagation in functional programming."}], "answers": [{"comments": [{"owner": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "edited": false, "score": 0, "creation_date": 1443507412, "post_id": 32836868, "comment_id": 53509032, "body": "Do you mean no matter how complicated the MyData is, functional programming compiler can automatically identify objects that contains the same data?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "edited": false, "score": 4, "creation_date": 1443507491, "post_id": 32836868, "comment_id": 53509077, "body": "@YanZhu, no. But if you&#39;ve calculated something, and you stick it in a couple different data structures, each of them (typically) holds only a pointer to it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "edited": false, "score": 4, "creation_date": 1443507492, "post_id": 32836868, "comment_id": 53509078, "body": "@YanZhu Generally that is not done, no. However, unlike languages where mutability is the norm and copying is the only safe thing to do, in Haskell almost no operations create a copy of a piece of data (which after all can&#39;t change!)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "edited": false, "score": 1, "creation_date": 1443513772, "post_id": 32836868, "comment_id": 53512430, "body": "@YanZhu It&#39;s not much different from imperative programming. Using e.g. <code>(&quot;hel&quot;++&quot;lo&quot;, &quot;hel&quot;++&quot;lo&quot;)</code> will likely allocate two strings, while <code>let x = &quot;hel&quot;++&quot;lo&quot; in (x,x)</code> will likely allocate only one. If you build two <code>MyData</code> values using the constructor twice, you are (likely) using two copies. But merely passing some value around never copies it, no matter how complex, and only passes a pointer."}, {"owner": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "edited": false, "score": 0, "creation_date": 1443572518, "post_id": 32836868, "comment_id": 53545237, "body": "@dfeuer I understand what you mean. Thanks"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 7, "last_activity_date": 1443513815, "last_edit_date": 1443513815, "creation_date": 1443507165, "answer_id": 32836868, "question_id": 32836715, "link": "https://stackoverflow.com/questions/32836715/one-data-with-two-structures-functional-programming-vs-imperative-programming/32836868#32836868", "title": "One data with two structures: Functional Programming vs Imperative Programming", "body": "<p>This is generally not an issue in functional programming either.</p>\n\n<pre><code>data MyData = MyData\n  { key1 :: ByteString\n  , key2 :: Int\n  , {- some data -} }\n</code></pre>\n\n<p>Now we can build a <code>HashMap ByteString MyData</code>, using <code>key1</code> as the key, or a <code>Vector MyData</code> using <code>key2</code> as the index, or whatever. Only the pointers to the keys will be duplicated, not the records or even the keys themselves.</p>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 4, "last_activity_date": 1443513363, "last_edit_date": 1443513363, "creation_date": 1443512707, "answer_id": 32838452, "question_id": 32836715, "link": "https://stackoverflow.com/questions/32836715/one-data-with-two-structures-functional-programming-vs-imperative-programming/32838452#32838452", "title": "One data with two structures: Functional Programming vs Imperative Programming", "body": "<p>There is little reason for Haskell or any other language, imperative or functional, to not store references/pointers to immutable objects (especially those bigger than a pointer) by default, except for specific reasons of optimisation such as perhaps memory layout or when functional code is rewritten by e.g. the compiler under the hood to be more performant. </p>\n\n<p>In other words, there is little reason to not assume Haskell (or any other modern language) handles this as expected and as efficiently as C. </p>\n"}], "owner": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 2, "accepted_answer_id": 32836868, "answer_count": 2, "score": 2, "last_activity_date": 1443513815, "creation_date": 1443506545, "question_id": 32836715, "link": "https://stackoverflow.com/questions/32836715/one-data-with-two-structures-functional-programming-vs-imperative-programming", "title": "One data with two structures: Functional Programming vs Imperative Programming", "body": "<p>Suppose in C, we have following struct: </p>\n\n<pre><code>struct MyData {\n    char key1[20];\n    long key2;\n    ...  /* some data */\n};\n</code></pre>\n\n<p>Essentially, in addition to some data, we have two keys: key1 and key2. Suppose we need to manage a bunch of objects of <em>MyData</em> in two different ways, for example, to quickly find corresponding object based on either key1 or key2 (but not both). One way to meet this requirement is to build two different RB-trees (or hash-tables) according to the two keys, respectively. In C/C++, the data need not to be duplicated since we only need to record the pointers of objects.</p>\n\n<p>In above hypothetical example, the key point is that we have a bunch of data with same type and we can organized it through two different data structures without duplicating the data in imperative language. I am wondering how pure functional programming can efficiently meet this requirement without duplicating data. To make it more general or challenging, the two data structures may not be of same type. For example, one could be rb-tree and the other could be hash-table. </p>\n\n<p>If possible, please layout your solution in Haskell. </p>\n\n<p>PS: As a newbie to functional programming, I couldn't help wondering how to achieve some tricks from imperative programming in a pure functional programming. I know sometimes it doesn't make sense at all. If someone feels this question is also pointless, please layout the detail reasoning. </p>\n\n<p>Thanks </p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 0, "creation_date": 1443505650, "post_id": 32836403, "comment_id": 53508294, "body": "use <code>groupBy</code> <a href=\"http://stackoverflow.com/questions/12398458/how-to-group-similar-items-in-a-list-using-haskell\" title=\"how to group similar items in a list using haskell\">stackoverflow.com/questions/12398458/&hellip;</a> <a href=\"http://stackoverflow.com/questions/32769930/haskell-combine-integers-in-a-list-of-tuples\" title=\"haskell combine integers in a list of tuples\">stackoverflow.com/questions/32769930/&hellip;</a>"}, {"owner": {"reputation": 251, "user_id": 5387269, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f336a3b6e8396585d351944438c783b?s=128&d=identicon&r=PG&f=1", "display_name": "CdSdw", "link": "https://stackoverflow.com/users/5387269/cdsdw"}, "reply_to_user": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 0, "creation_date": 1443506439, "post_id": 32836403, "comment_id": 53508601, "body": "Thanks! Sorry about the duplicate; I was trying to search for a similar question but wasn&#39;t sure how to phrase it exactly."}], "owner": {"reputation": 251, "user_id": 5387269, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f336a3b6e8396585d351944438c783b?s=128&d=identicon&r=PG&f=1", "display_name": "CdSdw", "link": "https://stackoverflow.com/users/5387269/cdsdw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "closed_date": 1443505550, "answer_count": 0, "score": 0, "last_activity_date": 1443505106, "creation_date": 1443505106, "question_id": 32836403, "link": "https://stackoverflow.com/questions/32836403/combine-tuples-based-on-first-element-haskell", "closed_reason": "Duplicate", "title": "Combine tuples based on first element (Haskell)", "body": "<p>In Haskell, I have a list of tuples in which each tuple in the list consists of a string and a number.  I was able to sort the list in ASCII order by the strings: </p>\n\n<pre><code>[(\"apple\",1), (\"apple\",2), (\"cat\",1), (\"cat\",2), (\"dog\",3)]\n</code></pre>\n\n<p>Now I need to combine all tuples that consist of the same string (taking case into consideration). So, the desired output would be:</p>\n\n<pre><code>[(\"apple\",[1,2]), (\"cat\",[1,2]), (\"dog\",[3])]\n</code></pre>\n\n<p>The new output list would consist of tuples, in which each tuple consists of a string and a list of ints.</p>\n\n<p>I'm new to Haskell so I'm still trying to get used to the Haskell way of thinking. I'm considering using takeWhile, but I'm not completely sure...</p>\n\n<p>Any help would be greatly appreciated. Thank you!</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1443504845, "post_id": 32836305, "comment_id": 53508024, "body": "Generally, you shouldn&#39;t do this. <code>Show</code> is really for printing out things you can then copy and paste into your source code. You should probably write an independent function for this, or use a pretty-printing library."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443505249, "post_id": 32836305, "comment_id": 53508154, "body": "Yeah recursion is confusing, perhaps using fold instead can be less confusing. S"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1443505729, "post_id": 32836305, "comment_id": 53508327, "body": "You might like to peruse the source of <a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/src/Data-Tree.html#drawTree\" rel=\"nofollow noreferrer\"><code>drawTree</code></a>, though it isn&#39;t annotated the way I would expect an answer here to be."}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 3, "last_activity_date": 1443611406, "last_edit_date": 1443611406, "creation_date": 1443512981, "answer_id": 32838547, "question_id": 32836305, "link": "https://stackoverflow.com/questions/32836305/make-tree-data-type-instance-of-show-in-haskell/32838547#32838547", "title": "Make Tree data type instance of Show in Haskell", "body": "\n\n<p>If you must use <code>Show</code> for this, then simply use an inner function that takes an extra arg:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Show Tree where\n  show x = show' 0 x\n    where show' indent x = a ++ show' (indent+1) ++ b   -- or something\n          a = ...\n          b = ...\n</code></pre>\n\n<p>but I doubt you can draw a nice looking tree with just a single extra parameter \u2014 it seems like an altogether non-trivial task to print arbitrary trees using ASCII output. I think it takes significantly more elaboration.</p>\n\n<p>You're probably better of reusing <a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/src/Data-Tree.html#drawTree\" rel=\"nofollow\">drawTree</a> as suggested by Daniel Wagner, or something equivalent.</p>\n"}], "owner": {"reputation": 765, "user_id": 2974642, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8a3448409a891f6d3394aa81ab0b32d9?s=128&d=identicon&r=PG&f=1", "display_name": "UnworthyToast", "link": "https://stackoverflow.com/users/2974642/unworthytoast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443611406, "creation_date": 1443504609, "question_id": 32836305, "link": "https://stackoverflow.com/questions/32836305/make-tree-data-type-instance-of-show-in-haskell", "title": "Make Tree data type instance of Show in Haskell", "body": "<p>I am having trouble getting the following tree data type to print out in a way that shows the hierarchy of the tree:</p>\n\n<pre><code>data Tree a b = Branch b (Tree a b) (Tree a b)\n              | Leaf a\n\ninstance (Show a, Show b) =&gt; Show (Tree a b) where\n         show t = \n</code></pre>\n\n<p>I can get the tree to print out its nodes in the correct order top to bottom, but I can't figure out how to make the show function keep track of how many spaces to add to a level to make it obvious that there is an actual <em>tree</em> structure being printed. I know I'm not giving much to go on with my instance definition, but I really just don't know where to begin since recursion is such a confusing thing to me right now.</p>\n"}, {"tags": ["sql", "haskell", "esqueleto"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443512977, "post_id": 32835427, "comment_id": 53511928, "body": "I&#39;m no SQL expert, but <code>DELETE FROM table1 INNER JOIN table2</code> doesn&#39;t look as a valid SQL statement, or at least not as a standard one. For instance PostgreSQL does not support it, and the manual suggests a subquery to accompllish that. <a href=\"http://www.postgresql.org/docs/9.4/static/sql-delete.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.4/static/sql-delete.html</a>"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443537856, "post_id": 32835427, "comment_id": 53527944, "body": "@chi That is correct, but <code>DELETE table1 from table1 INNER JOIN table2</code> (note the extra <code>table1</code>) should work.  My problem is that Esqueleto doesn&#39;t give me a way to add the extra <code>table1</code>.  Since there is no way to add this extra param, I tried without, thinking it might somehow be added, but it does just accept this faulty syntax at compiletime, which then leads to a runtime error."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443547409, "post_id": 32835427, "comment_id": 53534044, "body": "From the docs I linked, PostgreSQL does not support anything between <code>DELETE</code> and <code>FROM</code>. I agree on that Esqueleto should behave better, here."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443548944, "post_id": 32835427, "comment_id": 53534929, "body": "@chi I did some further research, you are correct, this does seem to be an extension supported by certain DBs (ie- MySQL), but not in the standard, and particularly not in Postgresql.  I am not sure of Esqueleto&#39;s philosophy on supporting extensions, but, as it turns out, I am actually using Postgresql (not sure how you knew that :) ), so it doesn&#39;t matter.  Since this actually concludes this question for me, feel free to upgrade your comment to a soln, and I&#39;ll give you credit...."}], "answers": [{"comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1444361610, "post_id": 33029118, "comment_id": 53881108, "body": "I think you are missing the point of the question....  The question is, how do I convert this SQL query to Esqueleto.  It doesn&#39;t seem to be possible."}, {"owner": {"reputation": 4116, "user_id": 4033273, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RZQ97.jpg?s=128&g=1", "display_name": "Moin Shirazi", "link": "https://stackoverflow.com/users/4033273/moin-shirazi"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1444361672, "post_id": 33029118, "comment_id": 53881130, "body": "Ohh sorry ...  m not familiar with Esqueleto. . m sql a guy"}], "tags": [], "owner": {"reputation": 4116, "user_id": 4033273, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RZQ97.jpg?s=128&g=1", "display_name": "Moin Shirazi", "link": "https://stackoverflow.com/users/4033273/moin-shirazi"}, "is_accepted": false, "score": -3, "last_activity_date": 1444359147, "creation_date": 1444359147, "answer_id": 33029118, "question_id": 32835427, "link": "https://stackoverflow.com/questions/32835427/esqueleto-how-can-i-delete-an-item-using-a-join/33029118#33029118", "title": "Esqueleto: How can I delete an item using a join", "body": "<p>In MS SQL you can use you can delete table using join in following manner</p>\n\n<pre><code>DELETE Table1,Table2  FROM Table1 INNER JOIN Table2\nWHERE Table1.Id1= Table2.Id1 and Table1.Id1= '1'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 1629056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ac1d479440d9d04b693fd004296d0e?s=128&d=identicon&r=PG", "display_name": "Andrew G", "link": "https://stackoverflow.com/users/1629056/andrew-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1502674905, "last_edit_date": 1502674905, "creation_date": 1502673909, "answer_id": 45666323, "question_id": 32835427, "link": "https://stackoverflow.com/questions/32835427/esqueleto-how-can-i-delete-an-item-using-a-join/45666323#45666323", "title": "Esqueleto: How can I delete an item using a join", "body": "<p>Try this.</p>\n\n<pre><code>delete $\nfrom $ \\(table1 `InnerJoin` table2) -&gt; do\non (just (table1 ^. Table1ID  ==. table2 ^. Table2ItemID)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 432, "user_id": 5328094, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n51duP2F4TI/AAAAAAAAAAI/AAAAAAAAAJw/IXPDfi3xBzI/photo.jpg?sz=128", "display_name": "iman kazemi", "link": "https://stackoverflow.com/users/5328094/iman-kazemi"}, "is_accepted": false, "score": 1, "last_activity_date": 1566020927, "creation_date": 1566020927, "answer_id": 57533633, "question_id": 32835427, "link": "https://stackoverflow.com/questions/32835427/esqueleto-how-can-i-delete-an-item-using-a-join/57533633#57533633", "title": "Esqueleto: How can I delete an item using a join", "body": "<p>I think it is very late to answer this question but you can use EXISTS</p>\n\n<pre><code>DELETE Table1\nWHERE EXISTS (SELECT * FROM Table2 WHERE Table1.ID = Table2.ItemID)\n</code></pre>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 3, "score": 9, "last_activity_date": 1566020927, "creation_date": 1443498922, "last_edit_date": 1443513016, "question_id": 32835427, "link": "https://stackoverflow.com/questions/32835427/esqueleto-how-can-i-delete-an-item-using-a-join", "title": "Esqueleto: How can I delete an item using a join", "body": "<p>Is the following query possible using esqueleto?</p>\n\n<pre><code>DELETE Table1\nFROM Table1\nINNER JOIN Table2 ON Table1.ID = Table2.ItemID\n</code></pre>\n\n<p>I've tried:</p>\n\n<pre><code>delete $ \n  from $ \\(table1 `InnerJoin` table2) -&gt; \n    on (table1 ^. Table1ID  ==. table2 ^. Table2ItemID)\n</code></pre>\n\n<p>which, oddly enough, generated one of the only runtime errors I've ever seen in Haskell</p>\n\n<pre><code>ERROR:  syntax error at or near \"INNER\"\nLINE 2: FROM \"table1\" INNER JOIN \"table2\" ON \"tab...\n</code></pre>\n\n<p>(basically, it was unhappy that the <code>DELETE</code> was missing the \"table1\")</p>\n\n<p>I've also tried adding a return value to the monad, which, like with select might add that missing value. But this fails because delete requires a monad of type <code>m ()</code>.</p>\n\n<p>Is it possible that this is just missing from Esqueleto?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1443496981, "post_id": 32835034, "comment_id": 53505843, "body": "That package doesn&#39;t export the <code>BankersDequeue</code> constructor. You can only manipulate it through the functions the module does export. This way, the user cannot violate any of the internal invariants that are always supposed to hold"}, {"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1443519383, "post_id": 32835034, "comment_id": 53515750, "body": "I had failed to see that the export of <code>BankersDequeue</code> was for the type constructor, and that the data constructor was hidden. Since this particular dequeue has some very strict and complex invariants, I now see why this is necessary. I was then having trouble making one of these things, until I realised that the methods are polymorphic in their return types, so you can say the following:  <code>let q = Data.Dequeue.fromList [1..4] :: BankersDequeue Integer</code>  All is clear now."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 0, "creation_date": 1443503617, "post_id": 32835177, "comment_id": 53507624, "body": "@andro, you should edit your question to clarify exactly what you&#39;re having trouble with <i>instead of</i> asking for tutorials. Questions asking for off-site resources are considered off-topic."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1443497069, "creation_date": 1443497069, "answer_id": 32835177, "question_id": 32835034, "link": "https://stackoverflow.com/questions/32835034/data-dequeue-and-bankersdequeue/32835177#32835177", "title": "Data.Dequeue and BankersDequeue", "body": "<p><code>Data.Dequeue</code> keeps <code>BankersDequeue</code> abstract by not exposing its constructors. That is indicated by there being no constructors listed under the <a href=\"https://hackage.haskell.org/package/dequeue-0.1.12/docs/Data-Dequeue.html#t:BankersDequeue\" rel=\"nofollow\">documentation for the type</a>. However, there is a <a href=\"https://hackage.haskell.org/package/dequeue-0.1.12/docs/Data-Dequeue.html#v:fromList\" rel=\"nofollow\"><code>fromList</code> method in the <code>Dequeue</code> class</a> that you can use to create dequeues.</p>\n"}, {"tags": [], "owner": {"reputation": 747, "user_id": 6933270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AdXs.jpg?s=128&g=1", "display_name": "William Rusnack", "link": "https://stackoverflow.com/users/6933270/william-rusnack"}, "is_accepted": false, "score": 1, "last_activity_date": 1568836413, "last_edit_date": 1568836413, "creation_date": 1527086013, "answer_id": 50491098, "question_id": 32835034, "link": "https://stackoverflow.com/questions/32835034/data-dequeue-and-bankersdequeue/50491098#50491098", "title": "Data.Dequeue and BankersDequeue", "body": "<p>I was trying to figure this out as well</p>\n\n<pre><code>module Main where\n\n-- Docs: http://hackage.haskell.org/package/dequeue-0.1.12/docs/Data-Dequeue.html\nimport Data.Dequeue as D\n\nmain :: IO ()\nmain = do\n\n  let a = D.empty :: D.BankersDequeue Char\n  let a' = D.pushFront a 'a'\n  let b = D.first a'\n  print b\n</code></pre>\n\n<p>Hopefully this will be helpful to others just starting using Dequeue.</p>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568836413, "creation_date": 1443495883, "question_id": 32835034, "link": "https://stackoverflow.com/questions/32835034/data-dequeue-and-bankersdequeue", "title": "Data.Dequeue and BankersDequeue", "body": "<p>Are there any code examples of how to use the Data.Dequeue module?</p>\n\n<p>If I <code>import Data.Dequeue</code>, when I attempt to use the data constructor <code>BankersDequeue</code> I am unable to do so.</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :m + Data.Dequeue\nPrelude Data.Dequeue&gt; Data.Dequeue.BankersDequeue 0 [] 0 []\n\n&lt;interactive&gt;:3:1:\n    Not in scope: data constructor \u2018Data.Dequeue.BankersDequeue\u2019\n    Perhaps you meant one of these:\n      variable \u2018Data.Dequeue.readDequeue\u2019 (imported from Data.Dequeue),\n      variable \u2018Data.Dequeue.showDequeue\u2019 (imported from Data.Dequeue)\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "hunit"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443495615, "post_id": 32834905, "comment_id": 53505519, "body": "What version of GHC are you using? And how did you install Haskell?"}, {"owner": {"reputation": 829, "user_id": 3833362, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3cd6f6e52a08b01dcaf954730a270458?s=128&d=identicon&r=PG&f=1", "display_name": "Suavocado", "link": "https://stackoverflow.com/users/3833362/suavocado"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443496041, "post_id": 32834905, "comment_id": 53505628, "body": "GHC version 7.10.2, I installed the windows file from here <a href=\"https://www.haskell.org/downloads\" rel=\"nofollow noreferrer\">haskell.org/downloads</a>.  I installed the &quot;Haskell Platform&quot; version."}, {"owner": {"reputation": 829, "user_id": 3833362, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3cd6f6e52a08b01dcaf954730a270458?s=128&d=identicon&r=PG&f=1", "display_name": "Suavocado", "link": "https://stackoverflow.com/users/3833362/suavocado"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443496788, "post_id": 32834905, "comment_id": 53505803, "body": "I changed the line &quot; base &gt;= 4.7 &amp;&amp; &lt;4.8&quot; to &quot; base &gt;= 4.8 &amp;&amp; &lt;4.9&quot; and I works okay"}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 2, "last_activity_date": 1443501878, "creation_date": 1443501878, "answer_id": 32835844, "question_id": 32834905, "link": "https://stackoverflow.com/questions/32834905/dependency-issues-running-cabal-test-for-haskell/32835844#32835844", "title": "Dependency issues running &quot;cabal test&quot; for Haskell", "body": "<p>Versions of GHC come bundled with versions of base.  GHC 7.10.2 uses base 4.8.1.0.</p>\n\n<p>Your cabal must be using a slightly out of date template....</p>\n\n<p>You should either change the range of acceptable base version (as you did in your comment above), or use a different version of GHC.</p>\n"}], "owner": {"reputation": 829, "user_id": 3833362, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3cd6f6e52a08b01dcaf954730a270458?s=128&d=identicon&r=PG&f=1", "display_name": "Suavocado", "link": "https://stackoverflow.com/users/3833362/suavocado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 32835844, "answer_count": 1, "score": 1, "last_activity_date": 1443510667, "creation_date": 1443494941, "last_edit_date": 1443510667, "question_id": 32834905, "link": "https://stackoverflow.com/questions/32834905/dependency-issues-running-cabal-test-for-haskell", "title": "Dependency issues running &quot;cabal test&quot; for Haskell", "body": "<p>I'm running my first \"cabal test\" for Haskell, but I get the error:</p>\n\n<pre><code>Package has never been configured. Configuring with default flags. If this\nfails, please run configure manually.\nResolving dependencies...\nConfiguring sample-0.1.0.0...\ncabal: At least the following dependencies are missing:\nbase ==4.7.*\n</code></pre>\n\n<p>sampel.cabal:</p>\n\n<pre><code>-- Initial sample.cabal generated by cabal init.  For further \n-- documentation, see http://haskell.org/cabal/users-guide/\n\nname:                sample\nversion:             0.1.0.0\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nexecutable SampleTest\n  main-is:             SampleTest.hs\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt;4.8, HUnit &gt;=1.2 &amp;&amp; &lt;1.3\n  hs-source-dirs:      test, src\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1443493593, "creation_date": 1443493593, "answer_id": 32834705, "question_id": 32833862, "link": "https://stackoverflow.com/questions/32833862/issues-running-tests-with-cabal-and-hunit-in-haskell-builds-depends-failed/32834705#32834705", "title": "Issues running tests with cabal and HUnit in haskell (&#39;builds-depends&#39; failed.)", "body": "<p>This is the problem:</p>\n\n<pre><code>build-depends:  Test.HUnit\n</code></pre>\n\n<p>Perhaps you wanted <code>build-depends: hunit</code> ?</p>\n"}], "owner": {"reputation": 829, "user_id": 3833362, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3cd6f6e52a08b01dcaf954730a270458?s=128&d=identicon&r=PG&f=1", "display_name": "Suavocado", "link": "https://stackoverflow.com/users/3833362/suavocado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 32834705, "answer_count": 1, "score": 1, "last_activity_date": 1443493593, "creation_date": 1443486922, "last_edit_date": 1443492983, "question_id": 32833862, "link": "https://stackoverflow.com/questions/32833862/issues-running-tests-with-cabal-and-hunit-in-haskell-builds-depends-failed", "title": "Issues running tests with cabal and HUnit in haskell (&#39;builds-depends&#39; failed.)", "body": "<p>I trying to run my first haskell program using cabal and HUnit.  I seem to have trouble with my .cabal as I get the error:</p>\n\n<pre><code>\u03bb cabal test\n.\\haskell.cabal has been changed. Re-configuring with most recently used\noptions. If this fails, please run configure manually.\ncabal: haskell.cabal:21: Parse of field 'build-depends' failed.\n</code></pre>\n\n<p>Here is the .cabal file</p>\n\n<pre><code>name:                haskell\nversion:             0.1.0.0\nsynopsis:            fibonacci functions\ncategory:            Testing\n\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\n\nexecutable haskell\n  main-is:             Main.hs\n\n  build-depends:       base &gt;=4.8 &amp;&amp; &lt;4.9\n  hs-source-dirs:      src\n\n  default-language:    Haskell2010\n\ntest-suite Tests\n  build-depends:  Test.HUnit\n  hs-source-dirs: test\n  main-is: tests.hs\n  Type: exitcode-stdio-1.0\n</code></pre>\n\n<p>test file:</p>\n\n<pre><code>import Test.HUnit\ntest1 = TestCase (assert True)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "code-formatting"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1443483943, "post_id": 32833450, "comment_id": 53502716, "body": "If you really want, <code>let r9 = replicate 9 in Sudoku (map r9 (r9 Nothing))</code>. But this isn&#39;t really more readable, nor more efficient."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1443484234, "post_id": 32833450, "comment_id": 53502815, "body": "Hmm, I put <a href=\"https://stackoverflow.com/questions/tagged/code-formatting\">code-formatting</a> in but this is more about code practice than code formatting. Is there anybody who knows a good existing tag for this?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1443491203, "post_id": 32833450, "comment_id": 53504437, "body": "@MaartenBodewes, I&#39;d tag it &quot;off topic&quot;. We are not able to read their teacher&#39;s mind any better than they are."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443491259, "post_id": 32833450, "comment_id": 53504455, "body": "I&#39;m voting to close this question as off-topic because it is about reading your teacher&#39;s mind."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443511168, "post_id": 32833450, "comment_id": 53510896, "body": "@dfeuer I disagree, copy paste programming is a well known term among programmers. Language is a method of conveying what&#39;s on somebody&#39;s mind, and in this case we are better in reading the teachers mind than a non-experienced programmer. Besides that &quot;is this copy-paste programming&quot; seems to be a valid question."}], "answers": [{"tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": false, "score": 0, "last_activity_date": 1443484417, "last_edit_date": 1443484417, "creation_date": 1443483878, "answer_id": 32833490, "question_id": 32833450, "link": "https://stackoverflow.com/questions/32833450/haskell-blank-cells-in-a-sudoku/32833490#32833490", "title": "Haskell - Blank cells in a sudoku", "body": "<p>No that's not copy-and-paste, you let your program do the copy-paste here. Copy-paste code is about repeating lines or blocks of <em>source code</em>. Such as <code>cell_0_0 = nothing</code>, <code>cell_0_1 = nothing</code> etc. Actually, your code looks quite succinct.</p>\n"}, {"tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": true, "score": 5, "last_activity_date": 1443484252, "last_edit_date": 1443484252, "creation_date": 1443483907, "answer_id": 32833500, "question_id": 32833450, "link": "https://stackoverflow.com/questions/32833450/haskell-blank-cells-in-a-sudoku/32833500#32833500", "title": "Haskell - Blank cells in a sudoku", "body": "<p>Copy-and-paste programming here probably means that your professor doesn't want:</p>\n\n<pre><code>allBlank = Sudoku [[Nothing,Nothing,Nothing ... ]\n                  ,[Nothing,Nothing,Nothing ...\n                  ...\n                  ]\n</code></pre>\n\n<p>By the way, as a minor note, I think</p>\n\n<pre><code>allBlank = Sudoku (replicate 9 (replicate 9 Nothing))\n</code></pre>\n\n<p>is a little easier to understand for me :)</p>\n\n<p>If you <em>need</em> to use list comprehensions, you can do:</p>\n\n<pre><code>[ [ Nothing | x &lt;- [1..9] ] | y &lt;- [1..9] ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 734, "user_id": 5386615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TTgAA.jpg?s=128&g=1", "display_name": "jedi.jesse", "link": "https://stackoverflow.com/users/5386615/jedi-jesse"}, "is_accepted": false, "score": 0, "last_activity_date": 1455824141, "last_edit_date": 1455824141, "creation_date": 1443483907, "answer_id": 32833501, "question_id": 32833450, "link": "https://stackoverflow.com/questions/32833450/haskell-blank-cells-in-a-sudoku/32833501#32833501", "title": "Haskell - Blank cells in a sudoku", "body": "<p>Copy-and-paste programming would be when you copy one line of code and paste it multiple times to do the same thing.\nRecursion is the way to go.</p>\n"}], "owner": {"reputation": 33, "user_id": 4442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c36f441b933234c7a335a2942ecb29?s=128&d=identicon&r=PG&f=1", "display_name": "mathgrad93", "link": "https://stackoverflow.com/users/4442299/mathgrad93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 1, "accepted_answer_id": 32833500, "answer_count": 3, "score": 3, "last_activity_date": 1455824141, "creation_date": 1443483685, "last_edit_date": 1443484084, "question_id": 32833450, "link": "https://stackoverflow.com/questions/32833450/haskell-blank-cells-in-a-sudoku", "title": "Haskell - Blank cells in a sudoku", "body": "<p>I'm sorry if this EXACT question has already been asked...</p>\n\n<p>I've got a sudoku assignment in Haskell and would appreciate some feedback here.</p>\n\n<p>The goal is to implement a function that represents a Sudoku that contains only blank cells, and then name it <code>allBlankSudoku :: Sudoku</code>, where</p>\n\n<pre><code>data Sudoku = Sudoku [[Maybe Int]]\n</code></pre>\n\n<p>You should use list comprehensions or the map function to do this,</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>This is my take on it: </p>\n\n<pre><code>allBlankSudoku :: Sudoku\n\nallBlankSudoku = Sudoku (map (replicate 9) (replicate 9 Nothing))\n</code></pre>\n\n<p>BUT! Here is my question: In the instructions it says \"Do not use copy-and-paste programming here! Your definition does not need to be longer than a few short lines.\"</p>\n\n<p>So, is my code above copy-and-paste or not? Is there an additional way I can do it? Note: This is just the first task out of 3 so I don't think it's supposed to be difficult.</p>\n"}, {"tags": ["linux", "haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1443485402, "post_id": 32833241, "comment_id": 53503133, "body": "Doesn&#39;t seem to have anything to do with Linux though."}, {"owner": {"reputation": 69, "user_id": 2105731, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d2df3612762179c8dc37eaafc2337a60?s=128&d=identicon&r=PG", "display_name": "ozhank", "link": "https://stackoverflow.com/users/2105731/ozhank"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1443496098, "post_id": 32833241, "comment_id": 53505643, "body": "Windows does not have fortune command"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1443502290, "post_id": 32833241, "comment_id": 53507272, "body": "Windows is not the only other os. Many BSDs, Unix, and OS X systems have fortune or package managers that include it.  My point is the Linux tag won&#39;t result in an audience any better at answering the question, it just causes noise."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443550450, "post_id": 32833241, "comment_id": 53535751, "body": "Quick note that <code>rawSystem(&quot;fortune&quot; [&quot;-a&quot;, &quot;-s&quot;])</code> is not correct syntax. It will be parsed as <code>rawSystem (&quot;fortune&quot; [&quot;-a&quot;, &quot;-s&quot;])</code>. Function application in Haskell is not indicated by parens, just by spaces: <code>rawSystem &quot;fortune&quot; [&quot;-a&quot;, &quot;-s&quot;]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443493213, "post_id": 32833327, "comment_id": 53504958, "body": "I think what they want is actually <code>readProcessWithExitCode</code>."}], "tags": [], "owner": {"reputation": 3066, "user_id": 293248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a15fc023b1e0a3324440cc63d7239b2?s=128&d=identicon&r=PG", "display_name": "sczizzo", "link": "https://stackoverflow.com/users/293248/sczizzo"}, "is_accepted": false, "score": 1, "last_activity_date": 1443482849, "creation_date": 1443482849, "answer_id": 32833327, "question_id": 32833241, "link": "https://stackoverflow.com/questions/32833241/haskell-system-process-handing/32833327#32833327", "title": "Haskell System.Process Handing", "body": "<p>According to Hackage, <a href=\"https://hackage.haskell.org/package/process-1.3.0.0/docs/System-Process.html#v:rawSystem\" rel=\"nofollow\"><code>rawSystem</code> returns type <code>IO ExitCode</code></a>, but <a href=\"https://hackage.haskell.org/package/process-1.3.0.0/docs/System-Process.html#v:readProcess\" rel=\"nofollow\"><code>readProcess</code> does basically what you want</a>. Was able to play around with this in <code>ghci</code>:</p>\n\n<pre><code>$ ghci\nPrelude&gt; :m System.Process\nPrelude System.Process&gt; ec &lt;- rawSystem \"fortune\" [ \"-a\", \"-s\" ]\nThere once was a girl from Spokane,\nWent to bed with a one-legged man.\n    She said, \"I know you--\n    You've really got two!\nWhy didn't you say so when we began?\"\nPrelude System.Process&gt; :t ec\nec :: GHC.IO.Exception.ExitCode\nPrelude System.Process&gt; out &lt;- readProcess \"fortune\" [ \"-a\", \"-s\" ] \"\"\nPrelude System.Process&gt; :t out\nout :: String\nPrelude System.Process&gt; out\n\"The truth about a woman often lasts longer than the woman is true.\\n\"\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 2105731, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d2df3612762179c8dc37eaafc2337a60?s=128&d=identicon&r=PG", "display_name": "ozhank", "link": "https://stackoverflow.com/users/2105731/ozhank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443482849, "creation_date": 1443482138, "question_id": 32833241, "link": "https://stackoverflow.com/questions/32833241/haskell-system-process-handing", "title": "Haskell System.Process Handing", "body": "<p>I wish to get output from Linux command fortune -a -s and put into irc channel. I have to load System.Process to access.</p>\n\n<pre><code>rawSystem(\"fortune\" [\"-a\", \"-s\"])\n</code></pre>\n\n<p>returns an exit code and the fortune string, both of which I want to capture.</p>\n\n<p>I know I need to use a tuple, but keep getting an error.</p>\n\n<pre><code>(status, fortune) &lt;- rawSystem(\"fortune\" [\"-a\", \"-s\"])\n</code></pre>\n\n<p>so that I can process both the exit code (status) and fortune (string).</p>\n"}, {"tags": ["haskell", "interpreter", "parsec"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443518994, "post_id": 32831287, "comment_id": 53515530, "body": "There is the <a href=\"http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.157.7899\" rel=\"nofollow noreferrer\">Parsing mixfix operators</a> paper, which also mentiones a bunch of other relevant papers. It&#39;s outdated though, since &quot;the treatment of operators has changed&quot;, as Agda often says now."}, {"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443538917, "post_id": 32831287, "comment_id": 53528746, "body": "That&#39;s the paper I&#39;ve been using to get this going. If it&#39;s outdated, where could I find information on how they&#39;re treating operators now?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443543397, "post_id": 32831287, "comment_id": 53531657, "body": "I&#39;m not aware of any description of what was changed and how. The only thing I know is that Agda now supports sections (e.g. you can write <code>if_then 1 else_</code> for <code>\u03bb b m -&gt; if b then 1 else m</code>). Try to ask on Agda mailing list."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1444062924, "post_id": 32831287, "comment_id": 53731713, "body": "Changes (w.r.t. to treating operators in Agda) are described in the <a href=\"https://github.com/agda/agda/blob/master/doc/release-notes/2-4-4.txt#L372\" rel=\"nofollow noreferrer\">changelog</a>."}], "owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1443507302, "creation_date": 1443472259, "last_edit_date": 1443472879, "question_id": 32831287, "link": "https://stackoverflow.com/questions/32831287/using-parsec-with-a-recursive-data-as-the-stream", "title": "Using Parsec with a recursive data as the stream", "body": "<p>I'm writing an interpreter for functional programming language with with <em>mixfix operators</em>, just like <a href=\"http://wiki.portal.chalmers.se/agda/pmwiki.php?n=ReferenceManual.Mixfix\" rel=\"nofollow\">Agda</a>.</p>\n\n<pre><code>if_then_else_ : Bool -&gt; a -&gt; a -&gt; a\nif True then x else _  = x\nif False then _ else x = x\n\n_/\\_ : Bool -&gt; Bool -&gt; Bool\nTrue /\\ True = True\n_ /\\ _ = False\n</code></pre>\n\n<p>So that means I had to run a parser (I used Alex/Happy), to get an AST, with this specific part (smaller than actual <code>Expr</code>):</p>\n\n<pre><code>data Expr \n  = Id String\n  | Apply [Expr]\n  | Forall Type Expr\n\ndata Type = TypeBind String Expr\n</code></pre>\n\n<p>And with this <code>Expr</code>, I have to run a second parser (which I intend to use Parsec) to do the following kind of processing:</p>\n\n<pre><code>\u03bb let example = Apply [Id \"if\", Id \"a\", Id \"/\\\\\", Id \"b\", Id \"then\", Id \"c\", Id \"else\", Id \"d\"]\n\u03bb parseMixfix example\nRight (Apply [Id \"if_then_else_\",Apply [Id \"_/\\\\_\",Id \"a\",Id \"b\"],Id \"c\",Id \"d\"])\n</code></pre>\n\n<p>I started with a Parser that received a <code>Stream</code> of <code>[Expr]</code>, but this only accepts the lists in a <code>Apply</code>, and doesn't go deep in the <em>tree</em>, just parses on the top level.</p>\n\n<p>So I'm considering the option of instead of using <code>[Expr]</code> as the <code>Stream</code>, to use <code>Expr</code>, having to do the <code>Stream</code> instance for it; this is where I'm at:</p>\n\n<pre><code>data Tok a = This a | Over (Tok a) deriving (Show)\n\ninstance (Monad m) =&gt; Stream Expr m (Tok Expr) where\n        uncons ex = check ex\n            where\n                check :: Monad m =&gt; Expr -&gt; m (Maybe (Tok Expr, Expr))\n                check ex = case ex of\n                        Id s         -&gt; return $ Just (This (Id s), Apply [])\n                        Apply (x:xs) -&gt; do\n                                mst &lt;- check x\n                                return $ fmap (\\(a, b) -&gt; (Over a, b)) mst\n</code></pre>\n\n<p>Which is using <code>data Tok</code> as kind of a Zipper breadcrumb (or at least I see it that way), to indicate how deep in the tree it comes from.</p>\n\n<p>I know this is not the correct code, but is for you folks to get the idea. I'm wondering if I'm on the right track or if there's a better solution for this problem. I'm also missing the <code>Forall</code> case here; that's because I was making tests with an <code>Id | Apply</code> only tree before.</p>\n"}, {"tags": ["haskell", "ghc", "travis-ci"], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443471025, "post_id": 32830882, "comment_id": 53497744, "body": "That approach (which I&#39;ll try next; just asking ahead now) looks like it would require me to build the whole Haskell stack manually. I&#39;m not sure I know how to do that."}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 2, "creation_date": 1443471386, "post_id": 32830882, "comment_id": 53497942, "body": "@raxacoricofallapatorius It will just fetch all the packages you need from <code>stackage</code>. Installing <code>stack</code> is painless if you follow the tutorial. I would say this is the best approach specially in the container-base infrastructure because you will get caching for free. I have tried it and it works like a charm."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443472114, "post_id": 32830882, "comment_id": 53498323, "body": "Is what&#39;s there in the example sufficient to build a full 7.10.2 stack, or do I need more? (Again, I&#39;ll check when I have access; just looking ahead.)"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1443473889, "post_id": 32830882, "comment_id": 53499204, "body": "The example handles everything you need for the full tool chain"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443476519, "post_id": 32830882, "comment_id": 53500406, "body": "That fails <a href=\"https://travis-ci.org/orome/crypto-enigma/builds/82636563\" rel=\"nofollow noreferrer\">pretty spectacularly</a>. What am I missing?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1443497583, "post_id": 32830882, "comment_id": 53506021, "body": "I have no idea, you haven&#39;t told us anything that explains why it&#39;s failing. There are many examples in the wild of it succeeding (e.g., the yaml repo)."}, {"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443499214, "post_id": 32830882, "comment_id": 53506467, "body": "@raxacoricofallapatorius You need to have a <code>stack.yaml</code> file for your project.  The command is failing because you are missing this file.  The clue is this output from your Travis build: <code>Run from outside a project, using implicit global config</code>"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1443512482, "post_id": 32830882, "comment_id": 53511635, "body": "Was that always a link to the Travis output? If so, I missed it first time around. I could have sworn it was plain text."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443527277, "post_id": 32830882, "comment_id": 53520446, "body": "Ah. No idea about <code>stack</code>. Never used it. What would that look like for <code>7.10.2</code>?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1443539130, "post_id": 32830882, "comment_id": 53528872, "body": "The page I linked to is the user&#39;s guide for Stack. The top of the page gives instructions on getting started. But tldr use stack init like the error message says"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443546693, "post_id": 32830882, "comment_id": 53533613, "body": "I see \u2014 so I need to use Stack locally too. I don&#39;t yet. Will I encounter any issues with my local Haskell/GHC config if I install it and used it for this? Does installing it locally for (just) this purpose have side effects?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1443553246, "post_id": 32830882, "comment_id": 53537148, "body": "No. And you don&#39;t need to use it locally. You just need a stack.yaml file."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443553518, "post_id": 32830882, "comment_id": 53537280, "body": "Cool. Works now (I&#39;ll make sure it continues to for a bit). I had to dig around to get <a href=\"http://stackoverflow.com/a/27819983/656912\"><code>pcre.h</code></a>, whatever that is, and install bunch of packages along with Stack, but so far so good. How do I confirm thought that it&#39;s doing what I expect? It no longer prints a GHC version to the log \u2014 where in <code>.travis.yml</code> should I add <code>ghc --version</code>?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1443555730, "post_id": 32830882, "comment_id": 53538430, "body": "stack exec -- git --version. At this point, I&#39;d recommend reading through the guide, it will cover most of these kinds of questions"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443635241, "post_id": 32830882, "comment_id": 53576788, "body": "Now it fails. I&#39;ve made no code changes at all, just changes to the one or two changes to a readme file, but <a href=\"https://travis-ci.org/orome/crypto-enigma/jobs/82974788\" rel=\"nofollow noreferrer\">now my Travis builds fail</a> with &quot;No compiler found, expected minor version match with ghc-7.10.2 (x86_64) (based on resolver setting in /home/travis/build/orome/crypto-enigma/stack.yaml). Try running stack setup to locally install the correct GHC&quot;"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1443635872, "post_id": 32830882, "comment_id": 53577102, "body": "That&#39;s because you&#39;re trying to use <code>ghc</code> before installing it. You just got lucky with the cache hit in the first few runs most likely. Use <code>--install-ghc</code> on the <code>stack ghc</code> call. Also, this is really getting too long for an SO comments section..."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1446213130, "post_id": 32830882, "comment_id": 54663241, "body": "This is <a href=\"http://stackoverflow.com/q/33437022/656912\">now tripping me up</a> (I think) when I try to use automatic deployment to Hackage."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1443470650, "creation_date": 1443470650, "answer_id": 32830882, "question_id": 32830176, "link": "https://stackoverflow.com/questions/32830176/how-do-i-build-for-ghc-7-10-2-in-the-container-based-infrastructure/32830882#32830882", "title": "How do I build for GHC 7.10.2 in the container-based infrastructure?", "body": "<p>There's an explanation of how to do this with Stack in the guide, you can see a full example at:</p>\n\n<p><a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md#travis-with-caching\" rel=\"nofollow\">https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md#travis-with-caching</a></p>\n"}, {"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443541231, "post_id": 32830891, "comment_id": 53530273, "body": "Any ideas on how to get this to work without Stack? <a href=\"http://stackoverflow.com/a/32830882/656912\">This answer</a> assumes Stack, which I don&#39;t use."}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443551506, "post_id": 32830891, "comment_id": 53536305, "body": "I said explicitly it should work with or without stash. It doesn&#39;t ?"}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443551929, "post_id": 32830891, "comment_id": 53536515, "body": "By using <code>language: c</code> there will be no default <code>ghc</code> so at least you should see that you are now using the expected ghc-7.10.x."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443552227, "post_id": 32830891, "comment_id": 53536671, "body": "I just get <code>&quot;.&#47;configure &amp;&amp; make &amp;&amp; make test&quot; exited with 127</code>."}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443552555, "post_id": 32830891, "comment_id": 53536818, "body": "Ok I might know of one problem. Could you replace ` - ghc-$GHCVER` with  <code>ghc-7.10.2</code> in <code>addons</code> ? Don&#39;t use <code>env</code> for now, you have only one version anyhow."}], "tags": [], "owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1443554987, "last_edit_date": 1443554987, "creation_date": 1443470693, "answer_id": 32830891, "question_id": 32830176, "link": "https://stackoverflow.com/questions/32830176/how-do-i-build-for-ghc-7-10-2-in-the-container-based-infrastructure/32830891#32830891", "title": "How do I build for GHC 7.10.2 in the container-based infrastructure?", "body": "<p>I suspect you are using <code>language: haskell</code>. Could you try with <code>language: c</code>.</p>\n\n<p>My understanding is that travis does not really support <code>ghc-7.10.x</code> just yet (there are outstanding issues). The workaround is to bypass and install it manually (using the <code>hvr-ghc</code> ppa); hence the <code>language: c</code> instead of haskell.</p>\n\n<p>Another tip. Start by removing <code>env</code>. I am pretty sure it won't work inside your <code>addons</code>. Simply use <code>ghc-7.10.2</code> and <code>cabal-1.22</code>. Now your<code>addons</code>should work fine. Check your travis log to be sure.</p>\n\n<p>I can confirm the stack tutorial (link by Michael Snoyman) is quite good. But it should work with or without stack.</p>\n\n<p>For reference here is a travis file where I try to minimize the usage of <code>sudo</code> to the strict minimum:</p>\n\n<p><a href=\"https://github.com/PierreR/language-puppet/blob/450ca249e23300351085d24fd58dcf9f429769d5/.travis.yml\" rel=\"nofollow\">https://github.com/PierreR/language-puppet/blob/450ca249e23300351085d24fd58dcf9f429769d5/.travis.yml</a></p>\n\n<p>As you see, I still use the old travis infra because I need Ruby2.x with the C header.</p>\n\n<p>Here is kind of the same travis file but without using stack (stack is only useful with caching):</p>\n\n<p><a href=\"https://github.com/bartavelle/language-puppet/blob/master/.travis.yml\" rel=\"nofollow\">https://github.com/bartavelle/language-puppet/blob/master/.travis.yml</a></p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 32830882, "answer_count": 2, "score": 2, "last_activity_date": 1443554987, "creation_date": 1443467725, "last_edit_date": 1443471336, "question_id": 32830176, "link": "https://stackoverflow.com/questions/32830176/how-do-i-build-for-ghc-7-10-2-in-the-container-based-infrastructure", "title": "How do I build for GHC 7.10.2 in the container-based infrastructure?", "body": "<p>I have a project that requires GHC 7.10.2, so to use Travis CI I must install the required version of GHC myself in a pre-install step.</p>\n\n<p>I currently have this working with</p>\n\n<pre><code>env:\n - CABALVER=1.22 GHCVER=7.10.2\n\nbefore_install:\n - |\n    travis_retry sudo add-apt-repository -y ppa:hvr/ghc\n    travis_retry sudo apt-get update\n    travis_retry sudo apt-get install cabal-install-$CABALVER ghc-$GHCVER\n    export PATH=/opt/ghc/$GHCVER/bin:/opt/cabal/$CABALVER/bin:$PATH\n</code></pre>\n\n<p>in my <code>.travis.yml</code>; but am limited to using the \"legacy\" infrastructure because of my use of <code>sudo</code>. </p>\n\n<p>I'd like to take advantage of the new container-based infrastructure, and have followed the <a href=\"http://docs.travis-ci.com/user/migrating-from-legacy/?utm_source=legacy-notice&amp;utm_medium=banner&amp;utm_campaign=legacy-upgrade\" rel=\"nofollow\">migration docs</a> as far as I can, resulting in </p>\n\n<pre><code>sudo: false\n\nenv:\n - CABALVER=1.22 GHCVER=7.10.2\n\naddons:\n  apt:\n    sources:\n    - hvr-ghc\n    packages:\n    - cabal-install-$CABALVER\n    - ghc-$GHCVER\n\nbefore_install:\n - |\n    export PATH=/opt/ghc/$GHCVER/bin:/opt/cabal/$CABALVER/bin:$PATH\n</code></pre>\n\n<p>as what seems to me should be the equivalent of the above. But this proceeds to use the default (7.4) version of GHC, which results in a failed build.</p>\n\n<p>How do I build for Haskell 7.10.2 in the container-based infrastructure? Specifically, what should I have in my <code>.travis.yml</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1467, "user_id": 3029422, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/13887984efe106e46fbeb35bcb56f134?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/3029422/ionut"}, "edited": false, "score": 0, "creation_date": 1443466386, "post_id": 32829799, "comment_id": 53495488, "body": "Thanks for the explanation."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1443477298, "post_id": 32829799, "comment_id": 53500723, "body": "Just to play devil&#39;s advocate: I could imagine wanting something like this for a library that had e.g. a forwards-compatible interface and an &quot;internal&quot; interface; then you might want tests that check that no hapless developer inadvertently changes the type of some part of the forwards-compatible interface. (The library interface could certainly contain operations that are useful to library consumers, but not actually called anywhere by the library itself, hence would not cause compile failure if their types changed.)"}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 10, "last_activity_date": 1443466059, "creation_date": 1443466059, "answer_id": 32829799, "question_id": 32829760, "link": "https://stackoverflow.com/questions/32829760/test-a-functions-type/32829799#32829799", "title": "Test a function&#39;s type", "body": "<p>Writing a test for a <em>type</em> is <strong>almost definitely not what you want</strong>. Since Haskell is statically typed, the compiler automatically checks types for you when you compile, with no need to run any code or tests. If <code>length</code> did not have a compatible type, you would get a type error if you tried to load the code at all.</p>\n\n<p><code>:type</code> is a special command from <code>ghci</code>, not actual Haskell syntax. You can't use it directly in a normal program. There are ways to get a value representing a type but they're somewhat complicated and, again, almost definitely not what you need.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443467625, "post_id": 32830075, "comment_id": 53496062, "body": "The most direct way by far (much easier than running GHCi from your program) is to use <code>typeRep :: forall proxy a. Typeable a =&gt; proxy a -&gt; TypeRep</code>. You can actually print those out."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443473106, "post_id": 32830075, "comment_id": 53498826, "body": "Urk... I guess <code>Typeable</code> probably has issues dealing with polymorphic things. <i>sigh</i>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443493894, "post_id": 32830075, "comment_id": 53505132, "body": "@dfeuer Thanks for the suggestion. I&#39;ve included some notes about <code>Typeable</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1443493872, "last_edit_date": 1443493872, "creation_date": 1443467293, "answer_id": 32830075, "question_id": 32829760, "link": "https://stackoverflow.com/questions/32829760/test-a-functions-type/32830075#32830075", "title": "Test a function&#39;s type", "body": "<p>Although I agree with the other answer that the question smells, I think it is worth giving a direct answer anyway. You could put a type assertion in your test suite like this:</p>\n\n<pre><code>module Test where\n\ncheck_type_of_length :: Foldable t =&gt; t a -&gt; Int\ncheck_type_of_length = length\n</code></pre>\n\n<p>If <code>length</code> can not be given the type you requested, the module will not compile. However, this is not a perfect test: if the type of <code>length</code> is actually <em>more</em> polymorphic than the type you demand, this will still \"pass\"; thus, for example, the following module still compiles, even though <code>undefined</code> does not have exactly the type <code>Foldable t =&gt; t a -&gt; Int</code>.</p>\n\n<pre><code>module Test where\n\ncheck_type_of_length :: Foldable t =&gt; t a -&gt; Int\ncheck_type_of_length = undefined\n</code></pre>\n\n<p>We can make the test a bit more precise if you want to check a monomorphic type. The idea is to use <code>Typeable</code>, as suggested by @dfeuer. That would look like this:</p>\n\n<pre><code>module Test where\n\nimport Data.Typeable\n\ntest_type_of_not :: Bool\ntest_type_of_not = typeOf not == typeOf (undefined :: Bool -&gt; Bool)\n</code></pre>\n\n<p>If <code>not</code> has the monomorphic type <code>Bool -&gt; Bool</code>, then <code>test_type_of_not</code> will be <code>True</code>; if it has a different monomorphic type, it will be <code>False</code>; and if <code>not</code> suddenly becomes polymorphic, the module will fail to compile with an ambiguity error.</p>\n\n<p>I do not know an analogous way to test that a polymorphic type does not become more polymorphic; you could perhaps do something nasty like running a short bash script that does</p>\n\n<pre><code>echo :t length | ghci\n</code></pre>\n\n<p>and checking its output, or something more direct with the GHC API. However, an approach like this is likely to be <em>very</em> fragile.</p>\n"}], "owner": {"reputation": 1467, "user_id": 3029422, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/13887984efe106e46fbeb35bcb56f134?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/3029422/ionut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 32829799, "answer_count": 2, "score": 2, "last_activity_date": 1443493872, "creation_date": 1443465869, "last_edit_date": 1495540308, "question_id": 32829760, "link": "https://stackoverflow.com/questions/32829760/test-a-functions-type", "title": "Test a function&#39;s type", "body": "<p>I'm new to haskell. I read <a href=\"https://stackoverflow.com/questions/20331209/haskell-unit-testing/21419654#21419654\">this</a> answer and I would also like to test the type of my functions, if there is a way to do it.\nHere is an example : <strong>test.hs</strong></p>\n\n<pre><code>module Test where\nimport Test.HUnit\n\ntest1 = TestCase (assertEqual \"test1\" 3 (length [1,2,3]))\ntests = TestList [test1]\n\nmain :: IO Counts\nmain = runTestTT tests \n</code></pre>\n\n<p>I'm running the code with <strong><code>runghc test.hs</code></strong> and I get:</p>\n\n<pre><code>Cases: 1  Tried: 1  Errors: 0  Failures: 0\n</code></pre>\n\n<p>Now, how can I test the type for the <code>length</code> function ?</p>\n\n<p>I have already tried adding a second test <code>test2 = TestCase (assertEqual \"test2\" \"length :: Foldable t =&gt; t a -&gt; Int\" :type length)</code>, but I get this <strong>error</strong> <code>test.hs:5:77: parse error on input 'type'</code>.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "search"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1443464797, "post_id": 32829458, "comment_id": 53494729, "body": "Looks like Knuth-Morris-Patterson algorithm; does the <i>sublist</i> always starts at the beginning? Given for your example with <code>3</code>; the array is <code>[1,2,3,4,2,3,4]</code>; should this return <code>4</code>?"}, {"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1443465422, "post_id": 32829458, "comment_id": 53495033, "body": "@CommuSoft Yes it always starts at the beginning. It should return <code>-1</code> since there is no <code>1,2,3</code> except the first."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443470155, "post_id": 32829458, "comment_id": 53497302, "body": "The question is still very confusing. You have plenty of examples, but the actual description of what you want remains unclear."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1443480539, "post_id": 32830907, "comment_id": 53501796, "body": "You should include the reason why this line is slow."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1443482058, "last_edit_date": 1443482058, "creation_date": 1443470752, "answer_id": 32830907, "question_id": 32829458, "link": "https://stackoverflow.com/questions/32829458/searching-elements-in-haskell/32830907#32830907", "title": "Searching elements in Haskell", "body": "<p>The most obvious problem is</p>\n\n<pre><code>| length x &lt;=20         = -1\n</code></pre>\n\n<p>This makes your code <code>O(m*n^2)</code>, where <code>m</code> is the length of the short list and <code>n</code> is the length of the long one. The trouble is that the program has to walk the entire length of the list to calculate its length, even though you only care about the first twenty elements. It's possible to speed up that test, or to integrate it into the equality check, but since you expect the lists to be long, you should see a dramatic improvement by just skipping it altogether:</p>\n\n<pre><code>repeat p = repeat' p 0 p\n where\n  repeat' [] = -1\n  repeat' (x : xs) position originlist\n    | take 20 xs == y = position+1\n    | otherwise       = repeat' xs (position+1) originlist\n     where y = take 20 originalist\n</code></pre>\n\n<p>Note that I've removed the calls to <code>tail</code>, which will throw an exception if called with an empty list, and replaced it with a pattern match on the front if the list.</p>\n\n<p>This is still rather hard to read/understand, but it's the best I could do with just a fragment of the original code and without understanding exactly what you want it to do.</p>\n"}, {"comments": [{"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 1, "creation_date": 1443498674, "post_id": 32832936, "comment_id": 53506314, "body": "There&#39;s an implementation of the Z algorithm on Hackage here: <a href=\"https://hackage.haskell.org/package/zalgo\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/zalgo</a>"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1443480131, "creation_date": 1443480131, "answer_id": 32832936, "question_id": 32829458, "link": "https://stackoverflow.com/questions/32829458/searching-elements-in-haskell/32832936#32832936", "title": "Searching elements in Haskell", "body": "<p>Using <a href=\"https://www.cs.umd.edu/class/fall2011/cmsc858s/Lec02-zalg.pdf\" rel=\"nofollow\">Z-algorithm</a> you may solve this problem very efficiently. By definition:</p>\n\n<blockquote>\n  <p><code>Z(S, i)</code>: The length of <em>longest</em> substring of <code>S</code> <em>starting</em> at index <code>i</code> which is also a <em>prefix</em> of <code>S</code>.</p>\n</blockquote>\n\n<p>For example, for string <code>abcababca</code> we have:</p>\n\n<pre><code>index  | 0 1 2 3 4 5 6 7 8\n-------|------------------\nstring | a b c a b a b c a\nz.func | 8 0 0 2 0 3 0 0 1\n</code></pre>\n\n<p>z-function <a href=\"https://e-maxx-eng.github.io/string/z-function.html\" rel=\"nofollow\">can be efficiently calculated in O(n)</a>, and once you have this function your problem reduces to finding the first index which has z-value exceeding the threshold;</p>\n\n<p>For example your first list has z-function:</p>\n\n<pre><code>\\&gt; toList.zfunc.fromList $ [1,2,3,0,0,4,4,1,2,3,0,0]\n[12,0,0,0,0,0,0,5,0,0,0,0]\n</code></pre>\n\n<p>and (skipping the very first index), you get the first value larger than 3 at index 7!</p>\n\n<p>Below is a possible implementation of z-algorithm in Haskell:</p>\n\n<pre><code>import Data.List (mapAccumL)\nimport Data.Vector (Vector, toList, fromList, fromListN, (!))\nimport qualified Data.Vector as V\n\nzfunc :: Eq a =&gt; Vector a -&gt; Vector Int\nzfunc a = out\n    where\n    n = V.length a :: Int\n    out = fromListN n (n:rest) :: Vector Int\n    rest = snd . mapAccumL loop (0, 0) $ [1..n - 1] :: [Int]\n\n    loop :: (Int, Int) -&gt; Int -&gt; ((Int, Int), Int)\n    loop (l, r) i\n        | r &lt; i + 1 = ((i, r'), r' - i)\n        | i + out ! (i - l) &lt; r = ((l, r), out ! (i - l))\n        | otherwise = ((i, r''), r'' - i)\n        where\n        next = head . dropWhile (\\j -&gt; j &lt; n &amp;&amp; a ! j == a ! (j - i))\n        [r', r''] = map next [[i..], [r..]] :: [Int]\n</code></pre>\n"}], "owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 32830907, "answer_count": 2, "score": 1, "last_activity_date": 1443482058, "creation_date": 1443464679, "last_edit_date": 1592644375, "question_id": 32829458, "link": "https://stackoverflow.com/questions/32829458/searching-elements-in-haskell", "title": "Searching elements in Haskell", "body": "<p>I want an algorithm to find the next position of the first 20 elements of the list.</p>\n<blockquote>\n<p>I want 20 but using 3 as an example:</p>\n<p>Input <code>x=[1,2,3,0,0,4,4,1,2,3,0,0]</code>, then return <code>7</code> since the next <code>1,2,3</code> started at position <code>7</code>.</p>\n<p>Input <code>x=[1,2,3,0,1,2,3,0,1,2,3]</code>, then return <code>4</code> since the the next <code>1,2,3</code> started at position <code>4</code>.</p>\n<p>Input <code>x=[2,1,2,1,2]</code>, then return <code>2</code> since the next <code>2,1,2</code> started at position <code>2</code>.</p>\n<p>If no matching is found, return <code>-1</code>.</p>\n</blockquote>\n<p>I tried the simplest one by just checking every position one by one:</p>\n<pre><code>repeat x = repeat' x 0 x\n  where repeat' x position originlist \n        | length x &lt;=20         = -1\n        | take 20 (tail x) == y = position+1\n        | otherwise             = repeat' (tail x) (position+1) originlist\n         where y = take 20 originalist\n</code></pre>\n<p>But this is too slow, I need to deal with list of length up to 2*10^6. Since the search tool in browsers like Chrome or Safari can matching it in the blink of an eye, there must be an better algorithm(Or better code in Haskell rather than what I typed).</p>\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443462715, "post_id": 32828907, "comment_id": 53493645, "body": "This is incorrect, I suggest you test those in GHCi, especially <code>not (even)</code>. <code>not . even $ x</code> <i>happens</i> to work the same as <code>not $ even $ x</code>, but that&#39;s just an accident of precedence: the latter is parsed as <code>not $ (even $ x)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443462839, "post_id": 32828907, "comment_id": 53493698, "body": "As they say in the vernacular, &quot;not even!&quot;"}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443462986, "post_id": 32828907, "comment_id": 53493775, "body": "@dfeuer I don&#39;t think is a duplicate....."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443463045, "post_id": 32828907, "comment_id": 53493803, "body": "@&#216;rjanJohansen Even if the example is incorrect, I would also like to know why the dot is encouraged. I think is a good question."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1443463189, "post_id": 32828907, "comment_id": 53493886, "body": "It&#39;s function composition, gives more mathematical flavor and enables talking about functions without values (points)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1443463452, "post_id": 32828907, "comment_id": 53494023, "body": "@dsign, see <a href=\"http://meta.stackoverflow.com/questions/291992/what-is-a-canonical-question-answer-and-what-is-their-purpose\">What is a canonical question/answer and what is their purpose?</a>."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443463628, "post_id": 32828907, "comment_id": 53494107, "body": "@dfeuer Ah, but it is a duplicate of the one given by Sam!"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 1, "creation_date": 1443463810, "post_id": 32828907, "comment_id": 53494201, "body": "@dsign I guess it is, although I&#39;m not sure I agree Don&#39;s top-voted answer is the best one."}], "owner": {"reputation": 261, "user_id": 5165551, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NBdFX.jpg?s=128&g=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5165551/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "closed_date": 1443463854, "answer_count": 0, "score": 0, "last_activity_date": 1443462541, "creation_date": 1443462541, "question_id": 32828907, "link": "https://stackoverflow.com/questions/32828907/whats-the-advantage-of-using-instead-of", "closed_reason": "Duplicate", "title": "What&#39;s the advantage of using (.) instead of ($)?", "body": "<p>Let's say I want to define <code>odd</code> in Haskell. How I would go about it is of course <code>not . even</code>. However, that's exactly the same as <code>not $ even</code> or <code>not (even)</code>. What's the advantage of using <code>(.)</code> instead of one of the other two options? I know it's encouraged, but I don't know why exactly.</p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1443461063, "post_id": 32828483, "comment_id": 53492753, "body": "Use a compiler option or a pragma.  <a href=\"https://downloads.haskell.org/~ghc/7.8.2/docs/html/users_guide/ghc-language-features.html#options-language\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/7.8.2/docs/html/users_guide/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 9, "creation_date": 1443461200, "post_id": 32828566, "comment_id": 53492825, "body": "The <code>{-# LANGUAGE GADTs #-}</code> approach is pretty much always the way to go, because it lets people reading the source see immediately what extensions are in play."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443461335, "post_id": 32828566, "comment_id": 53492892, "body": "@dfeuer I agree. Actually that is why it is more common."}, {"owner": {"reputation": 249, "user_id": 4618385, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a7435120be391bce02d370802b409272?s=128&d=identicon&r=PG&f=1", "display_name": "maffh", "link": "https://stackoverflow.com/users/4618385/maffh"}, "edited": false, "score": 0, "creation_date": 1443461370, "post_id": 32828566, "comment_id": 53492910, "body": "Thank you for your help."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1443470128, "post_id": 32828566, "comment_id": 53497286, "body": "There is also the option of <code>{-# OPTIONS_GHC -XGADTs #-}</code>, but that&#39;s less readable, so I&#39;d go with a <code>LANUGAGE</code> pragma by default, too."}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 22, "last_activity_date": 1510756249, "last_edit_date": 1510756249, "creation_date": 1443461089, "answer_id": 32828566, "question_id": 32828483, "link": "https://stackoverflow.com/questions/32828483/how-do-you-allow-gadts-in-haskell/32828566#32828566", "title": "How do you allow GADTs in Haskell?", "body": "<p>The <code>Use GADTS to allow GADTS</code> looks wild :)</p>\n\n<p>Basically there are two ways to enable language extensions:</p>\n\n<ul>\n<li><p>path a <code>-X&lt;extensions&gt;</code> to <code>ghc</code>, e.g. <code>ghc -XGADTS</code></p></li>\n<li><p>put <code>{-# LANGUAGE &lt;extension&gt; #-}</code> at the top of a file, e.g. <code>{-# LANGUAGE GADTs #-}</code></p></li>\n</ul>\n\n<p>Initially the error messages looked like that: <code>Use -XGADTs to allow GADTs</code>, but actually language pragma (the second way) is more common, and people started complaining that it is hard to copy-n-paste extension name from the error message, so <code>-X</code> was dropped.</p>\n"}], "owner": {"reputation": 249, "user_id": 4618385, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a7435120be391bce02d370802b409272?s=128&d=identicon&r=PG&f=1", "display_name": "maffh", "link": "https://stackoverflow.com/users/4618385/maffh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3276, "favorite_count": 1, "accepted_answer_id": 32828566, "answer_count": 1, "score": 14, "last_activity_date": 1510756249, "creation_date": 1443460727, "question_id": 32828483, "link": "https://stackoverflow.com/questions/32828483/how-do-you-allow-gadts-in-haskell", "title": "How do you allow GADTs in Haskell?", "body": "<p>Today I started to learn about GADTs from: <a href=\"https://downloads.haskell.org/~ghc/6.6.1/docs/html/users_guide/gadt.html\">haskell.org</a> and <a href=\"https://wiki.haskell.org/GADTs_for_dummies\">https://wiki.haskell.org</a></p>\n\n<p>Unfortunately, I don't know how to use them. If I run the code from the example I get the following error:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( test.hs, interpreted )\n\nAFP_229.hs:31:1:\nIllegal generalised algebraic data declaration for `Term'\n  (Use GADTs to allow GADTs)\nIn the data declaration for `Term'\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n\n<p>This is the code I am using:</p>\n\n<pre><code>data Term a where\n  Lit    :: Int -&gt; Term Int\n  Succ   :: Term Int -&gt; Term Int\n  IsZero :: Term Int -&gt; Term Bool   \n  If     :: Term Bool -&gt; Term a -&gt; Term a -&gt; Term a\n  Pair   :: Term a -&gt; Term b -&gt; Term (a,b)\n</code></pre>\n\n<p>I have tried other sample code, but this gives me the same error. How do you allow GADTs?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "edited": false, "score": 1, "creation_date": 1443460036, "post_id": 32828254, "comment_id": 53492194, "body": "I don&#39;t know about Haskell, but wouldn&#39;t that be equivalent to <code>map</code> returning an array of objects then <code>reduce</code> to join them together?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443485331, "post_id": 32828254, "comment_id": 53503114, "body": "Incidentally, since you mention <code>filter</code> and <code>map</code>, note that both of those can be implemented in terms of the &quot;one to many&quot; operation you describe (which, as shown in the comments, is <code>concatMap</code>, or <code>&gt;&gt;=</code>). You may enjoy the exercise of implementing <code>filter</code> and <code>map</code> in terms of it."}], "answers": [{"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 3, "creation_date": 1443461730, "post_id": 32828296, "comment_id": 53493103, "body": "You can use <code>concatMap</code> if you don\u2019t like strange symbols."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1443461769, "post_id": 32828296, "comment_id": 53493120, "body": "@JoachimBreitner, but then you&#39;re missing out on the connection to tree grafting and all that other monadic goodness."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 6, "creation_date": 1443461877, "post_id": 32828296, "comment_id": 53493181, "body": "Sure, but I find it more natural to first point to <code>concatMap</code>, and then, as a remark to those who can make use of it, point out that <code>(&gt;&gt;=)=concatMap</code>."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1443459986, "creation_date": 1443459986, "answer_id": 32828296, "question_id": 32828254, "link": "https://stackoverflow.com/questions/32828254/functional-programming-style-map-function-that-adds-elements/32828296#32828296", "title": "Functional Programming-Style Map Function that adds elements?", "body": "<p>This is exactly what <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:-62--62--61-\" rel=\"noreferrer\"><code>&gt;&gt;=</code></a> specialized to lists does.</p>\n\n<pre><code>&gt; [1..6] &gt;&gt;= \\x -&gt; take (x `mod` 3) [1..]\n[1,1,2,1,1,2]\n</code></pre>\n\n<p>It's <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:concat\" rel=\"noreferrer\"><code>concat</code></a>enating together the results of</p>\n\n<pre><code>&gt; map (\\x -&gt; take (x `mod` 3) [1..]) [1..6]\n[[1],[1,2],[],[1],[1,2],[]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7961, "user_id": 482601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52578189717d3748d30828c5fff42ba9?s=128&d=identicon&r=PG", "display_name": "fabian789", "link": "https://stackoverflow.com/users/482601/fabian789"}, "edited": false, "score": 0, "creation_date": 1443525981, "post_id": 32829938, "comment_id": 53519647, "body": "Thanks for the explanation and exercises \u2013 I like it!"}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 2, "last_activity_date": 1443466648, "creation_date": 1443466648, "answer_id": 32829938, "question_id": 32828254, "link": "https://stackoverflow.com/questions/32828254/functional-programming-style-map-function-that-adds-elements/32829938#32829938", "title": "Functional Programming-Style Map Function that adds elements?", "body": "<p>You do not have to roll your own.  There are many relevant functions here, but I'll highlight three.</p>\n\n<p>First of all, there is the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:concat\" rel=\"nofollow\"><code>concat</code> function</a>, which already comes in the Prelude (the standard library that's loaded by default).  What this function does, when applied to a list of lists, is return the list that contains concatenated contents of the sublists.</p>\n\n<p><strong>EXERCISE:</strong> Write your own version of <code>concat :: [[a]] -&gt; [a]</code>.</p>\n\n<p>So using <code>concat</code> together with <code>map</code>, you could write this function:</p>\n\n<pre><code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]\nconcatMap f = concat . map f\n</code></pre>\n\n<p>...except that you don't actually need to write it, because it's such a common pattern that <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow\">the Prelude already has it</a> (at a more general type than what I show here\u2014the library version takes any <code>Foldable</code>, not just lists).</p>\n\n<p>Finally, there is also the <code>Monad</code> instance for list, which can be defined this way:</p>\n\n<pre><code>instance Monad [] where\n  return a = [a]\n  as &gt;&gt;= f = concatMap f as\n</code></pre>\n\n<p>So the <code>&gt;&gt;=</code> operator (the centerpiece of the <code>Monad</code> class), when working with lists, is exactly the same thing as <code>concatMap</code>.</p>\n\n<p><strong>EXERCISE:</strong> Skim through the documentation of the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html\" rel=\"nofollow\"><code>Data.List</code> module</a>.  Figure out how to import the module into your code and play around with some of the functions.</p>\n"}], "owner": {"reputation": 7961, "user_id": 482601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52578189717d3748d30828c5fff42ba9?s=128&d=identicon&r=PG", "display_name": "fabian789", "link": "https://stackoverflow.com/users/482601/fabian789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 32828296, "answer_count": 2, "score": 2, "last_activity_date": 1443466648, "creation_date": 1443459824, "last_edit_date": 1443461833, "question_id": 32828254, "link": "https://stackoverflow.com/questions/32828254/functional-programming-style-map-function-that-adds-elements", "title": "Functional Programming-Style Map Function that adds elements?", "body": "<p>I know and love my <code>filter</code>, <code>map</code> and <code>reduce</code>, which happen to be part of more and more languages that are not really purely functional.</p>\n\n<p>I found myself needing a similar function though: something like <code>map</code>, but instead of one to one it would be one to many.</p>\n\n<p>I.e. one element of the original list might be mapped to multiple elements in the target list. </p>\n\n<p>Is there already something like this out there or do I have to roll my own?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1443454536, "post_id": 32826576, "comment_id": 53489123, "body": "The quote never claims that &quot;type erasure improves compiling time&quot;, only that it helps improving <i>runtime</i>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1443456635, "post_id": 32826576, "comment_id": 53490412, "body": "Functions are parametric in that if you have a type parameter <code>a</code>, you can never inspect <code>a</code> and make decisions at runtime based on it&#39;s type. So you can be certain that a function like <code>map</code> behaves uniformly for all input lists so you don&#39;t need to maintain the list element type around at runtime. Compare this with a language like C# which allows you to get the real list parameter type at runtime through reflection."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1443463359, "last_edit_date": 1443463359, "creation_date": 1443456774, "answer_id": 32827420, "question_id": 32826576, "link": "https://stackoverflow.com/questions/32826576/type-erasure-in-haskell/32827420#32827420", "title": "Type erasure in Haskell?", "body": "<p>Implementations of dynamically typed languages typically need to store type information with each value in memory. This isn't too bad for Lisp-like languages that have just a few types and can reasonably identify them with a few tag bits (although such limited types lead to other efficiency issues). It's much worse for a language with lots of types. Haskell lets you carry type information to runtime, but it forces you to be explicit about it, so you can pay attention to the cost. For example, adding the context <code>Typeable a</code> to a type offers a value with that type access, at runtime, to a representation of the type of <code>a</code>. More subtly, typeclass instance dictionaries are usually specialized away at compile time, but in sufficiently polymorphic or complex cases may survive to runtime. In a compiler like the apparently-abandoned JHC, and one likely possibility for the as-yet-barely-started compiler THC, this could lead to some type information leaking to runtime in the form of pointer tagging. But these situations are fairly easy to identify and only rarely cause serious performance problems.</p>\n"}, {"tags": [], "owner": {"reputation": 6648, "user_id": 464306, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8KCe.png?s=128&g=1", "display_name": "gdejohn", "link": "https://stackoverflow.com/users/464306/gdejohn"}, "is_accepted": true, "score": 13, "last_activity_date": 1443459681, "last_edit_date": 1443459681, "creation_date": 1443456920, "answer_id": 32827469, "question_id": 32826576, "link": "https://stackoverflow.com/questions/32826576/type-erasure-in-haskell/32827469#32827469", "title": "Type erasure in Haskell?", "body": "<blockquote>\n  <p>What I don't understand is how are \"all Haskell functions\" parametric?</p>\n</blockquote>\n\n<p>It doesn't say all Haskell functions are parametric, it says:</p>\n\n<blockquote>\n  <p>All Haskell functions must be parametric <strong>in their type parameters</strong>.</p>\n</blockquote>\n\n<p>A Haskell function need not have any type parameters.</p>\n\n<blockquote>\n  <p>One more question: why does the author say that \"Despite how important types are when writing Haskell code, they are completely irrelevant when running Haskell code\"?</p>\n</blockquote>\n\n<p>Unlike a dynamically typed language where you need to check at run time if (for example) two things are numbers before trying to add them together, your running Haskell program knows that if you're trying to add them together, then they must be numbers because the compiler made sure of it beforehand.</p>\n\n<blockquote>\n  <p>Aren't types explicit/static in Haskell?</p>\n</blockquote>\n\n<p>Types in Haskell can often be inferred, in which case they don't need to be explicit. But you're right that they're static, and that is actually why they don't matter at run time, because static means that the compiler makes sure everything has the type that it should before your program ever executes.</p>\n"}, {"tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": false, "score": 10, "last_activity_date": 1443457471, "creation_date": 1443457471, "answer_id": 32827618, "question_id": 32826576, "link": "https://stackoverflow.com/questions/32826576/type-erasure-in-haskell/32827618#32827618", "title": "Type erasure in Haskell?", "body": "<p>Types can be erased in Haskell because the type of an expression is either know at compile time (like <code>True</code>) or its type does not matter at runtime (like <code>[]</code>).</p>\n\n<p>There's a caveat to this though, it assumes that all values have some kind of uniform representation.  Most Haskell implementations use pointers for everything, so the actual type of what a pointer points to doesn't matter (except for the garbage collector), but you could imagine a Haskell implementation that uses a non-uniform representation and then some type information would have to be kept.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443468841, "post_id": 32828185, "comment_id": 53496662, "body": "The Java examples don&#39;t seem very good to me. In the first instance, calling <code>foo</code> generally <i>does</i> involve runtime type checks, because the JVM has to determine if the <code>foo</code> method has been overridden in some subclass of <code>SomeClass</code>. And in the second, the cast to <code>A</code> is triply wrong: you can&#39;t cast to the type of a type parameter (because of erasure); there&#39;s never any use casting a constructor call, since its type is perfectly known; there&#39;s no need to cast anyway since <code>B</code> is clearly a subclass of <code>A</code> in this context."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443470958, "post_id": 32828185, "comment_id": 53497709, "body": "@amalloy 1) I&#39;m not completely sure, but I think that accessing the vtable and calling the method pointed there does not require to check anything, only to blindly follow pointers; 2) Try compiling the code without the <code>(A)</code> cast: the compiler rightfully complains that <code>B</code> is not a subtype of the generic <code>A</code>. (There is a warning about the unchecked cast at runtime, though)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443471094, "post_id": 32828185, "comment_id": 53497781, "body": "Fair point about (1) I guess. What you say about (2) is true, but doesn&#39;t actually support your answer: that cast doesn&#39;t happen at runtime at all; it compiles to zero bytecode operations (or, okay, possibly a cast to Object, which is basically a no-op). It&#39;s required at compile time to make the compiler happy, but doesn&#39;t do anything at runtime."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443471213, "post_id": 32828185, "comment_id": 53497851, "body": "@chi, Java is one of those languages with too much reflection for its own good. I&#39;m not sure of much in Java, but one thing I know is that its types don&#39;t tell the compiler all it needs to know even when they look like they do."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1443471228, "post_id": 32828185, "comment_id": 53497863, "body": "@amalloy Yes, I agree - I was talking about the <code>instanceof</code> check which is done at runtime. Perhaps I should rework the sentence."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443471733, "post_id": 32828185, "comment_id": 53498131, "body": "@dfeuer I&#39;m far from being a Java expert, but from my experience the type information at compile time isn&#39;t too bad. The big warts arise when something can&#39;t be implemented because at runtime there&#39;s only a partial type information, e.g. you can&#39;t really test for <code>x instanceof Foo&lt;A&gt;</code>, since <code>A</code> is erased."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443471981, "post_id": 32828185, "comment_id": 53498253, "body": "@chi, what I mean is that reasoning from parametricity like we do in Haskell doesn&#39;t really work so well. Things that locally look parametric may not be."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1443471547, "last_edit_date": 1443471547, "creation_date": 1443459556, "answer_id": 32828185, "question_id": 32826576, "link": "https://stackoverflow.com/questions/32826576/type-erasure-in-haskell/32828185#32828185", "title": "Type erasure in Haskell?", "body": "<p>Others have already answered, but perhaps some examples can help.</p>\n\n<p>Python, for instance, retains type information until runtime:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; def f(x):\n...   if type(x)==type(0):\n...     return (x+1,x)\n...   else:\n...     return (x,x)\n... \n&gt;&gt;&gt; f(\"hello\")\n('hello', 'hello')\n&gt;&gt;&gt; f(10)\n(11, 10)\n</code></pre>\n\n<p>The function above, given any argument <code>x</code> returns the pair <code>(x,x)</code>, <em>except</em> when <code>x</code> is of type <code>int</code>. The function tests for that type at runtime, and if <code>x</code> is found to be an <code>int</code> it behaves in a special way, returning <code>(x+1, x)</code> instead.</p>\n\n<p>To realize the above, the Python runtime must keep track of types. That is, when we do</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; x = 5\n</code></pre>\n\n<p>Python can not just store the byte representation of <code>5</code> in memory. It also needs to mark that representation with a type tag <code>int</code>, so that when we do <code>type(x)</code> the tag can be recovered.</p>\n\n<p>Further, before doing any operation such as <code>x+1</code> Python needs to check the type tag to ensure we are really working on <code>int</code>s. If <code>x</code> is for instance a <code>str</code>ing, Python will raise an exception.</p>\n\n<p>Statically checked languages such as Java do not need such checks at runtime. For instance, when we run</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>SomeClass x = new SomeClass(42);\nx.foo();\n</code></pre>\n\n<p>the compiler has already checked there's indeed a method <code>foo</code> for <code>x</code> at compile time, so there's no need to do that again. This can improve performance, in principle. (Actually, the JVM does some runtime checks at class load time, but let's ignore those for the sake of simplicity)</p>\n\n<p>In spite of the above, Java <em>has</em> to store type tags like Python does, since it has a <code>type(-)</code> analogous:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>if (x instanceof SomeClass) { ...\n</code></pre>\n\n<p>Hence, Java allows one to write functions which can behave \"specially\" on some types.</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>// this is a \"generic\" function, using a type parameter A\n&lt;A&gt; A foo(A x) {\n   if (x instanceof B) {  // B is some arbitrary class\n      B b = (B) x;\n      return (A) new B(b.get()+1);\n   } else {\n      return x;\n   }\n}\n</code></pre>\n\n<p>The above function <code>foo()</code> just returns its argument, except when it's of type <code>B</code>, for which a new object is created instead. This is a consequence of using  <code>instanceof</code>, which requires every object to carry a tag at runtime. </p>\n\n<p>To be honest, such a tag is already present to be able to implement virtual methods, so it does not cost anything more. Yet, the presence of <code>instanceof</code> makes it possible to cause the above non-uniform behaviour on types -- some types can be handled differently.</p>\n\n<p>Haskell, instead has no such <code>type/instanceof</code> operator. A parametric Haskell function having type</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foo :: a -&gt; (a,a)\n</code></pre>\n\n<p><em>must</em> behave in the same way at all types. There's no way to cause some \"special\" behaviour. Concretely, <code>foo x</code> <em>must</em> return <code>(x,x)</code>, and we can see this just by looking at the type annotation above. To stress the point, there's no need to look at the code (!!) to prove such property. This is what <em>parametricity</em> ensures from the type above.</p>\n"}], "owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1631, "favorite_count": 2, "accepted_answer_id": 32827469, "answer_count": 4, "score": 9, "last_activity_date": 1576152858, "creation_date": 1443453974, "last_edit_date": 1592644375, "question_id": 32826576, "link": "https://stackoverflow.com/questions/32826576/type-erasure-in-haskell", "title": "Type erasure in Haskell?", "body": "<p>I was reading a <a href=\"https://www.seas.upenn.edu/%7Ecis194/spring15/fall14/lectures/04-poly.html\" rel=\"noreferrer\">lecture note</a> on Haskell when I came across this paragraph:</p>\n<blockquote>\n<p>This \u201cnot caring\u201d is what the \u201cparametric\u201d in parametric polymorphism means. All Haskell functions must be parametric in their type parameters; the functions must not care or make decisions based on the choices for these parameters. A function can't do one thing when a is Int and a different thing when a is Bool. Haskell simply provides no facility for writing such an operation. This property of a langauge is called parametricity.</p>\n<p>There are many deep and profound consequences of parametricity. One consequence is something called type erasure. Because a running Haskell program can never make decisions based on type information, all the type information can be dropped during compilation. Despite how important types are when writing Haskell code, they are completely irrelevant when running Haskell code. This property gives Haskell a huge speed boost when compared to other languages, such as Python, that need to keep types around at runtime. (Type erasure is not the only thing that makes Haskell faster, but Haskell is sometimes clocked at 20x faster than Python.)</p>\n</blockquote>\n<p>What I don't understand is how are &quot;all Haskell functions&quot; parametric? Aren't types explicit/static in Haskell? Also I don't really understand how type erasure improves <strike>compiling time</strike> runtime?</p>\n<p>Sorry if these questions are really basic, I'm new to Haskell.</p>\n<p>EDIT:</p>\n<p>One more question: why does the author say that &quot;Despite how important types are when writing Haskell code, they are completely irrelevant when running Haskell code&quot;?</p>\n"}, {"tags": ["haskell", "bytestring"], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "edited": false, "score": 0, "creation_date": 1443457068, "post_id": 32826894, "comment_id": 53490622, "body": "This is exactly what I was looking for. Thank you for thorough description."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 4, "last_activity_date": 1443455034, "creation_date": 1443455034, "answer_id": 32826894, "question_id": 32826539, "link": "https://stackoverflow.com/questions/32826539/chunksof-analog-for-bytestring/32826894#32826894", "title": "chunksOf analog for ByteString?", "body": "<p>Both <code>ByteString</code> and <code>Lazy.Bytestring</code> have <a href=\"http://hackage.haskell.org/package/bytestring/docs/Data-ByteString.html#v:splitAt\" rel=\"nofollow\"><code>splitAt</code></a> <a href=\"http://hackage.haskell.org/package/bytestring/docs/Data-ByteString-Lazy.html#v:splitAt\" rel=\"nofollow\">functions</a> which you can use to <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:unfoldr\" rel=\"nofollow\"><code>unfoldr</code></a> a list.</p>\n\n<pre><code>import Data.List (unfoldr)\nimport Data.Int (Int64)\n\nimport qualified Data.ByteString as BS\nimport qualified Data.ByteString.Lazy as Lazy\n\njustWhen :: (a -&gt; Bool) -&gt; (a -&gt; b) -&gt; (a -&gt; Maybe b)\njustWhen f g a = if f a then Just (g a) else Nothing\n\nnothingWhen :: (a -&gt; Bool) -&gt; (a -&gt; b) -&gt; (a -&gt; Maybe b)\nnothingWhen f = justWhen (not . f)\n\nchunksOf :: Int -&gt; BS.ByteString -&gt; [BS.ByteString]\nchunksOf x = unfoldr (nothingWhen BS.null (BS.splitAt x))\n\nchunksOf' :: Int64 -&gt; Lazy.ByteString -&gt; [Lazy.ByteString]\nchunksOf' x = unfoldr (nothingWhen Lazy.null (Lazy.splitAt x))\n</code></pre>\n\n<p>Building bytestrings for an example is easier with <code>OverloadedStrings</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmain = do\n    print $ chunksOf 3 \"\"\n    print $ chunksOf 3 \"Hello World!\"\n    print $ chunksOf' 3 \"\"\n    print $ chunksOf' 3 \"Hello, World\"\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 32826894, "answer_count": 1, "score": 4, "last_activity_date": 1443455034, "creation_date": 1443453848, "question_id": 32826539, "link": "https://stackoverflow.com/questions/32826539/chunksof-analog-for-bytestring", "title": "chunksOf analog for ByteString?", "body": "<p>I need to split bytestring into list of bytestrings diving first one by 100 characters. For lists, I can use <code>chunksOf</code> but not for <code>ByteString</code>. </p>\n\n<p>Is there some proper way to do this?</p>\n"}, {"tags": ["haskell", "ghc", "modular", "gadt", "type-families"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 7, "creation_date": 1443451337, "post_id": 32825670, "comment_id": 53487042, "body": "You might be interested in the paper <a href=\"http://okmij.org/ftp/Haskell/tr-15-04.pdf\" rel=\"nofollow noreferrer\">Functional Pearl: Implicit Configuration</a> and the corresponding <a href=\"https://hackage.haskell.org/package/reflection\" rel=\"nofollow noreferrer\">reflection</a> package."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443453210, "post_id": 32825670, "comment_id": 53488288, "body": "Do note that everything to do with <code>Given</code> in <code>reflection</code> is Considered Unwise; the rest is really cool."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 0, "creation_date": 1443455821, "post_id": 32825670, "comment_id": 53489921, "body": "Am reading the paper now.  Very interesting.  Thanks to Cirdec and dfeuer.  This may be just what I was looking for.  My main remaining point of confusion is whether it would be possible to construct Kiselyov/Shan modular numbers without the strangeness of considering them functions of a discarded argument."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443464041, "post_id": 32828281, "comment_id": 53494334, "body": "To avoid confusion, I highly recommend using <code>ScopedTypeVariables</code> whenever you use extensions that enable the <code>forall</code> keyword. It makes no difference here, but I don&#39;t like having to think about whether it&#39;s on or off."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443464680, "post_id": 32828281, "comment_id": 53494673, "body": "In fact, <code>ScopedTypeVariables</code> would be very useful here, to avoid any need to tie a knot. Simply use <code>normalize :: forall s a . (Reifies s a, Integral a) =&gt; a -&gt; M a s</code> and then <code>normalize a = M (mod a (reflect (Proxy :: Proxy s)))</code>"}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 0, "creation_date": 1443475459, "post_id": 32828281, "comment_id": 53499948, "body": "Couldn&#39;t agree more and was shocked when I first learned that type variables were <i>not</i> scoped.  ScopedTypeVariables really belongs in Haskell&#39;."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1443459926, "creation_date": 1443459926, "answer_id": 32828281, "question_id": 32825670, "link": "https://stackoverflow.com/questions/32825670/modular-arithmetic-using-haskell-type-families-or-gadts/32828281#32828281", "title": "Modular Arithmetic using Haskell Type-Families or GADTs?", "body": "<p>Here is some working code using <code>Data.Reflection</code>:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nimport Data.Reflection\nimport Data.Proxy\n\ndata M a s = M a -- Note the phantom comes *after* the concrete\n\n-- In `normalize` we're tying the knot to get the phantom types to align\n-- note that reflect :: Reifies s a =&gt; forall proxy. proxy s -&gt; a\n\nnormalize :: (Reifies s a, Integral a) =&gt; a -&gt; M a s\nnormalize a = b where b = M (mod a (reflect b)) \n\ninstance (Reifies s a, Integral a) =&gt; Num (M a s) where\n  M a + M b = normalize (a + b)\n  M a - M b = normalize (a - b)\n  M a * M b = normalize (a * b)\n  fromInteger n = normalize (fromInteger n)\n  abs _     = error \"abs not implemented\"\n  signum _  = error \"sgn not implemented\"\n\nwithModulus :: Integral a =&gt; a -&gt; (forall s. Reifies s a =&gt; M a s) -&gt; a\nwithModulus m ma = reify m (runM . asProxyOf ma)\n  where asProxyOf :: f s -&gt; Proxy s -&gt; f s\n        asProxyOf a _ = a\n\nrunM :: M a s -&gt; a\nrunM (M a) = a\n\nexample :: (Reifies s a, Integral a) =&gt; M a s\nexample = normalize 3\n\nexample2 :: (Reifies s a, Integral a, Num (M a s)) =&gt; M a s\nexample2 = 3*3 + 5*5\n\nmfactorial :: (Reifies s a, Integral a, Num (M a s)) =&gt; Int -&gt; M a s\nmfactorial n = product $ map fromIntegral [1..n]\n\ntest1 p n = withModulus p $ mfactorial n\n\nmadd :: (Reifies s Int, Num (M Int s)) =&gt; M Int s -&gt; M Int s -&gt; M Int s\nmadd a b = a + b\n\ntest2 :: Int -&gt; Int -&gt; Int -&gt; Int\ntest2 p a b = withModulus p $ madd (fromIntegral a) (fromIntegral b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 1, "creation_date": 1443475356, "post_id": 32829956, "comment_id": 53499913, "body": "Very nice.  Looks like you already did exactly what I was thinking of doing.  One question: Why define a new &#39;inv&#39; function, rather than instantiating Fractional and using recip?  That also gives you fromRational and /, both of which often make sense for modular numbers."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 1, "creation_date": 1443477953, "post_id": 32829956, "comment_id": 53500951, "body": "@CarlEdman: Ah, fair point. I just didn&#39;t think of it, but that seems to make sense, although maybe some of the behavior isn&#39;t intuitive? (<code>fromRational</code> feels a bit weird...) Could you open up a <a href=\"https://github.com/TikhonJelvis/modular-arithmetic/issues\" rel=\"nofollow noreferrer\">GitHub issue</a> or pull request? Thanks!"}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 4, "last_activity_date": 1443466743, "creation_date": 1443466743, "answer_id": 32829956, "question_id": 32825670, "link": "https://stackoverflow.com/questions/32825670/modular-arithmetic-using-haskell-type-families-or-gadts/32829956#32829956", "title": "Modular Arithmetic using Haskell Type-Families or GADTs?", "body": "<p>Newer versions of GHC have type-level numbers built in, which should be more efficient than ones you roll yourself using Peano arithmetic. You can use them by enabling <code>DataKinds</code>. As a bonus, you'd also get some nice syntax:</p>\n\n<pre><code>factorials :: [Mod Int 20]\n</code></pre>\n\n<p>Whether this is efficient or not depends on how you implement the <code>Mod</code> type. In the most general case, you probably want to just <code>mod</code> after every arithmetic operation. Unless you're in a hot loop where saving a handful of instructions matters, this should be fine. (And inside the hot loop, it's probably better to be explicit about when you mod anyhow.)</p>\n\n<p>I actually implemented this type in a library on Hackage: <a href=\"https://hackage.haskell.org/package/modular-arithmetic-1.2.1.1/docs/Data-Modular.html\" rel=\"nofollow\"><code>modular-arithmetic</code></a>. It has a test suite but no benchmarks so I can't vouch for the absolute performance, but it's not doing anything that should be slow and it was fast enough for my purposes. (Which, admittedly, involved small moduli.) If you try it and run into performance issues, I'd love to hear about them so I can try to fix them.</p>\n"}], "owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 32829956, "answer_count": 2, "score": 9, "last_activity_date": 1443555086, "creation_date": 1443450959, "last_edit_date": 1495542227, "question_id": 32825670, "link": "https://stackoverflow.com/questions/32825670/modular-arithmetic-using-haskell-type-families-or-gadts", "title": "Modular Arithmetic using Haskell Type-Families or GADTs?", "body": "<p>I frequently have occasion to perform modular arithmetic in Haskell, where the modulus is usually large and often prime (like 2000000011).  Currently, I just use functions like (modAdd m a b), (modMul m a b), (modDiv m a b) etc.  But that is rather inconvenient, requiring an additional parameter to always be specified and carried around and creating my various functions in both the regular integral form and separately in mod- form.</p>\n\n<p>So it occurs that it might be a good idea to create a new class something like this:</p>\n\n<pre><code>class Integral a =&gt; Mod a\n\nm = 2000000011\n\ninstance Integral a =&gt; Num (Mod a) where\n   ... defining (+), etc. as modulo m\n</code></pre>\n\n<p>Then one could just perform regular arithmetic, using regular functions, and define useful structures like</p>\n\n<pre><code>factorials :: [Mod Int]\nfactorials = 1:zipWith (*) factorials [1..]\n</code></pre>\n\n<p>But that has one problem: All values of type Mod Int necessarily must have the same modulus.  However, often I need to work in multiple moduli in one program (of course always only combining values of the same modulus).</p>\n\n<p>I think, but do not understand sufficiently well to be sure, that this could be overcome by something like this:</p>\n\n<pre><code>class Integral a =&gt; Mod Nat a\n</code></pre>\n\n<p>where Nat is a type that encodes the modulus in Peano fashion.  This would be advantageous: I could have values of different moduli and the type-checker would save me from accidentally combining this value.</p>\n\n<p>Is something like this feasible and efficient?  Will it cause either the compiler or the RTS to try to actually construct the enormous (Succ (Succ (Succ ... repeated 2000000011 times) if I try to use that modulus, rendering the solution effectively useless?  Will the RTS try to check the type match on every operation?  Will the RTS representation of every value be blown up from what could otherwise be just an unboxed int?</p>\n\n<p>Is there a better way?</p>\n\n<h2>CONCLUSION</h2>\n\n<p>Thanks to helpful comments from <a href=\"https://stackoverflow.com/users/414413/cirdec\">cirdec</a>, <a href=\"https://stackoverflow.com/users/1477667/dfeuer\">dfeuer</a>, <a href=\"https://stackoverflow.com/users/866915/user5402\">user5402</a>, and <a href=\"https://stackoverflow.com/users/286871/tikhon-jelvis\">tikhon-jelvis</a>, I learned that (unsurprisingly) I was not the first to have this idea.  In particular, there is a recent <a href=\"http://okmij.org/ftp/Haskell/tr-15-04.pdf\" rel=\"nofollow noreferrer\">paper</a> by Kiselyov and Shan that gives an implementation and tikhon-jelvis has posted to Hackage a solution called (surprise!) <a href=\"https://hackage.haskell.org/package/modular-arithmetic-1.2.1.1/docs/Data-Modular.html\" rel=\"nofollow noreferrer\">modular-arithmetic</a>, that offers even nicer semantics using fancy ghc pragmas.</p>\n\n<h2>OPEN QUESTION (TO ME)</h2>\n\n<p>What happens behind the curtain?  In particular, would a million-element list of [Mod Int 2000000011] carry around an extra million copies of 2000000011 around?  Or does it compile to the same code as a list of a million Int with the modulus parameter carried separately would?  The latter would be nice.</p>\n\n<h2>ADDENDUM ON PERFORMANCE</h2>\n\n<p>I ran a bit of a benchmark on a current problem I am working on.  The first run used an unboxed 10,000-element Int vector and performed 10,000 operations on it:</p>\n\n<pre><code>   4,810,589,520 bytes allocated in the heap\n         107,496 bytes copied during GC\n       1,197,320 bytes maximum residency (1454 sample(s))\n         734,960 bytes maximum slop\n              10 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0      6905 colls,     0 par    0.109s   0.101s     0.0000s    0.0006s\n  Gen  1      1454 colls,     0 par    0.812s   0.914s     0.0006s    0.0019s\n\n  TASKS: 13 (1 bound, 12 peak workers (12 total), using -N11)\n\n  SPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\n  INIT    time    0.000s  (  0.001s elapsed)\n  MUT     time    2.672s  (  2.597s elapsed)\n  GC      time    0.922s  (  1.015s elapsed)\n  EXIT    time    0.000s  (  0.001s elapsed)\n  Total   time    3.594s  (  3.614s elapsed)\n\n  Alloc rate    1,800,454,557 bytes per MUT second\n\n  Productivity  74.3% of total user, 73.9% of total elapsed\n</code></pre>\n\n<p>For the second run, I performed the same operations on an unboxed Vector of 10,000 (Mod Int 1000000007).  That made my code a little simpler, but took about 3 times as long (while having nearly identical memory profile):</p>\n\n<pre><code>   4,810,911,824 bytes allocated in the heap\n         107,128 bytes copied during GC\n       1,199,408 bytes maximum residency (1453 sample(s))\n         736,928 bytes maximum slop\n              10 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0      6906 colls,     0 par    0.094s   0.107s     0.0000s    0.0007s\n  Gen  1      1453 colls,     0 par    1.516s   1.750s     0.0012s    0.0035s\n\n  TASKS: 13 (1 bound, 12 peak workers (12 total), using -N11)\n\n  SPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\n  INIT    time    0.000s  (  0.001s elapsed)\n  MUT     time    8.562s  (  8.323s elapsed)\n  GC      time    1.609s  (  1.857s elapsed)\n  EXIT    time    0.000s  (  0.001s elapsed)\n  Total   time   10.172s  ( 10.183s elapsed)\n\n  Alloc rate    561,858,315 bytes per MUT second\n\n  Productivity  84.2% of total user, 84.1% of total elapsed\n</code></pre>\n\n<p>I wonder why that happens and if it could be fixed.  Still, I really like the modular-arithmetic package and will use it where performance is not absolutely critical.</p>\n"}, {"tags": ["haskell", "monads", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 5, "creation_date": 1443462504, "post_id": 32825256, "comment_id": 53493537, "body": "<a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Applicative-Backwards.html\" rel=\"nofollow noreferrer\"><code>Control.Applicative.Backwards</code> from <code>transformers</code></a> contains a newtype wrapper implementing this for any <code>Applicative</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1443459984, "last_edit_date": 1443459984, "creation_date": 1443449685, "answer_id": 32825256, "question_id": 32823867, "link": "https://stackoverflow.com/questions/32823867/how-arbitrary-is-the-ap-implementation-for-monads/32825256#32825256", "title": "How arbitrary is the &quot;ap&quot; implementation for monads?", "body": "<p>Let's start with the obvious fact: such a definition for <code>&lt;*&gt;</code> violates the <code>ap</code>-law in the sense that <code>&lt;*&gt;</code> should <code>ap</code>, where <code>ap</code> is the one defined in the <code>Monad</code> class, i.e. the first one you posted.</p>\n\n<p>Trivialities aside, as far as I can see, the other applicative laws should hold.</p>\n\n<p>More concretely, let's focus on the composition law you mentioned.\nYour \"reversed\" <code>ap</code></p>\n\n<pre><code>(&lt;**&gt;) m1 m2 = do { x &lt;- m2 ; f &lt;- m1 ; return (f x) }\n</code></pre>\n\n<p>can also be defined as</p>\n\n<pre><code>(&lt;**&gt;) m1 m2 = pure (flip ($)) &lt;*&gt; m2 &lt;*&gt; m1\n</code></pre>\n\n<p>where <code>&lt;*&gt;</code> is the \"regular\" <code>ap</code>.</p>\n\n<p>This means that, for instance,</p>\n\n<pre><code>u &lt;**&gt; (v &lt;**&gt; w) =\n  { def. &lt;**&gt; }\npure (flip ($)) &lt;*&gt; (v &lt;**&gt; w) &lt;*&gt; u =\n  { def. &lt;**&gt; }\npure (flip ($)) &lt;*&gt; (pure (flip ($)) &lt;*&gt; w &lt;*&gt; v) &lt;*&gt; u =\n  { composition law }\npure (.) &lt;*&gt; pure (flip ($)) &lt;*&gt; (pure (flip ($)) &lt;*&gt; w) &lt;*&gt; v &lt;*&gt; u =\n  { homomorphism law }\npure ((.) (flip ($))) &lt;*&gt; (pure (flip ($)) &lt;*&gt; w) &lt;*&gt; v &lt;*&gt; u =\n  { composition law }\npure (.) &lt;*&gt; pure ((.) (flip ($))) &lt;*&gt; pure (flip ($)) &lt;*&gt; w &lt;*&gt; v &lt;*&gt; u =\n  { homomorphism law (x2)}\npure ((.) ((.) (flip ($))) (flip ($))) &lt;*&gt; w &lt;*&gt; v &lt;*&gt; u =\n  { beta reduction (several) }\npure (\\x f g -&gt; g (f x)) &lt;*&gt; w &lt;*&gt; v &lt;*&gt; u\n</code></pre>\n\n<p>(I hope I got everything OK)</p>\n\n<p>Try doing something similar to the left hand side.</p>\n\n<pre><code>pure (.) &lt;**&gt; u &lt;**&gt; v &lt;**&gt; w = ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443453101, "post_id": 32825891, "comment_id": 53488213, "body": "An interesting example application of doing things backwards: implementing <code>mapAccumR</code> for <code>Traversable</code> containers."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443464809, "post_id": 32825891, "comment_id": 53494737, "body": "I know what a <code>list</code> is, but what does <code>Nel</code> stand for?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1443465056, "post_id": 32825891, "comment_id": 53494846, "body": "A <code>Nellist</code> is a non-empty list, with a doubled L to clarify the pronunciation."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443465067, "post_id": 32825891, "comment_id": 53494852, "body": "@Bergi <code>Ne</code> looks like NotEmpty."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443465220, "post_id": 32825891, "comment_id": 53494939, "body": "@pigworker: Ah, guess I&#39;d have pronounced <code>Nelist</code> the same."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 17, "last_activity_date": 1443451684, "creation_date": 1443451684, "answer_id": 32825891, "question_id": 32823867, "link": "https://stackoverflow.com/questions/32823867/how-arbitrary-is-the-ap-implementation-for-monads/32825891#32825891", "title": "How arbitrary is the &quot;ap&quot; implementation for monads?", "body": "<p>There are at least three relevant aspects to this question.</p>\n\n<ol>\n<li><p>Given a <code>Monad m</code> instance, what is the specification of its necessary <code>Applicative m</code> superclass instance? <em>Answer</em>: <code>pure</code> is <code>return</code>, <code>&lt;*&gt;</code> is <code>ap</code>, so</p>\n\n<pre><code>mf &lt;*&gt; ms == do f &lt;- mf; s &lt;- ms; return (f s)\n</code></pre></li>\n</ol>\n\n<p>Note that this specification is not a law of the <code>Applicative</code> class. It's a requirement on <code>Monad</code>s, to ensure consistent usage patterns.</p>\n\n<ol start=\"2\">\n<li><p>Given that specification (by candidate implementation), is <code>ap</code> the only acceptable implementation. <em>Answer</em>: resoundingly, <strong>no</strong>. The value dependency permitted by the type of <code>&gt;&gt;=</code> can sometimes lead to inefficient execution: there are situations where <code>&lt;*&gt;</code> can be made more efficient than <code>ap</code> because you don't need to wait for the first computation to finish before you can tell what the second computation is. The \"applicative do\" notation exists exactly to exploit this possibility.</p></li>\n<li><p>Do any other candidate instances for <code>Applicative</code> satisfy the <code>Applicative</code> laws, even though they disagree with the required <code>ap</code> instances? <em>Answer</em>: yes. The \"backwards\" instance proposed by the question is just such a thing. Indeed, as another answer observes, any applicative can be turned backwards, and the result is often a different beast.</p></li>\n</ol>\n\n<p>For a further example and exercise for the reader, note that nonempty lists are monadic in the way familiar from ordinary lists.</p>\n\n<pre><code>  data Nellist x = x :&amp; Maybe (Nellist x)\n\n  necat :: Nellist x -&gt; Nellist x -&gt; Nellist x\n  necat (x :&amp; Nothing) ys = x :&amp; Just ys\n  necat (x :&amp; Just xs) ys = x :&amp; Just (necat xs ys)\n\n  instance Monad Nellist where\n    return x = x :&amp; Nothing\n    (x :&amp; Nothing) &gt;&gt;= k = k x\n    (x :&amp; Just xs) &gt;&gt;= k = necat (k x) (xs &gt;&gt;= k)\n</code></pre>\n\n<p>Find at least <em>four</em> behaviourally distinct instances of <code>Applicative Nellist</code> which obey the applicative laws.</p>\n"}], "owner": {"reputation": 163, "user_id": 5384226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86e0774dcb4d0dfe788a7b3ccb6c673?s=128&d=identicon&r=PG&f=1", "display_name": "Simon A.", "link": "https://stackoverflow.com/users/5384226/simon-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 2, "accepted_answer_id": 32825891, "answer_count": 2, "score": 16, "last_activity_date": 1443459984, "creation_date": 1443445841, "last_edit_date": 1443446950, "question_id": 32823867, "link": "https://stackoverflow.com/questions/32823867/how-arbitrary-is-the-ap-implementation-for-monads", "title": "How arbitrary is the &quot;ap&quot; implementation for monads?", "body": "<p>I am currently studying the bonds between monad and applicative functors.</p>\n\n<p>I see two implementation for ap:</p>\n\n<pre><code>ap m1 m2 = do { f &lt;- m1 ; x &lt;- m2 ; return (f x) }\n</code></pre>\n\n<p>and </p>\n\n<pre><code>ap m1 m2 = do { x &lt;- m2 ; f &lt;- m1 ; return (f x) }\n</code></pre>\n\n<p>The second one is different, yet, would it be a good implementation for <code>&lt;*&gt;</code> ?</p>\n\n<p>I got lost in the proof of <code>pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)</code></p>\n\n<p>I try to get an intuition of \"what part of the monad is the applicative functor\"...</p>\n"}, {"tags": ["xml", "haskell", "xsd", "haxml"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443431415, "post_id": 32817080, "comment_id": 53474514, "body": "Have you made any attempts whatsoever so far? (including failed and partial ones)"}, {"owner": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443443312, "post_id": 32817080, "comment_id": 53481369, "body": "Well, I found <a href=\"https://hackage.haskell.org/package/HaXml-1.22.4/src/src/tools/XsdToHaskell.hs\" rel=\"nofollow noreferrer\">source</a> of XsdToHaskell and the comment on the top suggests to <i>&quot;import Xsd2Haskell wherever you intend to read and write XML files with your Haskell programs&quot;</i> but I can&#39;t find that module. Also, <code>runParser</code> sais that <code>Parser x a</code> is not compatible with <code>XMLParser PlansType</code>."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "edited": false, "score": 0, "creation_date": 1443446814, "post_id": 32823285, "comment_id": 53483847, "body": "I have tried that, but I got baffled on token sequence that <code>runParser</code> is taking as an argument: <code>runParser :: Parser t a -&gt; [t] -&gt; (Either String a, [t])</code> So, according to this: <code>type XMLParser a = Parser (Content Posn) a</code> I should pass something of type like this: <code>[Content Posn]</code>, but I didn&#39;t understand how do I get that..."}, {"owner": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "edited": false, "score": 0, "creation_date": 1443457934, "post_id": 32823285, "comment_id": 53491078, "body": "Firstly I&#39;d like to mention that rudeness is not necessary. I&#39;m getting quite lost in documentation since it&#39;s very poor and I&#39;m not an expert in Haskell. Secondly, how to construct a <code>Content Posn</code> value is not a solution - I need to tokenize input document because runparser is expecting &quot;&lt;Plans&gt;&quot; as first token and so on. Is there any function to do that for me?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "edited": false, "score": 0, "creation_date": 1443503282, "post_id": 32823285, "comment_id": 53507533, "body": "mine + user5402&#39;s answers should then solve both problems?"}, {"owner": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "edited": false, "score": 1, "creation_date": 1443513188, "post_id": 32823285, "comment_id": 53512059, "body": "<code>xmlLex</code> is doing not exactly what <code>runParser</code> is expecting. For instance, tag <code>&lt;Plans&gt;</code> will be tokenized as &quot;&lt;&quot;, &quot;Plans&quot; and &quot;&gt;&quot;, when parser is expecting &quot;&lt;Plans&gt;&quot;. Also it is having troubles with &quot;&lt;?xml version=...&quot;."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 0, "last_activity_date": 1443448628, "last_edit_date": 1443448628, "creation_date": 1443444133, "answer_id": 32823285, "question_id": 32817080, "link": "https://stackoverflow.com/questions/32817080/xsdtohaskell-output-usage/32823285#32823285", "title": "XsdToHaskell output usage", "body": "<p>Having done some searching on <a href=\"http://hayoo.fh-wedel.de/?query=XMLParser\" rel=\"nofollow\">Hayoo</a>, it seems that <code>XMLParser PlansType</code> is the same as <code>Parser (Content Posn) PlansType</code>:</p>\n\n<pre><code>type XMLParser a = Parser (Content Posn) a\n</code></pre>\n\n<p>according to <a href=\"http://hackage.haskell.org/package/HaXml-1.25.3/docs/Text-XML-HaXml-XmlContent-Parser.html#t:XMLParser\" rel=\"nofollow\">http://hackage.haskell.org/package/HaXml-1.25.3/docs/Text-XML-HaXml-XmlContent-Parser.html#t:XMLParser</a>.</p>\n\n<p>Which in turn lead me to <a href=\"http://hackage.haskell.org/package/polyparse-1.11/docs/Text-ParserCombinators-Poly-Plain.html\" rel=\"nofollow\">http://hackage.haskell.org/package/polyparse-1.11/docs/Text-ParserCombinators-Poly-Plain.html</a> (and <a href=\"http://hackage.haskell.org/package/polyparse-1.11/docs/Text-ParserCombinators-Poly-Lazy.html\" rel=\"nofollow\">the lazy version</a> thereof) \u2014 which has a <code>runParser</code> function.</p>\n\n<hr>\n\n<p>Re: your comment: the types in the documentation are clickable, i.e. you can navigate to them and try to understand them:</p>\n\n<p>clicking on <code>Content</code> takes you <a href=\"http://hackage.haskell.org/package/HaXml-1.25.3/docs/Text-XML-HaXml-XmlContent-Parser.html#t:Content\" rel=\"nofollow\">here</a>. From there it's obvious that in order to pass in a <code>String</code> (<code>[t]</code> where <code>t ~ Char</code>), you need to construct a <code>Content</code> value using <code>CString Bool CharData i</code>. The bool specifies whether whitespace is significant; <code>CharData</code> is an alias for <code>String</code>, and the <code>i</code> is a value of type <code>Posn</code> in your case.</p>\n\n<p>In order to construct a <code>Posn</code> value, click on <a href=\"http://hackage.haskell.org/package/HaXml-1.25.3/docs/Text-XML-HaXml-Posn.html#t:Posn\" rel=\"nofollow\">Posn</a>; you'll see there's a function <code>noPos</code> which you can use to construct a value of type <code>Posn</code> (assuming you don't care about locations in error reporting for the time being).</p>\n\n<p>All in all: <code>CString False \"bla bla bla\" noPos</code> or <code>CString True \"bla bla bla\" noPos</code> should get you started.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1443449653, "creation_date": 1443449653, "answer_id": 32825244, "question_id": 32817080, "link": "https://stackoverflow.com/questions/32817080/xsdtohaskell-output-usage/32825244#32825244", "title": "XsdToHaskell output usage", "body": "<p>I would look at the <code>htmlParse'</code> routine in module Text.XML.HaXml.Html.Parse for ideas:</p>\n\n<pre><code>-- | The first argument is the name of the file, the second is the string\n--   contents of the file.  The result is the generic representation of\n--   an XML document.  Any parsing errors are returned in the @Either@ type.\nhtmlParse' :: String -&gt; String -&gt; Either String (Document Posn)\nhtmlParse' file = Prelude.either Left (Right . simplify) . fst\n                  . runParser document . xmlLex file\n</code></pre>\n\n<p>It looks like the <code>xmlLex</code> function is used to tokenize a String and then <code>runParser</code> is used to for parsing.</p>\n\n<p>In that module, <code>document</code> has type:</p>\n\n<pre><code>document :: HParser (Document Posn)\ntype HParser a = Parser (Posn,TokenT) a\n</code></pre>\n\n<p>which looks like it uses the same <code>Parser</code> type that <code>XMLParser</code> uses.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "is_accepted": true, "score": 0, "last_activity_date": 1443594238, "creation_date": 1443594238, "answer_id": 32859173, "question_id": 32817080, "link": "https://stackoverflow.com/questions/32817080/xsdtohaskell-output-usage/32859173#32859173", "title": "XsdToHaskell output usage", "body": "<p>The following solves the problem:<br/></p>\n\n<pre><code>xmlText &lt;- readFile fname\nlet (Document _ _ root _) = xmlParse \"(No Document)\" xmlText\nlet (Right plans) = fst $ runParser elementPlans [CElem root noPos]\n</code></pre>\n\n<p>In the first line we read xml file content as string, then <code>xmlParse</code> returns document with root element of type <code>Element</code> which we use to create single token of type <code>CElem</code> and then run parser, generated by XsdToHaskell.</p>\n"}], "owner": {"reputation": 63, "user_id": 2665733, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000264148798/picture?type=large", "display_name": "Vitalii Kozhukhivskyi", "link": "https://stackoverflow.com/users/2665733/vitalii-kozhukhivskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 1, "accepted_answer_id": 32859173, "answer_count": 3, "score": 2, "last_activity_date": 1443594238, "creation_date": 1443422662, "last_edit_date": 1443431360, "question_id": 32817080, "link": "https://stackoverflow.com/questions/32817080/xsdtohaskell-output-usage", "title": "XsdToHaskell output usage", "body": "<p>I have generated Haskell data types from XSD using the XsdToHaskell tool embedded in the HaXml library.\nAnd now I have a bunch of data types and seem-to-be parsers for those datatypes.\nBut the main function in the output file (<code>elementPlans</code>) is returning <code>XMLParser PlansType</code> (<code>PlansType</code> is the type of the root element in XML) and I have no idea how to parse the XML file having this parser.</p>\n\n<p>Here's <a href=\"http://pastebin.com/m6Qzsd8t\" rel=\"nofollow\">Plans.hs</a> (output of XmlToHaskell), <a href=\"http://pastebin.com/SH8vZfe3\" rel=\"nofollow\">XSD</a> and <a href=\"http://pastebin.com/7zQFteZJ\" rel=\"nofollow\">XML</a>.</p>\n"}, {"tags": ["haskell", "ghc-mod"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443431456, "post_id": 32814349, "comment_id": 53474538, "body": "perhaps you could post the (relevant bits of) your <code>.cabal</code> file?"}], "owner": {"reputation": 21, "user_id": 5382897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b10dbd1de51c9def3bbb6cb51eec17?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/5382897/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443401260, "creation_date": 1443401260, "question_id": 32814349, "link": "https://stackoverflow.com/questions/32814349/ghc-mod-change-default-target", "title": "Ghc mod: change default target", "body": "<p>Is there a way to change ghc-mod's target? </p>\n\n<p>I have a cabal file with two sections: a library target, and a tests target. Ghc detects modules for packages in the library target correctly. </p>\n\n<p>However, if I add a package only to the tests target (such as QuickCheck), it will flag the \"import\" as an error. Any workarounds for that?</p>\n"}, {"tags": ["list", "haskell", "tuples", "grouping"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1443401312, "post_id": 32814305, "comment_id": 53465147, "body": "Have you tried using <code>groupBy</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1443422335, "post_id": 32815675, "comment_id": 53470022, "body": "<code>groupBy ((==) `on` fst)</code>"}, {"owner": {"reputation": 15219, "user_id": 1272950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1MQy.jpg?s=128&g=1", "display_name": "y\u01dds\u029e\u01ddla", "link": "https://stackoverflow.com/users/1272950/y%c7%9ds%ca%9e%c7%9dla"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443422571, "post_id": 32815675, "comment_id": 53470109, "body": "Nice simplification @dfeuer. Updated my answer"}], "tags": [], "owner": {"reputation": 15219, "user_id": 1272950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1MQy.jpg?s=128&g=1", "display_name": "y\u01dds\u029e\u01ddla", "link": "https://stackoverflow.com/users/1272950/y%c7%9ds%ca%9e%c7%9dla"}, "is_accepted": true, "score": 9, "last_activity_date": 1443422640, "last_edit_date": 1443422640, "creation_date": 1443414338, "answer_id": 32815675, "question_id": 32814305, "link": "https://stackoverflow.com/questions/32814305/group-a-list-of-tuples-by-their-1st-element/32815675#32815675", "title": "Group a list of tuples by their 1st element", "body": "<p>Use <code>Data.List</code> <code>groupBy</code> function (<a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html\">docs</a>):</p>\n\n<pre><code>Prelude&gt; import Data.List\nPrelude Data.List&gt; let xs = [(\"ab\", 1), (\"ab\", 2), (\"ac\", 3)]\nPrelude Data.List&gt; groupBy (\\a b -&gt; fst a == fst b) xs\n[[(\"ab\",1),(\"ab\",2)],[(\"ac\",3)]]\n</code></pre>\n\n<p>or as suggested by @dfeuer:</p>\n\n<pre><code>...\nimport Data.Function\ngroupBy ((==) `on` fst) xs\n</code></pre>\n"}], "owner": {"reputation": 1055, "user_id": 3326720, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SeWCu.png?s=128&g=1", "display_name": "Orange Receptacle", "link": "https://stackoverflow.com/users/3326720/orange-receptacle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2270, "favorite_count": 1, "accepted_answer_id": 32815675, "answer_count": 1, "score": 7, "last_activity_date": 1443431757, "creation_date": 1443400809, "last_edit_date": 1443431757, "question_id": 32814305, "link": "https://stackoverflow.com/questions/32814305/group-a-list-of-tuples-by-their-1st-element", "title": "Group a list of tuples by their 1st element", "body": "<p>Say I have a tuple list that consists of <code>[(\"ab\", 1), (\"ab\", 2), (\"ac\", 3)]</code></p>\n\n<p>Using the <code>group</code> function would split this list into a list of lists of tuples like so:</p>\n\n<pre><code>[\n  [(\"ab\", 1)],\n  [(\"ab\", 2)],\n  [(\"ac\", 3)]\n]\n</code></pre>\n\n<p>How would you group the tuple ignoring one of the indices so that they'd be grouped based on one of the elements:</p>\n\n<pre><code>[\n  [(\"ab\", 1), (\"ab\", 2)],\n  [(\"ac\", 3]\n]\n</code></pre>\n\n<p>Would the <code>groupBy</code> function be needed in this case?</p>\n"}, {"tags": ["haskell", "primes"], "comments": [{"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 0, "creation_date": 1443404165, "post_id": 32814289, "comment_id": 53465740, "body": "Have you tried profiling on a smaller input size (primes below 1000 for example) and seeing which function is taking the most time?"}, {"owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "reply_to_user": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 0, "creation_date": 1443405410, "post_id": 32814289, "comment_id": 53465974, "body": "Yeah, it looks like it&#39;s slicedChains and maybe the double call of primeChain. I&#39;m just not entirely sure how to avoid them."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443423165, "post_id": 32814289, "comment_id": 53470375, "body": "You probably want to use a sieve to make a vector (or even a list) of all the primes up to a million and then you probably want to shove those into an <code>IntSet</code>. The vector of primes will let you sum up consecutive ones really easily, while the <code>IntSet</code> will make it easy to check if a number is prime."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1443541678, "post_id": 32814289, "comment_id": 53530579, "body": "a suboptimal <code>isPrime</code> could easily be a culprit. why should it be left out? it shouldn&#39;t."}, {"owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "edited": false, "score": 0, "creation_date": 1443581245, "post_id": 32814289, "comment_id": 53547387, "body": "I&#39;ve included my isPrime function. It seems that it runs in linear time if I&#39;m calculating it correctly."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443662825, "post_id": 32814289, "comment_id": 53587126, "body": "you where right, it almost doesn&#39;t matter, though your code is very slow, <i>quadratic</i> (not linear by a long shot); yet even with it the solution can be found in few seconds (NB @dfeuer re: sieve -- normal TD is more than adequate here, it turns out)."}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "edited": false, "score": 0, "creation_date": 1443412254, "post_id": 32815150, "comment_id": 53467317, "body": "Thanks. What sort of structure or function would I be using to do the interleaving and tracking? I assume it&#39;d be some kind of map."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 6, "last_activity_date": 1443413836, "last_edit_date": 1443413836, "creation_date": 1443409581, "answer_id": 32815150, "question_id": 32814289, "link": "https://stackoverflow.com/questions/32814289/project-euler-50-algorithm-is-incredibly-slow-failing-to-understand-why/32815150#32815150", "title": "Project Euler 50: Algorithm is incredibly slow, failing to understand why", "body": "<p>Your basic problem is that you are not pruning your search space based on the best solution you have found so far.</p>\n\n<p>I can tell this just from the fact that you are using <code>maximumBy</code> to find the longest sequence.</p>\n\n<p>For instance, if during your search your find a consecutive sequence of 4 primes whose sum is a prime &lt; 10^6, you don't have to examine any sequence which begins with a prime greater than 250000.</p>\n\n<p>To do this kind of pruning you have to keep track of the solution found so far and interleave the testing of candidate sequences with their generation so that the best solution found so far can stop the search early.</p>\n\n<p><strong>Update</strong></p>\n\n<p>There are several inefficiencies in <code>slicedChains</code>. Haskell lists are implemented a linked lists. This video is pretty good overview of linked lists and how they differ from arrays: <a href=\"https://www.youtube.com/watch?v=pBrz9HmjFOs\">(link)</a></p>\n\n<p>The following expressions in your code are going to be problematic w.r.t. efficiency:</p>\n\n<p><strong>*</strong> <code>nub</code> has quadratic running time</p>\n\n<p><strong>*</strong> <code>length x &gt; 1</code> - the complexity of <code>length</code> is O(n) where n is the length of the list. A better way to write this is:</p>\n\n<pre><code>lengthGreaterThan1 :: [a] -&gt; Bool\nlengthGreaterThan1 (_:_:_) = True\nlengthGreaterThan1 _       = False\n</code></pre>\n\n<p><strong>*</strong> <code>subsequencesOfSize 2 [1..len]</code> may be more succinctly written:</p>\n\n<pre><code>[ [a,b] | a &lt;- [1..len], b &lt;- [a+1..len] ]\n</code></pre>\n\n<p>and this will also ensure that a &lt; b.</p>\n\n<p><strong>*</strong> The <code>take</code> and <code>drop</code> calls in <code>slice</code> are also O(n) </p>\n\n<p><strong>*</strong> In <code>primeSums</code> the call to <code>primeChain</code> will regenerate essentially the same list over and over again resulting in a lot of multiple calls to <code>isPrime</code>. A better approach is to define <code>primeChain</code> like this:</p>\n\n<pre><code>allPrimes = filter isPrime [1..]\n\nprimeChain x = takeWhile (&lt;= x) allPrimes\n</code></pre>\n\n<p>The list <code>allPrimes</code> will be generated once, and <code>primeChain</code> simply takes prefixes of that list.</p>\n\n<p><strong>*</strong> <code>primeSums x</code> is charged with finding sequences whose sum is <em>exactly</em> x, but it looks at a lot of sequences that can't possibly work. For instance, <code>primeSums 31</code> will examine:</p>\n\n<pre><code>11 + 13 + 17, 11 + 13 + 17 + 23, 11 + 13 + 17 + 23 + 29,\n17 + 19, 17 + 19 + 23, 17 + 19 + 23 + 29,\n19 + 23, 19 + 23 + 29\n23 + 29\n</code></pre>\n\n<p>even though it's pretty obvious that none of these sums could equal 31.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1443663319, "post_id": 32836363, "comment_id": 53587236, "body": "turns out, lists are fast enough here; though I couldn&#39;t include the code in my answer because that&#39;s PE after all."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 2, "last_activity_date": 1443504900, "creation_date": 1443504900, "answer_id": 32836363, "question_id": 32814289, "link": "https://stackoverflow.com/questions/32814289/project-euler-50-algorithm-is-incredibly-slow-failing-to-understand-why/32836363#32836363", "title": "Project Euler 50: Algorithm is incredibly slow, failing to understand why", "body": "<p>So the first thing you need is a good data structure: Once you find a sequence of length <code>n</code> you don't care about sequences of shorter length, so your primary needs are: (1) tracking the sum, (2) tracking the primes in the set, (3) removing the least element, (4) adding a new greatest element. The key is <strong>amortization</strong>, where a big cost is paid infrequently enough that you can pretend it is a small cost per procedure. The data structure looks like this:</p>\n\n<pre><code>data Queue x = Q [x] [x]\nq_empty (Q [] []) = True\nq_empty _ = False\n\nq_headtails (Q (x:xs) rest) = (x, Q xs rest)\nq_headtails (Q [] xs) = case reverse xs of y:ys -&gt; (y, Q ys [])\n                                           []   -&gt; error \"End of queue.\"\n\nq_append el (Q beg end) = Q beg (el:end)\n</code></pre>\n\n<p>So deconstructing the list is possible, but sometimes triggers an O(n) operation, but that's OK because when it does, we won't have to do it for another <code>n</code> steps, so it averages out to one operation per step. (You might also want to do it with a spine-strict list.)</p>\n\n<p>To save on length operations and summing the items of the list you probably want to cache those, too:</p>\n\n<pre><code>type Length = Int\ntype Sum = Int\ntype Prime = Int\ndata PrimeSeq = PS Length Sum (Queue Prime)\n\nheadTails (PS len sum q) = (x, PS (len - 1) (sum - x) xs)\n  where (x, xs) = q_headtails q\n\nappend x (PS len sum xs) = PS (len + 1) (sum + x) (q_append x xs)\n</code></pre>\n\n<p>The algorithm for these looks like:</p>\n\n<ol>\n<li>Cache a copy of the PrimeSeq you're starting with</li>\n<li>Keep adding primes to it and testing primality until you get to 10^6.</li>\n<li>If you find a new prime with a longer sequence, replace the cache.</li>\n<li>Whenever you run into 10^6, revert to the cache, pull a prime off the front of the queue, then repeat as needed.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "edited": false, "score": 0, "creation_date": 1443730536, "post_id": 32878058, "comment_id": 53621519, "body": "Alright, thanks. What&#39;s the difference between rem and mod?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "edited": false, "score": 1, "creation_date": 1443733184, "post_id": 32878058, "comment_id": 53622828, "body": "@thespectre if both arguments are positive, there&#39;s no difference. but <code>rem</code> sometimes is faster."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1443664222, "last_edit_date": 1443664222, "creation_date": 1443662565, "answer_id": 32878058, "question_id": 32814289, "link": "https://stackoverflow.com/questions/32814289/project-euler-50-algorithm-is-incredibly-slow-failing-to-understand-why/32878058#32878058", "title": "Project Euler 50: Algorithm is incredibly slow, failing to understand why", "body": "<p>Your prime generation is quadratic (<code>isPrime 101</code> tests <code>rem 101 100 == 0</code> even though <em>10</em> is the biggest number by which <em>101</em> needs to be tested -- and actually <em>7</em> is enough). </p>\n\n<p>Yet even with it, a simple enough <strong><em>list-based</em></strong> code finds the answer in under <em>2</em> seconds (on an Intel Core i7 2.5 GHz, <strong><em>interpreted</em></strong> in GHCi). And with the code corrected to take advantage of the above mentioned optimization (and additionally, testing by primes only), it takes <em>0.1s</em>.</p>\n\n<p>Also, <code>f x | t = False | otherwise = True</code> is the same as <code>f x = not t</code>.</p>\n\n<p>We are asked by the PE site not to give you even a hint. </p>\n\n<p>But in general, the key to efficiency in Haskell, thanks to its laziness, is being <strong><em>generative</em></strong> with as small a duplication of effort as possible. As one example, instead of calculating each slice of a list in isolation starting anew, we can produce the bunch of them together as part of one process,</p>\n\n<pre><code> slices :: Int -&gt; [a] -&gt; [[a]]\n slices n = map (take n) . iterate tail -- sequence of list's slices of length n each\n</code></pre>\n\n<p>Another principle is, try to solve a more <strong><em>general</em></strong> problem, of which yours is an instance.</p>\n\n<p>Having written such a function, we can play with it by trying out different values for its parameters, from smaller to the bigger ones, for an exploratory style of problem solving. We're told about <em>21</em> consecutive primes. What about <em>22</em> of them? <em>27</em>? <em>1127</em> of them? ... and I've said enough about this already.</p>\n\n<p>If it starts taking too much time, we can assess the full solution's needed run time by <a href=\"http://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth\" rel=\"nofollow\">empirical orders of growth</a> analysis. </p>\n\n<p>Though the solution is found quickly enough with your unoptimized <code>isPrime</code> code, the exploratory process can be prohibitively slow with it, but it is fast enough with the optimized code:</p>\n\n<pre><code> primes :: [Int]\n primes = 2 : filter isPrime [3,5..]\n isPrime n = and [rem n p &gt; 0 | p &lt;- takeWhile ((&lt;= n).(^2)) primes]\n</code></pre>\n"}], "owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 2, "accepted_answer_id": 32815150, "answer_count": 3, "score": 3, "last_activity_date": 1443664222, "creation_date": 1443400565, "last_edit_date": 1443581217, "question_id": 32814289, "link": "https://stackoverflow.com/questions/32814289/project-euler-50-algorithm-is-incredibly-slow-failing-to-understand-why", "title": "Project Euler 50: Algorithm is incredibly slow, failing to understand why", "body": "<p>I'm using Project Euler to learn Haskell. I'm new at Haskell and am having a lot of trouble coming up with an algorithm that doesn't take an absurd amount of time. I'm estimating that the program here would take 14 gigayears to arrive at the solution.</p>\n\n<p>The problem:</p>\n\n<blockquote>\n  <p>Which prime, below one-million, can be written as the sum of the most\n  consecutive primes?</p>\n</blockquote>\n\n<p>Here's my source. I've left out isPrime. I've posted it because it's far too inefficient to solve the problem. I think the issue lies with the slicedChains and primeChains calls, but I'm not sure what it is. I've resolved this before with C++. But for whatever reason, the efficient solution seems beyond me in Haskell.</p>\n\n<p>Edit: I've included isPrime.</p>\n\n<pre><code>import System.Environment (getArgs)\nimport Data.List (nub,maximumBy)\nimport Data.Ord (comparing)\n\nisPrime :: Integer -&gt; Bool\nisPrime 1 = False\nisPrime 2 = True\nisPrime x\n        | any (== 0) (fmap (x `mod`) [2..x-1]) = False\n        | otherwise = True\n\nprimeChain :: Integer -&gt; [Integer]\nprimeChain x = [ n | n &lt;- 1 : 2 : [3,5..x-1], isPrime n ]\n\nslice :: [a] -&gt; [Int] -&gt; [a]\nslice xs args = take (to - from + 1) (drop from xs)\n    where from = head args\n          to = last args\n\nsubsequencesOfSize :: Int -&gt; [a] -&gt; [[a]]\nsubsequencesOfSize n xs = let l = length xs\n                          in if n&gt;l then [] else subsequencesBySize xs !! (l-n)\n    where\n        subsequencesBySize [] = [[[]]]\n        subsequencesBySize (x:xs) = let next = subsequencesBySize xs\n                                    in zipWith (++) ([]:next) (map (map (x:)) next ++ [[]])\n\nslicedChains :: Int -&gt; [Integer] -&gt; [[Integer]]\nslicedChains len xs = nub [x | x &lt;- fmap (xs `slice`) subseqs, length x &gt; 1]\n    where subseqs = [x | x &lt;- (subsequencesOfSize 2 [1..len]), (last x) &gt; (head x)]\n\nprimeSums :: Integer -&gt; [[Integer]]\nprimeSums x = filter (\\ns -&gt; sum ns == x) chain\n    where xs = primeChain x\n          len = length xs\n          chain = slicedChains len xs\n\ncompLength :: [[a]] -&gt; [a]\ncompLength xs = maximumBy (comparing length) xs\n\ncleanSums :: [Integer] -&gt; [[Integer]]\ncleanSums xs = fmap (compLength) filtered\n    where filtered = filter (not . null) (fmap primeSums xs)\n\nmain :: IO()\nmain = do\n    args &lt;- getArgs\n    let arg = read (head args) :: Integer\n    let xs = primeChain arg\n    print $ maximumBy (comparing length) $ cleanSums xs\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1443440037, "last_edit_date": 1495542144, "creation_date": 1443401257, "answer_id": 32814348, "question_id": 32814151, "link": "https://stackoverflow.com/questions/32814151/maybets-m-in-type-signature/32814348#32814348", "title": "MaybeT&#39;s m in Type Signature", "body": "<blockquote>\n  <p>can <code>m</code> be any higher-kinded type, i.e. <code>* -&gt; *</code>?</p>\n</blockquote>\n\n<p>It can be anything with kind <code>* -&gt; *</code>. Other than that, there are no restrictions in principle.</p>\n\n<blockquote>\n  <p>why the <code>m</code> did not have a constraint of <code>Monad</code>.</p>\n</blockquote>\n\n<p>The constraint is provided through the types of the functions that use <code>MaybeT</code>, rather than through the <code>MaybeT</code> constructor. Adding constraints to constructors is not useful unless GADTs are involved (I believe <em>transformers</em> does not use GADTs for the sake of simplicity and compliance to the standard). See <a href=\"https://stackoverflow.com/q/18934882/2751851\">this question and its answers</a> for extra commentary on constraints and datatype declarations.</p>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 4, "last_activity_date": 1443401741, "last_edit_date": 1592644375, "creation_date": 1443401303, "answer_id": 32814356, "question_id": 32814151, "link": "https://stackoverflow.com/questions/32814151/maybets-m-in-type-signature/32814356#32814356", "title": "MaybeT&#39;s m in Type Signature", "body": "<p>To quote <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#type-parameters\" rel=\"nofollow noreferrer\">Learn You A Haskell</a>:</p>\n<blockquote>\n<p>Another example of a parameterized type that we've already met is <strong><code>Map k v</code></strong> from <strong><code>Data.Map</code></strong>. The <strong><code>k</code></strong> is the type of the keys in a map and the <strong><code>v</code></strong> is the type of the values. This is a good example of where type parameters are very useful. Having maps parameterized enables us to have mappings from any type to any other type, as long as the type of the key is part of the <strong><code>Ord</code></strong> type class. If we were defining a mapping type, we could add a type class constraint in the <em>data</em> declaration:</p>\n<pre><code>data (Ord k) =&gt; Map k v = ...\n</code></pre>\n<p>However, it is a very strong convention in Haskell to <strong>never add type class constraints in data declarations</strong>. Why? Well, because we don't benefit a lot, but we end up writing more class constraints, even when we don't need them. If we put or don't put the <strong><code>Ord k</code></strong> constraint in the <em>data</em> declaration for <strong><code>Map k v</code></strong>, we're going to have to put the constraint into functions that assume the keys in a map can be ordered. But if we don't put the constraint in the data declaration, we don't have to put <strong><code>(Ord k) =&gt;</code></strong> in the type declarations of functions that don't care whether the keys can be ordered or not. An example of such a function is <strong><code>toList</code></strong>, that just takes a mapping and converts it to an associative list. It's type signature is <strong><code>toList :: Map k a -&gt; [(k, a)]</code></strong>. If <strong><code>Map k v</code></strong> had a type constraint in its <em>data</em> declaration, the type for <strong><code>toList</code></strong> would have to be <strong><code>toList :: Ord k =&gt; Map k a -&gt; [(k, a)]</code></strong>, even though the function doesn't do any comparing of keys by order.</p>\n<p>So don't put type constraints into <em>data</em> declarations even if it seems to make sense, because you'll have to put them into the function type declarations either way.</p>\n</blockquote>\n<p>I hope that answers your question. Although the <code>m</code> in <code>MaybeT m a</code> is unconstrained yet there is an implicit assumption that <code>m</code> is an instance of <code>Monad</code>. In fact, if <code>m</code> is not an instance of <code>Monad</code> then you wouldn't be able to do much with a <code>MaybeT m a</code> value because most functions would require that <code>m</code> be an instance of <code>Monad</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1443435890, "creation_date": 1443435890, "answer_id": 32820742, "question_id": 32814151, "link": "https://stackoverflow.com/questions/32814151/maybets-m-in-type-signature/32820742#32820742", "title": "MaybeT&#39;s m in Type Signature", "body": "<blockquote>\n  <p>In <code>MaybeT</code>'s signature, can <code>m</code> be any higher-kinded type, i.e. <code>* -&gt; *</code>?</p>\n</blockquote>\n\n<p>No:</p>\n\n<pre><code>&gt; :k MaybeT\nMaybeT :: (* -&gt; *) -&gt; * -&gt; *\n</code></pre>\n\n<p>So, the <code>m</code> in the type <code>MaybeT m a</code> <em>must</em> be exactly of kind <code>* -&gt; *</code>, and not of any other kind.</p>\n\n<p>For instance, note the kind error below:</p>\n\n<pre><code>&gt; :k MaybeT (State Int)\nMaybeT (State Int) :: * -&gt; *\n\n&gt; :k MaybeT State\n    Expecting one more argument to \u2018State\u2019\n    The first argument of \u2018MaybeT\u2019 should have kind \u2018* -&gt; *\u2019,\n      but \u2018State\u2019 has kind \u2018* -&gt; * -&gt; *\u2019\n    In a type in a GHCi command: MaybeT (State)\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 32814356, "answer_count": 3, "score": 2, "last_activity_date": 1443440037, "creation_date": 1443399096, "question_id": 32814151, "link": "https://stackoverflow.com/questions/32814151/maybets-m-in-type-signature", "title": "MaybeT&#39;s m in Type Signature", "body": "<p>Looking at <code>MaybeT</code>:</p>\n\n<pre><code>\u03bb: import Monad.Trans\n\u03bb: import Monad.Trans.Maybe\n\u03bb: :t MaybeT\nMaybeT :: m (Maybe a) -&gt; MaybeT m a\n</code></pre>\n\n<p>In <code>MaybeT</code>'s signature, can <code>m</code> be any higher-kinded type, i.e. <code>* -&gt; *</code>?</p>\n\n<p>I'm trying to learn Monad Transformers, so I was curious why the <code>m</code> did not have a constraint of <code>Monad</code>.</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1443419259, "post_id": 32813797, "comment_id": 53468938, "body": "Consider using attoparsec, it is much faster and supports partial matches."}, {"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1443419908, "post_id": 32813797, "comment_id": 53469141, "body": "I&#39;m not parsing big files or anything like that, and as I understand, Parsec offers an easier <i>interface</i>. I use Parsec because of <a href=\"http://stackoverflow.com/a/19213247/1276441\">this answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 0, "creation_date": 1443419991, "post_id": 32814022, "comment_id": 53469170, "body": "This would work for getting the input only on parses that succeed. I would like a way to get the input in either case."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1443397801, "creation_date": 1443397801, "answer_id": 32814022, "question_id": 32813797, "link": "https://stackoverflow.com/questions/32813797/get-parsecs-left-input/32814022#32814022", "title": "Get Parsec&#39;s left input", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/parsec-3.1.9/docs/Text-ParserCombinators-Parsec-Prim.html#v:getInput\" rel=\"nofollow\"><code>getInput</code></a>, which is a parser that returns the remaining input.</p>\n"}, {"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": false, "score": 0, "last_activity_date": 1443467811, "creation_date": 1443467811, "answer_id": 32830195, "question_id": 32813797, "link": "https://stackoverflow.com/questions/32813797/get-parsecs-left-input/32830195#32830195", "title": "Get Parsec&#39;s left input", "body": "<p>I dug a bit into Parsec's internals and I wasn't able to find an easy way to recover the state information (which contains the stream).</p>\n\n<p>An ad hoc solution would be to examine the error that you receive and then use its location information to deduce where the parsing had stopped.  (Of course, this would only work if your stream supports seeking.)</p>\n"}, {"comments": [{"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 0, "creation_date": 1451668144, "post_id": 34557981, "comment_id": 56859504, "body": "I was the one who asked for this feature, I am using it."}], "tags": [], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "is_accepted": true, "score": 0, "last_activity_date": 1451666731, "creation_date": 1451666731, "answer_id": 34557981, "question_id": 32813797, "link": "https://stackoverflow.com/questions/32813797/get-parsecs-left-input/34557981#34557981", "title": "Get Parsec&#39;s left input", "body": "<p>Take a look at <a href=\"https://hackage.haskell.org/package/megaparsec\" rel=\"nofollow\">Megaparsec</a>\n\u2014 a modern fork of Parsec, beginning from version 4.2.0 it allows to supply\ncustom state at the beginning of parsing and extract parser state at the end (it\ndoesn't matter if parser succeeds or fails). This allows to partially parse\ninput, resume parsing, specify non-standard initial textual position,\netc. See\n<a href=\"https://hackage.haskell.org/package/megaparsec-4.2.0/docs/Text-Megaparsec.html#v:runParser-39-\" rel=\"nofollow\"><code>runParser'</code></a>\nand\n<a href=\"https://hackage.haskell.org/package/megaparsec-4.2.0/docs/Text-Megaparsec.html#v:runParserT-39-\" rel=\"nofollow\"><code>runParserT'</code></a>.</p>\n\n<hr>\n\n<p>Disclosure: I'm one of the authors of Megaparsec.</p>\n"}], "owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 34557981, "answer_count": 3, "score": 5, "last_activity_date": 1451666731, "creation_date": 1443395612, "question_id": 32813797, "link": "https://stackoverflow.com/questions/32813797/get-parsecs-left-input", "title": "Get Parsec&#39;s left input", "body": "<p>I was wondering if there's a way to get te remaining input from Parsec after it stops parsing, either if it was a successful or failed parse, maybe this signature:</p>\n\n<pre><code>parseRemaining :: Stream s Identity t =&gt; Parsec s () a -&gt; SourceName -&gt; s -&gt; (s, Either ParseError a)\n</code></pre>\n\n<p>Where we get instead of an <code>Either ParseError a</code>, we additionally get the remaining <code>Stream s</code></p>\n"}, {"tags": ["string", "haskell", "filter", "split"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1443396773, "post_id": 32813728, "comment_id": 53464327, "body": "see <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:group\" rel=\"nofollow noreferrer\">Data.List.group</a>. perhaps you will need <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:sort\" rel=\"nofollow noreferrer\"><code>Data.List.sort</code></a> as well."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 3, "last_activity_date": 1443397821, "creation_date": 1443397821, "answer_id": 32814026, "question_id": 32813728, "link": "https://stackoverflow.com/questions/32813728/how-do-you-split-a-string-list-to-find-all-duplicates-in-haskell/32814026#32814026", "title": "How do you split a string list to find all duplicates in Haskell?", "body": "<p>If you want to group consecutive values by equality as in your example input this will do</p>\n\n<pre><code>Prelude&gt; Data.List.group [\"one\", \"one\", \"two\", \"three\", \"three\", \"three\"]                               \n[[\"one\",\"one\"],[\"two\"],[\"three\",\"three\",\"three\"]]\n</code></pre>\n\n<p>otherwise, you may want to sort the list to get equal values next to each other.</p>\n"}], "owner": {"reputation": 1055, "user_id": 3326720, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SeWCu.png?s=128&g=1", "display_name": "Orange Receptacle", "link": "https://stackoverflow.com/users/3326720/orange-receptacle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 32814026, "answer_count": 1, "score": 1, "last_activity_date": 1443397821, "creation_date": 1443394863, "question_id": 32813728, "link": "https://stackoverflow.com/questions/32813728/how-do-you-split-a-string-list-to-find-all-duplicates-in-haskell", "title": "How do you split a string list to find all duplicates in Haskell?", "body": "<p>Say I have a [String] of <code>[\"one\", \"one\", \"two\", \"three\", \"three\", \"three\"]</code></p>\n\n<p>How would I go about splitting this [String] into a [[String]] of</p>\n\n<p><code>[[\"one\", \"one\"], [\"two\"], [\"three\", \"three\", \"three\"]]</code></p>\n\n<p>Thanks for your time</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1554, "user_id": 809015, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ba778facbad1e33e940db4a99826b1ca?s=128&d=identicon&r=PG", "display_name": "Michael Taufen", "link": "https://stackoverflow.com/users/809015/michael-taufen"}, "edited": false, "score": 0, "creation_date": 1443395894, "post_id": 32813604, "comment_id": 53464159, "body": "This seems like it accomplishes what I want. I wasn&#39;t aware that it was possible to associate a type synonym with a type class like you can a type family, that&#39;s a pretty cool technique. Thank you :)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 1554, "user_id": 809015, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ba778facbad1e33e940db4a99826b1ca?s=128&d=identicon&r=PG", "display_name": "Michael Taufen", "link": "https://stackoverflow.com/users/809015/michael-taufen"}, "edited": false, "score": 3, "creation_date": 1443405501, "post_id": 32813604, "comment_id": 53465995, "body": "@MichaelTaufen Just a note, <code>type V l :: *</code> <i>is</i> a type family, not a simple type synonym, whose index is <code>l</code> - because this type variable is bound in the class head. There is no difference between <code>class C x where type V x</code> and <code>class C x; type family V x</code>, other than the compiler reminding you to write an instance for <code>V</code> when you do so for <code>C</code>."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 3, "last_activity_date": 1443393784, "creation_date": 1443393784, "answer_id": 32813604, "question_id": 32813288, "link": "https://stackoverflow.com/questions/32813288/specifying-the-return-type-of-a-method-of-a-type-class-instance-based-on-the-typ/32813604#32813604", "title": "Specifying the return type of a method of a type class instance based on the type contained by the associated type family instance", "body": "<p>I'm not totally sure I understand what you want, but maybe this?</p>\n\n<pre><code>class TC (l :: Symbol) where\n  data T l :: *\n  type V l :: *\n  label :: T l -&gt; String\n  val :: T l -&gt; V l\n\ninstance TC \"age\" where\n  data T \"age\" = T___age Int\n  type V \"age\" = Int\n  label x = \"age\"\n  val (T___age x) = x\n</code></pre>\n"}], "owner": {"reputation": 1554, "user_id": 809015, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ba778facbad1e33e940db4a99826b1ca?s=128&d=identicon&r=PG", "display_name": "Michael Taufen", "link": "https://stackoverflow.com/users/809015/michael-taufen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 32813604, "answer_count": 1, "score": 0, "last_activity_date": 1443393784, "creation_date": 1443391185, "question_id": 32813288, "link": "https://stackoverflow.com/questions/32813288/specifying-the-return-type-of-a-method-of-a-type-class-instance-based-on-the-typ", "title": "Specifying the return type of a method of a type class instance based on the type contained by the associated type family instance", "body": "<p>As part of a thought experiment,\nI'm trying to enforce the following properties\nfor a type family T associated with type class TC\nin Haskell:</p>\n\n<ol>\n<li>Members of family T with different labels are different types.</li>\n<li>All T with the same label contain the same type of value.\n(i.e. the label string implies the return type of <code>val</code>)</li>\n</ol>\n\n<p>with the following feature:</p>\n\n<ol>\n<li>The string representation of the label of a T can be viewed at runtime, but not changed at runtime.</li>\n</ol>\n\n<p>Any ideas?</p>\n\n<p>The closest thing I could get to compile is the following. It satisfies Property 1 and Feature 1\nbut violates Property 2.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE FlexibleInstances #-}\n\nimport GHC.TypeLits\n-- Works, violates Property 2\n\nclass TC (l :: Symbol) where\n  data T l :: * -&gt; *\n  label :: T l v -&gt; String\n  val :: T l v -&gt; v\n\ninstance TC \"age\" where\n  data T \"age\" v = T___age v\n  label x = \"age\"\n  val (T___age x) = x\n\n\n-- The return type of val is determined by how one constructs T___age,\n-- rather than implied by the \"age\" label.\nfoo = T___age 1      -- In GHCi, foo :: Num v =&gt; T \"age\" v\nbar = T___age \"1\"    -- and bar :: T \"age\" [Char]\n</code></pre>\n\n<p>Is there any way to specify the return type of val on the instance declaration\nassociated with T___age rather than when the data is constructed? I tried the following,\nbut it won't match the <code>Int</code> in the <code>T___age</code> constructor with the <code>v</code> returned from val.</p>\n\n<pre><code>class TC (l :: Symbol) where\n  data T l :: *\n  label :: T l -&gt; String\n  val :: T l -&gt; v\n\ninstance TC \"age\" where\n  data T \"age\" = T___age Int\n  label x = \"age\"\n  val (T___age x) = x\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Couldn't match expected type \u2018v\u2019 with actual type \u2018Int\u2019\n      \u2018v\u2019 is a rigid type variable bound by\n          the type signature for val :: T \"age\" -&gt; v at src/Basics.hs:108:3\n    Relevant bindings include\n      val :: T \"age\" -&gt; v (bound at src/Basics.hs:108:3)\n    In the expression: x :: Int\n    In an equation for \u2018val\u2019: val (T___age x) = x :: Int\n    In the instance declaration for \u2018TC \"age\"\n</code></pre>\n\n<p>Thanks for any help you can give.</p>\n"}, {"tags": ["haskell", "traversal", "fold"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 9, "creation_date": 1443386690, "post_id": 32812400, "comment_id": 53461909, "body": "Well, if you <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Foldable.html#v:toList\" rel=\"nofollow noreferrer\">squint a bit</a> then <i>any</i> <code>Foldable</code> will necessarily look like a list."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1443387040, "post_id": 32812400, "comment_id": 53462016, "body": "@leftaroundabout, that isn&#39;t quite true, since a <code>Foldable</code> could extend indefinitely in both directions. But I&#39;m interested in the underlying intuition. It seems mostly to have to do with the ability to directly fold over the thing without anything else happening in between, but that&#39;s not really very formal."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443388831, "post_id": 32812400, "comment_id": 53462524, "body": "What about things like <code>data Prod1 f g a = P1 (f a) (g a); newtype Comp f g a = Comp (f (g a)); data Sum1 f g a = L1 (f a) | R1 (g a)</code>? These all have an <code>instance (Foldable f, Foldable g) =&gt; Foldable (X f g)</code>; I would consider these non trivial. (I believe but haven&#39;t checked they all have law-abiding instances)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443389521, "post_id": 32812400, "comment_id": 53462685, "body": "@user2407038, I don&#39;t see how you could build anything out of those that doesn&#39;t look like a container."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1443390429, "post_id": 32812400, "comment_id": 53462920, "body": "Building on the answer of Daniel Wagner, you can write <code>StateT</code> as <code>newtype StateT s m a = St { runSt :: (((-&gt;) s) :.: m :.: ((,) s)) a }</code>, where <code>:.:</code> is <code>Comp</code>. If you agree that <code>StateT</code> is a non trivial Foldable, then you can indeed build a non-trivial Foldable from these. This relies on the <code>Finite a =&gt; Foldable ((-&gt;) a)</code> to qualify as a &quot;non-trivial&quot; Foldable, which will also looks like a container, if you squint hard enough (for example <code>(-&gt;) Natural</code> could be a representation of a list). I think the answer is based mainly on how you define &#39;container&#39;."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1443390512, "post_id": 32812400, "comment_id": 53462944, "body": "Well anything can have a Foldable instance with <code>toList x = []</code>. I don&#39;t know what you mean by &quot;non-trivial&quot;; if you try to formalize it you may find that it is that condition which forces your functor to be &quot;container-like&quot;. Traversable is a lot more interesting."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443623580, "post_id": 32812758, "comment_id": 53569506, "body": "I think by then you have a container, and those instances sound sensible."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 10, "last_activity_date": 1443387430, "creation_date": 1443387430, "answer_id": 32812758, "question_id": 32812400, "link": "https://stackoverflow.com/questions/32812400/are-there-non-trivial-foldable-or-traversable-instances-that-dont-look-like-con/32812758#32812758", "title": "Are there non-trivial Foldable or Traversable instances that don&#39;t look like containers?", "body": "<p>Well, with the help of <a href=\"http://hackage.haskell.org/package/universe\" rel=\"noreferrer\">universe</a>, one could potentially write <code>Foldable</code> and <code>Traversable</code> instances for state transformers over finite state spaces. The idea would be roughly similar to the <code>Foldable</code> and <code>Traversable</code> instances for functions: run the function everywhere for <code>Foldable</code> and make a lookup table for <code>Traversable</code>. Thus:</p>\n\n<pre><code>import Control.Monad.State\nimport Data.Map\nimport Data.Universe\n\n-- e.g. `m ~ Identity` satisfies these constraints\ninstance (Finite s, Foldable m, Monad m) =&gt; Foldable (StateT s m) where\n    foldMap f m = mconcat [foldMap f (evalStateT m s) | s &lt;- universeF]\n\nfromTable :: (Finite s, Ord s) =&gt; [m (a, s)] -&gt; StateT s m a\nfromTable vs = StateT (fromList (zip universeF vs) !)\n\nfloat :: (Traversable m, Applicative f) =&gt; m (f a, s) -&gt; f (m (a, s))\nfloat = traverse (\\(fa, s) -&gt; fmap (\\a -&gt; (a, s)) fa)\n\ninstance (Finite s, Ord s, Traversable m, Monad m) =&gt; Traversable (StateT s m) where\n    sequenceA m = fromTable &lt;$&gt; traverse (float . runStateT m) universeF\n</code></pre>\n\n<p>I'm not sure whether this makes sense. If it does, I think I would be happy to add it to the package; what do you think?</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 4, "last_activity_date": 1443395011, "creation_date": 1443395011, "answer_id": 32813745, "question_id": 32812400, "link": "https://stackoverflow.com/questions/32812400/are-there-non-trivial-foldable-or-traversable-instances-that-dont-look-like-con/32813745#32813745", "title": "Are there non-trivial Foldable or Traversable instances that don&#39;t look like containers?", "body": "<p>I don\u2019t think it\u2019s actually Foldable or Traversible, but MonadRandom is an example of something that could be, functioning like an infinite list, but which doesn't look any more like a container than anything else that\u2019s foldable.  Conceptually, it\u2019s a random variable.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443575804, "post_id": 32821966, "comment_id": 53546045, "body": "Why does the first argument to <code>ShapeSize</code> have kind <code>*-&gt;*</code> when it is used only as <code>f ()</code>? Is the reason for that missing from the pseudo-translation to Haskell? Also, Haskell isn&#39;t so fussy about finiteness, allowing things like <code>Traversable []</code> and <code>Traversable Tree</code>. How does that affect things?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443597980, "post_id": 32821966, "comment_id": 53553295, "body": "(a) The first argument to ShapeSize is in <code>* -&gt; *</code> because so is the argument of <code>Traversable</code> that&#39;s being modelled; (b) <code>Traversable</code> doesn&#39;t make sense (<code>undefined</code> is a form of nonsense) for infinite structures, but it is common and inevitable Haskeller hypocrisy to pretend we mean just the finite fragment of an infinite type whenever it suits us, e.g. <code>Eq</code> instances. If ever we did separate data and codata, only the data would be <code>Traversable</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443623483, "post_id": 32821966, "comment_id": 53569436, "body": "On the other hand, one abomination (infinite traversable) mixes with another (lazy state) to produce perfectly sensible <code>mapAccumL</code> and <code>mapAccumR</code> for infinite structures."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443624307, "post_id": 32821966, "comment_id": 53570018, "body": "But perhaps the perfectly sensible things also admit perfectly sensible constructions."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443646414, "post_id": 32821966, "comment_id": 53582262, "body": "In your lectures extension of a <code>Normal</code> is not the part of the definition of <code>Normal</code>, and <code>Foldable</code> then is isomorphic to <code>Normal</code>, since<code>normalT</code> is defined via <code>sizeT</code>, which is defined via <code>crush</code>, which is <code>foldMap</code>. (Whilst extension of a <code>Normal</code> is not isomorphic to <code>Foldable</code>, since there is no <code>fmap</code>). So what definition of <code>Normal</code> is pedantically precise?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443683204, "post_id": 32821966, "comment_id": 53593307, "body": "@user3237465 crush is only foldMapDefault for Traversable; my lecture notes say nothing about Foldable. You are kicking up dust which isn&#39;t there."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443688747, "post_id": 32821966, "comment_id": 53596341, "body": "Sure, I just mean that if <code>Foldable</code> would be there, then every <code>Foldable</code> <a href=\"https://github.com/effectfully/DataData/blob/master/First.agda#L274\" rel=\"nofollow noreferrer\">would</a> give raise to a <code>Normal</code> (I said &quot;isomorphic&quot;, but that was wrong \u2014 two definitions of <code>Normal</code> messed up in my head)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1516509091, "post_id": 32821966, "comment_id": 83714168, "body": "@user3237465, what lectures are you referring to? Also, the link in your last comment is broken."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1517153156, "post_id": 32821966, "comment_id": 83968730, "body": "@dfeuer, <a href=\"https://github.com/pigworker/SSGEP-DataData\" rel=\"nofollow noreferrer\">SSGEP-DataData</a> ones. <a href=\"https://github.com/effectfully/DataData/blob/fecdf99394fe665c501fcf2a32c6e02992271656/Structures/Normal.agda#L81\" rel=\"nofollow noreferrer\">Here</a> is a working link."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 21, "last_activity_date": 1443439966, "creation_date": 1443439966, "answer_id": 32821966, "question_id": 32812400, "link": "https://stackoverflow.com/questions/32812400/are-there-non-trivial-foldable-or-traversable-instances-that-dont-look-like-con/32821966#32821966", "title": "Are there non-trivial Foldable or Traversable instances that don&#39;t look like containers?", "body": "<p>Every valid <code>Traversable f</code> is isomorphic to <code>Normal s</code> for some <code>s :: Nat -&gt; *</code> where</p>\n\n<pre><code>data Normal (s :: Nat -&gt; *) (x :: *) where  -- Normal is Girard's terminology\n  (:-) :: s n -&gt; Vec n x -&gt; Normal s x\n\ndata Nat = Zero | Suc Nat\n\ndata Vec (n :: Nat) (x :: *) where\n  Nil   :: Vec Zero n\n  (:::) :: x -&gt; Vec n x -&gt; Vec (Suc n) x\n</code></pre>\n\n<p>but it's not at all trivial to implement the iso in Haskell (but it's worth a go with full dependent types). Morally, the <code>s</code> you pick is</p>\n\n<pre><code>data {- not really -} ShapeSize (f :: * -&gt; *) (n :: Nat) where\n  Sized :: pi (xs :: f ()) -&gt; ShapeSize f (length xs)\n</code></pre>\n\n<p>and the two directions of the iso separate and recombine shape and contents. The shape of a thing is given just by <code>fmap (const ())</code>, and the key point is that the length of the shape of an <code>f x</code> is the length of the <code>f x</code> itself.</p>\n\n<p>Vectors are traversable in the visit-each-once-left-to-right sense. Normals are traversable exactly in by preserving the shape (hence the size) and traversing the vector of elements. To be traversable is to have finitely many element positions arranged in a linear order: isomorphism to a normal functor exactly exposes the elements in their linear order. Correspondingly, every <code>Traversable</code> structure is a (finitary) container: they have a set of shapes-with-size and a corresponding notion of position given by the initial segment of the natural numbers strictly less than the size.</p>\n\n<p>The <code>Foldable</code> things are also finitary and they keep things in an order (there is a sensible <code>toList</code>), but they are not guaranteed to be <code>Functor</code>s, so they don't have such a crisp notion of <em>shape</em>. In that sense (the sense of \"container\" defined by my colleagues Abbott, Altenkirch and Ghani), they do not necessarily admit a shapes-and-positions characterization and are thus not containers. If you're lucky, some of them may be containers upto some quotient. Indeed <code>Foldable</code> exists to allow processing of structures like <code>Set</code> whose internal structure is intended to be a secret, and certainly depends on ordering information about the elements which is not necessarily respected by traversing operations. Exactly what constitutes a well behaved <code>Foldable</code> is rather a moot point, however: I won't quibble with the pragmatic benefits of that library design choice, but I could wish for a clearer specification.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 9, "accepted_answer_id": 32821966, "answer_count": 3, "score": 23, "last_activity_date": 1443439966, "creation_date": 1443384937, "question_id": 32812400, "link": "https://stackoverflow.com/questions/32812400/are-there-non-trivial-foldable-or-traversable-instances-that-dont-look-like-con", "title": "Are there non-trivial Foldable or Traversable instances that don&#39;t look like containers?", "body": "<p>There are lots of functors that look like containers (lists, sequences, maps, etc.), and many others that don't (state transformers, <code>IO</code>, parsers, etc.). I've not yet seen any non-trivial <code>Foldable</code> or <code>Traversable</code> instances that don't look like containers (at least if you squint a bit). Do any exist? If not, I'd love to get a better understanding of why they can't.</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443378755, "post_id": 32811390, "comment_id": 53459365, "body": "Don&#39;t do this with <code>foldl</code>. This is definitely a <code>foldr</code> or <code>mapAccumL</code> problem. <code>foldl</code> will surely make this slow."}, {"owner": {"reputation": 985, "user_id": 280060, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e88aaa7dd1d2dd81c83c466035f559e?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/280060/andrew"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443378811, "post_id": 32811390, "comment_id": 53459380, "body": "But how do I know if given 0 is preceded by @ if I use foldr."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1443378833, "post_id": 32811390, "comment_id": 53459387, "body": "Why use any fold at all?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443378882, "post_id": 32811390, "comment_id": 53459403, "body": "Yeah, <code>mapAccumL</code>, which for lists is a fold, is probably the easiest way. <code>foldr</code> can do it, but it&#39;s a little tricky to see how."}, {"owner": {"reputation": 17837, "user_id": 1923190, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/D0JyZ.jpg?s=128&g=1", "display_name": "Simon H", "link": "https://stackoverflow.com/users/1923190/simon-h"}, "edited": false, "score": 0, "creation_date": 1443378901, "post_id": 32811390, "comment_id": 53459409, "body": "There is a whole string library at <a href=\"http://hackage.haskell.org/package/hS3-0.5.8/docs/Data-String-Utils.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hS3-0.5.8/docs/&hellip;</a>"}, {"owner": {"reputation": 985, "user_id": 280060, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e88aaa7dd1d2dd81c83c466035f559e?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/280060/andrew"}, "edited": false, "score": 0, "creation_date": 1443379023, "post_id": 32811390, "comment_id": 53459445, "body": "I prefer to stay within prelude if possible."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443379305, "post_id": 32811390, "comment_id": 53459558, "body": "Well, staying within the prelude, you should surely use <code>zipWith</code>. Extending to standard libraries, <code>mapAccumL</code> in <code>Data.List</code> is attractive. <code>foldr</code> is definitely doable, but it&#39;s a somewhat more advanced technique. <code>foldl</code> just seems silly here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1443379838, "post_id": 32811390, "comment_id": 53459758, "body": "I&#39;d use explicit recursion and pattern matching. Do you really need to use folds?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443380108, "post_id": 32811390, "comment_id": 53459869, "body": "@chi&#39;s suggestion is probably the best way to start, to give you a better feel for the problem, even if you eventually want to do it some other way."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1443383128, "post_id": 32811390, "comment_id": 53460771, "body": "As for your attempt, one thing I notice is that you are comparing characters (e.g. <code>last acc</code> and <code>x</code>) to strings (<code>&quot;@&quot;</code> and <code>&quot;0&quot;</code>).  You should compare them to characters <code>&#39;@&#39;</code> and <code>&#39;0&#39;</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 8, "last_activity_date": 1443388513, "last_edit_date": 1443388513, "creation_date": 1443382083, "answer_id": 32811960, "question_id": 32811390, "link": "https://stackoverflow.com/questions/32811390/foldl-on-string/32811960#32811960", "title": "Foldl on string", "body": "<p>Taking chi's advice,</p>\n\n<pre><code>rep \"\" = \"\"\nrep ('@' : '0' : xs) = \"@k\" ++ rep xs\nrep (x : xs) = x : rep xs\n</code></pre>\n\n<p>If we want to get fancier,</p>\n\n<pre><code>rep = snd . mapAccumL go False\n  where\n    go True '0' = (False, 'k')\n    go _ '@' = (True, '@')\n    go _ x = (False, x)\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>rep = snd . mapAccumL go 'x'\n  where\n    go '@' '0' = ('0', 'k')\n    go _ y = (y, y)\n</code></pre>\n\n<p>To use <code>foldr</code> with this second approach (just because it's shorter; the first will work fine too, and allows generalization),</p>\n\n<pre><code>rep xs = foldr go (const \"\") xs 'x'\n  where\n    go '0' r '@' = 'k' : r '0'\n    go x r _ = x : r x\n</code></pre>\n\n<p>To use <code>zipWith</code> (which is more awkward to generalize):</p>\n\n<pre><code>rep xs = zipWith go ('x' : xs) xs where\n  go '@' '0' = 'k'\n  go _ x = x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443383838, "post_id": 32812169, "comment_id": 53461001, "body": "While this should have the right asymptotic bounds, much like the &quot;build backwards, then reverse&quot; technique, it is entirely strict in the spine of the list and therefore inefficient in practice."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1443384301, "last_edit_date": 1443384301, "creation_date": 1443383366, "answer_id": 32812169, "question_id": 32811390, "link": "https://stackoverflow.com/questions/32811390/foldl-on-string/32812169#32812169", "title": "Foldl on string", "body": "<p>As others have commented, <code>foldl</code> would <em>not</em> fit well for this task. However, using the idea of <a href=\"https://wiki.haskell.org/Difference_list\" rel=\"nofollow\">difference list</a>, you may still do this <em>efficiently</em> using <code>foldl</code>:</p>\n\n<pre><code>repl :: String -&gt; String\nrepl a = foldl loop id a \"\"\n    where\n    loop :: (String -&gt; String) -&gt; Char -&gt; (String -&gt; String)\n    loop f '@' ('0':rest) = f ('@':'k':rest)\n    loop f x xs = f (x:xs)\n</code></pre>\n\n<p>Just for the purpose of demonstration and the fact that the question has asked for a <code>foldl</code> solution. (not that I would recommend doing it this way).</p>\n"}], "owner": {"reputation": 985, "user_id": 280060, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e88aaa7dd1d2dd81c83c466035f559e?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/280060/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 0, "accepted_answer_id": 32811960, "answer_count": 2, "score": 3, "last_activity_date": 1443388513, "creation_date": 1443378586, "question_id": 32811390, "link": "https://stackoverflow.com/questions/32811390/foldl-on-string", "title": "Foldl on string", "body": "<p>I would like to foldl a string so that any occurrence of zero which is preceded by @ is replaced with \"k\". So \"a.@0.1.2.0\" becomes, \"a.@k.1.2.0\". How do I do that? So far my attempt is</p>\n\n<pre><code>test = foldl(\\x acc-&gt; if((last acc) == \"@\" &amp;&amp; x == \"0\" then acc ++ \"k\" else acc ++ x)) \"\" \"a.@0.1.2.0\"\n</code></pre>\n\n<p>However, it doesn't work. Foldl is expecting list of string and what I'm providing is just a string. How do I overcome that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443377741, "post_id": 32811101, "comment_id": 53459012, "body": "What do you mean by &quot;group&quot;? Filter?"}, {"owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378296, "post_id": 32811101, "comment_id": 53459201, "body": "i think filter should work (i want to see how to use the groupBy function from Data.List in this problem) but if there is a solution with filter perfect"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378370, "post_id": 32811101, "comment_id": 53459228, "body": "Solution to what? What is the problem you&#39;re trying to solve?"}, {"owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378431, "post_id": 32811101, "comment_id": 53459247, "body": "1) How can i group them by the ficcion (Fiction) category? or Suspense? 2) How can i create a list of categories from the list of movies?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378479, "post_id": 32811101, "comment_id": 53459263, "body": "Dude, I&#39;ve asked you before: What do you mean by &quot;group them&quot;? Repeating your question isn&#39;t going to help."}, {"owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378596, "post_id": 32811101, "comment_id": 53459310, "body": "Sorry, I have to make a VideoClub project, where i have clients,movies,videoclubs, also make functions that returns lists like that ones i asking for. So thats it. Group them like this : Fictions movies:[movies], Suspense movies [movies].. etc"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378702, "post_id": 32811101, "comment_id": 53459345, "body": "... OK, I give up. You never asked for any lists. I&#39;m voting for closing this as &quot;unclear what you&#39;re asking&quot;."}, {"owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378777, "post_id": 32811101, "comment_id": 53459369, "body": "ok i&#39;ll edit it, pls dont give up"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443378826, "post_id": 32811101, "comment_id": 53459385, "body": "@melpomene I believe the OP wants an equivalent of SQL &quot;group by&quot;."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443378873, "post_id": 32811101, "comment_id": 53459398, "body": "@chi OK, so how do you group by category &quot;Fiction&quot; in SQL?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443379093, "post_id": 32811101, "comment_id": 53459473, "body": "@melpomene That makes no sense to me, I concur :) But you can group by &quot;categoria&quot;."}, {"owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "edited": false, "score": 0, "creation_date": 1443379236, "post_id": 32811101, "comment_id": 53459530, "body": "thats the idea, by &quot;categoria&quot;"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443379592, "post_id": 32811101, "comment_id": 53459659, "body": "@AleMaier The confusion arises from this: either 1) you have one specific categoria at hand, e.g. &quot;fiction&quot; and you simply want to compute  asublist of movies having that category, or 2) you have no specific categoria at hand, and you want to compute groups -- a list of lists in which the first list contains all the movies having categoria1, the second list containing all the movies having categoria2, and so on. Asking to &quot;group by&quot; a specific category means nothing. I guess you want 2)."}, {"owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443379755, "post_id": 32811101, "comment_id": 53459731, "body": "@chi i need 2 yes, but i think that&#39;s already answered my question."}], "answers": [{"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 2, "last_activity_date": 1443379217, "last_edit_date": 1443379217, "creation_date": 1443378837, "answer_id": 32811433, "question_id": 32811101, "link": "https://stackoverflow.com/questions/32811101/how-to-groupby-categories-in-haskell/32811433#32811433", "title": "How to groupby categories in haskell?", "body": "<p>The following code implements a utility function, which can be applied to your problem:</p>\n\n<pre><code>import qualified Data.Map as Map -- from the \"containers\" library\n\ngroupToMap :: (Ord b) =&gt; (a -&gt; b) -&gt; [a] -&gt; Map.Map b [a]\ngroupToMap toKey =\n  Map.fromListWith (++) . map (\\a -&gt; (toKey a, [a]))\n</code></pre>\n\n<p>Using that function now you can group your data easily:</p>\n\n<pre><code>groupPeliculas :: [Pelicula] -&gt; Map.Map String [Pelicula]\ngroupPeliculas =\n  groupToMap _categoria\n</code></pre>\n\n<p>Extracting a list of categories is not any less trivial:</p>\n\n<pre><code>peliculaCategories :: [Pelicula] -&gt; [String]\npeliculaCategories =\n  map _categoria\n</code></pre>\n\n<p>If you need to get a list of unique items, do it this way:</p>\n\n<pre><code>import qualified Data.List as List\n\npeliculaCategories :: [Pelicula] -&gt; [String]\npeliculaCategories =\n  List.nub . map _categoria\n</code></pre>\n\n<p>But then it'll be smarter to use the <code>Set</code> datastructure for that:</p>\n\n<pre><code>import qualified Data.Set as Set\n\npeliculaCategories :: [Pelicula] -&gt; Set.Set String\npeliculaCategories =\n  foldr Set.insert Set.empty . map _categoria\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443379161, "post_id": 32811440, "comment_id": 53459503, "body": "Perhaps the final example isn&#39;t the best one, since every group is a singleton. Sorting in advance should help."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1443379837, "post_id": 32811440, "comment_id": 53459757, "body": "@chi You are right, I didn&#39;t notice that. Using a combination of sortBy and groupBy doesn&#39;t seem nice actually."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443380391, "post_id": 32811440, "comment_id": 53459957, "body": "I agree. I&#39;d like to have a <code>groupSortBy</code> doing both in the standard libraries."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 2, "last_activity_date": 1443379786, "last_edit_date": 1443379786, "creation_date": 1443378884, "answer_id": 32811440, "question_id": 32811101, "link": "https://stackoverflow.com/questions/32811101/how-to-groupby-categories-in-haskell/32811440#32811440", "title": "How to groupby categories in haskell?", "body": "<blockquote>\n  <p>How can i <strong>group</strong> them by the ficcion (Fiction) category? or Suspense?</p>\n</blockquote>\n\n<p>Haskell base has a <code>groupBy</code> function which can be used for this purpose. You can see it's type in <code>ghci</code>:</p>\n\n<pre><code>\u03bb&gt; import Data.List (groupBy)\n\u03bb&gt; :t groupBy\ngroupBy :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>Let me demonstrate that with a simpler example than your (you can use the same idea to adapt it to your code):</p>\n\n<pre><code>data Test = Test { id :: Int,\n                   someField :: String \n                 } deriving (Eq, Show, Ord)\n\nsampleData = [Test 1 \"hello\", Test 2 \"World\", Test 3 \"hello\", Test 4 \"World\"]\n\ngroupFunction :: Test -&gt; Test -&gt; Bool\ngroupFunction t1 t2 = someField t1 == someField t2\n</code></pre>\n\n<p>The <code>groupFunction</code> will be what you will be using for performing the actual grouping. Demo in <code>ghci</code>:</p>\n\n<pre><code>\u03bb&gt; groupBy groupFunction $ sortBy (\\x y -&gt; someField x `compare` someField y) sampleData \n[[Test {id = 2, someField = \"World\"},Test {id = 4, someField = \"World\"}],[Test {id = 1, someField = \"hello\"},Test {id = 3, someField = \"hello\"}]]\n</code></pre>\n\n<p>You can adapt this to your use case.</p>\n"}], "owner": {"reputation": 31, "user_id": 5348130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02e0eec9f46dc7a07780160d2e3bc510?s=128&d=identicon&r=PG&f=1", "display_name": "Ale Maier", "link": "https://stackoverflow.com/users/5348130/ale-maier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 32811433, "answer_count": 2, "score": 0, "last_activity_date": 1443379786, "creation_date": 1443376859, "last_edit_date": 1443377595, "question_id": 32811101, "link": "https://stackoverflow.com/questions/32811101/how-to-groupby-categories-in-haskell", "title": "How to groupby categories in haskell?", "body": "<p>Well i've this movies (peliculas in spanish) so i need to groupby categories (Fiction,Scare,Drama,Suspense,Comedy,Action).</p>\n\n<p>This is how my data movie looks like:</p>\n\n<pre><code>data Pelicula = Pelicula\n  { _id          :: Int\n  , _titulo      :: String\n  , _alquilada   :: Bool\n  , _videoclub   :: V.VideoClub\n  , _categoria   :: String\n  } deriving Show\n</code></pre>\n\n<p>The categories \"Attribute\" is a String, so if i've this list of movies: </p>\n\n<pre><code>pelicula1  = Pelicula 1   \"Inception\"                         True      V.videoclub1      \"Ficcion\"\npelicula2  = Pelicula 2   \"Inception\"                         True      V.videoclub2      \"Ficcion\"\npelicula3  = Pelicula 3   \"Inception\"                         True      V.videoclub1      \"Ficcion\"\npelicula4  = Pelicula 4   \"The Call\"                          True      V.videoclub1      \"Miedo\"\npelicula5  = Pelicula 5   \"Frozen\"                            True      V.videoclub2      \"Fantasia\"\npelicula6  = Pelicula 6   \"Fight Club\"                        False     V.videoclub2      \"Accion\"\npelicula7  = Pelicula 7   \"Now you see me\"                    False     V.videoclub1      \"Suspenso\"\npelicula8  = Pelicula 8   \"Frozen\"                            False     V.videoclub1      \"Fantasia\"\npelicula9  = Pelicula 9   \"The Call\"                          False     V.videoclub2      \"Miedo\"\npelicula10 = Pelicula 10  \"Up\"                                True      V.videoclub2      \"Fantasia\"\n</code></pre>\n\n<p>Movie list: <code>peliculas  = [pelicula1 , pelicula2, pelicula3, pelicula4, pelicula5, pelicula6, pelicula7, pelicula8, pelicula9, pelicula10]</code></p>\n\n<p>1) How can i group them by the ficcion (Fiction) category?\nor Suspense?</p>\n\n<p>2) How can i create a list of categories from the list of movies?  </p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443374439, "post_id": 32810558, "comment_id": 53457944, "body": "You don&#39;t do that with lenses."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 2, "creation_date": 1443467348, "post_id": 32810558, "comment_id": 53495950, "body": "There are a few odd things going on here. First, note that you can&#39;t make a lens for the <code>a</code> in <code>a -&gt; b</code>. Second note that you can&#39;t make a lens for <code>Tuple a = Tuple a a</code>, but you can make a <i>traversal</i>."}, {"owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "reply_to_user": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1443527136, "post_id": 32810558, "comment_id": 53520359, "body": "@J.Abrahamson can you expand? What would the <code>Tuple a = Tuple a a</code> traversal be?"}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1443528682, "post_id": 32810558, "comment_id": 53521410, "body": "Traversals are like lenses except that they &quot;focus on&quot; 0 or more &quot;spots&quot;. So you can write a traversal which focuses on each half of a homogenous Tuple."}, {"owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "reply_to_user": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1443528931, "post_id": 32810558, "comment_id": 53521593, "body": "@J.Abrahamson but in this case one <code>a</code> is in positive and one in negative position."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1443529300, "post_id": 32810558, "comment_id": 53521827, "body": "Yeah, and you simple cannot write a lens over a type in a negative position. There&#39;s no &quot;there&quot; to be focused on."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1443378240, "post_id": 32811276, "comment_id": 53459174, "body": "<code>over</code> can be used directly in lieu of <code>from</code> bracketing: <code>supply y = over tt (\\(T&#39; x f) -&gt; T&#39; (x, y) (uncurry f))</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443416942, "post_id": 32811276, "comment_id": 53468273, "body": "@duplode, actually, I can&#39;t seem to make that work at all. I&#39;ve backed off to the bracketing approach, but if you can show how to do it better, I&#39;m all ears."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1443439831, "post_id": 32811276, "comment_id": 53479221, "body": "It seems the only issue is that <code>tt</code> should be <code>Iso (T a b) (T a&#39; b&#39;) (T&#39; a b a) (T&#39; a&#39; b&#39; a&#39;)</code>; that is, <code>a</code> should be allowed to change as well. That should be enough to allow you to define <code>eg</code> with a single <code>over</code> then."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443451691, "post_id": 32811276, "comment_id": 53487262, "body": "@duplode, at last! I also worked in the lensy modification to <code>T&#39;</code>, which was the actual purpose of setting up that <code>Iso</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1443540645, "last_edit_date": 1443540645, "creation_date": 1443377988, "answer_id": 32811276, "question_id": 32810558, "link": "https://stackoverflow.com/questions/32810558/lenses-with-interdependent-simultaneous-updates/32811276#32811276", "title": "Lenses with interdependent (simultaneous) updates", "body": "<p>You can't do this using the automatically generated lenses for <code>T</code>. If you want to stretch things a bit, you can first define</p>\n\n<pre><code>data T' a b c = T' { _foo' :: c, _bar' :: a -&gt; b}\n\ntt :: Iso (T a b) (T a' b') (T' a b a) (T' a' b' a')\ntt = dimap (\\(T x g) -&gt; T' x g) (fmap (\\(T' x g) -&gt; T x g))\n</code></pre>\n\n<p>Then you can (automatically) build type-changing lenses for <code>T'</code> and use <code>tt</code> to use them to modify values of type <code>T a b</code> through the isomorphism.</p>\n\n<p>For example, rearranging the arguments a bit, you can write</p>\n\n<pre><code>eg :: b -&gt; T a (b -&gt; c) -&gt; T (a, b) c\neg b = over tt $ (foo' %~ (,b)) . (bar' %~ uncurry)\n</code></pre>\n\n<p>Another approach that will likely be better if you don't need to fuss around with <code>T</code> too much is to define it as a <code>newtype</code> around <code>T'</code>:</p>\n\n<pre><code>newtype T a b = T { getT :: T' a b a }\n</code></pre>\n\n<p>Then you can skip the <code>Iso</code> and just compose things. Rearranging the arguments the same way,</p>\n\n<pre><code>eg' :: b -&gt; T a (b -&gt; c) -&gt; T (a, b) c\neg' b = T . (foo' %~ (,b)) . (bar' %~ uncurry) . getT\n</code></pre>\n"}], "owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 32811276, "answer_count": 1, "score": 7, "last_activity_date": 1443540645, "creation_date": 1443373727, "last_edit_date": 1443378516, "question_id": 32810558, "link": "https://stackoverflow.com/questions/32810558/lenses-with-interdependent-simultaneous-updates", "title": "Lenses with interdependent (simultaneous) updates", "body": "<p>Lets say I have:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE TupleSections #-}\nimport Control.Lens\n\ndata T a b = T { _foo :: a\n               , _bar :: a -&gt; b\n               }\n\nmakeLenses ''T\n</code></pre>\n\n<p><code>a</code> appears in both <code>foo</code> and <code>bar</code>, so updates have to be \"simulatenous\", as it were. This is possible without lenses:</p>\n\n<pre><code>eg1 :: T a (b -&gt; c) -&gt; b -&gt; T (a, b) c\neg1 (T foo bar) b = T (foo, b) (uncurry bar)\n</code></pre>\n\n<p>But how can I do this with lenses? The following doesn't work with an occurs check:</p>\n\n<pre><code>eg :: T a (b -&gt; c) -&gt; b -&gt; T (a, b) c\neg t b = t &amp; foo %~ (, b) &amp; bar %~ uncurry\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "find", "element", "fold"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1443370876, "post_id": 32810044, "comment_id": 53456824, "body": "Yes, try using <code>foldr</code> instead of <code>foldl</code>. Though counting an infinite list will always hang. I&#39;m not sure why you would want to use <code>count</code> for your <code>elem</code> implementation at all?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1443371004, "post_id": 32810044, "comment_id": 53456877, "body": "You&#39;re neither using <code>i</code> nor <code>elem</code> in that lambda. So what are you folding for at all? Also, if you use a fold, you should not use structural recursion (with pattern matching)"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443371083, "post_id": 32810044, "comment_id": 53456893, "body": "Try <code>elem&#39; x = foldr (\\el elemInRest -&gt; el == x || elemInRest) false</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443371271, "post_id": 32810044, "comment_id": 53456944, "body": "@Bergi, it might save some proving in a dependently typed setting, using inductive lists and lazy naturals, but counting elements of an infinite list makes rather less sense."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443371719, "post_id": 32810044, "comment_id": 53457088, "body": "@dfeuer: I knew someone would catch on the &quot;always&quot; :-) Yeah, with lazy Peano numerals it might be applicable, and in proofs anyway for sure, but it doesn&#39;t make sense for the OP."}, {"owner": {"reputation": 329, "user_id": 2423418, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5b36ab0919a6d5f0c8abf99d2fa1750a?s=128&d=identicon&r=PG", "display_name": "Karim Elsheikh", "link": "https://stackoverflow.com/users/2423418/karim-elsheikh"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443372381, "post_id": 32810044, "comment_id": 53457310, "body": "@Bergi, I see the idea, so you evaluate from right to left and if the current element in the list isn&#39;t x, it will recursively evaluate the rest of the list. How does it handle a true case? Sorry if this is obvious I&#39;m very new to functional programming."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1443372789, "post_id": 32810044, "comment_id": 53457438, "body": "@KarimElsheikh: In fact <code>foldr</code> evaluates from left to right as well, only the nesting of operations is different. Don&#39;t forget that Haskell is lazy, <code>elemInRest</code> is not yet evaluated. So if <code>x</code> is found, <code>true</code> is just &quot;returned&quot; right away - the <code>||</code> doesn&#39;t need to peek at its second argument, the rest of the list is never expanded."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1443379957, "last_edit_date": 1443379957, "creation_date": 1443373557, "answer_id": 32810530, "question_id": 32810044, "link": "https://stackoverflow.com/questions/32810044/how-do-i-find-an-element-in-an-infinite-list-using-the-foldr-function-in-haskell/32810530#32810530", "title": "How do I find an element in an infinite list using the foldr function in Haskell?", "body": "<p>Let's start with the basic skeleton on the <code>foldr</code> pattern:</p>\n\n<pre><code>elem :: Eq a =&gt; [a] -&gt; Bool\nelem x xs = foldr kons knil xs\n</code></pre>\n\n<p>When <code>foldr</code> sees <code>[]</code>, it will return knil. Since nothing is an element of the empty list, we conclude that</p>\n\n<pre><code>knil = False\n</code></pre>\n\n<p>When <code>foldr kons False</code> sees a list <code>a : as</code>, it returns <code>kons a (foldr kons False as)</code>. We can assume inductively that <code>foldr kons False as = elem x as</code>, so we seek to solve for <code>kons</code> in</p>\n\n<pre><code>elem x (a : as) = kons a (elem x as)\n</code></pre>\n\n<p>I bet you can finish up by coming up with the definition of <code>kons</code>. Watch out for Boolean short-circuit behavior to make this efficient and avoid problems with infinite lists.</p>\n"}], "owner": {"reputation": 329, "user_id": 2423418, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5b36ab0919a6d5f0c8abf99d2fa1750a?s=128&d=identicon&r=PG", "display_name": "Karim Elsheikh", "link": "https://stackoverflow.com/users/2423418/karim-elsheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1878, "favorite_count": 0, "accepted_answer_id": 32810530, "answer_count": 1, "score": 0, "last_activity_date": 1443379957, "creation_date": 1443370571, "question_id": 32810044, "link": "https://stackoverflow.com/questions/32810044/how-do-i-find-an-element-in-an-infinite-list-using-the-foldr-function-in-haskell", "title": "How do I find an element in an infinite list using the foldr function in Haskell?", "body": "<p>I'm trying to create a new implementation of the <code>elem</code> function in Haskell using the <code>foldr</code> function.</p>\n\n<p>So far I have this:</p>\n\n<pre><code>count :: Eq a =&gt; a -&gt; [a] -&gt; Integer\ncount x (y:ys) = foldl (\\counter y -&gt; if y == x then counter + 1 else counter) 0 ys\ncount _ [] = 0\n\nelem' :: Eq a =&gt; a -&gt; [a] -&gt; Bool\nelem' x (y:ys) = foldr (\\i elem-&gt; if (count x (y:ys)) &gt; 0 then True else False) False ys\nelem' _ [] = False\n</code></pre>\n\n<p>The <code>count</code> function is counting the number of occurances of x (another function I wrote) using <code>foldl</code>. This works fine for finite lists, but the problem is that I want to take advantage of the <code>foldr</code> lazy computation of an infinite list. If I try to use an infinite list as input the program hangs forever. </p>\n\n<p>Basically I want to \"break out\" once I find any instance of x in the list and return true, otherwise return false.</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["haskell", "profiling"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1443373225, "post_id": 32809263, "comment_id": 53457577, "body": "It seems to me that <code>Data.DAWG.Static</code> is shown because it corresponds to a CAF. In general, modules from existing packages wouldn&#39;t (and shouldn&#39;t - how could they!) be shown, if you haven&#39;t built the corresponding package with profiling enabled. If you want to profile library code you&#39;ll have to rebuild it (and its dependencies, I believe) with profiling enabled."}, {"owner": {"reputation": 551, "user_id": 755773, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93681534482869a80cf1a45f1180d1fd?s=128&d=identicon&r=PG", "display_name": "Yves Par&#232;s", "link": "https://stackoverflow.com/users/755773/yves-par%c3%a8s"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443387050, "post_id": 32809263, "comment_id": 53462019, "body": "Every library I use is built with profiling enabled. Though dawg is <i>not</i> built by default with &quot;-fprof-auto-top&quot;. So it enables profiling but it doesn&#39;t add SCCs on every function. And why doesn&#39;t <code>Data.DAWG.Dynamic</code> correspond to a CAF, then?"}], "owner": {"reputation": 551, "user_id": 755773, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93681534482869a80cf1a45f1180d1fd?s=128&d=identicon&r=PG", "display_name": "Yves Par&#232;s", "link": "https://stackoverflow.com/users/755773/yves-par%c3%a8s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1517909286, "creation_date": 1443366002, "last_edit_date": 1517909286, "question_id": 32809263, "link": "https://stackoverflow.com/questions/32809263/haskell-profiler-output-not-complete", "title": "Haskell: profiler output not complete?", "body": "<p>I'm building a project that stores words into a dictionary (using the library <code>dawg</code>), and when compiled with -fprof-auto, the profiler doesn't tell me that most of the time is spent in functions and CAFs from dawg modules.</p>\n\n<p>The code (also using conduit, but it's pretty straightforward) is:</p>\n\n<pre><code>import Data.DAWG.Static as D\nimport qualified Data.DAWG.Dynamic as DD\nimport Conduit\nimport qualified Data.Conduit.Combinators as C\nimport qualified Data.Text as T\nimport Data.List (isSuffixOf)\nimport Control.Monad\n\n\ninsertEntry dawg word =\n  DD.insertWith (+) (T.unpack word) 1 dawg\n\nisWhitespace x = x `elem` [' ', '.', '\\n', '\\'']\n\nappendFileToDDAWG dawg fp =\n  C.sourceFile fp $= C.decodeUtf8\n  $= C.splitOnUnboundedE isWhitespace\n  $$ C.foldl insertEntry dawg \n\nloadDirToDAWG :: FilePath -&gt; IO (DAWG Char () Int)\nloadDirToDAWG dir = runResourceT $ do\n  d &lt;- C.sourceDirectoryDeep True dir\n       $= C.filter (\".txt\" `isSuffixOf`)\n       $$ C.foldM appendFileToDDAWG DD.empty\n  return $ D.freeze d\n\nmain = do d &lt;- loadDirToDAWG some_directory\n          mapM_ print $ D.assocs d\n</code></pre>\n\n<p>Running with +RTS -p shows me most of the time is spent in insertEntry (which is normal):</p>\n\n<pre><code>COST CENTRE          MODULE                      no.     entries  %time %alloc   %time %alloc\n\nMAIN                 MAIN                        211           0    0.0    0.0   100.0  100.0\n main                Main                        423           0    2.3    1.7    99.9  100.0\n  loadDirToDAWG      Mymodule.BuildDAWG          425           0    1.9    1.0    97.6   98.2\n   appendFileToDDAWG Mymodule.BuildDAWG          427          74    8.0    5.1    95.7   97.2\n    insertEntry      Mymodule.BuildDAWG          430       71366   86.5   92.1    86.5   92.1\n    [...]\nCAF                  Data.DAWG.Static            418           0    0.1    0.0     0.1    0.0\nCAF                  Data.DAWG.Trans.Map         412           0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>But it doesn't tell me that the time is actually spent inside the <code>Data.DAWG.Dynamic</code> module. Which is weird because it shows the <code>Data.DAWG.Static</code> module, so it's able to \"detect\" some modules from dawg but not all of them, and especially not the one where most of the work is done.</p>\n\n<p>After downloading dawg, modifying its .cabal file so it's compiled with <code>-fprof-auto-top</code>, and rebuilding everything I get a larger profiler output that shows all inner functions of <code>Data.DAWG.Dynamic</code> and seems ok. But I don't want the full detail (I'm not profiling dawg, just my code) and I just want to be sure that the time is spent in dawg and not in my code (or else it means my code has a problem).</p>\n\n<p>So why in the first case was the <code>Data.DAWG.Dynamic</code> module not shown?\nIs there something I'm missing regarding how GHC handles profiling?</p>\n"}, {"tags": ["list", "haskell", "iteration", "reverse"], "comments": [{"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "edited": false, "score": 0, "creation_date": 1443362277, "post_id": 32808639, "comment_id": 53454042, "body": "Your second example is changing 1st and 3rd item. What&#39;s what you want to do?"}, {"owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "reply_to_user": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "edited": false, "score": 0, "creation_date": 1443362521, "post_id": 32808639, "comment_id": 53454128, "body": "@MASL the task is increase each 2&#39;nd from right. So look at list from right: the second from right is <code>3-&gt;(3+1)=4</code>, now skip <code>2</code>, after that  4th <code>1-&gt;(1+1)=2</code>. So result <code>[2, 2, 4, 4]</code>"}, {"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "edited": false, "score": 0, "creation_date": 1443362579, "post_id": 32808639, "comment_id": 53454150, "body": "Ok. Oversaw that detail."}, {"owner": {"reputation": 929, "user_id": 2441499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0e266b65599dceddf55d0cb898da88?s=128&d=identicon&r=PG", "display_name": "raymonad", "link": "https://stackoverflow.com/users/2441499/raymonad"}, "edited": false, "score": 0, "creation_date": 1443362613, "post_id": 32808639, "comment_id": 53454161, "body": "Reverse the list, add 1 to every second element and reverse to get the original order back."}, {"owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "reply_to_user": {"reputation": 929, "user_id": 2441499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0e266b65599dceddf55d0cb898da88?s=128&d=identicon&r=PG", "display_name": "raymonad", "link": "https://stackoverflow.com/users/2441499/raymonad"}, "edited": false, "score": 0, "creation_date": 1443362818, "post_id": 32808639, "comment_id": 53454232, "body": "@raymonad yep, it is possible, but I would like to understand how to process list from right-to-left, see my &#39;p.s.&#39; update"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1443363004, "post_id": 32808639, "comment_id": 53454292, "body": "Do you mean that you want to increment every second item starting from the right?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1443374734, "post_id": 32808639, "comment_id": 53458051, "body": "@Dewfy Please edit your question as to make it clearer."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443372450, "post_id": 32809117, "comment_id": 53457332, "body": "I really like your second answer. Note that the two approaches may perform very differently. The double reverse will generally allocate quite a bit more memory, but only benchmarks can say which will really be better."}], "tags": [], "owner": {"reputation": 929, "user_id": 2441499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0e266b65599dceddf55d0cb898da88?s=128&d=identicon&r=PG", "display_name": "raymonad", "link": "https://stackoverflow.com/users/2441499/raymonad"}, "is_accepted": false, "score": 4, "last_activity_date": 1443365069, "creation_date": 1443365069, "answer_id": 32809117, "question_id": 32808639, "link": "https://stackoverflow.com/questions/32808639/process-haskell-list-from-right-to-left-keeping-origin-order/32809117#32809117", "title": "Process Haskell list from right to left keeping origin order", "body": "<p>The typical way to process a Haskell list from right to left would be to reverse it. Since you want to have the original order for the result, you would simply reverse again:</p>\n\n<pre><code>f1 = reverse . zipWith (+) (cycle [0,1]) . reverse\n</code></pre>\n\n<p>But if you really want to, you can have each recursive call return both the updated tail and a flag that indicates whether that position is even when counted from the end so you know whether to increase the element at that position or not:</p>\n\n<pre><code>f2 = snd . g\n  where\n  g []     = (False, [])\n  g (x:xs) = let (addOne, xs') = g xs\n                 x' = if addOne then x + 1 else x\n             in (not addOne, x':xs')\n</code></pre>\n\n<p>We're basically mapping a function over the list, but this function requires an extra parameter that gets computed starting from the right end of the list. There's a standard function we can use:</p>\n\n<pre><code>import Data.List (mapAccumR)\nf2' = snd . mapAccumR g False\n  where\n  g addOne x = (not addOne, if addOne then x + 1 else x)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "edited": false, "score": 0, "creation_date": 1443366074, "post_id": 32809209, "comment_id": 53455247, "body": "Nice try! Indeed it gives correct result. My origin question was inspired by trying to find common parts in Prolog and Haskell . Prolog gives you 2 ways &#39;iteration&#39; and &#39;recursion&#39; to process list in any direction. So looking at Haskell I can see only <code>f (x:xs)</code> - the recursive way"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443371818, "post_id": 32809209, "comment_id": 53457137, "body": "I don&#39;t see how raymonad&#39;s answer ties a knot, per se."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443376124, "post_id": 32809209, "comment_id": 53458494, "body": "@dfeuer Oops, I glanced too fast.  My mistake."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 4, "last_activity_date": 1443376543, "last_edit_date": 1443376543, "creation_date": 1443365656, "answer_id": 32809209, "question_id": 32808639, "link": "https://stackoverflow.com/questions/32808639/process-haskell-list-from-right-to-left-keeping-origin-order/32809209#32809209", "title": "Process Haskell list from right to left keeping origin order", "body": "<p>I think a cleaner specification for what you want is that you increment even indicies if the length is even and odd indicies if the length is odd. For example, when indexing from zero, the list of length 3 resulted in index 1 being incremented.  One way to do this is with the obvious two pass solution:</p>\n\n<pre><code>f xs = zipWith (+) (cycle sol) xs\n where sol = map fromEnum [even len, odd len] \n       len = length xs\n</code></pre>\n\n<p>This can be done in one pass (without relying on the compiler fusion rules) by \"tying the knot\".  For example (using manual recursive style as means of communication).</p>\n\n<pre><code>f2 xs = let (isEven, result) = go isEven xs in result\n where\n  go _ []     = (True,     [])\n  go e (x:xs) = let (ne,rest) = go (not e) xs\n                in (not ne, x+fromEnum e : rest)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 2, "last_activity_date": 1465148429, "last_edit_date": 1465148429, "creation_date": 1443367631, "answer_id": 32809546, "question_id": 32808639, "link": "https://stackoverflow.com/questions/32808639/process-haskell-list-from-right-to-left-keeping-origin-order/32809546#32809546", "title": "Process Haskell list from right to left keeping origin order", "body": "<p>This can be done efficiently using a <em>left fold</em>:</p>\n\n<pre><code>inc :: Num a =&gt; [a] -&gt; [a]\ninc xs = foldl go (\\_ _ acc -&gt; acc) xs id (+ 1) []\n    where go run x f g acc = run g f (f x: acc)\n</code></pre>\n\n<p>Note that even thought this is a left fold, the list is built using cons <code>(:)</code> operator; and it will perform linearly and not quadratic (similar construct as in <a href=\"https://en.wikipedia.org/wiki/Difference_list\" rel=\"nofollow\">difference lists</a>).</p>\n\n<pre><code>\\&gt; inc [1, 2, 3]\n[1,3,3]\n\\&gt; inc [1, 2, 3, 4]\n[2,2,4,4]\n</code></pre>\n\n<p>It can also be generalized to alternating functions other than <code>id</code> and <code>(+ 1)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443717403, "post_id": 32892469, "comment_id": 53614789, "body": "This is the same as raymonad&#39;s second answer, except that you&#39;ve inlined <code>mapAccumR</code>."}, {"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443717661, "post_id": 32892469, "comment_id": 53614938, "body": "It doesn&#39;t have to be conceptually different to count as an answer. Plus, I find <code>foldr</code> to be much easier to understand for beginners than <code>mapAccumR</code>, because it&#39;s much more widely used in functional languages."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443728044, "post_id": 32892469, "comment_id": 53620184, "body": "I&#39;ll grant that, but the whole situation is a bit unusual. <code>mapAccumL</code> is much more common, and few beginners will understand its translation to <code>foldr</code>."}], "tags": [], "owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "is_accepted": false, "score": 0, "last_activity_date": 1443716859, "creation_date": 1443716859, "answer_id": 32892469, "question_id": 32808639, "link": "https://stackoverflow.com/questions/32808639/process-haskell-list-from-right-to-left-keeping-origin-order/32892469#32892469", "title": "Process Haskell list from right to left keeping origin order", "body": "<p>I like Thomas's solution. However, I think a simple <code>foldr</code> is enough here.</p>\n\n<pre><code>process = snd . foldr (\\x (b,xs) -&gt; (not b, x + fromEnum b:xs)) (False,[])\n</code></pre>\n"}], "owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 32809546, "answer_count": 4, "score": 4, "last_activity_date": 1465148429, "creation_date": 1443361968, "last_edit_date": 1443384264, "question_id": 32808639, "link": "https://stackoverflow.com/questions/32808639/process-haskell-list-from-right-to-left-keeping-origin-order", "title": "Process Haskell list from right to left keeping origin order", "body": "<p>Need increment every second item starting from the right in Haskell list but keeping origin order (e.g. <code>reverse</code> is not a case). For example:</p>\n\n<pre><code> f [1, 2, 3] --  [1, 3, 3]\n\n f [1, 2, 3, 4] -- [2, 2, 4, 4]\n</code></pre>\n\n<p>I've tried something like a following:</p>\n\n<pre><code>fc ([]) = []\nfc (x:[]) = [x]\nfc (x:[y]) = [x+1,y]\nfc( x:xs ) = fc [x] : ( fc xs ) -- this line is wrong\n</code></pre>\n\n<p>p.s. Obviously I could reverse (but prefer to understand original task) the list twice and apply something like:</p>\n\n<pre><code>helper (x:y:tail) = [x, y+1] ++ tail\nfc x = reverse (helper (reverse x) )\n</code></pre>\n"}, {"tags": ["haskell", "dependent-type"], "comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 6, "creation_date": 1443352615, "post_id": 32807193, "comment_id": 53451457, "body": "You won&#39;t find something you could start using in five minute to prevent bugs because because dependent types is not a magic receipe you can apply to everything and even when it applies it&#39;s not necessarily simple."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1443352716, "post_id": 32807193, "comment_id": 53451483, "body": "Right, but it still would be nice to know what all the hype is all about and why a mere mortal should care or should he/she really care? Or is this dependent typing story all just &quot;too academical&quot; to be useful in practice?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1443353310, "post_id": 32807193, "comment_id": 53451620, "body": "Yes, that&#39;s it exactly. Anything that takes more than five minutes to learn is too academical to be useful in practice."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1443353548, "post_id": 32807193, "comment_id": 53451667, "body": "@melpomene, yeah like walking, or talking ;-)"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443357091, "post_id": 32807193, "comment_id": 53452556, "body": "<a href=\"http://stackoverflow.com/questions/27029564/how-do-i-build-a-list-with-a-dependently-typed-length\">Related</a>."}], "answers": [{"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443354420, "post_id": 32807429, "comment_id": 53451880, "body": "This is cool, how can I try this right now ? :) Could you give a few line example that I can compile and run ? Or get a type error if want to take the head of an empty list?"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443359077, "post_id": 32807429, "comment_id": 53453062, "body": "So basically you run this program (checking List Empty-ess) at compile time. I still don&#39;t see how this differs from a simple test. I mean is dependent typing going to help to prevent me from giving bad input to a program? Or what is the point of dependent typing? Should the input into the program also already be present at compile time? Is dependent typing useful for programs when the input is not known until runtime?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 1, "creation_date": 1443360262, "post_id": 32807429, "comment_id": 53453422, "body": "The difference with a simple test, is you (or your library users) CAN NOT forget to do this simple test,this is enforce by the compiler. There is a problem indeed for runtime value, it&#39;s still doable but far beyond this &quot;5 minute&quot; example, which is one of the reason dependent type is not main stream yet ;-)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 3, "creation_date": 1443360506, "post_id": 32807429, "comment_id": 53453484, "body": "@jhegedus You don&#39;t need to know the input at compile time.  You can make sure the input is valid (through normal means), then dependent types can help prevent some incorrect manipulations of the data <i>inside</i> the program after you know the input is ok. Those dependent type errors are caught at compile time, so you never need to worry about missing an edge case, like you do with tests. Tests are still important, but depedent types provide an additional, useful (and different) tool."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443361342, "post_id": 32807429, "comment_id": 53453746, "body": "@mb14 Ok, then maybe one day somehow I will understand how the &quot;longer than 5 min example&quot; will work. But I get the point. The useful stuff is not very simple stuff."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443375379, "post_id": 32807429, "comment_id": 53458241, "body": "If someone can recommend a good and easy source on a &quot;longer than 5 min&quot; example, let me know."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443375936, "post_id": 32807429, "comment_id": 53458419, "body": "I compiled the snippet, it needed TypeOperators too with GHC 7.10.2. Thanks for the working code example !"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1453824047, "post_id": 32807429, "comment_id": 57763142, "body": "Here is an answer for my comment that I posted on Sep 27 &#39;15 at 13:04 <a href=\"http://docs.idris-lang.org/en/latest/effects/simpleeff.html#exceptions\" rel=\"nofollow noreferrer\">docs.idris-lang.org/en/latest/effects/simpleeff.html#excepti&zwnj;&#8203;ons</a> in that webpage it is described that dependent types enforce that user data must be validated before it enters into the &quot;inner, pure, total and proved to be correct&quot; part of the program."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1453824365, "post_id": 32807429, "comment_id": 57763381, "body": "This is the precise link <a href=\"http://docs.idris-lang.org/en/latest/effects/simpleeff.html#vadd-revisited\" rel=\"nofollow noreferrer\">docs.idris-lang.org/en/latest/effects/&hellip;</a>"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 5, "last_activity_date": 1443378090, "last_edit_date": 1443378090, "creation_date": 1443353431, "answer_id": 32807429, "question_id": 32807193, "link": "https://stackoverflow.com/questions/32807193/simple-dependent-type-example-in-haskell-for-dummies-how-are-they-useful-in-pra/32807429#32807429", "title": "Simple dependent type example in Haskell for Dummies. How are they useful in practice in Haskell? Why should I care about dependent types ?", "body": "<p>The common example is to encode the length of a list in it's type, so you can do things like (pseudo code).</p>\n\n<pre><code>cons :: a -&gt; List a n -&gt; List a (n+1)\n</code></pre>\n\n<p>Where <code>n</code> is an integer. This let you specify that adding an object to list increment its length by one. </p>\n\n<p>You can then prevent <code>head</code> (which give you the first element of a list) to be ran on empty list</p>\n\n<pre><code> head :: n &gt; 0 =&gt; List a n -&gt; a\n</code></pre>\n\n<p>Or do things like </p>\n\n<pre><code>to3uple :: List a 3 -&gt; (a,a,a)\n</code></pre>\n\n<p>The problem with this type of approach is you then can't call <code>head</code> on a arbitrary list without having proven first that the list is not null.</p>\n\n<p>Sometime the proof can be done by the compiler, ex:</p>\n\n<pre><code> head (a `cons` l)\n</code></pre>\n\n<p>Otherwise, you have to do things like </p>\n\n<pre><code> if null list\n    then ...\n    else (head list)\n</code></pre>\n\n<p>Here it's safe to call <code>head</code>, because you are in the else branch and therefore guaranteed that the length is not null.</p>\n\n<p>However, Haskell doesn't do dependent type at the moment, all the examples have given won't work as nicely, but you should be able to declare this type of list using <code>DataKind</code> because you can promote a int to type which allow to instanciate <code>List a b</code> with <code>List Int 1</code>. (b is a phantom type taking a literal).</p>\n\n<p>If you are interested in this type of safety, you can have a look a <em>liquid Haskell</em>.</p>\n\n<p>Here is a example of such code </p>\n\n<pre><code>{-# LANGUAGE DataKinds, KindSignatures, TypeFamilies, TypeOperators #-}\n\nimport GHC.TypeLits\n\n\ndata List a (n:: Nat) = List [a] deriving Show\n\ncons :: a -&gt; List a n -&gt; List a (n + 1)\ncons x (List xs) = List (x:xs)\n\nsingleton :: a -&gt; List a 1\nsingleton x = List [x]\n\ndata NonEmpty\ndata EmptyList\n\ntype family ListLength a where\n  ListLength (List a 0) =  EmptyList\n  ListLength (List a n) = NonEmpty\n\nhead' :: (ListLength (List a n) ~ NonEmpty) =&gt; List a n -&gt; a\nhead' (List xs) = head xs\n\ntail' :: (ListLength (List a n) ~ NonEmpty) =&gt; List a n -&gt; List a (n-1)\ntail' (List xs) = List (tail xs)\n\nlist = singleton \"a\"\n\nhead' list -- return \"a\"\n</code></pre>\n\n<p>Trying to do <code>head' (tail' list)</code>  doesn't compile and give </p>\n\n<pre><code>Couldn't match type \u2018EmptyList\u2019 with \u2018NonEmpty\u2019\nExpected type: NonEmpty\n  Actual type: ListLength (List [Char] 0)\nIn the expression: head' (tail' list)\nIn an equation for \u2018it\u2019: it = head' (tail' list)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443376621, "post_id": 32808086, "comment_id": 53458648, "body": "What do you mean by types can influence values in Haskell ? What do you mean by influence ? Influence how ?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443384139, "post_id": 32808086, "comment_id": 53461112, "body": "@jhedgedus Ie: Typeclasses and GADTs allow values to be restricted by types, but you can&#39;t determine a type via a value like you can in Idris. <a href=\"https://gist.github.com/paulkoerbitz/11281614\" rel=\"nofollow noreferrer\">this</a> example in Idris may explain. See line 76, the type signature refers to a value."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1443358206, "creation_date": 1443358206, "answer_id": 32808086, "question_id": 32807193, "link": "https://stackoverflow.com/questions/32807193/simple-dependent-type-example-in-haskell-for-dummies-how-are-they-useful-in-pra/32808086#32808086", "title": "Simple dependent type example in Haskell for Dummies. How are they useful in practice in Haskell? Why should I care about dependent types ?", "body": "<p>Adding to @mb14's example, here's some simpler working code.</p>\n\n<p>First, we need <code>DataKinds</code>, <code>GADTs</code>, and <code>KindSignatures</code> to really make it clear:</p>\n\n<pre><code>{-# LANGUAGE DataKinds      #-}\n{-# LANGUAGE GADTS          #-}\n{-# LANGUAGE KindSignatures #-}\n</code></pre>\n\n<p>Now let's define a <code>Nat</code> type, and a <code>Vector</code> type based on it:</p>\n\n<pre><code>data Nat :: * where\n    Z :: Nat\n    S :: Nat -&gt; Nat\n\ndata Vector :: Nat -&gt; * -&gt; * where\n    Nil   :: Vector Z a\n    (:-:) :: a -&gt; Vector n a -&gt; Vector (S n) a\n</code></pre>\n\n<p>And voila, lists using dependent types that can be called safe in certain circumstances.</p>\n\n<p>Here are the <code>head</code> and <code>tail</code> functions:</p>\n\n<pre><code>head' :: Vector (S n) a -&gt; a\nhead' (a :-: _) = a\n-- The other constructor, Nil, doesn't apply here because of the type signature!\n\ntail' :: Vector (S n) a -&gt; Vector n a\ntail (_ :-: xs) = xs\n-- Ditto here.\n</code></pre>\n\n<p>This is a more concrete and understandable example than above, but does the same sort of thing.</p>\n\n<p>Note that in Haskell, Types can influence values, but values cannot influence types in the same dependent ways. There are languages such as Idris that are similar to Haskell but also support value-to-type dependent typing, which I would recommend looking into.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1443376086, "creation_date": 1443376086, "answer_id": 32810958, "question_id": 32807193, "link": "https://stackoverflow.com/questions/32807193/simple-dependent-type-example-in-haskell-for-dummies-how-are-they-useful-in-pra/32810958#32810958", "title": "Simple dependent type example in Haskell for Dummies. How are they useful in practice in Haskell? Why should I care about dependent types ?", "body": "<p>The <code>machines</code> package lets users define machines that can request values. Many machines request only one type of value, but it's also possible to define machines that sometimes ask for one type and sometimes ask for another type. The requests are values of a GADT type, which allows the value of the request to determine the type of the response.</p>\n\n<pre><code>Step k o r = ...\n           | forall t . Await (t -&gt; r) (k t) r\n</code></pre>\n\n<p>The machine provides a request of type <code>k t</code> for some unspecified type <code>t</code>, and a function to deal with the result. By pattern matching on the request, the machine runner learns what type it must supply the machine. The machine's response handler doesn't need to check that it got the right sort of response.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443457191, "post_id": 32819712, "comment_id": 53490677, "body": "Church would be disappointed being counted as a software engineer."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443461269, "post_id": 32819712, "comment_id": 53492865, "body": "Thanks for the intuitive explanation, I&#39;ve just bought the Manning book on Idris, maybe all this will be more solid in my head by next summer :)"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443462247, "post_id": 32819712, "comment_id": 53493399, "body": "So the point is that if somewhere deep down in my program I add two vectors, then with dependent typing I can be sure that I will never have a run time exception because those two vectors are of different length. Right?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1443462336, "post_id": 32819712, "comment_id": 53493452, "body": "Yes, and the compiler shouldn&#39;t even generate code to check for that exceptional condition."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1443800817, "post_id": 32819712, "comment_id": 53649963, "body": "To provide a third-party endorsement of @pigworker&#39;s &quot;shameless plug&quot;: <i>Hasochism</i> is a fantastic paper. I&#39;m a &quot;regular&quot; Haskell programmer, not a mathematician or a professor or a type-theorist, and the paper was the first I&#39;d ever heard of dependent types. It took me a couple of reads-through to grasp the ideas in the article, but I haven&#39;t read a better introduction to the concept (even though the paper isn&#39;t pitched as an introduction!)."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1443821632, "post_id": 32819712, "comment_id": 53660262, "body": "@BenjaminHodgson Thank you! Sam and I had a great time writing that paper. And I should add that much of it was provoked by questions on this site."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1451293291, "post_id": 32819712, "comment_id": 56722669, "body": "Btw, just reading the Idris book atm, it really blows my mind :) super good intro, easy for &quot;dummies&quot; :)"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 11, "last_activity_date": 1443432664, "creation_date": 1443432664, "answer_id": 32819712, "question_id": 32807193, "link": "https://stackoverflow.com/questions/32807193/simple-dependent-type-example-in-haskell-for-dummies-how-are-they-useful-in-pra/32819712#32819712", "title": "Simple dependent type example in Haskell for Dummies. How are they useful in practice in Haskell? Why should I care about dependent types ?", "body": "<p>Late to the party, this answer is basically a shameless plug.</p>\n\n<p>Sam Lindley and I wrote a paper about <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\">Hasochism</a>, the pleasure and pain of dependently typed programming in Haskell. It gives plenty of examples of what's possible <em>now</em> in Haskell and draws points of comparison (favourable as well as not) with the Agda/Idris generation of dependently typed languages.</p>\n\n<p>Although it is an academic paper, it is about actual programs, and you can grab the code from <a href=\"https://github.com/slindley/dependent-haskell/tree/master/Hasochism\">Sam's repo</a>. We have lots of little examples (e.g. orderedness of mergesort output) but we end up with a text editor example, where we use indexing by width and height to manage screen geometry: we make sure that components are regular rectangles (vectors of vectors, not ragged lists of lists) and that they fit together exactly.</p>\n\n<p>The key power of dependent types is to maintain consistency between separate data components (e.g., the head vector in a matrix and every vector in its tail must all have the same length). That's never more important than when writing conditional code. The situation (which will one day come to be seen as having been ridiculously na\u00efve) is that the following are all type-preserving rewrites</p>\n\n<ul>\n<li><code>if b then t else e</code> => <code>if b then e else t</code></li>\n<li><code>if b then t else e</code> => <code>t</code></li>\n<li><code>if b then t else e</code> => <code>e</code></li>\n</ul>\n\n<p>Although we are presumably testing <code>b</code> because it gives us some useful insight into what would be appropriate (or even safe) to do next, none of that insight is mediated via the type system: the idea that <code>b</code>'s truth justifies <code>t</code> and its falsity justifies <code>e</code> is missing, despite being critical.</p>\n\n<p>Plain old Hindley-Milner does give us one means to ensure some consistency. Whenever we have a polymorphic function</p>\n\n<pre><code>f :: forall a. r[a] -&gt; s[a] -&gt; t[a]\n</code></pre>\n\n<p>we must instantiate <code>a</code> consistently: however the first argument fixes <code>a</code>, the second argument must play along, and we learn something useful about the result while we are at it. Allowing data at the type level is useful because some forms of consistency (e.g. lengths of things) are more readily expressed in terms of data (numbers).</p>\n\n<p>But the real breakthrough is GADT pattern matching, where the type of a pattern can <em>refine</em> the type of the argument it matches. You have a vector of length <code>n</code>; you look to see whether it's nil or cons; now you know whether <code>n</code> is zero or not. This is a form of testing where the type of the code in each case is more specific than the type of the whole, because in each case something which has been <em>learned</em> is reflected at the type level. It is <strong>learning by testing</strong> which makes a language dependently typed, at least to some extent.</p>\n\n<p>Here's a silly game to play, whatever typed language you use. Replace every type variable and every primitive type in your type expressions with 1 and evaluate types numerically (sum the sums, multiply the products, <code>s -&gt; t</code> means <code>t</code>-to-the-<code>s</code>) and see what you get: if you get 0, you're a logician; if you get 1, you're a software engineer; if you get a power of 2, you're an electronic engineer; if you get infinity, you're a programmer. What's going on in this game is a crude attempt to measure the information we're managing and the choices our code must make. Our usual type systems are good at managing the \"software engineering\" aspects of coding: unpacking and plugging together components. But as soon as a choice has been made, there is no way for types to observe it, and as soon as there are choices to make, there is no way for types to guide us: non-dependent type systems approximate all values in a given type as the same. That's a pretty serious limitation on their use in bug prevention.</p>\n"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 1, "accepted_answer_id": 32819712, "answer_count": 4, "score": 5, "last_activity_date": 1443432664, "creation_date": 1443351605, "last_edit_date": 1443352965, "question_id": 32807193, "link": "https://stackoverflow.com/questions/32807193/simple-dependent-type-example-in-haskell-for-dummies-how-are-they-useful-in-pra", "title": "Simple dependent type example in Haskell for Dummies. How are they useful in practice in Haskell? Why should I care about dependent types ?", "body": "<p>I hear a lot about dependent types nowadays and I heard that DataKinds is somehow related to dependent typing (but I am not sure about this... just heard it on a Haskell Meetup).</p>\n\n<p>Could someone illustrate with a super simple Haskell example what dependent typing is and what is it good for ?</p>\n\n<p>On wikipedia it is written that dependent types can help prevent bugs. Could you give a simple example about how dependent types in Haskell can prevent bugs?</p>\n\n<p>Something that I could start using in five minutes right now to prevent bugs in my Haskell code?</p>\n\n<p>Dependent types are basically functions from values to types, how can this be used in practice? Why is that good ?</p>\n"}, {"tags": ["haskell", "reactive-programming", "frp", "reactive-banana"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443354281, "post_id": 32806125, "comment_id": 53451836, "body": "how about if you provided a self contained reproduction of the problem? an FP Complete project perhaps, or at least a full self contained source code."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443354732, "post_id": 32806125, "comment_id": 53451969, "body": "One of the things I am trying to understand about Haskell and fp in general is if it is sometimes enough giving functions signatures to describe the problem itself. Anyway I will try to write something in fpcomplete."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1443356921, "post_id": 32806125, "comment_id": 53452505, "body": "Enough to describe the problem is not the same as enough to reproduce and play with the problem in a sandbox."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443363538, "post_id": 32806125, "comment_id": 53454497, "body": "I have created a project on fpcomplete although I cannot get the cabal conf to work"}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443367298, "post_id": 32806125, "comment_id": 53455648, "body": "hmm it looks it is just this: <code>accumB initialState $ doSomeTransformation &lt;$ (remoteValueB &lt;@ myButton)</code>"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443370555, "post_id": 32806125, "comment_id": 53456726, "body": "So did you resolve this? If yes, be sure to post it as an answer not just comment."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443383186, "post_id": 32806125, "comment_id": 53460788, "body": "No, it didn&#39;t solve. If it compiles doesn&#39;t meant it work."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443387270, "post_id": 32806125, "comment_id": 53462083, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/90747/discussion-between-erik-allik-and-randomize\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 1, "creation_date": 1443473312, "post_id": 32825323, "comment_id": 53498926, "body": "wow very clear explanation- unfortunately I can vote up only once :)"}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 2, "last_activity_date": 1443507051, "last_edit_date": 1443507051, "creation_date": 1443449914, "answer_id": 32825323, "question_id": 32806125, "link": "https://stackoverflow.com/questions/32806125/reactive-banana-how-to-use-values-from-a-remote-api-and-merge-them-in-the-event/32825323#32825323", "title": "Reactive Banana: how to use values from a remote API and merge them in the event stream", "body": "\n\n<p><strong>Short answer:</strong> the transform function needs to take one more argument, the value from the API:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>transformState v (AppState x) = AppState $ x + v\n</code></pre>\n\n<p>and you need to use <code>&lt;$&gt;</code> (i.e. apply function) instead of <code>&lt;$</code> (i.e. overwrite with constant value):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>accumB (AppState 0) $ transformState &lt;$&gt; remoteValueB &lt;@ ebt\n</code></pre>\n\n<p><strong>Long answer:</strong></p>\n\n<p><em>Note: I've renamed/changed a few things so please read my explanation accordingly</em></p>\n\n<p>What needs to be changed is the way you fold over the incoming values using <code>accumB</code>. The way <code>accumB</code> works is that it applies a sequence of functions <code>a -&gt; a</code> to a seed value <code>a</code>, to compute a final value of type <code>a</code>. The way you are currently folding over the API values is by always applying the app state count increment function to the initial state, completely throwing away the incoming value (by using <code>&lt;$</code>). Instead you need to <em>map</em> the incoming value not <em>replace</em> it, using <code>&lt;$&gt;</code>. What do you need to map the value to? A function (as per the type of <code>accumB</code>)! And that function is <code>transformValue eventValue :: AppState -&gt; AppState</code>.</p>\n\n<p>A lists and folds based example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Frp&gt; data State = State Int deriving Show\n*Frp&gt; let transform x (State c) = State $ x + c\n*Frp&gt; let xs = [1, 2, 3, 4, 5]                       -- the API values\n*Frp&gt; let xsE = transform &lt;$&gt; xs :: [State -&gt; State] -- the event stream\n*Frp&gt; let accumB = foldr ($)\n*Frp&gt; accumB (State 0) xsE\nState 15\n</code></pre>\n\n<p>(don't forget that <code>a &lt;$&gt; b</code> is the same as <code>fmap a b</code>, or just <code>map a b</code> in the case of lists)</p>\n\n<p>Now consider how you are currently \"overwriting\" any events from <code>remoteValueB &lt;@ ebt</code> with the (function) constant <code>transformState</code>, which means that all the overwritten events that arrive always hold the same content: the <code>transformState</code> function.</p>\n\n<p>Instead, what you want is to map the incoming values to some actual functions, for example one that takes the old state and combine it to the arrived value and yields a new state value:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>remoteValueE :: Event t Int\nremoteValueE = remoteValueB &lt;@ ebt\n\ntransformsE :: Event t (AppState -&gt; AppState)\ntransformsE = transformState &lt;$&gt; remoteValueE\n\ncoreOfTheApp :: Behavior t AppState\ncoreOfTheApp = accumB initialState $ transformsE\n</code></pre>\n\n<p>I've also changed <code>getRemoteApiValue</code> to return a changing value to imitate a real API. So with some modifications to your code, here's something that works:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import System.Random\n\ntype RemoteValue = Int\n\n-- generate a random value within [0, 10)\ngetRemoteApiValue :: IO RemoteValue\ngetRemoteApiValue = (`mod` 10) &lt;$&gt; randomIO\n\ndata AppState = AppState { count :: Int } deriving Show\n\ntransformState :: RemoteValue -&gt; AppState -&gt; AppState\ntransformState v (AppState x) = AppState $ x + v\n\nmain :: IO ()\nmain = start $ do\n    f        &lt;- frame [text := \"AppState\"]\n    myButton &lt;- button f [text := \"Go\"]\n    output   &lt;- staticText f []\n\n    set f [layout := minsize (sz 300 200)\n                   $ margin 10\n                   $ column 5 [widget myButton, widget output]]\n\n    let networkDescription :: forall t. Frameworks t =&gt; Moment t ()\n        networkDescription = do    \n          ebt &lt;- event0 myButton command\n\n          remoteValueB &lt;- fromPoll getRemoteApiValue\n          myRemoteValue &lt;- changes remoteValueB\n\n          let\n            events = transformState &lt;$&gt; remoteValueB &lt;@ ebt\n\n            coreOfTheApp :: Behavior t AppState\n            coreOfTheApp = accumB (AppState 0) events\n\n          sink output [text :== show &lt;$&gt; coreOfTheApp] \n\n    network &lt;- compile networkDescription    \n    actuate network\n</code></pre>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 2, "accepted_answer_id": 32825323, "answer_count": 1, "score": 5, "last_activity_date": 1443507051, "creation_date": 1443343539, "last_edit_date": 1443430594, "question_id": 32806125, "link": "https://stackoverflow.com/questions/32806125/reactive-banana-how-to-use-values-from-a-remote-api-and-merge-them-in-the-event", "title": "Reactive Banana: how to use values from a remote API and merge them in the event stream", "body": "\n\n<p>I am using Reactive-Banana in a WX interface.\nI need to retrieve a value from an external service API when a button is pressed.</p>\n\n<p>I have a generic <code>Behavior</code> based on the data type <code>AppState</code> that \u201caccums\u201d the transformed changes based on a function transformation (<code>doSomeTransformation</code>). The values that get transformed are transported by the events and they come from a remote API (<code>getRemoteValue</code>) when a button on the interface is pressed. I have written a slim version of the code that represents the essential part:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main where\n\n{-# LANGUAGE ScopedTypeVariables #-} -- allows \"forall t. Moment t\"\n\nimport Graphics.UI.WX hiding (Event)\nimport Reactive.Banana\nimport Reactive.Banana.WX\n\n{-----------------------------------------------------------------------------\n    Main\n------------------------------------------------------------------------------}\ndata AppState = AppState {\n    count :: Int\n} deriving (Show)\n\ntype String = [Char]\n\nmain :: IO ()\nmain = start $ do\n    f        &lt;- frame [text := \"AppState\"]\n    myButton &lt;- button f [text := \"Go\"]\n    output   &lt;- staticText f []\n\n    set f [layout := margin 10 $\n            column 5 [widget myButton, widget output]]\n\n    let networkDescription :: forall t. Frameworks t =&gt; Moment t ()\n        networkDescription = do\n\n        ebt   &lt;- event0 myButton command\n\n        remoteValueB &lt;- fromPoll getRemoteApiValue\n        myRemoteValue &lt;- changes remoteValueB\n\n        let            \n            doSomeTransformation :: AppState -&gt; AppState\n            doSomeTransformation ast = ast { count = count ast }\n\n            coreOfTheApp :: Behavior t AppState\n            coreOfTheApp = accumB initialState $ (doSomeTransformation to combine with myRemoteValue) &lt;$ ebt\n\n        sink output [text :== show &lt;$&gt; coreOfTheApp]\n\n    network &lt;- compile networkDescription    \n    actuate network\n\ngetRemoteApiValue :: IO Int\ngetRemoteApiValue = return 5\n</code></pre>\n\n<p>and the cabal conf:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>name:                brg\nversion:             0.1.0.0\nsynopsis:            sample frp gui\n-- description:\nlicense:             PublicDomain\nlicense-file:        LICENSE\nauthor:              me\nmaintainer:          me@gmail.com\n-- copyright:\ncategory:            fun\nbuild-type:          Simple\n-- extra-source-files:\ncabal-version:       &gt;=1.10\n\nexecutable bgr\n  main-is:             Main.hs\n  -- other-modules:\n  -- other-extensions:\n  build-depends:       base &gt;=4.7 &amp;&amp; &lt;4.8\n                       , text\n                       , wx ==0.92.0.0\n                       , wxcore ==0.92.0.0\n                       , transformers-base\n                       , reactive-banana &gt;=0.9 &amp;&amp; &lt;0.10\n                       , reactive-banana-wx ==0.9.0.2\n  hs-source-dirs:      src\n  default-language:    Haskell2010\n  ghc-options:         -Wall -O2\n</code></pre>\n\n<p>My problem here is how to compose <code>doSomeTransformation</code> and <code>myRemoteValue</code> in a way that I can use the remote API value as normal event value.\n<code>changes</code> from banana-reactive has the following signature:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>changes :: Frameworks t =&gt; Behavior t a -&gt; Moment t (Event t (Future a))\n</code></pre>\n\n<p>which it will wrap my <code>IO Int</code> from <code>getRemoteApiValue</code>.</p>\n\n<p>So basically how can I go from:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>IO Int -&gt; Moment t (Event t (Future AppState)) -&gt; AppState\n</code></pre>\n\n<p>?</p>\n\n<p>BTW I am not sure if it is cleaner having this different function signature:\n<code>doSomeTransformation :: Int -&gt; AppState -&gt; AppState</code>, where the <code>Int</code> value is represented by the API returned value. It sounds like two <code>Behavior</code>s and one stream. Maybe a bad way to solve the problem?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1443333624, "post_id": 32804717, "comment_id": 53447151, "body": "This is at least the second question I&#39;ve seen recently that had the <a href=\"https://stackoverflow.com/questions/tagged/dictionary\">dictionary</a> tag but had nothing to do with dictionaries. I&#39;m curious if you have any insight as to why that might be happening."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1443379931, "post_id": 32804717, "comment_id": 53459796, "body": "Please don&#39;t edit your question to remove essential information like the definition of <code>Car</code>. I have reverted your edit."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1443330860, "creation_date": 1443330860, "answer_id": 32804823, "question_id": 32804717, "link": "https://stackoverflow.com/questions/32804717/haskell-how-to-use-map-to-return-a-list/32804823#32804823", "title": "Haskell how to use map to return a list?", "body": "<p>The <code>Car</code> type is equivalent (mathematicians would use the term <em>isomorphic</em>) to lists in Haskell specialized to the <code>Make</code> data type.  Haskell lists are defined as</p>\n\n<pre><code>data [a] = a : [a] | []\n</code></pre>\n\n<p>Where <code>:</code> and <code>[]</code> are the constructors.  If we give them more human readable names it might make more sense</p>\n\n<pre><code>data List a = Cons a (List a) | Empty\n</code></pre>\n\n<p>All I've done is substitute <code>[a]</code> for <code>List a</code>, <code>:</code> for <code>Cons</code>, and <code>[]</code> for <code>Empty</code>.  If we specialize this to a specific type, such as <code>Int</code>, we would have</p>\n\n<pre><code>data List = Cons Int List | Empty\n</code></pre>\n\n<p>Now we see to correlation between Haskell lists and your <code>Car</code> type, it's just that <code>Car = List</code>, <code>Model = Cons</code>, and <code>Tail = Empty</code>.</p>\n\n<p>Your <code>makeList</code> function is actually just converting a <code>Car</code> style list into a <code>[]</code> style list, <code>map</code> isn't necessary (and wouldn't be useful, since it only works on <code>[]</code> style lists).  Instead, you'll just need to do the right substitutions</p>\n\n<pre><code>makeList :: Car -&gt; [Make]\nmakeList Tail = []\nmakeList (Car make nextCar) = ...\n</code></pre>\n\n<p>I don't want to give everything away since this sounds like homework, but at this point you simply need to make the second clause of <code>makeList</code> recursively construct a normal <code>[]</code> style list.  Again, the big hints are \"recursively\" and \"<code>[]</code> style list\".</p>\n"}], "owner": {"reputation": 1, "user_id": 5380682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde94b8b99498597800d473b63b42453?s=128&d=identicon&r=PG&f=1", "display_name": "SoCalFan", "link": "https://stackoverflow.com/users/5380682/socalfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1443379900, "creation_date": 1443329670, "last_edit_date": 1443379900, "question_id": 32804717, "link": "https://stackoverflow.com/questions/32804717/haskell-how-to-use-map-to-return-a-list", "title": "Haskell how to use map to return a list?", "body": "<p>I am a bit confused on how to return a list of something in a data type. I figure I have to use the map function, but am unsure how to use it in this context. For example, if I have the data type below (weird I know, but this specifically), how would I write a function</p>\n\n<pre><code>makeList :: Car -&gt; [Make]\nmakeList map f ???\n</code></pre>\n\n<p>that returns a list of makes of all the cars in the input (like below), and an empty list [ ] if \"makeList Tail\" is given.</p>\n\n<pre><code>data Car = Model Make Car | Tail\n\n&gt; makeList (Car Audi (Car Porsche Tail))\n  [Audi,Porsche]\n&gt; makeList Tail\n  [ ]\n</code></pre>\n"}, {"tags": ["haskell", "functor", "maybe"], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 7, "last_activity_date": 1443327002, "last_edit_date": 1443327002, "creation_date": 1443326689, "answer_id": 32804460, "question_id": 32804443, "link": "https://stackoverflow.com/questions/32804443/manipulating-a-value-in-a-maybe/32804460#32804460", "title": "Manipulating a value in a Maybe", "body": "<p><code>Just 3</code> has type <code>Maybe Int</code>.  You can either manipulate the int <em>within</em> the <code>Maybe</code>, the simplest form of that being <code>fmap</code>, e.g.</p>\n\n<pre><code>ghci&gt; fmap (\\x -&gt; x + 1) (Just 3) \nJust 4\n</code></pre>\n\n<p>which preserves the structure of the <code>Maybe</code> type, that is to say, it preserves <code>Nothing</code>s</p>\n\n<pre><code>ghci&gt; fmap (\\x -&gt; x + 1) Nothing\nNothing\n</code></pre>\n\n<p>Or you can define a function which pattern matches:</p>\n\n<pre><code>doThing :: Maybe Int -&gt; String\ndoThing (Just x) = \"I got \" ++ show x\ndoThing Nothing  = \"I didn't get anything\"\n\nghci&gt; doThing (Just 3)\n\"I got 3\"\n</code></pre>\n\n<p>There is also a useful function called <code>fromMaybe</code> (defined in <code>Data.Maybe</code>):</p>\n\n<pre><code>fromMaybe :: a -&gt; Maybe a -&gt; a\n</code></pre>\n\n<p>It will extract the value from a <code>Maybe</code>, but you have to provide it with what to return if it turned out to be <code>Nothing</code>:</p>\n\n<pre><code>ghci&gt; import Data.Maybe (fromMaybe)\nghci&gt; fromMaybe 0 (Just 3)\n3\nghci&gt; fromMaybe 0 Nothing\n0\n</code></pre>\n\n<p>Note that in all of these cases, we have to decide what to do if the value is <code>Nothing</code>, which is the essential feature of the <code>Maybe</code> type.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4933255"}, "edited": false, "score": 0, "creation_date": 1443328485, "post_id": 32804610, "comment_id": 53446330, "body": "Indeed, wise one. To eat my cake, I must have it! :)"}, {"owner": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 0, "creation_date": 1443336888, "post_id": 32804610, "comment_id": 53447712, "body": "Shouldn&#39;t the last equation return <code>def</code> rather than <code>Nothing</code>?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1443337524, "last_edit_date": 1443337524, "creation_date": 1443328368, "answer_id": 32804610, "question_id": 32804443, "link": "https://stackoverflow.com/questions/32804443/manipulating-a-value-in-a-maybe/32804610#32804610", "title": "Manipulating a value in a Maybe", "body": "<p>If I give you a recipe for chocolate cake, you can't take off the recipe and just eat the cake as you see fit. You first have to follow the recipe.</p>\n\n<p>Similarly, if I give you a <code>Maybe Int</code>, you can't just take off the <code>Maybe</code> and manipulate the <code>Int</code>; you must first inspect it to see whether you got <code>Just</code> an <code>Int</code> you can manipulate or <code>Nothing</code>.</p>\n\n<p>The most fundamental way to perform this inspection, which all other techniques use, is pattern matching. The <code>fromMaybe</code> function luqui suggests will serve as a good example. It turns a <code>Maybe a</code> into an <code>a</code>, using the given default if it finds <code>Nothing</code>.</p>\n\n<pre><code>fromMaybe :: a -&gt; Maybe a -&gt; a\nfromMaybe def (Just val) = val\nfromMaybe def Nothing = def\n</code></pre>\n\n<p>Pro tip: as you go through the process of learning Haskell, you will find several good opportunities to think back on the parable of the cake.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1443373893, "post_id": 32805332, "comment_id": 53457770, "body": "Yes, it was strategic :).  Note that in the pure subset of Haskell (the best part ;), exceptions can not be caught, so getting this one wrong means your whole program crashes.  Also the error message is crap, no indication as to where and under what conditions is crashed."}], "tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": false, "score": 1, "last_activity_date": 1443336641, "creation_date": 1443336641, "answer_id": 32805332, "question_id": 32804443, "link": "https://stackoverflow.com/questions/32804443/manipulating-a-value-in-a-maybe/32805332#32805332", "title": "Manipulating a value in a Maybe", "body": "<p>Another function that might be useful, and which is actually in the <code>Prelude</code>, is</p>\n\n<pre><code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b\n</code></pre>\n\n<p>which is very similar to <code>fromMaybe</code> but lets you use a function to work on the variable inside your <code>Just</code> instead (you need to give a default that matches the type of the output of the function for if you have <code>Nothing</code>). Example:</p>\n\n<pre><code>maybeShow = maybe \"Got nothing...\" show\n\nmaybeShow $ Just 3  -- gives \"3\"\nmaybeShow $ Nothing -- gives \"Got nothing...\"\n</code></pre>\n\n<p>And then there is a function which the other answerers seem to have strategically avoided :) But I think it should be here for completeness:</p>\n\n<pre><code>import Data.Maybe (fromJust)\nfromJust :: Maybe a -&gt; a\n</code></pre>\n\n<p>which takes a value out of its <code>Just</code> wrapper. The problem with this function is it's a partial function, i.e. it's not defined for <code>Nothing</code> values:</p>\n\n<pre><code>fromJust $ Just 3  -- gives 3\nfromJust $ Nothing -- gives *** Exception: Maybe.fromJust: Nothing\n</code></pre>\n\n<p>so as you can see this function is kind of risky to use and it's definitely not a clean solution. Still, if you're <em>sure</em> you will not get <code>Nothing</code>, or if you're just playing around and you want to get rid of annoying <code>Maybe</code>s, it can be very useful in practice.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4933255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 32804460, "answer_count": 3, "score": 0, "last_activity_date": 1443344368, "creation_date": 1443326396, "last_edit_date": 1443344368, "question_id": 32804443, "link": "https://stackoverflow.com/questions/32804443/manipulating-a-value-in-a-maybe", "title": "Manipulating a value in a Maybe", "body": "<p>A function in some code I'm writing returns</p>\n\n<pre><code>Just 3\n</code></pre>\n\n<p>What I'd like is to remove the Just and manipulate 3 as I please.</p>\n\n<p>I must confess to not understanding the Just syntax, but while I work that out, I'd appreciate some help with this.</p>\n"}, {"tags": ["haskell", "unsafe"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443321903, "post_id": 32804032, "comment_id": 53445439, "body": "&quot;Unsafe&quot; has no formal definition. I believe it&#39;s used as &quot;can break the normal rules of the language&quot;."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 5, "creation_date": 1443322236, "post_id": 32804032, "comment_id": 53445483, "body": "Looking at that wiki article, calling <code>seq</code> unsafe is a bit of an extreme position."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1443365373, "post_id": 32804032, "comment_id": 53455049, "body": "@melpomene, nowadays, &quot;unsafe&quot; is a Humpty Dumpty word that means &quot;can break the normal rules of&quot; the language the speaker thinks they wish they were programming in, yet for some reason are not. It used to mean dfeuer&#39;s 1-4 (definitely not 5 or 6)."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443323771, "post_id": 32804182, "comment_id": 53445668, "body": "<code>coerce</code> can affect function arity? I&#39;d have expected arity analysis to see through <code>newtype</code>s..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1443324201, "post_id": 32804182, "comment_id": 53445712, "body": "@OrjanJohansen, I guess I didn&#39;t describe that quite right. It can change the arity of a function using it compared to the reference implementation. <code>fmap f (Identity x) = Identity (f x)</code> gives <code>fmap</code> arity 2. <code>fmap = coerce</code> gives it arity 1. So someone relying on that having arity 2 (by using shady <code>seq</code>) will get surprised."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1443325667, "post_id": 32804182, "comment_id": 53445918, "body": "You missed cases that sacrifice memory safety, like those that show up in Vector or Array."}, {"owner": {"reputation": 704, "user_id": 939572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadfb25285dc4e9a3caf81e2277d77b?s=128&d=identicon&r=PG", "display_name": "GarethR", "link": "https://stackoverflow.com/users/939572/garethr"}, "edited": false, "score": 0, "creation_date": 1443364913, "post_id": 32804182, "comment_id": 53454921, "body": "Excellent answer. You forgot to add the notion of Safe Haskell. I think your notion 1 through 3 would be considered unsafe by Safe Haskell. It may be worth reading up on it because the Safe Haskell authors have clearly thought deeply on safety."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 704, "user_id": 939572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadfb25285dc4e9a3caf81e2277d77b?s=128&d=identicon&r=PG", "display_name": "GarethR", "link": "https://stackoverflow.com/users/939572/garethr"}, "edited": false, "score": 0, "creation_date": 1443366085, "post_id": 32804182, "comment_id": 53455249, "body": "@GarethR, I&#39;ll add it, but that is something of am inverse, because it is conservative."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443367660, "post_id": 32804182, "comment_id": 53455746, "body": "Safe Haskell also disallows some things that fit in point 6, such as extensions that can circumvent module export boundaries (Template Haskell, generalized newtype deriving) or change the behavior of imported code (rules, overlapping instances)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443373413, "post_id": 32804182, "comment_id": 53457630, "body": "I believe that recent versions of GHC will not be affected by the &#39;arity&#39; issue because of <a href=\"http://www.joachim-breitner.de/publications/CallArity-TFP.pdf\" rel=\"nofollow noreferrer\">Call Arity</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443374070, "post_id": 32804182, "comment_id": 53457833, "body": "@user2407038, that&#39;s a different issue altogether. The Call Arity analysis is about finding situations where the compiler can raise its estimation of the arity of a function without changing meaning, to enable certain optimizations that mostly affect folds. Here the code and meaning are different. Try each of the <code>fmap</code> implementations I described with <code>fmap undefined `seq` 4</code>. Note that <code>base-4.8</code> uses the <code>coerce</code>-based implementation, so if you want to play with this in different versions you should write your own copy of <code>Identity</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 18, "last_activity_date": 1443420738, "last_edit_date": 1495539867, "creation_date": 1443323346, "answer_id": 32804182, "question_id": 32804032, "link": "https://stackoverflow.com/questions/32804032/what-is-an-unsafe-function-in-haskell/32804182#32804182", "title": "What is an unsafe function in Haskell?", "body": "<p>There are several notions of \"unsafe\" in Haskell.</p>\n\n<ol>\n<li><p>Calculating the value leads to I/O. The prime suspect here is <code>unsafePerformIO</code>. It's a bit controversial whether lazy I/O and <code>unsafeInterleaveIO</code> should be considered unsafe by this definition.</p></li>\n<li><p>Something breaks the type system. The prime suspect is <code>unsafeCoerce</code>, but <code>unsafePerformIO</code> can do it too.</p></li>\n<li><p>Something breaks memory safety without breaking the type system (thanks to Carl for reminding me). The prime suspects are <code>unsafe</code> array or vector indexing operations and incorrect use of the foreign function interface.</p></li>\n<li><p>The result of the calculation depends on the order of evaluation. The prime suspect is <code>unsafePerformIO</code> but <code>unsafeInterleaveST</code> can certainly do it too.</p></li>\n<li><p>Evaluation can lead to an exception or infinite loop. This is a relatively mild sort of unsafety ... except when it's not.</p></li>\n<li><p>Something breaks the conventions (\"laws\") Haskell programmers rely on to reason about their code. Whether this should be considered \"unsafe\" is subject to debate. Examples: applying <code>seq</code> to a function, using <code>coerce</code> in such a manner as to change the arity of a function relative to its reference implementation and cause a problem if someone applies <code>seq</code> to what was previously a partial application and now can possibly be bottom (there are good performance reasons to do this in some cases), writing class instances that break functor, applicative, monad, traversable, etc., laws. Expecting arguments to satisfy pre-conditions but not checking that they do (e.g., functions that quickly turn ascending lists into sets or maps).</p></li>\n</ol>\n\n<h3>Safe Haskell</h3>\n\n<p>To help programmers control some of these forms of unsafety, the Safe Haskell system classifies modules as safe or unsafe depending on the imports and language extensions they use. I haven't studied the details, but GarethR <a href=\"https://stackoverflow.com/questions/32804032/what-is-an-unsafe-function-in-haskell/32804182#comment53454921_32804182\">indicates</a> that</p>\n\n<blockquote>\n  <p>I think your notion 1 through 3 would be considered unsafe by Safe Haskell. It may be worth reading up on it because the Safe Haskell authors have clearly thought deeply on safety.</p>\n</blockquote>\n\n<p>and \u00d8rjan Johansen <a href=\"https://stackoverflow.com/questions/32804032/what-is-an-unsafe-function-in-haskell/32804182#comment53455746_32804182\">indicates</a> that</p>\n\n<blockquote>\n  <p>Safe Haskell also disallows some things that fit in point 6, such as extensions that can circumvent module export boundaries (Template Haskell, generalized newtype deriving) or change the behavior of imported code (rules, overlapping instances).</p>\n</blockquote>\n\n<p>A programmer can mark a module <code>Safe</code> to indicate that they want GHC to check that it is safe, <code>Unsafe</code> to indicate that it is not safe, or <code>Trustworthy</code> to indicate that the author claims to believe that its API is safe to use despite the fact that its implementation uses unsafe features.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3090458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WhfLf.png?s=128&g=1", "display_name": "sp55aa", "link": "https://stackoverflow.com/users/3090458/sp55aa"}, "is_accepted": false, "score": 2, "last_activity_date": 1528105974, "creation_date": 1528105974, "answer_id": 50677832, "question_id": 32804032, "link": "https://stackoverflow.com/questions/32804032/what-is-an-unsafe-function-in-haskell/50677832#50677832", "title": "What is an unsafe function in Haskell?", "body": "<p>from <a href=\"https://wiki.haskell.org/Performance/FFI\" rel=\"nofollow noreferrer\">haskell FFI wiki</a>:</p>\n\n<blockquote>\n  <p>If you annotate a foreign import declaration with the <strong>unsafe</strong> keyword, this indicates to the compiler that (1) the call will not invoke another Haskell function, directly or indirectly, and (2) you don't mind if any other running Haskell threads in the system are blocked for the duration of the call.</p>\n</blockquote>\n"}], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 32804182, "answer_count": 2, "score": 10, "last_activity_date": 1528105974, "creation_date": 1443321643, "question_id": 32804032, "link": "https://stackoverflow.com/questions/32804032/what-is-an-unsafe-function-in-haskell", "title": "What is an unsafe function in Haskell?", "body": "<p>I believe that an unsafe function is a function that says that it will return a value of some type, but that it can actually throw an exception and end the execution therefore not returning any value at all, but I'm not sure.</p>\n\n<p>Or could it be that an unsafe function is a function that can return a value of other type than the declared in the signature? Wouldn't that be a <em>weakly typed</em> function?</p>\n\n<p>Or are <em>weakly typed</em> and <em>unsafe</em> synonyms in Haskell?</p>\n\n<p>This may be a silly question, but I couldn't find a straightforward answer.</p>\n\n<p>I checked the documentation of <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:readLn\"><code>readLn</code></a> hoping to see a reference to unsafe functions, but there wasn't any.</p>\n\n<p>This article, <a href=\"https://wiki.haskell.org/Unsafe_functions\">Unsafe functions</a>, says something about breaking the type system, but it doesn't specify in which manner; through exceptions?, through returning values of the wrong type?</p>\n\n<p>So, what is an unsafe function in Haskell?</p>\n"}, {"tags": ["haskell", "constraints", "type-families", "type-variables"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443308492, "post_id": 32802680, "comment_id": 53442998, "body": "What happens if you make <code>callTree</code> an argument to <code>FooCtx</code>?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1443310876, "post_id": 32802680, "comment_id": 53443501, "body": "If you ask for the type of <code>foo</code> you&#39;ll see it is <code>SomeTypeFunc o ~ OtherTypeFunc i =&gt; i-&gt; o</code>. References to <code>callTree</code> are removed by simplification. In fact, if your <code>foo</code> type <i>couldn&#39;t</i> be simplified to get rid of <code>callTree</code>, GHC would likely complain about amiguous types."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443314265, "post_id": 32803154, "comment_id": 53444100, "body": "Huh. I thought that <code>forall</code> was implicit for some reason. Oops."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443315898, "post_id": 32803154, "comment_id": 53444402, "body": "Wait a minute ... can that quantified constraint be satisfied?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443316164, "post_id": 32803154, "comment_id": 53444441, "body": "@dfeuer I should think so, note that now the <code>forall</code> scopes over the <code>=&gt; value</code> part too, so it just says that <i>if</i> <code>callTree</code> is equal to both of the other types, then you have a <code>value</code>. As you noted, if you ask for <code>:t foo&#39;</code>, <code>callTree</code> gets removed; this happens with this version as well."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443316938, "post_id": 32803154, "comment_id": 53444576, "body": "Oh, I didn&#39;t notice you scrapped the constraint type synonym in favor of a normal one. Whoops!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443373607, "post_id": 32803154, "comment_id": 53457684, "body": "Note that the type of <code>foo&#39;</code> is <i>still</i> <code>OtherTypeFunc input ~ SomeTypeFunc output =&gt; input -&gt; output</code>. I believe that this trick only works when the extra type variable is eliminated by simplification."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 6, "last_activity_date": 1443311685, "last_edit_date": 1443311685, "creation_date": 1443310972, "answer_id": 32803154, "question_id": 32802680, "link": "https://stackoverflow.com/questions/32802680/type-aliases-for-constraints-dont-share-the-same-variable-binding-behavior-as-c/32803154#32803154", "title": "Type Aliases for Constraints don&#39;t share the same variable binding behavior as Contexts", "body": "<p>There is no real inconsistency, it's just that</p>\n\n<ol>\n<li><p>Free type variables in a type signature have <code>forall</code> quantifiers automatically added, so the first case is really equivalent to</p>\n\n<pre><code>foo :: forall callTree output input. ( callTree ~ SomeTypeFunc output\n       , OtherTypeFunc input ~ callTree\n       ) =&gt; input -&gt; output\n</code></pre></li>\n<li><p>All free type variables on the right side of a <code>type</code> declaration must be parameters, you cannot have any that are not in scope.</p></li>\n</ol>\n\n<p>This is not specific to constraint kinds, except for the unfortunate fact that you cannot apply <code>forall</code> quantifiers directly to a constraint, which means I don't know a <em>general</em> workaround to make such a constraint type declaration work.</p>\n\n<p>In your particular example, <code>( OtherTypeFunc input ~ SomeTypeFunc output )</code> should be equivalent, but I assume you're really interested in a more complicated example where such a rewriting doesn't work.</p>\n\n<p>I can think of a different kind of workaround that changes the parameters to the type declaration in a different way, by including the value on the right side of the constraint:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, ConstraintKinds, FlexibleContexts, RankNTypes #-}\n\ntype family OtherTypeFunc a\ntype family SomeTypeFunc a\n\ntype FooCtx input output value =\n  forall callTree. ( callTree ~ SomeTypeFunc output\n  , OtherTypeFunc input ~ callTree\n  ) =&gt; value\n\n-- This now works\nfoo' :: FooCtx input output ( input -&gt; output )\n\nfoo' = undefined\n</code></pre>\n"}], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 32803154, "answer_count": 1, "score": 4, "last_activity_date": 1443311685, "creation_date": 1443306697, "question_id": 32802680, "link": "https://stackoverflow.com/questions/32802680/type-aliases-for-constraints-dont-share-the-same-variable-binding-behavior-as-c", "title": "Type Aliases for Constraints don&#39;t share the same variable binding behavior as Contexts", "body": "<p>I've been playing with <code>-XConstraintKinds</code> to help alleviate excessively verbose contexts, and have found an interesting inconsistency in terms of variable binding:</p>\n\n<pre><code>{-# LANGUAGE\n    TypeFamilies\n  , ConstraintKinds\n  , FlexibleContexts\n  #-}\n\n-- works\nfoo :: ( callTree ~ SomeTypeFunc output\n       , OtherTypeFunc input ~ callTree\n       ) =&gt; input -&gt; output\n\n\ntype FooCtx input output =\n  ( callTree ~ SomeTypeFunc output\n  , OtherTypeFunc input ~ callTree\n  )\n\n-- doesn't work\nfoo' :: FooCtx input output =&gt;\n        input -&gt; output\n</code></pre>\n\n<p>Is there a work-around for this, other than bringing <code>callTree</code> to the top-level scope?</p>\n"}, {"tags": ["haskell", "ghci", "winghci"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1443294280, "post_id": 32800884, "comment_id": 53439067, "body": "I&#39;m not sure if I&#39;m understanding the problem correctly, but the backtick character is typically located on a key immediately to the left of the &quot;1&quot; key on most keyboards: <a href=\"http://i.stack.imgur.com/TOn1U.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/TOn1U.png</a>."}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1443294324, "post_id": 32800884, "comment_id": 53439079, "body": "My version of GHCi accepts the backtick directly from my keyboard (although my keyboard isn&#39;t EN-US), and also accepts it from pasting. If you&#39;re using Windows, run GHCi on Powershell instead of Prompt to use Ctrl+V for pasting."}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "edited": false, "score": 4, "creation_date": 1443294343, "post_id": 32800884, "comment_id": 53439088, "body": "Have an Italian keyboard, has a \\ left of 1, sorry"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443294480, "post_id": 32800884, "comment_id": 53439126, "body": "If you don&#39;t find another approach, you can always use GHCi through emacs, which has some other, more substantial, benefits."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1443294532, "post_id": 32800884, "comment_id": 53439139, "body": "This SuperUser question might help: <a href=\"http://superuser.com/q/667622/320921\">Italian keyboard: entering the tilde (~) and backtick (`) characters without changing keyboard layout</a>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1443294533, "post_id": 32800884, "comment_id": 53439140, "body": "Well, one thing to note is that backticks are never <i>necessary</i>. <code>x `mod` 7</code> is the same as <code>mod x 7</code>. Backticks are just a way to use a function in an infix manner. Also, these options don&#39;t sound particularly convenient, but here is some info on typing backticks on Italian keyboards: <a href=\"http://superuser.com/questions/598135/type-backtick-on-windows-italian-keyboard\" title=\"type backtick on windows italian keyboard\">superuser.com/questions/598135/&hellip;</a>"}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1443294683, "post_id": 32800884, "comment_id": 53439179, "body": "@mephy Powershell works as Cmd, no ctrl/v and no backticks in GHCi. Outside GHCi those characters are insertednormally. It&#39;s GHCi that &quot;eats&quot; them, it seems"}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "edited": false, "score": 0, "creation_date": 1443294967, "post_id": 32800884, "comment_id": 53439267, "body": "I know how to add ascii characters, that&#39;s not the question. It&#39;s about how to convince GHCi not to ignore them when I type them! GHCI seems to ignore quite a bit of what is typed in; all CTRL/*, all mouse clicks, all ALT/*** characters."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443295033, "post_id": 32800884, "comment_id": 53439292, "body": "Really, once you&#39;ve worked with Haskell in a properly configured emacs (a bit tricky to set up, I&#39;ll admit), even the pain of emacs will seem small compared to the benefits you get from near-real-time feedback from flycheck, HLint, etc. And mapping something to backtick will be pretty easy."}, {"owner": {"reputation": 1284, "user_id": 1402585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/455cf7e9fb66b1fc270eba25c32ffd5a?s=128&d=identicon&r=PG", "display_name": "JustGage", "link": "https://stackoverflow.com/users/1402585/justgage"}, "edited": false, "score": 2, "creation_date": 1443295165, "post_id": 32800884, "comment_id": 53439330, "body": "I would guess that this is more a problem of keyboard layouts + terminal encoding and not so much with <code>ghci</code> itself."}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "edited": false, "score": 0, "creation_date": 1443295380, "post_id": 32800884, "comment_id": 53439393, "body": "Everybody seems to think of it as a windows problem, it is NOT: it is GHCI that ignores a character typed correctly via the num-keypad. Guess I&#39;ll vave to follow David&#39;s advice and make changed in the tutorial examples. Thank you all."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1443295381, "post_id": 32800884, "comment_id": 53439394, "body": "@Martin Have you tried using WinGHCi? I think that still comes with the Haskell Platform and it has a GUI interface rather than using cmd."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443295469, "post_id": 32800884, "comment_id": 53439423, "body": "Off on a tangent: Do Ctrl+Insert and Shift+Insert work for copy-pasting in PowerShell+GHCi? (I vaguely remember having done that in the past.)"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "edited": false, "score": 1, "creation_date": 1443295643, "post_id": 32800884, "comment_id": 53439477, "body": "Whether a command window supports copy&amp;paste is independent of the shell. You can activate copy&amp;paste (and other good stuff) in the command window&#39;s setting dialog, accessed from it&#39;s system menu: left-click on the window icon in the top-left corner of the window, select settings."}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "reply_to_user": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "edited": false, "score": 0, "creation_date": 1443296005, "post_id": 32800884, "comment_id": 53439585, "body": "@Toxaris : It&#39;s NOT a windows problem, it&#39;s a GHCi problem"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "edited": false, "score": 0, "creation_date": 1443296170, "post_id": 32800884, "comment_id": 53439622, "body": "@Martin: Hmm. I can confirm that &quot;paste by Ctrl-V&quot; doesn&#39;t work in ghci. However, I just tried &quot;paste by right mouse click&quot; in a ghci running in a Windows command window and it works fine. ghci 7.8.3, Windows 8.1"}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "edited": false, "score": 0, "creation_date": 1443296323, "post_id": 32800884, "comment_id": 53439677, "body": "Use Win7, right click does not show the usual menu Select, paste, etc. not in Cmd, not in Powershell"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "edited": false, "score": 1, "creation_date": 1443296352, "post_id": 32800884, "comment_id": 53439694, "body": "I guess the underlying problem is that ghci uses readline (or maybe some Haskell port of readline, I forgot), which defines its own CTRL-Whatever key combinations. Maybe readline can be configured to give you a key combination to insert a backtick?"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "edited": false, "score": 0, "creation_date": 1443296422, "post_id": 32800884, "comment_id": 53439719, "body": "Did you activate &quot;quick edit mode&quot; and &quot;paste mode&quot; in the command window&#39;s settings? I&#39;m pretty sure they existed for at least a couple of Windows versions now."}, {"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1443296470, "post_id": 32800884, "comment_id": 53439738, "body": "Found WinGHCi after all, (it&#39;s not in the BIN map, so not on the PATH) and it works.  @David Young: formulate the answer and I&#39;ll mark it as correct"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1443296558, "post_id": 32800884, "comment_id": 53439771, "body": "@Martin Well, the existing answer recommends using WinGHCi so I would suggest marking that as correct."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443316161, "post_id": 32801066, "comment_id": 53444440, "body": "The windows console doesn&#39;t support CTRL-V for pasting (in fact, it doesn&#39;t support any keyboard shortcut for pasting at all) - except on Windows 10, it seems: <a href=\"http://stackoverflow.com/questions/131955/keyboard-shortcut-to-paste-clipboard-content-into-command-prompt-window-win-xp/31506358#31506358\" title=\"keyboard shortcut to paste clipboard content into command prompt window win xp\">stackoverflow.com/questions/131955/&hellip;</a>"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443363976, "post_id": 32801066, "comment_id": 53454618, "body": "Really? How annoying. I use CTRL-V with the command prompt in my Windows console all the time, but I now realized it is provided by <a href=\"http://mridgers.github.io/clink/\" rel=\"nofollow noreferrer\">mridgers.github.io/clink</a> not the vanilla console or command prompt. Sorry for my confusion."}], "tags": [], "owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "is_accepted": true, "score": 10, "last_activity_date": 1443364116, "last_edit_date": 1443364116, "creation_date": 1443295507, "answer_id": 32801066, "question_id": 32800884, "link": "https://stackoverflow.com/questions/32800884/how-can-i-insert-a-backtick-in-ghci/32801066#32801066", "title": "How can I insert a backtick in GHCi?", "body": "<p>I don't know how send a backtick to ghci if your keyboard doesn't have it. But this little technical issue shouldn't stop you from trying out Haskell!</p>\n\n<ul>\n<li><p>You can program in Haskell without backticks by using <code>f a b</code> instead of <code>a `f` b</code>. In your example, <code>mod x 7</code>.</p></li>\n<li><p>You can set your keyboard layout to us-american for programming. While it takes some practice to find the keys with the wrong labels on the physical keyboard, it can be convenient to have <code>[</code>, <code>]</code>, <code>{</code> and <code>}</code> more accessible, and in your case, have the backtick at all.</p></li>\n<li><p>You can paste the backtick from the clipboard. (Activate \"quick-edit mode\" and \"paste mode\" from the command window's settings, and then use the right mouse button to paste).</p></li>\n<li><p>Maybe using a wrapper around the command window helps? I sometimes use Console2 and sometimes <code>M-x shell</code> in Emacs.</p></li>\n<li><p>Maybe WinGHCi helps? It supports copy and paste, at least.</p></li>\n<li><p>See \u00d8rjan Johansen's answer for how to add a custom keybinding to ghci.</p></li>\n</ul>\n\n<p>Good luck with Haskell!</p>\n"}, {"comments": [{"owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "edited": false, "score": 1, "creation_date": 1443344887, "post_id": 32803445, "comment_id": 53449416, "body": "Sorry to have indicated the correct answer already: YOURS is what I was looking for. Put it in what Windows calls HOMEPATH (c:\\users\\myname). Txs."}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "reply_to_user": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "edited": false, "score": 0, "creation_date": 1443364402, "post_id": 32803445, "comment_id": 53454767, "body": "@Martin I think you can change which answer you accept. I&#39;m happy that we solved your issue."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 6, "last_activity_date": 1443314436, "creation_date": 1443314436, "answer_id": 32803445, "question_id": 32800884, "link": "https://stackoverflow.com/questions/32800884/how-can-i-insert-a-backtick-in-ghci/32803445#32803445", "title": "How can I insert a backtick in GHCi?", "body": "<p>@Toxaris gave several suggestions in his answer, but in a comment he also mentioned the possibility of configuring GHCi's version of readline (which is called <a href=\"http://trac.haskell.org/haskeline\" rel=\"noreferrer\"><code>haskeline</code></a>). And indead it <a href=\"http://trac.haskell.org/haskeline/wiki/CustomKeyBindings\" rel=\"noreferrer\">allows custom keybindings</a>. So I decided to test that out.</p>\n\n<p>The documentation says to put the customizations in <code>~/.haskeline</code>, which is not a Windows path, but it presumably translates to <code>.haskeline</code> in whatever directory <code>System.Directory.getHomeDirectory</code> returns. (<code>vim</code> can also edit that path directly on Windows, but I only realized that afterwards.) So I put the following in <code>C:\\Users\\\u00d8rjan\\.haskeline</code>:</p>\n\n<pre><code>bind: meta-' `\n</code></pre>\n\n<p>Now I can get <code>`</code> in GHCi by pressing <code>alt-'</code> !</p>\n"}], "owner": {"reputation": 1360, "user_id": 845044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cadc772d42c1c43480a21d963abe95a?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/845044/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 1, "accepted_answer_id": 32801066, "answer_count": 2, "score": 8, "last_activity_date": 1443364116, "creation_date": 1443294043, "last_edit_date": 1443295602, "question_id": 32800884, "link": "https://stackoverflow.com/questions/32800884/how-can-i-insert-a-backtick-in-ghci", "title": "How can I insert a backtick in GHCi?", "body": "<p>I'm trying out Haskell in GHCi on Windows. In the tutorial I'm following, a function name is enclosed in backticks: <code>x `mod` 7</code>. However, I can't enter the character in GHCi.</p>\n\n<p>The backtick character has ASCII value 096, but GHCI does not allow <kbd>Alt</kbd> + <em>number</em> to insert any character. Copying/pasting doesn't work either. What should I do?</p>\n"}, {"tags": ["scala", "haskell", "higher-kinded-types"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1443290755, "post_id": 32800257, "comment_id": 53438003, "body": "it seems the first one just does not <i>see</i> the <code>int</code> (it talks just about <code>scala.collection.immutable.List</code> too"}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 6, "last_activity_date": 1443296191, "creation_date": 1443296191, "answer_id": 32801186, "question_id": 32800257, "link": "https://stackoverflow.com/questions/32800257/asking-for-a-types-kind-in-scala-vs-haskell/32801186#32801186", "title": "Asking for a type&#39;s kind in Scala vs Haskell", "body": "\n\n<p>It seems that <code>scala</code> sees the <code>[Int]</code> part in <code>List[Int]</code> perfectly well, but chooses to ignore it and always look at the \"outer\" type deliberately.</p>\n\n<p>If this weren't true, then <code>type ListOfInt = List[Int]</code> followed by <code>:k -v ListOfInt</code> would yield <code>*</code> not <code>* -&gt; *</code> but that's not the case:</p>\n\n<pre class=\"lang-scala prettyprint-override\"><code>scala&gt; :k -v List\nscala.collection.immutable.List's kind is F[+A]\n* -(+)-&gt; *\nThis is a type constructor: a 1st-order-kinded type.\n\nscala&gt; :k -v List[Int]\nscala.collection.immutable.List's kind is F[+A]\n* -(+)-&gt; *\nThis is a type constructor: a 1st-order-kinded type.\n\nscala&gt; type ListOfInt = List[Int]\ndefined type alias ListOfInt\n\nscala&gt; :k -v ListOfInt\nscala.collection.immutable.List's kind is F[+A]\n* -(+)-&gt; *\nThis is a type constructor: a 1st-order-kinded type.\n</code></pre>\n"}], "owner": {"reputation": 704, "user_id": 864306, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/cc979dfc088d7ca86c02fbfdb5f0fd93?s=128&d=identicon&r=PG", "display_name": "miguel", "link": "https://stackoverflow.com/users/864306/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 15, "last_activity_date": 1443296191, "creation_date": 1443290438, "question_id": 32800257, "link": "https://stackoverflow.com/questions/32800257/asking-for-a-types-kind-in-scala-vs-haskell", "title": "Asking for a type&#39;s kind in Scala vs Haskell", "body": "<p>When asking for the kind of <code>[Int]</code> and <code>[]</code> in Haskell I get:</p>\n\n<pre><code>Prelude&gt; :k [Int]\n[Int] :: *\nPrelude&gt; :k []\n[] :: * -&gt; *\n</code></pre>\n\n<p>which makes sense: the first one is a proper type and the second one is a higher kinded type.</p>\n\n<p>But when I do the same in Scala:</p>\n\n<pre><code>scala&gt; :k -v List[Int]\nscala.collection.immutable.List's kind is F[+A]\n* -(+)-&gt; *\nThis is a type constructor: a 1st-order-kinded type.\n\nscala&gt; :k -v List\nscala.collection.immutable.List's kind is F[+A]\n* -(+)-&gt; *\nThis is a type constructor: a 1st-order-kinded type.\n</code></pre>\n\n<p>... it says both are higher kinded types. Why the first one isn't classified as a proper type? What's the reason for this difference?</p>\n"}, {"tags": ["haskell", "math", "vector", "types"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1443282172, "post_id": 32798874, "comment_id": 53435405, "body": "You need to add another parameter wherever you use <code>(Member v)</code> because it&#39;s of kind <code>*-&gt;*</code> but it needs to be <code>*</code>."}, {"owner": {"reputation": 13, "user_id": 805677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d26cf2a4cb4f04c945fee724c3182f4f?s=128&d=identicon&r=PG", "display_name": "martinjacobd", "link": "https://stackoverflow.com/users/805677/martinjacobd"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1443282292, "post_id": 32798874, "comment_id": 53435444, "body": "What would this parameter look like, in this case? I want these functions to output functions. (I.e., things of kind * -&gt; *)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443282538, "post_id": 32798874, "comment_id": 53435512, "body": "Functions have arrow types; function types have kind <code>*</code>; type functions have kinds with arrows."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443300282, "post_id": 32801720, "comment_id": 53440879, "body": "Instances like that tend to lead to bad type errors, which is why <code>Reader</code> is useful."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1443299354, "creation_date": 1443299354, "answer_id": 32801720, "question_id": 32798874, "link": "https://stackoverflow.com/questions/32798874/implement-infinite-vector-space-in-haskell-as-mapping-from-integers-to-scalars/32801720#32801720", "title": "Implement Infinite Vector Space in Haskell as mapping from Integers to Scalars", "body": "<p>There is absolutely no need to create a new class; instead, simply make an instance of the old classes for the function type. Thus, for example:</p>\n\n<pre><code>instance AdditiveGroup v =&gt; AdditiveGroup (e -&gt; v) where\n    zeroV _ = zeroV\n    (f ^+^ g) x = f x ^+^ g x\n    negateV f x = negateV (f x)\n\ninstance VectorSpace v =&gt; VectorSpace (e -&gt; v) where\n    type Scalar (e -&gt; v) = Scalar v\n    (a *^ f) x = a *^ f x\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 805677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d26cf2a4cb4f04c945fee724c3182f4f?s=128&d=identicon&r=PG", "display_name": "martinjacobd", "link": "https://stackoverflow.com/users/805677/martinjacobd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 32801720, "answer_count": 1, "score": 1, "last_activity_date": 1443299354, "creation_date": 1443281970, "last_edit_date": 1443287894, "question_id": 32798874, "link": "https://stackoverflow.com/questions/32798874/implement-infinite-vector-space-in-haskell-as-mapping-from-integers-to-scalars", "title": "Implement Infinite Vector Space in Haskell as mapping from Integers to Scalars", "body": "<p>I'm trying to implement an infinite dimensional vector space in Haskell, but I'm running into trouble. I would use a stream as the base data type and simply use the provided package for vector spaces, but I want indices to go in both the negative and positive direction. In other words, I want some sort of mapping from the integers (all of them) to some scalar values. This can be easily implemented as, say,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(^+^) :: (Integer -&gt; Double) -&gt; (Integer -&gt; Double) -&gt; (Integer -&gt; Double)\na ^+^ b = (\\ n -&gt; (a n) + (b n))\n(^*^) :: Double -&gt; (Integer -&gt; Double) -&gt; (Integer -&gt; Double)\nc ^*^ a = (\\ n -&gt; c * (a n))\n</code></pre>\n\n<p>And used like</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>vecA :: (Integer -&gt; Double)\nvecB :: (Integer -&gt; Double)\nvecA n = fromInteger n\nvecB n = fromInteger n\nprint ((vecA ^+^ vecB) 4) --prints 8.0, as expected\n</code></pre>\n\n<p>Okay, so I would like to make this far more general, and na\u00efvely, I would want to write something like,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class AdditiveGroup v where\n  -- | The zero element: identity for '(^+^)'\n  zeroV :: v\n  -- | Add vectors\n  (^+^) :: v -&gt; v -&gt; v\n  -- | Additive inverse\n  negateV :: v -&gt; v\n  -- | Group subtraction\n  (^-^) :: v -&gt; v -&gt; v\n  v ^-^ v' = v ^+^ negateV v'\n\nclass AdditiveGroup v =&gt; VectorSpace v where\n  type Scalar v :: *\n  -- | Scale a vector\n  (*^) :: Scalar v -&gt; v -&gt; v\n</code></pre>\n\n<p>(I copied and pasted this definition from Haskell's classes for this kind of thing.) But, of course, there's not a way (that I can see) to implement the mapping I had above as a data construct, and trying to change the kind of v makes me run into problems</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>--This doesn't even compile\nclass InfVecSpace v where\n    type Index v  :: *\n    type Scalar v :: *\n    type Member v :: * -&gt; *\n    (^+^)   :: (Member v) -&gt; (Member v) -&gt; (Member v)\n    zeroV   :: (Member v)\n    invertV :: (Member v) -&gt; (Member v)\n    (^*^)   :: Scalar v -&gt; (Member v) -&gt; (Member v)\n</code></pre>\n\n<p>How might I implement this, preferably as idiomatically as possible, within Haskell's type system?</p>\n"}, {"tags": ["haskell", "recursion", "tree"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5377238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02607f44fbd475025bbaa28537ca9c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Danique", "link": "https://stackoverflow.com/users/5377238/danique"}, "edited": false, "score": 0, "creation_date": 1443272628, "post_id": 32797357, "comment_id": 53432623, "body": "Thank you for the answer. It really helped me to understand!"}], "tags": [], "owner": {"reputation": 17837, "user_id": 1923190, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/D0JyZ.jpg?s=128&g=1", "display_name": "Simon H", "link": "https://stackoverflow.com/users/1923190/simon-h"}, "is_accepted": false, "score": 4, "last_activity_date": 1443271756, "creation_date": 1443271756, "answer_id": 32797357, "question_id": 32797315, "link": "https://stackoverflow.com/questions/32797315/haskell-understanding-fmap/32797357#32797357", "title": "haskell understanding fmap", "body": "<p>Welcome to currying!!  What is happening is that you are 'partially applying' the inner fmap to get a function that you feed to outer fmap.  It is only this nested <code>fmap</code> that can get through both the <code>Rosetree</code> and the <code>[]</code> containers.</p>\n\n<p>Note that</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; h a -&gt; h b\n</code></pre>\n\n<p>So partially applied like below gives a function</p>\n\n<pre><code>let g = fmap f :: h a -&gt; hb\n</code></pre>\n\n<p>It is this function that is then fed to the other fmap</p>\n\n<pre><code>fmap g xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5377238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02607f44fbd475025bbaa28537ca9c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Danique", "link": "https://stackoverflow.com/users/5377238/danique"}, "edited": false, "score": 0, "creation_date": 1443272578, "post_id": 32797372, "comment_id": 53432607, "body": "Thank you for the explanation! I finally undestand it.:D"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 8, "last_activity_date": 1443271812, "creation_date": 1443271812, "answer_id": 32797372, "question_id": 32797315, "link": "https://stackoverflow.com/questions/32797315/haskell-understanding-fmap/32797372#32797372", "title": "haskell understanding fmap", "body": "<p>It's because <code>xs</code> is a list of <code>Rose a</code>.</p>\n\n<p>Perhaps this is clearer:</p>\n\n<pre><code>fmap f (x :&gt; xs) = (f x) :&gt; map (fmap f) xs\n                            ^^^\n</code></pre>\n\n<p>Of course, for lists, <code>map</code> = <code>fmap</code>.</p>\n\n<p>That is:</p>\n\n<ol>\n<li>apply <code>f</code> to <code>x</code>.</li>\n<li>for <code>xs</code>, map the function <code>fmap f</code> over the list <code>xs</code></li>\n</ol>\n"}], "owner": {"reputation": 43, "user_id": 5377238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02607f44fbd475025bbaa28537ca9c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Danique", "link": "https://stackoverflow.com/users/5377238/danique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 32797372, "answer_count": 2, "score": 3, "last_activity_date": 1443271812, "creation_date": 1443271417, "question_id": 32797315, "link": "https://stackoverflow.com/questions/32797315/haskell-understanding-fmap", "title": "haskell understanding fmap", "body": "<p>Could somebody help or give some direction of how I can understand the fmap function in following implementation.</p>\n\n<pre><code>data Rose a = a :&gt; [Rose a] deriving (Eq, Show)\ninstance Functor Rose where\nfmap f (x :&gt; xs) = (f x) :&gt; fmap (fmap f) xs\n\ntree :: Rose Int\ntree = 1 :&gt; [2:&gt;[]]\n</code></pre>\n\n<p>The part which I don't understand the (fmap f), why does it again go in recursion, but it only takes 1 parameter. How is this possible, because it needs to 2.</p>\n\n<p>The second part is that I don't undestand why this not works:</p>\n\n<pre><code>fmap f (x :&gt; xs) = (f x) :&gt; fmap f xs\n</code></pre>\n\n<p>I hope that someone could give me some direction of how understand this.</p>\n"}, {"tags": ["javascript", "css", "haskell", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 2, "last_activity_date": 1443263187, "last_edit_date": 1443263187, "creation_date": 1443262808, "answer_id": 32796104, "question_id": 32795440, "link": "https://stackoverflow.com/questions/32795440/highlight-js-fails-at-haskell/32796104#32796104", "title": "Highlight.js fails at Haskell?", "body": "<p>In my DOM explorer I see this turns into</p>\n\n<pre><code>&lt;code class=\"haskell hljs\"&gt;\n        &lt;span class=\"hljs-pragma\"&gt;{-# OPTIONS_GHC -Wall #-}&lt;/span&gt;\n        euclid :: &lt;span class=\"hljs-type\"&gt;Int&lt;/span&gt; -&amp;gt; &lt;span class=\"hljs-type\"&gt;Int&lt;/span&gt; -&amp;gt; &lt;span class=\"hljs-type\"&gt;Int&lt;/span&gt;\n        euclid a b\n          | a == &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;    = b\n          | b == &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;    = a\n          | a &amp;gt; b     = euclid (a-b) b\n          | otherwise = euclid a (b-a)\n\n      &lt;/code&gt;\n</code></pre>\n\n<p>Those spans have the following rule from line 143 in <a href=\"http://tekkkz.com/css/style.css\" rel=\"nofollow\">http://tekkkz.com/css/style.css</a> applied, which messes up their size and placement. Disabling that makes it look fine to me.</p>\n\n<pre><code>.content span {\n    float: left;\n    padding-right: 50px;\n}\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 32796104, "answer_count": 1, "score": 4, "last_activity_date": 1443263187, "creation_date": 1443258358, "question_id": 32795440, "link": "https://stackoverflow.com/questions/32795440/highlight-js-fails-at-haskell", "title": "Highlight.js fails at Haskell?", "body": "<p>I use <code>Highlight.js</code> at <a href=\"http://tekkkz.com/posts/articles/arch_installation.html\" rel=\"nofollow\">my Site</a> with the <code>Monokai.css</code> Theme.\nSee more:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" href=\"../../css/styles/monokai.css\"&gt;\n&lt;script src=\"../../js/highlight.pack.js\"&gt;&lt;/script&gt;\n&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;\n</code></pre>\n\n<p>Bit like you can see, something went wrong.</p>\n\n<pre><code>&lt;pre&gt;\n  &lt;code class=\"haskell\"&gt;\n    {-# OPTIONS_GHC -Wall #-}\n    euclid :: Int -&gt; Int -&gt; Int\n    euclid a b\n      | a == 0    = b\n      | b == 0    = a\n      | a &gt; b     = euclid (a-b) b\n      | otherwise = euclid a (b-a)\n  &lt;/code&gt;\n&lt;/pre&gt;\n</code></pre>\n\n<p>Why is it not shown correctly?</p>\n"}, {"tags": ["haskell", "elm", "web-frontend", "ghcjs", "haste"], "answers": [{"tags": [], "owner": {"reputation": 7168, "user_id": 1449964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/87e463011e9c8e62cc67a6c688bf88c1?s=128&d=identicon&r=PG", "display_name": "Alexandr Kurilin", "link": "https://stackoverflow.com/users/1449964/alexandr-kurilin"}, "is_accepted": false, "score": 3, "last_activity_date": 1443261983, "creation_date": 1443261983, "answer_id": 32795963, "question_id": 32795092, "link": "https://stackoverflow.com/questions/32795092/is-it-possible-to-server-side-render-haskell-frontend-with-ghcjs-haste-elm-et/32795963#32795963", "title": "Is it possible to server-side render Haskell frontend with Ghcjs, Haste, Elm, etc?", "body": "<p>Stock Yesod scaffold does server-side rendering of HTML and has custom pre-processed languages for HTML, CSS and JS. You should be able to integrate Fay/Purescript without too much of a problem given that they've been around for a while and yesod comes with scaffolds for at least one of them.</p>\n\n<p>For something like GHCJS integration, you'll see a lot of progress being done in upcoming versions of the <code>stack</code> tool (e.g. <a href=\"https://github.com/commercialhaskell/stack/issues/749\" rel=\"nofollow\">this issue</a>). That will theoretically make full-stack Haskell achievable without too much of a hassle. Right now, it's my understanding that integrating GHCJS is non-trivial.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 5379386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X8CTzzhiHQQ/AAAAAAAAAAI/AAAAAAAAAZs/-lqaa8YNE6c/photo.jpg?sz=128", "display_name": "Jason Zoladz", "link": "https://stackoverflow.com/users/5379386/jason-zoladz"}, "is_accepted": false, "score": 4, "last_activity_date": 1443281395, "last_edit_date": 1443281395, "creation_date": 1443277716, "answer_id": 32798246, "question_id": 32795092, "link": "https://stackoverflow.com/questions/32795092/is-it-possible-to-server-side-render-haskell-frontend-with-ghcjs-haste-elm-et/32798246#32798246", "title": "Is it possible to server-side render Haskell frontend with Ghcjs, Haste, Elm, etc?", "body": "<p>I don't believe that Alexandr has answered the question.</p>\n\n<p>The question is whether Haskell web frameworks do server-side rendering of JavaScript -- vanilla JS or JS-via-Haskell (GHCJS, Fay, etc.).   My understanding is that Yesod does not pre-render JS (i.e., execute the JS and serve the resulting HTML).   Rather, Yesod does server-side generation of HTML via hamlet (or blaze-html, or lucid, depending on your preferences).</p>\n\n<p>The only library that I could find for Haskell server-side JS rendering (for Angular) is:</p>\n\n<p><a href=\"https://github.com/danchoi/ngrender\" rel=\"nofollow\">https://github.com/danchoi/ngrender</a></p>\n\n<p>But it's still in beta.  </p>\n\n<p>If there are other libraries/solutions, I'd love to hear about them.  This is a problem for me as well.   I want to use purescript-halogen on the client, but...  SEO.</p>\n\n<p>Edit:  For now, the best option might be to use nginx as your load-balancer in front of your Haskell server with prerender.io to supply rendered JS-pages to search bots:</p>\n\n<p><a href=\"https://github.com/prerender/prerender\" rel=\"nofollow\">https://github.com/prerender/prerender</a></p>\n\n<p><a href=\"https://gist.github.com/thoop/8165802\" rel=\"nofollow\">https://gist.github.com/thoop/8165802</a></p>\n"}], "owner": {"reputation": 89, "user_id": 5356246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-824Y7_GExgA/AAAAAAAAAAI/AAAAAAAAAAA/fc_FFIhSQoY/photo.jpg?sz=128", "display_name": "Jakub K\u0159&#237;\u017e", "link": "https://stackoverflow.com/users/5356246/jakub-k%c5%99%c3%ad%c5%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1443281395, "creation_date": 1443255709, "last_edit_date": 1443255911, "question_id": 32795092, "link": "https://stackoverflow.com/questions/32795092/is-it-possible-to-server-side-render-haskell-frontend-with-ghcjs-haste-elm-et", "title": "Is it possible to server-side render Haskell frontend with Ghcjs, Haste, Elm, etc?", "body": "<p>I think that Haskell offers fantastic features. Also suited for Web development. However, one feature I miss. Server-side rendering.\nThe reasons are Google indexing crawlers and pre-rendering to increase performance on mobile devices.</p>\n\n<p>Is it possible to server-side render Haskell frontend with Ghcjs, Haste, Elm or with some other Haskell->JS compiler?</p>\n"}, {"tags": ["haskell", "pattern-matching", "singleton-type"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443301380, "post_id": 32793397, "comment_id": 53441171, "body": "Putting any singleton into an existential wrapper simply makes it isomorphic to the original type (ie, <code>SomeSing (KProxy :: KProxy x)</code> is inhabited by as many values as <code>x</code>, <i>if</i> your singleton is constructed properly). This should be obvious when you remember that a singleton shares the same structure as its parent datatype but encodes more information at the type level, and <code>SomeSing</code> erases all that information. So long story short: <code>SomeSing SNat</code> is just <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/GHC-Natural.html#t:Natural\" rel=\"nofollow noreferrer\"><code>Natural</code></a>."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443343347, "post_id": 32793397, "comment_id": 53449094, "body": "@user2407038 yes, I see that...but how can I get the <code>Natural</code> from the <code>SomeSing</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443343440, "post_id": 32793595, "comment_id": 53449117, "body": "I&#39;m interested in accessing the <code>Integer</code>...I&#39;m not using it for proofs, I&#39;m just using it to dynamically initialize my program, which deals with things like <code>V n Double</code>&#39;s, but is always polymorphic over all <code>n</code>.  I&#39;d like to get the <code>n</code> from runtime things, like the result of IO actions."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443366343, "post_id": 32793595, "comment_id": 53455331, "body": "@JustinL, what do you need the type-level addition for in that case? You might want to play with the latest version of <code>reflection</code>."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1443515338, "post_id": 32793595, "comment_id": 53513244, "body": "@dfeur it looks like <code>reflection</code> gives me what i wanted.  thanks! :)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1443241365, "creation_date": 1443241365, "answer_id": 32793595, "question_id": 32793397, "link": "https://stackoverflow.com/questions/32793397/using-snat-from-data-singletons-like-other-sing-instances/32793595#32793595", "title": "Using SNat from Data.Singletons like other Sing instances?", "body": "<p>I believe the problem is that there are two natural number singleton types both called <code>SNat</code>. The one you seem to have found goes with GHC typelits. Its constructor is not exported from the defining module, but it's an <code>Integer</code> underneath. You can access that integer, but the whole thing seems to be pretty much useless for proofs. The other <code>SNat</code> version deals with the classic Peano naturals. It'll work for proofs, but will be slow at runtime. I've not yet seen a Haskell natural good for both proofs and speed.</p>\n"}], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 1, "accepted_answer_id": 32793595, "answer_count": 1, "score": 3, "last_activity_date": 1443255078, "creation_date": 1443238998, "last_edit_date": 1443255078, "question_id": 32793397, "link": "https://stackoverflow.com/questions/32793397/using-snat-from-data-singletons-like-other-sing-instances", "title": "Using SNat from Data.Singletons like other Sing instances?", "body": "<p>I can use <code>SomeSing</code> with great effect to be able to dynamically generate Singletons and then pattern-match on them to be able to do fun stuff</p>\n\n<pre><code>&gt; let x = SomeSing SFalse :: SomeSing ('KProxy :: KProxy Bool)\n-- pretend x is dynamically generated using IO or something\n&gt; case x of SomeSing SFalse -&gt; blah blah\n            SomeSing STrue -&gt; blah blah\n</code></pre>\n\n<p>However, I'm not really sure how to do this with <code>SNat</code>, which is the data family instance for <code>Sing Nat</code>.  One issue I have is that I'm not able to ever get the <code>SNat</code> data constructor in scope even when importing all of the relevant modules (<code>Data.Singletons</code>, <code>Data.Singletons.TypeLits</code>, <code>Data.Singletons.Prelude</code>, etc.) and enabling the extensions (even though <code>SNat</code> the constructor shows up when I use <code>:browse</code> and <code>:i Sing</code>) </p>\n\n<p>...another issue I have is that ... there aren't any separate constructors to match on like for <code>SFalse</code> and <code>STrue</code>...there's just one constructor! :O  How am I supposed to use this in the same way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443235829, "post_id": 32793110, "comment_id": 53424857, "body": "There are a few packages on Hackage offering loops of various sorts. The most interesting I&#39;ve seen is probably <a href=\"https://hackage.haskell.org/package/loops\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/loops</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1443236361, "post_id": 32793110, "comment_id": 53424940, "body": "Monad transformers are never necessary -- merely convenient."}], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443237426, "post_id": 32793163, "comment_id": 53425093, "body": "Thanks for the great answer. However, maybe I didn&#39;t make it clear (I&#39;m editing my question), but what I wanted is not a <code>break</code> but a <code>continue</code>. There&#39;s a subtle difference --- I would like to skip the rest of the <i>iteration</i>, not the entire loop. I have changed the question."}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": true, "score": 13, "last_activity_date": 1443238502, "last_edit_date": 1443238502, "creation_date": 1443236108, "answer_id": 32793163, "question_id": 32793110, "link": "https://stackoverflow.com/questions/32793110/how-do-i-continue-in-a-monad-loop/32793163#32793163", "title": "How do I &quot;continue&quot; in a `Monad` loop?", "body": "<p>Remember that loops like this in Haskell are not magic...they're just normal first-class things that you can write yourself.</p>\n\n<p>For what it's worth, I don't think it's too useful to think of <code>MaybeT</code> as a Monad transformer.  To me, <code>MaybeT</code> is just a newtype wrapper to give an alternative implementation of <code>(&gt;&gt;=)</code>...just like how you use <code>Product</code>, <code>Sum</code>, <code>First</code>, <code>And</code>, etc. to give alternative implementations of <code>mappend</code> and <code>mempty</code>.</p>\n\n<p>Right now, <code>(&gt;&gt;=)</code> for you is <code>IO a -&gt; (a -&gt; IO b) -&gt; IO b</code>.  But it'd be more useful to have <code>(&gt;&gt;=)</code> here be <code>IO (Maybe a) -&gt; (a -&gt; IO (Maybe b) -&gt; IO (Maybe b)</code>.  As soon as you get to the first action that returns a <code>Nothing</code>, it's really impossible to \"bind\" any further.  That's exactly what <code>MaybeT</code> gives you.  You also get a \"custom instance\" of <code>guard</code>, <code>guard :: Bool -&gt; IO (Maybe a)</code>, instead of <code>guard :: IO a</code>.</p>\n\n<pre><code>forM_ [1..100] $ \\i -&gt; runMaybeT $ do\n  a &lt;- lift doSomeIO\n  guard (isValid1 a)\n  b &lt;- lift $ doSomeOtherIO a\n  guard (isValid2 b)\n  ...\n</code></pre>\n\n<p>and that's it :)</p>\n\n<p><code>MaybeT</code> is not magic either, and you can achieve basically the same effect by using nested <code>when</code>s.  It's <em>not necessary</em>, it just makes things a lot simpler and cleaner :)</p>\n"}, {"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443841767, "post_id": 32793253, "comment_id": 53664427, "body": "Thanks. I&#39;m trying out <code>loops</code>, but I couldn&#39;t get <code>break_</code> to work. Can you have a look at <a href=\"http://stackoverflow.com/questions/32918416/how-do-i-use-break-in-the-package-loops\">this question</a>?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1443237099, "creation_date": 1443237099, "answer_id": 32793253, "question_id": 32793110, "link": "https://stackoverflow.com/questions/32793110/how-do-i-continue-in-a-monad-loop/32793253#32793253", "title": "How do I &quot;continue&quot; in a `Monad` loop?", "body": "<p>If you want to loop over a list or other container to perform actions and/or produce a summary value, and you're finding the usual convenience tools like <code>for_</code> and <code>foldM</code> aren't good enough for the job, you might want to consider <code>foldr</code>, which is plenty strong enough for the job. When you're not really looping over a container, you can use plain old recursion or pull in something like <code>https://hackage.haskell.org/package/loops</code> or (for a very different flavor) <code>https://hackage.haskell.org/package/machines</code> or perhaps <code>https://hackage.haskell.org/package/pipes</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1443240068, "last_edit_date": 1443240068, "creation_date": 1443239218, "answer_id": 32793412, "question_id": 32793110, "link": "https://stackoverflow.com/questions/32793110/how-do-i-continue-in-a-monad-loop/32793412#32793412", "title": "How do I &quot;continue&quot; in a `Monad` loop?", "body": "<p>Here's how you would do it using bare-bones recursion:</p>\n\n<pre><code>loop [] = return ()   -- done with the loop\nloop (x:xs) =\n  do a &lt;- doSomeIO\n     if ...a...\n        then return ()  -- exit the loop\n        else do -- continuing with the loop\n                b &lt;- doSomeMoreIO\n                if ...b...\n                   then return () -- exit the loop\n                   else do -- continuing with the loop\n                           ...\n                           loop xs -- perform the next iteration\n</code></pre>\n\n<p>and then invoke it with:</p>\n\n<pre><code>loop [1..100]\n</code></pre>\n\n<p>You can tidy this up a bit with the <code>when</code> function from Control.Monad:</p>\n\n<pre><code>    loop [] = return ()\n    loop (x:xs) =\n      do a &lt;- doSomeIO\n         when (not ...a...) $ do\n           b &lt;- doSomeMoreIO\n           when (not ...b...) $ do\n             ...\n             loop xs\n</code></pre>\n\n<p>There is also <code>unless</code> in Control.Monad which you might prefer to use.</p>\n\n<p>Using @\u00d8rjan Johansen 's helpful advice, here is an simple example:</p>\n\n<pre><code>import Control.Monad\n\nloop [] = return ()\nloop (x:xs) = do\n  putStrLn $ \"x = \" ++ show x\n  a &lt;- getLine\n  when (a /= \"stop\") $ do\n  b &lt;- getLine\n  when (b /= \"stop\") $ do\n  print $ \"iteration: \" ++ show x ++ \": a = \" ++ a ++ \" b = \" ++ b\n  loop xs\n\nmain = loop [1..3]\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 2, "accepted_answer_id": 32793163, "answer_count": 3, "score": 10, "last_activity_date": 1443240068, "creation_date": 1443235548, "last_edit_date": 1443237564, "question_id": 32793110, "link": "https://stackoverflow.com/questions/32793110/how-do-i-continue-in-a-monad-loop", "title": "How do I &quot;continue&quot; in a `Monad` loop?", "body": "<p>Often times I found myself in need of skipping the rest of the <em>iteration</em> (like <code>continue</code> in C) in Haskell:</p>\n\n<pre><code>forM_ [1..100] $ \\ i -&gt;\n    a &lt;- doSomeIO\n    when (not $ isValid1 a) &lt;skip_rest_of_the_iteration&gt;\n    b &lt;- doSomeOtherIO a\n    when (not $ isValid2 b) &lt;skip_rest_of_the_iteration&gt;\n    ...\n</code></pre>\n\n<p>However, I failed to find an easy way to do so. The only way I am aware of is probably the <code>Trans.Maybe</code>, but is it necessary to use a monad transform to achieve something so trivial?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1443233769, "post_id": 32792927, "comment_id": 53424492, "body": "&quot;I keep getting errors&quot; -- <i>Which</i> errors? (Compiler errors are not gibberish; you should try to understand them.)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1443234846, "post_id": 32792927, "comment_id": 53424671, "body": "And, whether you understand them or not, you should include them in your question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1443234984, "post_id": 32792927, "comment_id": 53424702, "body": "@duplode, unfortunately, GHC type errors can be rather intimidating, especially to new users. They may talk about strange vocabulary like ambiguous type variables, skolems, etc. GHC&#39;s parse errors, on the other hand, tend to be rather uninformative."}, {"owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "edited": false, "score": 0, "creation_date": 1443235052, "post_id": 32792927, "comment_id": 53424717, "body": "I agree, I updated the post with an error I got when compiling a implementation of intersperse and show"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443235363, "post_id": 32792927, "comment_id": 53424774, "body": "@dfeuer Indeed. That makes it even more important to include the errors, so that answers can help making sense of them."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1443293270, "last_edit_date": 1443293270, "creation_date": 1443237766, "answer_id": 32793303, "question_id": 32792927, "link": "https://stackoverflow.com/questions/32792927/using-intersperse-and-show/32793303#32793303", "title": "Using intersperse and show", "body": "<p>Let's have a look at first error:</p>\n\n<pre><code>Couldn't match expected type \u2018String -&gt; [String]\u2019\n            with actual type \u2018[[a0] -&gt; [a0]]\u2019\nThe first argument of ($) takes one argument,\nbut its type \u2018[[a0] -&gt; [a0]]\u2019 has none\nIn the first argument of \u2018unwords\u2019, namely\n  \u2018(map intersperse ',' $ show x)\u2019\n</code></pre>\n\n<p>\"The first argument of <code>($)</code> takes one argument\" -- that means it should be a function, as its type shows:</p>\n\n<pre><code>GHCi&gt; :t ($)\n($) :: (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p><code>map intersperse ','</code>, however, is not a function. As you are passing two arguments to <code>map</code>, it would be a list...</p>\n\n<pre><code>GHCi&gt; :t map\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>... however, <code>map intersperse ','</code> is ill-typed: <code>','</code> is not a list, so you cannot use <code>map</code> to map a function over it (that is what the other error says). The root of the issue is that you don't need <code>map</code> to apply <code>intersperse ','</code> to a <code>String</code>:</p>\n\n<pre><code>GHCi&gt; :t intersperse ','\nintersperse ',' :: [Char] -&gt; [Char]\n</code></pre>\n\n<p>That will fix the two errors... and introduce another:</p>\n\n<pre><code>GHCi&gt; let printListTuples listTuple = unlines [ ys ++ \" \" ++  unwords (intersperse ',' $ show x) | (x, ys) &lt;- listTuple ]\n\n&lt;interactive&gt;:33:66:\n    Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n    Expected type: [String]\n      Actual type: [Char]\n    In the first argument of \u2018unwords\u2019, namely\n      \u2018(intersperse ',' $ show x)\u2019\n    In the second argument of \u2018(++)\u2019, namely\n      \u2018unwords (intersperse ',' $ show x)\u2019\n    In the second argument of \u2018(++)\u2019, namely\n      \u2018\" \" ++ unwords (intersperse ',' $ show x)\u2019\n</code></pre>\n\n<p>Now <code>unwords</code> wants a list of <code>String</code>s, but we are giving it <code>intersperse ',' $ show x</code>, which is a list of <code>Char</code>s (that is, a <code>String</code>). That directs our attention to the fact that we do not need <code>unwords</code> anymore: it was only used to put a space between the numbers, but now we want to put a comma instead of a space, and we are already doing that with <code>intersperse</code>. So all we have to do is removing it:</p>\n\n<pre><code>GHCi&gt; let printListTuples listTuple = unlines [ ys ++ \" \" ++  (intersperse ',' $ show x) | (x, ys) &lt;- listTuple ]\n</code></pre>\n\n<p><em>Et voil\u00e0</em>:</p>\n\n<pre><code>GHCi&gt; printListTuples [(123, \"foo\"), (456, \"bar\")]\n\"foo 1,2,3\\nbar 4,5,6\\n\"\n</code></pre>\n\n<p>From here, you should decompose your function into smaller parts, as user5402 suggests in their answer.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443238004, "post_id": 32793308, "comment_id": 53425171, "body": "I suspect <code>intersperse &#39;,&#39; . show</code> is actually not what the OP wants, but you couldn&#39;t have guessed that from the question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443238232, "post_id": 32793308, "comment_id": 53425201, "body": "I think they actually want <code>intercalate &quot;,&quot; . map show</code>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1443237813, "creation_date": 1443237813, "answer_id": 32793308, "question_id": 32792927, "link": "https://stackoverflow.com/questions/32792927/using-intersperse-and-show/32793308#32793308", "title": "Using intersperse and show", "body": "<p>Try to avoid writing complex expressions. You can use <code>let</code> and <code>where</code> clauses to create intermediate definitions. Then build up your final expression from smaller, tested expressions.</p>\n\n<p>For instance, you have identified a useful expression:</p>\n\n<pre><code>intersperse ',' $ show x\n</code></pre>\n\n<p>So create a definition which encapsulates this:</p>\n\n<pre><code>commify x = intersperse ',' (show x)\n</code></pre>\n\n<p>And then you can ask ghci for its signature:</p>\n\n<pre><code>ghci&gt; :t commify\ncommify :: Show a =&gt; a -&gt; String\n</code></pre>\n\n<p>Next, tackle the problem of printing just a single tuple:</p>\n\n<pre><code>printTuple (x,ys) = ys ++ \" \" ++ ...\n</code></pre>\n\n<p>Once you have that working, your <code>printListTuple</code> function is just:</p>\n\n<pre><code>printListTuple listTuples\n   = unlines [ printTuple (x,ys) | (x,ys) &lt;- listTuples ]\n</code></pre>\n\n<p>which is easy to read and understand.</p>\n"}], "owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 32793303, "answer_count": 2, "score": 0, "last_activity_date": 1443293270, "creation_date": 1443233480, "last_edit_date": 1443235081, "question_id": 32792927, "link": "https://stackoverflow.com/questions/32792927/using-intersperse-and-show", "title": "Using intersperse and show", "body": "<p>I'm trying to get this code: </p>\n\n<pre><code>intersperse ',' $ show 123\n</code></pre>\n\n<p>integrated into this function:</p>\n\n<pre><code>printListTuples listTuple = unlines [ ys ++ \" \" ++ unwords (map show x) | (x, ys) &lt;- listTuple ]\n</code></pre>\n\n<p>where x can be equal to 123 for this example.</p>\n\n<p>Therefore the code should output a string with numbers like this:\n\"1,2,3\"</p>\n\n<p>rather than just \"1 2 3\" like this code currently does. </p>\n\n<p>I keep getting errors trying to \"map\" \"intersperse\" and \"show\" to x in the function. Any advice?</p>\n\n<p>EDIT:</p>\n\n<p>For example, I tried using </p>\n\n<pre><code>printListTuples listTuple = unlines [ ys ++ \" \" ++  unwords (map intersperse ',' $ show x) | (x, ys) &lt;- listTuple ]\n</code></pre>\n\n<p>but this returns an error:</p>\n\n<pre><code>    Couldn't match expected type \u2018String -&gt; [String]\u2019\n                with actual type \u2018[[a0] -&gt; [a0]]\u2019\n    The first argument of ($) takes one argument,\n    but its type \u2018[[a0] -&gt; [a0]]\u2019 has none\n    In the first argument of \u2018unwords\u2019, namely\n      \u2018(map intersperse ',' $ show x)\u2019\n    In the second argument of \u2018(++)\u2019, namely\n      \u2018unwords (map intersperse ',' $ show x)\u2019\n\n    Couldn't match expected type \u2018[a0]\u2019 with actual type \u2018Char\u2019\n    In the second argument of \u2018map\u2019, namely \u2018','\u2019\n    In the expression: map intersperse ','\n    In the first argument of \u2018unwords\u2019, namely\n      \u2018(map intersperse ',' $ show x)\u2019\n</code></pre>\n\n<p>which I do not know enough about to fix.</p>\n"}, {"tags": ["haskell", "boolean", "monads", "functor"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1443227942, "post_id": 32792350, "comment_id": 53423598, "body": "Try hoogling for <code>(Bool -&gt; Bool) -&gt; (IO Bool -&gt; IO Bool)</code> instead. It gets the right answer eventually... quite low in the list, I grant you, but it does get it. <code>(a -&gt; b) -&gt; (IO a -&gt; IO b)</code> gets it at the top."}], "answers": [{"comments": [{"owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "edited": false, "score": 0, "creation_date": 1443313489, "post_id": 32792762, "comment_id": 53443959, "body": "Fair comment, not including the compiler output was a rookie mistake. Thanks for the great answer, I think <code>fmap</code> is exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": true, "score": 5, "last_activity_date": 1443231346, "creation_date": 1443231346, "answer_id": 32792762, "question_id": 32792350, "link": "https://stackoverflow.com/questions/32792350/invert-return-value-of-type-io-bool/32792762#32792762", "title": "Invert Return Value of Type IO Bool", "body": "<p>For the record, \"doesn't work\" is not a very helpful error description :)  Is it a syntax error?  a type error?  does it compile and typecheck, but return the wrong value?  It's probably the most vague description of your problem possible...and is usually a really really big impairment/hurdle for anyone who wants to help you.</p>\n\n<p>The main problem here is that you can't apply <code>not</code> to an <code>IO Bool</code>, because <code>not</code> only works on <code>Bool</code>s.  An <code>IO Bool</code> is not a <code>Bool</code>, nor does it \"contain a <code>Bool</code>\", so it's not surprising that it doesn't work.  It's like trying to apply <code>(* 2)</code> to your dog.  Your dog isn't a number!</p>\n\n<p>But it seems like you know how to work with do notation and binding from IO, so maybe you can understand why this would work?</p>\n\n<pre><code>userDidntEnterStr :: String -&gt; IO Bool\nuserDidntEnterStr str = do\n   didEnter &lt;- userEnteredStr str\n   return (not didEnter)\n</code></pre>\n\n<p>Alternatively, you can also apply any <code>(a -&gt; b)</code> to the <em>result</em> of an <code>IO a</code> to get a new <code>IO b</code> using <code>fmap</code>:</p>\n\n<pre><code>userDidntEnterStr :: String -&gt; IO Bool\nuserDidntEnterStr str = fmap not (userEnteredStr str)\n</code></pre>\n"}], "owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 32792762, "answer_count": 1, "score": 1, "last_activity_date": 1443231346, "creation_date": 1443226795, "question_id": 32792350, "link": "https://stackoverflow.com/questions/32792350/invert-return-value-of-type-io-bool", "title": "Invert Return Value of Type IO Bool", "body": "<p>I have a function that returns the type <code>IO Bool</code>. I'd like to use this function as an argument to <code>filterM</code>, but what I actually want to do is to invert its output. I've tried something to the effect of <code>(not . f)</code>, but <code>not</code> isn't hip to the <code>IO</code> vibe. How can I invert an <code>IO Bool</code>? </p>\n\n<p>Here's a minimal working example:</p>\n\n<pre><code>#!/usr/bin/env runhaskell\n{-# LANGUAGE UnicodeSyntax #-}\nmodule Main where\nimport Prelude.Unicode\n\nuserEnteredStr \u2237 String \u2192 IO Bool\nuserEnteredStr str = do\n    input \u2190 getLine\n    return (input \u2261 str)\n\n-- doesn't work. How would I write this function? \n--userDidntEnterStr \u2237 String \u2192 IO Bool\n--userDidntEnterStr str = not . userEnteredStr\n\nmain = do result \u2190 userEnteredStr \"y\"\n          print result\n</code></pre>\n\n<p>Sorry if this is basic! I can't find a function on Hoogle with type <code>IO Bool -&gt; IO Bool</code> and haven't found anything in my web searching.</p>\n"}, {"tags": ["haskell", "traversal"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443234669, "post_id": 32792414, "comment_id": 53424650, "body": "That&#39;s quite impressive. How did you come up with that <code>getCompose . Compose</code> trick?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443235548, "post_id": 32792414, "comment_id": 53424807, "body": "I suggest submitting this proof for inclusion in the documentation for <code>Data.Traversable</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443235947, "post_id": 32792414, "comment_id": 53424884, "body": "@dfeuer It was the quickest way to get a <code>Compose</code> in the right place to apply the composition law. That step might even be suppressed if we apply <code>getCompose</code> to both sides of the composition law before using it, as the <code>Control.Lens.Traversal</code> documentation does."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443282036, "post_id": 32792414, "comment_id": 53435347, "body": "What exactly is an applicative transformation? <code>t</code> is used at (seemingly) two different types in &quot;Naturality&quot; so I assume it has some higher-rank type or using some typeclasses?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443283027, "post_id": 32792414, "comment_id": 53435657, "body": "@user2407038, it&#39;s only used at one type. If <code>f</code> and <code>g</code> are applicative functors, an applicative transformation from <code>f</code> to <code>g</code> is a polymorphic function <code>t::f a -&gt; g a</code> such that <code>t . pure = pure</code> (<code>pure</code> used there with two types) and <code>t (x &lt;*&gt; y) = t x &lt;*&gt; t y</code> always (<code>&lt;*&gt;</code> used at two types)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443283423, "post_id": 32792414, "comment_id": 53435768, "body": "Actually, I&#39;m not sure it has to be polymorphic."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443285036, "post_id": 32792414, "comment_id": 53436245, "body": "@dfeuer It has to, as it wouldn&#39;t be a natural transformation otherwise. The polymorphism ensures it can&#39;t modify the <code>a</code> values."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443286566, "post_id": 32792414, "comment_id": 53436734, "body": "Why would that be a problem?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443289803, "post_id": 32792414, "comment_id": 53437688, "body": "@dfeuer A natural transformation between Haskell <code>Functor</code>s preserves functions being <code>fmap</code>ped, so that <code>t . fmap f = fmap f . t</code> for any <code>f</code> (incidentally, that also follows from the two properties of applicative transformations). There is no way that can hold if <code>t</code> can change the values within the <code>Functor</code>. (Back when I was trying to grok natural transformations I wrote <a href=\"https://duplode.github.io/posts/what-does-fmap-preserve.html\" rel=\"nofollow noreferrer\">some notes on this topic</a>. You might find them, or the links therein, useful, even though there is nothing specific about <code>Applicative</code> there.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443290373, "post_id": 32792414, "comment_id": 53437873, "body": "I guess I&#39;m still wondering whether it&#39;s possible for a <code>Traversable</code> instance to obey the naturality law for all natural applicative transformations but not all unnatural applicative transformations. Also whether there are any implications between naturality and those applicative transformation laws I&#39;m not seeing."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443291039, "post_id": 32792414, "comment_id": 53438081, "body": "@dfeuer An unnatural applicative transformation isn&#39;t an applicative transformation in this sense, both by definition (though right now I can&#39;t recall a reference to back up that claim) and because, for an applicative transformation <code>t</code>, <code>t (x &lt;*&gt; y) = t x &lt;*&gt; t y</code> =&gt; <code>t (pure f &lt;*&gt; y) = t (pure f) &lt;*&gt; t y</code> &lt;=&gt; <code>t (pure f &lt;*&gt; y) = pure f &lt;*&gt; t y</code> &lt;=&gt; <code>t (fmap f y) = fmap f (t y)</code> (that is, naturality)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443292050, "post_id": 32792414, "comment_id": 53438397, "body": "Those are some very nice notes on your blog. Thanks."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443299251, "post_id": 32792414, "comment_id": 53440561, "body": "@dfeuer By the way, thank you for decompressing the proof through that edit :)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 6, "last_activity_date": 1615922214, "last_edit_date": 1615922214, "creation_date": 1443227570, "answer_id": 32792414, "question_id": 32792132, "link": "https://stackoverflow.com/questions/32792132/how-can-i-show-that-traverse-interacts-sensibly-with-fmap/32792414#32792414", "title": "How can I show that traverse interacts sensibly with fmap?", "body": "<p><em>Note that this proof isn't actually necessary, as the result in question is indeed a free theorem. See <a href=\"https://stackoverflow.com/a/32813063/2751851\">Reid Barton's answer</a>.</em></p>\n<p>I believe this will do:</p>\n<pre><code>traverse f . fmap g -- LHS\n</code></pre>\n<p>By the <code>fmap/traverse</code> law,</p>\n<pre><code>traverse f . runIdentity . traverse (Identity . g)\n</code></pre>\n<p>Since <code>fmap</code> for <code>Identity</code> is effectively <code>id</code>,</p>\n<pre><code>runIdentity . fmap (traverse f) . traverse (Identity . g)\n</code></pre>\n<p>The <code>Compose</code> law offers a way to collapse two traversals into one, but we must first introduce <code>Compose</code> using <code>getCompose . Compose = id</code>.</p>\n<pre><code>runIdentity . getCompose . Compose . fmap (traverse f) . traverse (Identity . g)\n-- Composition law:\nrunIdentity . getCompose . traverse (Compose . fmap f . Identity . g)\n</code></pre>\n<p>Again using the <code>Identity</code> <code>fmap</code>,</p>\n<pre><code>runIdentity . getCompose . traverse (Compose . Identity . f . g)\n</code></pre>\n<p><code>Compose . Identity</code> is an applicative transformation, so by naturality,</p>\n<pre><code>runIdentity . getCompose . Compose . Identity . traverse (f . g)\n</code></pre>\n<p>Collapsing inverses,</p>\n<pre><code>traverse (f . g) -- RHS\n</code></pre>\n<p>Invoked laws and corollaries, for the sake of completeness:</p>\n<pre><code>-- Composition:\ntraverse (Compose . fmap g . f) = Compose . fmap (traverse g) . traverse f\n-- Naturality:\nt . traverse f = traverse (t . f) -- for every applicative transformation t\n-- `fmap` as traversal:\nfmap g = runIdentity . traverse (Identity . g)\n</code></pre>\n<p>The latter fact follows from the identity law, <code>traverse Identity = Identity</code>, plus the uniqueness of <code>fmap</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443389641, "post_id": 32813063, "comment_id": 53462717, "body": "What do <code>F</code> and <code>T</code> mean to @free?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443390203, "post_id": 32813063, "comment_id": 53462860, "body": "Nothing, they are arbitrary type constructors (maybe they need to be functors for <code>$map_F</code> to make sense, but the <code>f</code> and <code>t</code> in the type of <code>traverse</code> are functors anyway)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443390335, "post_id": 32813063, "comment_id": 53462894, "body": "Do the capital letters mean that they represent specific types rather than type variables?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443390883, "post_id": 32813063, "comment_id": 53463034, "body": "Yes. <code>traverse</code> is only assumed to be parametrically polymorphic in <code>a</code> and <code>b</code>. (In fact it is polymorphic to some degree in <code>f</code> as well, though lambdabot doesn&#39;t know how to take that into account (nor do I).)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443391337, "post_id": 32813063, "comment_id": 53463136, "body": "For example, the free theorem for <code>fun :: a -&gt; a</code> is <code>f . fun = fun . f</code>, while the free theorem for <code>fun :: A -&gt; A</code> is just the tautology <code>fun = fun</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443391422, "post_id": 32813063, "comment_id": 53463151, "body": "That&#39;s really neat, since it means the law I desire doesn&#39;t depend on any of the <code>Traversable</code> laws at all, and applies even to functor-specific <code>traverse</code>-like functions. Unfortunately, the mathematical machinery behind these free theorems is pretty intense."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477017510, "post_id": 32813063, "comment_id": 67603351, "body": "Looking back at this answer, it is worth noting that this being is a free theorem seems to be a quite significant. If we make <code>k = id</code> in the above, we get <code>traverse f = traverse id . fmap f</code>. If we define <code>sequenceA = traverse id</code>, that means the fact that <code>traverse</code> can be decomposed into <code>fmap</code> and <code>sequenceA</code> is independent of the <code>Traversable</code> laws."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 4, "last_activity_date": 1443389514, "creation_date": 1443389514, "answer_id": 32813063, "question_id": 32792132, "link": "https://stackoverflow.com/questions/32792132/how-can-i-show-that-traverse-interacts-sensibly-with-fmap/32813063#32813063", "title": "How can I show that traverse interacts sensibly with fmap?", "body": "<p>According to lambdabot it is a free theorem (parametricity).</p>\n\n<p>In response to <code>@free traverse :: (a -&gt; F b) -&gt; T a -&gt; F (T b)</code>, lamdabot produces</p>\n\n<pre><code>$map_F g . h = k . f =&gt; $map_F ($map_T g) . traverse h = traverse k . $map_T f\n</code></pre>\n\n<p>Set <code>g = id</code> so that <code>h = k . f</code>. Then the conclusion becomes</p>\n\n<pre><code>traverse (k . f) = traverse k . fmap f\n</code></pre>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 1, "accepted_answer_id": 32792414, "answer_count": 2, "score": 13, "last_activity_date": 1615922214, "creation_date": 1443224744, "question_id": 32792132, "link": "https://stackoverflow.com/questions/32792132/how-can-i-show-that-traverse-interacts-sensibly-with-fmap", "title": "How can I show that traverse interacts sensibly with fmap?", "body": "<p>It seems intuitively obvious that the following law should hold:</p>\n\n<pre><code>traverse f . fmap g = traverse (f . g)\n</code></pre>\n\n<p>The only <code>Traversable</code> law that <em>seems</em> to apply directly is</p>\n\n<pre><code>fmap g = runIdentity . traverse (Identity . g)\n</code></pre>\n\n<p>That changes the problem to</p>\n\n<pre><code>traverse f . runIdentity . traverse (Identity . g)\n</code></pre>\n\n<p>The only law that seems to have vaguely the right shape to apply to this is the naturality law. That, however, is about applicative transformations, and I don't see any of those around.</p>\n\n<p>Unless I'm missing something, the only thing left is a parametricity proof, and I've not yet gotten a clue about how to write those.</p>\n"}, {"tags": ["list", "function", "haskell", "printing", "tuples"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1443225207, "post_id": 32792042, "comment_id": 53423095, "body": "is that code you wrote?"}], "answers": [{"comments": [{"owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "edited": false, "score": 0, "creation_date": 1443225411, "post_id": 32792184, "comment_id": 53423136, "body": "Well &#39;show&#39; is being used in printListTuples to accomplish some of what you&#39;re telling me (my understanding at least), but I&#39;m not sure what function to use to insert commas."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "edited": false, "score": 0, "creation_date": 1443225620, "post_id": 32792184, "comment_id": 53423179, "body": "@shamu11,  I thought of a nicer way. Just remember that strings are lists, and read the documentation for <code>Data.List</code> on Hackage. You&#39;ll find something that suits your needs perfectly."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1443225511, "last_edit_date": 1443225511, "creation_date": 1443225211, "answer_id": 32792184, "question_id": 32792042, "link": "https://stackoverflow.com/questions/32792042/within-my-adhoc-specific-function-how-do-i-add-commas-when-printing-a-list-of-in/32792184#32792184", "title": "Within my adhoc specific function how do I add commas when printing a list of integers", "body": "<p>There's an easy way, and there's a hard way. The easy way is to use the <code>Show</code> instance for lists and a couple really simple list functions. The other really simple way is to use just one list function. Cn you see how? The harder bit more educational) way is to write it yourself. Can you come up with the base <em>cases</em> and the recursive case?</p>\n"}], "owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1612031916, "creation_date": 1443223992, "last_edit_date": 1612031916, "question_id": 32792042, "link": "https://stackoverflow.com/questions/32792042/within-my-adhoc-specific-function-how-do-i-add-commas-when-printing-a-list-of-in", "title": "Within my adhoc specific function how do I add commas when printing a list of integers", "body": "<p>With input being: </p>\n\n<pre><code>\"I am what I\nam, and I (765) do not like Spam. Abc2. Abc3.\"\n</code></pre>\n\n<p>My code makes an output of:</p>\n\n<pre><code>abc 2\nam 1 2\nand 2\ndo 2\ni 1 2\nlike 2\nnot 2\nspam 2\nwhat 1\n</code></pre>\n\n<p>Where each word is listed along with the line number it appears on. </p>\n\n<p>Question: How do you print the statement below where you get commas between the line numbers like so:</p>\n\n<pre><code>abc 2\nam 1,2\nand 2\ndo 2\ni 1,2\nlike 2\nnot 2\nspam 2\nwhat 1\n</code></pre>\n\n<p>Here is the code I have that takes a list with tuples formatted like this </p>\n\n<p><code>[([1, 2], \"a\"), ([1], \"b\"), ([1], \"c\"), ([2], \"dd\")]</code></p>\n\n<p>and prints it into my current output which I listed above:</p>\n\n<pre><code>combineInts listTuple = map f $ groupBy ((==) `on` fst) $ sortBy (compare `on` fst) $ map swap listTuple\n    where f xs@(x:_) = (map snd xs, fst x)\n\nprintListTuples listTuple = unlines [ ys ++ \" \" ++ unwords (map show x) | (x, ys) &lt;- listTuple ]\n</code></pre>\n\n<p>If I can get help figuring out how to get those commas in between the line numbers it would be useful and be much more readable.</p>\n"}, {"tags": ["haskell", "system.reactive", "monads", "continuations", "frp"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1443252496, "post_id": 32791168, "comment_id": 53427719, "body": "first what is the <i>callback-hell</i>? Second: are you talking about FRP or about  frameworks like RX (those are <i>not</i> really implementations of FRP) - also some of the parts (for example the type) of the cont-monad look like an event (you feed event-handler) but for example there is no unsubscribe (you usually find on frameworks like RX) and usually you don&#39;t add more than one continuations ;) ... so IMO it&#39;s not &quot;the same&quot; ... but well it&#39;s my opinion and maybe this is not the right place for discussions like this(?)"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1443253073, "post_id": 32791168, "comment_id": 53427842, "body": "here is a good picture about callback hell <a href=\"http://seajones.co.uk/content/images/2014/12/callback-hell.png\" rel=\"nofollow noreferrer\">seajones.co.uk/content/images/2014/12/callback-hell.png</a>"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1443253233, "post_id": 32791168, "comment_id": 53427875, "body": "in Erik&#39;s video it is said that RX is a realization of the Cont. Monad, it would be good to know &quot;in simple terms&quot;/&quot;explained to mere mortals&quot; why and how that is true ."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1565544498, "post_id": 32791168, "comment_id": 101379019, "body": "dead link: <a href=\"http://seajones.co.uk/content/images/2014/12/callback-hell.png\" rel=\"nofollow noreferrer\">seajones.co.uk/content/images/2014/12/callback-hell.png</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443288626, "post_id": 32798156, "comment_id": 53437352, "body": "Very interesting. So basically - loosely speaking - the continuation monad is similar to RX."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443288822, "post_id": 32798156, "comment_id": 53437400, "body": "FRP is good for modelling state machines, I wonder if Continuation Monad is good for that too ?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443295031, "post_id": 32798156, "comment_id": 53439291, "body": "@jhegedus It&#39;s important to note that the continuation monad has nothing to do with asynchronous computations, there are no threads involved. It&#39;d be possible to include threads explicitly in <code>ContT r IO</code>, or use Haskell&#39;s parallelism, but that&#39;s separate from <code>Cont</code>/<code>ContT</code>. Regarding FRP, I&#39;d argue that unless the state machines involve time in some way, FRP is not the right tool for them, although I&#39;m not an expert in that area. I&#39;d suggest to look into something like <a href=\"http://stackoverflow.com/a/17250253/1333025\"><code>Automaton</code></a>."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443339963, "post_id": 32798156, "comment_id": 53448291, "body": "We had a few meetups on FRP and that is how I know that FRP is pretty good for modeling state machines <a href=\"http://www.meetup.com/Helsinki-Functional-Reactive-Programming-Meetup/\" rel=\"nofollow noreferrer\">meetup.com/Helsinki-Functional-Reactive-Programming-Meetup</a> , this is even mentioned in the lecture videos which are online, given by one of the Haskell FRP authors , time is always discrete in practice, on our computers, so in practice time evolution is just another way of describing a state machine. In practice if you want to solve a differential equation you discretize it in some way, or you find an analytic solution.  The latter is not so easy in general :)"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443340061, "post_id": 32798156, "comment_id": 53448322, "body": "@jhegedus Nice, I didn&#39;t know about that. It&#39;s always good to learn something :). Do you perhaps have some more links on the topic of FRP &amp; state machines (preferably in text form)?"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443340123, "post_id": 32798156, "comment_id": 53448337, "body": "The Automaton is pretty similar to Yampa which is again FRP. We had a discussion about that, and I remember that we came to that conclusion that Yampa is a beefed up Automaton."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443340211, "post_id": 32798156, "comment_id": 53448358, "body": "Here you can find the discussion thread about this topic <a href=\"https://gitter.im/helsinki-frp/forall\" rel=\"nofollow noreferrer\">gitter.im/helsinki-frp/forall</a> and even ask away if you like coz the people there can tell you all the details you want to know :)"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443340335, "post_id": 32798156, "comment_id": 53448386, "body": "If you search for the word automaton in the upper right corner then you find the May 18 entry."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443340789, "post_id": 32798156, "comment_id": 53448487, "body": "This talk goes into details about Yampa <a href=\"https://www.youtube.com/watch?v=T7XwTolu9YI\" rel=\"nofollow noreferrer\">youtube.com/watch?v=T7XwTolu9YI</a> which is pretty much a beefed up Automaton - so I heard - from people who are much more clever then me :)"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443345283, "post_id": 32798156, "comment_id": 53449509, "body": "@jhegedus Interesting. I&#39;d be interested exactly what&#39;s the difference between FRP and and an automaton (in what way it&#39;s &quot;beefed up&quot;), if there is one."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1443351019, "post_id": 32798156, "comment_id": 53451130, "body": "I guess if you ask this question on that gitter chat you will get a quick and accurate answer : )"}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1549040211, "post_id": 32798156, "comment_id": 95774865, "body": "@PetrPudl&#225;k The continuation monad actually can have something to do with time when your <code>r</code> is a value representing an effect functor that incorporates passage of time (suppose <code>IO ()</code>). For example, you could have: <code>delay :: TimeSpan -&gt; v -&gt; (v -&gt; IO ()) -&gt; IO ()</code>, or <code>readFile :: FilePath -&gt; (Buffer -&gt; IO ()) -&gt; IO ()</code>. If you look at the standard library in Node JS, you&#39;ll see that it&#39;s basically 100% continuation monad with impure function arrows and an unfortunate argument order."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1549040271, "post_id": 32798156, "comment_id": 95774896, "body": "I have an article <a href=\"https://dev.to/masaeedu/actually-callbacks-are-fine-l4g\" rel=\"nofollow noreferrer\">here</a> about how to use the continuation monad to deal with asynchronicity in JS if you&#39;re interested."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 4, "last_activity_date": 1443277142, "creation_date": 1443277142, "answer_id": 32798156, "question_id": 32791168, "link": "https://stackoverflow.com/questions/32791168/why-and-how-the-continuation-monad-solves-the-callback-hell-in-other-words-is/32798156#32798156", "title": "Why and how the Continuation Monad solves the callback hell? In other words : Is RX or FRP = Continuation Monad ? IF not =, what is the difference?", "body": "<p>I'm not familiar with RX, but regarding FRP and the continuation monad, they're fundamentally different concepts.</p>\n\n<p><a href=\"https://wiki.haskell.org/Functional_Reactive_Programming\" rel=\"nofollow\">Functional reactive programming</a> is a solution to the problem of working with time-dependent values and events. With events, you can solve the callback problem by sequencing computations in such a way that when one finishes, an event is sent and it triggers the next one. But with callbacks you really don't care about time, you just want to sequence computations in a specific way, so unless your whole program is based on FRP, it's not the optimal solution.</p>\n\n<p>The <a href=\"https://wiki.haskell.org/All_About_Monads#The_Continuation_monad\" rel=\"nofollow\">continuation monad</a> has nothing to do with time at all. It's an abstract concept of computations that  can (loosely speaking) take \"snapshots\" of the current evaluation sequence and use them to \"jump\" to those snapshots arbitrarily. This allows to create complex control structures such as loops and <a href=\"https://en.wikipedia.org/wiki/Coroutine\" rel=\"nofollow\">coroutines</a>. Now have a look at the definition of the continuation monad:</p>\n\n<pre><code>newtype Cont r a = Cont { runCont :: (a -&gt; r) -&gt; r}\n</code></pre>\n\n<p>This is essentially a function with a callback! It's a function that accepts a continuation (callback) that will continue the computation after <code>a</code> is produced. So if you have several functions that take continuations,</p>\n\n<pre><code>f1 :: (Int -&gt; r) -&gt; r\n\nf2 :: Int -&gt; (Char -&gt; c) -&gt; c\n\nf3 :: Char -&gt; (String -&gt; d) -&gt; d\n</code></pre>\n\n<p>their composition becomes somewhat messy:</p>\n\n<pre><code>comp :: String\ncomp = f1 (\\a -&gt; f2 a (\\b -&gt; f3 b id))\n</code></pre>\n\n<p>Using continuations, it becomes very straightforward, we just need to wrap them in <code>cont</code> and then sequence them using the monadic bind operaiton <code>&gt;&gt;=</code>:</p>\n\n<pre><code>import Control.Monad.Cont\n\ncomp' :: String\ncomp' = runCont (cont f1 &gt;&gt;= cont . f2 &gt;&gt;= cont . f3) id\n</code></pre>\n\n<p>So continuations are a direct solution to the callback problem.</p>\n"}, {"tags": [], "owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "is_accepted": false, "score": 0, "last_activity_date": 1549044443, "creation_date": 1549044443, "answer_id": 54484921, "question_id": 32791168, "link": "https://stackoverflow.com/questions/32791168/why-and-how-the-continuation-monad-solves-the-callback-hell-in-other-words-is/54484921#54484921", "title": "Why and how the Continuation Monad solves the callback hell? In other words : Is RX or FRP = Continuation Monad ? IF not =, what is the difference?", "body": "<p>If you look at how the continuation monad is defined in Haskell, it looks like this:</p>\n\n<pre><code>data Cont r a =  Cont { runCont :: (a -&gt; r) -&gt; r }\n</code></pre>\n\n<p>By itself, this is completely pure, and doesn't represent real world effects or time. Even in its current form it <em>can</em> be used to represent temporal/IO effects, simply by choosing <code>r</code> to be a type involving <code>IO</code>. For our purposes however, we're going to do something slightly different. We're going to substitute the concrete <code>-&gt;</code> with a type parameter:</p>\n\n<pre><code>data Cont p r a = Cont { runCont :: p (p a r) r }\n</code></pre>\n\n<p>What is the use of this? In Haskell, we only have pure functions which map some input domain to an output domain. In other languages, we can have such functions, but we can <em>additionally</em> define impure \"functions\", which (in addition to producing some arbitrary output for a given input), may implicitly perform side effects.</p>\n\n<p>Here is an example of both in JS:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>// :: Int -&gt; Int -&gt; Int\nconst add = x =&gt; y =&gt; x + y\n\n// :: String -!-&gt; ()\nconst log = msg =&gt; { console.log(msg); }\n</code></pre>\n\n<p>Note that <code>log</code> is not a pure function that produces a value <em>representing</em> an effect, which is how such things are encoded in pure languages like Haskell. Instead, the effect is associated with the mere invocation of <code>log</code>. To capture this, we can use different arrows when we talk about pure functions and impure \"functions\" (<code>-&gt;</code> and <code>-!-&gt;</code>, respectively).</p>\n\n<p>So, returning to your question about how the continuation monad solves callback hell, it turns out that (in JavaScript at least), most of the APIs that give rise to callback hell can be massaged quite easily into values of the form <code>Cont (-!-&gt;) () a</code>, which I'll henceforth refer to as <code>Cont! a</code>.</p>\n\n<p>Once you have a monadic API, the rest is easy; you can traverse structures full of continuations into continuations of a structure, use do notation to write multi-step computations akin to <code>async/await</code>, use monad transformers to equip continuations with additional behavior (for example error handling), etc.</p>\n\n<p>The monad instance looks much the same as it does in Haskell:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>// :: type Cont p r a = p (p a r) r\n// :: type Cont! = Cont (-!-&gt;) ()\n\n// :: type Monad m = { pure: x -&gt; m x, bind: (a -&gt; m b) -&gt; m a -&gt; m b }\n\n// :: Monad Cont!\nconst Cont = (() =&gt; {\n  // :: x -&gt; Cont! x\n  const pure = x =&gt; cb =&gt; cb(x)\n  // :: (a -&gt; Cont! b) -&gt; Cont! a -&gt; Cont! b\n  const bind = amb =&gt; ma =&gt; cb =&gt; ma(a =&gt; amb(a)(cb))\n\n  return { pure, bind }\n})()\n</code></pre>\n\n<p>Here are a couple of examples of modelling the <code>setTimeout</code> and <code>readFile</code> APIs available in Node JS as impure continuations:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>// :: FilePath -&gt; Cont! (Either ReadFileError Buffer)\nconst readFile = path =&gt; cb =&gt; fs.readFile(path, (e, b) =&gt; cb(e ? Left(e) : Right(b)))\n\n// :: Int -&gt; v -&gt; Cont! v\nconst setTimeout = delay =&gt; v =&gt; cb =&gt; setTimeout(() =&gt; cb(v), delay)\n</code></pre>\n\n<p>As a contrived example, here's the \"callback hell\" we enter when we use the standard APIs to read a file, wait five seconds, then read another file:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>fs.readFile(\"foo.txt\", (e, b1) =&gt; {\n  if (e) { throw e }\n  setTimeout(() =&gt; {\n    fs.readFile(\"bar.txt\", (e, b2) =&gt; {\n      if (e) { throw e }\n      console.log(b1.toString(\"utf8\") + b2.toString(\"utf8\"))\n    })\n  }, 5000)\n})\n</code></pre>\n\n<p>And here is the equivalent program using the continuation monad:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const ECont = EitherT(Cont)\n\nconst decode = buf =&gt; buf.toString(\"utf8\")\n\nconst foo = readFile(\"foo.txt\") |&gt; ECont.map(decode)\nconst bar = readFile(\"bar.txt\") |&gt; ECont.map(decode)\n\n// Imaginary do notation for JS for purposes of clarity\nconst result = do(ECont)([\n  [s1, foo],\n  ECont.lift(delay_(5000)),\n  [s2, bar],\n  ECont.pure(s1 + s2)\n])\n\nconst panic = e =&gt; { throw e }\nconst log = v =&gt; { console.log(v) }\n\n// No side effects actually happen until the next line is invoked\nresult(Either.match({ Left: panic, Right: log }))\n</code></pre>\n"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1875, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1549044443, "creation_date": 1443217990, "last_edit_date": 1443250551, "question_id": 32791168, "link": "https://stackoverflow.com/questions/32791168/why-and-how-the-continuation-monad-solves-the-callback-hell-in-other-words-is", "title": "Why and how the Continuation Monad solves the callback hell? In other words : Is RX or FRP = Continuation Monad ? IF not =, what is the difference?", "body": "<p><a href=\"https://youtu.be/looJcaeboBY\" rel=\"noreferrer\">Here</a> and <a href=\"http://pursuit.purescript.org/packages/purescript-aff/0.11.0\" rel=\"noreferrer\">here</a> it is said that the Continuation Monad solves the callback hell.</p>\n\n<p>RX and FRP also solve the Callback hell. </p>\n\n<p>If all these three tools solve the Callback hell then the following question arises:</p>\n\n<p>In Erik's video it is said that RX=Continuation Monad. Is that really true? If yes, could you show the mapping? </p>\n\n<p>IF RX is not = Cont. Monad then what is the difference between RX and Continuation Monad? </p>\n\n<p>Similarly, what is the difference  between FRP and the Continuation Monad ?</p>\n\n<p>In other words, assuming that the reader knows what FRP or RX is, how can the reader easily understand what the Continuation Monad is ? </p>\n\n<p>Is it possible/easy to understand what the Continuation Monad is by comparing it with RX or FRP ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1443228165, "post_id": 32790469, "comment_id": 53423628, "body": "You should copy the relevant parts of your link into the question so that the question is robust to linkrot."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443230234, "post_id": 32792464, "comment_id": 53423923, "body": "That is a crappy extension. Better than nothing, yes, but it&#39;s extremely limited, it requires superclasses to know about subclasses, and it&#39;s really just upside down."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1443228908, "last_edit_date": 1443228908, "creation_date": 1443228123, "answer_id": 32792464, "question_id": 32790469, "link": "https://stackoverflow.com/questions/32790469/class-system-extension-proposal/32792464#32792464", "title": "class system extension proposal", "body": "<p>Yes, the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-class-extensions.html#class-default-signatures\" rel=\"nofollow\"><code>DefaultSignatures</code></a> extension allows this. For example, for the <code>Functor</code>/<code>Applicative</code> example, one could write</p>\n\n<pre><code>{-# LANGUAGE DefaultSignatures #-}\nclass Functor f where\n    fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n    default fmap :: Applicative f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n    fmap = liftA\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 32792464, "answer_count": 1, "score": 1, "last_activity_date": 1569226229, "creation_date": 1443214255, "last_edit_date": 1569226229, "question_id": 32790469, "link": "https://stackoverflow.com/questions/32790469/class-system-extension-proposal", "title": "class system extension proposal", "body": "<p>I'm solving some ploblem on generating ancestor instances in Haskell. Recently I found this on Haskell wiki: <a href=\"https://wiki.haskell.org/Class_system_extension_proposal\" rel=\"nofollow\">Class system extension proposal</a>. So, I would like to know, are there any solutions for this proposal already?</p>\n\n<p><em>Here are the examples from the Proposal:</em></p>\n\n<blockquote>\n  <p>The current class system in Haskell is based on the idea that you can\n  often provide default implementations for class methods at the same\n  time as defining the class, by using other methods of the class or its\n  ancestors. However consider the following hierarchy, adapted from\n  Functor hierarchy proposal and The Other Prelude:</p>\n\n<pre><code>class Functor m where\n    fmap :: (a -&gt; b) -&gt; m a -&gt; m b\n\nclass Functor m =&gt; Applicative m where\n    return :: a -&gt; m a\n\n    apply :: m (a -&gt; b) -&gt; m a -&gt; m b\n\n    (&gt;&gt;) :: m a -&gt; m b -&gt; m b\n    ma &gt;&gt; mb = (fmap (const id) ma) `apply` mb\n\nclass Applicative m =&gt; Monad m where\n    (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n  \n  <p>For all concrete instances of Monad we can define fmap, apply, and\n  (>>)in terms of return and (>>=) as follows:</p>\n\n<pre><code>fmap f ma = ma &gt;&gt;= (\\a -&gt; return (f a))\n\napply mf ma = mf &gt;&gt;= \\f -&gt; ma &gt;&gt;= \\a -&gt; return (f a)\n\nma &gt;&gt; mb = ma &gt;&gt;= \\_ -&gt; mb\n</code></pre>\n  \n  <p>In other words, we'd like to be able to write:</p>\n\n<pre><code>class Applicative m =&gt; Monad m where\n    (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n\n    fmap f ma = ma &gt;&gt;= (\\a -&gt; return (f a))\n\n    apply mf ma = mf &gt;&gt;= \\f -&gt; ma &gt;&gt;= \\a -&gt; return (f a)\n\n    ma &gt;&gt; mb = ma &gt;&gt;= \\_ -&gt; mb\n</code></pre>\n  \n  <p>and be able to define new instances of Monad just by supplying\n  definitions for return and (>>=) by writing:</p>\n\n<pre><code>instance Monad T where\n    ma &gt;&gt;= a_mb = ... -- some definition\n\n    return a = ... -- some definition\n</code></pre>\n  \n  <p>Explicit import/export of instances</p>\n  \n  <p>This is needed so that large programs can be built without fear of\n  colliding instance declarations between different packages. A possible\n  syntax could be:</p>\n\n<pre><code>module M\n     -- exported instances \n   ( instance Monad T\n   , instance Functor (F a) hiding (Functor (F Int), Functor (F Char))\n   , F(..)\n   ) where\n\nimport Foo (instance Monad a hiding Monad Maybe)\n\ndata T a\ndata F a b\n</code></pre>\n  \n  <p>where the context is elided because this isn't used in instance\n  selection (at the moment). The import directive tells the compiler to\n  use all Monad instances exported by Foo except for the Monad Maybe\n  instance (it doesn't matter whether or not Foo actually does export a\n  Monad Maybe instance - all that matters here is that we don't want it\n  if there is one).</p>\n</blockquote>\n"}, {"tags": ["list", "function", "haskell", "filter"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 3, "creation_date": 1443210825, "post_id": 32789535, "comment_id": 53418187, "body": "<code>fmap removeNull [[..]]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "is_accepted": true, "score": 7, "last_activity_date": 1443210456, "creation_date": 1443210456, "answer_id": 32789602, "question_id": 32789535, "link": "https://stackoverflow.com/questions/32789535/filter-out-null-string-in-a-list-of-lists/32789602#32789602", "title": "Filter out null string in a list of lists", "body": "<p>Simply use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:map\"><code>map</code></a> to apply your filter to each subList, e.g.</p>\n\n<pre><code>removeNull strList = map (filter (not . null))  strList\n                   //^^^ See here\n</code></pre>\n"}], "owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 32789602, "answer_count": 1, "score": 3, "last_activity_date": 1443217062, "creation_date": 1443210203, "last_edit_date": 1443217062, "question_id": 32789535, "link": "https://stackoverflow.com/questions/32789535/filter-out-null-string-in-a-list-of-lists", "title": "Filter out null string in a list of lists", "body": "<p>Currently I have this function:</p>\n\n<pre><code>removeNull strList = filter (not . null) strList\n</code></pre>\n\n<p>But I need to use map (I assume) to apply it to a list of lists, but I'm getting type errors.</p>\n\n<p>In GHCi, the functions filters this correctly:</p>\n\n<pre><code>removeNull [\"i\", \"\", \"b\"]\n[\"i\",\"b\"]\n</code></pre>\n\n<p>But this doesn't filter:</p>\n\n<pre><code>removeNull [[\"i\", \"\", \"b\"], [\"i\", \"\", \"b\"]]\n[[\"i\",\"\",\"b\"],[\"i\",\"\",\"b\"]]\n</code></pre>\n"}, {"tags": ["java", "haskell", "interface"], "answers": [{"tags": [], "owner": {"reputation": 18202, "user_id": 2158288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/glWQk.jpg?s=128&g=1", "display_name": "ZhongYu", "link": "https://stackoverflow.com/users/2158288/zhongyu"}, "is_accepted": false, "score": 2, "last_activity_date": 1443213209, "last_edit_date": 1443213209, "creation_date": 1443211522, "answer_id": 32789856, "question_id": 32789437, "link": "https://stackoverflow.com/questions/32789437/constrained-interface-implementation/32789856#32789856", "title": "Constrained interface implementation", "body": "<p>Well... no.</p>\n\n<p>But we can have a convenience method, that \"casts\" a <code>Pair&lt;A,B&gt;</code> to an <code>Eq&lt;Pair&lt;A,B&gt;&gt;</code>, if <code>A,B</code> are both <code>Eq</code> too. This requires an extra step on use site, and the programmer must do an explicit cast of type when it is needed; but that's probably not too bad</p>\n\n<pre><code>class Pair&lt;A, B&gt;\n{\n    A a;\n    B b;\n}\n\nstatic\n&lt;A extends Eq&lt;A&gt;, B extends Eq&lt;B&gt;&gt;\nEq&lt;Pair&lt;A,B&gt;&gt; cast(Pair&lt;A,B&gt; p1)\n{\n    return p2-&gt;( p1.a.eq(p2.a) &amp;&amp; p1.b.eq(p2.b) );\n}\n\n--\n\n    Pair&lt;X,Y&gt; pair = ...;\n\n    Eq&lt;Pair&lt;X,Y&gt;&gt; eq = cast(pair);\n</code></pre>\n\n<p>Preferably, we'd like the cast method as an instance method, something like</p>\n\n<pre><code>    Eq&lt;Pair&lt;X,Y&gt;&gt; eq = pair.asEq();\n</code></pre>\n\n<p>However, we don't want this to compile,unless<code>X,Y</code> satisfy the constraints. One way to enforce that</p>\n\n<pre><code>class Pair&lt;A, B&gt;\n{\n    A a;\n    B b;\n\n    &lt;A2 extends Eq&lt;A&gt;, B2 extends Eq&lt;B&gt;&gt;\n    Eq&lt;Pair&lt;A2,B2&gt;&gt;\n    asEq()\n    {\n        return p2-&gt;( p2.a.eq(a) &amp;&amp; p2.b.eq(b) );\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1443213380, "post_id": 32790088, "comment_id": 53419431, "body": "Doesn&#39;t look too bad, but wouldn&#39;t this require one subclass for each combination of instances? (e. g <code>PairEq</code>, <code>PairShow</code> and <code>PairEqShow</code> for <code>Eq</code> and <code>Show</code>)"}, {"owner": {"reputation": 18202, "user_id": 2158288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/glWQk.jpg?s=128&g=1", "display_name": "ZhongYu", "link": "https://stackoverflow.com/users/2158288/zhongyu"}, "edited": false, "score": 1, "creation_date": 1443213823, "post_id": 32790088, "comment_id": 53419676, "body": "you are bound to get a <code>Pair&lt;A,B&gt;</code> type from some API, not <code>PairEq</code>, even though <code>A,B</code> satisfy the constraints. Now you&#39;ll still need to convert <code>Pair</code> to <code>PairEq</code>."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1443256398, "post_id": 32790088, "comment_id": 53428556, "body": "@Andr&#225;sKov&#225;cs Yest, that&#39;s an unfortunate consequence, as in Java the list of superclasses for a class is always fixed. I don&#39;t see a way how to get around it. This could be to some degree alleviated by <a href=\"http://stackoverflow.com/q/7362659/1333025\">generating the code automatically at compile-time</a> ,"}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 7, "last_activity_date": 1443212506, "creation_date": 1443212506, "answer_id": 32790088, "question_id": 32789437, "link": "https://stackoverflow.com/questions/32789437/constrained-interface-implementation/32790088#32790088", "title": "Constrained interface implementation", "body": "<p>One canonical solution that comes to my mind is to make the comparator external to the class. This is the approach that Scala takes, while making it easier digestible with the help of <a href=\"http://docs.scala-lang.org/tutorials/tour/implicit-parameters.html\">implicits</a>. And they you'd have methods for constructing comparators, such as</p>\n\n<pre><code>public &lt;A, B&gt; Comparator&lt;Pair&lt;A,B&gt;&gt; pairCmp(Comparator&lt;A&gt; ca, Comparator&lt;B&gt; cb) { ...\n</code></pre>\n\n<p>This is however quite cumbersome to work with.\nHaskell does the same thing internally, passing <a href=\"https://www.fpcomplete.com/user/jfischoff/instances-and-dictionaries\">dictionaries of type-classes implementitions</a> under the hood, but the type-class interface together with type inference makes it much more pleasant.</p>\n\n<p>As far as I know, in Java there is no way how to declare conditional instances. But a more OO approach would be to have a sub-class for pairs that allow equality:</p>\n\n<pre><code>class PairEq&lt;A extends Eq&lt;A&gt;, B extends Eq&lt;B&gt;&gt;\n  extends Pair&lt;A,B&gt;\n  implements Eq&lt;Pair&lt;A, B&gt;&gt; {\n\n...\n</code></pre>\n\n<p>There is again some manual process involved, as you need to decide when to use <code>Pair</code> and when <code>PairEq</code>. But with method overloading, we could make it easier to use by declaring smart constructors. As Java always picks the most specific one, whenever we need to create a pair, we just use <code>mkPair</code> and Java will pick the one returning <code>PairEq</code>, if the arguments implement <code>Eq</code> appropriately:</p>\n\n<pre><code>public static &lt;A,B&gt; Pair&lt;A,B&gt; mkPair(A a, B b) {\n    return new Pair&lt;A,B&gt;(a, b);\n}\n\npublic static &lt;A extends Eq&lt;A&gt;, B extends Eq&lt;B&gt;&gt; PairEq&lt;A,B&gt; mkPair(A a, B b) {\n    return new PairEq&lt;A,B&gt;(a, b);\n}\n</code></pre>\n\n<p>Complete sample code:</p>\n\n<pre><code>interface Eq&lt;A&gt; {\n    public boolean eq(A other);\n}\n\npublic class Pair&lt;A,B&gt; {\n    public final A a;\n    public final B b;\n\n    public Pair(A a, B b) {\n        this.a = a;\n        this.b = b;\n    }\n\n    public static &lt;A,B&gt; Pair&lt;A,B&gt; mkPair(A a, B b) {\n        return new Pair&lt;A,B&gt;(a, b);\n    }\n\n    public static &lt;A extends Eq&lt;A&gt;, B extends Eq&lt;B&gt;&gt; PairEq&lt;A,B&gt; mkPair(A a, B b) {\n        return new PairEq&lt;A,B&gt;(a, b);\n    }\n}\n\nclass PairEq&lt;A extends Eq&lt;A&gt;, B extends Eq&lt;B&gt;&gt;\n    extends Pair&lt;A,B&gt;\n    implements Eq&lt;Pair&lt;A,B&gt;&gt;\n{\n    public PairEq(A a, B b) {\n        super(a, b);\n    }\n\n    @Override\n    public boolean eq(Pair&lt;A,B&gt; that) {\n        return a.eq(that.a) &amp;&amp; b.eq(that.b);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 3, "last_activity_date": 1443213283, "creation_date": 1443213283, "answer_id": 32790255, "question_id": 32789437, "link": "https://stackoverflow.com/questions/32789437/constrained-interface-implementation/32790255#32790255", "title": "Constrained interface implementation", "body": "<p>You're translating the typeclasses wrong. </p>\n\n<p>Typeclasses have nothing to do with inheritance. They implement <strong>Ad-hoc polymorphism</strong>, i.e. they are used to extend the functionality of the types which are already defined.</p>\n\n<p>The thing can be translated into Java as a pattern, but you must take into notice that whilst in Haskell the instances are provided implicitly, in Java you'll have to explicitly pass them around as parameters:</p>\n\n<pre><code>interface Eq&lt;A&gt; {\n  public boolean eq(A left, A right);\n}\n\nclass EqInstances {\n  public static Eq&lt;Pair&lt;A, B&gt;&gt; pair (final Eq&lt;A&gt; aInstance, final Eq&lt;B&gt; bInstance) {\n    return new Eq&lt;Pair&lt;A, B&gt;&gt; {\n      public boolean eq(Pair&lt;A, B&gt; left, Pair&lt;A, B&gt; right) {\n        return aInstance.eq(left.a, right.a) &amp;&amp; bInstance.eq(left.b, right.b);\n      }\n    };\n  }\n}\n</code></pre>\n\n<p>And here's how you can write the polymorphic functions using this pattern:</p>\n\n<pre><code>boolean someMethodThatUsesAnEqInstance&lt;A&gt;(final Eq&lt;A&gt; aEqInstance, A a1, A a2) {\n  return aEqInstance.eq(a1, a2);\n}\n</code></pre>\n"}], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 3, "score": 13, "last_activity_date": 1443213283, "creation_date": 1443209794, "last_edit_date": 1443210930, "question_id": 32789437, "link": "https://stackoverflow.com/questions/32789437/constrained-interface-implementation", "title": "Constrained interface implementation", "body": "<p>In Haskell (and Rust, and others) I can have instances that are constrained by other instances:</p>\n\n<pre><code>data Pair a b = Pair a b\n\ninstance (Eq a, Eq b) =&gt; Eq (Pair a b) where \n    Pair a b == Pair a' b' = a == a' &amp;&amp; b == b'\n</code></pre>\n\n<p>With Java interfaces I can't. I must require the type parameters of <code>Pair</code> to always implement <code>Eq</code>, or I can't implement <code>Eq&lt;Pair&lt;A, B&gt;&gt;</code> at all:</p>\n\n<pre><code>interface Eq&lt;A&gt; {\n    public boolean eq(A other);\n}\n\nclass Pair&lt;A extends Eq&lt;A&gt;, B extends Eq&lt;B&gt;&gt; implements Eq&lt;Pair&lt;A, B&gt;&gt; {\n    A a;\n    B b;\n    public boolean eq(Pair&lt;A, B&gt; other){\n        return a.eq(other.a) &amp;&amp; b.eq(other.b);\n    }\n}\n</code></pre>\n\n<p>I'd like to have something like:</p>\n\n<pre><code>class Pair&lt;A, B&gt; implements Eq&lt;Pair&lt;A, B&gt;&gt; if (A implements Eq&lt;A&gt; &amp;&amp; B implements Eq&lt;B&gt;) {...}\n</code></pre>\n\n<p>So far the Internet has told me that my desired functionality isn't directly supported in Java. Nevertheless I find this a rather critical factor in the (re)usability of interfaces. I'd like to know if there are workarounds or solutions that approximately cover the same ground.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1443207628, "post_id": 32788278, "comment_id": 53416656, "body": "Just a note, you don&#39;t need multi line input; you can write <code>let x :: T; x = t</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443207856, "post_id": 32788278, "comment_id": 53416774, "body": "@user2407038 You don&#39;t need it, and you can also use <code>:{</code> and <code>:}</code>, but I prefer <code>:set +m</code>, it&#39;s more like how IPython does multi-line input."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1443204853, "creation_date": 1443204853, "answer_id": 32788278, "question_id": 32788094, "link": "https://stackoverflow.com/questions/32788094/haskell-point-free-compilation-type/32788278#32788278", "title": "Haskell point-free compilation type", "body": "<p>This is another case of the extended defaulting rules in GHCi.  Do <code>:set -XNoMonomorphismRestriction</code> or just do</p>\n\n<pre><code>&gt; :set +m  -- multiline input in GHCi\n&gt; let c :: (Num a) =&gt; (b -&gt; a) -&gt; b -&gt; a -&gt; b\n|     c = (.) negate\n|\n&gt; :t c\nNum a =&gt; (b -&gt; a) -&gt; b -&gt; a -&gt; b\n</code></pre>\n"}], "owner": {"reputation": 515, "user_id": 433093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03617a2c8a41d56fe6c5f056a54c0a9c?s=128&d=identicon&r=PG", "display_name": "Nimnam1 ", "link": "https://stackoverflow.com/users/433093/nimnam1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 32788278, "answer_count": 1, "score": 5, "last_activity_date": 1443204853, "creation_date": 1443204168, "question_id": 32788094, "link": "https://stackoverflow.com/questions/32788094/haskell-point-free-compilation-type", "title": "Haskell point-free compilation type", "body": "<p>So I'm really new to Haskell, but I was playing around with the point free notation and came across this issue. I'm in the console:</p>\n\n<pre><code>&gt; let c = (.)negate \n&gt; :t c \n&gt; (a -&gt; Integer) -&gt; a -&gt; Integer -&gt; a\n</code></pre>\n\n<p>but negate takes a Number, so why is it being constrained to an Integer type? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 11, "creation_date": 1443204363, "post_id": 32788082, "comment_id": 53415103, "body": "There is no difference, they both exist for historical reasons (<code>Monad</code> has not always been a superclass of <code>Applicative</code>). There is a proposal to alias <code>return</code> to <code>pure</code>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 3, "creation_date": 1443204882, "post_id": 32788082, "comment_id": 53415338, "body": "To clarify, they are only the same if you know you are dealing with a <code>Monad</code>. <code>pure</code> is more general than <code>return</code> in that it returns an <code>Applicative</code> so you can&#39;t replace all instances of <code>return</code> with <code>pure</code> but you can replace <code>pure</code> with <code>return</code>."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 12, "creation_date": 1443205894, "post_id": 32788082, "comment_id": 53415829, "body": "@Lee, I think it&#39;s the other way around in your second sentence."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1443206784, "post_id": 32788082, "comment_id": 53416240, "body": "Relevant proposal and discussion on reddit from today, coincidentally: <a href=\"https://www.reddit.com/r/haskell/comments/3mb8lb/monad_of_no_return_proposal_mrp/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/3mb8lb/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 48, "last_activity_date": 1443206558, "last_edit_date": 1443206558, "creation_date": 1443206195, "answer_id": 32788607, "question_id": 32788082, "link": "https://stackoverflow.com/questions/32788082/difference-between-return-and-pure/32788607#32788607", "title": "Difference between &#39;return&#39; and &#39;pure&#39;", "body": "<p>In GHC 7.8 and before, <code>Applicative</code> was not a superclass of <code>Monad</code>. It was even possible for a <code>Monad</code> instance to not have an <code>Applicative</code> instance. There was, however, an expectation that <code>pure</code> and <code>return</code> should have the same behavior for types that are instances of both.</p>\n\n<p>In GHC 7.10, due to the <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\">Functor-Applicative-Monad Proposal</a>, <code>Applicative</code> is now a superclass of <code>Monad</code> (<code>class Applicative m =&gt; Monad m</code>) and it is now a rule that <code>pure</code> and <code>return</code> must be the same for all <code>Monad</code> instances. In fact, the default implementation of <code>return</code> is now <code>pure</code>, as seen in <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Base.html#return\">the source on hackage</a>.</p>\n\n<p><code>pure</code> might be preferred to <code>return</code> because it does not incur a <code>Monad</code> constraint, only an <code>Applicative</code> constraint, thus making the function more general. <code>return</code> might be preferred to <code>pure</code> in do notation because of historical precedent, but <code>pure</code> could be used to exactly the same effect.</p>\n"}, {"comments": [{"owner": {"reputation": 3857, "user_id": 105804, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5230bcf5c9fd74531f38cc0adaff0905?s=128&d=identicon&r=PG", "display_name": "Jamie Cook", "link": "https://stackoverflow.com/users/105804/jamie-cook"}, "edited": false, "score": 1, "creation_date": 1500295713, "post_id": 32788688, "comment_id": 77258105, "body": "Even though the other answer is accepted and earlier, I really liked your example"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 22, "last_activity_date": 1443235326, "last_edit_date": 1443235326, "creation_date": 1443206643, "answer_id": 32788688, "question_id": 32788082, "link": "https://stackoverflow.com/questions/32788082/difference-between-return-and-pure/32788688#32788688", "title": "Difference between &#39;return&#39; and &#39;pure&#39;", "body": "<p>The Applicative typeclass was added after <code>Monad</code> and historically the <code>Monad</code> class has not been a subclass of <code>Applicative</code>. This was changed fairly recently in the <code>Applicative-Monad-Proposal</code> and this means that <code>return a</code> should be equivalent to <code>pure a</code> for every <code>Monad</code> instance. </p>\n\n<p>There is a <a href=\"http://article.gmane.org/gmane.comp.lang.haskell.libraries/25274\" rel=\"noreferrer\">proposal</a> to move <code>return</code> out of the <code>Monad</code> class and make it an alias for <code>pure</code>.</p>\n\n<p>Therefore when dealing with a <code>Monad</code> you should always be able to use <code>pure</code> instead of <code>return</code>. You cannot go the other way however since <code>pure</code> has a more general type than <code>return</code> since it only returns an <code>Applicative</code>. For example the following</p>\n\n<pre><code>wontCheck :: Applicative f =&gt; f Int\nwontCheck = return 4\n</code></pre>\n\n<p>won't type check since <code>return</code> requires <code>f</code> to be a <code>Monad</code>.</p>\n"}], "owner": {"reputation": 3716, "user_id": 2899837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cd69ea3c72bc748dd806bb526823a7b?s=128&d=identicon&r=PG&f=1", "display_name": "greole", "link": "https://stackoverflow.com/users/2899837/greole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4879, "favorite_count": 5, "accepted_answer_id": 32788607, "answer_count": 2, "score": 38, "last_activity_date": 1445908248, "creation_date": 1443204121, "last_edit_date": 1445908248, "question_id": 32788082, "link": "https://stackoverflow.com/questions/32788082/difference-between-return-and-pure", "title": "Difference between &#39;return&#39; and &#39;pure&#39;", "body": "<p>What is the difference between <code>return</code> and  <code>pure</code> from <code>Control.Applicative</code> ? It seems that I can use <code>pure</code> even at the end of a <code>do</code> block? </p>\n\n<p>So is there any situation where one should be preferred over the other (besides that everyone expects a <code>return</code> at the end of a <code>do</code> Block)?</p>\n"}, {"tags": ["list", "haskell", "tuples", "element"], "comments": [{"owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "edited": false, "score": 0, "creation_date": 1443200287, "post_id": 32786823, "comment_id": 53413065, "body": "What do you need this cumbersome type for? Do the task allow to replace it with something more convenient?"}, {"owner": {"reputation": 73, "user_id": 5355979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-C48LDiHIcMg/AAAAAAAAAAI/AAAAAAAAABY/DLBILPMP7Zo/photo.jpg?sz=128", "display_name": "tbpotn", "link": "https://stackoverflow.com/users/5355979/tbpotn"}, "reply_to_user": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "edited": false, "score": 0, "creation_date": 1443202360, "post_id": 32786823, "comment_id": 53414074, "body": "Yes it does, but I fail to see how converting <code>((a,b,c),(d,e,f),(g,h,i))</code> to <code>[a,b,c,d,e,f,g,h,i]</code> or <code>[[a,b,c],[d,e,f],[g,h,i]]</code> would make this particular task easier."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5355979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-C48LDiHIcMg/AAAAAAAAAAI/AAAAAAAAABY/DLBILPMP7Zo/photo.jpg?sz=128", "display_name": "tbpotn", "link": "https://stackoverflow.com/users/5355979/tbpotn"}, "edited": false, "score": 0, "creation_date": 1443204754, "post_id": 32787849, "comment_id": 53415270, "body": "This changes all x into y and gives me a new tuple, I want to change individual x and each changed tuple to be added to a list."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1443203164, "creation_date": 1443203164, "answer_id": 32787849, "question_id": 32786823, "link": "https://stackoverflow.com/questions/32786823/changing-the-value-in-a-tuple-of-tuples-conditionally-in-haskell/32787849#32787849", "title": "Changing the value in a tuple of tuples conditionally in Haskell", "body": "<p>With tuples you have to write:</p>\n\n<pre><code>change x y ((a,b,c),(d,e,f),(g,h,i))\n     = ((z a, z b, z c), (z d, z e, z f), (z g, z h, z i))\n  where z w = if w == x then y else w\n</code></pre>\n\n<p>Life would be easier if you used a list (or an array) to represent your 3x3 grid.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 5355979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-C48LDiHIcMg/AAAAAAAAAAI/AAAAAAAAABY/DLBILPMP7Zo/photo.jpg?sz=128", "display_name": "tbpotn", "link": "https://stackoverflow.com/users/5355979/tbpotn"}, "edited": false, "score": 0, "creation_date": 1443215486, "post_id": 32789028, "comment_id": 53420404, "body": "That would probably work and reading through your solution I&#39;ve found my own solution. For those interested, I&#39;ll write it in an answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443217428, "post_id": 32789028, "comment_id": 53421101, "body": "<code>solve&#39;</code> can also be written <code>traverse (traverse choice)</code>, skipping <code>choices</code> altogether while simultaneously generalizing the type to allow each table to be represented by, e.g., a vector of vectors, or even a vector of arrays."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 2, "last_activity_date": 1443208800, "last_edit_date": 1443208800, "creation_date": 1443207941, "answer_id": 32789028, "question_id": 32786823, "link": "https://stackoverflow.com/questions/32786823/changing-the-value-in-a-tuple-of-tuples-conditionally-in-haskell/32789028#32789028", "title": "Changing the value in a tuple of tuples conditionally in Haskell", "body": "<p>With the additional information you provided in a comment, we can solve this using Richard Bird's approach:</p>\n\n<p>We instead represent the grid as a list of lists. We then replace each element in the grid with a list of the choices we can make for it. In your example, <code>1</code> becomes <code>[1,5]</code> (we either choose a 1 or a 5) and <code>n</code> becomes <code>[n]</code> (for everything else, there are no alternative choices).</p>\n\n<pre><code>choice                :: Int -&gt; [Int]\nchoice 1              =  [1,5]\nchoice n              =  [n]\n</code></pre>\n\n<p>Then we make this choice for each element:</p>\n\n<pre><code>choices               :: [[Int]] -&gt; [[[Int]]]\nchoices               =  map (map choice)\n</code></pre>\n\n<p>Now comes the tricky part. We reduce a grid of choices to a choice of grids, which can be done using the general cartesian product of a list:</p>\n\n<pre><code>cp                    :: [[a]] -&gt; [[a]]\ncp []                 =  [[]]\ncp (xs:xss)           =  [y:ys | y &lt;- xs, ys &lt;- cp xss]\n</code></pre>\n\n<p>We collapse a grid of choices like so:</p>\n\n<pre><code>collapse              :: [[[a]]] -&gt; [[[a]]]\ncollapse              =  cp . map cp\n</code></pre>\n\n<p>This works by first collapsing a list of rows of choices (a.k.a a grid of choices) into list of choices of rows and then collapsing the list of choices of rows into a choice of lists of rows, a.k.a, a choice of grids.</p>\n\n<p>Finally, we specify a solver by first making the choices and then collapsing them:</p>\n\n<pre><code>solve                 :: [[Int]] -&gt; [[[Int]]]\nsolve                 =  collapse . choices\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>&gt; mapM_ print (solve [[0,1,2],[1,2,3],[2,3,4]])\n\n[[0,1,2],[1,2,3],[2,3,4]]\n[[0,1,2],[5,2,3],[2,3,4]]\n[[0,5,2],[1,2,3],[2,3,4]]\n[[0,5,2],[5,2,3],[2,3,4]]\n</code></pre>\n\n<p>Hopefully this also demonstrates how converting the tuples to a list of lists makes this task easier.</p>\n\n<hr>\n\n<p>Note: Some of you may have noticed that <code>cp</code> is <code>sequence</code> for the list applicative. This means we can also equivalently write:</p>\n\n<pre><code>solve' = sequence . map sequence . choices\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5355979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-C48LDiHIcMg/AAAAAAAAAAI/AAAAAAAAABY/DLBILPMP7Zo/photo.jpg?sz=128", "display_name": "tbpotn", "link": "https://stackoverflow.com/users/5355979/tbpotn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443216395, "creation_date": 1443199018, "question_id": 32786823, "link": "https://stackoverflow.com/questions/32786823/changing-the-value-in-a-tuple-of-tuples-conditionally-in-haskell", "title": "Changing the value in a tuple of tuples conditionally in Haskell", "body": "<p>I'm working on 3-tuples of 3-tuples <code>((a,b,c),(d,e,f),(g,h,i))</code>. Now I want to take this tuple as input and as output generate a list of tuples in which an element is changed to a value if it had a certain value.</p>\n\n<p>Example: </p>\n\n<p><code>changefromtovalue :: a -&gt; a -&gt; ((a,a,a),(a,a,a),(a,a,a)) -&gt; [((a,a,a),(a,a,a),(a,a,a))]</code></p>\n\n<p><code>changefromtovalue 1 5 ((0,1,2),(1,2,3),(2,3,4)) results in [((0,5,2),(1,2,3),(2,3,4)),((0,1,2)(5,2,3)(2,3,4))]</code></p>\n\n<p>Now i'm not using integers, but the idea stays the same i think.</p>\n\n<p>First I thought I wanted some kind of map, but that would change all values at once, instead of making a list with 1 element changed each.</p>\n\n<p>Then I thought, I can just make all variations (in the example <code>[((5,x,x)..),((x,5,x)..),((x,x,5)..)]</code> and somehow drop the ones that don't meet the requirements, but I can't figure out a clean way to drop the unwanted ones.</p>\n\n<p>I've tried searching and found some information about making a data specification for the tuple, but I fail to see how that would really simplify this particular problem.</p>\n\n<p>Converting to a list and working with the list and then converting back seemed easier, but it still requires a weird kind of selection. If possible I'd like to avoid using a lot of conversions.</p>\n\n<p>What I'm looking for is a suggestion that leads to a clean way, not a full cut-out line of code.</p>\n"}, {"tags": ["haskell", "template-haskell", "quickcheck", "htf"], "answers": [{"comments": [{"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1443212020, "post_id": 32785507, "comment_id": 53418787, "body": "Thank you, I added more information to my question. I try to avoid specifying list of types to test explicitly"}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1443249534, "post_id": 32785507, "comment_id": 53427110, "body": "I see you point - very reasonable. However, I am not afraid of dynamically created tests, because in the end generated tests are exactly the same, only differ in type of argument. So I see at as being one test, running on different types. But what I really do not understand is Why HTF does not get TH-generated tests? As an alternative I would like to find a solution (via TH or HTF) to include generated tests manually into htf_Main."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1443268165, "post_id": 32785507, "comment_id": 53431459, "body": "htfpp is run before TH expansion occurs, and htfpp is a just a simple text file scanner."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1443229285, "last_edit_date": 1443229285, "creation_date": 1443194503, "answer_id": 32785507, "question_id": 32784054, "link": "https://stackoverflow.com/questions/32784054/htf-does-not-test-props-generated-by-th/32785507#32785507", "title": "HTF does not test props generated by TH", "body": "<p>If you know in advance what the names of the generated property tests are, then you could always manually define stubs so that HTF sees them, e.g.:</p>\n\n<pre><code>$(generate prop test for Int)\n$(generate prop test for CInt)\n\nprop_p1 = prop_absNormInt\nprop_p2 = prop_absNormCInt\n</code></pre>\n\n<p>HTF will see the tests as <code>prop_p1</code> and <code>prop_p2</code>. You shouldn't have to put type signatures on these stubs.</p>\n\n<p>Another idea is to create your own source pre-processor to add these stubs for you (and give them better names). Your source pre-processor would automatically call <code>htfpp</code> to complete the pre-processing.</p>\n\n<p>If you show me how your TH is invoked I can show you how to write the pre-processor.</p>\n\n<p>Update:</p>\n\n<p>Given your comment I would look at doing the following:</p>\n\n<ol>\n<li>Write a program to generate the test module source.</li>\n<li>Include that program and the output it generates in your cabal project.</li>\n<li>Tell users to run the program if they want to update the test module.</li>\n</ol>\n\n<p>So - the test cases remain fixed until the program is run to regenerate the test module.</p>\n\n<p>Having a static test module has the advantage that you can tell exactly what is being tested.</p>\n\n<p>Having a program to recreate the test module gives you the ability to easily update it when new Num instances become available.</p>\n"}, {"comments": [{"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1443623103, "post_id": 32806090, "comment_id": 53569153, "body": "Here is the full solution, if someone would be interested <a href=\"https://github.com/achirkin/fastvec/tree/master/test/VectorTests\" rel=\"nofollow noreferrer\">github.com/achirkin/fastvec/tree/master/test/VectorTests</a>"}], "tags": [], "owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "is_accepted": true, "score": 1, "last_activity_date": 1443343309, "creation_date": 1443343309, "answer_id": 32806090, "question_id": 32784054, "link": "https://stackoverflow.com/questions/32784054/htf-does-not-test-props-generated-by-th/32806090#32806090", "title": "HTF does not test props generated by TH", "body": "<p>Ok, I managed to solve this problem.\nThe idea is to use TH to aggregate the tests and insert them into <code>htfMain</code>.\nOn top of what I have in the question, this includes following steps:</p>\n\n<ol>\n<li>Convert all testable properties into <code>IO</code> actions running QuickCheck tests;</li>\n<li>Aggregate all tests into <code>TestSuite</code>;</li>\n<li>Aggregate all test suites into one list and put it into <code>htfMain</code>.</li>\n</ol>\n\n<p>In order to use step 1 I had to use semi-internal function of HTF called <code>qcAssertion :: (QCAssertion t) =&gt; t -&gt; Assertion</code>.\nThis function is available, but not recommended for external use; it allows running QuickCheck tests nicely, integrating them into report.</p>\n\n<p>To proceed with step 2, I use two functions from HTF: <code>makeTestSuite</code> and <code>makeQuickCheckTest</code>.\nI also use <code>location</code> function from TH to provide filename and line of the place where the splice with test template is inserted (for nicer test logs).</p>\n\n<p>Step 3 is a tricky one: for this we need to find all generated test suites.\nThe problem is that TH does not allow to browse through all functions (including generated) in a module.\nTo overcome this, I added following type class:</p>\n\n<pre><code>class MultitypeTestSuite name where\n    multitypeTestSuite :: name -&gt; TestSuite\n</code></pre>\n\n<p>So my function <code>writeTests</code> generates a new data type <code>data MTS[prop_name]</code> and an instance of <code>MultitypeTestSuite</code> for that data type.\nThis allows me later to use another splice function in htfMain that will generate a list of test suites out of instances of that class using <code>reify</code>:</p>\n\n<pre><code>aggregateTests :: ExpQ\naggregateTests = do\n    ClassI _ instances &lt;- reify ''MultitypeTestSuite\n    liftM ListE . forM instances\n          $ \\... -&gt; [e| multitypeTestSuite $(...) |]\n</code></pre>\n\n<p>In the end, including all generated tests together with manually written ones looks pretty simple:</p>\n\n<pre><code>main :: IO ()\nmain = htfMain $ htf_importedTests ++ $(aggregateTests)\n</code></pre>\n\n<p>So, by adjusting function <code>$(writeTests)</code> I am able now to generate and test properties that vary in argument type - for all types available in scope at the same type.\nTest results and logs are included the same way as original tests.</p>\n\n<p>On that the problem is fully solved.</p>\n"}, {"comments": [{"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1443345041, "post_id": 32806167, "comment_id": 53449456, "body": "Thanks! Seems like we came up with the same solutions. The only problem here is then how to discover using TH all functions generated in different splices (maybe later in different files). I couldn&#39;t do any better than putting all them into instances of pre-defined class <code>MultitypeTestSuite</code> and then inspecting this class using another splice in <code>main</code>."}], "tags": [], "owner": {"reputation": 390, "user_id": 395106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb92f1a86d6c574d2c9412d4abe18bf?s=128&d=identicon&r=PG", "display_name": "stefanwehr", "link": "https://stackoverflow.com/users/395106/stefanwehr"}, "is_accepted": false, "score": 1, "last_activity_date": 1443343873, "creation_date": 1443343873, "answer_id": 32806167, "question_id": 32784054, "link": "https://stackoverflow.com/questions/32784054/htf-does-not-test-props-generated-by-th/32806167#32806167", "title": "HTF does not test props generated by TH", "body": "<p>HTF does not use TemplateHaskell for collecting the tests , this would slow down compilation-time significantly. Instead, HTF uses a custom preprocessor called <code>htfpp</code>. <code>htfpp</code> runs <strong>before</strong> the compiler (and thus before TemplateHaskell splices are expanded). This means that you cannot use automatic test discovery with <code>htfpp</code> when generating your tests with TemplateHaskell.</p>\n\n<p>My suggestion: when you are using TemplateHaskell anyway, then just use TemplateHaskell to collect your generated test cases. This functionality is not built into HTF, but it's not difficult to implement such a function. Here is it:</p>\n\n<pre><code>-- file TH.hs\n{-# LANGUAGE TemplateHaskell #-}\nmodule TH ( genTestSuiteFromQcProps ) where\n\nimport Language.Haskell.TH\n\nimport Test.Framework\nimport Test.Framework.Location\n\ngenTestSuiteFromQcProps :: String -&gt; [Name] -&gt; Q Exp\ngenTestSuiteFromQcProps suiteName names =\n    [| makeTestSuite $(stringE suiteName) $(listE genTests) |]\n    where\n      genTests :: [ExpQ]\n      genTests =\n          map genTest names\n      genTest :: Name -&gt; Q Exp\n      genTest name =\n          [| makeQuickCheckTest $(stringE (show name)) unknownLocation\n                 (qcAssertion $(varE name)) |]\n</code></pre>\n\n<p>The function <code>genTestSuiteFromQcProps</code> takes the name of the test suite to generated and a list of names, referring to your QC properties. <code>genTestSuiteFromQcProps</code> returns an expression of type <code>TestSuite</code>. <a href=\"https://hackage.haskell.org/package/HTF-0.13.1.0/docs/Test-Framework.html#t:TestSuite\" rel=\"nofollow\">TestSuite</a> is one of the types HTF uses to organize tests.\n(The <code>htfpp</code> preprocessor als uses the <code>TestSuite</code> type in its output.)</p>\n\n<p>Here is how you wold use <code>genTestSuiteFromQcProps</code>:</p>\n\n<pre><code>-- file Main.hs\n{-# OPTIONS_GHC -F -pgmF htfpp #-}\n{-# LANGUAGE TemplateHaskell #-}\nmodule Main where\n\nimport TH\nimport Test.Framework\n\nimport {-@ HTF_TESTS @-} OtherTests\n\nprop_additionCommutative :: Int -&gt; Int -&gt; Bool\nprop_additionCommutative x y = (x + y) == (y + x)\n\nprop_reverseReverseIdentity :: [Int] -&gt; Bool\nprop_reverseReverseIdentity l = l == reverse (reverse l)\n\nmyTestSuite :: TestSuite\nmyTestSuite =\n    $(genTestSuiteFromQcProps\n         \"MyTestSuite\"\n         ['prop_additionCommutative\n         ,'prop_reverseReverseIdentity])\n\nmain :: IO ()\nmain = htfMain (myTestSuite : htf_importedTests)\n</code></pre>\n\n<p>For your case, you would pass <code>genTestSuiteFromQcProps</code> the names of the QC properties you generated with TemplateHaskell.</p>\n\n<p>The example also shows that you can mix test cases generated with the TemplateHaskell function with tests cases collected by <code>htfpp</code>. For completeness, here is the content of <code>OtherTests</code>:</p>\n\n<pre><code>{-# OPTIONS_GHC -F -pgmF htfpp #-}\nmodule OtherTests ( htf_thisModulesTests) where\n\nimport Test.Framework\n\ntest_someOtherTest :: IO ()\ntest_someOtherTest =\n    assertEqual 1 1\n</code></pre>\n"}], "owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 32806090, "answer_count": 3, "score": 5, "last_activity_date": 1443343873, "creation_date": 1443190029, "last_edit_date": 1443211781, "question_id": 32784054, "link": "https://stackoverflow.com/questions/32784054/htf-does-not-test-props-generated-by-th", "title": "HTF does not test props generated by TH", "body": "<p>I want to do a number of similar tests on various types in my library.</p>\n\n<p>To simplify things, assume I have a number of vector types implementing <code>Num</code> class, and I want to generate the same QuickCheck property check <code>prop_absNorm x y = abs x + abs y &gt;= abs (x+y)</code> that would work on all of the types in library.</p>\n\n<p>I generate such properties using TH:</p>\n\n<pre><code>$(writeTests\n    (\\t -&gt;\n        [d| prop_absNorm :: $(t) -&gt; $(t) -&gt; Bool\n            prop_absNorm x y = abs x + abs y &gt;= abs (x+y)\n        |])\n )\n</code></pre>\n\n<p>My function to generate tests has the following signature:</p>\n\n<pre><code>writeTests :: (TypeQ -&gt; Q [Dec]) -&gt; Q [Dec]\n</code></pre>\n\n<p>This function looks for all instances of my vector class <code>VectorMath (n::Nat) t</code> (and, at the same time, instances of <code>Num</code>) through <code>reify ''VectorMath</code> and generates all prop functions accordingly.\n<code>-ddump-splices</code> shows something like this:</p>\n\n<pre><code>prop_absNormIntX4 :: Vector 4 Int -&gt; Vector 4 Int -&gt; Bool\nprop_absNormIntX4 x y = abs x + abs y &gt;= abs (x+y)\nprop_absNormCIntX4 :: Vector 4 CInt -&gt; Vector 4 CInt -&gt; Bool\nprop_absNormCIntX4 x y = abs x + abs y &gt;= abs (x+y)\n...\nprop_absNormFloatX4 :: Vector 4 Float -&gt; Vector 4 Float -&gt; Bool\nprop_absNormFloatX4 x y = abs x + abs y &gt;= abs (x+y)\nprop_absNormFloatX3 :: Vector 3 Float -&gt; Vector 3 Float -&gt; Bool\nprop_absNormFloatX3 x y = abs x + abs y &gt;= abs (x+y)\n</code></pre>\n\n<p>The problem is that all manually written properties are checked, but generated ones are not.</p>\n\n<p>Note 1: I have generated and non-generated properties in the same file (i.e. TH expression <code>$(..)</code> is in the same file as the other props).</p>\n\n<p>Note 2: the list of types for creation of prop functions is variable - I want to add other instances of <code>VectorMath</code> later, so they are automatically added into the test list. </p>\n\n<p>I believe that the problem is that HTF (which presumably uses TH too) parses the original file, not the one with generated code - but I cannot get why this happens.</p>\n\n<p>So my question is: how to solve this problem? If it is not possible to use TH-generated props, then is that possible to do QuickCheck tests on various types (i.e. that it substitutes them into <code>prop_absNorm :: Vector 4 a -&gt; Vector 4 a -&gt; Bool</code>)?</p>\n\n<p>Also another alternative may be to use TH further to add test entries manually to htf_Main, but I have not figured out how to do this yet;\nand it does not look like a nice clean solution. </p>\n"}, {"tags": ["haskell", "currying"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443171621, "post_id": 32777809, "comment_id": 53395421, "body": "Can not reproduce with GHC 7.10.2. What version of GHC are you using? The MR should be off by default... (in GHCi)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1443185392, "post_id": 32777809, "comment_id": 53403722, "body": "@chi The assumption that people are using ghc7.8+ or 7.10+ is generally false. A lot of people install Haskell from the repositories of their distro. AFAIK Ubuntu is still using <a href=\"http://packages.ubuntu.com/trusty/haskell-platform\" rel=\"nofollow noreferrer\">haskell platform 2013</a> which still uses ghc 7.6.x. I believe the MR is off by default only from 7.8+"}], "owner": {"reputation": 412, "user_id": 2485063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fee7be40898bbcdd1b681bc98de67166?s=128&d=identicon&r=PG", "display_name": "szimon", "link": "https://stackoverflow.com/users/2485063/szimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "closed_date": 1443170061, "answer_count": 0, "score": 0, "last_activity_date": 1443169193, "creation_date": 1443169193, "question_id": 32777809, "link": "https://stackoverflow.com/questions/32777809/haskell-curried-function-types", "closed_reason": "Duplicate", "title": "Haskell curried function types", "body": "<p>I'm a little confused by types returned by <code>curry</code> and <code>uncurry</code> functions:</p>\n\n<pre><code>Prelude&gt; let pairMax (a,b) = if a &gt; b then a else b\nPrelude&gt; :t pairMax\npairMax :: Ord a =&gt; (a, a) -&gt; a\nPrelude&gt; let pairMaxCurried = curry pairMax\nPrelude&gt; :t pairMaxCurried \npairMaxCurried :: () -&gt; () -&gt; ()\n</code></pre>\n\n<p>I don't understand why the curried function's type consists only of Unit types. Trying to apply <code>pairMaxCurried</code> unsurprisingly results in an error:</p>\n\n<pre><code>Prelude&gt; pairMaxCurried 1 2\n\n&lt;interactive&gt;:10:16:\n    No instance for (Num ()) arising from the literal `1'\n    Possible fix: add an instance declaration for (Num ())\n    In the first argument of `pairMaxCurried', namely `1'\n    In the expression: pairMaxCurried 1 2\n    In an equation for `it': it = pairMaxCurried 1 2\n</code></pre>\n\n<p>while currying and applying in the same line is fine:</p>\n\n<pre><code>Prelude&gt; (curry pairMax) 1 2\n2\n</code></pre>\n\n<p>The same goes for <code>uncurry</code>:</p>\n\n<pre><code>Prelude&gt; let twoMax a b = if a &gt; b then a else b\nPrelude&gt; :t twoMax\ntwoMax :: Ord a =&gt; a -&gt; a -&gt; a\nPrelude&gt; let twoMaxUncurried = uncurry twoMax\nPrelude&gt; :t twoMaxUncurried\ntwoMaxUncurried :: ((), ()) -&gt; ()\n</code></pre>\n\n<p>Declaring explicit type doesn't help:</p>\n\n<pre><code>Prelude&gt; let pairMaxCurried = (curry pairMax) :: Ord a =&gt; a -&gt; a -&gt; a\nPrelude&gt; :t pairMaxCurried \npairMaxCurried :: () -&gt; () -&gt; ()\n</code></pre>\n\n<p><strong>Question 1.</strong> Why is the type not correctly inferred?</p>\n\n<p><strong>Question 2.</strong> Is there a way to bind curried/uncurried function to a name while preserving the correct type?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443172665, "post_id": 32777687, "comment_id": 53396019, "body": "Just guessing: try <code>db $ selectList [] []</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 1182106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86d21541ec0e9cdce4d2fcb7915ab64?s=128&d=identicon&r=PG", "display_name": "Wade Xing", "link": "https://stackoverflow.com/users/1182106/wade-xing"}, "edited": false, "score": 0, "creation_date": 1443188826, "post_id": 32778842, "comment_id": 53405955, "body": "Thanks a lot.Could you give me a suggestion for count ? Thanks in advance."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 53, "user_id": 1182106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86d21541ec0e9cdce4d2fcb7915ab64?s=128&d=identicon&r=PG", "display_name": "Wade Xing", "link": "https://stackoverflow.com/users/1182106/wade-xing"}, "edited": false, "score": 0, "creation_date": 1443189664, "post_id": 32778842, "comment_id": 53406571, "body": "&quot;for count?&quot; <code>Database.Persist.Query</code> ;)"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 3, "creation_date": 1443544577, "post_id": 32778842, "comment_id": 53532406, "body": "Another way to allow the compiler to infer the type of the <code>Entity</code> is to specify the type of the <code>Filter</code> or <code>SelectOpt</code> (e.g. <code>users &lt;- runDB $ selectList ([] :: [Filter User]) []</code>), which is common in the Persistent/Yesod codebase. I prefer @josejuan&#39;s way, personally."}, {"owner": {"reputation": 53, "user_id": 1182106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86d21541ec0e9cdce4d2fcb7915ab64?s=128&d=identicon&r=PG", "display_name": "Wade Xing", "link": "https://stackoverflow.com/users/1182106/wade-xing"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1443580033, "post_id": 32778842, "comment_id": 53547102, "body": "@MaxGabriel , You solved my counting problem &lt;!-- language: lang-haskell --&gt;     haskell db $ count ([]::[Filter Comment])"}], "tags": [], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "is_accepted": true, "score": 6, "last_activity_date": 1443172708, "creation_date": 1443172708, "answer_id": 32778842, "question_id": 32777687, "link": "https://stackoverflow.com/questions/32777687/is-there-a-way-to-selectlist-without-any-filter-or-select-options-in-persistent/32778842#32778842", "title": "Is there a way to selectList without any filter or select options in Persistent Haskell?", "body": "<p>Write what type you want</p>\n\n<pre><code>myData :: [Entity YOUR_ENTITY_HERE] &lt;- selectList [] []\n</code></pre>\n\n<p>(I used <code>ScopedTypeVariables</code> here but is not needed if type can be inferred in other way)</p>\n"}], "owner": {"reputation": 53, "user_id": 1182106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86d21541ec0e9cdce4d2fcb7915ab64?s=128&d=identicon&r=PG", "display_name": "Wade Xing", "link": "https://stackoverflow.com/users/1182106/wade-xing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 1, "accepted_answer_id": 32778842, "answer_count": 1, "score": 4, "last_activity_date": 1443172708, "creation_date": 1443168741, "last_edit_date": 1443170099, "question_id": 32777687, "link": "https://stackoverflow.com/questions/32777687/is-there-a-way-to-selectlist-without-any-filter-or-select-options-in-persistent", "title": "Is there a way to selectList without any filter or select options in Persistent Haskell?", "body": "<p>Good day.</p>\n\n<p>I'm learning <a href=\"http://www.yesodweb.com/\" rel=\"nofollow\">Yesod</a> a few weeks (I am pretty new to Haskell) by writing a little project.I used MongoDB as the DB and accessing it by persistent-mongoDB.\nWhen I want to run a query which have no any conditions or sorting stuff, e.g.</p>\n\n<pre><code>IN MONGODB SHELL\n&gt; db.comments.find();\n</code></pre>\n\n<p>I can not find a correct way at least in <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow\">the Yesod Book</a>.</p>\n\n<p>I tried to write a identical as a workaround.</p>\n\n<pre><code>IN YESOD REPL\n*Application&gt; db $ selectList [CommentContent !=. \"\"] []\n</code></pre>\n\n<p>But it sucks...</p>\n\n<p>The same issue in a transact-sql query. e.g.</p>\n\n<pre><code>IN YESOD REPL\n*Application&gt; db $ count [CommentContent !=. \"\" ]\n</code></pre>\n"}, {"tags": ["haskell", "monad-transformers", "ioref", "haste"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443172276, "post_id": 32777502, "comment_id": 53395807, "body": "I don&#39;t think it&#39;s possible. You can wait for <code>setinterval</code> to call its function <i>once</i> with <code>MVar</code>s. But the next functions calls can not affect the state inside the <code>StateT</code>."}, {"owner": {"reputation": 7245, "user_id": 867208, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73ff2469d25f133355be32507631ee40?s=128&d=identicon&r=PG", "display_name": "valderman", "link": "https://stackoverflow.com/users/867208/valderman"}, "edited": false, "score": 0, "creation_date": 1443222044, "post_id": 32777502, "comment_id": 53422414, "body": "Not related to the actual question at hand, which @drquicksilver answered admirably, but I want to point out that wrapping <code>setInterval</code> manually is unnecessary; you should use <a href=\"http://hackage.haskell.org/package/haste-compiler-0.5.1.3/docs/Haste.html#v:setTimer\" rel=\"nofollow noreferrer\">setTimer</a> instead."}, {"owner": {"reputation": 3611, "user_id": 1029158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YmuXk.jpg?s=128&g=1", "display_name": "DiegoNolan", "link": "https://stackoverflow.com/users/1029158/diegonolan"}, "reply_to_user": {"reputation": 7245, "user_id": 867208, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73ff2469d25f133355be32507631ee40?s=128&d=identicon&r=PG", "display_name": "valderman", "link": "https://stackoverflow.com/users/867208/valderman"}, "edited": false, "score": 0, "creation_date": 1443234854, "post_id": 32777502, "comment_id": 53424676, "body": "@valderman I tried doing that but ran into a similar problem as I was unable to implement MonadEvent for StateT."}], "answers": [{"tags": [], "owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "is_accepted": true, "score": 3, "last_activity_date": 1443174092, "creation_date": 1443174092, "answer_id": 32779298, "question_id": 32777502, "link": "https://stackoverflow.com/questions/32777502/write-interval-function-for-the-statet-monad-in-haste/32779298#32779298", "title": "Write interval function for the StateT monad in Haste", "body": "<p>The IO action you are passing to your FFI'ed <code>jsInterval</code> is just a plain IO action. If you implement that action using <code>runStateT</code> you are just running a little 'local' <code>StateT</code>. It's unrelated to the enclosing code.</p>\n\n<p>This is a generic problem with callbacks and monad stacks - callbacks (in the sense that the <code>IO(</code>) parameter to <code>jsInterval</code> is a callback) have a fixed monad chosen in their definition and they have no way to generalise to other monadic effects you might be using elsewhere.</p>\n\n<p>Since callbacks - in general - can be called at any time, including multiple times at once, in different threads, after the calling function has completed and its state has been destroyed - you can see that this is hard problem to solve in general. </p>\n\n<p>The pragmatic answer is, as you have tried, to just use an <code>IORef</code>; create the <code>IORef</code> in the enclosing action and let the callback modify it. You can still write the callback in <code>StateT</code> style if you wish - just extract the state from the <code>IORef</code> and pass it to <code>runStateT</code>. Your code doesn't do this, you are just referencing the parameter <code>s</code> from the top-level : you need to use the IORef, something like this:</p>\n\n<pre><code>id_ &lt;- jsInterval i $ do\n                   current_s &lt;- readIORef ref\n                   (_, new_s) &lt;- runStateT m current_s\n                   writeIORef ref (new_s)\n</code></pre>\n\n<p>You can't really use <code>Maybe</code> unless you are prepared to teach the action <code>m</code> how to cope with a <code>Maybe</code> - it need to deal with the <code>Nothing</code>, so perhaps you want it to have the type <code>StateT (Maybe s) IO ()</code> ?</p>\n\n<p>A second logic problem (?) with your code is that certainly the <code>s</code> returned by <code>interval</code> will not have been changed yet - the setInterval code can't possibly have been triggered until javascript goes back into its idle loop.</p>\n\n<p>The general problem of passing callbacks has been discussed a few times over the years, see:</p>\n\n<p><a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2007-July/028501.html\" rel=\"nofollow\">https://mail.haskell.org/pipermail/haskell-cafe/2007-July/028501.html</a>\n<a href=\"http://andersk.mit.edu/haskell/monad-peel/\" rel=\"nofollow\">http://andersk.mit.edu/haskell/monad-peel/</a>\n<a href=\"http://blog.sigfpe.com/2011/10/quick-and-dirty-reinversion-of-control.html\" rel=\"nofollow\">http://blog.sigfpe.com/2011/10/quick-and-dirty-reinversion-of-control.html</a></p>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 3611, "user_id": 1029158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YmuXk.jpg?s=128&g=1", "display_name": "DiegoNolan", "link": "https://stackoverflow.com/users/1029158/diegonolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 32779298, "answer_count": 1, "score": 1, "last_activity_date": 1526823704, "creation_date": 1443168121, "last_edit_date": 1526823704, "question_id": 32777502, "link": "https://stackoverflow.com/questions/32777502/write-interval-function-for-the-statet-monad-in-haste", "title": "Write interval function for the StateT monad in Haste", "body": "<p>So I wrote my own implementation of <code>StateT</code> because I couldn't get transformers to compile correctly in Haste. I think wanted to get the javascript <code>setInterval</code> working inside my state monad. Here is the ffi call to <code>setInterval</code>.</p>\n\n<pre><code>jsInterval :: Int -&gt; IO () -&gt; IO Int\njsInterval = ffi \"(function(t,f){window.setInterval(f,t);})\"\n</code></pre>\n\n<p>I couldn't think of anyway to get the result of <code>m</code> back after it is passed to <code>jsInterval</code>. So I tried to use <code>IORefs</code>.</p>\n\n<pre><code>interval :: Int -&gt; StateT s IO () -&gt; StateT s IO Int\ninterval i m = StateT $ \\s -&gt; do\n    ref &lt;- newIORef Nothing\n    id_ &lt;- jsInterval i $ do\n                       (_, s') &lt;- runStateT m s\n                       writeIORef ref (Just s')\n    s' &lt;- readIORef ref\n    return (id_, s')\n</code></pre>\n\n<p>This didn't work because it kept the original state. The read happened before the write. So I wrote a function that would poll in a loop until the <code>IORef</code> was written but this just hung forever.</p>\n\n<pre><code>interval :: Int -&gt; StateT s IO () -&gt; StateT s IO Int\ninterval i m = StateT $ \\s -&gt; do\n    ref &lt;- newIORef Nothing\n    id_ &lt;- jsInterval i $ do\n                       (_, s') &lt;- runStateT m s\n                       writeIORef ref (Just s')\n    s' &lt;- go ref\n    return (id_, s')\n  where\n    go ref = do\n      s &lt;- readIORef ref\n      case s of\n        Nothing -&gt; go ref\n        Just s' -&gt; return s'\n</code></pre>\n\n<p>Is it possible to implement this function? I tried writing an instance of <code>MonadEvent</code> for <code>StateT</code> but that was also unsuccessful.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": false, "score": 7, "last_activity_date": 1443164303, "creation_date": 1443164303, "answer_id": 32776512, "question_id": 32776326, "link": "https://stackoverflow.com/questions/32776326/haskell-function-to-duplicate/32776512#32776512", "title": "Haskell function to duplicate", "body": "<p>Your desired result <code>Tail Tail</code> is not a Lizard anymore. Actually <code>Tail Tail</code> is not a valid value at all. Also your function <code>duplicate</code> cannot do much as it takes a Lizard and returns a Lizard and the only possible Lizard is <code>Tail</code>.</p>\n\n<p>If you want Lizards with multiple Tails you need to reflect this in your Lizard datatype, e.g. as </p>\n\n<pre><code>data Tail = Tail deriving (Eq, Show)\ndata Lizard = Lizard [Tail] deriving (Eq, Show)\n\nduplicate :: Lizard -&gt; Lizard\nduplicate (Lizard ts) = Lizard (ts++ts)\n\nresult = duplicate (Lizard [Tail])\n</code></pre>\n\n<p>This gives you</p>\n\n<pre><code>*Main&gt; result\nLizard [Tail,Tail]\n</code></pre>\n\n<p>or applied twice</p>\n\n<pre><code>*Main&gt; duplicate result\nLizard [Tail,Tail,Tail,Tail]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1443180816, "post_id": 32776551, "comment_id": 53400780, "body": "<code>Lizard</code>s with <code>Bottom</code> are just Peano nats. Hence you need to recurse only on the first argument in <code>siamese</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443190706, "post_id": 32776551, "comment_id": 53407258, "body": "The <code>siamese t Bottom = t</code> part is not needed."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443192338, "post_id": 32776551, "comment_id": 53408280, "body": "@user3237465: I understand it&#39;s not needed, but the point of recursing only on the first argument is to save operations right? And this saves operations as well: if we add 0 to a number, we don&#39;t have to traverse all the way through the number before finally adding the 0, we can just return the number directly. Actually I think we could recurse on both, but as soon as <i>one of the two</i> is a bottom finish our recursion. If we add <i>m</i> and <i>n</i>, the current operation takes ~ <i>m</i> time, by recursing on both I think it would take ~ <i>2 min(m, n)</i> which could be better in some cases."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443193453, "post_id": 32776551, "comment_id": 53409030, "body": "My point was about simplicity rather than efficiency. I now think that your original definition is more appropriate, sorry for the misleading comment."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443193759, "post_id": 32776551, "comment_id": 53409232, "body": "No problem, you&#39;ve convinced me to go for simplicity for the example&#39;s sake :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443195156, "post_id": 32776551, "comment_id": 53410151, "body": "If every lizard has at least one tail, you can use <code>data Lizard = Lizard Tail [Tail]</code>, which is the same idea as the definition of the <code>NonEmpty</code> type, <code>data NonEmpty a = NonEmpty a [a]</code>; so a lizard could be <code>newtype Lizard = Lizard (NonEmpty Tail)</code>. If the tails don&#39;t have any information, you can (with recent GHC), import <code>Numeric.Natural</code> and use <code>newtype Lizard = Lizard Natural</code>, interpreting the natural number as either the number of tails or the number of tails minus 1."}], "tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": false, "score": 4, "last_activity_date": 1443193673, "last_edit_date": 1443193673, "creation_date": 1443164430, "answer_id": 32776551, "question_id": 32776326, "link": "https://stackoverflow.com/questions/32776326/haskell-function-to-duplicate/32776551#32776551", "title": "Haskell function to duplicate", "body": "<p>The way you use <code>Tail Tail</code> is not going to work for a datatype <code>data Lizard = Tail</code>, because <code>Tail</code> as you define it is a constructor that takes no arguments.</p>\n\n<p><strong>Mutant duplicators</strong></p>\n\n<p>If you want to use a constructor for each tail you can do something like the following:</p>\n\n<pre><code>data Lizard = Mutant Lizard Lizard | Tail\n\nduplicate :: Lizard -&gt; Lizard\nduplicate l = Mutant l l\n</code></pre>\n\n<p>Then <code>duplicate Tail</code> will give <code>Mutant Tail Tail</code>. Duplicating that will give <code>Mutant (Mutant Tail Tail) (Mutant Tail Tail)</code>.</p>\n\n<p><strong>Lists of tails</strong></p>\n\n<p>If it doesn't have to be all encoded in data but using values is also OK you can do this:</p>\n\n<pre><code>data Tail = Tail\ndata Lizard = LizMonster [Tail] | Lizard Tail\n\nduplicate :: Lizard -&gt; Lizard\nduplicate (Lizard t) = LizMonster [t,t]\nduplicate (LizMonster ts) = LizMonster (ts ++ ts)\n</code></pre>\n\n<p>You could also say that a <code>Lizard</code> with 1 tail is not so different from a monster with many tails and use <code>Lizard [Tail]</code> for all your cases. (Then you will probably want to define something like <code>oneTail = Lizard [Tail]</code> because using a list for a single tail might be a bit unintuitive).</p>\n\n<p><strong>From Tail to Bottom</strong></p>\n\n<p>If you're not only interested in duplications we can define a lizard which is very similar to a list of tails. This will give you output a bit closer to what you're looking for:</p>\n\n<pre><code>data Lizard = Tail Lizard | Bottom deriving (Show)\n\nnoTail :: Lizard\nnoTail = Bottom\n\noneTail :: Lizard\noneTail = Tail Bottom\n\nduplicate :: Lizard -&gt; Lizard\nduplicate (Tail t) = Tail . Tail $ duplicate t\nduplicate Bottom = Bottom\n\n-- Additional benefit: we can make siamese lizards\nsiamese :: Lizard -&gt; Lizard -&gt; Lizard\nsiamese (Tail t1) t = Tail $ siamese t1 t\nsiamese Bottom t = t\n</code></pre>\n\n<p>If we check how this shows up in for example GHCi it's quite close to what you want:</p>\n\n<pre><code>duplicate oneTail\n-- gives Tail (Tail Bottom)\n</code></pre>\n\n<p>And we can do more fancy stuff:</p>\n\n<pre><code>siamese (oneTail) (duplicate oneTail)\n-- gives Tail (Tail (Tail Bottom))\n</code></pre>\n\n<p>Arguably, if you keep on cutting off a lizard's tails, you might get something that more closely resembles the tree-like structure from the first suggestion though.</p>\n"}], "owner": {"reputation": 11, "user_id": 5375012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cbbdee31d877680c21a8086de4e434?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5375012/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443195276, "creation_date": 1443163500, "last_edit_date": 1443195276, "question_id": 32776326, "link": "https://stackoverflow.com/questions/32776326/haskell-function-to-duplicate", "title": "Haskell function to duplicate", "body": "<p>If a lizard's tail gets cut off, say two more get regrown. If I have the data type below, how would I write a function to be able to duplicate how many tails are grown?     </p>\n\n<pre><code>data Lizard = Tail\n    deriving (Eq, Show)\n\nduplicate :: Lizard -&gt; Lizard\nduplicate Tail?? = ???\n</code></pre>\n\n<p>so the input</p>\n\n<pre><code>&gt; duplicate Tail\n</code></pre>\n\n<p>should give</p>\n\n<pre><code>&gt; Tail Tail\n</code></pre>\n"}, {"tags": ["list", "function", "haskell", "tuples"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1443124990, "post_id": 32769930, "comment_id": 53378914, "body": "This looks like you want to do some kind of grouping with a capital-M <code>Map</code>."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1443125403, "post_id": 32769930, "comment_id": 53379096, "body": "no, it&#39;s a data structure from Data.Map."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443144435, "post_id": 32769930, "comment_id": 53385758, "body": "I think a better duplicate would be <a href=\"http://stackoverflow.com/q/12398458/791604\">How to group similar items in a list?</a>; the current duplicate&#39;s answer appears to be primarily about formatting, whereas this question is primarily about the grouping part."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443187502, "post_id": 32769930, "comment_id": 53405061, "body": "@DanielWagner That would be a better question to link back to, I mostly closed it as a duplicate because OP asked what is essentially the same question twice.  I&#39;ll see if I can reopen and then mark it as a duplicate of the question you linked. EDIT: I can&#39;t vote to close it again for a while, feel free to throw your vote in."}], "answers": [{"comments": [{"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 0, "creation_date": 1443125532, "post_id": 32770024, "comment_id": 53379168, "body": "This assumes all elements with the same <code>snd</code> already occur together in the input. If you sort first, you make sure that&#39;s not a problem."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1443125948, "last_edit_date": 1443125948, "creation_date": 1443125300, "answer_id": 32770024, "question_id": 32769930, "link": "https://stackoverflow.com/questions/32769930/haskell-combine-integers-in-a-list-of-tuples/32770024#32770024", "title": "Haskell: Combine integers in a list of tuples", "body": "<p>You can do this using <code>groupBy</code> if you order the list first:</p>\n\n<pre><code>import Data.List (groupBy)\nimport Data.Ord (comparing)\nimport Data.Function (on)\n\nmap (\\l@((_,c):_) -&gt; (map fst l, c))  $ groupBy (on (==) snd) $ sortBy (comparing snd) inputList\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 6, "last_activity_date": 1443125843, "last_edit_date": 1443125843, "creation_date": 1443125476, "answer_id": 32770066, "question_id": 32769930, "link": "https://stackoverflow.com/questions/32769930/haskell-combine-integers-in-a-list-of-tuples/32770066#32770066", "title": "Haskell: Combine integers in a list of tuples", "body": "<p>This should do:</p>\n\n<pre><code>import Data.Function (on)\nimport Data.List (groupBy, sort, sortBy)\n\nout = map f . groupBy ((==) `on` snd) . sortBy (compare `on` snd) $ input\n  where input = [(2,\"a\"),(1,\"a\"),(1,\"b\"),(1,\"c\"),(2,\"dd\")]\n        f xs@(x:_) = (sort $ map fst xs, snd x)\n\nmain = print out\n</code></pre>\n"}], "owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1415, "favorite_count": 0, "closed_date": 1443198573, "accepted_answer_id": 32770066, "answer_count": 2, "score": 2, "last_activity_date": 1443187507, "creation_date": 1443124904, "question_id": 32769930, "link": "https://stackoverflow.com/questions/32769930/haskell-combine-integers-in-a-list-of-tuples", "closed_reason": "Duplicate", "title": "Haskell: Combine integers in a list of tuples", "body": "<p>I need to get from here:</p>\n\n<pre><code>[(2,\"a\"), (1,\"a\"), (1,\"b\"), (1,\"c\"), (2,\"dd\")]\n</code></pre>\n\n<p>to here: </p>\n\n<pre><code>[([1, 2], \"a\"), ([1], \"b\"), ([1], \"c\"), ([2], \"dd\")]\n</code></pre>\n\n<p>So far I have </p>\n\n<pre><code>combineInts listTuple = someFunc (map (\\(num, str) -&gt; ([num], str)) listTuple)\n</code></pre>\n\n<p>where \"someFunc\" is the bit I still need to figure out and implement. I believe it should utilize foldr, map, and/or intercalate to accomplish my goal. Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 7, "creation_date": 1443124700, "post_id": 32769751, "comment_id": 53378770, "body": "This must be due to the desugaring of <code>..</code>-defined lists, and how it behaves oddly with floating point numbers. See <a href=\"http://stackoverflow.com/q/7290438/2751851\">Haskell ranges and floats</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1443125474, "post_id": 32769751, "comment_id": 53379132, "body": "<code>[1,3..10]</code> is a bad idea, especially using floating point numbers. Use <code>[1,3..9]</code> instead, or <code>[1,3..11]</code>. Number <code>10</code> falls exactly in the middle of the last &quot;step&quot; (from 9 to 11), so rounding will decide whether the closest approximation to 10 is 9 or 11."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1443128102, "post_id": 32769751, "comment_id": 53380437, "body": "@chi, in my opinion, that puts the blame in the wrong place. Fractional numbers (and <i>especially</i> floating point representations) have no business being in the <code>Enum</code> class. The sane way to get a list of floats like this is <code>map fromIntegral [1,3..whatever]</code>."}, {"owner": {"reputation": 71, "user_id": 5373679, "user_type": "registered", "profile_image": "https://graph.facebook.com/896449947102081/picture?type=large", "display_name": "Leopold Faschalek", "link": "https://stackoverflow.com/users/5373679/leopold-faschalek"}, "edited": false, "score": 0, "creation_date": 1443190199, "post_id": 32769751, "comment_id": 53406931, "body": "ok I got it, the wole list is type converted (as a range list, not per element)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1443217209, "post_id": 32769751, "comment_id": 53421032, "body": "great question! <code>Prelude&gt; length (map log x3) - length x3</code> =&gt;  <code>1</code>. Very funny looking. :) Compare with   <code>Prelude&gt; map (</code>asTypeOf` 1) x3` =&gt;  <code>[1,3,5,7,9]</code> ;  <code>Prelude&gt; map (</code>asTypeOf` 1.0) x3` =&gt;  <code>[1.0,3.0,5.0,7.0,9.0,11.0]</code>. <b>No</b>, the list is not &quot;converted&quot;. It does not exist at all, until its use. What exists, is the definition: <code>enumFromThenTo 1 3 10</code>. It is taken to be polymorphic, i.e. can have elements of any type which is in Num class. So until type is known, list doesn&#39;t exist. So at each use site it is built anew, esp. if types are different (if same types, it might get cached)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1443218407, "post_id": 32769751, "comment_id": 53421394, "body": "(&quot;can have elements of any type which is in Num class.&quot; all elements must be of the same type, of course)."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5373679, "user_type": "registered", "profile_image": "https://graph.facebook.com/896449947102081/picture?type=large", "display_name": "Leopold Faschalek", "link": "https://stackoverflow.com/users/5373679/leopold-faschalek"}, "edited": false, "score": 0, "creation_date": 1443189573, "post_id": 32769949, "comment_id": 53406507, "body": "sorry, but the problem ist not the original list, but the computed list from map"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 71, "user_id": 5373679, "user_type": "registered", "profile_image": "https://graph.facebook.com/896449947102081/picture?type=large", "display_name": "Leopold Faschalek", "link": "https://stackoverflow.com/users/5373679/leopold-faschalek"}, "edited": false, "score": 0, "creation_date": 1443190438, "post_id": 32769949, "comment_id": 53407098, "body": "updated answer - hopefully this explains it more."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1443201756, "last_edit_date": 1443201756, "creation_date": 1443124964, "answer_id": 32769949, "question_id": 32769751, "link": "https://stackoverflow.com/questions/32769751/result-list-of-map-is-one-longer/32769949#32769949", "title": "result list of map is one longer", "body": "<p>As @duplode suggested, it has to do with how <code>..</code> behaves with floating point vs. integers:</p>\n\n<pre><code>Prelude&gt; let x3 = [1,3..10] :: [Double]\nPrelude&gt; length x3\n6\nPrelude&gt; let x3 = [1,3..10] :: [Int]\nPrelude&gt; length x3\n5\n</code></pre>\n\n<p>Update in response to the comment...</p>\n\n<p>A definition like this in ghci:</p>\n\n<pre><code>let xs = [1,3..11]\n</code></pre>\n\n<p>is polymorphic. The <code>..</code> is a shortcut for the <code>enumFromThenTo</code> function:</p>\n\n<pre><code>let xs = enumFromThenTo 1 3 11\n</code></pre>\n\n<p>The result is polymorphic - the above expression has type:</p>\n\n<pre><code>ghci&gt; :t xs\nx3 :: (Enum t, Num t) =&gt; [t]\n</code></pre>\n\n<p>If you just print it out, Haskell chooses to type is as <code>[Integer]</code>, and you get:</p>\n\n<pre><code>[1,3,5,7,9]\n</code></pre>\n\n<p>Here the Integer version of <code>enumFromThenTo</code> is being used.</p>\n\n<p>However, if you apply a floating point operation to the list, Haskell interprets it as <code>[Double]</code>, and then it becomes one element longer for the reasons explained above:</p>\n\n<pre><code>ghci&gt; map (+ 0.0) x3\n[1.0,3.0,5.0,7.0,9.0,11.0]  -- length 6 now!\n</code></pre>\n\n<p>So the <code>map</code> operation \"changes\" the length of the list only because it changes the interpretation of its type which changes which <code>enumFromThenTo</code> function is called to construct it.</p>\n\n<p>Upshot: A list defined like <code>[1,3..11]</code> does not have known length until its type is determined.</p>\n"}], "owner": {"reputation": 71, "user_id": 5373679, "user_type": "registered", "profile_image": "https://graph.facebook.com/896449947102081/picture?type=large", "display_name": "Leopold Faschalek", "link": "https://stackoverflow.com/users/5373679/leopold-faschalek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1443128361, "answer_count": 1, "score": 7, "last_activity_date": 1443201756, "creation_date": 1443124194, "last_edit_date": 1443124554, "question_id": 32769751, "link": "https://stackoverflow.com/questions/32769751/result-list-of-map-is-one-longer", "closed_reason": "Duplicate", "title": "result list of map is one longer", "body": "<p>in this Haskell example the result is sometimes one longer than the base list. Any clue for this?</p>\n\n<pre><code>Prelude&gt; let x3 = [1,3..10]\nPrelude&gt; x3\n[1,3,5,7,9]\nPrelude&gt; length x3\n5\nPrelude&gt; length $ map (+1) x3\n5\nPrelude&gt; length $ map (*3) x3\n5\nPrelude&gt; length $ map (/2) x3\n6\nPrelude&gt; length $ map (/1) x3\n6\nPrelude&gt; length $ map (`div`1) x3\n5\nPrelude&gt; map log x3\n   [0.0,1.0986122886681098,1.6094379124341003\n   ,1.9459101490553132,2.1972245773362196,2.3978952727983707]\nPrelude&gt; length it\n6\n</code></pre>\n"}, {"tags": ["haskell", "typeclass", "type-constraints"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1443122504, "post_id": 32769112, "comment_id": 53377648, "body": "what you are looking for is already there - but there are more than one possible Monoids for numbers - that&#39;s why it&#39;s there for <code>Sum</code> and <code>Product</code>(<a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Monoid.html#t:Monoid\" rel=\"nofollow noreferrer\">see Data.Monoid</a>)"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1443124996, "post_id": 32769112, "comment_id": 53378916, "body": "@Carsten So now that I know about <code>Sum</code>, I can do this: <code>mconcat ([1,2] :: Sum Int)</code>, which is nice, but I can&#39;t do <code>mconcat ([1,2] :: Sum Float)</code>, nor <code>mconcat ([1,2] :: Sum Fractional)</code>. What is the proper way to use <code>Sum</code> for <code>Float</code>s and <code>Double</code>s?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1443126635, "post_id": 32769112, "comment_id": 53379728, "body": "I have no clue how you got the first to work - but <code>mconcat ([1,2] :: [Sum Float])</code> works fine for me ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1443126786, "post_id": 32769112, "comment_id": 53379790, "body": "btw: <code>Fractional</code> is no type, it&#39;s a class, so <code>Sum Fractional</code> makes no sense here (<code>Sum</code> wants something of kind <code>*</code> as it&#39;s first parameter, but <code>Fractional</code> is <code>* -&gt; Constraint</code>)"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1443126901, "post_id": 32769112, "comment_id": 53379850, "body": "Oops, yes I meant <code>:: [Sum Int]</code> in the first example not <code>:: Sum Int</code>. And what I couldn&#39;t get to work was <code>mconcat ([1.0, 2.0] :: [Sum Float])</code>; <code>mconcat ([1, 2] :: [Sum Float])</code> works fine."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1443127037, "post_id": 32769112, "comment_id": 53379913, "body": "the first one will not work because <code>1.0</code> is <code>Fractional something</code> and I think there is no such instance for <code>Sum</code> (there is one for <code>Num a =&gt; Num (Sum a)</code> so the example with <code>[1,2]</code> has no issue at all)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1443127137, "post_id": 32769112, "comment_id": 53379971, "body": "of course <code>mconcat [Sum 1.0, Sum 2.0]</code> will work ;)"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1443127683, "post_id": 32769112, "comment_id": 53380243, "body": "I got significantly less noob today, thanks. I&#39;ll check with more detail the source code."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443132005, "post_id": 32769112, "comment_id": 53382290, "body": "The Haskell libraries committee recently decided to add another new bunch of instances to <code>Sum</code> etc., but they weren&#39;t numerical classes. Maybe next time..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444879638, "post_id": 32769112, "comment_id": 54089572, "body": "If one of the answers satisfies you, you should accept it."}], "answers": [{"tags": [], "owner": {"reputation": 1284, "user_id": 5209349, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f5341e747308691d40f30d79ffd75f9?s=128&d=identicon&r=PG", "display_name": "Michael Benfield", "link": "https://stackoverflow.com/users/5209349/michael-benfield"}, "is_accepted": true, "score": 21, "last_activity_date": 1443124785, "last_edit_date": 1443124785, "creation_date": 1443123836, "answer_id": 32769655, "question_id": 32769112, "link": "https://stackoverflow.com/questions/32769112/can-you-make-an-instance-of-a-class-not-for-a-type-but-for-a-whole-class-in-hask/32769655#32769655", "title": "Can you make an instance of a class not for a type but for a whole class in Haskell?", "body": "<p>I'm interpreting this as asking about a general premise, rather than specifically about <code>Monoid</code> and <code>Num</code>.</p>\n\n<p>Maybe you could get what you wrote to work, by enabling language extensions FlexibleInstances, UndecidableInstances, and using overlapping instances.</p>\n\n<p>But you probably wouldn't want to: it <em>seems like</em> <code>instance Num t =&gt; Monoid t where ...</code> is saying </p>\n\n<p>\"If <code>t</code> is an instance of <code>Num</code>, here's how to make <code>t</code> an instance of <code>Monoid</code>...\" </p>\n\n<p>Unfortunately, that's not right. What it's actually saying is more like </p>\n\n<p>\"Here's how to make <code>t</code> an instance of <code>Monoid.</code> First, it's necessary that <code>t</code> be an instance of <code>Num</code>. Next...\"</p>\n\n<p>Thus, if you write an instance declaration like this, you can't write any other instance declarations. (At least not without <code>OverlappingInstances</code>, which would bring its own issues.)</p>\n"}, {"tags": [], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "is_accepted": false, "score": 6, "last_activity_date": 1443123846, "creation_date": 1443123846, "answer_id": 32769657, "question_id": 32769112, "link": "https://stackoverflow.com/questions/32769112/can-you-make-an-instance-of-a-class-not-for-a-type-but-for-a-whole-class-in-hask/32769657#32769657", "title": "Can you make an instance of a class not for a type but for a whole class in Haskell?", "body": "<p>GHC allows your definition with some language extensions enabled</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, UndecidableInstances #-}\n\ninstance Num t =&gt; Monoid t where\n  mappend = (+)\n  mempty = 0\n</code></pre>\n\n<p>This makes <code>2 &lt;&gt; 3</code> result in <code>5</code>.</p>\n\n<p><strong>But</strong> this overlaps with other <code>Monoid</code> instances, so trying to evaluate <code>\"Hello\" &lt;&gt; \"World\"</code> results with an error: <code>Overlapping instances for Monoid [Char]</code></p>\n\n<p>So, I think that the short answer is: no.</p>\n"}], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 2, "accepted_answer_id": 32769655, "answer_count": 2, "score": 8, "last_activity_date": 1443125710, "creation_date": 1443121843, "last_edit_date": 1443125710, "question_id": 32769112, "link": "https://stackoverflow.com/questions/32769112/can-you-make-an-instance-of-a-class-not-for-a-type-but-for-a-whole-class-in-hask", "title": "Can you make an instance of a class not for a type but for a whole class in Haskell?", "body": "<p>Suppose I want to make all numbers an instance of <code>Monoid</code>. Instead of having to create an instance for each <code>Num</code> like this:</p>\n\n<pre><code>instance Monoid Int where\n  mappend = (+)\n  mempty = 0\n\ninstance Monoid Float where\n  mappend = (+)\n  mempty = 0.0\n\n-- etc\n</code></pre>\n\n<p>Is there something like this?</p>\n\n<pre><code>instance Num t =&gt; Monoid t where\n  mappend = (+)\n  mempty = 0\n</code></pre>\n\n<h1>Edit</h1>\n\n<p>Some are answering with GHC extensions and warning about the potential issues; I found that informative, but I think I will stick with <code>Sum</code>, <code>Product</code> and whatever <a href=\"https://wiki.haskell.org/GHC/Coercible\"><code>coerce</code></a> does.</p>\n"}, {"tags": ["haskell", "hackage", "haddock"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443122110, "post_id": 32768787, "comment_id": 53377439, "body": "What&#39;s your .cabal file?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443122959, "post_id": 32768787, "comment_id": 53377894, "body": "@user5402: Added .cabal file."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443133335, "post_id": 32768787, "comment_id": 53382793, "body": "Your <code>tar</code> command ends with <code>MyPackage-0.0.1.3-docs</code>, which doesn&#39;t match the version in the rest. Did you perhaps pack the wrong one by accidental tab completion?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443133821, "post_id": 32768787, "comment_id": 53382969, "body": "@&#216;rjanJohansen: Typo in the question. Sorry."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1443363771, "post_id": 32768787, "comment_id": 53454570, "body": "What version of haddock are you using? I remember it used to get the links all wrong. I have been using <a href=\"https://github.com/michaelt/streaming/blob/master/upload.sh\" rel=\"nofollow noreferrer\">github.com/michaelt/streaming/blob/master/upload.sh</a> with Haddock version 2.16.1 (Add your user name when you call &quot;sh upload.sh MyHackageName&quot;) Also, I think &quot;cabal-version:  &gt;= 1.10&quot; should be fine."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1443368938, "post_id": 32768787, "comment_id": 53456208, "body": "@Michael: My Cabal version is <code>1.22.4.0</code>. I don&#39;t have a separate Haddock version, but my (local) docs show they were built with <code>2.16.1</code>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1443368962, "post_id": 32768787, "comment_id": 53456218, "body": "@Michael: using the linked <code>upload.sh</code> script give the same error as everything else."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443123595, "post_id": 32769528, "comment_id": 53378243, "body": "Ah. I see. That&#39;s why it seems to be such a common problem (poking around I see the exact, word for word, error for a couple dozen packages just hit at random). I&#39;ll see if I can step down. If not, what are my options for getting docs onto Hackage?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 3, "creation_date": 1443127034, "post_id": 32769528, "comment_id": 53379911, "body": "Yuk. Cabal needs to do that. No wonder this is a common issue."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443142475, "post_id": 32769528, "comment_id": 53385362, "body": "I&#39;ve also tried the linked approach (which amounts to the same thing as indicated in the edit to my question) with the same result."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443218438, "post_id": 32769528, "comment_id": 53421405, "body": "I&#39;ve tried every link I can find. Every version of the scripts derived from fails the same way. I&#39;ve added the script I&#39;m using to the question."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443270138, "post_id": 32769528, "comment_id": 53431966, "body": "Also note that the <a href=\"http://fuuzetsu.co.uk/blog/posts/2014-01-06-Fix-your-Hackage-documentation.html\" rel=\"nofollow noreferrer\">first link&#39;s</a> instructions are wrong (the docs are not in the directory indicated but in an <code>html</code> subdirectory). Perhaps they are outdated. All the other instructions I&#39;ve found are essentially the same as what I have in the script above, and work until the upload stage where I get the indicated error."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443442566, "post_id": 32769528, "comment_id": 53480859, "body": "It looks like Hacakge now supports to 7.10.2! Hooray!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1443126542, "last_edit_date": 1443126542, "creation_date": 1443123306, "answer_id": 32769528, "question_id": 32768787, "link": "https://stackoverflow.com/questions/32768787/how-do-i-get-documentation-for-my-haskell-package-onto-hackage/32769528#32769528", "title": "How do I get documentation for my Haskell package onto Hackage?", "body": "<p>Does your library require <code>base &gt;= 4.8.1.0</code>?</p>\n\n<p>That's the problem - Hackage is trying to use <code>base == 4.7.0.1</code> which conflicts with your cabal file.</p>\n\n<p>I would see if you can build your library with the base that Hackage is using.</p>\n\n<p>Some links to uploading docs to Hackage yourself:</p>\n\n<ul>\n<li><p><a href=\"http://fuuzetsu.co.uk/blog/posts/2014-01-06-Fix-your-Hackage-documentation.html\" rel=\"nofollow\">http://fuuzetsu.co.uk/blog/posts/2014-01-06-Fix-your-Hackage-documentation.html</a></p></li>\n<li><p><a href=\"https://gist.github.com/stbuehler/7068764\" rel=\"nofollow\">https://gist.github.com/stbuehler/7068764</a></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443369324, "post_id": 32809050, "comment_id": 53456351, "body": "This would build them locally with my version of <code>base</code> though, right?"}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443369473, "post_id": 32809050, "comment_id": 53456393, "body": "Yes honestly it works so transparently that i am not 100% certain how it works but i am pretty sure it does everything locally and just uploads the final product to hackage."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443369745, "post_id": 32809050, "comment_id": 53456488, "body": "Since I get all the way to the upload step with the other scripts, I think the best avenue is to figure out what &quot;file in tar archive is not in the expected directory&quot;. Is there perhaps something that Hackage needs to be uploaded, that would not have been built locally; a setting I should add to my (local) Cabal/Haddock config, perhaps?"}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443370877, "post_id": 32809050, "comment_id": 53456826, "body": "So you didn&#39;t try <code>neil</code> yet? Honestly at the time I was in your position, I tried <code>neil</code>, never looked back, and thankfully never needed to understand the details."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443372810, "post_id": 32809050, "comment_id": 53457448, "body": "I was a bit spooked by the pages of packages that installing it threatens to break."}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443373836, "post_id": 32809050, "comment_id": 53457759, "body": "Yes install it in a separate sandbox. Create a new folder, <code>cabal sandbox init</code>, <code>cabal install neil</code>, then the executable will be in <code>.cabal-sandbox&#47;bin</code>. Run it from your app&#39;s folder and you are set. You must trust it though because it asks for your hackage password."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443374335, "post_id": 32809050, "comment_id": 53457910, "body": "I guess I need to get comfortable with sandboxes (I&#39;ve never used them). Briefly though (1) how do I tear down a sandbox and (2) if <code>neil docs</code> works, can I leave the sandbox around and not use it for anything else other than to invoke <code>neil</code> from the command line?"}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443374463, "post_id": 32809050, "comment_id": 53457952, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/90740/discussion-between-emmanuel-touzery-and-raxacoricofallapatorius\">continue this discussion in chat</a>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443392145, "post_id": 32809050, "comment_id": 53463328, "body": "Oh dear. Now it fails with &quot;curl: (18) transfer closed with outstanding read data remaining&quot;. I haven&#39;t changed anything!"}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443414455, "post_id": 32809050, "comment_id": 53467739, "body": "Sounds like a straightforward network or server issue."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443442524, "post_id": 32809050, "comment_id": 53480827, "body": "Probably. It looks like things were changing there. I still get the error, but it no longer matters: Hackage built the docs <a href=\"https://github.com/haskell/hackage-server/issues/419\" rel=\"nofollow noreferrer\">with 7.10.2</a>."}], "tags": [], "owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "is_accepted": true, "score": 4, "last_activity_date": 1443365266, "last_edit_date": 1443365266, "creation_date": 1443364628, "answer_id": 32809050, "question_id": 32768787, "link": "https://stackoverflow.com/questions/32768787/how-do-i-get-documentation-for-my-haskell-package-onto-hackage/32809050#32809050", "title": "How do I get documentation for my Haskell package onto Hackage?", "body": "<p>Even if the docs would build on hackage, they take some time to appear and at some point they were broken for an extended period of time. I got used to do it with the <code>neil</code> tool as described here:</p>\n\n<p><a href=\"http://neilmitchell.blogspot.si/2014/10/fixing-haddock-docs-on-hackage.html\" rel=\"nofollow\">http://neilmitchell.blogspot.si/2014/10/fixing-haddock-docs-on-hackage.html</a></p>\n\n<p>I first install neil (in another sandbox on my disk), then, in the folder of your library:</p>\n\n<pre><code>neil docs --username=YourHackageUsername\n</code></pre>\n\n<p>It takes care of all the details for you!</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 4, "accepted_answer_id": 32809050, "answer_count": 2, "score": 7, "last_activity_date": 1443469354, "creation_date": 1443120707, "last_edit_date": 1443469354, "question_id": 32768787, "link": "https://stackoverflow.com/questions/32768787/how-do-i-get-documentation-for-my-haskell-package-onto-hackage", "title": "How do I get documentation for my Haskell package onto Hackage?", "body": "<blockquote>\n  <p>UPDATE: This question is now out of date. Hackage now uses Haskell\n  version 7.10.2 to build, so the following failure does not\n  occur. The change also appears to have broken some of the scripts\n  mentioned in the answers.</p>\n</blockquote>\n\n<p>How do I get documentation for my Haskell package onto Hackage?</p>\n\n<p>My understanding what that Hackage would build them, but I get an error</p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: MyPackage-0.1.0.2 (user goal)\nnext goal: base (dependency of MyPackage-0.1.0.2)\nrejecting: base-4.7.0.1/installed-e4b... (conflict: MyPackage =&gt; base&gt;=4.8 &amp;&amp;\n&lt;4.9)\nrejecting: base-4.8.1.0, 4.8.0.0, 4.7.0.2, 4.7.0.1, 4.7.0.0, 4.6.0.1, 4.6.0.0,\n4.5.1.0, 4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2, 4.2.0.1,\n4.2.0.0, 4.1.0.0, 4.0.0.0, 3.0.3.2, 3.0.3.1 (global constraint requires\ninstalled instance)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>I'm not able to downgrade the requirements for my package (which appears to be the obstacle to an automatic build) and I see that some packages say \"Docs uploaded by user\". However any attempt to build fails (see below.)</p>\n\n<p>How do I get documentation for my Haskell package onto Hackage? In particular, what do I need to do to upload them myself?</p>\n\n<hr>\n\n<p>I've <a href=\"https://wiki.haskell.org/How_to_write_a_Haskell_program#Upload_your_package_documentation_to_Hackage\" rel=\"nofollow\">tried</a></p>\n\n<pre><code>$ cp -R ./dist/doc/html/MyPackage/ MyPackage-0.1.0.2-docs\n$ tar cvzf --format=ustar -f MyPackage-0.1.0.2-docs.tar.gz MyPackage-0.1.0.2-docs\n$ curl -X PUT -H 'Content-Type: application/x-tar' -H 'Content-Encoding: gzip' --data-binary '@MyPackage-0.1.0.2-docs.tar.gz' 'https://hackage.haskell.org/package/MyPackage-0.1.0.2/docs' -u 'Rax'\n</code></pre>\n\n<p>but get</p>\n\n<blockquote>\n  <p>Invalid documentation tarball: File in tar archive is not in the\n  expected directory 'MyPackage-0.1.0.2-docs'</p>\n</blockquote>\n\n<hr>\n\n<pre><code>name:                   MyPackage\nversion:                0.1.0.2\nlicense:                BSD3\nlicense-file:           LICENSE\n-- copyright:           \ncategory:               Development\nbuild-type:             Simple\n-- extra-source-files:  \ncabal-version:          &gt;= 1.22.1.1\n\nlibrary\n    -- default-extensions: Trustworthy\n    exposed-modules:    MyMod.A,\n                        MyMod.A.B\n    other-modules:      MyMod.C\n    -- other-extensions:\n    build-depends:      base &gt;= 4.8.1.0 &amp;&amp; &lt;4.9,\n                        containers &gt;= 0.5.5.1,\n                        split &gt;= 0.2.2,\n                        MissingH &gt;= 1.3.0.1\n    -- hs-source-dirs:\n    default-language:   Haskell2010\n</code></pre>\n\n<hr>\n\n<p>I've also tried my own version of the several scripts linked below, but get the same error:</p>\n\n<pre><code>#!/bin/bash\n\ncabal haddock --hyperlink-source --html-location='/package/$pkg-$version/docs'  --contents-location='/package/$pkg'\nS=$?\nif [ \"${S}\" -eq \"0\" ]; then\n    cd \"dist/doc/html\"\n    DDIR=\"${1}-${2}-docs\"\n    cp -r \"${1}\" \"${DDIR}\" &amp;&amp; tar -c -v -z --format=ustar -f \"${DDIR}.tar.gz\" \"${DDIR}\"\n    CS=$?\n    if [ \"${CS}\" -eq \"0\" ]; then\n        echo \"Uploading to Hackage\u2026\"\n        curl -X PUT -H 'Content-Type: application/x-tar' -H 'Content-Encoding: gzip' --data-binary \"@${DDIR}.tar.gz\" --digest --netrc \"https://hackage.haskell.org/package/${1}-${2}/docs\"\n        exit $?\n    else\n        echo \"Error when packaging the documentation\"\n        exit $CS\n    fi\nelse\n    echo \"Error when trying to build the package.\"\n    exit $S\nfi\n</code></pre>\n\n<p>which I invoke with</p>\n\n<pre><code>myscript MyPackage 0.1.0.2\n</code></pre>\n\n<p>but get the same error.</p>\n"}, {"tags": ["performance", "list", "haskell", "garbage-collection", "automatic-differentiation"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1443109063, "post_id": 32765313, "comment_id": 53369950, "body": "More info!  How are you running this program?  Where is your test harness?  What concrete types are you using?  What are the flags and version on your Haskell compiler?"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1443109507, "post_id": 32765313, "comment_id": 53370244, "body": "Added some info. That function is called via the ad grad function which uses its own types (instances of Num). Profiling shows allocations of &quot;Cells&quot;."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 0, "creation_date": 1443111321, "post_id": 32765313, "comment_id": 53371465, "body": "Some half-informed suggestions: did you consider using mutable state with <code>ST</code>? And <a href=\"https://hackage.haskell.org/package/stream-fusion-0.1.2.5/docs/Data-List-Stream.html\" rel=\"nofollow noreferrer\">stream-fusion</a>/<a href=\"https://hackage.haskell.org/package/conduit\" rel=\"nofollow noreferrer\">conduit</a>/<a href=\"https://hackage.haskell.org/package/pipes\" rel=\"nofollow noreferrer\">pipes</a>? Maybe (?) it could even be worthwhile to transform your vector-list into something else, e.g. an <a href=\"http://lambda.jstolarek.com/2013/04/haskell-as-fast-as-c-a-case-study/\" rel=\"nofollow noreferrer\">unboxed vector</a>? I do not have experience with any of these techniques but maybe the links can help you further."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 3, "creation_date": 1443111388, "post_id": 32765313, "comment_id": 53371528, "body": "Just to exclude an obvious thing: what if you add a bang pattern in the last clause of <code>go</code>, e.g. <code>go (y:ys) (x:xs) !ix = go ys xs (y*x+ix)</code>"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1443111607, "post_id": 32765313, "comment_id": 53371667, "body": "I&#39;m starting to think this is linked to AD itself and not my code. For example <a href=\"http://stackoverflow.com/questions/30888615/how-to-get-more-performance-out-of-automatic-differentiation\" title=\"how to get more performance out of automatic differentiation\">stackoverflow.com/questions/30888615/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/30072218/how-to-do-automatic-differentiation-on-hmatrix\" title=\"how to do automatic differentiation on hmatrix\">stackoverflow.com/questions/30072218/&hellip;</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1443115477, "post_id": 32765313, "comment_id": 53373979, "body": "Could you give a minimum executable example?"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1443187979, "post_id": 32765313, "comment_id": 53405365, "body": "@ThomasM.DuBuisson, run example added"}], "answers": [{"comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1443112135, "post_id": 32766312, "comment_id": 53372021, "body": "Mhh, good idea, but it doesn&#39;t help at all in my use case (no improvement in speed or GC usage). I think the fact that the function is called via the ad library is what&#39;s impacting the performance (I see a Cells datatype with a strict Int field)."}], "tags": [], "owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "is_accepted": false, "score": 7, "last_activity_date": 1443111620, "creation_date": 1443111620, "answer_id": 32766312, "question_id": 32765313, "link": "https://stackoverflow.com/questions/32765313/optimize-a-list-function-that-creates-too-much-garbage-not-stack-overflow/32766312#32766312", "title": "Optimize a list function that creates too much garbage (not stack overflow)", "body": "<p>A very simple optimization is to make the <code>go</code> function strict by its accumulator parameter, because it's small, can be unboxed if <code>a</code> is primitive and always needs to be fully evaluated:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nlistMProd :: (Num a) =&gt; [a] -&gt; [a] -&gt; [a]\nlistMProd mdt vdt = go mdt vdt 0\n  where\n    go [] _  !s = [s]\n    go ls [] !s = s : go ls vdt 0\n    go (y:ys) (x:xs) !ix = go ys xs (y*x+ix)\n</code></pre>\n\n<p>On my machine, it gives 3-4x speedup (compiled with <code>-O2</code>).</p>\n\n<p>On the other hand, intermediate lists shouldn't be strict so they could be fused.</p>\n"}], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 11, "last_activity_date": 1443187955, "creation_date": 1443108576, "last_edit_date": 1443187955, "question_id": 32765313, "link": "https://stackoverflow.com/questions/32765313/optimize-a-list-function-that-creates-too-much-garbage-not-stack-overflow", "title": "Optimize a list function that creates too much garbage (not stack overflow)", "body": "<p>I have that Haskell function, that's causing more than 50% of all the allocations of my program, causing 60% of my run time to be taken by the GC. I run with a small stack (<code>-K10K</code>) so there is no stack overflow, but can I make this function faster, with less allocation?</p>\n\n<p>The goal here is to calculate the product of a matrix by a vector. I cannot use <a href=\"http://hackage.haskell.org/package/hmatrix\" rel=\"nofollow\"><code>hmatrix</code></a> for example because this is part of a bigger function using the <a href=\"https://hackage.haskell.org/package/ad\" rel=\"nofollow\"><code>ad</code> Automatic Differentiation</a> package, so I need to use lists of <code>Num</code>. At runtime I suppose the use of the <code>Numeric.AD</code> module means my types must be <code>Scalar Double</code>.</p>\n\n<pre><code>listMProd :: (Num a) =&gt; [a] -&gt; [a] -&gt; [a]\nlistMProd mdt vdt = go mdt vdt 0\n  where\n    go [] _  s = [s]\n    go ls [] s = s : go ls vdt 0\n    go (y:ys) (x:xs) ix = go ys xs (y*x+ix)\n</code></pre>\n\n<p>Basically we loop through the matrix, multiplying and adding an accumulator until we reach the end of the vector, storing the result, then continuing restarting the vector again. I have a <code>quickcheck</code> test verifying that I get the same result than the matrix/vector product in hmatrix.</p>\n\n<p>I have tried with <code>foldl</code>, <code>foldr</code>, etc. Nothing I've tried makes the function faster (and some things like <code>foldr</code> cause a space leak).</p>\n\n<p>Running with profiling tells me, on top of the fact that this function is where most of the time and allocation is spent, that there are loads of <a href=\"https://hackage.haskell.org/package/ad-4.2.4/docs/Numeric-AD-Internal-Reverse.html#t:Cells\" rel=\"nofollow\"><code>Cells</code></a> being created, <code>Cells</code> being a data type from the <code>ad</code> package.</p>\n\n<p>A simple test to run:</p>\n\n<pre><code>import Numeric.AD\n\nmain = do\n    let m :: [Double] = replicate 400 0.2\n        v :: [Double] = replicate 4 0.1\n        mycost v m = sum $ listMProd m v \n        mygrads = gradientDescent (mycost (map auto v)) (map auto m)\n    print $ mygrads !! 1000\n</code></pre>\n\n<p>This on my machine tells me GC is busy 47% of the time.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443092132, "post_id": 32759412, "comment_id": 53358130, "body": "Lines 2-4 in the code you posted have wrong indentation, which should cause a compilation error different from the one you got. That suggests you didn&#39;t paste your code exactly as you tested it. If so, please edit your question so that the code matches exactly what you have in your source file."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 0, "creation_date": 1443092165, "post_id": 32759412, "comment_id": 53358154, "body": "There is at least one problem in your indentation, the code below <code>do</code> in the <code>prompt</code> definition should be indented. If I try to compile the code after fixing that I get a series of other errors, at least some of which are related to <code>seconds</code> being of type <code>Int</code> and afterwards used with <code>&#47;</code> (which needs <code>Fractional</code> values =&gt; use <code>fromIntegral</code> if you want <code>&#47;</code> or better use <code>div</code>)."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1443092222, "post_id": 32759412, "comment_id": 53358192, "body": "@duplode: If I try to compile his code after copy-pasting, I get exactly the error he mentions."}, {"owner": {"reputation": 1715, "user_id": 1671718, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/2e56eb87e99c4e34b450e9335475ec09?s=128&d=identicon&r=PG", "display_name": "mungaih pk", "link": "https://stackoverflow.com/users/1671718/mungaih-pk"}, "edited": false, "score": 1, "creation_date": 1443092276, "post_id": 32759412, "comment_id": 53358239, "body": "I have rectified the indentation error.That was during pasting."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443148705, "post_id": 32759610, "comment_id": 53386665, "body": "There is another problem not mentioned in this answer, and invisible unless you click &quot;edit&quot; to get the raw source from the question: his indentation in <code>main</code> looks like <code>main = do\\n\\tlet foo = ...\\n\\t\\tbar = ...</code>. This will only render correctly with four-space tabstops; since the compiler uses eight-space tabstops it is not correct Haskell. See also <a href=\"http://dmwit.com/tabs/\" rel=\"nofollow noreferrer\">my guidelines for using tabs in Haskell</a>, which suggest using <code>main = do\\n\\tlet foo = ...\\n\\t\u2423\u2423\u2423\u2423bar = ...</code>; and keep in mind that the majority opinion seems to be that one should use only spaces when coding in Haskell."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443154372, "post_id": 32759610, "comment_id": 53387984, "body": "@DanielWagner thanks - maybe you should add this as an answer(?) - to be honest I usually don&#39;t even notice as I just loaded the stuff into emacs and fixed the obvious problems (I let emacs take care of the tab vs. spaces thing and I hope it does it correctly ;))"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443155057, "post_id": 32759610, "comment_id": 53388151, "body": "@Carsten emacs was not involved in fixing this particular problem: StackOverflow itself converted the tabs in the original question into spaces during markdown-rendering. It&#39;s a nasty habit that I wish they would correct."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443155752, "post_id": 32759610, "comment_id": 53388369, "body": "@DanielWagner ah yes of course ... sorry, as I said I did not even notice, that&#39;s why you should probably make it an answer too ;)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 7, "last_activity_date": 1443092739, "last_edit_date": 1443092739, "creation_date": 1443092238, "answer_id": 32759610, "question_id": 32759412, "link": "https://stackoverflow.com/questions/32759412/parse-error-in-a-do-block/32759610#32759610", "title": "Parse error in a do block", "body": "<p>ok here are the parts you need to do in order to get it compiling/running:</p>\n\n<ul>\n<li>remove the intendation problem in prompt</li>\n<li><code>seconds</code> / <code>read</code> is not an <code>IO</code> action so use <code>let</code>/ <code>=</code></li>\n<li>use <code>div</code> instead of <code>/</code></li>\n<li><code>mod</code> here needs to be put into backticks</li>\n<li><code>putStr</code> expects an <code>String</code> so either add <code>show</code> or use <code>print</code></li>\n</ul>\n\n<hr>\n\n<pre><code>module Main where\n\nprompt x = do\n  putStrLn x\n  number &lt;- getLine\n  return number\n\nmain = do\n    number &lt;- prompt \" Please input a number: \"\n    let seconds = read number :: Int\n        hours = seconds `div` 3600\n        remaining_seconds = seconds `mod` 3600\n        minutes = remaining_seconds `div` 60\n        final_seconds = remaining_seconds `rem` 60 \n    print hours\n</code></pre>\n\n<hr>\n\n<p>btw: I would refactor it into this:</p>\n\n<pre><code>module Main where\n\nprompt :: String -&gt; IO Int\nprompt x = do\n  putStrLn x\n  number &lt;- getLine\n  return $ read number\n\nmain :: IO ()\nmain = do\n    seconds &lt;- prompt \" Please input a number: \"\n    let (minutes,seconds') = seconds `divMod` 60\n        (hours',minutes') = minutes `divMod` 60\n    putStrLn $ show hours' ++ \":\" ++ show minutes' ++ \":\" ++ show seconds'\n</code></pre>\n"}], "owner": {"reputation": 1715, "user_id": 1671718, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/2e56eb87e99c4e34b450e9335475ec09?s=128&d=identicon&r=PG", "display_name": "mungaih pk", "link": "https://stackoverflow.com/users/1671718/mungaih-pk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 0, "accepted_answer_id": 32759610, "answer_count": 1, "score": 0, "last_activity_date": 1443112449, "creation_date": 1443091628, "last_edit_date": 1443112449, "question_id": 32759412, "link": "https://stackoverflow.com/questions/32759412/parse-error-in-a-do-block", "title": "Parse error in a do block", "body": "<p>I am a haskell dummy. I am trying to request the user for seconds and then display the hours, minutes and seconds. Here is my code:</p>\n\n<pre><code>prompt x = do\n    putStrLn x\n    number &lt;- getLine\n    return number\n\nmain = do\n    number &lt;- prompt \" Please input a number: \"\n    seconds &lt;- read number :: Int\n    let hours = seconds / 3600\n        remaining_seconds = seconds mod 3600\n        minutes = remaining_seconds/60\n        final_seconds = remaining_seconds `rem` 60 \n    putStr (hours)\n</code></pre>\n\n<p>However, I have an error at this <code>remaining_seconds = seconds mod 3600</code>. This is the error <code>parse error on input '='</code>\nPlease help me solve it. Regards,</p>\n"}, {"tags": ["haskell", "recursion", "lambda", "fold", "partial-application"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "edited": false, "score": 0, "creation_date": 1443090877, "post_id": 32758393, "comment_id": 53357379, "body": "Sorry for the typos and thanks for the edit, duplode!"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1443091483, "post_id": 32758393, "comment_id": 53357707, "body": "By the way, there is nothing recursive about your <code>firstThat</code> \u2014 just merely because <code>foldr</code> helps you non recursively rewrite an otherwise recursive function, doesn&#39;t mean you should refer to any function that uses <code>foldr</code> as a recursive one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1443108613, "post_id": 32758393, "comment_id": 53369648, "body": "Thank you, I see what you mean and of course it makes sense. I have a lot more to learn than I thought."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 2, "creation_date": 1443110279, "post_id": 32758393, "comment_id": 53370756, "body": "Maybe seeing the function written as <code>firstThat :: (a -&gt; Bool) -&gt; a -&gt; ([a] -&gt; a)</code> would help?  It takes two arguments and returns a <code>[a] -&gt; a</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "edited": false, "score": 0, "creation_date": 1443112964, "post_id": 32759146, "comment_id": 53372532, "body": "I am familiar with both, partial application and currying, but your answer will still help me to avoid tripping over some particular concepts in the future. That&#39;s why I upvoted your anser too. Thank you!"}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 5, "last_activity_date": 1443091241, "last_edit_date": 1443091241, "creation_date": 1443090825, "answer_id": 32759146, "question_id": 32758393, "link": "https://stackoverflow.com/questions/32758393/haskell-recursive-function-example-with-foldr/32759146#32759146", "title": "Haskell recursive function example with foldr", "body": "<blockquote>\n  <p>a function that takes one arguments and returns a Boolean value. Since the > operator is actually an infix function, the first argument in the example above seems the result of a partial application to the > function \u2013 is this correct?</p>\n</blockquote>\n\n<p>yes: <code>(&gt;10)</code> is short for <code>\\x -&gt; x &gt; 10</code>, just as <code>(10&gt;)</code> would be short for <code>\\x -&gt; 10 &gt; x</code>.</p>\n\n<blockquote>\n  <p>an unspecified value of the same type expected as the missing argument to the function provided as the first argument</p>\n</blockquote>\n\n<p>first of all, it's not a missing argument: by omitting an argument, you obtain a function value. however, the type of the 2nd argument does indeed match the argument of the function <code>&gt;10</code>, just as it matches the type of the elements of the list <code>[10,20,30,40]</code> (which is better reasoning).</p>\n\n<blockquote>\n  <p>a list of values of the aforementioned type</p>\n</blockquote>\n\n<p>yes.</p>\n\n<blockquote>\n  <p>But the actual function firstThat seems to be defined differently from its type declaration, with just one argument. Since foldr normally takes three arguments I gathered there is some kind of partial application happening. The lambda expression provided as an argument to foldr seem to be missing its arguments too.</p>\n</blockquote>\n\n<p>that's because given e.g. <code>foo x y z = x * y * z</code>, these 2 lines are equivalent:</p>\n\n<pre><code>bar x     = foo x\nbar x y z = foo x y z\n</code></pre>\n\n<p>\u2014 that's because of a concept called currying. Currying is also the reason why function type signatures are not <code>(a, b) -&gt; c</code> but instead <code>a -&gt; b -&gt; c</code>, which in turn is equivalent to <code>a -&gt; (b -&gt; c)</code> because of the right associativity of the <code>-&gt;</code> type operator.</p>\n\n<p>Therefore, these two lines are equivalent:</p>\n\n<pre><code>firstThat f     = foldr (\\x acc -&gt; if f x then x else acc)\nfirstThat f x y = foldr (\\x acc -&gt; if f x then x else acc) x y\n</code></pre>\n\n<hr>\n\n<p><strong>Note:</strong> that you can also use <code>Data.List.find</code> combined with <code>Data.Maybe.fromMaybe</code>:</p>\n\n<pre><code>\u03bb&gt; fromMaybe 2000 $ find (&gt;10) [10, 20, 30]\n20\n\u03bb&gt; fromMaybe 2000 $ find (&gt;10) [1, 2, 3]\n2000\n</code></pre>\n\n<hr>\n\n<p>See also:</p>\n\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Currying\">https://en.wikipedia.org/wiki/Currying</a>.</li>\n<li><a href=\"https://www.fpcomplete.com/user/EFulmer/currying-and-partial-application\">https://www.fpcomplete.com/user/EFulmer/currying-and-partial-application</a></li>\n<li><a href=\"http://learnyouahaskell.com/higher-order-functions\">http://learnyouahaskell.com/higher-order-functions</a></li>\n</ul>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "edited": false, "score": 1, "creation_date": 1443112833, "post_id": 32759365, "comment_id": 53372438, "body": "After reading the last third of your answer it clicked. Loudly. I should have done a <code>:t foldr</code> right away. That might have even helped me far enough to realize I should concentrate on lambdas a bit more in the future. Great answer, thanks!"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 5, "last_activity_date": 1443091489, "creation_date": 1443091489, "answer_id": 32759365, "question_id": 32758393, "link": "https://stackoverflow.com/questions/32758393/haskell-recursive-function-example-with-foldr/32759365#32759365", "title": "Haskell recursive function example with foldr", "body": "<blockquote>\n  <p>But the actual function <code>firstThat</code> seems to be defined differently from its type declaration, with just one argument. Since <code>foldr</code> normally takes three arguments I gathered there is some kind of partial application happening.</p>\n</blockquote>\n\n<p>You are right. However, there is a nicer way of putting it than talking about \"missing arguments\" -- one that doesn't lead you into asking where they have gone. Here are two ways in which the arguments are not missing.</p>\n\n<p>Firstly, consider this function:</p>\n\n<pre><code>add :: Num a =&gt; a -&gt; a -&gt; a\nadd x y = x + y\n</code></pre>\n\n<p>As you may know, we can also define it like this:</p>\n\n<pre><code>add :: Num a =&gt; a -&gt; a -&gt; a\nadd = (+)\n</code></pre>\n\n<p>That works because Haskell functions are values like any other. We can simply define a value, <code>add</code>, as being equal to another value, <code>(+)</code>, which just happens to be a function. There is no special syntax required to declare a function. The upshot is that writing arguments explicitly is (almost) never necessary; the main reason why we do so because it often makes code more readable (for instance, I could define <code>firstThat</code> without writing the <code>f</code> parameter explicitly, but I won't do so because the result is rather hideous).</p>\n\n<p>Secondly, whenever you see a function type with three arguments...</p>\n\n<pre><code>firstThat :: (a -&gt; Bool) -&gt; a -&gt; [a] -&gt; a\n</code></pre>\n\n<p>... you can also read it like this...</p>\n\n<pre><code>firstThat :: (a -&gt; Bool) -&gt; (a -&gt; [a] -&gt; a)\n</code></pre>\n\n<p>... that is, a function of one argument that produces a function of two arguments. That works for all functions of more than one argument. The key takeaway is that, at heart, <em>all Haskell functions take just one argument</em>. That is why partial application works. So on seeing...</p>\n\n<pre><code>firstThat :: (a -&gt; Bool) -&gt; a -&gt; [a] -&gt; a\nfirstThat f = foldr (\\x acc -&gt; if f x then x else acc)\n</code></pre>\n\n<p>... you can accurately say that you have written explicitly all parameters that <code>firstThat</code> takes -- that is, only one :)</p>\n\n<hr>\n\n<blockquote>\n  <p>The lambda expression provided as an argument to <code>foldr</code> seem to be missing its arguments too.</p>\n</blockquote>\n\n<p>Not really. <code>foldr</code> (when restricted to lists) is...</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>... and so the function passed to it takes two arguments (feel free to add air quotes around \"two\", given the discussion above). The lambda was written as...</p>\n\n<pre><code>\\x acc -&gt; if f x then x else acc\n</code></pre>\n\n<p>... with two explicit arguments, <code>x</code> and <code>acc</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1419, "favorite_count": 0, "accepted_answer_id": 32759365, "answer_count": 2, "score": 7, "last_activity_date": 1557609462, "creation_date": 1443088428, "last_edit_date": 1557609462, "question_id": 32758393, "link": "https://stackoverflow.com/questions/32758393/haskell-recursive-function-example-with-foldr", "title": "Haskell recursive function example with foldr", "body": "<p>I've taken up learning Haskell again, after a short hiatus and I am currently trying to get a better understanding of how recursion and lambda expressions work in Haskell.</p>\n\n<p>In this: <a href=\"https://youtu.be/1IjBT9TSTyQ\">YouTube video</a>, there is a function example that puzzles me far more than it probably should, in terms of how it actually works:</p>\n\n<pre><code>firstThat :: (a -&gt; Bool) -&gt; a -&gt; [a] -&gt; a\nfirstThat f = foldr (\\x acc -&gt; if f x then x else acc)\n</code></pre>\n\n<p>For the sake of clarity and since it wasn't immediately obvious to me, I'll give an example of applying this function to some arguments:</p>\n\n<pre><code>firstThat (&gt;10) 2000 [10,20,30,40] --returns 20, but would return 2000, if none of the values in the list were greater than 10\n</code></pre>\n\n<p>Please correct me, if my assumptions are wrong.</p>\n\n<p>It seems <code>firstThat</code> takes three arguments:</p>\n\n<ol>\n<li>a function that takes one arguments and returns a Boolean value. Since the <code>&gt;</code> operator is actually an infix function, the first argument in the example above seems the result of a partial application to the <code>&gt;</code> function \u2013 is this correct?</li>\n<li>an unspecified value of the same type expected as the missing argument to the function provided as the first argument</li>\n<li>a list of values of the aforementioned type</li>\n</ol>\n\n<p>But the actual function <code>firstThat</code> seems to be defined differently from its type declaration, with just one argument. Since <code>foldr</code> normally takes three arguments I gathered there is some kind of partial application happening. The lambda expression provided as an argument to <code>foldr</code> seem to be missing its arguments too.</p>\n\n<p>So, how exactly does this function work? I apologize if I am being too dense or fail to see the forest for the trees, but I just cannot wrap my head around it, which is frustrating.</p>\n\n<p>Any helpful explanation or example(s) would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "emacs", "ghc", "ghci"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1443093296, "post_id": 32758234, "comment_id": 53358887, "body": "I don&#39;t know about ghc-mod, but GHC defaults to storing compiles code next to source code, whereas Cabal puts the compiled code in the distribution folder..."}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1443097687, "post_id": 32758234, "comment_id": 53361668, "body": "Actually, I talk about ghc-mod but I was wrong: I am using haskell-mode with embedded REPL which uses <code>cabal repl</code> under the hood."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443108188, "post_id": 32758234, "comment_id": 53369356, "body": "@insitu, please edit the correction into the question."}], "answers": [{"tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": true, "score": 0, "last_activity_date": 1444198650, "creation_date": 1444198650, "answer_id": 32985022, "question_id": 32758234, "link": "https://stackoverflow.com/questions/32758234/how-can-i-prevent-recompiling-when-switching-between-ghci-and-ghc/32985022#32985022", "title": "How can I prevent recompiling when switching between ghci and ghc", "body": "<p>You can have <code>ghci</code> and friends use different suffixes for the compiled files. Add the following to your <code>~/.ghci</code>:</p>\n\n<pre><code>:set -hisuf i_hi\n:set -osuf i_o\n</code></pre>\n\n<p>...and ghci will output stuff to <code>foo.i_hi</code> and <code>foo.i_o</code> which won't overwrite the <code>.hi</code> and <code>.o</code> files of ghc.</p>\n"}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 32985022, "answer_count": 1, "score": 4, "last_activity_date": 1444198650, "creation_date": 1443087938, "last_edit_date": 1443194481, "question_id": 32758234, "link": "https://stackoverflow.com/questions/32758234/how-can-i-prevent-recompiling-when-switching-between-ghci-and-ghc", "title": "How can I prevent recompiling when switching between ghci and ghc", "body": "<p>When I use both ghci with <code>-fobject-code</code> and command-line ghc, code is compiled fully when switching from one to the other. For example, when I work interactively in Emacs using haskell inferior mode configured to use <code>cabal repl</code>, code loads and compiles fine. Then I do a <code>cabal build</code> and same code is recompiled. </p>\n\n<p>How can I prevent this double compilation assuming <code>-fobject-code</code> in ghci actually uses the same kind of binary format than ghc does?</p>\n"}, {"tags": ["haskell", "f#", "functional-programming", "ocaml", "ml"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1443085735, "post_id": 32757039, "comment_id": 53354238, "body": "can one of the downvoters please explain what the problem is here? The question seems good to me. FP subcommunities here usually are really friendly and I hope we can keep it that way, so please at least why the question is bad in your opinion."}, {"owner": {"reputation": 5432, "user_id": 3210257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e031a73b4d825b34b8fbcdae03b76f0b?s=128&d=identicon&r=PG", "display_name": "PatJ", "link": "https://stackoverflow.com/users/3210257/patj"}, "edited": false, "score": 1, "creation_date": 1443087497, "post_id": 32757039, "comment_id": 53355442, "body": "I think you should post one question per language, as future people will probably search one answer. Mainly, I&#39;d say if your question expects different answers, then you should split it."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1443089791, "post_id": 32757039, "comment_id": 53356774, "body": "@Carsten The levels of moderation noise seem to be higher than usual at the moment. Over the last couple of days I have seen not only odd downvotes but also absurd close votes in at least two [haskell] questions."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1443101502, "post_id": 32757039, "comment_id": 53364511, "body": "When a question is framed like &quot;Where do I find X?&quot; is very easily misunderstood as looking for off site resource or as lacking research. The next time you should frame your question to avoid such misunderstanding. Also if you are looking for something independent of the specific programming language you should use <a href=\"https://stackoverflow.com/questions/tagged/language-agnostic\">language-agnostic</a> or simply <a href=\"https://stackoverflow.com/questions/tagged/functional-programming\">functional-programming</a> alone."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1443103368, "post_id": 32757039, "comment_id": 53365845, "body": "See also <a href=\"http://stackoverflow.com/questions/3911060/library-function-to-compose-a-function-with-itself-n-times/\" title=\"library function to compose a function with itself n times\">stackoverflow.com/questions/3911060/&hellip;</a> for discussion of this function in Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "edited": false, "score": 0, "creation_date": 1443086825, "post_id": 32757400, "comment_id": 53354963, "body": "iterateN doesn&#39;t have the signature I&#39;m looking for. The function should return the final value and not a sequence"}, {"owner": {"reputation": 807, "user_id": 1278218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc600c707e4f698ad2e6d0a1b9d9f119?s=128&d=identicon&r=PG", "display_name": "erdeszt", "link": "https://stackoverflow.com/users/1278218/erdeszt"}, "reply_to_user": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "edited": false, "score": 0, "creation_date": 1443097038, "post_id": 32757400, "comment_id": 53361271, "body": "@vidi You can always just take the last element(or you can inline the whole shebang inside iterateN and you don&#39;t have to build the collection)."}], "tags": [], "owner": {"reputation": 807, "user_id": 1278218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc600c707e4f698ad2e6d0a1b9d9f119?s=128&d=identicon&r=PG", "display_name": "erdeszt", "link": "https://stackoverflow.com/users/1278218/erdeszt"}, "is_accepted": false, "score": 3, "last_activity_date": 1443086294, "last_edit_date": 1443086294, "creation_date": 1443085473, "answer_id": 32757400, "question_id": 32757039, "link": "https://stackoverflow.com/questions/32757039/is-there-a-standard-higher-order-function-for-applying-a-transformation-several/32757400#32757400", "title": "Is there a standard higher order function for applying a transformation several times?", "body": "<p>There is an iterateN function for Haskell in the <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html#v:iterateN\" rel=\"nofollow\">Data.Sequence</a> module that looks like the one you are looking for.</p>\n\n<p>It's actually just a combinaton of iterate + take:\n<code>let iterateN n f x = take n (iterate f x)</code>\nHere's an F# version of iterate (<a href=\"http://www.fssnip.net/18\" rel=\"nofollow\">from here</a>), Seq.take is part of the F# standard library:</p>\n\n<pre><code>let rec iterate f value = seq { \n   yield value\n   yield! iterate f (f value) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1443088996, "last_edit_date": 1443088996, "creation_date": 1443087808, "answer_id": 32758193, "question_id": 32757039, "link": "https://stackoverflow.com/questions/32757039/is-there-a-standard-higher-order-function-for-applying-a-transformation-several/32758193#32758193", "title": "Is there a standard higher order function for applying a transformation several times?", "body": "<p>A possible solution:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; import Data.Monoid\n&gt; import Debug.SimpleReflect -- not really needed, just for showing the result\n&gt; (appEndo . mconcat . replicate 5 . Endo $ f) a\nf (f (f (f (f a))))\n</code></pre>\n\n<p>Another (already mentioned):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; iterate f a !! 5\nf (f (f (f (f a))))\n</code></pre>\n\n<p>(add lambdas if you want to turn it into a function)</p>\n\n<p>However, don't forget that Haskell is lazy: the above methods will first build a thunk by applying <code>f</code> many times and only then start evaluating. Sometimes <code>f</code> could be iterated in constant space, e.g. when <code>f :: Int -&gt; Int</code> (and <code>f</code> itself works in constant space), but the above approaches only work in linear space.</p>\n\n<p>I would define by own strict iteration combinator, e.g.:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>iter :: Int -&gt; (a -&gt; a) -&gt; a -&gt; a\niter 0 _ x = x\niter n f x = iter (pred n) f $! f x\n</code></pre>\n\n<p>or even,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>iter n f x = foldl' (flip $ const f) x [1..n]\n</code></pre>\n\n<p>which is more of less the Haskell translation of what was already posted in the question.</p>\n\n<p>Alternatively, we can can define a strict version of <code>iterate</code> (which IMHO should already exist...)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>iterate' :: (a -&gt; a) -&gt; a -&gt; [a]\niterate' f x = x : (iterate' f $! f x)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "edited": false, "score": 1, "creation_date": 1443100062, "post_id": 32759005, "comment_id": 53363373, "body": "I didn&#39;t know you can search by signature. Thanks for the link to Hayoo!"}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 7, "last_activity_date": 1443110023, "last_edit_date": 1443110023, "creation_date": 1443090416, "answer_id": 32759005, "question_id": 32757039, "link": "https://stackoverflow.com/questions/32757039/is-there-a-standard-higher-order-function-for-applying-a-transformation-several/32759005#32759005", "title": "Is there a standard higher order function for applying a transformation several times?", "body": "<p>You would have gotten (very close to) an answer by using for example <a href=\"http://hayoo.fh-wedel.de\" rel=\"nofollow\">Hayoo</a> (or Hoogle, but Hoogle's not as flexible \u2014 <code>iterateN</code> was not found):</p>\n\n<ul>\n<li><p>a search for <code>Int -&gt; (a -&gt; a) -&gt; a -&gt; a</code> revealed several functions that do what you want but are not part of the stdlib.</p></li>\n<li><p>a search for <code>applyN</code> returned a function of exactly the same name with the type signature you are looking.</p></li>\n<li><p>by laxing the return value by searching for <code>Int -&gt; (a -&gt; a) -&gt; a</code> instead (note the missing <code>-&gt; a</code> at the end), you get the <code>iterateN :: Int -&gt; (a -&gt; a) -&gt; a -&gt; Seq a</code> function which erdeszt has already mentioned.</p></li>\n</ul>\n\n<p>P.S. Hoogle seems to be more capable of flipping around argument order: <code>(a -&gt; a) -&gt; Int -&gt; a -&gt; Seq a</code> successfully returns 'iterateN :: Int -> (a -> a) -> a -> Seq a`, which Hayoo does not. </p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1443112338, "last_edit_date": 1443112338, "creation_date": 1443105819, "answer_id": 32764309, "question_id": 32757039, "link": "https://stackoverflow.com/questions/32757039/is-there-a-standard-higher-order-function-for-applying-a-transformation-several/32764309#32764309", "title": "Is there a standard higher order function for applying a transformation several times?", "body": "<p>To add to the list of other ways to do it,</p>\n\n<pre><code>import Control.Monad.State.Lazy\n\napplyN initial n =\n  flip execState initial . replicateM_ n . modify\n</code></pre>\n"}], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 1, "accepted_answer_id": 32759005, "answer_count": 4, "score": 6, "last_activity_date": 1443112338, "creation_date": 1443084265, "last_edit_date": 1443087136, "question_id": 32757039, "link": "https://stackoverflow.com/questions/32757039/is-there-a-standard-higher-order-function-for-applying-a-transformation-several", "title": "Is there a standard higher order function for applying a transformation several times?", "body": "<p>I'm thinking of a function like this:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>&gt; let applyN (initial : 't) (n:int) (f : 't -&gt; 't) = seq {1..n} |&gt; Seq.fold (fun s _ -&gt; f s) initial;;\n\nval applyN : initial:'t -&gt; n:int -&gt; f:('t -&gt; 't) -&gt; 't\n\n&gt; applyN 0 10 (fun x -&gt; x + 1);;\nval it : int = 10\n</code></pre>\n\n<p>Note: The code is F# but I tagged the question with haskell, ocaml and ml tags because if the function doesn't exist in F# libraries but it exists in other languages I would like to use the same name</p>\n"}, {"tags": ["haskell", "yesod", "persistent"], "answers": [{"comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1443425298, "post_id": 32814984, "comment_id": 53471422, "body": "I think <code>now()</code> is only valid inside trigger (or sql embedded) since &quot;The default attribute has absolutely no impact on the Haskell code itself&quot; (eg. entity constructors require values for <code>created</code> and <code>lastUpdate</code> fields) I think the only real solution is to add triggers at <code>persistent</code> migrating level (instead manually) but I don&#39;t know how."}], "tags": [], "owner": {"reputation": 7168, "user_id": 1449964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/87e463011e9c8e62cc67a6c688bf88c1?s=128&d=identicon&r=PG", "display_name": "Alexandr Kurilin", "link": "https://stackoverflow.com/users/1449964/alexandr-kurilin"}, "is_accepted": false, "score": 0, "last_activity_date": 1443408033, "creation_date": 1443408033, "answer_id": 32814984, "question_id": 32756202, "link": "https://stackoverflow.com/questions/32756202/database-persist-and-lastupdate-field/32814984#32814984", "title": "Database.Persist and `lastUpdate` field", "body": "<p>Since it looks like that's important to you, relying on a database's <code>now()</code> is safest, as that will consistently use the beginning of the transaction as the return value.If you compute the time in the application itself, you'll have to be very careful to pass the same value around everywhere.</p>\n\n<p>You can look into Haskell's esqueleto library to compose sql in such a way that you'd always have an additional <code>set</code> call for your <code>lastUpdate</code> column. I don't think it currently exposes the sql <code>now()</code> function, so you might want to add it yourself to the lib.</p>\n"}], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1443408033, "creation_date": 1443081474, "question_id": 32756202, "link": "https://stackoverflow.com/questions/32756202/database-persist-and-lastupdate-field", "title": "Database.Persist and `lastUpdate` field", "body": "<p>As far as I know <code>Database.Persist</code> don't deal for any auto-updated field (<a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow\">Yesod Book Persistent</a>).</p>\n\n<p>But exists one special case on it is relevant (at least for me :P) it is <code>lastUpdate :: UTCTime</code> field (I love it and I used widely to know data changes).</p>\n\n<p>Also, this update must to be performed at database level (if not, all servers should be perfectly synchronized [<em>it's hard and weak</em>] and record updates should be done inside transaction to include in it the <code>getTime</code> system call [<em>inefficient</em>]).</p>\n\n<p>My current workaround is create (<strong>manually</strong>) a trigger.</p>\n\n<p>Do you know a better way to do it?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "parallel-processing", "lazy-evaluation", "finger-tree"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1443079939, "post_id": 32755353, "comment_id": 53351076, "body": "What do you mean by &quot;parallel (but lazy)&quot;? Those seem like a contradiction in terms to me. In any case my suggestion would be to apply the usual <code>fmap</code> for <code>Seq</code>, and then do whatever parallel evaluation you want on the result."}, {"owner": {"reputation": 335, "user_id": 3195266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11459be624d79fcf9665b0a46653b151?s=128&d=identicon&r=PG", "display_name": "Netsu", "link": "https://stackoverflow.com/users/3195266/netsu"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443082901, "post_id": 32755353, "comment_id": 53352612, "body": "I mean lazy for this case: <code>or $ odd `pfmap` (fromList [4, 3, undefined]) -- =&gt; True</code>"}], "answers": [{"tags": [], "owner": {"reputation": 335, "user_id": 3195266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11459be624d79fcf9665b0a46653b151?s=128&d=identicon&r=PG", "display_name": "Netsu", "link": "https://stackoverflow.com/users/3195266/netsu"}, "is_accepted": false, "score": 0, "last_activity_date": 1443083083, "last_edit_date": 1443083083, "creation_date": 1443082538, "answer_id": 32756528, "question_id": 32755353, "link": "https://stackoverflow.com/questions/32755353/data-sequence-seq-lazy-parallel-functor-instance/32756528#32756528", "title": "Data.Sequence.Seq lazy parallel Functor instance", "body": "<p>I found a solution, but it's actually not so efficient.</p>\n\n<pre><code>-- | A combination of 'parTraversable' and 'fmap', encapsulating a common pattern:\n--\n-- &gt; parFmap strat f = withStrategy (parTraversable strat) . fmap f\n--\nparFmap         :: Traversable t =&gt; Strategy b -&gt; (a -&gt; b) -&gt; t a -&gt; t b\nparFmap strat f = (`using` parTraversable strat) . fmap f\n\n-- | Parallel version of '&lt;$&gt;'\n(&lt;$|&gt;) :: Traversable t =&gt;  (a -&gt; b) -&gt; t a -&gt; t b\n(&lt;$|&gt;) = parFmap rpar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1443143129, "last_edit_date": 1443143129, "creation_date": 1443109707, "answer_id": 32765693, "question_id": 32755353, "link": "https://stackoverflow.com/questions/32755353/data-sequence-seq-lazy-parallel-functor-instance/32765693#32765693", "title": "Data.Sequence.Seq lazy parallel Functor instance", "body": "<p>The best you can do is probably to <code>splitAt</code> the sequence into chunks, <code>fmap</code> over each chunk, and then append the pieces back together. <code>Seq</code> is represented as a <a href=\"http://staff.city.ac.uk/~ross/papers/FingerTree.html\" rel=\"nofollow\">finger tree</a>, so its underlying structure isn't particularly well suited to parallel algorithms\u2014if you split it up by its natural structure, successive threads will get larger and larger pieces. If you want to give it a go, you can copy the definition of the <code>FingerTree</code> type from the <code>Data.Sequence</code> source, and use <code>unsafeCoerce</code> to convert between it and a <code>Seq</code>. You'll probably want to send the first few <code>Deep</code> nodes to one thread, but then you'll have to think pretty carefully about the rest. Finger trees can be very far from weight-balanced, primarily because <code>3^n</code> grows asymptotically faster than <code>2^n</code>; you'll need to take that into account to balance work among threads.</p>\n\n<p>There are at least two sensible ways to split up the sequence, assuming you use <code>splitAt</code>:</p>\n\n<ol>\n<li><p>Split it all before breaking the computation into threads. If you do this, you should split it from left to right or right to left, because splitting off small pieces is cheaper than splitting off large ones and then splitting those. You should append the results in a similar fashion.</p></li>\n<li><p>Split it recursively in multiple threads. This might make sense if you want a lot of pieces or more potential laziness. Split the list near the middle and send each piece to a thread for further splitting and processing.</p></li>\n</ol>\n\n<p>There's another splitting approach that might be nicer, using the machinery currently used to implement <code>zipWith</code> (see the GitHub ticket I filed requesting <code>chunksOf</code>), but I don't know that you'd get a huge benefit in this application.</p>\n\n<p>The non-strict behavior you seek seems unlikely to work in general. You can probably make it work in many or most specific cases, but I'm not too optimistic that you'll find a totally general approach.</p>\n"}], "owner": {"reputation": 335, "user_id": 3195266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11459be624d79fcf9665b0a46653b151?s=128&d=identicon&r=PG", "display_name": "Netsu", "link": "https://stackoverflow.com/users/3195266/netsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 32765693, "answer_count": 2, "score": 1, "last_activity_date": 1443143129, "creation_date": 1443078420, "last_edit_date": 1443082615, "question_id": 32755353, "link": "https://stackoverflow.com/questions/32755353/data-sequence-seq-lazy-parallel-functor-instance", "title": "Data.Sequence.Seq lazy parallel Functor instance", "body": "<p>I need parallel (but lazy) version of <code>fmap</code> for <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html#t:Seq\" rel=\"nofollow\"><code>Seq</code></a> from <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html\" rel=\"nofollow\"><code>Data.Sequence</code></a> package. But package doesn't export any <code>Seq</code> data constructors. So I can't just wrap it in <code>newtype</code> and implement <code>Functor</code> directly for the <code>newtype</code>.</p>\n\n<p>Can I do it without rewriting the whole package?</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 3, "last_activity_date": 1443079011, "last_edit_date": 1443079011, "creation_date": 1443078651, "answer_id": 32755432, "question_id": 32754794, "link": "https://stackoverflow.com/questions/32754794/haskell-read-variable-name/32755432#32755432", "title": "Haskell read variable name", "body": "<p>Part of the problem is with your use of the <code>+++</code> operator. The following code works for me:</p>\n\n<pre><code>import Data.Char\nimport Text.ParserCombinators.ReadP\n\ntype Parser a = ReadP a\ntype Ident = String\n\nidentToken :: Parser String\nidentToken = do c &lt;- satisfy lowerCase\n                cs &lt;- letdigs\n                return (c:cs)\n  where lowerCase = \\x -&gt; x `elem` ['a'..'z']\n        underscore = \\x -&gt; x == '_'\n        letdigs = munch (\\c -&gt; isLetter c || isDigit c || underscore c)\n\nident :: Parser Ident\nident = do _ &lt;- skipSpaces\n           s &lt;- identToken\n           skipSpaces\n           return s\n\ntest_parseIdents :: String -&gt; Either String [Ident]\ntest_parseIdents p = case readP_to_S prog p of\n    [(j, \"\")]   -&gt; Right j\n    []          -&gt; Left \"Invalid parse\"\n    multipleRes -&gt; Left (\"Ambiguous idents: \" ++ show multipleRes)\n  where prog :: Parser [Ident]\n        prog = do result &lt;- many ident\n                  eof\n                  return result\n\nmain = print $ test_parseIdents \"test_1349_zefz\"\n</code></pre>\n\n<p>So what went wrong:</p>\n\n<ul>\n<li><p><code>+++</code> imposes an order on its arguments, and allows for multiple alternatives to succeed (<a href=\"http://haddock.stackage.org/lts-3.6/base-4.8.1.0/Text-ParserCombinators-ReadP.html\" rel=\"nofollow\">symmetric choice</a>). <code>&lt;++</code> is left-biased so only the left-most option succeeds -> this would remove the ambiguity in the parse, but still leaves the next problem.</p></li>\n<li><p>Your parser was looking for letters <em>first</em>, <em>then</em> digits, and <em>finally</em> underscores. Digits after underscores failed, for example. The parser had to be modified to <code>munch</code> characters that were <em>either</em> letters, digits or underscores.</p></li>\n</ul>\n\n<p>I also removed some functions that were unused and made an educated guess for the definition of your datatypes.</p>\n"}], "owner": {"reputation": 1550, "user_id": 2523007, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/aCsFp.jpg?s=128&g=1", "display_name": "vanomart", "link": "https://stackoverflow.com/users/2523007/vanomart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 32755432, "answer_count": 1, "score": 0, "last_activity_date": 1443079011, "creation_date": 1443076313, "last_edit_date": 1443078914, "question_id": 32754794, "link": "https://stackoverflow.com/questions/32754794/haskell-read-variable-name", "title": "Haskell read variable name", "body": "<p>I need to write a code that parses some language. I got stuck on parsing variable name - it can be anything that is at least 1 char long, starts with lowercase letter and can contain underscore '_' character. I think I made a good start with following code:</p>\n\n<pre><code>identToken :: Parser String\nidentToken = do \n                       c &lt;- letter\n                       cs &lt;- letdigs\n                       return (c:cs)\n             where letter = satisfy isLetter\n                   letdigs = munch isLetter +++ munch isDigit +++ munch underscore\n                   num = satisfy isDigit\n                   underscore = \\x -&gt; x == '_'\n                   lowerCase = \\x -&gt; x `elem` ['a'..'z'] -- how to add this function to current code?\n\nident :: Parser Ident\nident = do \n          _ &lt;- skipSpaces\n          s &lt;- identToken\n          skipSpaces; return $ s\n\nidents :: Parser Command\nidents = do \n          skipSpaces; ids &lt;- many1 ident\n          ...\n</code></pre>\n\n<p>This function however gives me a weird results. If I call my test function</p>\n\n<pre><code>test_parseIdents :: String -&gt; Either Error [Ident]\ntest_parseIdents p = \n  case readP_to_S prog p of\n    [(j, \"\")] -&gt; Right j\n    [] -&gt; Left InvalidParse\n    multipleRes -&gt; Left (AmbiguousIdents multipleRes)\n  where\n    prog :: Parser [Ident]\n    prog = do\n      result &lt;- many ident\n      eof\n      return result\n</code></pre>\n\n<p>like this:</p>\n\n<pre><code>test_parseIdents  \"test\"\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>Left (AmbiguousIdents [([\"test\"],\"\"),([\"t\",\"est\"],\"\"),([\"t\",\"e\",\"st\"],\"\"),\n    ([\"t\",\"e\",\"st\"],\"\"),([\"t\",\"est\"],\"\"),([\"t\",\"e\",\"st\"],\"\"),([\"t\",\"e\",\"st\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),\n    ([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\"),([\"t\",\"e\",\"s\",\"t\"],\"\")])\n</code></pre>\n\n<p>Note that <code>Parser</code> is just synonym for <code>ReadP a</code>.</p>\n\n<p>I also want to encode in the parser that variable names should start with a lowercase character.</p>\n\n<p>Thank you for your help.</p>\n"}]