[{"tags": ["haskell", "emacs", "autocomplete", "haskell-mode"], "comments": [{"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420683765, "post_id": 27830456, "comment_id": 44069841, "body": "Put the haskell library in your <code>load-path</code> and <code>require</code> it. See the Emacs manual for how to require libraries."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420693551, "post_id": 27830456, "comment_id": 44072128, "body": "@Drew I have no idea what you mean by haskell library... do you mean the ghc path, or the haskell mode path?"}, {"owner": {"reputation": 6075, "user_id": 147442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5cb67e96d4c724cfac0ff043b11c87e?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger Hanke", "link": "https://stackoverflow.com/users/147442/r%c3%bcdiger-hanke"}, "edited": false, "score": 1, "creation_date": 1420708978, "post_id": 27830456, "comment_id": 44077705, "body": "What version of GHC do you use? Perhaps it&#39;s this issue: <a href=\"https://github.com/kazu-yamamoto/ghc-mod/issues/417\" rel=\"nofollow noreferrer\">github.com/kazu-yamamoto/ghc-mod/issues/417</a> - ghc-mod only works with Cabal 1.22 if you use GHC 7.10 (the format of the &#39;setup-config&#39; file ghc-mod parses changed to binary). I had similar problems in Vim and went back to the last Cabal version and now ghc-mod works again."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 6075, "user_id": 147442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5cb67e96d4c724cfac0ff043b11c87e?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger Hanke", "link": "https://stackoverflow.com/users/147442/r%c3%bcdiger-hanke"}, "edited": false, "score": 0, "creation_date": 1420709594, "post_id": 27830456, "comment_id": 44078009, "body": "@R&#252;digerHanke I have GHC 7.6.3, and Cabal 1.22"}, {"owner": {"reputation": 6075, "user_id": 147442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5cb67e96d4c724cfac0ff043b11c87e?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger Hanke", "link": "https://stackoverflow.com/users/147442/r%c3%bcdiger-hanke"}, "edited": false, "score": 0, "creation_date": 1420710596, "post_id": 27830456, "comment_id": 44078565, "body": "Then that could be the problem. Does ghc-mod work from the command line? Check if the file &quot;dist/setup-config&quot; in your cabal project is binary now. That would cause the error &quot;[path]/dist/setup-config: hGetContents: invalid argument (invalid byte sequence)&quot; when starting ghc-mod. As I understand it, the solution is either to upgrade to GHC 7.10 or go back to an older Cabal."}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420724271, "post_id": 27830456, "comment_id": 44086504, "body": "What I meant was this: You are tying everything to <code>haskell-mode</code>, but nowhere do you show that you load the code that defines that mode. Put the location of <b>any</b> Lisp library that you want to load in your <code>load-path</code>, and <code>require</code> it. And especially: I meant what I said about reading the Emacs manual section about loading libraries. The information you are missing is common to all libraries and to using Emacs generally. And if you use the package manager then read the manual section about that. In sum, <b>ask Emacs</b>."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420731700, "post_id": 27830456, "comment_id": 44091534, "body": "@Drew I have it loaded from the package manager, in which case I don&#39;t need to manually <code>require</code> it... at least that&#39;s what the doc says"}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420733091, "post_id": 27830456, "comment_id": 44092574, "body": "OK, in that case, check why it was <b>not</b> loaded, because apparently it was not. Both your question title and the error <code>(void-function interactive-haskell-mode)</code> indicate that the haskell-mode code was not loaded. That is your problem, AFAICT: you do <b>not</b> &quot;<i>have it loaded from the package manager</i>&quot;."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420737204, "post_id": 27830456, "comment_id": 44095446, "body": "@Drew then it begs the question, why did the highlighting work correctly, and better yet, why was &quot;Haskell&quot; written as a major mode at the bottom of the buffer? Adding <code>(require &#39;haskell-mode)</code> does fix the error, but the autocomplete still doesn&#39;t work"}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420738239, "post_id": 27830456, "comment_id": 44096042, "body": "In that case, your question title is incorrect/misleading and apparently <code>interactive-haskell-mode</code> is not something defined by the haskell package you installed. Your question rambles and is not very clear at this point. Please consider editing it. It sounds like your question really has to do (only?) with why autocomplete is not working, but I&#39;m not sure."}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420738299, "post_id": 27830456, "comment_id": 44096076, "body": "And that would explain two things: why you got the error about <code>interactive-haskell-mode</code> and why autocomplete does not work. It is not the Haskell package that is not installed; it is the autocomplete package that is not installed. Go back and read what was written about installing the haskell package and replace it by the autocomplete package. Either install it using the pkg mgr or put it in your <code>load-path</code> and <code>require</code> it."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420739042, "post_id": 27830456, "comment_id": 44096456, "body": "@Drew oh autocomplete works alright.. with other languages than haskell"}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420739309, "post_id": 27830456, "comment_id": 44096609, "body": "You&#39;re not getting the point. Your question is not clear. And you probably need to provide more information. What is the value of <code>ac-modes</code>, for instance? If library autocomplete is loaded then <code>ac-modes</code> should have an entry for <code>haskell-interactive-mode</code>. And find out what code should have defined <code>haskell-interactive-mode</code> (apparently that code was not invoked or did not do its job)."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420743170, "post_id": 27830456, "comment_id": 44098616, "body": "@Drew there, re-written"}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1420750082, "post_id": 27830456, "comment_id": 44102336, "body": "Thanks. Hopefully someone will now be able to help more. Is it correct that you have both <code>interactive-haskell-mode</code> and <code>haskell-interactive-mode</code>?"}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "reply_to_user": {"reputation": 6075, "user_id": 147442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5cb67e96d4c724cfac0ff043b11c87e?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger Hanke", "link": "https://stackoverflow.com/users/147442/r%c3%bcdiger-hanke"}, "edited": false, "score": 0, "creation_date": 1420907943, "post_id": 27830456, "comment_id": 44158586, "body": "@R&#252;digerHanke How would I go by upgrading ghc? my package manager doesn&#39;t have any newer version"}], "owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1420743156, "creation_date": 1420672856, "last_edit_date": 1420743156, "question_id": 27830456, "link": "https://stackoverflow.com/questions/27830456/autocomplete-not-working-correctly-after-updating-cabal", "title": "Autocomplete not working correctly after updating Cabal", "body": "<p>I recently updated Cabal to version 1.22, before installing <code>ghc-mod</code> so I could get some much needed error-checking in my projects. </p>\n\n<p>The update didn't come without complications, <code>ghc-mod</code> wouldn't even run before I had added the path of the latest version of Cabal to <code>$PATH</code>. Upon doing so, <code>haskell-mode</code> started acting up, as loading the interpreter no longer greeted me with the familiar phrase \"Your command is my IO\", but instead appeared to be the standard <code>GHCI</code>. Not only that, but it didn't ask if I wanted to start a new project named haskell like it usually did prior to the change; and with that, all the glorious autocompletion was gone.</p>\n\n<p>After a bit of fiddling around I learned that Emacs had trouble loading <code>haskell-interactive-mode</code>, being told it had something to do with <code>haskell-mode</code> itself, I installed it anew, and added </p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(require 'haskell-mode)\n(add-hook 'haskell-mode-hook 'interactive-haskell-mode)\n(eval-after-load \"auto-complete\"\n  '(add-to-list 'ac-modes 'haskell-interactive-mode))\n</code></pre>\n\n<p>to my <code>.emacs</code> file, and suddenly the error was gone, however the problem persists, and now whenever I try loading the interpreter, Emacs will ask me to provide a path to Cabal, then the current working directoryl; after which I'll be greeted by the repl that used to enable the autocompletion.</p>\n\n<p>Except... it still doesn't autocomplete. Or rather, it autocompletes whatever's in the document, but it doesn't reveal functions as I type, it doesn't show me sub-modules like it used to, it doesn't do anything at all, except auto-generate type signatures when I press <code>C-u C-c C-t</code>.</p>\n\n<p>I really have no idea how to go by from here, and would really appreciate some help.</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 0, "creation_date": 1420694692, "post_id": 27830602, "comment_id": 44072452, "body": "Scheme is generally considered a functional language, and its variables can change."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1420707760, "post_id": 27830602, "comment_id": 44077063, "body": "The imperative closure example is a bit subtle. In some languages (e.g. C++) the closure on <code>x</code> could happen by value (the value of <code>x</code> is copied) or by reference (as in your example). In the first case changing <code>x</code> does not affect <code>foo</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1420718561, "post_id": 27830602, "comment_id": 44083046, "body": "I usually think of the difference as &quot;assigning a value to a variable&quot; (variable named &#39;x&#39;, thy value shall now be 7) versus &quot;assigning a name to a value&quot; (7, thou shalt henceforth also be known as &#39;x&#39;)."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 1, "creation_date": 1420746351, "post_id": 27830602, "comment_id": 44100338, "body": "@newacct: That&#39;s more a matter of the fact that &quot;functional&quot; is an ill-defined term more than anything. Scheme with <code>set!</code> isn&#39;t fundamentally any more functional than JavaScript, except it has some features to <i>encourage</i> programming in a functional style."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 13, "last_activity_date": 1420673577, "creation_date": 1420673577, "answer_id": 27830602, "question_id": 27830405, "link": "https://stackoverflow.com/questions/27830405/binding-a-name-to-a-value-vs-assigning-a-value-to-a-variable/27830602#27830602", "title": "Binding a name to a value vs. assigning a value to a variable", "body": "<p>In some sense, the only real difference is that variables in imperative languages can change whereas bound names in functional languages can't. But I think it's important to understand the higher-level semantic distinction between the two and how we <em>think</em> about them differently.</p>\n\n<p>In imperative languages, a variable is a thing on its own which happens to include a value. They're often compared to boxes that contain something. The contents of a box can change and, semantically, the box has an identity of its own.</p>\n\n<p>Haskell names, on the other hand, are just labels for a value. You can use one or the other completely interchangeably. Crucially, <em>they can't change</em>.</p>\n\n<p>Compare binding in Haskell to function names in languages like Java\u00b9. These can't change either, and you don't think of them on their own; they're just names for the method they're attached to.</p>\n\n<p>Here's a contrived example of the difference: imagine a function <code>f</code> that closes over an imperative variable <code>x</code>:</p>\n\n<pre><code>var x = 7;\nfunction foo() {\n  console.log(x);\n}\n</code></pre>\n\n<p>Effectively, <code>x</code> is just a name for <code>7</code>... until <code>x</code> changes. What you've closed over is the <em>variable</em> <code>x</code>, not its value <code>7</code>, so if it changes so will the behavior of <code>foo</code>.</p>\n\n<p>In Haskell, on the other hand, if you bind <code>7</code> to the name <code>x</code> and close over it, that's the same as just closing over <code>7</code>. </p>\n\n<pre><code>let x = 7 in \\ () -&gt; x\n</code></pre>\n\n<p>does the same thing as</p>\n\n<pre><code>\\ () -&gt; 7\n</code></pre>\n\n<p>(which, itself, doesn't do anything more than just <code>7</code> by itself, ignoring strictness issues).</p>\n\n<p>\u00b9 ignoring reflection and similar shenanigans</p>\n"}], "owner": {"reputation": 441, "user_id": 573190, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/583d724f95975ff111de43d2dabd8cf0?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/573190/brendan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 27830602, "answer_count": 1, "score": 6, "last_activity_date": 1420673577, "creation_date": 1420672524, "question_id": 27830405, "link": "https://stackoverflow.com/questions/27830405/binding-a-name-to-a-value-vs-assigning-a-value-to-a-variable", "title": "Binding a name to a value vs. assigning a value to a variable", "body": "<p>Reading through Bartosz Milewski's piece at <a href=\"https://www.fpcomplete.com/school/starting-with-haskell/basics-of-haskell/3-pure-functions-laziness-io\">fpcomplete</a> where he writes, <code>\"In Haskell you never assign to a variable, instead you bind a name to a value.\"</code></p>\n\n<p>Could someone explain to me what this means, as well as the practical ramifications of this in the functional programming world?</p>\n"}, {"tags": ["haskell", "show", "maybe", "either", "deriving"], "answers": [{"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 10, "last_activity_date": 1420669326, "creation_date": 1420669326, "answer_id": 27829710, "question_id": 27829536, "link": "https://stackoverflow.com/questions/27829536/why-does-either-derives-show-but-maybe-does-not/27829710#27829710", "title": "Why does Either derives Show but Maybe does not?", "body": "<p>The instance for <code>Maybe</code> is defined explicitly in <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/src/GHC-Show.html\"><code>GHC.Show</code></a>, along with instances for a whole bunch of other common types like tuples. You can find out where an instance was defined using the <code>:i</code> command in <code>ghci</code>:</p>\n\n<pre><code>Prelude&gt; :i Maybe\ndata Maybe a = Nothing | Just a     -- Defined in \u2018Data.Maybe\u2019\ninstance Eq a =&gt; Eq (Maybe a) -- Defined in \u2018Data.Maybe\u2019\ninstance Monad Maybe -- Defined in \u2018Data.Maybe\u2019\ninstance Functor Maybe -- Defined in \u2018Data.Maybe\u2019\ninstance Ord a =&gt; Ord (Maybe a) -- Defined in \u2018Data.Maybe\u2019\ninstance Read a =&gt; Read (Maybe a) -- Defined in \u2018GHC.Read\u2019\ninstance Show a =&gt; Show (Maybe a) -- Defined in \u2018GHC.Show\u2019\n</code></pre>\n\n<p>I don't know why they defined the instance explicitly or put it in <code>GHC.Show</code> instead of <code>Data.Maybe</code>\u2014as far as I can tell, it could be moved to <code>Data.Maybe</code> and/or derived. My guess is that they did not want <code>Data.Maybe</code> to depend on anything except <code>GHC.Base</code> (as it does now), presumably because it's used in some of the other core modules.</p>\n"}, {"tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 4, "last_activity_date": 1420671266, "creation_date": 1420671266, "answer_id": 27830136, "question_id": 27829536, "link": "https://stackoverflow.com/questions/27829536/why-does-either-derives-show-but-maybe-does-not/27830136#27830136", "title": "Why does Either derives Show but Maybe does not?", "body": "<p>AFAIK tuples aren't defined anywhere, so to avoid orphan instances[1] the Show instances for tuples have to be defined in GHC.Show[2].  The implementation of those instances happens to use <code>foldr1</code>:</p>\n\n<pre><code>show_tuple :: [ShowS] -&gt; ShowS\nshow_tuple ss = showChar '('\n              . foldr1 (\\s r -&gt; s . showChar ',' . r) ss\n              . showChar ')'\n</code></pre>\n\n<p>so GHC.Show imports GHC.List where that function is defined.  GHC.List, in turn, defines <code>lookup</code>, which is in the <code>Maybe</code> monad (good old Haskell 98's monomorphism bias I guess).  So GHC.List imports Data.Maybe.  In order to define a <code>Show</code> instance, Data.Maybe would need to import GHC.Show (directly or indirectly), which would make the whole sequence GHC.Show -> GHC.List -> Data.Maybe -> GHC.Show a circular dependency.  GHC doesn't support circular dependencies very well (not that they're easy to support!), so base works really hard to avoid them.</p>\n\n<p>[1] An orphan instance is one defined in a different module than both the class and the type involved in the instance.  Formally, Haskell requires instance search to be done in any module directly or indirectly imported by the module being compiled; but for non-orphan instances GHC can short-circuit that and just look in two places.  For orphan instances, it has to track every orphan instance in a module and then track that those instances are re-exposed by every module that imports them, which is more expensive (and means it has to keep a context environment with potentially many instances that aren't even relevant to the current module, because it doesn't actually import those classes or types).  So good practice is to avoid orphan instances for that reason.</p>\n\n<p>Somewhat more philosophically, orphan instances are a really good way to get two conflicting instances of the same class / type in your program, which since they are both 'visible' in your <code>Main</code> module means they will conflict.  So the language feature itself is kind of dodgy.</p>\n\n<p>[2] IIRC GHC only provides <code>Show</code> instances up to a (relatively small) fixed number of tuple components, which isn't <em>quite</em> Haskell 98 compliant but is good enough for any practical programming need.  (Seriously, don't use tuples with more than 3 elements anyway, you <em>will</em> forget what specific components mean).  I don't know if the standard has been updated to bring GHC into compliance in the last few years or not.</p>\n"}], "owner": {"reputation": 940, "user_id": 1275256, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5cd12beabbb9d483c03d843cc504e5c0?s=128&d=identicon&r=PG", "display_name": "gxtaillon", "link": "https://stackoverflow.com/users/1275256/gxtaillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 27829710, "answer_count": 2, "score": 6, "last_activity_date": 1420671266, "creation_date": 1420668634, "question_id": 27829536, "link": "https://stackoverflow.com/questions/27829536/why-does-either-derives-show-but-maybe-does-not", "title": "Why does Either derives Show but Maybe does not?", "body": "<p>\nDocumentation of both <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Either.html\"><code>Either</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Maybe.html\"><code>Maybe</code></a> indicate that they have instances of <code>Show</code>.</p>\n\n<p><code>Either</code> is defined as deriving <code>Show</code>, simply :</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data  Either a b  =  Left a | Right b\n  deriving (Eq, Ord, Read, Show, Typeable)\n</code></pre>\n\n<p>Yet, <code>Maybe</code> does not :</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data  Maybe a  =  Nothing | Just a\n  deriving (Eq, Ord)\n</code></pre>\n\n<p>Since they are part of <code>base</code> and are so similar why doesn't <code>Maybe</code> directly derive <code>Show</code>?</p>\n\n<p>Another question might also be, where does it get its <code>Show</code> instance?</p>\n"}, {"tags": ["parsing", "haskell", "ghc"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1420660921, "post_id": 27827483, "comment_id": 44061168, "body": "There are lots of issues with this code.  Type signatures need to be followed by the definition, so <code>n :: Int</code> followed by a signature for <code>x</code> is invalid.  Second, your declaring an <code>instance Data</code> but <code>Data</code> is not a type class in this scope.  Third, top level declarations can not be expressions, meaning <code>let</code> is not a valid top level construct.  Perhaps you should try reading <code>LYAH</code> and asking one question at a time and building up."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1420661108, "post_id": 27827483, "comment_id": 44061246, "body": "@ThomasM.DuBuisson <code>n::Int</code> followed by <code>x::Int</code> is perfectly valid - the definitions have to be in the same file, there&#39;s no requirement of them being directly adjacent to the signatures though."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1420661579, "post_id": 27827483, "comment_id": 44061510, "body": "<code>let variable = value</code> is only for GHCi and <code>do</code>-blocks. You&#39;ll want to simply write <code>variable = value</code>. To find out more about everything to do with Haskell, I&#39;d reccomend visiting <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learnyouahaskell.com/chapters</a>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1420661682, "post_id": 27827483, "comment_id": 44061562, "body": "@Cubic Indeed, what was I thinking."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420668252, "post_id": 27827483, "comment_id": 44064881, "body": "@AJFarmar, it&#39;s also for local definitions, of course."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420720807, "post_id": 27827483, "comment_id": 44084204, "body": "@dfeuer Indeed, but that&#39;s only if followed by an <code>in</code>, which isn&#39;t included here."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3123801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b660a849be9871b965dc95812298b668?s=128&d=identicon&r=PG", "display_name": "dgomez1092", "link": "https://stackoverflow.com/users/3123801/dgomez1092"}, "edited": false, "score": 0, "creation_date": 1421381286, "post_id": 27827704, "comment_id": 44346605, "body": "bheklir, nothing but respect for you. You are the type of haskeller I aspire to be even though I suck. I have taken a look and read Learn You a Haskell. Thank you for pointing me in the right direction with the syntactically correct definition of &#39;let&#39;. I still have a lot to catch up on and I don&#39;t know why I am not &quot;getting it&quot;. I&#39;m sad this can&#39;t be my full-time focus bc I&#39;m job hunting. Thanks again."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 57, "user_id": 3123801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b660a849be9871b965dc95812298b668?s=128&d=identicon&r=PG", "display_name": "dgomez1092", "link": "https://stackoverflow.com/users/3123801/dgomez1092"}, "edited": false, "score": 0, "creation_date": 1421384386, "post_id": 27827704, "comment_id": 44347323, "body": "@dgomez1092 I first saw Haskell about 6 years ago.  I poked at the language for a while, but put it down for most of college.  I came back to it when I had a slow period at an internship.  After hammering on it a lot for a few months, I finally thought I had &quot;gotten it&quot;.  A couple years later now and I&#39;m still not sure I&#39;m done getting it.  Haskell is a weird and difficult language for many people, but it&#39;s worth it to stick through it!  It&#39;s not that you suck, it&#39;s just that you need more practice.  Just keep asking questions, keep practising, and the pieces will start falling in place."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1420660973, "creation_date": 1420660973, "answer_id": 27827704, "question_id": 27827483, "link": "https://stackoverflow.com/questions/27827483/parse-error-incorrect-indentation-or-misplaced-bracket/27827704#27827704", "title": "Parse Error: (incorrect indentation or misplaced bracket)", "body": "<p>I'm not sure what the <code>instance Data stutter n x</code> is supposed to be, the <code>instance XYZ where</code> syntax is used solely for typeclasses, but you have a couple syntax errors here.</p>\n\n<p>First of all, while GHC says that the error is on <code>let stutter 6 \"Iwannabehere\"</code>, your first error occurs before that with <code>stutter &gt;&gt;= main = concat [x:xs]</code>.  A single <code>=</code> sign is reserved for assignments, which are merely definitions.  You can have assignments at the top level, inside a <code>where</code> block, or inside a <code>let</code> block (the <code>where</code> includes typeclass instance definitions).  You can't have an assignment be part of an expression like <code>x &gt;&gt;= y = z</code>.</p>\n\n<p>Your next syntax error is the <code>let</code> itself.  <code>let</code> blocks can not appear at the top level, they only appear within another definition.  You use <code>let</code> in GHCi but the reasons for that are outside the scope of this answer.  Suffice to say that entering expression in GHCi is not equivalent to the top level of a source file.</p>\n\n<p>Next, if you were to use a <code>let</code> block somewhere, it can only contain definitions.  The syntax looks more like</p>\n\n<pre><code>let &lt;name&gt; [&lt;args&gt;] = &lt;definition&gt;\n    [&lt;name&gt; [&lt;args&gt;] = &lt;definition&gt;]\nin &lt;expression&gt;\n</code></pre>\n\n<p>And this whole block makes an expression.  For example, you could write</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def f(x, y, z):\n    w = x + y + z\n    u = x - y - z\n    return w * u\n</code></pre>\n\n<p>in Python, and this would be equivalent to the Haskell function definition</p>\n\n<pre><code>f x y z = let w = x + y + z\n              u = x - y - z\n          in w * u\n</code></pre>\n\n<p>It only defines local variables.  There is another form when you're using it inside <code>do</code> blocks where you can exclude the <code>in &lt;expression&gt;</code> part, such as</p>\n\n<pre><code>main = do\n    name &lt;- getLine\n    let message = if length name &gt; 5 then \"short name\" else \"long name\"\n        goodbye n = putStrLn (\"Goodbye, \" ++ n)\n    putStrLn message\n    goodbye name\n</code></pre>\n\n<p>Note that there is no need to use <code>in</code> here.  You can if you want, it just means you have to start a new <code>do</code> block:</p>\n\n<pre><code>main = do\n    name &lt;- getLine\n    let message = ...\n        goodbye n = ...\n    in do\n        putStrLn message\n        goodbye name\n</code></pre>\n\n<p>And this isn't as pretty.</p>\n\n<p>Hopefully this points you more towards correct syntax, but it looks like you have some misunderstandings about how Haskell works.  Have you looked at Learn You a Haskell?  It's a pretty gentle and fun introduction to the language that can really help you learn the syntax and core ideas.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1420662808, "last_edit_date": 1420662808, "creation_date": 1420662484, "answer_id": 27828067, "question_id": 27827483, "link": "https://stackoverflow.com/questions/27827483/parse-error-incorrect-indentation-or-misplaced-bracket/27828067#27828067", "title": "Parse Error: (incorrect indentation or misplaced bracket)", "body": "<p>Your parse error is from the <code>let</code> keyword. Remove it and no error related to that will occur. <code>let x = y</code> is only relevant in GHCi and <code>do</code>-blocks, neither of which is relevant at this point. Essentially, just replace it with this line:</p>\n\n<pre><code>theWordIGet = stutter 6 \"Iwannabehere\"\n</code></pre>\n\n<p>Secondly, <code>instance</code> keyword in Haskell has <em>absolutley nothing</em> to do with what you want to do at this stage. This is not how Haskell functions are defined, which is what I'm guessing you want to do. This is what you're wanting to do to create a <code>stutter</code> function, assuming it simply repeats a string <code>n</code> times.</p>\n\n<pre><code>stutter :: Int -&gt; String -&gt; String\nstutter n x = concat (replicate n x)\n</code></pre>\n\n<p>You'll also want to remove the type declarations for the (out-of-scope) values <code>n</code> and <code>x</code>: they're not objects, they're arguments for a function, which has its own signature determining the types of <code>n</code> and <code>x</code> within a function call.</p>\n\n<p>Lastly, I imagine you will want to print the value of <code>stutter 6 \"Iwannabehere\"</code> when the program is executed. To do that, just add this:</p>\n\n<pre><code>main :: IO ()\nmain = print (stutter 6 \"Iwannabehere\")\n</code></pre>\n\n<p>In conclusion, I <em>implore</em> you to start from scratch and read 'Learn You a Haskell' online <a href=\"http://learnyouahaskell.com\" rel=\"nofollow\">here</a>, because you're going off in entirely the wrong direction - the program you've quoted is a jumble of expressions that <em>could</em> have a meaning, but are in the wrong place entirely. The book will show you the syntax of Haskell much better that I can write about in this one answer, and will explain fully how to make your program behave in the way you expect.</p>\n"}], "owner": {"reputation": 57, "user_id": 3123801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b660a849be9871b965dc95812298b668?s=128&d=identicon&r=PG", "display_name": "dgomez1092", "link": "https://stackoverflow.com/users/3123801/dgomez1092"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1420662808, "creation_date": 1420660204, "question_id": 27827483, "link": "https://stackoverflow.com/questions/27827483/parse-error-incorrect-indentation-or-misplaced-bracket", "title": "Parse Error: (incorrect indentation or misplaced bracket)", "body": "<p>I'm starting out to learn Haskell. Even though I'm a dunce extraordinaire, I am intent on making this work. The error I received is listed as the title. This is the code that I wrote to try to implement the behavior of replicating a list (n) times and concatenating its new length as a new list. Now I have a basic understanding of how parsing works in Haskell, below my original code I will give example of some modified code to see if my understanding on parsing is adequate. My question for now is how I can properly indent or structure my block in order to not receive this error (is that specific enough :O) -- is there a piece of information I'm missing when it comes to creating instances and formatting? PLEASE DO NOT TELL ME OR OFFER SUGGESTIONS IF YOU NOTICE THAT MY CURRENT INSTANCE OR MAIN FUNCTION ARE SYNTACTICALLY WRONG. I want to figure it out and will deal with that GHC error when I get to it. (I hope that's the proper way to learn). BUT if I could ask for anyone's help in getting past this first obstacle in understanding proper formatting, I'd be grateful. </p>\n\n<pre><code>module Main where \nimport Data.List\n\nn :: Int \nx :: [Char]\n\ninstance Data stutter n x where\n   x = []\n   n = replicate &gt;&gt;=  x : (n:xs)\n   stutter &gt;&gt;= main = concat [x:xs]\n\nlet stutter 6 \"Iwannabehere\"  -- &lt;-- parse error occurs here!!!\n</code></pre>\n\n<p>--Modified code with appropriate brackets, at least where I think they go.</p>\n\n<pre><code>module Main where \nimport Data.List\n\nn :: Int \nx :: [Char]\n\ninstance Data stutter n x where{\n   ;x = []\n   ;n = replicate &gt;&gt;=  x : (n:xs)\n   ;stutter &gt;&gt;= main = concat [x:xs]\n;\n};let stutter 6 \"Iwannabehere\" -- there should be no bracket of any kind at the end of this\n</code></pre>\n\n<p>I placed the 'let' expression on the outside of the block, I don't believe it goes inside and I also receive a parsing error if I do that. Not correct but I thought I'd ask anyway. </p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 3, "creation_date": 1420657865, "post_id": 27826773, "comment_id": 44059464, "body": "It&#39;s all determined by your PATH."}, {"owner": {"reputation": 6548, "user_id": 3649209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4d5cb34bdd07db87fee16a103abbb42?s=128&d=identicon&r=PG&f=1", "display_name": "James Lawson", "link": "https://stackoverflow.com/users/3649209/james-lawson"}, "edited": false, "score": 0, "creation_date": 1425660637, "post_id": 27826773, "comment_id": 46066571, "body": "Have a look at these answers: <a href=\"http://stackoverflow.com/a/21200691/3649209\">stackoverflow.com/a/21200691/3649209</a>, <a href=\"http://stackoverflow.com/a/19736802/3649209\">stackoverflow.com/a/19736802/3649209</a>."}], "tags": [], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "is_accepted": false, "score": 5, "last_activity_date": 1420657537, "creation_date": 1420657537, "answer_id": 27826773, "question_id": 27826656, "link": "https://stackoverflow.com/questions/27826656/cabal-install-cabal-install-doesnt-update-cabal-version-in-osx/27826773#27826773", "title": "&quot;cabal install cabal-install&quot; doesn&#39;t update cabal version in OSX", "body": "<p>I see that there's an updated cabal at <code>~/Library/Haskell/bin</code>, so I could replace /usr/bin/cabal with a symbolic link to this copy or I could copy this binary to <code>/usr/bin</code>. </p>\n\n<p>I'm still interested if there is a more elegant/canonical way to make sure the new cabal is what gets used by default.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 14, "last_activity_date": 1420663614, "creation_date": 1420663614, "answer_id": 27828356, "question_id": 27826656, "link": "https://stackoverflow.com/questions/27826656/cabal-install-cabal-install-doesnt-update-cabal-version-in-osx/27828356#27828356", "title": "&quot;cabal install cabal-install&quot; doesn&#39;t update cabal version in OSX", "body": "<p>There are two ways of making <code>cabal</code> install packages globally. Note that, as a result, <code>cabal</code> may require sudo.</p>\n\n<p>This command will install <code>&lt;PACKAGE&gt;</code> globally:</p>\n\n<pre><code>$ cabal install &lt;PACKAGE&gt; --global\n</code></pre>\n\n<p>As a more general solution, edit the file <code>~/.cabal/config</code> and set <code>user-install</code> to <code>False</code>. This will automatically set the <code>--global</code> flag so you can just write <code>cabal install &lt;PACKAGE&gt;</code> without any worry. Here's a snippet of my <code>config</code> file:</p>\n\n<pre><code>...\n-- split-objs: False\n-- executable-stripping: True\nuser-install: False\n-- package-db:\n-- flags:\n...\n</code></pre>\n\n<p>You may also want to set <code>root-cmd</code> to <code>sudo</code> if it's not already, so that <code>cabal</code> will automatically prompt for the root password when it encounters a permission problem.</p>\n\n<p>There's some more info online <a href=\"https://www.haskell.org/haskellwiki/Cabal-Install#The_cabal-install_configuration_file\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 262, "user_id": 598625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeKvE.jpg?s=128&g=1", "display_name": "BMDan", "link": "https://stackoverflow.com/users/598625/bmdan"}, "edited": false, "score": 0, "creation_date": 1560100495, "post_id": 33380943, "comment_id": 99618915, "body": "Small nit: <code>hash -r</code> <i>clears</i> the hash table.  It is then rebuilt on a per-command basis each subsequent time an unqualified path is invoked as a command."}], "tags": [], "owner": {"reputation": 160, "user_id": 1644961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573044a35f30584b0942b5bccd3f9462?s=128&d=identicon&r=PG", "display_name": "eigensheep", "link": "https://stackoverflow.com/users/1644961/eigensheep"}, "is_accepted": false, "score": 2, "last_activity_date": 1445992487, "creation_date": 1445992487, "answer_id": 33380943, "question_id": 27826656, "link": "https://stackoverflow.com/questions/27826656/cabal-install-cabal-install-doesnt-update-cabal-version-in-osx/33380943#33380943", "title": "&quot;cabal install cabal-install&quot; doesn&#39;t update cabal version in OSX", "body": "<p>TLDR: Try running <code>hash -r</code></p>\n\n<p>Bash has a PATH hashtable that maps commands to the location of binaries. You may still have an old version of cabal installed somewhere in your PATH (possibly in a sandbox). Since cabal is not a new command, the hashtable will keep serving up the old version. <code>hash -r</code> rebuilds the hashtable, so the shell will correctly find the new version (providing it appears earlier in your path than the old one). </p>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4017, "favorite_count": 3, "accepted_answer_id": 27828356, "answer_count": 3, "score": 11, "last_activity_date": 1445992487, "creation_date": 1420657110, "question_id": 27826656, "link": "https://stackoverflow.com/questions/27826656/cabal-install-cabal-install-doesnt-update-cabal-version-in-osx", "title": "&quot;cabal install cabal-install&quot; doesn&#39;t update cabal version in OSX", "body": "<p>I'm a newbie to haskell and cabal, so I'm probably missing something simple.</p>\n\n<p>I updated cabal-install:</p>\n\n<pre><code>sudo cabal install cabal-install\nPassword:\nResolving dependencies...\nConfiguring cabal-install-1.22.0.0...\nBuilding cabal-install-1.22.0.0...\nInstalled cabal-install-1.22.0.0\nUpdating documentation index\n</code></pre>\n\n<p>However <code>cabal --version</code> says:</p>\n\n<pre><code>cabal-install version 1.18.0.5\nusing version 1.18.1.4 of the Cabal library \n</code></pre>\n\n<p>What happened to cabal-install 1.22.0.0?</p>\n"}, {"tags": ["haskell", "dependencies", "dependency-management", "cabal"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420658361, "post_id": 27826100, "comment_id": 44059718, "body": "Welcome to cabal hell.  The reason why it wants to reinstall <code>process</code> is because one of <i>its</i> dependencies has a new version, and so the binaries are compatible.  Have you tried using cabal sandboxes?  These were introduced a couple versions ago to provide project-specific environments.  You can still end up with cabal hell, it&#39;s just more difficult."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1420659693, "post_id": 27826100, "comment_id": 44060477, "body": "Cabal hell indeed. Short of reinstalling everything, you can try to fix things - this case seems to be straightforward. First, unregister <code>process-1.2.1.0</code>. If it breaks things, unregister them, and reinstall them, <i>but with the constraint</i> <code>--constraint=&quot;process==1.2.1.0&quot;</code>. This will ensure that you don&#39;t duplicate <code>process</code>. If cabal finds no way to build one of your packages w/o updating process, you use a sandbox or install ghc and the package versions you need (not HP)."}], "owner": {"reputation": 103, "user_id": 4429970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b8c5e6dba911ce00c539e51764b833?s=128&d=identicon&r=PG&f=1", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/4429970/alex-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420655121, "creation_date": 1420655121, "question_id": 27826100, "link": "https://stackoverflow.com/questions/27826100/cabal-unwanted-reinstallations", "title": "Cabal: unwanted reinstallations", "body": "<p>I always have the same problem with Cabal for various packages.\n(Now I installed ghc and cabal separately, but the same problem was and when I installed Haskell Platform.) For example:</p>\n\n<pre><code>&gt; cabal install extra\nResolving dependencies...\nIn order, the following would be installed:\ndirectory-1.2.1.0 (reinstall) changes: time-1.4.2 -&gt; 1.5\nprocess-1.2.1.0 (reinstall)\nextra-1.0 (new package)\ncabal: The following packages are likely to be broken by the reinstalls:\nprocess-1.2.0.0\nhoogle-4.2.35\nhaskell98-2.0.0.3\nghc-7.8.3\nCabal-1.22.0.0\n    ....... and more ...\n</code></pre>\n\n<p>But! I have already installed packages directory-1.2.1.0, process-1.2.1.0\nWhy cabal wants to reinstall if the plurality of packets to be broken?</p>\n\n<pre><code>    &gt; ghc-pkg list process\n    d:/prog/ghc-7.8.3\\lib\\package.conf.d:\n        process-1.2.0.0\n\n    C:\\Users\\User\\AppData\\Roaming\\ghc\\i386-mingw32-7.8.3\\package.conf.d:\n        process-1.2.1.0\n\n    &gt; ghc-pkg list directory\n    d:/prog/ghc-7.8.3\\lib\\package.conf.d:\n        directory-1.2.1.0\n\nC:\\Users\\User\\AppData\\Roaming\\ghc\\i386-mingw32-7.8.3\\package.conf.d:\n    (no packages)\n</code></pre>\n\n<p>I can not remove the process-1.2.0.0. On it depends set of packages (installed with ghc-7.8.3).\nAnd other versions of directory-1.2.1.0 does not exist at all.</p>\n\n<p>Do everytime install all over again, starting with the Haskell Platform?</p>\n\n<p>Please excuse me for my bad English. This is not my native language.</p>\n"}, {"tags": ["haskell", "sequence", "applicative"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1420650697, "post_id": 27824658, "comment_id": 44055350, "body": "What version of <code>base</code> are you using?  I&#39;m on GHC 7.8.3 and base-4.7.0.1 and I have an applicative instance for <code>Seq</code>."}, {"owner": {"reputation": 1, "user_id": 4429695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1e4ff4a80d52cea599359294f816a1?s=128&d=identicon&r=PG&f=1", "display_name": "confunderated", "link": "https://stackoverflow.com/users/4429695/confunderated"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420653587, "post_id": 27824658, "comment_id": 44057055, "body": "Yeah, I&#39;m not on my normal machine and its 7.6.3/4.6.0.1, but I was reading the docs online for latest, which is what confused me. I do, as predicted, feel stupid. Thanks."}], "owner": {"reputation": 1, "user_id": 4429695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1e4ff4a80d52cea599359294f816a1?s=128&d=identicon&r=PG&f=1", "display_name": "confunderated", "link": "https://stackoverflow.com/users/4429695/confunderated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420654076, "creation_date": 1420650219, "last_edit_date": 1420653352, "question_id": 27824658, "link": "https://stackoverflow.com/questions/27824658/haskell-data-sequence-no-instance-for-applicative-seq", "title": "Haskell Data.Sequence - No instance for (Applicative Seq)", "body": "<p>Edit: Sorry, just stupidity on my part. I 'm using the 7.6.3 Platform, but reading online docs for 'latest', and I just did this:</p>\n\n<pre><code>&gt;:i Seq\nnewtype Seq a\n  = Data.Sequence.Seq (Data.Sequence.FingerTree\n                         (Data.Sequence.Elem a))\n    -- Defined in `Data.Sequence'\ninstance Eq a =&gt; Eq (Seq a) -- Defined in `Data.Sequence'\ninstance Monad Seq -- Defined in `Data.Sequence'\ninstance Functor Seq -- Defined in `Data.Sequence'\ninstance Ord a =&gt; Ord (Seq a) -- Defined in `Data.Sequence'\ninstance Read a =&gt; Read (Seq a) -- Defined in `Data.Sequence'\ninstance Show a =&gt; Show (Seq a) -- Defined in `Data.Sequence'\n</code></pre>\n\n<p>and look, no applicative instance. Sorry for the bother, and thanks to bheklilr for asking me about versioning, which I just spaced on.</p>\n\n<p>The following confuses me. There certainly seems to be an instance defining (&lt;*>) sensibly for Seq:</p>\n\n<pre><code>instance Applicative Seq where\npure = singleton\nfs &lt;*&gt; xs = foldl' add empty fs\n  where add ys f = ys &gt;&lt; fmap f xs\n</code></pre>\n\n<p>Yet, this happens:</p>\n\n<pre><code>&gt;:m + Data.Sequence  Control.Applicative \n&gt;(*) &lt;$&gt; [1..4] &lt;*&gt; [3..4]\n[3,4,6,8,9,12,12,16]\n&gt;(*) &lt;$&gt; fromList [1..4] &lt;*&gt; fromList [3..4]\n\n&lt;interactive&gt;:58:25:\n    No instance for (Applicative Seq) arising from a use of `&lt;*&gt;'\n    Possible fix: add an instance declaration for (Applicative Seq)\n    In the expression: (*) &lt;$&gt; fromList [1 .. 4] &lt;*&gt; fromList [3 .. 4]\n    In an equation for `it':\n        it = (*) &lt;$&gt; fromList [1 .. 4] &lt;*&gt; fromList [3 .. 4]\n&gt;:t (*) &lt;$&gt; fromList [1..4] \n(*) &lt;$&gt; fromList [1..4] :: (Enum a, Num a) =&gt; Seq (a -&gt; a)\n</code></pre>\n\n<p>Using a singleton produces slightly different typing (no Enum qualification) and hence a slightly different error.</p>\n\n<pre><code>&gt;:t (*) &lt;$&gt; singleton 3\n(*) &lt;$&gt; singleton 3 :: Num a =&gt; Seq (a -&gt; a)\n&gt;:t (*) &lt;$&gt; singleton 3 &lt;*&gt; fromList [3 .. 4]\n\n&lt;interactive&gt;:1:21:\n    Could not deduce (Applicative Seq) arising from a use of `&lt;*&gt;'\n    from the context (Enum b, Num b)\n      bound by the inferred type of it :: (Enum b, Num b) =&gt; Seq b\n      at Top level\n    Possible fix: add an instance declaration for (Applicative Seq)\n    In the expression: (*) &lt;$&gt; singleton 3 &lt;*&gt; fromList [3 .. 4]\n</code></pre>\n\n<p>The type <code>Seq (a -&gt; a)</code> would seem to me to conform to the <code>f (a -&gt; b)</code> required by <code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code>.</p>\n\n<p>I'm sure this is simple and I'll be embarrassed for asking, but thanks in advance.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "edited": false, "score": 1, "creation_date": 1421201796, "post_id": 27825564, "comment_id": 44267061, "body": "In step #2 it looks like a simple &quot;cabal clean&quot; might be sufficient.  That way you don&#39;t have to build all your local dependencies (which may have their own sandboxes)."}, {"owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "edited": false, "score": 0, "creation_date": 1421203145, "post_id": 27825564, "comment_id": 44267395, "body": "I just discovered another case where &quot;cabal clean&quot; was not sufficient, and it seemed that &quot;cabal install&quot; was required, so YMMV."}], "tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": true, "score": 3, "last_activity_date": 1420653157, "creation_date": 1420653157, "answer_id": 27825564, "question_id": 27824509, "link": "https://stackoverflow.com/questions/27824509/ghc-pkg-cannot-create-dist-dist-sandbox-xxxxxxxx-package-conf-inplace-already/27825564#27825564", "title": "ghc-pkg: cannot create: dist/dist-sandbox-XXXXXXXX/package.conf.inplace already exists", "body": "<p>This is a <a href=\"https://github.com/haskell/cabal/issues/2301\" rel=\"nofollow\">known issue</a><a href=\"https://github.com/haskell/cabal/issues/2301\" rel=\"nofollow\">https://github.com/haskell/cabal/issues/2301</a>. The workaround is:</p>\n\n<ol>\n<li>Go to the directory containing the local package (/home/amy/n\u00e9al/cr\u00e9at\u00far-wains, in my case).</li>\n<li>Build the local package (<code>cabal install</code>).</li>\n<li>Return to the original directory. <code>cabal install</code> will now work.</li>\n</ol>\n"}], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 27825564, "answer_count": 1, "score": 4, "last_activity_date": 1420653157, "creation_date": 1420649768, "last_edit_date": 1420650428, "question_id": 27824509, "link": "https://stackoverflow.com/questions/27824509/ghc-pkg-cannot-create-dist-dist-sandbox-xxxxxxxx-package-conf-inplace-already", "title": "ghc-pkg: cannot create: dist/dist-sandbox-XXXXXXXX/package.conf.inplace already exists", "body": "<p>I've just upgraded to cabal 1.22.0.0. I created a <em>brand new</em> sandbox, and added a link to another local package like so:</p>\n\n<pre><code>cabal sandbox add-source /home/amy/n\u00e9al/cr\u00e9at\u00far-wains\n</code></pre>\n\n<p>Then I tried to install the dependencies:</p>\n\n<pre><code>cabal install --dep\n</code></pre>\n\n<p>But when it got to the part where it tried to build my local package, I got an error:</p>\n\n<pre><code>Configuring creatur-wains-4.1.1...\nBuilding creatur-wains-4.1.1...\nghc-pkg: cannot create: dist/dist-sandbox-5cb45741/package.conf.inplace already exists\n</code></pre>\n\n<p>I get the same result if I try to install that package using <code>cabal install creatur-wains</code>. I didn't have this problem with earlier versions of cabal. How can I fix this?</p>\n"}, {"tags": ["haskell", "memoization"], "comments": [{"owner": {"reputation": 55045, "user_id": 1003565, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd05397868614fcd87d9243c8025a725?s=128&d=identicon&r=PG", "display_name": "Dason", "link": "https://stackoverflow.com/users/1003565/dason"}, "edited": false, "score": 5, "creation_date": 1420647852, "post_id": 27823709, "comment_id": 44053600, "body": "Memoizing is a thing... <a href=\"http://en.wikipedia.org/wiki/Memoization\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Memoization</a> Please don&#39;t edit it to &quot;memorize&quot;"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1420649956, "post_id": 27823709, "comment_id": 44054918, "body": "Are all of the elements of the list non-negative?"}, {"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1420650709, "post_id": 27823709, "comment_id": 44055360, "body": "@Cirdec: Yes! (Sorry for forgetting to mention it.)"}], "answers": [{"comments": [{"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 0, "creation_date": 1420650353, "post_id": 27824479, "comment_id": 44055131, "body": "I&#39;d like to avoid walking the graph from the root for many integers <b>a</b> for a fixed integer list <b>as</b> to get <b>f (a:as)</b> as the lists can become quite long."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 1, "creation_date": 1420651492, "post_id": 27824479, "comment_id": 44055835, "body": "So it seems you want two things: 1) after computing <code>f([2..100])</code> you&#39;ll be computing <code>f([1..100])</code> but you don&#39;t want to walk the graph again to retrieve the cached value of <code>f([2..100])</code>. And 2) After computing <code>f([1,5])</code> you want <code>f([5,1])</code> to find that previously computed value. Is that right?"}, {"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 0, "creation_date": 1420652867, "post_id": 27824479, "comment_id": 44056618, "body": "Yes! Maybe I should have put the 2nd paragraph of my question at the end??"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1420649687, "creation_date": 1420649687, "answer_id": 27824479, "question_id": 27823709, "link": "https://stackoverflow.com/questions/27823709/memoizing-a-function-of-type-integer-a/27824479#27824479", "title": "Memoizing a function of type [Integer] -&gt; a", "body": "<p>How about just defining <code>g_m' = g_m . sort</code>, i.e. you simply sort the input list first before calling your memoized function?</p>\n\n<p>I have a feeling this is the best you can do since if you want your memoized graph to consist of only sorted paths someone is going to have to look at all of the elements of the list before constructing the path.</p>\n\n<p>Depending on what your input lists look like it might be helpful to transform them in a way which makes the trees branch less. For instance, you might try sorting and taking differences:</p>\n\n<pre><code>original input list:   [8,3,14,8,5]\nsorted:                [3,3,8,8,14]\ndiffed:                [3,0,5,0,6] -- use this as the key\n</code></pre>\n\n<p>The transformation is a bijection, and the trees branch less because there are smaller numbers involved.</p>\n"}, {"comments": [{"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 0, "creation_date": 1420666831, "post_id": 27828277, "comment_id": 44064219, "body": "Did you mean to write 2^a1*3^a2*5^a3... instead? My lists will have few thousands of entries with values up to few thousand, so I didn&#39;t want to encode lists of integers as (quite long) integers. PS: Thanks for the long answer, checking might take a day..."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 0, "creation_date": 1420697668, "post_id": 27828277, "comment_id": 44073343, "body": "Ah true, <code>primen^an</code>. If you have relatively small deltas between entries, the result integer won&#39;t grow &quot;large&quot;. <code>faster_g [100,120..2000]</code> performs relatively fast still.  <b>If</b> you know that values are bounded from the top as well, you can use <code>a1 + a2 * N + a3 * N * N + ...</code> encoding, which is much more <i>terse</i>."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 0, "creation_date": 1420704107, "post_id": 27828277, "comment_id": 44075589, "body": "@j.p. Seems that your <code>Graph</code> version is twice as fast as my binary trick. Not to say <code>Graph</code> one is much leaner!"}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 2, "last_activity_date": 1420704048, "last_edit_date": 1495535170, "creation_date": 1420663330, "answer_id": 27828277, "question_id": 27823709, "link": "https://stackoverflow.com/questions/27823709/memoizing-a-function-of-type-integer-a/27828277#27828277", "title": "Memoizing a function of type [Integer] -&gt; a", "body": "<p>You can use a bit different approach.\nThere is a trick in proof that a finite product of countable sets is countable:</p>\n\n<p>We can map the sequence <code>[a1, ..., an]</code> to <code>Nat</code> by <code>product . zipWith (^) primes</code>: <code>2 ^ a1 * 3 ^ a2 * 5 ^ a3 * ... * primen ^ an</code>.</p>\n\n<p>To avoid problems with sequences with zero at the end, we can increase the last index. </p>\n\n<p>As the sequence is ordered, we can exploit the property as <a href=\"https://stackoverflow.com/a/27824479/1308058\">user5402</a> mentioned.</p>\n\n<p>The benefit of using the tree, is that you can increase branching to speed-up traversal. OTOH prime trick could make indexes quite big, but hopefully some tree paths will just be unexplored (remain as thunks).</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\n-- Modified from Kmett's answer:\ndata Tree a = Tree a (Tree a) (Tree a) (Tree a) (Tree a)\ninstance Functor Tree where\n  fmap f (Tree x a b c d) = Tree (f x) (fmap f a) (fmap f b) (fmap f c) (fmap f d)\n\nindex :: Tree a -&gt; Integer -&gt; a\nindex (Tree x _ _ _ _) 0 = x\nindex (Tree _ a b c d) n = case (n - 1) `divMod` 4 of\n  (q,0) -&gt; index a q\n  (q,1) -&gt; index b q\n  (q,2) -&gt; index c q\n  (q,3) -&gt; index d q\n\nnats :: Tree Integer\nnats = go 0 1\n    where\n        go !n !s = Tree n (go a s') (go b s') (go c s') (go d s')\n            where\n                a = n + s\n                b = a + s\n                c = b + s\n                d = c + s\n                s' = s * 4\n\ntoList :: Tree a -&gt; [a]\ntoList as = map (index as) [0..]\n\n-- Primes -- https://www.haskell.org/haskellwiki/Prime_numbers\n-- Generation and factorisation could be done much better\nminus (x:xs) (y:ys) = case (compare x y) of\n           LT -&gt; x : minus  xs  (y:ys)\n           EQ -&gt;     minus  xs     ys\n           GT -&gt;     minus (x:xs)  ys\nminus  xs     _     = xs\n\nprimes = 2 : sieve [3..] primes\n  where\n    sieve xs (p:ps) | q &lt;- p*p , (h,t) &lt;- span (&lt; q) xs =\n                   h ++ sieve (t `minus` [q, q+p..]) ps\n\naddToLast :: [Integer] -&gt; [Integer]\naddToLast [] = []\naddToLast [x] = [x + 1]\naddToLast (x:xs) = x : addToLast xs\n\nsubFromLast :: [Integer] -&gt; [Integer]\nsubFromLast [] = []\nsubFromLast [x] = [x - 1]\nsubFromLast (x:xs) = x : subFromLast xs\n\naddSubProp :: [NonNegative Integer] -&gt; Property\naddSubProp xs = xs' === subFromLast (addToLast xs')\n  where xs' = map getNonNegative xs\n\n-- Trick from user5402 answer\ntoDiffList :: [Integer] -&gt; [Integer]\ntoDiffList = toDiffList' 0\n  where toDiffList' _ [] = []\n        toDiffList' p (x:xs) = x - p : toDiffList' x xs\n\nfromDiffList :: [Integer] -&gt; [Integer]\nfromDiffList = fromDiffList' 0\n  where fromDiffList' _ [] = []\n        fromDiffList' p (x:xs) = p + x : fromDiffList' (x + p) xs\n\ndiffProp :: [Integer] -&gt; Property\ndiffProp xs = xs === fromDiffList (toDiffList xs)\n\nlistToInteger :: [Integer] -&gt; Integer\nlistToInteger = product . zipWith (^) primes . addToLast\n\nintegerToList :: Integer -&gt; [Integer]\nintegerToList = subFromLast . impl primes 0\n  where impl _      _ 0 = []\n        impl _      0 1 = []\n        impl _      k 1 = [k]\n        impl (p:ps) k n = case n `divMod` p of\n                            (n', 0) -&gt; impl (p:ps) (k + 1) n'\n                            (_,  _) -&gt; k : impl ps 0 n\n\nlistProp :: [NonNegative Integer] -&gt; Property\nlistProp xs = xs' === integerToList (listToInteger xs')\n  where xs' = map getNonNegative xs\n\ntoIndex :: [Integer] -&gt; Integer\ntoIndex = listToInteger . toDiffList\n\nfromIndex :: Integer -&gt; [Integer]\nfromIndex = fromDiffList . integerToList\n\n-- [1,0] /= [0]\n-- Decreasing sequence!\ndoesntHold :: [NonNegative Integer] -&gt; Property\ndoesntHold xs = xs' === fromIndex (toIndex xs')\n  where xs' = map getNonNegative xs\n\nholds :: [NonNegative Integer] -&gt; Property\nholds xs = xs' === fromIndex (toIndex xs')\n  where xs' = sort $ map getNonNegative xs\n\ng :: ([Integer] -&gt; Integer) -&gt; [Integer] -&gt; Integer\ng mg = g' . sort\n  where g' [] = 0\n        g' (x:xs)  = x + sum (map mg $ tails xs)\n\ng_tree :: Tree Integer\ng_tree = fmap (g faster_g' . fromIndex) nats\n\nfaster_g' :: [Integer] -&gt; Integer\nfaster_g' = index g_tree . toIndex\n\nfaster_g = faster_g' . sort\n</code></pre>\n\n<p>On my machine <code>fix g [1..22]</code> feels slow, when <code>faster_g [1..40]</code> is still blazing fast.</p>\n\n<hr>\n\n<p><em>Addition</em>: <strong>if</strong> we have bounded set (with indexes <em>0..n-1</em>) , we can encode it as: <code>a0 * n^0 + a1 * n^1 ...</code>.</p>\n\n<p>We can encode any <code>Integer</code> as binary list, e.g. <code>11</code> is <code>[1, 1, 0, 1]</code> (least bit first).\nThen if we separate integers in the list with <code>2</code>, we get sequence of bounded values.</p>\n\n<p>As bonus we can take the sequence of <em>0, 1, 2</em> digits and <em>compress</em> it to binary using e.g. Huffman encoding, as 2 is much rarer than 0 or 1. But this might be overkill.</p>\n\n<p>With this trick, indexes stay much smaller and the space probably is better packed.</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\n-- From Kment's answer:\nimport Data.Function (fix)\nimport Data.List (sort, tails)\nimport Data.List.Split (splitOn)\nimport Test.QuickCheck\n\n{-- Tree definition as before --}\n\n-- 0, 1, 2\nnewtype N3 = N3 { unN3 :: Integer }\n  deriving (Eq, Show)\n\ninstance Arbitrary N3 where\n  arbitrary = elements $ map N3 [ 0, 1, 2 ]\n\n-- Integer &lt;-&gt; N3\ncoeffs3 :: [Integer]\ncoeffs3 = coeffs' 1\n  where coeffs' n = n : coeffs' (n * 3)\n\nlistToInteger :: [N3] -&gt; Integer\nlistToInteger = sum . zipWith f coeffs3\n  where f n (N3 m) = n * m\n\nlistFromInteger :: Integer -&gt; [N3]\nlistFromInteger 0 = []\nlistFromInteger n = case n `divMod` 3 of\n  (q, m) -&gt; N3 m : listFromInteger q\n\nlistProp :: [N3] -&gt; Property\nlistProp xs = (null xs || last xs /= N3 0) ==&gt; xs === listFromInteger (listToInteger xs)\n\n-- Integer &lt;-&gt; N2\n\n-- 0, 1\nnewtype N2 = N2 { unN2 :: Integer }\n  deriving (Eq, Show)\n\ncoeffs2 :: [Integer]\ncoeffs2 = coeffs' 1\n  where coeffs' n = n : coeffs' (n * 2)\n\nintegerToBin :: Integer -&gt; [N2]\nintegerToBin 0 = []\nintegerToBin n = case n `divMod` 2 of\n  (q, m) -&gt; N2 m : integerToBin q\n\nintegerFromBin :: [N2] -&gt; Integer\nintegerFromBin = sum . zipWith f coeffs2\n  where f n (N2 m) = n * m\n\nbinProp :: NonNegative Integer -&gt; Property\nbinProp (NonNegative n) = n === integerFromBin (integerToBin n)\n\n-- unsafe!\nn3ton2 :: N3 -&gt; N2\nn3ton2 = N2 . unN3\n\nn2ton3 :: N2 -&gt; N3\nn2ton3 = N3 . unN2\n\n-- [Integer] &lt;-&gt; [N3]\nintegerListToN3List :: [Integer] -&gt; [N3]\nintegerListToN3List = concatMap (++ [N3 2]) . map (map n2ton3 . integerToBin)\n\nintegerListFromN3List :: [N3] -&gt; [Integer]\nintegerListFromN3List = init . map (integerFromBin . map n3ton2) . splitOn [N3 2]\n\nn3ListProp :: [NonNegative Integer] -&gt; Property\nn3ListProp xs = xs' === integerListFromN3List (integerListToN3List xs')\n  where xs' = map getNonNegative xs\n\n-- Trick from user5402 answer\n-- Integer &lt;-&gt; Sorted Integer\ntoDiffList :: [Integer] -&gt; [Integer]\ntoDiffList = toDiffList' 0\n  where toDiffList' _ [] = []\n        toDiffList' p (x:xs) = x - p : toDiffList' x xs\n\nfromDiffList :: [Integer] -&gt; [Integer]\nfromDiffList = fromDiffList' 0\n  where fromDiffList' _ [] = []\n        fromDiffList' p (x:xs) = p + x : fromDiffList' (x + p) xs\n\ndiffProp :: [Integer] -&gt; Property\ndiffProp xs = xs === fromDiffList (toDiffList xs)\n\n---\n\ntoIndex :: [Integer] -&gt; Integer\ntoIndex = listToInteger . integerListToN3List . toDiffList\n\nfromIndex :: Integer -&gt; [Integer]\nfromIndex = fromDiffList . integerListFromN3List . listFromInteger\n\n-- [1,0] /= [0]\n-- Decreasing sequence! doesn't terminate in this case\ndoesntHold :: [NonNegative Integer] -&gt; Property\ndoesntHold xs = xs' === fromIndex (toIndex xs')\n  where xs' = map getNonNegative xs\n\nholds :: [NonNegative Integer] -&gt; Property\nholds xs = xs' === fromIndex (toIndex xs')\n  where xs' = sort $ map getNonNegative xs\n\ng :: ([Integer] -&gt; Integer) -&gt; [Integer] -&gt; Integer\ng mg = g' . sort\n  where g' [] = 0\n        g' (x:xs)  = x + sum (map mg $ tails xs)\n\ng_tree :: Tree Integer\ng_tree = fmap (g faster_g' . fromIndex) nats\n\nfaster_g' :: [Integer] -&gt; Integer\nfaster_g' = index g_tree . toIndex\n\nfaster_g = faster_g' . sort\n</code></pre>\n\n<hr>\n\n<p><em>Second addition:</em></p>\n\n<p>I quickly benchmarked graph and binary sequence approach for my <code>g</code> with:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  n &lt;- read . head &lt;$&gt; getArgs\n  print $ faster_g [100, 110..n]\n</code></pre>\n\n<p>And the results are:</p>\n\n<pre><code>% time ./IntegerMemo 1000\n1225560638892526472150132981770\n./IntegerMemo 1000  0.19s user 0.01s system 98% cpu 0.200 total\n% time ./IntegerMemo 2000\n3122858113354873680008305238045814042010921833620857170165770\n./IntegerMemo 2000  1.83s user 0.05s system 99% cpu 1.888 total\n% time ./IntegerMemo 2500\n4399449191298176980662410776849867104410434903220291205722799441218623242250\n./IntegerMemo 2500  3.74s user 0.09s system 99% cpu 3.852 total\n% time ./IntegerMemo 3000    \n5947985907461048240178371687835977247601455563536278700587949163642187584269899171375349770\n./IntegerMemo 3000  6.66s user 0.13s system 99% cpu 6.830 total\n\n% time ./IntegerMemoGrap 1000 \n1225560638892526472150132981770\n./IntegerMemoGrap 1000  0.10s user 0.01s system 97% cpu 0.113 total\n% time ./IntegerMemoGrap 2000\n3122858113354873680008305238045814042010921833620857170165770\n./IntegerMemoGrap 2000  0.97s user 0.04s system 98% cpu 1.028 total\n% time ./IntegerMemoGrap 2500\n4399449191298176980662410776849867104410434903220291205722799441218623242250\n./IntegerMemoGrap 2500  2.11s user 0.08s system 99% cpu 2.202 total\n% time ./IntegerMemoGrap 3000 \n5947985907461048240178371687835977247601455563536278700587949163642187584269899171375349770\n./IntegerMemoGrap 3000  3.33s user 0.09s system 99% cpu 3.452 total\n</code></pre>\n\n<p>Looks like that graph version is faster by constant factor of <strong>2</strong>. But they seem to have same time complexity :)</p>\n"}, {"tags": [], "owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1421012984, "last_edit_date": 1421012984, "creation_date": 1420667559, "answer_id": 27829279, "question_id": 27823709, "link": "https://stackoverflow.com/questions/27823709/memoizing-a-function-of-type-integer-a/27829279#27829279", "title": "Memoizing a function of type [Integer] -&gt; a", "body": "<p>Looks like my problem is solved by simply replacing <code>intSeq</code> in the definition of <code>g_graph</code> by a monotone version:</p>\n\n<pre><code>-- replace vertexes for non-monotone integer lists by the according monotone one\nmonoIntSeq :: Graph [Integer]\nmonoIntSeq = f intSeq\n  where f (Graph as t) | as == sort as = Graph as $ fmap f t\n                       | otherwise     = fetch monIntSeq $ sort as\n\n-- extract the subgraph after following the given labels\nfetch :: Graph a -&gt; [Integer] -&gt; Graph a\nfetch g [] = g\nfetch (Graph _ t) (x:xs) = fetch (index t x) xs\n\ng_graph :: Graph (StrictPair Integer [Integer])\ng_graph = fmap (g g_m) monoIntSeq\n</code></pre>\n\n<p>Many thanks to all (especially user5402 and Oleg) for the help!</p>\n\n<hr>\n\n<p><strong>Edit:</strong> I still have the problem that the memory consumption is to high for my typical use case which can be described by following a path like this:</p>\n\n<pre><code>p :: [Integer]\np = map f [1..]\n  where f n | n `mod` 6 == 0 = n `div` 6\n            | n `mod` 3 == 0 = n `div` 3\n            | n `mod` 2 == 0 = n `div` 2\n            | otherwise      = n\n</code></pre>\n\n<p>A slight improvement is to define the monotone integer sequences directly like this:</p>\n\n<pre><code>-- extract the subgraph after following the given labels (right to left)\nfetch :: Graph a -&gt; [Integer] -&gt; Graph a\nfetch = foldl' step\n  where step (Graph _ t) n = index t n\n\n-- walk the graph following the given labels (right to left)\nwalk :: Graph a -&gt; [Integer] -&gt; a\nwalk g ns = a\n  where Graph a _ = fetch g ns\n\n-- all monotone falling integer sequences\nmonoIntSeqs :: Graph [Integer]\nmonoIntSeqs = Graph [] $ fmap (flip f monoIntSeqs) nats\n  where f n (Graph ns t) | null ns      = Graph (n:ns) $ fmap (f n) t\n                         | n &gt;= head ns = Graph (n:ns) $ fmap (f n) t\n                         | otherwise    = fetch monoIntSeqs (insert' n ns)\n        insert' = insertBy (comparing Down)\n</code></pre>\n\n<p>But at the end I might just use the original integer sequences without identification, identify nodes now and then explicitly and avoid keeping a reference to g_graph etc to let the garbage collection clean up as the program proceeds.</p>\n"}, {"tags": [], "owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1521185387, "creation_date": 1521185387, "answer_id": 49315256, "question_id": 27823709, "link": "https://stackoverflow.com/questions/27823709/memoizing-a-function-of-type-integer-a/49315256#49315256", "title": "Memoizing a function of type [Integer] -&gt; a", "body": "<p>Reading the functional pearl <a href=\"https://www.cs.ox.ac.uk/ralf.hinze/publications/HW03.pdf\" rel=\"nofollow noreferrer\">Trouble Shared is Trouble Halved</a> by Richard Bird and Ralf Hinze, I understood how to implement, what I was looking for two years ago (again based on Edward Kmett's trick):</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nimport Data.Function (fix)\n\ndata Tree a = Tree (Tree a) a (Tree a)\n  deriving Show\n\ninstance Functor Tree where\n  fmap f (Tree l m r) = Tree (fmap f l) (f m) (fmap f r)\n\nindex :: Tree a -&gt; Integer -&gt; a\nindex (Tree _ m _) 0 = m\nindex (Tree l _ r) n = case (n - 1) `divMod` 2 of\n  (q,0) -&gt; index l q\n  (q,1) -&gt; index r q\n\nnats :: Tree Integer\nnats = go 0 1\n  where go !n !s = Tree (go l s') n (go r s')\n          where l = n + s\n                r = l + s\n                s' = s * 2\n\ndata IntSeqTree a = IntSeqTree a (Tree (IntSeqTree a))\n\nval :: IntSeqTree a -&gt; a\nval (IntSeqTree a _) = a\n\nstep :: Integer -&gt; IntSeqTree t -&gt; IntSeqTree t\nstep n (IntSeqTree _ ts) = index ts n\n\nintSeqTree :: IntSeqTree [Integer]\nintSeqTree = fix $ create []\n  where create p x = IntSeqTree p $ fmap (extend x) nats\n        extend x n = case span (&gt;n) (val x) of\n                       ([], p) -&gt; fix $ create (n:p)\n                       (m, p)  -&gt; foldr step intSeqTree (m ++ n:p)\n\ninstance Functor IntSeqTree where\n  fmap f (IntSeqTree a t) = IntSeqTree (f a) (fmap (fmap f) t)\n</code></pre>\n\n<p>In my use case I have hundreds or thousands of similar integer sequences (of length few hundred entries) that are generated incrementally. So for me this way is cheaper than sorting the sequences before looking up the function value (which I will access by using fmap on intSeqTree).</p>\n"}], "owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 2, "accepted_answer_id": 49315256, "answer_count": 4, "score": 4, "last_activity_date": 1521185387, "creation_date": 1420647289, "last_edit_date": 1495541569, "question_id": 27823709, "link": "https://stackoverflow.com/questions/27823709/memoizing-a-function-of-type-integer-a", "title": "Memoizing a function of type [Integer] -&gt; a", "body": "<p>My problem is how to efficiently memoize an expensive function <code>f :: [Integer] -&gt; a</code> that is defined for all <em>finite</em> lists of integers and has the property <code>f . sort = f</code>?</p>\n\n<p>My typical use case is that given a list <code>as</code> of integers I need to obtain the values <code>f (a:as)</code> for various Integer a, so I'd like to build up simultaneously a directed labelled graph whose vertices are pairs of an Integer list and its function value. An edge labelled by a from (as, f as) to (bs, f bs) exists if and only if a:as = bs.</p>\n\n<p>Stealing from a <a href=\"https://stackoverflow.com/a/3209189/99978\">brilliant answer by Edward Kmett</a> I simply copied</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\ndata Tree a = Tree (Tree a) a (Tree a)\ninstance Functor Tree where\n  fmap f (Tree l m r) = Tree (fmap f l) (f m) (fmap f r)\n\nindex :: Tree a -&gt; Integer -&gt; a\nindex (Tree _ m _) 0 = m\nindex (Tree l _ r) n = case (n - 1) `divMod` 2 of\n  (q,0) -&gt; index l q\n  (q,1) -&gt; index r q\n\nnats :: Tree Integer\nnats = go 0 1\n  where go !n !s = Tree (go l s') n (go r s')\n          where l = n + s\n                r = l + s\n                s' = s * 2\n</code></pre>\n\n<p>and adapted his idea to my problem as</p>\n\n<pre><code>-- directed graph labelled by Integers\ndata Graph a = Graph a (Tree (Graph a))\ninstance Functor Graph where\n  fmap f (Graph a t) = Graph (f a) (fmap (fmap f) t)\n\n-- walk the graph following the given labels\nwalk :: Graph a -&gt; [Integer] -&gt; a\nwalk (Graph a _) [] = a\nwalk (Graph _ t) (x:xs) = walk (index t x) xs\n\n-- graph of all finite integer sequences\nintSeq :: Graph [Integer]\nintSeq = Graph [] (fmap (\\n -&gt; fmap (n:) intSeq) nats)\n\n-- could be replaced by Data.Strict.Pair\ndata StrictPair a b = StrictPair !a !b\n  deriving Show\n\n-- f = sum modified according to Edward's idea (the real function is more complicated)\ng :: ([Integer] -&gt; StrictPair Integer [Integer]) -&gt; [Integer] -&gt; StrictPair Integer [Integer]\ng mf [] = StrictPair 0 []\ng mf (a:as) = StrictPair (a+x) (a:as)\n  where StrictPair x y = mf as\n\ng_graph :: Graph (StrictPair Integer [Integer])\ng_graph = fmap (g g_m) intSeq\n\ng_m :: [Integer] -&gt; StrictPair Integer [Integer]\ng_m = walk g_graph\n</code></pre>\n\n<p>This works OK, but as the function <code>f</code> is independent of the order of the occurring integers (but not of their counts) there should be only one vertex in the graph for all integer lists equal up to ordering.</p>\n\n<p>How do I achieve this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 3, "creation_date": 1420645367, "post_id": 27822867, "comment_id": 44051960, "body": "You are correct, a function is non-strict if f \u22a5 \u2260 \u22a5.  If you might not evaluate an argument depending on &lt;condition&gt;, the function is non-strict (in the argument that might not be evaluated)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1420647443, "post_id": 27822867, "comment_id": 44053317, "body": "If a function <i>always</i> evaluates its argument, it is called strict in that argument. A function that <i>never</i> evaluates an argument is called uninteresting in that argument. OK, OK, I&#39;ve just made it up. But studying this trivial behaviour doesn&#39;t seem to be very exciting science. A function that does <i>not always</i> evaluate its argument is called non-strict in that argument."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1420667030, "post_id": 27822867, "comment_id": 44064324, "body": "@n.m. A function can completely ignore its argument and still be strict in that argument."}, {"owner": {"reputation": 8297, "user_id": 298847, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b52bc71fb15db17f585b912aed45b217?s=128&d=identicon&r=PG", "display_name": "tibbe", "link": "https://stackoverflow.com/users/298847/tibbe"}, "edited": false, "score": 0, "creation_date": 1420722390, "post_id": 27822867, "comment_id": 44085228, "body": "Given this it seems to me that saying that a function is lazy in an argument isn&#39;t very interesting, as that statement lacks enough precision for the caller to make use of that fact. The caller needs know under which conditions the argument is evaluated to be able to rely on laziness for some correctness purpose."}], "answers": [{"tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": true, "score": 13, "last_activity_date": 1420647134, "creation_date": 1420647134, "answer_id": 27823646, "question_id": 27822867, "link": "https://stackoverflow.com/questions/27822867/how-do-we-formally-say-that-a-function-is-non-strict-in-an-argument/27823646#27823646", "title": "How do we formally say that a function is non-strict in an argument?", "body": "<p>There's no standard notation for expressing complex strictness properties.  It's also no not as simple as just being strict, since for data structures you may need to say exactly how much gets evaluated.</p>\n\n<p>That said, for a simple function like</p>\n\n<pre><code>cond c t e = if c then t else e\n</code></pre>\n\n<p>you can imagine saying that the strictness is <code>1 &amp; (2 | 3)</code>, meaning that it will evaluate the first argument, and either the second or the third.  These are the kind of strictness properties that a simple strictness analyzer will come up with.  (And simple ones seem to be the only ones that are worth while.)</p>\n"}], "owner": {"reputation": 8297, "user_id": 298847, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b52bc71fb15db17f585b912aed45b217?s=128&d=identicon&r=PG", "display_name": "tibbe", "link": "https://stackoverflow.com/users/298847/tibbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 27823646, "answer_count": 1, "score": 6, "last_activity_date": 1420647134, "creation_date": 1420644758, "question_id": 27822867, "link": "https://stackoverflow.com/questions/27822867/how-do-we-formally-say-that-a-function-is-non-strict-in-an-argument", "title": "How do we formally say that a function is non-strict in an argument?", "body": "<p>We say that a function is strict in its argument if</p>\n\n<pre><code>f \u22a5 = \u22a5\n</code></pre>\n\n<p>but how do we say that a function is non-strict in its argument? Can we say that a function is non-strict if</p>\n\n<pre><code>f \u22a5 \u2260 \u22a5\n</code></pre>\n\n<p>?</p>\n\n<p>How does that extend to functions of many arguments, where we might or might not evaluate an argument depending on the value of some other argument?</p>\n\n<p>I'm asking this in the context of better documenting the strictness properties of Haskell functions using Haddock documentation.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1420646352, "post_id": 27822527, "comment_id": 44052586, "body": "Shouldn&#39;t the error say &quot;Not a valid <b>DNA</b> nucleotide&quot;, since the valid inputs are GCTA?"}, {"owner": {"reputation": 1761, "user_id": 1726359, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1caf4235671739f4a0848dd39e63a343?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/1726359/chad"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1420667063, "post_id": 27822527, "comment_id": 44064337, "body": "That is actually a great observation. I will correct it appropriately"}], "answers": [{"comments": [{"owner": {"reputation": 1761, "user_id": 1726359, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1caf4235671739f4a0848dd39e63a343?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/1726359/chad"}, "edited": false, "score": 0, "creation_date": 1420644415, "post_id": 27822677, "comment_id": 44051196, "body": "This was very helpful. I got it now!"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 12, "last_activity_date": 1420644243, "creation_date": 1420644243, "answer_id": 27822677, "question_id": 27822527, "link": "https://stackoverflow.com/questions/27822527/why-do-i-have-to-compose-id-with-mapm/27822677#27822677", "title": "Why do I have to compose id with mapM", "body": "<p>I think you're reading this wrong...</p>\n\n<pre><code>either error id . mapM nucleotideComplement\n</code></pre>\n\n<p>You seem to think this means</p>\n\n<pre><code>either error (id . mapM nucleotideComplement)\n</code></pre>\n\n<p>when in fact it means</p>\n\n<pre><code>(either error id) . (mapM nucleotideComplement)\n</code></pre>\n\n<p>You aren't doing <code>id . mapM nucleotideComplement</code> anywhere. You're applying <code>mapM</code> and then passing the result to <code>either</code>, which will apply <code>error</code> or <code>id</code> depending on whether it sees <code>Left</code> or <code>Right</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1420645212, "last_edit_date": 1420645212, "creation_date": 1420644630, "answer_id": 27822819, "question_id": 27822527, "link": "https://stackoverflow.com/questions/27822527/why-do-i-have-to-compose-id-with-mapm/27822819#27822819", "title": "Why do I have to compose id with mapM", "body": "<p>The type of either is <code>(a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c</code>. So you apply it to <code>error</code> and you get <code>(b -&gt; c) -&gt; Either String b -&gt; c</code>, then you apply that to <code>mapM</code> and you get <code>Monad m =&gt; Either String (a -&gt; m b) -&gt; [a] -&gt; m [b]</code>. Then you apply that to <code>nucleotideComplement</code> and you get an error because <code>nucleotideComplement</code> is a function and not an <code>Either</code>.</p>\n\n<p>In other words you apply <code>either</code> to three arguments when you intended to call it with two arguments where the second argument was the result of applying <code>mapM</code> to <code>nucleotideComplement</code>. To call the function with the arguments you intended, you can write <code>either error (mapM nucleotideComponent)</code>, but that still won't work because the second argument to <code>either</code> should be a function accepting a <code>Char</code> (because you have an <code>Either String Char</code>), not one accepting a monad. To achieve what you wanted you can either write <code>either error nucleotideComponent</code> or use <code>.</code> as you already found out.</p>\n\n<p>The version with <code>.</code> works because the precedence rules of Haskell say that <code>either error id . mapM nucleotideComplement</code> is equivalent to <code>(either error id) . (mapM nucleotideComplement)</code>, not <code>(either error id . mapM) nucleotideComplement</code> or <code>either error (id . mapM nucleotideComplement)</code>. <code>either error id</code> is a function that turns an <code>Either String b</code> into an <code>Either a b</code> where the left case would cause an error and <code>mapM nucleotideComplement</code> is a function that turns an <code>m Char</code> into another <code>m Char</code> with the char being \"flipped\" for any monad m - in this case <code>m</code> being <code>Either String</code>. So by composing these two functions, you get a function that turns an <code>Either String Char</code> into an <code>Either a Char</code> with the right case being a flipped char and the left case causing an error.</p>\n\n<p>Of course <code>either error flipNucleotide</code> is the far simpler solution.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1420671674, "creation_date": 1420671674, "answer_id": 27830228, "question_id": 27822527, "link": "https://stackoverflow.com/questions/27822527/why-do-i-have-to-compose-id-with-mapm/27830228#27830228", "title": "Why do I have to compose id with mapM", "body": "<p>This doesn't exactly get at your type error, but I'd like to suggest that you reconsider your representation. Specifically, it's generally best to use types to enforce invariants, avoiding partial functions that can throw errors or exceptions, and avoiding accidentally mixing up related things that may belong to different parts of the code. There are various ways to approach this, but here's one. This approach pretends that DNA and RNA have completely different kinds of nucleotides. Chemically, this is not true, but it's probably a sensible representation for what you're doing. Actually encoding the chemical reality is probably beyond the abilities of Haskell's type system, and probably actually less useful for catching mistakes in this context.</p>\n\n<pre><code>data DNANucleotide = GD | CD | TD | AD\ndata RNANucleotide = GR | CR | UR | AR\n\ntoStringDNA :: [DNANucleotide] -&gt; String\ntoStringDNA = map (\\nucleotide -&gt; case nucleotide of\n  {GD -&gt; 'G'; CD -&gt; 'C'; TD -&gt; 'T'; AD -&gt; 'A'})\n\ntoStringRNA = ...\n\nfromCharDNA :: Char -&gt; Maybe DNANucleotide\nfromCharDNA 'G' = Just GD\nfromCharDNA 'C' = Just CD\n...\nfromCharDNA _ = Nothing\n\nfromCharRNA = ...\n\nfromStringDNA :: String -&gt; Maybe [DNANucleotide]\nfromStringDNA = mapM fromCharDNA\n\nfromStringRNA :: String -&gt; Maybe [RNANucleotide]\nfromStringRNA = mapM fromCharRNA\n</code></pre>\n\n<p>Once you get into the actual mechanics of <em>working</em> with DNA and RNA, as opposed to reading them in from strings, there can be no more errors:</p>\n\n<pre><code>transcribeN :: DNANucleotide -&gt; RNANucleotide\ntranscribeN GD = CR\ntranscribeN CD = GR\ntranscribeN TD = AR\ntranscribeN AD = UR\n\ntranscribe :: [DNANucleotide] -&gt; [RNANucleotide]\ntranscribe = map transcribeN\n</code></pre>\n"}], "owner": {"reputation": 1761, "user_id": 1726359, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1caf4235671739f4a0848dd39e63a343?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/1726359/chad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 27822819, "answer_count": 3, "score": 0, "last_activity_date": 1420671674, "creation_date": 1420643829, "question_id": 27822527, "link": "https://stackoverflow.com/questions/27822527/why-do-i-have-to-compose-id-with-mapm", "title": "Why do I have to compose id with mapM", "body": "<p>I have the following methods:</p>\n\n<pre><code>nucleotideComplement :: Char -&gt; Either String Char\nnucleotideComplement 'G' = Right 'C'\nnucleotideComplement 'C' = Right 'G'\nnucleotideComplement 'T' = Right 'A'\nnucleotideComplement 'A' = Right 'U'\nnucleotideComplement x = Left \"Not a valid RNA nucleotide.\"\n</code></pre>\n\n<p>And would like to define another:</p>\n\n<pre><code>toRNA :: String -&gt; String\ntoRNA = either error mapM nucleotideComplement\n</code></pre>\n\n<p>However I'm getting a type error here. However doing it this way seems to fix the issue:</p>\n\n<pre><code>toRNA :: String -&gt; String\ntoRNA = either error id . mapM nucleotideComplement\n</code></pre>\n\n<p>I don't understand why this happens</p>\n\n<p>First, <code>id</code> has the type <code>a -&gt; a</code>. Next, when getting the type (<code>:t</code>) of <code>mapM nucleotideComplement</code> and <code>id . mapM nucleotideComplement</code>, they seem to be the same. Why am I getting such a different effect?</p>\n\n<p>Hope someone could clarify this further.</p>\n"}, {"tags": ["haskell", "monads", "state-monad"], "answers": [{"comments": [{"owner": {"reputation": 1622, "user_id": 1054800, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881102db0abfb0d08ff131c472ce4991?s=128&d=identicon&r=PG", "display_name": "abelard2008", "link": "https://stackoverflow.com/users/1054800/abelard2008"}, "edited": false, "score": 0, "creation_date": 1420665338, "post_id": 27822082, "comment_id": 44063512, "body": "Thank you! I am sorry that I almost forgot the equivalent relation between do-notation and <code>&gt;&gt;=</code> <code>RWH</code> described, and did not fully understand <code>State act</code> as a whole thing!"}], "tags": [], "owner": {"reputation": 7803, "user_id": 190744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ia1FC.jpg?s=128&g=1", "display_name": "Stephen Diehl", "link": "https://stackoverflow.com/users/190744/stephen-diehl"}, "is_accepted": true, "score": 5, "last_activity_date": 1420642370, "creation_date": 1420642370, "answer_id": 27822082, "question_id": 27821325, "link": "https://stackoverflow.com/questions/27821325/understanding-the-symbol-when-using-state-monad/27822082#27822082", "title": "Understanding the symbol &quot;&lt;-&quot; when using State Monad?", "body": "<p>I'm not entirely sure about the phrasing of your question, so correct me if I misunderstood.</p>\n\n<p>There is an equivalence between the syntactic sugar for the do-notation syntax <code>&lt;-</code> and the overloaded bind operator <code>(&gt;&gt;=)</code>.</p>\n\n<pre><code>do { a &lt;- f ; m } \u2261 f &gt;&gt;= \\a -&gt; do { m }\n</code></pre>\n\n<p>So if you were to desugar the binds, it would look like:</p>\n\n<pre><code>rollDie' :: GeneratorState Int\nrollDie' =\n  get &gt;&gt;= \\generator -&gt;\n    let (value, newGenerator) = randomR (1,6) generator in\n    put newGenerator &gt;&gt;= \\_ -&gt;\n      return value\n</code></pre>\n\n<p>If you understand how the State monad works, in the implementation it threads around the state in an implicit argument for each bind (i.e. <code>&gt;&gt;=</code>). A simplified implementation might look like:</p>\n\n<pre><code>newtype State s a = State { runState :: s -&gt; (a,s) }\n\ninstance Monad (State s) where\n  return a = State $ \\s -&gt; (a, s)\n\n  State act &gt;&gt;= k = State $ \\s -&gt;\n    let (a, s') = act s\n    in runState (k a) s'\n\nget :: State s s\nget = State $ \\s -&gt; (s, s)\n\nput :: s -&gt; State s ()\nput s = State $ \\_ -&gt; ((), s)\n</code></pre>\n\n<p>So the bind operator when specialized to this specific State monad has the type:</p>\n\n<pre><code>(&gt;&gt;=) :: State s a -&gt; (a -&gt; State s b) -&gt; State s b\n</code></pre>\n\n<p>The function  <code>get</code> is simply the function that returns the state as an argument so you can inspect it, so it has to match the <code>s</code> type of the monad it lives in.</p>\n\n<pre><code>--           +--- State\n--           | +- Return value (inner state)\n--           | |\nget :: State s s\n</code></pre>\n"}], "owner": {"reputation": 1622, "user_id": 1054800, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881102db0abfb0d08ff131c472ce4991?s=128&d=identicon&r=PG", "display_name": "abelard2008", "link": "https://stackoverflow.com/users/1054800/abelard2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 27822082, "answer_count": 1, "score": 2, "last_activity_date": 1439510646, "creation_date": 1420639883, "last_edit_date": 1439510646, "question_id": 27821325, "link": "https://stackoverflow.com/questions/27821325/understanding-the-symbol-when-using-state-monad", "title": "Understanding the symbol &quot;&lt;-&quot; when using State Monad?", "body": "<p>In <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/State\" rel=\"nofollow\">Haskell/Understanding monads/State</a> there is a snippet code:</p>\n\n<pre><code>type GeneratorState = State StdGen\nrollDie :: GeneratorState Int\nrollDie = do generator &lt;- get\n         let (value, newGenerator) = randomR (1,6) generator\n         put newGenerator\n         return value\n</code></pre>\n\n<p>About the Symbol <code>&lt;-</code> in the above third line, there is an explanation:</p>\n\n<p>we take out the pseudo-random generator with <code>&lt;-</code> in conjunction with get. get overwrites the monadic value (The <code>a</code> in <code>m a</code>) with the state, binding the generator to the state. (If in doubt, recall the definition of get and <code>&gt;&gt;=</code> above).</p>\n\n<p>I do not understand: (1) <code>generator</code> is corresponding to the first type parameter of the definition <code>State</code>? (2)  why <code>generator</code> is just one of the two parameters of <code>State</code>, not two? Of course, from the context, the answer is obvious, but I do not know the concrete rules about <code>&lt;-</code>.</p>\n\n<p>To my knowledge, when evaluating <code>evalState rollDie (mkStdGen 600)</code>, <code>get</code> will be replaced by <code>State (mkStdGen 0) (mkStdGen 0)</code> , and, according to RWH's description \"<code>&lt;-</code> pulls things out of monads\", things here are not <code>(mkStdGen 0) (mkStdGen 0)</code> ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420672375, "post_id": 27818073, "comment_id": 44066657, "body": "I suspect you&#39;re missing some context."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4428454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037fc90b316797eb57595aee08e0ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "insoo-son", "link": "https://stackoverflow.com/users/4428454/insoo-son"}, "edited": false, "score": 0, "creation_date": 1420631782, "post_id": 27818272, "comment_id": 44043607, "body": "thanks. it&#39;s my mistake. i modified it. Text String can be represented Char. in the book, if the string contains escape character , for example JValue (&#39;\\x1ff&#39; : &#39;\\x1ff&#39; : []) , then generate Text &quot;\\x1ff&quot; <code>Concat</code> Text &quot;\\x1ff&quot; . I think it could be Char &#39;\\x1ff&#39; <code>Concat</code> Char &#39;\\x1ff&#39; . i think Text value constructor is useless. I am confused with it."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1420812364, "post_id": 27818272, "comment_id": 44126694, "body": "@Don Stewart: So why is there a separate <code>Char</code> constructor, what is its advantage compared to just using <code>Text . (:[])</code>?"}, {"owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "edited": false, "score": 0, "creation_date": 1420813381, "post_id": 27818272, "comment_id": 44127287, "body": "Char and Text are different types. You might want to print one with single quotes, and one with double, for example."}], "tags": [], "owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "is_accepted": false, "score": 3, "last_activity_date": 1420629466, "creation_date": 1420629466, "answer_id": 27818272, "question_id": 27818073, "link": "https://stackoverflow.com/questions/27818073/difference-between-doc-data-value-constructor-char-and-text/27818272#27818272", "title": "Difference between Doc data value constructor Char and Text", "body": "<p><code>Text</code> takes a <code>String</code> argument. <code>Char</code> takes a single <code>Char</code> value. As defined:</p>\n\n<pre><code>data Doc = Empty\n         | Char Char\n         | Text String\n         | Line\n         | Concat Doc Doc\n         | Union Doc Doc\n           deriving (Show,Eq)\n</code></pre>\n\n<p>Your example has a type error, it seems, since you're passing a '\\n' to Text on the final line.</p>\n"}], "owner": {"reputation": 9, "user_id": 4428454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037fc90b316797eb57595aee08e0ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "insoo-son", "link": "https://stackoverflow.com/users/4428454/insoo-son"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439510725, "creation_date": 1420628831, "last_edit_date": 1439510725, "question_id": 27818073, "link": "https://stackoverflow.com/questions/27818073/difference-between-doc-data-value-constructor-char-and-text", "title": "Difference between Doc data value constructor Char and Text", "body": "<p>I am reading Real World Haskell, chapter 5 (writing JSON renderer).</p>\n\n<pre><code>data JValue = JString String\n            | JNumber Double\n            | JBool   Bool\n            | JNull   \n            ... \n\ndata Doc = Empty\n         | Char Char\n         | Text String  \n         | Concat Doc Doc\n         ....  \n</code></pre>\n\n<p>I cannot understand the difference \nbetween Char and Text (Doc Value Constructor).</p>\n\n<pre><code>renderJValue :: JValue -&gt; Doc\nrenderJValue (JNumber n)        = Text $ show n\nrenderJValue (JBool   b)        = Text $ show b\nrenderJValue JNull              = Text \"null\"\nrenderJValue (JString (a:b:[])) = render a `Concat` render b \n    where render c = if isEscapeChar(c) \n                         then Text (c : [])\n                         else Char c \n\n\nrenderJValue $ JNumber 3                 \n    = Text \"3\"\nrenderJValue $ JNull                     \n    = Text \"null\"\nrenderJValue $ JString (\"null\")          \n    = Char 'n' `Concat` Char 'u' `Concat` Char 'l' `Concat` Char 'l'\nrenderJValue $ JString ('a' : '\\n' : []) \n    = Char 'a' `Concat` Text \"\\n\"\n</code></pre>\n\n<p>What is an advantage of distinguish Char and Text ?</p>\n"}, {"tags": ["haskell", "reactive-banana"], "answers": [{"comments": [{"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1420977131, "post_id": 27878929, "comment_id": 44174465, "body": "Thanks, this is an interesting approach that I hadn&#39;t considered. Do still need <code>once</code> as you still have the problem that old &quot;modes&quot; are still receiving events, even when they ask to be switched away? I&#39;ll be sure to have a play with this and see what I find."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1421156619, "post_id": 27878929, "comment_id": 44243946, "body": "In both cases, the old modes are still receiving events -- it&#39;s just that you discard them / ignore their results and create new modes instead. This probably means that you still need <code>once</code> in order to make sure that each mode may only signal once that it is to be replaced by a new one."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1421170416, "post_id": 27878929, "comment_id": 44253108, "body": "I don&#39;t suppose this is anything garbage collection would help address in the future?"}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1421315733, "post_id": 27878929, "comment_id": 44315088, "body": "Maybe. I think I would have to bake <code>once</code> into the API in order to enable garbage collection for events that use this combinator. The idea is that events can be garbage collected whenever: (a) they don&#39;t have an observable effect or (b) they cannot have occurrences anymore. The <code>once</code> combinator certainly satisfies (b), but an implementation in terms of <code>filter</code> cannot prove this to the run-time. Actually, could you make an issue about <code>once</code> (and your whole scenario) on github? This way, I won&#39;t forget to think about it when I get around to work on reactive-banana-0.9."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1421330484, "post_id": 27878929, "comment_id": 44323024, "body": "Ok, I thought it might need some primitive support to work due to being unable to do intensional analysis on <code>filter</code>. I&#39;ll go report that now - thanks!"}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 1, "creation_date": 1421485141, "post_id": 27878929, "comment_id": 44385369, "body": "Thanks for making the issue!"}], "tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 3, "last_activity_date": 1420910286, "creation_date": 1420910286, "answer_id": 27878929, "question_id": 27816012, "link": "https://stackoverflow.com/questions/27816012/performing-a-single-switch-in-reactive-banana/27878929#27878929", "title": "Performing a single switch in reactive-banana", "body": "<p>The problem is somewhat open ended, so I can't give a definite answer. But I can certainly give my opinion. ;-)</p>\n\n<p>However, what I would probably do is to separate the switching <em>between</em> modes from the behavior <em>within</em> a mode. If we forget about FRP for a moment, your program looks a bit like pair of functions that recursively call themselves:</p>\n\n<pre><code>defaultMode = ... `andthen` sectorMode\nsectorMode  = ... `andthen` defaultMode\n</code></pre>\n\n<p>It's written a bit like a \"sequential\" program, \"first do this mode, then do that mode\". I think there is nothing wrong with that, though the default API reactive-banana, in particular <code>switchB</code>, does not support that style very well. You mentioned (privately) that you can write a</p>\n\n<pre><code>once :: Event t a -&gt; Event t a\n</code></pre>\n\n<p>combinator that lets through the first occurrence of an event, but discards the rest. This is indeed what you would need for the sequential style.</p>\n\n<p>Since you always return to the default mode, though, I would probably try a different approach, where each mode has an event that indicates that it wants to be switched away. The switching itself is taken care of by an \"outside\" entity. The idea is to avoid the explicit recursion in the program above by some higher-order combinator. In pseudo-code, this would look something like this:</p>\n\n<pre><code>modeManager = switchB initialMode changeMode\nchangeMode  = defaultModeSwitch `union` sectorModeSwitch\n</code></pre>\n\n<p>though I am a bit unsure about the details. In fact, I'm not entirely sure if it works at all, you probably still need the <code>once</code> combinator.</p>\n\n<p>Anyway, that's just an idea on how to go about the switching. I fully agree that switching is the right way to deal with different modes.</p>\n"}], "owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 27878929, "answer_count": 1, "score": 6, "last_activity_date": 1420910286, "creation_date": 1420622375, "question_id": 27816012, "link": "https://stackoverflow.com/questions/27816012/performing-a-single-switch-in-reactive-banana", "title": "Performing a single switch in reactive-banana", "body": "<p>I'm building a multi-modal editor using <code>reactive-banana</code> - and for the most part it's going perfect. To expand on my scenario, the editor is some mapping software, or you could think of it as a very simple vector graphics editor. It currently has two states - <em>selection mode</em> and <em>polygon creation mode</em>. In selection mode, the user is able to select previously created polygons with the right mouse button (which would in theory take you to a new <em>selected mode</em>) or they can begin creating a new polygon with the left mouse button.</p>\n\n<p>The intention is, when the left mouse button is pressed, we switch from selection mode into polygon creation mode. In this mode, a left mouse button means \"add a new vertex\", until the user returns to the original vertex. At this point, they have closed the polygon, so we return to selection mode.</p>\n\n<p>I've implemented this a few different ways, and recently noticed that event switch almost makes this very elegant. I can have:</p>\n\n<pre><code>defaultMode :: Frameworks t =&gt; HadoomGUI -&gt; Moment t (Behavior t Diagram)\ndefaultMode gui@HadoomGUI{..} =\n  do mouseMoved &lt;- registerMotionNotify guiMap\n     mouseClicked &lt;- registerMouseClicked guiMap\n     let lmbClicked = ...\n         gridCoords = ...\n         diagram = ... \n     switchToCreateSector &lt;- execute ((\\m -&gt;\n                                         FrameworksMoment\n                                           (=&lt;&lt; trimB =&lt;&lt; createSectorMode gui emptySectorBuilder m)) &lt;$&gt;\n                                      (gridCoords &lt;@ lmbClicked))\n     return (switchB diagram switchToCreateSector)\n</code></pre>\n\n<p>Along with</p>\n\n<pre><code>createSectorMode :: Frameworks t\n                 =&gt; HadoomGUI\n                 -&gt; SectorBuilder\n                 -&gt; Point V2 Double\n                 -&gt; Moment t (Behavior t Diagram)\ncreateSectorMode HadoomGUI{..} initialSectorBuilder firstVertex =\n  do mouseClicked &lt;- registerMouseClicked guiMap\n     ...\n</code></pre>\n\n<p>This certainly works - for a single mouse click. If I click on the map once, I switch into sector creation mode from the state I was just in. However, if I click <em>again</em>, <code>defaultMode</code> receives the click event and switches into a <em>new</em> polygon creation mode, throwing away my previous state.</p>\n\n<p>What I'd like to do is switch in <code>defaultMode</code> once and never have the possibility of coming back. Essentially I want to \"swap\" the <code>Behavior t Diagram</code> produced by <code>defaultMode</code> with the result of <code>createSectorMode</code>.</p>\n\n<p>I understand <code>reactive-banana</code> has problems with garbage collection of dynamic events, but I'm willing to live with that for now. The above formulation is significantly more precise than anything else I've written so far - such as having a single <code>CurrentState</code> variable and filtering various events based on the contents of that. The problem I have with this is that it's too big, and leaves way too much scope for me to mess things up. With switching, I only have in scope the events I can about.</p>\n"}, {"tags": ["haskell", "generics", "type-systems", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "edited": false, "score": 1, "creation_date": 1420634698, "post_id": 27818445, "comment_id": 44045273, "body": "Great! A quick idea is that since <code>recordId</code> is a selector that selects a field at a certain <i>index</i>, it could be possible to extract which index it is, and combine it with the <code>selectors</code> function you described to get the right name and type. Is it impossible? (Or can it be easily addressed with Template Haskell?)"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "edited": false, "score": 1, "creation_date": 1420636360, "post_id": 27818445, "comment_id": 44046204, "body": "@Minoru without TH we can only see the type of a function. That is not enough in any case. <code>(const 0 :: Record -&gt; Int32)</code> has a right type but it&#39;s not a selector. As to TH, I guess we can quote a function name (e. g. `recordId) then look up where it was declared to see if it&#39;s a selector. But I&#39;m not very familiar with TH, unfortunately."}, {"owner": {"reputation": 1882, "user_id": 2882307, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ec8370b53eef1b4e53bccdcdf605a282?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2882307/john-smith"}, "edited": false, "score": 0, "creation_date": 1565108253, "post_id": 27818445, "comment_id": 101244943, "body": "@Andr&#225;sKov&#225;cs This has helped me immensily. Could you make a version which works with Type.Reflection as well?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 1882, "user_id": 2882307, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ec8370b53eef1b4e53bccdcdf605a282?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2882307/john-smith"}, "edited": false, "score": 1, "creation_date": 1565125636, "post_id": 27818445, "comment_id": 101252135, "body": "@JohnSmith I appended that to the answer"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 18, "last_activity_date": 1565125603, "last_edit_date": 1565125603, "creation_date": 1420630086, "answer_id": 27818445, "question_id": 27815489, "link": "https://stackoverflow.com/questions/27815489/is-it-possible-to-list-the-names-and-types-of-fields-in-a-record-data-type-that/27818445#27818445", "title": "Is it possible to list the names and types of fields in a record data type that derives Generic?", "body": "<h2>List all record fields</h2>\n\n<p>This one is very much possible, and it's indeed done by recursing on the structure of <code>Rep</code>, using a class. The solution below works for single-constructor types and returns empty string names for fields without selectors:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Data.ByteString (ByteString)\nimport Data.Data\nimport Data.Int\nimport Data.Proxy\nimport GHC.Generics\nimport qualified Data.ByteString as B\n\ndata Record = Record { recordId :: Int32, recordName :: ByteString }\n  deriving (Generic)\n\nclass Selectors rep where\n  selectors :: Proxy rep -&gt; [(String, TypeRep)]\n\ninstance Selectors f =&gt; Selectors (M1 D x f) where\n  selectors _ = selectors (Proxy :: Proxy f)\n\ninstance Selectors f =&gt; Selectors (M1 C x f) where\n  selectors _ = selectors (Proxy :: Proxy f)\n\ninstance (Selector s, Typeable t) =&gt; Selectors (M1 S s (K1 R t)) where\n  selectors _ =\n    [ ( selName (undefined :: M1 S s (K1 R t) ()) , typeOf (undefined :: t) ) ]\n\ninstance (Selectors a, Selectors b) =&gt; Selectors (a :*: b) where\n  selectors _ = selectors (Proxy :: Proxy a) ++ selectors (Proxy :: Proxy b)\n\ninstance Selectors U1 where\n  selectors _ = []\n</code></pre>\n\n<p>Now we can have:</p>\n\n<pre><code>selectors (Proxy :: Proxy (Rep Record))\n-- [(\"recordId\",Int32),(\"recordName\",ByteString)]\n</code></pre>\n\n<p>The least obvious part here is <code>selName</code> and <code>Selector</code>: this class can be found in <code>GHC.Generics</code>, and it allows us to extract the selector names from the generated selector types. In the case of <code>Record</code>, the representation is</p>\n\n<pre><code>:kind! Rep Record\nRep Record :: * -&gt; *\n= D1\n    Main.D1Record\n    (C1\n       Main.C1_0Record\n       (S1 Main.S1_0_0Record (Rec0 Int32)\n        :*: S1 Main.S1_0_1Record (Rec0 ByteString)))\n</code></pre>\n\n<p>and the selector types are <code>Main.S1_0_0Record</code> and <code>Main.S1_0_1Record</code>. We can only access these types by extracting them from the <code>Rep</code> type using classes or type families, because GHC doesn't export them. Anyway, <code>selName</code> gets us the selector name from any <code>M1</code> node with an <code>s</code> selector tag (it has a more general type <code>t s f a -&gt; String</code> but that doesn't concern us here).</p>\n\n<p>It's also possible to handle multiple constructors, and have <code>selectors</code> return <code>[[(String, TypeRep)]]</code>. In that case we would probably have two classes, one similar to the one above, used for extracting selectors from a given constructor, and another class for gathering the lists for constructors. </p>\n\n<h2>Inspect a record selector</h2>\n\n<p>It's easy to get the record type from a function:</p>\n\n<pre><code>class Magic f where\n  magic :: f -&gt; TypeRep\n\ninstance Typeable a =&gt; Magic (a -&gt; b) where\n  magic _ = typeOf (undefined :: a)\n</code></pre>\n\n<p>Or statically:</p>\n\n<pre><code>type family Arg f where\n   Arg (a -&gt; b) = a\n</code></pre>\n\n<p>However, without TH we can't know whether a function is a legitimate selector or just a function with the right type; they're indistinguishable in Haskell. There is no way to inspect the name \"recordId\" in <code>magic recordId</code>. </p>\n\n<hr>\n\n<p><strong>2019 update</strong>: selector extraction with GHC 8.6.5 and typed <code>TypeRep</code>s. We modernize the solution a bit by getting rid of proxies in favor of type applications. </p>\n\n<pre><code>{-# language\n  AllowAmbiguousTypes,\n  DeriveGeneric,\n  FlexibleContexts,\n  FlexibleInstances,\n  RankNTypes,\n  TypeApplications,\n  TypeInType\n  #-}\n\nimport Type.Reflection\nimport GHC.Generics\n\nclass Selectors rep where\n  selectors :: [(String, SomeTypeRep)]\n\ninstance Selectors f =&gt; Selectors (M1 D x f) where\n  selectors = selectors @f\n\ninstance Selectors f =&gt; Selectors (M1 C x f) where\n  selectors = selectors @f\n\ninstance (Selector s, Typeable t) =&gt; Selectors (M1 S s (K1 R t)) where\n  selectors =\n    [(selName (undefined :: M1 S s (K1 R t) ()) , SomeTypeRep (typeRep @t))]\n\ninstance (Selectors a, Selectors b) =&gt; Selectors (a :*: b) where\n  selectors = selectors @a ++ selectors @b\n\ninstance Selectors U1 where\n  selectors = []\n</code></pre>\n\n<p>Now the usage becomes <code>selectors @(Rep MyType)</code>. </p>\n"}], "owner": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1868, "favorite_count": 4, "accepted_answer_id": 27818445, "answer_count": 1, "score": 13, "last_activity_date": 1565125603, "creation_date": 1420620385, "last_edit_date": 1420627536, "question_id": 27815489, "link": "https://stackoverflow.com/questions/27815489/is-it-possible-to-list-the-names-and-types-of-fields-in-a-record-data-type-that", "title": "Is it possible to list the names and types of fields in a record data type that derives Generic?", "body": "<p>I know that for data types that derive Data.Data, <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Data.html#v:constrFields\" rel=\"noreferrer\"><code>constrFields</code></a> gives the list of field names. Looking at the GHC.Generics documentation, I think the same should be possible for <code>Generic</code> as well. (but miserably failed to figure out how to do it myself).</p>\n\n<p>More specifically, I am looking for two things:</p>\n\n<h2>List all record fields</h2>\n\n<p>... within a Haskell program. I knew that <a href=\"http://hackage.haskell.org/package/aeson\" rel=\"noreferrer\">aeson</a> is capable of automatically inferring the JSON representation of any record data type that derives <code>Generic</code>, but reading its source code only confirmed that I'm clueless here. From what I can guess, aeson must be able to obtain all field names (as <code>String</code>s or <code>ByteString</code>s) from a record data type, as well as their types (that has the type of something like <code>TypeRep</code> in Data.Typeable, or an instance of <code>Eq</code>: anything that can be used for <code>case</code> block pattern matching would do).</p>\n\n<p>I vaguely assume that creating a class and instances for <code>M1</code>, <code>:*:</code>, etc. is the way, but I couldn't make it to the type checker.</p>\n\n<h2>Inspect a record selector</h2>\n\n<p>To get the record data type it belongs to, the record field name (as <code>String</code>), etc.</p>\n\n<p>For example, given</p>\n\n<pre><code>data Record = Record\n    { recordId :: Int32\n    , recordName :: ByteString\n    } deriving Generic\n</code></pre>\n\n<p>A function <code>magic</code> that is like</p>\n\n<pre><code>typeOf (Record {}) == typeOf (magic recordId)\n</code></pre>\n\n<p>Are these possible with <code>deriving Generic</code>, or do I have to resort to Template Haskell?</p>\n"}, {"tags": ["haskell", "compilation", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 1306381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ce799013a7d92b9152b3d9a282ca67?s=128&d=identicon&r=PG", "display_name": "Kaiko Kaur", "link": "https://stackoverflow.com/users/1306381/kaiko-kaur"}, "edited": false, "score": 1, "creation_date": 1421286257, "post_id": 27846449, "comment_id": 44306055, "body": "Thank you Duncan. Then with (Haskell-written) shared library full ghc is needed and all used packages (from hackage) too. Is it really rare wish to have Haskell-written library without Haskell related libraries linked?"}], "tags": [], "owner": {"reputation": 786, "user_id": 359717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba3b7b9cc524c565c2e62b638005bea?s=128&d=identicon&r=PG", "display_name": "Duncan Coutts", "link": "https://stackoverflow.com/users/359717/duncan-coutts"}, "is_accepted": false, "score": 11, "last_activity_date": 1420739489, "creation_date": 1420739489, "answer_id": 27846449, "question_id": 27815467, "link": "https://stackoverflow.com/questions/27815467/haskell-dynamic-library/27846449#27846449", "title": "Haskell dynamic library", "body": "<p>Since Kaiko contacted me privately for an answer, might as well post it here...</p>\n\n<h2>Short version</h2>\n\n<p>By omitting -dynamic you would be trying to take all the static .a libs and link them into one massive .so file. Those .a libs were themselves built without -fPIC. All code that ends up on a .so file must be built with -fPIC (at least on ELF x86-64). Thus the linking would fail in this case because -fPIC is required but the libs were not built with -fPIC.</p>\n\n<h2>Long version</h2>\n\n<p>There are a few things that vary between different ways of building\nstatic and dynamic libraries:</p>\n\n<ol>\n<li>Is it built as a .a archive or as a .so (or .dll/.dynlib) object?</li>\n<li>Is it built with -fPIC, position independent code or not?</li>\n<li>Are external symbols expected to be in the same DSO or an external DSO?</li>\n</ol>\n\n<p>In principle, lots of different combinations of these things make sense\nbut in practice only a few are used.</p>\n\n<p>On Linux (ELF), there are two standard approaches to building libraries,\nfully static and fully dynamic. In the fully static approach the answer\nto question 1,2,3 above are: .a archive, no -fPIC, same DSO. In the\nfully dynamic approach the answers are: .so lib, -fPIC, external DSO.</p>\n\n<p>Now what you want to do is different. You want all libraries to be built\nas .a files, but with -fPIC and external symbols expected to be in the\nsame DSO. This would then let you link all those libraries together into\none huge shared library. So the crucial difference is the use of -fPIC,\nsince on ELF (specifically x86_64) code that ends up in a shared lib\nmust be built with -fPIC.</p>\n\n<p>By contrast, on Windows, GHC can do exactly what you want, to link all\nthe Haskell libs (including the RTS etc) into one massive shared lib\n(.dll). This is because on Windows (unlike ELF), position independent\ncode does not matter. So on Windows, one is able to take the static\nlibraries and link them into a big shared library.</p>\n\n<p>In principle this should also be possible on Linux, if all of the\nHaskell libraries were built statically but with -fPIC. This is not the\ndefault, and that is the immediate reason why you cannot omit -dynamic\nin this case on Linux.</p>\n\n<p>So in principle, one could try rebuilding ghc and the core libraries\nfrom source using the -fPIC flag and then see if it then works to omit\n-dynamic and link everything into one huge shared lib.</p>\n"}, {"comments": [{"owner": {"reputation": 7245, "user_id": 867208, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73ff2469d25f133355be32507631ee40?s=128&d=identicon&r=PG", "display_name": "valderman", "link": "https://stackoverflow.com/users/867208/valderman"}, "edited": false, "score": 0, "creation_date": 1557439498, "post_id": 28131655, "comment_id": 98776097, "body": "This worked for me with GHC 8.6.5, but I needed to add <code>-fPIC</code> to <code>GhcLibHcOpts</code> as well when building GHC. When building static/dynamic mixed, I also had to add <code>-lrt</code>, but did <i>not</i> have to explicitly specify any Haskell libraries apart from <code>-lHSrts</code> and <code>-lCffi</code>."}], "tags": [], "owner": {"reputation": 331, "user_id": 1306381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ce799013a7d92b9152b3d9a282ca67?s=128&d=identicon&r=PG", "display_name": "Kaiko Kaur", "link": "https://stackoverflow.com/users/1306381/kaiko-kaur"}, "is_accepted": true, "score": 4, "last_activity_date": 1422143729, "creation_date": 1422143729, "answer_id": 28131655, "question_id": 27815467, "link": "https://stackoverflow.com/questions/27815467/haskell-dynamic-library/28131655#28131655", "title": "Haskell dynamic library", "body": "<p>Yes, compiling with -fPIC helps. Here is how to do that.</p>\n\n<p><code>ghc-7.8.4/mk/build.mk</code>:</p>\n\n<pre><code> SRC_HC_OPTS     = -H64m -O \n EXTRA_HC_OPTS   = -fPIC    \n SRC_CC_OPTS     = -fPIC -O \n GhcStage1HcOpts = -fasm -O0\n GhcStage2HcOpts = -fasm -O0\n GhcLibHcOpts    = -fasm -O2\n GhcLibWays      = v dyn    \n DYNAMIC_GHC_PROGRAMS = YES \n DYNAMIC_BY_DEFAULT   = NO  \n SplitObjs            = NO  \n HADDOCK_DOCS         = NO  \n BUILD_DOCBOOK_HTML   = NO  \n BUILD_DOCBOOK_PS     = NO  \n BUILD_DOCBOOK_PDF    = NO  \n</code></pre>\n\n<p>While you compile ghc:</p>\n\n<pre><code>export EXTRA_CONFIGURE_OPTS=\"--disable-library-profiling --enable-shared\"\n</code></pre>\n\n<p>To build cabal packages with -fPIC use:</p>\n\n<pre><code>cabal install --enable-shared --ghc-option=-fPIC text\n</code></pre>\n\n<p>Test file <code>foo.hs</code> (Data.Text is used to see if cabal packages also work):</p>\n\n<pre><code>import Foreign.C as C \nimport Data.Text as T\nimport Data.Text.Foreign as T \nforeign export ccall   len :: CString -&gt; IO CInt \nlen t = C.peekCString t &gt;&gt;= return . CInt . fromIntegral . T.length . T.pack  \nmain = return ()\n</code></pre>\n\n<p>Dynamic build:</p>\n\n<pre><code>ghc -dynamic --make foo.hs\n</code></pre>\n\n<p>Dynamic mixed with static build (not sure if pthread is needed but it illustrates how to add dynamic linking):</p>\n\n<pre><code>ghc -fPIC -shared --make -o libfoo.so \\\n -optl-Wl,-Bstatic -lHSrts -lCffi \\\n   -lHSbase-4.7.0.2 -lHSinteger-gmp-0.5.1.0 -lHSghc-prim-0.3.1.0 \\\n-optl-Wl,-Bdynamic -lpthread foo.hs\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 1306381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ce799013a7d92b9152b3d9a282ca67?s=128&d=identicon&r=PG", "display_name": "Kaiko Kaur", "link": "https://stackoverflow.com/users/1306381/kaiko-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2896, "favorite_count": 3, "accepted_answer_id": 28131655, "answer_count": 2, "score": 8, "last_activity_date": 1422143729, "creation_date": 1420620308, "last_edit_date": 1420620730, "question_id": 27815467, "link": "https://stackoverflow.com/questions/27815467/haskell-dynamic-library", "title": "Haskell dynamic library", "body": "<p><a href=\"http://www.vex.net/~trebla/haskell/so.xhtml\">http://www.vex.net/~trebla/haskell/so.xhtml</a> describes how to compile shared library.</p>\n\n<p>About compiling command:</p>\n\n<pre><code>ghc -O2 -dynamic -shared -fPIC -o libEval.so Eval.hs hsbracket.c -lHSrts-ghc7.6.3\n</code></pre>\n\n<p>it says:</p>\n\n<blockquote>\n  <p>(Could you omit -dynamic to request static libraries of other packages? Not really, they were not generated with -fPIC. In particular it is illegal on x86_64.)</p>\n</blockquote>\n\n<p>Why is it so? What should one do to compile shared library without libHS* dependencies?</p>\n"}, {"tags": ["c++", "haskell", "types", "c++14", "generic-lambda"], "comments": [{"owner": {"reputation": 5903, "user_id": 1387612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3ybF.png?s=128&g=1", "display_name": "janisz", "link": "https://stackoverflow.com/users/1387612/janisz"}, "edited": false, "score": 0, "creation_date": 1420617311, "post_id": 27814714, "comment_id": 44036096, "body": "when you replace <code>auto</code> with some type e.g. <code>int</code> compiler should tell you that it cannot infer types and give they names. But I haven&#39;t tested it"}, {"owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "reply_to_user": {"reputation": 5903, "user_id": 1387612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3ybF.png?s=128&g=1", "display_name": "janisz", "link": "https://stackoverflow.com/users/1387612/janisz"}, "edited": false, "score": 0, "creation_date": 1420617445, "post_id": 27814714, "comment_id": 44036122, "body": "but why could g++ infer the right type of my fac function?"}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 0, "creation_date": 1420617480, "post_id": 27814714, "comment_id": 44036138, "body": "<code>fac</code> in this is a generic lambda, which acts like a functor with a templated <code>operator()</code>. Note that these are new for c++14."}, {"owner": {"reputation": 5903, "user_id": 1387612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3ybF.png?s=128&g=1", "display_name": "janisz", "link": "https://stackoverflow.com/users/1387612/janisz"}, "edited": false, "score": 0, "creation_date": 1420618928, "post_id": 27814714, "comment_id": 44036638, "body": "Here is nice answer that might be helpful <a href=\"http://stackoverflow.com/a/17233649/1387612\">How does generic lambda work in C++14?</a>"}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 1, "creation_date": 1420642236, "post_id": 27814714, "comment_id": 44049729, "body": "As a side note, a better way to write the Haskell version is to split it into the recursive bit (namely and generically, <code>fix :: (a -&gt; a) -&gt; a</code> with <code>fix f = f (fix f)</code>) and the non-recursive bit. The non-recursive bit is <code>fact1 recur n = if n == 0 then 1 else n * recur (n-1)</code> and you&#39;ll notice that this (a) is not recursive, (b) has a finite and inferable type <code>fact1 :: (Int -&gt; Int) -&gt; (Int -&gt; Int)</code>, and (c) implements a single &quot;step&quot; of factorial. We then just &quot;complete&quot; it by combining the recursive and non-recursive bits: <code>fact = fix fact1</code>."}, {"owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "reply_to_user": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1420647309, "post_id": 27814714, "comment_id": 44053233, "body": "@J.Abrahamson you mean the Y combinator. I know that"}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 2, "creation_date": 1420664392, "post_id": 27814714, "comment_id": 44063027, "body": "Well, I would not call <code>fix</code> the Y combinator. It has the same effect, but there are many fixed point combinators of which <code>Y</code> and <code>fix</code> are just two examples."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1423069515, "post_id": 27814714, "comment_id": 45001957, "body": "This isn&#39;t so relevant, but you can write your <code>Y</code> type as a <code>newtype</code> instead of <code>data</code>, which leads to a more efficient runtime representation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1423069790, "post_id": 27814714, "comment_id": 45002118, "body": "Also note that there is a pre-made version of <code>fix</code> in <code>Data.Function</code> defined as <code>fix f = let x = f x in x</code>. I <i>think</i> this is designed to save memory and/or time in certain situations, but I don&#39;t know the details."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1423070269, "post_id": 27814714, "comment_id": 45002449, "body": "Oh yes, I remember now: the definition in <code>Data.Function</code> makes <code>fix (1:)</code> a circularly linked list instead of an infinite list, and similarly for some other such things. It lets you tie data structures up in knots, whereas the more obvious <code>fix f = f (fix f)</code> does not."}], "answers": [{"tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 6, "last_activity_date": 1420618030, "last_edit_date": 1420618030, "creation_date": 1420617627, "answer_id": 27814829, "question_id": 27814714, "link": "https://stackoverflow.com/questions/27814714/what-is-the-type-of-this-self-applying-factorial-function/27814829#27814829", "title": "What is the type of this self-applying factorial function?", "body": "<p>The expression following <code>auto fac =</code> is a lambda expression, and the compiler will automatically generate a closure object from it. The type of that object is unique and known only to the compiler.</p>\n\n<p>From N4296, <em>\u00a75.1.2/3</em> <strong>[expr.prim.lambda]</strong></p>\n\n<blockquote>\n  <p>The type of the <em>lambda-expression</em> (which is also the type of the closure object) is a unique, unnamed non-union class type \u2014 called the <em>closure type</em> \u2014 whose properties are described below. This class type is neither an aggregate (8.5.1) nor a literal type (3.9). The closure type is declared in the smallest block scope, class scope, or namespace scope that contains the corresponding <em>lambda-expression</em>.</p>\n</blockquote>\n\n<p>Note that because of this, even two identical lambda expressions will have distinct types. For example,</p>\n\n<pre><code>auto l1 = []{};\nauto l2 = []{}; // l1 and l2 are of different types\n</code></pre>\n\n<hr>\n\n<p>Your lambda expression is a C++14 generic lambda, and will be translated by the compiler to a class that resembles the following:</p>\n\n<pre><code>struct __unique_name\n{\n    template&lt;typename Arg1, typename Arg2&gt;\n    auto operator()(Arg1 self, Arg2 n) const\n    { \n        // body of your lambda\n    }\n};\n</code></pre>\n\n<p>I cannot comment on the Haskell part, but the reason the recursive expression works in C++ is because you're simply passing a copy of the closure object instance (<code>fac</code>) in each call. The <code>operator()</code> being a template is able to deduce the type of the lambda even though it is not one you can name otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 27, "last_activity_date": 1423052032, "last_edit_date": 1423052032, "creation_date": 1420621219, "answer_id": 27815705, "question_id": 27814714, "link": "https://stackoverflow.com/questions/27814714/what-is-the-type-of-this-self-applying-factorial-function/27815705#27815705", "title": "What is the type of this self-applying factorial function?", "body": "<p>The C++ <code>fac</code> isn't really a function, but a struct which has a member function.</p>\n\n<pre><code>struct aaaa // Not its real name.\n{\n    template&lt;typename a, typename b&gt;\n    auto operator()(a self, b n) const\n    { \n    }\n};\n</code></pre>\n\n<p>The overloaded call operator hides some of the trickery that C++ performs in order to implement \"lambda functions\"</p>\n\n<p>When you \"call\" <code>fac</code>, what happens is</p>\n\n<pre><code>fac.operator() (fac, 3);\n</code></pre>\n\n<p>so the argument to the function isn't the function itself, but an object which has it as a member.<br>\nOne effect of this is that the function's type (i.e. the type of <code>operator()</code>) does not occur in the type of the <code>operator()</code> function itself.<br>\n(The type of <code>self</code> is the struct that defines the function.)</p>\n\n<p>The template part isn't necessary for this to work; this is a non-generic version of the <code>fac</code> \"function\":</p>\n\n<pre><code>struct F\n{\n    int operator()(const F&amp; self, int n) const\n    { \n        // ...\n    }\n};\n\nF fac;\nfac(fac, 3);\n</code></pre>\n\n<p>If we keep the template and rename <code>operator()</code> to <code>applY</code>:</p>\n\n<pre><code>// The Y type\ntemplate&lt;typename a&gt;\nstruct Y\n{\n    // The wrapped function has type (Y&lt;a&gt;, a) -&gt; a\n    a applY(const Y&lt;a&gt;&amp; self, a n) const\n    { \n        if(n &lt; 1)\n            return 1;\n        else \n            return n * self.applY(self, n-1);\n    }\n};\n\ntemplate&lt;typename a&gt;\na fac(a n)\n{\n    Y&lt;a&gt; y;\n    return y.applY(y, n);\n}\n</code></pre>\n\n<p>we see that your working Haskell program and your C++ program are very similar - the differences are mainly punctuation.</p>\n\n<p>In contrast, in Haskell</p>\n\n<pre><code>fac2 self 0 = 1\nfac2 self n = n * (self self $ n-1)\n</code></pre>\n\n<p><code>self</code> <em>is</em> a function, and <code>fac2</code>'s type would have to be</p>\n\n<pre><code>X -&gt; Int -&gt; Int\n</code></pre>\n\n<p>for some <code>X</code>.<br>\nSince <code>self</code> is a function, and <code>self self $ n-1</code> is an Int, <code>self</code>'s type is also <code>X -&gt; Int -&gt; Int</code>.</p>\n\n<p>But what could <code>X</code> be?<br>\nIt must be the same as the type of <code>self</code> itself, i.e <code>X -&gt; Int -&gt; Int</code>.<br>\nBut that means that the type of <code>self</code> is (substituting for <code>X</code>):</p>\n\n<pre><code>(X -&gt; Int -&gt; Int) -&gt; Int -&gt; Int  \n</code></pre>\n\n<p>so the type <code>X</code> must also be</p>\n\n<pre><code>(X -&gt; Int -&gt; Int) -&gt; Int -&gt; Int  \n</code></pre>\n\n<p>so <code>self</code>'s type must be</p>\n\n<pre><code>((X -&gt; Int -&gt; Int) -&gt; Int -&gt; Int) -&gt; Int -&gt; Int\n</code></pre>\n\n<p>and so on, ad infinitum.<br>\nThat is, in Haskell the type would be infinite.</p>\n\n<p>Your solution for Haskell essentially explicitly introduces the necessary indirection that C++ generates through its structure with a member function.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 15, "last_activity_date": 1420627702, "last_edit_date": 1420627702, "creation_date": 1420627207, "answer_id": 27817553, "question_id": 27814714, "link": "https://stackoverflow.com/questions/27814714/what-is-the-type-of-this-self-applying-factorial-function/27817553#27817553", "title": "What is the type of this self-applying factorial function?", "body": "<p>As others pointed out, the lambda acts as a structure involving a template. The question then becomes: why Haskell can not type the self-application, while C++ can? </p>\n\n<p>The answer lies on the difference between C++ templates and Haskell polymorphic functions. Compare these:</p>\n\n<pre><code>-- valid Haskell\nfoo :: forall a b. a -&gt; b -&gt; a\nfoo x y = x\n\n// valid C++\ntemplate &lt;typename a, typename b&gt;\na foo(a x, b y) { return x; }\n</code></pre>\n\n<p>While they might look nearly equivalent, they are not really such. </p>\n\n<p>When Haskell type checks the above declaration, it checks that the definition is type safe for any types <code>a,b</code>. That is, if we substitute <code>a,b</code> with any two types, the function must be well-defined.</p>\n\n<p>C++ follows another approach. At template definition, it is not checked that any substitution for <code>a,b</code> will be correct. This check is <em>deferred</em> to the point of use of the template, i.e. at instantiation time. To stress the point, let's add a <code>+1</code> in our code:</p>\n\n<pre><code>-- INVALID Haskell\nfoo :: forall a b. a -&gt; b -&gt; a\nfoo x y = x+1\n\n// valid C++\ntemplate &lt;typename a, typename b&gt;\na foo(a x, b y) { return x+1; }\n</code></pre>\n\n<p>The Haskell definition will not type check: there's no guarantee you can perform <code>x+1</code> when <code>x</code> is of an arbitrary type. The C++ code is fine, instead. The fact that some substitutions of <code>a</code> lead to incorrect code is irrelevant right now.</p>\n\n<p>Deferring this check causes some \"infinitely-typed values\" to be allowed, roughly. Dynamic languages such as Python or Scheme further defer these type errors until run-time, and of course will handle self-application just fine.</p>\n"}], "owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 1, "accepted_answer_id": 27814829, "answer_count": 3, "score": 25, "last_activity_date": 1423052032, "creation_date": 1420617039, "last_edit_date": 1420630087, "question_id": 27814714, "link": "https://stackoverflow.com/questions/27814714/what-is-the-type-of-this-self-applying-factorial-function", "title": "What is the type of this self-applying factorial function?", "body": "<p>I wrote an anonymous factorial function in C++ and compiled my code with g++4.9.2.\nIt works well. However, I don't know the type of my function.</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;functional&gt;\nusing std::function;\nint main()\n{\n    //tested at g++ 4.9.2\n    //g++ -std=c++1y -o anony anony.cpp\n    auto fac = [](auto self,auto n)-&gt;auto{\n        if(n &lt; 1)\n            return 1;\n        else \n            return n * self(self,n-1);\n    };\n    std::cout&lt;&lt;fac(fac,3)&lt;&lt;std::endl;//6\n    return 0;\n}\n</code></pre>\n\n<p>So, I wonder: what are the types of <code>fac</code> and <code>self</code>?\nIf I just translate the C++ code into Haskell, it won't compile because\nit involves infinite types:</p>\n\n<pre><code>fac2 self 0 = 1\nfac2 self n = n * (self self $ n-1)\n</code></pre>\n\n<p>and I have to define some recursive type  work around it:</p>\n\n<pre><code>data Y a = Y ((Y a)-&gt;a-&gt;a)\nfac2 self 0 = 1\nfac2 self n = n * ((applY self self) (n-1))\n    where applY (Y f1) f2 = f1 f2\nfact2 = fac2 $ Y fac2\n</code></pre>\n\n<p>So, why could g++ get exactly the right type of the <code>fac</code> function, and what type does g++ think the <code>fac</code> function is?</p>\n"}, {"tags": ["forms", "haskell", "yesod"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 1, "creation_date": 1420613242, "post_id": 27813267, "comment_id": 44034599, "body": "As far as general web solutions go, I would either store the data from form 1 in a hidden field of form 2 (that way when form 2 is submitted, you have the data from both forms) or I would combine both parts into one form and use Javascript show part 2 of the form after they do part 1."}, {"owner": {"reputation": 38, "user_id": 4427526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7926183b27c70b60e7ed8be8ded3577?s=128&d=identicon&r=PG&f=1", "display_name": "AdamCS", "link": "https://stackoverflow.com/users/4427526/adamcs"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1420678154, "post_id": 27813267, "comment_id": 44068398, "body": "Thanks! I think my data structures are too complicated for hidden fields to work easily but even if they weren&#39;t, how would that work?  I need to give the data (the recordInfo) as an argument to runFormPost before I can get the data so having the data in the form isn&#39;t much help.  I think the javascript idea could work though it would also need ajax since the later fields depend on (the server) parsing the chosen files.  But I think I&#39;d rather learn how to use a DB rather than all the javascript and ajax.  At least for now..."}], "owner": {"reputation": 38, "user_id": 4427526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7926183b27c70b60e7ed8be8ded3577?s=128&d=identicon&r=PG&f=1", "display_name": "AdamCS", "link": "https://stackoverflow.com/users/4427526/adamcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420614403, "creation_date": 1420610295, "last_edit_date": 1420614403, "question_id": 27813267, "link": "https://stackoverflow.com/questions/27813267/parametrized-forms-in-yesod", "title": "Parametrized forms in Yesod", "body": "<p>I'm trying to create a pair of forms in a (scaffolded) Yesod setup where:\n form 1 allows a user to choose a file.  That file is parsed into a set of records and then the user is given\n  form 2 which has a selectFieldList for choosing a record.</p>\n\n<p>So I have</p>\n\n<pre><code>form2::[(Text,Record)]-&gt;Form Record\nform2 recordInfo = ...\n</code></pre>\n\n<p>which is fine for when I generate it (<code>generateFormPost $ form2 recordInfo</code>) .  But to process the result, I will be in a different handler and I no longer have the list of <code>(Text,Record)</code> pairs to give to the <code>form2</code> function in order to execute <code>runFormPost</code> (<code>runFormPost $ form2 ??</code>).  So I can't get the data from the form. </p>\n\n<p>I realize this is a consequence of the statelessness of the RESTful web.  And I realize there are some ways out of this.  I could use persistent and hand some sort of key to the handler so it knows where to get the <code>(Text,Record)</code> data.  Or I could use session somehow?  Or cookies?</p>\n\n<p>This web stuff is new to me so before I launch in a silly direction, I was wondering if there is a simple answer I am missing and, if not, what is the \"right\" way to handle forms that depend on dynamic data in this way?</p>\n"}, {"tags": ["haskell", "llvm", "ghc", "cabal", "cabal-install"], "answers": [{"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 2, "last_activity_date": 1420664660, "creation_date": 1420664660, "answer_id": 27828612, "question_id": 27810715, "link": "https://stackoverflow.com/questions/27810715/compiling-a-cabal-project-with-llvm-on-ghc-7-10-rc1/27828612#27828612", "title": "Compiling a cabal project with LLVM on GHC 7.10 RC1", "body": "<p>I guess I needed <code>--disable-shared</code>:</p>\n\n<pre><code>cabal configure -w /usr/local/bin/ghc-7.10.0.20141222  --enable-tests --enable-benchmarks --ghc-option=-fllvm --ghc-option=-static --disable-shared\n</code></pre>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 27828612, "answer_count": 1, "score": 0, "last_activity_date": 1420664660, "creation_date": 1420598821, "last_edit_date": 1420651365, "question_id": 27810715, "link": "https://stackoverflow.com/questions/27810715/compiling-a-cabal-project-with-llvm-on-ghc-7-10-rc1", "title": "Compiling a cabal project with LLVM on GHC 7.10 RC1", "body": "<p>I've tried:</p>\n\n<pre><code>$ cabal install --only-dependencies -w /usr/local/bin/ghc-7.10.0.20141222  --enable-tests --enable-benchmarks --ghc-option=-fllvm --ghc-option=-static\n$ cabal configure -w /usr/local/bin/ghc-7.10.0.20141222  --enable-tests --enable-benchmarks --ghc-option=-fllvm --ghc-option=-static\n$ cabal build   \nBuilding unagi-chan-0.3.0.0...\nPreprocessing library unagi-chan-0.3.0.0...\n\nwhen making flags consistent: Warning:\n    Using native code generator rather than LLVM, as LLVM is incompatible with -fPIC and -dynamic on this platform\n</code></pre>\n\n<p>I don't see anything referencing \"PIC\" in the output of <code>cabal build -v</code>.</p>\n"}, {"tags": ["haskell", "swift", "functional-programming"], "comments": [{"owner": {"reputation": 38822, "user_id": 3925941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3f76eac79606d705426bcc267dc01?s=128&d=identicon&r=PG", "display_name": "Airspeed Velocity", "link": "https://stackoverflow.com/users/3925941/airspeed-velocity"}, "edited": false, "score": 1, "creation_date": 1420588825, "post_id": 27809298, "comment_id": 44027683, "body": "Can you include the code for <code>flatten</code> to make it easier to reproduce?"}], "answers": [{"tags": [], "owner": {"reputation": 38822, "user_id": 3925941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3f76eac79606d705426bcc267dc01?s=128&d=identicon&r=PG", "display_name": "Airspeed Velocity", "link": "https://stackoverflow.com/users/3925941/airspeed-velocity"}, "is_accepted": false, "score": 1, "last_activity_date": 1420590143, "last_edit_date": 1420590143, "creation_date": 1420589759, "answer_id": 27809501, "question_id": 27809298, "link": "https://stackoverflow.com/questions/27809298/sequencetype-of-functions/27809501#27809501", "title": "SequenceType of functions", "body": "<p>Couple of problems (one fixable, one more fatal):</p>\n\n<p>You have the syntax for the generic template a bit off.  There\u2019s only one where clause for all the placeholders, rather than an optional one per placeholder.  So it would be more like:</p>\n\n<pre><code>public func &lt;*&gt; &lt;\n    T, U, Tseq: SequenceType, Fseq: SequenceType\n    where Fseq.enerator.Element == T -&gt; U,\n          Tseq.Generator.Element == T&gt;\n    (left:[(T)-&gt;U], right:Tseq) -&gt; [U] {\n        return flatten(map(left) { (function) -&gt; [U] in\n            return map(right) { return function($0) }\n            })\n}\n</code></pre>\n\n<p>However, that still won\u2019t work because you can\u2019t have expressions more complex than single types on the rhs of a <code>==</code> (not even tuples of two placeholders).  So <code>where Fseq.Generator.Element == T-&gt;U</code> is not going to fly.</p>\n\n<p>You might want to look at how <a href=\"https://github.com/typelift/swiftz/blob/master/swiftz/IxState.swift#L68-74\" rel=\"nofollow\">swiftz</a> does this \u2013 looks like it requires an additional struct.</p>\n"}], "owner": {"reputation": 39364, "user_id": 3203487, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/642430374fe647174b3e8bc33cdfc049?s=128&d=identicon&r=PG&f=1", "display_name": "David Berry", "link": "https://stackoverflow.com/users/3203487/david-berry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420590143, "creation_date": 1420588365, "question_id": 27809298, "link": "https://stackoverflow.com/questions/27809298/sequencetype-of-functions", "title": "SequenceType of functions", "body": "<p>I have a swift implementation of the haskell &lt;*> operator that seems to work as long as the arguments are arrays:</p>\n\n<pre><code>public func &lt;*&gt; &lt;T, U&gt;(left:[(T)-&gt;U], right:[T]) -&gt; [U] {\n    return flatten(map(left) { (function) -&gt; [U] in\n        return map(right) { return function($0) }\n    })\n}\n</code></pre>\n\n<p>I'm trying to make it more general by rewriting it to use sequences instead of arrays, but I'm having difficulty with the syntax to require that a sequence be a sequence of functions.  This works to generalize the right argument, but not the left:</p>\n\n<pre><code>public func &lt;*&gt; &lt;T, U, Tseq:SequenceType where Tseq.Generator.Element == T&gt;(left:[(T)-&gt;U], right:Tseq) -&gt; [U] {\n    return flatten(map(left) { (function) -&gt; [U] in\n        return map(right) { return function($0) }\n    })\n}\n</code></pre>\n\n<p>Now I'm trying to generalize the left part, but running into syntax errors.  It seems like it ought to be:</p>\n\n<pre><code>public func &lt;*&gt; &lt;\n    T,\n    U,\n    Tseq:SequenceType where Tseq.Generator.Element == T,\n    Fseq:SequenceType where Fseq.Generator.Element == (T) -&gt; U\n    &gt;(left:[(T)-&gt;U], right:Tseq) -&gt; [U] {\n    return flatten(map(left) { (function) -&gt; [U] in\n        return map(right) { return function($0) }\n    })\n}\n</code></pre>\n\n<p>But that gives me an error on the Fseq... line:</p>\n\n<pre><code>Expected '&gt;' to complete generic parameter list\n</code></pre>\n\n<p>What is the proper syntax (or is there no proper syntax) to require that Fseq.Generator.Element be a function taking a T and returning a U?</p>\n"}, {"tags": ["haskell", "combinations"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420635058, "post_id": 27808947, "comment_id": 44045463, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/27229899/generate-a-truth-table-of-arbitrary-length-haskell\">Generate a truth table of arbitrary length haskell</a>"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1420586755, "creation_date": 1420586755, "answer_id": 27809036, "question_id": 27808947, "link": "https://stackoverflow.com/questions/27808947/haskell-combination-of-number-and-bool/27809036#27809036", "title": "Haskell combination of number and bool", "body": "<pre><code>b1 n = sequence $ replicate n [False,True]\n\nb2 xs = map (zip xs) (b1 (length xs))\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>*Main&gt; b2 [1,2]\n[[(1,False),(2,False)],[(1,False),(2,True)],[(1,True),(2,False)],[(1,True),(2,True)]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1420592653, "post_id": 27809052, "comment_id": 44028647, "body": "Or: <code>f = mapM (\\x -&gt; [(x, False), (x, True)])</code>."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 5, "last_activity_date": 1420586810, "creation_date": 1420586810, "answer_id": 27809052, "question_id": 27808947, "link": "https://stackoverflow.com/questions/27808947/haskell-combination-of-number-and-bool/27809052#27809052", "title": "Haskell combination of number and bool", "body": "<p>The list monad might be the easiest to understand:</p>\n\n<pre><code>f xs = do\n    bs &lt;- replicateM (length xs) [False, True]  -- Obtain |xs| elements from the set of all possible booleans\n    return (zip xs bs)                          -- Pair the elements of each list\n</code></pre>\n\n<p>With a result of:</p>\n\n<pre><code>Prelude Control.Monad&gt; f [1,2]\n[[(1,False),(2,False)],[(1,False),(2,True)],[(1,True),(2,False)],[(1,True),(2,True)]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1420647146, "creation_date": 1420647146, "answer_id": 27823655, "question_id": 27808947, "link": "https://stackoverflow.com/questions/27808947/haskell-combination-of-number-and-bool/27823655#27823655", "title": "Haskell combination of number and bool", "body": "<p>with list comprehensions</p>\n\n<pre><code>[zip [1..] [x,y] | x&lt;-[True,False], y&lt;-[True,False]]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4400821, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/071934f389c2b84225ea46908db092bc?s=128&d=identicon&r=PG&f=1", "display_name": "overpro", "link": "https://stackoverflow.com/users/4400821/overpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 27809052, "answer_count": 3, "score": 0, "last_activity_date": 1420647146, "creation_date": 1420586343, "last_edit_date": 1420590314, "question_id": 27808947, "link": "https://stackoverflow.com/questions/27808947/haskell-combination-of-number-and-bool", "title": "Haskell combination of number and bool", "body": "<p>In Haskell, when I input a list of ordered number, how can I make a list which has all the possible combination of the number and the bool(either True or False) ? </p>\n\n<p>for example\nwhen I input [1,2]<br>\nthe output is:</p>\n\n<pre><code>[ [(1,False),(2,False)]\n, [(1,False),(2,True)]\n, [(1,True),(2,False)]\n, [(1,True), (2,True)] ]\n</code></pre>\n"}, {"tags": ["haskell", "swift", "functional-programming"], "comments": [{"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 5, "creation_date": 1420582897, "post_id": 27808198, "comment_id": 44025452, "body": "In Haskell you might use a list comprehension: <code>[Card s r | s &lt;- suits, r &lt;- ranks]</code>. You could also take advantage of the fact that list is an Applicative and write <code>Card &lt;$&gt; suits &lt;*&gt; ranks</code> though the reason that works is a bit far from obvious to start."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 1, "creation_date": 1420583143, "post_id": 27808198, "comment_id": 44025571, "body": "The above translates to <code>concat (concat (map (\\suit -&gt; map (\\rank -&gt; Card rank suit) ranks) suits))</code>, btw, which might be more directly implementable in Swift."}, {"owner": {"reputation": 797, "user_id": 1133236, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06d1fcb66a053e29095f12fbe3180a75?s=128&d=identicon&r=PG&f=1", "display_name": "Sinisa Drpa", "link": "https://stackoverflow.com/users/1133236/sinisa-drpa"}, "reply_to_user": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1420583273, "post_id": 27808198, "comment_id": 44025647, "body": "Haskell is much more concise, unfortunately in Swift there is no similar grammar. I wrote above after watching Haskell tutorials then I implemented few simple Haskell func. in swift (head, drop ...) to try if I can do it in swift, but in swift it&#39;s much more verbose."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1421612462, "post_id": 27808198, "comment_id": 44415951, "body": "Which is the most readable/understandably by others? That is the metric that decides good code."}], "answers": [{"comments": [{"owner": {"reputation": 797, "user_id": 1133236, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06d1fcb66a053e29095f12fbe3180a75?s=128&d=identicon&r=PG&f=1", "display_name": "Sinisa Drpa", "link": "https://stackoverflow.com/users/1133236/sinisa-drpa"}, "edited": false, "score": 0, "creation_date": 1420588107, "post_id": 27809058, "comment_id": 44027452, "body": "Thank you. It works correctly! I haven&#39;t heard of &quot;Haskell&#39;s applicative concept&quot;, I&#39;ve just started &quot;Learn You a Haskell, for Great Good&quot;. Will check it now."}], "tags": [], "owner": {"reputation": 39364, "user_id": 3203487, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/642430374fe647174b3e8bc33cdfc049?s=128&d=identicon&r=PG&f=1", "display_name": "David Berry", "link": "https://stackoverflow.com/users/3203487/david-berry"}, "is_accepted": true, "score": 5, "last_activity_date": 1420586840, "creation_date": 1420586840, "answer_id": 27809058, "question_id": 27808198, "link": "https://stackoverflow.com/questions/27808198/functional-thinking-in-swift/27809058#27809058", "title": "Functional thinking in Swift?", "body": "<p>Building on the usage of Haskell's applicative concept and <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code> you might find the following generally useful (I think I've translated correctly, although it's based on arrays not sequences):</p>\n\n<pre><code>// use &lt;^&gt; because &lt;$&gt; is already used\ninfix operator &lt;^&gt; { associativity left }\npublic func &lt;^&gt; &lt;T, U&gt;(left:(T)-&gt;U, right:[T]) -&gt; [U] {\n    return map(right) { return left($0) }\n}\n\npublic func flatten&lt;T&gt;(input:[[T]]) -&gt; [T] {\n    return input.reduce([], +)\n}\n\ninfix operator &lt;*&gt; { associativity left }\npublic func &lt;*&gt; &lt;T, U&gt;(left:[(T)-&gt;U], right:[T]) -&gt; [U] {\n    return flatten(map(left) { (function) -&gt; [U] in\n        return map(right) { return function($0) }\n    })\n}\n</code></pre>\n\n<p>Which then allows you to use the following:</p>\n\n<pre><code>let suits : [Character] = [ \"C\", \"D\", \"H\", \"S\"]\nlet ranks = Array(2...14)\n\nstruct Card {\n    let suit : Character\n    let rank : Int\n\n    static func build(suit:Character)(rank:Int) -&gt; Card {\n        return Card(suit: suit, rank:rank)\n    }\n}\n\nCard.build &lt;^&gt; suits &lt;*&gt; ranks\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1420624081, "post_id": 27811010, "comment_id": 44039225, "body": "This unfortunately does not answer the question stated by the OP"}, {"owner": {"reputation": 797, "user_id": 1133236, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06d1fcb66a053e29095f12fbe3180a75?s=128&d=identicon&r=PG&f=1", "display_name": "Sinisa Drpa", "link": "https://stackoverflow.com/users/1133236/sinisa-drpa"}, "edited": false, "score": 0, "creation_date": 1420643666, "post_id": 27811010, "comment_id": 44050678, "body": "It should be valid pure functional &quot;style&quot;. Great combination of reduce, map to achieve the goal."}, {"owner": {"reputation": 12251, "user_id": 4051126, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-Wc2bxqc71R8/AAAAAAAAAAI/AAAAAAAAABQ/aPxESgRjMSI/photo.jpg?sz=128", "display_name": "Aaron Rasmussen", "link": "https://stackoverflow.com/users/4051126/aaron-rasmussen"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1420647152, "post_id": 27811010, "comment_id": 44053136, "body": "@ThreeFx: He did ask if the task could be accomplished with less code, among other questions :) But I agree that it probably wasn&#39;t what he was looking for. I was just throwing it out there for comparison."}], "tags": [], "owner": {"reputation": 12251, "user_id": 4051126, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-Wc2bxqc71R8/AAAAAAAAAAI/AAAAAAAAABQ/aPxESgRjMSI/photo.jpg?sz=128", "display_name": "Aaron Rasmussen", "link": "https://stackoverflow.com/users/4051126/aaron-rasmussen"}, "is_accepted": false, "score": 1, "last_activity_date": 1420601688, "last_edit_date": 1420601688, "creation_date": 1420601312, "answer_id": 27811010, "question_id": 27808198, "link": "https://stackoverflow.com/questions/27808198/functional-thinking-in-swift/27811010#27811010", "title": "Functional thinking in Swift?", "body": "<p>This may not be pretty, and I don't think it is functional programming, but it is less code and it uses Swift's terrific map and reduce functions:</p>\n\n<pre><code>struct Card {\n    let suit: String\n    let rank: Int\n}\n\nlet cards = [\"Heart\", \"Diamond\", \"Club\", \"Spade\"].reduce([Card]()) { (cards, suit) in\n    return cards + map(1...13) { rank in return Card(suit: suit, rank: rank) }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2504, "user_id": 2442765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a0f104a40be7b564b32b3fee2a27112?s=128&d=identicon&r=PG", "display_name": "UnchartedWorks", "link": "https://stackoverflow.com/users/2442765/unchartedworks"}, "is_accepted": false, "score": 0, "last_activity_date": 1525028842, "creation_date": 1525028842, "answer_id": 50090293, "question_id": 27808198, "link": "https://stackoverflow.com/questions/27808198/functional-thinking-in-swift/50090293#50090293", "title": "Functional thinking in Swift?", "body": "<p>Swift isn't a functional language. However, you can write swift code in functional style.</p>\n\n<pre><code>func map&lt;T: Collection, U&gt;( _ transform: (T.Iterator.Element) -&gt; U, _ xs: T) -&gt; [U] {\n    return xs.reduce([U](), {$0 + [transform($1)]})\n}\n\nfunc concatMap&lt;A, B&gt; (_ process: (A)-&gt;[B], _ xs: [A]) -&gt; [B] {\n    return xs.reduce([B](), {$0 + process($1)})\n}\n\ninfix operator &lt;*&gt;\nfunc &lt;*&gt;&lt;A, B&gt;(_ xs: [A], _ ys: [B]) -&gt; [(A, B)]{\n    let transform: (A, B) -&gt; (A, B) = {($0, $1)}\n    return concatMap({x in map({transform(x, $0)}, ys)}, xs)\n}\n\nstruct Card {\n    let suit : Character\n    let rank : Int\n\n    static func build(_ sr: (s:Character, r:Int)) -&gt; Card {\n        return Card(suit: sr.0, rank: sr.1)\n    }\n}\n\nfunc test() {\n    let suits : [Character] = [ \"C\", \"D\", \"H\", \"S\"]\n    let ranks = Array(1...13)\n    let cards = map(Card.build, suits &lt;*&gt; ranks)\n    print(cards)\n}\n</code></pre>\n\n<p>If you want to learn Haskell and Swift, you could refer to <a href=\"https://github.com/unchartedworks/HaskellSwift\" rel=\"nofollow noreferrer\">https://github.com/unchartedworks/HaskellSwift</a></p>\n"}], "owner": {"reputation": 797, "user_id": 1133236, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06d1fcb66a053e29095f12fbe3180a75?s=128&d=identicon&r=PG&f=1", "display_name": "Sinisa Drpa", "link": "https://stackoverflow.com/users/1133236/sinisa-drpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 1, "accepted_answer_id": 27809058, "answer_count": 3, "score": 1, "last_activity_date": 1525028842, "creation_date": 1420582719, "question_id": 27808198, "link": "https://stackoverflow.com/questions/27808198/functional-thinking-in-swift", "title": "Functional thinking in Swift?", "body": "<p>I started learning Haskell and Swift. I'm wondering if it's the correct way of thinking in \"functional\" way?\nThe problem is to create card deck:\nI need to loop through suits and ranks - for every suit create card with given suit and rank. In \"imperative\" way it'd be:</p>\n\n<pre><code>let suits: Array&lt;Character&gt; = ...\nlet ranks: Array&lt;Int&gt; = ...\n\nvar cards: [Card]\nfor suit in suits {\n    for rank in ranks {\n        cards.addObject(Card(suit: suit, rank: rank))\n    }\n}\n</code></pre>\n\n<p>Then I tried with pure functions using recursion, it works but, can it be done with less code ?\nTo me \"functional\" in Swift is less readable, or probably I'm doing it wrong ...</p>\n\n<pre><code>let cards = cardsWithSuits(suits, ranks, [Card]());\n\nfunc cardsWithSuits(suits: [Character], ranks: [Int], cards: [Card]) -&gt; [Card] {\n   if suits.count == 0 { return cards }\n   let suit: Character = head(suits)!\n   let acc = cardsWithRanks(ranks, suit, cards)\n\n   return cardsWithSuits(drop(1, suits), ranks, acc)\n}\n\nfunc cardsWithRanks(ranks: [Int], suit: Character, cards: [Card]) -&gt; [Card] {\n   if ranks.count == 0 { return cards }\n   let acc = cards + [Card(suit: suit, rank: head(ranks)!)]\n\n   return cardsWithRanks(drop(1, ranks), suit, acc)\n}\n</code></pre>\n"}, {"tags": ["haskell", "currying", "parse-error"], "comments": [{"owner": {"reputation": 3, "user_id": 4425592, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l1VqKS8HV48/AAAAAAAAAAI/AAAAAAAAABQ/ZkN3v7rA580/photo.jpg?sz=128", "display_name": "SambaBoy", "link": "https://stackoverflow.com/users/4425592/sambaboy"}, "edited": false, "score": 1, "creation_date": 1420580566, "post_id": 27807622, "comment_id": 44024395, "body": "h (y:[]) k x = [x++k:[y]] this is where the interpreter says NO"}, {"owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 0, "creation_date": 1420580684, "post_id": 27807622, "comment_id": 44024454, "body": "Hey, can you fix your code layout a little bit? It&#39;s hard to understand what&#39;s going on there."}], "answers": [{"comments": [{"owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 0, "creation_date": 1504684896, "post_id": 27807755, "comment_id": 79100165, "body": "Correct me if I&#39;m wrong, please. I&#39;d like to add that in the expression <code>h (y:[]) k x</code>, <code>(y:[])</code> is expected to be a tuple <code>([Int],Int,[Int])</code> by declaration of <code>h</code>. In <code>h y:xs k x</code> then <code>y</code> is expected to be such a tuple."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1504684126, "last_edit_date": 1504684126, "creation_date": 1420580891, "answer_id": 27807755, "question_id": 27807622, "link": "https://stackoverflow.com/questions/27807622/haskell-parse-error-in-pattern-after-currying/27807755#27807755", "title": "(Haskell) Parse error in pattern after Currying", "body": "<p>There are two problems with this line:</p>\n\n<pre><code>h y:xs k x = [x++k:y:xs]++h(xs,k,x++[y])\n  ^^^^                    ^^^^^^^^^^^^^\n  (1)                     (2)\n</code></pre>\n\n<ol>\n<li>You need parens around this pattern - <code>(y:xs)</code></li>\n<li>Unlike in other languages like C, Java, C#, etc, in Haskell you don't use commas to separate parameters to functions.</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 4425592, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l1VqKS8HV48/AAAAAAAAAAI/AAAAAAAAABQ/ZkN3v7rA580/photo.jpg?sz=128", "display_name": "SambaBoy", "link": "https://stackoverflow.com/users/4425592/sambaboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 27807755, "answer_count": 1, "score": -1, "last_activity_date": 1504684126, "creation_date": 1420580380, "last_edit_date": 1504684053, "question_id": 27807622, "link": "https://stackoverflow.com/questions/27807622/haskell-parse-error-in-pattern-after-currying", "title": "(Haskell) Parse error in pattern after Currying", "body": "<p>I am getting a parse error after I changed this:</p>\n\n<pre><code>h :: ([Int],Int,[Int])-&gt;[[Int]]\n\nh ([],k,x) =[[]]\n\nh(y:[],k,x) = [x++k:[y]]\n\nh(y:xs,k,x)= [x++k:y:xs]++h(xs,k,x++[y])\n</code></pre>\n\n<p>to this: at line 3</p>\n\n<pre><code>h :: [Int]-&gt;Int-&gt;[Int]-&gt;[[Int]]\n\nh [] k x  =[[]]\n\nh (y:[]) k x = [x++k:[y]]\n\nh y:xs k x = [x++k:y:xs]++h(xs,k,x++[y])\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1420579242, "post_id": 27807327, "comment_id": 44023720, "body": "<code>lens</code> defines this operator as <code>&amp;</code> with <code>infixl 1 &amp;</code> instead, and I believe F# uses the <code>|&gt;</code> operator or something like it for a similar effect, but I haven&#39;t really used F# so I may be lying."}, {"owner": {"reputation": 14069, "user_id": 1769720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5815db653a13a7122066f811caa020a7?s=128&d=identicon&r=PG", "display_name": "didierc", "link": "https://stackoverflow.com/users/1769720/didierc"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420579561, "post_id": 27807327, "comment_id": 44023875, "body": "@bheklilr you are correct."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1420584048, "post_id": 27807327, "comment_id": 44025956, "body": "Your <code>(#)</code> operator is flipped function <i>application</i>, not function composition. You may want to consider the difference between <code>f $ g $ h $ a</code> and <code>f . g . h $ a</code>. Some authors and languages do prefer flipped composition, btw, so this is a pretty reasonable thing to want. You can define <code>(&gt;&gt;&gt;) = flip (.)</code> and use it as <code>numEvens = filter even &gt;&gt;&gt; length</code>."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1420625893, "post_id": 27807327, "comment_id": 44040288, "body": "@Rein Henrichs, you are right. I am mistaking: my <code>#</code> function is a flipped function application. Ok, but what it influences? I want to use it for left to right writting\\reading of my code. Name of <code>#</code> has the single char and the <code>&gt;&gt;&gt;</code> has three chars, i.e. first variant shortly. The question which I asked in a subject, still is actual for me."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420639868, "post_id": 27807327, "comment_id": 44048228, "body": "@bheklilr <code>|&gt;</code> in F# isn&#39;t function composition, but application. But you are right about the order."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420658950, "post_id": 27807327, "comment_id": 44060060, "body": "Your <code>#</code> function is <i>not</i> function composition. You should define it as <code>(#) = flip (.)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420580312, "post_id": 27807432, "comment_id": 44024277, "body": "&gt;Reverse composition, however, is &gt;&gt;&gt; from Control.Category.&lt; But ghci is not see the <code>&gt;&gt;&gt;</code> function in the <code>Control.Category</code> module:  <code>\u03bb: :m + Control.Category \u03bb: :t &gt;&gt;&gt;  &lt;interactive&gt;:1:1: parse error on input </code>&gt;&gt;&gt;&#39; \u03bb: :t Control.Category.&gt;&gt;&gt;  &lt;interactive&gt;:1:1: parse error on input <code>Control.Category.&gt;&gt;&gt;&#39; \u03bb:</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1420580584, "post_id": 27807432, "comment_id": 44024401, "body": "You need to surround operators with <code>()</code>s to use them in non-infix ways: <code>:t (&gt;&gt;&gt;)</code> would work fine."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420580931, "post_id": 27807432, "comment_id": 44024576, "body": "Thank you. I try to use the <code>&gt;&gt;&gt;</code> instead of <code>#</code>:  <code>import Control.Category someFunc2 :: (Double -&gt; Double) -&gt; Double -&gt; Int someFunc2 f n = map (f) [1..] &gt;&gt;&gt; scanl1 (+) &gt;&gt;&gt; takeWhile (&lt; n) &gt;&gt;&gt; length</code> but ghci can&#39;t load this. I see that a signature of <code>&gt;&gt;&gt;</code> is not the same as <code>#</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420582717, "post_id": 27807432, "comment_id": 44025371, "body": "@Bush <code>Prelude Control.Arrow&gt; ($ zipWith max [1,2] [4,5]) $ map (*3) &gt;&gt;&gt; product &gt;&gt;&gt; replicate 2</code> <b>=&gt;</b> <code>[180,180]</code>."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 4, "creation_date": 1420582784, "post_id": 27807432, "comment_id": 44025404, "body": "<code>($)</code> is to <code>(.)</code> as <code>(&amp;)</code> is to <code>(&gt;&gt;&gt;)</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420582894, "post_id": 27807432, "comment_id": 44025450, "body": "@Bush or, <code>Prelude&gt; let x |&gt; f = f x</code> ;  <code>Prelude&gt; zipWith max [1,2] [4,5] |&gt; map (*3) |&gt; product |&gt; replicate 2</code> <b>=&gt;</b> <code>[180,180]</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420599494, "post_id": 27807432, "comment_id": 44030297, "body": "@Bush Hi =)  And for the record it literally doesn&#39;t mean anything.  I made it up about a decade ago."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420624785, "post_id": 27807432, "comment_id": 44039615, "body": "@Will Ness, I try to do: <code>\u03bb: :m + Control.Arrow \u03bb: ($ zipWith max [1,2] [4,5]) $ map (*3) &gt;&gt;&gt; product &gt;&gt;&gt; replicate 2 =&gt; [180,180]</code> but I get an error: &lt;interactive&gt;:2:68: parse error on input `=&gt;&#39;"}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420624911, "post_id": 27807432, "comment_id": 44039688, "body": "@Will Ness, I get the same error for your second variant too."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420625187, "post_id": 27807432, "comment_id": 44039846, "body": "@dfeuer, but my <code>#</code> works like a reverse <i>composition</i> and this is not necessary the reverse <i>application</i>. Look my <code>someFunc&#39;</code> function please. Its first expression (the <code>map</code> calling) has two arguments."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1420579518, "creation_date": 1420579518, "answer_id": 27807432, "question_id": 27807327, "link": "https://stackoverflow.com/questions/27807327/function-composition-left-to-right/27807432#27807432", "title": "Function composition left to right", "body": "<p>Your <code>#</code> is, as bheklir notes, <code>&amp;</code> from <code>lens</code>, which is reverse <em>application</em>. Reverse <em>composition</em>, however, is <code>&gt;&gt;&gt;</code> from <code>Control.Category</code>.</p>\n"}], "owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 27807432, "answer_count": 1, "score": 0, "last_activity_date": 1420579518, "creation_date": 1420579069, "question_id": 27807327, "link": "https://stackoverflow.com/questions/27807327/function-composition-left-to-right", "title": "Function composition left to right", "body": "<p>I am learning Haskell. Some expression: </p>\n\n<pre><code>replicate 2 . product . map (*3) $ zipWith max [1,2] [4,5]\n</code></pre>\n\n<p>When I build it I write the <code>zipWith max [1,2] [4,5]</code> at first, then I press the <code>Home</code> key and write the <code>map (*3) $</code>, then I press the <code>Home</code> key again and write the <code>product .</code>, then I press the <code>Home</code> key and write the <code>replicate 2 .</code>. This way is inconvenient to me.</p>\n\n<p>So I build an expression right to left,and when I am reading this - I do it right to left too. But I got used to read left to right - this is more convenient to me.</p>\n\n<p>I can do the same left to right:</p>\n\n<pre><code>zipWith max [1,2] [4,5] # map (*3) # product # replicate 2\n</code></pre>\n\n<p>This case I am writting\\reading an expression left to right, as I got used, without the <code>Home</code> key pressing.</p>\n\n<p>I define the <code>#</code> function as:</p>\n\n<pre><code>infixl 0 #\n(#) :: a -&gt; (a -&gt; b) -&gt; b\nn # f = (f) n\n</code></pre>\n\n<p>So, the <code>#</code> function creates the <em>function composition</em>, like the <code>.</code> function, but it works left to right.</p>\n\n<p>For example, this functions are equal:</p>\n\n<pre><code>someFunc :: (Double -&gt; Double) -&gt; Double -&gt; Int\nsomeFunc f n = length . takeWhile (&lt; n) $ scanl1 (+) (map (f) [1..])\n\nsomeFunc' :: (Double -&gt; Double) -&gt; Double -&gt; Int\nsomeFunc' f n = map (f) [1..] # scanl1 (+) # takeWhile (&lt; n) # length\n</code></pre>\n\n<p>But the <code>someFunc'</code> is more convenient for me for reading\\writting.</p>\n\n<p>I am thinking to use the <code>#</code> function in my code instead the <code>.</code>. Are exist some problems with the <code>#</code> function which I not see still?</p>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 3, "creation_date": 1420566842, "post_id": 27804258, "comment_id": 44017603, "body": "Can you show us what you have tried in Haskell? Be more specific about where you are having trouble, what errors are you getting, etc."}, {"owner": {"reputation": 374, "user_id": 3785289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4wlxn.jpg?s=128&g=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/3785289/lakshman"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1420567120, "post_id": 27804258, "comment_id": 44017745, "body": "I googled and found haskell tutorial where somee built in function was mntion factorial <code>n = product [1..n] </code>mod` 1000000007` but this is taking more time. Thats why I asked here for help."}, {"owner": {"reputation": 374, "user_id": 3785289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4wlxn.jpg?s=128&g=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/3785289/lakshman"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1420567374, "post_id": 27804258, "comment_id": 44017882, "body": "@JustinWood I googled and found haskell tutorial where some built in function was metion factorial <code>n = product [1..n] mod 1000000007</code> but this is taking more time. Thats why I asked here for help."}, {"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1420567547, "post_id": 27804258, "comment_id": 44017969, "body": "it isn&#39;t very clear what you are asking at this point. It sounds like you are just asking us to write the code for you. That is not the point of this site."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1420580917, "post_id": 27804258, "comment_id": 44024567, "body": "This question appears to be off-topic because it is asking for an entire program to be written."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1420577253, "post_id": 27804528, "comment_id": 44022746, "body": "I&#39;d be more explicit: <code>p = 1000000007 :: Int64</code>, since on a 32-bit platform you&#39;ll get wrong results due to integer overflow."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1422436836, "post_id": 27804528, "comment_id": 44745204, "body": "The default type for numbers in Haskell is <code>Integer</code>, so adding <code>:: Int64</code> causes overflows, not prevents them."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1422437115, "post_id": 27804528, "comment_id": 44745354, "body": "We are performing arithmetic mod 10^9+7 so we don&#39;t anything more than an Int64."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1420577351, "last_edit_date": 1420577351, "creation_date": 1420567694, "answer_id": 27804528, "question_id": 27804258, "link": "https://stackoverflow.com/questions/27804258/product-of-factorial-in-haskell/27804528#27804528", "title": "Product of factorial in haskell", "body": "<p>Here is a way of generating the \"product of factorials\" list using <code>scanl</code>:</p>\n\n<pre><code>p = 1000000007 :: Int64\nmtimes a b = mod (a * b) p\nfacts = scanl mtimes 1 [1..]\nprodfacts = scanl mtimes 1 facts\n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>ghci&gt; take 10 facts\n[1,1,2,6,24,120,720,5040,40320,362880]\n\nghci&gt; take 10 prodfacts\n[1,1,1,2,12,288,34560,24883200,411327125,709563912]\n</code></pre>\n"}], "owner": {"reputation": 374, "user_id": 3785289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4wlxn.jpg?s=128&g=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/3785289/lakshman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 27804528, "answer_count": 1, "score": -1, "last_activity_date": 1420585837, "creation_date": 1420566613, "last_edit_date": 1420585837, "question_id": 27804258, "link": "https://stackoverflow.com/questions/27804258/product-of-factorial-in-haskell", "title": "Product of factorial in haskell", "body": "<p>I am trying to convert Python to Haskell but facing difficulty. I am very new in Haskell and only know the basics.\nHere is the Python code I need in Haskell. Can someone help me?</p>\n\n<p>Thanks.</p>\n\n<pre><code>import sys\nfact=[]\ndef facto():\n    mod=1000000007\n    f1=1;f2=1\n    for j in xrange(1,1000001):\n        f1=f1*j%mod\n        f2=f2*f1%mod\n        fact.append(f2)\ndef main():\n    facto()\n    tc=int(sys.stdin.readline())\n    for i in xrange(tc):\n        n=int(sys.stdin.readline())\n        sys.stdout.write(\"Case %d: \"%(i+1))\n        print fact[n-1]\nmain()\n</code></pre>\n"}, {"tags": ["haskell", "functor", "algebraic-data-types"], "comments": [{"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1420613821, "post_id": 27803386, "comment_id": 44034824, "body": "Why not just keep a list of strings and a separate list of lists of Ints? Then you can use map and map.map on them both without authoring any new code first?"}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1420640385, "post_id": 27803386, "comment_id": 44048572, "body": "If you used <code>[Either [[Int]] [String]]</code> and then <code>fmap</code> works on the Right values, but not the left: <code>map (fmap (map length)) [Left [[2,2],[3]],Right [&quot;Hello&quot;,&quot;Mum&quot;],Left []]</code> would be <code>[Left [[2,2],[3]],Right [5,3],Left []] :: Either [[Int]] [Int]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1420567967, "post_id": 27803680, "comment_id": 44018190, "body": "<code>Either a</code> is not actually a type constructor. You could call it a type, or maybe a type function or something."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 4, "last_activity_date": 1420564617, "last_edit_date": 1420564617, "creation_date": 1420564249, "answer_id": 27803680, "question_id": 27803386, "link": "https://stackoverflow.com/questions/27803386/functor-instance-for-a-simple-algebraic-data-type/27803680#27803680", "title": "Functor instance for a simple algebraic data type", "body": "<p>No because it doesn't have the right <a href=\"https://www.haskell.org/haskellwiki/Kind\" rel=\"nofollow\">kind</a>. Functors should have kind <code>* -&gt; *</code> while <code>T</code> has kind <code>*</code>. Functors must be type constructors with a single type argument, for example <code>IO</code>, <code>Maybe</code>, <code>Either a</code>. This is reflected in the type of <code>fmap</code>:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>so <code>f</code> requires a type argument <code>a</code>. There is no such parameter for your type <code>T</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1420569611, "post_id": 27803810, "comment_id": 44019052, "body": "<code>tmap</code> is just a special case of <code>caseT :: ([Int] -&gt; b) -&gt; ([Char] -&gt; b) -&gt; T -&gt; b</code>. Namely, <code>tmap f = caseT f f</code>. Then you can do things like <code>caseT (Left . (!!2)) (Right . (!!2))</code>."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 9, "last_activity_date": 1420564824, "creation_date": 1420564824, "answer_id": 27803810, "question_id": 27803386, "link": "https://stackoverflow.com/questions/27803386/functor-instance-for-a-simple-algebraic-data-type/27803810#27803810", "title": "Functor instance for a simple algebraic data type", "body": "<h2>Short Answer:</h2>\n\n<p>No, it can't be made into a <code>Functor</code>.</p>\n\n<h2>Long Answer:</h2>\n\n<p>The first reason this can not be made into a function is that functors must have the kind <code>* -&gt; *</code>.  Kinds are like the types of types, you can even check them in GHCi using <code>:kind &lt;type&gt;</code>.  For example:</p>\n\n<pre><code>&gt; :kind Int\nInt :: *\n&gt; :kind []\n[] :: * -&gt; *\n&gt; :kind Num\nNum :: * -&gt; Constraint\n&gt; :kind Maybe\nMaybe :: * -&gt; *\n&gt; :kind Either\nEither :: * -&gt; * -&gt; *\n&gt; :kind Functor\nFunctor :: (* -&gt; *) -&gt; Constraint\n</code></pre>\n\n<p>The <code>*</code> basically means a fully applied type, such as <code>Int</code>, <code>Char</code>, <code>[String]</code>, etc, and something like <code>* -&gt; *</code> means the type takes a single type of kind <code>*</code> to return a new type of kind <code>*</code>.  Constraints also have kinds, namely that they return the kind <code>Constraint</code> when fully applied.</p>\n\n<p>Your type has kind <code>*</code>, which does not match <code>* -&gt; *</code> required as the argument to <code>Functor</code>.  In order for it to become a <code>Functor</code> it would need to accept a type variable.  Adding a type variable here doesn't make much sense, but you could have</p>\n\n<pre><code>data T a = LInt [a] | LChar [a]\n</code></pre>\n\n<p>But this isn't very useful, we now can't enforce that <code>LInt</code> only contains <code>Int</code>s and <code>LChar</code> only contains <code>Char</code>s.  Worse still, looking at the type of <code>fmap</code> we have</p>\n\n<pre><code>class Functor f where\n    fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)\n</code></pre>\n\n<p>But what you're wanting to do is something like</p>\n\n<pre><code>myfmap :: (a -&gt; b) -&gt; (f a -&gt; b)\n</code></pre>\n\n<p>Notice how the return type is <code>b</code> instead of <code>f b</code>.  The <code>fmap</code> function only transforms values inside a container, it doesn't extract values from said container.</p>\n\n<p>It would be possible to write a parameterized type that is constrained using <code>-XGADTs</code>, though, you could write</p>\n\n<pre><code>data T a where\n    LInt :: [Int] -&gt; T Int\n    LChar :: [Char] -&gt; T Char\n</code></pre>\n\n<p>And this would guarantee the types are sane, but it's still not possible to make this into an instance of <code>Functor</code> (that satisfies the functor laws, that is) and it would prevent you from making a heterogeneous list (<code>T Int /~ T Char</code>).</p>\n\n<p>So it really looks like the <code>Functor</code> option is just right out.  You might find it tempting to write a function like</p>\n\n<pre><code>tmap :: ([a] -&gt; b) -&gt; T -&gt; b\ntmap f (LInt x) = f x\ntmap f (LChar x) = f x\n</code></pre>\n\n<p>But this won't work either.  The type system sees that you're trying to say that <code>f :: [Int] -&gt; b</code> and <code>f :: [Char] -&gt; b</code>, which can't be unified.  You can do this by enabling <code>-XRankNTypes</code> though:</p>\n\n<pre><code>tmap :: (forall a. [a] -&gt; b) -&gt; T -&gt; b\ntmap f (LInt x) = f x\ntmap f (LChar x) = f x\n</code></pre>\n\n<p>And this does allow you to do something like</p>\n\n<pre><code>&gt; tmap length (LInt [1, 2, 3])\n3\n&gt; tmap length (LChar \"test\")\n4\n</code></pre>\n\n<p>But it won't let you do</p>\n\n<pre><code>&gt; tmap (!! 2) (LChar \"test\")\nCouldn't match type 'b' with 'a'\n  because type variable 'a' would escape its scope\nThis (rigid, skolem) type variable is bound by\n  a type expected by the context: [a] -&gt; b\nExpected type: [a] -&gt; b\n  Actual type: [a] -&gt; a\n...\n</code></pre>\n\n<p>What this means is that the type <code>a</code> can't appear anywhere in the output type <code>b</code>, since the <code>f</code> passed in has to work for <em>all</em> <code>a</code>, it can't work for just any <code>a</code>.</p>\n\n<p>In conclusion, without having to dip even further into type system madness your type can't be made to do what you want it to.  You're going to have to write specialized functions to handle each case individually, which is pretty much the point of ADTs.  The compiler can ensure that you do actually handle each case, and so long as you stay away from functions that return <code>undefined</code> or call <code>error</code>, then your program will be safe.  It may not be as flexible as you'd like, but it'll be rock solid in terms of safety.</p>\n"}], "owner": {"reputation": 9657, "user_id": 143813, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8d1b60d97a4941619b7e38b2e39ed847?s=128&d=identicon&r=PG", "display_name": "gappy", "link": "https://stackoverflow.com/users/143813/gappy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 1, "accepted_answer_id": 27803810, "answer_count": 2, "score": 5, "last_activity_date": 1420564824, "creation_date": 1420563261, "question_id": 27803386, "link": "https://stackoverflow.com/questions/27803386/functor-instance-for-a-simple-algebraic-data-type", "title": "Functor instance for a simple algebraic data type", "body": "<p>I would like to use heterogeneous lists of lists. To this effect, I define a simple algebraic data type:</p>\n\n<pre><code>data T = LInt [Int]\n       | LChar [Char]\n       deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>so I can now have something like this: </p>\n\n<pre><code>x = [LInt [1, 2, 3], LChar \"test\"]\n</code></pre>\n\n<p>My question: can this type be made an instance of Functor? This would be useful; for example to select elements of a list in x, as in </p>\n\n<pre><code>fmap (!!2) LChar \"test\"  =&gt; 's'\n</code></pre>\n\n<p>It seems to me that this is not possible. Aside from the motivation for the question, I believe the answer would help me understand Algebraic Data Types better.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1420561121, "post_id": 27802578, "comment_id": 44014258, "body": "<code>mlist</code> is a list of strings, <code>mlist!!x</code> is a string, <code>(mlist!!x)++&quot;L&quot;</code> is also a string."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1420562794, "post_id": 27802578, "comment_id": 44015308, "body": "you need list of Strings, you have a String which is a list or [Char]"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1420566784, "post_id": 27802578, "comment_id": 44017580, "body": "Do you mean a program like <a href=\"http://ideone.com/UMKhiF\" rel=\"nofollow noreferrer\">this</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420655695, "post_id": 27809179, "comment_id": 44058181, "body": "The omega version doesn&#39;t compute the strings in order of increasing length. Why?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420663184, "post_id": 27809179, "comment_id": 44062364, "body": "@n.m. Omega makes no such guarantees: it applies a dovetailing/diagonalization function to reduce all the infinite combinations to a single list. The order in which each combination appears in the final list has no significant property. In other words, <code>join</code> has roughly the type <code>[[a]] -&gt; [a]</code> but is more involved than <code>concat</code>, and acts as a fair scheduler among infinitely many threads, each one producing a list <code>[a]</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420663646, "post_id": 27809179, "comment_id": 44062616, "body": "@n.m. I realized that I pasted the output for a different code of mine. Now I edited with the actual one."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420673373, "post_id": 27809179, "comment_id": 44067007, "body": "I just tried to compare the performance of the omega version and my simple memoizing version <a href=\"http://ideone.com/UMKhiF\" rel=\"nofollow noreferrer\">here</a>, and realized the comparison is not fair because they don&#39;t compute the result in the same order."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420674961, "post_id": 27809179, "comment_id": 44067483, "body": "@n.m. I like that your solution does not use naturals, and is memoized (unlike mine). It also produces the results in a predictable order. You could add some comment to it and post it here as an answer."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1420663551, "last_edit_date": 1420663551, "creation_date": 1420587666, "answer_id": 27809179, "question_id": 27802578, "link": "https://stackoverflow.com/questions/27802578/find-combinations-of-all-brackets-in-haskell/27809179#27809179", "title": "Find combinations of all brackets in haskell?", "body": "<h1>Problem statement</h1>\n\n<p>Let's define what a balanced string is, inductively:</p>\n\n<ul>\n<li><code>\"\"</code> is balanced</li>\n<li>if <code>x</code> and <code>y</code> are balanced, <code>\"(\" ++ x ++ \")\" ++ y</code> is balanced</li>\n</ul>\n\n<p>All the balanced strings can be constructed using the above rules.</p>\n\n<h1>The finite case</h1>\n\n<p>We want to enumerate all the balanced strings having exactly <code>n</code> parentheses. We follow the inductive rules above.</p>\n\n<pre><code>paren :: Int -&gt; [String]\nparen 0 = [\"\"]\nparen n = [ \"(\" ++ x ++ \")\" ++ y\n          | m &lt;- [0..n-1] , x &lt;- paren m , y &lt;- paren (n-1-m) ]\n</code></pre>\n\n<p>In the second rule, we divide the remaining <code>n-1</code> parentheses in two parts, in any possible way. The first part is made of <code>m</code> parentheses, with <code>0 &lt;= m &lt;= n-1</code>. The second therefore\nis made of <code>(n-1)-m</code> parentheses.</p>\n\n<h1>The infinite case</h1>\n\n<p>Let's raise the bar. We don't want just the combinations for a specific <code>n</code>, we want an exhaustive list comprising all of them. We might <code>concat $ map paren [0..]</code> but that feels silly: why should we partition the set over the number of parentheses <code>n</code> when we are going to concatenate the results anyway?</p>\n\n<p>Instead, let's directly enumerate all the infinite balanced strings. \nThis is a job for the <a href=\"http://hackage.haskell.org/package/control-monad-omega-0.3.1/docs/Control-Monad-Omega.html\" rel=\"nofollow\">Omega</a> monad. We just need to use the inductive rules, once again:</p>\n\n<pre><code>import Control.Monad.Omega\n\nallParen :: Omega String\nallParen = return \"\"\n       &lt;|&gt; (\\x y -&gt; \"(\" ++ x ++ \")\" ++ y) &lt;$&gt; allParen &lt;*&gt; allParen\n</code></pre>\n\n<p>This is even simpler than <code>paren</code> since we never need to count the number of parentheses.</p>\n\n<p>A quick test in GHCi:</p>\n\n<pre><code>&gt; take 20 $ runOmega allParen\n[\"\",\"()\",\"()()\",\"(())\",\"()()()\",\"(())()\",\"(()())\",\"()(())\",\"(())()()\",\"(()())()\",\"((()))\",\"()()()()\",\"(())(())\",\"(()())()()\",\"((()))()\",\"(()()())\",\"()(())()\",\"(())()()()\",\"(()())(())\",\"((()))()()\"]\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 3857075, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ofemI.jpg?s=128&g=1", "display_name": "Animesh Saxena", "link": "https://stackoverflow.com/users/3857075/animesh-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 1, "accepted_answer_id": 27809179, "answer_count": 1, "score": 0, "last_activity_date": 1420663551, "creation_date": 1420560733, "question_id": 27802578, "link": "https://stackoverflow.com/questions/27802578/find-combinations-of-all-brackets-in-haskell", "title": "Find combinations of all brackets in haskell?", "body": "<p>I am trying to write a simple code for generating all combinations of brackets..But am stuck with a simple type error. </p>\n\n<pre><code>balancedParens :: Int -&gt; [String]\nbalancedParens n\n            | n==0 = []\n            | otherwise = placeParens 0 1 0 n [\"\"]\n          where placeParens x lc rc n mlist\n                                | lc == n = mlist\n                                | rc == n = mlist\n                                | lc &lt; n = placeParens (x+1) (lc+1) rc n ((mlist !! x) ++ \"L\")\n                                | rc &lt; n = placeParens (x+1) lc (rc+1) n ((mlist !! x) ++ \"R\")\n</code></pre>\n\n<p>There are lots of errors but most prominent is </p>\n\n<pre><code>Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\nExpected type: [[Char]]\n  Actual type: [Char]\nIn the first argument of \u2018(!!)\u2019, namely \u2018mlist\u2019\nIn the first argument of \u2018(++)\u2019, namely \u2018(mlist !! x)\u2019\n</code></pre>\n\n<p>Failed, modules loaded: none.</p>\n\n<p>((mlist !! x) ++ \"L\") is a list so why the type error? How come it is matching [Char]?</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": true, "score": 5, "last_activity_date": 1420715925, "last_edit_date": 1420715925, "creation_date": 1420543317, "answer_id": 27797577, "question_id": 27797576, "link": "https://stackoverflow.com/questions/27797576/unrecognized-configure-option-enable-executable-profiling/27797577#27797577", "title": "unrecognized &#39;configure&#39; option `--enable-executable-profiling&#39;", "body": "<p>The parameter <code>executable-profiling</code> appears to have been renamed to <code>profiling</code> at some point. There are some other changes to the configuration parameters as well. I suspect that all I needed to do was change <code>executable-profiling</code> to <code>profiling</code> in <code>~/.cabal/config</code> and re-try my cabal install.</p>\n\n<p>However, I didn't know <em>a priori</em> what the changes were. So my solution* was:</p>\n\n<ol>\n<li><code>mv ~/.cabal/config ~/.cabal/config.BACKUP</code></li>\n<li><code>cabal update</code> to create a new default configuration file.</li>\n<li>Edit <code>~/.cabal/config</code> to preserve any settings from <code>~/.cabal/config.BACKUP</code> I wanted to keep for the next step, BUT NOT <code>executable-profiling</code>.</li>\n<li><code>cabal --no-require-sandbox install cabal-install</code></li>\n<li><code>rm ~/.cabal/config</code></li>\n<li><code>cabal update</code> to create a new default configuration file. As soon as a new default configuration file has been created, you can CTRL-c.</li>\n<li>Edit <code>~/.cabal/config</code> to preserve any settings from <code>~/.cabal/config.BACKUP</code> I wanted to keep going forward.</li>\n</ol>\n\n<hr>\n\n<p><strong>EDIT:</strong> *I've just discovered the cabal command <code>user-config</code>, which seems tailor-made for situations like this. To learn more, type <code>cabal help user-config</code>.</p>\n"}], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 2, "accepted_answer_id": 27797577, "answer_count": 1, "score": 8, "last_activity_date": 1420715925, "creation_date": 1420543317, "question_id": 27797576, "link": "https://stackoverflow.com/questions/27797576/unrecognized-configure-option-enable-executable-profiling", "title": "unrecognized &#39;configure&#39; option `--enable-executable-profiling&#39;", "body": "<p>After upgrading from ghc 7.8.3 to ghc 7.8.4, I did a <code>cabal update</code>, and saw that there was a new version of cabal. So I ran the command</p>\n\n<pre><code>cabal --no-require-sandbox install cabal-install\n</code></pre>\n\n<p>and got the error message</p>\n\n<pre><code>unrecognized 'configure' option `--enable-executable-profiling'\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1420550247, "post_id": 27797157, "comment_id": 44007394, "body": "<code>-fno-warn-orphans</code>? Short of editing the ghc source code, your best bet is to submit a bug report. In fact, I think this is a bug, because <code>data A = A; deriving instance Typeable &#39;A; deriving instance Typeable A</code> gives you <code>typeRep (Proxy :: Proxy A) == typeRep (Proxy :: Proxy &#39;A)</code> = <code>True</code>, which is probably wrong."}, {"owner": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1420551943, "post_id": 27797157, "comment_id": 44008363, "body": "Apparently this is fixed in GHC 7.10."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1420601833, "post_id": 27797157, "comment_id": 44030821, "body": "@user2407038 Presumably you started <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9858\" rel=\"nofollow noreferrer\">this trac ticket</a>? For future readers,  the <code>Typeable</code> bug doesn&#39;t look like it&#39;s going to get fixed for 7.10."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1420607217, "post_id": 27797157, "comment_id": 44032847, "body": "The ticket that automatically creates <code>Typeable</code> instances for promoted constructors in <code>base</code> is <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9111\" rel=\"nofollow noreferrer\">#9111</a>"}], "owner": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1420541756, "creation_date": 1420541756, "question_id": 27797157, "link": "https://stackoverflow.com/questions/27797157/avoiding-orphan-typeable-instances", "title": "Avoiding orphan typeable instances", "body": "<p>It seems that data types promoted by <code>DataKinds</code> do not automatically get typeable instances. It is quite easy solve this by using <code>StandaloneDeriving</code> but this creates orphan instances. Is there anyway to avoid this?</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE DeriveDataTypeable #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE PolyKinds #-}\n\nmodule Orphan where\n\nimport Data.Typeable\n\nderiving instance Typeable '[]\nderiving instance Typeable '(:)\n</code></pre>\n\n<p>On compilation..</p>\n\n<pre><code>[1 of 1] Compiling Orphan           ( orphan.hs, interpreted )\n\norphan.hs:10:1: Warning: Orphan instance: instance Typeable '[]\n\norphan.hs:11:1: Warning: Orphan instance: instance Typeable (':)\nOk, modules loaded: Orphan.\n*Orphan&gt; \n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1420532513, "post_id": 27794660, "comment_id": 43998358, "body": "Interesting. I can do <code>testSort = L.sort</code> just fine in GHCi."}], "answers": [{"comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1420532596, "post_id": 27794695, "comment_id": 43998391, "body": "How does GHCi overcome this when I merely write <code>let testSort = L.sort</code> in the shell?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 1, "creation_date": 1420532627, "post_id": 27794695, "comment_id": 43998401, "body": "GHCi has recently made <code>-XNoMonomorphismRestriction</code> the default."}, {"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1420532710, "post_id": 27794695, "comment_id": 43998447, "body": "Oh OK, wasn&#39;t aware of that. When I tried to compile it from a source file, I did get OP&#39;s error.!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 1, "creation_date": 1420537705, "post_id": 27794695, "comment_id": 44000653, "body": "@shree.pat18 Note that GHC suggested this fix: <code>Probable fix: give these definition(s) an explicit type signature</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420537724, "post_id": 27794695, "comment_id": 44000664, "body": "You might want to indicate how this is done in GHCi."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420554690, "post_id": 27794695, "comment_id": 44010151, "body": "@dfeuer You can use <code>:set +m</code> for multiline input or you can use <code>let {testSort :: Ord a =&gt; [a] -&gt; [a]; testSort = L.sort}</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420555492, "post_id": 27794695, "comment_id": 44010646, "body": "@bheklilr, <i>I</i> know how to do it; I suggested you add it to your answer for the benefit of those who may not."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420555547, "post_id": 27794695, "comment_id": 44010678, "body": "@dfeuer Not my answer... I figured you know how to do it, I was just tagging your name on it so that future readers would know it&#39;s part of the same conversation."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420557218, "post_id": 27794695, "comment_id": 44011672, "body": "@bheklilr: you don&#39;t need braces around such a &quot;semicolon-typed&quot; expression in GHCi. \u2014 Anyway, I don&#39;t quite see what that has to do with the question: in GHCi I usually don&#39;t write signatures. Definitions in GHCi needn&#39;t be readable (they&#39;ll be gone in the next session anyway) and <code>-XNoMono</code> makes sure this doesn&#39;t. When something in complex enough to need a signature, it&#39;s almost always better to define it in a proper file."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1420532554, "creation_date": 1420532554, "answer_id": 27794695, "question_id": 27794660, "link": "https://stackoverflow.com/questions/27794660/function-substitution-with-an-import/27794695#27794695", "title": "Function substitution with an import", "body": "<p>Dreaded <a href=\"https://www.haskell.org/haskellwiki/Monomorphism_restriction\" rel=\"noreferrer\">monomorphism restriction</a> strikes again.</p>\n\n<p>Simply make it a habit to always write out type signatures, then this will never be a problem.</p>\n\n<pre><code>testSort :: Ord a =&gt; [a] -&gt; [a]\n</code></pre>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 27794695, "answer_count": 1, "score": 1, "last_activity_date": 1420532554, "creation_date": 1420532378, "question_id": 27794660, "link": "https://stackoverflow.com/questions/27794660/function-substitution-with-an-import", "title": "Function substitution with an import", "body": "<p>I'm a Haskell newbie, and working with GHCi, version 7.6.3</p>\n\n<p>I'm trying to understand why this function assignment (or substitution, whatever the correct term is) isn't working.</p>\n\n<p>This code works fine:</p>\n\n<pre><code>import qualified Data.List as L\ntestSort list = L.sort list\n</code></pre>\n\n<p>Prompt:</p>\n\n<pre><code>*Main&gt; testSort [3,2,1]\n[1,2,3]\n</code></pre>\n\n<p>However, if I remove the list parameter like so...</p>\n\n<pre><code>import qualified Data.List as L\ntestSort = L.sort\n</code></pre>\n\n<p>To me, it makes intuitive sense that this would simple substitute L.sort for testSort, and then I could just run the same command at the prompt as before and get the same result.  However, I get a big error from GHCi:</p>\n\n<pre><code>No instance for (Ord a0) arising from a use of `L.sort'\nThe type variable `a0' is ambiguous\nPossible cause: the monomorphism restriction applied to the following:\n  testSort :: [a0] -&gt; [a0] (bound at modulesandbox.hs:4:1)\nProbable fix: give these definition(s) an explicit type signature\n              or use -XNoMonomorphismRestriction\nNote: there are several potential instances:\n  instance Integral a =&gt; Ord (GHC.Real.Ratio a)\n    -- Defined in `GHC.Real'\n  instance Ord () -- Defined in `GHC.Classes'\n  instance (Ord a, Ord b) =&gt; Ord (a, b) -- Defined in `GHC.Classes'\n  ...plus 23 others\nIn the expression: L.sort\nIn an equation for `testSort': testSort = L.sort\n</code></pre>\n\n<p>Is there a way to set up my code so that <code>testSort = L.sort</code> can behave as a simple function substitution?  </p>\n"}, {"tags": ["haskell", "ghc-mod"], "answers": [{"comments": [{"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420525293, "post_id": 27793148, "comment_id": 43995644, "body": "Absolutely. I have <code>cabal.sandbox.config</code> file present in the directory where I am running my <code>ghc-mod check</code> commands. But <code>ghc-mod</code> still does not know to check for available packages in my sandbox."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420525378, "post_id": 27793148, "comment_id": 43995669, "body": "My experimentation shows that you also need a .cabal file."}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420525401, "post_id": 27793148, "comment_id": 43995678, "body": "How can I generate a <code>.cabal</code> file?"}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420525596, "post_id": 27793148, "comment_id": 43995747, "body": "And no, even with my <code>.cabal</code> file, <code>ghc-mod</code> still does not know where to look for my 3rd party packages in the cabal sandbox."}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420525967, "post_id": 27793148, "comment_id": 43995903, "body": "Nope. Both <code>cabal repl</code> and <code>cabal run</code> cannot find the sandbox either... :-("}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420526033, "post_id": 27793148, "comment_id": 43995938, "body": "But <code>cabal exec -- runghc hellowai.hs</code> works (i.e. able to find the sandbox)"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420526628, "post_id": 27793148, "comment_id": 43996161, "body": "You can always create a symlink for cabal.sandbox.config that points to the real file."}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420526712, "post_id": 27793148, "comment_id": 43996200, "body": "I am not sure I understood what you meant.  My project source file <code>hellowai.hs</code> is in the same directory as my <code>cabal.sandbox.conf</code> file."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420526720, "post_id": 27793148, "comment_id": 43996204, "body": "You can also use <code>cabal sandbox init --path=...</code> to create a cabal.sandbox.config file which points to an existing .cabal-sandbox directory."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420527646, "post_id": 27793148, "comment_id": 43996583, "body": "I&#39;ve updated my answer with a recipe which works for me. Perhaps you can use it to figure out what is different with your setup."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420528447, "post_id": 27793148, "comment_id": 43996884, "body": "Added an example of where the sandbox dir is <i>not</i> directly above the current working directory and how to configure the cabal.sandbox.config file to point to it."}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420533255, "post_id": 27793148, "comment_id": 43998652, "body": "<code>cabal</code> version <code>1.18.1.4</code>, <code>ghc-mod</code> version <code>5.2.1.2 compiled by GHC 7.8.3</code> with a valid project <code>.cabal</code> file containing the correct dependencies in <code>build-depends</code> solved the problem for me. Thank you for sharing your example!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1420528191, "last_edit_date": 1420528191, "creation_date": 1420525151, "answer_id": 27793148, "question_id": 27792830, "link": "https://stackoverflow.com/questions/27792830/ghc-mod-does-not-use-my-cabal-sandbox-why/27793148#27793148", "title": "ghc-mod does not use my cabal sandbox. why?", "body": "<p>Do you have a <code>cabal.sandbox.config</code> file? And are you using a <code>.cabal</code> file for your project?</p>\n\n<p>If you have both of these you should be able to use <code>ghc-mod check ...</code> and it will just work.</p>\n\n<p>Another advantage of using a .cabal file is that you can use <code>cabal repl</code> to invoke ghci and <code>cabal run</code> to invoke <code>runhaskell</code> with the correct command line options.</p>\n\n<p><em>Update</em></p>\n\n<p>Here is a recipe you can try out to see when ghc-mod can find your cabal sandbox. Perhaps this can help you determine what's different with your set up.</p>\n\n<p>Start in a clean directory:</p>\n\n<pre><code>$ mkdir foo\n$ cd foo\n$ cabal sandbox init\n$ cabal get split\n$ cd split-0.2.2\n$ cabal sandbox init --sandbox=../.cabal-sandbox\n</code></pre>\n\n<p>Edit around line 55 of split.cabal to add <code>heredoc</code> as a dependency.</p>\n\n<p>Edit src/Data/List/Split.hs to use the module <code>Text.Heredoc</code>:</p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\n...\nimport Text.Heredoc\n...\nfoo :: String\nfoo = [here|this is a test|]\n</code></pre>\n\n<p>Make sure <code>heredoc</code> is installed:</p>\n\n<pre><code>$ cabal install --only-dependencies\n</code></pre>\n\n<p>Finally this should work:</p>\n\n<pre><code>$ ghc-mod check ./src/Data/List/Split.hs\n</code></pre>\n\n<p>And it will still work if you cd into a sub-directory:</p>\n\n<pre><code>$ cd src\n$ ghc-mod check ./Data/List/Split.hs\n</code></pre>\n\n<p>However, ghc-mod won't work if you move away <code>split.cabal</code>:</p>\n\n<pre><code>(back at the top level directory)\n$ mv split.cabal split.cabal-old\n$ ghc-mod check ./src/Data/List/Split.hs\n</code></pre>\n\n<p>In this case I created the sandbox in a parent directory of our working directory, but things should also work if the initial sandbox was created like this:</p>\n\n<pre><code>$ mkdir foo\n$ cd foo\n$ mkdir sandbox-dir\n$ cd sandbox-dir\n$ cabal sandbox init\n$ cd ..\n$ cabal get split\n$ cd split-0.2.2\n$ cabal sandbox init --sandbox=../sandbox-dir/.cabal-sandbox\n</code></pre>\n"}], "owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 1, "accepted_answer_id": 27793148, "answer_count": 1, "score": 4, "last_activity_date": 1420528191, "creation_date": 1420523583, "question_id": 27792830, "link": "https://stackoverflow.com/questions/27792830/ghc-mod-does-not-use-my-cabal-sandbox-why", "title": "ghc-mod does not use my cabal sandbox. why?", "body": "<pre><code>runghc -package-db=.cabal-sandbox/.cabal-sandbox/x86_64-osx-ghc-7.8.3-packages.conf.d hellowai.hs\n</code></pre>\n\n<p>Works perfect for me.</p>\n\n<p>Similarly, with</p>\n\n<pre><code>ghci -package-db=.cabal-sandbox/.cabal-sandbox/x86_64-osx-ghc-7.8.3-packages.conf.d \n</code></pre>\n\n<p>I am also able to import my cabal-sandbox-installed <code>Wai</code> package in <code>ghci</code> with no issue at all.</p>\n\n<p>But when I ask <code>ghc-mod</code> to validate my haskell source code, via</p>\n\n<pre><code>ghc-mod check --boundary=\"\" -g -package-db=.cabal-sandbox/x86_64-osx-ghc-7.8.3-packages.conf.d hellowai.hs\nhellowai.hs:4:8:Could not find module \u2018Network.Wai.Handler.Warp\u2019Use -v to see a list of the files searched for.\nhellowai.hs:3:8:Could not find module \u2018Network.HTTP.Types\u2019Perhaps you meant  Network.HTTP.Base (from HTTP-4000.2.19)  Network.HTTP.Base (needs flag -package HTTP-4000.2.10)  Network.HTTP.Headers (needs flag -package HTTP-4000.2.10)Use -v to see a list of the files searched for.\nhellowai.hs:2:8:Could not find module \u2018Network.Wai\u2019Perhaps you meant  Network.BSD (needs flag -package network-2.4.2.3)  Network.URI (needs flag -package network-2.4.2.3)  Network.TCP (needs flag -package HTTP-4000.2.10)Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>It is unable to find my cabal sandbox installed module.  Why is that so?</p>\n"}, {"tags": ["haskell", "llvm", "cabal", "cabal-install"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1420516485, "creation_date": 1420516485, "answer_id": 27791848, "question_id": 27791277, "link": "https://stackoverflow.com/questions/27791277/cabal-installation-failure-for-llvm-general/27791848#27791848", "title": "cabal installation failure for llvm-general", "body": "<p>I believe that <code>cabal</code> simply looks in your <code>PATH</code> for <code>llvm-config</code>, so just adjust your path accordingly. Otherwise you can try:</p>\n\n<ul>\n<li>modify the file <code>llvm-general.cabal</code> to reference an absolute path for <code>llvm-config</code> (line 52)</li>\n<li>temporarily move aside /usr/local/bin/llvm-config and replace it with the llvm-config for the llvm installation you want to use</li>\n</ul>\n\n<p>For reference, I found <code>llvm-config</code> for version 3.4 at /usr/local/Cellar/llvm34/3.4.2/lib/llvm-3.4/bin/llvm-config on my OSX system.</p>\n"}], "owner": {"reputation": 1032, "user_id": 1840975, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/38e39d49c8a3f64c969f28de7dd562b4?s=128&d=identicon&r=PG", "display_name": "Ricky Stewart", "link": "https://stackoverflow.com/users/1840975/ricky-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1420516485, "creation_date": 1420511854, "question_id": 27791277, "link": "https://stackoverflow.com/questions/27791277/cabal-installation-failure-for-llvm-general", "title": "cabal installation failure for llvm-general", "body": "<p>I am attempting to install the <code>llvm-general</code> Cabal package on OS X. When I do, I get the following error:</p>\n\n<pre><code>$ cabal install llvm-general\nResolving dependencies...\n[1 of 1] Compiling Main             ( /var/folders/PP/PP+wAuBcGWuqzt-Iekiipk+++TI/-Tmp-/llvm-general-3.4.4.2-38424/llvm-general-3.4.4.2/Setup.hs, /var/folders/PP/PP+wAuBcGWuqzt-Iekiipk+++TI/-Tmp-/llvm-general-3.4.4.2-38424/llvm-general-3.4.4.2/dist/setup/Main.o )\nLinking /var/folders/PP/PP+wAuBcGWuqzt-Iekiipk+++TI/-Tmp-/llvm-general-3.4.4.2-38424/llvm-general-3.4.4.2/dist/setup/setup ...\nsetup: The program llvm-config version ==3.4.* is required but the version\nfound at /usr/local/bin/llvm-config is version 3.2\ncabal: Error: some packages failed to install:\nllvm-general-3.4.4.2 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>What it's doing is running /usr/local/bin/llvm-config; this, I believe, is the version of LLVM installed by the OS X developer tools that I installed a while ago.  I do have the current version of LLVM, but it's installed with Homebrew as a local (keg-only) installation.  Is there any way I can point cabal to that version of LLVM for the purposes of this installation?</p>\n"}, {"tags": ["haskell", "random", "monad-transformers", "maybe"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1420505979, "post_id": 27790314, "comment_id": 43990801, "body": "This really seems like it should be three seperate questions. 1) This works for me: <code>let x :: ReaderT Problem (StateT SolutionState (Rand StdGen)) Int; x = getRandomR (1,2)</code>. What version of each package are you using? 2) Maybe is not MaybeT. You simply cannot have <code>a &lt;- lookup b c</code> unless your monad is <i>exactly</i> Maybe. Instead do <code>a &lt;- MaybeT $ return $ lookup b c</code>. <code>embed = MaybeT . return</code> is useful. 3) What I do is have a type like <code>type MyMonad m = (MonadState T m, MonadReader Q m, MonadRandom m)</code>, etc. Then later I decide which &quot;order&quot; of transformers I want."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1420506311, "post_id": 27790314, "comment_id": 43990904, "body": "And lastly, all of these monad transformers are defined using <code>newtype</code> so their runtime cost is essentially the same as &quot;manually&quot; manipulating your effects as functions. Essentially the only &quot;optimization&quot; you can do is decide you don&#39;t need a particular effect. The only thing I would do is replace ReaderT/WriterT/StateT with RWST, but since they are isomorphic, it won&#39;t affect your performance - it is just style."}, {"owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1420507500, "post_id": 27790314, "comment_id": 43991170, "body": "Seemed a bit weird to ask 3 questions about the same small code snippet. FYI - you&#39;ve answered all of my questions in 2 short comments. Would be happy to accept as an answer... (1) You were right, the MonadRandom instances did work, I just had old/conflicting versions. Should have used a sandbox. (2) I think I understand. Is this because <code>Maybe</code> isn&#39;t <code>MaybeT Identity</code> like other types are? (3) RWS sounds awesome. But I&#39;m not sure I follow how your proposed type alias works."}], "answers": [{"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 3, "last_activity_date": 1420558877, "creation_date": 1420558877, "answer_id": 27802046, "question_id": 27790314, "link": "https://stackoverflow.com/questions/27790314/monad-transformer-stacks-with-maybet-and-randt/27802046#27802046", "title": "Monad Transformer stacks with MaybeT and RandT", "body": "<h2>Problem 1</h2>\n\n<p>Can't reproduce. There are already these instances for <code>RandT</code>.</p>\n\n<h2>Problem 2</h2>\n\n<p><code>lookup</code> returns <code>Maybe</code>, but you have a stack based on <code>MaybeT</code>. The reason why there is no <code>MonadMaybe</code> is that the corresponding type class is <code>MonadPlus</code> (or more general <code>Alternative</code>) - <code>pure</code>/<code>return</code> correspond to <code>Just</code> and <code>empty</code>/<code>mzero</code> correspond to <code>Nothing</code>. I'd suggest to create a helper</p>\n\n<pre><code>lookupA :: (Alternative f, Ord k) =&gt; k -&gt; M.Map k v -&gt; f v\nlookupA k = maybe empty pure . M.lookup k\n</code></pre>\n\n<p>and then you can call <code>lookupA</code> wherever you need in your monad stack</p>\n\n<p>As mentioned in the comments, I'd strongly suggest to use <code>RWST</code>, as it's exactly what fits your case, and it's much easier to work with than the stack of StateT/ReaderT/WriterT.</p>\n\n<p>Also think about the difference between</p>\n\n<pre><code>type Solver a = RWST Problem Leaderboard SolutionState (MaybeT (Rand StdGen)) a\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type Solver a = MaybeT (RWST Problem Leaderboard SolutionState (Rand StdGen)) a\n</code></pre>\n\n<p>The difference is what happens in the case of a failure. The former stack doesn't return anything, while the latter allows you to retrieve the state and the <code>Leaderboard</code> computed so far.</p>\n\n<h2>Problem 3</h2>\n\n<p>The easiest way is to add it into the state part. I'd just include it into <code>SolutionState</code>.</p>\n\n<h2>Sample code</h2>\n\n<pre><code>import Control.Applicative\nimport Control.Monad.Random\nimport Control.Monad.Random.Class\nimport Control.Monad.Trans\nimport Control.Monad.Trans.Maybe\nimport Control.Monad.RWS\nimport qualified Data.Map as M\nimport Data.Monoid\nimport System.Random\n\n-- Dummy data types to satisfy the compiler\ndata Problem = Problem\ndata Leaderboard = Leaderboard\ndata SolutionState = SolutionState\ndata City = City\n\ninstance Monoid Leaderboard where\n  mempty = Leaderboard\n  mappend _ _ = Leaderboard\n\n-- dummy function\ngetCities :: Problem -&gt; M.Map Int City\ngetCities _ = M.singleton 0 City\n\n-- the actual sample code\n\ntype Solver a = RWST Problem Leaderboard SolutionState (MaybeT (Rand StdGen)) a\n\nlookupA :: (Alternative f, Ord k) =&gt; k -&gt; M.Map k v -&gt; f v\nlookupA k = maybe empty pure . M.lookup k\n\nrandomCity :: Solver City\nrandomCity = do\n    cits &lt;- asks getCities\n    x &lt;- getRandomR (0, M.size cits - 1)\n    lookupA x cits\n</code></pre>\n"}], "owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 2, "accepted_answer_id": 27802046, "answer_count": 1, "score": 4, "last_activity_date": 1420593181, "creation_date": 1420504517, "last_edit_date": 1420593181, "question_id": 27790314, "link": "https://stackoverflow.com/questions/27790314/monad-transformer-stacks-with-maybet-and-randt", "title": "Monad Transformer stacks with MaybeT and RandT", "body": "<p>I'm trying to learn how Monad Transformers work by re-factoring something I wrote when I first learned Haskell. It has quite a few components that could be replaced with a (rather large) stack of Monad Transformers.</p>\n\n<p>I started by writing a type alias for my stack:</p>\n\n<pre><code>type SolverT a = MaybeT\n                    (WriterT Leaderboard\n                        (ReaderT Problem\n                            (StateT SolutionState\n                                (Rand StdGen)))) a\n</code></pre>\n\n<p>A quick rundown:</p>\n\n<ul>\n<li><code>Rand</code> threads through a <code>StdGen</code> used in various random operations</li>\n<li><code>StateT</code> carries the state of the solution as it gets progressively evaluated</li>\n<li><code>ReaderT</code> has a fixed state Problem space being solved</li>\n<li><code>WriterT</code> has a leaderboard constantly updated by the solution with the best version(s) so far</li>\n<li><code>MaybeT</code> is needed because both the problem and solution state use <code>lookup</code> from <code>Data.Map</code>, and any error in how they are configured would lead to a <code>Nothing</code></li>\n</ul>\n\n<p>In the original version a <code>Nothing</code> \"never\" happened because I only used a <code>Map</code> for efficient lookups for known key/value pairs (I suppose I could refactor to use an array). In the original I got around the <code>Maybe</code> problem by making a liberal use of <code>fromJust</code>.</p>\n\n<p>From what I understand having <code>MaybeT</code> at the top means that in the event of a <code>Nothing</code> in any <code>SolverT a</code> I don't lose any of the information in my other transformers, as they are unwrapped from outside-in.</p>\n\n<p><strong>Side question</strong></p>\n\n<p>[EDIT: This was a problem because I didn't use a sandbox, so I had old/conflicting versions of libraries causing an issue]</p>\n\n<p>When I first wrote the stack I had <code>RandT</code> at the top. I decided to avoid using <code>lift</code> everywhere or writing my own instance declarations for all the other transformers for <code>RandT</code>. So I moved it to the bottom.</p>\n\n<p>I did try writing an instance declaration for <code>MonadReader</code> and this was about as much as I could get to compile:</p>\n\n<pre><code>instance (MonadReader r m,RandomGen g) =&gt; MonadReader r (RandT g m) where\n    ask = undefined\n    local = undefined\n    reader = undefined\n</code></pre>\n\n<p>I just couldn't get any combination of <code>lift</code>, <code>liftRand</code> and <code>liftRandT</code> to work in the definition. It's not particularly important but I am curious about what a valid definition might be?</p>\n\n<p><strong>Problem 1</strong></p>\n\n<p>[EDIT: This was a problem because I didn't use a sandbox, so I had old/conflicting versions of libraries causing an issue]</p>\n\n<p>Even though MonadRandom has instances of everything (except MaybeT) I still had to write my own instance declarations for each Transformer:</p>\n\n<pre><code>instance (MonadRandom m) =&gt; MonadRandom (MaybeT m) where\n    getRandom = lift getRandom\n    getRandomR = lift . getRandomR\n    getRandoms = lift getRandoms\n    getRandomRs = lift . getRandomRs\n</code></pre>\n\n<p>I did this for <code>WriterT</code>, <code>ReaderT</code> and <code>StateT</code> by copying the instances from the <a href=\"http://hackage.haskell.org/package/MonadRandom-0.3.0.1/docs/src/Control-Monad-Random.html#RandT\" rel=\"nofollow\">MonadRandom source code</a>. Note: for <code>StateT</code> and <code>WriterT</code> they do use qualified imports but not for Reader. If I didn't write my own declarations I got errors like this:</p>\n\n<pre><code>No instance for (MonadRandom (ReaderT Problem (StateT SolutionState (Rand StdGen))))\n  arising from a use of `getRandomR'\n</code></pre>\n\n<p>I'm not quite sure why this is happening.</p>\n\n<p><strong>Problem 2</strong></p>\n\n<p>With the above in hand, I re-wrote one of my functions:</p>\n\n<pre><code>randomCity :: SolverT City\nrandomCity = do\n    cits &lt;- asks getCities\n    x &lt;- getRandomR (0,M.size cits -1)\n    --rc &lt;- M.lookup x cits\n    return undefined --rc\n</code></pre>\n\n<p>The above compiles and I think is how transformers are suppose to be used. In-spite of the tedium of having to write repetitive transformer instances, this is pretty handy. You'll notice that in the above I've commented out two parts. If I remove the comments I get:</p>\n\n<pre><code>Couldn't match type `Maybe'\n              with `MaybeT\n                      (WriterT\n                         Leaderboard\n                         (ReaderT Problem (StateT SolutionState (Rand StdGen))))'\nExpected type: MaybeT\n                 (WriterT\n                    Leaderboard (ReaderT Problem (StateT SolutionState (Rand StdGen))))\n                 City\n  Actual type: Maybe City\n</code></pre>\n\n<p>At first I thought the problem was about the types of Monads that they are. All of the other Monads in the stack have a constructor for <code>(\\s -&gt; (a,s))</code> while Maybe has <code>Just a | Nothing</code>. But that shouldn't make a difference, the type for <code>ask</code> should return <code>Reader r a</code>, while <code>lookup k m</code> should give a type <code>Maybe a</code>.</p>\n\n<p>I thought I would check my assumption, so I went into GHCI and checked these types:</p>\n\n<pre><code>&gt; :t ask\nask :: MonadReader r m =&gt; m r\n&gt; :t (Just 5)\n(Just 5) :: Num a =&gt; Maybe a\n&gt; :t MaybeT 5\nMaybeT 5 :: Num (m (Maybe a)) =&gt; MaybeT m a\n</code></pre>\n\n<p>I can see that all of my other transformers define a type class that can be lifted through a transformer. <code>MaybeT</code> doesn't seem to have a <code>MonadMaybe</code> typeclass.</p>\n\n<p>I know that with <code>lift</code> I can lift something from my transformer stack into <code>MaybeT</code>, so that I can end up with <code>MaybeT m a</code>. But if I end up with <code>Maybe a</code> I assumed that I could bind it in a <code>do</code> block with <code>&lt;-</code>. </p>\n\n<p><strong>Problem 3</strong></p>\n\n<p>I actually have one more thing to add to my stack and I'm not sure where it should go. The <code>Solver</code> operates on a fixed number of cycles. I need to keep track of the current cycle vs the max cycle. I could add the cycle count to the solution state, but I'm wondering if there is an additional transformer I could add.</p>\n\n<p>Further to that, how many transformers is too many? I know this is incredibly subjective but surely there is a performance cost on these transformers? I imagine some amount of fusion can optimise this at compile time so maybe the performance cost is minimal?</p>\n"}, {"tags": ["haskell", "cabal"], "owner": {"reputation": 198, "user_id": 3662505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47a809a8525ded7a770c542b6070072?s=128&d=identicon&r=PG&f=1", "display_name": "qhfgva", "link": "https://stackoverflow.com/users/3662505/qhfgva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420499009, "creation_date": 1420499009, "question_id": 27789439, "link": "https://stackoverflow.com/questions/27789439/using-cabal-with-tsocks", "title": "using cabal with tsocks", "body": "<p>I'm able to use apt-get with my proxy like:</p>\n\n<pre><code>$ sudo tsocks apt-get install ghc\n</code></pre>\n\n<p>But trying to use with cabal:</p>\n\n<pre><code>$ sudo tsocks cabal update\n\nDownloading the latest package list from hackage.haskell.org\nWarning: http error: Network.Browser.request: Error raised ErrorClosed\ncabal: Network.Browser.request: Error raised ErrorClosed\n</code></pre>\n\n<p>Not sure who to point the finger at here.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1420497215, "post_id": 27788983, "comment_id": 43988123, "body": "The code you posted is not the code that appears in your error message.  Are you sure you&#39;ve posted the right code?  Also, <code>return prev &amp;&amp; True</code> won&#39;t work, you&#39;re looking for <code>return $ prev &amp;&amp; True</code>, which is equivalent to just <code>return prev</code>"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420497272, "post_id": 27788983, "comment_id": 43988158, "body": "You could also simplify it a bit with just <code>return $ either (const False) (const prev) result</code> instead of the case statement."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420497621, "post_id": 27788983, "comment_id": 43988285, "body": "And this works for me: <code>foldM (\\prev action -&gt; either (const prev) (const False) &lt;$&gt; action) True [return (Right 1), return (Left &quot;2&quot;), return (Right 3)]</code>, which should be equivalent to what you have.  I will point out that your <code>runAction</code> function should have the type <code>Bool -&gt; IO (Either a b) -&gt; IO Bool</code> instead."}, {"owner": {"reputation": 1843, "user_id": 1395166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57a0053b0e0fac9a23e15b8adb501ab9?s=128&d=identicon&r=PG", "display_name": "Chris Hanson", "link": "https://stackoverflow.com/users/1395166/chris-hanson"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420498708, "post_id": 27788983, "comment_id": 43988720, "body": "@bheklilr Your example isn&#39;t quite the same as what I&#39;m trying to do. I want my runAction to ignore the type of Right. So the second item in the list would be <code>return (Right &quot;2&quot;)</code> i.e.: <code>foldM (\\prev action -&gt; either (const prev) (const False) &lt;$&gt; action) True [return (Right 1), return (Right &quot;2&quot;), return (Right 3)]</code> which throws an error."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1420498850, "post_id": 27788983, "comment_id": 43988782, "body": "The problem there is your list, not your <code>runAction</code>.  You can&#39;t mix <code>Either a Int</code> and <code>Either a String</code> in a list, or even <code>IO (Either a Int)</code> and <code>IO (Either a String)</code>, all lists are homogeneous."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420498894, "post_id": 27788983, "comment_id": 43988813, "body": "Although you are correct that my example is incorrect, just that it should have been <code>foldM (\\prev action -&gt; either (const False) (const prev) &lt;$&gt; action) True</code>, I got the arguments to <code>either</code> in the wrong order."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1420505487, "post_id": 27788983, "comment_id": 43990679, "body": "Note that a simpler definition for <code>runAction</code> is just <code>fmap isRight</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 1395166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57a0053b0e0fac9a23e15b8adb501ab9?s=128&d=identicon&r=PG", "display_name": "Chris Hanson", "link": "https://stackoverflow.com/users/1395166/chris-hanson"}, "edited": false, "score": 0, "creation_date": 1420500382, "post_id": 27789546, "comment_id": 43989284, "body": "I see how <code>foldM</code> over a list won&#39;t work per your answer, but is there another pattern I could use that would allow me to reduce this code? All I want to do is perform an arbitrary number of these actions without the bookkeeping. The type will always be <code>IO (Either ByteString a)</code> but the <code>a</code> can be pretty much any type..."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1843, "user_id": 1395166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57a0053b0e0fac9a23e15b8adb501ab9?s=128&d=identicon&r=PG", "display_name": "Chris Hanson", "link": "https://stackoverflow.com/users/1395166/chris-hanson"}, "edited": false, "score": 0, "creation_date": 1420501446, "post_id": 27789546, "comment_id": 43989630, "body": "@ChrisHanson Where are the values coming from? You can&#39;t really have a heterogeneous list in the first place in Haskell (without some tricky stuff). If you just want to ignore the <code>Right</code> values, you could make them all the same type with <code>void</code> (<a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Control-Monad.html#v:void\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.7.0.2/docs/&hellip;</a> )."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420542614, "post_id": 27789546, "comment_id": 44003350, "body": "Why use <code>Either</code> and not <code>Maybe</code>?"}, {"owner": {"reputation": 1843, "user_id": 1395166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57a0053b0e0fac9a23e15b8adb501ab9?s=128&d=identicon&r=PG", "display_name": "Chris Hanson", "link": "https://stackoverflow.com/users/1395166/chris-hanson"}, "edited": false, "score": 0, "creation_date": 1420558961, "post_id": 27789546, "comment_id": 44012810, "body": "The actions I want to chain all come from a third party library (namely hedis) which uses <code>Either</code>. I&#39;m actually interested in the value if it&#39;s on the <code>Left</code>, but if it&#39;s on the <code>Right</code>, I don&#39;t actually care what&#39;s in there."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 1843, "user_id": 1395166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57a0053b0e0fac9a23e15b8adb501ab9?s=128&d=identicon&r=PG", "display_name": "Chris Hanson", "link": "https://stackoverflow.com/users/1395166/chris-hanson"}, "edited": false, "score": 1, "creation_date": 1420559121, "post_id": 27789546, "comment_id": 44012922, "body": "@ChrisHanson Your best bet is probably to use <code>Data.Either.isRight</code> and <code>fmap</code> to convert the types for you, then you can <code>fmap and . sequence</code> to fold over your list of <code>IO Bool</code>s."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 2, "last_activity_date": 1420505557, "last_edit_date": 1420505557, "creation_date": 1420499648, "answer_id": 27789546, "question_id": 27788983, "link": "https://stackoverflow.com/questions/27788983/can-i-ignore-the-type-of-either-right-if-im-ignoring-the-value/27789546#27789546", "title": "Can I ignore the type of Either Right if I&#39;m ignoring the value?", "body": "<p>Your problem comes from the types of <code>actA</code> and <code>actB</code> being in the same list.  Lists in Haskell are homogenous, you can't mix elements of different types.  <code>actA</code> and <code>actB</code> have explicitly different types, there's no possible way for the types to be unified.  You can't have the type <code>[Either a1 b1, Either a2 b2]</code>, this sort of thing just doesn't exist (without a lot of extensions and type system magic, anyway).</p>\n"}], "owner": {"reputation": 1843, "user_id": 1395166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57a0053b0e0fac9a23e15b8adb501ab9?s=128&d=identicon&r=PG", "display_name": "Chris Hanson", "link": "https://stackoverflow.com/users/1395166/chris-hanson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 27789546, "answer_count": 1, "score": 1, "last_activity_date": 1420505557, "creation_date": 1420496841, "last_edit_date": 1420498159, "question_id": 27788983, "link": "https://stackoverflow.com/questions/27788983/can-i-ignore-the-type-of-either-right-if-im-ignoring-the-value", "title": "Can I ignore the type of Either Right if I&#39;m ignoring the value?", "body": "<p>I have an IO action that runs the following pattern three times in a row:</p>\n\n<pre><code>runAction :: IO a -&gt; IO Bool\nrunAction action = do\n  result &lt;- action\n  case result of\n    Right _ -&gt; return True\n    _ -&gt; return False\n\ncallingFunc :: IO Bool\ncallingFunc = do\n  resA &lt;- runAction a\n  resB &lt;- runAction b\n  resC &lt;- runAction c\n  return (resA &amp;&amp; resB &amp;&amp; resC)\n\n\na :: IO (Either ByteString Integer)\nb :: IO (Either ByteString ByteString)\nc :: IO (Either ByteString Bool)\n</code></pre>\n\n<p>This works fine, but I'd like to eliminate some redundancy. This doesn't work because of the type of the Right side of Either:</p>\n\n<pre><code>  {-# LANGUAGE OverloadedStrings #-}\n\n  import Control.Monad\n  import Data.ByteString.Char8 as BSC \n\n\n  runAction :: Bool -&gt; IO (Either ByteString a) -&gt; IO Bool\n  runAction prev action = do\n    result &lt;- action\n    case result of\n      Right _ -&gt; return prev\n      _ -&gt; return False\n\n\n  actA :: IO (Either ByteString Integer)\n  actA = return (Right 1)\n\n\n  actB :: IO (Either ByteString Bool)\n  actB = return (Right True)\n\n\n  main :: IO ()\n  main = do\n    res &lt;- foldM runAction True [actA, actB]\n    print res \n</code></pre>\n\n<p>Resulting error:</p>\n\n<pre><code>Actions.hs:25:38:\n    Couldn't match type \u2018Bool\u2019 with \u2018Integer\u2019\n    Expected type: IO (Either ByteString Integer)\n      Actual type: IO (Either ByteString Bool)\n    In the expression: actB\n    In the third argument of \u2018foldM\u2019, namely \u2018[actA, actB]\u2019\n</code></pre>\n\n<p>But I never actually look at the value. I just check if I got Right or not.</p>\n\n<p>Is there any way for me to hide or ignore the type of the Right of Either? Is there a better or more idiomatic way to reduce or abstract this?</p>\n\n<p>EDIT: Sorry, must have pasted an old copy of code. Updated.</p>\n"}, {"tags": ["haskell", "tuples", "reverse", "huffman-code"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1420495587, "post_id": 27788688, "comment_id": 43987443, "body": "<code>\\xs -&gt; let (a,b) = unzip xs in zip a (reverse b)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 1909658, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cfMSw.png?s=128&g=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/1909658/bradley"}, "is_accepted": true, "score": 1, "last_activity_date": 1420496336, "creation_date": 1420496336, "answer_id": 27788888, "question_id": 27788688, "link": "https://stackoverflow.com/questions/27788688/how-do-i-reverse-a-tuple-in-haskell/27788888#27788888", "title": "How do I reverse a tuple in Haskell", "body": "<p>As you have said yourself, you need to use the <a href=\"https://www.haskell.org/hoogle/?hoogle=reverse\" rel=\"nofollow\">reverse</a> function. Wherever you have your code to form the list of tuples, encapsulate that code in a reverse function using brackets <code>(reverse(code))</code> or <code>reverse $ &lt;code&gt;</code> and the result will be the reverse.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 43, "user_id": 3416196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1346483526/picture?type=large", "display_name": "Howard", "link": "https://stackoverflow.com/users/3416196/howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2648, "favorite_count": 0, "accepted_answer_id": 27788888, "answer_count": 1, "score": 1, "last_activity_date": 1420496336, "creation_date": 1420495450, "last_edit_date": 1492087139, "question_id": 27788688, "link": "https://stackoverflow.com/questions/27788688/how-do-i-reverse-a-tuple-in-haskell", "title": "How do I reverse a tuple in Haskell", "body": "<p>I am having trouble figuring out how to reverse a tuple, below is my code:</p>\n\n<pre><code>extractCode :: HTree -&gt; HCodeMap \nextractCode t = extractCodeInner t []\n  where extractCodeInner (Leaf _ c) bits = [(c, [])]\n        extractCodeInner (Branch _ left right) bits = map (addBit Zero) (extractCode left ) ++ map (addBit One) (extractCode right)\n        where addBit b = second $ ( b : )\n</code></pre>\n\n<p>Where HTree is defined as an Int (The frequency of a character occurring in a String) and Char from the String:</p>\n\n<pre><code>data HTree = Branch Int HTree HTree | Leaf Int Char \n             deriving (Show, Eq)\n</code></pre>\n\n<p>and HCodeMap is:</p>\n\n<pre><code>type HCodeMap = [(Char, [Bit])]\n</code></pre>\n\n<p>Where the Char is a character from the tree and [Bit] is:</p>\n\n<pre><code>data Bit = Zero | One deriving (Show, Eq)\n</code></pre>\n\n<p>Now when I pass the tree of the string \"aaabbc\"</p>\n\n<p>I get:</p>\n\n<pre><code>[('c',[Zero, Zero]),('b',[Zero, One]),('a',[One])]\n</code></pre>\n\n<p>What I would like to do is reverse all of the items in the round bracket list (), such that it will look like this:</p>\n\n<pre><code>[('a',[One]),('b',[Zero, One]),('c',[Zero, Zero])]\n</code></pre>\n\n<p>I tried to using the sort . reverse I found in this article but I'm not sure how to\n<a href=\"https://codegolf.stackexchange.com/questions/3571/descending-sort-using-standard-ascending-sort-function\">https://codegolf.stackexchange.com/questions/3571/descending-sort-using-standard-ascending-sort-function</a></p>\n\n<p>And I previously used a sortby( compare 'on' snd) function but trying to change this to reverse isn't that easy to work through in my head.</p>\n\n<p>I am relatively new to Haskell, so I am sorry if this is a stupid question. Its just really easy to do on a normal list but I can't visualize how I would do it on a tuple.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["haskell", "recursion", "data-structures", "tree", "complexity-theory"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1420482394, "post_id": 27784506, "comment_id": 43981087, "body": "<a href=\"https://hackage.haskell.org/package/dlist-0.3/docs/Data-DList.html\" rel=\"nofollow noreferrer\"><code>DList</code></a> should emulate the performance of the global solution you describe -- it&#39;s the functional equivalent of mutating a list cons (as long as it is only consumed once)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1420482789, "post_id": 27784506, "comment_id": 43981281, "body": "... I&#39;m not sure how? I&#39;d love to see an answer! :) also - if you just use the list monad like this: &quot;do { x &lt;- map f xs; x }&quot;, and then, on the most deep iteration, cons to a normal list on IORef, would this do what I want?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user395760"}, "edited": false, "score": 0, "creation_date": 1420479854, "post_id": 27784765, "comment_id": 43979837, "body": "One invocation of <code>concat</code> takes O(n) time, but since it&#39;s being used at each level of recursion, the complexity of <code>paths</code> is worse (I&#39;m too lazy to figure out what exactly). Also, &quot;terrible&quot; is relative, but there are certainly persistent sequential containers with better (logarithmic or amortized constant, for concatenating two lists) complexity."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1420480474, "post_id": 27784765, "comment_id": 43980118, "body": "@delnan, the <code>concat</code> is applied at each level to the elements one level below, so the sum of all the steps in the concats follows the total number of elements in the tree."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1420482461, "post_id": 27784765, "comment_id": 43981124, "body": "Thanks for the answer! But I do think that it can be done in constant time per iteration - maybe using ST - since you can in another language. I&#39;ve edited the main post with what I have in mind. Thanks again!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1420482814, "post_id": 27784765, "comment_id": 43981289, "body": "@Viclib, I&#39;m not sure what you mean by &quot;per iteration&quot;. The solution I gave is <code>O(n)</code>, where <code>n</code> is the total number of elements in the tree. There is no way to do better than that in any language."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1420482865, "post_id": 27784765, "comment_id": 43981322, "body": "No, I mean - your solution involves using another data structure. If I get it, it is perfectly fine and a great way to do it - but I&#39;m specifically asking if this can be done with lists alone. Mostly for learning purposes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user395760"}, "edited": false, "score": 2, "creation_date": 1420483753, "post_id": 27784765, "comment_id": 43981723, "body": "@dfeuer Not the elements are concatenated, the results of <code>paths element</code>, which includes many copies of said elements (except for leaves). In fact, the root of a full binary tree with depth d, there are 2 child elements but <code>concat $ map paths elements</code> has 2^(d-1) elements, give or take a few, most of which have already been copied several times by previous <code>concat</code> calls."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420487479, "post_id": 27784765, "comment_id": 43983481, "body": "@delnan, it should be fixed now. Sorry about that."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 7, "last_activity_date": 1420487457, "last_edit_date": 1420487457, "creation_date": 1420479184, "answer_id": 27784765, "question_id": 27784506, "link": "https://stackoverflow.com/questions/27784506/what-is-the-proper-efficient-way-to-write-this-function/27784765#27784765", "title": "What is the proper (efficient) way to write this function?", "body": "<p><code>concat</code> does not have terrible complexity; it is <code>O(n)</code>, where <code>n</code> is the total number of elements in each list but the last. In this case, I don't think it's possible to do any better, with or without an intermediate structure, unless you change the type of the result. The list of lists, in this context, offers absolutely no potential for sharing, so you have no choice but to allocate each \"cons\" of each list. The <code>concatMap</code> only adds a constant factor overhead, and I'd be surprised if you could find a way to reduce that significantly.</p>\n\n<p>If you want to use some sharing (at the cost of structural laziness), you can indeed switch to a different data structure. This will only matter if the tree is somewhat \"bushy\". Any sequence type supporting <code>snoc</code> will do. At the simplest, you can even use lists <em>in reverse</em>, so you get paths leading from the leaves to the root instead of the other way around. Or you can use something more flexible like <code>Data.Sequence.Seq</code>:</p>\n\n<pre><code>import qualified Data.Sequence as S\nimport Data.Sequence ((|&gt;), Seq)\nimport qualified Data.DList as DL\nimport Data.Tree\n\npaths :: Tree a -&gt; [Seq a]\npaths = DL.toList . go S.empty\n  where\n    go s (Node a []) = DL.singleton (s |&gt; a)\n    go s (Node a xs) = let sa = s |&gt; a\n                       in sa `seq` DL.concat . map (go sa) $ xs\n</code></pre>\n\n<h3>Edit</h3>\n\n<p>As Viclib and delnan point out, there was a problem with my original answer, because the bottom level got traversed multiple times.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420565300, "post_id": 27788324, "comment_id": 44016772, "body": "exactly. <code>foldl (++)</code> is bad; <code>foldr (++)</code> (and so, <code>concat</code>) is perfectly fine."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420569572, "post_id": 27788324, "comment_id": 44019036, "body": "I think your trees are much too small to reflect some of the differences between these algorithms. Using fewer benchmarks of deeper/bushier trees may be interesting. It would also be good to add a <code>revList</code> version using <code>DList</code> (or something). I say &quot;or something&quot; because I&#39;m also trying to find a nice way to transform the <code>DList</code>s away while using that same essential algorithm."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420575101, "post_id": 27788324, "comment_id": 44021801, "body": "@dfeuer: my 6-branching 8-depth tree has 6^8 ~ 1,6 million nodes, that&#39;s surely not too small! Anyway, I added results for wide and deep trees too, and the overall picture remains the same."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420586206, "post_id": 27788324, "comment_id": 44026801, "body": "Interesting. I&#39;m still trying to understand why the <code>DList</code>s are hurting performance for the reversed lists. I&#39;ll need to think about this more."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 6, "last_activity_date": 1420574910, "last_edit_date": 1420574910, "creation_date": 1420493827, "answer_id": 27788324, "question_id": 27784506, "link": "https://stackoverflow.com/questions/27784506/what-is-the-proper-efficient-way-to-write-this-function/27788324#27788324", "title": "What is the proper (efficient) way to write this function?", "body": "<p>Let's benchmark:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nimport Control.DeepSeq\nimport Criterion.Main\nimport Data.Sequence ((|&gt;), Seq)\nimport Data.Tree\nimport GHC.DataSize\nimport qualified Data.DList as DL\nimport qualified Data.Sequence as S\n\n-- original version\npathsList :: Tree a -&gt; [[a]]\npathsList = go where\n  go (Node element []) = [[element]]\n  go (Node element children) = map (element:) (concatMap go children)\n\n-- with reversed lists, enabling sharing of path prefixes\npathsRevList :: Tree a -&gt; [[a]]\npathsRevList = go [] where\n  go acc (Node a []) = [a:acc]\n  go acc (Node a xs) = concatMap (go (a:acc)) xs\n\n-- dfeuer's version\npathsSeqDL :: Tree a -&gt; [Seq a]\npathsSeqDL = DL.toList . go S.empty\n  where\n    go s (Node a []) = DL.singleton (s |&gt; a)\n    go s (Node a xs) = let sa = s |&gt; a\n                       in sa `seq` DL.concat . map (go sa) $ xs\n\n-- same as previous but without DLists. \npathsSeq :: Tree a -&gt; [Seq a]\npathsSeq = go S.empty where\n  go acc (Node a []) = [acc |&gt; a]\n  go acc (Node a xs) = let acc' = acc |&gt; a\n                       in acc' `seq` concatMap (go acc') xs\n\ngenTree :: Int -&gt; Int -&gt; Tree Int\ngenTree branch depth = go 0 depth where\n  go n 0 = Node n []\n  go n d = Node n [go n' (d - 1) | n' &lt;- [n .. n + branch - 1]]\n\nmemSizes = do\n  let !tree = force $ genTree 4 4      \n  putStrLn \"sizes in memory\"\n  putStrLn . (\"list: \"++) . show =&lt;&lt; (recursiveSize $!! pathsList tree)\n  putStrLn . (\"listRev: \"++) . show =&lt;&lt; (recursiveSize $!! pathsRevList tree)\n  putStrLn . (\"seq: \"++) . show =&lt;&lt; (recursiveSize $!! pathsSeq tree)\n  putStrLn . (\"tree itself: \"++) . show =&lt;&lt; (recursiveSize $!! tree)\n\nbenchPaths !tree = do\n  defaultMain [\n    bench \"pathsList\" $ nf pathsList tree,\n    bench \"pathsRevList\" $ nf pathsRevList tree,\n    bench \"pathsSeqDL\" $ nf pathsSeqDL tree,\n    bench \"pathsSeq\" $ nf pathsSeq tree\n    ]  \n\nmain = do\n  memSizes\n  putStrLn \"\"\n  putStrLn \"normal tree\"\n  putStrLn \"-----------------------\"\n  benchPaths (force $ genTree 6 8)\n  putStrLn \"\\ndeep tree\"\n  putStrLn \"-----------------------\"  \n  benchPaths (force $ genTree 2 20)\n  putStrLn \"\\nwide tree\"\n  putStrLn \"-----------------------\"  \n  benchPaths (force $ genTree 35 4)  \n</code></pre>\n\n<p>Some notes:</p>\n\n<ul>\n<li>I benchmark on on GHC 7.8.4 with -O2 and -fllvm. </li>\n<li>I fill the tree in <code>genTree</code> with some <code>Int</code>-s in order to prevent GHC optimization causing subtrees to be shared.</li>\n<li>In <code>memSizes</code> the tree must be pretty small, because <code>recursiveSize</code> has quadratic complexity. </li>\n</ul>\n\n<p>Results on my Core i7 3770:</p>\n\n<pre><code>sizes in memory\nlist: 37096\nlistRev: 14560\nseq: 26928\ntree itself: 16576\n\nnormal tree\n-----------------------\npathsList               372.9 ms   \npathsRevList            213.6 ms   \npathsSeqDL              962.2 ms   \npathsSeq                308.8 ms   \n\ndeep tree\n-----------------------\npathsList               554.1 ms   \npathsRevList            266.7 ms   \npathsSeqDL              919.8 ms   \npathsSeq                438.4 ms   \n\nwide tree\n-----------------------\npathsList               191.6 ms   \npathsRevList            129.1 ms   \npathsSeqDL              448.2 ms   \npathsSeq                157.3 ms  \n</code></pre>\n\n<p>Comments:</p>\n\n<ul>\n<li>I am entirely unsurprised. The original version with lists is asymptotically optimal for the job. Also, it makes sense to use <code>DList</code> only when we would otherwise have inefficient list appends, but it's not the case here. </li>\n<li>Note that the list of reversed paths takes less space than the tree itself.</li>\n<li>The performance patterns are consistent over differently shaped trees. In the \"deep tree\" case <code>Seq</code> performs relatively worse, presumably because <code>Seq</code> snoc is costlier than list cons. </li>\n<li>I think a Clojure-style persistent vector (Int-indexed shallow tries) would be nice here, since they can be pretty fast, can possibly have less space overhead than plain lists and support efficient snoc and random reads/writes. In comparison, <code>Seq</code> is heavier in weight, though it supports a wider range of efficient operations.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 4048, "user_id": 417166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d335ffc02805c8c5deb38bdaabfa3e73?s=128&d=identicon&r=PG", "display_name": "blaze", "link": "https://stackoverflow.com/users/417166/blaze"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1420505888, "post_id": 27789493, "comment_id": 43990780, "body": "Actually, your code returns paths not to the deepest nodes, but to the all leaf nodes, depth isn&#39;t taken into account at all."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1420564672, "post_id": 27789493, "comment_id": 44016452, "body": "... yes, that is what I mean. I meant terminal nodes. I&#39;m not a native english speaker, but I see your confusion."}], "tags": [], "owner": {"reputation": 4048, "user_id": 417166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d335ffc02805c8c5deb38bdaabfa3e73?s=128&d=identicon&r=PG", "display_name": "blaze", "link": "https://stackoverflow.com/users/417166/blaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1420499333, "creation_date": 1420499333, "answer_id": 27789493, "question_id": 27784506, "link": "https://stackoverflow.com/questions/27784506/what-is-the-proper-efficient-way-to-write-this-function/27789493#27789493", "title": "What is the proper (efficient) way to write this function?", "body": "<p>Speaking of algorithm optimization, not code optimization: tree by definition has only one path from root to any node, there is no need to return a list in first place. It only makes sense if you want to return paths to all deepest nodes, if there are many of them on the same depth.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 27784765, "answer_count": 3, "score": 2, "last_activity_date": 1420574910, "creation_date": 1420478027, "last_edit_date": 1420482277, "question_id": 27784506, "link": "https://stackoverflow.com/questions/27784506/what-is-the-proper-efficient-way-to-write-this-function", "title": "What is the proper (efficient) way to write this function?", "body": "<p>The following function returns a list of possible paths starting from the root node to the deepest node of a tree: </p>\n\n<pre><code>paths :: Tree a -&gt; [[a]]\npaths (Node element []) = [[element]]\npaths (Node element children) = map (element :) $ concat $ map paths children\n</code></pre>\n\n<p>This looks very inefficient on paper, since <code>concat</code> has terrible complexity. Can this function be rewritten in a way that keeps the complexity lower without using intermediate data structures (like sequence)? </p>\n\n<p>EDIT: to be honest, I know one could avoid the O(n)/loop complexity of concat by:</p>\n\n<ol>\n<li>Building the path (list) as you go down on the recursion;</li>\n<li>Only when you reach the last recursion level, append the path to a global \"result\" list.</li>\n</ol>\n\n<p>Here is a JavaScript implementation that illustrates this algorithm:</p>\n\n<pre><code>function paths(tree){\n    var result = [];\n    (function go(node,path){\n        if (node.children.length === 0)\n            result.push(path.concat([node.tag]));\n        else\n            node.children.map(function(child){\n                go(child,path.concat([node.tag]));\n            });\n    })(tree,[]);\n    return result;\n}\nconsole.log(paths(\n    {tag: 1,\n    children:[\n        {tag: 2, children: [{tag: 20, children: []}, {tag: 200, children: []}]},\n        {tag: 3, children: [{tag: 30, children: []}, {tag: 300, children: []}]},\n        {tag: 4, children: [{tag: 40, children: []}, {tag: 400, children: []}]}]}));\n</code></pre>\n\n<p><em>(It is not actually O(1)/iteration since I used <code>Array.concat</code> instead of lists consing (JS has no built-in lists), but just using it instead would make it constant-time per iteration.)</em></p>\n"}, {"tags": ["haskell", "expression"], "comments": [{"owner": {"reputation": 10246, "user_id": 762363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cec6320f5a5a8253b3dbfbb8177e001?s=128&d=identicon&r=PG", "display_name": "Tarmil", "link": "https://stackoverflow.com/users/762363/tarmil"}, "edited": false, "score": 2, "creation_date": 1420472718, "post_id": 27782871, "comment_id": 43975668, "body": "This does look like an indentation problem. Have you checked for tab characters? IIRC Haskell interprets them as &quot;tab to next multiple of 8 spaces&quot;, maybe your editor does differently."}, {"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1420472865, "post_id": 27782871, "comment_id": 43975758, "body": "<code>button &lt;- eventButton;</code> :D"}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "reply_to_user": {"reputation": 10246, "user_id": 762363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cec6320f5a5a8253b3dbfbb8177e001?s=128&d=identicon&r=PG", "display_name": "Tarmil", "link": "https://stackoverflow.com/users/762363/tarmil"}, "edited": false, "score": 0, "creation_date": 1420472885, "post_id": 27782871, "comment_id": 43975773, "body": "Checked with <code>ghc</code> and the code you pasted here seems OK as far as indentation is concerned, so there&#39;s probably some invisible character and/or tabs like @Tarmil suggested.  I suspect the code was not pasted into the question properly."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1420473816, "post_id": 27782871, "comment_id": 43976354, "body": "Apologies, folks. I had removed all tabs in my previous edit. I&#39;ve restored the OP&#39;s code to its original form."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 4, "creation_date": 1420474410, "post_id": 27782871, "comment_id": 43976730, "body": "FYI The StackOverflow engine converts tabs into four spaces when it renders the MarkDown source as HTML, however when you click &quot;edit&quot; and look at the original source, there are tabs there."}, {"owner": {"reputation": 13, "user_id": 4420608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58eb4a24d1017e3013262a95973af508?s=128&d=identicon&r=PG&f=1", "display_name": "JoJoD", "link": "https://stackoverflow.com/users/4420608/jojod"}, "reply_to_user": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1420476609, "post_id": 27782871, "comment_id": 43978044, "body": "@d12frosted Your solution is indeed the correct one. Could you give an explanation why to use the &quot;;&quot; because i don&#39;t think you need to type the &quot;;&quot; after every line"}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 3, "creation_date": 1420477809, "post_id": 27782871, "comment_id": 43978761, "body": "@JoJoD It works because indentation is a sort of implicit <code>{</code>, <code>;</code> &amp; <code>}</code> and you can give them explicitly if you want. The problem is indentation, and you can see it if you set your editor&#39;s tab stops to 8, or replace all your tabs with spaces. See <a href=\"http://stackoverflow.com/a/27714157/1598537\">stackoverflow.com/a/27714157/1598537</a>"}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1420492914, "post_id": 27782871, "comment_id": 43986113, "body": "Why did you comment the <code>main</code> function type out? Why?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4420608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58eb4a24d1017e3013262a95973af508?s=128&d=identicon&r=PG&f=1", "display_name": "JoJoD", "link": "https://stackoverflow.com/users/4420608/jojod"}, "edited": false, "score": 0, "creation_date": 1420484257, "post_id": 27785818, "comment_id": 43981952, "body": "Not good because the extrafunctie is in the main function ==&gt; can&#39;t do  that (parse error on =)"}, {"owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "reply_to_user": {"reputation": 13, "user_id": 4420608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58eb4a24d1017e3013262a95973af508?s=128&d=identicon&r=PG&f=1", "display_name": "JoJoD", "link": "https://stackoverflow.com/users/4420608/jojod"}, "edited": false, "score": 1, "creation_date": 1420486459, "post_id": 27785818, "comment_id": 43982972, "body": "Thought my indentation would make a difference. Looking forward to the answer."}], "tags": [], "owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "is_accepted": false, "score": -1, "last_activity_date": 1420484449, "last_edit_date": 1420484449, "creation_date": 1420483413, "answer_id": 27785818, "question_id": 27782871, "link": "https://stackoverflow.com/questions/27782871/haskell-do-block-last-statement-must-be-expression/27785818#27785818", "title": "Haskell: Do block, last statement must be expression", "body": "<p>How's the following?</p>\n\n<pre><code>import Graphics.UI.Gtk\nimport Control.Monad.IO.Class \n\n--main::IO()\nmain = do\n  initGUI\n  window &lt;- windowNew\n  button &lt;- buttonNewWithLabel \"button\"\n  on button buttonPressEvent (tryEvent (do button &lt;- eventButton\n                                         liftIO (extrafunctie button)\n                                         ))                                      \n  containerAdd window button\n  onDestroy window mainQuit\n  widgetShowAll window\n  mainGUI\n\nextrafunctie b = if (RightButton == b) \n           then putStrLn \"True\"\n           else putStrLn \"False\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": false, "score": 1, "last_activity_date": 1420492614, "creation_date": 1420492614, "answer_id": 27788050, "question_id": 27782871, "link": "https://stackoverflow.com/questions/27782871/haskell-do-block-last-statement-must-be-expression/27788050#27788050", "title": "Haskell: Do block, last statement must be expression", "body": "<p>Your indentation is terrible, that's the problem. You need to replace this:</p>\n\n<pre><code>on button buttonPressEvent (tryEvent (do button &lt;- eventButton\n\n                                         liftIO (extrafunctie button)\n                                         ))  \n</code></pre>\n\n<p>with:</p>\n\n<pre><code>on button buttonPressEvent $\n    tryEvent $ do \n        button &lt;- eventButton\n        liftIO (extrafunctie button)\n</code></pre>\n\n<p>Also you can replace your <code>extrafunctie</code> function with:</p>\n\n<pre><code>extrafunctie b = print (RightButton == b)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "is_accepted": true, "score": 0, "last_activity_date": 1420493709, "creation_date": 1420493709, "answer_id": 27788296, "question_id": 27782871, "link": "https://stackoverflow.com/questions/27782871/haskell-do-block-last-statement-must-be-expression/27788296#27788296", "title": "Haskell: Do block, last statement must be expression", "body": "<p>Here's how the compiler sees your code, with tabstops at 8 character intervals.\nI'll show a tab as <code>-------|</code> and spaces as <code>.</code>:</p>\n\n<pre><code>&gt;....import Graphics.UI.Gtk\n&gt;....import Control.Monad.IO.Class \n&gt;\n&gt;....--main::IO()\n&gt;....main = do\n&gt;....-|initGUI\n\n&gt;...--|window &lt;- windowNew\n\n&gt;....-|button &lt;- buttonNewWithLabel \"button\"\n\n&gt;....-|on button buttonPressEvent (tryEvent (do button &lt;- eventButton\n\n&gt;....-|------|------|------|------|------|------|------|------|------|..----|.liftIO (extrafunctie button)\n&gt;....-|------|------|------|------|------|------|------|------|------|.....))                                           \n&gt;....-|containerAdd window button\n\n&gt;....-|onDestroy window mainQuit\n\n&gt;....-|widgetShowAll window\n\n&gt;....-|mainGUI\n&gt;\n&gt;....extrafunctie b = if (RightButton == b) \n&gt;....-|------|------|------|.then putStrLn \"True\"\n&gt;....-|------|------|------|.else putStrLn \"False\"\n</code></pre>\n\n<p>As you can see, the compiler sees the <code>liftIO (extrafunctie</code> bit as much further to the right.\nIf you use spaces to lay out your work this can't happen:</p>\n\n<pre><code>&gt;    import Graphics.UI.Gtk\n&gt;    import Control.Monad.IO.Class \n&gt;\n&gt;    --main::IO()\n&gt;    main = do\n&gt;      initGUI\n&gt;      window &lt;- windowNew\n&gt;      button &lt;- buttonNewWithLabel \"button\"\n&gt;      on button buttonPressEvent (tryEvent (do button &lt;- eventButton\n&gt;                                               liftIO (extrafunctie button)\n&gt;                                               ))                                             \n&gt;      containerAdd window button\n&gt;      onDestroy window mainQuit\n&gt;      widgetShowAll window\n&gt;      mainGUI\n&gt;\n&gt;    extrafunctie b = if (RightButton == b) \n&gt;                  then putStrLn \"True\"\n&gt;                  else putStrLn \"False\"\n</code></pre>\n\n<h2>It's easiest if you stick to spaces. Change your editor's settings.</h2>\n\n<p>If you use just spaces without any tabs at all, you can't get this problem, because your editor has to show it the way the compiler thinks about it.</p>\n\n<p>My editor lets me specify that when I press tab, it should insert the number of spaces that a tab would show as, so I use that, which is safe for a tabstop of 4. If your editor can do that, use that option. (If not, consider getting a cleverer editor for when you're programming.)</p>\n\n<p>My editor also has auto indent and outdent, where the next line copies the whitespace indentation of the previous line - this avoids the problem. Turn this on if your editor supports it, because it saves you effort and you're less likely to get the parse error. (When I then press backspace, my editor deletes back to the previous level of indentation, which is nice.)</p>\n\n<p>Almost all editors can change how they display tabs. If you can't get it to use spaces for tabs, you should change the tabstop to be 8, because that matches ghc, and you're much less likely to get this error, but you're still better off using spaces.</p>\n"}], "owner": {"reputation": 13, "user_id": 4420608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58eb4a24d1017e3013262a95973af508?s=128&d=identicon&r=PG&f=1", "display_name": "JoJoD", "link": "https://stackoverflow.com/users/4420608/jojod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1356, "favorite_count": 0, "accepted_answer_id": 27788296, "answer_count": 3, "score": 1, "last_activity_date": 1420493709, "creation_date": 1420472560, "last_edit_date": 1420474102, "question_id": 27782871, "link": "https://stackoverflow.com/questions/27782871/haskell-do-block-last-statement-must-be-expression", "title": "Haskell: Do block, last statement must be expression", "body": "<p>I want to know the difference when I right or left click on a button. I wrote the following code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Graphics.UI.Gtk\nimport Control.Monad.IO.Class \n\n--main::IO()\nmain = do\n    initGUI\n\nwindow &lt;- windowNew\n\n    button &lt;- buttonNewWithLabel \"button\"\n\n    on button buttonPressEvent (tryEvent (do button &lt;- eventButton\n\n                                             liftIO (extrafunctie button)\n                                             ))                                         \n    containerAdd window button\n\n    onDestroy window mainQuit\n\n    widgetShowAll window\n\n    mainGUI\n\nextrafunctie b = if (RightButton == b) \n                 then putStrLn \"True\"\n                 else putStrLn \"False\"\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>jolien@jolien-VirtualBox:~/Documenten/haskell$ ghc --make test.hs -o test\n[1 of 1] Compiling Main             ( test.hs, test.o )\n\ntest.hs:9:50:\n    The last statement in a 'do' block must be an expression\n      button &lt;- eventButton liftIO (extrafunctie button)\n</code></pre>\n\n<p>I've looked at my indentation, which is correct. Does someone know a solution?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 6, "creation_date": 1420464616, "post_id": 27780378, "comment_id": 43970994, "body": "I am wondering, which error?"}, {"owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "reply_to_user": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1420466241, "post_id": 27780378, "comment_id": 43971935, "body": "My yesod server application is running. I send request to server.In console no log message. I dont&#39;t know what&#39;s going on. How to diagnose the error?"}, {"owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "reply_to_user": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1420466493, "post_id": 27780378, "comment_id": 43972076, "body": "The error occurs not always, from time to time."}, {"owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "reply_to_user": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1420466602, "post_id": 27780378, "comment_id": 43972142, "body": "What should I do to find out where the error occurs?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1420467488, "post_id": 27780378, "comment_id": 43972599, "body": "Can you make a small, repeatable example?  What&#39;s the minimal amount of code you can write to cause this error, and what is your full setup?  It might be a problem with your OS setup, your hardware, or some other small thing.  Intermittent bugs like this are really hard to track down, and virtually impossible with the sparse information you&#39;ve provided."}, {"owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "edited": false, "score": 2, "creation_date": 1420468534, "post_id": 27780378, "comment_id": 43973233, "body": "Error in Windows Event Viewer: Application name: yesod.exe, version: 0.0.0.0 Module name: ntdll.dll, \u0432\u0435\u0440\u0441\u0438\u044f: 6.1.7601.18247 Exception code: 0xc0000374 Exception offset: 0x00000000000c4102 Application path: C:\\Users\\Bet\\AppData\\Roaming\\cabal\\bin\\yesod.exe Module Path: C:\\Windows\\SYSTEM32\\ntdll.dll"}, {"owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "edited": false, "score": 2, "creation_date": 1420468885, "post_id": 27780378, "comment_id": 43973427, "body": "Error code 0xc0000374 is heap curruption."}, {"owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "edited": false, "score": 0, "creation_date": 1420744871, "post_id": 27780378, "comment_id": 44099486, "body": "Probably it is ghc bug? <a href=\"https://ghc.haskell.org/trac/ghc/ticket/7919\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/7919</a>"}], "owner": {"reputation": 329, "user_id": 971883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab5062317cc23f37e24ff80f0b6261e8?s=128&d=identicon&r=PG", "display_name": "Bet", "link": "https://stackoverflow.com/users/971883/bet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420473656, "creation_date": 1420463824, "last_edit_date": 1420473656, "question_id": 27780378, "link": "https://stackoverflow.com/questions/27780378/yesod-crashes-with-heap-corruption", "title": "Yesod crashes with heap corruption", "body": "<p>I installed a fresh version of the Haskell Platfrom and Yesod (from Stackage Nightly) on Windows 7.<br>\nDuring development the yesod application crashes.</p>\n\n<p>The Windows Eventlog has the following entry:</p>\n\n<pre><code>Application name: yesod.exe, version: 0.0.0.0\nModule name: ntdll.dll, \u0432\u0435\u0440\u0441\u0438\u044f: 6.1.7601.18247\nException code: 0xc0000374\nException offset: 0x00000000000c4102\nApplication path: C:\\Users\\Bet\\AppData\\Roaming\\cabal\\bin\\yesod.exe\nModule Path: C:\\Windows\\SYSTEM32\\ntdll.dll \n</code></pre>\n\n<p>The error occurs when I send a request to the server. No log messages in console. How to detect why yesod crashes?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "edited": false, "score": 26, "creation_date": 1420463509, "post_id": 27780282, "comment_id": 43970327, "body": "<a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/defer-type-errors.html\" rel=\"nofollow noreferrer\"><code>:set -fdefer-type-errors</code></a>"}, {"owner": {"reputation": 41142, "user_id": 262667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dd09cc9b40b956f93a00f5b464469d11?s=128&d=identicon&r=PG", "display_name": "Olivier Verdier", "link": "https://stackoverflow.com/users/262667/olivier-verdier"}, "reply_to_user": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "edited": false, "score": 1, "creation_date": 1420463724, "post_id": 27780282, "comment_id": 43970465, "body": "Oooh! exactly what I needed! Thanks!!"}, {"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "reply_to_user": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "edited": false, "score": 12, "creation_date": 1420464691, "post_id": 27780282, "comment_id": 43971029, "body": "@MikhailGlushenkov create answer with links :D"}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1421769704, "post_id": 28030127, "comment_id": 44481637, "body": "Oh my god <i>I need this</i>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1421769884, "post_id": 28030127, "comment_id": 44481779, "body": "@BartekBanachewicz  I was pretty excited about it too, instant addition to my .ghci file"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 9, "last_activity_date": 1421687746, "creation_date": 1421687746, "answer_id": 28030127, "question_id": 27780282, "link": "https://stackoverflow.com/questions/27780282/ghc-partially-compile-haskell-code/28030127#28030127", "title": "Ghc: partially compile Haskell code?", "body": "<p>As @MikhailGlushenkov pointed out in the comments, the solution is to use the <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/defer-type-errors.html\"><code>-fdefer-type-errors</code></a> flag to GHCi.</p>\n"}], "owner": {"reputation": 41142, "user_id": 262667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dd09cc9b40b956f93a00f5b464469d11?s=128&d=identicon&r=PG", "display_name": "Olivier Verdier", "link": "https://stackoverflow.com/users/262667/olivier-verdier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 4, "accepted_answer_id": 28030127, "answer_count": 1, "score": 17, "last_activity_date": 1421687746, "creation_date": 1420463479, "question_id": 27780282, "link": "https://stackoverflow.com/questions/27780282/ghc-partially-compile-haskell-code", "title": "Ghc: partially compile Haskell code?", "body": "<p>When I compile a Haskell file with <code>ghci</code>, typically with <code>:load</code>, and if there is no type error, all the expressions are loaded in the ghc interpreter. It's very nice: I can play around with <code>:t</code> to figure out the type of various expressions.</p>\n\n<p>My problem is: if there is a tiny error somewhere, ghci is not able to load <em>anything</em> (not even the imported modules!!), which makes finding the right types even more difficult. I always do the same: comment out all the bits that do not typecheck, find the relevant types wiht <code>:t</code> in ghci, and de-comment.</p>\n\n<p>But this is so tedious! Is there a better workflow for \"partially compiling\" a Haskell source code?</p>\n"}, {"tags": ["haskell", "ghc", "ffi"], "answers": [{"comments": [{"owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "edited": false, "score": 4, "creation_date": 1420468339, "post_id": 27780482, "comment_id": 43973131, "body": "Yep, I agree with this. Mark <code>safe</code> by default, unless you have something that profiling shows to be a problem that is fixed by <code>unsafe</code>. Here is a good overview, <a href=\"http://blog.melding-monads.com/2011/10/24/concurrency-and-foreign-functions-in-the-glasgow-haskell-compiler/\" rel=\"nofollow noreferrer\">blog.melding-monads.com/2011/10/24/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 4, "last_activity_date": 1420464167, "creation_date": 1420464167, "answer_id": 27780482, "question_id": 27780091, "link": "https://stackoverflow.com/questions/27780091/ghc-ccall-safe-vs-ccall-unsafe/27780482#27780482", "title": "GHC ccall safe VS ccall unsafe", "body": "<p>The rule of thumb is as follows:</p>\n\n<ol>\n<li>Make everything <code>safe</code>.</li>\n<li>If profiling reveals a performance problem in the overhead of FFI calls, carefully consider whether the semantics of <code>unsafe</code> are appropriate for the hotspot calls.</li>\n<li>If profiling has revealed a performance problem in the overhead of a <code>safe</code> FFI call and semantic analysis of the call has shown that <code>unsafe</code> won't break anything, then consider a change to <code>unsafe</code> if the worst-case time of the call is expected to be better than 1 millisecond.</li>\n</ol>\n\n<p>Don't skip the first two steps. <code>unsafe</code> has more potential issues than just blocking the RTS.</p>\n"}], "owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 1, "accepted_answer_id": 27780482, "answer_count": 1, "score": 3, "last_activity_date": 1420464167, "creation_date": 1420462820, "question_id": 27780091, "link": "https://stackoverflow.com/questions/27780091/ghc-ccall-safe-vs-ccall-unsafe", "title": "GHC ccall safe VS ccall unsafe", "body": "<p>Dear GHC/Haskell Gurus,</p>\n\n<p>I am currently writing a (medium-sized) Haskell server application using GHC, which (heavily) uses 3rd-party C library functions via the FFI. In other words, there are multiple FFI C calls made by a server thread, when serving a client request.</p>\n\n<p>Currently I am calling all the C functions unsafely (<strong>unsafe ccall</strong>) in order to minimize the calling overhead. But the tradeoff here is, that the unsafe ccalls cannot be preemptied by the GHC RTS, meaning that all other Haskell threads are blocked until the C function returns. This could be problematic, if the C function takes too long.</p>\n\n<p>On the other hand, the <strong>safe ccalls</strong> are more expensive but they will be run in separate OS threads and will not block the GHC's worker threads.</p>\n\n<p>I guess, what I am trying to ask here is, how can you sensibly make the best choice whether to make a <strong>safe ccall</strong> or <strong>unsafe ccall</strong>? For example I don't want to make an expensive safe ccall if the C function is short and trivial, but if a C function takes long time to return (cpu-heavy computation, IO operations etc.), then making an unsafe call is problematic, since it will <strong>block a worker thread</strong>.\nIs there a kind of approximate threshold value <code>t</code>, so that if the C function takes longer than <code>t</code> to complete, then make it a safe ccall and otherwise unsafe ccall?</p>\n\n<p>I hope, this question makes somewhat sense and if there are something unclear, please don't hesitate to comment.</p>\n\n<p>Thans a ton for your help in advance!</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1420461596, "post_id": 27779620, "comment_id": 43969214, "body": "Should begin with using lowercase. Uppercase is mainly used for data types."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1420461972, "post_id": 27779620, "comment_id": 43969416, "body": "Nope, this is simply not possible in Haskell. Variables / constructors can only contain letters, underscores and prime symbols, hyphens are not allowed. Why do you think you need a hyphen there? What&#39;s wrong with <code>TheFirst</code> or <code>The_First</code>? If your actual use case isn&#39;t more complicated, it might also be worth considerung to simply use <code>Either Int Int</code>, then you don&#39;t need to define any constructors at all. \u2014 @CommuSoft: erm, no! Constructors <i>must</i> in fact begin with an uppercase letter."}, {"owner": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1420463063, "post_id": 27779620, "comment_id": 43970089, "body": "@leftaroundabout thanks! I just removed the Int but it is still not working. The actual use case is more complicated so I have to use hyphen to follow a specific naming convention. BTW, underscore is working perfectly so The_First is OK but The-First is has problematic."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1420463502, "post_id": 27779620, "comment_id": 43970324, "body": "Well, a naming convention that mandates hyphens is impossible to follow."}, {"owner": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1420463611, "post_id": 27779620, "comment_id": 43970398, "body": "@leftaroundabout ok thanks"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1420507910, "post_id": 27779620, "comment_id": 43991292, "body": "Hyphens aren&#39;t valid in identifiers in <i>any</i> widely used programming language that I can think of. Where did this naming convention come from? It certainly wasn&#39;t designed by a Haskell programmer and intended for Haskell code, and I doubt it was intended for code at all. Are you sure you&#39;re not trying to apply a naming convention intended for something else (e.g. filenames) to Haskell constructors, perhaps because you&#39;re using Show or Read instances to connect the two?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1420700937, "post_id": 27779620, "comment_id": 44074442, "body": "@Ben: Ahem... Lisp? ;)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1420708934, "post_id": 27779620, "comment_id": 44077686, "body": "@ReinHenrichs I did not know that! To my regret, I have not yet learned a lisp. :)"}, {"owner": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1420716740, "post_id": 27779620, "comment_id": 44082023, "body": "@Ben yes this is a naming convention outside programming stuff. I think I have to write a function that maps the names on the data constructors to intended naming convention."}], "answers": [{"comments": [{"owner": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "edited": false, "score": 0, "creation_date": 1420463198, "post_id": 27780010, "comment_id": 43970161, "body": "thanks for the reply but I have to use hyphen to follow a specific naming convention."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "edited": false, "score": 0, "creation_date": 1420463498, "post_id": 27780010, "comment_id": 43970323, "body": "@PHA What specific naming convention ? When you are using a language, it&#39;s best to adhere to the language&#39;s accepted conventions. And in your case, there is no way other than removing hyphen to make it typecheck."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "edited": false, "score": 3, "creation_date": 1420488496, "post_id": 27780010, "comment_id": 43983991, "body": "@PHA It&#39;s probably easier to change your naming convention than the grammar of the Haskell language."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1420462584, "creation_date": 1420462584, "answer_id": 27780010, "question_id": 27779620, "link": "https://stackoverflow.com/questions/27779620/haskell-data-constructor-name-with-hyphen/27780010#27780010", "title": "Haskell data constructor name with hyphen", "body": "<p>What you want is not allowed by the Haskell Standard. Quoting relevant parts of it:</p>\n\n<p>From <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch1.html#x6-120001.3\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>There are six kinds of names in Haskell: those for variables and\n  constructors denote values; those for type variables, type\n  constructors, and type classes refer to entities related to the type\n  system; and module names refer to modules. There are two constraints\n  on naming:</p>\n  \n  <p>1.Names for variables and type variables are identifiers beginning with lowercase letters  or underscore; the other four kinds of names are identifiers beginning with uppercase letters.</p>\n  \n  <ol start=\"2\">\n  <li>An identifier must not be used as the name of a type constructor and a class in the same scope.</li>\n  </ol>\n</blockquote>\n\n<p>And from <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>An identifier consists of a letter followed by zero or more letters,\n  digits, underscores, and single quotes.</p>\n</blockquote>\n\n<p>Summary: Just get used to the CamelCase format. You will start liking it after some time. :)</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1670157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f508b71f43bcd9c60b8ae0d990440ed?s=128&d=identicon&r=PG", "display_name": "Maurizio Vitale", "link": "https://stackoverflow.com/users/1670157/maurizio-vitale"}, "is_accepted": false, "score": 0, "last_activity_date": 1420493051, "creation_date": 1420493051, "answer_id": 27788150, "question_id": 27779620, "link": "https://stackoverflow.com/questions/27779620/haskell-data-constructor-name-with-hyphen/27788150#27788150", "title": "Haskell data constructor name with hyphen", "body": "<p>well, I presume if one wanted it might be possible to use Template Haskell to accept expressions and generate constructor names (I've never used it, so I don't know if it can kick in at that point in the grammar). I wouldn't then know how to allow [The-First] and not [The - First], as they parse the same.</p>\n\n<p>But really, using CamelCase or Camel_Case is so much better that you don't want to look at any other crazy options.</p>\n"}], "owner": {"reputation": 1342, "user_id": 3990158, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c657e26d1552cbe4705fd965d53d2e25?s=128&d=identicon&r=PG&f=1", "display_name": "PHA", "link": "https://stackoverflow.com/users/3990158/pha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 27780010, "answer_count": 2, "score": -1, "last_activity_date": 1420493051, "creation_date": 1420461183, "last_edit_date": 1420462154, "question_id": 27779620, "link": "https://stackoverflow.com/questions/27779620/haskell-data-constructor-name-with-hyphen", "title": "Haskell data constructor name with hyphen", "body": "<p>I wish to have a data constructor with a name including some hyphens like this:</p>\n\n<pre><code>data D = The-First |  The-Second deriving (Ord, Eq, Show, Read)\n</code></pre>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1420459474, "post_id": 27778999, "comment_id": 43968219, "body": "If you parenthesize the operators (<code>&lt;=</code> and <code>&gt;</code>) and surround <code>f</code> with backticks (<code>`</code>), your <code>qsort</code> function should then work. Backticks allow you to use binary functions like infix operators."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1420459703, "post_id": 27778999, "comment_id": 43968312, "body": "Yes, it works fine, thank you. But why it is necessary to use the backticks? The <code>&lt;=</code> and <code>&lt;</code> operators are infix operators, so I&#39;ve expected infix form will works this case."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1420459771, "post_id": 27778999, "comment_id": 43968345, "body": "Only functions defined with &quot;special&quot; characters (see <a href=\"http://stackoverflow.com/questions/10548170/what-characters-are-permitted-for-haskell-operators\">this</a>) are assumed by GHC to be infix by default. As an example, try <code>let (&#47;.&#47;) = (+)</code> in GHCi; you will be able to write something like <code>1 &#47;.&#47; 5</code> without any error."}], "answers": [{"comments": [{"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1420459473, "post_id": 27779073, "comment_id": 43968217, "body": "Thank you, this works fine. But why I can&#39;t use the <i>infix</i> form? Both operators are the infix and I&#39;ve expected infix call will work..."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1420463177, "last_edit_date": 1420463177, "creation_date": 1420459140, "answer_id": 27779073, "question_id": 27778999, "link": "https://stackoverflow.com/questions/27778999/the-and-operators-as-a-function-arguments/27779073#27779073", "title": "The &lt;= and &gt; operators as a function arguments", "body": "<p>You shouldn't use <code>f</code> as infix. You can solve it by putting <code>f</code> in front and representing the functions between brackets <code>(&lt;=)</code>:</p>\n\n<pre><code>-- third variant:\nqsort' :: (Ord a) =&gt; [a] -&gt; [a]\nqsort' [] = []\nqsort' (x:xs) = (srt (&lt;=)) ++ [x] ++ (srt (&gt;))\n  where srt f = qsort' [m | m &lt;- xs, f m x]\n</code></pre>\n\n<p>This is mainly because what you basically want to do is <strong>call</strong> <code>f</code> on <code>m</code> and <code>x</code>. Now default lambda-calculus always evaluates first the function that is listed to the left. </p>\n\n<p>Haskell only provides some syntactical sugar for operators: when you write <code>a+b</code>, what you basically write is <code>(+) a b</code> (behind the curtains). This is what Haskell likes best, but the compiler thus offers some functionality for programmer's convenience. Since writing <code>a*b+c*d</code> is way easier than writing <code>(+) ((*) a b) ((*) c d)</code>, but the second is actually how to write such things in lambda-calculus.</p>\n\n<p>In order to see operators as functions, you write them between brackets, so to get the function-variant of <code>&lt;=</code>, you write <code>(&lt;=)</code>.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As @Jubobs argues, you can also use the infix, but thus requires you to use backticks:</p>\n\n<pre><code>-- fourth variant:\nqsort' :: (Ord a) =&gt; [a] -&gt; [a]\nqsort' [] = []\nqsort' (x:xs) = (srt (&lt;=)) ++ [x] ++ (srt (&gt;))\n  where srt f = qsort' [m | m &lt;- xs, m `f` x]\n</code></pre>\n\n<p>The problem is mainly you need to <strong>pass</strong> your functions through <code>f</code>, and <code>&lt;=</code> and <code>&gt;</code> aren't functions, <code>(&lt;=)</code> and <code>(&gt;)</code> are. Technically speaking, the story is a bit more complicated, but I guess this will suffice when learning the basics.</p>\n\n<p>By using backticks, Haskell reads:</p>\n\n<pre><code>x `f` y\n</code></pre>\n\n<p>as:</p>\n\n<pre><code>f x y\n</code></pre>\n\n<p>(note that this is not completely true since operators have also a <strong>priority</strong>: <code>*</code> binds tighter than <code>+</code>, but these are more the \"details\" of the process).</p>\n\n<p>Putting brackets over an operator is kind of the opposite effect:</p>\n\n<pre><code>x o y\n</code></pre>\n\n<p>is</p>\n\n<pre><code>(o) x y\n</code></pre>\n\n<p>with <code>o</code> an operator.</p>\n"}], "owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 27779073, "answer_count": 1, "score": 3, "last_activity_date": 1420463177, "creation_date": 1420458881, "question_id": 27778999, "link": "https://stackoverflow.com/questions/27778999/the-and-operators-as-a-function-arguments", "title": "The &lt;= and &gt; operators as a function arguments", "body": "<p>Quick sort:</p>\n\n<pre><code>-- First variant:\nqsort :: (Ord a) =&gt; [a] -&gt; [a]\nqsort [] = []\nqsort (x:xs) = left x ++ [x] ++ right x \n  where left  n = qsort [m | m &lt;- xs, m &lt;= n]\n        right n = qsort [m | m &lt;- xs, m  &gt; n]\n\n-- \u03bb: qsort [10,2,5,3,1,6,7,4,2,3,4,8,9]\n-- [1,2,2,3,3,4,4,5,6,7,8,9,10]\n</code></pre>\n\n<p>I see the <code>left</code> and <code>right</code> functions are <em>almost</em> identical. Therefore I want to rewrite it shorter... Something like that:</p>\n\n<pre><code>-- Second variant:\nqsort' :: (Ord a) =&gt; [a] -&gt; [a]\nqsort' [] = []\nqsort' (x:xs) = (srt &lt;=) ++ [x] ++ (srt &gt;)\n  where srt f = qsort' [m | m &lt;- xs, m f x]\n</code></pre>\n\n<p>But I get errors when I try to load this into <code>ghci</code>:</p>\n\n<pre><code>\u03bb: :load temp\n[1 of 1] Compiling Main             ( temp.hs, interpreted )\n\ntemp.hs:34:18:\n    Couldn't match expected type `[a]'\n                with actual type `(t0 -&gt; [a]) -&gt; Bool'\n    Relevant bindings include\n      srt :: forall t. t -&gt; [a] (bound at temp.hs:35:9)\n      xs :: [a] (bound at temp.hs:34:11)\n      x :: a (bound at temp.hs:34:9)\n      qsort' :: [a] -&gt; [a] (bound at temp.hs:33:1)\n    In the first argument of `(++)', namely `(srt &lt;=)'\n    In the expression: (srt &lt;=) ++ [x] ++ (srt &gt;)\n    In an equation for qsort':\n        qsort' (x : xs)\n          = (srt &lt;=) ++ [x] ++ (srt &gt;)\n          where\n              srt f = qsort' [m | m &lt;- xs, m f x]\n\ntemp.hs:34:37:\n    Couldn't match expected type `[a]'\n                with actual type `(t1 -&gt; [a]) -&gt; Bool'\n    Relevant bindings include\n      srt :: forall t. t -&gt; [a] (bound at temp.hs:35:9)\n      xs :: [a] (bound at temp.hs:34:11)\n      x :: a (bound at temp.hs:34:9)\n      qsort' :: [a] -&gt; [a] (bound at temp.hs:33:1)\n    In the second argument of `(++)', namely `(srt &gt;)'\n    In the second argument of `(++)', namely `[x] ++ (srt &gt;)'\n    In the expression: (srt &lt;=) ++ [x] ++ (srt &gt;)\n\ntemp.hs:35:38:\n    Could not deduce (a ~ (t -&gt; a -&gt; Bool))\n    from the context (Ord a)\n      bound by the type signature for qsort' :: Ord a =&gt; [a] -&gt; [a]\n      at temp.hs:32:11-31\n      `a' is a rigid type variable bound by\n          the type signature for qsort' :: Ord a =&gt; [a] -&gt; [a]\n          at temp.hs:32:11\n    Relevant bindings include\n      m :: a (bound at temp.hs:35:29)\n      f :: t (bound at temp.hs:35:13)\n      srt :: t -&gt; [a] (bound at temp.hs:35:9)\n      xs :: [a] (bound at temp.hs:34:11)\n      x :: a (bound at temp.hs:34:9)\n      qsort' :: [a] -&gt; [a] (bound at temp.hs:33:1)\n    The function `m' is applied to two arguments,\n    but its type `a' has none\n    In the expression: m f x\n    In a stmt of a list comprehension: m f x\nFailed, modules loaded: none.\n\u03bb:\n</code></pre>\n\n<p>I read the error message, but I don't understand the reason still...</p>\n"}, {"tags": ["haskell", "ghci", "haskell-warp"], "answers": [{"comments": [{"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420454753, "post_id": 27777870, "comment_id": 43965969, "body": "That&#39;s what I tried - <code>:print x</code> and I get <code>Top level: Not in scope: \u2018x\u2019</code>  (Edited above to reflect that I did try using <code>:print</code>)"}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420456607, "post_id": 27777870, "comment_id": 43966844, "body": "I see. It works when I explicitly use those variables <code>x</code> or <code>req</code> in code. Thanks for the answer.  That does work. I manage to get <code>Request {requestMethod = &quot;GET&quot;, httpVersion = HTTP&#47;1.1, rawPathInfo = &quot;&#47;&quot;, rawQueryString = &quot;&quot;, requestHeaders = [(&quot;User-Agent&quot;,&quot;curl&#47;7.39.0&quot;),(&quot;Host&quot;,&quot;127.0.0.1:3000&quot;),(&quot;Ac&zwnj;&#8203;cept&quot;,&quot;*&#47;*&quot;)], isSecure = False, remoteHost = 127.0.0.1:62615, pathInfo = [], queryString = [], requestBody = &lt;IO ByteString&gt;, vault = &lt;Vault&gt;, requestBodyLength = KnownLength 0, requestHeaderHost = Just &quot;127.0.0.1:3000&quot;, requestHeaderRange = Nothing} Stopped at hellowai.hs:12:5-23</code>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1420456456, "last_edit_date": 1420456456, "creation_date": 1420454646, "answer_id": 27777870, "question_id": 27777830, "link": "https://stackoverflow.com/questions/27777830/using-ghci-debugger-in-a-wai-warp-app/27777870#27777870", "title": "Using ghci debugger in a wai/warp app", "body": "<p>With the GHCi command <code>:print ...</code> (or <code>:sprint ...</code>) you can print out the variables in scope. This however will print only evaluated values (recall Haskell is lazy).</p>\n\n<p>To evaluate and print, just use the name of the variables directly. You can get a list of the variables in scope with the <code>:show bindings</code> command.</p>\n\n<p>If you do not see the variables in scope, it is possible that they have been optimized away by the compilier. In your code, you do not use <code>x</code>, so that is likely removed during compilation. Also, code such as</p>\n\n<pre><code>foo = do\n  let x = 3\n  print \"aa\"\n  print \"bb\"\n  print x\n</code></pre>\n\n<p>is probably handled as (line numbers aside)</p>\n\n<pre><code>foo = do\n  print \"aa\"\n  print \"bb\"\n  let x = 3\n  print x\n</code></pre>\n\n<p>So you will not see <code>x</code> in scope until the last line. In such cases, use <code>:step</code> to advance your execution a little until you see <code>x</code> appear.</p>\n"}], "owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 27777870, "answer_count": 1, "score": 1, "last_activity_date": 1420456456, "creation_date": 1420454497, "last_edit_date": 1420454856, "question_id": 27777830, "link": "https://stackoverflow.com/questions/27777830/using-ghci-debugger-in-a-wai-warp-app", "title": "Using ghci debugger in a wai/warp app", "body": "<p>Here's a trivial <code>wai</code>/<code>warp</code> program so I can learn how <code>ghci</code> debugger actually works:-</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.Wai\nimport Network.HTTP.Types (status200)\nimport Network.Wai.Handler.Warp (run)\nimport Debug.Trace (trace)\n\nmyApp req respond = do \n    let x = 1 {- line 8 -}\n    putStrLn \"processing request\" {- line 9 -}\n    putStrLn \"Hoooray!\" {- line 10 -}\n    respond $ responseLBS status200 [(\"Content-Type\", \"text/plain\")] \"Hello World\" \n\nmain = run 3000 myApp \n</code></pre>\n\n<p>In <code>ghci</code>, I first load this program (e.g. with <code>:load hellowai.hs</code>).</p>\n\n<p>Then, I set my break points in line 9 and line 10 with</p>\n\n<pre><code>:break 9\n:break 10\n</code></pre>\n\n<p>Then, in <code>ghci</code>, I execute <code>main</code>.</p>\n\n<p>I then run <code>localhost:3000</code> on my browser or with curl (doesn't matter of course) and my program breaks at line 9 as expected.</p>\n\n<p>How do I print out (introspect) <code>x</code> and how do I introspect <code>req</code> ?</p>\n\n<p>I tried using <code>:print</code> and <code>ghci</code> simply complains \"Not in scope\".</p>\n\n<pre><code>Stopped at hellowai.hs:9:5-33\n_result :: IO () = _\n[hellowai.hs:9:5-33] *Main&gt; :print x\n\nTop level: Not in scope: \u2018x\u2019\n[hellowai.hs:9:5-33] *Main&gt; :print req\n\nTop level:\n    Not in scope: \u2018req\u2019\n    Perhaps you meant one of these:\n      \u2018rem\u2019 (imported from Prelude), \u2018seq\u2019 (imported from Prelude)\n[hellowai.hs:9:5-33] *Main&gt;\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 2, "creation_date": 1420464519, "post_id": 27777450, "comment_id": 43970945, "body": "Usually, you don&#39;t need to <i>return</i> Nothing, at the end of a do block <code>Nothing</code> is enough. I mean <code>do Nothing</code> is valid."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420484034, "post_id": 27777450, "comment_id": 43981859, "body": "You might be looking for something more along the lines of <code>fail &quot;To err is human&quot; :: Maybe t</code>, which will result in <code>Nothing</code>."}], "answers": [{"tags": [], "owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "is_accepted": true, "score": 7, "last_activity_date": 1420453602, "creation_date": 1420453602, "answer_id": 27777573, "question_id": 27777450, "link": "https://stackoverflow.com/questions/27777450/what-is-the-type-signature-for-return-nothing/27777573#27777573", "title": "what is the type signature for &quot;return Nothing&quot;?", "body": "<p>The difference between:</p>\n\n<pre><code>*Main&gt; return 1 :: Maybe Integer\n</code></pre>\n\n<p>And</p>\n\n<pre><code>*Main&gt; return Nothing :: Maybe String\n</code></pre>\n\n<p>Is that <code>1</code> has type <code>Integer</code>, but <code>Nothing</code> has type <code>Maybe a</code>. If you want to wrap <code>Nothing</code> into another <code>Maybe</code> value, you should specify the type for <code>Nothing</code> like this:</p>\n\n<pre><code>*Main&gt; return Nothing :: Maybe (Maybe String)\nJust Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1439511156, "post_id": 27777606, "comment_id": 51904076, "body": "I personally would typecheck the last expression as <code>Monad m =&gt; m (Maybe a)</code>. I&#39;m not sure where GHCi infers (m ~ Maybe)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 11, "last_activity_date": 1439538818, "last_edit_date": 1439538818, "creation_date": 1420453747, "answer_id": 27777606, "question_id": 27777450, "link": "https://stackoverflow.com/questions/27777450/what-is-the-type-signature-for-return-nothing/27777606#27777606", "title": "what is the type signature for &quot;return Nothing&quot;?", "body": "<p>In the lines</p>\n\n<pre><code>return 1\nreturn \"ok\"\n</code></pre>\n\n<p>the <code>return</code> works inside the <code>Maybe</code> monad, so <code>return = Just</code> here.</p>\n\n<p>In the line</p>\n\n<pre><code>return Nothing :: Maybe String\n</code></pre>\n\n<p>the compiler spots that your code is of the form</p>\n\n<pre><code>return ... :: Maybe ...\n</code></pre>\n\n<p>so, once again, <code>return = Just</code>. Your code is equivalent to</p>\n\n<pre><code>Just Nothing :: Maybe String\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>Just (Nothing :: String)\n</code></pre>\n\n<p>but <code>Nothing</code> is not a string, it is a <code>Maybe a</code> for any <code>a</code> -- hence the type error.</p>\n\n<p>You probably are looking for</p>\n\n<pre><code>Nothing :: Maybe String -- no return here\n</code></pre>\n\n<p>which works fine.</p>\n\n<p>By the way, you can ask GHCi to give the type for an expression with the <code>:t</code> command:</p>\n\n<pre><code>&gt; :t return Nothing\nMonad m =&gt; m (Maybe a)\n</code></pre>\n"}], "owner": {"reputation": 1622, "user_id": 1054800, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881102db0abfb0d08ff131c472ce4991?s=128&d=identicon&r=PG", "display_name": "abelard2008", "link": "https://stackoverflow.com/users/1054800/abelard2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "accepted_answer_id": 27777573, "answer_count": 2, "score": 0, "last_activity_date": 1439538818, "creation_date": 1420453170, "last_edit_date": 1439510864, "question_id": 27777450, "link": "https://stackoverflow.com/questions/27777450/what-is-the-type-signature-for-return-nothing", "title": "what is the type signature for &quot;return Nothing&quot;?", "body": "<p>In <a href=\"http://book.realworldhaskell.org/read/monads.html\" rel=\"nofollow\">the chapter 14 of Real World Haskell (Monads)</a>, the type signature of the inject function <code>return</code> is <code>return :: a -&gt; m a</code>, where <code>m a</code> is a type constructor, so under ghci I can specify a type signature for a <code>return arg1</code>, such as:</p>\n\n<pre><code>*Main&gt; return 1 :: Maybe Integer\nJust 1\n\n*Main&gt; return \"ok\" :: Maybe String\nJust \"ok\"   \n</code></pre>\n\n<p>Because <code>Nothing</code> is the value of the type <code>Maybe a</code>, <code>Nothing</code> 's type is <code>Maybe Integer</code> or <code>Maybe String</code> , so I think I can specify the type as follows:</p>\n\n<pre><code>*Main&gt; return Nothing :: Maybe String\n</code></pre>\n\n<p>But I got an error:</p>\n\n<pre><code>    Couldn't match type `Maybe a0' with `[Char]'\nExpected type: String\n  Actual type: Maybe a0\nIn the first argument of `return', namely `Nothing'\nIn the expression: return Nothing :: Maybe String\nIn an equation for `it': it = return Nothing :: Maybe String\n</code></pre>\n\n<p>I am confused about what is the type signature for that.</p>\n"}, {"tags": ["haskell", "yesod", "haskell-warp"], "answers": [{"comments": [{"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420442398, "post_id": 27773924, "comment_id": 43960602, "body": "I am not sure what I am doing wrong as this is in fact what I did right from the get-go but it gives me <code>hellowai.hs:7:5: parse error on input \u2018respond\u2019</code>"}, {"owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420442483, "post_id": 27773924, "comment_id": 43960631, "body": "Damn, I realize that my tabs are not configured as space. My bad. This works great."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "edited": false, "score": 0, "creation_date": 1420442536, "post_id": 27773924, "comment_id": 43960648, "body": "Haskell is whitespace sensitive - make sure things line up and do not use tabs. Here is my code: <a href=\"http://lpaste.net/117798\" rel=\"nofollow noreferrer\">lpaste.net/117798</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1420435933, "creation_date": 1420435933, "answer_id": 27773924, "question_id": 27773822, "link": "https://stackoverflow.com/questions/27773822/how-do-you-add-logic-into-the-following-myapp-haskell-function/27773924#27773924", "title": "How do you add logic into the following `myApp` haskell function?", "body": "<p><code>myApp</code> has this type:</p>\n\n<pre><code>myApp :: Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived\n</code></pre>\n\n<p>so you can add your own IO action before returning the response like this:</p>\n\n<pre><code>myApp _ respond = do putStrLn \"processing request\"\n                     respond $ responseLBS status200 [(\"Content-Type\", \"text/plain\")] \"Hello World\"\n</code></pre>\n"}], "owner": {"reputation": 32556, "user_id": 482506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81b13b737bddbf0ab1c906135581f6a7?s=128&d=identicon&r=PG", "display_name": "Calvin Cheng", "link": "https://stackoverflow.com/users/482506/calvin-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 27773924, "answer_count": 1, "score": 0, "last_activity_date": 1420435933, "creation_date": 1420435235, "question_id": 27773822, "link": "https://stackoverflow.com/questions/27773822/how-do-you-add-logic-into-the-following-myapp-haskell-function", "title": "How do you add logic into the following `myApp` haskell function?", "body": "<p>I am still trying to understand how haskell syntax works.  So, here's a dead simple <code>wai</code>/<code>warp</code> application.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.Wai\nimport Network.HTTP.Types (status200)\nimport Network.Wai.Handler.Warp (run)\n\nmyApp _ respond = respond $\n    responseLBS status200 [(\"Content-Type\", \"text/plain\")] \"Hello World\" \n\nmain = run 3000 myApp \n</code></pre>\n\n<p>If I want to print out some text into <code>stdout</code> with <code>putStrLn</code> <em>before</em> returning the status 200 and \"Hello World\" plain text, how would I implement it?</p>\n"}, {"tags": ["scala", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1420442478, "post_id": 27773779, "comment_id": 43960629, "body": "<code>concatMap (maybe [] (:[]))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 11, "last_activity_date": 1420701287, "last_edit_date": 1420701287, "creation_date": 1420435608, "answer_id": 27773865, "question_id": 27773779, "link": "https://stackoverflow.com/questions/27773779/implementing-listflatten-in-haskell/27773865#27773865", "title": "Implementing List#flatten in Haskell", "body": "<p>Your <code>flatten</code> is the same as <code>catMaybes</code> <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Maybe.html#v:catMaybes\" rel=\"nofollow\">(link)</a> which is defined like this:</p>\n\n<pre><code>catMaybes :: [Maybe a] -&gt; [a]\ncatMaybes ls = [x | Just x &lt;- ls]\n</code></pre>\n\n<p>The special syntax <code>Just x &lt;- ls</code> in a list comprehension means to draw an element from <code>ls</code> and discard it if it is not a <code>Just</code>. Otherwise assign <code>x</code> by pattern matching the value against <code>Just x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 4, "last_activity_date": 1420499730, "last_edit_date": 1420499730, "creation_date": 1420497661, "answer_id": 27789150, "question_id": 27773779, "link": "https://stackoverflow.com/questions/27773779/implementing-listflatten-in-haskell/27789150#27789150", "title": "Implementing List#flatten in Haskell", "body": "<p>A slight modification of the code you have will do the trick:</p>\n\n<pre><code>flatten :: [Maybe a] -&gt; [a]\nflatten xs = xs &gt;&gt;= f\n\nf :: Maybe a -&gt; [a]\nf x = case x of Just j  -&gt; [j]\n                Nothing -&gt; []\n</code></pre>\n\n<p>If we extract the value inside of the <code>Just</code> constructor in <code>f</code>, we avoid <code>g</code> altogether.</p>\n\n<p>Incidentally, <code>f</code> already exists as <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Maybe.html#v:maybeToList\" rel=\"nofollow\"><code>maybeToList</code></a> and <code>flatten</code> is called <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Maybe.html#v:catMaybes\" rel=\"nofollow\"><code>catMaybes</code></a>, both in <code>Data.Maybe</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1420702003, "post_id": 27807864, "comment_id": 44074825, "body": "Complete is accurate enough, although the term of art is &quot;total&quot; \u2013 as opposed to &quot;partial&quot;."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 0, "last_activity_date": 1420652131, "last_edit_date": 1420652131, "creation_date": 1420581354, "answer_id": 27807864, "question_id": 27773779, "link": "https://stackoverflow.com/questions/27773779/implementing-listflatten-in-haskell/27807864#27807864", "title": "Implementing List#flatten in Haskell", "body": "<p>One could quite easily write a simple recursive function which goes through a list and rejects all the <code>Nothing</code>s from the Maybe monad. Here's how I'd do it as a recursive sequence:</p>\n\n<pre><code>flatten :: [Maybe a] -&gt; [a]\nflatten [] = []\nflatten (Nothing : xs) =     flatten xs\nflatten (Just x  : xs) = x : flatten xs\n</code></pre>\n\n<p>However, it may be clearer to write it as a fold:</p>\n\n<pre><code>flatten :: [Maybe a] -&gt; [a]\nflatten = foldr go []\n    where go  Nothing xs =     xs\n          go (Just x) xs = x : xs\n</code></pre>\n\n<p>Or, we could use a blindingly elegant solution thanks to @user2407038, which I'd recommend playing around with in GHCi to work out the individual functions' jobs:</p>\n\n<pre><code>flatten :: [Maybe a] -&gt; [a]\nflatten = (=&lt;&lt;) (maybe [] (:[])\n</code></pre>\n\n<p>And it's faster, folded brother:</p>\n\n<pre><code>flatten :: [Maybe a] -&gt; [a]\nflatten = foldr (maybe id (:))\n</code></pre>\n\n<p>Your solution is halfway there. My suggestion if to rewrite your function <code>f</code> to use pattern matching (like my temporary <code>go</code> function), and enclose it in a <code>where</code> statement to keep relevant functions in one place. You've got to remember the differences in function syntax within scala and Haskell.</p>\n\n<p>The big problem you're having is you don't know the differences I've mentioned. Your <code>g</code> function can use pattern matching with multiple patterns:</p>\n\n<pre><code>g :: Maybe a -&gt; [a]\ng (Just x) = [x]\ng  Nothing = []\n</code></pre>\n\n<p>There you go: your <code>g</code> function is now what you call 'complete', though more accurately, it would be said to have <em>exhaustive patterns</em>.</p>\n\n<p>You can find more about function syntax <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 27773865, "answer_count": 3, "score": 5, "last_activity_date": 1420701287, "creation_date": 1420434930, "question_id": 27773779, "link": "https://stackoverflow.com/questions/27773779/implementing-listflatten-in-haskell", "title": "Implementing List#flatten in Haskell", "body": "<p>Scala offers a <code>List#flatten</code> method for going from <code>List[Option[A]]</code> to <code>List[A]</code>.</p>\n\n<pre><code>scala&gt; val list = List(Some(10), None)\nlist: List[Option[Int]] = List(Some(10), None)\n\nscala&gt; list.flatten\nres11: List[Int] = List(10)\n</code></pre>\n\n<p>I attempted to implement it in Haskell:</p>\n\n<pre><code>flatten :: [Maybe a] -&gt; [a]\nflatten xs = map g $ xs &gt;&gt;= f\n\nf :: Maybe a -&gt; [Maybe a]\nf x = case x of Just _  -&gt; [x]\n                Nothing -&gt; []\n\n-- partial function!\ng :: Maybe a -&gt; a\ng (Just x) = x\n</code></pre>\n\n<p>However I don't like the fact that <code>g</code> is a partial, i.e. non-total, function.</p>\n\n<p>Is there a <strong>total</strong> way to write such <code>flatten</code> function?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1420419700, "post_id": 27771849, "comment_id": 43955206, "body": "Typically in Haskell you would split the printing of the numbers (impure operation) from creating such a list (pure). If you were just debugging with the print statement, you can use something like Debug.Trace to cheat the typechecker (again, for debugging purposes only). <a href=\"http://en.wikibooks.org/wiki/Haskell/Debugging#Debug_prints_with_Debug.Trace\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/&hellip;</a>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420480976, "post_id": 27771849, "comment_id": 43980364, "body": "You&#39;re mixing the <code>IO</code> monad from <code>print</code> and the List monad in the same binding! Remember that <code>a &lt;- something</code> is just sugar for <code>something &gt;&gt;= \\a -&gt;</code>, and it needs to have very particular types as a result."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420421142, "post_id": 27771916, "comment_id": 43955470, "body": "I&#39;ve been playing around with this and it works perfectly. Just another little question, I&#39;ve tried to add in an if statement. So if the number is divisible by 3 then it gets added to the list, if not it just takes one away. It doesn&#39;t seem to like the ns &lt;- addNumbers (n-1) within an if statement."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420453343, "post_id": 27771916, "comment_id": 43965283, "body": "@Jordan Replace the <code>return (n:ns)</code> with <code>if n `mod` 3 == 0 then return (n:ns) else return (tail ns)</code>. You don&#39;t need to run <code>addNumbers</code> under an <code>if</code> for this. (And watch out because this can try to remove an element from the empty list)"}, {"owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420464300, "post_id": 27771916, "comment_id": 43970827, "body": "Thank you chi, is there any reason i&#39;m unable to call &quot;length&quot; on the output? I thought this created a list. But if i remove the print from the randomusername&#39;s code and call &quot;length (addNumbers 3)&quot; it gives an error. Any idea?"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420472050, "post_id": 27771916, "comment_id": 43975282, "body": "@Jordan You have a type mismatch: <code>length</code> has type <code>[a] -&gt; Int</code>, but your list has type <code>IO [Int]</code>. Try <code>fmap length $ addNumbers 3</code>."}], "tags": [], "owner": {"reputation": 7189, "user_id": 2898458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bc37a9f235a6fa726c8047459ecf0a3f?s=128&d=identicon&r=PG", "display_name": "randomusername", "link": "https://stackoverflow.com/users/2898458/randomusername"}, "is_accepted": true, "score": 4, "last_activity_date": 1420417787, "creation_date": 1420417787, "answer_id": 27771916, "question_id": 27771849, "link": "https://stackoverflow.com/questions/27771849/haskell-adding-an-element-to-a-list-via-recursion/27771916#27771916", "title": "Haskell adding an element to a list via recursion", "body": "<p>This will not do what you think it does, in Haskell everything is immutable (once it has been given a value, that value cannot change).  What you might be trying to do is:</p>\n\n<pre><code>addNumbers :: Int -&gt; IO [Int]\naddNumbers 0 = return []\naddNumbers n = do print n\n                  ns &lt;- addNumbers (n-1)\n                  return (n:ns)\n</code></pre>\n\n<p>Then in the interpreter you'll get</p>\n\n<pre><code>ghci&gt; addNumbers 3\n3\n2\n1\n[3, 2, 1]\nghci&gt;\n</code></pre>\n\n<p>Pay careful attention to the signature of <code>addNumbers</code>, it accepts an <code>Int</code> and returns a list of <code>Int</code>'s encapsulated by the IO monad.  It has to be encapsulated by the IO monad because the call to print returns <code>()</code> in the IO monad and without that then the value won't be printed.</p>\n\n<p>If you just want a list of <code>Int</code>'s prepended to a list then you can easily do</p>\n\n<pre><code>foo 0 = [0]\nfoo n = n:foo (n-1)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 27771916, "answer_count": 1, "score": 0, "last_activity_date": 1420417787, "creation_date": 1420417243, "question_id": 27771849, "link": "https://stackoverflow.com/questions/27771849/haskell-adding-an-element-to-a-list-via-recursion", "title": "Haskell adding an element to a list via recursion", "body": "<p>I'm attempting to understand lists in Haskell and I've ran into something i'm unsure on. Is it possible to iterate through a loop and on each iteration add an item to a list ? for the purpose of the question i wrote the following code: </p>\n\n<pre><code>list = []\naddNumbers 0 = return ()\naddNumbers n =\n do\n    print n\n    n : list\n    addNumbers (n-1)\n</code></pre>\n\n<p>I thought that this would work but it seems to give the error \"Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\". I'm not quite sure why this error is coming up as there is no input or output being asked for from the user. I thought it may have been to do with the \"print n\" but it doesn't seem to work without that line.</p>\n\n<p>Cheers in advance for any help</p>\n"}, {"tags": ["haskell", "functional-programming", "functor", "category-theory"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 7, "creation_date": 1420415216, "post_id": 27771474, "comment_id": 43954262, "body": "My feeling is that the motivation behind indexed functors can be understood only by looking at indexed <i>applicative</i> functors, or indexed monads. These are just like their non-indexed parts, except that the type (in its index) is allowed to change when using <code>&lt;*&gt;</code> or <code>&gt;&gt;=</code>. The index can therefore be used e.g. to keep track of how many side effects you have: <code>allocSomeData :: M Zero One T1</code> and <code>allocSomeOtherData :: M One Two T2</code> then <code>do d1 &lt;- allocSomeData; d2 &lt;- allocSomeOtherData; return (d1,d2) :: M Zero Two (T1,T2)</code> and the double allocation is reflected in the type."}], "answers": [{"comments": [{"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 1, "creation_date": 1420464861, "post_id": 27771772, "comment_id": 43971123, "body": "If I&#39;ve understood that correctly, it should be <code>runIxState :: i -&gt; (a, j)</code>, shouldn&#39;t it? And thanks for this really good explanation, now these finally make sense for me..."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1491058458, "post_id": 27771772, "comment_id": 73391564, "body": "Great notion of &#39;simultaneously composes morphisms&#39;"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 19, "last_activity_date": 1491061315, "last_edit_date": 1495540922, "creation_date": 1420416517, "answer_id": 27771772, "question_id": 27771474, "link": "https://stackoverflow.com/questions/27771474/what-is-exactly-an-indexed-functor-in-haskell-and-what-are-its-usages/27771772#27771772", "title": "What is exactly an indexed functor in Haskell and what are its usages?", "body": "<p>An indexed functor is, to use <a href=\"https://stackoverflow.com/questions/3261729/monad-in-non-programming-terms\">spacesuitburritoesque</a> wording, \u201ca container that also contains a mapping\u201d. I.e. a value <code>f j k a</code> will \u201ccontain\u201d some sort of morphism(s) <code>j -&gt; k</code> <sup>(not necessarily functions, can be more general arrows)</sup> and also values of type <code>a</code>.</p>\n\n<p>For those <code>a</code> values, the container is a functor in the obvious way. In fact the <code>IxFunctor</code> class on its own is pretty boring \u2013 an</p>\n\n<pre><code>instance IxFunctor f\n</code></pre>\n\n<p>is basically the same as</p>\n\n<pre><code>instance Functor (f j k)\n</code></pre>\n\n<p>Now, where it gets interesting is when you consider the more specific functor classes. This monad one isn't actually in the <code>Indexed</code> module, but I think it makes the point best clear:</p>\n\n<pre><code>class IxPointed f =&gt; IxMonad f where\n  ijoin :: m j k (m k l a) -&gt; m j l a\n</code></pre>\n\n<p>compare this side-by-side:</p>\n\n<pre><code>(&gt;&gt;&gt;) ::  (j-&gt;k) -&gt; (k-&gt;l)   -&gt;   j-&gt;l\nijoin :: m j  k   (m k  l a) -&gt; m j  l a\njoin  :: m        (m      a) -&gt; m      a\n</code></pre>\n\n<p>So what we do is, while joining the \u201ccontainer-layers\u201d, we <em>compose</em> the morphisms.</p>\n\n<p>The obvious example is <code>IxState</code>. Recall the standard state monad</p>\n\n<pre><code>newtype State s a = State { runState :: s -&gt; (a, s) }\n</code></pre>\n\n<p>This, when used as a monad, simply composes the <code>s -&gt; s</code> aspect of the function:</p>\n\n<pre><code>  join (State f) = State $ \\s -&gt; let (State f', s') = f s in f' s'\n</code></pre>\n\n<p>so you thread the state first through <code>f</code>, then through <code>f'</code>. Well, there's really no reason we need all the states to have the same type, right? After all, the intermediate state is merely passed on to the next action. Here's the indexed state monad,</p>\n\n<pre><code>newtype IxState i j a = IxState { runIxState :: i -&gt; (a, j) }\n</code></pre>\n\n<p>It does just that:</p>\n\n<pre><code>  ijoin (IxState f) = IxState $ \\s -&gt; let (IxState f', s') = f s in f' s'\n</code></pre>\n"}], "owner": {"reputation": 8046, "user_id": 1774391, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/96ec1a791090d470daa3338f3dfdf996?s=128&d=identicon&r=PG", "display_name": "MainstreamDeveloper00", "link": "https://stackoverflow.com/users/1774391/mainstreamdeveloper00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 2, "accepted_answer_id": 27771772, "answer_count": 1, "score": 17, "last_activity_date": 1491061315, "creation_date": 1420413807, "question_id": 27771474, "link": "https://stackoverflow.com/questions/27771474/what-is-exactly-an-indexed-functor-in-haskell-and-what-are-its-usages", "title": "What is exactly an indexed functor in Haskell and what are its usages?", "body": "<p>When studying functors in Haskell I came up with <a href=\"https://hackage.haskell.org/package/category-extras-0.53.4/docs/Control-Functor-Indexed.html\">Functor.Indexed</a> type of functor. This functor defines an operation called <code>imap</code>. I didn't understood its definition and <code>imap</code> signature: <code>imap :: (a -&gt; b) -&gt; f j k a -&gt; f j k b</code>. I tried to find it s formal definition and found only this: <a href=\"http://ncatlab.org/nlab/show/indexed+functor\">http://ncatlab.org/nlab/show/indexed+functor</a> . But it really didn't help me at all. So can someone clarify in more simple words this kind of functor and in what cases should I use it? Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1420413631, "post_id": 27771035, "comment_id": 43953913, "body": "<code>getIndex c xs &#47;= -1</code> can be replaced by <code>elem c xs</code>. After this, <code>getIndex</code> should be removed: you can compare the <code>Maybe Int</code> result of <code>elemIndex</code> directly, if you want. Transforming <code>Nothing</code> into <code>-1</code> is very un-Haskellish: at best it is useless (as in this case), at worst it prods the programmer to forget about the &quot;not found&quot; case. Finally, your code does not handle other chars e.g. <code>a(b[c]d)e</code> is not valid -- this is intended, right?"}, {"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "edited": false, "score": 0, "creation_date": 1420458239, "post_id": 27771035, "comment_id": 43967626, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7209260/checking-if-a-string-consists-of-balanced-parenthesis\">Checking if a string consists of balanced parenthesis</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "is_accepted": true, "score": 6, "last_activity_date": 1420414039, "creation_date": 1420414039, "answer_id": 27771499, "question_id": 27771035, "link": "https://stackoverflow.com/questions/27771035/valid-parenthese-in-a-string-haskell-implementation/27771499#27771499", "title": "Valid Parenthese in a string (Haskell implementation)", "body": "<ul>\n<li>Loop through the string</li>\n<li>Store opening parentheses in stack</li>\n<li>Pop matching parentheses out of the stack</li>\n<li><p>Check if stack is empty at the end</p>\n\n<pre><code>isValid = loop []\n  where\n    match '(' ')' = True\n    match '{' '}' = True\n    match '[' ']' = True\n    match  _   _  = False\n\n    loop st [] = null st\n    loop st (x:xs)\n      | x `elem` \"([{\" = loop (x:st) xs\n      | x `elem` \")]}\" = case st of\n        open : st' | match open x -&gt; loop st' xs\n        _ -&gt; False -- unmatched close\n      | otherwise = loop st xs\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 3088, "user_id": 1246521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b6f356f2d97855f089819216b4bca5a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yan Zhu", "link": "https://stackoverflow.com/users/1246521/yan-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 27771499, "answer_count": 1, "score": -1, "last_activity_date": 1420414039, "creation_date": 1420410225, "question_id": 27771035, "link": "https://stackoverflow.com/questions/27771035/valid-parenthese-in-a-string-haskell-implementation", "title": "Valid Parenthese in a string (Haskell implementation)", "body": "<p>the problem is to check whether parentheses in a string is properly closed or not. For Haskell implementation, so far I have following. It looks quite awkward. I am looking for a more \"Haskell-style\" or more elegant implementation.</p>\n\n<pre><code>import Data.List\n\nisValidParentheses :: String -&gt; Bool\nisValidParentheses = isValidHelper . (filter isParenthese)\n\ngetIndex :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\ngetIndex c xs =  getOut (elemIndex c xs)\n  where getOut (Just x) = x\n        getOut Nothing = -1\n\nisLeftParenthese :: Char -&gt; Bool\nisLeftParenthese c = (getIndex c \"{[(\") /= -1\n\nisRightParenthese :: Char -&gt; Bool\nisRightParenthese c = (getIndex c \"}])\") /= -1\n\nisParenthese :: Char -&gt; Bool\nisParenthese c = isLeftParenthese c || isRightParenthese c\n\n\nisValidHelper :: String -&gt; Bool\nisValidHelper xs = helper xs []\n  where helper (x:xs) []     | isRightParenthese x = False\n                             | otherwise = helper xs [x]\n        helper [] st = null st\n        helper (x:xs) (s:ss) | isLeftParenthese x = helper xs (x:s:ss)\n                              | ((getIndex x \"}])\") /= (getIndex s \"{[(\")) = False\n                              | otherwise = helper xs ss\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "infix-notation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1420404484, "post_id": 27770118, "comment_id": 43951243, "body": "The associativity (<code>l&#47;r&#47;&lt;nothing&gt;</code>) tells how to group when there are many copies of that operator; the precedence (<code>1-9</code>) tells how to group when there are many different operators."}], "answers": [{"comments": [{"owner": {"reputation": 4004, "user_id": 1498178, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2a7f53f1d991f2ab18a4957a1f192960?s=128&d=identicon&r=PG", "display_name": "toraritte", "link": "https://stackoverflow.com/users/1498178/toraritte"}, "edited": false, "score": 0, "creation_date": 1598039632, "post_id": 27770182, "comment_id": 112338980, "body": "Downvote - Please anyone tell me how that&#39;s an informative and well-researched answer to the question at hand, and why it shouldn&#39;t just be an obscure comment somewhere on the page."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 4004, "user_id": 1498178, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2a7f53f1d991f2ab18a4957a1f192960?s=128&d=identicon&r=PG", "display_name": "toraritte", "link": "https://stackoverflow.com/users/1498178/toraritte"}, "edited": false, "score": 1, "creation_date": 1598054275, "post_id": 27770182, "comment_id": 112342835, "body": "@toraritte: The question: \u201cIf so, why is the numeric argument necessary considering that brackets have the highest precedence)?\u201d Here\u2019s an example of an expression without brackets, therefore requiring the operator to have a precedence. It\u2019s short and to the point. If you don\u2019t find it helpful, well, that\u2019s perfectly within your rights."}, {"owner": {"reputation": 4004, "user_id": 1498178, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2a7f53f1d991f2ab18a4957a1f192960?s=128&d=identicon&r=PG", "display_name": "toraritte", "link": "https://stackoverflow.com/users/1498178/toraritte"}, "edited": false, "score": 0, "creation_date": 1598055987, "post_id": 27770182, "comment_id": 112343106, "body": "The question was &quot;<i>How does the &#39;infix&#39; work?</i>&quot;, and then they expanded on it, ending with a couple questions, probably to clarify their inquiry. Plus, I&#39;m just wasting energy belaboring the obvious, and I should get a life instead."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": false, "score": 4, "last_activity_date": 1420404342, "creation_date": 1420404342, "answer_id": 27770182, "question_id": 27770118, "link": "https://stackoverflow.com/questions/27770118/how-does-the-infix-work/27770182#27770182", "title": "How does the &#39;infix&#39; work?", "body": "<p>Because</p>\n\n<pre><code>1 +++ 2 &lt; 3\n</code></pre>\n\n<p>works fine.</p>\n"}, {"tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 39, "last_activity_date": 1544606936, "last_edit_date": 1544606936, "creation_date": 1420406165, "answer_id": 27770448, "question_id": 27770118, "link": "https://stackoverflow.com/questions/27770118/how-does-the-infix-work/27770448#27770448", "title": "How does the &#39;infix&#39; work?", "body": "<h2>tl;dr</h2>\n\n<p>The <code>r</code> and <code>l</code> refer to the associativity, the number you specify refers to the operator precedence. When you don't specify the associativity you get an operator that can be associated only by explicit parenthesis or when the associativity is non-ambiguous.</p>\n\n<h2>Our test data structure</h2>\n\n<p>Let's use a data structure to define operators on and understand how associativity works:</p>\n\n<pre><code>data Test = Test String deriving (Eq, Show)\n</code></pre>\n\n<p>It will contain the string built with the below operators.</p>\n\n<h2>Associativity with <code>infixr</code> and <code>infixl</code></h2>\n\n<p>Now let's define right- and left- associative operators:</p>\n\n<pre><code>(&gt;:) :: Test -&gt; Test -&gt; Test\n(Test a) &gt;: (Test b) = Test $ \"(\" ++ a ++ \" &gt;: \" ++ b ++ \")\"\n\n(&lt;:) :: Test -&gt; Test -&gt; Test\n(Test a) &lt;: (Test b) = Test $ \"(\" ++ a ++ \" &lt;: \" ++ b ++ \")\"\n\ninfixr 6 &gt;:\ninfixl 6 &lt;:\n</code></pre>\n\n<p>These operator will construct the string of the resulting operator by explicitly adding the parenthesis to our associated terms.</p>\n\n<p>If we test it out we see that it works correctly:</p>\n\n<pre><code>print $ (Test \"1\") &gt;: (Test \"2\") &gt;: (Test \"4\")\n-- Test \"(1 &gt;: (2 &gt;: 4))\"\n\nprint $ (Test \"1\") &lt;: (Test \"2\") &lt;: (Test \"4\")\n-- Test \"((1 &lt;: 2) &lt;: 4)\"\n</code></pre>\n\n<h2>\"Associativity\" with <code>infix</code></h2>\n\n<p>An <code>infix</code> declaration does not specify associativity. So what should happen in those cases? Let's see:</p>\n\n<pre><code>(?:) :: Test -&gt; Test -&gt; Test\n(Test a) ?: (Test b) = Test $ \"(\" ++ a ++ \" ?: \" ++ b ++ \")\"\n\ninfix 6 ?:\n</code></pre>\n\n<p>And then let's try it:</p>\n\n<pre><code>print $ (Test \"1\") ?: (Test \"2\") ?: (Test \"4\")\n</code></pre>\n\n<p>Woops, we get:</p>\n\n<blockquote>\n  <p>Precedence parsing error\n          cannot mix `?:' [infix 6] and `?:' [infix 6] in the same infix expression</p>\n</blockquote>\n\n<p>As you can see the language parser noticed that we didn't specify the associativity of the operator and doesn't know what to do. </p>\n\n<p>If we instead remove the last term:</p>\n\n<pre><code>print $ (Test \"1\") ?: (Test \"2\")\n-- Test \"(1 ?: 2)\"\n</code></pre>\n\n<p>Then the compiler doesn't complain.</p>\n\n<p>To fix the original term we would need to explicitly add parenthesis; for example:</p>\n\n<pre><code>print $ (Test \"1\") ?: ((Test \"2\") ?: (Test \"4\"))\n-- Test \"(1 ?: (2 ?: 4))\"\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/b2a647ed60e41129\" rel=\"noreferrer\"><kbd>Live demo</kbd></a></p>\n"}], "owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10006, "favorite_count": 9, "accepted_answer_id": 27770448, "answer_count": 2, "score": 22, "last_activity_date": 1544606936, "creation_date": 1420403959, "last_edit_date": 1420447584, "question_id": 27770118, "link": "https://stackoverflow.com/questions/27770118/how-does-the-infix-work", "title": "How does the &#39;infix&#39; work?", "body": "<p>I'm playing with the <code>infixr</code>, <code>infixl</code> and <code>infix</code> declarations. I understand how <code>infixr</code> and <code>infixl</code> works:</p>\n\n<pre><code>-- Test expression: 40 +++ 20 +++ 50 +++ 10 * 10\n\n-- infixr 8 +++ -- Calculated as: (40 +++ (20 +++ (50 +++ 10))) * 10. Result: 630.\n-- infixl 8 +++ -- Calculated as: (((40 +++ 20) +++ 50) +++ 10) * 10. Result: 800.\n\n-- infixr 6 +++ -- Calculated as: 40 +++ (20 +++ (50 +++ (10 * 10))). Result: 75.\n-- infixl 6 +++ -- Calculated as: ((40 +++ 20) +++ 50) +++ (10 * 10). Result: 125.\n\n(+++) :: Int -&gt; Int -&gt; Int\na +++ b = a + (b `div` 2)\n</code></pre>\n\n<p>But I don't understand how the <code>infix</code> keyword works. Am I right in thinking that with <code>infix</code> you always need to specify the order with parenthesis? If so, why is the numeric argument necessary considering that brackets have the highest precedence)? </p>\n"}, {"tags": ["haskell", "iteration", "differentiation"], "comments": [{"owner": {"reputation": 29, "user_id": 4400821, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/071934f389c2b84225ea46908db092bc?s=128&d=identicon&r=PG&f=1", "display_name": "overpro", "link": "https://stackoverflow.com/users/4400821/overpro"}, "edited": false, "score": 0, "creation_date": 1420401756, "post_id": 27769754, "comment_id": 43950327, "body": "use &quot;iterate&quot;command"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1420405036, "post_id": 27769754, "comment_id": 43951423, "body": "For future questions, please quote proper declarations of the functions you&#39;re talking about (type signatures!) and use Markdown to make your post nicely readable."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1420414559, "post_id": 27769754, "comment_id": 43954129, "body": "An OT suggestion: when programming, especially in a functional programming language, please try to unlearn the bad habit of saying &quot;<code>sin x</code> is a function&quot; when actually meaning &quot;<code>\\x -&gt; sin x</code> is a function&quot;. In your case, I guess, <code>sin x</code> is actually some value representing an <i>expression</i>, i.e. a piece of syntax, using a suitable data type. If that&#39;s the case, it is likely not written as <code>sin x</code> at all, in Haskell. So, as @leftaroundabout said, try to be clear about the involved types."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1420404950, "post_id": 27769909, "comment_id": 43951400, "body": "It would probably be a good idea to flip the definition of <code>diff</code> itself, so you can write <code>diff &quot;x&quot;</code> as the differential operator \u2202/\u2202x. (Also, it would probably be better to change the type of the differentiation-variable: &quot;magic strings&quot; aren&#39;t very nice...)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1420402718, "creation_date": 1420402718, "answer_id": 27769909, "question_id": 27769754, "link": "https://stackoverflow.com/questions/27769754/list-of-differentiations-maclaurin-expansion/27769909#27769909", "title": "list of differentiations ( Maclaurin expansion)", "body": "<p>Use <code>flip</code> in conjunction with <code>iterate</code>:</p>\n\n<pre><code>(flip diff) \"x\" f = diff f \"x\"\n</code></pre>\n\n<p>so</p>\n\n<pre><code>iterate ((flip diff) \"x\") f = [ f, f', f'', ...]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4400821, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/071934f389c2b84225ea46908db092bc?s=128&d=identicon&r=PG&f=1", "display_name": "overpro", "link": "https://stackoverflow.com/users/4400821/overpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 27769909, "answer_count": 1, "score": 0, "last_activity_date": 1420402718, "creation_date": 1420401726, "question_id": 27769754, "link": "https://stackoverflow.com/questions/27769754/list-of-differentiations-maclaurin-expansion", "title": "list of differentiations ( Maclaurin expansion)", "body": "<p>Here,I have a diff function which can be used to differentiate.  </p>\n\n<p>for example diff (sin x) (\"x\")= cos x  </p>\n\n<p>(here,(sin x) is the function, (\"x\") is the variable i want to differentiate)  </p>\n\n<p>How to use iterate to generate a list of differentiations of function [f(x),f'(x),f'(x),f''(x)....]  </p>\n"}, {"tags": ["haskell", "tree", "fold"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1420401858, "post_id": 27769688, "comment_id": 43950357, "body": "Define what you mean by &quot;minimal information&quot;. I think the tree itself is pretty much as simple as it gets, for any &quot;structure with depth&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1420403327, "post_id": 27769688, "comment_id": 43950879, "body": "I like this question a lot. Perhaps a related question is: is there anything like <code>Traversable</code> that uses <i>both</i> the <code>Alternative</code> and <code>Applicative</code> structure of the folding <code>Functor</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1420404021, "post_id": 27769688, "comment_id": 43951109, "body": "(A few more details of what I&#39;m thinking: it wouldn&#39;t be hard to define <code>data Depth a = Depth Nat</code> with the obvious <code>Functor</code> instance. The <code>Applicative</code> monoid could be <code>(+,0)</code> and the <code>Alternative</code> one <code>(max,0)</code>.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1420451979, "post_id": 27769688, "comment_id": 43964580, "body": "Unfortunately, <code>Data.Foldable</code> won&#39;t do anything for you here, except provide a (possibly infinite) upper bound. It&#39;s just too &quot;one-dimensional&quot;. Anything you can do with the <code>Data.Foldable</code> instance for <code>Tree</code> you can do using just <code>toList</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420453412, "post_id": 27769688, "comment_id": 43965316, "body": "The minimal information required to compute the depth of a tree is ... the depth of the tree. I know that&#39;s not so useful, but it&#39;s very clearly true."}], "answers": [{"comments": [{"owner": {"reputation": 3088, "user_id": 2008899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc08db690c45406131e861e766b252c?s=128&d=identicon&r=PG", "display_name": "Boyd Stephen Smith Jr.", "link": "https://stackoverflow.com/users/2008899/boyd-stephen-smith-jr"}, "edited": false, "score": 0, "creation_date": 1421944585, "post_id": 27783737, "comment_id": 44564101, "body": "I don&#39;t think that <code>F.Foldable</code> instance is law-abiding, since it drops all <code>rootLabel</code>s."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 3088, "user_id": 2008899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc08db690c45406131e861e766b252c?s=128&d=identicon&r=PG", "display_name": "Boyd Stephen Smith Jr.", "link": "https://stackoverflow.com/users/2008899/boyd-stephen-smith-jr"}, "edited": false, "score": 1, "creation_date": 1421961368, "post_id": 27783737, "comment_id": 44573437, "body": "@BoydStephenSmithJr. That&#39;s a misunderstanding. The data type <code>TreeF a t</code> holds 2 kinds of things: The root label of type <code>a</code> and the sub-forests of type <code>t</code>. The <code>F.Foldable (TreeF a)</code> instance iterates on elements of type <code>t</code>, that is, on sub-forests - the type <code>a</code> is even outside the scope of the instance."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1546980020, "post_id": 27783737, "comment_id": 95031550, "body": "Four years later and I still don&#39;t understand the answer. But yeah, this does look like what I was asking for..."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 5, "last_activity_date": 1569270514, "last_edit_date": 1569270514, "creation_date": 1420475381, "answer_id": 27783737, "question_id": 27769688, "link": "https://stackoverflow.com/questions/27769688/what-is-the-most-general-way-to-compute-the-depth-of-a-tree-with-something-like/27783737#27783737", "title": "What is the most general way to compute the depth of a tree with something like a fold?", "body": "<p>I can't say if it's a minimal/most general amount of information. But one general solution is that a given structure</p>\n\n<ul>\n<li>is a <a href=\"https://en.wikipedia.org/wiki/Catamorphism\" rel=\"nofollow noreferrer\">catamorphism</a></li>\n<li>underlying functor of the catamorphism is <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Foldable.html#t:Foldable\" rel=\"nofollow noreferrer\"><code>Foldable</code></a> so that it's possible to enumerate sub-terms.</li>\n</ul>\n\n<p>Here is sample code using <a href=\"https://hackage.haskell.org/package/recursion-schemes\" rel=\"nofollow noreferrer\">recursion-schemes</a>.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, FlexibleContexts #-}\n\nimport Data.Functor.Foldable\nimport Data.Semigroup\nimport Data.Tree\n\ndepth :: (Recursive f, Foldable (Base f)) =&gt; f -&gt; Int\ndepth = cata ((+ 1) . maybe 0 getMax . getOption\n              . foldMap (Option . Just . Max))\n\n-- Necessary instances for Tree:\n\ndata TreeF a t = NodeF { rootLabel' :: a, subForest :: [t] }\n\ntype instance Base (Tree a) = TreeF a\n\ninstance Functor (TreeF a) where\n    fmap f (NodeF x ts) = NodeF x (map f ts)\n\ninstance Foldable (TreeF a) where\n    foldMap f (NodeF _ ts) = foldMap f ts\n\ninstance Recursive (Tree a) where\n    project (Node x ts) = NodeF x ts\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": false, "score": 2, "last_activity_date": 1420484550, "last_edit_date": 1495540674, "creation_date": 1420484550, "answer_id": 27786082, "question_id": 27769688, "link": "https://stackoverflow.com/questions/27769688/what-is-the-most-general-way-to-compute-the-depth-of-a-tree-with-something-like/27786082#27786082", "title": "What is the most general way to compute the depth of a tree with something like a fold?", "body": "<p>To answer the first question: <code>Data.Foldable</code> is <strong>not enough</strong> to compute the depth of the tree. The minimum complete definition of <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Foldable.html#t:Foldable\" rel=\"nofollow noreferrer\">Foldable</a> is <code>foldr</code>, which always has the following semantics:</p>\n\n<pre><code>foldr f z = Data.List.foldr f z . toList\n</code></pre>\n\n<p>In other words, a <code>Foldable</code> instance is <em>fully</em> characterized by how it behaves on a list projection of the input (ie <code>toList</code>), which will throw away the depth information of a tree.</p>\n\n<p>Other ways of verifying this idea involve the fact that <code>Foldable</code> depends on a monoid instance which has to be associative or the fact that the various <code>fold</code> functions see the elements one by one in some particular order with no other information, which necessarily throws out the actual tree structure. (There has to be more than one tree with the same set of elements in the same relative order.)</p>\n\n<p>I'm not sure what the minimal abstraction would be for trees <em>specifically</em>, but I think the core of your question is actually a bit broader: it would be interesting to see what minimum amount of information is needed to compute arbitrary facts about a type with a fold-like function.</p>\n\n<p>To do this, the actual helper function in the fold would have to take a different sort of argument for each sort of data structure. This naturally leads us to <strong>catamorphisms</strong>, which are generalized folds over different data types. </p>\n\n<p>You can read more about these generalized folds on a different Stack Overflow question: <a href=\"https://stackoverflow.com/questions/16426463/what-constitutes-a-fold-for-types-other-than-list/16426964#16426964\">What constitutes a fold for types other than list?</a> (In the interest of disclosure/self-promotion, I wrote one of the answeres there :P.)</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "answer_count": 2, "score": 10, "last_activity_date": 1569270514, "creation_date": 1420401320, "last_edit_date": 1420484641, "question_id": 27769688, "link": "https://stackoverflow.com/questions/27769688/what-is-the-most-general-way-to-compute-the-depth-of-a-tree-with-something-like", "title": "What is the most general way to compute the depth of a tree with something like a fold?", "body": "<p>What minimal (most general) information is required to compute depth of a <code>Data.Tree</code>? Is instance of a <code>Data.Foldable</code> sufficient? </p>\n\n<p>I initially tried to <code>fold</code> a <code>Tree</code> and got stuck trying to find right <code>Monoid</code> similar to <code>Max</code>. Something tells me that since <code>Monoid</code> (that would compute depth) needs to be associative, it probably cannot be used to express any fold that needs to be aware of the structure (as in <code>1 + maxChildrenDepth</code>), but I'm not certain.</p>\n\n<p>I wonder what thought process would let me arrive at right abstraction for such cases.</p>\n"}, {"tags": ["algorithm", "sorting", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1420393486, "post_id": 27768426, "comment_id": 43947484, "body": "This definitely looks comparison-based to me. Are you supposed to be using some sort of radix sort?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1420394022, "post_id": 27768426, "comment_id": 43947666, "body": "<code>import Data.List (sort)</code> and <code>sort &quot;HOHOHOO!!!&quot;</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1420394321, "post_id": 27768426, "comment_id": 43947775, "body": "@AaditMShah: <code>sort</code> is comparison based."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1420395382, "post_id": 27768426, "comment_id": 43948146, "body": "<a href=\"https://en.wikipedia.org/wiki/Radix_sort\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Radix_sort</a> should give you the info you need. Your life will be much easier if you use functions from <code>Data.Bits</code> instead of trying to stick with the <code>Prelude</code> ones. You should probably <code>import Data.Char (ord, chr)</code> also, to avoid needing to spray <code>toEnum</code> and <code>fromEnum</code> all over your code."}, {"owner": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420409635, "post_id": 27768426, "comment_id": 43952878, "body": "@dfeuer I have to use a non-comparative sorting. I was my guess that it should be a radix sort"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "edited": false, "score": 0, "creation_date": 1420404878, "post_id": 27768924, "comment_id": 43951368, "body": "I am sorry to addmit it, but your answer is too complicated for me... I tried putting in your code, but it doesn&#39;t work for me. Could you please explain it or do more a easier version of it?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "edited": false, "score": 0, "creation_date": 1420405144, "post_id": 27768924, "comment_id": 43951459, "body": "@DashaVKravets &quot;It doesn&#39;t work&quot; isn&#39;t specific enough for me to give much more help, really. What did you do, exactly? What happened? (What error did you get?) What did you expect to happen?"}, {"owner": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "edited": false, "score": 0, "creation_date": 1420409461, "post_id": 27768924, "comment_id": 43952816, "body": "@ Daniel Wagner I put import Data.Array countingSort = accumArray (+) 0 (minBound, maxBound) . flip zip (repeat 1) in Notepad++, tried to reload in WinHugs and got &quot;ERROR file:.\\new  0.hs:69 - Unresolved top-level overloading *** Binding             : countingSort *** Outstanding context : (Bounded b, Ix b)&quot;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "edited": false, "score": 1, "creation_date": 1420418241, "post_id": 27768924, "comment_id": 43954903, "body": "@DashaVKravets Sounds like the monomorphism restriction. Try adding a type signature (I&#39;ll edit the answer shortly to show how)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "edited": false, "score": 2, "creation_date": 1420430829, "post_id": 27768924, "comment_id": 43957351, "body": "@DashaVKravets, this isn&#39;t really relevant, but Hugs has not been maintained since 2006, so you should probably switch to GHC and GHCi for your Haskell adventures."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420431520, "post_id": 27768924, "comment_id": 43957498, "body": "@DanielWagner, isn&#39;t this going to allocate a rather large array (on the order of a million entries), and then fill some unknown but small portion of it with counts that will not be so easy to use?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1420434079, "post_id": 27768924, "comment_id": 43958064, "body": "@dfeuer What&#39;s a few megabytes between friends? But yes, a sparse data structure -- e.g. <code>IntMap</code>, which I suggested in the answer -- may be more desirable in some cases."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1420418335, "last_edit_date": 1420418335, "creation_date": 1420396442, "answer_id": 27768924, "question_id": 27768426, "link": "https://stackoverflow.com/questions/27768426/how-to-sort-hohohoo-in-haskell-using-any-non-comparative-integer-sorting-al/27768924#27768924", "title": "How to sort &#39;HOHOHOO!!!&#39; in Haskell using any non-comparative integer sorting algorithm?", "body": "<p>A counting sort is non-comparative and quite easy (a one-liner!) in Haskell:</p>\n\n<pre><code>import Data.Array\n\ncountingSort :: (Bounded a, Ix a, Num i) =&gt; [a] -&gt; Array a i\ncountingSort = accumArray (+) 0 (minBound, maxBound) . flip zip (repeat 1)\n</code></pre>\n\n<p>Radix sort can be implemented with a similar technique, using data structures that reify radix lookups. See <a href=\"http://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap.html\" rel=\"nofollow\">IntMap</a> for sorting <code>Int</code>s, or browse the many memoization packages for interfaces that can handle other types of data.</p>\n"}], "owner": {"reputation": 39, "user_id": 4417804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492087026/picture?type=large", "display_name": "Dasha V Kravets", "link": "https://stackoverflow.com/users/4417804/dasha-v-kravets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420418335, "creation_date": 1420393403, "question_id": 27768426, "link": "https://stackoverflow.com/questions/27768426/how-to-sort-hohohoo-in-haskell-using-any-non-comparative-integer-sorting-al", "title": "How to sort &#39;HOHOHOO!!!&#39; in Haskell using any non-comparative integer sorting algorithm?", "body": "<p>I am trying to sort 'HOHOHOO!!!' in Haskell using any non-comparative integer sorting algorithm, so that at the end I get '!!!HHHOOOO'.. </p>\n\n<p>I am only string with Haskell and have been sitting on it all day... Please, help! </p>\n\n<p>All i got so far is this, but it doesn't allow to sort Letters. I think i need to use a Radix sort, but i Have no idea how.</p>\n\n<pre><code>merge [] l = l\nmerge l [] = l\nmerge l1@(x1:r1) l2@(x2:r2) =\nif x1 &lt; x2 then x1:(merge r1 l2) else x2:(merge l1 r2)\n\nssort [] = []\nssort l = merge strand (ssort rest)\nwhere (strand, rest) = foldr extend ([],[]) l\n      extend x ([],r) = ([x],r)\n      extend x (s:ss,r) = if x &lt;= s then (x:s:ss,r) else (s:ss,x:r)\n</code></pre>\n\n<p>Thank you,\nDasha</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420388394, "post_id": 27767307, "comment_id": 43945709, "body": "It does what? Where does this <code>n</code> come from?"}, {"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420388863, "post_id": 27767307, "comment_id": 43945860, "body": "Added an explanation for both arguments, thanks for pointing out I forgot that."}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420388098, "post_id": 27767399, "comment_id": 43945611, "body": "To check if an Int modulo another Int (since both vary) would require me to give in both Ints as an input, which would make it <code>f :: Int -&gt; Int -&gt; Bool</code>. Can I handle that with <code>all</code>?"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "reply_to_user": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420388724, "post_id": 27767399, "comment_id": 43945812, "body": "Sure. For ease of notation, let&#39;s say that the thing you mod by is the first argument to <code>f :: Int -&gt; Int -&gt; Bool</code>, i.e. that <code>f n m</code> checks if <code>m</code> is zero modulo <code>n</code> (however unpleasant that may be to read). Partial application means that <code>f n</code> is a new function with signature <code>Int -&gt; Bool</code>. This is the function that checks if its (single!) argument is zero modulo n, and it (i.e. <code>f n</code>) is precisely the function you pass to <code>all</code>."}, {"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420389200, "post_id": 27767399, "comment_id": 43945968, "body": "Trying to do that gives me a &quot;not in scope&quot; for m, which was kinda what I expected since I&#39;m telling f to know n but not m while using both in <code>f n = m &#39;mod&#39; n == 0</code>, how can I bypass that? Signature is <code>f :: Int -&gt; Bool</code> now. I&#39;M sorry for these basic questions, but I really don&#39;t understand where <code>all</code> would take the other Int from and how <code>f</code> could work alone."}], "tags": [], "owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "is_accepted": false, "score": 3, "last_activity_date": 1420387284, "creation_date": 1420387284, "answer_id": 27767399, "question_id": 27767307, "link": "https://stackoverflow.com/questions/27767307/check-if-int-mod-every-element-of-a-list-0/27767399#27767399", "title": "Check if Int `mod` every element of a list == 0", "body": "<p>Can you write down a function <code>f :: Int -&gt; Bool</code> that checks if an <code>Int</code> is 0 modulo n? I'll leave this first step to you.</p>\n\n<p>So now you have a function <code>f :: Int -&gt; Bool</code> and a list of <code>Int</code>s, and you want to see if <code>f x</code> is <code>True</code> for every <code>x</code> in the list. We <a href=\"https://www.haskell.org/hoogle/?hoogle=%28Int%20-%3E%20Bool%29%20-%3E%20[Int]%20-%3E%20Bool\" rel=\"nofollow\">ask Hoogle</a>, and it tells us about <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Prelude.html#v:all\" rel=\"nofollow\"><code>all</code></a>. You'll use <code>f</code> as the first argument of <code>all</code> to do what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420396455, "post_id": 27768341, "comment_id": 43948584, "body": "Shouldn&#39;t <code>p x = x </code>mod` n == 0` also give a &quot;not in scope&quot; error for n? And I&#39;m sorry, but as a complete beginner I am having trouble with your last line of code. The $ is a dividing symbol between arguments that are meant to be in different brackets, right? Is this equivalent to <code>bfLCM xs = fromJust (find SOMETHING [2..])</code>? And if so, where do you specify if a number fits the scheme (in this case being a mod 0 of x)?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420396797, "post_id": 27768341, "comment_id": 43948693, "body": "@JoeCocker, <code>p x = x `mod` n == 0</code> will give a &quot;not in scope&quot; error for <code>n</code>, yes, <i>unless</i> you put that definition in a place where <code>n</code> is in scope, using a <code>let</code> expression or a <code>where</code> clause. <code>$</code> is the function application operator, so <code>fromJust $ find SOMETHING [2..]</code> does indeed mean <code>fromJust (find SOMETHING [2..])</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420396838, "post_id": 27768341, "comment_id": 43948707, "body": "By the way, you can type backticks in inline code by using <i>double</i> backticks to surround that code."}, {"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420397668, "post_id": 27768341, "comment_id": 43949000, "body": "Yeah I actually knew you could use backticks here to escape some characters, I just did not see I produced an imcomplete code in my last comment and time ran out to fix it. Anyway, I implemented the code using <code>if all p xs</code> and <code>where p x = x `mod` n == 0</code> and I ran into your predicted infinite loop while testing. Can you give any lead why this happens? From my point of view the math actually seemed fine, I check every whole number from 2 onwards until it fits the scheme <code>[m] `mod` n == 0</code>, is there a logical mistake or just a wrong implementation?"}, {"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420397948, "post_id": 27768341, "comment_id": 43949097, "body": "Well actually my initial question was &quot;How can I check if every element of a list mod n equals 0&quot;, which got solved by you right now, so I should ask for more help in a new thread according to the guidelines for asking questions. Thank you!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420398102, "post_id": 27768341, "comment_id": 43949154, "body": "@JoeCocker, think about what LCM means again. You&#39;ll get there."}, {"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420398477, "post_id": 27768341, "comment_id": 43949325, "body": "oh wow, i implemented a solution to find the smallest shared divisor if there exists one and go in an infinite loop if there is none! well, thank you for pointing that out, i think i wouldn&#39;t have seen such an obvious mistake because i was too sure with my code... so i&#39;ll just have to swap some things out now that i know how i can approach the problem"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420398849, "post_id": 27768341, "comment_id": 43949442, "body": "@JoeCocker, you only need to swap exactly two variables. Think about what divides what."}, {"owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "edited": false, "score": 0, "creation_date": 1420399406, "post_id": 27768341, "comment_id": 43949599, "body": "yes, I now swapped x and n in my where statement and changed it in my initial post. Interesting though that you get the least common divisor and least common multiple by just swapping out what divides what, I never thought of that by just looking at it."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1420392923, "creation_date": 1420392923, "answer_id": 27768341, "question_id": 27767307, "link": "https://stackoverflow.com/questions/27767307/check-if-int-mod-every-element-of-a-list-0/27768341#27768341", "title": "Check if Int `mod` every element of a list == 0", "body": "<p>You're starting out with</p>\n\n<pre><code>bruteforceLCM :: [Int] -&gt; Int -&gt; Int\nbruteforceLCM xs n = if EVERYELEMENTOFTHELIST `mod` n == 0\n                       then n\n                       else (bruteforceLCM xs (n+1))\n</code></pre>\n\n<p>When you say <code>EVERYELEMENTOFTHELIST `mod` n == 0</code>, what you really mean is \"For each element, <code>x</code>, of <code>xs</code>, <code>x `mod` n == 0</code>\".</p>\n\n<p>Let's write a predicate expressing what that says about an element of the list:</p>\n\n<pre><code>p x = x `mod` n == 0\n</code></pre>\n\n<p>Now we can use <code>all</code>, which takes our predicate and tells us if it's true for all elements of the list.</p>\n\n<p>But now we might want to clean things up a bit at a higher level. Because Haskell is lazy, we don't need to be so explicit about the recursion. We can do something like this instead:</p>\n\n<pre><code>bfLCM xs = fromJust $ find SOMETHING [2..]\n</code></pre>\n\n<p>Unfortunately, running this leads to a lot of infinite loops, because your math actually turns out to be a little bit wrong. Can you figure out where your mistake is?</p>\n"}], "owner": {"reputation": 148, "user_id": 2834788, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bjp4B.jpg?s=128&g=1", "display_name": "Nico Wawrzyniak", "link": "https://stackoverflow.com/users/2834788/nico-wawrzyniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 27768341, "answer_count": 2, "score": 1, "last_activity_date": 1420399055, "creation_date": 1420386785, "last_edit_date": 1420399055, "question_id": 27767307, "link": "https://stackoverflow.com/questions/27767307/check-if-int-mod-every-element-of-a-list-0", "title": "Check if Int `mod` every element of a list == 0", "body": "<p>I'm writing a (Literate) Haskell code that bruteforces the lcm (least common multiple) of a list of Ints.</p>\n\n<p>I already thought about a strategy, but I'm not that good with Haskell syntax and don't know a lot of functions.</p>\n\n<p>This is the function so far:</p>\n\n<pre><code>&gt; bruteforceLCM :: [Int] -&gt; Int -&gt; Int\n&gt; bruteforceLCM xs n = if EVERYELEMENTOFTHELIST `mod` n == 0\n&gt;                        then n\n&gt;                        else (bruteforceLCM xs (n+1))\n</code></pre>\n\n<p>Where xs is the list of all Ints and n is the current Int that gets checked for being the lcm.</p>\n\n<p>The first call would be <code>bruteforceLCM xs 2</code>, because n=0 would be not divisible and n=1 would always return true, these cases are solved with pattern matching earlier.</p>\n\n<p>What would I have to replace \"EVERYELEMENTOFTHELIST\" with to achieve my goal?</p>\n\n<p>Greeting, Joe</p>\n\n<p>EDIT: Here is the whole code now, thanks to dfeuer!</p>\n\n<pre><code>&gt; bruteforceKGV :: [Int] -&gt; Int -&gt; Int\n&gt; bruteforceKGV xs n = if all p xs then n else (bruteforceKGV xs (n+1))\n&gt;   where p x = n `mod` x == 0\n</code></pre>\n"}, {"tags": ["haskell", "ffi", "hsc2hs", "c2hsc"], "comments": [{"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 3, "creation_date": 1420385557, "post_id": 27767020, "comment_id": 43944710, "body": "Given that the <code>hsc2hs</code> codebase no mention of unions at all I suspect it&#39;s not implemented.  Plus, unions are inherently unsafe, so it&#39;s not obvious how one would translate them into algebraic data types.  To do it safely one needs the discriminator as well, which is an entity outside the union."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420385671, "post_id": 27767020, "comment_id": 43944744, "body": "Your best bet would probably be to write the functions to construct and manipulate these in C yourself, and then use those from the Haskell side. But I know nothing about the FFI."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1458369933, "creation_date": 1458369933, "answer_id": 36098756, "question_id": 27767020, "link": "https://stackoverflow.com/questions/27767020/interfacing-c-unions-in-haskell-via-c2hsc-and-hsc2hs/36098756#36098756", "title": "Interfacing C unions in Haskell via c2hsc and hsc2hs", "body": "<p><code>c2hsc</code> just generates <code>bindings-dsl</code> macros. Using the <a href=\"https://github.com/jwiegley/bindings-dsl/wiki/Types\" rel=\"nofollow\">documentation there</a>, you should be able to figure out how to write these directly. Consider something like...</p>\n\n<pre><code>#starttype struct sum_t\n#field tag , CInt\n#field v.a , CChar\n#field v.b , CDouble\n#stoptype\n</code></pre>\n\n<p>The documentation <a href=\"https://github.com/jwiegley/bindings-dsl/wiki/TipsAndQuestions\" rel=\"nofollow\">goes on to describe</a> how to manipulate unions using pointers.</p>\n"}], "owner": {"reputation": 7698, "user_id": 1106679, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0bfae7a37115975e05f2e7d471ce8eb1?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1106679/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1458369933, "creation_date": 1420385052, "last_edit_date": 1420396396, "question_id": 27767020, "link": "https://stackoverflow.com/questions/27767020/interfacing-c-unions-in-haskell-via-c2hsc-and-hsc2hs", "title": "Interfacing C unions in Haskell via c2hsc and hsc2hs", "body": "<p>While using <code>c2hsc</code> and <code>hsc2hs</code> saves me a lot of work, I've run into some trouble when trying to create bindings for C unions.</p>\n\n<hr>\n\n<p>For example, given the C structure</p>\n\n<pre><code>typedef struct {\n      int tag;\n      union {\n            char a;\n            double b;\n      } v;\n} sum_t;\n</code></pre>\n\n<p><code>c2hsc</code> creates the following code for me:</p>\n\n<pre><code>#starttype sum_t\n#field tag , CInt\n#field v , \n#stoptype\n</code></pre>\n\n<p>where the <code>v</code> field is generated empty. Going further down the toolchain via <code>hsc2hs</code> yields the incorrect</p>\n\n<pre><code>data C'sum_t = C'sum_t{\n  c'sum_t'tag :: CInt,\n  c'sum_t'v :: \n}\n</code></pre>\n\n<hr>\n\n<p>The questions now are</p>\n\n<ol>\n<li>What is the correct way to write the <code>.hsc</code> code manually so I can work with the bindings?</li>\n<li>Is there a way I can make <code>c2hsc</code> do this automatically?</li>\n</ol>\n"}, {"tags": ["haskell", "rpc"], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": true, "score": 3, "last_activity_date": 1420435671, "last_edit_date": 1420435671, "creation_date": 1420385934, "answer_id": 27767159, "question_id": 27765464, "link": "https://stackoverflow.com/questions/27765464/haskell-rpc-framework-in-production/27767159#27767159", "title": "Haskell RPC framework in production", "body": "<p>Yes. There is <a href=\"https://www.haskell.org/haskellwiki/HaXR\" rel=\"nofollow\">https://www.haskell.org/haskellwiki/HaXR</a>. If JSON is more your thing then there's also <a href=\"http://hackage.haskell.org/package/json-rpc-server\" rel=\"nofollow\">http://hackage.haskell.org/package/json-rpc-server</a>, but that's only for the server side (the same guy is also doing a client library but it's not as mature)</p>\n\n<p>Having said that: RPC should always be the last resort because it's always bad for reliability and performance (this is general programming advice, not specific to Haskell)</p>\n"}], "owner": {"reputation": 389, "user_id": 2428540, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ded04fd3243d82817640ea9a7a725b3?s=128&d=identicon&r=PG", "display_name": "hl1020", "link": "https://stackoverflow.com/users/2428540/hl1020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "closed_date": 1420391207, "accepted_answer_id": 27767159, "answer_count": 1, "score": -1, "last_activity_date": 1420435671, "creation_date": 1420374318, "question_id": 27765464, "link": "https://stackoverflow.com/questions/27765464/haskell-rpc-framework-in-production", "closed_reason": "Not suitable for this site", "title": "Haskell RPC framework in production", "body": "<p>I really think Haskell is a awesome programming language, but it seems that Haskell lacks the handy and mature tools can be used in production.\nDoes Haskell have a mature, stable and convenient RPC framework to use like Finagle in Scala? Has any one use Haskell in production and how do they handle the communication between different ends? \nThanks.</p>\n"}, {"tags": ["haskell", "decoding", "huffman-code"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1420373906, "post_id": 27765127, "comment_id": 43941435, "body": "Why not just reconstruct the tree from the <code>HCodeMap</code>?"}, {"owner": {"reputation": 13, "user_id": 4417095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7beb98d94a065e114fa7a450aabea0b8?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin89", "link": "https://stackoverflow.com/users/4417095/gavin89"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1420374882, "post_id": 27765127, "comment_id": 43941679, "body": "Unfortunately all of our tree creation functions require a string for their input, and also we were asked not to recreate all of them using a different input."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4417095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7beb98d94a065e114fa7a450aabea0b8?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin89", "link": "https://stackoverflow.com/users/4417095/gavin89"}, "edited": false, "score": 1, "creation_date": 1420385050, "post_id": 27766480, "comment_id": 43944549, "body": "Ahh, I knew I had been doing something wrong! The act of just recursively calling a function on the next elements makes SO much more sense than trying to keep creating a longer list! Managed to get it all working! Thank you! :)"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 3, "last_activity_date": 1420660551, "last_edit_date": 1420660551, "creation_date": 1420381520, "answer_id": 27766480, "question_id": 27765127, "link": "https://stackoverflow.com/questions/27765127/haskell-huffman-decoding-without-tree/27766480#27766480", "title": "Haskell - Huffman Decoding without tree", "body": "<p>Try parsing all codes successively, then repeat after a successful match. Repeat until there's no more input.</p>\n\n<pre><code>import Control.Monad\n\ndata Bit = Zero | One deriving (Show, Eq)\ntype HCodeMap = [(Char, [Bit])]\n\ndecode :: [Bit] -&gt; HCodeMap -&gt; Maybe String\ndecode bits codes = process bits where\n\n  -- if the code matches the input, return the corresponding \n  -- Char value along with the rest of of the input\n  match :: (Char, [Bit]) -&gt; [Bit] -&gt; Maybe (Char, [Bit])\n  match (v, xs) ys = go xs ys where\n    go (x:xs) (y:ys) | x == y = go xs ys\n    go []     ys              = Just (v, ys)\n    go _      _               = Nothing\n\n  -- match and consume until there's no more input, or fail if there is no match.\n  -- note that msum takes the first Just from a list of Maybe-s, \n  -- or returns Nothing if there isn't any\n  process :: [Bit] -&gt; Maybe String\n  process [] = Just []\n  process xs = do\n    (v, xs) &lt;- msum $ map (`match` xs) codes\n    (v:) `fmap` process xs\n</code></pre>\n\n<p>For those who are unfamiliar with <code>msum</code>, here's its implementation specialized to <code>Maybe</code>:</p>\n\n<pre><code>msum :: [Maybe a] -&gt; Maybe a\nmsum (Just a:xs)  = Just a\nmsum (Nothing:xs) = msum xs\nmsum []           = Nothing\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4417095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7beb98d94a065e114fa7a450aabea0b8?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin89", "link": "https://stackoverflow.com/users/4417095/gavin89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1814, "favorite_count": 2, "accepted_answer_id": 27766480, "answer_count": 1, "score": 1, "last_activity_date": 1420660551, "creation_date": 1420371727, "question_id": 27765127, "link": "https://stackoverflow.com/questions/27765127/haskell-huffman-decoding-without-tree", "title": "Haskell - Huffman Decoding without tree", "body": "<p>So for an assignment I have been given, I had three functions to complete, those being to extract an HCodeMap from each leaf node of a given tree, to encode a string into a list of Bits, and to decode that string of bits back into a string.</p>\n\n<p>I have successfully completed the code extraction and encoding functions, but I am struggling to make progress with the last decoding function as we are not allowed to traverse a tree as we are not given one to use.</p>\n\n<p>This is the format of the function, followed by some of the types we are supplied with:</p>\n\n<pre><code>decode :: [Bit] -&gt; HCodeMap -&gt; Maybe String \n\ndata Bit = Zero | One deriving (Show, Eq)\ntype HCodeMap = [(Char, [Bit])]\n</code></pre>\n\n<p>I initially tried creating my own lookup function, which would swap the values of the HCodeMap, and then to lookup the first n bits from the list of Bits we are given.</p>\n\n<p>I will use an example to demonstrate if I have not made myself very clear:</p>\n\n<p><strong>[Bit] we are given : [One,Zero,One,One,Zero]</strong></p>\n\n<p><strong>HCodeMap we are given: [('c',[Zero]),('a',[One,Zero]),('b',[One,One])]</strong></p>\n\n<p>I planned to take the first bit we are given from the list, being One, and then to search through HCodeMap testing to see if that was equal to any of the [Bit]s there.</p>\n\n<p>This is where my reverse lookup function would come in, as I could lookup the list of bits within the HCodeMap, as I cannot lookup by letter. It was along the lines of:</p>\n\n<p><strong>lookup (bits we are given here) (each tuple of HCodeMap) $ map swap code</strong></p>\n\n<p>In this case, we see that One does not match any of the HCodeMap tuples, so I then test One,Zero. This matches with 'a', so I add 'a' to a string, and then carry on with the next [Bit] we are passed, being One again.</p>\n\n<p>etc etc this goes on and we are left with the string \"abc\".</p>\n\n<p>I am really struggling with how to actually put this into a function however.</p>\n\n<p>I hope I have not made this too confusing, thanks for any help in advance!</p>\n"}, {"tags": ["haskell", "tree", "foldable"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1420416113, "post_id": 27764685, "comment_id": 43954464, "body": "Actually with the <code>Traversable</code> class and some helper functions you can do this task generically using only standard library functions."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1420435268, "post_id": 27764685, "comment_id": 43958392, "body": "I knew about <code>Traversable</code>, but it doesn&#39;t seem to have a function that does this specific task."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420469719, "post_id": 27764685, "comment_id": 43973900, "body": "the Functor instance isn&#39;t shown and if it does what it&#39;s supposed to do, this would mean repeated re-entering and rescanning of whole subtrees (quadratic behaviour)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420470487, "post_id": 27764685, "comment_id": 43974370, "body": "My mistake, I misunderstood the goal."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420538628, "post_id": 27764685, "comment_id": 44001154, "body": "@WillNess This code doesn&#39;t re-enter or re-scan whole subtrees, but it does apply more iterations of <code>f</code> to deeper nodes in the tree as is specified in the OP. You can check the actual behavior with the <code>:step</code> and <code>:list</code> commands in ghci"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420539226, "post_id": 27764685, "comment_id": 44001503, "body": "@JeremyList doesn&#39;t <code>fmap</code> (which isn&#39;t shown...) has to do the rescanning (i.e. repeated traversal) of the result trees (of calling <code>scan f</code> on each subtree), to produce the results as shown in the Q? check out the two ideone entries from the other answer here, which clearly show a quadratic behaviour for your code. Each node is first recreated with the same value, then is modified by <code>fmap (f r)</code> from the node immediately above it, then by <code>fmap (f r)</code> from the node above <i>that</i>, etc. Quadratic."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420539715, "post_id": 27764685, "comment_id": 44001744, "body": "(contd.) for <code>f = (+)</code> this means, the chain of functions is applied on each node, e.g. <code>(+1) . (+20) . (+300) $ 400</code> for the leftmost bottom node. I don&#39;t expect the conversion is performed by compiler into <code>(+321) $ 400</code>. Which would make it linear, and <i>would</i> be extremely nice, if it were, performed. (I can remove my downvote if you&#39;d add a note explaining this - or I could do that myself, with your permission...)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420540097, "post_id": 27764685, "comment_id": 44001917, "body": "(replace &quot;quadratic behaviour&quot; with &quot;dramatic slowdown&quot; in the comment above last. to see whether it&#39;s quadratic, at least two size points need be measured.)"}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420540357, "post_id": 27764685, "comment_id": 44002050, "body": "@WillNess Not exactly. A single application of fmap would scan the whole subtree if the whole result is evaluated, but because of lazy evaluation you can use fmap in a nested way and still only traverse each node once. The repeated applications of <code>f</code> at each node are part of the OP&#39;s problem definition."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420541182, "post_id": 27764685, "comment_id": 44002496, "body": "@willNess You haven&#39;t explained your reasoning clearly enough for me to know exactly where you went wrong, but the <code>:step</code> and <code>:list</code> commands in ghci clearly show that you went wrong somewhere."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 3, "last_activity_date": 1420558566, "last_edit_date": 1420558566, "creation_date": 1420368185, "answer_id": 27764685, "question_id": 27763400, "link": "https://stackoverflow.com/questions/27763400/on-haskell-there-a-standard-function-that-performs-scan-on-a-tree/27764685#27764685", "title": "On Haskell, there a standard function that performs &quot;scan&quot; on a tree?", "body": "<p>There is no standard library function that does this. In the case of lists: Haskell has just about any function you can think of already in <code>Data.List</code>, but <code>Data.Tree</code> is actually pretty sparse.</p>\n\n<p>Fortunately the function you want is quite simple.</p>\n\n<pre><code>scan f ~(Node r l) = Node r $ map (fmap (f r) . scan f) l\n</code></pre>\n\n<p>--edit--</p>\n\n<p>The above function has a problem: in the example given by the OP it calculates the \"721\" as \"1 + (20 + (400 + 300))\", which prevents the \"1 + 20\" calculation from being re-used in the other branches.</p>\n\n<p>The below function doesn't have this problem, but I'm leaving the original one in place because it can still be useful depending on what function is passed as the first argument.</p>\n\n<pre><code>scan f ~(Node r l) = Node r $ map (scan' r) l where\n  scan' a ~(Node n b) = let a' = f a n in Node a' $ map (scan' r) b \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420471437, "post_id": 27768819, "comment_id": 43974880, "body": "@Will Ness, the <code>Tree</code> datatype has only one constructor, so I put it automatically. But yes, <code>map</code> anyway forces <code>ns</code>. Fixed, thanks. <a href=\"http://ideone.com/C6SnCA\" rel=\"nofollow noreferrer\">Also</a>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1420471790, "post_id": 27768819, "comment_id": 43975106, "body": "Hm, but it doesn&#39;t force <code>x</code>, hence <code>treeHead $ scan const &quot;pointless&quot; undefined</code> returns <code>&quot;pointless&quot;</code>. Which indeed is pointless."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1420531843, "post_id": 27768819, "comment_id": 43998066, "body": "you meant, <i>with the lazy pattern</i> it returns &quot;pointless&quot;. (just to clarify)"}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 2, "last_activity_date": 1420471302, "last_edit_date": 1420471302, "creation_date": 1420395737, "answer_id": 27768819, "question_id": 27763400, "link": "https://stackoverflow.com/questions/27763400/on-haskell-there-a-standard-function-that-performs-scan-on-a-tree/27768819#27768819", "title": "On Haskell, there a standard function that performs &quot;scan&quot; on a tree?", "body": "<p>If you want to pass an accumulator, then the definition is</p>\n\n<pre><code>scan f a (Node x ns) = Node a' $ map (scan f a') ns where a' = f a x\n</code></pre>\n\n<p>This version is also quite more efficient, compare <a href=\"http://ideone.com/wSES9K\" rel=\"nofollow\">this</a> and <a href=\"http://ideone.com/4KqkwQ\" rel=\"nofollow\">this</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1420421200, "post_id": 27771726, "comment_id": 43955484, "body": "This type, and appropriate instances, are defined in <code>Data.Tree</code> in the <code>containers</code> package, which ships with GHC."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420422063, "post_id": 27771726, "comment_id": 43955661, "body": "Yep, but if he is using a custom declaration then it&#39;s beneficial for him to know how to derive the instances.  The question omitted that part."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1420463718, "post_id": 27771726, "comment_id": 43970463, "body": "I believe this doesn&#39;t solve the question. The OP asked for accumulating paths from the root to each node, not for accumulating the whole traversal. Compare your result with the result he is asking for."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1420469616, "post_id": 27771726, "comment_id": 43973831, "body": "Exactly... the result is different from what I asked. I&#39;ve learned something from that answer, though, so I&#39;m thankful you posted it."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420470423, "post_id": 27771726, "comment_id": 43974327, "body": "Ah, I see. I didn&#39;t catch this."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1420540479, "last_edit_date": 1420540479, "creation_date": 1420416053, "answer_id": 27771726, "question_id": 27763400, "link": "https://stackoverflow.com/questions/27763400/on-haskell-there-a-standard-function-that-performs-scan-on-a-tree/27771726#27771726", "title": "On Haskell, there a standard function that performs &quot;scan&quot; on a tree?", "body": "<p><em>update: this produces different results than requested; but it shows a valuable general approach that can be helpful where applicable, and is helpful here as well, as a counterpoint.</em></p>\n\n<p>It is entirely possible to do this sort of traversal generically using <code>base</code> and GHC.  The class you are looking for is <code>Traversable</code> and the <code>mapAccum{R,L}</code> functions along with <code>fst</code> or <code>snd</code>:</p>\n\n<p>Lets avoid writing our own instances:</p>\n\n<pre><code>{-# LANGUAGE DeriveTraversable #-}\n{-# LANGUAGE DeriveFoldable #-}\n{-# LANGUAGE DeriveFunctor #-}\n</code></pre>\n\n<p>Now we can derive the necessary parts:</p>\n\n<pre><code>import Data.Traversable\nimport Data.Foldable\n\ndata Tree a = Node a [Tree a]\n            deriving (Functor, Traversable, Foldable, Show)\n</code></pre>\n\n<p>Then the use is quite easy.  If you don't want the final accumulator then just use <code>snd</code>.</p>\n\n<pre><code>main :: IO ()\nmain = print $ mapAccumL (\\acc e -&gt; (acc+e,acc+e)) 0 demo\n\ndemo :: Tree Int\ndemo =\n   Node 1 [Node 20.\n            [Node 300 [Node 400 []\n                      , Node 500 []]\n            , Node 310 []\n            ]\n          , Node 30 [], Node 40 []\n          ]\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1420558566, "creation_date": 1420356393, "question_id": 27763400, "link": "https://stackoverflow.com/questions/27763400/on-haskell-there-a-standard-function-that-performs-scan-on-a-tree", "title": "On Haskell, there a standard function that performs &quot;scan&quot; on a tree?", "body": "<p>I have a tree:</p>\n\n<pre><code>a :: Tree Double\na = \n    Node 1 \n       [Node 20 \n           [Node 300 \n               [Node 400 [], \n               Node 500 []], \n           Node 310 []], \n       Node 30 [], \n       Node 40 []]\n</code></pre>\n\n<p>I want to apply it an <code>scan</code> operation similar to lists - except that, instead of returning a list, it should return a tree with the travelled paths. For example:</p>\n\n<pre><code>scan (+) 0 a\n</code></pre>\n\n<p>Should reduce to:</p>\n\n<pre><code>Node 1 \n    [Node 21 \n        [Node 321 \n            [Node 721 [], \n            Node 821 []], \n        Node 331 []], \n    Node 31 [], \n    Node 41 []]\n</code></pre>\n\n<p>Which is accumulated the sums through the tree. Is there a standard function for this?</p>\n"}, {"tags": ["macos", "haskell", "gcc", "ghc"], "comments": [{"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "edited": false, "score": 0, "creation_date": 1420372479, "post_id": 27762615, "comment_id": 43941046, "body": "could be an error in the way they typed the kernel version..."}, {"owner": {"reputation": 25560, "user_id": 2068642, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DYTnZ.jpg?s=128&g=1", "display_name": "TheDarkKnight", "link": "https://stackoverflow.com/users/2068642/thedarkknight"}, "edited": false, "score": 0, "creation_date": 1420554373, "post_id": 27762615, "comment_id": 44009931, "body": "Have you installed the developer command line tools for Yosemite (10.10)?"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420348292, "creation_date": 1420348292, "question_id": 27762615, "link": "https://stackoverflow.com/questions/27762615/gcc-error-message-after-installing-osx-yosemite-on-macbook-pro", "title": "GCC error message after installing OSX Yosemite on Macbook Pro", "body": "<p>Since I updated my Macbook to OSX Yosemite, I've getting the following warning from gcc:</p>\n\n<pre><code>gcc: warning: couldn\u2019t understand kern.osversion \u201814.0.0\n</code></pre>\n\n<p>This shows anytime I use GHC to compile a Haskell program. The compiling process doesn't fail. I've already installed <code>xcode-select</code>. How can I get rid of that message?</p>\n"}, {"tags": ["haskell", "lenses"], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 3859566, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7c4c1c9ad9bd41f49004d32884bc680?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/3859566/yong"}, "edited": false, "score": 0, "creation_date": 1420351113, "post_id": 27762811, "comment_id": 43936711, "body": "Thanks, it looks like I was looking at the old version of the documentation."}], "tags": [], "owner": {"reputation": 8690, "user_id": 712548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f468e49dc69e4f281faf3e9516adcf5?s=128&d=identicon&r=PG", "display_name": "shachaf", "link": "https://stackoverflow.com/users/712548/shachaf"}, "is_accepted": true, "score": 6, "last_activity_date": 1420350517, "creation_date": 1420350517, "answer_id": 27762811, "question_id": 27762519, "link": "https://stackoverflow.com/questions/27762519/how-to-use-the-of-lenses-haskell/27762811#27762811", "title": "How to use the &quot;Of&quot; lenses? (Haskell)", "body": "<p>The <a href=\"http://hackage.haskell.org/package/lens-4.7/docs/Control-Lens-Fold.html#v:minimumOf\">documentation</a> seems reasonably clear on the usage -- how would you improve it?</p>\n\n<p><code>minimumOf</code> isn't a lens (or traversal or anything) -- it takes a fold (or traversal or lens or something -- but it's not useful to use it with a lens, because you're taking the minimum of exactly one thing) and looks for the minimum value that it focuses on in a structure. E.g.</p>\n\n<pre><code>\u03bb&gt; minimumOf (traverse . _1) [(1,'a'),(2,'b')]\nJust 1\n</code></pre>\n\n<p>It generalizes the Prelude function <code>minimum</code> -- which always takes a list -- to a function which takes any sort of value, along with instructions for getting a bunch of things out of that value, and computes the minimum of those things.</p>\n"}], "owner": {"reputation": 3333, "user_id": 3859566, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7c4c1c9ad9bd41f49004d32884bc680?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/3859566/yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 27762811, "answer_count": 1, "score": 4, "last_activity_date": 1420350517, "creation_date": 1420347247, "last_edit_date": 1420347745, "question_id": 27762519, "link": "https://stackoverflow.com/questions/27762519/how-to-use-the-of-lenses-haskell", "title": "How to use the &quot;Of&quot; lenses? (Haskell)", "body": "<p>I want to write:</p>\n\n<pre><code>minimum $ map _x elems\n</code></pre>\n\n<p>using lenses. I want to use the <code>minimumOf</code> lens, but I can't figure out how to use it from its type.</p>\n\n<p>I'm looking for something like </p>\n\n<pre><code>elems ^.. minimumOf x\n</code></pre>\n\n<p>but it does not type check:</p>\n\n<pre><code>Prelude Control.Lens Data.Map&gt; let elems = [(1,2),(3,4)] :: [(Double, Double)]\nPrelude Control.Lens Data.Map&gt; elems ^.. minimumOf _1\n\n&lt;interactive&gt;:62:11:\n    Couldn't match type \u2018Maybe a0\u2019\n                  with \u2018[(Double, Double)]\n                        -&gt; Const (Data.Monoid.Endo [a]) [(Double, Double)]\u2019\n    Expected type: Getting (Data.Monoid.Endo [a]) [(Double, Double)] a\n      Actual type: (a -&gt; Const (Data.Monoid.Endo [a]) a) -&gt; Maybe a0\n    Relevant bindings include it :: [a] (bound at &lt;interactive&gt;:62:1)\n    Possible cause: \u2018minimumOf\u2019 is applied to too many arguments\n    In the second argument of \u2018(^..)\u2019, namely \u2018minimumOf _1\u2019\n    In the expression: elems ^.. minimumOf _1\n</code></pre>\n"}, {"tags": ["haskell", "identity", "equality"], "comments": [{"owner": {"reputation": 7380, "user_id": 1189745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8595855d0f63aa1c19c79e74aff16d1?s=128&d=identicon&r=PG", "display_name": "Kristopher Micinski", "link": "https://stackoverflow.com/users/1189745/kristopher-micinski"}, "edited": false, "score": 0, "creation_date": 1420346662, "post_id": 27762441, "comment_id": 43936016, "body": "Programming with this referential style is a little awkward to do in Haskell.  It&#39;s best to use a functional data structure instead of a stateful one for most purposes.  If you really want to, you could always use something like the ST monad."}, {"owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "edited": false, "score": 0, "creation_date": 1420346771, "post_id": 27762441, "comment_id": 43936036, "body": "I guess you can tag every node with an unique value to make them distinguishable"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420346964, "post_id": 27762441, "comment_id": 43936066, "body": "There are no objects in Haskell. It works with values, not objects. Objects have <i>identity</i> (I guess that&#39;s the word you&#39;re looking for), values only have equality."}], "answers": [{"comments": [{"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420348026, "post_id": 27762567, "comment_id": 43936230, "body": "I was just picturing an interview type scenario where they say &quot;Implement a linked list with insert at front, insert after node X&quot;, etc, and was unsure of how to handle that type of request if I did it in Haskell."}, {"owner": {"reputation": 7380, "user_id": 1189745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8595855d0f63aa1c19c79e74aff16d1?s=128&d=identicon&r=PG", "display_name": "Kristopher Micinski", "link": "https://stackoverflow.com/users/1189745/kristopher-micinski"}, "reply_to_user": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 3, "creation_date": 1420348418, "post_id": 27762567, "comment_id": 43936296, "body": "@user2666425 sounds like if they asked you to do that in Haskell you&#39;d have a good tip not to work at that place."}, {"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "reply_to_user": {"reputation": 7380, "user_id": 1189745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8595855d0f63aa1c19c79e74aff16d1?s=128&d=identicon&r=PG", "display_name": "Kristopher Micinski", "link": "https://stackoverflow.com/users/1189745/kristopher-micinski"}, "edited": false, "score": 0, "creation_date": 1420348600, "post_id": 27762567, "comment_id": 43936322, "body": "@KristopherMicinski I more meant, they say &quot;implement a linked list that does x, y, and z&quot; and one of those being an &#39;insert After&#39; method. I pick Haskell, begin working, and then panic. :) But what should I say in that situation? What is the property of Haskell/FP that makes this request &#39;awkward&#39;?"}, {"owner": {"reputation": 7380, "user_id": 1189745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8595855d0f63aa1c19c79e74aff16d1?s=128&d=identicon&r=PG", "display_name": "Kristopher Micinski", "link": "https://stackoverflow.com/users/1189745/kristopher-micinski"}, "reply_to_user": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 2, "creation_date": 1420351053, "post_id": 27762567, "comment_id": 43936705, "body": "@user2666425 the fact that references don&#39;t exist.  A linked list is a data structure that fundamentally depends on pointers, which don&#39;t exist in functional languages."}, {"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "reply_to_user": {"reputation": 7380, "user_id": 1189745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8595855d0f63aa1c19c79e74aff16d1?s=128&d=identicon&r=PG", "display_name": "Kristopher Micinski", "link": "https://stackoverflow.com/users/1189745/kristopher-micinski"}, "edited": false, "score": 0, "creation_date": 1420351320, "post_id": 27762567, "comment_id": 43936737, "body": "@KristopherMicinski I&#39;m confused what a more &#39;functional data structure&#39; is, then- aren&#39;t lists in Haskell actually <a href=\"http://stackoverflow.com/a/2689376/2666425\">singly linked lists</a> too?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420351488, "post_id": 27762567, "comment_id": 43936763, "body": "I imagine this is not a typical interview question for a Haskell job (never was at one though)."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 7, "last_activity_date": 1420347680, "creation_date": 1420347680, "answer_id": 27762567, "question_id": 27762441, "link": "https://stackoverflow.com/questions/27762441/is-there-a-sense-of-object-equality-in-haskell/27762567#27762567", "title": "Is there a sense of &#39;object equality&#39; in Haskell?", "body": "<p>No, there is no such thing. The only way to tell apart values is by their structure; there is no <em>identity</em> like objects in some languages have. That is, there's no way you could tell apart these two values: <code>(Just 5, Just 5)</code> behaves exactly the same as <code>let x = Just 5 in (x, x)</code>. Likewise, there is no difference between \"this <code>Node 1</code>\" and \"some other <code>Node 1</code>\": they are indistinguishable.</p>\n\n<p>Usually the \"solution\" to this problem is to think of your problem in some other way so that there's no longer a need to distinguish based on identity (and usually there in fact is no need). But, as mentioned in the comments, you can emulate the \"pointer\" mechanic of other languages yourself, by generating distinct tags of some sort, eg increasing integers, and assigning one to each object so that you can tell them apart.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1446315951, "post_id": 27762950, "comment_id": 54696684, "body": "Couldn&#39;t <code>genId &gt;&gt;= return . (x,)</code> just be <code>(x,) &lt;$&gt; genId</code>?"}], "tags": [], "owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "is_accepted": false, "score": 2, "last_activity_date": 1420351980, "creation_date": 1420351980, "answer_id": 27762950, "question_id": 27762441, "link": "https://stackoverflow.com/questions/27762441/is-there-a-sense-of-object-equality-in-haskell/27762950#27762950", "title": "Is there a sense of &#39;object equality&#39; in Haskell?", "body": "<p>As others have pointed, in Haskell every value is immutable and there is no object.\nTo specify an unique node, you either need to specify it structually (the first node in the linked list that contains <code>1</code>, for example) or give every node an extra tag somehow (simulating what happens in an imperative world) so that we can distinguish them.</p>\n\n<p>To structurally distinguish a node from others, we basically need to know the location of\nthat node, e.g. a <a href=\"http://en.wikipedia.org/wiki/Zipper_%28data_structure%29\" rel=\"nofollow\">zipper</a> that not only gives you the value at the point, but also its \"neighborhoods\".</p>\n\n<p>And more detailed about \"giving every node an extra tag\":</p>\n\n<p>First of all, you need to make every value an object, that requires you to generate unique tags at runtime. This is usually done by an allocator, the simplest allocator might just keep an integer, bump it when we need to create a new object:</p>\n\n<pre><code>-- | bumps counter\ngenId :: (Monad m, Functor m, Enum e) =&gt; StateT e m e\ngenId = get &lt;* modify succ\n\n-- | given a value, initializes a new node value\nnewNode :: (Monad m, Functor m, Enum e) =&gt; a -&gt; StateT e m (a,e)\nnewNode x = genId &gt;&gt;= return . (x,)\n</code></pre>\n\n<p>And if you want to make an existing linked list work, we need to walk through it and give every node value a tag to make it an object:</p>\n\n<pre><code>-- | tags the llnked list with an extra value\ntagged :: (Traversable f, Enum e, Monad m, Functor m)\n       =&gt; f a -&gt; StateT e m (f (a,e))\ntagged = traverse newNode\n</code></pre>\n\n<p>And here is the full demo, it does look <code>Maybe \"a little\"</code> awkward:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, DeriveFoldable, DeriveTraversable, TupleSections #-}\nimport Control.Applicative\nimport Control.Monad.State hiding (mapM_)\nimport Data.Traversable\nimport Data.Foldable\nimport Prelude hiding (mapM_)\n\ndata LL a = Empty | Node a (LL a)\n    deriving (Show, Eq, Functor, Foldable, Traversable)\n\n-- | bumps counter\ngenId :: (Monad m, Functor m, Enum e) =&gt; StateT e m e\ngenId = get &lt;* modify succ\n\n-- | given a value, initializes a new node value\nnewNode :: (Monad m, Functor m, Enum e) =&gt; a -&gt; StateT e m (a,e)\nnewNode x = genId &gt;&gt;= return . (x,)\n\nexample :: LL Int\nexample = Node 1 (Node 2 (Node 3 (Node 1 Empty)))\n\n-- | tags the llnked list with an extra value\ntagged :: (Traversable f, Enum e, Monad m, Functor m)\n       =&gt; f a -&gt; StateT e m (f (a,e))\ntagged = traverse newNode\n\ninsertAfter :: (a -&gt; Bool) -&gt; a -&gt; LL a -&gt; LL a\ninsertAfter cond e ll = case ll of\n    Empty -&gt; Empty\n    Node v vs -&gt; Node v (if cond v\n                           then Node e vs\n                           else insertAfter cond e vs)\n\ndemo :: StateT Int IO ()\ndemo = do\n    -- ll1 = Node (1,0) (Node (2,1) (Node (3,2) (Node (1,3) Empty)))\n    ll1 &lt;- tagged example\n    nd &lt;- newNode 10\n    let tagIs t = (== t) . snd\n        ll2 = insertAfter (tagIs 0) nd ll1\n        -- ll2 = Node (1,0) (Node (10,4) (Node (2,1) (Node (3,2) (Node (1,3) Empty))))\n        ll3 = insertAfter (tagIs 3) nd ll1\n        -- ll3 = Node (1,0) (Node (2,1) (Node (3,2) (Node (1,3) (Node (10,4) Empty))))\n    liftIO $ mapM_ print [ll1,ll2,ll3]\n\nmain :: IO ()\nmain = evalStateT demo (0 :: Int)\n</code></pre>\n\n<p>In this demo, <code>tagIs</code> is essentially doing the \"object equality\" thing because it is only interested in the extra tag we added before. Notice here I cheated in order to specify two nodes with their \"values\" being <code>1</code>: one tagged <code>0</code> and the other tagged <code>3</code>. Before running the program, it's impossible to tell what the actually tag would be. (Just like hard-coding a pointer value and hope it happens to work) In a more realistic setting, you would need another function to scan through the linked list and collect you a list of tags with a certain value (in this example, if you search the linked list to find all the nodes with \"value\" <code>1</code>, you would have <code>[0,3]</code>) to work with.</p>\n\n<p>\"object equality\" seems more like a concept from imperative programming languages, which assumes that there are allocators to offer \"references\" or \"pointers\" so that we can talk about \"object equality\". We have to simulate that allocator, I guess this is the thing that makes functional programming a little awkward to deal with it.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1420355776, "last_edit_date": 1495541843, "creation_date": 1420355776, "answer_id": 27763346, "question_id": 27762441, "link": "https://stackoverflow.com/questions/27762441/is-there-a-sense-of-object-equality-in-haskell/27763346#27763346", "title": "Is there a sense of &#39;object equality&#39; in Haskell?", "body": "<p>Kristopher Micinski <a href=\"https://stackoverflow.com/questions/27762441/is-there-a-sense-of-object-equality-in-haskell#comment43936016_27762441\">remarked</a> that you actually can do something similar with the <code>ST</code> monad, and you can do it with <code>IO</code> as well. Specifically, you can create an <code>STRef</code> or <code>IORef</code>, which is a sort of mutable box. The box can only be accessed using <code>IO</code> or <code>ST</code> actions as appropriate, which maintains the clean separation between \"pure\" and \"impure\" code. These references have identity\u2014asking if two are equal tells you if they are actually the same box, rather than whether they have the same contents. But this is not really so pleasant, and not something you're likely to do without a good reason.</p>\n"}, {"tags": [], "owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "is_accepted": false, "score": 1, "last_activity_date": 1420434993, "creation_date": 1420434993, "answer_id": 27773792, "question_id": 27762441, "link": "https://stackoverflow.com/questions/27762441/is-there-a-sense-of-object-equality-in-haskell/27773792#27773792", "title": "Is there a sense of &#39;object equality&#39; in Haskell?", "body": "<p>No, because it would break <em>referential transparency</em>. The results from calling a method with the same input multiple times should be indistinguishable, and it should be possible to replace it transparently with calling the method with that input once and then re-using the result. However, calling a method that returns some structure multiple times may produce a new copy of the structure every time -- structures with different \"identity\". If you could somehow tell that they have different identities, then it violates referential transparency.</p>\n"}], "owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1420434993, "creation_date": 1420346384, "last_edit_date": 1420347345, "question_id": 27762441, "link": "https://stackoverflow.com/questions/27762441/is-there-a-sense-of-object-equality-in-haskell", "title": "Is there a sense of &#39;object equality&#39; in Haskell?", "body": "<p>If I have a singly linked list in Haskell:</p>\n\n<pre><code>data LL a = Empty | Node a (LL a) deriving (Show, Eq)\n</code></pre>\n\n<p>I can easily implement methods to insert at the end and at the beginning. But what about inserting after or before a particular element? If I have a <code>LL</code> of <code>Integer</code>, can I make a distinction in Haskell between inserting <code>4</code> after a particular node containing a <code>1</code>, rather than the first <code>1</code> that it sees when processing the list?</p>\n\n<pre><code>Node 1 (Node 2 (Node 3 (Node 1 Empty)))\n</code></pre>\n\n<p>I'm curious how an <code>insertAfter</code> method would look that you would be able to specify \"insert 5 after this particular node containing a 1\". If I wanted to insert after the first node containing <code>1</code>, would I have to pass in the entire list to specify this, and for the last node, only <code>Node 1 Empty</code>?</p>\n\n<p>I'm not sure if it's right to address this as 'object equality'- but I'm wondering if there's a way to refer to particular elements of a type with the same payload in a data structure like this.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3407, "user_id": 194229, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6779b488f95ec26d77ab8380acdb4df4?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/194229/ian"}, "edited": false, "score": 4, "creation_date": 1420340664, "post_id": 27761896, "comment_id": 43935099, "body": "Thank you, this was the tip off I needed to understand. The other bit that I was missing is that &lt;- is not just an assignment, it strips the Monad and returns the underlying type, so x &lt;- y then foo x is not equivalent to foo y. I appreciate the comprehensive answer, Rein."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 11, "last_activity_date": 1420348303, "last_edit_date": 1420348303, "creation_date": 1420339991, "answer_id": 27761896, "question_id": 27761821, "link": "https://stackoverflow.com/questions/27761821/haskell-expression-equivalents/27761896#27761896", "title": "Haskell Expression Equivalents", "body": "<h1>Do Notation Desugaring</h1>\n\n<p>The <a href=\"http://en.wikibooks.org/wiki/Haskell/do_Notation#Translating_the_bind_operator\">rules for do notation desugaring</a> imply that</p>\n\n<pre><code>do x &lt;- try parseA &lt;|&gt; parseB\n   return x\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>(try parseA &lt;|&gt; parse B) &gt;&gt;= return\n</code></pre>\n\n<h1><code>($)</code> versus <code>(&gt;&gt;=)</code></h1>\n\n<p>Since <code>(=&lt;&lt;)</code> is a flipped version of <code>(&gt;&gt;=)</code>,  both are equivalent to</p>\n\n<pre><code>return =&lt;&lt; (try parseA &lt;|&gt; parse B)\n</code></pre>\n\n<p>This implies that the only difference between your correct version and <code>return $ try parseA &lt;|&gt; parse B</code> is the difference between <code>(=&lt;&lt;)</code> and <code>($)</code>, whose types are:</p>\n\n<pre><code>($)   :: (a -&gt; b)   -&gt; a   -&gt; b\n(=&lt;&lt;) :: (a -&gt; m b) -&gt; m a -&gt; m b\n</code></pre>\n\n<p>You can see that <code>($)</code> is not a replacement for <code>(=&lt;&lt;)</code>, but perhaps you can also see that they are somewhat similar. One way to look at it is that <code>(=&lt;&lt;)</code> &ndash; and thus also <code>(&gt;&gt;=)</code> &ndash; is a kind of function application that applies \"monadic functions\" of type <code>a -&gt; m b</code> for some Monad <code>m</code> to \"monadic values\" of type <code>m a</code> for some Monad <code>m</code>, whereas <code>($)</code> is the usual kind of function application that applies functions of type <code>a -&gt; b</code> to values of type <code>a</code>.</p>\n\n<h1>Monad Laws</h1>\n\n<p>One of the <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Prelude.html#t:Monad\">monad laws</a> is that</p>\n\n<pre><code>k &gt;&gt;= return = k\n</code></pre>\n\n<p>This implies that</p>\n\n<pre><code>(try parseA &lt;|&gt; parse B) &gt;&gt;= return\n</code></pre>\n\n<p>can also be written as</p>\n\n<pre><code>try parseA &lt;|&gt; parse B\n</code></pre>\n\n<p>which means your original form using do notation can also be written that way.</p>\n"}], "owner": {"reputation": 3407, "user_id": 194229, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6779b488f95ec26d77ab8380acdb4df4?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/194229/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 1, "accepted_answer_id": 27761896, "answer_count": 1, "score": 8, "last_activity_date": 1420392448, "creation_date": 1420339162, "last_edit_date": 1420392448, "question_id": 27761821, "link": "https://stackoverflow.com/questions/27761821/haskell-expression-equivalents", "title": "Haskell Expression Equivalents", "body": "<p>I'm a very new Haskell learner. I have a working expression:</p>\n\n<pre><code>do x &lt;- try parseA &lt;|&gt; parseB\n   return x\n</code></pre>\n\n<p>which appears to work perfectly (I'm using the <code>Parsec</code> package, but I hope this question has nothing to do with its functionality, as far as I know <code>&lt;|&gt;</code> is a Parsec-defined infix operator). <code>parseA</code> and <code>parseB</code> both have the <code>Parser Foo</code> monad type, as does the whole expression.</p>\n\n<p>Based on what I've read so far, it seems this should be equivalent to</p>\n\n<pre><code>do return (try parseA &lt;|&gt; parseB)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>do return $ try parseA &lt;|&gt; parseB\n</code></pre>\n\n<p>but none of the latter compile, they complain of mismatched types (errors below).</p>\n\n<p>My other attempt to rewrite this, as</p>\n\n<pre><code>(try parseA &lt;|&gt; parse B) &gt;&gt;= return\n</code></pre>\n\n<p>seems to work. But if I've misunderstood this too, please say.</p>\n\n<p>So my question is, can someone explain why the first three are different. I'm confused why they aren't equivalent. What am I missing?</p>\n\n<hr>\n\n<p>Errors (in case this is relevant, though fwiw I'm not looking to 'fix' my code - I have a working version, I'm looking to understand how the versions differ):</p>\n\n<pre><code>do return (try parseA &lt;|&gt; parseB)\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>parse.hs:76:11:\n    Couldn't match expected type \u2018Foo\u2019\n                with actual type \u2018Text.Parsec.Prim.ParsecT\n                                    [Char] () Data.Functor.Identity.Identity Foo\u2019\n</code></pre>\n\n<p>and</p>\n\n<pre><code>do return $ try parseA &lt;|&gt; parseB\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>parse.hs:76:3:\n    Couldn't match type \u2018Text.Parsec.Prim.ParsecT\n                           [Char] () Data.Functor.Identity.Identity Foo\u2019\n                  with \u2018Foo\u2019\n    Expected type: Parser Foo\n      Actual type: Text.Parsec.Prim.ParsecT\n                     String\n                     ()\n                     Data.Functor.Identity.Identity\n                     (Text.Parsec.Prim.ParsecT\n                        [Char] () Data.Functor.Identity.Identity Foo)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 3, "creation_date": 1420293643, "post_id": 27755623, "comment_id": 43921907, "body": "Hint: the statement <code>partial_add x list count+a</code> is interpreted as <code>(partial_add x list count)+a</code> not <code>partial_add x list (count+a)</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1420293802, "post_id": 27755623, "comment_id": 43921939, "body": "Hint2: Check <code>partial_add</code>&#39;s type. Then try to add the correct type signature yourself."}, {"owner": {"reputation": 43, "user_id": 4161098, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312016236/picture?type=large", "display_name": "Panos", "link": "https://stackoverflow.com/users/4161098/panos"}, "edited": false, "score": 0, "creation_date": 1420295199, "post_id": 27755623, "comment_id": 43922348, "body": "Thank you everyone! I needed to declare the type partial_add :: [Int] -&gt; [Int] -&gt; Int -&gt; [Int] and add the parenthesis around count+a"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1420298679, "post_id": 27755623, "comment_id": 43923407, "body": "@PanosPaparrigopoulos: You can answer your own questions, so don&#39;t forget to add an answer later."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420315824, "post_id": 27755623, "comment_id": 43928992, "body": "Note also that the <code>a</code> value gets lost if <code>a `elem` list</code> holds, so you may want to adjust that case."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4161098, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312016236/picture?type=large", "display_name": "Panos", "link": "https://stackoverflow.com/users/4161098/panos"}, "edited": false, "score": 0, "creation_date": 1420372579, "post_id": 27759449, "comment_id": 43941070, "body": "Thank you @bmk it was indeed not working properly. The second code you posted is what i did to finaly."}], "tags": [], "owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "is_accepted": true, "score": 2, "last_activity_date": 1420318984, "last_edit_date": 1420318984, "creation_date": 1420318665, "answer_id": 27759449, "question_id": 27755623, "link": "https://stackoverflow.com/questions/27755623/haskell-partial-sum-of-a-list-error/27759449#27759449", "title": "Haskell partial sum of a list error", "body": "<p>Given your example, I would write the function something like this:</p>\n\n<pre><code>partialAdd :: [Int] -&gt; [Int] -&gt; [Int]\npartialAdd ls seps = foldr f [] ls\n  where \n    f a [] = [a]\n    f a (x:xs)\n      | a `elem` seps = a:x:xs\n      | otherwise = (x+a):xs\n\n*Main&gt; partialAdd [1,2,3,4,5,6] [2,5]\n[3,12,6]\n</code></pre>\n\n<p>Btw. I think the solution in your question seems not to work quite the way you specified in your example (or I misunderstood something):</p>\n\n<pre><code>partial_add :: [Int] -&gt; [Int] -&gt; Int -&gt; [Int]\npartial_add [] _ count = []\npartial_add (a:x) list count | elem a list =  count:partial_add x list 0\n                             | otherwise =  partial_add x list (count+a)\n\n*Main&gt; partial_add [1,2,3,4,5,6] [2,5] 0\n[1,7]\n</code></pre>\n\n<p>But it is easily fixed to work for your example:</p>\n\n<pre><code>partial_add :: [Int] -&gt; [Int] -&gt; Int -&gt; [Int]\npartial_add [] _ count = [count]\npartial_add (a:x) list count | elem a list =  (count+a):partial_add x list 0\n                             | otherwise =  partial_add x list (count+a)\n\n*Main&gt; partial_add [1,2,3,4,5,6] [2,5] 0\n[3,12,6]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 4161098, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312016236/picture?type=large", "display_name": "Panos", "link": "https://stackoverflow.com/users/4161098/panos"}, "edited": false, "score": 0, "creation_date": 1420372474, "post_id": 27762110, "comment_id": 43941045, "body": "passing the count as 0 is my way to reset the counter :P don&#39;t know if there is a better way but it&#39;s only my third day working on haskell and i am a bit influeced by prolog. Thank you for your answer"}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 1, "last_activity_date": 1420343139, "last_edit_date": 1420343139, "creation_date": 1420342611, "answer_id": 27762110, "question_id": 27755623, "link": "https://stackoverflow.com/questions/27755623/haskell-partial-sum-of-a-list-error/27762110#27762110", "title": "Haskell partial sum of a list error", "body": "<p><em>Note: I am a bit confused by the <code>count</code> parameter since it is ignored in one of the recursive calls, where it is always passed as <code>0</code>. It should be easy to add its behavior once it's more clear what it does.</em></p>\n\n<p>Another way to look at this is to first separate the second list* into sublists <em>delimited by</em> (and including) the elements of the first list and then to find the sums of each sublist:</p>\n\n<pre><code>-- | A version of Data.List.splitOneOf that includes the delimiter\nsplitOneOf' :: Eq a =&gt; [a] -&gt; [a] -&gt; [[a]]\nsplitOneOf' _ [] = [[]]\nsplitOneOf' delims (x:xs) | x `elem` delims = [x] : splitOneOf' delims xs\nsplitOneOf' delims (x:xs) | otherwise = let (ys:yss) = splitOneOf' delims xs\n                                        in (x:ys) : yss\n\npartialAdd :: (Eq a, Num a) =&gt; [a] -&gt; [a] -&gt; [a]\npartialAdd delims = map sum . splitOneOf' delims\n\nmain :: IO ()\nmain = print $ partialAdd [2,5] [1,2,3,4,5,6]\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>[3,12,6]\n</code></pre>\n\n<p>I think this is a nice example of \"bottom up\" programming in Haskell.</p>\n\n<p>* I reversed the argument order to match the order used by <code>Data.List.Split</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 4161098, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312016236/picture?type=large", "display_name": "Panos", "link": "https://stackoverflow.com/users/4161098/panos"}, "is_accepted": false, "score": 0, "last_activity_date": 1420372337, "creation_date": 1420372337, "answer_id": 27765200, "question_id": 27755623, "link": "https://stackoverflow.com/questions/27755623/haskell-partial-sum-of-a-list-error/27765200#27765200", "title": "Haskell partial sum of a list error", "body": "<p>Thank to your answers i figured it out.\nI needed to declare the type of the function and put the parenthesis where they should be.\nThe code was indeed not working as it should but i fixed that to. </p>\n\n<p>Here is the fixed code:</p>\n\n<pre><code>partial_add :: [Int] -&gt; [Int] -&gt; Int -&gt; [Int]        \npartial_add [] _ count = [count]\npartial_add (a:x) list count | elem a list =  (count+a):partial_add x list 0\n                             | otherwise =  partial_add x list (count+a)\n</code></pre>\n\n<p>It may not be the best possible but it worked out for me.</p>\n"}], "owner": {"reputation": 43, "user_id": 4161098, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312016236/picture?type=large", "display_name": "Panos", "link": "https://stackoverflow.com/users/4161098/panos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 27759449, "answer_count": 3, "score": 3, "last_activity_date": 1420372337, "creation_date": 1420293415, "last_edit_date": 1420293678, "question_id": 27755623, "link": "https://stackoverflow.com/questions/27755623/haskell-partial-sum-of-a-list-error", "title": "Haskell partial sum of a list error", "body": "<p>I need to write a function in Haskell that sums the elements of a list until some specific elements stored in another list.</p>\n\n<p>For example <code>partial_add [1,2,3,4,5,6] [2,5] 0</code> should return <code>[3,12,6]</code>.</p>\n\n<p>I have reached this far:</p>\n\n<pre><code>partial_add [] _ count = []\npartial_add (a:x) list count | elem a list =  count:partial_add x list 0\n                             | otherwise =  partial_add x list count+a\n</code></pre>\n\n<p>(most probably not working properly)</p>\n\n<p>But when I try to run the function (it compiles properly) I get this error:</p>\n\n<pre><code>No instance for (Num [t0]) arising from a use of `it' \nIn a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>Any idea what's going on?</p>\n"}, {"tags": ["haskell", "operator-overloading", "ghc"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1420289404, "post_id": 27754902, "comment_id": 43920762, "body": "That would be nice but how would you apply normal functions?"}, {"owner": {"reputation": 11972, "user_id": 1546844, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ac5e2787eb9367020473f8d146222279?s=128&d=identicon&r=PG", "display_name": "Chiel ten Brinke", "link": "https://stackoverflow.com/users/1546844/chiel-ten-brinke"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1420291148, "post_id": 27754902, "comment_id": 43921194, "body": "It should only be overloaded for certain types, like (in my example) two numbers."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1420291735, "post_id": 27754902, "comment_id": 43921368, "body": "It won&#39;t work together with type inference."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1420292228, "post_id": 27754902, "comment_id": 43921523, "body": "Maybe it would. I could imagine a <code>type family Argument</code> with <code>type instance Argument (a -&gt; b) a</code>, where the term <code>(x::a) (y::b)</code> would generate the constraint <code>Argument a ~ b</code>. Surely, more code will need type annotations, but it could work."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1420290432, "post_id": 27755045, "comment_id": 43921010, "body": "<code>3 (4 :: Int) :: Int</code> is hardly a gain over <code>3 * 4</code>."}, {"owner": {"reputation": 11972, "user_id": 1546844, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ac5e2787eb9367020473f8d146222279?s=128&d=identicon&r=PG", "display_name": "Chiel ten Brinke", "link": "https://stackoverflow.com/users/1546844/chiel-ten-brinke"}, "edited": false, "score": 0, "creation_date": 1420291000, "post_id": 27755045, "comment_id": 43921155, "body": "Would it be possible to make this work without explicitly casting the result to <code>Int</code> like is done in <code>3 _4 :: Int</code>?"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1420298423, "post_id": 27755045, "comment_id": 43923342, "body": "The type annotation is needed in ghci only. In source file you could have <code>twelve :: Int</code> <code>twelve = 3 4</code>"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1420343348, "post_id": 27755045, "comment_id": 43935509, "body": "Strictly speaking, this does not overload juxtaposition. Juxtaposition is still function application. It is quite clever though!"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 5, "last_activity_date": 1420289823, "last_edit_date": 1420289823, "creation_date": 1420289488, "answer_id": 27755045, "question_id": 27754902, "link": "https://stackoverflow.com/questions/27754902/is-there-a-way-to-overload-juxtaposition-in-ghc/27755045#27755045", "title": "Is there a way to overload juxtaposition in ghc?", "body": "<p>Actually, yes!</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\nmodule Temp where\n\ninstance Num a =&gt; Num (a -&gt; a) where\n  fromInteger n = (fromInteger n *)\n  n + m = \\x -&gt; n x + m x\n  -- ...\n</code></pre>\n\n<p>Then in ghci:</p>\n\n<pre><code>\u03bb :l Temp\n...\n\u03bb 3 (4 :: Int) :: Int\n12\n\u03bb let _4 = 4 :: Int\n\u03bb 3 _4 :: Int\n12\n\u03bb (3 + 4) (2 :: Int) :: Int\n14\n</code></pre>\n\n<p>The symbols <code>0</code>, <code>1</code>, etc in Haskell are overloaded - <code>0 :: Num a =&gt; a</code> - they can represent anything that has a <code>Num</code> instance. So by defining a <code>Num</code> instance for functions <code>Num a =&gt; a -&gt; a</code>, we now have the <code>3 :: Num a =&gt; a -&gt; a</code></p>\n"}], "owner": {"reputation": 11972, "user_id": 1546844, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ac5e2787eb9367020473f8d146222279?s=128&d=identicon&r=PG", "display_name": "Chiel ten Brinke", "link": "https://stackoverflow.com/users/1546844/chiel-ten-brinke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 27755045, "answer_count": 1, "score": 3, "last_activity_date": 1420289823, "creation_date": 1420288436, "last_edit_date": 1420288960, "question_id": 27754902, "link": "https://stackoverflow.com/questions/27754902/is-there-a-way-to-overload-juxtaposition-in-ghc", "title": "Is there a way to overload juxtaposition in ghc?", "body": "<p>I'm trying to design an embedded language in Haskell, and, if possible, I'd like to give a custom meaning to juxtaposition, which normally denotes function application.\nOr, almost equivalently, I would like to define a whitespace operator, which has a normal definable operator precedence.</p>\n\n<p>Something like</p>\n\n<pre><code>( ) x y = x * y\n</code></pre>\n\n<p>which would then allow to write multiplication <code>3 * 4</code> as <code>3 4</code>.</p>\n\n<p>Is there any way in GHC (using any extension necessary) to implement this?</p>\n"}, {"tags": ["haskell", "optimization", "real-time", "immutability", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1420334762, "post_id": 27754801, "comment_id": 43933967, "body": "You might want to be a little more concrete by &quot;recreate a new slightly-changed state&quot;. I think you might be asking about sharing, or about how GHC represents data on the heap."}], "answers": [{"comments": [{"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1420289460, "post_id": 27754928, "comment_id": 43920771, "body": "You mentioned just for the <code>IO</code> monad that it&#39;s probably the right thing for real-time. Are you excluding <code>ST</code> or would it probably serve me just as well?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1420292985, "post_id": 27754928, "comment_id": 43921724, "body": "@MasterMastic: <code>ST</code> should be fine."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 2, "creation_date": 1420293001, "post_id": 27754928, "comment_id": 43921727, "body": "@MasterMastic: <code>IO</code> and <code>ST</code> are in fact the same as far as mutable state is concerned; the difference is simply that <code>ST</code> doesn&#39;t allow you to perform file reads, random number access etc.. Hence its end-to-end performance is referentially transparent; you can therefore embed a mutable <code>ST</code> algorithm safely into a purely-functional program (with <code>runST</code>; when using <code>IO</code>, this would require <code>unsafePerformIO</code>, we don&#39;t want that). But if you&#39;re in the <code>IO</code> monad anyway, you might as well use it for the mutable state, too."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 1, "creation_date": 1420445582, "post_id": 27754928, "comment_id": 43961740, "body": "GHC actually does perform this optimization very occasionally (it has a name which I&#39;m trying to remember), but it&#39;s not at all thorough about detecting when it&#39;s applicable."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 9, "last_activity_date": 1420291488, "last_edit_date": 1420291488, "creation_date": 1420288673, "answer_id": 27754928, "question_id": 27754801, "link": "https://stackoverflow.com/questions/27754801/when-does-ghc-internally-mutate-immutable-values/27754928#27754928", "title": "When does GHC internally mutate immutable values?", "body": "<p>GHC itself doesn't do this. Various container libraries use a trick called <em>stream fusion</em>, which means some copies that the pure-functional code suggests aren't actually ever made &ndash; but this is still not true \"internal mutation\", rather it groups together multiple operations that would each involve a copy to one single big operation with still only one copy.</p>\n\n<p>I don't think it's really feasible to get true \"mutation-optimisation\" in a fully automatic way; some languages like <a href=\"http://mercurylang.org/\" rel=\"noreferrer\">Mercury</a> kind of claim they do it, but I don't really know how well it works.</p>\n\n<p>However, a good pure functional language like Haskell is quite capable of <em>explicitly</em> dealing with mutable state: through monads. This can either be the \"omnipotent\" <code>IO</code> monad (somewhat frowned upon because you lose all ref-transp. guarantees, but for a realtime application this is probably the right thing), or the specialised <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Control-Monad-ST.html\" rel=\"noreferrer\"><code>ST</code> monad</a>, whose purpose is specifically to allow you using true mutable state while keeping the outside behaviour of the program purely-functional.<br>\nIf you take such an approach, you not only make <em>sure</em> there won't be costly copies made, you also probably end up with nicer code. Because sometimes mutation is just the right way to think about some problem; even code that's really pure-functional sometimes gets nicer if you \"pretend\" to use mutable state, in the <a href=\"http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-State.html\" rel=\"noreferrer\"><code>State</code> monad</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1420444646, "post_id": 27754952, "comment_id": 43961419, "body": "Manually notifying the compiler that such an optimization is possible would require unique types, but there are a couple of cases where GHC does this on its own (such as when an object&#39;s declaration and last use are in the same function)"}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": false, "score": 4, "last_activity_date": 1420288828, "creation_date": 1420288828, "answer_id": 27754952, "question_id": 27754801, "link": "https://stackoverflow.com/questions/27754801/when-does-ghc-internally-mutate-immutable-values/27754952#27754952", "title": "When does GHC internally mutate immutable values?", "body": "<p>AFAIK <code>ghc</code> doesn't perform such the optimization in general case. It probably requires <a href=\"http://en.wikipedia.org/wiki/Uniqueness_type\" rel=\"nofollow\">unique types</a>.</p>\n\n<p>But it's runtime is optimized for such \"slightly-changed state\" case. Usually your state is (or can be represented as) something like a tree, and most of manges actually reuse most of existing tree. So modification operated only few pointers, and is very efficient. Consider the example:</p>\n\n<pre><code>data State = State\n  { theA :: A\n  , theB :: B\n  }\n\ndata A = A Int\ndata B = B String\n\nmodifyTheA :: (A -&gt; A) -&gt; State -&gt; State\nmodifyTheA f s = s {theA = f (theA s)}\n</code></pre>\n\n<p>Here <code>modifyTheA</code> function creates new <code>State</code>, but it is just two pointers. The whole <code>theB</code> string is reused. </p>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 2, "last_activity_date": 1420445269, "creation_date": 1420445269, "answer_id": 27775535, "question_id": 27754801, "link": "https://stackoverflow.com/questions/27754801/when-does-ghc-internally-mutate-immutable-values/27775535#27775535", "title": "When does GHC internally mutate immutable values?", "body": "<p>GHC does this optimization on one condition: if an object is used once in the function where it's declared and no additional references to it are created. It isn't applied if the object is created and used in separate functions unless the source function is inlined.</p>\n\n<p>There is another related optimization that GHC does more reliably. If a function's last action is to call itself with mostly the same arguments then it won't even touch the arguments that are unchanged.</p>\n"}], "owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 3, "answer_count": 3, "score": 3, "last_activity_date": 1420445269, "creation_date": 1420287724, "question_id": 27754801, "link": "https://stackoverflow.com/questions/27754801/when-does-ghc-internally-mutate-immutable-values", "title": "When does GHC internally mutate immutable values?", "body": "<p>I wish to use Haskell for a realtime application that consists of a ever-changing heavy state.</p>\n\n<p>The state is immutable, of course, so at every state-step I will re-create a new slightly-changed state and discard the old one. It would turn out painfully inefficient in this instance, because I have no need for the previous states.</p>\n\n<p>I often encountered people saying that GHC can optimize those kind of stuff and internally mutate immutable values, and I want to make sure that it will.</p>\n\n<p>Is it possible? is there a way to determine if GHC will optimize it by internally mutating the value? is there a way to enforce it / make sure it will?</p>\n\n<p>P.S. Is there a formal name for this optimization?</p>\n"}, {"tags": ["list", "haskell", "sum"], "answers": [{"tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": false, "score": 4, "last_activity_date": 1420284475, "last_edit_date": 1420284475, "creation_date": 1420284133, "answer_id": 27754279, "question_id": 27754250, "link": "https://stackoverflow.com/questions/27754250/haskell-sum-of-generated-list/27754279#27754279", "title": "Haskell sum of generated list", "body": "<p>Just use the <code>sum</code> function, like so:</p>\n\n<pre><code>primesR :: Integral a =&gt; a -&gt; a -&gt; a\nprimesR a b = sum $ takeWhile (&lt;= b) $ dropWhile (&lt; a) $ sieve [2..]\n       where sieve (n:ns) = n:sieve [ m | m &lt;- ns, m `mod` n /= 0 ]\n</code></pre>\n\n<p>Note that you need to change the function signature from <code>Integral a =&gt; a -&gt; a -&gt; [a]</code> to <code>Integral a =&gt; a -&gt; a -&gt; a</code>, since the result of summation is a single value, not a list.</p>\n"}], "owner": {"reputation": 87, "user_id": 2191138, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9ec043b8ac2688a2ccebe032ea7aa655?s=128&d=identicon&r=PG", "display_name": "Batsman", "link": "https://stackoverflow.com/users/2191138/batsman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420284475, "creation_date": 1420283894, "question_id": 27754250, "link": "https://stackoverflow.com/questions/27754250/haskell-sum-of-generated-list", "title": "Haskell sum of generated list", "body": "<p>Hi i'm pretty new to haskell and I want to make a program with prime numbers.\nWith the code below I put all the prime numbers between 2 integers in a list, now i want to make a sum of all the prime numbers of the generated list and show this as an answer.</p>\n\n<pre><code>primesR :: Integral a =&gt; a -&gt; a -&gt; [a]\nprimesR a b = takeWhile (&lt;= b) $ dropWhile (&lt; a) $ sieve [2..]\n  where sieve (n:ns) = n:sieve [ m | m &lt;- ns, m `mod` n /= 0 ]\n</code></pre>\n\n<p>I didn't find any examples of the sum of a generated list. Does anyone know how I can manage this in the code? </p>\n\n<p>thx</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "edited": false, "score": 1, "creation_date": 1420396304, "post_id": 27753412, "comment_id": 43948532, "body": "Apparently, the problem lies in the main thread quitting before logger. The workaround is to not rely on logger logging the message, but collect all results separately and write to disk."}], "owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420277990, "creation_date": 1420277412, "last_edit_date": 1420277990, "question_id": 27753412, "link": "https://stackoverflow.com/questions/27753412/running-an-hint-evaluator-on-cloud-haskell-node-odd-behavior-on-quickcheck", "title": "Running an Hint evaluator on cloud haskell node, odd behavior on quickCheck", "body": "<p>I am trying to follow along the tutorial on cloud haskell <a href=\"http://haskell-distributed.github.io/tutorials/1ch.html#sending-messages\" rel=\"nofollow\">here</a>. For my purpose, I wanted to evaluate quickcheck properties in different slaves. So I added a Hint evaluator that takes a module name to load, and an expression to evaluate within the context of that module. </p>\n\n<p>Now, my problem is that when I try to run it after compiling it, I get all the messages just before evaluation, and the process seems to exit.</p>\n\n<pre><code>./dist/build/d-mucheck/d-mucheck\nSat Jan  3 09:16:34 UTC 2015 pid://127.0.0.1:10501:0:10: send mymodule\nSat Jan  3 09:16:34 UTC 2015 pid://127.0.0.1:10501:0:11: Got mymodule and test:quickCheckResult revProp\n</code></pre>\n\n<p>However, if I run <code>main</code> from <code>cabal repl</code> I get the expected output. So my question is, am I doing any thing wrong? How do I get it to produce the expected output in the command line?</p>\n\n<p>My code</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving, DeriveDataTypeable, TypeSynonymInstances #-}\n\nmodule Main where\nimport Control.Concurrent (threadDelay)\nimport Control.Monad (forever)\nimport Control.Distributed.Process\nimport Control.Distributed.Process.Node (forkProcess, newLocalNode, initRemoteTable)\nimport Network.Transport.TCP (createTransport, defaultTCPParameters)\nimport qualified Language.Haskell.Interpreter as I\nimport qualified Test.QuickCheck.Test as Qc\n\nimport Data.Typeable\nderiving instance Typeable Qc.Result\n\ntype InterpreterOutput = Either I.InterpreterError Qc.Result\n\nlocalHost, localPort :: String\nlocalHost = \"127.0.0.1\"\nlocalPort = \"10501\"\n\nevaluator :: String -&gt; String -&gt; IO InterpreterOutput\nevaluator mymodule myexpr = I.runInterpreter evM\n  where evM = do I.loadModules [mymodule]\n                 ms &lt;- I.getLoadedModules\n                 I.setTopLevelModules ms\n                 result &lt;- I.interpret myexpr (I.as :: (Typeable a =&gt; IO a)) &gt;&gt;= liftIO\n                 return result\n\nmuServer :: (ProcessId, String, String) -&gt; Process ()\nmuServer (sender, mymodule, myexpr) = do\n  say $ \"Got mymodule and test:\" ++ myexpr\n  iResult &lt;- liftIO (evaluator mymodule myexpr)\n  val &lt;- case iResult of\n        Left err -&gt; do say $ \"error \" ++ (show err)\n                       return (show err)\n        Right out -&gt; do say $ \"success \" ++ (show out)\n                        return (show out)\n  say $ \"Got mymodule and test:\" ++ myexpr\n  send sender (show val)\n\nmain :: IO ()\nmain = do\n  Right t &lt;- createTransport localHost localPort defaultTCPParameters\n  node &lt;- newLocalNode t initRemoteTable\n  _ &lt;- forkProcess node $ do\n    myPid &lt;- spawnLocal $ forever $ do\n      receiveWait [match muServer]\n\n    self &lt;- getSelfPid\n    say $ \"send mymodule\"\n    send myPid (self, \"Examples/QuickCheckTest.hs\", \"quickCheckResult revProp\")\n\n    m &lt;- expectTimeout 1000000\n    case m of\n      Nothing  -&gt; die \"at worker: nothing came back!\"\n      (Just s) -&gt; do say $ \"at worker: got \" ++ s ++ \" back!\"\n    return ()\n\n  liftIO $ threadDelay (1*1000000)\n  return ()\n</code></pre>\n\n<p>The sample module with quickcheck properties</p>\n\n<pre><code>module Examples.QuickCheckTest where\nimport Test.QuickCheck\nimport Data.List\n\nqsort :: [Int] -&gt; [Int]\nqsort [] = []\nqsort (x:xs) = qsort l ++ [x] ++ qsort r\n    where l = filter (&lt; x) xs\n          r = filter (&gt;= x) xs\n\nidEmpProp xs = qsort xs == qsort (qsort xs)\nrevProp xs = qsort xs == qsort (reverse xs)\nmodelProp xs = qsort xs == sort xs\n</code></pre>\n\n<p>If I use just a simple module,</p>\n\n<pre><code>module Test where\nmytest :: IO String\nmytest = return \"Hello from module Test\"\n</code></pre>\n\n<p>and then use <code>mytest</code> as the evaluation string (replacing Qc.Result with string), I get the expected output from the slave.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1420251934, "post_id": 27750952, "comment_id": 43913344, "body": "&quot;I think the implementation of the solution is little [messy]&quot; - Then clean it up!  Is there any reason why you can&#39;t use custom <code>data</code> types for the months and days?  It&#39;d be a lot cleaner and safer to not use strings."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1420252471, "post_id": 27750952, "comment_id": 43913440, "body": "October 2013 started on a Tuesday."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1420253987, "creation_date": 1420253987, "answer_id": 27751298, "question_id": 27750952, "link": "https://stackoverflow.com/questions/27750952/generate-calendar-of-a-given-month-and-year-in-haskell/27751298#27751298", "title": "generate calendar of a given month and year in haskell", "body": "<p>A more \"functional\" approach to this problem would be:</p>\n\n<ol>\n<li>Create a list of 35 strings, each string is either the empty string or a (stringified) number.</li>\n<li>Break up the list into chunks of 7 elements each (so you get five chunks)</li>\n<li>For each chunk render the elements as a row in the calendar.</li>\n</ol>\n\n<p>For example, for the month October 2013 the list of 35 strings would be:</p>\n\n<pre><code>cells = [ \"\", \"\", \"\", \"1\", \"2\", \"3\", ..., \"31\", \"\", \"\" ]\n</code></pre>\n\n<p>The chunks can be created using this helper function:</p>\n\n<pre><code>chunksOf7 (a:b:c:d:e:f:g:rest) = [ [a,b,c,d,e,f,g] ] ++ chunksOf7 rest\nchunksOf7 xs = xs\n</code></pre>\n\n<p>(There are better ways to define <code>chunksOf7</code>, but this will suffice.)</p>\n\n<p>And to render a chunk:</p>\n\n<pre><code>renderChunk cells =  (concat $ map renderCell cells) ++ \"\\n\"\nrenderCell c = pad 3 c ++ \"|\"\npad n str = str ++ (replicate (n-(length str)) ' ')\n</code></pre>\n\n<p><code>pad n str</code> pads the string <code>str</code> with spaces on the right until the total length is <code>n</code>.\n<code>replicate n a</code> creates a list of with the value <code>a</code> repeated <code>n</code> times.</p>\n\n<p>And to put it all together (once you have your <code>cells</code> list):</p>\n\n<pre><code>renderCalendarBody cells =  concat (map renderChunk chunks)\n  where chunks = chunksOf7 cells\n</code></pre>\n\n<p>Now, given a year and a month, you just have to write a function to define what <code>cells</code> is.\nThe cells list is going to consists of:</p>\n\n<ul>\n<li>some number of leading empty strings</li>\n<li>followed by 1 through 30 (or 31 or whatever the last day of the month is)</li>\n<li>followed by some number of trailing empty strings</li>\n</ul>\n\n<p>i.e.:</p>\n\n<pre><code>cellsForYearAndMonth y m = (replicate n1 \"\")\n                              ++ [ show d | d &lt;- [1..lastday] ]\n                              ++ (replicate n2 \"\")\n  where lastday = ...\n        n1 = ... number of leading empty strings ...\n        n2 = ... number of trailing empty strings ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4404063, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3aa2ae7a028fa7142b86a5575f41d179?s=128&d=identicon&r=PG&f=1", "display_name": "rmsorPth", "link": "https://stackoverflow.com/users/4404063/rmsorpth"}, "is_accepted": true, "score": 0, "last_activity_date": 1420429678, "creation_date": 1420429678, "answer_id": 27773142, "question_id": 27750952, "link": "https://stackoverflow.com/questions/27750952/generate-calendar-of-a-given-month-and-year-in-haskell/27773142#27773142", "title": "generate calendar of a given month and year in haskell", "body": "<p>Thanks @user5402. Finally I got working version</p>\n\n<pre><code>import Data.Time.Calendar\nimport Data.Time.Calendar.WeekDate\nimport Data.Char\nyear=2014\nmonth=2\nmonths=[\"JANUARY\",\"FEBRUARY\",\"MARCH\",\"APRIL\",\"MAY\",\"JUNE\",\"JULY\",\"AUGUST\",\"SEPTEMBER\",\"OCTOBER\",\"NOVEMBER\",\"DECEMBER\"]\nmnth=months!!(month-1)\nmonthDate = getDaysInMonth year month\nstartAt=snd(monthDate)\ntotalDays = fst(monthDate)\n\ngetDaysInMonth year month=(nDays,sDay) \n                      where nDays = gregorianMonthLength year month\n                            sDay= digitToInt(last(showWeekDate (fromGregorian year month 01)))\ncells = (replicate n1 \"\")\n                          ++ [ show d | d &lt;- [1..lastday] ]\n                          ++ (replicate n2 \"\")\n          where lastday = totalDays\n                n1=(startAt-1)\n                n2=(7-(totalDays-(29-startAt)))\nchunksOf7 []=[]\nchunksOf7 (a:b:c:d:e:f:g:rest) = [ [a,b,c,d,e,f,g] ] ++ chunksOf7 rest\n\npad n str = str ++ (replicate (n-(length str)) ' ')\nrenderCell c = pad 3 c ++ \"|\"\nrenderChunk cells =  (concat $ map renderCell cells) ++ \"\\n\"\n\nprintLine = \"\\n\"++concat [\"+---\" | r &lt;- [1..7]]++\"\\n\"\nmonthLine=concat [[r]++\" |\" | r &lt;- mnth]\ndayLine=\"Sun|Mon|Tue|Wed|Thu|Fri|Sat\"\nheading=concat[printLine,\"Year: \",show year,printLine,monthLine,printLine,dayLine,printLine]\n\nrenderCalendarBody cells =  heading++concat (map renderChunk chunks)\n  where chunks = chunksOf7 cells\n\nmain= do putStrLn $ renderCalendarBody cells\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4404063, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3aa2ae7a028fa7142b86a5575f41d179?s=128&d=identicon&r=PG&f=1", "display_name": "rmsorPth", "link": "https://stackoverflow.com/users/4404063/rmsorpth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 2, "accepted_answer_id": 27773142, "answer_count": 2, "score": 1, "last_activity_date": 1420429678, "creation_date": 1420249839, "question_id": 27750952, "link": "https://stackoverflow.com/questions/27750952/generate-calendar-of-a-given-month-and-year-in-haskell", "title": "generate calendar of a given month and year in haskell", "body": "<p>I have been learning haskell since a week and is facing different problems. This time I have to create a calendar from a given month and year. I am almost done but the problem is that I could not start filling days from starting day.</p>\n\n<p>My solution is </p>\n\n<pre><code>getDaysInMonth year month=(nDays,sDay) \n                          where nDays = gregorianMonthLength year month\n                                sDay= digitToInt(last(showWeekDate (fromGregorian year month 01)))\nyear=2013\nmonth=10\nmonths=[\"JANUARY\",\"FEBRUARY\",\"MARCH\",\"APRIL\",\"MAY\",\"JUNE\",\"JULY\",\"AUGUST\",\"SEPTEMBER\",\"OCTOBER\",\"NOVEMBER\",\"DECEMBER\"]\nmnth=months!!(month-1)\nmonthDate = getDaysInMonth year month\nstartAt=snd(monthDate)\ntotalDays = fst(monthDate)\nprintLine = \"\\n\"++concat [\"+---\\t\" | r &lt;- [1..7]]\ncheck x | x&gt;totalDays=\"\"\n        | x&lt;=totalDays=show x\ngenDays n m=\"\\n \"++concat[check(x)++\"\\t|\"|x&lt;-[n..m]]\ngenD 6=\"\"\ngenD sP=genDays ((sP-1)*7+1) (sP*7) ++genD (sP+1)\ngenerateCalendar=printLine++\"\\n \"++\n                        concat [[r]++\"\\t|\" | r &lt;- mnth]++printLine++\n                        \"\\n Sun\\t|Mon\\t|Tue\\t|Wed\\t|Thu\\t|Fri\\t|Sat\"++printLine++\n                        genD 1\nmain=do\n     putStrLn generateCalendar\n</code></pre>\n\n<p>Output of this program is like this</p>\n\n<pre><code>+---+---+---+---+---+---+---    \n O  |C  |T  |O  |B  |E  |R  |\n+---+---+---+---+---+---+---    \n Sun|Mon|Tue|Wed|Thu|Fri|Sat\n+---+---+---+---+---+---+---    \n 1  |2  |3  |4  |5  |6  |7  |\n 8  |9  |10 |11 |12 |13 |14 |\n 15 |16 |17 |18 |19 |20 |21 |\n 22 |23 |24 |25 |26 |27 |28 |\n 29 |30 |31 |   |   |   |   |\n</code></pre>\n\n<p>So the problem is that October month should start from Monday. I think the implementation of the solution is little mess but how can I solve this problem ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["json", "exception", "haskell", "aeson"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1420245964, "post_id": 27750552, "comment_id": 43912249, "body": "How do you generate the <code>content</code> you feed to getBook? If you use <code>parseJSON</code> then the <code>fromJust</code> exception can come from one of the instances you have declared as they use this unsafe function heavily."}, {"owner": {"reputation": 318, "user_id": 4413773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lLK8T.png?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4413773/rafael"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1420246642, "post_id": 27750552, "comment_id": 43912381, "body": "I&#39;m retrieving the content directly from the webpages I mentioned using  <code>simpleHttp</code> from the <code>Network.HTTP.Conduit</code> library, as a <code>ByteString</code> (<code>Data.ByteString.Lazy.Char8.ByteString</code>). The function <code>fromJust</code> is only used in the parsing Aeson functions I included in the beginning of the post."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1420246912, "post_id": 27750552, "comment_id": 43912425, "body": "That&#39;s my point: I&#39;d guess that the <code>fromJust</code>s used in the parsing phase fail at some point (is <code>decode</code> basically using <code>parseJSON</code>?)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1463583485, "post_id": 27750552, "comment_id": 62128479, "body": "Don&#39;t use <code>fromJust</code> in real code. <code>isNothing</code> isn&#39;t much use either. Use pattern matching or <code>fromMaybe</code> or <code>maybe</code> and you won&#39;t have these problems."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1420249394, "creation_date": 1420249394, "answer_id": 27750914, "question_id": 27750552, "link": "https://stackoverflow.com/questions/27750552/isnothing-throws-an-exception-when-parsing-json-file/27750914#27750914", "title": "isNothing throws an exception when parsing JSON file", "body": "<p>The github package defines a convenience operator to define array fields:</p>\n\n<pre><code>-- | A slightly more generic version of Aeson's @(.:?)@, using `mzero' instead\n-- of `Nothing'.\n(.:&lt;) :: (FromJSON a) =&gt; Object -&gt; T.Text -&gt; Parser [a]\nobj .:&lt; key = case Map.lookup key obj of\n                   Nothing -&gt; pure mzero\n                   Just v  -&gt; parseJSON v\n</code></pre>\n\n<p>(here <code>Map</code> is an alias for <code>Data.HashMap.Lazy</code>)</p>\n\n<p>Then the <code>FromJSON</code> instance of VolumeInfo would be defined like this:</p>\n\n<pre><code>instance FromJSON VolumeInfo\n  v .: \"title\" &lt;*&gt;\n  ...\n  v .:&lt; \"industryIdentifiers\" &lt;*&gt;\n  ...\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 4413773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lLK8T.png?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4413773/rafael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 27750914, "answer_count": 1, "score": 1, "last_activity_date": 1463566782, "creation_date": 1420245623, "last_edit_date": 1463566782, "question_id": 27750552, "link": "https://stackoverflow.com/questions/27750552/isnothing-throws-an-exception-when-parsing-json-file", "title": "isNothing throws an exception when parsing JSON file", "body": "<p>I've got the following functions to decode JSON files using the <code>Data.Aeson</code> library:</p>\n\n<pre><code>data SearchResult = SearchResult {\n  items :: [Item]\n} deriving (Show)\n\ninstance FromJSON SearchResult where\n  parseJSON :: Value -&gt; Parser SearchResult\n  parseJSON (Object v) = SearchResult &lt;$&gt;\n    parseJSON (fromJust $ HM.lookup \"items\" v)\n  parseJSON _ = mzero\n\ndata Item = Item {\n  volumeInfo :: VolumeInfo\n} deriving (Show)\n\ninstance FromJSON Item where\n  parseJSON :: Value -&gt; Parser Item\n  parseJSON (Object v) = Item &lt;$&gt;\n    parseJSON (fromJust $ HM.lookup \"volumeInfo\" v)\n  parseJSON _ = mzero\n\ndata VolumeInfo = VolumeInfo {\n  title :: String,\n  authors :: [String],\n  publisher :: String,\n  publishedDate :: String,\n  industryIdentifiers :: [IndustryIdentifier],\n  pageCount :: Int,\n  categories :: [String]\n} deriving (Show)\n\ninstance FromJSON VolumeInfo where\n  parseJSON :: Value -&gt; Parser VolumeInfo\n  parseJSON (Object v) = VolumeInfo &lt;$&gt;\n    v .: \"title\" &lt;*&gt;\n    v .: \"authors\" &lt;*&gt;\n    v .: \"publisher\" &lt;*&gt;\n    v .: \"publishedDate\" &lt;*&gt;\n    parseJSON (fromJust $ HM.lookup \"industryIdentifiers\" v) &lt;*&gt;\n    v .: \"pageCount\" &lt;*&gt;\n    v .: \"categories\"\n  parseJSON _ = mzero\n\ndata IndustryIdentifier = IndustryIdentifier {\n  identifierType :: String,\n  identifier :: String\n} deriving (Show)\n\ninstance FromJSON IndustryIdentifier where\n  parseJSON :: Value -&gt; Parser IndustryIdentifier\n  parseJSON (Object v) = IndustryIdentifier &lt;$&gt;\n    v .: \"type\" &lt;*&gt;\n    v .: \"identifier\"\n  parseJSON _ = mzero\n</code></pre>\n\n<p>And this function:</p>\n\n<pre><code>getBook content = do\n  putStrLn (Data.ByteString.Lazy.Char8.unpack content)\n  let searchResult = decode content :: Maybe SearchResult\n  print (isNothing searchResult)\n  print searchResult\n</code></pre>\n\n<p>The function <code>getBook</code> works with many JSON files. Here's an example:</p>\n\n<pre><code>False\nJust (SearchResult {items = [Item {volumeInfo = VolumeInfo {title = \"A Memoir of Jane Austen\", authors = [\"James Edward Austen-Leigh\",\"Jane Austen, James Austen-Leigh\"], publisher = \"Wordsworth Editions\", publishedDate = \"2007\", industryIdentifiers = [IndustryIdentifier {identifierType = \"ISBN_10\", identifier = \"1840225602\"},IndustryIdentifier {identifierType = \"ISBN_13\", identifier = \"9781840225600\"}], pageCount = 256, categories = [\"Novelists, English\"]}}]})\n</code></pre>\n\n<p>The JSON content was successfully decoded, and therefore <code>isNothing</code> returns <code>False</code> in the first line, followed by the decoded content. If I run the function again with <a href=\"https://www.googleapis.com/books/v1/volumes?q=inauthor:jane%20austen&amp;printType=books&amp;maxResults=1&amp;startIndex=1\" rel=\"nofollow\">this JSON file</a> as <code>content</code>, I get the following output:</p>\n\n<pre><code>True\nNothing\n</code></pre>\n\n<p>The file couldn't be decoded (as there is no field <code>categories</code> on the JSON file), and so <code>isNothing</code> returns <code>True</code>, and <code>Nothing</code> is printed on screen. Now the problem is when I run it with <a href=\"https://www.googleapis.com/books/v1/volumes?q=inauthor:jane%20austen&amp;printType=books&amp;maxResults=1&amp;startIndex=2\" rel=\"nofollow\">this JSON file</a> as <code>content</code>. I get this:</p>\n\n<pre><code>*** Exception: Maybe.fromJust: Nothing\n</code></pre>\n\n<p>An exception is thrown when <code>print (isNothing searchResult)</code> is executed, and I don't understand why <code>True</code> isn't returned like in the previous example (because in this case there is no field <code>industryIdentifiers</code>, for example). What am I missing or doing wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I found out the problem happens every time the JSON file doesn't include the field <code>industryIdentifiers</code>. It fails in this line:</p>\n\n<pre><code>parseJSON (fromJust $ HM.lookup \"industryIdentifiers\" v) &lt;*&gt;\n</code></pre>\n"}, {"tags": ["haskell", "empty-list"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1420246183, "post_id": 27750533, "comment_id": 43912296, "body": "This question appears to be off-topic because it shows no prior effort and has no question."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1420295448, "post_id": 27750533, "comment_id": 43922424, "body": "It looks like you&#39;re trying to parse some non-trivial language &quot;by hand&quot;. This is probably a bad idea, you should look into parsec or the like. More importantly, if you represented your data as a tree, it would be much easier to do substitutions like these."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4400821, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/071934f389c2b84225ea46908db092bc?s=128&d=identicon&r=PG&f=1", "display_name": "overpro", "link": "https://stackoverflow.com/users/4400821/overpro"}, "edited": false, "score": 0, "creation_date": 1420249453, "post_id": 27750635, "comment_id": 43912902, "body": "I defined split myself. It has been added to the question as addition."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 1, "last_activity_date": 1420246445, "creation_date": 1420246445, "answer_id": 27750635, "question_id": 27750533, "link": "https://stackoverflow.com/questions/27750533/exception-prelude-head-empty-list/27750635#27750635", "title": "Exception: Prelude.head: empty list", "body": "<p>As you can see <a href=\"http://hackage.haskell.org/package/text-1.2.0.3/docs/Data-Text.html#g:18\" rel=\"nofollow\">in the doc</a>, <code>split</code> does not keep the separators in the chunks it outputs so they may very well be empty.</p>\n\n<p>As a consequence, having <code>(head t) == '$'</code> in a guard is unsafe and can lead to exceptions being raised.</p>\n"}], "owner": {"reputation": 29, "user_id": 4400821, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/071934f389c2b84225ea46908db092bc?s=128&d=identicon&r=PG&f=1", "display_name": "overpro", "link": "https://stackoverflow.com/users/4400821/overpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1420250291, "accepted_answer_id": 27750635, "answer_count": 1, "score": -1, "last_activity_date": 1420273166, "creation_date": 1420245501, "last_edit_date": 1420273166, "question_id": 27750533, "link": "https://stackoverflow.com/questions/27750533/exception-prelude-head-empty-list", "closed_reason": "Not suitable for this site", "title": "Exception: Prelude.head: empty list", "body": "<p>Here's my attempt at an expand function:</p>\n\n<pre><code>expand :: FileContents -&gt; FileContents -&gt; FileContents  \nexpand textfile infofile  \n  = concat (combine (fst (split separators textfile)) (expand' (snd (split separators textfile))   infofile \"\")   )  \n    where  \n      expand' [] _ stack = []  \n      expand' (t:ts) info stack  \n        |(head t) == '$' = (head (change t info )):expand' ts info stack  \n        |otherwise = t: expand' ts info stack  \n          where  \n            change x y  \n              = lookUp x (getKeywordDefs (snd (split ['\\n'] y)))  \n</code></pre>\n\n<p>When I do:</p>\n\n<pre><code>expand \"Keywords (e.g. $x, $y, $z...) may appear anwhere, e.g. &lt;$here&gt;.\" \"$x $a\\n$y $b\\n$z $c\\n$here $this-is-one\"\n</code></pre>\n\n<p>I get</p>\n\n<pre><code> Exception: Prelude.head: empty list\n</code></pre>\n\n<p>but I wanted</p>\n\n<pre><code>\"Keywords (e.g. $a, $b, $c...) may appear anwhere, e.g. &lt;$this-is-one&gt;.\"\n</code></pre>\n\n<p>Because I should have</p>\n\n<pre><code>(\"Keywords (e.g. $x, $y, $z...) may appear anwhere, e.g. &lt;$here&gt;.\",\n   \"$x $a\\n$y $b\\n$z $c\\n$here $this-is-one\")\n    ==&gt; \"Keywords (e.g. $a, $b, $c...) may appear anwhere, e.g. &lt;$this-is-one&gt;.\"\n</code></pre>\n\n<p>ADDITION\ni defined split myself ,that is:  </p>\n\n<pre><code>split :: [Char] -&gt; String -&gt; (String, [String])  \nsplit separators ( x : wordsrest)  \n      | elem x separators  = (x : listseparators,\"\" : word : listwords)  \n      | otherwise          = (listseparators, ((x : word) : listwords))  \n        where  \n          (listseparators,    word : listwords) = split separators wordsrest  \nsplit _ _ = (\"\" , [\"\"])  \n</code></pre>\n\n<p>for example \nif I input  </p>\n\n<pre><code>split \" .,\" \"A comma, then some words.\"\n</code></pre>\n\n<p>then i'll get </p>\n\n<pre><code>(\" , .\",[\"A\",\"comma\",\"\",\"then\",\"some\",\"words\",\"\"])\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1420234136, "post_id": 27748744, "comment_id": 43908818, "body": "Do you understand why you get that error?  It is an important part to understanding many of the possible answers."}, {"owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420234340, "post_id": 27748744, "comment_id": 43908881, "body": "@ThomasM.DuBuisson sorry, has been experimenting and pasted the wrong definition"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420234676, "post_id": 27748744, "comment_id": 43908998, "body": "But my same question applies."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 2, "creation_date": 1420234701, "post_id": 27748744, "comment_id": 43909003, "body": "@rahul: Think about your definition of <code>apply</code> carefully: are all the <code>b</code> variables of the same type in each case?  Remember that although <code>apply</code> is a polymorphic function, the <i>caller</i> gets to decide what the type variable <code>a</code> is going to be (a.k.a. &quot;a rigid type variable&quot;)."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 3, "creation_date": 1420235250, "post_id": 27748744, "comment_id": 43909207, "body": "@rahul: You will need to use the Rank2Types extension.  This way, you can ask for a function in which the callee (<code>apply</code>) can arbitrarily choose which specialization of <code>==</code> to use."}, {"owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "reply_to_user": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1420235486, "post_id": 27748744, "comment_id": 43909283, "body": "@Rufflewind thanks, I see what you mean."}, {"owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "reply_to_user": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1420235969, "post_id": 27748744, "comment_id": 43909445, "body": "@Rufflewind So apply becomes <code>forall c. (forall a. Eq a =&gt; (a,a) -&gt; c) -&gt; MuOp -&gt; c</code>. If you would like to add this answer, I will accept it."}, {"owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420236352, "post_id": 27748744, "comment_id": 43909564, "body": "@ThomasM.DuBuisson The error is due to my usage of same f applying to different types in the same function call."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1420244853, "post_id": 27749246, "comment_id": 43911993, "body": "The type <code>forall a . Eq a =&gt; (a, a) -&gt; c</code> looks very similar to <code>Bool -&gt; c</code>: what else can <code>f</code> do beyond checking whether the two pair components are equal? My feeling is that this is guaranteed by parametricity. If that&#39;s the case, there aren&#39;t many meaningful <code>f</code>s to pass to <code>apply</code> :-/"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1420296283, "post_id": 27749246, "comment_id": 43922660, "body": "It could be generalized to <code>apply :: Q =&gt; Proxy c -&gt; (forall a . c a =&gt; a -&gt; a -&gt; c) -&gt; MuOp -&gt; c</code>, where <code>Q</code> is a constraint that says every type inside MuOp is an instance of <code>c</code>."}], "tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": true, "score": 3, "last_activity_date": 1420236892, "creation_date": 1420236892, "answer_id": 27749246, "question_id": 27748744, "link": "https://stackoverflow.com/questions/27748744/how-to-apply-a-function-to-a-value-inside-a-constructor-in-haskell/27749246#27749246", "title": "How to apply a function to a value inside a constructor in haskell?", "body": "<p>Think about your definition of <code>apply</code> carefully: are all the <code>b</code> variables of the same type in each case? Remember that although <code>apply</code> is a polymorphic function, the caller gets to decide what the type variable <code>a</code> is going to be (a.k.a. \"a rigid type variable\" in the error message).</p>\n\n<p>Look at, for example, these two cases:</p>\n\n<pre><code>apply :: ((a, a) -&gt; c) -&gt; MuOp -&gt; c\napply f (N  (a, b)) = f (a, b)\napply f (QN (a, b)) = f (a, b)\n...\n</code></pre>\n\n<p>In the first line <code>a</code> and <code>b</code> are both of type <code>Name</code>, but in the second line <code>a</code> and <code>b</code> are both of type <code>QName</code>.  Since the <em>caller</em> gets to decide what the type variable <code>a</code> is, you don't really get to choose between <code>Name</code> and <code>QName</code> arbitrarily.</p>\n\n<p><strong>The solution is to use rank-2 types:</strong></p>\n\n<pre><code>{-# Language Rank2Types #-}\n\napply :: (forall a . Eq a =&gt; (a, a) -&gt; c) -&gt; MuOp -&gt; c\napply f (N  (a, b)) = f (a, b)\napply f (QN (a, b)) = f (a, b)\n...\n</code></pre>\n\n<p>The previously implicit quantifier <code>forall a .</code> has been made explicit and pushed inside the left side of the function arrow.  (Additionally, the <code>Eq</code> constraint has been added, but that is a minor detail.)  By doing so, you allow the <em>callee</em> (i.e. <code>apply</code>) to instantiate the type variable <code>a</code> with any type that satisfies the <code>Eq</code> constraint.</p>\n"}], "owner": {"reputation": 709, "user_id": 1420407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fIdQA.png?s=128&g=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/1420407/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 27749246, "answer_count": 1, "score": 2, "last_activity_date": 1420236892, "creation_date": 1420233899, "last_edit_date": 1420234300, "question_id": 27748744, "link": "https://stackoverflow.com/questions/27748744/how-to-apply-a-function-to-a-value-inside-a-constructor-in-haskell", "title": "How to apply a function to a value inside a constructor in haskell?", "body": "<p>I have my constructor defined as </p>\n\n<pre><code>data MuOp = N  (Name, Name)\n          | QN (QName, QName)\n          | QO (QOp, QOp)\n          | E  (Exp, Exp)\n          | D  (Decl, Decl)\n          | L  (Literal, Literal)\n          | G  (GuardedRhs, GuardedRhs)\n</code></pre>\n\n<p>And I have a few operations on the tuples such as</p>\n\n<pre><code>same :: MuOp -&gt; Bool\nsame (N (a,b)) = a == b\nsame (QN (a,b)) = a == b\nsame (QO (a,b)) = a == b\nsame (E (a,b)) = a == b\nsame (D (a,b)) = a == b\nsame (L (a,b)) = a == b\nsame (G (a,b)) = a == b\n</code></pre>\n\n<p>How ever, it looks ugly to repeat it for multiple functions. Is there any way to define some function such as <code>apply</code> where</p>\n\n<pre><code>apply :: ((a,a) -&gt; c) -&gt; MuOp -&gt; c\napply f (N (a,b)) = f (a, b)\napply f (QN (a,b)) = f (a, b)\napply f (QO (a,b)) = f (a, b)\napply f (E (a,b)) = f (a, b)\napply f (D (a,b)) = f (a, b)\napply f (L (a,b)) = f (a, b)\napply f (G (a,b)) = f (a, b)\n</code></pre>\n\n<p>So I can just say <code>same = apply (\\(a,b) -&gt; a == b)</code> or <code>fEq c -&gt; apply (\\(a,b) -&gt; a == c)</code></p>\n\n<p>My current definition produces this error.</p>\n\n<pre><code>Couldn't match expected type \u2018a\u2019 with actual type \u2018Name\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n      the type signature for apply :: ((a, b) -&gt; c) -&gt; MuOp -&gt; c\n      at src/Test/MuCheck/MuOp.hs:28:10\nRelevant bindings include\n  f :: (a, b) -&gt; c (bound at src/Test/MuCheck/MuOp.hs:29:7)\n  apply :: ((a, b) -&gt; c) -&gt; MuOp -&gt; c\n    (bound at src/Test/MuCheck/MuOp.hs:29:1)\nIn the expression: a\nIn the first argument of \u2018f\u2019, namely \u2018(a, b)\u2019\n</code></pre>\n"}, {"tags": ["algorithm", "haskell", "tree", "unfold", "monadfix"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 3, "creation_date": 1420234474, "post_id": 27748526, "comment_id": 43908929, "body": "What do you mean by lazy here? In general, all of the effects of <code>m</code> from every level must be put in order before the outermost <code>Node</code> can be inspected. Are you looking for a function <code>unfoldForestM</code> such that <code>unfoldForest&#39; f = runIdentity . unfoldForestM (Identity . f)</code> has the same strictness semantics as <code>unfoldForest</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1420234749, "post_id": 27748526, "comment_id": 43909019, "body": "@Cirdec, yes, I am well aware that nothing can be gained in a &quot;strict&quot; monad like <code>Control.Monad.Trans.State.Strict</code>, <code>Control.Monad.ST</code>, or <code>IO</code>. But yes, your description of my general sense of what the laziness criterion should be is correct. The name <code>unfoldForestM</code>, however, is already taken by a <i>depth-first</i> unfold that actually does have the desired laziness."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1420274425, "post_id": 27748526, "comment_id": 43917094, "body": "Could you add examples where you observe the difference between <code>unfoldForst</code> and <code>unfoldForestM_BF</code> specialized to <code>Identity</code>?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1420301300, "post_id": 27748526, "comment_id": 43924140, "body": "@PetrPudl&#225;k I made some examples when working on the problem. If you define <code>unfoldTreeBF f = runIdentity . unfoldTreeM_BF (Identity . f)</code> and a unary tree unfolder <code>mkUnary x = (x, [x+1])</code> then the part of the tree taken while the label matches a predicate is completely defined when the tree is built with <code>unfoldTree</code> - <code>takeWhileTree (&lt;= 3) (unfoldTree   mkUnary 0)</code> but isn&#39;t defined when the tree is build with <code>unfoldTreeBF</code> - <code>takeWhileTree (&lt;= 3) (unfoldTreeBF mkUnary 0)</code>.  See my <a href=\"http://stackoverflow.com/a/27752984/414413\">examples section</a> for the definition of <code>takeWhileTree</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1420306460, "post_id": 27748526, "comment_id": 43925775, "body": "@PetrPudl&#225;k, a simple example: <code>unfoldTree (\\_ -&gt; (&quot;a&quot;,[1..])) 1</code>. Try to descend the tree taking the second child of each node."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420306071, "post_id": 27752984, "comment_id": 43925628, "body": "Ah, this is (mostly) based around the same idea as one implementation I thought of (although yours seems to be much lazier than mine, thanks to the <code>MonadFix</code> and the <code>zipWithIrrefutable</code>). Both run up against the same brick wall of re-splitting the concatenated lists. There doesn&#39;t seem to be any obvious way to set up &quot;jumping over&quot; an infinite (or bottom) list segment without &quot;iterative deepening&quot;, or any way to accomplish the latter in <code>O(n)</code> time when a tree is degenerate (one child per node)."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420306809, "post_id": 27752984, "comment_id": 43925901, "body": "@dfeuer I&#39;m working on another solution that should be able to do <code>O(n)</code> time except in the degenerate case when the tree is a list (one child per node)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420307089, "post_id": 27752984, "comment_id": 43926005, "body": "Well, if you&#39;re willing to accept <code>O(n^2)</code> for one child per node, I think nesting a bunch of <code>mapM</code> calls (approximately) gets you there, and probably without the <code>MonadFix</code> shenanigans."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420307287, "post_id": 27752984, "comment_id": 43926052, "body": "Actually, you might still need the <code>MonadFix</code>. I never finished working out that idea once I realized the degenerate case would be bad."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420309884, "post_id": 27752984, "comment_id": 43926908, "body": "@dfeuer I&#39;ve edited the answer to include a solution that&#39;s sufficiently lazy for trees with infinite branching factor. It runs in <code>O(n^2)</code> time on degenerate trees with one child per node."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420314418, "post_id": 27752984, "comment_id": 43928538, "body": "I keep wondering if there&#39;s some way to apply path compression to the second approach to fix its efficiency problem, representing degenerate trees using queues temporarily. Laziness definitely complicates things. Could you explain a bit why <code>MonadFix</code> is needed for the second solution? That&#39;s still not obvious to me."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1420402393, "post_id": 27752984, "comment_id": 43950541, "body": "@dfeuer I&#39;ve been contemplating removing unnecessary components of degenerate trees since I wrote the lazy solution. I&#39;ve added a general solution to my answer that should run in <code>O(n)</code> time even for degenerate trees with only one child per node. It compresses the structure of the nested trees at each step into a <code>Free []</code> tree, branching only when there are at least two branches."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420403702, "post_id": 27752984, "comment_id": 43951012, "body": "I have some things I have to do before I can read through your latest code, but this looks like quite an impressive feat. You will of course be receiving a bounty here, but I would also suggest that you make this available on Hackage, or, since there&#39;s been some discussion lately of expanding the <code>Data.Tree</code> API, perhaps proposing this for inclusion there."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1420445563, "post_id": 27752984, "comment_id": 43961729, "body": "I&#39;ve been playing around with this a bit, and there seems to be a problem. Try <code>print . until (null . subForest) (last . subForest) $ runIdentity $ flip unfoldTreeMFix_BF 0 (\\x -&gt; return (x, if x &gt; 5 then [] else replicate 10 (x+1)))</code>. This seems quite a bit slower than it should be. I suspect the problem is the recursive <code>compress</code>. Might it be possible to create the forests already compressed, avoiding the decompression? Or might something funky from <code>Control.Monad.Free.Church</code> help along with your idea of using the <code>Monad</code> instance of <code>Free []</code>?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420471909, "post_id": 27752984, "comment_id": 43975182, "body": "@dfeuer That example, which isn&#39;t degenerate until the last level, is slow even with the solution for trees with large branching factors; it doesn&#39;t seem to be related to the compression step."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420479730, "post_id": 27752984, "comment_id": 43979765, "body": "@dfeuer <code>MonadFix</code> isn&#39;t required. I&#39;ve edited the answer to remove it, which makes it slightly more clear what&#39;s going on."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420482265, "post_id": 27752984, "comment_id": 43981028, "body": "Oh, that&#39;s slightly clearer now. I&#39;m surprised you could do without <code>MonadFix</code>. But the same example is still giving terrible performance, and I <i>suspect</i> the problem is that the same things get compressed and decompressed many times. I would think that rather than building a compressed list from an uncompressed one, we&#39;d want to build a compressed list from another compressed list, and build an uncompressed forest from a compressed list and a decompressed forest. But I don&#39;t know."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420489635, "post_id": 27752984, "comment_id": 43984552, "body": "@dfeuer There&#39;s probably somewhere the general solution can be lazier. Without the rule for cleaning up empty lists your example runs quickly (but completely sequencing finite trees like my <code>binaryDepths</code> fails to detect termination). With the rule for empty lists, <code>print . until (null . subForest) (last . subForest) $ runIdentity $ flip unfoldTreeM_BF 0 (\\x -&gt; return (x, if x &gt; 5 then [] else replicate 9 x ++ [x+1]))</code> runs quickly, which demonstrates what the delay is. The rule for cleaning up empty lists needs to find a non-empty part of some portion of the tree to terminate early."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420569496, "post_id": 27752984, "comment_id": 44019010, "body": "@dfeuer I&#39;ve made a <a href=\"https://gist.github.com/Cedev/745e9c58edae4d546cae\" rel=\"nofollow noreferrer\">two stage compressor</a> that delays path compression a single depth. It keeps <code>print . until (null . subForest) (last . subForest)</code> from expanding all of the tree <code>runIdentity $ flip unfoldTreeMFix_BF 0 (\\x -&gt; return (x, if x &gt; 5 then [] else replicate 10 (x+1)))</code>. I&#39;m not sure if it solves all such expansion problems in general."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420593230, "post_id": 27752984, "comment_id": 44028770, "body": "<code>unfoldTree</code> actually completes the challenge very quickly, so I&#39;m not sure you&#39;re right about the &quot;general solution&quot; being as lazy, unless there&#39;s some other efficiency problem. It&#39;s beginning to sound like what I&#39;m after might really be impossible after all."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 15, "last_activity_date": 1420604475, "last_edit_date": 1495542801, "creation_date": 1420272881, "answer_id": 27752984, "question_id": 27748526, "link": "https://stackoverflow.com/questions/27748526/is-a-lazy-breadth-first-monadic-rose-tree-unfold-possible/27752984#27752984", "title": "Is a lazy, breadth-first monadic rose tree unfold possible?", "body": "<p><em>I previously claimed that the third solution presented below has the same strictness as the depth-first <code>unfoldForest</code>, which is not correct.</em></p>\n\n<p>Your intuition that trees can be lazily unfolded breadth first is at least partially correct, even if we don't require a <code>MonadFix</code> instance. Solutions exist for the special cases when the branching factor is known to be finite and when the branching factor is known to be \"large\". We will start with a solution that runs in <code>O(n)</code> time for trees with finite branching factors including degenerate trees with only one child per node. The solution for finite branching factors will fail to terminate on trees with infinite branching factors, which we will rectify with a solution that that runs in <code>O(n)</code> time for trees with \"large\" branching factors greater than one including trees with infinite branching factor. The solution for \"large\" branching factors will run in <code>O(n^2)</code> time on degenerate trees with only one child or no children per node. When we combine the methods from both steps in an attempt to make a hybrid solution that runs in <code>O(n)</code> time for any branching factor we will get a solution that is lazier than the first solution for finite branching factors but cannot accommodate trees that make a rapid transition from an infinite branching factor to having no branches.</p>\n\n<h3>Finite Branching Factor</h3>\n\n<p>The general idea is that we will first build all the labels for an entire level and the seeds for the forests for the next level. We will then descend into the next level, building all of it. We will collect together the results from the deeper level to build the forests for the outer level. We will put the labels together with the forests to build the trees.</p>\n\n<p><code>unfoldForestM_BF</code> is fairly simple. If there are no seeds for the level it returns. After building all the labels, it takes the seeds for each forest and collects them together into one list of all the seeds to build the next level and unfolds the entire deeper level. Finally it constructs the forest for each tree from the structure of the seeds.</p>\n\n<pre><code>import Data.Tree hiding (unfoldTreeM_BF, unfoldForestM_BF)\n\nunfoldForestM_BF :: Monad m =&gt; (b-&gt;m (a, [b])) -&gt; [b] -&gt; m [Tree a]\nunfoldForestM_BF f []    = return []\nunfoldForestM_BF f seeds = do\n    level &lt;- sequence . fmap f $ seeds\n    let (labels, bs) = unzip level\n    deeper &lt;- unfoldForestM_BF f (concat bs)\n    let forests = trace bs deeper\n    return $ zipWith Node labels forests\n</code></pre>\n\n<p><code>trace</code> reconstructs the structure of nested lists from a flattened list.It is assumed that there is an item in <code>[b]</code> for each of the items anywhere in <code>[[a]]</code>. The use of <code>concat</code> ... <code>trace</code> to flatten all the information about ancestor levels prevents this implementation from working on trees with infinite children for a node.</p>\n\n<pre><code>trace :: [[a]] -&gt; [b] -&gt; [[b]]\ntrace []       ys = []\ntrace (xs:xxs) ys =\n    let (ys', rem) = takeRemainder xs ys\n    in   ys':trace xxs rem\n    where\n        takeRemainder []        ys  = ([], ys)\n        takeRemainder (x:xs) (y:ys) = \n            let (  ys', rem) = takeRemainder xs ys\n            in  (y:ys', rem)\n</code></pre>\n\n<p>Unfolding a tree is trivial to write in terms of unfolding a forest.</p>\n\n<pre><code>unfoldTreeM_BF :: MonadFix m =&gt; (b-&gt;m (a, [b])) -&gt; b -&gt; m (Tree a)\nunfoldTreeM_BF f = (&gt;&gt;= return . head) . unfoldForestMFix_BF f . (:[])\n</code></pre>\n\n<h3>Large Branching Factor</h3>\n\n<p>The solution for large branching factor proceeds in much the same way as the solution for finite branching factor, except it keeps the entire structure of the tree around instead of <code>concat</code>enating the branches in a level to a single list and <code>trace</code>ing that list. In addition to the <code>import</code>s used in the previous section, we will be using <code>Compose</code> to compose the functors for multiple levels of a tree together and <code>Traversable</code> to <code>sequence</code> across multi-level structures.</p>\n\n<pre><code>import Data.Tree hiding (unfoldForestM_BF, unfoldTreeM_BF)\n\nimport Data.Foldable\nimport Data.Traversable\nimport Data.Functor.Compose\nimport Prelude hiding (sequence, foldr)\n</code></pre>\n\n<p>Instead of flattening all of the ancestor structures together with <code>concat</code> we will wrap with <code>Compose</code> the ancestors and the seeds for the next level and recurse on the entire structure.</p>\n\n<pre><code>unfoldForestM_BF :: (Traversable t, Traceable t, Monad m) =&gt;\n                    (b-&gt;m (a, [b])) -&gt; t b -&gt; m (t (Tree a))\nunfoldForestM_BF f seeds\n    | isEmpty seeds = return (fmap (const undefined) seeds)\n    | otherwise     = do\n        level &lt;- sequence . fmap f $ seeds\n        deeper &lt;- unfoldForestM_BF f (Compose (fmap snd level))\n        return $ zipWithIrrefutable Node (fmap fst level) (getCompose deeper)\n</code></pre>\n\n<p><code>zipWithIrrefutable</code> is a lazier version of <code>zipWith</code> that relies on the assumption that there is an item in the second list for each item in the first list. The <code>Traceable</code> structures are the <code>Functors</code> that can provide a <code>zipWithIrrefutable</code>. The laws for <code>Traceable</code> are for every <code>a</code>, <code>xs</code>, and <code>ys</code> if <code>fmap (const a) xs == fmap (const a) ys</code> then <code>zipWithIrrefutable (\\x _ -&gt; x) xs ys == xs</code> and <code>zipWithIrrefutable (\\_ y -&gt; y) xs ys == ys</code>. Its strictness is given for every <code>f</code> and <code>xs</code> by <code>zipWithIrrefutable f xs \u22a5 == fmap (\\x -&gt; f x \u22a5) xs</code>. </p>\n\n<pre><code>class Functor f =&gt; Traceable f where\n    zipWithIrrefutable :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c \n</code></pre>\n\n<p>We can combine two lists lazily if we already know they have the same structure.</p>\n\n<pre><code>instance Traceable [] where\n    zipWithIrrefutable f []       ys    = []\n    zipWithIrrefutable f (x:xs) ~(y:ys) = f x y : zipWithIrrefutable f xs ys \n</code></pre>\n\n<p>We can combine the composition of two functors if we know that we can combine each functor.</p>\n\n<pre><code>instance (Traceable f, Traceable g) =&gt; Traceable (Compose f g) where\n    zipWithIrrefutable f (Compose xs) (Compose ys) =\n        Compose (zipWithIrrefutable (zipWithIrrefutable f) xs ys)\n</code></pre>\n\n<p><code>isEmpty</code> checks for an empty structure of nodes to expand like the pattern match on <code>[]</code> did in the solution for finite branching factors.</p>\n\n<pre><code>isEmpty :: Foldable f =&gt; f a -&gt; Bool\nisEmpty = foldr (\\_ _ -&gt; False) True\n</code></pre>\n\n<p>The astute reader may notice that <code>zipWithIrrefutable</code> from <code>Traceable</code> is very similar to <code>liftA2</code> which is half of the definition of <code>Applicative</code>.</p>\n\n<h3>Hybrid Solution</h3>\n\n<p>The hybrid solution combines the approaches of the finite solution and the \"large\" solution. Like the finite solution, we will compress and decompress the tree representation at each step. Like the solution for \"large\" branching factors we will use a data structure that allows stepping over complete branches. The finite branching factor solution used a data type that is flattened everywhere, <code>[b]</code>. The \"large\" branching factor solution used a data type that was flattened nowhere: increasingly nested lists starting with <code>[b]</code> then <code>[[b]]</code> then <code>[[[b]]]</code> and so on. In between these structures would be nested lists that either stop nesting and just hold a <code>b</code> or keep nesting and hold <code>[b]</code>s. That pattern of recursion is described in general by the <code>Free</code> monad.</p>\n\n<pre><code>data Free f a = Pure a | Free (f (Free f a))\n</code></pre>\n\n<p>We will be working specifically with <code>Free []</code> which looks like.</p>\n\n<pre><code>data Free [] a = Pure a | Free [Free [] a]\n</code></pre>\n\n<p>For the hybrid solution we will repeat all of its imports and components so that the code below here should be complete working code.</p>\n\n<pre><code>import Data.Tree hiding (unfoldTreeM_BF, unfoldForestM_BF)\n\nimport Data.Traversable\nimport Prelude hiding (sequence, foldr)\n</code></pre>\n\n<p>Since we will be working with <code>Free []</code>, we will provide it with a <code>zipWithIrrefutable</code>.</p>\n\n<pre><code>class Functor f =&gt; Traceable f where\n    zipWithIrrefutable :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c  \n\ninstance Traceable [] where\n    zipWithIrrefutable f []       ys    = []\n    zipWithIrrefutable f (x:xs) ~(y:ys) = f x y : zipWithIrrefutable f xs ys \n\ninstance (Traceable f) =&gt; Traceable (Free f) where\n    zipWithIrrefutable f (Pure x)  ~(Pure y ) = Pure (f x y)\n    zipWithIrrefutable f (Free xs) ~(Free ys) =\n        Free (zipWithIrrefutable (zipWithIrrefutable f) xs ys)\n</code></pre>\n\n<p>The breadth first traversal will look very similar to the original version for the finitely branching tree. We build the current labels and seeds for the current level, compress the structure of the remainder of the tree, do all the work for the remaining depths, and decompress the structure of the results to get the forests to go with the labels.</p>\n\n<pre><code>unfoldFreeM_BF :: (Monad m) =&gt; (b-&gt;m (a, [b])) -&gt; Free [] b -&gt; m (Free [] (Tree a))\nunfoldFreeM_BF f (Free []) = return (Free [])\nunfoldFreeM_BF f seeds = do\n    level &lt;- sequence . fmap f $ seeds\n    let (compressed, decompress) = compress (fmap snd level)\n    deeper &lt;- unfoldFreeM_BF f compressed\n    let forests = decompress deeper\n    return $ zipWithIrrefutable Node (fmap fst level) forests\n</code></pre>\n\n<p><code>compress</code> takes a <code>Free []</code> holding the seeds for forests <code>[b]</code> and flattens the <code>[b]</code> into the <code>Free</code> to get a <code>Free [] b</code>. It also returns a <code>decompress</code> function that can be used to undo the flattening to get the original structure back. We compress away branches with no remaining seeds and branches that only branch one way.</p>\n\n<pre><code>compress :: Free [] [b] -&gt; (Free [] b, Free [] a -&gt; Free [] [a])\ncompress (Pure [x]) = (Pure x, \\(Pure x) -&gt; Pure [x])\ncompress (Pure xs ) = (Free (map Pure xs), \\(Free ps) -&gt; Pure (map getPure ps))\ncompress (Free xs)  = wrapList . compressList . map compress $ xs\n    where    \n        compressList []                 = ([], const [])\n        compressList ((Free [],dx):xs) = let (xs', dxs) = compressList xs\n                                         in  (xs', \\xs -&gt; dx (Free []):dxs xs)\n        compressList (      (x,dx):xs) = let (xs', dxs) = compressList xs\n                                         in  (x:xs', \\(x:xs) -&gt; dx x:dxs xs)\n        wrapList ([x], dxs) = (x,             \\x   -&gt; Free (dxs [x]))\n        wrapList (xs , dxs) = (Free xs, \\(Free xs) -&gt; Free (dxs xs ))\n</code></pre>\n\n<p>Each compression step also returns a function that will undo it when applied to a <code>Free []</code> tree with the same structure. All of these functions are partially defined; what they do to <code>Free []</code> trees with a different structure is undefined. For simplicity we also define partial functions for the inverses of <code>Pure</code> and <code>Free</code>.</p>\n\n<pre><code>getPure (Pure x)  = x\ngetFree (Free xs) = xs\n</code></pre>\n\n<p>Both <code>unfoldForestM_BF</code> and <code>unfoldTreeM_BF</code> are defined by packaging their argument up into a <code>Free [] b</code> and unpackaging the results assuming they are in the same structure.</p>\n\n<pre><code>unfoldTreeM_BF :: MonadFix m =&gt; (b-&gt;m (a, [b])) -&gt; b -&gt; m (Tree a)\nunfoldTreeM_BF f = (&gt;&gt;= return . getPure) . unfoldFreeM_BF f . Pure\n\n\nunfoldForestM_BF :: MonadFix m =&gt; (b-&gt;m (a, [b])) -&gt; [b] -&gt; m [Tree a]\nunfoldForestM_BF f = (&gt;&gt;= return . map getPure . getFree) . unfoldFreeM_BF f . Free . map Pure\n</code></pre>\n\n<p>A more elegant version of this algorithm can probably be made by recognizing that <code>&gt;&gt;=</code> for a <code>Monad</code> is grafting on trees and both <code>Free</code> and <code>FreeT</code> provide monad instances. Both <code>compress</code> and <code>compressList</code> probably have more elegant presentations.</p>\n\n<p>The algorithm presented above is not lazy enough to allow querying trees that branch an infinite number of ways and then terminate. A simple counter example is the following generating function unfolded from <code>0</code>.</p>\n\n<pre><code>counterExample :: Int -&gt; (Int, [Int])\ncounterExample 0 = (0, [1, 2])\ncounterExample 1 = (1, repeat 3)\ncounterExample 2 = (2, [3])\ncounterExample 3 = (3, [])\n</code></pre>\n\n<p>This tree would look like</p>\n\n<pre><code>0\n|\n+- 1\n|  |\n|  +- 3\n|  |\n|  `- 3\n|  |\n|  ...\n|\n`- 2\n   |\n   +- 3\n</code></pre>\n\n<p>Attempting to descend the second branch (to <code>2</code>) and inspect the remaining finite sub-tree will fail to terminate.</p>\n\n<h3>Examples</h3>\n\n<p>The following examples demonstrate that all implementations of <code>unfoldForestM_BF</code> run actions in breadth first order and that <code>runIdentity . unfoldTreeM_BF (Identity . f)</code> has the same strictness as <code>unfoldTree</code> for trees with finite branching factor. For trees with inifinite branching factor, only the solution for \"large\" branching factors has the same strictness as <code>unfoldTree</code>. To demonstrate laziness we'll define three infinite trees - a unary tree with one branch, a binary tree with two branches, and an infinitary tree with an infinite number of branches for each node.</p>\n\n<pre><code>mkUnary :: Int -&gt; (Int, [Int])\nmkUnary x = (x, [x+1])\n\nmkBinary :: Int -&gt; (Int, [Int])\nmkBinary x = (x, [x+1,x+2])\n\nmkInfinitary :: Int -&gt; (Int, [Int])\nmkInfinitary x = (x, [x+1..])\n</code></pre>\n\n<p>Together with <code>unfoldTree</code>, we will define <code>unfoldTreeDF</code> in terms of <code>unfoldTreeM</code> to check that <code>unfoldTreeM</code> really is lazy like you claimed and <code>unfoldTreeBF</code> in terms of <code>unfoldTreeMFix_BF</code> to check that the new implementation is just as lazy.</p>\n\n<pre><code>import Data.Functor.Identity\n\nunfoldTreeDF f = runIdentity . unfoldTreeM    (Identity . f)\nunfoldTreeBF f = runIdentity . unfoldTreeM_BF (Identity . f)\n</code></pre>\n\n<p>To get finite pieces of these infinite trees, even the infinitely branching one, we'll define a way to take from a tree as long as its labels match a predicate. This could be written more succinctly in terms of the ability to apply a function to every <code>subForest</code>.</p>\n\n<pre><code>takeWhileTree :: (a -&gt; Bool) -&gt; Tree a -&gt; Tree a\ntakeWhileTree p (Node label branches) = Node label (takeWhileForest p branches)\n\ntakeWhileForest :: (a -&gt; Bool) -&gt; [Tree a] -&gt; [Tree a]\ntakeWhileForest p = map (takeWhileTree p) . takeWhile (p . rootLabel)\n</code></pre>\n\n<p>This lets us define nine example trees.</p>\n\n<pre><code>unary   = takeWhileTree (&lt;= 3) (unfoldTree   mkUnary 0)\nunaryDF = takeWhileTree (&lt;= 3) (unfoldTreeDF mkUnary 0)\nunaryBF = takeWhileTree (&lt;= 3) (unfoldTreeBF mkUnary 0)\n\nbinary   = takeWhileTree (&lt;= 3) (unfoldTree   mkBinary 0)\nbinaryDF = takeWhileTree (&lt;= 3) (unfoldTreeDF mkBinary 0)\nbinaryBF = takeWhileTree (&lt;= 3) (unfoldTreeBF mkBinary 0)\n\ninfinitary   = takeWhileTree (&lt;= 3) (unfoldTree   mkInfinitary 0)\ninfinitaryDF = takeWhileTree (&lt;= 3) (unfoldTreeDF mkInfinitary 0)\ninfinitaryBF = takeWhileTree (&lt;= 3) (unfoldTreeBF mkInfinitary 0)\n</code></pre>\n\n<p>All five methods have the same output for the unary and binary trees. The output comes from <code>putStrLn . drawTree . fmap show</code></p>\n\n<pre><code>0\n|\n`- 1\n   |\n   `- 2\n      |\n      `- 3\n\n0\n|\n+- 1\n|  |\n|  +- 2\n|  |  |\n|  |  `- 3\n|  |\n|  `- 3\n|\n`- 2\n   |\n   `- 3\n</code></pre>\n\n<p>However, the breadth first traversal from the finite branching factor solution is not sufficiently lazy for a tree with an infinite branching factor. The other four methods output the entire tree</p>\n\n<pre><code>0\n|\n+- 1\n|  |\n|  +- 2\n|  |  |\n|  |  `- 3\n|  |\n|  `- 3\n|\n+- 2\n|  |\n|  `- 3\n|\n`- 3\n</code></pre>\n\n<p>The tree generated with <code>unfoldTreeBF</code> for the finite branching factor solution can never be completely drawn past its first branches.</p>\n\n<pre><code>0\n|\n+- 1\n|  |\n|  +- 2\n|  |  |\n|  |  `- 3\n|  |\n|  `- 3\n</code></pre>\n\n<p>The construction is definitely breadth first.</p>\n\n<pre><code>mkDepths :: Int -&gt; IO (Int, [Int])\nmkDepths d = do\n    print d\n    return (d, [d+1, d+1])\n\nmkFiltered :: (Monad m) =&gt; (b -&gt; Bool) -&gt; (b -&gt; m (a, [b])) -&gt; (b -&gt; m (a, [b]))\nmkFiltered p f x = do\n    (a, bs) &lt;- f x\n    return (a, filter p bs)\n\nbinaryDepths = unfoldTreeM_BF (mkFiltered (&lt;= 2) mkDepths) 0\n</code></pre>\n\n<p>Running <code>binaryDepths</code> outputs the outer levels before the inner ones</p>\n\n<pre><code>0\n1\n1\n2\n2\n2\n2\n</code></pre>\n\n<h3>From Lazy to Downright Slothful</h3>\n\n<p>The hybrid solution from the earlier section is not lazy enough to have the same strictness semantics as <code>Data.Tree</code>'s <code>unfoldTree</code>. It is the first in a series of algorithms, each slightly lazier than their predecessor, but none lazy enough to have the same strictness semantics as <code>unfoldTree</code>.</p>\n\n<p>The hybrid solution does not provide a guarantee that exploring a portion of a tree doesn't demand exploring other portions of the same tree. <strong>Nor will the code presented below</strong>. In one particular yet common case <a href=\"https://stackoverflow.com/questions/27748526/is-a-lazy-breadth-first-monadic-rose-tree-unfold-possible/27752984#comment43961729_27752984\">identified by dfeuer</a> exploring only a <code>log(N)</code> sized slice of a finite tree forces the entirety of the tree. This happens when exploring the last descendant of each branch of a tree with constant depth. When compressing the tree we throw out every trivial branch with no descendants, which is necessary to avoid <code>O(n^2)</code> running time. We can only lazily skip over this portion of compression if we can quickly show that a branch has at least one descendant and we can therefore reject the pattern <code>Free []</code>. At the greatest depth of the tree with constant depth, none of the branches have any remaining descendants, so we can never skip a step of the compression. This results in exploring the entire tree to be able to visit the very last node. When the entire tree to that depth is non-finite due to infinite branching factor, exploring a portion of the tree fails to terminate when it would terminate when generated by <code>unfoldTree</code>.</p>\n\n<p>The compression step in the hybrid solution section compresses away branches with no descendants in the first generation that they can be discovered in, which is optimal for compression but not optimal for laziness. We can make the algorithm lazier by delaying when this compression occurs. If we delay it by a single generation (or even any constant number of generations) we will maintain the <code>O(n)</code> upper bound on time. If we delay it by a number of generations that somehow depends on <code>N</code> we would necessarily sacrifice the <code>O(N)</code> time bound. In this section we will delay the compression by a single generation.</p>\n\n<p>To control how compression happens, we will separate stuffing the innermost <code>[]</code> into the <code>Free []</code> structure from compressing away degenerate branches with 0 or 1 descendants. </p>\n\n<p>Because part of this trick doesn't work without a lot of laziness in the compression, we will adopt a paranoid level of excessively slothful laziness everywhere. If anything about a result other than the tuple constructor <code>(,)</code> could be determined without forcing part of its input with a pattern match we will avoid forcing it until it is necessary. For tuples, anything pattern matching on them will do so lazily. Consequently, some of the code below will look like core or worse.</p>\n\n<p><code>bindFreeInvertible</code> replaces <code>Pure [b,...]</code> with <code>Free [Pure b,...]</code> </p>\n\n<pre><code>bindFreeInvertible :: Free [] ([] b) -&gt; (Free [] b, Free [] a -&gt; Free [] ([] a))\nbindFreeInvertible = wrapFree . go\n    where\n        -- wrapFree adds the {- Free -} that would have been added in both branches\n        wrapFree ~(xs, dxs) = (Free xs, dxs)\n        go (Pure xs) = ({- Free -} (map Pure xs), Pure . map getPure . getFree)\n        go (Free xs) = wrapList . rebuildList . map bindFreeInvertible $ xs\n        rebuildList = foldr k ([], const [])\n        k ~(x,dx) ~(xs, dxs) = (x:xs, \\(~(x:xs)) -&gt; dx x:dxs xs)\n        wrapList ~(xs, dxs) = ({- Free -} xs, \\(~(Free xs)) -&gt; Free (dxs xs)))\n</code></pre>\n\n<p><code>compressFreeList</code> removes occurrences of <code>Free []</code> and replaces <code>Free [xs]</code> with <code>xs</code>. </p>\n\n<pre><code>compressFreeList :: Free [] b -&gt; (Free [] b, Free [] a -&gt; Free [] a)\ncompressFreeList (Pure x) = (Pure x, id)\ncompressFreeList (Free xs) = wrapList . compressList . map compressFreeList $ xs\n    where\n        compressList = foldr k ([], const [])\n        k ~(x,dx) ~(xs', dxs) = (x', dxs')\n            where\n                x' = case x of\n                        Free []   -&gt; xs'\n                        otherwise -&gt; x:xs'\n                dxs' cxs = dx x'':dxs xs''\n                    where\n                        x'' = case x of\n                            Free []   -&gt; Free []\n                            otherwise -&gt; head cxs\n                        xs'' = case x of\n                            Free []   -&gt; cxs\n                            otherwise -&gt; tail cxs\n        wrapList ~(xs, dxs) = (xs', dxs')\n            where\n                xs' = case xs of\n                        [x]       -&gt; x\n                        otherwise -&gt; Free xs\n                dxs' cxs = Free (dxs xs'')\n                    where\n                        xs'' = case xs of\n                            [x]       -&gt; [cxs]\n                            otherwise -&gt; getFree cxs\n</code></pre>\n\n<p>The overall compression will not bind the <code>Pure []</code>s into <code>Free</code>s until after the degenerate <code>Free</code>s have been compressed away, delaying compression of degenerate <code>Free</code>s introduced in one generation to the next generation's compression.</p>\n\n<pre><code>compress :: Free [] [b] -&gt; (Free [] b, Free [] a -&gt; Free [] [a])\ncompress xs = let ~(xs' , dxs' ) = compressFreeList xs\n                  ~(xs'', dxs'') = bindFreeInvertible xs'\n                  in (xs'', dxs' . dxs'')\n</code></pre>\n\n<p>Out of continued paranoia, the helpers <code>getFree</code> and <code>getPure</code> are also made irrefutably lazy.</p>\n\n<pre><code>getFree ~(Free xs) = xs\ngetPure ~(Pure x)  = x\n</code></pre>\n\n<p>This very quickly solves the problematic example dfeuer discovered</p>\n\n<pre><code>print . until (null . subForest) (last . subForest) $\n    flip unfoldTreeBF 0 (\\x -&gt; (x, if x &gt; 5 then [] else replicate 10 (x+1)))\n</code></pre>\n\n<p>But since we only delayed the compression by <code>1</code> generation, we can recreate exactly the same problem if the very last node of the very last branch is <code>1</code> level deeper than all of the other branches.</p>\n\n<pre><code>print . until (null . subForest) (last . subForest) $\n    flip unfoldTreeBF (0,0) (\\(x,y) -&gt; ((x,y), \n        if x==y\n        then if x&gt;5 then [] else replicate 9 (x+1, y) ++ [(x+1, y+1)]\n        else if x&gt;4 then [] else replicate 10 (x+1, y)))\n</code></pre>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 8, "answer_count": 1, "score": 11, "last_activity_date": 1420604475, "creation_date": 1420232624, "last_edit_date": 1420397599, "question_id": 27748526, "link": "https://stackoverflow.com/questions/27748526/is-a-lazy-breadth-first-monadic-rose-tree-unfold-possible", "title": "Is a lazy, breadth-first monadic rose tree unfold possible?", "body": "<p><code>Data.Tree</code> includes <code>unfoldTreeM_BF</code> and <code>unfoldForestM_BF</code> functions to construct trees breadth-first using the results of monadic actions. The tree unfolder can be written easily using the forest unfolder, so I'll focus on the latter:</p>\n\n<pre><code>unfoldForestM_BF :: Monad m =&gt;\n             (b -&gt; m (a, [b])) -&gt; [b] -&gt; m [Tree a]\n</code></pre>\n\n<p>Starting with a list of seeds, it applies a function to each, generating actions that will produce the tree roots and the seeds for the next level of unfolding. The algorithm used is somewhat strict, so using <code>unfoldForestM_BF</code> with the <code>Identity</code> monad is not exactly the same as using the pure <code>unfoldForest</code>. I've been trying to figure out if there's a way to make it lazy without sacrificing its <code>O(n)</code> time bound. If (as Edward Kmett suggested to me) this is impossible, I wonder if it would be possible to do it with a more constrained type, specifically requiring <code>MonadFix</code> rather than <code>Monad</code>. The concept there would be to (somehow) set up the pointers to the results of future computations while adding those computations to the to-do list, so if they are lazy in the effects of earlier computations they will be available immediately.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 0, "last_activity_date": 1420377734, "creation_date": 1420377734, "answer_id": 27765931, "question_id": 27748274, "link": "https://stackoverflow.com/questions/27748274/calling-haskell-function-in-yesod-with-onclick/27765931#27765931", "title": "Calling Haskell function in Yesod with onclick", "body": "<p>Not directly the way you are describing. You can have <code>onclick</code> use some Javascript to make an AJAX call, which will trigger a handler function to be run.</p>\n"}], "owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 27765931, "answer_count": 1, "score": 1, "last_activity_date": 1420377734, "creation_date": 1420231204, "question_id": 27748274, "link": "https://stackoverflow.com/questions/27748274/calling-haskell-function-in-yesod-with-onclick", "title": "Calling Haskell function in Yesod with onclick", "body": "<p>Is there a possibility to call a Haskell function in Yesod with the \"onclick\" setting?</p>\n\n<p>The function I want to call:</p>\n\n<p><code>save_all :: WidgetT App IO[()]\nsave_all = mapM save_cur_answers (exam_questions exam_1)</code></p>\n\n<pre><code>save_cur_answers :: Question -&gt; WidgetT App IO()\nsave_cur_answers quest = do\nq_box1 &lt;- runInputPost $ ireq checkBoxField (answer_id ((answer_list quest) !! 0))\nq_box2 &lt;- runInputPost $ ireq checkBoxField (answer_id ((answer_list quest) !! 1))\nq_box3 &lt;- runInputPost $ ireq checkBoxField (answer_id ((answer_list quest) !! 2))\nq_box4 &lt;- runInputPost $ ireq checkBoxField (answer_id ((answer_list quest) !! 3))\n\nsetSession (question_id quest) $ bool_to_cookie [q_box1, q_box2, q_box3, q_box4]\n</code></pre>\n\n<p>in</p>\n\n<pre><code>&lt;input type=\"radio\" onclick=\"save_all\" name=\"tabs\" id=\"tab#{question_id quest}\"&gt;\n</code></pre>\n\n<p>I want to get the results of all checkboxes and save it in a cookie everytime I click on the radio button. The <code>save_cur_answers</code> looks up the checkboxes with the unique answer_id, returns the <code>Bool</code> value and stores all 4 of them.</p>\n"}, {"tags": ["haskell", "ffi"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1420227078, "post_id": 27747496, "comment_id": 43906051, "body": "My initial guess is that it isn&#39;t possible from Haskell since there is no <code>setArgs</code> function and <code>getArgs</code> returns an immutable list."}, {"owner": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420227245, "post_id": 27747496, "comment_id": 43906121, "body": "Thanks. I&#39;ve been pouring over the FFI code and came to the same conclusion, but since I&#39;m relatively new to this I didn&#39;t know if there was another way."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1420227368, "post_id": 27747496, "comment_id": 43906181, "body": "This is something I didn&#39;t even know was possible 5 minutes ago, so there might be a way, but if there is a way it&#39;ll involve some strange corner function in an internal library.  Look in the GHC specific libraries, since it&#39;d likely depend on which compiler you&#39;re using."}, {"owner": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420227480, "post_id": 27747496, "comment_id": 43906232, "body": "@bheklilr this is what I&#39;ve been doing. There are functions in <code>System.Environment</code> but they&#39;re not exported. I may end up re-writing some of them for this purpose, but wanted to check-in first. Thanks."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1420229355, "post_id": 27747496, "comment_id": 43906999, "body": "<a href=\"https://gist.github.com/ec78cc20e78479029812\" rel=\"nofollow noreferrer\">Try this</a>.  I&#39;m currently on windows so I don&#39;t think I can check it very accurately.  Cygwin&#39;s ps doesn&#39;t show command line arguments at all, but Process Monitor catches everything that the process does so it records the command line args before you have a chance to overwrite it.  Something along these lines might be what you&#39;re looking for."}, {"owner": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420230565, "post_id": 27747496, "comment_id": 43907480, "body": "@bheklilr hmm, I had something similar to this earlier and that didn&#39;t work, neither did yours :("}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1420235855, "post_id": 27747496, "comment_id": 43909405, "body": "If you&#39;re on a POSIX system you could 1) transfer all of the command line arguments to the environment, 2) <code>execve</code> yourself with no command line args and then 3) cleanse the environment; <code>execve</code> is available as <code>executeFile</code> in System.Posix.Process"}, {"owner": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1420239109, "post_id": 27747496, "comment_id": 43910424, "body": "@amalloy I don&#39;t think that&#39;s a duplicate. It&#39;s close, but it uses a <code>prctl</code> which, as far as I can tell, only lets you change the process name."}], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "edited": false, "score": 0, "creation_date": 1420233971, "post_id": 27748728, "comment_id": 43908760, "body": "This strategy doesn&#39;t seem to work. Try this code <a href=\"https://gist.github.com/bheklilr/ec78cc20e78479029812\" rel=\"nofollow noreferrer\">here</a>, which is very similar to the <code>getArgs</code> method in <code>System.Posix.Env.ByteString</code>. Maybe this is related to some lazy evaluation? Not sure."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "edited": false, "score": 0, "creation_date": 1420235199, "post_id": 27748728, "comment_id": 43909183, "body": "hmmm... even if you add <code>getArgs &gt;&gt;= print</code> at the end the original args are printed. wonder why that&#39;s happening."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1420233793, "creation_date": 1420233793, "answer_id": 27748728, "question_id": 27747496, "link": "https://stackoverflow.com/questions/27747496/access-original-argv-pointer-from-haskell/27748728#27748728", "title": "Access original argv pointer from Haskell", "body": "<p>I would look at the <code>System.Posix.Env.ByteString</code><a href=\"http://hackage.haskell.org/package/unix-2.7.1.0/docs/System-Posix-Env-ByteString.html#v:getArgs\" rel=\"nofollow\">(link)</a> module from the <code>unix</code> package.</p>\n\n<p>It contains functions to modify the environment and even though it only provides <code>getArgs</code> it shouldn't be difficult to add a <code>setArgs</code> function.</p>\n"}], "owner": {"reputation": 1383, "user_id": 1308975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9420c2ef938f4857bb9c921836b243d4?s=128&d=identicon&r=PG", "display_name": "aaronlevin", "link": "https://stackoverflow.com/users/1308975/aaronlevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "closed_date": 1420271422, "answer_count": 1, "score": 5, "last_activity_date": 1420437361, "creation_date": 1420226871, "last_edit_date": 1495541848, "question_id": 27747496, "link": "https://stackoverflow.com/questions/27747496/access-original-argv-pointer-from-haskell", "closed_reason": "Duplicate", "title": "Access original argv pointer from Haskell", "body": "<p>Is it possible to access the original <code>argv</code> pointer from within a Haskell <code>main</code>? </p>\n\n<p>My use case is that I'd like to remove command-line parameters after the application has started so they can't be read via <code>ps</code>. There are a few ways to do this but all require manipulating the original<code>argv</code>.</p>\n\n<p>I am able to do this if I write a C wrapper and call <code>hs_init</code> from there (afterwards mucking around with <code>argv</code> ala <a href=\"https://unix.stackexchange.com/questions/88665/how-does-ps-know-to-hide-passwords\">here</a>), but it'd be nicer to do this from Haskell.</p>\n\n<p>Thanks!</p>\n\n<p>PS - this question is different from the <a href=\"https://stackoverflow.com/questions/9503157/setting-argv0-in-haskell\">duplicate</a> as the duplicate uses a <code>prctl</code> which, as far as I can tell, only lets you change the process name. Further, the duplicate is looking to \"set\" <code>argv[0]</code> whereas I am trying to obtain a mutable reference to the original <code>argv</code> used to call the program.</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 0, "creation_date": 1420213460, "post_id": 27744558, "comment_id": 43900150, "body": "Can you share what have you tried with <code>do</code>? Because that&#39;s a correct way."}, {"owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "reply_to_user": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 0, "creation_date": 1420214193, "post_id": 27744558, "comment_id": 43900504, "body": "I know that works, what i want to happen is each iteration of this it prints the number. As it stands you call it and it just returns &quot;Number is 1&quot; instead of (The number you&#39;ve input) and then &quot;Number is 1&quot;"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1420217215, "post_id": 27744558, "comment_id": 43901882, "body": "There is no &quot;if statement&quot; in Haskell, because there are no statements, because everthing (each part of a program) is an expression."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1420213499, "creation_date": 1420213499, "answer_id": 27744657, "question_id": 27744558, "link": "https://stackoverflow.com/questions/27744558/haskell-doing-some-code-followed-by-an-if-statement-in-one-function/27744657#27744657", "title": "Haskell, doing some code followed by an if statement in one function", "body": "<p>You need to return an <code>IO ()</code> and you can use <code>do</code> notation e.g.</p>\n\n<pre><code>example :: Int -&gt; IO ()\nexample x = do\n  putStrLn $ \"Number is \" ++ (show x)\n  case x of\n    1 -&gt; return ()\n    _ -&gt; if (even x) then example (x-1) else example(x-2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420214479, "post_id": 27744670, "comment_id": 43900611, "body": "Thanks for your response bheklilr. The way it works at the moment it already displays &quot;Number is 1&quot; without me having to import IO String. Is there no way to add one line above the current code to allow it to print x each time instead of having to import ?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 1, "creation_date": 1420214695, "post_id": 27744670, "comment_id": 43900712, "body": "@Jordan Your function is returning the value <code>&quot;Number is 1&quot;</code>, and in GHCi that value will be printed out after evaluation.  If you type in <code>1 + 2</code>, GHCi will print <code>3</code>, but the function itself is not printing the value <code>3</code>, only returning it.  If you tried to make an executable using this function, it would not print out <code>&quot;Number is 1&quot;</code> without a <code>putStrLn</code> call somewhere.  If you want to print to the screen in Haskell, you have to use <code>IO</code>, there is no other way.  Alternatively you could return a list of strings that are later printed, but that is more complex and I doubt it is what you want."}, {"owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420214889, "post_id": 27744670, "comment_id": 43900808, "body": "Perfect, thank you very much for that. Sorry if it seemed a bit simple, but i&#39;d rather learn how something works than the answer just being given. Thanks again."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "edited": false, "score": 0, "creation_date": 1420215283, "post_id": 27744670, "comment_id": 43901001, "body": "@Jordan No question is too simple, but there can be bad questions.  You seem to be putting forth the effort to understand, all the pieces just haven&#39;t fallen into place yet.  Haskell can be pretty daunting at first, but it&#39;s worth the effort to learn.  The IO model is quite unique so it takes time to get used to, but it&#39;s rewarding once you understand it.  Just keep practicing and some day you&#39;ll be answering my questions on stackoverflow =)"}, {"owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "edited": false, "score": 0, "creation_date": 1420217291, "post_id": 27744670, "comment_id": 43901921, "body": "Strictly speaking I think saying that it needs a &quot;type signature/annotation&quot; indicating IO is untrue -- it needs such a type, right. :)"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "edited": false, "score": 1, "creation_date": 1420217595, "post_id": 27744670, "comment_id": 43902043, "body": "@Sarah Technically you don&#39;t have to provide a type signature for most functions in Haskell, the compiler can infer it instead.  Without a signature you can encounter strange behavior, for example this function could also work with <code>Integer</code> instead of <code>Int</code>, but <code>Integer</code> has different runtime behavior than <code>Int</code> does. The compiler would have defaulted to using <code>Integer</code> in this case (with a warning), so the type signature I used is different than what would be inferred. It&#39;s always preferable to give an explicit signature, so I pretend that it&#39;s required with the <code>-Wall -Werror</code> flags to GHC"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 1, "last_activity_date": 1420213983, "last_edit_date": 1420213983, "creation_date": 1420213562, "answer_id": 27744670, "question_id": 27744558, "link": "https://stackoverflow.com/questions/27744558/haskell-doing-some-code-followed-by-an-if-statement-in-one-function/27744670#27744670", "title": "Haskell, doing some code followed by an if statement in one function", "body": "<p>If you are going to print something to the screen, your function has to be an <code>IO</code> action, so to start with it needs a type signature indicating that.  Next, to perform a series of <code>IO</code> actions inside your function, you should use the <code>do</code> syntax, but this means to return a value from it you need to use the <code>return</code> function:</p>\n\n<pre><code>example :: Int -&gt; IO String\nexample x = do\n    putStrLn $ \"Calling: example \" ++ show x\n    if x == 1\n        then return \"Number is 1\"\n        else if even x\n            then example (x - 1)\n            else example (x - 2)\n</code></pre>\n\n<p>You don't need the <code>return</code> on <code>example (x - 1)</code> or <code>example (x - 2)</code> because the type of these expressions is <code>IO String</code>, it's already the type needed for the return value of this function.  However, <code>\"Number is 1\"</code> just has type <code>String</code>.  To turn it into <code>IO String</code>, you have to use the <code>return</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11618704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95106ab8ecd5235dacffc8fe0e338636?s=128&d=identicon&r=PG&f=1", "display_name": "anubhav", "link": "https://stackoverflow.com/users/11618704/anubhav"}, "is_accepted": false, "score": 0, "last_activity_date": 1560420905, "last_edit_date": 1560420905, "creation_date": 1560008076, "answer_id": 56507753, "question_id": 27744558, "link": "https://stackoverflow.com/questions/27744558/haskell-doing-some-code-followed-by-an-if-statement-in-one-function/56507753#56507753", "title": "Haskell, doing some code followed by an if statement in one function", "body": "<p>Have a look at the <code>trace</code> function. It does specifically what you are looking for. And the function's signature need not be changed.</p>\n\n<pre><code>import Debug.Trace\n\nexample x = trace (\"Called with \" ++ (show x)) $\n    if (x == 1) then \"Number is 1\" \n    else if (even x) then example (x - 1) \n    else example (x - 2) \n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Debug-Trace.html\" rel=\"nofollow noreferrer\">Documentation</a> for <code>trace</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 4215710, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d912a7b0b839f486293ab2befba28ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4215710/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 27744670, "answer_count": 3, "score": 0, "last_activity_date": 1560420905, "creation_date": 1420213032, "question_id": 27744558, "link": "https://stackoverflow.com/questions/27744558/haskell-doing-some-code-followed-by-an-if-statement-in-one-function", "title": "Haskell, doing some code followed by an if statement in one function", "body": "<p>I've been using haskell for roughly a week now and I don't seem to understand how to add a line of code above an if statement that will be executed each time the function is called. Below is the code I've put together for the purpose of this question:</p>\n\n<pre><code>let example x = \n    if (x == 1) then \"Number is 1\" \n    else if (even x) then example (x - 1) \n    else example (x - 2) \n</code></pre>\n\n<p>What I want to happen is for the number to be printed each time the function is called, so logic was telling me to find out how to add a line above the if statement to print [x]. I've looked into it heavily but haven't been able to find a solution. I looked into the \"Do\" but I couldn't seem to get it working. If anyone can shine some light on this area it would be much appreciated. </p>\n"}, {"tags": ["parsing", "haskell", "lambda"], "comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1420220261, "post_id": 27743531, "comment_id": 43903277, "body": "I&#39;d say it&#39;s a matter of taste."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1420239423, "post_id": 27743593, "comment_id": 43910497, "body": "It&#39;s not pointfree at all. In <code>\\y -&gt; ...</code>, the argument named <code>y</code> is the &quot;point&quot;. Just because it&#39;s not on the left side of the <code>=</code> doesn&#39;t make this definition point-free."}, {"owner": {"reputation": 6581, "user_id": 461202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f780ff5bfdfea60bdc260664f00b574?s=128&d=identicon&r=PG", "display_name": "zegkljan", "link": "https://stackoverflow.com/users/461202/zegkljan"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1420269062, "post_id": 27743593, "comment_id": 43916220, "body": "@amalloy You&#39;re probably right (I&#39;m editing my answer right now). But it&#39;s more pointfree than the direct definition, isn&#39;t it? :)"}], "tags": [], "owner": {"reputation": 6581, "user_id": 461202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f780ff5bfdfea60bdc260664f00b574?s=128&d=identicon&r=PG", "display_name": "zegkljan", "link": "https://stackoverflow.com/users/461202/zegkljan"}, "is_accepted": false, "score": 3, "last_activity_date": 1420269354, "last_edit_date": 1420269354, "creation_date": 1420208314, "answer_id": 27743593, "question_id": 27743531, "link": "https://stackoverflow.com/questions/27743531/why-use-lambda-instead-of-pattern-matching/27743593#27743593", "title": "Why use lambda instead of pattern matching?", "body": "<p>I think they are absolutely equal. The lambda-style definition puts a name <code>item</code> to an anonymous lambda function which does pattern matching inside. The pattern-matching-style definition defines it directly. But in the end both are functions that do pattern matching. I think it's a matter of personal taste.</p>\n\n<p><strike>Also, the lambda-style definition could be considered to be in <a href=\"https://www.haskell.org/haskellwiki/Pointfree\" rel=\"nofollow\">pointfree</a> style, i.e. a function defined without explicitly writing down its arguments</strike> actually it is not very much pointfree since the argument is still written (but in a different place), but in this case you don't get anything with this.</p>\n\n<p>Here is another possible definion, somewhere in between of those two:</p>\n\n<pre><code>item :: Parser Char\nitem inp = case inp of\n                [] -&gt; []\n                (x:xs) -&gt; [(x, xs)]\n</code></pre>\n\n<p>It's essentially identical to the lambda-style, but not pointfree.</p>\n"}, {"comments": [{"owner": {"reputation": 3518, "user_id": 1080523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608ae546674d9a64d4ec87aa465a7795?s=128&d=identicon&r=PG", "display_name": "rethab", "link": "https://stackoverflow.com/users/1080523/rethab"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1420209588, "post_id": 27743662, "comment_id": 43898457, "body": "@bheklilr i added a list"}], "tags": [], "owner": {"reputation": 3518, "user_id": 1080523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608ae546674d9a64d4ec87aa465a7795?s=128&d=identicon&r=PG", "display_name": "rethab", "link": "https://stackoverflow.com/users/1080523/rethab"}, "is_accepted": false, "score": 4, "last_activity_date": 1420209561, "last_edit_date": 1420209561, "creation_date": 1420208660, "answer_id": 27743662, "question_id": 27743531, "link": "https://stackoverflow.com/questions/27743531/why-use-lambda-instead-of-pattern-matching/27743662#27743662", "title": "Why use lambda instead of pattern matching?", "body": "<p>Why you should avoid equational function definitions (by Roman Cheplyaka):\n<a href=\"http://ro-che.info/articles/2014-05-09-clauses\" rel=\"nofollow\">http://ro-che.info/articles/2014-05-09-clauses</a></p>\n\n<p>Major Points from the above link:</p>\n\n<ul>\n<li>DRY: Function and argument names are repeated --> harder to refactor</li>\n<li>Clearer shows which arguments the function decides upon</li>\n<li>Easy to add pragmas (e.g. for profiling)</li>\n<li>Syntactically closer to lower level code</li>\n</ul>\n\n<p>This doesn't explain the lambda though..</p>\n"}, {"comments": [{"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 2, "creation_date": 1420210884, "post_id": 27744035, "comment_id": 43899042, "body": "I&#39;m in full agreement on the newtype thing. You&#39;re going to want your parser to be a Functor and Applicative at least, and so you&#39;ll need the newtype, so making it ready for that with minimal editing is a good thing."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 11, "last_activity_date": 1420210542, "creation_date": 1420210542, "answer_id": 27744035, "question_id": 27743531, "link": "https://stackoverflow.com/questions/27743531/why-use-lambda-instead-of-pattern-matching/27744035#27744035", "title": "Why use lambda instead of pattern matching?", "body": "<p>I believe this comes from the common practice of writing</p>\n\n<pre><code>f :: Type1 -&gt; ... -&gt; Typen -&gt; Result\nf x1 ... xn = someResult\n</code></pre>\n\n<p>where we have exactly <code>n</code> function arrows in the type, and exactly <code>n</code> arguments in the left hand side of the equation. This makes it easy to relate types and formal parameters.</p>\n\n<p>If <code>Result</code> is a type alias for a function, then we may write</p>\n\n<pre><code>f :: Type1 -&gt; ... -&gt; Typen -&gt; Result\nf x1 ... xn y = something\n</code></pre>\n\n<p>or</p>\n\n<pre><code>f :: Type1 -&gt; ... -&gt; Typen -&gt; Result\nf x1 ... xn = \\y -&gt; something\n</code></pre>\n\n<p>The latter follows the convention above: <code>n</code> arrows, <code>n</code> variables in the left hand side. Also, on the right hand side we have something of type <code>Result</code>, making it easier to spot. The former instead does not, and one might miss the extra argument when reading the code quickly.</p>\n\n<p>Further, this style makes it easy to convert <code>Result</code> to a newtype instead of a type alias:</p>\n\n<pre><code>newtype Result = R (... -&gt; ...)\n\nf :: Type1 -&gt; ... -&gt; Typen -&gt; Result\nf x1 ... xn = R $ \\y -&gt; something\n</code></pre>\n\n<p>The posted <code>item :: Parser Char</code> code is an instance of this style when <code>n=0</code>.</p>\n"}], "owner": {"reputation": 1001, "user_id": 867377, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b695266843a42e85ba91f1c6b7d645e?s=128&d=identicon&r=PG", "display_name": "toftis", "link": "https://stackoverflow.com/users/867377/toftis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 27744035, "answer_count": 3, "score": 5, "last_activity_date": 1420269354, "creation_date": 1420208076, "question_id": 27743531, "link": "https://stackoverflow.com/questions/27743531/why-use-lambda-instead-of-pattern-matching", "title": "Why use lambda instead of pattern matching?", "body": "<p>I am watching a tutorial on parsers in haskell <a href=\"https://www.youtube.com/watch?v=9FGThag0Fqs\">https://www.youtube.com/watch?v=9FGThag0Fqs</a>. The lecture starts with defining some really basic parsers. These are to be used together to create more complicated parsers later. One of the basic parsers is <em>item</em>. This is used to extract a character from the string we are parsing.</p>\n\n<p>All parsers have the following type:</p>\n\n<pre><code>type Parser a = String -&gt; [(a, String)]                                         \n</code></pre>\n\n<p>The parser <em>item</em> is defined like this:</p>\n\n<pre><code>item :: Parser Char                                                             \nitem = \\inp -&gt; case inp of                                                      \n                    [] -&gt; []                                                \n                    (x:xs) -&gt; [(x,xs)]\n</code></pre>\n\n<p>I am not so used to this syntax, so it looks strange to me. I would have written it:</p>\n\n<pre><code>item' :: Parser Char                                                            \nitem' [] = []                                                                   \nitem' (x:xs) = [(x,xs)]\n</code></pre>\n\n<p>Testing it in ghci indicates that they are equal:</p>\n\n<pre><code>*Main&gt; item \"\"\n[]\n*Main&gt; item \"abc\"\n[('a',\"bc\")]\n*Main&gt; item' \"\"\n[]\n*Main&gt; item' \"abc\"\n[('a',\"bc\")]\n</code></pre>\n\n<p>The lecturer makes a short comment about thinking it looks clearer, but I disagree. So my questions are:</p>\n\n<p>Are they indeed completely identical?\nWhy is the lambda version clearer? </p>\n"}, {"tags": ["haskell", "dependent-type"], "comments": [{"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 1, "creation_date": 1420208854, "post_id": 27743472, "comment_id": 43898158, "body": "Does this question apply? <a href=\"http://stackoverflow.com/questions/12442858/can-i-provide-the-type-checker-with-proofs-about-inductive-naturals-in-ghc-7-6\" title=\"can i provide the type checker with proofs about inductive naturals in ghc 7 6\">stackoverflow.com/questions/12442858/&hellip;</a>"}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "reply_to_user": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 0, "creation_date": 1420209085, "post_id": 27743472, "comment_id": 43898269, "body": "Up to a point Lord Copper. I couldn&#39;t get the solutions provided to work with the accumulating version of reverse."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 6, "creation_date": 1420211630, "post_id": 27743472, "comment_id": 43899338, "body": "The compiler&#39;s right that Add isn&#39;t injective. Your first equation shows that <code>Add Z (S Z) ~ S Z</code> but the first and second mean that <code>Add (S Z) Z ~ S (Add Z Z) ~ S Z</code>. In fact, if it&#39;s commutative it <i>can&#39;t</i> be injective."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1420214504, "post_id": 27743472, "comment_id": 43900622, "body": "What would you like to have as opposed to what you&#39;ve already done in your example? The <code>(+)</code> proofs must be written at some point in any case. Would you like to elide <code>gcast</code>-s, for example?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1420222842, "post_id": 27743472, "comment_id": 43904352, "body": "&quot;How do I tell the compiler that Add is really commutative&quot; Exactly the way you&#39;ve done. I would pattern match on Refl instead of using gcast, but that is just style. Even in a dependently typed language, with the same definitions of + and Nat, you will still have to write the proofs."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1420236583, "post_id": 27743472, "comment_id": 43909649, "body": "Building these proofs can indeed be quite painful. That&#39;s why Coq has a lot of tactics to help the user in such task."}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 0, "creation_date": 1420289157, "post_id": 27743472, "comment_id": 43920706, "body": "I appreciate all the comments. I will come back to this after I have thought some more. The question was prompted by my attempts to update a package which had, at some time in the past, had the ability to give a term a type without enforcing that it really was of that type (a restricted unsafecoerce). I don&#39;t think my intended approach is going to work but I am going to ask about this in another question."}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1420384905, "post_id": 27743472, "comment_id": 43944505, "body": "@Andr&#225;sKov&#225;cs: I would like to see what solution without gcast... looks like. As you can see from my edit, I find some of what is going on a bit terse."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1420903632, "post_id": 27743472, "comment_id": 44157100, "body": "<code>@</code> doesn&#39;t work in posts, so stackoverflow hasn&#39;t notified me about your edit. If you want to learn how unification works and how to write proofs, you should study Agda or Idris. It&#39;s <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">hasochism</a> to do such things in Haskell. Here is a complete solution to your problem: <a href=\"http://lpaste.net/118199\" rel=\"nofollow noreferrer\">lpaste.net/118199</a> It was directly translated from the solution in Agda."}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 0, "creation_date": 1420934597, "post_id": 27743472, "comment_id": 44166777, "body": "lol - I just wrote an implementation myself and then discovered your comment."}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 0, "creation_date": 1420935102, "post_id": 27743472, "comment_id": 44166904, "body": "I tried to read the hasochism paper but afaict it assumed I knew about dependently typed programming and here was how one might do it in Haskell. I&#39;d love to find time to study Agda or Idris."}], "answers": [{"comments": [{"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 0, "creation_date": 1420301660, "post_id": 27755512, "comment_id": 43924242, "body": "Thanks very much. I just installed Agda but get Failed to find source of module Function in any of the following locations:   /yarr/repairs/Function.agda   /yarr/repairs/Function.lagda   /Library/Haskell/ghc-7.8.3/lib/Agda-2.4.2.2/share/lib/prim/F&zwnj;&#8203;unction.agda   /Library/Haskell/ghc-7.8.3/lib/Agda-2.4.2.2/share/lib/prim/F&zwnj;&#8203;unction.lagda when scope checking the declaration   open import Function"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 1, "creation_date": 1420304365, "post_id": 27755512, "comment_id": 43925087, "body": "@idontgetoutmuch, <a href=\"https://github.com/agda/agda-stdlib\" rel=\"nofollow noreferrer\">the standard library</a> needs to be installed separately. You can find instructions <a href=\"http://wiki.portal.chalmers.se/agda/pmwiki.php?n=Libraries.StandardLibrary\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 0, "creation_date": 1420934842, "post_id": 27755512, "comment_id": 44166837, "body": "Also see user3237465&#39;s implementation:  lpaste.net/118199 and mine below."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 2, "last_activity_date": 1420298192, "last_edit_date": 1420298192, "creation_date": 1420292672, "answer_id": 27755512, "question_id": 27743472, "link": "https://stackoverflow.com/questions/27743472/how-to-convince-ghc-that-type-level-addition-is-commutative-to-implement-depend/27755512#27755512", "title": "How to convince ghc that type level addition is commutative (to implement dependently typed reverse)?", "body": "<p>You can simplify the definition of <code>reverse</code> a bit:</p>\n\n<pre><code>{-# LANGUAGE GADTs, KindSignatures, DataKinds    #-}\n{-# LANGUAGE TypeFamilies, UndecidableInstances  #-}\n{-# LANGUAGE TypeOperators                       #-}\n\ndata Nat = Z | S Nat\n\ndata Vec a n where\n    Nil   :: Vec a Z\n    (:::) :: a -&gt; Vec a n -&gt; Vec a (S n)\n\ntype family n :+ m where\n    Z   :+ m = m\n    S n :+ m = n :+ S m\n\nelim0 :: Vec a (n :+ Z) -&gt; Vec a n\nelim0 = undefined\n\naccrev :: Vec a n -&gt; Vec a n\naccrev = elim0 . go Nil where\n    go :: Vec a m -&gt; Vec a n -&gt; Vec a (n :+ m)\n    go acc  Nil       = acc\n    go acc (x ::: xs) = go (x ::: acc) xs\n</code></pre>\n\n<p>The <code>(:+)</code> operator is defined accordingly to the <code>(:::)</code> operator. Unification in the <code>(:::)</code> case proceeds as follows:</p>\n\n<p><code>x ::: xs</code> induces <code>n</code> to be <code>S n</code>. So the type of the result becomes <code>Vec a (S n :+ m)</code> or, after beta-reduction, <code>Vec a (n :+ S m)</code>. While</p>\n\n<pre><code>x ::: acc         :: Vec a (S m)\nxs                :: Vec a  n\ngo (x ::: acc) xs :: Vec a (n :+ S m)\n</code></pre>\n\n<p>So we have a match. However now you need to define <code>elim0 :: Vec a (n :+ Z) -&gt; Vec a n</code>, which requires both the proofs from your question.</p>\n\n<p>The whole code in Agda: <a href=\"http://lpaste.net/117679\" rel=\"nofollow\">http://lpaste.net/117679</a></p>\n\n<hr>\n\n<p>BTW, it's not true, that you would need proofs in any case. Here is how <code>reverse</code> defined in the Agda's standard library:</p>\n\n<pre><code>foldl : \u2200 {a b} {A : Set a} (B : \u2115 \u2192 Set b) {m} \u2192\n        (\u2200 {n} \u2192 B n \u2192 A \u2192 B (suc n)) \u2192\n        B zero \u2192\n        Vec A m \u2192 B m\nfoldl b _\u2295_ n []       = n\nfoldl b _\u2295_ n (x \u2237 xs) = foldl (\u03bb n \u2192 b (suc n)) _\u2295_ (n \u2295 x) xs\n\nreverse : \u2200 {a n} {A : Set a} \u2192 Vec A n \u2192 Vec A n\nreverse {A = A} = foldl (Vec A) (\u03bb rev x \u2192 x \u2237 rev) []\n</code></pre>\n\n<p>That's because <code>foldl</code> carries additional type information about the behavior of <code>_\u2295_</code>, so you satisfy the typechecker at each step and no proofs are needed.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1420935151, "post_id": 27882534, "comment_id": 44166920, "body": "I think you should accept your answer as the best, since your solution is much better and complete."}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1422176928, "post_id": 27882534, "comment_id": 44641807, "body": "I&#39;ve written a blog post summarising much of this: <a href=\"https://idontgetoutmuch.wordpress.com/2015/01/25/a-type-safe-reverse-or-some-hasochism/\" rel=\"nofollow noreferrer\">idontgetoutmuch.wordpress.com/2015/01/25/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "is_accepted": true, "score": 4, "last_activity_date": 1420934649, "creation_date": 1420934649, "answer_id": 27882534, "question_id": 27743472, "link": "https://stackoverflow.com/questions/27743472/how-to-convince-ghc-that-type-level-addition-is-commutative-to-implement-depend/27882534#27882534", "title": "How to convince ghc that type level addition is commutative (to implement dependently typed reverse)?", "body": "<pre><code>{-# LANGUAGE GADTs                #-}\n{-# LANGUAGE KindSignatures       #-}\n{-# LANGUAGE DataKinds            #-}\n{-# LANGUAGE TypeFamilies         #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE ExplicitForAll #-}\n\nimport Data.Type.Equality\n\ndata Nat = Z | S Nat\n\ntype family (n :: Nat) :+ (m :: Nat) :: Nat where\n    Z   :+ m = m\n    S n :+ m = n :+ S m\n\n-- Singleton for Nat\ndata SNat :: Nat -&gt; * where\n  SZero :: SNat Z\n  SSucc :: SNat n -&gt; SNat (S n)\n\nsucc_plus_id :: SNat n1 -&gt; SNat n2 -&gt; (((S n1) :+ n2) :~: (S (n1 :+ n2)))\nsucc_plus_id SZero _ = Refl\nsucc_plus_id (SSucc n) m = gcastWith (succ_plus_id n (SSucc m)) Refl\n\nplus_id_r :: SNat n -&gt; ((n :+ Z) :~: n)\nplus_id_r SZero = Refl\nplus_id_r (SSucc x) = gcastWith (plus_id_r x) (succ_plus_id x SZero)\n\ndata Vec a n where\n    Nil   :: Vec a Z\n    (:::) :: a -&gt; Vec a n -&gt; Vec a (S n)\n\nsize :: Vec a n -&gt; SNat n\nsize Nil         = SZero\nsize (_ ::: xs)  = SSucc $ size xs\n\nelim0 :: SNat n -&gt; (Vec a (n :+ Z) -&gt; Vec a n)\nelim0 n x = gcastWith (plus_id_r n) x\n\naccrev :: Vec a n -&gt; Vec a n\naccrev x = elim0 (size x) $ go Nil x where\n    go :: Vec a m -&gt; Vec a n -&gt; Vec a (n :+ m)\n    go acc  Nil       = acc\n    go acc (x ::: xs) = go (x ::: acc) xs\n\nsafeHead :: Vec a (S n) -&gt; a\nsafeHead (x ::: _) = x\n</code></pre>\n"}], "owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 2, "accepted_answer_id": 27882534, "answer_count": 2, "score": 4, "last_activity_date": 1420934649, "creation_date": 1420207780, "last_edit_date": 1420385417, "question_id": 27743472, "link": "https://stackoverflow.com/questions/27743472/how-to-convince-ghc-that-type-level-addition-is-commutative-to-implement-depend", "title": "How to convince ghc that type level addition is commutative (to implement dependently typed reverse)?", "body": "<p>This does not compile because as ghc tells me Add is not injective. How do I tell the compiler that Add is really commutative (maybe by telling it that Add is injective)? It seems from the hasochism paper that one has to provide a proxy somehow.</p>\n\n<pre><code>{-# LANGUAGE DataKinds             #-}\n{-# LANGUAGE TypeOperators         #-}\n{-# LANGUAGE KindSignatures        #-}\n{-# LANGUAGE GADTs                 #-}\n{-# LANGUAGE RankNTypes            #-}\n{-# LANGUAGE ScopedTypeVariables   #-}\n{-# LANGUAGE TypeFamilies          #-}\n{-# LANGUAGE UndecidableInstances  #-}\n\ndata Nat = Z | S Nat\n\ntype family Add a b where\n  Add  Z    n = n\n  Add  n    Z = n\n  Add (S n) k = S (Add n k)\n\ndata VecList n a where\n  Nil  :: VecList Z a\n  Cons :: a -&gt; VecList n a -&gt; VecList (S n) a\n\nsafeRev :: forall a n . VecList n a -&gt; VecList n a\nsafeRev xs = safeRevAux Nil xs\n  where\n    safeRevAux :: VecList p a -&gt; VecList q a -&gt; VecList (Add p q) a\n    safeRevAux acc Nil = acc\n    safeRevAux acc (Cons y ys) = safeRevAux (Cons y acc) ys\n</code></pre>\n\n<p>One can do this but it feels like too much is going on under the covers for my taste.</p>\n\n<pre><code>{-# LANGUAGE TypeOperators         #-}\n{-# LANGUAGE GADTs                 #-}\n{-# LANGUAGE RankNTypes            #-}\n{-# LANGUAGE ScopedTypeVariables   #-}\n{-# LANGUAGE TypeFamilies          #-}\n\nimport Data.Proxy\nimport Data.Type.Equality\n\ndata Nat = Z | S Nat\n\ntype family n1 + n2 where\n  Z + n2 = n2\n  (S n1) + n2 = S (n1 + n2)\n\n-- singleton for Nat\ndata SNat :: Nat -&gt; * where\n  SZero :: SNat Z\n  SSucc :: SNat n -&gt; SNat (S n)\n\n-- inductive proof of right-identity of +\nplus_id_r :: SNat n -&gt; ((n + Z) :~: n)\nplus_id_r SZero = Refl\nplus_id_r (SSucc n) = gcastWith (plus_id_r n) Refl\n\n-- inductive proof of simplification on the rhs of +\nplus_succ_r :: SNat n1 -&gt; Proxy n2 -&gt; ((n1 + (S n2)) :~: (S (n1 + n2)))\nplus_succ_r SZero _ = Refl\nplus_succ_r (SSucc n1) proxy_n2 = gcastWith (plus_succ_r n1 proxy_n2) Refl\n\ndata VecList n a where\n  V0  :: VecList Z a\n  Cons :: a -&gt; VecList n a -&gt; VecList (S n) a\n\nreverseList :: VecList n a -&gt; VecList n a\nreverseList V0 = V0\nreverseList list = go SZero V0 list\n  where\n    go :: SNat n1 -&gt; VecList n1  a-&gt; VecList n2 a -&gt; VecList (n1 + n2) a\n    go snat acc V0 = gcastWith (plus_id_r snat) acc\n    go snat acc (Cons h (t :: VecList n3 a)) =\n      gcastWith (plus_succ_r snat (Proxy :: Proxy n3))\n              (go (SSucc snat) (Cons h acc) t)\n\nsafeHead :: VecList (S n) a -&gt; a\nsafeHead (Cons x _) = x\n\ntest = safeHead $ reverseList (Cons 'a' (Cons 'b' V0))\n</code></pre>\n\n<p>See <a href=\"https://www.haskell.org/pipermail/haskell-cafe/2014-September/115919.html\" rel=\"nofollow\">https://www.haskell.org/pipermail/haskell-cafe/2014-September/115919.html</a> for the original idea.</p>\n\n<p>EDIT:</p>\n\n<p>@user3237465 This is very interesting and more what I had in mind\n(although on reflection my question was probably not very well\nformulated).</p>\n\n<p>It seems I have \"axioms\"</p>\n\n<pre><code>type family n1 :+ n2 where\n  Z :+ n2 = n2\n  (S n1) :+ n2 = S (n1 + n2)\n</code></pre>\n\n<p>and thus can produce proofs like</p>\n\n<pre><code>plus_id_r :: SNat n -&gt; ((n + Z) :~: n)\nplus_id_r SZero = Refl\nplus_id_r (SSucc n) = gcastWith (plus_id_r n) Refl\n</code></pre>\n\n<p>I find this quite terse. I would normally reason something like this</p>\n\n<ul>\n<li>In the last clause of the above we have SSucc n :: SNat (S k) so n ::  k</li>\n<li>We thus need to prove S k + Z :~: S k</li>\n<li>By the second \"axiom\" S k + Z = S (k + Z)</li>\n<li>We thus need to prove S (k + Z) :~: S k</li>\n<li>plus_id_r n gives a \"proof\" that (k + Z) :~: k</li>\n<li>and Refl gives a \"proof\" that m ~ n => S m :~: S n</li>\n<li>We can thus unify these proofs using gcastWith to give the desired\nresult.</li>\n</ul>\n\n<p>For your solution you give the \"axioms\"</p>\n\n<pre><code>type family n :+ m where\n    Z   :+ m = m\n    S n :+ m = n :+ S m\n</code></pre>\n\n<p>With these, the proof for (n + Z) :~: n will not work.</p>\n\n<ul>\n<li>In the last clause, we again have that SSucc x has type SNat (S k)</li>\n<li>We thus need to prove S k :+ Z :~: S k</li>\n<li>By the second new \"axiom\" we have S k + Z = k + S Z</li>\n<li>We thus need to prove k + S Z :~: S k</li>\n<li>So we have something more complex to prove :-(</li>\n</ul>\n\n<p>I can produce a proof for the original second \"axiom\" from the new\nsecond \"axiom\" (so my second \"axiom\" is now a lemma?).</p>\n\n<pre><code>succ_plus_id :: SNat n1 -&gt; SNat n2 -&gt; (((S n1) :+ n2) :~: (S (n1 :+ n2)))\nsucc_plus_id SZero _ = Refl\nsucc_plus_id (SSucc n) m = gcastWith (succ_plus_id n (SSucc m)) Refl\n</code></pre>\n\n<p>So now I should be able to get the original proofs to work but I am\nnot sure how currently.</p>\n\n<p>Is my reasoning correct thus far?</p>\n\n<p>PS: ghc agrees with my reasoning for why the proof of the existence of a right identity will not work</p>\n\n<pre><code>Could not deduce ((n1 :+ 'S 'Z) ~ 'S n1)\n...\nor from ((n1 :+ 'Z) ~ n1)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "pointfree"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1420207193, "post_id": 27743132, "comment_id": 43897454, "body": "There are many ways, <code>flip const undefined</code> or <code>head . return</code> and many others, but there&#39;s no point."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 16, "last_activity_date": 1420206481, "creation_date": 1420206481, "answer_id": 27743228, "question_id": 27743132, "link": "https://stackoverflow.com/questions/27743132/define-id-function-using-point-free-notation/27743228#27743228", "title": "define `id` function using point-free notation", "body": "<p>The pointfree version of <code>id</code> is... well, <code>id</code>. <code>id</code> is often taken as a fundamental operator in pointfree constructions, a sort of a primitive upon which more combinators are constructed.</p>\n\n<p>If you really want, you can reconstruct <code>id</code> from other more complex operators, e.g. exploiting the <code>Monad ((-&gt;) a)</code> instance:</p>\n\n<pre><code>id = join const\n</code></pre>\n\n<p>or the <code>Applicative ((-&gt;) a)</code> instance</p>\n\n<pre><code>id = const &lt;*&gt; const\n</code></pre>\n\n<p>(in combinatory logic, this is <code>I = S K K</code> since <code>&lt;*&gt;</code> is <code>S</code> and <code>const</code> is <code>K</code>)</p>\n\n<p>Nothing can be simpler than <code>id</code> itself, though.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1420213043, "creation_date": 1420213043, "answer_id": 27744559, "question_id": 27743132, "link": "https://stackoverflow.com/questions/27743132/define-id-function-using-point-free-notation/27744559#27744559", "title": "define `id` function using point-free notation", "body": "<p>This question is an interesting one, because <code>id</code> is essentially the identity of any mathematical group of functions under composition. To put it simply, when you get two opposite functions and  compose them, you get <code>id</code>.</p>\n\n<p>So, any of these will work polymorphically and in the same way, though naturally slower:</p>\n\n<pre><code>id :: a -&gt; a\n----------------------------\nid = snd . (0,)\nid = fst . (,0)\nid = (!! 0) . return\nid = ($ 0) . const\nid = (\\(Just n) -&gt; n) . Just\n</code></pre>\n\n<p>Or, we could write it in a simple lambda expression, which is good practice and very simple:</p>\n\n<pre><code>id = \\a -&gt; a\n</code></pre>\n\n<p>All of these are in points-free style, which should be satisfactory for your question, but it's not just points-free, but quite point-less. All these solutions may seem very valid, and they are, but they're <em>not</em> equivalent to <code>id</code>. These solutions, not including the last one, build and deconstruct datastructures which are expensive in performance. Points-free style may be good practice, but not everywhere.</p>\n"}], "owner": {"reputation": 568, "user_id": 265374, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70e5083d48892b749889c4bcbf8a5766?s=128&d=identicon&r=PG", "display_name": "reddot", "link": "https://stackoverflow.com/users/265374/reddot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 27743228, "answer_count": 2, "score": 3, "last_activity_date": 1420213043, "creation_date": 1420206024, "question_id": 27743132, "link": "https://stackoverflow.com/questions/27743132/define-id-function-using-point-free-notation", "title": "define `id` function using point-free notation", "body": "<p>In Haskell language function <code>id</code> defined to be unit of composition:</p>\n\n<pre><code>id :: a -&gt; a\nid x = x\n</code></pre>\n\n<p>Is there a way to define haskell' <code>id</code> function using point-free notation?\nI mean not to directly referencing it like:</p>\n\n<pre><code>same :: a -&gt; a\nsame = id\n</code></pre>\n"}, {"tags": ["html", "haskell", "pandoc", "blaze-html"], "owner": {"reputation": 135, "user_id": 3585010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a243ced53e90238cb1451c9f22c00d40?s=128&d=identicon&r=PG&f=1", "display_name": "user3585010", "link": "https://stackoverflow.com/users/3585010/user3585010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420204491, "creation_date": 1420204491, "question_id": 27742851, "link": "https://stackoverflow.com/questions/27742851/parse-html-to-text-blaze-html", "title": "Parse html to Text.Blaze.Html", "body": "<p>I'm trying to parse an html file to the Text.Blaze.Html type using Text.Pandoc.\nThe html I'll be attempting to parse is:</p>\n\n<pre><code>&lt;head&gt;\n\n &lt;style type=\"text/css\"&gt;table.sourceCode {\n margin: 0; padding: 0; vertical-align: baseline; border: none; }\n table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }\n &lt;/style&gt;\n\n &lt;title&gt;Using Yesod&lt;/title&gt;\n\n &lt;/head&gt;\n\n &lt;body&gt;\n   &lt;h1&gt;Intial Commit&lt;/h1&gt;\n   &lt;br&gt;\n &lt;/body&gt;\n</code></pre>\n\n<p>The code I use is:</p>\n\n<pre><code>writeHtml def {writerHtml5 = True } . readHtml def $ inp\n</code></pre>\n\n<p>This strips the header tags off and yields only the body giving:</p>\n\n<pre><code>Main &gt; renderHtml $ writeHtml def &gt; {writerHtml5 = True } . readHtml def $ inp\n\"&lt;h1&gt;Intial Commit&lt;/h1&gt;\\n&lt;p&gt;&lt;br /&gt;&lt;/p&gt;\"\n</code></pre>\n\n<p>I understand the header content is stored as meta-data, but I want to know where the rest of the Header content (the style information goes in this case) goes.</p>\n\n<pre><code>Main &gt; readHtml def ht\nPandoc (Meta {unMeta = fromList [(\"title\",MetaInlines [Str \"Using\",Space,Str   \"Yesod\"])]}) &gt; [Header 1 (\"\",[],[]) [Str \"Intial\",Space,Str \"Commit\"],Para [LineBreak]]\n</code></pre>\n"}, {"tags": ["haskell", "package-managers", "nixos"], "comments": [{"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 1, "creation_date": 1420214556, "post_id": 27742846, "comment_id": 43900648, "body": "How does your application normally find it&#39;s files? Do you use the _Paths module produced by cabal?"}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1420238892, "post_id": 27742846, "comment_id": 43910356, "body": "@bennofs The directories <code>config</code> and <code>static</code> are in the root of the project. So when I run <code>cabal run</code> in the project root the files are looked up relatively. See my edit for more information."}], "answers": [{"comments": [{"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "edited": false, "score": 0, "creation_date": 1420244995, "post_id": 27743554, "comment_id": 43912023, "body": "I just found out that enabling <code>isExecutable</code> in <code>cabal.mkDerivation</code> fixed this automatically."}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "edited": false, "score": 0, "creation_date": 1420245219, "post_id": 27743554, "comment_id": 43912072, "body": "Any idea how to fix lookup of data files used by the application? Right now they exist in <code>$out&#47;share&#47;x86_64-linux-ghc-7.8.3&#47;myproject-0.0.1&#47;</code>. Can&#39;t seem to find any examples of other applications in nixpkgs that does this."}], "tags": [], "owner": {"reputation": 1880, "user_id": 471622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1384132ace283798b6e1294f31ac62?s=128&d=identicon&r=PG", "display_name": "lethalman", "link": "https://stackoverflow.com/users/471622/lethalman"}, "is_accepted": false, "score": 2, "last_activity_date": 1420208190, "creation_date": 1420208190, "answer_id": 27743554, "question_id": 27742846, "link": "https://stackoverflow.com/questions/27742846/nix-derivation-does-not-include-cabal-data-files-when-running-haskell-applicatio/27743554#27743554", "title": "Nix derivation does not include cabal data-files when running Haskell application", "body": "<p>Installing it would have the same problem. Wrap your binary with makeWrapper and set the necessary environment variables.</p>\n"}, {"tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 2, "last_activity_date": 1425168938, "creation_date": 1425168938, "answer_id": 28788566, "question_id": 27742846, "link": "https://stackoverflow.com/questions/27742846/nix-derivation-does-not-include-cabal-data-files-when-running-haskell-applicatio/28788566#28788566", "title": "Nix derivation does not include cabal data-files when running Haskell application", "body": "<p>The correct solution here is not to fix the nix expression. Instead, you should extend your application such that it uses <code>getDataFileName</code> which is provided by the cabal-generated Paths module to find it's files (you could use it as a fallback).</p>\n\n<p>For more information about this see: <a href=\"http://neilmitchell.blogspot.de/2008/02/adding-data-files-using-cabal.html\" rel=\"nofollow\">http://neilmitchell.blogspot.de/2008/02/adding-data-files-using-cabal.html</a></p>\n"}], "owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 1, "accepted_answer_id": 28788566, "answer_count": 2, "score": 3, "last_activity_date": 1589450240, "creation_date": 1420204469, "last_edit_date": 1589450240, "question_id": 27742846, "link": "https://stackoverflow.com/questions/27742846/nix-derivation-does-not-include-cabal-data-files-when-running-haskell-applicatio", "title": "Nix derivation does not include cabal data-files when running Haskell application", "body": "<p>I have a haskell project that uses <code>cabal.mkDerivation</code> to make a Nix derivation. </p>\n\n<p>When I run <code>nix-build</code> in the project root I get the expected <code>result</code> symlink after the build is successful. </p>\n\n<p>If I enter that directory I have 4 directories:</p>\n\n<ul>\n<li>bin</li>\n<li>lib</li>\n<li>nix-support</li>\n<li>share</li>\n</ul>\n\n<p>Where my executable exists inside <code>bin</code>. When I try to run my executable it cannot find my application files nor the dynamic libraries. I understand that this is due to to missing environment variables that set up all the paths of the package. </p>\n\n<p><strong>How can I run the executable of my package with the right environment variables without installing it?</strong></p>\n\n<p>I'm aware that I can use <code>nix-shell</code> to use <code>cabal run</code> to run the executable, but I want to run the executable in the deployed state. </p>\n\n<h2>Edit #1: More information</h2>\n\n<p>Here is my <code>default.nix</code> in my project:</p>\n\n<pre><code>{ haskellPackages ? (import &lt;nixpkgs&gt; {}).haskellPackages_ghc783_no_profiling }:\n\nlet\n  inherit (haskellPackages)\n    blazeHtml\n    ... list of deps\n    ;\nin\n  cabal.mkDerivation (self: {\n    pname           = \"myproject\";\n    version         = \"0.0.1\";\n    src             = ./;\n    enableSplitObjs = false;\n\n    buildTools = [\n      yesodBin\n      cabalInstall\n    ];\n\n    buildDepends = [\n      blazeHtml\n      ... list of deps\n    ];\n})\n</code></pre>\n\n<p>Here is the relevant part of my cabal-file which contains the list of data files used by the application:</p>\n\n<pre><code>data-files: config/favicon.ico\n          , config/robots.txt\n          , config/settings.yml\n          , static/css/*.css\n          , static/fonts/*.eot\n          , static/fonts/*.svg\n          , static/fonts/*.ttf\n          , static/fonts/*.woff\n          , static/img/*.jpg\n</code></pre>\n\n<p>When the application is deployed by using <code>cabal install</code> the structure would be:</p>\n\n<pre><code>  myproject\n\u25be config\n    favicon.ico\n    robots.txt\n    settings.yml \n\u25be static\n    \u25b8 css\n    \u25b8 fonts\n    \u25b8 img\n</code></pre>\n\n<p>The executable finds all files relatively to the current working directory.</p>\n"}, {"tags": ["haskell", "desktop", "xmonad"], "comments": [{"owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "reply_to_user": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1420207734, "post_id": 27742421, "comment_id": 43897662, "body": "@AndrewC: No it&#39;s not generated from the strings. I can say &quot;foo&quot; instead of &quot;1&quot; and that will only influence what is displayed as the name of the workspace. Note that I use Unicode characters to depict what some of the workspaces are dedicated for."}], "answers": [{"tags": [], "owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "is_accepted": false, "score": 1, "last_activity_date": 1420208872, "creation_date": 1420208872, "answer_id": 27743705, "question_id": 27742421, "link": "https://stackoverflow.com/questions/27742421/how-can-i-have-more-than-9-workspaces-in-xmonad/27743705#27743705", "title": "How can I have more than 9 workspaces in xmonad?", "body": "<pre><code>-- | The default number of workspaces (virtual screens) and their names.\n-- By default we use numeric strings, but any string may be used as a\n-- workspace name. The number of workspaces is determined by the length\n-- of this list.\n--\n-- A tagging example:\n--\n-- &gt; workspaces = [\"web\", \"irc\", \"code\" ] ++ map show [4..9]\n--\nworkspaces :: [WorkspaceId]\nworkspaces = map show [1 .. 9 :: Int]\n</code></pre>\n\n<p>Modify the length of the list in Config.hs</p>\n"}, {"comments": [{"owner": {"reputation": 5812, "user_id": 478206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85cacece5b347853dc35d97371b9e0c?s=128&d=identicon&r=PG", "display_name": "Robie Basak", "link": "https://stackoverflow.com/users/478206/robie-basak"}, "edited": false, "score": 1, "creation_date": 1458695481, "post_id": 27743913, "comment_id": 59973405, "body": "Thanks! To make your examples work, I also needed <code>import qualified XMonad.StackSet as W</code> and had to replace both occurrences of <code>myModMask</code> to <code>modm</code>. I&#39;m not sure where <code>modm</code> is defined but it matched the pattern used in other key bindings."}], "tags": [], "owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "is_accepted": true, "score": 13, "last_activity_date": 1420210628, "last_edit_date": 1420210628, "creation_date": 1420209853, "answer_id": 27743913, "question_id": 27742421, "link": "https://stackoverflow.com/questions/27742421/how-can-i-have-more-than-9-workspaces-in-xmonad/27743913#27743913", "title": "How can I have more than 9 workspaces in xmonad?", "body": "<p>I found the answer buried in <a href=\"https://www.haskell.org/haskellwiki/Xmonad/Config_archive/Thomas_ten_Cate&#39;s_xmonad.hs\" rel=\"noreferrer\">this example configuration</a> and together with the <a href=\"http://xmonad.org/xmonad-docs/xmonad/doc-index-X.html\" rel=\"noreferrer\">key names list</a>, it looks like the following:</p>\n\n<p>Defining a tenth workspace:</p>\n\n<pre><code>myExtraWorkspaces = [(xK_0, \"0\"),(xK_minus, \"tmp\"),(xK_equal, \"swap\")]\n\nmyWorkspaces = [\"1\",\"2\",\"3\u2302\",\"4\",\"5\",\"6\",\"7\u2709\",\"8\u263a\",\"9\u266b\"] ++ (map snd myExtraWorkspaces)\n</code></pre>\n\n<p>Then the key binding looks like this:</p>\n\n<pre><code>myKeys = \n      [ -- ... some more keys ...\n      ] ++ [\n        ((myModMask, key), (windows $ W.greedyView ws))\n        | (key,ws) &lt;- myExtraWorkspaces\n      ] ++ [\n        ((myModMask .|. shiftMask, key), (windows $ W.shift ws))\n        | (key,ws) &lt;- myExtraWorkspaces\n      ]\n</code></pre>\n\n<p>In this example the slash key is used, but any other key from the list above can be used instead.</p>\n\n<p>And finally:</p>\n\n<pre><code>main = do\n xmonad $ config {\n           workspaces = myWorkspaces\n        } `additionalKeys` (myKeys)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1052, "user_id": 371334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d62591847a676f5ea4a871379a68fee6?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/371334/andrew"}, "is_accepted": false, "score": 1, "last_activity_date": 1525446331, "creation_date": 1525446331, "answer_id": 50177979, "question_id": 27742421, "link": "https://stackoverflow.com/questions/27742421/how-can-i-have-more-than-9-workspaces-in-xmonad/50177979#50177979", "title": "How can I have more than 9 workspaces in xmonad?", "body": "<p>Another way is <a href=\"http://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Actions-DynamicWorkspaces.html\" rel=\"nofollow noreferrer\">dynamic workspaces</a>.\nAdd</p>\n\n<pre><code>import XMonad.Actions.DynamicWorkspaces\nimport XMonad.Actions.CopyWindow(copy)\n</code></pre>\n\n<p>to your <code>xmonad.hs</code> file and add</p>\n\n<pre><code>, ((modm, xK_v), selectWorkspace myXPConfig)\n</code></pre>\n\n<p>to the keybindings in that file.\nThen pressing mod+v lets you switch to a workspace by name or create it if it doesn't exist.</p>\n"}], "owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3034, "favorite_count": 1, "accepted_answer_id": 27743913, "answer_count": 3, "score": 13, "last_activity_date": 1525446331, "creation_date": 1420202506, "question_id": 27742421, "link": "https://stackoverflow.com/questions/27742421/how-can-i-have-more-than-9-workspaces-in-xmonad", "title": "How can I have more than 9 workspaces in xmonad?", "body": "<p>I can change the names of workspaces, and presumably simply add more by changing this conststant:</p>\n\n<pre><code>myWorkspaces = [\"1\",\"2\",\"3\u2302\",\"4\",\"5\",\"6\",\"7\u2709\",\"8\u263a\",\"9\u266b\"]\n</code></pre>\n\n<p>If I add something to the array, there will be more workspaces, but how do I keybind them? Mod-1 through Mod-9 are the default but I can't find documentation for how to change that default.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1420198635, "post_id": 27741542, "comment_id": 43893945, "body": "How/where do these functions get applied to the variable?"}, {"owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "edited": false, "score": 1, "creation_date": 1420200352, "post_id": 27741542, "comment_id": 43894686, "body": "Regarding your edit, can you give us the code in more context?"}], "answers": [{"tags": [], "owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "is_accepted": false, "score": 6, "last_activity_date": 1420198971, "creation_date": 1420198971, "answer_id": 27741638, "question_id": 27741542, "link": "https://stackoverflow.com/questions/27741542/extracting-list-of-functions-into-a-standalone-function-in-haskell/27741638#27741638", "title": "Extracting list of functions into a standalone function in Haskell", "body": "<p>What you're looking for is the function composition operator, <code>.</code>. This works as follows:</p>\n\n<pre><code>(f . g) x = f (g x) = f $ g x\n</code></pre>\n\n<p>Therefore, <code>fun = fun1 . fun2 . fun3</code> is what you're looking for.</p>\n"}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1420201218, "creation_date": 1420198561, "last_edit_date": 1420201218, "question_id": 27741542, "link": "https://stackoverflow.com/questions/27741542/extracting-list-of-functions-into-a-standalone-function-in-haskell", "title": "Extracting list of functions into a standalone function in Haskell", "body": "<p>I have a pipe of functions <code>fun1 $ fun2 $ fun3</code> applied to a variable <code>var</code> as <code>fun1 $ fun2 $ fun3 var</code>. How could I extract this pipe <code>fun1 $ fun2 $ fun3</code> into standalone function <code>fun = (fun1 $ fun2 $ fun3)</code> that can be appllied to a <code>var</code> as <code>fun var</code>?</p>\n\n<p>For example, I have a following pipe of functions: <code>BS.unpack $ JSON.encode var</code>. I want to extract <code>BS.unpack $ JSON.encode</code> from the statement <code>BS.unpack $ JSON.encode var</code> into <code>let fun = BS.unpack . JSON.encode</code>, but I get an error:</p>\n\n<pre><code>No instance for (JSON.ToJSON a0)\n  arising from a use of `JSON.encode'\nThe type variable `a0' is ambiguous\n</code></pre>\n\n<p>What is wrong with my function extraction?</p>\n"}, {"tags": ["multithreading", "haskell", "concurrency"], "comments": [{"owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "edited": false, "score": 0, "creation_date": 1420198634, "post_id": 27741439, "comment_id": 43893944, "body": "Your <code>main</code> is sequential. Don&#39;t you need to fork threads for the jobs somewhere?"}, {"owner": {"reputation": 345, "user_id": 3996781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ebc9d5cf8ef442da813c0076fc2b17f8?s=128&d=identicon&r=PG&f=1", "display_name": "Ammlan Ghosh", "link": "https://stackoverflow.com/users/3996781/ammlan-ghosh"}, "reply_to_user": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "edited": false, "score": 0, "creation_date": 1420198861, "post_id": 27741439, "comment_id": 43894052, "body": "@DonStewart, I couldn&#39;t understand. Please elaborate. Thanks."}, {"owner": {"reputation": 345, "user_id": 3996781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ebc9d5cf8ef442da813c0076fc2b17f8?s=128&d=identicon&r=PG&f=1", "display_name": "Ammlan Ghosh", "link": "https://stackoverflow.com/users/3996781/ammlan-ghosh"}, "reply_to_user": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "edited": false, "score": 0, "creation_date": 1420199327, "post_id": 27741439, "comment_id": 43894246, "body": "@DonStewart, I have updated the code [forkIO()], but getting same result."}], "answers": [{"tags": [], "owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "is_accepted": true, "score": 2, "last_activity_date": 1420199333, "creation_date": 1420199333, "answer_id": 27741714, "question_id": 27741439, "link": "https://stackoverflow.com/questions/27741439/haskell-mvar-how-to-execute-shortest-job-first/27741714#27741714", "title": "Haskell MVar : How to execute shortest job first?", "body": "<p>To implement scheduling you need to use MVars and threads together. Start with an empty MVar. Fork the jobs you wish to run in the background. The main thread can then block on each result in turn. The fastest will come first. Like so:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nimport Control.Parallel\nimport Control.Concurrent\n\nimport System.IO\n\nnfib :: Int -&gt; Int\nnfib n | n &lt;= 2     = 1\n       | otherwise  = par n1 (pseq n2 (n1 + n2 ))\n                 where n1 = nfib (n-1)\n                       n2 = nfib (n-2)\n\nmain :: IO ()\nmain = do\n    result &lt;- newEmptyMVar\n\n    forkIO $ do\n        let !x = nfib 40\n        putMVar result x\n    forkIO $ do\n        let !x = nfib 30\n        putMVar result x\n\n    t      &lt;- takeMVar result\n    print $ \"Fastest result was: \" ++ show t\n    t      &lt;- takeMVar result\n    print $ \"Slowest result was: \" ++ show t\n</code></pre>\n\n<p>Note that it is important to use bang patterns to evaluate the fibonacci calls outside of the MVar (don't want to simply return an unevaluated thunk to the main thread). </p>\n\n<p>Compile with the threaded runtime:</p>\n\n<pre><code>$ ghc -o A --make A.hs -threaded  -fforce-recomp -rtsopts\n[1 of 1] Compiling Main             ( A.hs, A.o )\nLinking A.exe ...\n</code></pre>\n\n<p>And run on two cores:</p>\n\n<pre><code>$ ./A.exe  +RTS -N2\n\"Fastest result was: 832040\"\n\"Slowest result was: 102334155\"\n</code></pre>\n\n<p>Productivity is pretty good as well (use +RTS -s to see runtime performance statistics).</p>\n\n<pre><code>Productivity  89.3% of total user, 178.1% of total elapsed\n</code></pre>\n\n<p>The first thread to finish will have its result printed first. The main thread will then block until the second thread is done.</p>\n\n<p>The main thing is to take advantage of MVar empty/full semantics to block the main thread on each of the children threads.</p>\n"}], "owner": {"reputation": 345, "user_id": 3996781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ebc9d5cf8ef442da813c0076fc2b17f8?s=128&d=identicon&r=PG&f=1", "display_name": "Ammlan Ghosh", "link": "https://stackoverflow.com/users/3996781/ammlan-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 27741714, "answer_count": 1, "score": 0, "last_activity_date": 1420199383, "creation_date": 1420198094, "last_edit_date": 1420199383, "question_id": 27741439, "link": "https://stackoverflow.com/questions/27741439/haskell-mvar-how-to-execute-shortest-job-first", "title": "Haskell MVar : How to execute shortest job first?", "body": "<p>When more than one thread is waiting to write an MVar, they are executed in first-in first-out scheme. I want to execute thread as per shortest job scheduling. </p>\n\n<p>I have tired to code this using MVar. Here job is to calculate a Fibonacci number and write a MVar. 1st thread calculates Fibonacci 30 and 2nd thread calculates Fibonacci 10. As time taken for calculating Fibonacci 10 is less than 30, thus 2nd thread should execute first. I a not getting the desired result from the following block of code. </p>\n\n<p>How to implement shortest job first scheduling in Haskell (or may be using Haskell STM)?</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>module Main\nwhere\nimport Control.Parallel\nimport Control.Concurrent\n\nimport System.IO\n\n\nnfib :: Int -&gt; Int\nnfib n | n &lt;= 2 = 1\n       | otherwise = par n1 (pseq n2 (n1 + n2 ))\n                 where n1 = nfib (n-1)\n                       n2 = nfib (n-2)\n\n\ntype MInt = MVar Int\n\nupdateMVar :: MInt -&gt; Int -&gt; IO ()\nupdateMVar n v = do x1 &lt;- readMVar n\n        let y = nfib v\n        x2 &lt;- readMVar n            \n        if x1 == x2 \n        then do t &lt;- takeMVar n \n            putMVar n y\n        else return()\n\nmain :: IO ()\nmain = do\n n &lt;- newEmptyMVar\n putMVar n 0\n\n forkIO(updateMVar n 30)\n t &lt;- readMVar n\n putStrLn(\"n is : \" ++  (show t))   \n\n forkIO(updateMVar n 10)\n t &lt;- readMVar n\n putStrLn(\"n is : \" ++  (show t))\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>n is : 832040\nn is : 55\n</code></pre>\n"}, {"tags": ["haskell", "ghci", "bytestring"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1420193040, "creation_date": 1420193040, "answer_id": 27740377, "question_id": 27740254, "link": "https://stackoverflow.com/questions/27740254/display-full-type-in-ghci/27740377#27740377", "title": "Display full type in ghci", "body": "<p>GHCi should use the same syntax you can use in your file. That is, if you import <code>Data.ByteString.Lazy.Char8</code> unqualified you will get <code>ByteString</code> unqualified, otherwise you should get the qualified type.</p>\n\n<p>Check all your imports in your Haskell file: is something importing the <code>ByteString</code> type in an unqualified way?</p>\n\n<p>As you can see below, I can not reproduce your issue in a small GHCi session:</p>\n\n<pre><code>&gt; import qualified Data.ByteString.Lazy.Char8 as BSL\n&gt; let a :: String ; a = \"aa\"\n&gt; :t BSL.pack a\nBSL.pack a :: BSL.ByteString\n</code></pre>\n"}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 27740377, "answer_count": 1, "score": 2, "last_activity_date": 1420193040, "creation_date": 1420192455, "question_id": 27740254, "link": "https://stackoverflow.com/questions/27740254/display-full-type-in-ghci", "title": "Display full type in ghci", "body": "<p>I have a variable of <code>ByteString</code> type. I want to see which package it belongs to. This could be useful for ByteString types because there are several different implementations in different packages.</p>\n\n<p>For instance, I have following piece of code:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy.Char8 as BSL\njson :: String\njson = \"{\\\"document\\\":{\\\"name\\\":\\\"doc1\\\",\\\"content\\\":\\\"content1\\\"}}\"\n</code></pre>\n\n<p>I want to get full package when I do <code>ghci&gt; :t BSL.pack json</code>. What I get is <code>BSL.pack json :: ByteString</code> while I want something like <code>BSL.pack json :: Data.ByteString.Lazy.Char8</code>. Is there any way to get this kind of information at the ghci prompt?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420207594, "post_id": 27739762, "comment_id": 43897616, "body": "How can <code>4 :: Maybe Int</code> be valid? you&#39;re looking for <code>Just 4 :: Maybe Int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "edited": false, "score": 0, "creation_date": 1420190876, "post_id": 27739814, "comment_id": 43890612, "body": "but even if I declare 4 like this 4::Maybe Int, it still doesn&#39;t work"}, {"owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "edited": false, "score": 0, "creation_date": 1420190949, "post_id": 27739814, "comment_id": 43890641, "body": "plus, if I compare literal 4 with a Maybe Int,the type inference should know what type I want, right?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "edited": false, "score": 1, "creation_date": 1420193160, "post_id": 27739814, "comment_id": 43891583, "body": "@sqd - There are only two ways to construct a value of <code>Maybe Int</code> - <code>Nothing</code> or using the <code>Just</code> constructor. The compiler will not do any conversions for you automatically."}, {"owner": {"reputation": 5184, "user_id": 1935631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0e4d0d6c5ce5e9350cacc818ee350347?s=128&d=identicon&r=PG", "display_name": "Sassa NF", "link": "https://stackoverflow.com/users/1935631/sassa-nf"}, "reply_to_user": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "edited": false, "score": 1, "creation_date": 1420198693, "post_id": 27739814, "comment_id": 43893973, "body": "@sqd i don&#39;t know what the confusion is, but if you are bringing the ideas about type casting from other languages, then that&#39;s where the mistake is. <code>4</code> can not be forced to <code>Maybe Int</code>. In fact, you never cast types in Haskell - only convert from values of some type to the other type (for example, can&#39;t cast <code>float</code> to <code>int</code> - got to explicitly convert them). Sometimes you do need to qualify the type, if the expression is too polymorphic, but that&#39;s not type casting in the sense of C or Java."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1420325329, "post_id": 27739814, "comment_id": 43931747, "body": "@AndrewC, that&#39;s quite a sensible instance. I wonder if it should be added to base."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420328133, "post_id": 27739814, "comment_id": 43932503, "body": "@dfeuer Perhaps. You could define <code>Fractional</code> and <code>Integral</code> to avoid dividing by zero and give <code>Nothing</code> instead. It&#39;s a pity you can&#39;t check whether there&#39;s also a <code>Bounded</code> instance and replace overflows etc with <code>Nothing</code> too."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420328425, "post_id": 27739814, "comment_id": 43932594, "body": "@dfeuer But the one that&#39;s really bugging me is that it seems the AMP is being done without putting <code>&lt;$&gt;</code> in the prelude. Just a little <code>&lt;$&gt;</code> without importing <code>Control.Applicative</code> or <code>Data.Functor</code> wouldn&#39;t hurt people while they&#39;re editing out <code>&lt;*&gt;</code> anyway and would make me very happy!"}], "tags": [], "owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "is_accepted": false, "score": 7, "last_activity_date": 1420190228, "creation_date": 1420190228, "answer_id": 27739814, "question_id": 27739762, "link": "https://stackoverflow.com/questions/27739762/haskell-why-nothing4maybe-int-gets-an-error-but-nothing-just-4-pass/27739814#27739814", "title": "Haskell: Why &quot;Nothing&lt;(4::Maybe Int)&quot; gets an error but &quot;Nothing&lt; Just 4&quot; pass?", "body": "<p>There's a simple type error in your expression:  <code>4</code> does not have type <code>Maybe Int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1420193318, "last_edit_date": 1420193318, "creation_date": 1420192687, "answer_id": 27740292, "question_id": 27739762, "link": "https://stackoverflow.com/questions/27739762/haskell-why-nothing4maybe-int-gets-an-error-but-nothing-just-4-pass/27740292#27740292", "title": "Haskell: Why &quot;Nothing&lt;(4::Maybe Int)&quot; gets an error but &quot;Nothing&lt; Just 4&quot; pass?", "body": "<p>Yes, <code>Nothing</code> can be of type <code>Maybe Int</code> (or <code>Maybe String</code>, or <code>Maybe AnythingElse</code>). </p>\n\n<p>Any two values of type <code>Maybe Int</code> can be compared. </p>\n\n<p>Equality <code>==</code> is defined as one might expect: <code>Nothing</code> is only equal to <code>Nothing</code>, and <code>Just x</code> is only equal to <code>Just y</code> if <code>x==y</code>. This is defined in the <code>Eq</code> instance for <code>Maybe a</code>, which is automatically imported since it is in the Haskell <code>Prelude</code>.</p>\n\n<p>Similarly, there is an <code>Ord (Maybe a)</code> instance as well in the <code>Prelude</code>. This instance defines <code>&lt;</code> between <code>Maybe Int</code>s so that <code>Nothing</code> is the minimum element (<code>&lt;</code> anything else), while two values <code>Just x</code> and <code>Just y</code> are compared according to whether <code>x &lt; y</code>.</p>\n\n<p>So, <code>Nothing &lt; Just 4</code> is true.</p>\n\n<hr>\n\n<p>The code <code>Nothing&lt;(4::Maybe Int)</code> gives you an error since <code>4</code> is an <code>Int</code> (technically, it is any type in the <code>Num</code> type class), but <code>4</code> is not a <code>Maybe Int</code>. If you write <code>4 :: String</code> or <code>4 :: [Int]</code> or <code>4 :: Int -&gt; Int</code> you will get a similar type error.</p>\n\n<p>The <code>Maybe Int</code> type contains only the values</p>\n\n<pre><code>Nothing\nJust 0\nJust 1\nJust -1\nJust 2\nJust -2\n...\n</code></pre>\n\n<p>(and some bottoms, which I omit.)</p>\n\n<p>The value <code>4</code> is not a value of type <code>Maybe Int</code>. <code>Just 4</code> is instead one of such values.</p>\n"}], "owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 27740292, "answer_count": 2, "score": 0, "last_activity_date": 1420193318, "creation_date": 1420189948, "question_id": 27739762, "link": "https://stackoverflow.com/questions/27739762/haskell-why-nothing4maybe-int-gets-an-error-but-nothing-just-4-pass", "title": "Haskell: Why &quot;Nothing&lt;(4::Maybe Int)&quot; gets an error but &quot;Nothing&lt; Just 4&quot; pass?", "body": "<p><code>Nothing</code> 's type could be <code>Maybe Int</code> and why couldn't it be compared with another <code>Maybe Int</code>?</p>\n\n<p>And why <code>Nothing&lt; Just 4</code> pass?</p>\n"}, {"tags": ["haskell", "side-effects"], "comments": [{"owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "edited": false, "score": 0, "creation_date": 1420164027, "post_id": 27736538, "comment_id": 43884603, "body": "Your <code>foo</code> function doesn&#39;t accept any arguments with this function head."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1420240975, "post_id": 27736538, "comment_id": 43910934, "body": "Your <code>bar</code> function in the edit does not return <code>[IO ()]</code>, but rather <code>IO ()</code>. It prints all the inputs (when run in GHCI), but its return type is definitely not a list of anything, as you can see by looking at it: there are no lists anywhere!"}], "answers": [{"tags": [], "owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "is_accepted": false, "score": -1, "last_activity_date": 1420164247, "creation_date": 1420164247, "answer_id": 27736594, "question_id": 27736538, "link": "https://stackoverflow.com/questions/27736538/why-cant-you-map-print-to-a-list-in-haskell/27736594#27736594", "title": "Why can&#39;t you map print to a list in Haskell?", "body": "<p>In the <code>IO</code> monad, something like <code>IO a</code> is required. You have <code>[IO ()]</code> which is a list of IO operations. You can use <code>mapM</code> instead, to do a monadic map. <code>mapM f</code> is equivalent to <code>sequence . map f</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420164381, "post_id": 27736601, "comment_id": 43884682, "body": "Then why does <code>foo 1</code> print <code>1</code> and return <code>IO ()</code>?"}, {"owner": {"reputation": 3525, "user_id": 1440433, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/mKFTJ.jpg?s=128&g=1", "display_name": "Joker_vD", "link": "https://stackoverflow.com/users/1440433/joker-vd"}, "reply_to_user": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 1, "creation_date": 1420164576, "post_id": 27736601, "comment_id": 43884718, "body": "Evaluating <code>foo 1</code> doesn&#39;t print <code>1</code>. Evaluate <code>foo 1 `seq` return ()</code>: it will evaluate <code>foo 1</code>, but <code>1</code> won&#39;t be printed."}], "tags": [], "owner": {"reputation": 3525, "user_id": 1440433, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/mKFTJ.jpg?s=128&g=1", "display_name": "Joker_vD", "link": "https://stackoverflow.com/users/1440433/joker-vd"}, "is_accepted": false, "score": 2, "last_activity_date": 1420165575, "last_edit_date": 1420165575, "creation_date": 1420164316, "answer_id": 27736601, "question_id": 27736538, "link": "https://stackoverflow.com/questions/27736538/why-cant-you-map-print-to-a-list-in-haskell/27736601#27736601", "title": "Why can&#39;t you map print to a list in Haskell?", "body": "<blockquote>\n  <p>If the <code>print</code> calls are evaluated to get the <code>IO ()</code> to build the list, why doesn't the side effect happen?</p>\n</blockquote>\n\n<p>Because evaluating an expression of type <code>IO ()</code> doesn't have any side effects. In fact, evaluating an expression of any type doesn't have any side effects.</p>\n"}, {"comments": [{"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420166160, "post_id": 27736617, "comment_id": 43884995, "body": "Thank you for the answer- I have started learning Haskell but I have not really gotten to monads or to the internals of <code>IO</code>. <code>print</code> returns <code>IO ()</code>, and I&#39;ve been reading that as <code>print returns an action that returns ()</code>. Is that right? So what you are saying is that it&#39;s not the call to <code>print</code> that prints <code>1</code> to the screen- it&#39;s when we evaluate what is returned by print?"}, {"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "reply_to_user": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420166864, "post_id": 27736617, "comment_id": 43885090, "body": "@user2666425: Kind of, but you have to be careful with your wording. Evaluation is pure, and won\u2019t ever <i>do</i> anything. On the other hand, <i>executing</i> (not merely evaluating) the monadic action returned by <code>print</code> does indeed print the <code>1</code> to the screen."}, {"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420167078, "post_id": 27736617, "comment_id": 43885130, "body": "You mention that if GHCi will execute an <code>IO</code> if an expression returns one- then why doesn&#39;t GHCi execute each <code>print</code> when it successively does <code>map print [1..10]</code>? <code>print 1</code>, <code>print 2</code>, etc, are expressions that are yielding a <code>IO</code>, right?"}, {"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "reply_to_user": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420167570, "post_id": 27736617, "comment_id": 43885194, "body": "@user2666425: Those are indeed expressions yielding an <code>IO</code>, but I was a little sloppy in describing GHCi\u2019s automatic execution. GHCi doesn\u2019t automatically execute <i>all</i> <code>IO</code> in expressions. The only <code>IO</code> it will try to execute is the one wrapping the result of the overall expression you\u2019ve typed in at the prompt, if there is an <code>IO</code> at all. It does not modify the evaluation behavior for subexpressions."}, {"owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420168056, "post_id": 27736617, "comment_id": 43885271, "body": "Last question- I&#39;ve updated my post with <code>bar</code>, which calls <code>foo</code> and then calls itself. Why does <code>bar</code> print out the values then? I thought <code>do</code> returns the value of the last expression in it, so why is GHCi executing each <code>IO ()</code> returned from <code>foo</code> if it&#39;s not the top-level expression?"}, {"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "reply_to_user": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "edited": false, "score": 0, "creation_date": 1420168370, "post_id": 27736617, "comment_id": 43885330, "body": "@user2666425: You\u2019ve been mislead about <code>do</code>. <code>do</code> is one way you can combine a few monadic values into one big monadic value that does everything inside it. In fact, <code>do</code> is just syntactic sugar: the right hand side of your <code>bar n</code> could be written as <code>foo n &gt;&gt; bar (n - 1)</code>. Looking at the type of <code>&gt;&gt;</code>, it takes two monadic values and gives you a new monadic value. So there what you\u2019re doing is recursively building up a big monadic value, and then all GHCi does is execute that, at which point all the effects contained within begin to execute."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1420175853, "post_id": 27736617, "comment_id": 43886683, "body": "Your last remark about composing things into other things is rather unclear."}], "tags": [], "owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "is_accepted": true, "score": 9, "last_activity_date": 1420167376, "last_edit_date": 1420167376, "creation_date": 1420164497, "answer_id": 27736617, "question_id": 27736538, "link": "https://stackoverflow.com/questions/27736538/why-cant-you-map-print-to-a-list-in-haskell/27736617#27736617", "title": "Why can&#39;t you map print to a list in Haskell?", "body": "<p><code>map foo [0..10]</code> will definitely construct a list of <code>IO ()</code> values, but constructing an <code>IO ()</code> value doesn\u2019t execute the <code>IO</code>. You probably know this intuitively: if we have a global <code>IO ()</code> and nothing referencing it, it doesn\u2019t get executed:</p>\n\n<pre><code>sayHello :: IO ()\nsayHello = putStrLn \"hello\"\n</code></pre>\n\n<p>You might attribute that to laziness; after all, if <code>sayHello</code> isn\u2019t referenced, nothing ever forces its evaluation. But then, this doesn\u2019t do anything either:</p>\n\n<pre><code>main = sayHello `seq` return ()\n</code></pre>\n\n<p>Here, we are <em>certainly</em> evaluating <code>sayHello</code>, but we\u2019re only evaluating an <code>IO ()</code>.</p>\n\n<p>What makes an <code>IO</code> do something is when you compose it into another <code>IO</code> (like <code>main</code>) and <em>that</em> gets run, and <em>only then</em> will it do something:</p>\n\n<pre><code>main = sayHello\n</code></pre>\n\n<hr>\n\n<p>I should note that GHCi clouds the situation a bit. GHCi has some special interactions with <code>IO</code>: if the overall expression you type at the prompt yields an <code>IO</code>, it will execute it and display the result of that. Otherwise, it just displays the result. But that is just an interactive feature; in real Haskell code, you can\u2019t just have an <code>IO ()</code> and expect it to turn into a <code>()</code> magically.</p>\n"}, {"comments": [{"owner": {"reputation": 3549, "user_id": 658270, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/56a007a4b2c47b141bd39790278f88a7?s=128&d=identicon&r=PG", "display_name": "Sonia Hamilton", "link": "https://stackoverflow.com/users/658270/sonia-hamilton"}, "edited": false, "score": 0, "creation_date": 1428744482, "post_id": 27736799, "comment_id": 47300898, "body": "Gracias Gabriel, the <code>mapM_</code> helped me a lot."}], "tags": [], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "is_accepted": false, "score": 2, "last_activity_date": 1420166512, "creation_date": 1420166512, "answer_id": 27736799, "question_id": 27736538, "link": "https://stackoverflow.com/questions/27736538/why-cant-you-map-print-to-a-list-in-haskell/27736799#27736799", "title": "Why can&#39;t you map print to a list in Haskell?", "body": "<p>The only way to run an <code>IO</code> action is to assign it to <code>main</code>.  Evaluating <code>IO</code> actions does not run them.</p>\n\n<p>If you want to call <code>print</code> on the list of values, you must do two things:</p>\n\n<p>First: use <code>mapM_</code> to build an <code>IO</code> action that <code>print</code>s each value:</p>\n\n<pre><code>mapM_ print [1..3] :: IO ()\n</code></pre>\n\n<p>Second, assign that expression to <code>main</code>:</p>\n\n<pre><code>main = mapM_ print [1..3]\n</code></pre>\n\n<p>If you leave out the second step (assign it to something other than <code>main</code>), nothing will happen.</p>\n"}], "owner": {"reputation": 1551, "user_id": 2666425, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16b135dfb3e8d6ad840986ef13813931?s=128&d=identicon&r=PG", "display_name": "user2666425", "link": "https://stackoverflow.com/users/2666425/user2666425"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 27736617, "answer_count": 4, "score": 3, "last_activity_date": 1420167967, "creation_date": 1420163732, "last_edit_date": 1495540244, "question_id": 27736538, "link": "https://stackoverflow.com/questions/27736538/why-cant-you-map-print-to-a-list-in-haskell", "title": "Why can&#39;t you map print to a list in Haskell?", "body": "<p>I checked <a href=\"https://stackoverflow.com/questions/932639/haskell-cant-use-map-putstrln\">this</a> post before making this, but that post doesn't really explain <em>why</em> this doesn't work.</p>\n\n<pre><code>foo :: (Num a, Show a) =&gt; a -&gt; IO ()\nfoo 0 = print \"Was zero\"\nfoo x = print x\n\nfoo 2 -- prints 2\nfoo 5 -- prints 5\n\nmap foo [0..10] :: [IO ()] -- Doesn't print out numbers.\n</code></pre>\n\n<p>Edit:</p>\n\n<pre><code>bar 0 = foo 0\nbar n = do\n            foo n\n            bar (n - 1)\n</code></pre>\n\n<p>I <em>do</em> understand why this returns <code>[IO ()]</code>, but I don't understand why the printing doesn't occur while building this list. At the very least, I'd expect that we'd see the <em>first</em> print call occur because of lazy evaluation.</p>\n\n<p>In the process of creating this list, why isn't the 'side effect' of printing to the screen occurring? Is the <code>foo</code> function not actually entered when applied to each element of the list? If the <code>print</code> calls are evaluated to get the <code>IO ()</code> to build the list, why doesn't the side effect happen?</p>\n"}, {"tags": ["haskell", "cabal", "hackage"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1420159608, "post_id": 27736022, "comment_id": 43883768, "body": "Try <code>cabal sandbox add-source</code>. See <a href=\"http://coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html\" rel=\"nofollow noreferrer\">coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html</a> for an example."}, {"owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1420165572, "post_id": 27736022, "comment_id": 43884902, "body": "That did the trick thanks."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1517907248, "creation_date": 1517907248, "answer_id": 48638934, "question_id": 27736022, "link": "https://stackoverflow.com/questions/27736022/how-to-install-a-dev-branch-into-a-cabal-sandbox/48638934#48638934", "title": "How to install a dev branch into a Cabal Sandbox", "body": "<p>Reproducing the correct answer as community-wiki from the comments:</p>\n\n<p>Try <code>cabal sandbox add-source</code>. See coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html for an example.</p>\n"}], "owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 48638934, "answer_count": 1, "score": 2, "last_activity_date": 1517907248, "creation_date": 1420158336, "question_id": 27736022, "link": "https://stackoverflow.com/questions/27736022/how-to-install-a-dev-branch-into-a-cabal-sandbox", "title": "How to install a dev branch into a Cabal Sandbox", "body": "<p>I have a project in a Cabal sandbox. There is a package I would like to use but the one on Hackage isn't suitable. There is an alternative dev branch that should meet my needs that the author has on Github. I've previously installed dev branches without a sandbox by using:</p>\n\n<pre><code>$ runhaskell Setup.hs configure --user\n$ runhaskell Setup.hs build\n$ runhaskell Setup.hs install\n</code></pre>\n\n<p>Obviously that's not going to work if I only want this repo installed in the sandbox.</p>\n\n<p>My directory structure is set up like this:</p>\n\n<pre><code>../MyProject\n../MyProject/.cabal-sandbox\n../MyProject/exec/Main.hs\n../MyProject/src/MyProject.hs\n../MyProject/MyProject.cabal\n</code></pre>\n\n<p>There's both an executable and a library. My build-depends has about 18 package dependencies, of which this is one. So my questions:</p>\n\n<ol>\n<li>Once I've downloaded the dev repo, where should I extract it to?</li>\n<li>Once extracted, how do I build/install into my sandbox?</li>\n<li>Once that's all done, do I need to modify my .cabal file at all?</li>\n</ol>\n"}, {"tags": ["haskell", "binary-tree"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1420156329, "post_id": 27735742, "comment_id": 43883096, "body": "I don&#39;t see what the <code>preorder</code> function has to do with this."}, {"owner": {"reputation": 14917, "user_id": 1123020, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/78465afdabcd3781cf060e74fd28cfab?s=128&d=identicon&r=PG&f=1", "display_name": "Yoda", "link": "https://stackoverflow.com/users/1123020/yoda"}, "edited": false, "score": 0, "creation_date": 1420156331, "post_id": 27735742, "comment_id": 43883097, "body": "This is a comprehensible order: prefix order, ther is also infix order and postfix order. But you probably want to display path to every node, so you probably(that&#39;s the way I understood your question) need also to use stack to achieve that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1420157426, "post_id": 27735742, "comment_id": 43883336, "body": "Note that your example does not clarify what should be the paths of <code>Branch &#39;A&#39; Empty (Branch &#39;B&#39; Empty Empty)</code>. One might say <code>[&quot;AB&quot;]</code> or <code>[&quot;A&quot;,&quot;AB&quot;]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1420156744, "last_edit_date": 1420156744, "creation_date": 1420156427, "answer_id": 27735842, "question_id": 27735742, "link": "https://stackoverflow.com/questions/27735742/haskell-traverse-tree-and-output-to-lists/27735842#27735842", "title": "Haskell - Traverse Tree and output to lists", "body": "<p>This exercise amounts to this:</p>\n\n<ul>\n<li>What are the paths for the empty tree?</li>\n<li>Let <code>e</code> and <code>d</code> be trees, each having their paths lists <code>ep</code> and <code>dp</code>, respectively. How to compute the paths for a tree labelled with <code>x</code> and having <code>e</code> and <code>d</code> as subtrees?</li>\n</ul>\n\n<p>So,</p>\n\n<pre><code>paths :: Tree a -&gt; [[a]]\npaths Empty = ???\npaths (Branch x e d) = ??? -- use x,ep,dp accordingly\n       where ep = paths e\n             dp = paths d\n</code></pre>\n\n<p>As a extra hint, related to your own example:</p>\n\n<pre><code>[ 'A':xs | xs &lt;- [\"BE\",\"BB\"] ] = [ \"ABE\" , \"ABB\" ]\n</code></pre>\n\n<p>Note that <code>[\"BE\",\"BB\"]</code> are the paths for your first subtree.</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 1, "last_activity_date": 1420156734, "creation_date": 1420156734, "answer_id": 27735873, "question_id": 27735742, "link": "https://stackoverflow.com/questions/27735742/haskell-traverse-tree-and-output-to-lists/27735873#27735873", "title": "Haskell - Traverse Tree and output to lists", "body": "<pre><code>paths :: Tree a -&gt; [[a]]\npaths  Empty                 = [[]]\npaths (Branch x Empty d    ) = map (x:) $ paths d\npaths (Branch x e     Empty) = map (x:) $ paths e\npaths (Branch x e     d    ) = map (x:) $ paths e ++ paths d\n</code></pre>\n\n<p>I.e. simply prepend <code>x</code> to every subpath.</p>\n\n<pre><code>createTree = Branch 'A' \n                  (Branch 'B'\n                          (Branch 'E' Empty (Branch 'A' Empty Empty)) \n                          (Branch 'B' Empty Empty)\n                  )\n                  (Branch 'A'\n                          (Branch 'E' Empty Empty) \n                          (Branch 'A' Empty Empty)\n                  )\n\nmain = print $ paths createTree\n</code></pre>\n\n<p>prints <code>[\"ABEA\",\"ABB\",\"AAE\",\"AAA\"]</code></p>\n"}], "owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420159275, "creation_date": 1420155526, "last_edit_date": 1420159275, "question_id": 27735742, "link": "https://stackoverflow.com/questions/27735742/haskell-traverse-tree-and-output-to-lists", "title": "Haskell - Traverse Tree and output to lists", "body": "<p>I have this bit of code, which outputs the nodes after traversing, without any comprehensible order:</p>\n\n<pre><code>preorder :: Tree a -&gt; [a]\npreorder Empty = []\npreorder (Branch x e d) = [x]++(preorder e)++(preorder d)\n\ncreateTree = Branch 'A' \n                  (Branch 'B'\n                          (Branch 'E' Empty Empty) \n                          (Branch 'B' Empty Empty)\n                  )\n                  (Branch 'A'\n                          (Branch 'E' Empty Empty) \n                          (Branch 'A' Empty Empty)\n                  )\n</code></pre>\n\n<p>Applying <code>preorder</code> to <code>createTree</code> outputs :</p>\n\n<pre><code>ABEBAEA\n</code></pre>\n\n<p>What i would like to have is a list of all paths going from the root:</p>\n\n<pre><code>[\"ABE\",\"ABB\",\"AAE\",\"AAA\"]\n</code></pre>\n\n<p>I have no idea on how to do this, I'm a beginner at Haskell!</p>\n\n<p>Thank you very much for all the help that can be provided. </p>\n"}, {"tags": ["haskell", "non-exhaustive-patterns"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1420143972, "creation_date": 1420143972, "answer_id": 27734361, "question_id": 27734254, "link": "https://stackoverflow.com/questions/27734254/non-exhaustive-patterns-in-function-trace/27734361#27734361", "title": "Non-exhaustive patterns in function trace&#39;", "body": "<p>Your test string contains '[' and ']', but you only match 'R', 'L' and 'F' in your pattern match. So as soon as it reaches a square bracket you get an exception.</p>\n"}], "owner": {"reputation": 29, "user_id": 4400821, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/071934f389c2b84225ea46908db092bc?s=128&d=identicon&r=PG&f=1", "display_name": "overpro", "link": "https://stackoverflow.com/users/4400821/overpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 27734361, "answer_count": 1, "score": 0, "last_activity_date": 1420143972, "creation_date": 1420143197, "last_edit_date": 1420143408, "question_id": 27734254, "link": "https://stackoverflow.com/questions/27734254/non-exhaustive-patterns-in-function-trace", "title": "Non-exhaustive patterns in function trace&#39;", "body": "<pre><code>trace :: String -&gt; Float -&gt; Colour -&gt; [ColouredLine]  \ntrace (c:cs) angle colour  \n = trace' (c:cs) angle colour (0.0,0.0)  \n  where  \n   trace' \"\" angle colour intvertex = []  \n   trace' (c:cs) angle colour intvertex  \n       | c == 'R' = trace' cs (angle-90) colour intvertex  \n       | c == 'L' = trace' cs (angle+90) colour intvertex  \n       | c == 'F' = [(intvertex,aftvertex,colour)] ++ trace' cs angle colour aftvertex  \n         where  \n           aftvertex = fst (move 'F' (intvertex,angle) angle) \n</code></pre>\n\n<p>REPORT:</p>\n\n<blockquote>\n  <p>trace \"F[RF][LF][FF]\" 45.0 (1.0,0.0,0.0) = Exception: LSystems.hs:(95,4)-(101,61): Non-exhaustive patterns in function trace'</p>\n</blockquote>\n\n<p>Test case expected: </p>\n\n<blockquote>\n  <p>[((-8.742278e-8,2.0),(-1.3113416e-7,3.0),(1.0,0.0,0.0)),((-4.371139e-8,1.0),(-0.7071068,1.7071068),(1.0,0.0,0.0)),((-4.371139e-8,1.0),(-8.742278e-8,2.0),(1.0,0.0,0.0)),((-4.371139e-8,1.0),(0.7071067,1.7071068),(1.0,0.0,0.0)),((0.0,0.0),(-4.371139e-8,1.0),(1.0,0.0,0.0))]</p>\n</blockquote>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 1867082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/582ce4225fd51413e5758c795263759b?s=128&d=identicon&r=PG&f=1", "display_name": "Gracjan Polak", "link": "https://stackoverflow.com/users/1867082/gracjan-polak"}, "edited": false, "score": 0, "creation_date": 1420286334, "post_id": 27738615, "comment_id": 43919876, "body": "Can you change the order of presentation? Comonads should go first as direct response, everything else as supportive discussion of the problem."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 1, "last_activity_date": 1420182224, "creation_date": 1420182224, "answer_id": 27738615, "question_id": 27733699, "link": "https://stackoverflow.com/questions/27733699/monadbasecontrol-how-to-lift-simplehttp-from-happstack/27738615#27738615", "title": "MonadBaseControl: how to lift simpleHTTP from Happstack?", "body": "<p>I don't think you can lift this in general for any <code>MonadBaseControl IO m</code>. There are some <code>m</code>s for which we can.</p>\n\n<h3>In General</h3>\n\n<p><code>UnWebT m</code> is isomorphic to <a href=\"http://hackage.haskell.org/package/happstack-server-7.3.9/docs/Happstack-Server-Internal-Monads.html#t:WebT\" rel=\"nofollow\"><code>WebT m</code></a> which has a <a href=\"http://hackage.haskell.org/package/monad-control-0.3.3.0/docs/Control-Monad-Trans-Control.html\" rel=\"nofollow\"><code>MonadTransControl</code></a> instance. You can convert to and from <code>WebT</code> with <code>mkWebT :: UnWebT m a -&gt; WebT m a</code> and <code>ununWebT :: WebT m a -&gt; UnWebT m a</code>.</p>\n\n<p><code>MonadBaseControl</code> is a fancy wrapper around a stack of <code>MonadTransControl</code> transformers that flattens the stack so that running and restoring state happens all the way down the stack and all the way back up it again. You can understand <code>MonadBaseControl</code> by understanding <code>MonadTransControl</code>, which I'll repeat briefly here:</p>\n\n<pre><code>class MonadTrans t =&gt; MonadTransControl t where\n  data StT t :: * -&gt; *\n  liftWith :: Monad m =&gt; (Run t -&gt; m a) -&gt; t m a\n  restoreT :: Monad m =&gt; m (StT t a) -&gt; t m a\n\ntype Run t = forall n b. Monad n =&gt; t n b -&gt; n (StT t b)\n</code></pre>\n\n<p>The class says with <code>liftWith</code>, \"I'll provide a temporary way to run <code>t m</code>s in <code>m</code>, which you can use to build actions in <code>m</code>, which I will in turn run.\" The <code>StT</code> type of the result says, \"the results of the <code>t m</code> things I run in <code>m</code> for you aren't going to be generally available in <code>t m</code>; I need to save my state somewhere, and you have to give me a chance to restore my state if you want the results.\"</p>\n\n<p>Another way of saying approximately the same thing is, \"I can temporarily unwrap the base monad\". The question of implementing <code>fixTypes</code> is reduced to \"Given that we can temporarily unwrap a <code>WebT</code> from an <code>m</code> and can temporarily unwrap an <code>m</code> from <code>IO</code>, can we permanently unwrap an <code>m</code> from an <code>IO</code>?\" for which the answer, barring the capabilities of <code>IO</code>, is almost certainly \"no\".</p>\n\n<h3>IO Tricks</h3>\n\n<p>I suspect that there exist <code>m</code>s such that the \"ugly\" <code>fixTypes</code> will do horrible things like never call <code>writeIORef</code> and thus return <code>undefined</code> or execute code asynchronously and therefore call <code>writeIORef</code> after <code>readIORef</code>. I'm not sure. This is made complicated to reason about due to the possibility that the action created by <code>liftBaseWith</code> is never used in such degenerate cases.</p>\n\n<h3>For Comonads</h3>\n\n<p>There should be a way to lift <code>simpleHttp</code> without <code>IO</code> tricks precisely when the state of the monad <code>m</code> is a <a href=\"https://hackage.haskell.org/package/comonad-4.2.2/docs/Control-Comonad.html\" rel=\"nofollow\"><code>Comonad</code></a> and therefore has a function <code>extract :: StM m a -&gt; a</code>. For example, this would be the case for <code>StateT s m</code> which essentially has <code>StM s a ~ (s, a)</code>.</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Happstack.Server.SimpleHTTP\n\nimport Control.Comonad\nimport Control.Monad.Base\nimport Control.Monad.Trans.Control\n\nsimpleHTTPLifted :: forall m a. (MonadBaseControl IO m, Comonad (StM m), ToMessage a)\n                 =&gt; Conf -&gt; ServerPartT m a -&gt; m ()\nsimpleHTTPLifted conf action =\n    liftBaseWith (\\runInBase -&gt;\n        let\n            fixTypes :: UnWebT m b -&gt; UnWebT IO b\n            fixTypes = fmap extract . runInBase\n        in simpleHTTP conf (mapServerPartT fixTypes action)\n    )\n</code></pre>\n\n<p>In practice this isn't very useful because the <code>newtype</code>s defined in the older versions of monad-control don't have <code>Comonad</code> instances and the type synonymns in the newer versions of monad-control make no effort to have the result as the last type argument. For example, in the newest version of monad-control <code>type StT (StateT s) a = (a, s)</code> .</p>\n"}], "owner": {"reputation": 568, "user_id": 1867082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/582ce4225fd51413e5758c795263759b?s=128&d=identicon&r=PG&f=1", "display_name": "Gracjan Polak", "link": "https://stackoverflow.com/users/1867082/gracjan-polak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 27738615, "answer_count": 1, "score": 3, "last_activity_date": 1420182224, "creation_date": 1420138914, "last_edit_date": 1495541569, "question_id": 27733699, "link": "https://stackoverflow.com/questions/27733699/monadbasecontrol-how-to-lift-simplehttp-from-happstack", "title": "MonadBaseControl: how to lift simpleHTTP from Happstack?", "body": "<p>How to use <a href=\"http://hackage.haskell.org/package/monad-control-0.3.1/docs/Control-Monad-Trans-Control.html#t:MonadBaseControl\" rel=\"nofollow noreferrer\"><code>MonadBaseControl</code></a> from <a href=\"http://hackage.haskell.org/package/monad-control\" rel=\"nofollow noreferrer\">monad-control</a> to lift <a href=\"http://hackage.haskell.org/package/happstack-server/docs/Happstack-Server-SimpleHTTP.html#v:simpleHTTP\" rel=\"nofollow noreferrer\"><code>simpleHTTP</code></a> function defined in <a href=\"http://hackage.haskell.org/package/happstack-server\" rel=\"nofollow noreferrer\">happstack-server</a>?</p>\n\n<p>Current type of <code>simpleHTTP</code>:</p>\n\n<pre><code>simpleHTTP :: ToMessage a \n           =&gt; Conf -&gt; ServerPartT IO a -&gt; IO () \n</code></pre>\n\n<p>Expected type of <code>simpleHTTPLifted</code>:</p>\n\n<pre><code>simpleHTTPLifted :: (MonadBaseControl IO m, ToMessage a)\n                 =&gt; Conf -&gt; ServerPartT m a -&gt; m ()\n</code></pre>\n\n<p>My current attempt (does not compile):</p>\n\n<pre><code>simpleHTTPLifted conf action =\n   liftBaseWith (\\runInBase -&gt;\n              let\n                  fixTypes :: UnWebT m a -&gt; UnWebT IO a\n                  fixTypes c = runInBase c\n              in simpleHTTP conf (mapServerPartT fixTypes action)\n           )\n</code></pre>\n\n<p>Note that similar puzzle is in my related question: <a href=\"https://stackoverflow.com/questions/27704615/monadbasecontrol-how-to-lift-threadgroup\">MonadBaseControl: how to lift ThreadGroup</a></p>\n\n<p>I'd like to understand how to in general lift such functions and what are usual steps taken when presented with such a type puzzle?</p>\n\n<p>EDIT: I guess I need a function of type <code>(StM m a -&gt; a)</code>. <code>restoreM</code> is pretty close, but does not make it. I've also found an ugly version of <code>fixTypes</code>:</p>\n\n<pre><code>fixTypes :: UnWebT m a -&gt; UnWebT IO a\nfixTypes c = do\n    x &lt;- newIORef undefined\n    _ &lt;- runInBase (c &gt;&gt;= liftBase . writeIORef x)\n    readIORef x\n</code></pre>\n\n<p>This relies on IO being the base monad which is not an optimal solution.</p>\n"}, {"tags": ["list", "haskell", "io", "element", "monads"], "comments": [{"owner": {"reputation": 12819, "user_id": 845414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fbe63f77ce3f9656c62b27db4d8583b?s=128&d=identicon&r=PG", "display_name": "Johannes Kuhn", "link": "https://stackoverflow.com/users/845414/johannes-kuhn"}, "edited": false, "score": 2, "creation_date": 1420137445, "post_id": 27733492, "comment_id": 43878499, "body": "<code>fmap (!!x) ioDeck</code> - or <code>ioDeck &gt;&gt;= (\\deck -&gt; do some stuff with the deck)</code>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1420138715, "post_id": 27733492, "comment_id": 43878828, "body": "You can find out how to manipulate monads here: <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\">learnyouahaskell.com/a-fistful-of-monads</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1420138532, "creation_date": 1420138532, "answer_id": 27733643, "question_id": 27733492, "link": "https://stackoverflow.com/questions/27733492/haskell-getting-io-list-elements/27733643#27733643", "title": "Haskell getting IO list elements", "body": "<p>Assuming these are your types:</p>\n\n<pre><code>type Card = (Int, Int)\n\ntype Deck = [Card]\n\nsomeDeck :: IO Deck\nsomeDeck = undefined -- Some sample IO Deck which you have (from reading file etc.)\n</code></pre>\n\n<p>Then you can use the monad do-notation to access the <code>Deck</code>:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\ntestFun :: IO Deck\ntestFun = do\n  (x :: Deck) &lt;- someDeck\n  -- Operate here on the x value                 \n  return []\n</code></pre>\n\n<p>The <code>&lt;-</code> will extract the <code>Deck</code> from the <code>IO Deck</code>. Notice that the <code>x</code> is of type <code>Deck</code> here. You can apply your pure functions on that in an let expression. Another way would be to use <code>fmap</code> which is much simpler but less intuitive unless you are used to it. </p>\n"}, {"tags": [], "owner": {"reputation": 2995, "user_id": 1095506, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07067c06a12496ca32eb400313ef4ab6?s=128&d=identicon&r=PG", "display_name": "mariop", "link": "https://stackoverflow.com/users/1095506/mariop"}, "is_accepted": false, "score": 1, "last_activity_date": 1420138642, "creation_date": 1420138642, "answer_id": 27733658, "question_id": 27733492, "link": "https://stackoverflow.com/questions/27733492/haskell-getting-io-list-elements/27733658#27733658", "title": "Haskell getting IO list elements", "body": "<p>You should separate the code that you use for loading the deck from the game itself and then combine the two together somewhere. A template could be:</p>\n\n\n\n<pre><code>import System.Environment (getArgs)\n\nsolve :: Deck -&gt; Deck\nsolve deck = -- do something here\n\nloadDeckFromFile :: FilePath -&gt; IO Deck\nloadDeckFromFile fp = -- load deck code here\n\nmain :: IO ()\nmain = do\n  deckFile &lt;- fmap head getArgs\n  deck &lt;- loadDeckFromFile deckFile\n  let solvedDeck = solve deck\n\n  putStrLn \"Starting deck:\"\n  print deck\n  putStrLn \"\\nSolved deck:\"\n  print solvedDeck\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1420140195, "post_id": 27733787, "comment_id": 43879219, "body": "I think it&#39;s a bit misleading to say &quot;manipulate monads&quot;. A monad is a once-and-for-all thing, a mathematical concept, you can&#39;t manipulate that! Nor can you manipulate <i>monadic values</i> (aka <i>actions</i>; I think those are what you mean here). Operators like <code>&gt;&gt;=</code> don&#39;t manipulate but <i>combine</i> such actions."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1420140338, "post_id": 27733787, "comment_id": 43879256, "body": "@leftaroundabout That&#39;s true, but at a beginner level, it may be a better idea to think about it in a more basic way that combining actions. I certainly find it easier to think in the former way."}, {"owner": {"reputation": 299, "user_id": 821442, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5a1db6b3aadf18df987f4352a9ee4cf?s=128&d=identicon&r=PG&f=1", "display_name": "wolx", "link": "https://stackoverflow.com/users/821442/wolx"}, "edited": false, "score": 0, "creation_date": 1420147063, "post_id": 27733787, "comment_id": 43880896, "body": "How would you apply this to filtering? I have <i>filter predicate iolist</i> where iolist is the IO Deck and the predicate is Card -&gt; Bool. I tried using liftM but it didn&#39;t work."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 299, "user_id": 821442, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5a1db6b3aadf18df987f4352a9ee4cf?s=128&d=identicon&r=PG&f=1", "display_name": "wolx", "link": "https://stackoverflow.com/users/821442/wolx"}, "edited": false, "score": 0, "creation_date": 1420147395, "post_id": 27733787, "comment_id": 43880963, "body": "@wolx it should work fine if you do <code>liftM (filter predicate) ioList</code> - it works like that for me. Your issue may be that you haven&#39;t enclosed the function as I have within parentheses. You will also need to import <code>Control.Monad</code>, where <code>liftM</code> comes from."}, {"owner": {"reputation": 299, "user_id": 821442, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5a1db6b3aadf18df987f4352a9ee4cf?s=128&d=identicon&r=PG&f=1", "display_name": "wolx", "link": "https://stackoverflow.com/users/821442/wolx"}, "edited": false, "score": 0, "creation_date": 1420147451, "post_id": 27733787, "comment_id": 43880974, "body": "Nevermind, I managed by using fmap. :) <i>fmap (filter predicate) iolist</i> <b>Edit</b>: You beat me to it. Thank you again!"}, {"owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 0, "creation_date": 1420153694, "post_id": 27733787, "comment_id": 43882459, "body": "<code>sndElem &lt;- list !! 1</code> won&#39;t work because <code>!!</code> doesn&#39;t return a monadic value."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 4, "last_activity_date": 1420205193, "last_edit_date": 1420205193, "creation_date": 1420139436, "answer_id": 27733787, "question_id": 27733492, "link": "https://stackoverflow.com/questions/27733492/haskell-getting-io-list-elements/27733787#27733787", "title": "Haskell getting IO list elements", "body": "<p>Your main problem here is you simply don't know how to manipulate monads, so here are a few pointers:</p>\n\n<p>Monads have a few functions to allow them to be manipulated. These stem from the basic ones defined in the monad typeclass, <code>return</code> and <code>&gt;&gt;=</code> (aka 'bind').</p>\n\n<p><code>return</code> allows a monad to be constructed, and <code>&gt;&gt;=</code> takes first a monad, then a function which constructs a monad, and applies the function to the value given. This is the way in which you would use it in your case:</p>\n\n<pre><code>-- Imagine your list to be here:\nioList :: IO [Int]\nioList = return [1,2,3,4,5]\n\n-- If we were to print the second element...\nmain = ioList &gt;&gt;= ( \\a -&gt; return (a !! 1) ) &gt;&gt;= print\n\n-- We could write this in do-notation, syntactic sugar for the above:\nmain = do\n    list &lt;- ioList\n    print (list !! 1)\n</code></pre>\n\n<p>One could also use the function <code>liftM</code> from <code>Control.Monad</code> which takes a function and applies it to a monad like so:</p>\n\n<pre><code>import Control.Monad\nmain = print (liftM (!! 1) ioList)\n</code></pre>\n\n<p>You can find more ways to manipulate monads, as well as an explanation of the various type signatures involved, as well as do-notation and the rest <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 299, "user_id": 821442, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5a1db6b3aadf18df987f4352a9ee4cf?s=128&d=identicon&r=PG&f=1", "display_name": "wolx", "link": "https://stackoverflow.com/users/821442/wolx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1499, "favorite_count": 0, "accepted_answer_id": 27733787, "answer_count": 3, "score": 1, "last_activity_date": 1420205193, "creation_date": 1420137373, "question_id": 27733492, "link": "https://stackoverflow.com/questions/27733492/haskell-getting-io-list-elements", "title": "Haskell getting IO list elements", "body": "<p>I have a type synonym <strong>Card</strong> consisting of a tuple. I also have a type synonym <strong>Deck</strong> defined as [Card] (a list of cards).</p>\n\n<p>Due to a file read, I am stuck with the IO monad, specifically, I have an object with the type IO Deck. How would I retrieve the individual elements of the card list? Because of the IO monad, the type doesn't seem to be a list anymore so I cannot use the !! operator.</p>\n"}, {"tags": ["haskell", "bind", "sparql"], "comments": [{"owner": {"reputation": 14789, "user_id": 757100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/442cf0ccb33b748e24cd178f5efa0b35?s=128&d=identicon&r=PG", "display_name": "AndyS", "link": "https://stackoverflow.com/users/757100/andys"}, "edited": false, "score": 0, "creation_date": 1420133088, "post_id": 27731563, "comment_id": 43877280, "body": "If hsparql only covers SPARQL 1.0, there is no way to set the value of a variable except from the data (i.e a triple pattern)."}], "owner": {"reputation": 11, "user_id": 4410242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd43d07585db6d0f4788693f6ebbb063?s=128&d=identicon&r=PG&f=1", "display_name": "Samir J. Sohoni", "link": "https://stackoverflow.com/users/4410242/samir-j-sohoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420121835, "creation_date": 1420121835, "question_id": 27731563, "link": "https://stackoverflow.com/questions/27731563/how-do-i-use-the-sparql-bind-in-hsparql", "title": "How do I use the SPARQL BIND in hsparql?", "body": "<p>I would like someone to show how the BIND from SPARQL can be used in haskell hsparql module. </p>\n\n<p>I have the following query;</p>\n\n<p>select ?t\nwhere {\n BIND (5 as ?t)\n}</p>\n\n<p>How what can be the equivalent in haskell using hsparql? </p>\n\n<p>I checked the examples on the the page <a href=\"https://github.com/robstewart57/hsparql/blob/master/tests/DBPedia.hs\" rel=\"nofollow\">https://github.com/robstewart57/hsparql/blob/master/tests/DBPedia.hs</a> but found nothing which directly addresses my query.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "nixos", "hoogle"], "answers": [{"tags": [], "owner": {"reputation": 2393, "user_id": 10486, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa8d1aa7a81deba551fe80024ef74528?s=128&d=identicon&r=PG", "display_name": "William Casarin", "link": "https://stackoverflow.com/users/10486/william-casarin"}, "is_accepted": true, "score": 14, "last_activity_date": 1450080318, "last_edit_date": 1450080318, "creation_date": 1450053901, "answer_id": 34258218, "question_id": 27728838, "link": "https://stackoverflow.com/questions/27728838/using-hoogle-in-a-haskell-development-environment-on-nix/34258218#34258218", "title": "Using hoogle in a haskell development environment on nix", "body": "<p>Here's what my Nix Haskell dev environment looks like</p>\n\n<p>in <code>~/.nixpkgs/config.nix</code>:</p>\n\n<h2>The environment helper function</h2>\n\n<p>First off, define a haskellEnvFun function for building Haskell environments:</p>\n\n<pre><code>packageOverrides = super: rec {\n\nhaskellEnvFun = { withHoogle ? false, compiler ? null, name }:\n  let hp = if compiler != null\n             then super.haskell.packages.${compiler}\n             else haskellPackages;\n\n      ghcWith = if withHoogle\n                  then hp.ghcWithHoogle\n                  else hp.ghcWithPackages;\n\n  in super.buildEnv {\n    name = name;\n    paths = [(ghcWith myHaskellPackages)];\n  };\n</code></pre>\n\n<h2>Defining some environments</h2>\n\n<p>Call this function to define two environments: one for running the Hoogle builder on changes, and one without:</p>\n\n<pre><code>haskellEnvHoogle = haskellEnvFun {\n  name = \"haskellEnvHoogle\";\n  withHoogle = true;\n};\n\nhaskellEnv = haskellEnvFun {\n  name = \"haskellEnv\";\n  withHoogle = false;\n};\n</code></pre>\n\n<h2>Packages</h2>\n\n<p>Define all the packages you want to use in your local Haskell dev environment:</p>\n\n<pre><code>myHaskellPackages = hp: with hp; [\n  Boolean\n  HTTP\n  HUnit\n  MissingH\n  QuickCheck\n  SafeSemaphore\n  Spock\n  aeson\n  async\n  attoparsec\n  bifunctors\n  blaze-builder\n  blaze-builder-conduit\n  blaze-builder-enumerator\n  blaze-html\n  blaze-markup\n  blaze-textual\n  cased\n  cassava\n  cereal\n  comonad\n  comonad-transformers\n  directory_1_2_4_0\n  dlist\n  dlist-instances\n  doctest\n  exceptions\n  fingertree\n  foldl\n  free\n  hamlet\n  hashable\n  hspec\n  hspec-expectations\n  html\n  http-client\n  http-date\n  http-types\n  io-memoize\n  keys\n  language-c\n  language-javascript\n  language-bash\n  lens\n  lens-action\n  lens-aeson\n  lens-datetime\n  lens-family\n  lens-family-core\n  lifted-async\n  lifted-base\n  linear\n  list-extras\n  list-t\n  logict\n  mime-mail\n  mime-types\n  mmorph\n  monad-control\n  monad-coroutine\n  monad-loops\n  monad-par\n  monad-par-extras\n  monad-stm\n  monadloc\n  mongoDB\n  monoid-extras\n  network\n  newtype\n  numbers\n  optparse-applicative\n  parsec\n  parsers\n  pcg-random\n  persistent\n  persistent-mongoDB\n  persistent-template\n  pipes\n  pipes-async\n  pipes-attoparsec\n  pipes-binary\n  pipes-bytestring\n  pipes-concurrency\n  pipes-csv\n  pipes-extras\n  pipes-group\n  pipes-http\n  pipes-mongodb\n  pipes-network\n  pipes-parse\n  pipes-safe\n  pipes-shell\n  pipes-text\n  posix-paths\n  postgresql-simple\n  pretty-show\n  profunctors\n  random\n  reducers\n  reflection\n  regex-applicative\n  regex-base\n  regex-compat\n  regex-posix\n  regular\n  relational-record\n  resourcet\n  retry\n  rex\n  safe\n  sbv\n  scotty\n  semigroupoids\n  semigroups\n  shake\n  shakespeare\n  shelly\n  simple-reflect\n  speculation\n  split\n  spoon\n  stm\n  stm-chans\n  stm-stats\n  streaming\n  streaming-bytestring\n  streaming-wai\n  strict\n  stringsearch\n  strptime\n  syb\n  system-fileio\n  system-filepath\n  tagged\n  taggy\n  taggy-lens\n  tar\n  tardis\n  tasty\n  tasty-hspec\n  tasty-hunit\n  tasty-quickcheck\n  tasty-smallcheck\n  temporary\n  test-framework\n  test-framework-hunit\n  text\n  text-format\n  time\n  tinytemplate\n  transformers\n  transformers-base\n  turtle\n  uniplate\n  unix-compat\n  unordered-containers\n  uuid\n  vector\n  void\n  wai\n  wai-conduit\n  warp\n  wreq\n  xhtml\n  yaml\n  zippers\n  zlib\n];\n</code></pre>\n\n<h2>Shell helpers</h2>\n\n<p>In your <code>~/.profile</code> define a couple bash functions to load those environments for convenience:</p>\n\n<pre>\nenv-type () {\n  envtype=\"$1\"\n  shift\n  nix-shell -Q -p $envtype \"$@\"\n}\n\nhaskell-env () {\n  env-type \"haskellEnv\" \"$@\"\n}\n\nhaskell-env-hoogle () {\n  env-type \"haskellEnvHoogle\" \"$@\"\n}\n</pre>\n\n<h2>Hoogle</h2>\n\n<p>Call <code>haskell-env-hoogle</code> in your shell. This will build all of your packages + docs and load you into an environment with <code>hoogle</code> in scope. At this point I usually type:</p>\n\n<pre><code>hoogle server --local -p 8080 &amp;&gt; /tmp/hoogle.log &amp; disown\n</code></pre>\n\n<p>to launch a hoogle server the the background. Eventually I want to have a systemd service for this so that I can just nixos-rebuild to regen docs and launch the server automatically.</p>\n\n<h2>Emacs</h2>\n\n<p>For emacs I've set the <code>haskell-hoogle-url</code> to <code>http://localhost:8080/?hoogle=%s</code>, so that I can get local hoogle docs for keywords under my cursor. I use spacemacs so I just type <code>, h h</code> for this functionality.</p>\n\n<p>You can see my full nixpkgs config here: <a href=\"https://github.com/jb55/nix-files/blob/659798f2ca81fb7ad0cb5a29de576024ee16eef8/nixpkgs/config.nix#L20\" rel=\"noreferrer\">https://github.com/jb55/nix-files/blob/659798f2ca81fb7ad0cb5a29de576024ee16eef8/nixpkgs/config.nix#L20</a></p>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 2393, "user_id": 10486, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa8d1aa7a81deba551fe80024ef74528?s=128&d=identicon&r=PG", "display_name": "William Casarin", "link": "https://stackoverflow.com/users/10486/william-casarin"}, "edited": false, "score": 0, "creation_date": 1452868081, "post_id": 34583430, "comment_id": 57368355, "body": "Yup! I used to do it this way. When writing lots of Haskell code I find it easier to just have everything in one shell for rapid development. But this works great if you only have one project you&#39;re working on."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 13, "last_activity_date": 1451869175, "creation_date": 1451869175, "answer_id": 34583430, "question_id": 27728838, "link": "https://stackoverflow.com/questions/27728838/using-hoogle-in-a-haskell-development-environment-on-nix/34583430#34583430", "title": "Using hoogle in a haskell development environment on nix", "body": "<p><code>haskellPackages.hoogleLocal</code> appears to be out of date; it doesn't exist anymore.</p>\n\n<p>William Casarin's answer appears to be assuming you will have a single \"haskell development environment\" you use, rather than using nix-shell to have different dev environments for different projects.</p>\n\n<p>What I've just figured out how to do instead is to write my shell.nix to override <code>ghc.withPackages</code> and <code>ghcWithPackages</code> to be <code>ghc.withHoogle</code>, so that when nix-shell creates an environment with a GHC that knows about all the necessary packages it also creates a hoogle database that knows about the same packages.</p>\n\n<p>Here's my shell.nix<sup>1</sup>:</p>\n\n<pre><code>{ nixpkgs ? import &lt;nixpkgs&gt; {}, compiler ? \"default\", withHoogle ? true }:\n\nlet\n\n  inherit (nixpkgs) pkgs;\n\n  f = import ./default.nix;\n\n  packageSet = (\n    if compiler == \"default\"\n      then  pkgs.haskellPackages\n      else  pkgs.haskell.packages.${compiler}\n  );\n\n  haskellPackages = (\n    if withHoogle\n      then  packageSet.override {\n              overrides = (self: super:\n                {\n                  ghc = super.ghc // { withPackages = super.ghc.withHoogle; };\n                  ghcWithPackages = self.ghc.withPackages;\n                }\n              );\n            }\n      else  packageSet\n  );\n\n  drv = haskellPackages.callPackage f {};\n\nin\n\n  if pkgs.lib.inNixShell then drv.env else drv\n</code></pre>\n\n<p>I'm newish to nix, but I believe this should be pretty much \"project independent\"; I can use <code>cabal2nix . &gt; default.nix</code> to generate a nix package from my cabal file when I change it, without having to touch shell.nix.</p>\n\n<p>I haven't actually used this in real development yet, only a dummy project I was using to try to figure out how to get hoogle working in nix-shell.</p>\n\n<hr>\n\n<p><sup>1</sup>The skeleton of this was what <code>cabal2nix --shell</code> spits out, with the project-specific guts removed and replaced with <code>f = import ./default.nix</code> instead of embedding the nixified cabal package again.</p>\n"}, {"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 2, "last_activity_date": 1564097670, "creation_date": 1564097670, "answer_id": 57211345, "question_id": 27728838, "link": "https://stackoverflow.com/questions/27728838/using-hoogle-in-a-haskell-development-environment-on-nix/57211345#57211345", "title": "Using hoogle in a haskell development environment on nix", "body": "<p>Using @Ben's answer as reference, here is a diff on the required changes I needed to make to a <code>cabal2nix --shell</code> file:</p>\n\n<pre><code>diff --git a/shell.nix b/shell.nix\nindex 540ade3..e207d6e 100644\n--- a/shell.nix\n+++ b/shell.nix\n@@ -1,4 +1,4 @@\n-{ nixpkgs ? import &lt;nixpkgs&gt; {}, compiler ? \"default\", doBenchmark ? false }:\n+{ nixpkgs ? import &lt;nixpkgs&gt; {}, compiler ? \"default\", doBenchmark ? false , withHoogle ? true}:\n\n let\n\n@@ -21,10 +21,23 @@ let\n         license = stdenv.lib.licenses.bsd3;\n       };\n\n-  haskellPackages = if compiler == \"default\"\n+  haskellPackages' = if compiler == \"default\"\n                        then pkgs.haskellPackages\n                        else pkgs.haskell.packages.${compiler};\n\n+  haskellPackages = (\n+    if withHoogle\n+    then  haskellPackages'.override {\n+      overrides = (self: super:\n+        {\n+          ghc = super.ghc // { withPackages = super.ghc.withHoogle; };\n+          ghcWithPackages = self.ghc.withPackages;\n+        }\n+      );\n+    }\n+    else haskellPackages'\n+  );\n+\n   variant = if doBenchmark then pkgs.haskell.lib.doBenchmark else pkgs.lib.id;\n\n   drv = variant (haskellPackages.callPackage f {});```\n</code></pre>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2947, "favorite_count": 7, "accepted_answer_id": 34258218, "answer_count": 3, "score": 14, "last_activity_date": 1564097670, "creation_date": 1420094543, "last_edit_date": 1550198735, "question_id": 27728838, "link": "https://stackoverflow.com/questions/27728838/using-hoogle-in-a-haskell-development-environment-on-nix", "title": "Using hoogle in a haskell development environment on nix", "body": "<p>I'm trying to use hoogle in a Haskell development environment exactly\nlike the one described by <a href=\"https://web.archive.org/web/20160407215009/http://wiki.ocharles.org.uk/Nix\" rel=\"nofollow noreferrer\">O'Charles' wiki</a>:</p>\n\n<p>I have modified <code>shell.nix</code> like below in order to use <code>hoogleLocal</code>, but it doesn't seem to install the hoogle binary for me.</p>\n\n<pre><code>let\n  pkgs = import &lt;nixpkgs&gt; {};\n\n  # I'm attempting to use hoogle here, but it is not working.\n  haskellPackages =\n    let callPackage = pkgs.lib.callPackageWith haskellPackages;\n    in pkgs.recurseIntoAttrs (pkgs.haskellPackages.override {\n      extension = self: super: {\n        thiscurrentpackage = self.callPackage ./. {};\n        hoogleLocal = pkgs.haskellPackages.hoogleLocal.override {\n          packages = self.thiscurrentpackage;\n        };\n      };\n    });\nin pkgs.myEnvFun {\n  name = haskellPackages.thiscurrentpackage.name;\n  buildInputs = [\n    (haskellPackages.ghcWithPackages (hs: ([\n      hs.cabalInstall\n      hs.ghcMod\n      hs.yesodBin\n      # This doesn't appear to install the hoogle binary?\n      hs.hoogleLocal\n    ] ++ hs.thiscurrentpackage.propagatedNativeBuildInputs)))\n  ];\n}\n</code></pre>\n\n<p>In the resulting shell, the <code>hoogle</code> binary is not available.</p>\n\n<p>If I include <code>hs.hoogle</code> to the <code>buildInputs</code>, the <code>hoogle</code> binary is installed but it can't find the databases.  Below is what happens when I try to use it.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ nix-shell\n......\n$ hoogle Monad\nCould not find some databases: default\nSearching in:\n  .\n    /nix/store/91y9q2y5a2ws8xgcsx1gkhfagc0f2qz6-haskell-hoogle-ghc7.8.3-4.2.36-shared/share/x86_64-linux-ghc-7.8.3/hoogle-4.2.36/databases\n\n    There are no available databases, generate them with: hoogle data\n$ hoogle data\n    hoogle: /nix/store/91y9q2y5a2ws8xgcsx1gkhfagc0f2qz6-haskell-hoogle-ghc7.8.3-4.2.36-shared/share/x86_64-linux-ghc-7.8.3/hoogle-4.2.36/databases:\nchangeWorkingDirectory: does not exist (No such file or directory)\n$\n</code></pre>\n\n<p>How do I get this working correctly for a setup like described by O'Charles?</p>\n\n<p><strong>Edit</strong>: The original shell.nix is the same one from <a href=\"https://stackoverflow.com/a/27284762/3040129\">this answer</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1420108284, "post_id": 27728255, "comment_id": 43871437, "body": "Would you agree that <code>mapM</code> is useful? I think it is obvious that &quot;perform this action on every element of the collection&quot; is a ubiquitous concept. This is what <code>mapM&#47;A</code> are. <code>mapA</code> is <code>mapM</code> for Applicative. Since not every Applicative is a Monad, you may sometimes want a function with the &quot;shape&quot; of <code>mapM</code> which only requires the Applicative constraint. Hence, <code>mapA</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1420141128, "post_id": 27728255, "comment_id": 43879439, "body": "<code>mapA f = dist . map f</code>, where <code>dist</code> is from your <a href=\"http://stackoverflow.com/questions/27350924/applicative-distributor-for-list-dist-function\">question</a>."}, {"owner": {"reputation": 2133, "user_id": 2494576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69dcf21a7cf379c1f25476d80a73338f?s=128&d=identicon&r=PG", "display_name": "felix-eku", "link": "https://stackoverflow.com/users/2494576/felix-eku"}, "edited": false, "score": 0, "creation_date": 1420146968, "post_id": 27728255, "comment_id": 43880867, "body": "You can also find a implenmentation of this function in the list instance of <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/src/Data-Traversable.html\" rel=\"nofollow noreferrer\"><code>Data.Traversable</code></a>"}, {"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 1, "creation_date": 1420166677, "post_id": 27728255, "comment_id": 43885072, "body": "<a href=\"http://www.cs.ox.ac.uk/jeremy.gibbons/publications/iterator.pdf\" rel=\"nofollow noreferrer\">The essence of the iterator pattern</a> describe several uses for the idiom, using the more general <code>traverse</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 8440, "user_id": 402428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17015101f2649d332c389337897816b?s=128&d=identicon&r=PG", "display_name": "michid", "link": "https://stackoverflow.com/users/402428/michid"}, "edited": false, "score": 1, "creation_date": 1451924648, "post_id": 27728454, "comment_id": 56936132, "body": "&quot;but immediately you can see that glom provides exactly what we&#39;re looking&quot;. I can&#39;t."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 8440, "user_id": 402428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17015101f2649d332c389337897816b?s=128&d=identicon&r=PG", "display_name": "michid", "link": "https://stackoverflow.com/users/402428/michid"}, "edited": false, "score": 0, "creation_date": 1451927869, "post_id": 27728454, "comment_id": 56937978, "body": "Normally we&#39;d have <code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</code> but we can get that with <code>glom</code> as <code>f &lt;*&gt; a = fmap ($) (glom f a)</code>. Try it out!"}, {"owner": {"reputation": 8440, "user_id": 402428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17015101f2649d332c389337897816b?s=128&d=identicon&r=PG", "display_name": "michid", "link": "https://stackoverflow.com/users/402428/michid"}, "edited": false, "score": 0, "creation_date": 1451931928, "post_id": 27728454, "comment_id": 56940236, "body": "But why is the equivalence of Monoidal and Applicative relevant to the original question (which is how to implement mapA)?"}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 8440, "user_id": 402428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17015101f2649d332c389337897816b?s=128&d=identicon&r=PG", "display_name": "michid", "link": "https://stackoverflow.com/users/402428/michid"}, "edited": false, "score": 0, "creation_date": 1451932178, "post_id": 27728454, "comment_id": 56940367, "body": "Because <code>Monoidal</code> more clearly indicates how <code>Applicative</code>&#39;s core is the ability to smash functors together using a standard product. This is obscured by the <code>Applicative</code> formulation."}], "tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": false, "score": 3, "last_activity_date": 1420089509, "creation_date": 1420089509, "answer_id": 27728454, "question_id": 27728255, "link": "https://stackoverflow.com/questions/27728255/understanding-mapa-to-gain-intuition/27728454#27728454", "title": "Understanding `mapA` to Gain Intuition", "body": "<p>If we knew nothing at all about <code>f</code> then a function like <code>a -&gt; f b</code> would let us put things into <code>f</code>-boxes but then we'd be completely stuck. You're probably familiar with <code>Functor</code>. If we know <code>f</code> were a <code>Functor</code> then we'd be able to transform the thing inside of <code>f</code>, but we're still basically stuck---<code>f</code> forms an unmoving wall we cannot cross.</p>\n\n<p>Why do we care? Well, when we try to construct the function <code>[a] -&gt; f [b]</code> we need to some how operate on a collection of <code>a</code>s. We could, perhaps, just pull the first one off if we liked (and it existed) and  feed it through <code>a -&gt; f b</code> then wrap the result in a list:</p>\n\n<pre><code>unsatisfying :: Functor f =&gt; (a -&gt; f b) -&gt; ([a] -&gt; f [b])\nunsatisfying inject (a : _) = fmap (\\x -&gt; [x]) (inject a)\n</code></pre>\n\n<p>but not only do we have an incomplete pattern match on <code>[a]</code>, we're clearly violating something in the spirit of this function---we'd much prefer to use all of the <code>a</code>s. Unfortunately, knowing only <code>f</code> or even that <code>f</code> is a <code>Functor</code> gets us only as far as</p>\n\n<pre><code>stillUnsatisfying :: Functor f =&gt; (a -&gt; f b) -&gt; ([a] -&gt; [f b])\nstillUnsatisfying inject as = map inject as\n</code></pre>\n\n<p>The problem is that just because we have a collection of <code>f</code>-containers doesn't mean we can find any way to treat them collectively. We'd like to somehow \"glue\" our collection <code>[f b]</code> all together. If we could do that then a function like <code>[a] -&gt; f [b]</code> would sound like \"explode our list <code>[a]</code> into pieces, pass them each individually into <code>f</code> using <code>inject</code>, glom all of the <code>(f b)</code>s together, and then reassemble the list on the inside\".</p>\n\n<p>Clearly we need a way to \"glom\" <code>Functor</code>s together and also a way to operate on the separate pieces \"on the inside\" of <code>f</code>.</p>\n\n<p>So this is where <code>Applicative</code> comes in. I'm not going to introduce it exactly, though. Instead, let's look at an equivalent type class</p>\n\n<pre><code>class Functor f =&gt; Monoidal f where\n  basic :: a -&gt; f a\n  glom  :: f a -&gt; f b -&gt; f (a, b)\n</code></pre>\n\n<p>It's an interesting exercise to prove that <code>Monoidal</code> and <code>Applicative</code> are equivalent, but immediately you can see that <code>glom</code> provides exactly what we're looking for. Moreover, <code>basic</code>/<code>pure</code> give us the ability to inject raw pieces of our list into <code>f</code> as we need them (for instance, if our <code>[a]</code> is empty then we'll need to inject an empty list into <code>f</code> without using <code>a -&gt; f b</code> as we cannot---that looks like <code>basic [] :: f [b]</code>).</p>\n\n<p>So <code>Applicative</code> provides you the ability to not only transform inside of functors but also to glom a bunch of functors together and operate on all of their pieces inside of the functor.</p>\n"}, {"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": false, "score": 0, "last_activity_date": 1420119401, "last_edit_date": 1420119401, "creation_date": 1420107892, "answer_id": 27729936, "question_id": 27728255, "link": "https://stackoverflow.com/questions/27728255/understanding-mapa-to-gain-intuition/27729936#27729936", "title": "Understanding `mapA` to Gain Intuition", "body": "<p>We already know that <code>map :: (a -&gt; b) -&gt; ([a] -&gt; [b])</code> is useful.  It applies a function to every element of a list.</p>\n\n<p>A loose but enlightening interpretation of <code>a -&gt; f b</code> for an applicative <code>f</code> is that it is a function which takes an <code>a</code>, performs an applicative \"action\", and returns a <code>b</code>.  For example if <code>f</code> is <code>IO</code> then the \"action\" might be reading from a disk.  <code>mapA :: (a -&gt; f b) -&gt; ([a] -&gt; f [b])</code> can be interpreted as applying this \"function\" to every element of the list.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1420136961, "creation_date": 1420136961, "answer_id": 27733440, "question_id": 27728255, "link": "https://stackoverflow.com/questions/27728255/understanding-mapa-to-gain-intuition/27733440#27733440", "title": "Understanding `mapA` to Gain Intuition", "body": "<p>You're halfway there, but the final function you're looking for is the <code>sequenceA</code> function that's defined in LYAH. Here's my implementation:</p>\n\n<pre><code>sequenceA :: Applicative f =&gt; [f a] -&gt; f [a]\nsequenceA = foldr ((&lt;*&gt;) . fmap (:)) (pure [])\n</code></pre>\n\n<p>From there the <code>mapA</code> function is easy as pie. Just add another argument and compose the two functions:</p>\n\n<pre><code>mapA :: Applicative f =&gt; (a -&gt; f b) -&gt; [a] -&gt; f [b]\nmapA f xs = foldr ((&lt;*&gt;) . fmap (:) . f) (pure []) xs\n-- Or, you could implement it this more elegant, albeit slightly slower, way:\nmapA = (sequenceA .) . map\n</code></pre>\n\n<p>And there you have an implementation for you to have a look at. As for the usefulness, it's particularly useful in IO, when you have a list like <code>[\"Foo\",\"Bar\",\"Baz\"]</code>, and you'd like to <code>putStrLn</code> all of those functions. Do do so, you will need to map each value and the <code>sequence</code> it, which <code>mapA</code> does. Note that these functions have monadic equivalents, but it's a good exercise to implement them in purely <code>Applicative</code> ways. </p>\n\n<p>These functions are both quite useful when dealing with lists of <code>Applicative</code>s, allowing one to more easily manipulate the values inside them without using half a ton of <code>fmap</code>s.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1420136961, "creation_date": 1420086383, "last_edit_date": 1420093340, "question_id": 27728255, "link": "https://stackoverflow.com/questions/27728255/understanding-mapa-to-gain-intuition", "title": "Understanding `mapA` to Gain Intuition", "body": "<p>I'm working on an exercise from Brent Yorgey's 2013 UPenn <a href=\"http://www.cis.upenn.edu/~cis194/spring13/lectures/11-applicative2.html\" rel=\"nofollow\">lecture</a> to implement <code>mapA</code>.</p>\n\n<p><code>mapA :: Applicative f =&gt; (a -&gt; f b) -&gt; ([a] -&gt; f [b])</code></p>\n\n<p>I'm trying to gain intuition for this function. How is this function useful? I'm not questioning its utility - just trying to understand it.</p>\n\n<p>Additionally, I'm looking for a hint to go from <code>a -&gt; f b</code> to <code>[a] -&gt; f [b]</code>.</p>\n"}, {"tags": ["haskell", "random", "unique"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1420080990, "post_id": 27727980, "comment_id": 43867867, "body": "Will you use all the values?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420081893, "post_id": 27727980, "comment_id": 43867954, "body": "What is the goal? <code>System.Random</code> isn&#39;t secure and doesn&#39;t even give good random values."}, {"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 0, "creation_date": 1420081962, "post_id": 27727980, "comment_id": 43867960, "body": "Yes, I want a list (or set) of six numbers with no duplicates, as in a lottery where numbered balls are drawn from a set."}, {"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 0, "creation_date": 1420084357, "post_id": 27727980, "comment_id": 43868200, "body": "The goal is to learn how to build a list monadically using filtering. It&#39;s a raw newbie question. Also, if System. Random does not give good values, what does?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420094973, "post_id": 27727980, "comment_id": 43869414, "body": "See the tf-random package for one example."}, {"owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1420120121, "post_id": 27727980, "comment_id": 43874060, "body": "@ThomasM.DuBuisson the RNG in <code>System.Random</code> is good enough for this task. Also <code>System.Random</code> includes the <code>RandomGen</code> class, allowing you to write a instance for every RNG you can imagine. Relative to Occam&#39;s razor, <code>System.Random</code> is the base module you should use every time, when you handle random numbers."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "edited": false, "score": 0, "creation_date": 1420126929, "post_id": 27727980, "comment_id": 43875638, "body": "@Vektorweg I couldn&#39;t disagree more.   <code>System.Random</code> is about only useful for education or quick prototypes.  For example, in property checking it can result in tests erroneously passing even when a large portion of the domain would fail.  The <code>RandomGen</code> class fails in at least three ways 1) It can only generate <code>Int</code>s 2) Users must break abstraction to create generators 3) Generators can&#39;t fail without exceptions.  For these reasons <code>System.Random</code> is the module you should avoid every time you handle random numbers."}], "answers": [{"comments": [{"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 2, "creation_date": 1420082005, "post_id": 27728017, "comment_id": 43867965, "body": "The question is how to do this in Haskell specifically."}, {"owner": {"reputation": 2063, "user_id": 562106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b32f903b988a6463c473a15fd897313?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/562106/nick"}, "reply_to_user": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 1, "creation_date": 1420127967, "post_id": 27728017, "comment_id": 43875900, "body": "What I think is important is that the Fisher Yates Shuffle won&#39;t produce duplicates, so it a good algorithm to use (if possible in Haskell). :)"}], "tags": [], "owner": {"reputation": 2063, "user_id": 562106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b32f903b988a6463c473a15fd897313?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/562106/nick"}, "is_accepted": false, "score": 1, "last_activity_date": 1420081464, "creation_date": 1420081464, "answer_id": 27728017, "question_id": 27727980, "link": "https://stackoverflow.com/questions/27727980/random-numbers-without-duplicates/27728017#27728017", "title": "Random numbers without duplicates", "body": "<p>I've used the <a href=\"http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow\">Fisher Yates Shuffle</a> in C++ with a decent random number generator to great success.  This approach is very efficient if you are willing to allocate an array for holding numbers 1 to 40.</p>\n"}, {"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1420108423, "post_id": 27729418, "comment_id": 43871465, "body": "Instead of <code>take i avail ++ drop (i+1) avail</code> use <code>splitAt i avail</code>."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 1, "creation_date": 1420127635, "post_id": 27729418, "comment_id": 43875811, "body": "Suppose we would have to draw 6 numbers between 0 and 100000. Would you still randomly shuffle <code>[1..100000]</code> and then take the first 6?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1420129280, "last_edit_date": 1420129280, "creation_date": 1420101934, "answer_id": 27729418, "question_id": 27727980, "link": "https://stackoverflow.com/questions/27727980/random-numbers-without-duplicates/27729418#27729418", "title": "Random numbers without duplicates", "body": "<p>If you don't mind using a library, then install the <a href=\"https://hackage.haskell.org/package/random-shuffle\" rel=\"nofollow\">random-shuffle package</a> and use it like this:</p>\n\n<pre><code>import System.Random.Shuffle\nimport Control.Monad.Random\n\nmain1 = do\n  perm &lt;- evalRandIO $ shuffleM [1..10]\n  print perm\n</code></pre>\n\n<p>If you want to see how to implement a naive Fischer-Yates shuffle using lists in Haskell, have a look at this code:</p>\n\n<pre><code>  shuffle2 xs g = go [] g (length xs) xs\n    where\n      go perm g n avail\n        | n == 0    = (perm,g)\n        | otherwise = let (i, g') = randomR (0,n-1) g\n                          a = avail !! i\n                          -- can also use splitAt to define avail':\n                          avail' = take i avail ++ drop (i+1) avail\n                      in go (a:perm) g' (n-1) avail'\n\n  main = do\n    perm &lt;- evalRandIO $ liftRand $ shuffle2 [1..10]\n    print perm\n</code></pre>\n\n<p>The parameters to the <code>go</code> helper function are:</p>\n\n<ul>\n<li><code>perm</code> - the constructed permutation so far</li>\n<li><code>g</code> - the current generator value</li>\n<li><code>n</code> - the length of the available items</li>\n<li><code>avail</code> - the available items - i.e. items not yet selected to be part of the permutation</li>\n</ul>\n\n<p><code>go</code> simply adds a random element from <code>avail</code> to the permutation being constructed and recursively calls itself with the new avail list and new generator.</p>\n\n<p>To only draw <code>k</code> random elements from <code>xs</code>, just start <code>go</code> at <code>k</code> instead of <code>length xs</code>:</p>\n\n<pre><code>shuffle2 xs k g = go [] g k xs\n  ...\n</code></pre>\n\n<p>You could also use a temporary array (in the ST or IO monad) to implement a Fischer-Yates type algorithm. The <code>shuffleM</code> function in <code>random-shuffle</code> uses a yet completely different approach which you might find interesting.</p>\n\n<p><em>Update:</em> Here is an example of using an ST-array in a F-Y style algorithm:</p>\n\n<pre><code>import Control.Monad.Random\nimport Data.Array.ST\nimport Control.Monad\nimport Control.Monad.ST (runST, ST)\n\nshuffle3 :: RandomGen g =&gt; Int -&gt; g -&gt; ([Int], g)\nshuffle3 n g0 = runST $ do\n  arr &lt;- newListArray (1,n) [1..n] :: ST s (STUArray s Int Int)\n  let step g i = do let (j,g') = randomR (1,n) g\n                    -- swap i and j\n                    a &lt;- readArray arr i\n                    b &lt;- readArray arr j\n                    writeArray arr j a\n                    writeArray arr i b\n                    return g'\n  g' &lt;- foldM step g0 [1..n]\n  perm &lt;- getElems arr\n  return (perm, g')\n\nmain = do\n  perm &lt;- evalRandIO $ liftRand $ shuffle3 20\n  print perm\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": false, "score": 0, "last_activity_date": 1420130414, "last_edit_date": 1420130414, "creation_date": 1420115485, "answer_id": 27730822, "question_id": 27727980, "link": "https://stackoverflow.com/questions/27727980/random-numbers-without-duplicates/27730822#27730822", "title": "Random numbers without duplicates", "body": "<p>You commented:</p>\n\n<blockquote>\n  <p>The goal is to learn how to build a list monadically using filtering. It's a raw newbie question</p>\n</blockquote>\n\n<p>Maybe you should change the question title then! Anyways, this is quite a common task. I usually define a combinator with a general monadic type that does what I want, give it a descriptive name (which I didn't quite succeed in here :-) and then use it, like below</p>\n\n<pre><code>import Control.Monad\nimport System.Random\n\n-- | 'myUntil': accumulate a list with unique action results until the list \n-- satisfies a test                                                        \nmyUntil :: (Monad m, Eq a) =&gt; ([a] -&gt; Bool) -&gt; m a -&gt; m [a]\nmyUntil test action = myUntil' test [] action where\n  myUntil' test resultSoFar action = do\n     if test resultSoFar then\n       return resultSoFar\n     else do\n       x &lt;- action\n       let newResults = if x `elem` resultSoFar then resultSoFar \n                                                else resultSoFar ++ [x] -- x:resultSoFar\n       myUntil' test newResults action\n\nmain :: IO ()\nmain = do\n    let enough xs = length xs == 6\n        drawNumber  = randomRIO (0, 40::Int)\n    numbers &lt;- myUntil enough drawNumber\n    print numbers\n</code></pre>\n\n<p>NB: this is not the optimal way to get your 6 distinct numbers, but meant as an example how to, <em>in general</em>,  build a list monadically using a filter that works on <em>the entire list</em></p>\n\n<p>It is in essence the same as Vektorweg's longest answer, but uses a combinator with a much more general type (which is the way I like to do it, which may be more useful for you, given your comment at the top of this answer)</p>\n"}, {"comments": [{"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1420119453, "post_id": 27731095, "comment_id": 43873925, "body": "Nice. Because it returns an (infinite) <i>pseudo</i>-random list, <code>randomRs</code> can be pure, and you can use it with <code>nub</code>. If you need <i>real</i> random values (e.g. from <code>&#47;dev&#47;urandom</code>) you will still need a kind of monadic <code>while</code> or <code>until</code>, as the question-asker was trying."}, {"owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "reply_to_user": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1420121106, "post_id": 27731095, "comment_id": 43874247, "body": "@HansLub I can&#39;t imagine a situation where you need <i>real</i> random values."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 1, "creation_date": 1420124197, "post_id": 27731095, "comment_id": 43874982, "body": "I read the question more like: how does one gather a list of results of monadic actions, until the list satisfies some criterion. I see that you give an example in your <i>other</i> answer. Nice again!"}], "tags": [], "owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "is_accepted": false, "score": 4, "last_activity_date": 1420118653, "last_edit_date": 1420118653, "creation_date": 1420117889, "answer_id": 27731095, "question_id": 27727980, "link": "https://stackoverflow.com/questions/27727980/random-numbers-without-duplicates/27731095#27731095", "title": "Random numbers without duplicates", "body": "<p>The function you are looking for is <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-List.html#v:nub\" rel=\"nofollow\"><code>nub</code></a> from <code>Data.List</code>, to filter dublicates.</p>\n\n<pre><code>import Data.List\nimport System.Random\n\nmain = do\n    g &lt;- newStdGen\n    print . take 6 . nub $ (randomRs (1,40) g :: [Int])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "is_accepted": false, "score": 1, "last_activity_date": 1420124248, "last_edit_date": 1420124248, "creation_date": 1420123458, "answer_id": 27731744, "question_id": 27727980, "link": "https://stackoverflow.com/questions/27727980/random-numbers-without-duplicates/27731744#27731744", "title": "Random numbers without duplicates", "body": "<p>Going the strict IO way requires to break down <code>nub</code>, bringing the condition into the tail recursion.</p>\n\n<pre><code>import System.Random\n\nrandsf :: (Eq a, Num a, Random a) =&gt; [a] -&gt; IO [a]\nrandsf rs\n    | length rs &gt; 6 = return rs\n    | otherwise = do\n        r &lt;- randomRIO (1,40)\n        if elem r rs \n            then randsf rs \n            else randsf (r:rs)\n\nmain = do\n    rs &lt;- randsf [] :: IO [Int]\n    print rs\n</code></pre>\n\n<p>If you know what you do <code>unsafeInterleaveIO</code> from <code>System.IO.Unsafe</code> can be handy, allowing you to generate lazy lists from IO. Functions like <code>getContents</code> work this way.</p>\n\n<pre><code>import Control.Monad\nimport System.Random\nimport System.IO.Unsafe\nimport Data.List\n\nrands :: (Eq a, Num a, Random a) =&gt; IO [a]\nrands = do \n    r &lt;- randomRIO (1,40)\n    unsafeInterleaveIO $ liftM (r:) rands\n\nmain = do \n    rs &lt;- rands :: IO [Int]\n    print . take 6 $ nub rs\n</code></pre>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1464, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1420130414, "creation_date": 1420080791, "last_edit_date": 1420081251, "question_id": 27727980, "link": "https://stackoverflow.com/questions/27727980/random-numbers-without-duplicates", "title": "Random numbers without duplicates", "body": "<p>Simulating a lottery of 6 numbers chosen from 40, I want to create a list of numbers in Haskell using the system random generator but eliminate duplicates, which often arise.</p>\n\n<p>If I have the following:</p>\n\n<pre><code>import System.Random\n\nmain :: IO ()\nmain = do\n  rs &lt;- forM [1..6] $ \\_x -&gt; randomRIO (1, 40) :: (IO Int)\n  print rs\n</code></pre>\n\n<p>this is halfway. But how do I filter out duplicates? It seems to me I need a while loop of some sort to construct a list filtering elements that are already in the list until the list is the required size. If I can generate an infinite list of random numbers and filter it inside the IO monad I am sure that would work, but I do not know how to approach this. It seems while loops are generally deprecated in Haskell, so I am uncertain of the true Haskeller's way here. Is this a legitimate use case for a while loop, and if so, how does one do that?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 8, "last_activity_date": 1420104637, "last_edit_date": 1420104637, "creation_date": 1420074578, "answer_id": 27727640, "question_id": 27727575, "link": "https://stackoverflow.com/questions/27727575/reader-applicatives-apply-function/27727640#27727640", "title": "Reader Applicative&#39;s Apply Function", "body": "<p>If we substitute <code>((-&gt;) e)</code> for <code>f</code> (remembering that this is a function with <code>e</code> as its argument type), we get:</p>\n\n<pre><code>(&lt;*&gt;) ::     f    (a -&gt; b)  -&gt;    f     a  -&gt;    f    b\n(&lt;*&gt;) :: ((-&gt;) e) (a -&gt; b)  -&gt; ((-&gt;) e) a  -&gt; ((-&gt;) e) b  -- Replace f with ((-&gt;) e)\n(&lt;*&gt;) ::    (e -&gt; (a -&gt; b)) -&gt;    (e -&gt; a) -&gt;    (e -&gt; b) -- Apply ((-&gt;) e)\n(&lt;*&gt;) ::    (e -&gt;  a -&gt; b)  -&gt;    (e -&gt; a) -&gt;     e -&gt; b  -- Remove unneeded parentheses\n</code></pre>\n\n<p>A key thing to remember is that <code>((-&gt;) e) a</code> is the same as <code>e -&gt; a</code>. The notation can look a bit misleading at first.</p>\n\n<p>The only implementation for this type is the one you have provided in your question. This definition can also be written as:</p>\n\n<pre><code>f &lt;*&gt; x = \\e -&gt; f e (x e)\n</code></pre>\n\n<p>or, using prefix notation:</p>\n\n<pre><code>(&lt;*&gt;) f x e = f e (x e)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1420102867, "post_id": 27728189, "comment_id": 43870494, "body": "This is true, but how does it answer the question?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1420523728, "post_id": 27728189, "comment_id": 43995158, "body": "That looks like it mostly explains the <code>ZipList</code> instance of <code>Applicative</code> specifically. It doesn&#39;t seem to apply so much to many of the other instances: <code>[]</code> and <code>Const a</code> come to mind. I&#39;m also not sure how that fits with <code>(-&gt;) e</code>. It looks like you&#39;re saying that each <code>ai</code> gets applied to a corresponding index but, as you said later, with <code>(-&gt;) e</code> the index stays the same."}], "tags": [], "owner": {"reputation": 1338, "user_id": 770110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dae11b30544529b3c0836855a14cd653?s=128&d=identicon&r=PG", "display_name": "Vlad Patryshev", "link": "https://stackoverflow.com/users/770110/vlad-patryshev"}, "is_accepted": false, "score": -2, "last_activity_date": 1420214730, "last_edit_date": 1420214730, "creation_date": 1420084959, "answer_id": 27728189, "question_id": 27727575, "link": "https://stackoverflow.com/questions/27727575/reader-applicatives-apply-function/27728189#27728189", "title": "Reader Applicative&#39;s Apply Function", "body": "<p>Looks like S combinator to me. (It's not an answer, it's a comment.)</p>\n\n<p>My explanation is this:</p>\n\n<p>Applicative operation is pretty much like zipping. In our specific case we have two entities (<code>f</code> and <code>a</code>) that both depend on <code>e</code>. So zipping them together produces another entity that depends on e again: and when called, it uses the same e for the left and for the right part. Compare to this:</p>\n\n<p>We have f<sub>0</sub>, f<sub>1</sub>, f<sub>2</sub>, etc, and a<sub>0</sub>, a<sub>1</sub>, a<sub>2</sub>, etc. When zipping them, we get (f<sub>0</sub>,a<sub>0</sub>), (f<sub>1</sub>,a<sub>1</sub>), (f<sub>2</sub>,a<sub>2</sub>) etc.</p>\n\n<p>In applicative case, we also apply <code>fi</code> to <code>ai</code>, so we get (f<sub>0</sub> a<sub>0</sub>), (f<sub>1</sub> a<sub>1</sub>), (f<sub>2</sub> a<sub>2</sub>) etc. Note that we use the same index for <code>f</code> and <code>a</code>. If we consider the index as environment (we \"read\" the index), here we go, it's the same thing. And also, that's how S combinator works.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1420214730, "creation_date": 1420073352, "question_id": 27727575, "link": "https://stackoverflow.com/questions/27727575/reader-applicatives-apply-function", "title": "Reader Applicative&#39;s Apply Function", "body": "<p>Looking at the <code>reader or environment applicative</code> from Brent Yorgey's UPenn 2013 <a href=\"http://www.cis.upenn.edu/~cis194/spring13/lectures/11-applicative2.html\">Lecture</a>:</p>\n\n<pre><code>instance Functor ((-&gt;) e) where\n  fmap = (.)\n\ninstance Applicative ((-&gt;) e) where\n  pure = const\n  f &lt;*&gt; x = \\e -&gt; (f e) (x e)\n</code></pre>\n\n<p>I'm trying to gain intuition for the Applicative instance.</p>\n\n<p>Given:</p>\n\n<p><code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code></p>\n\n<p>then how does <code>\\e -&gt; (f e) (x e)</code> result in the <code>f b</code> type?</p>\n"}]