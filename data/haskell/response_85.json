[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 3, "creation_date": 1472081974, "post_id": 39134514, "comment_id": 65614437, "body": "You should explain what you mean by &quot;it doesn&#39;t work.&quot; Do you get a compile error?"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472082162, "post_id": 39134514, "comment_id": 65614484, "body": "No. I do not get a compile error. I cannot find any way to do this. Can you please help me?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1472082441, "post_id": 39134514, "comment_id": 65614551, "body": "Then what output do you get with your example input file? And what output do you want? When I run your program I get 3 lines of output: <code>1 2</code> on the first line, <code>3 4</code> on the second line and <code>END</code> on the third line."}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472082522, "post_id": 39134514, "comment_id": 65614563, "body": "My desired output would be <code>1 2 3 4</code> after <code>0 0</code> and not after every <code>Enter</code> press"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1472083228, "post_id": 39134514, "comment_id": 65614724, "body": "Are you really asking for a way to read in a list of numbers? I.e. a function <code>readNums :: IO [Int]</code> ?"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472083475, "post_id": 39134514, "comment_id": 65614787, "body": "Yes, but the output should appear after the terminating condition viz <code>0 0</code> and not anywhere in between"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1472083729, "post_id": 39134514, "comment_id": 65614844, "body": "Your code is semantically correct, but contains a(t least one) syntax error (indendation of <code>myLoop</code> recursive call)."}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "edited": false, "score": 0, "creation_date": 1472084038, "post_id": 39134514, "comment_id": 65614911, "body": "But it does not give the correct result. Let me try to explain. When I execute the code, it prompts for input; I enter <code>1 2</code> and then press <code>Return</code>. It displays <code>1 2</code> which is what I do not want. When I enter <code>0 0</code> and press the <code>return</code> key, that is when the entire string <code>1 2</code> should appear. Maybe I am trying something which is impossible to accomplish."}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "edited": false, "score": 1, "creation_date": 1472084606, "post_id": 39134799, "comment_id": 65615024, "body": "Added example usage. You get a list back, so you can do whatever you want with it."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1472084601, "last_edit_date": 1472084601, "creation_date": 1472083759, "answer_id": 39134799, "question_id": 39134514, "link": "https://stackoverflow.com/questions/39134514/reading-a-continuous-input-terminating-at-a-condition/39134799#39134799", "title": "Reading a continuous input terminating at a condition", "body": "<p>First of all, make sure you are not using tabs in your source. In order to get your example to work I had to line up the <code>putStrLn</code> and the <code>myLoop</code> like this:</p>\n\n<pre><code>myLoop = do inp &lt;- getLine\n            if (inp == \"0 0\") then\n                putStrLn \"END\"\n            else do putStrLn(inp)\n                    myLoop\n               --   ^ note putStrLn and myLoop are at the same column\n</code></pre>\n\n<p>Secondly, I'll answer the question assuming you want to read in a list of numbers / words.</p>\n\n<pre><code>readNums :: IO [String]\nreadNums = do\n  x &lt;- getLine\n  if x == \"0 0\"\n    then return []\n    else do xs &lt;- readNums\n            return (words x ++ xs)\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>main = do nums &lt;- readNums\n          print nums\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 39134799, "answer_count": 1, "score": 2, "last_activity_date": 1472135952, "creation_date": 1472081552, "question_id": 39134514, "link": "https://stackoverflow.com/questions/39134514/reading-a-continuous-input-terminating-at-a-condition", "title": "Reading a continuous input terminating at a condition", "body": "<p>I am totally new to Haskell. I am writing code to accept a series of values.</p>\n\n<pre><code>eg.\n1 2\n3 4\n0 0\n</code></pre>\n\n<p>The last condition in when the input stops and I should display the values 1 2 3 4.</p>\n\n<p>I have done the following, but it doesn't work. I need some help.</p>\n\n<pre><code>main = myLoop\n\nmyLoop = do inp &lt;- getLine\n            if (inp == \"0 0\") then\n                putStrLn \"END\"\n            else do putStrLn(inp)\n                      myLoop\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472074982, "post_id": 39133363, "comment_id": 65612315, "body": "What web framework/library are you using?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472076451, "post_id": 39133363, "comment_id": 65612884, "body": "Please read the note, no framework"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472076690, "post_id": 39133363, "comment_id": 65612952, "body": "Are you emitting a <code>Content-type:</code> header?  What does <code>hPutStr handle $ show(response)</code> actually print out?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472077041, "post_id": 39133363, "comment_id": 65613049, "body": "please see updates"}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1472079738, "post_id": 39133981, "comment_id": 65613841, "body": "Answer updated - If you post a link to your server code I&#39;ll test this - otherwise I can only make assumptions about how response function is suppose to work."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1472136467, "post_id": 39133981, "comment_id": 65640344, "body": "heres a link: <a href=\"https://gist.github.com/dopatraman/1573a20f53bf7c5a5d8b25cac9c9d82b\" rel=\"nofollow noreferrer\">gist.github.com/dopatraman/1573a20f53bf7c5a5d8b25cac9c9d82b</a>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1472137611, "post_id": 39133981, "comment_id": 65641104, "body": "Doh! I used <code>text&#47;plain</code> when I meant <code>text&#47;html</code>. Answer verified to work now."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1472137576, "last_edit_date": 1495540386, "creation_date": 1472077827, "answer_id": 39133981, "question_id": 39133363, "link": "https://stackoverflow.com/questions/39133363/how-do-i-write-html-to-a-handle/39133981#39133981", "title": "How do I write HTML to a handle?", "body": "<p>You are not emitting a Content-type header. Without a Content-type header\nbrowsers will probably treat the output as plain text - not HTML.</p>\n\n<p>If you change your code to emit:</p>\n\n<pre><code>HTTP/1.1 200 OK\nContent-type: text/html; charset=UTF-8\n\nHaskell says: &lt;b&gt;hello there!&lt;/b&gt;\n</code></pre>\n\n<p>it should be rendered as HTML in your browser.</p>\n\n<p>This SO answer has an example of a simple HTTP response containing HTML:</p>\n\n<p><a href=\"https://stackoverflow.com/a/26346025/866915\">https://stackoverflow.com/a/26346025/866915</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>Based on your code, this should work:</p>\n\n<pre><code>response :: Request -&gt; Handle -&gt; IO ()\nresponse _ h = do\n  hPutStr h \"HTTP/1.1 200 OK\\r\\n\"\n  hPutStr h \"Content-type: text/html; charset=UTF-8\\r\\n\"\n  hPutStr h \"\\r\\n\\r\\n\"\n  hPutStr h \"Haskell says: &lt;b&gt;hello there!&lt;/b&gt;\\n\"\n</code></pre>\n\n<p>This assumes that you close the handle after emitting the response to\nindicate the end of the response. Also, note that your Show instance\nfor the Response is not very helpful because you have to add more\nheaders after the HTTP line but before the blank line.</p>\n\n<p>If you post a link to your server code I can test this for you.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472137576, "creation_date": 1472074379, "last_edit_date": 1472077037, "question_id": 39133363, "link": "https://stackoverflow.com/questions/39133363/how-do-i-write-html-to-a-handle", "title": "How do I write HTML to a handle?", "body": "<p>I'm trying to write HTML to a page when a certain path is hit:</p>\n\n<pre><code>import Control.Monad\nimport Data.Char\nimport System.IO\nimport Network\nimport Data.Time.LocalTime\n\ndata RequestType = GET | POST deriving (Show)\ndata Request = Request { rtype :: RequestType, path :: String, options :: [(String,String)] }\ndata Response = Response { version :: String, statuscode :: Int }\n\ninstance Show Response where\n    show r = version(r) ++ \" \" ++ show(statuscode(r)) ++ \" \" ++ (case statuscode(r) of\n        100 -&gt; \"Continue\"\n        200 -&gt; \"OK\"\n        404 -&gt; \"Not Found\") ++ \"\\r\\n\\r\\n\"\n\n-- respond function\nrespond :: Request -&gt; Handle -&gt; IO ()\nrespond request handle = do\n    putStrLn $ show request\n    let response = Response {version = \"HTTP/1.1\", statuscode = 200}\n    hPutStr handle $ show(response)\n    hPutStr handle $ \"Haskell says \" ++ (getMessage request)\n    where getMessage r\n            | (path r) == \"/hello\" = \"&lt;b&gt;hello there!&lt;/b&gt;\" &lt;-- HERE\n            | otherwise = (path r)\n</code></pre>\n\n<p>I can run this code without errors, but when I hit http://{hostname}/hello I get the string <code>&lt;b&gt;hello there!&lt;/b&gt;</code> meaning the html is being rendered as a string.</p>\n\n<p>How do I render it as html?</p>\n\n<p><strong>NOTE</strong></p>\n\n<p>I want to do this using vanilla Haskell, meaning no 3rd party libraries.</p>\n"}, {"tags": ["loops", "variables", "for-loop", "haskell", "immutability"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1472067959, "post_id": 39131812, "comment_id": 65609007, "body": "You can do this with <a href=\"http://learnyouahaskell.com/recursion\" rel=\"nofollow noreferrer\">recursion</a>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1472068014, "post_id": 39131812, "comment_id": 65609036, "body": "p.s. Haskell has variables. They just act differently than in procedural languages."}, {"owner": {"reputation": 351, "user_id": 4280916, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c717fbb3591ef6fadd122db8c38bce82?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/4280916/joe"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1472068338, "post_id": 39131812, "comment_id": 65609220, "body": "@Code-Apprentice uuuh, like <code>rec x a = if x &lt; n then rec x 1-a else ...</code>? great!"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1472068660, "post_id": 39131812, "comment_id": 65609394, "body": "You also need to define <code>n</code> somewhere."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1472068780, "post_id": 39131812, "comment_id": 65609452, "body": "I&#39;d argue that it depends very much on why you are looping. Sometimes, you can use a higher-order function that abstracts away the iteration. Other times, you write your own recursive functions. Still others, you don&#39;t actually need to iterate at all."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1520101635, "post_id": 39131812, "comment_id": 85180820, "body": "<code>a = ((-1)^(n+1)+1)`div`2</code>."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 7, "last_activity_date": 1472068070, "creation_date": 1472068070, "answer_id": 39131895, "question_id": 39131812, "link": "https://stackoverflow.com/questions/39131812/haskell-for-loop/39131895#39131895", "title": "Haskell - for loop", "body": "<p>In Haskell instead of using loops, you combine standard library functions and/or your own recursive function to achieve the desired effect.</p>\n\n<p>In your example code you seem to be setting <code>a</code> to either 0 or 1 depending on whether or not <code>n</code> is even (in a rather confusing fashion if I'm honest). To achieve the same in Haskell, you'd write:</p>\n\n<pre><code>a =\n  if even n\n  then 0\n  else 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": true, "score": 10, "last_activity_date": 1472068337, "creation_date": 1472068337, "answer_id": 39131957, "question_id": 39131812, "link": "https://stackoverflow.com/questions/39131812/haskell-for-loop/39131957#39131957", "title": "Haskell - for loop", "body": "<p>Often, repetition that you would perform with a loop in a procedural language is accomplished with <a href=\"http://learnyouahaskell.com/recursion\" rel=\"noreferrer\">recursion</a> in Haskell. In this case, you should think about what the result of the loop is. It appears to alternate between 0 and 1. There are several ways to do this in Haskell. One way is</p>\n\n<pre><code>alternatingList n = take n alternating0and1\nalternating0and1 = 0 : alternating1and0\nalternating1and0 = 1 : alternating0and1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 11, "last_activity_date": 1472068972, "creation_date": 1472068972, "answer_id": 39132127, "question_id": 39131812, "link": "https://stackoverflow.com/questions/39131812/haskell-for-loop/39132127#39132127", "title": "Haskell - for loop", "body": "<p>There are a few options. First, you can rewrite the problem with naive recursion:</p>\n\n<pre><code>loop :: Int -&gt; Int\nloop n = loop' n 0\n  where loop' 0 a = a\n        loop' n a = loop' (n - 1) (1 - a)\n</code></pre>\n\n<p>Next, you can restate recursion as a fold:</p>\n\n<pre><code>loop :: Int -&gt; Int\nloop n = foldr (\\a _ -&gt; 1 - a) 0 [0..n]\n</code></pre>\n\n<p>Or you can use <code>State</code> to simulate a for loop:</p>\n\n<pre><code>import Control.Monad\nimport Control.Monad.State\n\nloop :: Int -&gt; Int\nloop n = execState (forM_ [0..n] \n                      (\\_ -&gt; modify (\\a -&gt; 1 - a))) 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1472069532, "creation_date": 1472069532, "answer_id": 39132282, "question_id": 39131812, "link": "https://stackoverflow.com/questions/39131812/haskell-for-loop/39132282#39132282", "title": "Haskell - for loop", "body": "<p>Another option:</p>\n\n<pre><code>iterate (\\a -&gt; 1-a) 0 !! n\n-- or even\niterate (1-) 0 !! n\n</code></pre>\n\n<p>The snippet <code>iterate (\\a -&gt; 1-a) 0</code> produces an infinite lazy list of all the values obtained starting from <code>0</code> and repeatedly applying the function <code>(\\a -&gt; 1-a)</code>. Then <code>!! n</code> takes the n-th element.</p>\n\n<p>To be completely honest, in this case, I'd also look for a stricter definition of <code>iterate</code> which does not create so many lazy thunks.</p>\n"}, {"tags": [], "owner": {"reputation": 9436, "user_id": 444705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e754cabb8c4f443410c1fd107ecdfd8?s=128&d=identicon&r=PG", "display_name": "Pi Delport", "link": "https://stackoverflow.com/users/444705/pi-delport"}, "is_accepted": false, "score": 5, "last_activity_date": 1472217870, "last_edit_date": 1472217870, "creation_date": 1472137155, "answer_id": 39148635, "question_id": 39131812, "link": "https://stackoverflow.com/questions/39131812/haskell-for-loop/39148635#39148635", "title": "Haskell - for loop", "body": "<p>The other answers have already explained how you would approach a problem like this functionally, in Haskell.</p>\n\n<p>However, Haskell does have mutable variables (or references) in the form of <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad-ST.html\" rel=\"nofollow\">ST</a> actions and <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-STRef.html\" rel=\"nofollow\">STRef</a>. Using them is usually not very pretty, but it does allow you to express imperative, variable-mutating code faithfully in Haskell, if you really want to.</p>\n\n<p>Just for fun, here's how you might use them to express your example problem.</p>\n\n<p>(The following code also uses <a href=\"http://hackage.haskell.org/package/monad-loops-0.4.3/docs/Control-Monad-Loops.html#v:whileM_\" rel=\"nofollow\">whileM_</a> from the <a href=\"http://hackage.haskell.org/package/monad-loops\" rel=\"nofollow\">monad-loops</a> package, for convenience.)</p>\n\n<pre><code>import Control.Monad.Loops\nimport Control.Monad.ST\nimport Data.STRef\n\n-- First, we define some infix operators on STRefs,\n-- to make the following code less verbose.\n\n-- Assignment to refs.\nr @= x = writeSTRef r =&lt;&lt; x\nr += n = r @= ((n +) &lt;$&gt; readSTRef r)\n\n-- Binary operators on refs. (Mnemonic: the ? is on the side of the ref.)\nn -? r = (-) &lt;$&gt; pure n &lt;*&gt; readSTRef r\nr ?&lt; n = (&lt;) &lt;$&gt; readSTRef r &lt;*&gt; pure n\n\n\n-- Armed with these, we can transliterate the original example to Haskell.\n-- This declares refs a and x, mutates them, and returns the final value of a.\nfoo n = do\n    a &lt;- newSTRef 0\n    x &lt;- newSTRef 0\n    whileM_ (x ?&lt; n) $ do\n        x += 1\n        a @= (1 -? a)\n    readSTRef a\n\n-- To run it:\nmain = print =&lt;&lt; stToIO (foo 10)\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 4280916, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c717fbb3591ef6fadd122db8c38bce82?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/4280916/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21392, "favorite_count": 1, "accepted_answer_id": 39131957, "answer_count": 5, "score": 5, "last_activity_date": 1520101985, "creation_date": 1472067728, "last_edit_date": 1520101985, "question_id": 39131812, "link": "https://stackoverflow.com/questions/39131812/haskell-for-loop", "title": "Haskell - for loop", "body": "<p>if I want to express something like [just a simple example]:</p>\n\n<pre><code>int a = 0;\nfor (int x = 0; x &lt; n; x += 1)\n    a = 1 - a;\n</code></pre>\n\n<p>what should I do in Haskell, <em>since it doesn't have variable concept?</em> (maybe wrong, see: <a href=\"https://stackoverflow.com/questions/993124/does-haskell-have-variables\">Does Haskell have variables?</a>)</p>\n"}, {"tags": ["haskell", "polymorphism"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1472064071, "post_id": 39130365, "comment_id": 65606973, "body": "<a href=\"https://typesandkinds.wordpress.com/2015/08/19/planned-change-to-ghc-merging-types-and-kinds/\" rel=\"nofollow noreferrer\">It&#39;s not</a>"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1472064285, "post_id": 39130365, "comment_id": 65607102, "body": "@bheklilr I think OP has something different in mind, although I don&#39;t quite get it."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1472064426, "post_id": 39130365, "comment_id": 65607183, "body": "If you enable <code>PartialTypeSignatures</code>, you can put <code>_</code> instead of type variables. For example, <code>Nothing :: Maybe _</code> or <code>Left () :: Either _ _</code>. What you propose would be a simple syntactic extension, but I&#39;m not sure it wouldn&#39;t introduce more confusion (especially in the context of other extensions like <code>PolyKinds</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1472078876, "post_id": 39131277, "comment_id": 65613601, "body": "It&#39;s fine to mash types and kinds together.  In fact, the latest ghc has a language extension for that.  Though, viewed as a logic type-in-type has to be handled very carefully to avoid inconsistencies.  But that doesn&#39;t matter for Haskell."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 5, "last_activity_date": 1472066272, "last_edit_date": 1472066272, "creation_date": 1472065738, "answer_id": 39131277, "question_id": 39130365, "link": "https://stackoverflow.com/questions/39130365/haskell-polymorphism-with-kinds-and-type-variables/39131277#39131277", "title": "Haskell Polymorphism With Kinds and Type Variables", "body": "<p>They are distinct just like typing and usual (value-level) variables are distinct. Variables <em>have</em> types, but they <em>aren't</em> types. So also, type variables <em>have</em> kinds. Type variables are the primary notion: without them you don't have parametric polymorphism, and they exist also in many other languages like Java, C#, etc. But Haskell goes further in allowing types-which-take-parameters (<code>[]</code>, <code>Maybe</code>, <code>-&gt;</code>, etc.) to exist on their own and to have type variables which represent such non-concrete types. And this means it needs a kind system to disallow things like <code>Maybe Int Int</code>.</p>\n\n<p>From the example, it seems that you suggest that you can write a signature without type variables and restore it to the signature with them. But then how could you distinguish <code>a -&gt; b -&gt; a</code> and <code>a -&gt; b -&gt; b</code>? </p>\n"}], "owner": {"reputation": 51, "user_id": 3996010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f14186b9746743b8d44e6c39d1a3be?s=128&d=identicon&r=PG&f=1", "display_name": "Monty Thibault", "link": "https://stackoverflow.com/users/3996010/monty-thibault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 2, "accepted_answer_id": 39131277, "answer_count": 1, "score": 4, "last_activity_date": 1472066272, "creation_date": 1472062503, "last_edit_date": 1472064670, "question_id": 39130365, "link": "https://stackoverflow.com/questions/39130365/haskell-polymorphism-with-kinds-and-type-variables", "title": "Haskell Polymorphism With Kinds and Type Variables", "body": "<p>In Haskell I have learnt that there are <em>type variables</em> (ex. <code>id :: a -&gt; a</code>), applied to type signatures, and <em>kinds</em> (ex. <code>Maybe :: * -&gt; *</code>), applied to type constructors and type classes. A type must have kind <code>*</code> (be a concrete type) in order to hold values. </p>\n\n<p>We use type variables to enable polymorphism: <code>Nothing :: Maybe a</code> means that the constant <code>Nothing</code> can belong to a family of possible types. This leads me to believe that kinding and type variables serve the same purpose; wouldn't the last code sample work as simply <code>Nothing :: Maybe</code>, where type class Maybe remains with the kind <code>* -&gt; *</code> to signify that the type belongs to generic family? </p>\n\n<p>What it seems we are doing is taking an empty parameter (<code>* -&gt; *</code>) and filling it  in with a type variable (<code>a</code>) that represents the same level of variance.</p>\n\n<p>We see this behavior in another example:</p>\n\n<pre><code>&gt;&gt;&gt; :k Either\nEither :: * -&gt; * -&gt; *\n&gt;&gt;&gt; :t Left ()\nLeft () :: Either () b\n&gt;&gt;&gt; :t Right ()\nRight () :: Either a ()\n</code></pre>\n\n<p>Why is it theoretically necessary to make the distinction between kinds and type variables?</p>\n"}, {"tags": ["haskell", "ghcjs"], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1472055470, "creation_date": 1472055470, "question_id": 39128382, "link": "https://stackoverflow.com/questions/39128382/wrapping-javascript-ffi-in-either", "title": "Wrapping JavaScript FFI in Either", "body": "<p>I am very new to <code>JavascriptFFI</code> and will very much appreciate help here. </p>\n\n<p>I have a working javascript code to grab image as <code>FILE URI</code> from camera (via cordova camera plugin). Now, it can return either error or file uri on success.  We want to map them to <code>Left Int Text</code> and <code>Right  GHCJS.DOM.Types.File</code> (not sure if I got the type of <code>FILE URI</code> right). </p>\n\n<p>Here is the javascript code (untested since I modified it off the tested one to return just fileuri or error, instead of displaying it in the browser). </p>\n\n<pre><code>    &lt;script type=\"text/javascript\" charset=\"utf-8\"&gt;\n\n    var destinationType; // sets the format of returned value\n\n    // Wait for device API libraries to load\n    document.addEventListener(\"deviceready\",onDeviceReady,false);\n\n    // device APIs are available\n    function onDeviceReady() {\n        pictureSource=navigator.camera.PictureSourceType;\n        destinationType=navigator.camera.DestinationType;\n    }\n\n    // Called when a photo is successfully retrieved\n    //\n    function onPhotoURISuccess(imageURI) {\n      console.log(\"success\");\n      return imageURI;\n    }\n\n    // A button will call this function for testing\n    function capturePhotoEdit() {\n      // Take picture using device camera, allow edit, and retrieve image as binary data \n      navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 20, allowEdit: true,\n        destinationType: destinationType.FILE_URI });\n    }\n\n    // Called if something bad happens.\n    //\n    function onFail(message) {\n       console.log(\"failure\");\n      return[1, message];\n    }\n\n    &lt;/script&gt;\n</code></pre>\n\n<p>I will appreciate pointers on how to do the FFI to <code>navigator.camera.getPicture</code> with ghcjs-dom-0.2.3.1 (I am using it with Reflex) such that returned result is in Either. </p>\n\n<p>I can then wrap the <code>File URI</code> in <code>ByteString</code> (I think through Cordova file api to convert it first to <code>arraybuffer</code>) and send it off to remove server for persistence.</p>\n"}, {"tags": ["haskell", "algebra"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1472051505, "post_id": 39127050, "comment_id": 65599630, "body": "<code>data Poly a = Poly (Field a -&gt; [ (Int, [a]) ])</code>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472051761, "post_id": 39127050, "comment_id": 65599832, "body": "See <a href=\"http://stackoverflow.com/a/12770425/866915\">this answer</a> for why we don&#39;t put class constraints on data constructors anymore."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1472059636, "last_edit_date": 1472059636, "creation_date": 1472054766, "answer_id": 39128159, "question_id": 39127050, "link": "https://stackoverflow.com/questions/39127050/declaring-a-field-from-algebra-by-class-and-or-by-data/39128159#39128159", "title": "Declaring a field from algebra by class and / or by data?", "body": "<p>Another way to do this is to define a <code>Field</code> typeclass:</p>\n\n<pre><code>class Field a where\n    rplus :: a -&gt; a -&gt; a\n    rmult :: a -&gt; a -&gt; a\n    rnegate :: a -&gt; a\n    rinverse :: a -&gt; a\n    runit :: a\n    rzero :: a\n</code></pre>\n\n<p>For each field, define a type that represents the underlying set of the field, then define an appropriate instance for that type. You are responsible for ensuring that your implementation obeys the various field laws (multiplication distributes over addition, any element times its inverse is 1, etc).</p>\n\n<p>See the last example for how to define a <code>Field</code> instance for a polynomial over a field.</p>\n\n<h1>Examples</h1>\n\n<h2>Integers mod 7</h2>\n\n<pre><code>-- Haskell doesn't have dependent types yet, so use the\n-- next best thing: a smart constructor\nnewtype Z7 = Z7 Integer\nmakeZ7 :: Integer -&gt; Z7\nmakeZ7 x = Z7 $ (x `mod` 7)\n\ninstance Field Z7 where\n    rplus (Z7 a) (Z7 b) = makeZ7 (a + b)\n    rmult (Z7 a) (Z7 b) = makeZ7 (a * b)\n    rzero = makeZ7 0\n    runit = makeZ7 1\n    rnegate (Z7 a) = makeZ7 (7 - a)\n    -- Necessarily partial, since 0 doesn't have an inverse\n    rinverse (Z7 a) | a == 1 = makeZ7 1\n                    | a == 2 = makeZ7 4\n                    | a == 3 = makeZ7 5\n                    | a == 4 = makeZ7 2\n                    | a == 5 = makeZ7 3\n                    | a == 6 = makeZ7 6\n</code></pre>\n\n<h2>Rationals</h2>\n\n<p>This one is easier because <code>Integral a =&gt; Ratio a</code> is already an instance of <code>Num</code>, so we get most of the implementation for free.</p>\n\n<pre><code>import Data.Ratio\ninstance Integeral a =&gt; Field (Ratio a) where\n    rplus = (+)\n    rmult = (*)\n    rnegate = negate\n    rinverse q = denominator q % numerator q\n    rzero = 0\n    runit = 1\n</code></pre>\n\n<h2>Polynomials over a field</h2>\n\n<p>The coefficients of a polynomial can be anything you want.</p>\n\n<pre><code>data Poly f = Poly [(f, Int)]\n</code></pre>\n\n<p>However, polynomials only form a field if the coefficients themselves are from a field, so this is where you declare that constraint.</p>\n\n<pre><code>-- A type Poly f is a field if f is a field.\n-- Fields: Poly Z7, Integral a =&gt; Poly (Ratio a)\n-- Not a field: Poly Integer\ninstance Field f =&gt; Field (Poly f) where\n    runit = Poly [(runit, 0)] -- Not Poly [(1,0)]\n    rzero = Poly [(rzero, 0)] -- Not Poly [(0,0)]\n    -- Not Poly [(-c, e) | (c,e) &lt;- p]\n    rnegate (Poly p) = Poly [(rnegate c, e) | (c,e) &lt;- p]\n    -- Left as an exercise for the reader\n    -- Remember to use runit instead of 1, rzero instead of 0\n    -- and rnegate instead of - where appropriate.\n    rinverse p = ...\n    rplus p q = ...\n    rmult p q = ...\n</code></pre>\n\n<p>Some very quick examples that don't require me to finish implementing the <code>Poly</code> instance. (You can derive <code>Show</code> for all the types involved.)</p>\n\n<pre><code>&gt; runit :: Z7\nZ7 1\n&gt; runit :: Rational  -- type Rational = Ratio Integer\n1 % 1\n&gt; runit :: Poly Z7\nPoly [(Z7 1,0)]\n&gt; runit :: Poly Rational\nPoly [(1 % 1,0)]\n</code></pre>\n"}], "owner": {"reputation": 7961, "user_id": 482601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52578189717d3748d30828c5fff42ba9?s=128&d=identicon&r=PG", "display_name": "fabian789", "link": "https://stackoverflow.com/users/482601/fabian789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472059636, "creation_date": 1472051354, "last_edit_date": 1472052521, "question_id": 39127050, "link": "https://stackoverflow.com/questions/39127050/declaring-a-field-from-algebra-by-class-and-or-by-data", "title": "Declaring a field from algebra by class and / or by data?", "body": "<p>I would like to model a <a href=\"https://en.wikipedia.org/wiki/Field_(mathematics)\" rel=\"nofollow\">field</a> in Haskell. A field is a set of elements plus two operations, which can be seen as multiplication and addition. I proceeded as follows:</p>\n\n<pre><code>data Field a = Field [a] (a -&gt; a -&gt; a) (a -&gt; a -&gt; a)\n\nelements :: Field a -&gt; [a]\nelements (Field els _ _) = els\n\nadd :: Field a -&gt; a -&gt; a -&gt; a\nadd (Field _ addop _) = addop\n\nmul :: Field a -&gt; a -&gt; a -&gt; a\nmul (Field _ _ mulop) = mulop\n</code></pre>\n\n<p>However, I would now like to model polynomials over fields, i.e., something like</p>\n\n<pre><code>data Poly = Poly f [(a, Int)]\n</code></pre>\n\n<p>where <code>f</code> should be a field and <code>a</code> should be the type of the field. The list <code>[(a, Int)]</code> would represent the polynomial, e.g.,</p>\n\n<pre><code>[(4, 2), (1, 1)] = 4 * x^2 + 1 * x^1\n</code></pre>\n\n<p>Yet I cannot think of how to achieve this in Haskell. I think maybe somehow I can declare <code>Field</code> as a class instead and then somehow constrain Poly to only work with Fields, but as far as I know, I cannot constrain data constructors.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 1, "creation_date": 1472050648, "post_id": 39126755, "comment_id": 65598949, "body": "try <code>greet_buggy = forever . putStrLn</code>"}, {"owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "reply_to_user": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1472050865, "post_id": 39126755, "comment_id": 65599138, "body": "thanks, working like greet, but still it is not complete solution to my Goal? I want to accept string and print it and accept one more string like that forever"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "edited": false, "score": 0, "creation_date": 1472052125, "post_id": 39127075, "comment_id": 65600074, "body": "so <code>forever $ putStrLn &quot;something&quot;</code> will always print same IO action i.e. printing something, in case I want to change &quot;something&quot; to &quot;anything&quot; in between can I do that using <code>forever</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "edited": false, "score": 0, "creation_date": 1472052400, "post_id": 39127075, "comment_id": 65600285, "body": "I&#39;m not sure I understand: you might be looking for something like <code>forever (do s &lt;- getLine ; putStrLn s)</code>"}, {"owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "edited": false, "score": 0, "creation_date": 1472053192, "post_id": 39127075, "comment_id": 65600780, "body": "yes, your explanation and this comment solves my problem. Thanks"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1472068795, "last_edit_date": 1472068795, "creation_date": 1472051423, "answer_id": 39127075, "question_id": 39126755, "link": "https://stackoverflow.com/questions/39126755/understanding-forever-in-haskell/39127075#39127075", "title": "Understanding forever in Haskell", "body": "<blockquote>\n  <p>Can anyone explain whats going on here?</p>\n</blockquote>\n\n<p>We have</p>\n\n<pre><code>putStrLn :: String -&gt; IO ()\n</code></pre>\n\n<p>which, incidentally, is a value in the <code>(-&gt;) String</code> monad. Consequently,</p>\n\n<pre><code>forever putStrLn :: (-&gt;) String b\n</code></pre>\n\n<p>where <code>b</code> is universally quantified, hence we also have (unfortunately)</p>\n\n<pre><code>forever putStrLn :: (-&gt;) String (IO ())\n</code></pre>\n\n<p>making the posted code to type check.</p>\n\n<p>To understand what is <code>forever</code> in the <code>(-&gt;) String</code> monad, recall that:</p>\n\n<pre><code>m &gt;&gt;= g\n=  -- definition of &gt;&gt;=\n\\x -&gt; g (m x) x\n</code></pre>\n\n<p>hence</p>\n\n<pre><code>m &gt;&gt; f\n= -- definition of &gt;&gt; in terms of &gt;&gt;=\nm &gt;&gt;= const f\n= -- definition of &gt;&gt;=\n\\x -&gt; const f (m x) x\n= -- beta\n\\x -&gt; f x\n= -- eta\nf\n</code></pre>\n\n<p>Back to <code>forever</code>: recall its definition</p>\n\n<pre><code>forever m = m &gt;&gt; forever m\n</code></pre>\n\n<p>which is equivalent (in the <code>(-&gt;) String</code> monad) to the recursive definition</p>\n\n<pre><code>forever m = forever m\n</code></pre>\n\n<p>causing a useless infinite loop.</p>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1472051539, "creation_date": 1472051539, "answer_id": 39127119, "question_id": 39126755, "link": "https://stackoverflow.com/questions/39126755/understanding-forever-in-haskell/39127119#39127119", "title": "Understanding forever in Haskell", "body": "<p><code>forever</code> performs the exact same IO action (or in general, monadic action) over and over. If your function accepts a String as input, <code>forever</code> will print that same string forever. If, instead, you want to read a string from the user each time, you must include that in your IO action.</p>\n\n<p>What is a simple IO action that reads a line from the user and then prints it? Combine together <code>getLine</code> and <code>putStrLn</code>:</p>\n\n<pre><code>echo :: IO ()\necho = getLine &gt;&gt;= putStrLn\n</code></pre>\n\n<p>Then just pass that action to <code>forever</code>:</p>\n\n<pre><code>cat :: IO ()\ncat = forever echo\n</code></pre>\n\n<p>Alternatively, it turns out there is already something built into Prelude that does this whole thing for you: what we've written is equivalent to:</p>\n\n<pre><code>cat :: IO ()\ncat = interact id\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 8, "last_activity_date": 1472053197, "creation_date": 1472053197, "answer_id": 39127649, "question_id": 39126755, "link": "https://stackoverflow.com/questions/39126755/understanding-forever-in-haskell/39127649#39127649", "title": "Understanding forever in Haskell", "body": "<p><code>greet_buggy</code> is working over a different monad.</p>\n\n<p><code>forever</code> takes a monadic action and repeats it indefinitely. It can be defined like this:</p>\n\n<pre><code>forever a = let loop = a &gt;&gt; loop in loop\n</code></pre>\n\n<p>which can also be visualized as</p>\n\n<pre><code>forever a = a &gt;&gt; a &gt;&gt; a &gt;&gt; a &gt;&gt; ...  (infinitely many times)\n</code></pre>\n\n<p>(In fact forever is defined over Applicative, not Monad; but this is not important right now).</p>\n\n<p>So <code>forever greet</code> is actually</p>\n\n<pre><code>putStrLn \"Hello\" &gt;&gt; putStrLn \"Hello\" &gt;&gt; putStrLn \"Hello\" &gt;&gt; ...\n</code></pre>\n\n<p>which needs no further explanation.</p>\n\n<p>OTOH <code>forever greet_buggy</code> is equivalent to</p>\n\n<pre><code>putStrLn &gt;&gt; putStrLn &gt;&gt; putStrLn &gt;&gt; ...\n</code></pre>\n\n<p>Now, since <code>(-&gt; a)</code> is a monad, <code>&gt;&gt;</code> is defined for any two functions of suitable types, and the meaning of <code>f &gt;&gt; g</code> in this case is... just <code>g</code>! So the meaning of</p>\n\n<pre><code>( putStrLn &gt;&gt; putStrLn &gt;&gt; putStrLn &gt;&gt; ... ) \"Hello\"\n</code></pre>\n\n<p>is to take the last function in the chain of <code>&gt;&gt;</code> and apply it to <code>Hello</code>. Of course there's no last function there, so this just keeps running forever.</p>\n"}], "owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "closed_date": 1472075692, "accepted_answer_id": 39127649, "answer_count": 3, "score": 1, "last_activity_date": 1472093524, "creation_date": 1472050524, "last_edit_date": 1495540865, "question_id": 39126755, "link": "https://stackoverflow.com/questions/39126755/understanding-forever-in-haskell", "closed_reason": "Duplicate", "title": "Understanding forever in Haskell", "body": "<p>Goal: take a string and print same thing in console like that same action need to be done forever</p>\n\n<p>I came up something like this, no compilation error but not working as expected.</p>\n\n<pre><code>greet_buggy :: String -&gt; IO ()\ngreet_buggy = forever $ putStrLn\n</code></pre>\n\n<p>Problem is below string is not printing anything in the console.</p>\n\n<pre><code>greet_buggy \"something\"\n</code></pre>\n\n<p>based on <a href=\"https://stackoverflow.com/questions/24042977/how-does-forever-monad-work\">this post</a> I tried to debug and changed the definition like below. It is working fine </p>\n\n<pre><code>greet :: IO ()\ngreet = forever $ putStrLn \"Hello\"\n</code></pre>\n\n<p>Can anyone explain whats going on here? Is it possible to achieve same effect using <code>forever</code> alone?</p>\n\n<p>EDIT: found one more related <a href=\"https://stackoverflow.com/questions/9753389/why-does-importing-control-applicative-allow-this-bad-code-to-type-check\">post</a>(Thanks to @Daniel Wagner), even through this question is different from mine, answer explains about <code>forever</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1472049011, "post_id": 39126028, "comment_id": 65597757, "body": "<code>f = concatMap g . take 5</code> would also be point-free. <code>a &gt;&gt;= f</code> is <code>concatMap f a</code> because that\u2019s the definition of the list monad."}], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 1, "creation_date": 1472050406, "post_id": 39126456, "comment_id": 65598774, "body": "yes, my question was asked poorly. Just reading up on what you wrote..  thanks. Reading up on what you wrote, Is it also a good way of thinking  about it along the lines that  <code>concatMap</code> is <code>join fmap</code> for lists (and indeed all monads)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1472052888, "post_id": 39126456, "comment_id": 65600590, "body": "@matthias <code>concatMap = concat .: map = (concat .) . map</code> by definition, and for lists <code>map = fmap</code> and <code>concat = join</code>, so. And, in general, <a href=\"http://stackoverflow.com/questions/11234632/monads-with-join-instead-of-bind/11249714#11249714\"><code>((g&lt;=&lt;f)=&lt;&lt;) = (g=&lt;&lt;).(f=&lt;&lt;) = join.(g&lt;$&gt;).join.(f&lt;$&gt;)</code></a>."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 3, "last_activity_date": 1472115592, "last_edit_date": 1472115592, "creation_date": 1472049780, "answer_id": 39126456, "question_id": 39126028, "link": "https://stackoverflow.com/questions/39126028/haskell-concatmap-point-free-explanation/39126456#39126456", "title": "Haskell concatMap point free explanation", "body": "<p>The substitution of <code>=&lt;&lt;</code> for <code>concatMap</code> has nothing to do with point-free'ness.</p>\n\n<p><code>&gt;&gt;=</code> for lists is defined to be a combination of <code>concat</code> and <code>map</code> (which is in turn equivalent to <code>concatMap</code>):</p>\n\n<pre><code>xs &gt;&gt;= f = concat (map f xs)\n</code></pre>\n\n<p>and of course <code>=&lt;&lt;</code> is just <code>&gt;&gt;=</code> flipped.</p>\n\n<p>An explanation of the monad instance for lists can be found at: <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/List\" rel=\"nofollow\">https://en.wikibooks.org/wiki/Haskell/Understanding_monads/List</a></p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 39126456, "answer_count": 1, "score": 1, "last_activity_date": 1472115592, "creation_date": 1472048711, "last_edit_date": 1472050513, "question_id": 39126028, "link": "https://stackoverflow.com/questions/39126028/haskell-concatmap-point-free-explanation", "title": "Haskell concatMap point free explanation", "body": "<p>I am struggling to figure out how <code>concatMap</code> relates to the <code>=&lt;&lt;</code> operator. Could someone please explain why: </p>\n\n<p><code>f x = concatMap g $ take 5 $ x</code></p>\n\n<p>becomes</p>\n\n<p><code>f = (g =&lt;&lt;) . take 5</code></p>\n\n<p><del>in point free.</del>  I can see that the types of <code>concatMap</code> and <code>=&lt;&lt;</code> match but I don't understand why.</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1472070196, "post_id": 39125627, "comment_id": 65610120, "body": "I have a feeling that&#39;s probably the cleanest code you are going to get. If you don&#39;t get an answer here try <a href=\"https://groups.google.com/forum/#!forum/haskell-pipes\" rel=\"nofollow noreferrer\">pipes mailing list</a> - and then post the answer back here."}], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 755773, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93681534482869a80cf1a45f1180d1fd?s=128&d=identicon&r=PG", "display_name": "Yves Par&#232;s", "link": "https://stackoverflow.com/users/755773/yves-par%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1472206148, "post_id": 39154588, "comment_id": 65670241, "body": "Thanks! Indeed <code>next</code> was the missing element here."}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": true, "score": 2, "last_activity_date": 1472306758, "last_edit_date": 1472306758, "creation_date": 1472158566, "answer_id": 39154588, "question_id": 39125627, "link": "https://stackoverflow.com/questions/39125627/pipes-open-a-file-according-to-content-of-another/39154588#39154588", "title": "Pipes: open a file according to content of another", "body": "<p>There are I think a number of ways of doing this without mixing <code>Data.Text.IO</code> in with <code>Pipes</code> stuff. It is basically a <code>zip</code>, as you say. The natural way of finding out the first line of the first file is just to use <code>next</code> which, in this case, gives you the first line paired with the rest of lines:</p>\n\n<pre><code>someFunc_ = runSafeT $ runEffect $ do \n  e &lt;- next (T.readFileLn file1)\n  case e of\n    Left r              -&gt; return r\n    Right (file2, rest) -&gt; do \n      let other = T.readFileLn (T.unpack file2)\n          amalgam = for (P.zip rest other) $ \\(l1,l2) -&gt; do\n            yield l2 \n            yield l1\n      runEffect $ amalgam &gt;-&gt; T.stdoutLn\n</code></pre>\n\n<p>I think an approach that tried to do more 'inside a pipeline' would end up being more complicated than it was worth. In particular, you have to deal with the case where file1 turns out to empty. <code>next</code> is basically what you use to pattern match on a pipes <code>Producer</code>, so it's a fundamental pipes operation.</p>\n\n<p>So, part for part, it's basically the same as a regular Text program like this</p>\n\n<pre><code> someFunc = do\n    ls &lt;- fmap T.lines TIO.readFile file1 \n    case ls of\n      []         -&gt; return ()\n      file2:rest -&gt; do \n        ls' &lt;- fmap T.lines (TIO.readFile file1) \n        forM_ (zip ls ls') $ \\(t1,t2) -&gt; do\n             TIO.putStrLn t1\n             TIO.putStrLn t2\n</code></pre>\n\n<p>except that it streams properly. </p>\n"}], "owner": {"reputation": 551, "user_id": 755773, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93681534482869a80cf1a45f1180d1fd?s=128&d=identicon&r=PG", "display_name": "Yves Par&#232;s", "link": "https://stackoverflow.com/users/755773/yves-par%c3%a8s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 39154588, "answer_count": 1, "score": 3, "last_activity_date": 1472306758, "creation_date": 1472047667, "last_edit_date": 1472051917, "question_id": 39125627, "link": "https://stackoverflow.com/questions/39125627/pipes-open-a-file-according-to-content-of-another", "title": "Pipes: open a file according to content of another", "body": "<p>I have this code:</p>\n\n<pre><code>import Pipes\nimport Pipes.Safe\nimport qualified Pipes.Prelude as P\nimport qualified Pipes.Safe.Prelude as P\nimport System.IO\n\nimport Data.Text as T\nimport Data.Text.IO as TIO\nimport qualified Pipes.Prelude.Text as T\n\nsomeFunc :: IO ()\nsomeFunc = runSafeT $\n  P.withFile file1 ReadMode $ \\file1Handle -&gt; do\n    file2 &lt;- liftIO $ TIO.hGetLine file1Handle\n    runEffect $\n      for (P.zip (T.fromHandleLn file1Handle)\n                 (T.readFileLn $ T.unpack file2))\n          (\\(l1,l2) -&gt; do yield l2\n                          yield l1)\n      &gt;-&gt; T.stdoutLn\n</code></pre>\n\n<p>But it seems quite hacky, and I would like to be able to open the second file from within the pipe, from what I read in the first line of the first file.\nAny idea?</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "edited": false, "score": 0, "creation_date": 1472046491, "post_id": 39124578, "comment_id": 65595781, "body": "<code>MonadState</code> is the type class for monads such as <code>State</code>: <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Class.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/mtl-2.2.1/docs/&hellip;</a>"}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 0, "creation_date": 1472054216, "post_id": 39124578, "comment_id": 65601419, "body": "What research have you done to answer this question yourself?  Have you read the documentation?  Have you googled for <code>MonadState</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 1, "last_activity_date": 1472054931, "last_edit_date": 1472054931, "creation_date": 1472047959, "answer_id": 39125756, "question_id": 39124578, "link": "https://stackoverflow.com/questions/39124578/haskell-monadstate/39125756#39125756", "title": "Haskell - MonadState", "body": "<p><code>MonadState</code> abstracts the state monad (as if this stuff wasn't abstract enough, right?). Instead of requiring a concrete type <code>State</code> with a <code>Monad</code> instance, it lets us use any <code>Monad</code> we like, provided we can provide appropriate <code>get</code> and <code>put</code> functions. In particular, we can use <code>StateT</code> which lets us combine effects.</p>\n\n<p>simple example combining State and IO:</p>\n\n<pre><code>tick :: (MonadIO m, MonadState Int m) =&gt; m ()\ntick = do\n  x &lt;- get\n  liftIO $ putStrLn (\"incrementing \" ++ (show x))\n  put (x+1)\n\n&gt; runStateT (tick &gt;&gt; tick &gt;&gt; tick &gt;&gt; tick) 5\nincrementing 5\nincrementing 6\nincrementing 7\nincrementing 8\n((),9)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1472050769, "last_edit_date": 1472050769, "creation_date": 1472048301, "answer_id": 39125885, "question_id": 39124578, "link": "https://stackoverflow.com/questions/39124578/haskell-monadstate/39125885#39125885", "title": "Haskell - MonadState", "body": "<p><code>MonadState</code> abstracts out the <code>get</code> and <code>put</code> functions so that they work not just for one type, but for <em>any</em> type that can act as a state monad. It's primarily to make monad transformers work.</p>\n\n<p>Without going into too much detail, let's just assume you know that <code>StateT</code> exists: it takes one monad and returns a new monad that can act as state. (I'll ignore the difference between lazy and strict state monads here). A monad that handles state can then be defined by applying <code>StateT</code> to the <code>Identity</code> monad:</p>\n\n<pre><code>newtype State s = StateT s Identity\n</code></pre>\n\n<p>As long as the input type is a monad, we can provide a <code>MonadState</code> instance for the monad returned by <code>StateT</code>:</p>\n\n<pre><code>-- Add state to any monad\ninstance Monad m =&gt; MonadState s (StateT s m) where\n    ...\n</code></pre>\n\n<p>This says that applying <code>StateT</code> to <em>any</em> monad (not just <code>Identity</code>) produces a monad that can be treated as a state monad. </p>\n\n<p>Further, you can say that anything that <em>wraps</em> a state monad is also a state monad, as long as it implements <code>MonadState</code>:</p>\n\n<pre><code>-- Add Maybe to a state monad, it's still a state monad\ninstance MonadState s m =&gt; MonadState s (MaybeT m) where\n    ...\n\n-- Add Writer to a state monad, it's still a state monad\ninstance (Monoid w, MonadState s m) =&gt; MonadState s (WriterT w m) where\n    ...\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 5738619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/489ffbc19dae2212663f027806a6a95f?s=128&d=identicon&r=PG&f=1", "display_name": "Zubair", "link": "https://stackoverflow.com/users/5738619/zubair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 1, "accepted_answer_id": 39125885, "answer_count": 2, "score": 0, "last_activity_date": 1472054931, "creation_date": 1472044956, "question_id": 39124578, "link": "https://stackoverflow.com/questions/39124578/haskell-monadstate", "title": "Haskell - MonadState", "body": "<p>So I have recently been looking at state monads because I want to build a parser combinator library in haskell.</p>\n\n<p>I came across a typeclass known as MonadState, I was wondering what is the point of this typeclass and  where would you use it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1472040947, "post_id": 39122970, "comment_id": 65591606, "body": "<a href=\"http://ideone.com/Zdflsx\" rel=\"nofollow noreferrer\">No repro</a> Are you sure there are no tab characters in the file?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1472041000, "post_id": 39122970, "comment_id": 65591648, "body": "Looks OK to me. Use <code>-Wall</code> and check if it reports tabs in your code instead of spaces. (quick.sh instead of quick.hs above is just a typo in the posted question, right?)"}, {"owner": {"reputation": 85, "user_id": 5414175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/SjpnR.jpg?s=128&g=1", "display_name": "Julian20151006", "link": "https://stackoverflow.com/users/5414175/julian20151006"}, "edited": false, "score": 0, "creation_date": 1472042382, "post_id": 39122970, "comment_id": 65592599, "body": "I rewrited the code and made sure there is no tab in the file. But the error is still there......"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1472043843, "post_id": 39122970, "comment_id": 65593740, "body": "Is <code>larger</code> exactly defined on the same column as <code>smaller</code>?"}, {"owner": {"reputation": 85, "user_id": 5414175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/SjpnR.jpg?s=128&g=1", "display_name": "Julian20151006", "link": "https://stackoverflow.com/users/5414175/julian20151006"}, "edited": false, "score": 0, "creation_date": 1472044937, "post_id": 39122970, "comment_id": 65594585, "body": "yes, I&#39;m sure about it"}, {"owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "edited": false, "score": 0, "creation_date": 1472045471, "post_id": 39122970, "comment_id": 65594991, "body": "which version of GHC ?"}, {"owner": {"reputation": 85, "user_id": 5414175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/SjpnR.jpg?s=128&g=1", "display_name": "Julian20151006", "link": "https://stackoverflow.com/users/5414175/julian20151006"}, "edited": false, "score": 0, "creation_date": 1472046833, "post_id": 39122970, "comment_id": 65596072, "body": "version 8.0.1 , on Windows 7"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1472058624, "post_id": 39122970, "comment_id": 65603988, "body": "@chi, was <code>-fwarn-tabs</code> included in <code>-Wall</code> before it was enabled by default?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1472068890, "post_id": 39122970, "comment_id": 65609504, "body": "@dfeuer Good point -- I somehow assumed it was..."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5414175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/SjpnR.jpg?s=128&g=1", "display_name": "Julian20151006", "link": "https://stackoverflow.com/users/5414175/julian20151006"}, "edited": false, "score": 0, "creation_date": 1472086356, "post_id": 39128959, "comment_id": 65615391, "body": "I swear I have replaced all the tab characters with the appropriate number of spaces , but the error is still there"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 8, "last_activity_date": 1472057320, "creation_date": 1472057320, "answer_id": 39128959, "question_id": 39122970, "link": "https://stackoverflow.com/questions/39122970/haskell-error-parse-error-on-input/39128959#39128959", "title": "Haskell error: parse error on input &#39;=&#39;", "body": "<p>You say in the comments that you are sure there are no tab characters in the source file, but inspecting the source of your question, indeed there is one right before the <code>in</code> token. Replace that with the appropriate number of spaces and you'll be all good.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8006807, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9143f2263b00af97dc5247fd4bf9fd29?s=128&d=identicon&r=PG", "display_name": "Cris", "link": "https://stackoverflow.com/users/8006807/cris"}, "is_accepted": false, "score": 1, "last_activity_date": 1494676739, "creation_date": 1494676739, "answer_id": 43952887, "question_id": 39122970, "link": "https://stackoverflow.com/questions/39122970/haskell-error-parse-error-on-input/43952887#43952887", "title": "Haskell error: parse error on input &#39;=&#39;", "body": "<p>You have to remove all tabs and change it by spaces. I hope that this instruction helps you.</p>\n"}], "owner": {"reputation": 85, "user_id": 5414175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/SjpnR.jpg?s=128&g=1", "display_name": "Julian20151006", "link": "https://stackoverflow.com/users/5414175/julian20151006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5620, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1549195797, "creation_date": 1472040669, "last_edit_date": 1472046795, "question_id": 39122970, "link": "https://stackoverflow.com/questions/39122970/haskell-error-parse-error-on-input", "title": "Haskell error: parse error on input &#39;=&#39;", "body": "<p>I created a new quick.hs file in the ghci.exe directory. And the content is   </p>\n\n<pre><code>quicksort::(Ord a)=&gt;[a]-&gt;[a]  \nquicksort []=[]  \nquicksort (x:xs)=  \n    let smaller = [a |a&lt;-xs,a&lt;=x]  \n        larger = [a |a&lt;-xs,a&gt;x]  \n    in  quicksort smaller ++ [x] ++ quicksort larger \n</code></pre>\n\n<p>When I issue <strong><em>:l quick</em></strong> in the ghci command lline, the output is    </p>\n\n<pre><code>Prelude&gt; :l quick\n[1 of 1] Compiling Main             ( quick.hs, interpreted )\n\nquick.hs:5:17: error:\n    parse error on input \u2018=\u2019\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I have concured this kind of problems many times. What's wrong on earth?</p>\n"}, {"tags": ["c++", "c", "haskell", "ffi"], "comments": [{"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 5662, "user_id": 5781248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712de4f2f811d1a400d3311c9cdd5836?s=128&d=identicon&r=PG&f=1", "display_name": "J.J. Hakala", "link": "https://stackoverflow.com/users/5781248/j-j-hakala"}, "edited": false, "score": 0, "creation_date": 1472037793, "post_id": 39121458, "comment_id": 65589346, "body": "@J.J.Hakala that does not make a difference. I can also use <code>cout</code> earlier in <code>basler_init</code> without any problems."}], "answers": [{"comments": [{"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 3, "creation_date": 1472039048, "post_id": 39122190, "comment_id": 65590193, "body": "Wow, spot on! I used the &quot;hack&quot; from <a href=\"http://www.serpentine.com/blog/2010/09/04/dealing-with-fragile-c-libraries-e-g-mysql-from-haskell/\" rel=\"nofollow noreferrer\">serpentine.com/blog/2010/09/04/&hellip;</a> and all is good now. Thank you!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 8, "last_activity_date": 1472038901, "last_edit_date": 1472038901, "creation_date": 1472038383, "answer_id": 39122190, "question_id": 39121458, "link": "https://stackoverflow.com/questions/39121458/calling-a-shared-library-from-haskell-via-ffi-blocks-while-it-doesnt-when-link/39122190#39122190", "title": "Calling a shared library from Haskell via FFI blocks, while it doesn&#39;t when linked from a C program", "body": "<p>I believe this TRAC commentary is relevant:</p>\n\n<p><a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Signals\">https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Signals</a></p>\n\n<p>The difference occurs starting a line 437 in the C strace output\nvs. line 495 in the Haskell strace output.</p>\n\n<p>At this point the library creates two UDP sockets and sends two UDP datagrams\n(lines 448-449 C / lines 506-507 Haskell). The packets are broadcast to\ntwo local networks: 192.168.1.0/24 and 192.168.56.0/24.</p>\n\n<p>It then waits for a response on either of these sockets with a timeout of (apparently)\n25 microseconds (line 450 C / line 508 Haskell). In the C case the select call\ntimes out. In the Haskell case the select call is repeatedly interrupted by\na SIGVTALRM signal which is used by the GHC RTS. This is the same pattern\nwhich is shown in the the above TRAC commentary.</p>\n\n<p>For a potential fix, have a look at how the mysql package implements and uses the <code>block_rts_signals()</code> and <code>unblock_rts_signals()</code> macros:</p>\n\n<ul>\n<li><a href=\"https://github.com/bos/mysql/blob/00fcc3ae5bb03b49612ecdd43319164377671ad5/cbits/mysql_signals.c\">mysql_signals.c</a></li>\n</ul>\n"}], "owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 3, "accepted_answer_id": 39122190, "answer_count": 1, "score": 6, "last_activity_date": 1472038901, "creation_date": 1472036387, "last_edit_date": 1472037519, "question_id": 39121458, "link": "https://stackoverflow.com/questions/39121458/calling-a-shared-library-from-haskell-via-ffi-blocks-while-it-doesnt-when-link", "title": "Calling a shared library from Haskell via FFI blocks, while it doesn&#39;t when linked from a C program", "body": "<p>I'm trying to interface with a Basler USB3 camera from a Haskell application, but I'm experiencing some difficulty. The camera comes with a C++ library that makes it fairly straight forward. The following code can be used to acquire a camera source:</p>\n\n<pre><code>extern \"C\" {\n  void basler_init() {\n    PylonAutoInitTerm pylon;\n    CInstantCamera camera( CTlFactory::GetInstance().CreateFirstDevice());\n    camera.RegisterConfiguration( (CConfigurationEventHandler*) NULL, RegistrationMode_ReplaceAll, Cleanup_None);\n    cout &lt;&lt; \"Using device \" &lt;&lt; camera.GetDeviceInfo().GetModelName() &lt;&lt; endl;\n  }\n}\n</code></pre>\n\n<p>I've used this source code to build a shared library - <code>libbasler.so</code>. To confirm it works, here's a basic C program that links against it and confirms everything is working:</p>\n\n<pre><code>void basler_init();\n\nint main () {\n  basler_init();\n}\n</code></pre>\n\n<p>I compile and run this as:</p>\n\n<pre><code>$ gcc Test2.c -lbasler -Llib -Wl,--enable-new-dtags -Wl,-rpath,pylon5/lib64 -Wl,-E -lpylonbase -o Test2-c\n\n$ PYLON_CAMEMU=1 LD_LIBRARY_PATH=lib ./Test2-c\nUsing device Emulation\n</code></pre>\n\n<p>This is the expected output.</p>\n\n<p>However, when I try and use this with Haskell, the behaviour changes and the program blocks indefinitely. Here's the Haskell source code:</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nforeign import ccall \"basler_init\" baslerInit :: IO ()\n\nmain :: IO ()\nmain = baslerInit\n</code></pre>\n\n<p>I compile and run this as:</p>\n\n<pre><code>$ ghc --make Test2.hs -o Test2-haskell -Llib -lbasler -optl-Wl,--enable-new-dtags -optl-Wl,-rpath,pylon5/lib64 -optl-Wl,-E -lpylonbase\n\n$ PYLON_CAMEMU=1 LD_LIBRARY_PATH=lib ./Test2-haskell\n</code></pre>\n\n<p>The application now hangs indefinitely.</p>\n\n<p>I have ran both through <code>strace</code> to try and get an idea of what is going on, but I'm unable to really make much sense of it. The output is too long to add here, but please see these two pastes:</p>\n\n<ul>\n<li><code>strace</code> output for the C application: <a href=\"https://gist.github.com/ocharles/001b5f42c09229bc7a8482a22cadf486\">https://gist.github.com/ocharles/001b5f42c09229bc7a8482a22cadf486</a></li>\n<li><code>strace</code> output for the Haskell application: <a href=\"https://gist.github.com/ocharles/4c1c45a9ee78f75cd723f1a2910998f3\">https://gist.github.com/ocharles/4c1c45a9ee78f75cd723f1a2910998f3</a></li>\n</ul>\n\n<p>On top of that, I've used <code>gdb</code> to try and ascertain where the Haskell application is getting stuck:</p>\n\n<pre><code>$ PYLON_CAMEMU=1 LD_LIBRARY_PATH=lib gdb Test2-haskell \nGNU gdb (GDB) 7.11\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-pc-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from Test2-haskell...done.\n(gdb) run\nStarting program: /home/ollie/work/circuithub/receiving-station/Test2-haskell \nwarning: File \"/nix/store/9ljgbhb26ca0j9shwh8bwsa77h42izr2-gcc-5.4.0-lib/lib/libstdc++.so.6.0.21-gdb.py\" auto-loading has been declined by your `auto-load safe-path' set to \"$debugdir:$datadir/auto-load\".\nTo enable execution of this file add\n        add-auto-load-safe-path /nix/store/9ljgbhb26ca0j9shwh8bwsa77h42izr2-gcc-5.4.0-lib/lib/libstdc++.so.6.0.21-gdb.py\nline to your configuration file \"/home/ollie/.gdbinit\".\nTo completely disable this security protection add\n        set auto-load safe-path /\nline to your configuration file \"/home/ollie/.gdbinit\".\nFor more information about this security protection see the\n\"Auto-loading safe path\" section in the GDB manual.  E.g., run from the shell:\n        info \"(gdb)Auto-loading safe path\"\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/nix/store/bb32xf954imhdrzn7j8h82xs1bx7p3fr-glibc-2.23/lib/libthread_db.so.1\".\n^C\nProgram received signal SIGINT, Interrupt.\n0x00007ffff6c6fb33 in __recvfrom_nocancel () from /nix/store/98s2znxww6x7h2ch7cj1w5givahxmdna-glibc-2.23/lib/libc.so.6\n(gdb) bt\n#0  0x00007ffff6c6fb33 in __recvfrom_nocancel () from /nix/store/98s2znxww6x7h2ch7cj1w5givahxmdna-glibc-2.23/lib/libc.so.6\n#1  0x00007fffedb885c2 in GxImp::CEnumCollector::OnReady(unsigned int, _GX_SOCKET_INTERFACE_INFO const*) () from /home/ollie/work/circuithub/receiving-station/pylon5/lib64/libgxapi-5.0.1.so\n#2  0x00007fffedb8d54d in CCollector::Collect(GxImp::CSocket*, unsigned int, unsigned int, _GX_SOCKET_INTERFACE_INFO const*) () from /home/ollie/work/circuithub/receiving-station/pylon5/lib64/libgxapi-5.0.1.so\n#3  0x00007fffedb8817b in CBroadcastSocketCollection::Collect(CCollector&amp;, unsigned int) () from /home/ollie/work/circuithub/receiving-station/pylon5/lib64/libgxapi-5.0.1.so\n#4  0x00007fffedb889ab in Gx::Enumerator::Discover(Gx::Enumerator::Callee*, unsigned int, unsigned int, sockaddr const*) () from /home/ollie/work/circuithub/receiving-station/pylon5/lib64/libgxapi-5.0.1.so\n#5  0x00007fffeddeaca0 in Pylon::CBaslerGigETl::DoDeviceEnumeration(Pylon::DeviceInfoList&amp;, bool, sockaddr const*) () from pylon5/lib64/libpylon_TL_gige-5.0.1.so\n#6  0x00007fffeddeaebc in Pylon::CBaslerGigETl::InternalEnumerateDevices(Pylon::DeviceInfoList&amp;) () from pylon5/lib64/libpylon_TL_gige-5.0.1.so\n#7  0x00007fffeddf3c99 in Pylon::CTransportLayerBase&lt;Pylon::IGigETransportLayer&gt;::EnumerateDevices(Pylon::DeviceInfoList&amp;, Pylon::DeviceInfoList const&amp;, bool) () from pylon5/lib64/libpylon_TL_gige-5.0.1.so\n#8  0x00007ffff7949669 in Pylon::CTlFactory::EnumerateDevices(Pylon::DeviceInfoList&amp;, Pylon::DeviceInfoList const&amp;, bool) () from pylon5/lib64/libpylonbase-5.0.1.so\n#9  0x00007ffff7949c8f in Pylon::CTlFactory::InternalCreateDevice(Pylon::CDeviceInfo const&amp;, GenICam_3_0_Basler_pylon_v5_0::gcstring_vector const&amp;, bool) () from pylon5/lib64/libpylonbase-5.0.1.so\n#10 0x00007ffff794a655 in Pylon::CTlFactory::CreateFirstDevice(Pylon::CDeviceInfo const&amp;) () from pylon5/lib64/libpylonbase-5.0.1.so\n#11 0x00007ffff7bd7dc5 in basler_init () from lib/libbasler.so\n#12 0x0000000000438415 in rFl_info ()\n#13 0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>For the C program:</p>\n\n<pre><code>Reading symbols from Test2-c...done.\n(gdb) run\nStarting program: /home/ollie/work/circuithub/receiving-station/Test2-c \nwarning: File \"/nix/store/9ljgbhb26ca0j9shwh8bwsa77h42izr2-gcc-5.4.0-lib/lib/libstdc++.so.6.0.21-gdb.py\" auto-loading has been declined by your `auto-load safe-path' set to \"$debugdir:$datadir/auto-load\".\nTo enable execution of this file add\n        add-auto-load-safe-path /nix/store/9ljgbhb26ca0j9shwh8bwsa77h42izr2-gcc-5.4.0-lib/lib/libstdc++.so.6.0.21-gdb.py\nline to your configuration file \"/home/ollie/.gdbinit\".\nTo completely disable this security protection add\n        set auto-load safe-path /\nline to your configuration file \"/home/ollie/.gdbinit\".\nFor more information about this security protection see the\n\"Auto-loading safe path\" section in the GDB manual.  E.g., run from the shell:\n        info \"(gdb)Auto-loading safe path\"\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/nix/store/bb32xf954imhdrzn7j8h82xs1bx7p3fr-glibc-2.23/lib/libthread_db.so.1\".\n[New Thread 0x7fffed4ae700 (LWP 13792)]\n[New Thread 0x7fffeccad700 (LWP 13793)]\nUsing device Emulation\n[Thread 0x7fffeccad700 (LWP 13793) exited]\n[Thread 0x7fffed4ae700 (LWP 13792) exited]\n[Inferior 1 (process 13788) exited normally]\n</code></pre>\n\n<p>My guess is GHC's runtime is doing something that causes pthreads to have different behaviour, but I'm not sure what that could be.</p>\n"}, {"tags": ["haskell", "ghc", "typeclass", "type-level-computation"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1472033380, "post_id": 39119372, "comment_id": 65586417, "body": "What&#39;s this <code>|$</code> type?"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1472036593, "post_id": 39119372, "comment_id": 65588598, "body": "It&#39;s a type operator defined as <code>data (|$) a b</code>, uninhabited."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1472041249, "post_id": 39119372, "comment_id": 65591821, "body": "Please add some additional explanation as to what functionality you&#39;d like to have. What does your query do, list some expected input-output mappings for your functions, etc."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1472041462, "post_id": 39119372, "comment_id": 65591967, "body": "Please also include the definitions of all mentioned names."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1472041847, "post_id": 39119372, "comment_id": 65592214, "body": "Also, in <code>Model</code> you have <code>[(Dimension, [DimValue])]</code>, while <code>getAspectLists</code> returns <code>[[(Dimension, DimValue)]]</code>. Is that intended?"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472115876, "post_id": 39119372, "comment_id": 65626320, "body": "I&#39;ll upload the whole project to a public github shortly. Hopefully that will help clear things up."}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472118898, "post_id": 39119372, "comment_id": 65628399, "body": "Check it out: <a href=\"https://github.com/rubenmoor/cellstore\" rel=\"nofollow noreferrer\">github.com/rubenmoor/cellstore</a>"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472118933, "post_id": 39119372, "comment_id": 65628438, "body": "If you are interested, we might want to chat somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472119082, "post_id": 39121674, "comment_id": 65628543, "body": "I started off with an approach based on type-classes. It&#39;s in the github repo that I linked in a comment under the question. I have to compare your code with my initial type-class approach ... I&#39;m afraid, a type-class approach does not result in a concise, type-safe interface for queries."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472640725, "post_id": 39121674, "comment_id": 65831031, "body": "@ruben.moor Huh? I just gave you an example of a concise type-safe interface based on classes."}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472641344, "post_id": 39121674, "comment_id": 65831491, "body": "Ok, maybe you need to help me there. My requirement for a type-safe query is: The model defines, given a number of aspects, what (Haskell-) datatype there is. When writing a query later, the compiler knows the type of the query result and can typecheck. That way I extend type-safety into the database. From what I understand, that is not possible w/o use of type families (which makes my code so complicated). In terms of conciseness: the aspect type-class and instances add quite some boilerplate. Btw I put a link to the complete code in github."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1472641623, "post_id": 39121674, "comment_id": 65831687, "body": "If you want to establish a link between the query type and the result type then type families (or their cousins, functional dependencies) are the way to go. It needn&#39;t be complicated though, it&#39;s actually a relatively minor adjustment to the code I presented."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 1, "last_activity_date": 1472640310, "last_edit_date": 1472640310, "creation_date": 1472036944, "answer_id": 39121674, "question_id": 39119372, "link": "https://stackoverflow.com/questions/39119372/haskell-type-arithmetic-how-to-access-type-level-list-of-lists/39121674#39121674", "title": "Haskell type arithmetic: how to access type-level list of lists", "body": "<p>I don't really understand what you're trying to do, but I'll say this. Types are primarily useful for classifying values. Building up a lot of type-level information, erasing it at the value-level using a <code>Proxy</code>, and then trying to recover it using classes to pattern-match on types results in complicated code (as you've seen) and doesn't really buy you anything in terms of safety or terseness.</p>\n\n<p>Keep it simple. My advice is to think more carefully about what information your API clients will know in advance - this is type-level stuff - and what clients will want to construct dynamically. Use the type-level stuff to classify the value-level stuff.</p>\n\n<p>In this instance, your users will know their <em>schema</em> in advance - the various dimensions of the model - but they generally won't know which views over those dimensions they'll be querying.</p>\n\n<hr>\n\n<p>Here's a sketch, which won't necessarily help you out directly, but should at least point you in the right direction. Pay attention to how I use types to classify values, not just as meaningless bits of compile-time data. This allows me to use the class system to generate code in a type-directed fashion, leading to a concise API without sacrificing safety. Plus, if you're willing to forego <code>TypeOperators</code> and <code>PatternSynonyms</code>, this solution is entirely Haskell 98.</p>\n\n<p>This is what the API for the library looks like:</p>\n\n<pre><code>data Currency = EUR | USD deriving Show\ndata FlowType = Stock | FlowType deriving Show\n\n-- this class just wraps up knowledge of the type's name.\n-- You could generate these instances using Template Haskell\ninstance Aspect Currency where\n    aspectName = const \"Currency\"\ninstance Aspect FlowType where\n    aspectName = const \"FlowType\"\n\n-- queries contain a currency and a flowtype\ntype Model = () :&amp;: Currency :&amp;: FlowType\n\nmyQuery :: Q Model\nmyQuery = () :&amp;: EUR :&amp;: Stock :@ 3.3\n</code></pre>\n\n<p>The user defines their own aspect types like <code>Currency</code> and <code>FlowType</code>, and writes instances of <code>Aspect</code> for each of them. They then compose the aspects into a bigger type using <code>:&amp;:</code>, terminating the list using <code>I</code>. Then, when the time comes to build a query, the client has to provide values for the various aspects in the correct order.</p>\n\n<p>Here's how it's implemented. Models that are built using the <code>:&amp;:</code> type combinator will automatically be instances of the following <code>Query</code> class.</p>\n\n<pre><code>class Query a where\n    showQuery :: a -&gt; String\n</code></pre>\n\n<p>I'm representing models built with <code>:&amp;:</code> as nested tuples. This allows me to build and recurse on tuples of arbitrary size. <code>Q</code> simply pairs up a <code>Model</code> with a <code>Double</code> value, and <code>A</code> is just a marker newtype for aspects.</p>\n\n<pre><code>infixl 5 :&amp;:\ntype (m :&amp;: a) = (m, A a)\npattern m :&amp;: a = (m, A a)\n\nnewtype A a = A a\n\ninfixl 3 :@\ndata Q m = m :@ Double\n</code></pre>\n\n<p>Instances of <code>Query</code> compile a query into a string by structural recursion on the nested tuple. (If we'd used flat tuples, we'd have to write <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.Show.html#line-223\" rel=\"nofollow\">lots of instances</a> of <code>Query</code> - one for each size of tuple - though it would improve performance somewhat because unpacking a tuple is always O(1).)</p>\n\n<pre><code>instance Query a =&gt; Query (Q a) where\n    showQuery (a :@ x) = showQuery a ++ \"@\" ++ show x\ninstance (Query a, Query b) =&gt; Query (a, b) where\n    showQuery (x, y) = showQuery x ++ \", \" ++ showQuery y\ninstance Query () where\n    showQuery = const \"\"\ninstance Aspect a =&gt; Query (A a) where\n    showQuery (A x) = aspectName (proxy x) ++ \": \" ++ show x\n        where proxy :: a -&gt; Proxy a\n              proxy = const Proxy\n</code></pre>\n\n<p>The <code>Aspect</code> class just wraps up static knowledge of the type's name so that we can use it in the compiled string.</p>\n\n<pre><code>class Show c =&gt; Aspect c where\n    aspectName :: Proxy c -&gt; String\n</code></pre>\n\n<p>The proof of the pudding is in the eating:</p>\n\n<pre><code>ghci&gt; showQuery myQuery\n\", Currency: EUR, FlowType: Stock@3.3\"  -- the leading comma is fixable. You get the idea\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "is_accepted": true, "score": 0, "last_activity_date": 1472914681, "creation_date": 1472914681, "answer_id": 39308264, "question_id": 39119372, "link": "https://stackoverflow.com/questions/39119372/haskell-type-arithmetic-how-to-access-type-level-list-of-lists/39308264#39308264", "title": "Haskell type arithmetic: how to access type-level list of lists", "body": "<p>This is a solution, thanks to Kosmikus.</p>\n\n<pre><code>{-# LANGUAGE TypeOperators, DataKinds, PolyKinds, ScopedTypeVariables, TypeInType #-}\n{-# LANGUAGE TypeFamilies, FlexibleInstances, GADTs #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# OPTIONS_GHC -fno-warn-unticked-promoted-constructors #-}\n\nmodule IsList where\n\nimport Data.Proxy\nimport GHC.TypeLits hiding (Nat)\nimport GHC.Types (Type)\n\ntype family Extract (k :: Type) :: Type where\n  Extract Symbol = String\n  Extract [a]    = [Extract a]\n\nclass Extractable (a :: k) where\n  extract :: Proxy (a :: k) -&gt; Extract k\n\ninstance KnownSymbol a =&gt; Extractable (a :: Symbol) where\n  extract p = symbolVal p\n\ninstance Extractable ('[] :: [a]) where\n  extract _ = []\n\ninstance (Extractable x, Extractable xs) =&gt; Extractable (x ': xs) where\n  extract _ = extract (Proxy :: Proxy x) : extract (Proxy :: Proxy xs)\n</code></pre>\n\n<p>It's not even that complicated, but I didn't get the nesting straight. This solutions works for lists of lists nested to arbitrary depths.</p>\n\n<p>The <code>type family</code> should probably be an associated type family of the <code>Extractable</code> class.</p>\n"}], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 1, "accepted_answer_id": 39308264, "answer_count": 2, "score": 0, "last_activity_date": 1472914681, "creation_date": 1472030724, "question_id": 39119372, "link": "https://stackoverflow.com/questions/39119372/haskell-type-arithmetic-how-to-access-type-level-list-of-lists", "title": "Haskell type arithmetic: how to access type-level list of lists", "body": "<p>I am working on a type-level representation for cell-based database models that features queries as Haskell-types. I got stuck when trying to extract values from a more complex query type.</p>\n\n<p>Let me first show you code that works:</p>\n\n<pre><code>-- a model with datapoints defined by a list of \"aspects\"\n-- every aspect has a \"dimension\" and a list of dimensional values\ntype Model = Double  $|$ Aspect \"currency\" '[\"eur\", \"usd\"]\n                      |$ Aspect \"flowtype\" '[\"stock\", \"flow\"]\n                      |$ Nil\n\n-- extract the aspects from the query type\nclass GetAspectsSingle a where\n  getAspectsSingle :: Proxy a -&gt; [(Dimension, DimValue)]\n\ninstance (KnownSymbol d, KnownSymbol v, GetAspectsSingle as)\n      =&gt; GetAspectsSingle (Aspect d v |$ as) where\n  getAspectsSingle _ = (symbolText (Proxy :: Proxy d),\n                        symbolText (Proxy :: Proxy v))\n                         : (getAspectsSingle (Proxy :: Proxy as))\n\ninstance GetAspectsSingle Nil where\n  getAspectsSingle _ = []\n\n-- a dummy for the execution of a type-safe query\n-- where CellTypeSingle is a type function that evaluates to the expected type\nsave :: (MonadIO m, GetAspectsSingle q)\n      =&gt; Proxy model -&gt; Proxy q -&gt; CellTypeSingle model q -&gt; m ()\n-- just print aspects instead of actual query\nsave Proxy query _ = liftIO . print $ getAspectsSingle query\n\n-- an example query\nquery :: Proxy (Aspect \"currency\" \"eur\" |$ Aspect \"flowtype\" \"stock\" |$ Nil)\nquery = Proxy\n\ntest :: IO ()\ntest = save (Proxy :: Proxy Model) query 3.3\n</code></pre>\n\n<p>The key idea is that the type function <code>CellTypeSingle</code> evaluates to <code>Double</code> and thus the above code compiles, only if <code>3.3</code> is of type <code>Double</code>.</p>\n\n<p>I want to have queries that allow the selection of several values (of same type) like this:</p>\n\n<pre><code>query :: Proxy (Aspect \"currency\" '[\"eur\", \"usd\"] |$ Aspect \"flowtype\" '[\"stock\"] |$ Nil)\nquery = Proxy\n</code></pre>\n\n<p>I managed to implement the corresponding type function <code>CellTypeList</code> that evaluates to <code>[Double]</code> in the above case. In order to get the aspects, however, I have to \"explode\" the query first. I.e. the above query becomes a list of queries.\nThis is what I tried.</p>\n\n<pre><code>saveList :: (MonadIO m, GetAspectsList q)\n         =&gt; Proxy model -&gt; Proxy q -&gt; CellTypeList model q -&gt; m ()\n-- just print aspects instead of actual query\nsave Proxy query _ = liftIO . print $ getAspectsList query\n\nclass GetAspectsList query where\n  type GetAspectsListType (query :: Type) :: Type\n  getAspectsList :: Proxy query -&gt; GetAspectsListType query -&gt; [[(Dimension, DimValue)]]\n\ninstance (GetAspectsList as)\n      =&gt; GetAspectsList (a |$ as) where\n  type GetAspectsListType (a |$ as) = GetAspectsListType (ExplodeQuery (a |$ as))\n  getAspectsList = ???\n</code></pre>\n\n<p>Now I got stuck: <code>ExplodeQuery</code> evaluates to <code>'[ '[ Aspect \"currency\" \"eur\", Aspect \"flowtype\" \"stock\" ], '[ Aspect \"currency\" \"usd\", Aspect \"flowtype\" \"stock\"] ]</code>, that is a list of lists on type-level.</p>\n\n<p>I don't know how to extract the <em>dimension</em> and <em>dimensional values</em> from there.</p>\n"}, {"tags": ["haskell", "where-clause"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 4, "creation_date": 1472028426, "post_id": 39118335, "comment_id": 65583241, "body": "<code>negRef&#47;2</code> is not a valid pattern."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1472028926, "post_id": 39118335, "comment_id": 65583535, "body": "The inner where clause is in scope for only the second line in the definition of divs. When the first line of divs calls negDiv, the inner where clause is not in scope. That and the pattern thing."}, {"owner": {"reputation": 105, "user_id": 4809575, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c72329f445630e8fae179221608685fe?s=128&d=identicon&r=PG", "display_name": "fant0me", "link": "https://stackoverflow.com/users/4809575/fant0me"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1472038416, "post_id": 39118335, "comment_id": 65589807, "body": "Then how could I correctly write that division pattern? @MathematicalOrchid"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1472040909, "post_id": 39118335, "comment_id": 65591579, "body": "@flamenquino You can&#39;t; you need to use a guard: <code>negDiv x y negList | x == y&#47;2 = (x:y:negList)</code> Other cases are specified as additional guards, since the patterns <code>x</code> and <code>y</code> will match anything."}], "answers": [{"comments": [{"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 0, "creation_date": 1472137835, "post_id": 39118928, "comment_id": 65641231, "body": "Sometimes <code>where</code> is preferable to <code>let</code>, sometimes it&#39;s the other way around. I don&#39;t think one is more idiomatic than the other. See <a href=\"http://stackoverflow.com/questions/4362328/haskell-where-vs-let\">stackoverflow.com/questions/4362328/haskell-where-vs-let</a> for example."}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": true, "score": 4, "last_activity_date": 1472029772, "last_edit_date": 1495542183, "creation_date": 1472029466, "answer_id": 39118928, "question_id": 39118335, "link": "https://stackoverflow.com/questions/39118335/using-nested-where-clauses-in-haskell/39118928#39118928", "title": "Using nested `where` clauses in Haskell", "body": "<p>Your second <code>where</code>-clause doesn't use any name from the <code>divs</code> scope. You can just use one single clause like so:</p>\n\n<pre><code>divisors' :: (Integral a) =&gt; a -&gt; [a]\ndivisors' x = divs x (x/2) [x]\n  where\n    divs ref 1 list = negDiv (-ref) (-2) ((-1):1:list)\n    divs ref num list = if (mod ref num == 0) then divs ref (num-1) (num:list) else divs ref (num-1) list\n    negDiv negRef (negRef/2) negList = (negRef:(negRef/2):negList)\n    negDiv negRef negNum negList = if (mod negRef negNum == 0) then negDiv (negNum-1) (negNum:negList) else negDiv (negNum-1) negList\n</code></pre>\n\n<p>If you really want to express your function with nested clauses, you can use <code>let ... in</code>.</p>\n\n<p>But in this case this is not useful, I recommend using the <code>where</code> clause (which is often preferred to <code>let ... in</code>, considered to be less idiomatic in most cases).</p>\n\n<p>The reason why it is not working is that the clause is attached to the second equation of <code>divs</code>, not the first one which uses <code>negDiv</code>.</p>\n\n<p>PS: As <a href=\"https://stackoverflow.com/questions/39118335/using-nested-where-clauses-in-haskell/39118928#comment65583241_39118335\">MathematicalOrchid said</a>, <code>negRef/2</code> is not a valid pattern, that is where your error comes from.</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 4809575, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c72329f445630e8fae179221608685fe?s=128&d=identicon&r=PG", "display_name": "fant0me", "link": "https://stackoverflow.com/users/4809575/fant0me"}, "edited": false, "score": 0, "creation_date": 1472038501, "post_id": 39120215, "comment_id": 65589879, "body": "I&#39;ve done it before, using <code>div</code>, but it returned me the same error."}], "tags": [], "owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "is_accepted": false, "score": 2, "last_activity_date": 1472033009, "last_edit_date": 1495541312, "creation_date": 1472033009, "answer_id": 39120215, "question_id": 39118335, "link": "https://stackoverflow.com/questions/39118335/using-nested-where-clauses-in-haskell/39120215#39120215", "title": "Using nested `where` clauses in Haskell", "body": "<p>Another issue is that the <code>/</code> operator doesn't work on integers. In Haskell, <code>/</code> is the division operator for fields, and as such requires a <code>Fractional</code> type such as <code>Rational</code> or <code>Double</code>.</p>\n\n<p>For <em>integer</em> division you should instead use <a href=\"https://stackoverflow.com/q/8111120/617159\"><code>div</code> or <code>quot</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1472044556, "last_edit_date": 1472044556, "creation_date": 1472041703, "answer_id": 39123339, "question_id": 39118335, "link": "https://stackoverflow.com/questions/39118335/using-nested-where-clauses-in-haskell/39123339#39123339", "title": "Using nested `where` clauses in Haskell", "body": "<p>You have several problems:</p>\n\n<ol>\n<li>You can only pattern match on literals and data constructors, not arbitrary functions like <code>/</code>.</li>\n<li><code>/</code> is only defined for <code>Fractional a</code> values, not <code>Integral</code>. Use <code>div</code> instead.</li>\n<li>You definitions of <code>negDiv</code> are missing an argument in the recursive calls. It's not clear what the arguments should be, though.</li>\n</ol>\n\n<p>A mostly corrected version:</p>\n\n<pre><code>divisors' :: (Integral a) =&gt; a -&gt; [a]\ndivisors' x = divs x (x `div` 2) [x]\n  where\n    divs ref 1 list = negDiv (-ref) (-2) ((-1):1:list)\n    divs ref num list | ref `mod` num == 0 = divs ref (num-1) (num:list) \n                      | otherwise          = divs ref (num-1) list\n    -- Three arguments, but only two given to each recursive call\n    negDiv x y negList | x == negRef `div` 2 = x:y:negList\n                       | x `mod` y == 0      = negDiv (y-1) (y:negList)\n                       | otherwise           = negDiv (y-1) negList\n</code></pre>\n\n<hr>\n\n<p>By the way, this is much more simply done with</p>\n\n<pre><code>divisors' x = ds ++ (map negate ds)               -- positive and negative ds\n              where ds = filter (divs x) [1..x]   -- d such that d divides x\n                    x `divs` y = x `mod` y == 0   -- Does y divide x?\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>divisors' x = [d | d &lt;- [(-x)..x], d /= 0, x `mod` d == 0]\n</code></pre>\n\n<p>Anytime you find yourself writing recursive functions to iterate over a list, you are probably overlooking the correct higher-order function or list comprehension.</p>\n"}], "owner": {"reputation": 105, "user_id": 4809575, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c72329f445630e8fae179221608685fe?s=128&d=identicon&r=PG", "display_name": "fant0me", "link": "https://stackoverflow.com/users/4809575/fant0me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 2, "accepted_answer_id": 39118928, "answer_count": 3, "score": 0, "last_activity_date": 1472044556, "creation_date": 1472027808, "question_id": 39118335, "link": "https://stackoverflow.com/questions/39118335/using-nested-where-clauses-in-haskell", "title": "Using nested `where` clauses in Haskell", "body": "<p>While learning Haskell, I've to do a function to return all whole numbers divisors of a given number. So, I've created it using two nested <code>where</code> clauses, but it doesn't work.</p>\n\n<p><strong>Error returned</strong>: <code>exs2.hs:49:24: Parse error in pattern: negRef / 2</code></p>\n\n<pre><code>divisors' :: (Integral a) =&gt; a -&gt; [a]\ndivisors' x = divs x (x/2) [x]\n  where\n    divs ref 1 list = negDiv (-ref) (-2) ((-1):1:list)\n    divs ref num list = if (mod ref num == 0) then divs ref (num-1) (num:list) else divs ref (num-1) list\n      where\n        negDiv negRef (negRef/2) negList = (negRef:(negRef/2):negList)\n        negDiv negRef negNum negList = if (mod negRef negNum == 0) then negDiv (negNum-1) (negNum:negList) else negDiv (negNum-1) negList\n</code></pre>\n\n<p>What's the wrong thing then? It seems to be well indented.</p>\n"}, {"tags": ["haskell", "let"], "answers": [{"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 6, "last_activity_date": 1472025785, "creation_date": 1472025785, "answer_id": 39117671, "question_id": 39117524, "link": "https://stackoverflow.com/questions/39117524/haskell-let-statement-copy-data-type-to-itself-with-without-modification-not-w/39117671#39117671", "title": "Haskell: let statement, copy data type to itself with/without modification not working", "body": "<p>The issue you're running into is that <em>all</em> <code>let</code> and <code>where</code> bindings in Haskell are recursive by default. So when you write</p>\n\n<pre><code>let rec = rec { ... }\n</code></pre>\n\n<p>it tries to define a circular data type that will loop forever when you try to evaluate it (just like <code>let a = a</code>).</p>\n\n<p>There's no real way around this\u2014it's a tradeoff in the language. It makes recursive functions (and even plain values) easier to write with less noise, but also means you can't easily redefine <code>a</code> a bunch of times in terms of itself.</p>\n\n<p>The only thing you can really do is give your values different names\u2014<code>rec</code> and <code>rec'</code> would be a common way to do this.</p>\n\n<p>To be fair to Haskell, recursive functions and even recursive values come up quite often. Code like</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\n</code></pre>\n\n<p>can be really nice once you get the hang of it, and not having to explicitly mark this definition as recursive (like you'd have to do in, say, OCaml) is a definite upside.</p>\n"}, {"tags": [], "owner": {"reputation": 9010, "user_id": 812034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b646bea073b6f95ee97064322877a87a?s=128&d=identicon&r=PG", "display_name": "Earth Engine", "link": "https://stackoverflow.com/users/812034/earth-engine"}, "is_accepted": false, "score": 1, "last_activity_date": 1472340565, "last_edit_date": 1472340565, "creation_date": 1472026572, "answer_id": 39117942, "question_id": 39117524, "link": "https://stackoverflow.com/questions/39117524/haskell-let-statement-copy-data-type-to-itself-with-without-modification-not-w/39117942#39117942", "title": "Haskell: let statement, copy data type to itself with/without modification not working", "body": "<p>First of all, Haskell does not allow \"copying\" data to itself, which in the normal sense, means the data is mutable. In Haskell you don't have mutable \"variable\"s, so you will not be able to modify the value a given variable presents.</p>\n\n<p>All you have did, is <em>define</em> a new variable which have the same name of its previous version. But, to do this properly, you have to refer to the <em>old</em> variable, not the newly defined one. So your original definition</p>\n\n<pre><code>let rec = rec { field=1 }\n</code></pre>\n\n<p>is a recursive definition, the name <code>rec</code> refer to itself. But what you intended to do, is to refer to the <code>rec</code> defined early on.</p>\n\n<p>So this is a name conflict.</p>\n\n<p>Haskell have some machenism to work around this. One is your \"temporary renaming\". </p>\n\n<p>For the original example this looks like</p>\n\n<pre><code>let rec' = rec\nlet rec = rec' { field=1 }\n</code></pre>\n\n<p>This looks like your given solution. But remember this is only available in a command line environment. If you try to use this in a function, you may have to  write</p>\n\n<pre><code>let rec' = rec in let rec = rec' { field=1 } in ...\n</code></pre>\n\n<p>Here is another workaround, which might be useful when <code>rec</code> is belong to another module (say \"<code>MyModule</code>\"):</p>\n\n<pre><code>let rec = MyModule.rec { field=1 }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": false, "score": 2, "last_activity_date": 1472030527, "last_edit_date": 1472030527, "creation_date": 1472027515, "answer_id": 39118245, "question_id": 39117524, "link": "https://stackoverflow.com/questions/39117524/haskell-let-statement-copy-data-type-to-itself-with-without-modification-not-w/39118245#39118245", "title": "Haskell: let statement, copy data type to itself with/without modification not working", "body": "<p>You never need to update a variable : you can always make another variable with the new value. In your case <code>let rec' = rec{field = 1}</code>.</p>\n\n<p>Maybe you worry about performance and the value being unnecessarily copied. That's the compiler's job, not yours : even if you declare 2 variables in your code, the compiler should only make one in memory and update it in place.</p>\n\n<p>Now there are times when the code is so complex that the compiler fails to optimize. You can tell by inspecting the intermediate core language, or even the final assembly. Profile first to know what functions are slow : if it's just an extra Int or Double, you don't care.</p>\n\n<p>If you do find a function that the compiler failed to optimize and that takes too much time, then you can rewrite it to handle the memory yourself. You will then use things like unboxed vectors, IO and ST monad, or even language extensions to access the native machine-level types.</p>\n"}], "owner": {"reputation": 47, "user_id": 1492928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d299f945d0adc10fc2f0576a140e3f7?s=128&d=identicon&r=PG", "display_name": "Noob Saibot", "link": "https://stackoverflow.com/users/1492928/noob-saibot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 1, "accepted_answer_id": 39117671, "answer_count": 3, "score": 1, "last_activity_date": 1472340565, "creation_date": 1472025386, "last_edit_date": 1472026602, "question_id": 39117524, "link": "https://stackoverflow.com/questions/39117524/haskell-let-statement-copy-data-type-to-itself-with-without-modification-not-w", "title": "Haskell: let statement, copy data type to itself with/without modification not working", "body": "<p>I want to update a record syntax with a change in one field so i did something like:</p>\n\n<pre><code>let rec = rec{field = 1}\n</code></pre>\n\n<p>But I've noticed that i can't print <code>rec</code> anymore, means the compiler seems to get into an infinite loop when i try. so i have tried doing:</p>\n\n<pre><code>let a = 1 -- prints OK\n\nlet a = a -- now i can't print a (also stuck in a loop) \n</code></pre>\n\n<p>So i can't do <code>let a = a</code> with any type, but i don't understand why, and how should i resolve this issue.</p>\n\n<p>BTW: while doing:</p>\n\n<pre><code>let b = a {...record changes..}\n\nlet a = b\n</code></pre>\n\n<p>works, but seems redundant.</p>\n"}, {"tags": ["haskell", "google-oauth", "yesod", "keter"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1472023557, "post_id": 39113310, "comment_id": 65580189, "body": "I recently faced the same problem. It seemed to be a bug coming out of the tls package. Switching to <code>lts-6.11</code> resolved it for me. I haven&#39;t still got around to figuring out the exact problem."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1472024045, "post_id": 39113310, "comment_id": 65580476, "body": "This is the possible issue: <a href=\"https://github.com/vincenthz/hs-tls/issues/152\" rel=\"nofollow noreferrer\">github.com/vincenthz/hs-tls/issues/152</a>"}, {"owner": {"reputation": 123, "user_id": 6257921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vMSb-u_jr9Q/AAAAAAAAAAI/AAAAAAAABLk/0-qCDsnM1MY/photo.jpg?sz=128", "display_name": "Graham Leach-Krouse", "link": "https://stackoverflow.com/users/6257921/graham-leach-krouse"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1472049164, "post_id": 39113310, "comment_id": 65597870, "body": "Thanks! Downgrading seems to have resolved the issue. There&#39;s a puzzle here, since the tls package doesn&#39;t change between lts-6.11 and lts-6.12. Changes are listed here:<a href=\"https://www.stackage.org/diff/lts-6.11/lts-6.12\" rel=\"nofollow noreferrer\">stackage.org/diff/lts-6.11/lts-6.12</a>. My best guess is that the proximate cause is either either yesod-core or connection. Though the ultimate cause could still be that tls issue---maybe some change in these other packages exposed it."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1472049329, "post_id": 39113310, "comment_id": 65597989, "body": "Yeah, you are right. I have to look on this further to see what&#39;s the actual issue. Will update here in case I find it!"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1473197919, "post_id": 39113310, "comment_id": 66046333, "body": "It seems to be working in the latest lts-6.15 for me."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10167266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45213e02591c94fd05b5e30eaf6ca86a?s=128&d=identicon&r=PG&f=1", "display_name": "paetiers", "link": "https://stackoverflow.com/users/10167266/paetiers"}, "is_accepted": false, "score": -2, "last_activity_date": 1533145695, "creation_date": 1533145695, "answer_id": 51639385, "question_id": 39113310, "link": "https://stackoverflow.com/questions/39113310/sudden-yesod-tls-exception-decodeerror/51639385#51639385", "title": "sudden yesod tls exception, DecodeError", "body": "<p>I had bump up to lts-6.28 to get it work.</p>\n"}], "owner": {"reputation": 123, "user_id": 6257921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vMSb-u_jr9Q/AAAAAAAAAAI/AAAAAAAABLk/0-qCDsnM1MY/photo.jpg?sz=128", "display_name": "Graham Leach-Krouse", "link": "https://stackoverflow.com/users/6257921/graham-leach-krouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1533145695, "creation_date": 1472004132, "question_id": 39113310, "link": "https://stackoverflow.com/questions/39113310/sudden-yesod-tls-exception-decodeerror", "title": "sudden yesod tls exception, DecodeError", "body": "<p>I've suddenly started encountering the following errors when attempting to use gmail authentication (<code>Yesod.Auth.GoogleEmail2</code>) in my Yesod Application:</p>\n\n<pre><code>FailedConnectionException2 \"www.googleapis.com\" 443 True sendBuf: resource vanished (Broken pipe)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>TlsExceptionHostPort (HandshakeFailed (Error_Packet_unexpected \"Alert [(AlertLevel_Fatal,DecodeError)]\" \" expected: change cipher\")) \"www.googleapis.com\" 443\n</code></pre>\n\n<p>The second error is more common. It's still possible to log in---reloading after the error gives</p>\n\n<pre><code>StatusCodeException (Status {statusCode = 400, statusMessage = \"Bad Request\"}) [(\"Content-Type\",\"application/json; charset=utf-8\"),(\"Cache-Control\",\"no-cache, no-store, max-age=0, must-revalidate\"),(\"Pragma\",\"no-cache\"),(\"Expires\",\"Mon, 01 Jan 1990 00:00:00 GMT\"),(\"Date\",\"Wed, 24 Aug 2016 01:13:02 GMT\"),(\"Content-Encoding\",\"gzip\"),(\"X-Content-Type-Options\",\"nosniff\"),(\"X-Frame-Options\",\"SAMEORIGIN\"),(\"X-XSS-Protection\",\"1; mode=block\"),(\"Server\",\"GSE\"),(\"Alternate-Protocol\",\"443:quic\"),(\"Alt-Svc\",\"quic=\\\":443\\\"; ma=2592000; v=\\\"35,34,33,32,31,30\\\"\"),(\"Transfer-Encoding\",\"chunked\"),(\"X-Response-Body-Start\",\"{\\n  \\\"error\\\" : \\\"invalid_grant\\\",\\n  \\\"error_description\\\" : \\\"Code was already redeemed.\\\"\\n}\"),(\"X-Request-URL\",\"POST https://accounts.google.com:443/o/oauth2/token\")] (CJ {expose = []})\n</code></pre>\n\n<p>and heading back through the auth route after getting that message logs you in.</p>\n\n<p>I'm building on the Yesod scaffolded site, and as far as I can tell, nothing has changed in Foundation.hs or Application.hs since before this problem started showing up. The application is being deployed with keter, and compiled in stack lts-6.12</p>\n\n<p>twofold question: what's the cause, and what's the fix?</p>\n"}, {"tags": ["haskell", "emacs"], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 0, "creation_date": 1472003837, "post_id": 39113088, "comment_id": 65573696, "body": "Thanks @Jack. Great answer. I updated the Question to explain that this is actually a Haskell REPL provided by a plugin. I would have expected it to have the features of a standard shell, but apparently not."}], "tags": [], "owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "is_accepted": false, "score": 2, "last_activity_date": 1472003359, "last_edit_date": 1472003359, "creation_date": 1472002266, "answer_id": 39113088, "question_id": 39112746, "link": "https://stackoverflow.com/questions/39112746/emacs-shell-term-unlock-cursor-from-madly-scrolling-output/39113088#39113088", "title": "Emacs shell/term - unlock cursor from madly scrolling output", "body": "<p>You probably want <code>term-line-mode</code>. By default it should be <kbd>C-c C-j</kbd>, so you can toggle it on and off.</p>\n"}], "owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1472003708, "creation_date": 1471999322, "last_edit_date": 1472003708, "question_id": 39112746, "link": "https://stackoverflow.com/questions/39112746/emacs-shell-term-unlock-cursor-from-madly-scrolling-output", "title": "Emacs shell/term - unlock cursor from madly scrolling output", "body": "<p>I would like to temporarily decouple the cursor from the terminal output in emacs. In an eclipse console there's a button for this, so you can page up and see previous output without the latest line of output grabbing the cursor back.</p>\n\n<p>Does emacs allow you to do this? Is there some variable or command?</p>\n\n<p><strong>Update:</strong> I'm actually using plugins that run a GHCi (Haskell) REPL in a terminal window. I guess I assumed they would have built the REPL on top of the terminal or eshell in out-of-box Emacs. But the <code>term-line-mode</code> command @Jack pointed out is for some reason not available in the GHCi REPL. So I guess this just became a Haskell-specific question...</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1472002479, "post_id": 39112453, "comment_id": 65573374, "body": "<code>Foo.Internal</code> needs to appear in the <code>extra-modules:</code> list in your <code>.cabal</code> file."}, {"owner": {"reputation": 53, "user_id": 3230242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe498b9fb4caf65e795bf36e2f777f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/3230242/tobin"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1472071165, "post_id": 39112453, "comment_id": 65610610, "body": "Fixed the issue, thanks"}], "owner": {"reputation": 53, "user_id": 3230242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe498b9fb4caf65e795bf36e2f777f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/3230242/tobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1471996903, "creation_date": 1471996903, "question_id": 39112453, "link": "https://stackoverflow.com/questions/39112453/haskell-reexport-linker-errors", "title": "Haskell reexport linker errors", "body": "<p>I want to have a function in a <code>Foo.Internal</code> module that is used by other things in there, but it should also be exposed by the <code>Foo</code> module. When I reexport the function from <code>Foo</code> to use elsewhere I get linker errors. I am using stack to build the code, so it might be an issue there, or with cabal, not sure.</p>\n\n<p>Minimal working example:</p>\n\n<pre><code>module Foo.Internal where\nsecrets = \"stuff\"\n\nmodule Foo(secrets) where\nimport Foo.Internal (secrets)\n\nmodule Main where\nimport Foo\nmain = putStrLn secrets\n</code></pre>\n\n<p>When I compile this with <code>stack build</code> I get</p>\n\n<pre><code>package-0.1.0.0: build\nPreprocessing library package-0.1.0.0...\n[1 of 2] Compiling Foo.Internal     ( src/Foo/Internal.hs, .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/Foo/Internal.o )\n[2 of 2] Compiling Foo              ( src/Foo.hs, .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/Foo.o )\nIn-place registering package-0.1.0.0...\nPreprocessing executable 'package-exe' for package-0.1.0.0...\nLinking .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/package-exe/package-exe ...\n.stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/package-exe/package-exe-tmp/Main.o:(.text+0x26): undefined reference to `packazuEPdwTk5e5ZZOCOiVJMdOJ3P_FooziInternal_secrets_closure'\n.stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/package-exe/package-exe-tmp/Main.o: In function `S2Re_srt':\n(.data+0x40): undefined reference to `packazuEPdwTk5e5ZZOCOiVJMdOJ3P_FooziInternal_secrets_closure'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["haskell", "pipe"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1471997186, "post_id": 39112380, "comment_id": 65572113, "body": "Can you show a complete error message please?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1471997280, "post_id": 39112380, "comment_id": 65572132, "body": "<a href=\"http://stackoverflow.com/questions/37119459/no-instance-for-show-io-arising-from-a-use-of-print\">This</a> might help."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1471997345, "post_id": 39112380, "comment_id": 65572148, "body": "AFAIK, <code>main</code> must have type <code>main :: IO()</code> or <code>main :: [String] -&gt; IO()</code>."}, {"owner": {"reputation": 45, "user_id": 1569125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28513668964a740109e670194e728a2b?s=128&d=identicon&r=PG", "display_name": "andrea", "link": "https://stackoverflow.com/users/1569125/andrea"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1471998080, "post_id": 39112380, "comment_id": 65572329, "body": "the complete error message is:        &gt; cabal build           Building java2scala-1.0...     Preprocessing library java2scala-1.0...     In-place registering java2scala-1.0...     Preprocessing executable &#39;java2scala&#39; for java2scala-1.0...     Preprocessing executable &#39;test&#39; for java2scala-1.0...     [5 of 5] Compiling Main             ( test/Main.hs, dist/build/test/test-   tmp/Main.o )  test/Main.hs:27:1:     No instance for (Show (IO J2s)) arising from a use of \u2018main\u2019     In the expression: main     When checking the type of the IO action \u2018main\u2019"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1471998604, "post_id": 39112380, "comment_id": 65572477, "body": "Please edit your question so you can use proper formatting."}, {"owner": {"reputation": 45, "user_id": 1569125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28513668964a740109e670194e728a2b?s=128&d=identicon&r=PG", "display_name": "andrea", "link": "https://stackoverflow.com/users/1569125/andrea"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1471999277, "post_id": 39112380, "comment_id": 65572631, "body": "Yeah, edited Thanks! . Problem is resolved :-)"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1471998373, "last_edit_date": 1471998373, "creation_date": 1471998031, "answer_id": 39112606, "question_id": 39112380, "link": "https://stackoverflow.com/questions/39112380/no-instance-for-show-arising-from-a-use-in-main-level/39112606#39112606", "title": "No instance for Show arising from a use in &quot;main&quot; level", "body": "<p>A signature like <code>Show (IO J2s) =&gt; IO ()</code> almost never makes sense. What this expresses is basically \u201cprovided the universe is crafted such that <code>IO J2s</code> has a <code>Show</code> instance, I give you an <code>IO ()</code> action\u201d. Well, if the universe has that property, then give us <code>IO ()</code> action right now. <a href=\"https://youtu.be/fYiCPmwOV4A?t=44s\" rel=\"nofollow\">Keep nasty <del>chips</del>constraints</a>!\n<br>Constraints only really make sense if you apply them to <em>type variables</em>, i.e. if you're writing code that's polymorphic over several different, but not <em>all</em> types. (Like with <code>CheckP p</code>). But a constraint applied to concrete types does little more than defer type errors.</p>\n\n<p><code>IO J2s</code> <em>has no <code>Show</code> instance</em>. And it can't have such an instance: this is an <em>IO action</em>. It could be a complete subprogram that might execute costly computations, call commercial third-party library code, launch some missiles... and only in the very end return a <code>J2s</code> value. How do you expect to pack all the information of something so possibly complex into a simple string?</p>\n\n<p>What possibly does have a <code>Show</code> instance is <code>J2s</code>. If you're in the <code>IO</code> monad anyway and have an <code>IO J2s</code> action, you can at any point fetch the <code>J2s</code> value from it by monad-binding that action (i.e. <em>executing</em> the subprogram) and just showing the <code>J2s</code> value. In your case:</p>\n\n<pre><code>tokensParserToByteString :: [Token] -&gt; IO B.ByteString\ntokensParserToByteString tokens = fmap (B8.pack . show) $ parseIO pJ2s tokens\n</code></pre>\n\n<p>I case you're confused about fmapping in the IO functor, this is equivalent to</p>\n\n<pre><code>tokensParserToByteString :: [Token] -&gt; IO B.ByteString\ntokensParserToByteString tokens = do\n     j2sValue &lt;- parseIO pJ2s tokens\n     return . B8.pack $ show j2sValue\n</code></pre>\n\n<p>Of course you then need to adapt <code>applyParser</code> because <code>tokensParserToByteString</code> is now an <code>IO</code> action. Easy enough with the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad.html#v:-61--60--60-\" rel=\"nofollow\"><code>=&lt;&lt;</code> operator</a>:</p>\n\n<pre><code>applyParser :: Proxy p =&gt; String -&gt; Consumer p B.ByteString IO ()\napplyParser path = runIdentityP loop\n  where\n    loop = do\n        bs &lt;- request ()\n        let sc = classify  (initPos path) (B8.unpack bs)\n        lift $ B8.putStrLn =&lt;&lt; tokensParserToByteString sc\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1569125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28513668964a740109e670194e728a2b?s=128&d=identicon&r=PG", "display_name": "andrea", "link": "https://stackoverflow.com/users/1569125/andrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 39112606, "answer_count": 1, "score": 1, "last_activity_date": 1471998448, "creation_date": 1471996319, "last_edit_date": 1471998448, "question_id": 39112380, "link": "https://stackoverflow.com/questions/39112380/no-instance-for-show-arising-from-a-use-in-main-level", "title": "No instance for Show arising from a use in &quot;main&quot; level", "body": "<p>I have a code that reads files and parses using UU.Parsing lib that  returns an abstract sintax tree and shows on the screen.</p>\n\n<p>I received the error message \"No instance for Show\" in my functions originated in <strong>tokensParserToByteString</strong> and <strong>applyParser</strong> using <strong>parseIO</strong> (of UU.Parsing lib) and inherited signatures until main. I fixed the signatures but my problem is in the <strong>main</strong> function. I added the instance Show in the signature but I have the next compilation error:</p>\n\n<pre><code>No instance for (Show (IO J2s)) arising from a use of \u2018main\u2019\nIn the expression: main\nWhen checking the type of the IO action \u2018main\u2019\n</code></pre>\n\n<p>The complete error message is:</p>\n\n<pre><code>$ cabal build\nBuilding java2scala-1.0...\nPreprocessing library java2scala-1.0...\nIn-place registering java2scala-1.0...\nPreprocessing executable 'java2scala' for java2scala-1.0...\nPreprocessing executable 'test' for java2scala-1.0...\n[5 of 5] Compiling Main             ( test/Main.hs, dist/build/test/test-tmp/Main.o )\n\ntest/Main.hs:27:1:\n    No instance for (Show (IO J2s)) arising from a use of \u2018main\u2019\n    In the expression: main\n    When checking the type of the IO action \u2018main\u2019\n</code></pre>\n\n<p>Some idea, about the problem?</p>\n\n<p>Main module</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nmodule Main where\n\nimport UU.Parsing\n...\nimport Content\n\nmain :: (Show (IO J2s)) =&gt; IO()\nmain = do f &lt;- getLine\n      let command = test f\n      command\n\ntest :: (Show (IO J2s)) =&gt; String -&gt; IO()\ntest \"testparser\" = testParser\n</code></pre>\n\n<p>Test module</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nmodule J2s.Parser.Test where\n\nimport Content\nimport J2s.Ast.Sintax\nimport J2s.Parser\nimport UU.Parsing\n...\n\ntestParser :: (Show (IO J2s)) =&gt; IO()\ntestParser  = (runSafeIO $ runProxy $ runEitherK $\n                contentsRecursive \"path/of/my/tests\" /&gt;/ handlerParser) :: (Show (IO J2s)) =&gt; IO()\n</code></pre>\n\n<p>Content module</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nmodule Content where\n\nimport Control.Monad(forM, liftM)\nimport System.Directory (doesDirectoryExist, getDirectoryContents)\nimport System.FilePath ((&lt;/&gt;), splitExtension, splitFileName)\nimport J2s.Parser\nimport J2s.Ast.Sintax\nimport UU.Parsing\n\nimport Control.Monad (when, unless)\nimport Control.Proxy\nimport Control.Proxy.Safe hiding (readFileS)\n\nimport J2s.Scanner.Token\nimport Text.Show\n\nimport UU.Parsing\n\n\ncontentsRecursive\n     :: (CheckP p)\n     =&gt; FilePath -&gt; () -&gt; Producer (ExceptionP p) FilePath SafeIO ()\ncontentsRecursive path () = loop path\n   where\n     loop path = do\n         contents path () //&gt; \\newPath -&gt; do\n             respond newPath\n             isDir &lt;- tryIO $ doesDirectoryExist newPath\n             let isChild = not $ takeFileName newPath `elem` [\".\", \"..\"]\n             when (isDir &amp;&amp; isChild) $ loop newPath\n\n\napplyParser :: (Proxy p, Show (IO J2s)) =&gt; String -&gt; Consumer p B.ByteString IO ()\napplyParser path = runIdentityP loop\n  where\n    loop = do\n        bs &lt;- request ()\n        let sc = classify  (initPos path) (B8.unpack bs)\n        lift $  B8.putStrLn (tokensParserToByteString sc)\n\ntokensParserToByteString :: (Show (IO J2s)) =&gt;  [Token] -&gt; B.ByteString\ntokensParserToByteString tokens = B8.pack(show (parseIO pJ2s tokens))\n\n\nhandlerParser :: (CheckP p, Show (IO J2s)) =&gt; FilePath -&gt; Session (ExceptionP p) SafeIO ()\nhandlerParser path = do\n    canRead &lt;- tryIO $ fmap readable $ getPermissions path\n    isDir   &lt;- tryIO $ doesDirectoryExist path\n    isValidExtension &lt;- tryIO $ evaluate ((snd (splitExtension path) == \".java\" || snd (splitExtension path) == \".mora\") &amp;&amp; (snd (splitFileName path) /= \"EncodeTest.java\") &amp;&amp; (snd (splitFileName path) /= \"T6302184.java\") &amp;&amp; (snd (splitFileName path) /= \"Unmappable.java\"))\n    when (not isDir &amp;&amp; canRead &amp;&amp; isValidExtension) $\n        (readFileSP 10240 path &gt;-&gt; try . applyParser) path\n\n\nreadFileSP\n:: (CheckP p)\n=&gt; Int -&gt; FilePath -&gt; () -&gt; Producer (ExceptionP p) B.ByteString SafeIO ()\nreadFileSP chunkSize path () =\n    bracket id (openFile path ReadMode) hClose $ \\handle -&gt; do\n        let loop = do\n                eof &lt;- tryIO $ hIsEOF handle\n                unless eof $ do\n                    bs &lt;- tryIO $ B.hGetSome handle chunkSize\n                    respond bs\n                    loop\n        loop\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 3902, "user_id": 391399, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61f56a38bf46f807b5ef431c46813c99?s=128&d=identicon&r=PG", "display_name": "mrsteve", "link": "https://stackoverflow.com/users/391399/mrsteve"}, "edited": false, "score": 0, "creation_date": 1471995009, "post_id": 39112219, "comment_id": 65571605, "body": "This question is for saving the 3 hours of work for searching for a solution (I wasted 3 hours...)"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 2, "creation_date": 1471995857, "post_id": 39112219, "comment_id": 65571818, "body": "Since you know a solution, could you post it as an answer for better visibility? Thanks! (Answering your own question is perfectly reasonable, although there might be a timeout stopping you in the first 15 minutes after you post a question.)"}, {"owner": {"reputation": 3902, "user_id": 391399, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61f56a38bf46f807b5ef431c46813c99?s=128&d=identicon&r=PG", "display_name": "mrsteve", "link": "https://stackoverflow.com/users/391399/mrsteve"}, "reply_to_user": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 1, "creation_date": 1471996487, "post_id": 39112219, "comment_id": 65571961, "body": "Did what you suggested, answered my own question."}], "answers": [{"tags": [], "owner": {"reputation": 3902, "user_id": 391399, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61f56a38bf46f807b5ef431c46813c99?s=128&d=identicon&r=PG", "display_name": "mrsteve", "link": "https://stackoverflow.com/users/391399/mrsteve"}, "is_accepted": true, "score": 3, "last_activity_date": 1471996461, "creation_date": 1471996461, "answer_id": 39112399, "question_id": 39112219, "link": "https://stackoverflow.com/questions/39112219/ghc-8-0-cabal-build-error-ld-r-and-pie-may-not-be-used-together-known/39112399#39112399", "title": "ghc 8.0 cabal build error &quot;ld: -r and -pie may not be used together&quot; known?", "body": "<p><strong>The solution is to use the linker flag \"-no-pie\":</strong></p>\n\n<pre><code>cabal -v --ghc-option=\"-optl-no-pie\" install cabal-install\n</code></pre>\n\n<p>Is suspect it is perhaps an implicit LD flag that is set on ubuntu that is conflicting somehow.</p>\n"}, {"tags": [], "owner": {"reputation": 1409, "user_id": 2195752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3hKXi.jpg?s=128&g=1", "display_name": "pbnelson", "link": "https://stackoverflow.com/users/2195752/pbnelson"}, "is_accepted": false, "score": 0, "last_activity_date": 1476245027, "creation_date": 1476245027, "answer_id": 39990323, "question_id": 39112219, "link": "https://stackoverflow.com/questions/39112219/ghc-8-0-cabal-build-error-ld-r-and-pie-may-not-be-used-together-known/39990323#39990323", "title": "ghc 8.0 cabal build error &quot;ld: -r and -pie may not be used together&quot; known?", "body": "<p>Okay, this is an incredibly! hacky solution, but it did get me past the immediate problem of not being able to build grub. It should work for any other app, but it's so! hacky, I wouldn't leave this in place for very long.</p>\n\n<p>I realize the poster's question is about cabal, not grub. But the problem affects multiple programs and the \"correct\" solution of using the -fno-pie compiler flag doesn't actually work. Apparently the latest version of gcc sets \"pie\" on by default, and this takes precedence over the -fno-pie flag. Or at least sometimes.</p>\n\n<p>Here is my working hack for gcc version 6.2.0-5ubuntu12, lubuntu 16.10 (yakkety), linux kernel 4.8.0-22... to build grub 2.02~beta3:</p>\n\n<pre><code># TO HACK\nsudo cp /usr/bin/gcc /usr/bin/gcc.orig\nsudo cp /usr/bin/gcc /usr/bin/gcc.patch\nsudo rm /usr/bin/gcc\nsudo ln -s /usr/bin/gcc.patch /usr/bin/gcc\nsudo bless /usr/bin/gcc.patch\n# search and replace \"-pie -z now\" with \"-v   -z now\" (see below)\n# save changes and exit 'bless'\n</code></pre>\n\n<p>That is, use the 'bless' hex editor to search for the text string <strong>-pie -z now</strong> and change that string to read <strong>-v   -z now</strong>   making sure to replace \"pie\" with \"v space space\" so it takes up the EXACT same number of characters. </p>\n\n<p>What this does is hack the compiler into sending -v to the linker instead of -pie. If you want to see for yourself what the compiler's doing, just include -Q -v in your compiler's CFLAGS list, and read closely. Even if you specify -fno-pie, the dang thing will still toss out a -pie option to the linker. Anyway, be sure to put everything back when you're done.</p>\n\n<pre><code># UNDO THE HACK\nsudo ln -f -s /usr/bin/gcc.orig /usr/bin/gcc\n</code></pre>\n\n<p>.</p>\n\n<pre><code># REDO THE HACK\nsudo ln -f -s /usr/bin/gcc.patch /usr/bin/gcc\n</code></pre>\n"}], "owner": {"reputation": 3902, "user_id": 391399, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61f56a38bf46f807b5ef431c46813c99?s=128&d=identicon&r=PG", "display_name": "mrsteve", "link": "https://stackoverflow.com/users/391399/mrsteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1052, "favorite_count": 0, "accepted_answer_id": 39112399, "answer_count": 2, "score": 4, "last_activity_date": 1476245027, "creation_date": 1471994955, "last_edit_date": 1471996408, "question_id": 39112219, "link": "https://stackoverflow.com/questions/39112219/ghc-8-0-cabal-build-error-ld-r-and-pie-may-not-be-used-together-known", "title": "ghc 8.0 cabal build error &quot;ld: -r and -pie may not be used together&quot; known?", "body": "<p>After upgrading to ghc 8.0 on a <em>RECENT</em> ubuntu machine, I got the following build error:</p>\n\n<blockquote>\n  <p>/usr/bin/ld: -r and -pie may not be used together</p>\n</blockquote>\n\n<p>A different error message for the same problem is:</p>\n\n<blockquote>\n  <p>relocation R_X86_64_32 against `.rodata' can not be used when making a > shared object; recompile with -fPIC</p>\n</blockquote>\n\n<p>Is this a known bug? Are there other solutions?</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 0, "creation_date": 1471990607, "post_id": 39110937, "comment_id": 65570407, "body": "Ah okay, I&#39;m not thrilled about making code changes to debug my code, but am thrilled to have a solution that works!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1471987558, "creation_date": 1471987558, "answer_id": 39110937, "question_id": 39109267, "link": "https://stackoverflow.com/questions/39109267/ghci-debugger-not-hitting-breakpoints-recursively-why-and-whats-the-solution/39110937#39110937", "title": "GHCi Debugger not hitting breakpoints recursively: Why, and what&#39;s the solution?", "body": "<p>I think it is working as expected, but you have to take into account lazy evaluation.</p>\n\n<p>If you break at the guard lines in <code>recurse</code> (lines 13 -- 15) and the call to recurse in progress (line 19) you'll see this pattern when the program is run with <code>:main 2</code>:</p>\n\n<pre><code>Stopped at prog0.hs:13:6-23   - recurse\nStopped at prog0.hs:14:6-15   - recurse\nStopped at prog0.hs:15:18-67  - recurse, call to foldr progress\nStopped at prog0.hs:19:3-74   - in progress, pos = (1,1)\nStopped at prog0.hs:19:3-74   - in progress, pos = (1,0)\nStopped at prog0.hs:19:3-74   - in progress, pos = (0,1)\nStopped at prog0.hs:19:3-74   - in progress, pos = (0,0)\nStopped at prog0.hs:13:6-23   - in recurse\nStopped at prog0.hs:14:6-15\nStopped at prog0.hs:13:6-23   - in recurse\nStopped at prog0.hs:14:6-15   \nStopped at prog0.hs:13:6-23   - in recurse\nStopped at prog0.hs:14:6-15  \nStopped at prog0.hs:13:6-23   - in recurse\nStopped at prog0.hs:14:6-15\n</code></pre>\n\n<p>However, if you change <code>progress</code> to force its result:</p>\n\n<pre><code>import Control.DeepSeq\n\nprogress n inProg pos (done, avail)  = let\n  result = (recurse n done (filter (not . shaded pos) remain) (pos:inProg), remain)\n  in deepseq result result\n  where remain = tail avail\n</code></pre>\n\n<p>then the break point pattern is:</p>\n\n<pre><code>Stopped at prog1.hs:14:6-23   - recurse\nStopped at prog1.hs:15:6-15   - recurse\nStopped at prog1.hs:16:18-67  - recurse, call to foldr progress\nStopped at prog1.hs:21:6-26   - progress, pos = (1,1)\nStopped at prog1.hs:14:6-23   - recurse\nStopped at prog1.hs:15:6-15\nStopped at prog1.hs:21:6-26   - progress, pos = (1,0)\nStopped at prog1.hs:14:6-23   - recurse\nStopped at prog1.hs:15:6-15\nStopped at prog1.hs:21:6-26   - progress, pos = (0,1)\nStopped at prog1.hs:14:6-23   - recurse\nStopped at prog1.hs:15:6-15\nStopped at prog1.hs:21:6-26   - progress, pos = (0,0)\nStopped at prog1.hs:14:6-23   - recurse\nStopped at prog1.hs:15:6-15\n</code></pre>\n\n<p>The recursive calls to <code>recurse</code> are now interleaved because we are forcing them right away.</p>\n"}, {"comments": [{"owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 0, "creation_date": 1471990246, "post_id": 39111098, "comment_id": 65570303, "body": "Thanks @ErikR, I remember reading about the trace function but never used it and forgot. I guess since you mention it, this is an approach preferred by many Haskellers over use of the GHCi Debugger? I tend to prefer testing my code in an unmangled form, but I am no stranger to throwing debug info to the log! Perhaps many find the user experience with GHCi Debugger a bit uneven? :)"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 0, "creation_date": 1472006424, "post_id": 39111098, "comment_id": 65574247, "body": "I can&#39;t speak for others, but With Haskell I&#39;ve actually never used the debugger - I&#39;ve either resort to printf/trace-debugging or writing test cases."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1471988358, "creation_date": 1471988358, "answer_id": 39111098, "question_id": 39109267, "link": "https://stackoverflow.com/questions/39109267/ghci-debugger-not-hitting-breakpoints-recursively-why-and-whats-the-solution/39111098#39111098", "title": "GHCi Debugger not hitting breakpoints recursively: Why, and what&#39;s the solution?", "body": "<p>I'm adding another answer to demonstrate how to use <code>Debug.Trace</code> to perform \"printf\" debugging with pure functions.</p>\n\n<p>Here is <code>recurse</code> and <code>progress</code> with trace statements added to print\ntheir call arguments. We can safely use <code>undefined</code> here because the\ntrace calls will always return False.</p>\n\n<pre><code>import System.Environment\nimport Debug.Trace\n\n...\n\nrecurse :: Int -&gt; [[Pos]] -&gt; [Pos] -&gt; [Pos] -&gt; [[Pos]]\nrecurse n done avail inProg\n   | trace msg False = undefined\n   | length inProg == n = inProg:done\n   | null avail = done\n   | otherwise = fst $ foldr (progress n inProg) (done,avail) avail\n   where msg = unwords [\"recurse:\", show n, show done, show avail, show inProg]\n\nprogress :: Int -&gt; [Pos] -&gt; Pos -&gt; Acc -&gt; Acc\nprogress n inProg pos (done, avail)\n  | trace msg False = undefined\n    where msg = unwords [\"progress:\", show n, show inProg, show pos, show (done, avail)]\nprogress n inProg pos (done, avail)  =\n  (recurse n done (filter (not . shaded pos) remain) (pos:inProg), remain)\n  where remain = tail avail\n\n...\n</code></pre>\n\n<p>And here is the output for <code>:main 2</code>:</p>\n\n<pre><code>recurse: 2 [] [(0,0),(0,1),(1,0),(1,1)] []\nprogress: 2 [] (1,1) ([],[(0,0),(0,1),(1,0),(1,1)])\nrecurse: 2 [] [] [(1,1)]\nprogress: 2 [] (1,0) ([],[(0,1),(1,0),(1,1)])\nrecurse: 2 [] [] [(1,0)]\nprogress: 2 [] (0,1) ([],[(1,0),(1,1)])\nrecurse: 2 [] [] [(0,1)]\nprogress: 2 [] (0,0) ([],[(1,1)])\nrecurse: 2 [] [] [(0,0)]\n</code></pre>\n\n<p>In general with trace statements added evaluation proceeds in a strict fashion as printing out the function arguments will force them.</p>\n"}], "owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 39110937, "answer_count": 2, "score": 1, "last_activity_date": 1471988358, "creation_date": 1471980544, "question_id": 39109267, "link": "https://stackoverflow.com/questions/39109267/ghci-debugger-not-hitting-breakpoints-recursively-why-and-whats-the-solution", "title": "GHCi Debugger not hitting breakpoints recursively: Why, and what&#39;s the solution?", "body": "<p>I have a simple recursive program that doesn't quite work. So I'm trying to use the ghci debugger to figure out what's going on. I set breakpoints on all lines of functions <code>recurse</code>, <code>progress</code> and <code>shaded</code>, and it catches the first few. But when I get to the second line of <code>progress</code>, every invocation of :continue drops me back on that same line of code, even though I'm calling <code>recurse</code> and <code>shaded</code> from there and expecting my breakpoints to work. Here's the code:</p>\n\n<pre><code>import System.Environment\n\ntype Pos = (Int,Int) \ntype Acc = ([[Pos]], [Pos])\n\nmain = do\n  getArgs &gt;&gt;= putStrLn . show . length . combos . read . head\n\ncombos n = recurse n [] (allPos n) []\n\nrecurse :: Int -&gt; [[Pos]] -&gt; [Pos] -&gt; [Pos] -&gt; [[Pos]]\nrecurse n done avail inProg\n   | length inProg == n = inProg:done\n   | null avail = done\n   | otherwise = fst $ foldr (progress n inProg) (done,avail) avail\n\nprogress :: Int -&gt; [Pos] -&gt; Pos -&gt; Acc -&gt; Acc\nprogress n inProg pos (done, avail)  =\n  (recurse n done (filter (not . shaded pos) remain) (pos:inProg), remain)\n  where remain = tail avail\n\nallPos n =  [ (i,j) | i &lt;- [0..n-1], j &lt;- [0..n-1] ]\n\nshaded :: Pos -&gt; Pos -&gt; Bool\nshaded (i,j) (k,l) =\n  k == i\n  || l == j\n  || k+l == i+j\n  || k-l == i-j\n  || abs (k-i) &lt; 3 &amp;&amp; abs (l-j) &lt; 3\n</code></pre>\n\n<p>Why will the ghci debugger not stop on breakpoints in functions called by <code>progress</code>? Is there something like \"non-reentrancy\" turning them off? How can I get the debugger to break on every recursive call to these functions?               </p>\n\n<p>GHCi version 7.8.4</p>\n\n<p><strong>Update:</strong> I suspect this may have something to do with cached results, but it's not obvious to me that these functions have been called with the same arguments twice. Could be a bug in my code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 8, "creation_date": 1471978001, "post_id": 39108492, "comment_id": 65564524, "body": "This is not a \u201cdo my homework for me\u201d site."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 1, "creation_date": 1471978723, "post_id": 39108492, "comment_id": 65564894, "body": "I&#39;m voting to close this question as off-topic because this is quite clearly a homework question."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1471986280, "post_id": 39108492, "comment_id": 65568708, "body": "I agree that this should be closed, but let us be clear here: it is not because this is a homework question, it is because the author clearly put no effort of their own into finding an answer. <a href=\"http://meta.stackexchange.com/questions/10811/how-do-i-ask-and-answer-homework-questions\">Well-researched homework questions where we have a chance of teaching something are great additions to the site.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471987036, "post_id": 39108870, "comment_id": 65569058, "body": "Gotta be the most useful, informative non-answer I&#39;ve seen. (That is meant positively.)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 6, "last_activity_date": 1471979054, "creation_date": 1471979054, "answer_id": 39108870, "question_id": 39108492, "link": "https://stackoverflow.com/questions/39108492/how-can-i-re-write-this-haskell-function-complexity/39108870#39108870", "title": "How can i re-write this haskell function complexity", "body": "<p>Use <a href=\"https://hackage.haskell.org/package/data-memocombinators-0.5.1/docs/Data-MemoCombinators.html\">Data.Memocombinators</a>:</p>\n\n<pre><code>import Data.MemoCombinators\n\nc:: Integer -&gt; Integer\nc n | n &lt; 3 = n + 100\n    | otherwise = c' (n-2) + c' (n-3) + c' (n-2)\n\nc' = integral c\n\nmain = print $ c' 1000\n</code></pre>\n\n<p>Note how <code>c</code> was re-written to call <code>c'</code> which is the memoized version of <code>c</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 6749312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a3afd18ac7a2917d0ca21cc99d8c7?s=128&d=identicon&r=PG&f=1", "display_name": "Andres S&#246;&#246;t", "link": "https://stackoverflow.com/users/6749312/andres-s%c3%b6%c3%b6t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1471982292, "answer_count": 1, "score": -9, "last_activity_date": 1471979054, "creation_date": 1471977572, "question_id": 39108492, "link": "https://stackoverflow.com/questions/39108492/how-can-i-re-write-this-haskell-function-complexity", "closed_reason": "Not suitable for this site", "title": "How can i re-write this haskell function complexity", "body": "<pre><code>c:: Integer -&gt; Integer\nc n | n &lt; 3 = n + 100\n    | otherwise = c (n-2) + c (n-3) + c (n-2)\n</code></pre>\n\n<p>Complexity of c in this form is exponential. Rewrite function c so that it's complexity is linear.\nc x should terminate if 1000 &lt; x 100000.</p>\n"}, {"tags": ["haskell", "recursion", "abstract-syntax-tree", "catamorphism", "recursion-schemes"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1471969734, "post_id": 39106158, "comment_id": 65559818, "body": "In the general case, you could take a precedence argument as in <code>showsPrec</code>. Para does not look too bad to me, though."}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471970650, "post_id": 39106158, "comment_id": 65560347, "body": "Could you elaborate? I don&#39;t see where I can put this argument. In this case yes <code>para</code> is ok, but when ast is much bigger it&#39;s just too much noise"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1471973721, "post_id": 39106158, "comment_id": 65562133, "body": "@ais I don&#39;t have time to write a full answer right now, but you can pass a <code>Bool</code> down to the recursive call by folding to a function <code>Bool -&gt; a</code>. <a href=\"http://okmij.org/ftp/tagless-final/course/lecture.pdf\" rel=\"nofollow noreferrer\">Kiselyov&#39;s tagless final notes</a> touch on it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1471973745, "post_id": 39106158, "comment_id": 65562146, "body": "You could build a function using cata: something like <code>cata $ \\case Var x -&gt; const x ; Apply x y -&gt; \\_ -&gt; unwords [x 5, y 5] ; Lambda x y -&gt; (\\p -&gt; if p==5 then addParen (x 0) (y 0) else noParen (x 0) (y 0) ; ...</code> Adjust precedence numbers as needed, and pass an initial 0 at the top level so that the result is a string."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1471975466, "post_id": 39106158, "comment_id": 65563100, "body": "@ais You may like the discussion in <a href=\"http://stackoverflow.com/q/20406722/791604\">this question on pretty-printing boolean formulae</a> for more on the <code>showsPrec</code> approach."}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471975677, "post_id": 39106158, "comment_id": 65563213, "body": "@chi interesting. But why <code>Int</code>, Shouldn&#39;t <code>Bool</code> be enough?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471979566, "post_id": 39106158, "comment_id": 65565321, "body": "One option is to wrap a newtype around <code>Fix ExprF</code>, then use pattern synonyms to construct/deconstruct it. The pattern synonyms will make it less awkward, and the newtype will make the types look less scary."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1471982962, "post_id": 39106158, "comment_id": 65567030, "body": "@ais Bool is fine if you only have two levels of precedence. In the general case, you need more. The link by Daniel Wagner above is such an example."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1471973847, "post_id": 39107448, "comment_id": 65562200, "body": "This will fail since cata does not recurse using the first case e.g. in <code>Apply (Apply (Lambda ..) ..) ..</code>"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471974351, "post_id": 39107448, "comment_id": 65562475, "body": "Then a recursion for each ExprF constructor. It&#39;s not much longer than para and it will probably be faster."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1471975216, "post_id": 39107448, "comment_id": 65562978, "body": "I think the whole point of the question is about avoiding writing explicit recursion."}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1471975984, "post_id": 39107448, "comment_id": 65563402, "body": "@DanielWagner not necessary. The main point is to find what could be a better solution for the problem."}], "tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": false, "score": 0, "last_activity_date": 1471973505, "creation_date": 1471973505, "answer_id": 39107448, "question_id": 39106158, "link": "https://stackoverflow.com/questions/39106158/is-there-something-like-cata-but-where-you-can-match-inner-structure/39107448#39107448", "title": "Is there something like cata but where you can match inner structure?", "body": "<p>How about straight recursion for the missing case :</p>\n\n<pre><code>toString :: Fix ExprF -&gt; String\ntoString (Fix (Apply (Fix (Lambda _ x)) y)) = \"(\" ++ toString x ++ \")(\" ++ toString y ++ \")\"\ntoString z = (cata $ \\case\n  Const x -&gt; show x\n  Var x -&gt; x\n  EList x -&gt; unwords x\n  Lambda x y -&gt; unwords [x, \"=&gt;\", y]\n  Apply x y -&gt; unwords [x, \"(\", y, \")\"]) z\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1471983267, "post_id": 39109649, "comment_id": 65567199, "body": "This makes the code shorter but it doesn&#39;t directly address the question. OP wants to use structural recursion to write the pretty-printer"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1471990998, "post_id": 39109649, "comment_id": 65570547, "body": "The exhaustivity checker is completely broken with regard to pattern synonyms (or at least non-trivial ones). No one has a fix yet."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1471982809, "last_edit_date": 1471982809, "creation_date": 1471982104, "answer_id": 39109649, "question_id": 39106158, "link": "https://stackoverflow.com/questions/39106158/is-there-something-like-cata-but-where-you-can-match-inner-structure/39109649#39109649", "title": "Is there something like cata but where you can match inner structure?", "body": "<p>One solution is to use the <code>{-# LANGUAGE PatternSynonyms #-}</code> extension and define unidirectional patterns like:</p>\n\n<pre><code>pattern Apply' r1 r2 &lt;- Apply (_,r1) (_,r2)\n</code></pre>\n\n<p>that you could then use in your definitions like this:</p>\n\n<pre><code>toString2 :: Fix ExprF -&gt; String\ntoString2 = para $ \\case\n  Const x -&gt; show x\n  Var x -&gt; x\n  Lambda x (_,y) -&gt; unwords [x, \"=&gt;\", y]\n  EList x -&gt; unwords (snd &lt;$&gt; x)\n  Apply ((Fix Lambda {}),x) (_,y) -&gt; unwords [\"(\", x, \")\", \"(\", y, \")\"]\n  Apply' x y -&gt; unwords [x, \"(\", y, \")\"]\n</code></pre>\n\n<p>Since <code>ExprF</code> is a Functor, another option would be simply to write:</p>\n\n<pre><code>toString2' :: Fix ExprF -&gt; String\ntoString2' = para $ \\case\n  Apply ((Fix Lambda {}),x) (_,y) -&gt; unwords [\"(\", x, \")\", \"(\", y, \")\"]\n  other -&gt; case fmap snd other of\n      Const x -&gt; show x\n      Var x -&gt; x\n      Lambda x y -&gt; unwords [x, \"=&gt;\", y]\n      Apply x y -&gt; unwords [x, \"(\", y, \")\"]\n</code></pre>\n\n<p>With the pattern synonym, and compiling with <code>-Wall</code>, I'm having trouble convincing the exhaustivity checker that the pattern matches are exhaustive.</p>\n"}, {"comments": [{"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 2, "creation_date": 1471986293, "post_id": 39110240, "comment_id": 65568715, "body": "A function <code>Bool -&gt; String</code> is just a pair <code>(String, String)</code>. So you fold it twice, with and without parentheses, then select which one you want during the recursion. That&#39;s brilliant, +1"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 2, "creation_date": 1471987077, "post_id": 39110240, "comment_id": 65569080, "body": "@V.Semeria Yep! That&#39;s exactly right. The <code>Bool -&gt; String</code> version is better though. You do less work (because you only <i>actually</i> fold it once). It also scales better to syntaxes with more than two precedences: if you have, say, 5 precedence levels in your language then working with <code>Int</code>s (or some type with five values, if you wanna be total) is much easier than working with tuples <code>(String, String, String, String, String)</code>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 8, "last_activity_date": 1471996906, "last_edit_date": 1495535649, "creation_date": 1471984632, "answer_id": 39110240, "question_id": 39106158, "link": "https://stackoverflow.com/questions/39106158/is-there-something-like-cata-but-where-you-can-match-inner-structure/39110240#39110240", "title": "Is there something like cata but where you can match inner structure?", "body": "<p>As @chi, @DanielWagner and I pointed out in the comments, the way to do this sort of pretty-printing-with-parenthesisation in a structurally recursive manner is \"the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:showsPrec\" rel=\"nofollow noreferrer\"><code>showsPrec</code></a> approach\".</p>\n\n<p>The big idea is not to fold up the syntax tree into a <code>String</code>, but into a <em>function</em> <code>Bool -&gt; String</code>. This gives us a degree of context-sensitivity in the fold: we'll use that extra <code>Bool</code> parameter to keep track of whether we're currently in the context of the left-hand side of an application.</p>\n\n<pre><code>parens x = \"(\" ++ x ++ \")\"\n\nppAlg :: ExprF (Bool -&gt; String) -&gt; (Bool -&gt; String)\nppAlg (Const x) isBeingApplied = show x\nppAlg (Var x) isBeingApplied = x\nppAlg (Lambda name body) isBeingApplied = p (\"\\\\\" ++ name ++ \" -&gt; \" ++ body False)\n    where p = if isBeingApplied then parens else id\nppAlg (EList es) isBeingApplied = unwords (sequenceA es False)\nppAlg (Apply fun arg) isBeingApplied = fun True ++ \" \" ++ arg False\n</code></pre>\n\n<p>We pass values of <code>isBeingApplied</code> down the recursive calls depending on where we are in the syntax tree right now. Note that the only place we're passing down <code>True</code> is as an argument to <code>fun</code> in the body of the <code>Apply</code> case. Then, in the <code>Lambda</code> case, we inspect that argument. If the current term is the left-hand part of an application we parenthesise the lambda; if not we don't.</p>\n\n<p>At the top level, having folded up the whole tree into a function <code>Bool -&gt; String</code>, we pass it an argument of <code>False</code> - we're not currently in the context of an application - to get a <code>String</code> out.</p>\n\n<pre><code>pp :: Expr -&gt; String\npp ex = cata ppAlg ex False\n\nghci&gt; pp $ app (lam \"x\" (var \"x\")) (cnst 2)\n\"(\\\\x -&gt; x) 2\"\n</code></pre>\n\n<p>By replacing the <code>Bool</code> with an <code>Int</code>, this approach can be generalised to parenthesising operators with arbitrary precedences, as covered in <a href=\"https://stackoverflow.com/questions/20406722/better-display-of-boolean-formulas\">@DanielWagner's linked answer</a>.</p>\n"}], "owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 39110240, "answer_count": 3, "score": 4, "last_activity_date": 1473953434, "creation_date": 1471968886, "last_edit_date": 1473953434, "question_id": 39106158, "link": "https://stackoverflow.com/questions/39106158/is-there-something-like-cata-but-where-you-can-match-inner-structure", "title": "Is there something like cata but where you can match inner structure?", "body": "<p>I have this language AST</p>\n\n<pre><code>data ExprF r = Const Int\n              | Var   String\n              | Lambda String r\n              | EList [r]\n              | Apply r r\n deriving ( Show, Eq, Ord, Functor, Foldable )\n</code></pre>\n\n<p>And I want to convert it to string</p>\n\n<pre><code>toString = cata $ \\case\n  Const x -&gt; show x\n  Var x -&gt; x\n  EList x -&gt; unwords x\n  Lambda x y -&gt; unwords [x, \"=&gt;\", y]\n  Apply x y -&gt; unwords [x, \"(\", y, \")\"]\n</code></pre>\n\n<p>But when lambda is used in <code>Apply</code> I need the parentheses</p>\n\n<pre><code>(x =&gt; x)(1)\n</code></pre>\n\n<p>but I cannot match inner structure with cata</p>\n\n<pre><code>toString :: Fix ExprF -&gt; String\ntoString = cata $ \\case\n  Const x -&gt; show x\n  Var x -&gt; x\n  Lambda x y -&gt; unwords [x, \"=&gt;\", y]\n  Apply (Lambda{}) y -&gt; unwords [\"(\", x, \")\", \"(\", y, \")\"]\n  Apply x y -&gt; unwords [x, \"(\", y, \")\"]\n</code></pre>\n\n<p>Is there any better solution than <code>para</code>?</p>\n\n<pre><code>toString2 :: Fix ExprF -&gt; String\ntoString2 = para $ \\case\n  Const x -&gt; show x\n  Var x -&gt; x\n  Lambda x (_,y) -&gt; unwords [x, \"=&gt;\", y]\n  EList x -&gt; unwords (snd &lt;$&gt; x)\n  Apply ((Fix Lambda {}),x) (_,y) -&gt; unwords [\"(\", x, \")\", \"(\", y, \")\"]\n  Apply (_,x) (_,y) -&gt; unwords [x, \"(\", y, \")\"]\n</code></pre>\n\n<p>It looks uglier. Even it is needed only in one place I need to remove fst tuple parameters everywhere and I guess it will be slower.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "edited": false, "score": 0, "creation_date": 1471967204, "post_id": 39105538, "comment_id": 65558128, "body": "Here are some advice: <a href=\"http://dev.stephendiehl.com/hask/#error-handling\" rel=\"nofollow noreferrer\">dev.stephendiehl.com/hask/#error-handling</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471967246, "post_id": 39105538, "comment_id": 65558153, "body": "I believe <code>System.IO.Error</code> is actually making use of <code>catch</code> from <code>Control.Exception</code> <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/System.IO.Error.html#catchIOError\" rel=\"nofollow noreferrer\">under the hood</a>"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471968561, "post_id": 39105538, "comment_id": 65559083, "body": "@Alec. Yes, <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/System.IO.Error.html#catchIOError\" rel=\"nofollow noreferrer\"><code>catchIOError = catch</code></a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1471970310, "post_id": 39105538, "comment_id": 65560150, "body": "@Cirdec I realize. Check the link in my comment, it is the same as yours. :)"}], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": true, "score": 1, "last_activity_date": 1471968544, "creation_date": 1471968544, "answer_id": 39106060, "question_id": 39105538, "link": "https://stackoverflow.com/questions/39105538/to-handle-ioerror-which-method-should-i-use/39106060#39106060", "title": "To handle IOError, which method should I use?", "body": "<pre><code>type IOError = IOException\n</code></pre>\n\n<p>so both finish in Control.Exception.Base, ie <code>catch</code>. System.IO.Error is just a specialization package, to help you deal with those exceptions that are IO.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 39106060, "answer_count": 1, "score": 0, "last_activity_date": 1471968544, "creation_date": 1471967012, "question_id": 39105538, "link": "https://stackoverflow.com/questions/39105538/to-handle-ioerror-which-method-should-i-use", "title": "To handle IOError, which method should I use?", "body": "<p>I came across a function that, according to its documentation, can throw <code>IOError</code>. I want to handle this.</p>\n\n<p>It looks like there are multiple ways of doing it. <code>Control.Exception</code> is one. <code>System.IO.Error</code> is another.</p>\n\n<ul>\n<li>Are there other ways?</li>\n<li>Which way do you recommend I use and why? Or what are the pros and cons of each?</li>\n</ul>\n"}, {"tags": ["list", "haskell", "frequency", "huffman-code"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1471965456, "post_id": 39104825, "comment_id": 65556892, "body": "<code>c</code> is a function of type <code>String -&gt; Int</code>, yet you use in in a context which requires it to be of type <code>Int</code> (<code>c&gt;0</code>). It seems like you&#39;ve forgetten to bind a variable: <code>\\list -&gt; [ (x,c) | ... c = length (filter (==x) list) ... ]</code>"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 1, "creation_date": 1471965837, "post_id": 39104825, "comment_id": 65557143, "body": "What does &quot;without importing anything&quot; mean ? List comprehensions use the list monad, ie functions map, concat and guard (hidden by syntactic sugar). Isn&#39;t this importing already ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471965871, "post_id": 39104825, "comment_id": 65557156, "body": "Can you please clean up this question? We don&#39;t need your life story or what questions you plan to ask later."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471966021, "post_id": 39104825, "comment_id": 65557255, "body": "@V.Semeria, that&#39;s not actually how they&#39;re implemented, although they could be. I think the OP means Prelude-only."}, {"owner": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "edited": false, "score": 0, "creation_date": 1471966808, "post_id": 39104825, "comment_id": 65557816, "body": "I meant without Data.List or Map . Even if they&#39;re working in the background for the sort and group you have to do the import"}, {"owner": {"reputation": 69864, "user_id": 444991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c57f597182ae324d8eb33b935f7d38af?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/444991/matt"}, "edited": false, "score": 0, "creation_date": 1473704980, "post_id": 39104825, "comment_id": 66234183, "body": "Please do not edit your question such that it invalidates existing answers. Instead, create a new question."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "edited": false, "score": 1, "creation_date": 1471967015, "post_id": 39105132, "comment_id": 65557971, "body": "Instead of having text as a parameter can I write = \\ text -&gt;   ....... ??"}, {"owner": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "reply_to_user": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "edited": false, "score": 1, "creation_date": 1471967119, "post_id": 39105132, "comment_id": 65558061, "body": "@PeterPan Why not give it a try?"}, {"owner": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "edited": false, "score": 0, "creation_date": 1471967269, "post_id": 39105132, "comment_id": 65558181, "body": "On the bus on the way from work :) typing on the phone but will try it straight as I walk home :)"}, {"owner": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "edited": false, "score": 0, "creation_date": 1471983386, "post_id": 39105132, "comment_id": 65567259, "body": "@Cidec Do you have any suggestions why I am still getting an errore message such as the one below?"}, {"owner": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "edited": false, "score": 0, "creation_date": 1471986446, "post_id": 39105132, "comment_id": 65568792, "body": "OK I know now is all because of differencw in letters sizes. Can somebody help me how I can change size of letters in my string before I check the frequency? How I can modify this: \\text -&gt; [ (x,c) | x &lt;- [&#39;A&#39;..&#39;z&#39;], let c = (length . filter (==x)) text, c&gt;0 ] ?"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 4, "last_activity_date": 1471965870, "creation_date": 1471965870, "answer_id": 39105132, "question_id": 39104825, "link": "https://stackoverflow.com/questions/39104825/frequency-table-in-haskell-with-list-comprehension-only-find-frequency-of-chara/39105132#39105132", "title": "Frequency table in Haskell with list comprehension only, find frequency of characters in a String", "body": "<p>You haven't included what you should be filtering and taking the length of</p>\n\n<pre><code>[ (x,c) | x &lt;- ['A'..'z'], let c = (length . filter (==x)), c&gt;0 ]\n--                                 ^_____________________^ \n-- this is a function from a String -&gt; Int\n-- you want the count, an Int\n-- The function needs to be applied to a String\n</code></pre>\n\n<p>The string to apply it to is the argument to <code>fTable</code></p>\n\n<pre><code>fTable :: String -&gt; FreqTable\nfTable    text   =  [ (x,c) | x &lt;- ['A'..'z'], let c = (length . filter (==x)) text, c&gt;0 ]\n--        ^--------------------------------------------------------------------^\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1471992872, "creation_date": 1471992872, "answer_id": 39111932, "question_id": 39104825, "link": "https://stackoverflow.com/questions/39104825/frequency-table-in-haskell-with-list-comprehension-only-find-frequency-of-chara/39111932#39111932", "title": "Frequency table in Haskell with list comprehension only, find frequency of characters in a String", "body": "<p>The list: <code>['A'..'z']</code> is this string:</p>\n\n<pre><code>\"ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz\"\n</code></pre>\n\n<p>so you are iterating over both upper and lower case letters (and some symbols.) That's why you have a tuple, e.g., for both 'A' and 'a'.</p>\n\n<p>If you want to perform a case-insensitive count, you have to perform a case-insensitive comparison instead of straight equality.</p>\n\n<pre><code>import Data.Char\n\nciEquals :: Char -&gt; Char -&gt; Bool\nciEquals a b = toLower a == toLower b\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>ftable text = [ (x,c) | x &lt;- ['A'..'Z'], \n                      , let c = (length . filter (ciEquals x)) text,\n                      , c &gt; 0 ]\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6694648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9rLr.jpg?s=128&g=1", "display_name": "PeterPan", "link": "https://stackoverflow.com/users/6694648/peterpan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1024, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473704972, "creation_date": 1471964956, "last_edit_date": 1473704972, "question_id": 39104825, "link": "https://stackoverflow.com/questions/39104825/frequency-table-in-haskell-with-list-comprehension-only-find-frequency-of-chara", "title": "Frequency table in Haskell with list comprehension only, find frequency of characters in a String", "body": "<p>I am new to Haskell, trying to learn some stuff and pass the task that I was given. I would like to find the number of characters in a String but without importing Haskell modules.</p>\n\n<p>I need to implement a frequency table and I would like to understand more about programming in Haskell and how I can do it.\nI have my FreqTable as a tuple with the character and the number of occurrences of the 'char' in a String.</p>\n\n<pre><code>type FreqTable = [(Char, Int)]\n</code></pre>\n\n<p>I have been searching for for a solution for couple of days and long hours to find some working examples.</p>\n\n<p>My function or the function in the task id declares as follows:</p>\n\n<pre><code>fTable :: String -&gt; FreqTable\n</code></pre>\n\n<p>I know that the correct answer can be:</p>\n\n<pre><code>map (\\x -&gt; (head x, length x)) $ group $ sort\n</code></pre>\n\n<p>or</p>\n\n<pre><code>map (head &amp;&amp;&amp; length) . group . sort\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[ (x,c) | x &lt;- ['A'..'z'], let c = (length . filter (==x)), c&gt;0 ]\n</code></pre>\n\n<p>I can get this to work exactly with my list but I found this as an optional solution. I am getting an error which I can solve at the moment with the above list comprehension. </p>\n\n<pre><code> Couldn't match expected type \u2018String -&gt; FreqTable\u2019\n            with actual type \u2018[(Char, [Char] -&gt; Int)]\u2019\nIn the expression:\n  [(x, c) |\n     x &lt;- ['A' .. 'z'], let c = (length . filter (== x)), c &gt; 0]\nIn an equation for \u2018fTable\u2019:\n    fTable\n      = [(x, c) |\n           x &lt;- ['A' .. 'z'], let c = (length . filter (== x)), c &gt; 0]\n</code></pre>\n\n<p>Can please someone share with me and explain me a nice and simple way of checking the frequency of characters without importing Data.List or Map</p>\n"}, {"tags": ["haskell", "random"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1472014045, "post_id": 39102852, "comment_id": 65575932, "body": "It is not possible to do it with the type <code>Int-&gt;Bool</code>, because the result of a function only depends on its inputs, and here the only input is the number. If you also pass in the random number then you have <code>randomCompare x r = x &lt; r</code>."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 1492928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d299f945d0adc10fc2f0576a140e3f7?s=128&d=identicon&r=PG", "display_name": "Noob Saibot", "link": "https://stackoverflow.com/users/1492928/noob-saibot"}, "edited": false, "score": 0, "creation_date": 1471960424, "post_id": 39102954, "comment_id": 65552938, "body": "Thanks for the answer. So i understand that there is no elegant way out of this without IO. nevertheless, the function that is calling &quot;randomCompare&quot; wants just the Bool value, so hot should the calling function handle IO Bool instead of Bool? Thanks."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 2, "creation_date": 1471961225, "post_id": 39102954, "comment_id": 65553635, "body": "If you import Control.Monad.Random and are using the MonadRandom package, you can replace <code>Int -&gt; IO Bool</code> by <code>MonadRandom m =&gt; Int -&gt; m Bool</code>. You can then still use that as if it was <code>Int -&gt; IO Bool</code>, but you have the type-level gurantee that the function doesn&#39;t have any other side effect than generating random numbers."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1471974625, "post_id": 39102954, "comment_id": 65562636, "body": "Infinite lists of randoms are also common.  <code>randomCompare :: RandList -&gt; Int -&gt; (Bool,RandList)</code> where <code>type RandList = [Int]</code> and <code>randomCompare (x:xs) i = (i &lt; x, xs)</code>.  This alternative is just leaning on lazyness instead of manually stepping some RNG and manually plumbing the data instead of hiding behind a monad (IO or MonadRandom m)."}, {"owner": {"reputation": 47, "user_id": 1492928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d299f945d0adc10fc2f0576a140e3f7?s=128&d=identicon&r=PG", "display_name": "Noob Saibot", "link": "https://stackoverflow.com/users/1492928/noob-saibot"}, "edited": false, "score": 0, "creation_date": 1471976973, "post_id": 39102954, "comment_id": 65563979, "body": "I would do the infinite list solution if my ranges weren&#39;t variable and i don&#39;t think making a list every time is the best way, so i guess i&#39;ll try to  work with the IO monad and see how it goes.  thanks guys!"}], "tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": true, "score": 7, "last_activity_date": 1471984941, "last_edit_date": 1471984941, "creation_date": 1471959871, "answer_id": 39102954, "question_id": 39102852, "link": "https://stackoverflow.com/questions/39102852/haskell-how-to-use-random-integer-from-randomrio-in-a-function-that-returns-a-b/39102954#39102954", "title": "Haskell: How to use random integer from randomRIO in a function that returns a boolean", "body": "<pre><code>import System.Random(randomIO)\n\nrandomCompare :: Int -&gt; IO Bool\nrandomCompare x = do\n  r &lt;- randomIO\n  return $ x &lt; r\n</code></pre>\n\n<p>IO is neither good nor bad, it just declares that your function has side effects. Here the side effect is modifying the state of the global random number generator, so that a subsequent call to randomIO will give another number (it wouldn't be random if it was constant !).</p>\n\n<p>IO does force all calling functions to be IO too (the ones that want to use the IO Bool). However, if a calling function is IO only by consuming this IO Bool, if it has no other side effects, then you can separate it as a pure function <code>f :: Bool -&gt; SomeType</code> and functorially apply it on the IO, ie  </p>\n\n<pre><code>f &lt;$&gt; randomCompare i\n</code></pre>\n\n<p>So the IO monad only costs you to replace the ordinary function call <code>$</code> by the functorial <code>fmap</code>, also noted <code>&lt;$&gt;</code>. Is it so much longer to type ?</p>\n\n<p>If you absolutely want to leave the IO monad (why ?), you can also draw all the random values you need first, store them in a list, then apply pure functions on that list.</p>\n"}], "owner": {"reputation": 47, "user_id": 1492928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d299f945d0adc10fc2f0576a140e3f7?s=128&d=identicon&r=PG", "display_name": "Noob Saibot", "link": "https://stackoverflow.com/users/1492928/noob-saibot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1831, "favorite_count": 0, "accepted_answer_id": 39102954, "answer_count": 1, "score": 3, "last_activity_date": 1471984941, "creation_date": 1471959565, "last_edit_date": 1471959854, "question_id": 39102852, "link": "https://stackoverflow.com/questions/39102852/haskell-how-to-use-random-integer-from-randomrio-in-a-function-that-returns-a-b", "title": "Haskell: How to use random integer from randomRIO in a function that returns a boolean", "body": "<p>I am new to Haskell and i'm having a problem with using the IO Int from randomRIO function. My goal is to get a random Int value, say r, and to return True if r &lt; x or false otherwise, but i don't know how to do it.</p>\n\n<p>my function should look like:</p>\n\n<pre><code>randomCompare :: Int-&gt;Bool\n\nrandomCompare x\n\n  | x &lt; r = True -- somehow i want to r &lt;- randomRIO(start,end) \n\n  | otherwise = False                \n</code></pre>\n\n<p>I know there is a designed intention with keeping IO vals in context for purity etc.. but i don't see why using a random number for a Boolean function should be \"bad\".</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471967535, "post_id": 39101371, "comment_id": 65558358, "body": "Enable warnings with the <code>-Wall</code> flag: it will help you notice many common mistakes, including not considering all possible cases as in the snippet above."}], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": true, "score": 7, "last_activity_date": 1471955920, "creation_date": 1471955920, "answer_id": 39101460, "question_id": 39101371, "link": "https://stackoverflow.com/questions/39101371/how-to-make-a-list-consisted-by-other-lists/39101460#39101460", "title": "How to make a list consisted by other lists?", "body": "<p>First write a function that does what you want to each element of the list. In your case, each element is itself a list.</p>\n\n<pre><code>doubleFirst :: Num a =&gt; [a] -&gt; [a]\ndoubleFirst [] = []\ndoubleFirst (x:xs) = (2*x:xs)\n</code></pre>\n\n<p>Then use <code>map</code> to apply that function to the list of elements:</p>\n\n<pre><code>map doubleFirst [[2,3],[2,4],[4,3]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "edited": false, "score": 0, "creation_date": 1471963778, "post_id": 39102222, "comment_id": 65555684, "body": "Thanks, and my function is work now. However can you explain about your second case? I tried to delete it and the code still work properly."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "edited": false, "score": 0, "creation_date": 1471968566, "post_id": 39102222, "comment_id": 65559088, "body": "@Jerry Try <code>double_the_first [[],[1,2,3],[4,5,6]]</code>"}], "tags": [], "owner": {"reputation": 53, "user_id": 5842668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5db6882df9052aa19ef82c0de4528bc5?s=128&d=identicon&r=PG&f=1", "display_name": "Baltazar", "link": "https://stackoverflow.com/users/5842668/baltazar"}, "is_accepted": false, "score": 1, "last_activity_date": 1471957909, "creation_date": 1471957909, "answer_id": 39102222, "question_id": 39101371, "link": "https://stackoverflow.com/questions/39101371/how-to-make-a-list-consisted-by-other-lists/39102222#39102222", "title": "How to make a list consisted by other lists?", "body": "<p>You are missing some cases when the list is empty. You can change your code following way. I have added possibility that list is empty. I think you wanted to use different type of result.</p>\n\n<pre><code>double_the_first::(Num a)=&gt;[[a]]-&gt;[[a]]\ndouble_the_first list = case list of \n    []                   -&gt; []\n    (([]):xs)            -&gt; [[]] ++ double_the_first xs\n    ((y:ys):xs)          -&gt; [(2*y:ys)] ++ double_the_first xs\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 39101460, "answer_count": 2, "score": 1, "last_activity_date": 1471957909, "creation_date": 1471955701, "question_id": 39101371, "link": "https://stackoverflow.com/questions/39101371/how-to-make-a-list-consisted-by-other-lists", "title": "How to make a list consisted by other lists?", "body": "<p>I'm trying to make a list contains several smaller lists, and double the first element of each sub-lists.Here is my code:</p>\n\n<pre><code> double_the_first::(Num a)=&gt;[[a]]-&gt;[a]\n double_the_first list = case list of \n []                   -&gt;[]\n [[x]]                -&gt;[x*2]\n [x:xs]               -&gt;map(*2)(map(head)[x:xs])\n</code></pre>\n\n<p>How can I represent a list like [[2,3],[4,5]]? I know my code is wrong, but haskell does not show any error, how? It will not work when I input a list like this:</p>\n\n<pre><code> double_the_first [[2,3],[2,4],[4,3]]\n*** Exception: test.hs:(3,25)-(6,51): Non-exhaustive patterns in case\n</code></pre>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1471953786, "post_id": 39100320, "comment_id": 65547784, "body": "Not a duplicate, but I feel I feel <a href=\"http://stackoverflow.com/questions/16726659/should-do-notation-be-avoided-in-haskell/16733658#16733658\">my answer here</a> adresses this quite well. I&#39;d say <i>it&#39;s perfectly fine to use <code>forM_</code> like that</i>. (Except as phadej says, <code>for_</code> is the more modern alternative, but in practice there&#39;s usually no difference between these.)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471965650, "post_id": 39100622, "comment_id": 65557010, "body": "These operations are inherently <code>Applicative</code>. There are versions more naturally monadic. <code>traverseM :: (Monad m, TraversableM t) =&gt; (s -&gt; a -&gt; m (s, b)) -&gt; t a -&gt; m (t b)</code>.  The latter can be forced into <code>Traversable</code> using <code>StateT</code>, but I&#39;m pretty sure that stops working when you want a McBride-style indexed monad."}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1472194326, "post_id": 39100622, "comment_id": 65663433, "body": "Nice answer! Exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 11, "last_activity_date": 1471954490, "last_edit_date": 1471954490, "creation_date": 1471953716, "answer_id": 39100622, "question_id": 39100320, "link": "https://stackoverflow.com/questions/39100320/is-form-idiomatic-haskell/39100622#39100622", "title": "Is `forM_` idiomatic Haskell?", "body": "<p>It is, though you'd probably better using just <code>for_ :: (Foldable t, Applicative f) =&gt; t a -&gt; (a -&gt; f b) -&gt; f ()</code> from <code>Data.Foldable</code>.</p>\n\n<p>Also by using it as prefix (i.e. normal function), the code looks like an \"ordinary\" imperative code:</p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    for_ args $ \\address -&gt; do\n        ips &lt;- resolve address\n        for_ ips $ \\ip -&gt; putStrLn $ address ++ \"\\t\" ++ ip\n</code></pre>\n\n<p>P.S. <code>Applicative</code> versions of <code>Monad</code>ic \"traversals\":</p>\n\n<ul>\n<li><code>mapM</code> ~ <code>traverse</code></li>\n<li><code>mapM_</code> ~ <code>traverse_</code></li>\n<li><code>forM</code> ~ <code>for</code></li>\n<li><code>forM_</code> ~ <code>for_</code></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1471954583, "post_id": 39100800, "comment_id": 65548360, "body": "<code>mapM_</code> probably. I&#39;m not sure code-golfing is really helpful here though."}, {"owner": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "edited": false, "score": 0, "creation_date": 1471964670, "post_id": 39100800, "comment_id": 65556321, "body": "Where does the <code>address</code> come from?"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471972668, "post_id": 39100800, "comment_id": 65561576, "body": "Whoops, didn&#39;t notice that. Btw the golfing just emerged from the process of removing the fors. Editing."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471983216, "post_id": 39100800, "comment_id": 65567174, "body": "This use of <code>transformers</code> <code>ListT</code> is probably tolerable in Stephen Shaws case but it courts disaster. It&#39;s a standard description of a space leak waiting to happen."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471983356, "post_id": 39100800, "comment_id": 65567244, "body": "See <a href=\"http://lpaste.net/179912\" rel=\"nofollow noreferrer\">lpaste.net/179912</a>  which is slower at these numbers, on my computer, when it uses a &#39;ListT done right&#39; -- because it is translating through list operations. But the transformers version nearly exhausts memory and will exhaust memory if either number is bumped up. The streaming ListT uses constant memory, though it has to construct lists all the time."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 1, "last_activity_date": 1471972704, "last_edit_date": 1471972704, "creation_date": 1471954225, "answer_id": 39100800, "question_id": 39100320, "link": "https://stackoverflow.com/questions/39100320/is-form-idiomatic-haskell/39100800#39100800", "title": "Is `forM_` idiomatic Haskell?", "body": "<pre><code>main = getArgs &gt;&gt;= mapM_ (\\address -&gt;\n  resolve address &gt;&gt;= mapM_ (\\ip -&gt;\n    putStrLn $ address ++ \"\\t\" ++ ip))\n</code></pre>\n\n<p>And once we have <code>ArgumentDo</code> we won't have to bracket that lambda expression.</p>\n\n<p>ListT also happens to be applicable:</p>\n\n<pre><code>main = void $ runListT $ do\n  address &lt;- ListT getArgs\n  ip &lt;- ListT $ resolve address\n  liftIO $ putStrLn $ address ++ \"\\t\" ++ ip\n</code></pre>\n"}], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 2, "accepted_answer_id": 39100622, "answer_count": 2, "score": 6, "last_activity_date": 1471972704, "creation_date": 1471952829, "question_id": 39100320, "link": "https://stackoverflow.com/questions/39100320/is-form-idiomatic-haskell", "title": "Is `forM_` idiomatic Haskell?", "body": "<p>I tend to fall into the use of <code>forM_</code> in Haskell which is quite like <code>.each</code> in Ruby or <code>foreach</code> in Scala.</p>\n\n<pre><code>import Control.Monad (forM_)\nimport Network.BSD (getHostByName, hostAddresses)\nimport Network.Socket (inet_ntoa)\nimport System.Environment (getArgs)\n\nresolve address = do\n  ent &lt;- getHostByName address\n  mapM inet_ntoa (hostAddresses ent)\n\nmain = do\n  args &lt;- getArgs\n  args `forM_` (\\address -&gt; do\n    ips &lt;- resolve address\n    ips `forM_` (\\ip -&gt; putStrLn $ address ++ \"\\t\" ++ ip))\n</code></pre>\n\n<p>It doesn't seem to be idiomatic to me but using <code>mapM_</code> seems clumsy. Is there an idiomatic way of rewriting this code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1471949090, "post_id": 39098222, "comment_id": 65544549, "body": "The problem with your definition is that <code>accept</code> can get <i>any</i> type of class NetworkConn and return <i>any other</i> type of class NetworkConn. You either want it to (1) always return the same constant type, or (2) always return the input type or (3) return a type that <i>depends on</i> input type. For 3, have a multipatameter type class <code>NetworkConn a b where accept :: a-&gt;b</code> and constrain it with fundep, or use a type family."}], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1471948133, "post_id": 39098430, "comment_id": 65543935, "body": "<code>acceptReuqest PendingConnection</code> returns <code>Connection</code> so i had to keep the return type different.. i have edited the question.. apologies for that being not visible before."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1471949487, "post_id": 39098430, "comment_id": 65544833, "body": "Is it possible to restrict the return type to be <code>NetworkConn</code> because i only want to call few methods defined only in <code>NetworkConn</code>.. ?"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1471949648, "post_id": 39098430, "comment_id": 65544936, "body": "The return is restricted to NetworkConn in the 2-class solution above"}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1471952699, "post_id": 39098430, "comment_id": 65547039, "body": "i have updated the question with  your approach.. since c is of type <code>CandidateConn</code> i can only call functions defined in that <code>CandidateConn</code>.. Now the errors have moved to CandidateConn.. did i fail to understand your approach ?"}], "tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": false, "score": 1, "last_activity_date": 1471948569, "last_edit_date": 1471948569, "creation_date": 1471947506, "answer_id": 39098430, "question_id": 39098222, "link": "https://stackoverflow.com/questions/39098222/writing-a-class-with-method-returning-same-class-object/39098430#39098430", "title": "writing a Class with method returning same Class object", "body": "<p>How about</p>\n\n<pre><code>class NetworkConn sock where\n  accept :: sock -&gt; IO sock\n</code></pre>\n\n<p>What you wrote was a universal return type, whereas I reckon your <code>accept</code> methods only return specific connection types.</p>\n\n<p>If you do want a dynamic return, you might need 2 type classes like</p>\n\n<pre><code>class CandidateConn sock where\n  -- some methods\nclass NetworkConn sock where\n  accept :: CandidateConn c =&gt; c -&gt; IO sock\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1471973160, "post_id": 39098967, "comment_id": 65561846, "body": "this answer is right for what i asked.. but i have <code>send</code> and <code>recv</code> method that needs <code>Connection</code> at which case, this fails."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 3, "last_activity_date": 1471948967, "creation_date": 1471948967, "answer_id": 39098967, "question_id": 39098222, "link": "https://stackoverflow.com/questions/39098222/writing-a-class-with-method-returning-same-class-object/39098967#39098967", "title": "writing a Class with method returning same Class object", "body": "<p>This type signature:</p>\n\n<pre><code>class NetworkConn sock where\n  accept :: (NetworkConn myconn) =&gt; sock -&gt; IO myconn\n</code></pre>\n\n<p>says, \"a type <code>sock</code> that is a <code>NetworkConn</code> provides a function <code>accept</code> that takes a <code>sock</code> and returns an action resulting in whatever type the caller requires, as long as that type in turn is a <code>NetworkConn</code>.\"</p>\n\n<p>This is a promise you cannot uphold. You probably wanted to write that it returns \"some type specific to <code>sock</code> that also implements <code>NetworkConn</code>\". That's what associated types are for.</p>\n\n<p>Roughly speaking, you enable the TypeFamilies extension and then write</p>\n\n<pre><code>class NetworkConn sock where\n  type AcceptedConn sock :: *\n  accept :: sock -&gt; IO (AcceptedConn sock)\n</code></pre>\n\n<p>except this lacks the <code>NetworkConn</code> constraint for <code>AcceptedConn</code>. I have trouble finding the right syntax to express this and can't syntax-check at the moment, but you can try this:</p>\n\n<pre><code>class NetworkConn (AcceptedConn sock) =&gt; NetworkConn sock where\n  type AcceptedConn sock :: *\n  accept :: sock -&gt; IO (AcceptedConn sock)\n</code></pre>\n\n<p>I think this requires FlexibleInstances to be enabled.</p>\n\n<p>The instance declaration then becomes:</p>\n\n<pre><code>instance NetworkConn WS.PendingConnection where\n  type AcceptedConn WS.PendingConnection = Connection\n  accept sock = WS.acceptRequest sock\n</code></pre>\n\n<p>As I said, I have not done syntax checking on this at all.</p>\n"}, {"tags": [], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "is_accepted": false, "score": 1, "last_activity_date": 1471952938, "creation_date": 1471952938, "answer_id": 39100361, "question_id": 39098222, "link": "https://stackoverflow.com/questions/39098222/writing-a-class-with-method-returning-same-class-object/39100361#39100361", "title": "writing a Class with method returning same Class object", "body": "<p>A noble soul <code>{As}</code> on #haskell irc channel suggested to use <a href=\"https://wiki.haskell.org/Multi-parameter_type_class\" rel=\"nofollow\">https://wiki.haskell.org/Multi-parameter_type_class</a></p>\n\n<p>and it worked.. thanks <code>{As}</code></p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nmodule HChat.Network where\n\n-- For Network.Socket library\nimport qualified Network.Socket as NS (Socket, accept)\nimport qualified Network.Socket.ByteString as NSB (send, recv)\nimport qualified Data.ByteString.Char8 as C\n\n-- For WebSockets library\nimport qualified Network.WebSockets as WS\n\nimport Control.Monad (void)\n\nclass NetworkConn sock conn where\n  send :: conn -&gt; C.ByteString -&gt; IO ()\n  recv :: conn -&gt; IO C.ByteString\n  accept :: sock -&gt; IO conn\n\ninstance NetworkConn NS.Socket NS.Socket where\n  send conn text = void $ NSB.send conn text\n  recv conn      = NSB.recv conn 1024\n  accept sock    = fst &lt;$&gt; NS.accept sock\n\ninstance NetworkConn WS.PendingConnection WS.Connection where\n  send sock text = WS.sendTextData sock text\n  recv sock      = WS.receiveData sock\n  accept sock    = WS.acceptRequest sock\n</code></pre>\n"}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 39098967, "answer_count": 3, "score": 1, "last_activity_date": 1471952938, "creation_date": 1471946913, "last_edit_date": 1471952565, "question_id": 39098222, "link": "https://stackoverflow.com/questions/39098222/writing-a-class-with-method-returning-same-class-object", "title": "writing a Class with method returning same Class object", "body": "<p>I am writing a chat server in haskell. Earlier i had tcp sockets. Now i am moving to WebSockets. I wanted to create a thin wrapper of <code>NetworkConn</code> over it.. I am having problem writing <code>accept</code> function. </p>\n\n<p><code>acceptReuqest PendingConnection</code> returns <code>Connection</code></p>\n\n<p>and </p>\n\n<p><code>fst &lt;$&gt; accept Socket</code> is <code>Socket</code>.</p>\n\n<p>So, i tried following ..\nCreating <code>NetworkConn</code> for <code>Socket, Connection, PendingConnection</code></p>\n\n<pre><code>class NetworkConn sock where\n  accept :: (NetworkConn myconn) =&gt; sock -&gt; IO myconn\n\ninstance NetworkConn NS.Socket where\n  accept sock    = fst &lt;$&gt; NS.accept sock\n\ninstance NetworkConn WS.Connection where\n  accept sock    = error \"Not allowed\"\n</code></pre>\n\n<p><code>acceptReuqest PendingConnection</code> returns <code>Connection</code></p>\n\n<pre><code>instance NetworkConn WS.PendingConnection where\n  accept sock = WS.acceptRequest sock\n</code></pre>\n\n<p>This gives me error in <code>NS.Socket</code> that </p>\n\n<pre><code>Couldn't match type \u2018myconn\u2019 with \u2018NS.Socket\u2019\n      \u2018myconn\u2019 is a rigid type variable bound by\n               the type signature for\n                 acceptC :: NetworkConn myconn =&gt; NS.Socket -&gt; IO myconn\n               at src/HChat/Network.hs:21:3\n    Expected type: IO\n                     (myconn, network-2.6.2.1:Network.Socket.Types.SockAddr)\n      Actual type: IO\n                     (NS.Socket, network-2.6.2.1:Network.Socket.Types.SockAddr)\n    Relevant bindings include\n      acceptC :: NS.Socket -&gt; IO myconn\n        (bound at src/HChat/Network.hs:21:3)\n    In the second argument of \u2018(&lt;$&gt;)\u2019, namely \u2018NS.accept sock\u2019\n    In the expression: fst &lt;$&gt; NS.accept sock\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Couldn't match type \u2018myconn\u2019 with \u2018WS.Connection\u2019\n      \u2018myconn\u2019 is a rigid type variable bound by\n               the type signature for\n                 acceptC :: NetworkConn myconn =&gt; WS.PendingConnection -&gt; IO myconn\n               at src/HChat/Network.hs:31:3\n    Expected type: IO myconn\n      Actual type: IO WS.Connection\n    Relevant bindings include\n      acceptC :: WS.PendingConnection -&gt; IO myconn\n        (bound at src/HChat/Network.hs:31:3)\n</code></pre>\n\n<p>I starting reading about <code>class</code> and could not understand why the error is coming.\nI guess it is a syntactic error, but unable to figure it out. Please help.</p>\n\n<p>Also Is it possible to restrict the return type to be NetworkConn because i only want to call few methods defined only in NetworkConn.. ?</p>\n\n<p>Trying two classes:</p>\n\n<pre><code>class CandidateConn c where\n  acceptC :: (NetworkConn s) =&gt; c -&gt; IO s\n\nclass NetworkConn sock where\n  send :: sock -&gt; C.ByteString -&gt; IO ()\n  recv :: sock -&gt; IO C.ByteString\n  accept :: (CandidateConn conn) =&gt; conn -&gt; IO sock\n\ninstance NetworkConn NS.Socket where\n  send sock text = void $ NSB.send sock text\n  recv sock      = NSB.recv sock 1024\n  accept c       = acceptC c\n\ninstance CandidateConn NS.Socket where\n  acceptC sock = fst &lt;$&gt; NS.accept sock\n</code></pre>\n\n<p>gives :</p>\n\n<pre><code>Couldn't match type \u2018s\u2019 with \u2018NS.Socket\u2019\n      \u2018s\u2019 is a rigid type variable bound by\n          the type signature for\n            acceptC :: NetworkConn s =&gt; NS.Socket -&gt; IO s\n          at src/HChat/Network.hs:29:3\n    Expected type: IO\n                     (s, network-2.6.2.1:Network.Socket.Types.SockAddr)\n      Actual type: IO\n                     (NS.Socket, network-2.6.2.1:Network.Socket.Types.SockAddr)\n    Relevant bindings include\n      acceptC :: NS.Socket -&gt; IO s (bound at src/HChat/Network.hs:29:3)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471951049, "post_id": 39099587, "comment_id": 65545886, "body": "No need to do <code>name &lt;- x ; return name</code>, we can simply use <code>x</code>."}], "tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": true, "score": 4, "last_activity_date": 1471951923, "last_edit_date": 1471951923, "creation_date": 1471950719, "answer_id": 39099587, "question_id": 39097413, "link": "https://stackoverflow.com/questions/39097413/dns-lookup-in-haskell/39099587#39099587", "title": "DNS lookup in Haskell", "body": "<p>This worked for me:</p>\n\n<pre><code>import Network.BSD (getHostByName, hostAddress)\nimport Network.Socket (inet_ntoa)\nimport System.Environment (getArgs)\n\nresolve address = do\n  ent &lt;- getHostByName address\n  inet_ntoa (hostAddress ent)\n\nmain = resolve \"perdu.com\" &gt;&gt;= putStrLn\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "accepted_answer_id": 39099587, "answer_count": 1, "score": 2, "last_activity_date": 1471951923, "creation_date": 1471944529, "question_id": 39097413, "link": "https://stackoverflow.com/questions/39097413/dns-lookup-in-haskell", "title": "DNS lookup in Haskell", "body": "<p>I'm trying to do a simple lookup, for example convert \"perdu.com\" in \"208.97.177.124\". I tried using Network.DNS.Lookup since that's the first result on google, and it works fine : </p>\n\n<pre><code>rs &lt;- makeResolvSeed defaultResolvConf\neIp &lt;- withResolver rs $ \\resolver -&gt; lookupA resolver $ BS.pack \"perdu.com\"\n</code></pre>\n\n<p>The problem is that seems to be ignoring the /etc/hosts file. What is the correct way in Haskell to resolve a domain \"normally\", like other software like ping or any browser would do it ? I'm assuming Network.DNS.Lookup implements a full recursive resolver instead of just using the C functions ?</p>\n"}, {"tags": ["haskell", "asynchronous", "callback", "ffi"], "comments": [{"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 0, "creation_date": 1471938931, "post_id": 39094532, "comment_id": 65537793, "body": "This isn\u2019t intended to be a complete answer, but it looks like the console handler will just note that an interrupt was received, and then does something with the scheduler to make it do something at the next available opportunity. Take a look at <a href=\"https://github.com/ghc/ghc/blob/master/rts/Schedule.c\" rel=\"nofollow noreferrer\"><code>Schedule.c</code></a>, with a particular focus on <code>interruptStgRts</code> and how it interacts with the other functions in that file."}, {"owner": {"reputation": 2530, "user_id": 6658809, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d30a3055ca065bcc94e1c7386de4e48?s=128&d=identicon&r=PG&f=1", "display_name": "siracusa", "link": "https://stackoverflow.com/users/6658809/siracusa"}, "reply_to_user": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 0, "creation_date": 1471962931, "post_id": 39094532, "comment_id": 65555024, "body": "Looking at that file didn&#39;t give me any new insights, tbh. I&#39;ve tried to find other Haskell libraries that use callbacks to see how they handle it. There is, for example, <a href=\"https://hackage.haskell.org/package/GLUT-2.7.0.10/src/src/Graphics/UI/GLUT/Callbacks/Global.hs\" rel=\"nofollow noreferrer\"><code>addTimerCallback</code></a> from the GLUT package which also seems to just run the pure Haskell action, without the need for special handling from the C side or by RTS internals."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1471977755, "post_id": 39094532, "comment_id": 65564384, "body": "The reason the GHC implementation works is <a href=\"https://github.com/ghc/ghc/blob/master/rts/win32/ConsoleHandler.c#L183\" rel=\"nofollow noreferrer\">this</a> - instead of calling the <code>FunPtr</code> inside the callback, the callback is passed as a <code>StablePtr</code> which is applied to a buffer of events captured by <code>generic_handler</code>, and (perhaps critically) this buffer is declared in the C file globally, making it properly available to the callback. You would probably have to find a similair approach (write to a buffer, consume from the buffer)."}, {"owner": {"reputation": 2530, "user_id": 6658809, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d30a3055ca065bcc94e1c7386de4e48?s=128&d=identicon&r=PG&f=1", "display_name": "siracusa", "link": "https://stackoverflow.com/users/6658809/siracusa"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1472007966, "post_id": 39094532, "comment_id": 65574552, "body": "@user2407038: So do I understand correctly that it is the handling that happens in the critical section that makes the callback safe, because it kind of prepares the RTS for a safe re-entry to the Haskell side? To me this all looks awfully complicated compared to e.g. the much simpler <code>addTimerCallback</code> in the GLUT package, and I don&#39;t see why you need all the fancy C wrapping for the one callback but, apparently, no special handling for the other."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1472050898, "post_id": 39094532, "comment_id": 65599169, "body": "@siracusa <code>addTimerCallback</code> is GLUT, this is WinAPI you are working with. Blame Windows, not C. Seriously, I&#39;ve only ever had this problem with WinAPI callbacks - the reason, I believe, is that the WinAPI uses the <code>stdcall</code> call convention, but GHC can&#39;t generate such a <code>FunPtr</code>. When you call a function with the FFI typically, the haskell RTS will be the one to clean up the stack (i.e. make the function conform to the call convention) but when such a function is called in a callback by the WinApi, the Haskell RTS gets no chance to even know it runs."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1472051283, "post_id": 39094532, "comment_id": 65599479, "body": "@siracusa Furthermore, why it works with <code>-threading</code>, I&#39;m not too sure - perhaps with this flag, the Haskell RTS somehow registers foreign code in some way to be able to know when it runs? This is pure speculation - I don&#39;t know the GHC internals that well."}, {"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 0, "creation_date": 1472620452, "post_id": 39094532, "comment_id": 65819017, "body": "In the specific case of <code>SetConsoleCtrlHandler</code>, the handler is called on a different thread. (This is different from how it works on POSIX platforms; see Raymond Chen\u2019s <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20080728-00/?p=21453/\" rel=\"nofollow noreferrer\">blog post on the subject</a>.) Hence, you either need <code>-threaded</code> so Haskell can, well, deal with threads; or, you can leave it to the RTS, which in C enqueues the event to be handled by the main thread when it\u2019s free to do so (with no Haskell code ever running on the interrupt thread)."}], "owner": {"reputation": 2530, "user_id": 6658809, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d30a3055ca065bcc94e1c7386de4e48?s=128&d=identicon&r=PG&f=1", "display_name": "siracusa", "link": "https://stackoverflow.com/users/6658809/siracusa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 2, "answer_count": 0, "score": 7, "last_activity_date": 1471936173, "creation_date": 1471936173, "question_id": 39094532, "link": "https://stackoverflow.com/questions/39094532/asynchronous-c-callbacks-into-haskell-code-via-ffi", "title": "Asynchronous C callbacks into Haskell code via FFI", "body": "<p>I'm currently trying to port parts of the Windows API to Haskell. One of the functions covered is <code>SetConsoleCtrlHandler</code> which registers a handler callback that is called whenever a Ctrl+C or Ctrl+Break is received from console input. So here a small sample program:\n</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n{-# LANGUAGE ForeignFunctionInterface #-}\nmodule Main where\n\nimport Control.Monad\nimport GHC.ConsoleHandler\nimport Foreign\nimport System.Win32.Process\nimport System.Win32.Types\n\nforeign import ccall \"wrapper\"\n    makeHandlerPtr :: (DWORD -&gt; IO BOOL) -&gt; IO (FunPtr (DWORD -&gt; IO BOOL))\n\nforeign import stdcall \"windows.h SetConsoleCtrlHandler\"\n    c_SetConsoleCtrlHandler :: FunPtr (DWORD -&gt; IO BOOL) -&gt; BOOL -&gt; IO BOOL\n\nmain :: IO ()\nmain = unsafeCtrl\n\nunsafeCtrl :: IO ()\nunsafeCtrl = do\n    ptrHandler &lt;- makeHandlerPtr $ \\d -&gt; do\n        putStrLn $ \"received event \" ++ show d\n        return True\n    c_SetConsoleCtrlHandler ptrHandler True\n\n    forM_ [1..50] $ \\_ -&gt; sleep 100\n    freeHaskellFunPtr ptrHandler\n\nsafeCtrl :: IO ()\nsafeCtrl = do\n    installHandler $ Catch $ \\e -&gt; do\n        putStrLn $ \"received event \" ++ show e\n\n    forM_ [1..50] $ \\_ -&gt; sleep 100\n</code></pre>\n\n<p>If you compile the above program via <code>ghc --make AsyncCallback.hs</code> and run the program, it crashes with the following error as soon as a control event is received:</p>\n\n<pre><code>$ AsyncCallback\nAsyncCallback.exe: schedule: re-entered unsafely.\n   Perhaps a 'foreign import unsafe' should be 'safe'?\n</code></pre>\n\n<p>However, compiling with the <code>-threaded</code> option added seems to work fine:</p>\n\n<pre><code>$ AsyncCallback\nreceived event 0\nreceived event 1\nreceived event 0\n</code></pre>\n\n<p>Not sure why this makes it work, as I don't explicitly use threads here, and I can't see where GHC would implicitly start a new thread.</p>\n\n<p>Asking earlier about this on #haskell, someone noted that calling Haskell functions asynchronously from a C callback is inherently unsafe and that the above example just more or less coincidentally works. I was also pointed to <code>GHC.ConsoleHandler.installHandler</code> which seems to be a safe wrapper around <code>SetConsoleCtrlHandler</code>, and running the above program with <code>main = safeCtrl</code> indeed works fine. I tried to understand the implementation of <code>installHandler</code> (<a href=\"https://github.com/ghc/ghc/blob/master/rts/win32/ConsoleHandler.c\">C-side</a> and <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/src/GHC/ConsoleHandler.hs\">Haskell-side</a>) but I don't quite get it.</p>\n\n<p>The whole problem here seems to be that the callback is issued asynchronously, such that the Haskell RTS isn't \"prepared\" for when the callback tries to run the Haskell code. So I would like to know</p>\n\n<ol>\n<li>How does the GHC implementation of <code>installHandler</code> work? What is the crucial part that makes that implementation work and my version fail?</li>\n<li>Are there other options/general patterns how to call Haskell code asynchronously from a C callback? In this particular case, I can switch to the GHC implementation. But I may come accross similar C functions that asynchronously call back into Haskell code where I would have to write a safe binding on my own.</li>\n</ol>\n"}, {"tags": ["json", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1471915824, "post_id": 39090812, "comment_id": 65529761, "body": "Is there an easy way to get that version of Data.Aeson.Text?  Seems to break my packages: --  Failure when adding dependencies:           aeson: needed (&gt;=1.0.0.0), couldn&#39;t resolve its dependencies"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1471916164, "post_id": 39090812, "comment_id": 65529830, "body": "And the second gives me: ``` *Main A BS GHC.Generics T I&gt; BS.writeFile &quot;myfile2.json&quot; (encode meowmers)  &lt;interactive&gt;:23:30:     Couldn&#39;t match expected type \u2018BS.ByteString\u2019                 with actual type \u2018Data.ByteString.Lazy.Internal.ByteString\u2019     NB: \u2018BS.ByteString\u2019 is defined in \u2018Data.ByteString.Internal\u2019         \u2018Data.ByteString.Lazy.Internal.ByteString\u2019           is defined in \u2018Data.ByteString.Lazy.Internal\u2019     In the second argument of \u2018BS.writeFile\u2019, namely       \u2018(encode meowmers)\u2019     In the expression: BS.writeFile &quot;myfile2.json&quot; (encode meowmers) ```"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471917490, "post_id": 39090812, "comment_id": 65530097, "body": "For the second solution, try changing the import to: <code>import qualified Data.ByteString.Lazy as BS</code>"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1471922339, "post_id": 39090812, "comment_id": 65531113, "body": "Thanks, again, @TikhonJelvis.  With that amendment, I&#39;m getting: <code>&lt;interactive&gt;:27:30:     No instance for (ToJSON Cat) arising from a use of \u2018encode\u2019     In the second argument of \u2018BS.writeFile\u2019, namely       \u2018(encode meowmers)\u2019 </code>"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1471922509, "post_id": 39090812, "comment_id": 65531153, "body": "Or with an explicit utf8 encoding: ``` Data.Text.Encoding&gt; BS.writeFile &quot;myfile2.json&quot; (encodeUtf8 meowmers)  &lt;interactive&gt;:31:30:     Couldn&#39;t match expected type \u2018BS.ByteString\u2019                 with actual type \u2018Data.ByteString.Internal.ByteString\u2019 ```"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1472102105, "post_id": 39090812, "comment_id": 65618879, "body": "I got aeson 1.0.0.0 installed, which contains the encodeToLazyText method in 1.    ``` &lt;interactive&gt;:68:1:     No instance for (ToJSON Cat)       arising from a use of \u2018encodeToLazyText\u2019     In the expression: encodeToLazyText meowmers     In an equation for \u2018it\u2019: it = encodeToLazyText meowmers ```"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1472147343, "post_id": 39090812, "comment_id": 65646909, "body": "@Mittenchops: The <code>ToJSON</code> problem just means you need to make your type an instance of the <code>ToJSON</code> typeclass, to specify how it&#39;s encoded to JSON."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1472148066, "post_id": 39090812, "comment_id": 65647352, "body": "@Mittenchops: I added a bit of detail about how to do that to my answer."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1472398913, "post_id": 39090812, "comment_id": 65726430, "body": "Thank you, this was helpful."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": false, "score": 8, "last_activity_date": 1472147982, "last_edit_date": 1472147982, "creation_date": 1471913992, "answer_id": 39090812, "question_id": 39090784, "link": "https://stackoverflow.com/questions/39090784/write-json-to-a-file-in-haskell-with-text-rather-than-char/39090812#39090812", "title": "Write json to a file in Haskell (with Text rather than [Char])", "body": "<p>You can encode JSON to a lazy <code>Text</code> value directly using <a href=\"https://hackage.haskell.org/package/aeson-1.0.0.0/docs/Data-Aeson-Text.html\" rel=\"nofollow\">Data.Aeson.Text.encodeToLazyText</a>.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.Aeson.Text (encodeToLazyText)\n\n...\n\nI.writeFile \"myfile.json\" (encodeToLazyText meowmers)\n</code></pre>\n\n<p>A <code>bytestring</code> is a type for binary data\u2014not necessarily text. To represent textual data in a bytestring, you need to encode it with some encoding like UTF-8. Once you have a bytestring (encoded with UTF-8 or whatever format makes sense), you can write it to a file using <code>Data.ByteString</code> functions:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as BS\n\nBS.writeFile \"myfile.json\" (encode meowmers)\n</code></pre>\n\n<p>To make this work you need to give your <code>Cat</code> type a <code>ToJSON</code> instance that specifies how to encode it in JSON. You can do this automatically with the <code>DeriveGeneric</code> extension:</p>\n\n<pre><code>data Cat = Cat { ... } deriving (Show, Generic)\n\ninstance ToJSON Cat\n</code></pre>\n\n<p>You can also do this manually if you need finer control over what the resulting JSON looks like.</p>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 11, "last_activity_date": 1472105397, "creation_date": 1472105397, "answer_id": 39137854, "question_id": 39090784, "link": "https://stackoverflow.com/questions/39090784/write-json-to-a-file-in-haskell-with-text-rather-than-char/39137854#39137854", "title": "Write json to a file in Haskell (with Text rather than [Char])", "body": "<p>So, to iron everything out (since most of the work has already been done). You actually have two problems:</p>\n\n<ol>\n<li>You are mixing string types</li>\n<li>You don't have an instance of <code>ToJSON</code> declared for <code>Cat</code></li>\n</ol>\n\n<p>Here is a working example that relies on recent versions of <code>aeson</code> and <code>text</code> (for me that is <code>aeson-1.0.0.0</code> and <code>text-1.2.2.1</code>.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, DeriveGeneric, DeriveAnyClass #-}\n\nimport GHC.Generics\nimport Data.Text.Lazy (Text)\nimport Data.Text.Lazy.IO as I\nimport Data.Aeson.Text (encodeToLazyText)\nimport Data.Aeson (ToJSON)\n\ndata Cat = Cat { name :: Text, age :: Int } deriving (Show, Generic, ToJSON)\n\nmeowmers = Cat { name = \"meowmers\", age = 1 }\n\nmain = I.writeFile \"myfile.json\" (encodeToLazyText meowmers)\n</code></pre>\n\n<p>As you can probably tell from the imports, I rely on <code>aeson</code> to convert between string types through <code>encodeToLazyText</code>. That deals with problem number 1.</p>\n\n<p>Then, I use the language extension <code>DeriveGeneric</code> to get a <code>Generic</code> instance for <code>Cat</code>, and use that in conjunction with the extension <code>DeriveAnyClass</code> to get an instance of <code>ToJSON</code> for <code>Cat</code>. The magic of that instance is again <a href=\"https://hackage.haskell.org/package/aeson-1.0.0.0/docs/Data-Aeson-TH.html\" rel=\"noreferrer\">part of <code>aeson</code></a>.</p>\n\n<p>Running this, I get a new file <code>myfile.json</code> that contains <code>{\"age\":1,\"name\":\"meowmers\"}</code> in it.</p>\n"}, {"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1472398901, "post_id": 39151145, "comment_id": 65726425, "body": "Thank you, this was helpful."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1472152345, "last_edit_date": 1472152345, "creation_date": 1472145268, "answer_id": 39151145, "question_id": 39090784, "link": "https://stackoverflow.com/questions/39090784/write-json-to-a-file-in-haskell-with-text-rather-than-char/39151145#39151145", "title": "Write json to a file in Haskell (with Text rather than [Char])", "body": "<p>Rolling all the comments and answers into one (credit to the other folks here, please accept one of their answers).</p>\n\n<ol>\n<li>Derive <code>Generic</code> and <code>ToJSON</code> (or manually write a <code>ToJSON</code> instance if you'd like).  This required a few more <code>LANGUAGE</code> pragmas.</li>\n<li>Use either a newer version of <code>text</code> and <code>encodeToLazyText</code> OR use <code>Data.ByteString.Lazy.writeFile</code> to write out the bytestring.</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DeriveAnyClass #-}\n\nimport GHC.Generics\nimport Data.Aeson (encode,ToJSON(..))\nimport Data.Text.Lazy (Text)\nimport qualified Data.ByteString.Lazy as BS\n\ndata Cat = Cat { name :: Text\n               , age  :: Int\n               } deriving (Show,Generic,ToJSON)\n\nmain =\n  do let meowmers = Cat {name = \"meowmers\", age = 1}\n     BS.writeFile \"myfile.json\" (encode meowmers)\n</code></pre>\n\n<p>Resulting in:</p>\n\n<pre><code>tommd@HalfAndHalf /tmp% runhaskell so.hs\ntommd@HalfAndHalf /tmp% cat myfile.json\n{\"age\":1,\"name\":\"meowmers\"}\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 39137854, "answer_count": 3, "score": 6, "last_activity_date": 1472152345, "creation_date": 1471913774, "last_edit_date": 1471916919, "question_id": 39090784, "link": "https://stackoverflow.com/questions/39090784/write-json-to-a-file-in-haskell-with-text-rather-than-char", "title": "Write json to a file in Haskell (with Text rather than [Char])", "body": "<p>I'm trying to serialize an object into a JSON string and write it to a file.</p>\n\n<p>In python, I'd do something like:</p>\n\n<pre><code>&gt;&gt;&gt; meowmers = {\"name\" : \"meowmers\", \"age\" : 1}\n&gt;&gt;&gt; import json\n&gt;&gt;&gt; with open(\"myfile.json\",\"wb\") as f\n    json.dump(meowmers, f)\n\n$ cat myfile.json\n{\"age\": 1, \"name\": \"meowmers\"}\n</code></pre>\n\n<p>I'm looking at this in Haskell</p>\n\n<pre><code>$ stack ghci\n\n{-# LANGUAGE OverloadedStrings #-}\n:set -XOverloadedStrings\n\nimport GHC.Generics\nimport Data.Aeson as A\nimport Data.Text.Lazy as T\nimport Data.Text.Lazy.IO as I\n\n:{\ndata Cat = Cat {\n      name :: Text\n    , age  :: Int\n    } deriving Show\n:}\n\nlet meowmers = Cat {name = \"meowmers\", age = 1}\nwriteFile \"myfile.json\" (encode meowmers)\n</code></pre>\n\n<p>Oh no!</p>\n\n<pre><code>*A T I GHC.Generics&gt; I.writeFile \"myfile2.json\" (encode meowmers)\n\n&lt;interactive&gt;:34:29:\n    Couldn't match expected type \u2018Text\u2019\n                with actual type \u2018bytestring-0.10.6.0:Data.ByteString.Lazy.Internal.ByteString\u2019\n    In the second argument of \u2018I.writeFile\u2019, namely \u2018(encode meowmers)\u2019\n    In the expression: I.writeFile \"myfile2.json\" (encode meowmers)\n</code></pre>\n\n<p>Two questions:</p>\n\n<ol>\n<li>This appears to be a bytestring.  How can I work with that?</li>\n<li>If that's not what I want to do, is there a Haskell json serialization solution using Text rather than String that is yet rather simple?</li>\n</ol>\n"}, {"tags": ["haskell", "haskell-stack", "haste"], "comments": [{"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471928516, "post_id": 39090396, "comment_id": 65532629, "body": "I don&#39;t know a Stack answer, but maybe you might want to step up to a full build system like <a href=\"http://shakebuild.com\" rel=\"nofollow noreferrer\">shake</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1472615791, "last_edit_date": 1472615791, "creation_date": 1472596892, "answer_id": 39238172, "question_id": 39090396, "link": "https://stackoverflow.com/questions/39090396/integrating-haste-into-stack-tool-chain/39238172#39238172", "title": "Integrating Haste into Stack tool chain", "body": "<p>This should work, but take that with a grain of salt as I'm having extra issues due to <a href=\"https://github.com/valderman/haste-compiler/issues/375\" rel=\"noreferrer\">this</a> known bug. Make sure your <code>.cabal</code> file has the right dependencies, especially the <code>if impl(haste) ..</code> part (<a href=\"http://haste-lang.org/blog/haste-and-cabal-files/\" rel=\"noreferrer\">see this</a>). Seems like most of the dependencies for Haste (and since Haste uses GHC 7.10.3 as of today) work with <code>lts-6.14</code>, so I used that as resolver.</p>\n\n<p><strong>haste-project.cabal</strong></p>\n\n<pre><code>name:                haste-project\nversion:             0.1.0.0\ncategory:            Web\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nexecutable haste-project-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  build-depends:       base  &gt;= 4.8 &amp;&amp; &lt; 4.9\n  if impl(haste)\n    build-depends:     haste-lib &gt;= 0.5 &amp;&amp; &lt; 0.6\n  else\n    build-depends:     haste-compiler &gt;= 0.5 &amp;&amp; &lt; 0.6\n  default-language:    Haskell2010\n</code></pre>\n\n<p><strong>stack.yaml</strong></p>\n\n<pre><code>extra-deps:\n- HTTP-4000.2.23\n- ghc-simple-0.3\n- haste-compiler-0.5.4.2\n- shellmate-0.2.3\nresolver: lts-6.14\n</code></pre>\n\n<p>Then, from the same directory, you can now proceed with the <a href=\"http://haste-lang.org/downloads/\" rel=\"noreferrer\">usual setup instructions for Haste</a>, but with Stack complements of the Cabal commands:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack build\n$ stack install haste-compiler # installs haste-boot, haste-cat, haste-pkg, and hastec\n$ stack exec haste-boot        # setup Haste (where I get the bug I mentioned above)\n</code></pre>\n\n<p>Then, you should be able to run all the usual commands, but prefixed with <code>stack exec --</code>. For example</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack exec -- hastec -O2 -fglasgow-exts myprog.hs\n</code></pre>\n"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 2, "accepted_answer_id": 39238172, "answer_count": 1, "score": 5, "last_activity_date": 1472615791, "creation_date": 1471910189, "question_id": 39090396, "link": "https://stackoverflow.com/questions/39090396/integrating-haste-into-stack-tool-chain", "title": "Integrating Haste into Stack tool chain", "body": "<p>I am using <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"noreferrer\">Haskell Stack</a> for a project and I want to include <a href=\"http://haste-lang.org/\" rel=\"noreferrer\">Haste</a> it compile client side logic. I like the fact that Stack abstracts away the different build and install issues among environments and if it builds on my machine, it will build on someone else's.</p>\n\n<p>How do I integrate Haste into the Stack tool chain?  Working out one time setup is fine, but I don't want to have to recreate the whole tool chain every time the code moves to a new system.</p>\n"}, {"tags": ["haskell", "pool"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1471904723, "creation_date": 1471904723, "answer_id": 39089633, "question_id": 39088309, "link": "https://stackoverflow.com/questions/39088309/in-data-pool-what-happens-if-the-action-that-creates-a-new-resource-throws-an-e/39089633#39089633", "title": "In Data.Pool, what happens if the action that creates a new resource throws an exception?", "body": "<p>Resources aren't created until you <code>takeResource</code> or <code>tryTakeResource</code> and there isn't a resource in the pool. If the action to create a resource throws an exception the pool is left unmodified and the exception is raised in the calling code. If you repeatedly call <code>takeResource</code> or <code>tryTakeResource</code> even when previous calls have thrown exceptions the create action will be executed repeatedly. <a href=\"https://hackage.haskell.org/package/resource-pool-0.2.3.2/docs/src/Data-Pool.html#withResource\" rel=\"nofollow\"><code>withResource</code></a> calls <code>takeResource</code> without handling any exceptions; if the action to create a resource throws an exception in <code>takeResoure</code> the exception will be raised in the code calling <code>withResource</code>.</p>\n\n<hr>\n\n<p>The code that creates a resource is in <a href=\"https://hackage.haskell.org/package/resource-pool-0.2.3.2/docs/src/Data-Pool.html#takeResource\" rel=\"nofollow\"><code>takeResource</code></a> and <a href=\"https://hackage.haskell.org/package/resource-pool-0.2.3.2/docs/src/Data-Pool.html#tryTakeResource\" rel=\"nofollow\"><code>tryTakeResource</code></a>. The difference between them is that when <code>used == maxResources</code> <code>takeResource</code> <code>retry</code>s; <code>tryTakeResouce</code> returns <code>Nothing</code>.</p>\n\n<p>When there are no available entries, and <code>used</code> isn't <code>maxResources</code>, they both do the following:</p>\n\n<pre><code>create `onException` atomically (modifyTVar_ inUse (subtract 1))\n</code></pre>\n\n<p>When an exception occurs creating the resource the number of resources <code>inUse</code> isn't changed and the exception is raised in the code calling <code>takeResource</code> or <code>tryTakeResource</code>.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 39089633, "answer_count": 1, "score": 2, "last_activity_date": 1471904723, "creation_date": 1471898215, "question_id": 39088309, "link": "https://stackoverflow.com/questions/39088309/in-data-pool-what-happens-if-the-action-that-creates-a-new-resource-throws-an-e", "title": "In Data.Pool, what happens if the action that creates a new resource throws an exception?", "body": "<p>In <a href=\"https://hackage.haskell.org/package/resource-pool-0.2.3.2/docs/Data-Pool.html\" rel=\"nofollow\">Data.Pool</a>, <code>createPool</code>'s first parameter is the \"action that creates a new resource\".</p>\n\n<p>What happens if this action throws an exception? Can I control what happens? (I'm afraid it will go into an infinite loop where it continually tries to create a new resource.)</p>\n\n<p>(For the <code>withResource</code> function, they say: \"If the action throws an exception of any type, the resource is destroyed, and not returned to the pool.\" But this seems like an entirely different thing. This seems to happen <em>after</em> the resource has already been successfully created. So I guess this is not a clue to the answer to my above question.)</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1471897149, "creation_date": 1471897149, "answer_id": 39088049, "question_id": 39087880, "link": "https://stackoverflow.com/questions/39087880/how-to-access-rts-s-or-other-memory-information-from-within-a-haskell-progra/39088049#39088049", "title": "How to access &quot;+RTS -s&quot; or other memory information from within a Haskell program?", "body": "<p>Have a look at the <code>getGCStats</code> function in the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-Stats.html\">GHC.Stats</a> package.</p>\n\n<p>The <code>currentBytesUsed</code> field will report the number of live bytes at the end of the last major GC.</p>\n\n<p>Also note the comments in the docs about having to enable to the RTS <code>-T</code> option and perhaps calling <code>performGC</code> beforehand.</p>\n"}], "owner": {"reputation": 319, "user_id": 6531137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8fa00f21d96d6c6030c3c74d7fb26944?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6531137/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 39088049, "answer_count": 1, "score": 3, "last_activity_date": 1471897149, "creation_date": 1471896512, "question_id": 39087880, "link": "https://stackoverflow.com/questions/39087880/how-to-access-rts-s-or-other-memory-information-from-within-a-haskell-progra", "title": "How to access &quot;+RTS -s&quot; or other memory information from within a Haskell program?", "body": "<p>When running a Haskell program, +RTS -s reports information such as \"bytes maximum residency\". Is there a way to access this information from within a Haskell program? Is there a library on Hackage that provides this functionality?</p>\n\n<p>If not, is there a way to access the amount of memory currently in use? For example, the amount displayed by the terminal command \"top\"?</p>\n"}, {"tags": ["haskell", "c-preprocessor", "haddock"], "answers": [{"comments": [{"owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "edited": false, "score": 0, "creation_date": 1472062962, "post_id": 39088966, "comment_id": 65606354, "body": "Thanks. I&#39;ll try a variant of this that defines a CPP function that takes to args, a string one for each GHC version, since that would look much nicer. I&#39;ll report back!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1471901080, "creation_date": 1471901080, "answer_id": 39088966, "question_id": 39087731, "link": "https://stackoverflow.com/questions/39087731/cpp-within-haddock/39088966#39088966", "title": "CPP within Haddock", "body": "<p>I can't remember if, as you say, a newline is inserted or if -- worse -- some <code>#line</code> directive is also inserted, which breaks the Haddock block.</p>\n\n<p>Anyway, I think one could workaround it as follows:</p>\n\n<pre><code>#if SOME_MACRO\n#define SOME_MACRO_HK -- True\n#else\n#define SOME_MACRO_HK -- False\n#endif\n\n\n-- | Whether SOME_MACRO is true\n-- &gt;&gt;&gt; someMacro\nSOME_MACRO_HK\nsomeMacro :: Bool\nsomeMacro = macroVal\n</code></pre>\n\n<p>Insert newlines in the macro as needed, possibly integrating the whole Haddock block in it. Not elegant by any stretch, but it should do.</p>\n"}], "owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1471901080, "creation_date": 1471895917, "question_id": 39087731, "link": "https://stackoverflow.com/questions/39087731/cpp-within-haddock", "title": "CPP within Haddock", "body": "<p>I can change haddocks based on a flag if I put the entire block within the CPP conditional branches:</p>\n\n<pre><code>#if SOME_MACRO\n-- | Whether SOME_MACRO is true\n-- &gt;&gt;&gt; someMacro\n-- True\nsomeMacro :: Bool\nsomeMacro = macroVal\n#else\n-- | Whether SOME_MACRO is true\n-- &gt;&gt;&gt; someMacro\n-- False\nsomeMacro :: Bool\nsomeMacro = macroVal\n#endif\n</code></pre>\n\n<p>And the documentation looks as you'd expect it to, and <code>doctest</code> also works as expected.</p>\n\n<p>But that's maintenance nightmare for larger comments or code blocks. On the other hand, this does not seem to work:</p>\n\n<pre><code>-- | Whether SOME_MACRO is true\n-- &gt;&gt;&gt; someMacro\n#if SOME_MACRO\n-- True\n#else\n-- False\n#endif\nsomeMacro :: Bool\nsomeMacro = macroVal\n</code></pre>\n\n<p>Why is that? Isn't CPP processed before Haddock? I have the intuition that it's because a newline is staying on after the CPP stage, but it's just an intuition</p>\n"}, {"tags": ["windows", "haskell", "x509certificate", "elm"], "comments": [{"owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1471943314, "post_id": 39086758, "comment_id": 65540556, "body": "Could you provide more information? Do you get this error every time you try to run elm-make, or do you get it only for specific input files?"}, {"owner": {"reputation": 8171, "user_id": 311655, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6bad9300ce17b6a89678ed9343647906?s=128&d=identicon&r=PG", "display_name": "DenisKolodin", "link": "https://stackoverflow.com/users/311655/deniskolodin"}, "reply_to_user": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1472046543, "post_id": 39086758, "comment_id": 65595821, "body": "Everytime. I take it after <b>Crypto Pro</b> installed. I have no idea how to use &quot;1.2.643.2.2.3&quot; algorithm which is necessary to Haskell. If I reinstall Windows than Haskell and Elm work fine."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 539470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f1daccb03f89f7e8588028515e9a9b1?s=128&d=identicon&r=PG", "display_name": "dluciv", "link": "https://stackoverflow.com/users/539470/dluciv"}, "is_accepted": true, "score": 2, "last_activity_date": 1482505798, "last_edit_date": 1482505798, "creation_date": 1482487747, "answer_id": 41299329, "question_id": 39086758, "link": "https://stackoverflow.com/questions/39086758/haskell-or-elm-error-unknown-public-key-oid/41299329#41299329", "title": "Haskell or Elm error: unknown public key OID", "body": "<p>I confirm that it is <em>likely</em> CryptoPro. For me, error happened when using <code>pandoc-citeproc</code>.</p>\n\n<p>I solved it this way without reinstalling Windows:</p>\n\n<ol>\n<li>Removing CryproPro.</li>\n<li>Then manually removing trusted root certificates using \u0413\u041e\u0421\u0422 algorithm (they were likely the reason of such a crash) as shown <a href=\"https://msdn.microsoft.com/en-us/library/ms788967(v=vs.110).aspx\" rel=\"nofollow noreferrer\">here</a>.</li>\n</ol>\n\n<p>Good luck!</p>\n\n<p>P.S. Don't know if Russian \u0413\u041e\u0421\u0422 certificates actually violate standards in some very bad way or Haskell library does. This is subject to investigate.</p>\n"}], "owner": {"reputation": 8171, "user_id": 311655, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6bad9300ce17b6a89678ed9343647906?s=128&d=identicon&r=PG", "display_name": "DenisKolodin", "link": "https://stackoverflow.com/users/311655/deniskolodin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 41299329, "answer_count": 1, "score": 6, "last_activity_date": 1482505798, "creation_date": 1471891891, "question_id": 39086758, "link": "https://stackoverflow.com/questions/39086758/haskell-or-elm-error-unknown-public-key-oid", "title": "Haskell or Elm error: unknown public key OID", "body": "<p>I have an error in Windows with Elm:</p>\n\n<pre><code>elm-make.exe: unknown public key OID: [1,2,643,2,2,19]\n</code></pre>\n\n<p>Also I have the same with Haskell Platform, because it's an error of <code>Data.X509.PublicKey</code> module. How to fix it?</p>\n\n<p>I've found that <code>1.2.643.2.2.19</code> is a <code>GOST R 34.10-2001</code> encryption algorithm installed with <strong>Crypto PRO</strong> encryption software. How to revert it back to defaults?</p>\n"}, {"tags": ["linux", "haskell", "encoding"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1471894434, "post_id": 39086584, "comment_id": 65522481, "body": "Do you know the exact encoding of the file?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471894520, "post_id": 39086584, "comment_id": 65522533, "body": "Probably the file is latin-1 encoded, when Haskell (as most applications in linux nowadays) tries to decode it as utf8."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471894663, "post_id": 39086584, "comment_id": 65522611, "body": "I just tried readFile on a latin-1 file with accents, Haskell shows character codes like \\218, but does not crash. You should try to reduce your file to a small region that has the problem and post it."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 0, "creation_date": 1471895236, "post_id": 39086584, "comment_id": 65522892, "body": "Could you post an excerpt from your file that causes this error? It would be much easier to help you if we could reproduce the problem on our own machines."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1471895292, "post_id": 39086584, "comment_id": 65522925, "body": "@chi : readFile returns a String, not a Text. It doesn&#39;t know UTF8."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471899970, "post_id": 39086584, "comment_id": 65525224, "body": "@V.Semeria A String is a list of unicode code points, so decoding is performed. The actual encoding is set via <code>hSetEncoding</code> on a handle (e.g. stdin) in text mode."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471901240, "post_id": 39086584, "comment_id": 65525759, "body": "My mistake. I thought Char and Word8 were the same type."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1471902401, "post_id": 39086584, "comment_id": 65526236, "body": "@danidiaz <code>file -i MAIL.txt</code> returns <code>iso-8859-1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1471902530, "post_id": 39087804, "comment_id": 65526283, "body": "Thank you, I&#39;ll try later. This is not important, I&#39;m just playing with Haskell :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1471937769, "post_id": 39087804, "comment_id": 65537066, "body": "@St&#233;phaneLaurent Keep in mind that a ByteString contains bytes, not characters -- if you want to do text processing you might want to decode it to a <code>Text</code> before starting the actual processing. For that, you need to specify an encoding, and use some library."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1472892023, "post_id": 39087804, "comment_id": 65943194, "body": "Works fine! Thank you."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1471896547, "last_edit_date": 1471896547, "creation_date": 1471896189, "answer_id": 39087804, "question_id": 39086584, "link": "https://stackoverflow.com/questions/39086584/failure-of-readprocess-grep-in-haskell-because-of-a-strange-file/39087804#39087804", "title": "Failure of readProcess &quot;grep&quot; in Haskell because of a strange file", "body": "<p>Use <code>readProcessWithExitCode</code> or <code>readCreateProcessWithExitCode</code> from the <a href=\"https://hackage.haskell.org/package/process-extras-0.4.1.4/docs/System-Process-ByteString.html\" rel=\"nofollow\">process-extras</a> package. They return ByteStrings:</p>\n\n<pre><code>readProcessWithExitCode :: FilePath -&gt; [String] -&gt; ByteString\n       -&gt; IO (ExitCode, ByteString, ByteString)\n</code></pre>\n\n<p>Other versions exists for return lazy Bytestrings and Text.</p>\n\n<p>Edit: Updated links since process-listlike is deprecated in favor of process-extras.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 39087804, "answer_count": 1, "score": 2, "last_activity_date": 1472892292, "creation_date": 1471891321, "last_edit_date": 1472892292, "question_id": 39086584, "link": "https://stackoverflow.com/questions/39086584/failure-of-readprocess-grep-in-haskell-because-of-a-strange-file", "title": "Failure of readProcess &quot;grep&quot; in Haskell because of a strange file", "body": "<p>I have a file <code>MAIL.txt</code> containing strange characters (this file comes from Windows and I am on Linux). It contains the character string <code>rec</code>. When I run <code>grep \"rec\" MAIL.txt</code> in a terminal, I get the expected output. </p>\n\n<p>However this command fails in Haskell:</p>\n\n<pre><code>Prelude System.Process&gt; r &lt;- readProcessWithExitCode \"grep\" [\"rec\", \"MAIL.txt\"] \"\"\n*** Exception: fd:13: hGetContents: invalid argument (invalid byte sequence)\n</code></pre>\n\n<p>What is the explanation and is there a way to avoid that (without modifying the strange file)?</p>\n\n<p>Here is the output of <code>grep</code> where you can see the strange characters:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oVLB6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oVLB6.png\" alt=\"enter image description here\"></a></p>\n\n<p>In fact these should be accented letters.</p>\n\n<p>I cannot read the file with <code>readFile</code>:</p>\n\n<pre><code>&gt; r &lt;- readFile \"MAIL.txt\"\n&gt; r\n\"Bonjour,\\r\\n\\r\\n Quelques remarques sur cette fiche :\\r\\n\\r\\n- *** Exception: MAIL.txt: hGetContents: invalid argument (invalid byte sequence)\n</code></pre>\n\n<p>Maybe there's a way to detect the problem with <a href=\"https://hackage.haskell.org/package/binary-0.8.4.1/docs/Data-Binary.html\" rel=\"nofollow noreferrer\">Data.Binary</a>?</p>\n\n<h1>Solution</h1>\n\n<p>To detail @ErikR's answer:</p>\n\n<pre><code>import System.Process.ByteString (readProcessWithExitCode)\nimport Data.ByteString (ByteString, empty)\nimport qualified Data.ByteString.Char8 as B\nimport System.Exit (ExitCode)\n(err, stdout, stderr) &lt;- readProcessWithExitCode \"grep\" [\"rec\", \"MAIL.txt\"] empty\nB.putStrLn stdout\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 1, "last_activity_date": 1471954300, "creation_date": 1471954300, "answer_id": 39100833, "question_id": 39086469, "link": "https://stackoverflow.com/questions/39086469/what-does-it-mean-for-a-setter-to-be-index-preserving/39100833#39100833", "title": "What does it mean for a Setter to be index preserving?", "body": "<p>There's two questions here. The first one: what is \"index preserving\", there is a hint in other docs:</p>\n\n<blockquote>\n  <p><code>f . g</code> (and <code>f .&gt; g</code>) gives you the index of <code>g</code> unless <code>g</code> is index-preserving, like a <code>Prism</code>, <code>Iso</code> or <code>Equality</code>, in which case it'll pass through the index of <code>f</code>.</p>\n</blockquote>\n\n<p>The other question: <code>i</code> is constrained in other <code>Indexable</code> instance:</p>\n\n<pre><code>instance i ~ j =&gt; Indexable i (Indexed j)\n</code></pre>\n\n<p>where</p>\n\n<pre><code>-- | A function with access to a index. ...\nnewtype Indexed i a b = Indexed { runIndexed :: i -&gt; a -&gt; b }\n</code></pre>\n\n<p>Shortly, this is an encoding trick to make indexed and non-indexed optics to compose. We stay polymorphic in <code>Profunctor</code>, and instantiate it with  <code>(-&gt;)</code> or <code>Indexed i</code> much later.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1471954300, "creation_date": 1471890927, "question_id": 39086469, "link": "https://stackoverflow.com/questions/39086469/what-does-it-mean-for-a-setter-to-be-index-preserving", "title": "What does it mean for a Setter to be index preserving?", "body": "<p>I'm trying to gain some intuition about Setters in <code>lens</code>. It's easy to run into an <a href=\"https://hackage.haskell.org/package/lens-4.14/docs/src/Control.Lens.Type.html#IndexedSetter\" rel=\"nofollow\">IndexedSetter</a> which requires rather intimidating <code>Conjoined</code> class:</p>\n\n<pre><code>class\n  ( Choice p, Corepresentable p, Comonad (Corep p), Traversable (Corep p)\n  , Strong p, Representable p, Monad (Rep p), MonadFix (Rep p), Distributive (Rep p)\n  , Costrong p, ArrowLoop p, ArrowApply p, ArrowChoice p, Closed p\n  ) =&gt; Conjoined p where\n</code></pre>\n\n<p>But for functions, it's quite trivial:</p>\n\n<pre><code>class Conjoined p =&gt; Indexable i p where\n  -- | Build a function from an 'indexed' function.\n  indexed :: p a b -&gt; i -&gt; a -&gt; b\n\ninstance Indexable i (-&gt;) where\n  indexed = const\n</code></pre>\n\n<p>It seems that <code>i</code> is not constrained in any way other than being an argument after <code>p a b</code>. </p>\n\n<p>What makes it an \"index\" and should I care about it when working with <code>Setter</code>s?</p>\n"}, {"tags": ["haskell", "ghc", "type-families"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1471889739, "post_id": 39085532, "comment_id": 65520120, "body": "I have no idea, but the documentation for <code>TypeFamilyDependencies</code> makes me fear they&#39;re not quite ready for prime time. They have unnatural restrictions that don&#39;t sit right with me; I wouldn&#39;t be shocked if the developers missed a spot."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1471891637, "post_id": 39085532, "comment_id": 65521039, "body": "If it loops forever that&#39;s definitely a bug"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1474570150, "last_edit_date": 1495541703, "creation_date": 1474570150, "answer_id": 39646767, "question_id": 39085532, "link": "https://stackoverflow.com/questions/39085532/ghc-8-0-1-hangs-explanation-or-compiler-bug/39646767#39646767", "title": "GHC 8.0.1 hangs. Explanation or compiler bug?", "body": "<p>The compiler falling into an infinite loop without <code>UndecidableInstances</code> or <code>UndecidableSuperclassCycles</code> is a compiler bug, as <a href=\"https://stackoverflow.com/questions/39085532/ghc-8-0-1-hangs-explanation-or-compiler-bug#comment65521039_39085532\">jberryman stated</a>. You should report it on the <a href=\"https://ghc.haskell.org/trac/ghc\" rel=\"nofollow noreferrer\">GHC Trac</a> site.</p>\n\n<p>I simplified your example a bit, which may or may not clarify things and will likely make your bug report more effective.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilyDependencies #-}\n\nmodule TFLoop where\n\nimport Data.Proxy\n\nmain :: IO ()\nmain = return $ f Proxy Proxy (Just 'c')\n\ndata D1 x\ndata D2\n\ntype family TF d a = t | t -&gt; d a\ntype instance TF (D1 x) a = Maybe (TF x a)\ntype instance TF D2 () = Char\n\nf :: proxy1 x -&gt; proxy2 a -&gt; TF x a -&gt; ()\nf _ _ _ = ()\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 3, "answer_count": 1, "score": 12, "last_activity_date": 1474570150, "creation_date": 1471887376, "last_edit_date": 1474534855, "question_id": 39085532, "link": "https://stackoverflow.com/questions/39085532/ghc-8-0-1-hangs-explanation-or-compiler-bug", "title": "GHC 8.0.1 hangs. Explanation or compiler bug?", "body": "<p>Can someone explain why the following code causes GHC 8.0.1 to loop forever on compiling, or is this a bug?</p>\n\n<pre><code>{-# LANGUAGE TypeFamilyDependencies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n\nmain = return $ f (Just 'c')\n\ndata D1 x\ndata D2\n\ntype family TF x = t | t -&gt; x\ntype instance TF (D1 x, a) = Maybe (TF (x, a))\ntype instance TF (D2, ()) = Char\n\nf :: TF (x, a) -&gt; ()\nf _ = ()\n</code></pre>\n"}, {"tags": ["mongodb", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471883918, "post_id": 39084563, "comment_id": 65517138, "body": "What does &quot;not working&quot; mean? Is there an error message? If so, what does it say? What did you expect? What did you get? What version of the package are you using?"}, {"owner": {"reputation": 61, "user_id": 2931588, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93a9499a898bce63dd78f23826dfe02f?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/2931588/david"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471884109, "post_id": 39084563, "comment_id": 65517230, "body": "@dfeuer:   Couldn&#39;t match expected type \u2018Query\u2019                 with actual type \u2018(Collection -&gt; aQueryOrSelection0, String)\u2019"}, {"owner": {"reputation": 61, "user_id": 2931588, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93a9499a898bce63dd78f23826dfe02f?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/2931588/david"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471884234, "post_id": 39084563, "comment_id": 65517299, "body": "I want to query multiple fields with an &quot;$and&quot; operator. Is this syntax OK?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1471888878, "post_id": 39084563, "comment_id": 65519673, "body": "You should edit your question to add the full text of the error message in the question body. You should also include all relevant <code>import</code> lines in your posted code."}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1488194005, "post_id": 39093325, "comment_id": 72108095, "body": "it actually helped me do an $or query, I spent hours searching the net for it."}], "tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": true, "score": 3, "last_activity_date": 1471931612, "creation_date": 1471931612, "answer_id": 39093325, "question_id": 39084563, "link": "https://stackoverflow.com/questions/39084563/how-to-use-and-operator-in-haskell-mongodb-query/39093325#39093325", "title": "How to use \u201c$and\u201d operator in Haskell MongoDB query", "body": "<p>You have an unnecessary comma before \"db\" which is causing a type error.</p>\n\n<p>Try this:</p>\n\n<pre><code>myFilter = do\n   cursor &lt;- MongoDB.find (MongoDB.select [\"$and\" =: [[\"field1\" =: \"test1\"], [\"field2\" =: \"test2\"], [\"field3\" =: \"test3\"]]]  \"db\")\n   rest cursor\n</code></pre>\n\n<p>Note:</p>\n\n<ul>\n<li>you don't really need to use \"$and\" because it is the default.</li>\n<li>where you specify \"db\" is the name of a collection.</li>\n</ul>\n"}], "owner": {"reputation": 61, "user_id": 2931588, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93a9499a898bce63dd78f23826dfe02f?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/2931588/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 39093325, "answer_count": 1, "score": 0, "last_activity_date": 1471931612, "creation_date": 1471883650, "question_id": 39084563, "link": "https://stackoverflow.com/questions/39084563/how-to-use-and-operator-in-haskell-mongodb-query", "title": "How to use \u201c$and\u201d operator in Haskell MongoDB query", "body": "<p>I am trying to use \"$and\" operator in Haskell mongoDB which is not working:</p>\n\n<pre><code>myFilter = do\n   cursor &lt;- MongoDB.find (MongoDB.select [\"$and\" =: [[\"field1\" =: \"test1\"], [\"field2\" =: \"test2\"], [\"field3\" =: \"test3\"]]],  \"db\") \n   rest cursor\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "operators"], "comments": [{"owner": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "edited": false, "score": 0, "creation_date": 1471883755, "post_id": 39084551, "comment_id": 65517050, "body": "It is type context: <a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"nofollow noreferrer\">haskell.org/tutorial/classes.html</a>"}, {"owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "reply_to_user": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "edited": false, "score": 0, "creation_date": 1471884160, "post_id": 39084551, "comment_id": 65517256, "body": "@LeeDuhem Can you briefly explain what that means in simple terms? As someone who doesn&#39;t program in Haskell I&#39;m having trouble understanding the link you sent."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471884231, "post_id": 39084551, "comment_id": 65517298, "body": "This must be a duplicate, but I don&#39;t know how to find an older copy."}, {"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 3, "creation_date": 1471885662, "post_id": 39084551, "comment_id": 65518022, "body": "If you come from Java, a type class is a bit like an interface."}, {"owner": {"reputation": 14052, "user_id": 1004301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6aacd03deb37cb13cbc8b65e454f2b?s=128&d=identicon&r=PG", "display_name": "Lee Duhem", "link": "https://stackoverflow.com/users/1004301/lee-duhem"}, "edited": false, "score": 0, "creation_date": 1471939313, "post_id": 39084551, "comment_id": 65538037, "body": "Looks like your question has already been answered :-)"}], "answers": [{"comments": [{"owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471885720, "post_id": 39084785, "comment_id": 65518056, "body": "So are e &amp; m still inputs to this function? Or is it just Message? Or...both?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1471885812, "post_id": 39084785, "comment_id": 65518101, "body": "The input to this function is just a <code>Message</code>. The output is of any <code>m</code> type you choose, <i>so long as</i> <code>m</code> is an instance of the typeclass <code>MonadM e m</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471885835, "post_id": 39084785, "comment_id": 65518108, "body": "@Niko: they are <i>type-level arguments</i> of the function, if you will. But it&#39;s not necessarily helpful to look at it this way."}, {"owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471886017, "post_id": 39084785, "comment_id": 65518194, "body": "Okay I think I understand. My only question is how can you verify that m is of type MonadM e m if you don&#39;t know what e is? Or am I misinterpreting what &quot;e&quot; is"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471888807, "post_id": 39084785, "comment_id": 65519632, "body": "@Niko, you shouldn&#39;t need to worry about <code>e</code> here, because it seems to be irrelevant to <code>sendMessage</code>, though it&#39;s presumably important for some other operations. <code>e</code> will be fixed by whatever instance <code>m</code> has. You&#39;ll have to check the documentation or GHC to see if your particular <code>m</code> has an instance. Note also that <code>m</code> <i>is</i> a type, and does not have <i>type</i> <code>MonadM e m</code>, but rather <i>satisfies the constraint</i> <code>MonadM e m</code>."}, {"owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471891956, "post_id": 39084785, "comment_id": 65521187, "body": "@dfeuer That clears it up. Thanks for your patience."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1471884557, "creation_date": 1471884557, "answer_id": 39084785, "question_id": 39084551, "link": "https://stackoverflow.com/questions/39084551/what-does-the-sign-mean-in-haskell/39084785#39084785", "title": "What does the =&gt; sign mean in Haskell?", "body": "<p>The type signature</p>\n\n<pre><code>sendMessage :: MonadM e m =&gt; Message -&gt; m ()\n</code></pre>\n\n<p>can be read</p>\n\n<blockquote>\n  <p>Assuming that the constraint <code>MonadM e m</code> holds, <code>sendMessage</code> has type <code>Message -&gt; m ()</code></p>\n</blockquote>\n\n<p><code>MonadM</code> is (almost certainly) a multi-parameter type class with a functional dependency. Its definition probably looks vaguely like</p>\n\n<pre><code>class Monad m =&gt; MonadM e m | m -&gt; e where ....\n</code></pre>\n\n<p>You don't have to worry about that right now. Writing such classes is a somewhat advanced topic. But it expresses that some operations are available that relate the types <code>e</code> and <code>m</code>, where the type <code>e</code> is determined by the type <code>m</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471885897, "post_id": 39084901, "comment_id": 65518138, "body": "Thanks for the Hayoo reference; I&#39;ll totally be using that a ton. So, if I understand this correctly, anything before the =&gt; sign is just a type restriction to the matching input/output elements?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 1, "creation_date": 1471886501, "post_id": 39084901, "comment_id": 65518437, "body": "Basically yes. In fact it&#39;s often useful to disregard the constraints at first, and either consider an example instantiation or the unconstrained polymorphic function to figure out what&#39;s going on."}, {"owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "edited": false, "score": 0, "creation_date": 1471887603, "post_id": 39084901, "comment_id": 65519018, "body": "Got it. Thanks for your help."}, {"owner": {"reputation": 2540, "user_id": 1803897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921ed2f776bd064b49d8aadb378dd15a?s=128&d=identicon&r=PG", "display_name": "Roland Puntaier", "link": "https://stackoverflow.com/users/1803897/roland-puntaier"}, "edited": false, "score": 0, "creation_date": 1591025098, "post_id": 39084901, "comment_id": 109893414, "body": "<a href=\"https://hackage.haskell.org/package/hoogle\" rel=\"nofollow noreferrer\">hoogle</a> instead of <a href=\"https://hackage.haskell.org/package/Hayoo\" rel=\"nofollow noreferrer\">hayoo</a>, as the latter has no upload since 2012, and the link above is not reachable, either."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2540, "user_id": 1803897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921ed2f776bd064b49d8aadb378dd15a?s=128&d=identicon&r=PG", "display_name": "Roland Puntaier", "link": "https://stackoverflow.com/users/1803897/roland-puntaier"}, "edited": false, "score": 0, "creation_date": 1591026404, "post_id": 39084901, "comment_id": 109894075, "body": "@RolandPuntaier yes, thanks. Please don&#39;t hesitate to make such remarks directly as <i>edits</i> in the future."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 11, "last_activity_date": 1591026367, "last_edit_date": 1591026367, "creation_date": 1471884956, "answer_id": 39084901, "question_id": 39084551, "link": "https://stackoverflow.com/questions/39084551/what-does-the-sign-mean-in-haskell/39084901#39084901", "title": "What does the =&gt; sign mean in Haskell?", "body": "<p>First off: if you want to know what such and such operator does, don't ask StackOverflow, ask <a href=\"https://hoogle.haskell.org/?hoogle=%3D%3E\" rel=\"noreferrer\">Hoogle</a>!</p>\n\n<p>But in fact Hayoo is no use for <code>=&gt;</code> in particular because, unlike almost everything else in Haskell, this is built-in syntax and not an operator that's defined in some library.</p>\n\n<p>Your signature</p>\n\n<pre><code>sendMessage :: MonadM e m =&gt; Message -&gt; m ()\n</code></pre>\n\n<p>means the following: the type of <code>sendMessage</code> is <code>Message -&gt; m ()</code>, where <code>m</code> can be any monad that has an instance of the <code>MonadM</code> type class.</p>\n\n<p>That probably doesn't help you much, because in fact <code>MonadM</code> is a rather involved type class. Better consider a simpler example:</p>\n\n<pre><code>sum :: Num n =&gt; [n] -&gt; n\n</code></pre>\n\n<p>This means: the type of sum is <code>[n] -&gt; n</code>, where <code>n</code> can be any number type that's an instance of the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Num\" rel=\"noreferrer\"><code>Num</code></a> class, i.e. the class of types supporting subtraction, multiplication, obviously <em>addition</em> etc.. Actually the syntax is shorthand for</p>\n\n<pre><code>sum :: \u2200 n . Num n =&gt; [n] -&gt; n\n</code></pre>\n\n<p>meaning that <em>for all</em> types <code>n</code> which fulfill the constraint <code>Num n</code>, the function <code>sum</code> has the signature <code>[n] -&gt; n</code>.</p>\n\n<p>You can <em>instantiate</em> such a polymorphic function with any concrete number type: e.g.</p>\n\n<pre><code>sum :: [Int] -&gt; Int\n</code></pre>\n\n<p>In your example you'd probably instantiate it to something like</p>\n\n<pre><code>sendMessage :: Message -&gt; MessageT IO ()\n</code></pre>\n"}], "owner": {"reputation": 916, "user_id": 3686057, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a689d2dbba6a4372281439b89f6e565b?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/3686057/niko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 0, "accepted_answer_id": 39084901, "answer_count": 2, "score": 11, "last_activity_date": 1591026367, "creation_date": 1471883610, "question_id": 39084551, "link": "https://stackoverflow.com/questions/39084551/what-does-the-sign-mean-in-haskell", "title": "What does the =&gt; sign mean in Haskell?", "body": "<p>For some reason I can't find the answer to this anywhere. I tried Googling \"Haskell equal sign arrow\" and I'm not getting any results. Let's say we have the following function:</p>\n\n<pre><code>sendMessage :: MonadM e m =&gt; Message -&gt; m ()\nsendMessage message = do\n    mClient  &lt;- getMessageClient\n    liftIO $ send mClient message\n</code></pre>\n\n<p>Where exactly are e and m getting used? Are they being passed into the Message object (function?) and then outputted as a single type, m ()?</p>\n\n<p>I don't think it helps that I'm very new to Haskell, but any help is appreciated here.</p>\n"}, {"tags": ["algorithm", "haskell", "math", "number-theory", "integer-partition"], "comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1471880084, "post_id": 39083485, "comment_id": 65514897, "body": "<a href=\"https://en.wikipedia.org/wiki/Partition_(number_theory)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Partition_(number_theory)</a>"}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 160456, "user_id": 89391, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bb5230985aa2c9ea7d022d1a16890f16?s=128&d=identicon&r=PG", "display_name": "miku", "link": "https://stackoverflow.com/users/89391/miku"}, "edited": false, "score": 0, "creation_date": 1471880650, "post_id": 39083485, "comment_id": 65515277, "body": "@miku But in partitioning [1,2] and [2,1] are the same which is not what I want."}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 1166, "user_id": 3927528, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43998659fa10dfb488614ff3ae274595?s=128&d=identicon&r=PG&f=1", "display_name": "17slim", "link": "https://stackoverflow.com/users/3927528/17slim"}, "edited": false, "score": 0, "creation_date": 1471943086, "post_id": 39083485, "comment_id": 65540403, "body": "@17slim I already develop a haskell program which build all composition but I think it will take very long time to find a number."}, {"owner": {"reputation": 1166, "user_id": 3927528, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43998659fa10dfb488614ff3ae274595?s=128&d=identicon&r=PG&f=1", "display_name": "17slim", "link": "https://stackoverflow.com/users/3927528/17slim"}, "edited": false, "score": 0, "creation_date": 1471961124, "post_id": 39083485, "comment_id": 65553539, "body": "@AmirAghajanzadehGheshlaghi Fair enough, retracted my close vote."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "edited": false, "score": 0, "creation_date": 1471941978, "post_id": 39083925, "comment_id": 65539663, "body": "I already developed the software which can calculate the compositions but I think It&#39;s take too long because It has over 2^50 distinct composition."}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "reply_to_user": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "edited": false, "score": 0, "creation_date": 1471947781, "post_id": 39083925, "comment_id": 65543737, "body": "I don&#39;t know Haskell and cannot see whether memoization is realized right . My Delphi program with memoization works a millisecond for your example list and all N values up to 64 (max value to avoid long arithmetics) giving for N=64 result <code>8978045929416305555</code>"}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "edited": false, "score": 0, "creation_date": 1471949240, "post_id": 39083925, "comment_id": 65544654, "body": "Can you share your delphi sample?"}], "tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": true, "score": 1, "last_activity_date": 1471950131, "last_edit_date": 1471950131, "creation_date": 1471881422, "answer_id": 39083925, "question_id": 39083485, "link": "https://stackoverflow.com/questions/39083485/number-of-integer-composition-with-the-number-which-is-in-a-specific-list/39083925#39083925", "title": "Number of Integer Composition with the number which is in a specific list", "body": "<p>You can use dynamic programming to calculate the number of needed compositions.\nExample of recursive relation for your example:</p>\n\n<pre><code> P(4, [1,2]) = P(3, [1,2])  + P(2, [1,2])\n</code></pre>\n\n<p>here <code>P(N, [list])</code> is the number of variants to make N from the list</p>\n\n<p>Try to generalize formulas and use top-down memoization or bottom-up table filling DP to quickly find the result.</p>\n\n<p>Delphi example:</p>\n\n<pre><code>var\n  A: TArray&lt;Integer&gt;;\n  Mem: TArray&lt;Int64&gt;;\n  N, i: Integer;\n\n  function Calc(N: Integer): Int64;\n  var\n    i: Integer;\n  begin\n    if Mem[N] &gt;= 0 then\n      Exit(Mem[N]);\n\n    i := 0;\n    Result := 0;\n    while A[i] &lt;= N do begin\n      Result := Result + Calc(N - A[i]);\n      Inc(i);\n    end;\n    Mem[N] := Result;\n  end;\n\nbegin\n  //should be sorted\n  //-1 - sentinel value to stop\n  A := TArray&lt;Integer&gt;.Create(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 30, 40, 50, 60,\n    70, 80, 90, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, -1);\n  for N := 10 to 64 do begin\n    SetLength(Mem, N + 1);\n    for i := 1 to N do\n      Mem[i] := -1; //not initialized yet\n    Mem[0] := 1;\n    Memo1.Lines.Add(Format('%d   %d', [N, Calc(N)]));\n  end;\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 1, "accepted_answer_id": 39083925, "answer_count": 1, "score": 1, "last_activity_date": 1471950131, "creation_date": 1471879931, "last_edit_date": 1471945951, "question_id": 39083485, "link": "https://stackoverflow.com/questions/39083485/number-of-integer-composition-with-the-number-which-is-in-a-specific-list", "title": "Number of Integer Composition with the number which is in a specific list", "body": "<p>Each positive integer n has 2^(n\u22121) distinct compositions. what If I want the number of composition which is only have specific number which is in my list:</p>\n\n<p>for example composition of 4 is</p>\n\n<pre><code>4\n3 1\n1 3\n2 2\n2 1 1\n1 2 1\n1 1 2\n1 1 1 1\n</code></pre>\n\n<p>but if I want the number of composition of 4 which it has only 1 and 2,\nHow could I calculate the NUMBER of distinct compositions?</p>\n\n<pre><code>2 2\n2 1 1\n1 2 1\n1 1 2\n1 1 1 1\n</code></pre>\n\n<p><strong>Edited:</strong>\nHere Haskell code which calculate the number, But I think It takes too long even IF I add memorization for Number 70</p>\n\n<pre><code>main :: IO ()\nmain = do\n     putStrLn \"Enter the integer number\"\n     num' &lt;- getLine\n     let num = read num' :: Int\n     putStr \"\"\n     let result= composition num\n     let len=length result\n     print len\n      --print result\n\ncomposition 0 = [[]]\ncomposition n = [x:rest | x &lt;- [1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1000],x&lt;=n ,rest &lt;- composition (n-x)]\n</code></pre>\n"}, {"tags": ["list", "haskell", "recursion", "types", "type-mismatch"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1471876975, "post_id": 39082382, "comment_id": 65512668, "body": "If the type of <code>[x1]</code> is <code>[a]</code>, then what is the type of <code>[x1]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 1, "last_activity_date": 1471877282, "creation_date": 1471877282, "answer_id": 39082571, "question_id": 39082382, "link": "https://stackoverflow.com/questions/39082382/type-error-with-recursion/39082571#39082571", "title": "Type error with recursion", "body": "<p><code>[]</code>, <code>[x1]</code>, <code>[x1, x2]</code> and <code>[[x1, x2], (test xs)]</code> all must have the same type to be possible values of the same function. I think you wanted <code>[[x1]]</code> in the second case and <code>[[x1, x2]]</code> in the third, because in those two cases there is exactly one chunk of length at most two. Note that you don't even need the third case because it is covered by the fourth for <code>xs</code> = <code>[]</code>. Also you can skip implementing this function by importing <code>Data.List.Split</code> and using its <code>chunksOf 2</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "edited": false, "score": 0, "creation_date": 1471912650, "post_id": 39083053, "comment_id": 65529129, "body": "That really make sense. Thanks a lot!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1471878580, "creation_date": 1471878580, "answer_id": 39083053, "question_id": 39082382, "link": "https://stackoverflow.com/questions/39082382/type-error-with-recursion/39083053#39083053", "title": "Type error with recursion", "body": "<p>It's usually preferred in Haskell to just write different clauses of a function \u2013 this does the same thing as <code>case</code>, but is often better readable. Also, please don't give your functions names like <code>test</code>!</p>\n\n<p>Better like this:</p>\n\n<pre><code>chunks\u00c02 :: [a] -&gt; [[a]]\nchunks\u00c02 [] = []\nchunks\u00c02 [x1] = [x1]\nchunks\u00c02 [x1,x2] = [x1,x2]\nchunks\u00c02 (x1:x2:xs) = [[x1,x2], chunks\u00c02 xs]\n</code></pre>\n\n<p>Now, each of these clauses must typecheck independently. I'll start with the second:</p>\n\n<pre><code>chunks\u00c02 [x1] = [x1]\n</code></pre>\n\n<p>Hm. The signature says that the result should be a nested list and the input a simple list. So surely, you actually mean this:</p>\n\n<pre><code>chunks\u00c02 [x1] = [[x1]]\n</code></pre>\n\n<p>That is a list whose only element is a list with one element.</p>\n\n<p>Similar for the next clause: </p>\n\n<pre><code>chunks\u00c02 [x1,x2] = [[x1,x2]]\n</code></pre>\n\n<p>Note that</p>\n\n<pre><code>chunks\u00c02 [x1,x2] = [[x1],[x2]]\n</code></pre>\n\n<p>would also be possible. (Exercise: why is that not what you want?)</p>\n\n<p>Where it gets interesting is in the recursive clause. You've correctly popped the first two elements from the input list with the pattern matching <code>x1:x2:xs</code>. Now you need to reassemble them. <code>[x1,x2]</code> is right at the first element of the result list, but then? <code>chunks\u00c02 xs</code> has type <code>[[a]]</code>, so if you put it in another <code>[]</code> you'd have the type <code>[[[a]]]</code>. That's clearly too much wrapping!</p>\n\n<p>Instead, you only want to <em>prepend</em> <code>[x1,x2]</code> to <code>chunks\u00c02 xs</code>. Well, use the cons operator, the same you also used for the pattern match:</p>\n\n<pre><code>chunks\u00c02 (x1:x2:xs) = [x1,x2] : chunks\u00c02 xs\n</code></pre>\n\n<p>Finally, the empty clause. That actually works the way you've wrote it, but do you know why? Note that <code>[]</code> can have the type of any list you like:</p>\n\n<pre><code>Prelude&gt; [] :: [Int]\n[]\nPrelude&gt; [] :: [String]\n[]\nPrelude&gt; [] :: [[(Double,[Maybe Bool])]]\n[]\n</code></pre>\n\n<p>in</p>\n\n<pre><code>chunks\u00c02 [] = []\n</code></pre>\n\n<p>you actually have</p>\n\n<pre><code>chunks\u00c02 ([] :: [a]) = [] :: [[a]]\n</code></pre>\n\n<p>You could have also written</p>\n\n<pre><code>chunks\u00c02 [] = [[]]\n</code></pre>\n\n<p>but that wouldn't do the right thing.</p>\n"}], "owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 39083053, "answer_count": 2, "score": 0, "last_activity_date": 1475885933, "creation_date": 1471876783, "last_edit_date": 1475885933, "question_id": 39082382, "link": "https://stackoverflow.com/questions/39082382/type-error-with-recursion", "title": "Type error with recursion", "body": "<p>I want to pick every two elements form a list to make a new list, then I get an error like this:</p>\n\n<pre><code>test.hs:4:20: error:\n? Couldn't match expected type \u2018[a]\u2019 with actual type \u2018a\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n    the type signature for:\n      test :: forall a. [a] -&gt; [[a]]\n    at test.hs:1:7\n? In the expression: x1\n  In the expression: [x1]\n  In a case alternative: [x1] -&gt; [x1]\n? Relevant bindings include\n    x1 :: a (bound at test.hs:4:6)\n    list :: [a] (bound at test.hs:2:6)\n    test :: [a] -&gt; [[a]] (bound at test.hs:2:1)\n</code></pre>\n\n<p>and here is my code:</p>\n\n<pre><code>test::[a]-&gt;[[a]]\ntest list = case list of\n    []          -&gt;[]\n    [x1]        -&gt;[x1]\n    [x1,x2]     -&gt;[x1,x2]\n    x1:x2:xs    -&gt;[[x1,x2],(test xs)]\n</code></pre>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1471882306, "post_id": 39082041, "comment_id": 65516281, "body": "Enable more warnings with <code>-Wall</code>: in this case the shadowing of the global binding with the local one should also be reported, providing further insight on your issue."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471891519, "post_id": 39082041, "comment_id": 65520986, "body": "<code>TypeRep</code> is supposed to get a big shake-up in GHC 8.2. If that happens, you&#39;ll probably find it far more useful than now."}], "answers": [{"comments": [{"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1471877601, "post_id": 39082443, "comment_id": 65513135, "body": "Thanks. By any chance would you happen to know if there is a way to refer to &quot;the global constant of the same name&quot; in the code for TypeReps? Is there any TypeRep litterals? Eg &quot;Typeable.Int&quot;, &quot;Typeable.Bool&quot;? I can&#39;t see any in the docs (<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Typeable.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.0.0/docs/&hellip;</a>). I think that&#39;d allow me to keep the pattern matching function. Otherwise I&#39;ll stick with func4 style."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 1, "creation_date": 1471879462, "post_id": 39082443, "comment_id": 65514482, "body": "Nope, no hope for that avenue - <code>TypeRep</code> is purposefully opaque (no constructors exported). Really <code>func4</code> is your best bet for this. :)"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1471890063, "last_edit_date": 1471890063, "creation_date": 1471876915, "answer_id": 39082443, "question_id": 39082041, "link": "https://stackoverflow.com/questions/39082041/issues-with-pattern-matching-and-case-expression-over-data-typeable-typerep/39082443#39082443", "title": "Issues with pattern matching and case expression over Data.Typeable.TypeRep", "body": "<p>The issue is that <code>tyI</code> and <code>tyD</code> are being considered as ordinary variables (as opposed to being compared to the global constants of the same name) in the pattern match. The code below is completely equivalent to yours.</p>\n\n<pre><code>func1 :: TypeRep -&gt; Bool\nfunc1 x = False\nfunc1 y = False\nfunc1 _ = True\n\nfunc2 :: TypeRep -&gt; Bool\nfunc2 tr = case tr of\n    x -&gt; False\n    y -&gt; False\n    _ -&gt; True\n</code></pre>\n\n<p>As you've observed in <code>func3</code>, the way to solve this is to make the comparison explicit. You could also do it with guards:</p>\n\n<pre><code>func4 :: TypeRep -&gt; Bool\nfunc4 tr | tr == tyI = False\n         | tr == tyD = False\n         | otherwise = True\n</code></pre>\n\n<hr>\n\n<p>In general, the only things permitted on the left hand side of the equals against which you can pattern match are constructors. The one exception is number literals, and you'll notice that using these in patterns incurs an <code>Eq</code> constraint on the function as a whole</p>\n\n<pre><code>even :: (Num a, Eq a) =&gt; a -&gt; Bool\neven 0 = True\neven 1 = False\neven n = even (n-2)\n</code></pre>\n\n<p>Similar exceptions to this rule are added if you add <code>OverloadedLists</code> and <code>OverloadedStrings</code>. The rule still holds for almost all cases.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1471876916, "creation_date": 1471876916, "answer_id": 39082444, "question_id": 39082041, "link": "https://stackoverflow.com/questions/39082041/issues-with-pattern-matching-and-case-expression-over-data-typeable-typerep/39082444#39082444", "title": "Issues with pattern matching and case expression over Data.Typeable.TypeRep", "body": "<p>The <code>tyI</code> here:</p>\n\n<pre><code>func1 :: TypeRep -&gt; Bool\nfunc1 tyI = False\n</code></pre>\n\n<p>has nothing to do with the <code>tyI</code> defined here:</p>\n\n<pre><code>tyI = typeOf (1    :: Int)\n</code></pre>\n\n<p>In fact, your definition of <code>func1</code> could have been written:</p>\n\n<pre><code>func1 :: TypeRep -&gt; Bool\nfunc1 x = False\n</code></pre>\n\n<p>And the same holds for <code>func2</code> - the variables <code>tyI</code>, <code>tyB</code> and <code>tyD</code> there are just pattern variable names and do not refer to your global bindings.</p>\n\n<p>However, your use of <code>tyI</code> and <code>tyD</code> in <code>func3</code> do refer to the global definitions, so that's why <code>func3 tyB</code> returns True.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 39082443, "answer_count": 2, "score": 0, "last_activity_date": 1471890063, "creation_date": 1471875846, "question_id": 39082041, "link": "https://stackoverflow.com/questions/39082041/issues-with-pattern-matching-and-case-expression-over-data-typeable-typerep", "title": "Issues with pattern matching and case expression over Data.Typeable.TypeRep", "body": "<p>I am trying to pattern match on Data.Typeable.TypeRep in the following code:</p>\n\n<pre><code>import Data.Typeable (TypeRep, typeOf)\n\ntyI = typeOf (1    :: Int)\ntyD = typeOf (3.14 :: Double)\ntyB = typeOf (True :: Bool)\n\nfunc1 :: TypeRep -&gt; Bool\nfunc1 tyI = False\nfunc1 tyD = False\nfunc1 _ = True\n\nfunc2 :: TypeRep -&gt; Bool\nfunc2 tr = case tr of\n    tyI -&gt; False\n    tyD -&gt; False\n    _   -&gt; True\n\nfunc3 :: TypeRep -&gt; Bool\nfunc3 tr = if tr == tyI then False else\n           if tr == tyD then False else\n           True\n</code></pre>\n\n<p>... and I get these warnings on compilation:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( /home/[..]/test.hs, interpreted )\n\n/home/[..]/test.hs:8:1: Warning:\n    Pattern match(es) are overlapped\n    In an equation for \u2018func1\u2019:\n        func1 tyD = ...\n        func1 _ = ...\n\n/home/[..]/test.hs:23:12: Warning:\n    Pattern match(es) are overlapped\n    In a case alternative:\n        tyD -&gt; ...\n        _ -&gt; ...\nOk, modules loaded: Main.\n</code></pre>\n\n<p>Also, I get the surprising results:</p>\n\n<pre><code>*Main&gt; func1 tyI\nFalse\n*Main&gt; func1 tyD\nFalse\n*Main&gt; func1 tyB\nFalse -- !!!\n\n*Main&gt; func2 tyI\nFalse\n*Main&gt; func2 tyD\nFalse\n*Main&gt; func2 tyB\nFalse -- !!!\n\n*Main&gt; func3 tyI\nFalse\n*Main&gt; func3 tyD\nFalse\n*Main&gt; func3 tyB\nTrue -- Ok!\n</code></pre>\n\n<p>So only the last function func3 seems to produce the expected results. What should I do to use the pattern matching (func1) and case (func2) functions to work properly over TypeReps?</p>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1471874360, "post_id": 39081456, "comment_id": 65510656, "body": "Where did you find that one is a lazy version of the other?  We should correct or remove this resource as it is wrong."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1471874529, "post_id": 39081456, "comment_id": 65510801, "body": "<code>f &gt;=&gt; g = \\x -&gt; f x &gt;&gt;= g</code>"}, {"owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "edited": false, "score": 0, "creation_date": 1471874545, "post_id": 39081456, "comment_id": 65510813, "body": "Hi Thomas,   please look this frame <a href=\"https://youtu.be/2jdJGdA7AYs?t=3m30s\" rel=\"nofollow noreferrer\">youtu.be/2jdJGdA7AYs?t=3m30s</a>"}, {"owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1471874936, "post_id": 39081456, "comment_id": 65511129, "body": "@Thomas these things used in the same context in this video but I didn&#39;t understand explanation, so I am posting here"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1471874960, "post_id": 39081456, "comment_id": 65511139, "body": "@venugangireddy That video is talking about lazy IO and when actions are taken (such as reading a file, computing values, and closing handles).  The interesting thing in the video is not the operators you are focused on but <code>print</code> happening within the scope of <code>withFile</code> vs afterwards."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471875088, "post_id": 39081456, "comment_id": 65511236, "body": "The lazyness-difference between <code>withX (h &gt;=&gt; p)</code> and <code>withX h &gt;&gt;= p</code> in some application has nothing to do with the difference between <code>&gt;=&gt;</code> and <code>&gt;&gt;=</code>. It&#39;s the same way <code>fmap g $!! fmap f $ x</code> and <code>fmap (g . f) $!! x</code> are different."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "edited": false, "score": 0, "creation_date": 1471876204, "post_id": 39081792, "comment_id": 65512109, "body": "Thanks Dietrich, Is there any name for this operator?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 12, "creation_date": 1471876714, "post_id": 39081792, "comment_id": 65512518, "body": "The informal name is the fish operator; formally, it is the left-to-right Kleisli composition operator. (Functions of the form <code>a -&gt; m b</code> are called Kleisli arrows, a concept from category theory.)"}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 12, "last_activity_date": 1471875120, "creation_date": 1471875120, "answer_id": 39081792, "question_id": 39081456, "link": "https://stackoverflow.com/questions/39081456/difference-between-and/39081792#39081792", "title": "difference between (&gt;&gt;=) and (&gt;=&gt;)", "body": "<p>The <code>(&gt;=&gt;)</code> function is kind of like <code>(.)</code>, but instead of working with <code>a -&gt; b</code>, it works with <code>a -&gt; m b</code>.</p>\n\n<pre><code>-- Ask the user a question, get an answer.\npromptUser :: String -&gt; IO String\npromptUser s = putStrLn s &gt;&gt; getLine\n\n-- note: readFile :: String -&gt; IO String\n\n-- Ask the user which file to read, return the file contents.\nreadPromptedFile :: String -&gt; IO String\nreadPromptedFile = promptUser &gt;=&gt; readFile\n\n-- Ask the user which file to read,\n-- then print the contents to standard output\nmain = readPromptedFile \"Read which file?\" &gt;&gt;= putStr\n</code></pre>\n\n<p>This is a bit contrived but it illustrates <code>(&gt;=&gt;)</code>.  Like <code>(.)</code>, you don't <em>need</em> it, but it is generally useful for writing programs in the point-free style.</p>\n\n<p>Note that <code>(.)</code> has the opposite argument order from <code>(&gt;=&gt;)</code>, but there is also <code>(&lt;=&lt;)</code> which is <code>flip (&gt;=&gt;)</code>.</p>\n\n<pre><code>readPromptedFile = readFile &lt;=&lt; promptUser\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 6743841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294832dd90389a3d25f99f2d92139214?s=128&d=identicon&r=PG&f=1", "display_name": "venu gangireddy", "link": "https://stackoverflow.com/users/6743841/venu-gangireddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 3, "accepted_answer_id": 39081792, "answer_count": 1, "score": 8, "last_activity_date": 1471875120, "creation_date": 1471874178, "last_edit_date": 1471874707, "question_id": 39081456, "link": "https://stackoverflow.com/questions/39081456/difference-between-and", "title": "difference between (&gt;&gt;=) and (&gt;=&gt;)", "body": "<p>I need some clarification regarding (>>=) and (>=>).</p>\n\n<pre><code>*Main Control.Monad&gt; :type (&gt;&gt;=)                                                                                                                                                               \n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b                                                                                                                                                \n*Main Control.Monad&gt; :type (&gt;=&gt;)                                                                                                                                                               \n(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c \n</code></pre>\n\n<p>I know about bind operator(>>=) but I am not getting the context where (>=>) is useful. Please explain with simple toy example.</p>\n\n<p>Edit : Correcting based on @Thomas comments</p>\n"}, {"tags": ["haskell", "fractals"], "comments": [{"owner": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "edited": false, "score": 1, "creation_date": 1471873270, "post_id": 39081074, "comment_id": 65509823, "body": "How will it take millions of iterations if you cap the number of iterations at 255?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471873690, "post_id": 39081074, "comment_id": 65510137, "body": "<code>genericLength</code> is (or <i>was</i>?) a somewhat silly experiment at comparing lengths with lazy number types, and horribly inefficient. In practice, it is always better to just use <code>length</code> (though of course checking lengths <i>at all</i> is best avoided)."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1471875137, "post_id": 39081074, "comment_id": 65511280, "body": "How are you compiling it? Have you tried profiling?"}, {"owner": {"reputation": 3, "user_id": 6743164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b3b813923ddb8685701f7f5db733cc?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/6743164/matt"}, "reply_to_user": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "edited": false, "score": 0, "creation_date": 1471876181, "post_id": 39081074, "comment_id": 65512094, "body": "@Glubus each use of <code>iter</code> is on a pixel in a picture... so max number of iterations is <code>255 * height * width</code>"}, {"owner": {"reputation": 3, "user_id": 6743164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b3b813923ddb8685701f7f5db733cc?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/6743164/matt"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471876208, "post_id": 39081074, "comment_id": 65512115, "body": "@leftaroundabout thanks, I will keep that in mind."}, {"owner": {"reputation": 3, "user_id": 6743164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b3b813923ddb8685701f7f5db733cc?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/6743164/matt"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1471876379, "post_id": 39081074, "comment_id": 65512271, "body": "@MathematicalOrchid   <code>ghc --make -O2 -threaded</code>.  <code>threaded</code> because I am using <code>repa</code> to build a plot.  <code>iter1</code> is about 1.5x slower than <code>iter2</code>"}, {"owner": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "edited": false, "score": 0, "creation_date": 1471876496, "post_id": 39081074, "comment_id": 65512373, "body": "You can also just lower the maximum allowed iterations. You&#39;re right when you say this is going to take a lot of iterations, but that&#39;s pretty much required for what you&#39;re trying to do. Im not sure if it&#39;s possible, (because I&#39;m not too familiar with this specific function) use some sort of heuristic to predict whether or not the current pixel is going to hit the cap, and decrease the cap in that scenario (lots of fractals have big areas that all fall over the threshhold)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6743164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b3b813923ddb8685701f7f5db733cc?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/6743164/matt"}, "edited": false, "score": 0, "creation_date": 1471943270, "post_id": 39083144, "comment_id": 65540523, "body": "wow, I didn&#39;t realise the cost of using the Complex data type. I removed <code>Data.Complex</code> from my module and did all calculations manually and my program went from 1.6s run time for 1920x1080 to 0.2s. Thanks. I guess I should learn how to use <code>Criterion</code> too."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 0, "last_activity_date": 1471879645, "last_edit_date": 1471879645, "creation_date": 1471878854, "answer_id": 39083144, "question_id": 39081074, "link": "https://stackoverflow.com/questions/39081074/haskell-julia-set-function/39083144#39083144", "title": "Haskell: Julia Set function", "body": "<p>For a loop like this handcrafted recursion usually is the best approach.</p>\n\n<p>Here is a comparison of three implementations:</p>\n\n<ul>\n<li>iter1 - original code</li>\n<li>iter2 - handcrafted recursion</li>\n<li>iter3 - @Alec's solution</li>\n</ul>\n\n<p>The timings are (with <code>-O2</code>):</p>\n\n<pre><code>benchmarking julia/1\ntime                 17.30 \u03bcs   (17.06 \u03bcs .. 17.56 \u03bcs)\n                     0.995 R\u00b2   (0.991 R\u00b2 .. 0.998 R\u00b2)\nmean                 17.79 \u03bcs   (17.37 \u03bcs .. 18.51 \u03bcs)\nstd dev              1.839 \u03bcs   (1.008 \u03bcs .. 3.285 \u03bcs)\nvariance introduced by outliers: 86% (severely inflated)\n\nbenchmarking julia/2\ntime                 1.456 \u03bcs   (1.448 \u03bcs .. 1.466 \u03bcs)\n                     0.999 R\u00b2   (0.999 R\u00b2 .. 1.000 R\u00b2)\nmean                 1.457 \u03bcs   (1.444 \u03bcs .. 1.470 \u03bcs)\nstd dev              42.03 ns   (34.14 ns .. 54.37 ns)\nvariance introduced by outliers: 38% (moderately inflated)\n\nbenchmarking julia/3\ntime                 13.53 \u03bcs   (13.35 \u03bcs .. 13.69 \u03bcs)\n                     0.999 R\u00b2   (0.998 R\u00b2 .. 0.999 R\u00b2)\nmean                 13.42 \u03bcs   (13.26 \u03bcs .. 13.58 \u03bcs)\nstd dev              550.8 ns   (445.3 ns .. 768.8 ns)\nvariance introduced by outliers: 50% (moderately inflated)\n</code></pre>\n\n<p>I think the main reason why <code>iter2</code> is better is because it avoids\nallocating Complex values. In any case it does a lot fewer allocations.</p>\n\n<p>Code follows:</p>\n\n<pre><code>import Data.List\nimport Data.Ratio\nimport Data.Complex\nimport Criterion\nimport Criterion.Main\n\niter1 :: Double -&gt; Double -&gt; Complex Double -&gt; Int\niter1 a b = genericLength . take 255 . takeWhile ((&lt;=2) . magnitude) . iterate f\n  where\n   f z = z * z - (a :+ b)\n\niter2 :: Double -&gt; Double -&gt; Complex Double -&gt; Int\niter2 a b (x :+ y) =  loop 0 x y\n  where\n    loop n x y\n      | n &gt; 255 || x*x + y*y &gt; 4 = n\n    loop n x y = loop (n+1)  (x*x-y*y-a) (2*x*y-b)\n\niter3 :: Double -&gt; Double -&gt; Complex Double -&gt; Int\niter3 a b z = fst $ until (\\(n,z) -&gt; magnitude z &gt; 2 || n == 255)\n                        (\\(n,z) -&gt; (n+1,f z))\n                        (0,z)\n  where\n   f z = z * z - (a :+ b)\n\n-- should give 101 iterations\nz0 = 7.396147400000001e-3 :+ 0.6418972592000001\n\nmain = defaultMain [\n  bgroup \"julia\"\n    [\n      bench \"3\"  $ whnf (iter3 (negate 0.40) 0.65) z0\n    , bench \"2\"  $ whnf (iter2 (negate 0.40) 0.65) z0\n    , bench \"1\"  $ whnf (iter1 (negate 0.40) 0.65) z0\n    ]\n  ]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6743164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b3b813923ddb8685701f7f5db733cc?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/6743164/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "accepted_answer_id": 39083144, "answer_count": 1, "score": 0, "last_activity_date": 1471879645, "creation_date": 1471873003, "question_id": 39081074, "link": "https://stackoverflow.com/questions/39081074/haskell-julia-set-function", "title": "Haskell: Julia Set function", "body": "<p>I am trying to write a function that returns the length of a Julia Set where before it passes a certain threshold, 2, with a maximum number of iterations of 255.</p>\n\n<p>i have function <code>f z = z * z - (a :+ b)</code> I iterate this function over a complex number until the <code>magnitude</code> of <code>a + bi</code> crosses 2 and then count the number of iterations it took.</p>\n\n<p>my first attempt was</p>\n\n<p><code>iter1 = genericLength . take 255 . takeWhile ((&lt;=2) . magnitude) . iterate f</code></p>\n\n<p>but it is painfully slow. </p>\n\n<p>my second attempt is </p>\n\n<pre><code>iters2 x y = iters2' f ((&lt;=2) . magnitude) (a :+ b)\niters2' f' p c = len c 0\n  where\n    len c acc = if p c &amp;&amp; acc &lt; 255 then len (f' c) (acc + 1) else acc\n</code></pre>\n\n<p>This is still slow, considering that I will have to do millions of iterations.</p>\n\n<p>Can someone help with how to make this faster?</p>\n\n<p>Also,  is there <code>list fusion</code> built into the <code>Prelude</code> list functions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 2, "creation_date": 1471872010, "post_id": 39080419, "comment_id": 65508936, "body": "This code does not compile, I get the error :       Could not deduce (Num (Poly a)) arising from a use of `sum&#39;"}, {"owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "reply_to_user": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471880019, "post_id": 39080419, "comment_id": 65514845, "body": "now it should, i didn&#39;t include the <code>plus</code> function"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471880264, "post_id": 39080419, "comment_id": 65515022, "body": "That doesn&#39;t make any difference, <code>sum</code> actually needs a <code>Num</code> instance."}, {"owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "edited": false, "score": 0, "creation_date": 1471881183, "post_id": 39080419, "comment_id": 65515613, "body": "Ok, now it definitely does."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471882359, "post_id": 39080419, "comment_id": 65516301, "body": "btw - there is a bug in your definition of <code>plus</code> - e.g. try <code>plus (P [1]) (P [2,3])</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471883082, "post_id": 39080419, "comment_id": 65516676, "body": "You should have <code>negate (P cs) = P (map negate cs)</code> and <code>fromInteger x = [x]</code>. These are entirely straightforward for polynomials."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471885526, "post_id": 39080419, "comment_id": 65517960, "body": "Your instance is invalid.  Neither <code>abs</code>, <code>fromInteger</code>, nor <code>signum</code> are optional, and while you can omit a definition of <code>negate</code> as long as you provide a definition for <code>(-)</code>, you can&#39;t explicitly leave it undefined."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471889378, "post_id": 39080419, "comment_id": 65519939, "body": "@chepner, <code>abs</code> and <code>signum</code> don&#39;t seem sensible in this context. The rest can be fixed easily."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471892837, "post_id": 39080419, "comment_id": 65521658, "body": "I&#39;d argue that abusing <code>Num</code> like this is no better than doing the same thing so that we could &quot;add&quot; two lists rather than defining the <code>(++)</code> operator."}, {"owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "edited": false, "score": 0, "creation_date": 1471950816, "post_id": 39080419, "comment_id": 65545732, "body": "What would be a good Type for polynomials other than <code>Num</code>, I&#39;m doing this because I&#39;m learning Haskell on my own with the CIS 194 course and that is the set up for one of the homeworks."}], "answers": [{"comments": [{"owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "edited": false, "score": 1, "creation_date": 1471951719, "post_id": 39084014, "comment_id": 65546335, "body": "I think it should be <code>fromInteger x = P [fromInteger x]</code>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1471952239, "last_edit_date": 1471952239, "creation_date": 1471881722, "answer_id": 39084014, "question_id": 39080419, "link": "https://stackoverflow.com/questions/39080419/undefined-error-on-defined-function/39084014#39084014", "title": "Undefined error on defined function", "body": "<p>Clearly you are calling one of the <code>undefined</code> methods in the Num instance for Poly.</p>\n\n<p>You can determine which one is being called by using these definitions:</p>\n\n<pre><code>negate      = error \"Poly negate undefined\"\nfromInteger = error \"Poly fromInteger undefined\"\nabs    = error \"Poly abs undefined\"\nsignum = error \"Poly signum undefined\"\n</code></pre>\n\n<p>Running your test expression yields:</p>\n\n<pre><code>Poly *** Exception: Poly fromInteger undefined\n</code></pre>\n\n<p>The problem is in your use of <code>sum</code> which is essentially defined as:</p>\n\n<pre><code>sum xs = foldl (+) 0 xs\n</code></pre>\n\n<p>It is therefore calling <code>fromInteger 0</code>. You can fix this with:</p>\n\n<pre><code>fromInteger x = P [ fromInteger x ]\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>The reason <code>fromInteger</code> for <code>Poly a</code> needs to be defined this way is\nbecause we need to construct a list of <code>Num a</code> values, and <code>fromInteger x</code>\nis the way to create a <code>Num a</code> from the Integer value <code>x</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471883753, "post_id": 39084141, "comment_id": 65517049, "body": "Polynomials form rings, which is more than you can say for floating point representations, and are even commutative under rather weak conditions. The <code>Num</code> class has no laws to speak of, so I don&#39;t really see a problem with the OP&#39;s instance."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471884260, "post_id": 39084141, "comment_id": 65517314, "body": "I agree: this instance <i>is</i> sensible, though I&#39;m generally a big critic of giving types a <code>Num</code> instance if they aren&#39;t really number types. Nevertheless, +1 if only because it&#39;s always good to remind yourself how you can get along without type classes. But... surely it should be <code>foldl&#39;</code>?"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 1, "creation_date": 1471884793, "post_id": 39084141, "comment_id": 65517587, "body": "Num has methods <code>abs :: a -&gt; a</code> and <code>signum :: a -&gt; a</code>, which are not defined for polynomials."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471885177, "post_id": 39084141, "comment_id": 65517786, "body": "Besides, <code>foldl&#39;</code> is more efficient here indeed."}, {"owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471950904, "post_id": 39084141, "comment_id": 65545795, "body": "@leftaroundabout what would you have used instead of <code>Num</code>, this is the set up from a homework file (I&#39;m teaching myself haskell using the CIS 194 course)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "edited": false, "score": 0, "creation_date": 1471958455, "post_id": 39084141, "comment_id": 65551338, "body": "@Liumx31: for many types, <a href=\"http://hackage.haskell.org/package/vector-space-0.10.2/docs/Data-VectorSpace.html\" rel=\"nofollow noreferrer\"><code>VectorSpace</code></a> is an excellent abstraction: addition and scaling are perfectly natural, but vector\u2295vector\u2192vector multiplication is usually not quite well-defined (it depends on a choice of basis). In the case of polynomials, multiplication is clear and unambiguous though, hence I&#39;d say the <code>Num</code> instance is ok. (Though indeed <code>abs</code> and <code>signum</code> are problematic \u2013 you could actually define these by e.g. integration over the unit interval, but that&#39;s not natural anymore)."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1471959345, "post_id": 39084141, "comment_id": 65552066, "body": "Use class Data.Algebra.Ring to get an addition and a multiplication."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1471959456, "post_id": 39084141, "comment_id": 65552146, "body": "@Semeria: to make that concrete: I&#39;d propose the definition <code>abs f = \u221a( \u2080\u222b&#185; d\ud835\udc65 (f \ud835\udc65)&#178; )</code> and <code>signum f = f &#47; \u221a( \u2080\u222b&#185; d\ud835\udc65 (f \ud835\udc65)&#178; )</code>. That fulfills: <b>1.</b> <code>abs f \u2261 realToFrac n</code> for some <code>n \u2265 0</code> (with <code>n==0</code> iff <code>f==0</code>) <b>2.</b> <code>abs (signum f) \u2261 1</code> for all <code>f \u2260 0</code> <b>3.</b> <code>abs f * signum f == f</code>. So IMO that would be a fine <code>Num</code> instance, quite useful and efficient to compute, though it&#39;s not completely natural."}], "tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": true, "score": 2, "last_activity_date": 1471889379, "last_edit_date": 1471889379, "creation_date": 1471882142, "answer_id": 39084141, "question_id": 39080419, "link": "https://stackoverflow.com/questions/39080419/undefined-error-on-defined-function/39084141#39084141", "title": "Undefined error on defined function", "body": "<p>A polynomial is not really a Num, although there is a ring monomorphism <code>Num a =&gt; a -&gt; Poly a</code>.</p>\n\n<p>Discard that Num instance and use <code>foldl plus</code> instead of <code>sum</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1472060226, "last_edit_date": 1472060226, "creation_date": 1471890446, "answer_id": 39086333, "question_id": 39080419, "link": "https://stackoverflow.com/questions/39080419/undefined-error-on-defined-function/39086333#39086333", "title": "Undefined error on defined function", "body": "<p>I'm going to take the position that you should not define an instance of a class simply to hijack the class's functions. The minimal definition of a <code>Num</code> instance expects certain functions to be defined; explicitly assigning <code>undefined</code> to those names does not qualify as a definition. Consider that Haskell provides a specific operator <code>(++)</code> for list concatenation instead of simply overloading <code>(+)</code> with an instance like</p>\n\n<pre><code>instance Num [a] where\n    a + [] = a\n    [] + b = b\n    (a:as) + b = a:(as + b)\n    (*) = undefined\n    negate = undefined\n    -- etc\n</code></pre>\n\n<hr>\n\n<p>Instead, define a class that <em>does</em> provide the operations you want. In this case, you want a <code>Ring</code>, which is a type along with two operations, addition and multipication, that obey certain laws. (Put briefly, the operations act as you would expect given the integers as an example, except multiplication is not required to be commutative.)</p>\n\n<p>In Haskell, we would define the class as</p>\n\n<pre><code>class Ring a where\n    rplus :: a -&gt; a -&gt; a -- addition\n    rmult :: a -&gt; a -&gt; a -- multiplication\n    rnegate :: a -&gt; a    -- negation\n    runit :: a           -- multiplicative identity\n    rzero :: a           -- additive identity, multiplicative zero\n</code></pre>\n\n<p>Any value with a valid <code>Num</code> instance forms a ring, although you need to define the instances separately.</p>\n\n<pre><code>instance Ring Integer where\n    rplus = (+)\n    rmult = (*)\n    rnegate = negate\n    rzero = 0\n    runit = 1\n\ninstance Ring Float\n    rplus = (+)\n    rmult = (*)\n    rnegate = negate\n    rzero = 0\n    runit = 1\n\n-- etc\n</code></pre>\n\n<p>You can define an instance of <code>Ring</code> for polynomials, as long as the coefficients form a ring as well.</p>\n\n<pre><code>newtype Poly a = P [a]\n\ninstance Ring a =&gt; Ring (Poly a) where\n    -- Take care to handle polynomials with different degree\n    -- Note the use of rplus and rzero instead of (+) and 0\n    -- when dealing with coefficients\n    rplus (P a) (P b) = case (compare (length a) (length b)) of\n                          LT -&gt; rplus (P (rzero:a)) (P b)\n                          EQ -&gt; P $ zipWith rplus a b\n                          GT -&gt; rplus (P a) (P (rzero:b))\n\n\n\n    -- I leave a correct implementation of rmult as an exercise\n    -- for the reader.\n    rmult = ...\n    rnegate (P coeffs) = P $ map rnegate coeffs\n    rzero = P [0]\n    runit = P [1]\n</code></pre>\n"}], "owner": {"reputation": 1085, "user_id": 5007499, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000055026531/picture?type=large", "display_name": "Liumx31", "link": "https://stackoverflow.com/users/5007499/liumx31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 1, "accepted_answer_id": 39084141, "answer_count": 3, "score": 2, "last_activity_date": 1472060226, "creation_date": 1471871271, "last_edit_date": 1471951091, "question_id": 39080419, "link": "https://stackoverflow.com/questions/39080419/undefined-error-on-defined-function", "title": "Undefined error on defined function", "body": "<p>I'm trying to implement a function that multiplies polynomials (represented using lists -- 3x^2 + 5x + 2 = P [2,5,3]):</p>\n\n\n\n<pre><code>newtype Poly a = P [a]\n\nplus :: Num a =&gt; Poly a -&gt; Poly a -&gt; Poly a\nplus (P a) (P b) = P (map (\\(y,z) -&gt; z + y) (zipWithPadding 0 a b))\n    where\n        zipWithPadding :: (Num a) =&gt; a -&gt; [a] -&gt; [a] -&gt; [(a, a)]\n        zipWithPadding e (aa: as) (bb: bs) = ((aa, bb): zipWithPadding e as bs)\n        zipWithPadding e [] bs = zip (repeat e) bs\n        zipWithPadding e as [] = zip as (repeat e)\n\ntimes :: Num a =&gt; Poly a -&gt; Poly a -&gt; Poly a\ntimes (P a) (P b) = sum $ multList 0 [] a b\n    where\n        multList :: Num a =&gt; Int -&gt; [Poly a] -&gt; [a] -&gt; [a] -&gt; [Poly a]\n        multList _ s [] _ = s\n        multList e s (aa:as) bs = multList (e + 1) (s ++ (multElement e aa bs)) as bs\n\n        multElement :: Num a =&gt; Int -&gt; a -&gt; [a] -&gt; [Poly a]\n        multElement e aa bs = [P $ replicate e 0 ++ (map (*aa) bs)]\n\n\ninstance Num a =&gt; Num (Poly a) where\n    (+) = plus\n    (*) = times\n    negate      = undefined\n    fromInteger = undefined\n    -- No meaningful definitions exist\n    abs    = undefined\n    signum = undefined\n</code></pre>\n\n<p>When I tried to run however, I got an <code>undefined</code> error:</p>\n\n<pre><code>*HW04&gt; times (P [1,2,2]) (P [1,2])\n*** Exception: Prelude.undefined\n</code></pre>\n\n<p>I'm confused.</p>\n"}, {"tags": ["c", "haskell"], "comments": [{"owner": {"reputation": 20705, "user_id": 5174469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cXyx5.jpg?s=128&g=1", "display_name": "Mong Zhu", "link": "https://stackoverflow.com/users/5174469/mong-zhu"}, "edited": false, "score": 0, "creation_date": 1471855399, "post_id": 39074828, "comment_id": 65497621, "body": "your question is a little confusing. What exactly are you asking about? C or C# solution? Can you describe for the people who don&#39;t know Haskell what the expression: <code>generate n = [x:rest | x &lt;- [1..n], rest &lt;- generate (n-x)]</code> does? The more information you provide the easier will it be for the people to answer your question"}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 114, "user_id": 6694971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc9a19c3b402f385359f4c9e3604451?s=128&d=identicon&r=PG&f=1", "display_name": "LuckAss", "link": "https://stackoverflow.com/users/6694971/luckass"}, "edited": false, "score": 0, "creation_date": 1471856273, "post_id": 39074828, "comment_id": 65498227, "body": "@LuckAss I add C output"}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 1402, "user_id": 6554747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xlzqs.png?s=128&g=1", "display_name": "progyammer", "link": "https://stackoverflow.com/users/6554747/progyammer"}, "edited": false, "score": 0, "creation_date": 1471856476, "post_id": 39074828, "comment_id": 65498369, "body": "@progy_rock 1) I know but I don&#39;t know how to fix it 2) I didn&#39;t develop it yet, anyway I also and do not know how to create array in a recursive way like I did in Haskel with : colon."}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 1402, "user_id": 6554747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xlzqs.png?s=128&g=1", "display_name": "progyammer", "link": "https://stackoverflow.com/users/6554747/progyammer"}, "edited": false, "score": 1, "creation_date": 1471857081, "post_id": 39074828, "comment_id": 65498814, "body": "@progy_rock there is sample C# code on stack overflow: <a href=\"http://stackoverflow.com/questions/15048329/finding-all-numbers-that-sum-to-a-specified-target-number-integer-partition\" title=\"finding all numbers that sum to a specified target number integer partition\">stackoverflow.com/questions/15048329/&hellip;</a> but I want a recursive one"}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 1402, "user_id": 6554747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xlzqs.png?s=128&g=1", "display_name": "progyammer", "link": "https://stackoverflow.com/users/6554747/progyammer"}, "edited": false, "score": 0, "creation_date": 1471858226, "post_id": 39074828, "comment_id": 65499524, "body": "@progy_rock ok I delete the C# section."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "edited": false, "score": 0, "creation_date": 1471875427, "post_id": 39081211, "comment_id": 65511500, "body": "What If I don&#39;t want a list just print on a screen, something like this sudo code: foreach y in composition(n-j) {printf ( j,y) } which y is probably a list"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "edited": false, "score": 0, "creation_date": 1471875788, "post_id": 39081211, "comment_id": 65511795, "body": "Compute the list first, then print it."}], "tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": true, "score": 1, "last_activity_date": 1471873423, "creation_date": 1471873423, "answer_id": 39081211, "question_id": 39074828, "link": "https://stackoverflow.com/questions/39074828/composition-of-integer-in-c-and-haskell/39081211#39081211", "title": "Composition of integer in C and Haskell", "body": "<p>Using printf is not really equivalent : it outputs the result to stdout instead of returning it as list object. In C++ you could do</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt; &gt; composition(int n)\n{\n    int j;\n    if (n == 0)\n        return std::vector&lt;std::vector&lt;int&gt; &gt;(0);\n    std::vector&lt;std::vector&lt;int&gt; &gt; ret;\n    ret.push_back(std::vector&lt;int&gt;(1, n));\n    for (j = 1; j &lt;= n; j++) \n    {\n        std::vector&lt;std::vector&lt;int&gt; &gt; rec = composition(n - j);\n        for (auto&amp; it : rec)\n            it.push_back(j);\n        ret.insert(ret.begin(), rec.begin(), rec.end());\n    }\n    return ret;\n}\n</code></pre>\n\n<p>Now if you really want plain C, you have to dynamically allocate the vectors yourself. It is not very fun.</p>\n"}], "owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 39081211, "answer_count": 1, "score": 3, "last_activity_date": 1471874914, "creation_date": 1471855153, "last_edit_date": 1471874914, "question_id": 39074828, "link": "https://stackoverflow.com/questions/39074828/composition-of-integer-in-c-and-haskell", "title": "Composition of integer in C and Haskell", "body": "<p>I want to find a <a href=\"https://en.wikipedia.org/wiki/Composition_(combinatorics)\" rel=\"nofollow\">Composition of Integer</a> in C  and Haskell\nI find this code for Haskell which works fine:</p>\n\n<pre><code>composition 0 = [[]]\ncomposition n = [x:rest | x &lt;- [1..n], rest &lt;- composition (n-x)]\n</code></pre>\n\n<p>Sample output of this Code Is:</p>\n\n<pre><code>*Main&gt; composition 3 \n[[1,1,1],[1,2],[2,1],[3]]\n\n*Main&gt; composition 4 \n[[1,1,1,1],[1,1,2],[1,2,1],[1,3],[2,1,1],[2,2],[3,1],[4]]\n</code></pre>\n\n<p>but I could not develop an equivalent in C:\nI tried to create recursive function in C but I don't know how to use equivalent of Haskell :[] in C</p>\n\n<pre><code>void composition(int n)\n{\n        int j;\n        if (n==0)\n                return;\n        for(j=1;j&lt;=n;j++){\n                printf (\"%d\",j);\n                composition(n-j);\n                printf(\"\\n\");\n        }\n\n}\n</code></pre>\n\n<p>sample Output of this code is:</p>\n\n<pre><code>Composition is\n111\n\n2\n\n21\n\n3\n</code></pre>\n\n<p>The correct composition for 3 is</p>\n\n<pre><code>1 1 1\n2 1\n1 2\n3\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "functional-programming", "monads", "parsec"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1471834668, "creation_date": 1471834668, "answer_id": 39070802, "question_id": 39070545, "link": "https://stackoverflow.com/questions/39070545/how-to-express-parsing-logic-in-parsec-parsert-monad/39070802#39070802", "title": "How to express parsing logic in Parsec ParserT monad", "body": "<p>The solution is to define a string literal as a starting quote + many valid characters + an ending quote where a \"valid character\" is either a an escape sequence or non-quote.</p>\n\n<p>So there is a one line change to <code>parseString</code>:</p>\n\n<pre><code>parseString = do char '\"'\n                 x &lt;- many validChar\n                 char '\"'\n                 return $ String x\n</code></pre>\n\n<p>and we add the definitions:</p>\n\n<pre><code>validChar = try escapeSequence &lt;|&gt; satisfy ( /= '\"' )\nescapeSequence = do { char '\\\\'; anyChar }\n</code></pre>\n\n<p><code>escapeSequence</code> may be refined to allow a limited set of escape sequences.</p>\n"}, {"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1471843242, "post_id": 39071043, "comment_id": 65491790, "body": "An aside: <code>x &gt;&gt; return a</code> is <code>a &lt;$ x</code>."}, {"owner": {"reputation": 69, "user_id": 6741684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf62a32d3748bb826d93f9b8891c32b?s=128&d=identicon&r=PG&f=1", "display_name": "lachrimae", "link": "https://stackoverflow.com/users/6741684/lachrimae"}, "edited": false, "score": 0, "creation_date": 1471886873, "post_id": 39071043, "comment_id": 65518639, "body": "Thank you! I worked through the type signatures and documentation to see why <code>x &gt;&gt; return a</code> is <code>a &lt;$ x</code>. Is there a reason why the latter expression is preferred over the former here?  And is there a reason why <code>_ &lt;- char dq</code> is preferred over <code>char dq</code>? (edited)"}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1471916116, "post_id": 39071043, "comment_id": 65529823, "body": "The expression with <code>&lt;$</code> is shorter. As for <code>_ &lt;- char dq</code>, I had copied that code from when I did Scheme in 48 Hours. It makes it clear that the value of <code>char dq</code> isn&#39;t used. Otherwise you&#39;d get a compiler warning (at least with <code>-Wall</code>)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 69, "user_id": 6741684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf62a32d3748bb826d93f9b8891c32b?s=128&d=identicon&r=PG&f=1", "display_name": "lachrimae", "link": "https://stackoverflow.com/users/6741684/lachrimae"}, "edited": false, "score": 0, "creation_date": 1471920978, "post_id": 39071043, "comment_id": 65530811, "body": "@lachrimae For any type obeying the monad laws, <code>x &gt;&gt; return a</code> and <code>a &lt;$ x</code> must be equal, so it doesn&#39;t matter at all in terms of semantics - obviously the latter saves you typing &quot;return&quot; <i>n</i> times."}], "tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": true, "score": 3, "last_activity_date": 1471843883, "last_edit_date": 1471843883, "creation_date": 1471836903, "answer_id": 39071043, "question_id": 39070545, "link": "https://stackoverflow.com/questions/39070545/how-to-express-parsing-logic-in-parsec-parsert-monad/39071043#39071043", "title": "How to express parsing logic in Parsec ParserT monad", "body": "<p>Try something like this:</p>\n\n<pre><code>dq :: Char\ndq = '\"'\n\nparseString :: Parser Val\nparseString = do\n  _ &lt;- char dq\n  x &lt;- many ((char '\\\\' &gt;&gt; escapes) &lt;|&gt; noneOf [dq])\n  _ &lt;- char dq\n  return $ String x\n    where\n      escapes = dq &lt;$ char dq\n            &lt;|&gt; '\\n' &lt;$ char 'n'\n            &lt;|&gt; '\\r' &lt;$ char 'r'\n            &lt;|&gt; '\\t' &lt;$ char 't'\n            &lt;|&gt; '\\\\' &lt;$ char '\\\\'\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6741684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf62a32d3748bb826d93f9b8891c32b?s=128&d=identicon&r=PG&f=1", "display_name": "lachrimae", "link": "https://stackoverflow.com/users/6741684/lachrimae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 39071043, "answer_count": 2, "score": 2, "last_activity_date": 1471843883, "creation_date": 1471831961, "question_id": 39070545, "link": "https://stackoverflow.com/questions/39070545/how-to-express-parsing-logic-in-parsec-parsert-monad", "title": "How to express parsing logic in Parsec ParserT monad", "body": "<p>I was working on \"Write Yourself a Scheme in 48 hours\" to learn Haskell and I've run into a problem I don't really understand. It's for question 2 from the exercises at the bottom of <a href=\"https://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours/Parsing#Return_Values\" rel=\"nofollow\">this section</a>.</p>\n\n<p>The task is to rewrite </p>\n\n<pre><code>import Text.ParserCombinators.Parsec\nparseString :: Parser LispVal\nparseString = do\n                char '\"'\n                x &lt;- many (noneOf \"\\\"\")\n                char '\"'\n                return $ String x\n</code></pre>\n\n<p>such that quotation marks which are properly escaped (e.g. in \"This sentence \\\" is nonsense\") get accepted by the parser. </p>\n\n<p>In an imperative language I might write something like this (roughly pythonic pseudocode):</p>\n\n<pre><code>def parseString(input): \n  if input[0] != \"\\\"\" or input[len(input)-1] != \"\\\"\":\n    return error\n  input = input[1:len(input) - 1] # slice off quotation marks  \n  output = \"\" # This is the 'zero' that accumulates over the following loop\n  # If there is a '\"' in our string we want to make sure the previous char\n  # was '\\'  \n\n  for n in range(len(input)):\n    if input[n] == \"\\\"\":\n      try:\n        if input[n - 1] != \"\\\\\":\n          return error\n      catch IndexOutOfBoundsError:\n        return error\n    output += input[n]\n  return output\n</code></pre>\n\n<p>I've been looking at the <a href=\"http://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec-Prim.html\" rel=\"nofollow\">docs for Parsec</a> and I just can't figure out how to work this as a monadic expression. </p>\n\n<p>I got to this:</p>\n\n<pre><code>parseString :: Parser LispVal\nparseString = do\n                char '\"'\n                regular &lt;- try $ many (noneOf \"\\\"\\\\\")\n                quote &lt;- string \"\\\\\\\"\"\n                char '\"'\n                return $ String $ regular ++ quote\n</code></pre>\n\n<p>But this only works for one quotation mark and it has to be at the very end of the string--I can't think of a functional expression that does the work that my loops and if-statements do in the imperative pseudocode. </p>\n\n<p>I appreciate you taking your time to read this and give me advice. </p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1471823366, "post_id": 39069770, "comment_id": 65488050, "body": "If you do not have an executable you can delete main.hs and the respective parts in the cabal file. In the other case i would try to provide as much functionality as a library and only have a minimal io related executable. But if you are new to haskell do as you feel comfortable and don&#39;t worry too much. Ultimately i think, this is more a matter of style/taste than a formally answerable question."}], "answers": [{"comments": [{"owner": {"reputation": 4414, "user_id": 551904, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c0a0f47f94565025a9aa388e8bd8681?s=128&d=identicon&r=PG", "display_name": "Sunjay Varma", "link": "https://stackoverflow.com/users/551904/sunjay-varma"}, "edited": false, "score": 1, "creation_date": 1471834451, "post_id": 39070268, "comment_id": 65489914, "body": "Thanks! Some relevant cabal documentation regarding what you said about changing corresponding lines in <code>.cabal</code> - <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#editing-the-.cabal-file\" rel=\"nofollow noreferrer\">haskell.org/cabal/users-guide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 11, "last_activity_date": 1593349635, "last_edit_date": 1593349635, "creation_date": 1471828956, "answer_id": 39070268, "question_id": 39069770, "link": "https://stackoverflow.com/questions/39069770/how-am-i-meant-to-split-code-between-src-lib-hs-and-app-main-hs-in-a-new-stack-p/39070268#39070268", "title": "How am I meant to split code between src/Lib.hs and app/Main.hs in a new stack project?", "body": "<p>This separation of modules into folders can be any way you want. The naive idea is that you put almost all logic into the <code>Lib</code> folder. <code>Main.hs</code> then just</p>\n<ul>\n<li>imports required parts from <code>Lib</code>,</li>\n<li>reads command-line arguments, and</li>\n<li>runs stuff.</li>\n</ul>\n<p>You can rename <code>app</code> into <code>executables</code> and change the corresponding lines in <code>.cabal</code> file. Actually, you can come up with an arbitrary file hierarchy.</p>\n<p>In our company project, we use another but also very popular approach. And our file hierarchy looks like this:</p>\n<pre><code>.\n|-- bench\n|-- src\n    |-- exec1\n        |-- Main.hs\n    |-- exec2\n        |-- Main.hs\n    |-- SuperCoolLibrary\n        |-- LibModule1.hs\n        |-- LibModule2.hs\n|-- test\n|-- Setup.hs\n</code></pre>\n<p>Other <code>stack.yaml</code>, <code>.cabal</code>, etc. files are not shown here.</p>\n<p>Actually, if you are writing an application, you can just create one <code>Main.hs</code> file and put all logic inside the <code>main</code> function. You won't believe it but as a Haskell lecturer I saw such code from my students :(\nThough I don't suggest you write code that way.</p>\n<p>If you are writing a library then you don't need <code>Main.hs</code> files and the <code>main</code> function at all. You can look at a simple example like this library (it allows you to automatically generate command-line options from data types): <a href=\"https://github.com/Gabriel439/Haskell-Optparse-Generic-Library\" rel=\"nofollow noreferrer\" title=\"optparse-generic\">optparse-generic</a></p>\n<p>I hope I helped clearing up your confusion.</p>\n"}, {"tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": false, "score": 4, "last_activity_date": 1471843413, "creation_date": 1471843413, "answer_id": 39071868, "question_id": 39069770, "link": "https://stackoverflow.com/questions/39069770/how-am-i-meant-to-split-code-between-src-lib-hs-and-app-main-hs-in-a-new-stack-p/39071868#39071868", "title": "How am I meant to split code between src/Lib.hs and app/Main.hs in a new stack project?", "body": "<p>The main reason it's typically set up like this even for an application is for writing tests. Say you create a default stack project called <code>foo</code>, the test suite <code>foo-test</code> will depend on the <code>foo</code> library, as will the <code>foo-exe</code>. If you were to put all your functions into <code>app/Main.hs</code>, then those functions cannot be tested from the <code>foo-test</code> test suite.</p>\n\n<p>If you're just playing around and don't care about having a test suite, you could base your stack project on the <code>simple</code> template:</p>\n\n<pre><code>$ stack new foo simple\n</code></pre>\n\n<p>If you'd like to set up testing, I like <code>tasty</code>. You'd modify your <code>.cabal</code> file something like this:</p>\n\n<pre><code>test-suite foo-test\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test\n  main-is:             Spec.hs\n  build-depends:       base\n                     , foo\n                     , tasty\n                     , tasty-hunit\n                     , tasty-quickcheck\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Then take a look <a href=\"https://github.com/feuerbach/tasty#example\" rel=\"nofollow\">at the example</a>.</p>\n"}], "owner": {"reputation": 4414, "user_id": 551904, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c0a0f47f94565025a9aa388e8bd8681?s=128&d=identicon&r=PG", "display_name": "Sunjay Varma", "link": "https://stackoverflow.com/users/551904/sunjay-varma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1751, "favorite_count": 2, "accepted_answer_id": 39070268, "answer_count": 2, "score": 16, "last_activity_date": 1593349635, "creation_date": 1471822765, "question_id": 39069770, "link": "https://stackoverflow.com/questions/39069770/how-am-i-meant-to-split-code-between-src-lib-hs-and-app-main-hs-in-a-new-stack-p", "title": "How am I meant to split code between src/Lib.hs and app/Main.hs in a new stack project?", "body": "<p>I was following the <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md\" rel=\"noreferrer\">stack guide</a> and I got a new project setup (yay!).</p>\n\n<p>It generated the following file layout:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 app\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Main.hs\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 helloworld.cabal\n\u251c\u2500\u2500 Setup.hs\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Lib.hs\n\u251c\u2500\u2500 stack.yaml\n\u2514\u2500\u2500 test\n    \u2514\u2500\u2500 Spec.hs\n</code></pre>\n\n<p>According to the \"<a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md#files-in-helloworld\" rel=\"noreferrer\">Files in helloworld</a>\" section of the guide:</p>\n\n<blockquote>\n  <p>The app/Main.hs, src/Lib.hs, and test/Spec.hs files are all Haskell source files that compose the actual functionality of our project (we won't dwell on them here).</p>\n</blockquote>\n\n<p>I really wish they had dwelled on that for a second, because I have no idea what the distinction between <code>app/Main.hs</code> and <code>src/Lib.hs</code> should be. Which code should I put where?</p>\n\n<p><strong>In what ways am I supposed to divide code between <code>app/</code>, <code>src/</code>, <code>app/Main.hs</code> and <code>src/Lib.hs</code>?</strong></p>\n\n<p>If I'm just writing an application or just writing a library, do I need both files/directories?</p>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1471819872, "post_id": 39069188, "comment_id": 65487471, "body": "If you use <code>-Wall</code>, then GHC will help you in two ways. It will tell you what non-exhaustive patterns it sees, and it will tell you that the accidental function <code>mKPerson2&#39;</code> is missing its type signature."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 9, "last_activity_date": 1471817461, "creation_date": 1471817461, "answer_id": 39069297, "question_id": 39069188, "link": "https://stackoverflow.com/questions/39069188/these-patterns-look-exhaustive-to-me-non-exhaustive-patterns-error-why/39069297#39069297", "title": "These patterns look exhaustive to me, &quot;Non-exhaustive patterns error&quot; ? Why?", "body": "<p>You used a capital K in the first two definitions:</p>\n\n<pre><code>mKPerson2' (Right nameOk) (Right ageOk) = Right (Person nameOk ageOk)\n ^\n\nmKPerson2' (Left badName) (Left badAge) = Left (badName ++ badAge)\n ^\n</code></pre>\n"}], "owner": {"reputation": 2365, "user_id": 6682929, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/BuvWA.jpg?s=128&g=1", "display_name": "Jonathan Portorreal", "link": "https://stackoverflow.com/users/6682929/jonathan-portorreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 39069297, "answer_count": 1, "score": 0, "last_activity_date": 1471817461, "creation_date": 1471816429, "question_id": 39069188, "link": "https://stackoverflow.com/questions/39069188/these-patterns-look-exhaustive-to-me-non-exhaustive-patterns-error-why", "title": "These patterns look exhaustive to me, &quot;Non-exhaustive patterns error&quot; ? Why?", "body": "<h1>Problem</h1>\n\n<p>While taking notes from a Haskell book, this code example should return: <code>Left [NameEmpty, AgeTooLow]</code>, but it only returns the first case <code>Left [NameEmpty]</code>. Then when I pass the function <code>mkPerson2</code> results to which it should return <code>Right Person _ _</code>, I get back a `Non-exhaustive pattern``` error. I've looked over this code for quite some time, but it looks right to me. What am I missing here? Any explanation on the subject would be absolutely appreciated, thanks! <br></p>\n\n<p><a href=\"http://haskellbook.com\" rel=\"nofollow\">Book I'm using</a></p>\n\n<h1>Code</h1>\n\n<pre><code>module EqCaseGuard where\n\ntype Name = String\ntype Age  = Integer\ntype ValidatePerson a = Either [PersonInvalid] a\n\ndata Person = Person Name Age deriving Show\n\ndata PersonInvalid = NameEmpty\n                   | AgeTooLow\n                   deriving Eq\n\nageOkay :: Age -&gt; Either [PersonInvalid] Age\nageOkay age = case age &gt;= 0 of\nTrue  -&gt; Right age\nFalse -&gt; Left [AgeTooLow]\n\nnameOkay :: Name -&gt; Either [PersonInvalid] Name\nnameOkay name = case name /= \"\" of\nTrue  -&gt; Right name\nFalse -&gt; Left [NameEmpty]\n\nmkPerson2 :: Name -&gt; Age -&gt; ValidatePerson Person\nmkPerson2 name age = mkPerson2' (nameOkay name) (ageOkay age)\n\nmkPerson2' :: ValidatePerson Name -&gt; ValidatePerson Age -&gt; ValidatePerson Person\nmKPerson2' (Right nameOk) (Right ageOk) = Right (Person nameOk ageOk)\nmKPerson2' (Left badName) (Left badAge) = Left (badName ++ badAge)\nmkPerson2' (Left badName)  _            = Left badName\nmkPerson2' _              (Left badAge) = Left badAge\n</code></pre>\n\n<h1>Error</h1>\n\n<pre><code>*EqCaseGuard&gt; mkPerson2 \"jack\" 22\n*** Exception: eqCaseGuard.hs:(54,1)-(55,53): Non-exhaustive patterns in function mkPerson2'\n\n*EqCaseGuard&gt; mkPerson2 \"\" (-1)\nLeft [NameEmpty]\n*EqCaseGuard&gt; \n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1471822461, "post_id": 39069305, "comment_id": 65487918, "body": "I&#39;m facing a related situation right now designing a merge API for <code>Data.Map</code>. The &quot;open&quot; approach is preferable in some ways. For one thing, I can implement it without GADTs and therefore maintain compatibility with Report Haskell. For another, I don&#39;t need huge case analyses everywhere. But it&#39;s unpleasant in some other ways; in particular, it&#39;s much harder for me to take advantage of what I know about the behavior of values constructed in particular manners to optimize things."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1471857393, "post_id": 39069305, "comment_id": 65499010, "body": "@Benjamin: &quot;Over the years, very smart people have invented lots of clever ways of solving the Expression Problem, to support new operations and new types&quot; What are these solutions ?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1471858007, "post_id": 39069305, "comment_id": 65499377, "body": "@baxbaxwalanuksiwe There&#39;s too much literature, and too many different approaches, for me to cite exhaustively here. Kiselyov touches on it in his <a href=\"http://okmij.org/ftp/tagless-final/course/lecture.pdf\" rel=\"nofollow noreferrer\">tagless final notes</a>; there&#39;s a <a href=\"http://scala-lang.org/docu/files/IC_TECH_REPORT_200433.pdf\" rel=\"nofollow noreferrer\">Scala paper</a> by Zenger and Odersky; Torgersen has done <a href=\"http://www.daimi.au.dk/~madst/ecoop04/main.pdf\" rel=\"nofollow noreferrer\">work</a> on it in Java and C#. That&#39;s just a starter - I advise following the references from those papers and doing some of your own Googling to learn about the full variety of solutions"}, {"owner": {"reputation": 217, "user_id": 5849249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25df1c8663346da249c1c838143d59ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan", "link": "https://stackoverflow.com/users/5849249/ronan"}, "edited": false, "score": 0, "creation_date": 1471879063, "post_id": 39069305, "comment_id": 65514183, "body": "That is a difference from the point of view of code mutability (ie. the developer). Is there some difference at the computer level (performance or security, for instance)?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 217, "user_id": 5849249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25df1c8663346da249c1c838143d59ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan", "link": "https://stackoverflow.com/users/5849249/ronan"}, "edited": false, "score": 0, "creation_date": 1471887568, "post_id": 39069305, "comment_id": 65519004, "body": "@ernesto There <i>may</i> be a (very minor) performance difference between the two but you&#39;d be firmly in the realm of microoptimisations. The impact on flexibility is much more important."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 26, "last_activity_date": 1476740708, "last_edit_date": 1476740708, "creation_date": 1471817522, "answer_id": 39069305, "question_id": 39068583, "link": "https://stackoverflow.com/questions/39068583/cases-of-types-vs-fields-of-records-in-haskell/39069305#39069305", "title": "Cases of types vs fields of records in Haskell", "body": "<p>Good question! You've struck at the heart of one of the fundamental problems of software engineering. Per Wadler, it's called <a href=\"http://homepages.inf.ed.ac.uk/wadler/papers/expression/expression.txt\" rel=\"nofollow\"><em>the Expression Problem</em></a>, and, roughly summarised, the question is:</p>\n\n<blockquote>\n  <p>Should it be easy to add new operations, or new types of data?</p>\n</blockquote>\n\n<p>Your first example makes it <strong>easy to add new operations</strong> to existing animals. We can process <code>Animal</code> values in all sorts of ways without changing the definition of <code>Animal</code>:</p>\n\n<pre><code>numberOfTeeth :: Animal -&gt; Int\nnumberOfTeeth Cat = 30\nnumberOfTeeth Dog = 42\n\nfood :: Animal -&gt; String\nfood Cat = \"Fish\"\nfood Dog = \"Sausages\"  -- probably stolen from a cartoon butcher\n</code></pre>\n\n<p>The downside is that it's <strong>hard to add new types</strong> of animal. You have to add new constructors to <code>Animal</code> and change all the existing operations:</p>\n\n<pre><code>data Animal = Cat | Dog | Crocodile\n\nspeak :: Animal -&gt; String\nspeak Cat = \"miaow\"\nspeak Dog = \"woof\"\nspeak Crocodile = \"RAWR\"\n\nnumberOfTeeth :: Animal -&gt; Int\nnumberOfTeeth Cat = 30\nnumberOfTeeth Dog = 42\nnumberOfTeeth Crocodile = 100000  -- I'm not a vet\n\nfood :: Animal -&gt; String\nfood Cat = \"Fish\"\nfood Dog = \"Sausages\"\nfood Crocodile = \"Human flesh\"\n</code></pre>\n\n<p>Your second example flips the matrix, making it <strong>easy to add new types</strong>,</p>\n\n<pre><code>crocodile = Animal { speak = \"RAWR\" }\n</code></pre>\n\n<p>but <strong>hard to add new functions</strong> - it means adding new fields to <code>Animal</code> and updating all the existing animals.</p>\n\n<pre><code>data Animal = Animal {\n    speak :: String,\n    numberOfTeeth :: Int,\n    food :: String\n}\ncat = Animal {\n    speak = \"miaow\",\n    numberOfTeeth = 30,\n    food = \"Fish\"\n}\ndog = Animal {\n    speak = \"woof\",\n    numberOfTeeth = 42,\n    food = \"Sausages\"\n}\ncrocodile = Animal {\n    speak = \"RAWR\",\n    numberOfTeeth = 100000,\n    food = \"Human flesh\"\n}\n</code></pre>\n\n<p>Don't underestimate how big of a deal the Expression Problem is! If you're working on a published library, you may find yourself contending with operations or types defined by someone you've never met in a codebase you can't change. You have to think carefully about the way you expect people to use your system, and decide how to orient the design of your library.</p>\n\n<p>Over the years, smart people have invented lots of clever ways of solving the Expression Problem, to support new operations <em>and</em> new types. These solutions tend to be complicated, using the most advanced features of the most modern programming languages. In the real world, this is just another trade-off engineers have to consider - is solving the Expression Problem worth the code-complexity it'll cause?</p>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 1, "last_activity_date": 1471837421, "last_edit_date": 1471837421, "creation_date": 1471836345, "answer_id": 39070979, "question_id": 39068583, "link": "https://stackoverflow.com/questions/39068583/cases-of-types-vs-fields-of-records-in-haskell/39070979#39070979", "title": "Cases of types vs fields of records in Haskell", "body": "<p>First, let's assign the types the names, which closer reflect their essence:</p>\n\n<pre><code>data AnimalType =\n  Cat | Dog\n\nnewtype Phrase =\n  Phrase { phrase :: String }\n</code></pre>\n\n<p>It already becomes evident that they are very different and clearly isolatable.</p>\n\n<p>A phrase here is a way more general thing. It can be spoken not just by animals, but by robots at least as well. But more so it can not only be spoken, but also be transformed with operations like upper-casing and etc. Such operations would make no sense for the <code>AnimalType</code> type.</p>\n\n<p><code>AnimalType</code> OTOH has its own benefits. By matching the type, you can pick a type of food the animal needs or its size and etc. You can't do that on <code>Phrase</code>.</p>\n\n<p>You can also have both types coexist in isolation in your application and have a transformation (and, hence, a dependency) from the more specific to the more general one:</p>\n\n<pre><code>module Animal where\n\nimport qualified Phrase\n\nspeakPhrase :: Animal -&gt; Phrase.Phrase\nspeakPhrase =\n  Phrase.Phrase . speak\n</code></pre>\n\n<p>What's causing your confusion is that your problem lacks the context of an application. Once you'll provide it to yourself, you'll get the info on what you actually need this thing to do and which data it'll operate on.</p>\n"}], "owner": {"reputation": 217, "user_id": 5849249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25df1c8663346da249c1c838143d59ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan", "link": "https://stackoverflow.com/users/5849249/ronan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 2, "answer_count": 2, "score": 17, "last_activity_date": 1476740708, "creation_date": 1471811416, "last_edit_date": 1471819770, "question_id": 39068583, "link": "https://stackoverflow.com/questions/39068583/cases-of-types-vs-fields-of-records-in-haskell", "title": "Cases of types vs fields of records in Haskell", "body": "<p>The two following pieces of code seem really similar. However there <em>must</em> be some differences and I am hoping that someone could point them out.</p>\n\n<pre><code>data Animal = Cat | Dog\nspeak :: Animal -&gt; String\nspeak Cat = \"meowh\"\nspeak Dog = \"wouf\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>data Animal = Animal { speak :: String }\ncat = Animal { speak = \"meowh\"}\ndog = Animal { speak = \"wouf\" }\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1471815650, "post_id": 39068591, "comment_id": 65486525, "body": "Ok I see. I didn&#39;t know <code>glob</code>. Thank you. I knew <code>readCreateProcess</code>, this is the workaround I used."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1471823660, "post_id": 39068591, "comment_id": 65488094, "body": "Just to complement, I&#39;ve just found the <a href=\"https://hackage.haskell.org/package/path\" rel=\"nofollow noreferrer\">path library</a> which is very nice to convert between absolute paths and relative paths (glob returns absolute paths)."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1471811509, "creation_date": 1471811509, "answer_id": 39068591, "question_id": 39068356, "link": "https://stackoverflow.com/questions/39068356/how-to-use-readprocesswithexitcode-part-2/39068591#39068591", "title": "How to use readProcessWithExitCode ? (part 2)", "body": "<p>When you run the command in the shell the shell expands the \"glob\" <code>./*.hs</code> to all of the file names in the current directory ending in <code>.hs</code>.</p>\n\n<p>So the <code>grep</code> command never sees the argument <code>./*.hs</code> - it will only see the actual .hs file names.</p>\n\n<p>To get the shell to expand the glob pattern you have to use <code>readCreateProcessWithExitCode</code> with a CreateProcess value configured to call the shell:</p>\n\n<pre><code>readCreateProcessWithExitCode (shell \"grep run ./*.hs\") \n</code></pre>\n\n<p>However, you then have to worry about quoting and escaping arguments. For instance, if you\nare grepping for <code>run this</code> you will have to add quotes around the</p>\n\n<pre><code>readCreateProcessWithExitCode (shell \"grep 'run this' ./*.hs\") \"\"\n</code></pre>\n\n<p>whereas with <code>readProcess</code> you would just use:</p>\n\n<pre><code>readProcess \"grep\" [\"run this\", ...] \"\"\n</code></pre>\n\n<p>and not worry that the first argument contains a space.</p>\n\n<p>Using the <a href=\"https://hackage.haskell.org/package/Glob-0.7.11\" rel=\"nofollow\">Glob</a> package you can perform the file globbing yourself:</p>\n\n<pre><code>import System.FilePath.Glob\n\nmain = do\n  files &lt;- glob \"./*.hs\"\n  let args = [\"run\"] ++ files\n  readProcess \"grep\" args \"\"\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 39068591, "answer_count": 1, "score": 1, "last_activity_date": 1471811509, "creation_date": 1471809581, "last_edit_date": 1495541700, "question_id": 39068356, "link": "https://stackoverflow.com/questions/39068356/how-to-use-readprocesswithexitcode-part-2", "title": "How to use readProcessWithExitCode ? (part 2)", "body": "<p>Follow-up of <a href=\"https://stackoverflow.com/questions/38959402/how-to-use-readprocesswithexitcode\">How to use readProcessWithExitCode?</a>. </p>\n\n<p>The following terminal command works fine:</p>\n\n<pre><code>$ grep \"run\" ./*.hs\n</code></pre>\n\n<p>It finds all the hs files containing the string \"runr\" in the current directory only.</p>\n\n<p>But this command in Haskell returns an exit code (even when there are some matching files):</p>\n\n<pre><code>Prelude System.Process&gt; readProcessWithExitCode \"grep\" [\"run\", \"./*.hs\"] \"\"\n</code></pre>\n\n<p>So how does <code>readProcessWithExitCode</code> (or <code>readProcess</code>) deal with the list of arguments, exactly ?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1471809009, "post_id": 39068247, "comment_id": 65484648, "body": "What would you get if you didn&#39;t have the Functor constraint? It&#39;d still be producable from an (s -&gt; a), and turnable into an (s -&gt; a), right?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471809381, "post_id": 39068247, "comment_id": 65484746, "body": "Well, to go back to a plain function you just need to instantiate <code>f</code> suitably, usually done with <code>Const</code>, which of course happens to have a <code>Functor</code> instance too."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471810549, "post_id": 39068247, "comment_id": 65485065, "body": "Yea but you could also use other <code>Contravariant</code>s that happen not to have a Functor instance, right? Or do you mean that wouldn&#39;t give us more power, because you can turn a Getter into a function, and use that function to construct the thing that we wanted to do that couldnt provide a Functor constraint?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1530553878, "post_id": 39068247, "comment_id": 89266853, "body": "Follow the types they said! I just revisited this and there is a story right there in the module documentation! I&#39;d love to accept this answer, may I ask for some hint for understanding CPS tranfromation for completeness?   <a href=\"https://hackage.haskell.org/package/lens-4.16.1/docs/Control-Lens-Getter.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/lens-4.16.1/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1471808760, "creation_date": 1471808760, "answer_id": 39068247, "question_id": 39068004, "link": "https://stackoverflow.com/questions/39068004/what-is-the-story-behind-a-getter/39068247#39068247", "title": "What is the story behind a Getter?", "body": "<p>Well, a getter is basically just a function. The isomorphism is this:</p>\n\n<pre><code>getter :: (Functor f, Contravariant f) =&gt; (s-&gt;a) -&gt; (a-&gt;f a) -&gt; s-&gt;f s\ngetter f q = contramap f . q . f\n</code></pre>\n\n<p>Here, the <code>contramap</code> will in effect do nothing but coerce the types, because as you say, combining <code>Functor</code> and <code>Contravariant</code> amounts to requiring that <code>f x</code> doesn't actually contain an <code>x</code>. Basically, ensuring this is also the only reason the <code>Functor</code> constraint is there.</p>\n"}, {"comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 2, "creation_date": 1471808968, "post_id": 39068269, "comment_id": 65484636, "body": "Or the other way: <code>change = contramap (const ()) . fmap (const ())</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471809218, "post_id": 39068269, "comment_id": 65484693, "body": "@Gurkenglas, yes, either terminal object will do. I didn&#39;t notice that."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 8, "last_activity_date": 1471808910, "creation_date": 1471808910, "answer_id": 39068269, "question_id": 39068004, "link": "https://stackoverflow.com/questions/39068004/what-is-the-story-behind-a-getter/39068269#39068269", "title": "What is the story behind a Getter?", "body": "<p>The idea of a <code>Getter</code> is that it is a read-only lens. Given a <code>Getter s a</code> you can pull an <code>a</code> out of an <code>s</code>, but you can't put one in. The type is defined thus:</p>\n\n<pre><code>type Getter s a = forall f. (Contravariant f, Functor f) =&gt; (a -&gt; f a) -&gt; s -&gt; f s\n</code></pre>\n\n<p>When a type is both a <code>Functor</code> and <code>Contravariant</code>, it actually doesn't depend on its type argument at all:</p>\n\n<pre><code>import Data.Void\n\nchange :: (Functor f, Contravariant f) =&gt; f a -&gt; f b\nchange = fmap absurd . contramap absurd\n</code></pre>\n\n<p>Such a functor will always look very much like <code>Const b</code> for some <code>b</code>.</p>\n\n<p>So a <code>Getter s a</code> is essentially</p>\n\n<pre><code>type Getter s a = forall b . (a -&gt; b) -&gt; s -&gt; b\n</code></pre>\n\n<p>but to make it work with the rest of the lens ecosystem it has extra polymorphism.</p>\n"}, {"comments": [{"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1536775404, "post_id": 52292617, "comment_id": 91549819, "body": "Possibly best answer out there but I suspect few people could tell whether it&#39;s right or wrong!"}], "tags": [], "owner": {"reputation": 345, "user_id": 2610474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1c33bc50efcb00a277fd29737d8f73?s=128&d=identicon&r=PG", "display_name": "dremodaris", "link": "https://stackoverflow.com/users/2610474/dremodaris"}, "is_accepted": false, "score": 1, "last_activity_date": 1536747226, "last_edit_date": 1536747226, "creation_date": 1536746777, "answer_id": 52292617, "question_id": 39068004, "link": "https://stackoverflow.com/questions/39068004/what-is-the-story-behind-a-getter/52292617#52292617", "title": "What is the story behind a Getter?", "body": "<p>The type</p>\n\n<pre><code>Getter s a = forall f . (Contravariant f, Functor f) =&gt; (a -&gt; f a) -&gt; (s -&gt; f s)\n</code></pre>\n\n<p>is isomorphic to the type <code>s -&gt; a</code>. The two sides of the isomorphism are given by</p>\n\n<pre><code>toGetter :: (s -&gt; a) -&gt; Getter s a\ntoGetter h alpha = contramap h . alpha . h\nfromGetter :: Getter s a -&gt; (s -&gt; a)\nfromGetter getter = getConst . getter Const\n</code></pre>\n\n<p>It is not hard to see that <code>fromGetter (toGetter h)</code> equals <code>h</code>.</p>\n\n<p>Up to this point (i.e. in order to implement <code>toGetter</code> and <code>fromGetter</code> and to prove that <code>fromGetter . toGetter = id</code>) we have not used the <code>Functor f</code> constraint. This constraint is however necessary in order to prove that <code>toGetter . fromGetter = id</code>.</p>\n\n<hr>\n\n<p>First assume that <code>f</code> is both a covariant <code>Functor</code> and a <code>Contravariant</code> functor. Then any function <code>g :: x -&gt; y</code> yields functions <code>fmap g :: f x -&gt; f y</code> and <code>contramap g :: f y -&gt; f x</code>. Parametricity, combined with the functor laws, entails that these are mutually inverse, i.e. <code>f x \u2245 f y</code>. Hence, <code>f</code> is (up to isomorphism) a constant functor, so we can think of <code>Getter s a</code> as being defined as</p>\n\n<pre><code>Getter s a = forall f0 . (a -&gt; b) -&gt; (s -&gt; b)\n</code></pre>\n\n<p>(as mentioned in dfeuer's answer). By the Yoneda lemma, this is isomorphic to <code>s -&gt; a</code>.</p>\n\n<hr>\n\n<p>Remarkably, if we lift the <code>Functor f</code> constraint:</p>\n\n<pre><code>OddGetter s a = forall f . Contravariant f =&gt; (a -&gt; f a) -&gt; (s -&gt; f s)\n</code></pre>\n\n<p>then we obtain a subtype of <code>Getter s a</code> that is no longer isomorphic to <code>s -&gt; a</code>, but instead to <code>s -&gt; Aux a s</code>:</p>\n\n<pre><code>newtype Aux a x = Aux {aAux :: a, gAux :: x -&gt; a}\ninstance Contravariant (Aux a) where\n  contramap f (Aux a g) = Aux a (g . f)\n\ntoAux :: a -&gt; Aux a a\ntoAux a = Aux a id\n</code></pre>\n\n<p><em><code>(Aux a, toAux)</code> is the initial of all pairs <code>(F, toF)</code> where <code>F</code> is a contravariant functor and <code>toF :: a -&gt; F a</code>, similar to how <code>(Const a, Const)</code> is the initial of all pairs <code>(F, toF)</code> where <code>F</code> is a co- and contravariant functor and <code>toF :: a -&gt; F a</code>.</em></p>\n\n<p>The two sides of the isomorphism can be implemented as follows:</p>\n\n<pre><code>toOddGetter :: (s -&gt; Aux a s) -&gt; OddGetter s a\ntoOddGetter sigma alpha s1 =\n    contramap (\\s2 -&gt; gAux (sigma s1) s2) $ alpha $ aAux (sigma s1)\nfromOddGetter :: OddGetter s a -&gt; (s -&gt; Aux a s)\nfromOddGetter getter = getter toAux\n</code></pre>\n\n<p>Again, it is straightforward to check that <code>fromOddGetter . toOddGetter = id</code>, which already shows that <code>OddGetter s a</code> is <strong>not</strong> isomorphic to <code>s -&gt; a</code>. To prove that <code>fromOddGetter . toOddGetter = id</code>, we again need a parametricity argument.</p>\n\n<p>Parametricity entails that, for any natural transformation <code>nu :: forall x . d x -&gt; f x</code>, any <code>getter :: OddGetter s a</code> and any <code>alphaD :: a -&gt; d a</code>, we have</p>\n\n<pre><code>nu . getter alphaD = getter (nu . alphaD) :: s -&gt; f s\n</code></pre>\n\n<p>Now, we instantiate <code>d</code> with <code>Aux a</code>, <code>alphaD</code> with <code>toAux</code> and <code>nu</code> with <code>factor alpha</code> (for an arbitrary <code>alpha : a -&gt; f a</code>):</p>\n\n<pre><code>factor :: (a -&gt; f a) -&gt; forall x . Aux a x -&gt; f x\nfactor alpha (Aux a g) = contramap g $ alpha a\n</code></pre>\n\n<p>which has the property that <code>factor alpha . toAux = alpha</code>. Then we have</p>\n\n<pre><code>factor alpha . getter toAux = getter (factor alpha . toAux) = getter alpha :: s -&gt; f s\n</code></pre>\n\n<p>Now when we apply this to some <code>s1 :: s</code>, we find that <code>getter alpha s1</code> (the applied RHS) equals</p>\n\n<pre><code>factor alpha (getter toAux s1)\n  = contramap (gAux $ getter toAux s1) $ alpha (aAux $ getter toAux s1)\n    {-by definition of factor-}\n  = contramap (\\s2 -&gt; gAux (getter toAux s1) s2) $ alpha $ aAux (getter toAux s1)\n    {-by eta-expansion and regrouping-}\n  = toOddGetter (getter toAux) alpha s1\n    {-by definition of toOddGetter-}\n  = toOddGetter (fromOddGetter getter) alpha s1\n    {-by definition of fromOddGetter-}\n</code></pre>\n\n<p>i.e. <code>getter = toOddGetter (fromOddGetter getter)</code>.</p>\n\n<hr>\n\n<p>Given the isomorphisms, it is perhaps remarkable that the type</p>\n\n<pre><code>OddGetter s a \u2245 s -&gt; Aux a s\n</code></pre>\n\n<p>is a subtype of</p>\n\n<pre><code>Getter s a \u2245 s -&gt; a\n</code></pre>\n\n<p>The \"coercion\" function</p>\n\n<pre><code>\\ getter -&gt; getter :: OddGetter s a -&gt; Getter s a\n</code></pre>\n\n<p>corresponds to the function</p>\n\n<pre><code>\\ sigma -&gt; aAux . sigma :: (s -&gt; Aux a s) -&gt; (s -&gt; a)\n</code></pre>\n\n<p>under these isomorphisms.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 2, "answer_count": 3, "score": 5, "last_activity_date": 1536747226, "creation_date": 1471807209, "question_id": 39068004, "link": "https://stackoverflow.com/questions/39068004/what-is-the-story-behind-a-getter", "title": "What is the story behind a Getter?", "body": "<p>I stumbled upon <a href=\"https://hackage.haskell.org/package/lens-4.14/docs/src/Control.Lens.Type.html#Getter\" rel=\"noreferrer\">Getter</a> definition having both <code>Functor</code> and <code>Contravariant</code> constraint on <code>f</code>. </p>\n\n<p>It's not surprising that \"getter\" can't do much with the \"contained part\" but this signature looks like a <a href=\"https://hackage.haskell.org/package/contravariant-1.4/docs/src/Data.Functor.Contravariant.html#phantom\" rel=\"noreferrer\">Phantom</a> in a \"van Laarhoven\" setting of <code>(a -&gt; f a) -&gt; s -&gt; f s</code>. Is the implicit constraint \"<code>s</code> knows about <code>a</code>\" represented this way in <code>lens</code>?</p>\n\n<p>How can I find source code of some concrete instances of a <code>Getter</code> so that I can see <code>map</code> and <code>contramap</code> being used?</p>\n"}, {"tags": ["csv", "haskell", "dataframe"], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 2, "last_activity_date": 1471868338, "last_edit_date": 1471868338, "creation_date": 1471810023, "answer_id": 39068398, "question_id": 39067845, "link": "https://stackoverflow.com/questions/39067845/read-a-particular-line-from-a-csv-with-headers-in-haskell/39068398#39068398", "title": "Read a particular line from a CSV with headers in Haskell", "body": "<p>(1) gets you an [IO [(Text, Text)]], since you mapped an Int -> IO [(Text, Text)] over an [Int]. You want mapM.</p>\n\n<p>(2) !! is a smell. I would have getL make a whole list immediately, and if you really want to supply Ints afterwards you can still use !! at the call site:</p>\n\n<pre><code>readCSV :: FilePath -&gt; IO [[(Text,Text)]]\nreadCSV filename = do\n  headers : body &lt;- T.lines &lt;$&gt; I.readFile filename\n  return $ map (Prelude.zip (splitOn \",\" headers) . splitOn \",\") body\n</code></pre>\n\n<p>(3) <code>flines &lt;- T.lines &lt;$&gt; I.readFile filename</code> is a monadic bind and you can't just do that in a where clause, the only reason you can do it in a do block is because those are desugared to <code>&gt;&gt;=</code>.</p>\n\n<p>(4) Here's how it would look like desugared:</p>\n\n<pre><code>readCSV :: FilePath -&gt; IO [[(Text,Text)]]\nreadCSV filename =\n  (T.lines &lt;$&gt; I.readFile filename) &gt;&gt;= \\(headers : body) -&gt;\n  return $ map (Prelude.zip (splitOn \",\" headers) . splitOn \",\") body\n</code></pre>\n\n<p>Since filename is used only once at the end of the first line, this could, in fact, be written using <code>&gt;=&gt;</code>:</p>\n\n<pre><code>readCSV :: FilePath -&gt; IO [[(Text,Text)]]\nreadCSV =\n  fmap T.lines . I.readFile &gt;=&gt; \\(headers : body) -&gt;\n  return $ map (Prelude.zip (splitOn \",\" headers) . splitOn \",\") body\n</code></pre>\n\n<p>Since only return is used in the last line, we don't even need <code>&gt;=&gt;</code> - <code>fmap</code> is enough.</p>\n\n<pre><code>readCSV :: FilePath -&gt; IO [[(Text,Text)]]\nreadCSV =\n  fmap ( (\\(headers : body) -&gt; map (Prelude.zip (splitOn \",\" headers) . splitOn \",\") body)\n         . T.lines)\n  . I.readFile\n</code></pre>\n\n<p>Which of these is more readable, of course, is another question entirely.</p>\n\n<p>Edit: The last one suggests a further refactoring:</p>\n\n<pre><code>parseCSV :: Text -&gt; [[(Text, Text)]]\nparseCSV = \n  (\\(headers : body) -&gt; map (Prelude.zip (splitOn \",\" headers) . splitOn \",\") body)\n  . T.lines\n</code></pre>\n\n<p>And then you use it like, for example:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  [filename, field] &lt;- getArgs\n  csv &lt;- parseCSV &lt;$&gt; I.readFile filename\n  print $ traverse (lookup field) csv\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 39068398, "answer_count": 1, "score": 0, "last_activity_date": 1471868338, "creation_date": 1471806212, "question_id": 39067845, "link": "https://stackoverflow.com/questions/39067845/read-a-particular-line-from-a-csv-with-headers-in-haskell", "title": "Read a particular line from a CSV with headers in Haskell", "body": "<p>I'm just learning haskell, and trying to make a simple program that gives me a list of tuples of</p>\n\n<pre><code>(header, data)\n</code></pre>\n\n<p>when reading a CSV.  I'm trying to use <code>Data.Text.Lazy</code> and <code>Data.Text.Lazio.IO</code> because I understand\nthese have good performance and unicode coverage versus <code>String</code>.</p>\n\n<p>The function I'm working on will take a line number (<code>n</code>) and a CSV filename (<code>filename</code>) and return just the <code>(header, datum)</code> tuple</p>\n\n<p>Here's my CSV, \"dat.csv\"</p>\n\n<pre><code>ORDINAL,CATEGORICAL,BOOL,CONTINUOUS,INT\nLow,Blue,True,1.2,2\nMedium,Green,False,0.5,3\nHigh, Green,False,1.0,5\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>-- hs_reader.hs\n{-# LANGUAGE OverloadedStrings #-}\nimport Data.Text.Lazy as T\nimport Data.Text.Lazy.IO as I\nimport Control.Applicative\n\ngetL :: Int -&gt; FilePath -&gt; IO [(Text,Text)]\ngetL n filename =\n  do\n    flines &lt;- T.lines &lt;$&gt; I.readFile filename\n    let headers = Prelude.head flines\n    let body = Prelude.tail flines\n    let row = Prelude.zip (splitOn \",\" headers) (splitOn \",\" (body !! n))\n    return row\n</code></pre>\n\n<p>And this works like I want kinda:</p>\n\n<pre><code>Prelude&gt; :l hs_reader\n[1 of 1] Compiling Main             ( hs_reader.hs, interpreted )\nOk, modules loaded: Main.\nPrelude&gt; getL 1 \"dat.csv\"\n[(\"ORDINAL\",\"Medium\"),(\"CATEGORICAL\",\"Green\"),(\"BOOL\",\"False\"),(\"CONTINUOUS\",\"0.5\"),(\"INT\",\"3\")]\nPrelude&gt; getL 2 \"dat.csv\"\n[(\"ORDINAL\",\"High\"),(\"CATEGORICAL\",\" Green\"),(\"BOOL\",\"False\"),(\"CONTINUOUS\",\"1.0\"),(\"INT\",\"5\")]\n</code></pre>\n\n<p>I realize there's a lot I don't understand about how to use monads correctly.  I have 4 main questions:</p>\n\n<p>Question (1) I'd like to do a partial function application of this to a range of line numbers. Why doesn't this work?</p>\n\n<pre><code>let readF x = getL x \"dat.csv\"\n-- a\nPrelude.map readF [1..3]\n--\nPrelude&gt; Prelude.map readF [1..3]\n--\n&lt;interactive&gt;:514:1:\n    No instance for (Show (IO [(Text, Text)]))\n      arising from a use of \u2018print\u2019\n    In a stmt of an interactive GHCi command: print it\n--\n-- b.\nPrelude&gt; T.map readF [1..3]\n--\n&lt;interactive&gt;:515:7:\n    Couldn't match type \u2018IO [(Text, Text)]\u2019 with \u2018Char\u2019\n    Expected type: Char -&gt; Char\n      Actual type: Int -&gt; IO [(Text, Text)]\n    In the first argument of \u2018T.map\u2019, namely \u2018readF\u2019\n    In the expression: T.map readF [1 .. 3]\n--\n&lt;interactive&gt;:515:13:\n    Couldn't match expected type \u2018Text\u2019 with actual type \u2018[Integer]\u2019\n    In the second argument of \u2018T.map\u2019, namely \u2018[1 .. 3]\u2019\n    In the expression: T.map readF [1 .. 3]\n    In an equation for \u2018it\u2019: it = T.map readF [1 .. 3]\n</code></pre>\n\n<p>Question (2) Is there a more elegant way to do this? Can I do this without any let statements for example, since I have a do?</p>\n\n<p>Question (3) I tried to use the following because it looked more like examples I had seen online. Why doesn't this work? (I can't use \"&lt;-\" inside where?)</p>\n\n<pre><code>getL2 :: Int -&gt; FilePath -&gt;  [(Text,Text)]\ngetL2 n filename = do\n  Prelude.zip (splitOn \",\" headers) (splitOn \",\" (body !! n))\n  where \n    headers = Prelude.head flines\n    body = Prelude.tail flines\n    flines &lt;- T.lines &lt;$&gt; I.readFile filename\n--\n-- ERROR!\nhs_reader.hs:25:12:\n    parse error on input \u2018&lt;-\u2019\n    Perhaps this statement should be within a 'do' block?\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Question (4) I'm working with some monads.  Is one of these dudes applicable in an easy way to understand? >>= or >=> ?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1471805114, "post_id": 39067546, "comment_id": 65483510, "body": "You cannot control which tyvar names the compiler chooses. To &quot;bind and reduce&quot; a type variable doesn&#39;t even make sense to me. (<code>a</code> and <code>b</code> are not ambiguous in <code>fmap . const</code> because they don&#39;t appear in its type at all). Finally, I&#39;m not sure what the thought process here is - it seems like you&#39;re just asking GHCi for the type of an expression."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1471806458, "post_id": 39067546, "comment_id": 65483918, "body": "If I&#39;m understanding correctly, you are having trouble with the same type variable names being reused in different signatures? Different signatures have different scopes, so the type variables are completely unrelated to each other. When you construct an expression by applying other expressions, you might have to do capture avoiding substitution to find the correct type (if you&#39;re looking for that), but this is performed automatically by GHCi (for example, <code>:t fmap . const</code> will do this). I am also not sure what you mean by &quot;bind and reduce&quot; in this context."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1471807535, "post_id": 39067546, "comment_id": 65484222, "body": "Possibly another way to solve this problem would be to produce proof that type <code>:t fmap.const</code> is indeed what GHCI claims to be given types of <code>fmap</code> and <code>const</code>."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1471875943, "post_id": 39067546, "comment_id": 65511916, "body": "@sevo The result of <code>:t fmap . const</code> is a proof of its own result. That is, if the compiler gives an expression a type, then that is the type of that expression. If this wasn&#39;t the case, then what&#39;s the point of static type checking? I think what you want is a step-by-step explanation of how the compiler decides what the type should be."}], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": false, "score": 0, "last_activity_date": 1471875425, "creation_date": 1471875425, "answer_id": 39081907, "question_id": 39067546, "link": "https://stackoverflow.com/questions/39067546/bind-type-variables-in-a-ghci-session/39081907#39081907", "title": "Bind type variables in a GHCI session", "body": "<p>The type variables in signatures are actually bound by an implicit universal quantifier. There is a language extension to make it explicit, check that this compiles :</p>\n\n<pre><code>{-# LANGUAGE ExplicitForAll #-}\n\nfmapPrime :: forall a b f. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nfmapPrime = fmap\n\nconstPrime :: forall a b. a -&gt; b -&gt; a\nconstPrime = const\n\nfmapConst :: forall a b f. Functor f =&gt; b -&gt; f a -&gt; f b\nfmapConst = fmap . const\n</code></pre>\n\n<p>So you cannot say that the type variables variables are \"reused\" : they are not free.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471875425, "creation_date": 1471804181, "question_id": 39067546, "link": "https://stackoverflow.com/questions/39067546/bind-type-variables-in-a-ghci-session", "title": "Bind type variables in a GHCI session", "body": "<p>Let's take <code>fmap . const</code> as a simple example where I try to understand what it does:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nconst :: a -&gt; b -&gt; a\n</code></pre>\n\n<p>The fist thing I notice is that <code>a</code>, <code>b</code> are ambiguous when I try to understand <code>fmap . const</code>. The use of two or more related signatures together is what I mean by \"<code>GHCI</code> session\".</p>\n\n<p>Here's example of what would help me understand things better:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nconst :: c -&gt; d -&gt; c\nfmap . const :: Functor g =&gt; h -&gt; g i -&gt; g h\n</code></pre>\n\n<p>Let's bind <code>g = f</code> and reduce <code>g</code>:</p>\n\n<pre><code>fmap . const :: Functor f =&gt; h -&gt; f i -&gt; f h\n</code></pre>\n\n<p>Pick <code>h :: h</code> as a least-confusing variable name for the pointful version:</p>\n\n<pre><code>\\h -&gt; fmap (const h) :: Functor f =&gt; h -&gt; f i -&gt; f h\n</code></pre>\n\n<p>Let's bind <code>h = c</code> and reduce <code>h</code>:</p>\n\n<pre><code>\\c -&gt; fmap (const c) :: Functor f =&gt; c -&gt; f i -&gt; f c\n</code></pre>\n\n<p>Now, it is much easier to see that <code>c</code> in <code>f c</code> came from first argument to <code>const</code>. I also see that <code>i</code> and <code>a</code> are free since I did not need to \"operate\" on them.</p>\n\n<p>Questions:</p>\n\n<ul>\n<li>Is there a way to prevent letters being re-used in a <code>GHCI</code> session?</li>\n<li>Is there a way to bind and reduce type variables in a <code>GHCI</code> session?</li>\n<li>Finally, I suspect there is an easier way to do the equivalent thought process.</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1471786969, "post_id": 39064797, "comment_id": 65478244, "body": "Running <a href=\"https://www.haskell.org/hoogle/?hoogle=%3A%3A+Functor+f+%3D%3E+f+a+-%3E+%28a+-%3E+b%29+-%3E+f+b+%2Bbase\" rel=\"nofollow noreferrer\">this query</a> in Hoogle does not return an exact match. I don&#39;t think there is, unfortunately."}, {"owner": {"reputation": 310, "user_id": 1640122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4032ecb7e9b24ad9cb2bcc0b8b8b04fa?s=128&d=identicon&r=PG", "display_name": "Haochen Xie", "link": "https://stackoverflow.com/users/1640122/haochen-xie"}, "reply_to_user": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1471787247, "post_id": 39064797, "comment_id": 65478326, "body": "yes, I did exactly the same query but found nothing: thus came this question"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1471788796, "post_id": 39064797, "comment_id": 65478842, "body": "If Hoogle doesn&#39;t find anything, <a href=\"http://hayoo.fh-wedel.de/?query=Functor+f+%3D%3E+f+a+-%3E+%28a+-%3E+b%29+-%3E+f+b\" rel=\"nofollow noreferrer\">try Hayoo</a> (which searches more packages by default). There&#39;s nothing in the standard library, but there are many <code>&lt;&amp;&gt;</code>s in various libs."}, {"owner": {"reputation": 310, "user_id": 1640122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4032ecb7e9b24ad9cb2bcc0b8b8b04fa?s=128&d=identicon&r=PG", "display_name": "Haochen Xie", "link": "https://stackoverflow.com/users/1640122/haochen-xie"}, "edited": false, "score": 0, "creation_date": 1471840056, "post_id": 39064797, "comment_id": 65491004, "body": "Downvoter, could you please leave a comment so that I could know how to improve my question?"}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1471787248, "post_id": 39064864, "comment_id": 65478327, "body": "<a href=\"http://hackage.haskell.org/package/microlens\" rel=\"nofollow noreferrer\">microlens</a> also has this function."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1471787141, "last_edit_date": 1471787141, "creation_date": 1471786965, "answer_id": 39064864, "question_id": 39064797, "link": "https://stackoverflow.com/questions/39064797/haskell-is-there-an-operator-like-this-functor-f-f-a-a-b/39064864#39064864", "title": "Haskell: Is there an operator like this: (&lt;$$&gt;) :: Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b", "body": "<p>It's not anywhere in the <code>base</code> package. The most commonly used library that exports this function is <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow\"><code>lens</code></a>, <a href=\"https://hackage.haskell.org/package/lens-4.14/docs/Control-Lens-Operators.html#v:-60--38--62-\" rel=\"nofollow\">as <code>&lt;&amp;&gt;</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1471804409, "post_id": 39066955, "comment_id": 65483326, "body": "This doesn&#39;t use <code>TupleSections</code> (or tuples for that matter). It is just an operator section, which requires no extension."}], "tags": [], "owner": {"reputation": 21, "user_id": 6741004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef35e267f7438bf82f27a65e099fa46?s=128&d=identicon&r=PG&f=1", "display_name": "julm", "link": "https://stackoverflow.com/users/6741004/julm"}, "is_accepted": false, "score": 2, "last_activity_date": 1471814563, "last_edit_date": 1471814563, "creation_date": 1471800626, "answer_id": 39066955, "question_id": 39064797, "link": "https://stackoverflow.com/questions/39064797/haskell-is-there-an-operator-like-this-functor-f-f-a-a-b/39066955#39066955", "title": "Haskell: Is there an operator like this: (&lt;$$&gt;) :: Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b", "body": "<p>Note also that, as often to flip arguments, operator sections may be \"enough\" and may perhaps preserve readability by limiting the introduction of new operators:</p>\n\n<pre><code>&gt; :{\n| (&lt;$&gt; Just 0) $ \\x -&gt;\n|   x + 1 + 1 + 1\n|     + 1 + 1 + 1\n|     + 1 + 1 + 1\n|     + 1 + 1 + 1\n| :}\nJust 12\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 1640122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4032ecb7e9b24ad9cb2bcc0b8b8b04fa?s=128&d=identicon&r=PG", "display_name": "Haochen Xie", "link": "https://stackoverflow.com/users/1640122/haochen-xie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 39064864, "answer_count": 2, "score": -1, "last_activity_date": 1471814563, "creation_date": 1471786572, "question_id": 39064797, "link": "https://stackoverflow.com/questions/39064797/haskell-is-there-an-operator-like-this-functor-f-f-a-a-b", "title": "Haskell: Is there an operator like this: (&lt;$$&gt;) :: Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b", "body": "<p>Finding out that map and flat map in Haskell could be performed the this way,</p>\n\n<pre><code>xs &gt;&gt;= f          \u2243 flatMap f xs\nxs &gt;&gt;= return . f \u2243 map f xs\n</code></pre>\n\n<p>I thought it would be convenient if we have such an operator</p>\n\n<pre><code>(&lt;$$&gt;) :: Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b\nf &lt;$$&gt; fn = fn &lt;$&gt; f\n</code></pre>\n\n<p>so that map could be expressed more tidily:</p>\n\n<pre><code>xs &gt;&gt;=  f \u2243 flatMap f xs\nxs &lt;$$&gt; f \u2243 map f xs\n</code></pre>\n\n<p>Does such an operator exist in Haskell's standard library?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 858, "user_id": 3677952, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/kst8c.jpg?s=128&g=1", "display_name": "Dr. John A Zoidberg", "link": "https://stackoverflow.com/users/3677952/dr-john-a-zoidberg"}, "edited": false, "score": 0, "creation_date": 1471774550, "post_id": 39062828, "comment_id": 65475037, "body": "What is the meaning of the &quot;in if&quot;?"}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "reply_to_user": {"reputation": 858, "user_id": 3677952, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/kst8c.jpg?s=128&g=1", "display_name": "Dr. John A Zoidberg", "link": "https://stackoverflow.com/users/3677952/dr-john-a-zoidberg"}, "edited": false, "score": 1, "creation_date": 1471775039, "post_id": 39062828, "comment_id": 65475148, "body": "This is just a <code>let ... in</code> clause followed by a  <code>if</code> expression. Nothing magic here."}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 2, "last_activity_date": 1471772224, "creation_date": 1471772224, "answer_id": 39062828, "question_id": 39062757, "link": "https://stackoverflow.com/questions/39062757/haskell-parse-error-in-nested-where-clause/39062828#39062828", "title": "Haskell: Parse Error in nested where clause", "body": "<p>I believe you wanted to write <code>filter</code> with a do-notation. You could just add a <code>do</code> just after the <code>filter ls indx =</code>. However, this code being pure (i.e. non monadic), I would recommend this syntax:</p>\n\n<pre><code>primeSieve :: Int -&gt; [Int] -- Returns a list of primes up to upperbound\nprimeSieve upperbound = filter [2..upperbound]\n  where\n    filter ls indx =\n        let divisor = (ls!!indx)\n            filtered = [x | x &lt;- ls, x `mod` divisor /= 0]\n        in if divisor*divisor &gt;= last filtered\n          then filtered\n          else filter filtered (indx+1)\n</code></pre>\n\n<p>... but your code gives me the following error:</p>\n\n<pre><code>&lt;file&gt;:13:25:\nCouldn't match expected type `[Int]'\n            with actual type `Int -&gt; [Int]'\nProbable cause: `filter' is applied to too few arguments\nIn the expression: filter [2 .. upperbound]\nIn an equation for `primeSieve':\n    primeSieve upperbound\n      = filter [2 .. upperbound]\n      where\n          filter ls indx\n            = let ...\n              in\n                if divisor * divisor &gt;= last filtered then\n                    filtered\n                else\n                    filter filtered (indx + 1)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I think you meant to pass <code>0</code> as a second argument to <code>filter</code>:</p>\n\n<pre><code>primeSieve :: Int -&gt; [Int] -- Returns a list of primes up to upperbound\nprimeSieve upperbound = filter [2..upperbound]\n  where\n    filter ls indx =\n        let divisor = (ls!!indx)\n            filtered = [x | x &lt;- ls, x `mod` divisor /= 0]\n        in if divisor*divisor &gt;= last filtered\n          then filtered\n          else filter filtered (indx+1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2995, "user_id": 1095506, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07067c06a12496ca32eb400313ef4ab6?s=128&d=identicon&r=PG", "display_name": "mariop", "link": "https://stackoverflow.com/users/1095506/mariop"}, "is_accepted": true, "score": 1, "last_activity_date": 1471773081, "creation_date": 1471773081, "answer_id": 39062929, "question_id": 39062757, "link": "https://stackoverflow.com/questions/39062757/haskell-parse-error-in-nested-where-clause/39062929#39062929", "title": "Haskell: Parse Error in nested where clause", "body": "<p>The issue is the indentation of the definition of <code>filter</code> which is smaller than what it shoul be. The important part is</p>\n\n\n\n<pre><code>where filter ls indx = \n  let divisor = (ls!!indx)\n</code></pre>\n\n<p>where the <code>let</code> starts 4 characters before the <code>filter</code> on the line above. That triggers the syntax error. To fix it you can indent more the <code>filter</code> definition</p>\n\n\n\n<pre><code>where filter ls indx = \n        let divisor = (ls!!indx)\n</code></pre>\n\n<p>a more common format is</p>\n\n\n\n<pre><code>where\n  filter ls indx = \n    let divisor = (ls!!indx)\n</code></pre>\n\n<p>because in this way you don't indent too much.</p>\n\n<p>You can find more information about indentation on the <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation\" rel=\"nofollow\">haskell wiki</a> which contains some nice visual examples about this kind of errors.</p>\n"}], "owner": {"reputation": 858, "user_id": 3677952, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/kst8c.jpg?s=128&g=1", "display_name": "Dr. John A Zoidberg", "link": "https://stackoverflow.com/users/3677952/dr-john-a-zoidberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 39062929, "answer_count": 2, "score": 0, "last_activity_date": 1471773081, "creation_date": 1471771646, "question_id": 39062757, "link": "https://stackoverflow.com/questions/39062757/haskell-parse-error-in-nested-where-clause", "title": "Haskell: Parse Error in nested where clause", "body": "<p>I have the following code, which implements the sieve or Eratosthenes:</p>\n\n<pre><code>primeSieve :: Int -&gt; [Int] -- Returns a list of primes up to upperbound\nprimeSieve upperbound = filter[2..upperbound] \n  where filter ls indx = \n    let divisor = (ls!!indx)\n    let filtered = [x | x &lt;- ls, x `mod` divisor /= 0]\n    if divisor*divisor &gt;= last filtered\n      then filtered\n      else filter filtered (indx+1)\n</code></pre>\n\n<p>I get a parse error on line 4, \"possible incorrect indentation or mismatched brackets\". </p>\n\n<p>Why is this? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1471754536, "post_id": 39060871, "comment_id": 65471252, "body": "The link from @amalloy explains something similar. Haskell number literals are overloaded, so they can have any type (as long as that type is an instance of <code>Num</code>).  You could (although it would be a terrible idea) define an instance of <code>Num</code> for functions, in which case the above would actually work."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1471754735, "post_id": 39060871, "comment_id": 65471274, "body": "<i>Any</i> type can be an instance of any given class - this is the open world assumption. <code>a -&gt; b</code> can be an instance of <code>Num</code> if you write <code>instance (..) =&gt; Num (a -&gt; b)</code> in a module and bring that module into scope. As an aside, there is a reasonable <code>Num a =&gt; Num (F a)</code> instance for any <code>Applicative F</code>, so the constraint <code>Num (a -&gt; b)</code> is not even so crazy."}], "owner": {"reputation": 113, "user_id": 4513188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/609cd019a4304cc8d0bbb4b0fc6f4076?s=128&d=identicon&r=PG&f=1", "display_name": "haskell looks great", "link": "https://stackoverflow.com/users/4513188/haskell-looks-great"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "closed_date": 1471766931, "answer_count": 0, "score": 0, "last_activity_date": 1471754134, "creation_date": 1471754134, "question_id": 39060871, "link": "https://stackoverflow.com/questions/39060871/weird-type-inference-in-haskell", "closed_reason": "Duplicate", "title": "Weird type inference in Haskell", "body": "<p>When asking GHCi the type of expression <code>2 . (+1)</code>, I am told of a type expression that doesn't make much sense to me:</p>\n\n<pre><code>Prelude \u03bb : :type 2 . (+1) \n2 . (+1) :: (Num b, Num (b -&gt; c)) =&gt; b -&gt; c\n</code></pre>\n\n<p>How can a function <code>b-&gt;c</code> be of class <code>Num</code>?</p>\n"}, {"tags": ["algorithm", "haskell", "graph"], "comments": [{"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 1, "creation_date": 1471736946, "post_id": 39059037, "comment_id": 65468802, "body": "Okay, I haven&#39;t thought the details through, but would it be enough to take FGL and implement its <code>Graph</code> and <code>DynGraph</code> classes with a fully lazy structure of some sort, instead of <code>IntMap</code>?"}, {"owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "reply_to_user": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 1, "creation_date": 1471740640, "post_id": 39059037, "comment_id": 65469317, "body": "@TikhonJelvis It looks like the typeclass was written with finite graphs in mind (e.g. the <code>noNodes</code> function), and I imagine that code that uses the typeclass makes similar assumptions.  (iow possibly worth a try, but seems dangerous)"}, {"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471741177, "post_id": 39059037, "comment_id": 65469385, "body": "I don&#39;t quite understand why you aren&#39;t just using your already-existing graph implementation. I feel like something important is missing."}, {"owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "reply_to_user": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 1, "creation_date": 1471741805, "post_id": 39059037, "comment_id": 65469476, "body": "@MarLinn it&#39;s that I keep needing stuff like this across new projects.  I could just try packaging some of my existing implementations up, but it would feel like a silly dependency for some things to have, and knowing me I&#39;d also waste days fretting over little design decisions in the API."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1471790574, "post_id": 39059037, "comment_id": 65479414, "body": "Not to be a stick in he mud, but why is this being upvoted? It&#39;s well asked, sure, but asking for external resources is explicitly off-topic."}, {"owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "edited": false, "score": 0, "creation_date": 1471793057, "post_id": 39059037, "comment_id": 65480136, "body": "Agh, you&#39;re right. :/  I guess this falls more under the scope of softwarerecs..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471806593, "post_id": 39059037, "comment_id": 65483954, "body": "I fixed it. Just ask how to abstract out this pattern, rather than asking for a library to do so. If there&#39;s a library, someone may point it out. If not, someone may invent something."}, {"owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471807813, "post_id": 39059037, "comment_id": 65484314, "body": "@dfeuer It feels like that sort of confounds the question though, since in it I already present what I find to be a successful abstraction for solving these problems.  Perhaps the question should instead just be open to alternative ways of looking at or solving these problems? (since people clearly do manage to get by without such a library)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471808164, "post_id": 39059037, "comment_id": 65484441, "body": "@ExpHP, if there&#39;s a part you get tired of writing, that means you haven&#39;t hit upon an abstraction that you can stick in a module/package of your own and use over and over. The problem with your question was that you were asking <i>where to find</i> a library. A better approach is to ask <i>how to write</i> one, but leaving things loose enough that people will feel free to let you know that you don&#39;t need to do that because someone else already did."}, {"owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "edited": false, "score": 1, "creation_date": 1471811251, "post_id": 39059037, "comment_id": 65485257, "body": "note: since posting the question, I actually have started working on some skeleton of a library, since upon reflection it didn&#39;t really seem that I had a good reason to be so apprehensive about doing so."}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "edited": false, "score": 0, "creation_date": 1471786515, "post_id": 39064524, "comment_id": 65478097, "body": "Very nice find!  Note that not all of my problems are search problems; other frequent ones are extracting a component of finite size, or using the DFS postorder to compute a recursively-defined property of the nodes like <a href=\"https://en.wikipedia.org/wiki/Nimber\" rel=\"nofollow noreferrer\">nimbers</a> or centrality. But perhaps this suggests I should be looking for smaller, single purpose libraries. :)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 7, "last_activity_date": 1471784798, "creation_date": 1471784798, "answer_id": 39064524, "question_id": 39059037, "link": "https://stackoverflow.com/questions/39059037/library-for-working-with-potentially-infinite-graphs-defined-by-neighbor-list/39064524#39064524", "title": "Library for working with (potentially infinite) graphs defined by neighbor-list functions", "body": "<p>I think most \"breadth-first\" search algorithms are really some sort of <a href=\"https://en.wikipedia.org/wiki/Best-first_search\" rel=\"noreferrer\">\"best-first\" algorithm</a>. That is, the search frontier is placed in a priority queue\nwhich determines the order in which the nodes are visited.</p>\n\n<p>I found two packages which implement general best-first algorithms:</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/astar\" rel=\"noreferrer\">astar</a></li>\n<li><a href=\"https://hackage.haskell.org/package/monad-dijkstra\" rel=\"noreferrer\">monad-dijkstra</a></li>\n</ul>\n\n<p>Both of these modules have very generic interfaces - i.e. you supply a neighbor\nfunction, an inter-node distance function and (in the case of A-star) a heuristic\nfunction.</p>\n\n<p>With the appropriate choice of heuristic and distance functions you might be able to map\nyour search into one of these algorithms.\nFor instance, <a href=\"https://www.google.com/patents/US7313555\" rel=\"noreferrer\">this patent</a> describes a way of employing A-star\nto solve the edit distance problem.</p>\n"}], "owner": {"reputation": 675, "user_id": 166765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6593e0e838ac7520884ef575a45be58f?s=128&d=identicon&r=PG", "display_name": "Exp HP", "link": "https://stackoverflow.com/users/166765/exp-hp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 4, "accepted_answer_id": 39064524, "answer_count": 1, "score": 11, "last_activity_date": 1471806533, "creation_date": 1471730296, "last_edit_date": 1471806533, "question_id": 39059037, "link": "https://stackoverflow.com/questions/39059037/library-for-working-with-potentially-infinite-graphs-defined-by-neighbor-list", "title": "Library for working with (potentially infinite) graphs defined by neighbor-list functions", "body": "<p>Here's a pattern I've used countless times across a variety of programming languages:</p>\n\n<ol>\n<li>Encounter a problem which can be easily reduced to some graph algorithm.</li>\n<li>Define an adjacency function: <code>outEdges :: MyNode -&gt; [MyNode]</code>.</li>\n<li>Code up some general form of said graph algorithm which takes this function as its first argument.</li>\n</ol>\n\n<p>As an example, consider this <em>(purposefully inefficient)</em> method for computing the <strong>edit distance</strong> between two words.  We will count the least number of insertions and deletions necessary to transform one word into another via breadth first search.</p>\n\n<pre><code>import Data.List\nimport Data.Maybe\n\nalphabet :: String\nalphabet = ['a'..'z']\n\nwordNeighbors :: String -&gt; [String]\nwordNeighbors word = deletions ++ insertions where\n    insertions = [pre++[c]++suf | (pre,suf) &lt;- splits, c &lt;- alphabet]\n    deletions =  [pre++suf      | (pre,_:suf) &lt;- take (length word) splits]\n\n    splits = zip (inits word) (tails word)\n\nshortestDistance :: (Eq a,Hashable a)=&gt; (a -&gt; [a]) -&gt; a -&gt; a -&gt; Maybe Int\nshortestDistance edgeFunc source target =\n    -- 8 lines of code where I do a breadth-first traversal,\n    -- using a HashSet to track previously visited nodes;\n    -- yawn...\n\neditDistance :: String -&gt; String -&gt; Int\neditDistance a b = fromJust $ shortestDistance wordNeighbors a b\n\nmain = print $ editDistance \"cat\" \"can\"  -- prints 2\n</code></pre>\n\n<p>The problem is, <strong>I'm getting awfully tired of step 3.</strong> (see <code>shortestDistance</code> above...)</p>\n\n<p>I feel like I've written <em>the same algorithms hundreds of times.</em> I'd love it if I could instead just somehow utilize FGL or Data.Graph and be done with it, but as far as I can tell both ultimately require the construction of some sort of <code>Graph</code> data structure which is strict with respect to the set of all nodes.  This is an issue because in many problems, <em>the graph is infinite</em> (such as in the example above).</p>\n\n<p>I specifically ask about Haskell because Haskell has such a strong focus on combinators that I somehow expected many of these algorithms to already exist somewhere.</p>\n\n<hr>\n\n<p><strong>Addendum:</strong> Here are other examples of functions I frequently write besides shortest-path:</p>\n\n<pre><code>-- Useful for organizing the computation of a recursively-defined\n-- property of the nodes in an acyclic graph, such as nimbers.\ndfsPostOrder :: (v -&gt; [v]) -&gt; v -&gt; [v]\ndfsPostOrder adjFunc root = ...\n\n-- Find all nodes connected in some manner to the root node.\n-- In case I know the components are finite size, but am not sure\n-- of a nice way to express their contents.\n-- (Note: The API below is only good for undirected graphs)\ngetComponent :: (v -&gt; [v]) -&gt; v -&gt; Set v\ngetComponent adjFunc root = ...\n\n-- Lazily organize the graph into groups by their minimum distance\n-- to any of the nodes in @roots@.\n-- One could use this to help incrementalize parts of e.g. a Game\n-- of Life or Kinetic Monte Carlo simulation by locating regions\n-- invalidated by changes in the state.\ngroupsByProximity :: (v -&gt; [v]) -&gt; Set v -&gt; [Set v]\ngroupsByProximity adjFunc roots = ...\n</code></pre>\n\n<hr>\n\n<p><strong>TL;DR:</strong>  Is there any general way to write algorithms that work on potentially infinite, potentially cyclic, directed graphs---such as one defined by an adjacency function (<code>Node -&gt; [Node]</code> or <code>Node -&gt; [(Node, Weight)]</code>)?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1471730211, "post_id": 39058971, "comment_id": 65467563, "body": "Can you show your .cabal file?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471730591, "post_id": 39058971, "comment_id": 65467637, "body": "Do you have an <code>executable</code> stanza or <code>library</code> stanza or both?"}, {"owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471730915, "post_id": 39058971, "comment_id": 65467703, "body": "@ErikR I just figured this out after you requested the cabal file and I went to anonymize it, lol. It is indeed a confusion of stanzas. I didn&#39;t expect more than one so just added the dependencies to the first <code>build-depends</code> I saw. If you concoct some kind of answer to that effect I&#39;ll accept it. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1471731298, "creation_date": 1471731298, "answer_id": 39059143, "question_id": 39058971, "link": "https://stackoverflow.com/questions/39058971/stack-cant-find-chart-or-chart-cairo-though-the-cabal-file-calls-for-them/39059143#39059143", "title": "Stack can&#39;t find Chart or Chart-cairo, though the cabal file calls for them", "body": "<p>If you have both an <code>executable</code> and <code>library</code> stanza, try listing\nthe dependencies in both.</p>\n\n<p>If your executable depends on those dependencies but you've only listed\nthem in your library stanza you'll get that error - dependencies from\ndifferent stanzas are independent of each other.</p>\n"}], "owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 39059143, "answer_count": 1, "score": 1, "last_activity_date": 1471731298, "creation_date": 1471729647, "last_edit_date": 1471730240, "question_id": 39058971, "link": "https://stackoverflow.com/questions/39058971/stack-cant-find-chart-or-chart-cairo-though-the-cabal-file-calls-for-them", "title": "Stack can&#39;t find Chart or Chart-cairo, though the cabal file calls for them", "body": "<p>I'm trying to use Haskell stack (lts-6.12 resolver) to set up and run a <a href=\"http://hackage.haskell.org/package/Chart-1.8/docs/Graphics-Rendering-Chart-Easy.html\" rel=\"nofollow\">small demo program</a> for Chart. I created the project with <code>stack new</code>, <code>stack init</code>, etc. then modified the generated <code>Main.hs</code>, adding the demo code. I also added the Chart and Chart-cairo packages to the .cabal file and ran <code>stack build</code>. Lots and lots of packages installed, including Chart and Chart-cairo, judging from the output, and when it was finally done, it tried to compile <code>Main.hs</code>, but failed with the following errors:</p>\n\n<pre><code>/home/asdf/my-project/app/Main.hs:4:8:\nCould not find module \u2018Graphics.Rendering.Chart.Easy\u2019\nIt is a member of the hidden package \u2018Chart-1.6@Chart_Cz416CvPROo70VikOoIoki\u2019.\nPerhaps you need to add \u2018Chart\u2019 to the build-depends in your .cabal file.\nUse -v to see a list of the files searched for.\n\n/home/asdf/my-project/app/Main.hs:5:8:\nCould not find module \u2018Graphics.Rendering.Chart.Backend.Cairo\u2019\nIt is a member of the hidden package \u2018Chart-cairo-1.6@Chart_I1HGJHEm7pvIiSoYgOrXbq\u2019.\nPerhaps you need to add \u2018Chart-cairo\u2019 to the build-depends in your .cabal file.\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>How can stack be loading these packages successfully, then be somehow unable to find them later? How can it have the nerve (jk) to ask me to put the dependencies in my .cabal file, when it has already obtained them from there to load them in the first place?</p>\n\n<p>Here is the dependency list:</p>\n\n<pre><code>$ stack list-dependencies\nChart 1.6\nChart-cairo 1.6\nStateVar 1.1.0.4\nadjunctions 4.3\narray 0.5.1.0\nbase 4.8.2.0\nbase-orphans 0.5.4\nbifunctors 5.2\nbinary 0.7.5.0\nbytestring 0.10.6.0\ncairo 0.13.1.1\ncolour 2.3.3\ncomonad 4.2.7.2\ncontainers 0.5.6.2\ncontravariant 1.4\ndata-default-class 0.0.1\ndeepseq 1.4.1.1\ndistributive 0.5.0.2\nexceptions 0.8.3\nfilepath 1.4.0.0\nfree 4.12.4\nghc-prim 0.4.0.0\nhashable 1.2.4.0\nhmatrix 0.17.0.2\ninteger-gmp 1.0.0.0\nkan-extensions 4.2.3\nlens 4.13\nmachine-learning 0.1.0.0\nmtl 2.2.1\nold-locale 1.0.0.7\noperational 0.2.3.3\nparallel 3.2.1.0\nprelude-extras 0.4.0.3\nprimitive 0.6.1.0\nprofunctors 5.2\nrandom 1.1\nreflection 2.1.2\nsemigroupoids 5.0.1\nsemigroups 0.18.1\nsplit 0.2.3.1\nstm 2.4.4.1\nstorable-complex 0.2.2\ntagged 0.8.4\ntemplate-haskell 2.10.0.0\ntext 1.2.2.1\ntime 1.5.0.1\ntransformers 0.4.2.0\ntransformers-compat 0.4.0.4\nunordered-containers 0.2.7.1\nutf8-string 1.0.1.1\nvector 0.11.0.0\nvoid 0.7.1\n</code></pre>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1471781464, "post_id": 39058020, "comment_id": 65476724, "body": "good answer but If I replace <code>string &quot;No&quot;</code> with <code>&quot;return &quot;No&quot;</code>(something that always succeeds) it doesn&#39;t backtrack even with <code>&lt;|&gt;</code> when <code>spaceornull</code> succeeds"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1471781620, "post_id": 39058020, "comment_id": 65476772, "body": "Well, yes... <code>&lt;|&gt;</code> only considers the RHS parser if the LHS fails without consuming input. So?"}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1471783815, "post_id": 39058020, "comment_id": 65477351, "body": "what about <code>try</code> ? I mean <code>(try $ spaceornull *&gt; string &quot;hello&quot;) &lt;|&gt; (return &quot;No&quot;)</code> shouldn&#39;t fail with input <code>&quot; &quot;</code> !!!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1471785143, "post_id": 39058020, "comment_id": 65477707, "body": "Correct, it doesn&#39;t fail but yields <code>&quot;No&quot;</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1471722583, "last_edit_date": 1471722583, "creation_date": 1471721853, "answer_id": 39058020, "question_id": 39057940, "link": "https://stackoverflow.com/questions/39057940/why-doesnt-parsec-backtrack-when-one-part-of-the-parser-succeeds-and-the-rest-f/39058020#39058020", "title": "Why doesn&#39;t Parsec backtrack when one part of the parser succeeds and the rest fails?", "body": "<p><code>try</code> has nothing to do with whether failure is allowed or not. It merely makes it <em>possible</em> to backtrack in case of failure<sup>\u2020</sup>, but to commence the backtracking you need to provide an alternative parser to start at that point. The usual way to do that is with the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Applicative.html#v:-60--124--62-\" rel=\"noreferrer\"><code>&lt;|&gt;</code> operator</a>:</p>\n\n<pre><code>a = optionMaybe $ (try $ spaceornull *&gt; string \"hello\") &lt;|&gt; string \"No\"\n</code></pre>\n\n<p>OTOH, your code is equivalent to</p>\n\n<pre><code>a = optionMaybe $ (try $ spaceornull *&gt; string \"hello\") &gt;&gt; string \"No\"\n</code></pre>\n\n<p>where the monadic chaining <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad-Instances.html#v:-62--62-\" rel=\"noreferrer\">operator <code>&gt;&gt;</code></a> (same as <a href=\"http://hackage.haskell.org/package/base/docs/Control-Applicative.html#v:-42--62-\" rel=\"noreferrer\"><code>*&gt;</code></a>) will in the case of parsec check if the LHS succeeds, <em>then</em> go on and also run the RHS parser. So it must be, because you could also write:</p>\n\n<pre><code>a = optionMaybe $ do\n       s &lt;- try $ spaceornull *&gt; string \"hello\"\n       string $ \"No\"++s\n</code></pre>\n\n<p>Here I've used the result of the first parser (which you simply threw away, by not <code>&lt;-</code>-matching it to any variable) in deciding <em>what</em> the second one should look for. This clearly is only possible of the first actually succeeded!</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>Basically, <code>&lt;|&gt;</code> only works if either the LHS <em>immediately</em> fails right at the first character, or if you set a backtracking point with <code>try</code>. The reason this is required is that it would be very inefficient if parsec would need to leave a backtracking point before each and every alternative that needs to be ckecked.</sub></p>\n"}], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 39058020, "answer_count": 1, "score": 3, "last_activity_date": 1472143993, "creation_date": 1471721254, "last_edit_date": 1472143993, "question_id": 39057940, "link": "https://stackoverflow.com/questions/39057940/why-doesnt-parsec-backtrack-when-one-part-of-the-parser-succeeds-and-the-rest-f", "title": "Why doesn&#39;t Parsec backtrack when one part of the parser succeeds and the rest fails?", "body": "<p>I have this parsec parser : </p>\n\n<pre><code>a = optionMaybe $ do {try $ spaceornull *&gt; string \"hello\";string \"No\"}                        \n</code></pre>\n\n<p>Where <code>spaceornull</code> is <code>((:[]) &lt;$&gt; try space) &lt;|&gt; string \"\"</code>  </p>\n\n<p>When I test a with input \" \" I get : </p>\n\n<blockquote>\n  <p>Left (line 1, column 2):<br>\n    unexpected end of input<br>\n    expecting \"hello\"</p>\n</blockquote>\n\n<p>I don't understand this, <code>spaceornull *&gt; string \"hello\"</code> should fail because there is no \"hello\", then with <code>try</code> parsec backtracks and now there is no consumed input but <code>try</code> fails anyway so the parser passed to <code>optionMaybe</code> (the one inside <code>do</code>) fails altogether, it shouldn't try to consume farther input, so we end up with a failed parser without consuming any input so I should get <code>Right Nothing</code>.  </p>\n\n<p>But the error message says it, the space is consumed so <code>try</code> didn't really backtrack, does <code>try</code> not backtrack when part of parser succeeds ? and how to make it backtrack with the above ?</p>\n"}, {"tags": ["haskell", "monads", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1471720653, "post_id": 39057576, "comment_id": 65465146, "body": "If you run (abusing the notation) <code>(var 0 (var 1)) [\\x -&gt; x]</code>, you&#39;ll get <code>(\\x -&gt; x) (var 1)</code>, which doesn&#39;t have a syntactic representation in your type system. Note that both <code>subst</code>s in the paper receive inferrable terms and there is no <code>subst : TermC -&gt; TermC -&gt; TermC</code>. It&#39;s not necessarily to have bidirectional type system in order to define a bidirectional type checker, so you can just collapse these mutually recursive data types into a single <code>Term</code>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1471773505, "post_id": 39057576, "comment_id": 65474764, "body": "<code>bound</code> doesn&#39;t support mutual data, but (as said above) you can do your type checker with a single data definition. The indexed version of <code>bound</code> can do mutual data (<a href=\"http://lpaste.net/79582\" rel=\"nofollow noreferrer\">for example</a>), but it doesn&#39;t exist as published library."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1471778913, "post_id": 39057576, "comment_id": 65476096, "body": "Throwing everything into a single datatype is not without downsides: it lets you write a <code>Lam</code> without an annotation, which should not be syntactically valid. I suppose I could require a type in the <code>Lam</code> constructor (<code>Lam (Scope () Term a) Type</code>), but then you get superfluous annotations for nested lambdas, and you have to support an additional construct for annotating other terms."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471800479, "post_id": 39057576, "comment_id": 65482242, "body": "If <code>bound</code> doesn&#39;t do the trick, you may look into the more typey paper <code>bound</code> simplifies. I don&#39;t know if it&#39;s the right sort of typey, but it&#39;s worth checking."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471807713, "post_id": 39057576, "comment_id": 65484281, "body": "@dfeuer D&#39;you mean <a href=\"http://staff.city.ac.uk/~ross/papers/debruijn.ps.gz\" rel=\"nofollow noreferrer\"><i>de Bruijn Notation as a Nested Datatype</i></a>? As far as I can tell, the only difference between <code>bound</code> and that paper is that <code>bound</code>&#39;s <code>Var</code> has an extra parameter to account for the type of variables bound in a particular scope. (If anything <code>bound</code> is the more typey of the two!)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471807848, "post_id": 39057576, "comment_id": 65484330, "body": "@BenjaminHodgson, yes, I was really just guessing. I haven&#39;t read the paper!"}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1471902032, "post_id": 39076810, "comment_id": 65526098, "body": "This kinda works - you get the <code>Monad</code> instance - but it ends up ugly. You can&#39;t use most of <code>bound</code>&#39;s combinators (including <code>&gt;&gt;&gt;=</code> - you have to implement <code>subst</code> by <code>fmap</code>ping under the <code>Scope</code>) because they require a <code>Monad</code> instance for <code>Scope</code>&#39;s second parameter. So you end up reimplementing most of <code>bound</code>."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 2, "last_activity_date": 1471889453, "last_edit_date": 1471889453, "creation_date": 1471860721, "answer_id": 39076810, "question_id": 39057576, "link": "https://stackoverflow.com/questions/39057576/mutually-recursive-syntaxes-with-bound/39076810#39076810", "title": "Mutually-recursive syntaxes with Bound", "body": "<p>It's quite simply impossible to do: <code>TermC</code> is not a monad. Substitution puts terms in place of variables. For this to make sense, the terms need to be able to fit, i.e. to be similar enough so that the resulting term still has good properties. Here it means that its type must be inferrable. <code>TermC</code> won't do.</p>\n\n<p>You can either implement:</p>\n\n<pre><code> substI :: TermI a -&gt; (a -&gt; TermI b) -&gt; TermI b\n substC :: TermC a -&gt; (a -&gt; TermI b) -&gt; TermC b\n</code></pre>\n\n<p>and have</p>\n\n<pre><code> instance Monad TermI where\n   return = Var\n   bind   = substI\n</code></pre>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1471889453, "creation_date": 1471718671, "last_edit_date": 1471820584, "question_id": 39057576, "link": "https://stackoverflow.com/questions/39057576/mutually-recursive-syntaxes-with-bound", "title": "Mutually-recursive syntaxes with Bound", "body": "<p>Here's a syntax for a dependently-typed lambda calculus.</p>\n\n<pre><code>data TermI a = Var a\n             | App (TermI a) (TermC a)  -- when type-checking an application, infer the type of the function and then check that its argument matches the domain\n             | Star  -- the type of types\n             | Pi (Type a) (Scope () Type a)  -- The range of a pi-type is allowed to refer to the argument's value\n             | Ann (TermC a) (Type a)  -- embed a checkable term by declaring its type\n             deriving (Functor, Foldable, Traversable)\n\ndata TermC a = Inf (TermI a)  -- embed an inferrable term\n             | Lam (Scope () TermC a)\n             deriving (Functor, Foldable, Traversable)\n\ntype Type = TermC  -- types are values in a dependent type system\n</code></pre>\n\n<p>(I more-or-less lifted this from <a href=\"http://strictlypositive.org/Easy.pdf\" rel=\"nofollow\"><em>Simply Easy</em></a>.) The type system is <a href=\"http://davidchristiansen.dk/tutorials/bidirectional.pdf\" rel=\"nofollow\">bidirectional</a>, splitting terms into those whose type can be inferred from the typing context, and those which can only be checked against a goal type. This is useful in dependent type systems because in general lambda terms will have no principal type.</p>\n\n<p>Anyway, I've got stuck trying to define a <code>Monad</code> instance for this syntax:</p>\n\n<pre><code>instance Monad TermI where\n    return = Var\n    Var x &gt;&gt;= f = f x\n    App fun arg &gt;&gt;= f = App (fun &gt;&gt;= f) (arg &gt;&gt;= Inf . f)  -- embed the substituted TermI into TermC using Inf\n    Star &gt;&gt;= _ = Star\n    Pi domain range &gt;&gt;= f = Pi (domain &gt;&gt;= Inf . f) (range &gt;&gt;&gt;= Inf . f)\n    Ann term ty &gt;&gt;= f = Ann (term &gt;&gt;= Inf . f) (ty &gt;&gt;= Inf . f)\n\ninstance Monad TermC where\n    return = Inf . return\n    Lam body &gt;&gt;= f = Lam (body &gt;&gt;&gt;= f)\n    Inf term &gt;&gt;= f = Inf (term &gt;&gt;= _)\n</code></pre>\n\n<p>To fill the hole in the last line of <code>TermC</code>'s instance, I need something of type <code>a -&gt; TermI b</code> but <code>f</code> has a type of <code>a -&gt; TermC b</code>. I can't embed the resulting <code>TermC</code> into <code>TermI</code> using the <code>Ann</code> constructor because I don't know the type of the <code>TermC</code>.</p>\n\n<p>Is this datatype incompatible with <code>bound</code>'s model? Or is there a trick I can use to make the <code>Monad</code> instance go?</p>\n"}, {"tags": ["haskell", "persistent", "servant"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 1221651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfeb35ad1d8a6ab8b50bc8609ce98989?s=128&d=identicon&r=PG", "display_name": "leighman", "link": "https://stackoverflow.com/users/1221651/leighman"}, "edited": false, "score": 0, "creation_date": 1471713250, "post_id": 39056621, "comment_id": 65462754, "body": "What&#39;s the <code>let maybeUser = Nothing</code> doing in there? Is that a typo?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 191, "user_id": 1221651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfeb35ad1d8a6ab8b50bc8609ce98989?s=128&d=identicon&r=PG", "display_name": "leighman", "link": "https://stackoverflow.com/users/1221651/leighman"}, "edited": false, "score": 0, "creation_date": 1471713596, "post_id": 39056621, "comment_id": 65462866, "body": "It&#39;s a leftover from experimentation :-)  I just tested it again, and It works without that line."}, {"owner": {"reputation": 191, "user_id": 1221651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfeb35ad1d8a6ab8b50bc8609ce98989?s=128&d=identicon&r=PG", "display_name": "leighman", "link": "https://stackoverflow.com/users/1221651/leighman"}, "edited": false, "score": 0, "creation_date": 1471714820, "post_id": 39056621, "comment_id": 65463277, "body": "Thanks. The Entity data constructor is what I was looking for."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1471713541, "last_edit_date": 1471713541, "creation_date": 1471712146, "answer_id": 39056621, "question_id": 39055829, "link": "https://stackoverflow.com/questions/39055829/use-of-get-and-tosqlkey-in-persistent/39056621#39056621", "title": "Use of `get` and `toSqlKey` in persistent", "body": "<p>The difference is that <code>get ...</code> returns a plain <code>User</code> not an <code>Entity User</code>, so this will work:</p>\n\n<pre><code>altSingleUser :: Int64 -&gt; App User\naltSingleUser userid = do\n    let foo = get (toSqlKey userid) :: SqlPersistT IO (Maybe User)\n    maybeUser &lt;- runDb $ foo\n    case maybeUser of\n         Nothing -&gt;\n            throwError err404\n         Just person -&gt;\n            return person\n</code></pre>\n\n<p>If you want to return an <code>Entity User</code>, just change the last return statement to:</p>\n\n<pre><code>return $ Entity { entityKey = toSqlKey userid, entityVal = person }\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 1221651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfeb35ad1d8a6ab8b50bc8609ce98989?s=128&d=identicon&r=PG", "display_name": "leighman", "link": "https://stackoverflow.com/users/1221651/leighman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 1, "accepted_answer_id": 39056621, "answer_count": 1, "score": 0, "last_activity_date": 1471713541, "creation_date": 1471707098, "last_edit_date": 1471712936, "question_id": 39055829, "link": "https://stackoverflow.com/questions/39055829/use-of-get-and-tosqlkey-in-persistent", "title": "Use of `get` and `toSqlKey` in persistent", "body": "<p>I'm trying to use persistent-postgresql with servant.</p>\n\n<p>I have a <code>User</code> model.</p>\n\n<p>I want to have an endpoint that takes an id and returns the user with that id.</p>\n\n<p>According to other answers I can use <code>toSqlKey</code> to turn an <code>Int64</code> into a <code>Key</code> to feed to <code>get</code>.</p>\n\n<p>My function looks like:</p>\n\n<pre><code>oneUser :: Int64 -&gt; App (Entity User)\noneUser userId = do\n  maybeUser &lt;- runDb $ get $ toSqlKey userId\n  case maybeUser of\n    Nothing -&gt;\n      throwError err404\n    Just user -&gt;\n      return user\n</code></pre>\n\n<p>When I try to compile I get the error <code>Couldn't match expected type \u2018PersistEntityBackend (Entity User)\u2019 with actual type \u2018SqlBackend\u2019</code></p>\n\n<p>Use of <code>selectList</code> works fine.</p>\n\n<pre><code>allUsers :: App [Entity User]\nallUsers = runDb $ selectList [] []\n</code></pre>\n\n<p>Please tell me what I'm doing wrong and where I should look in the future for stuff like this. I couldn't find <code>get</code> on hackage/the right version of the library on stackage etc.</p>\n\n<p><code>runDb</code> looks like:</p>\n\n<pre><code>runDb :: (MonadReader Config m, MonadIO m) =&gt; SqlPersistT IO b -&gt; m b\nrunDb query = do\n  pool &lt;- asks getPool\n  liftIO $ runSqlPool query pool\n</code></pre>\n\n<p>taken from <a href=\"https://github.com/parsonsmatt/servant-persistent/blob/master/src/Models.hs\" rel=\"nofollow\">this github project</a>.</p>\n"}, {"tags": ["haskell", "cabal", "atom-editor"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471713424, "post_id": 39055204, "comment_id": 65462811, "body": "The GHCi interactive environment isn&#39;t quite normal Haskell. It requires the syntax <code>let main = putStrLn &quot;Hello World!&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 1, "last_activity_date": 1471705733, "creation_date": 1471705733, "answer_id": 39055597, "question_id": 39055204, "link": "https://stackoverflow.com/questions/39055204/script-atom-plugin-parse-error-on-input/39055597#39055597", "title": "Script (Atom Plugin) - Parse error on input \u2018=\u2019", "body": "<p>That code is correct if you're putting it in a file. I'm not familiar with that atom plugin, but it sounds like it's trying to put it's input through ghci (basically the Haskell repl) where that code isn't valid.</p>\n\n<p>Have you tried compiling the file by hand, using ghc or even cabal? It should work if there's nothing else wrong in the file.</p>\n"}, {"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1471720199, "post_id": 39057320, "comment_id": 65464999, "body": "That&#39;s not an error, that&#39;s just a warning. Type signatures are optional in Haskell (except for corner cases), but it&#39;s good style to have signatures for top level items."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1471725613, "post_id": 39057320, "comment_id": 65466468, "body": "Related: <a href=\"http://stackoverflow.com/questions/29538610/should-one-specify-a-type-signature-for-main-or-not-why-why-not\" title=\"should one specify a type signature for main or not why why not\">stackoverflow.com/questions/29538610/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4510, "user_id": 6224823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-eVoU_E2fMho/AAAAAAAAAAI/AAAAAAAAAC4/7qlAOwlIJkM/photo.jpg?sz=128", "display_name": "Olian04", "link": "https://stackoverflow.com/users/6224823/olian04"}, "is_accepted": true, "score": 0, "last_activity_date": 1471716901, "creation_date": 1471716901, "answer_id": 39057320, "question_id": 39055204, "link": "https://stackoverflow.com/questions/39055204/script-atom-plugin-parse-error-on-input/39057320#39057320", "title": "Script (Atom Plugin) - Parse error on input \u2018=\u2019", "body": "<p>Turns out that trying to run a piece of Haskell, using <code>Script</code>, without saving the code to a file causes some strange error <em>(Although it never once actually told me to save the file)</em>.</p>\n\n<p>Saving the code to a file however changed things.</p>\n\n<p>The code:</p>\n\n<pre><code>main = putStrLn \"Hello World\"\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Top-level binding with no type signature: main :: IO ()\n</code></pre>\n\n<p>How ever, this time i got an output:</p>\n\n<pre><code>Hello World\n</code></pre>\n"}], "owner": {"reputation": 4510, "user_id": 6224823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-eVoU_E2fMho/AAAAAAAAAAI/AAAAAAAAAC4/7qlAOwlIJkM/photo.jpg?sz=128", "display_name": "Olian04", "link": "https://stackoverflow.com/users/6224823/olian04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 39057320, "answer_count": 2, "score": 0, "last_activity_date": 1471716942, "creation_date": 1471703289, "last_edit_date": 1471716942, "question_id": 39055204, "link": "https://stackoverflow.com/questions/39055204/script-atom-plugin-parse-error-on-input", "title": "Script (Atom Plugin) - Parse error on input \u2018=\u2019", "body": "<p>So I'm trying to learn haskell.<br>\nI got this code: </p>\n\n<pre><code>main = putStrLn \"Hello World!\"\n</code></pre>\n\n<p>And I'm compiling it using the <code>Script</code> plugin for <code>Atom</code> (Whitch in turn uses <code>Cabal</code>).<br>\nAnd i get this error:</p>\n\n<pre><code>&lt;interactive&gt;:1:6: parse error on input \u2018=\u2019\n</code></pre>\n\n<p>Also there is nothing printed to the console.<br>\nWhat am I missing?  </p>\n\n<p><strong>NOTE:</strong><br>\nI'm trying to follow the <a href=\"http://www.happylearnhaskelltutorial.com/1/first_step.html#s2.5\" rel=\"nofollow\">Happy Learn Haskell Tutorial</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1471717039, "post_id": 39055113, "comment_id": 65464013, "body": "Disagree with the close vote. This is not a typographical error, but a misunderstanding of how <code>.</code> and <code>$</code> work."}, {"owner": {"reputation": 4919, "user_id": 1463681, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/82a85370ac6830d7858e785db168576f?s=128&d=identicon&r=PG", "display_name": "Wildhoney", "link": "https://stackoverflow.com/users/1463681/wildhoney"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1471729843, "post_id": 39055113, "comment_id": 65467481, "body": "Agreed... Think it will be useful for other starting out in Haskell. In truth I should have realised, but when dealing with the complexities of Haskell, it&#39;s common to make these silly mistakes."}], "answers": [{"comments": [{"owner": {"reputation": 4919, "user_id": 1463681, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/82a85370ac6830d7858e785db168576f?s=128&d=identicon&r=PG", "display_name": "Wildhoney", "link": "https://stackoverflow.com/users/1463681/wildhoney"}, "edited": false, "score": 0, "creation_date": 1471704102, "post_id": 39055261, "comment_id": 65459609, "body": "That makes perfect sense now. Thank you!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1471703667, "creation_date": 1471703667, "answer_id": 39055261, "question_id": 39055113, "link": "https://stackoverflow.com/questions/39055113/couldnt-match-expected-type-io-a0-with-actual-type-a1-io/39055261#39055261", "title": "Couldn&#39;t match expected type \u2018IO a0\u2019 with actual type \u2018a1 -&gt; IO ()\u2019", "body": "<p>This will work:</p>\n\n<pre><code>enumerate = \\todos -&gt;\n    setSGR [] &gt;&gt;\n    (putStrLn . unlines . map transform) todos &gt;&gt;\n    setSGR []\n</code></pre>\n\n<p>Note that <code>f . g . map h xs</code> implies that <code>map h xs</code> is a function you are composing with <code>g</code> and then <code>f</code>. But <code>map transform todos</code> is a list, and\nyou are really composing the function <code>putStrLn</code>, <code>unlines</code> and <code>map transform</code> and then applying the composition to the list <code>todos</code>.</p>\n\n<p>In general:</p>\n\n<pre><code>f $ g $ h x  = (f . g . h) x\n</code></pre>\n\n<p>so your working expression:</p>\n\n<pre><code>putStrLn $ unlines $ map transform todos\n</code></pre>\n\n<p>is the same as:</p>\n\n<pre><code>( putStrLn . unlines . map transform ) todos\n</code></pre>\n"}], "owner": {"reputation": 4919, "user_id": 1463681, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/82a85370ac6830d7858e785db168576f?s=128&d=identicon&r=PG", "display_name": "Wildhoney", "link": "https://stackoverflow.com/users/1463681/wildhoney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471703667, "creation_date": 1471702691, "last_edit_date": 1471702828, "question_id": 39055113, "link": "https://stackoverflow.com/questions/39055113/couldnt-match-expected-type-io-a0-with-actual-type-a1-io", "title": "Couldn&#39;t match expected type \u2018IO a0\u2019 with actual type \u2018a1 -&gt; IO ()\u2019", "body": "<p>Works:\n</p>\n\n<pre><code>enumerate = \\todos -&gt;\n    setSGR [SetColor Foreground Vivid Red] &gt;&gt;=\n    (\\_ -&gt; putStrLn $ unlines $ map transform todos) &gt;&gt;\n    setSGR [Reset]\n</code></pre>\n\n<p>Doesn't work:\n</p>\n\n<pre><code>enumerate = \\todos -&gt;\n    setSGR [SetColor Foreground Vivid Red] &gt;&gt;\n    putStrLn . unlines . map transform todos &gt;&gt;\n    setSGR [Reset]\n</code></pre>\n\n<p>As far as I can undestand, <code>&gt;&gt;=</code> passes on the variable, which is then ignored in the subsequent lambda <code>(\\_ -&gt; ...)</code>. However, when I transform that to using <code>&gt;&gt;</code> and have function composition, it doesn't appear to work.</p>\n\n<p>What is the difference between the two that causes the second not to compile? It'd be great to know why those two expressions aren't equivalent.</p>\n\n<pre><code>/Users/atimberlake/Webroot/HTodo/htodo/app/Main.hs:18:25:\n    Couldn't match expected type \u2018IO a0\u2019 with actual type \u2018a1 -&gt; IO ()\u2019\n    In the second argument of \u2018(&gt;&gt;)\u2019, namely\n      \u2018putStrLn . unlines . map transform todos\u2019\n    In the first argument of \u2018(&gt;&gt;)\u2019, namely\n      \u2018setSGR [SetColor Foreground Vivid Red]\n       &gt;&gt; putStrLn . unlines . map transform todos\u2019\n    In the expression:\n      setSGR [SetColor Foreground Vivid Red]\n      &gt;&gt; putStrLn . unlines . map transform todos\n      &gt;&gt; setSGR [Reset]\n\n/Users/atimberlake/Webroot/HTodo/htodo/app/Main.hs:18:46:\n    Couldn't match expected type \u2018a1 -&gt; [String]\u2019\n                with actual type \u2018[[Char]]\u2019\n    Possible cause: \u2018map\u2019 is applied to too many arguments\n    In the second argument of \u2018(.)\u2019, namely \u2018map transform todos\u2019\n    In the second argument of \u2018(.)\u2019, namely\n      \u2018unlines . map transform todos\u2019\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 2, "creation_date": 1471698977, "post_id": 39054543, "comment_id": 65458196, "body": "Haskell can probably iterate over the list without materializing it, so maybe there is no space wasted."}, {"owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1471699393, "post_id": 39054543, "comment_id": 65458297, "body": "@Thilo even keeping that in mind, still computation requires little bit of mutation. <i>The reason why we don&#39;t mark everything <code>const</code> in C</i>. Not an argument but the idea of everything immutable itches me sometimes. But Thanks for clearing my doubt up ! :)"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471701602, "post_id": 39054543, "comment_id": 65458924, "body": "@GauravP - if you are summing reciprocals of <code>n</code> you should fix your C code: <code>sum += 1 &#47; (double) n</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471703244, "post_id": 39054543, "comment_id": 65459355, "body": "@GauravP You are underestimating the amount of work the compiler can do. Things in Haskell are immutable by default; this <i>decreases</i> the overhead because the compiler can make optimizations that a C compiler cannot because immutability is already guaranteed."}, {"owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471707649, "post_id": 39054543, "comment_id": 65460762, "body": "@ErikR not exactly the sum of reciprocals. It&#39;s modified for a math problem I have in an assignment. It needs the &#39;n&#39; to be the sum of 1 to &#39;i&#39; in each iteration &#39;i&#39;."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471707915, "post_id": 39054543, "comment_id": 65460856, "body": "Even if the list is materialized, in the sense that all reference to it does not disappear with build/foldr fusion, no more than one element need be in memory at a time, due to laziness and gc."}, {"owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471708223, "post_id": 39054543, "comment_id": 65460986, "body": "@chepner I think I have to change my mind. But I was missing one thing that is the compiler is very smart in Haskell. I feel bad because I have hard time grasping immutable concept. Any advice for me from you. <i>I am going for functional programming over object oriented</i>"}, {"owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471708401, "post_id": 39054543, "comment_id": 65461049, "body": "@Michael That makes sense actually ! After all haskell is lazy. It will never do anything that can be avoided."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "edited": false, "score": 0, "creation_date": 1471701410, "post_id": 39054761, "comment_id": 65458852, "body": "note I&#39;m also incrementing n with each iteration so it goes like 1,3,6,10 so on up to 20. i and n is changing simultaneously. Thanks a lot I was looking for that escaping immutability. ST monad. Great resource."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471707216, "post_id": 39054761, "comment_id": 65460581, "body": "Data.List uses foldr/build fusion, which is basically the exact opposite of stream fusion."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471707805, "post_id": 39054761, "comment_id": 65460817, "body": "I wish we&#39;d stop referencing that answer. To much of the information in it is outdated. For example, the default Prelude list functions have had stream fusion for a while now... The first comment on <a href=\"http://stackoverflow.com/questions/38905369/what-is-fusion-in-haskell\">this</a> question sort of says it."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 3, "last_activity_date": 1471700260, "last_edit_date": 1495535318, "creation_date": 1471700260, "answer_id": 39054761, "question_id": 39054543, "link": "https://stackoverflow.com/questions/39054543/how-to-do-inverse-series-sum-in-haskell-efficiently/39054761#39054761", "title": "How to do inverse series sum in haskell efficiently?", "body": "<p>To temporarily escape the immutability you can use <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad-ST.html\" rel=\"nofollow noreferrer\">the <code>ST</code> monad</a>.</p>\n\n<p>However there's no need for that. In the following expression everything will be optimised out by the compiler due to <a href=\"https://stackoverflow.com/questions/578063/what-is-haskells-stream-fusion\">Stream Fusion</a>:</p>\n\n<pre><code>sum (map (\\n -&gt; 1 / fromIntegral n) [1..20])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1471702467, "last_edit_date": 1471702467, "creation_date": 1471700642, "answer_id": 39054810, "question_id": 39054543, "link": "https://stackoverflow.com/questions/39054543/how-to-do-inverse-series-sum-in-haskell-efficiently/39054810#39054810", "title": "How to do inverse series sum in haskell efficiently?", "body": "<p>You can examine the code that GHC generates with <code>-ddump-asm</code>.</p>\n\n<p>Compile this program:</p>\n\n<pre><code>main = print $ 1.0 / fromIntegral (sum [(1::Int)..12345])\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>$ ghc -O2 Main.hs -ddump-asm &gt; asm-output\n</code></pre>\n\n<p>Then have a look at <code>asm-output</code>, search for <code>12345</code> and you will see this loop:</p>\n\n<pre><code>_c47b:\n        addq %r14,%rsi\n        incq %r14\n_c476:\n        cmpq $12345,%r14\n        jne _c47b\n</code></pre>\n\n<p>This shows that the list <code>[1..12345]</code> is not actually created.</p>\n\n<p><strong>Update</strong></p>\n\n<p>It seems you intended to sum the reciprocals of the triangular numbers,\ni.e. 1/1 + 1/3 + 1/6 + ... That is, you intended to write:</p>\n\n<pre><code>sum += 1.0 / (double) n;\n</code></pre>\n\n<p>This can be expressed in Haskell as:</p>\n\n<pre><code>main = print $ sum $ map (\\x -&gt; 1 / (fromIntegral x)) $ scanl (+) 1 [(2::Int)..12345]\n</code></pre>\n\n<p>Examining the generated assembly we see again that no intermediate list is created:</p>\n\n<pre><code>_c4ao:\n        cvtsi2sdq %rsi,%xmm0\n        movsd _n4aP(%rip),%xmm2\n        divsd %xmm0,%xmm2\n        addsd %xmm2,%xmm1\n        incq %r14\n_c4ad:\n        addq %r14,%rsi\n        cmpq $12345,%r14\n        jne _c4ao\n</code></pre>\n\n<p>Here <code>%r14</code> is the counter <code>i</code> in your C code, <code>%rsi</code> is the variable <code>n</code> and <code>%xmm1</code> is the accumulator <code>sum</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1471704847, "post_id": 39055363, "comment_id": 65459844, "body": "Or, use math <code>2-2&#47;(n+1)=1.9</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1471704973, "post_id": 39055363, "comment_id": 65459880, "body": "Yes, that would apply to the original C code as well. We&#39;re trying to point out that what is a bad idea in C isn&#39;t necessarily a bad idea in Haskell."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1471705340, "post_id": 39055363, "comment_id": 65460005, "body": "I&#39;m waiting for the day compilers to get smart enough to perform these higher level optimizations..."}, {"owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "edited": false, "score": 0, "creation_date": 1471708557, "post_id": 39055363, "comment_id": 65461107, "body": "Exactly the answer I was looking for. And the last output is also identical to that of C. Thank You ! :)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1471704548, "last_edit_date": 1471704548, "creation_date": 1471704230, "answer_id": 39055363, "question_id": 39054543, "link": "https://stackoverflow.com/questions/39054543/how-to-do-inverse-series-sum-in-haskell-efficiently/39055363#39055363", "title": "How to do inverse series sum in haskell efficiently?", "body": "<p>Use <code>scanl1</code> to generate your list of <code>n</code>s:</p>\n\n<pre><code>&gt; scanl1 (+) $ [1..19]\n[1,3,6,10,15,21,28,36,45,55,66,78,91,105,120,136,153,171,190]\n</code></pre>\n\n<p>From there, it is a simple matter to compute the inverses</p>\n\n<pre><code>&gt; map (1/) . scanl1 (+) $ [1..19]\n[1.0,0.3333333333333333,0.16666666666666666, ...]\n</code></pre>\n\n<p>and sum them:</p>\n\n<pre><code>&gt; sum . map (1/) . scanl1 (+) $ [1..19]\n1.8999999999999997\n</code></pre>\n\n<p>Although the <em>Haskell</em> code treats values as immutable and it appears you are generating a bunch of intermediate lists, the compiler is smart enough to generate efficient <em>executable</em> code.</p>\n"}], "owner": {"reputation": 61, "user_id": 6284269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SEGat.jpg?s=128&g=1", "display_name": "GauravP", "link": "https://stackoverflow.com/users/6284269/gauravp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 39055363, "answer_count": 3, "score": -1, "last_activity_date": 1471704548, "creation_date": 1471698799, "question_id": 39054543, "link": "https://stackoverflow.com/questions/39054543/how-to-do-inverse-series-sum-in-haskell-efficiently", "title": "How to do inverse series sum in haskell efficiently?", "body": "<p>This is the code I am trying to convert in haskell. But immutability creates the problem. How to do calculation without mutable variables. Creating a list of <code>[1..20]</code> and mapping over it doesn't seem like space efficient. Is there any trick or techniques to escape immutability?</p>\n\n<pre><code>int main()\n{\n    int i,n=0;\n    double sum= 0.0;\n    for ( i=1; i&lt;20; ++i )\n    {\n        n += i;\n        sum = 1 / (double) n;\n    }\n    printf(\"The sum is: %lf\",sum);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1471697036, "post_id": 39054179, "comment_id": 65457650, "body": "It still works for me."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1471697271, "post_id": 39054179, "comment_id": 65457730, "body": "have you used also <code>module () where</code>?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471697360, "post_id": 39054179, "comment_id": 65457761, "body": "Your file name should match the module name - i.e. module <code>FunctorChapter</code> should reside in file <code>FunctorChapter.hs</code>."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471697441, "post_id": 39054179, "comment_id": 65457783, "body": "OP: Yes I have. @ErikR It works even for differently named modules for me."}], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1471853896, "post_id": 39054733, "comment_id": 65496713, "body": "what I meant by file is my file name , moreover  I am using stack so all what  I did is to use <code>stack ghci</code> to test the code, and I have recognized something is when I use :load <code>functorChapter</code> it works but when I use <code>stack ghci</code> it doesn&#39;t"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1471858478, "post_id": 39054733, "comment_id": 65499701, "body": "Note the prompt: it says <code>Main File&gt;</code>. This shows that <code>FunctorChapter</code> isn&#39;t loaded. &quot;when I use :load functorChapter it works but when I use stack ghci it doesn&#39;t&quot; After running <code>stack ghci</code>, you still need to load the modules, see <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#ghci-the-repl\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/GUIDE/#ghci-the-repl</a>."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 3, "last_activity_date": 1471700066, "creation_date": 1471700066, "answer_id": 39054733, "question_id": 39054179, "link": "https://stackoverflow.com/questions/39054179/haskell-error-while-declaring-new-type/39054733#39054733", "title": "Haskell : error while declaring new type", "body": "<p>You don't have the <code>FunctorChapter</code> module loaded, but some different <code>File</code> module.</p>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471700066, "creation_date": 1471696290, "last_edit_date": 1471696716, "question_id": 39054179, "link": "https://stackoverflow.com/questions/39054179/haskell-error-while-declaring-new-type", "title": "Haskell : error while declaring new type", "body": "<p>I Have defined new type in file <code>file.hs</code></p>\n\n<pre><code>module FunctorChapter\n  (\n  FixMePls\n  )\n  where\n  data FixMePls a =\n    Fixme | Pls a\n    deriving (Show,Eq)\n</code></pre>\n\n<p>when imported the <code>file.hs</code> into ghci it is loaded successfully but I am not able to use the constructor <code>Pls</code></p>\n\n<pre><code>Main File&gt; Pls \"test\"\n&lt;interactive&gt;:5:1: Not in scope: data constructor \u2018Pls\u2019\n</code></pre>\n\n<p>while I can use the Just constructor</p>\n\n<pre><code>Main File&gt; Just \"me\"\nJust \"me\"\n</code></pre>\n\n<p>what is missing in my type?</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471660161, "post_id": 39049864, "comment_id": 65449314, "body": "What does <code>findInt</code> look like (just helps having something to work off of)?"}, {"owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471660346, "post_id": 39049864, "comment_id": 65449351, "body": "Added. Sorry I was not thinking when I put the code up."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1471661010, "creation_date": 1471661010, "answer_id": 39049961, "question_id": 39049864, "link": "https://stackoverflow.com/questions/39049864/parsec-if-a-match-it-found-then-throw-error/39049961#39049961", "title": "Parsec if a match it found then throw error", "body": "<p>I would use <code>notFollowedBy</code> - e.g.:</p>\n\n<pre><code>import Text.Parsec\nimport Text.Parsec.String\nimport Text.Parsec.Combinator\n\nint :: Parser String\nint = many1 digit &lt;* notFollowedBy (char '.')\n\nfloat :: Parser (String,String)\nfloat = do whole &lt;- many1 digit\n           fracpart &lt;- try (char '.' *&gt; many digit) &lt;|&gt; (return \"\")\n           return (whole, fracpart)\n\nintOrFloat :: Parser (Either String (String,String))\nintOrFloat = try (fmap Left int) &lt;|&gt; (fmap Right float)\n\ntest1 = parseTest (intOrFloat &lt;* eof) \"123\"\ntest2 = parseTest (intOrFloat &lt;* eof) \"123.456\"\ntest3 = parseTest (intOrFloat &lt;* eof) \"123.\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 2, "last_activity_date": 1471662565, "last_edit_date": 1471662565, "creation_date": 1471661541, "answer_id": 39050006, "question_id": 39049864, "link": "https://stackoverflow.com/questions/39049864/parsec-if-a-match-it-found-then-throw-error/39050006#39050006", "title": "Parsec if a match it found then throw error", "body": "<p>I think you are best off actually combining the two parsers into one. Try something like this:</p>\n\n<pre><code>import Text.Parsec.String (Parser)\nimport Control.Applicative ((&lt;|&gt;))\nimport Text.Parsec.Char (char,digit)\nimport Text.Parsec.Combinator (many1,optionMaybe)\n\nmakeIntOrFloat :: Parser (Either Int Float)\nmakeIntOrFloat = do\n    sign &lt;- optionMaybe (char '-' &lt;|&gt; char '+')\n    n &lt;- many1 digit\n    m &lt;- optionMaybe (char '.' *&gt; many1 digit)\n    return $ case (m,sign) of\n        (Nothing, Just '-') -&gt; Left (negate (read n))\n        (Nothing, _)        -&gt; Left (read n)\n        (Just m, Just '-')  -&gt; Right (negate (read n + read m / 10.0^(length m)))\n        (Just m, _)         -&gt; Right (read n + read m / 10.0^(length m))\n</code></pre>\n\n<p>ErikR has a correct solution, but the use of <code>try</code> means that <code>parsec</code> has to keep track of the possibility of backtracking (which is a bit inefficient) when in fact that is unnecessary in this case.</p>\n\n<p>Here, the key difference is that we can actually tell right away if we have a float or not - if we don't have a float, the <code>char '.' *&gt; many1 digit</code> parser in <a href=\"http://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec-Combinator.html#v:optionMaybe\" rel=\"nofollow\"><code>optionMaybe</code></a> will fail immediately (without consuming input), so there is no need to consider backtracking.</p>\n\n<p>At GHCi</p>\n\n<pre><code>ghci&gt; import Text.Parsec.Prim\nghci&gt; parseTest makeIntOrFloat \"1234.012\"\nRight 1234.012\nghci&gt; parseTest makeIntOrFloat \"1234\"\nLeft 1234\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 0, "last_activity_date": 1471714819, "creation_date": 1471714819, "answer_id": 39057012, "question_id": 39049864, "link": "https://stackoverflow.com/questions/39049864/parsec-if-a-match-it-found-then-throw-error/39057012#39057012", "title": "Parsec if a match it found then throw error", "body": "<p>It is typically easiest to use applicative combinators to build your parsers - this makes your parsers easier to reason about and often you do not need monadic and backtracking functions of the parser.</p>\n\n<p>For example, a parser for integers could be written as such:</p>\n\n<pre><code>import Text.Parsec hiding ((&lt;|&gt;), optional)\nimport Text.Parsec.String \nimport Numeric.Natural \nimport Control.Applicative \nimport Data.Foldable\n\nnatural :: Parser Natural \nnatural = read &lt;$&gt; many1 digit\n\nsign :: Num a =&gt; Parser (a -&gt; a)\nsign = asum [ id &lt;$ char '+'\n            , negate &lt;$ char '-'\n            , pure id \n            ] \n\ninteger :: Parser Integer \ninteger = sign &lt;*&gt; (fromIntegral &lt;$&gt; natural)\n</code></pre>\n\n<p>A decimal number is an integer optionally followed by a decimal portion (a '.' followed by another integer), which is itself a number proper, so your parser can be written as</p>\n\n<pre><code>decimalPart :: Parser Double   \ndecimalPart = read . (\"0.\"++) &lt;$&gt; (char '.' *&gt; many1 digit)\n\nintegerOrDecimal :: Parser (Either Integer Double)\nintegerOrDecimal = liftA2 cmb integer (optional decimalPart) where \n   cmb :: Integer -&gt; Maybe Double -&gt; Either Integer Double\n   cmb x Nothing = Left x \n   cmb x (Just d) = Right (fromIntegral x + d) \n</code></pre>\n\n<p>The definition of <code>cmb</code> is obvious - if the is no decimal part, then produce an <code>Integer</code>, and if there is, produce a <code>Double</code>, by adding the integer part to the decimal part.</p>\n\n<p>You can also define a parser for decimals in terms of the above:</p>\n\n<pre><code>decimal :: Parser Double \ndecimal = either fromIntegral id &lt;$&gt; integerOrDecimal \n</code></pre>\n\n<p>Note that none of the above parsers directly use monadic functions (i.e. <code>&gt;&gt;=</code>) or backtracking - making them simple and efficient. </p>\n"}], "owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 39050006, "answer_count": 3, "score": 1, "last_activity_date": 1471714819, "creation_date": 1471659655, "last_edit_date": 1471660314, "question_id": 39049864, "link": "https://stackoverflow.com/questions/39049864/parsec-if-a-match-it-found-then-throw-error", "title": "Parsec if a match it found then throw error", "body": "<p>I am trying to distinguish between Ints and floats in a parser. I have 2 parsers one for each int and float. However, I am having trouble getting into to fail on a '.'.  I looked for negating and look ahead and didn't seem to get and fruits.</p>\n\n<p>I hope I am not duplicating any questions. </p>\n\n<p>I had it working with looking at the next character that is not a '.' but that is an ugly solution. </p>\n\n<p><strong>EDIT</strong>: Added more code. </p>\n\n<pre><code>--Int--------------------------------------------------------------------\nfindInt :: Parser String\nfindInt = plus &lt;|&gt; minus &lt;|&gt; number\n\nnumber :: Parser String\nnumber = many1 digit\n\nplus :: Parser String\nplus = char '+' *&gt; number\n\nminus :: Parser String\nminus = char '-' &lt;:&gt; number\n\nmakeInt :: Parser Int\nmakeInt = prepareResult (findInt  &lt;* many (noneOf \".\")  &lt;* endOfLine)\n    where readInt = read :: String -&gt; Int\n          prepareResult = liftA readInt\nmakeInt2 :: Parser Int\nmakeInt2 = do\n  numberFound &lt;- (findInt  &lt;* many (noneOf \".\")  &lt;* endOfLine)\n  match &lt;- char '.'\n  return  (prepareResult numberFound)\n  where readInt = read :: String -&gt; Int\n        prepareResult = readInt\n--End Int----------------------------------------------------------------\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 12, "creation_date": 1471642559, "post_id": 39047943, "comment_id": 65445831, "body": "There is no such thing as an empty word. There <i>is</i> such a thing as an empty line."}, {"owner": {"reputation": 1099, "user_id": 6513157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d45981b71a14222513f57e8566e4b8b?s=128&d=identicon&r=PG&f=1", "display_name": "R B", "link": "https://stackoverflow.com/users/6513157/r-b"}, "edited": false, "score": 3, "creation_date": 1471642617, "post_id": 39047943, "comment_id": 65445855, "body": "A blank line is still a line, but the empty string is not a word. I know that&#39;s a bit glib, but I think it captures the reasoning pretty concisely."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1471658942, "post_id": 39047943, "comment_id": 65449168, "body": "Whether there is an empty word depends on the definition of word, but I do understand, though, that it would be misleading to say &quot; one two three&quot; has 4 words. OTOH, sometimes it is interesting to know whether the string actually starts with a word."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1471682288, "post_id": 39047943, "comment_id": 65453605, "body": "Note that this isn&#39;t unique to Haskell. E.g. in python: <code>&#39; one two three&#39;.split() --&gt; [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;]</code> and <code>&#39;\\none\\ntwo\\nthree&#39;.splitlines() --&gt; [&#39;&#39;, &#39;one&#39;, &#39;two&#39;, &#39;three&#39;]</code>  which is exactly the same behaviour, for the exact same reasons."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 9, "last_activity_date": 1471649665, "creation_date": 1471649665, "answer_id": 39049007, "question_id": 39047943, "link": "https://stackoverflow.com/questions/39047943/inconsistent-behavior-of-lines-and-words/39049007#39049007", "title": "Inconsistent behavior of lines and words", "body": "<p><code>lines</code> is an actual bijection: you can use it to split up any string at the <code>'\\n'</code> characters, and later reassemble them perfectly with <code>unlines</code>. (Well, almost: let's disregard trailing newlines and Windows line ending.)</p>\n\n<p>If <code>words</code> had the same behaviour just with <code>' '</code> instead of <code>'\\n'</code> as the separator character, it wouldn't quite work the way we want it: for instance, the string</p>\n\n<pre><code>     \"I will not buy this record\\nit is scratched\"\n</code></pre>\n\n<p>would get split up to</p>\n\n<pre><code>     [\"I\",\"will\",\"not\",\"buy\",\"this\",\"record\\nit\",\"is\",\"scratched\"]\n</code></pre>\n\n<p>which <code>words</code> avoids, by splitting at <em>any</em> whitespace.</p>\n\n<pre><code>Prelude&gt; words \"I will not buy this record\\nit is scratched\"\n[\"I\",\"will\",\"not\",\"buy\",\"this\",\"record\",\"it\",\"is\",\"scratched\"]\n</code></pre>\n\n<p>This means that <strong>a)</strong> it's not a bijection anyway, because the flavour of whitespace is lost, and <strong>b)</strong> you would get a lot of \u201cempty words\u201d when there are any two whitespace characters adjacent.</p>\n\n<p>Hence, the sensible behaviour for <code>words</code> is to just condense such whitespace into a single gap.</p>\n"}], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1471649665, "creation_date": 1471642245, "question_id": 39047943, "link": "https://stackoverflow.com/questions/39047943/inconsistent-behavior-of-lines-and-words", "title": "Inconsistent behavior of lines and words", "body": "<p>Here is a GHCi session:</p>\n\n<pre><code>Prelude&gt; words \" one two three\"\n[\"one\",\"two\",\"three\"]\nPrelude&gt; lines \"\\none\\ntwo\\nthree\"\n[\"\",\"one\",\"two\",\"three\"]\n</code></pre>\n\n<p>Is there a reason for this inconsistency? And, if so, what is it?</p>\n"}, {"tags": ["windows", "haskell", "ghc"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471639416, "post_id": 39047317, "comment_id": 65444624, "body": "Also, what is the exception?"}, {"owner": {"reputation": 4070, "user_id": 104672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R72O5.png?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/104672/andre"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1471639472, "post_id": 39047317, "comment_id": 65444644, "body": "@Zeta updated, its regex-compat"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471639513, "post_id": 39047317, "comment_id": 65444660, "body": "@Alec program crashes, nothing in the console output."}, {"owner": {"reputation": 4070, "user_id": 104672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R72O5.png?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/104672/andre"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471639609, "post_id": 39047317, "comment_id": 65444708, "body": "@Alec, yup. Crashes with no output"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1471642385, "post_id": 39047317, "comment_id": 65445768, "body": "It&#39;s a bug, probably in <code>regex-posix</code>, due to its difference in the inclusion of the underlying BSD regex library  from 1994. In <code>sslow</code>, an invalid memory address (<code>-1(%rdx)</code> with <code>rdx = 0</code>) will be accessed. I&#39;m too tired for an in-depth analysis, but you could add <code>CC-Options: -g</code> and compile those packages by hand to find the culprit. Given that the package uses HSC doesn&#39;t make it a lot easier, to be honest\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 4070, "user_id": 104672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R72O5.png?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/104672/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1471956390, "creation_date": 1471956390, "answer_id": 39101634, "question_id": 39047317, "link": "https://stackoverflow.com/questions/39047317/simple-regular-expression-substitution-crashes-on-windows-using-regex-compat/39101634#39101634", "title": "Simple regular expression substitution crashes on Windows using regex-compat", "body": "<p>Shuffling the regex around avoids the bug in this case. </p>\n\n<p>This works fine for me now</p>\n\n<pre><code>let re = Re.mkRegexWithOpts \"(jul|aug|sep|oct|jun|nov|dec)\" True False in \n</code></pre>\n\n<p>I.e. moving the <code>jun</code> towards the end of the regex. Not particularly satisfactory but it works and it means I can continue.</p>\n\n<p>@Zeta's comment suggest that this is a bug with the underlying library</p>\n\n<blockquote>\n  <p>It's a bug, probably in regex-posix, due to its difference in the\n  inclusion of the underlying BSD regex library from 1994. In sslow, an\n  invalid memory address (-1(%rdx) with rdx = 0) will be accessed.</p>\n</blockquote>\n"}], "owner": {"reputation": 4070, "user_id": 104672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R72O5.png?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/104672/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 39101634, "answer_count": 1, "score": 2, "last_activity_date": 1471956390, "creation_date": 1471639076, "last_edit_date": 1471846690, "question_id": 39047317, "link": "https://stackoverflow.com/questions/39047317/simple-regular-expression-substitution-crashes-on-windows-using-regex-compat", "title": "Simple regular expression substitution crashes on Windows using regex-compat", "body": "<p>The following code crashes when using GHC on Windows. It works perfectly on Linux. </p>\n\n<p>Does this make any sense or is there a bug?</p>\n\n<pre><code>module Main where\n\nimport qualified Text.Regex as Re -- from regex-compat\nimport Debug.Trace\n\nmain :: IO ()\nmain = do\n  putStr $ cleanWord \"jan\"\n  putStr $ cleanWord \"dec\"\n  putStr $ cleanWord \"jun\" -- crashes here\n\ncleanWord :: String -&gt; String\ncleanWord word_ =\n  let word = trace (show word_) word_ in\n  let re = Re.mkRegexWithOpts \"(jun|jul|aug|sep|oct|nov|dec)\" True False in\n  Re.subRegex re word \"\"\n</code></pre>\n\n<p>Some additional details</p>\n\n<ol>\n<li>I'm building with <code>stack</code></li>\n<li>It crashes in both GHCi and running the compiled executable</li>\n<li>I tried to enable profiling but can't seem to figure out how to get that to work correctly.</li>\n</ol>\n"}, {"tags": ["haskell", "emacs", "intero"], "comments": [{"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471654612, "post_id": 39045965, "comment_id": 65448571, "body": "What&#39;s keeping you from having a file loaded into the repl with the right commands and parameters? What&#39;s keeping you from compiling the code together with a suitable <code>main</code> function?"}, {"owner": {"reputation": 967, "user_id": 1465472, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/64ca2c1540eb6254acb10aec1958655c?s=128&d=identicon&r=PG", "display_name": "Mike Flynn", "link": "https://stackoverflow.com/users/1465472/mike-flynn"}, "reply_to_user": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471663055, "post_id": 39045965, "comment_id": 65449740, "body": "I don&#39;t want to run this code all at once, I want to selectively load it into the repl depending on the current state of the process, and doing that with one keystroke (<code>C-Ret</code>) is an order of magnitude performance boost over typing (10-60 keystrokes) and 5x more efficient than copy paste in emacs (about 5 keystrokes)."}, {"owner": {"reputation": 967, "user_id": 1465472, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/64ca2c1540eb6254acb10aec1958655c?s=128&d=identicon&r=PG", "display_name": "Mike Flynn", "link": "https://stackoverflow.com/users/1465472/mike-flynn"}, "reply_to_user": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471663175, "post_id": 39045965, "comment_id": 65449757, "body": "I also might want to customize how I run the lines on the fly, so coding them into single commands and then reloading the module is also less efficient than just changing the lines in the script and loading them into the buffer."}, {"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471713877, "post_id": 39045965, "comment_id": 65462953, "body": "I see... I don&#39;t have an answer to that. But you could still define local functions; if they&#39;re one char long it&#39;s two keystrokes per instruction. Maybe use <code>:e</code> or a self-made command (in <code>.ghci</code>) to help editing on the fly"}], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": false, "score": 1, "last_activity_date": 1472037760, "last_edit_date": 1472037760, "creation_date": 1472036998, "answer_id": 39121699, "question_id": 39045965, "link": "https://stackoverflow.com/questions/39045965/haskell-intero-send-lines-to-intero-repl-buffer/39121699#39121699", "title": "Haskell / Intero - send lines to Intero REPL buffer", "body": "<p>This emacs lisp function will send a command to haskell's repl</p>\n\n<pre><code>(defun haskell-send-command (cmd)\n  (process-send-string (inferior-haskell-process) (concat cmd \"\\n\")))\n</code></pre>\n\n<p>and this will call the previous one with the current selection </p>\n\n<pre><code>(defun haskell-send-selection ()\n  (interactive)\n  (haskell-send-command (x-selection)))\n</code></pre>\n\n<p>You can assign it a keyboard shortcut with <code>global-set-key</code>. Then you need to figure out how to quickly select what you want to send. For instance <code>M-h</code> is mark-paragraph. Or just recode the ESS functions you like :</p>\n\n<pre><code>(defun haskell-send-paragraph ()\n  (interactive)\n  (mark-paragraph)\n  (haskell-send-selection))\n</code></pre>\n\n<p>I actually used those to build a small debugging GUI for Haskell in emacs. I have shortcuts for setting breakpoints and stepping, and the position of the debugger highlights directly in the haskell code.</p>\n"}], "owner": {"reputation": 967, "user_id": 1465472, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/64ca2c1540eb6254acb10aec1958655c?s=128&d=identicon&r=PG", "display_name": "Mike Flynn", "link": "https://stackoverflow.com/users/1465472/mike-flynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1472037760, "creation_date": 1471632745, "question_id": 39045965, "link": "https://stackoverflow.com/questions/39045965/haskell-intero-send-lines-to-intero-repl-buffer", "title": "Haskell / Intero - send lines to Intero REPL buffer", "body": "<p>I've been attempting to use Haskell for running a simple production process. Like many production processes, it involves changing the states of things all over the place. For this reason, it would be really handy for me to have a script file where I could keep track of things and selectively run commands into interactive Haskell, something like</p>\n\n<pre><code>-- to start the process\nprocess &lt;- startProcess\n\n-- to stop process\nstopProcess\n\n-- to check how things are going\nsummary &lt;- checkStuff\nsummary \n\n-- optionally restart bad processes\nrestartProcesses (getBadProcesses summary)\n\n-- send summary emails\nsendSummaryEmails summary [\"abunch@ofemails.com\", \"thatIwould@rather.com\", \n                           \"nothaveto@keep.com\" \"typing@out.com\",\n                           \"orcopy@pasting.com\"]\n\n-- set up something big that I don't want to have to retype/paste every time\nstudentGrades &lt;- getStudentGrades \"John Peterson\"\ngen &lt;- getStdGen\nlet (randomTest, gen') = generateRandomTest studentGrades gen\ncompilePdf randomTest\nanswers &lt;- getAnswers\ngradeTest randomTest answers \"John Peterson\"\n</code></pre>\n\n<p>It would be really cool if, like with ESS (Emacs speaks statistics) in R, if you could press a button to send these lines to the repl process. Maybe seperate buttons for line, paragraph, region. Is there already a way to do this?</p>\n\n<p>For example with ESS, <code>C-Ret</code> sends the line, <code>C-c C-c</code> sends a paragraph, and <code>C-c C-r</code> sends a region.</p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471632364, "post_id": 39045680, "comment_id": 65441458, "body": "You can open up GHCi and paste in <code>import Control.Monad.State.Lazy</code>. Then, you can try out the interactive stuff they talk about (like <code>runState (return &#39;X&#39;) 1</code>). One aside: this tutorial makes some simplifying remarks, so don&#39;t be surprised if you occasionally run into <code>StateT</code>...  Also, <a href=\"https://kuniganotas.wordpress.com/2012/09/08/haskell-importunimport-a-module-into-ghci/\" rel=\"nofollow noreferrer\">this</a> covers imports and unimports."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471637465, "post_id": 39045680, "comment_id": 65443862, "body": "The <a href=\"https://downloads.haskell.org/~ghc/master/users-guide/ghci.html\" rel=\"nofollow noreferrer\">Using GHCI section</a> in the GHC User&#39;s Guide might help."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1471660992, "post_id": 39045680, "comment_id": 65449450, "body": "Please consider asking a single question with the example code, filename(s), and commands ran.  As is your question is long and rambling, making it hard to answer in an objective fashion."}, {"owner": {"reputation": 3, "user_id": 6735970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf1282c0b937f720c80c2bcc7c15442?s=128&d=identicon&r=PG&f=1", "display_name": "d446", "link": "https://stackoverflow.com/users/6735970/d446"}, "edited": false, "score": 0, "creation_date": 1471709669, "post_id": 39045680, "comment_id": 65461472, "body": "Thomas, I edited the question so less rambling, maybe it will help some future straggler like me."}, {"owner": {"reputation": 3, "user_id": 6735970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf1282c0b937f720c80c2bcc7c15442?s=128&d=identicon&r=PG&f=1", "display_name": "d446", "link": "https://stackoverflow.com/users/6735970/d446"}, "edited": false, "score": 0, "creation_date": 1471709845, "post_id": 39045680, "comment_id": 65461541, "body": "EricR, Alec, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 1, "last_activity_date": 1471707459, "creation_date": 1471707459, "answer_id": 39055889, "question_id": 39045680, "link": "https://stackoverflow.com/questions/39045680/modules-and-programs-in-haskell-first-steps/39055889#39055889", "title": "modules and programs in Haskell - first steps", "body": "<p>The code in the sections titled \"complete and concrete example\" are complete and concrete examples. You can put the code in these into files with the same name as the module name (i.e. the StateGame module should go into a file called StateGame.hs).</p>\n\n<p>You can then compile that with ghc <code>ghc StateGame.hs -main-is StateGame</code>. Alternatively you can rename that module to <code>Main</code>, then you don't need the <code>-main-is</code> part.</p>\n"}], "owner": {"reputation": 3, "user_id": 6735970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf1282c0b937f720c80c2bcc7c15442?s=128&d=identicon&r=PG&f=1", "display_name": "d446", "link": "https://stackoverflow.com/users/6735970/d446"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1473238461, "accepted_answer_id": 39055889, "answer_count": 1, "score": -1, "last_activity_date": 1471709728, "creation_date": 1471631588, "last_edit_date": 1471709728, "question_id": 39045680, "link": "https://stackoverflow.com/questions/39045680/modules-and-programs-in-haskell-first-steps", "closed_reason": "Needs more focus", "title": "modules and programs in Haskell - first steps", "body": "<p>I am studying the example in section 3 on this page:</p>\n\n<p><a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow\">https://wiki.haskell.org/State_Monad</a></p>\n\n<p>Basically, I would like to play with this example but I do not know how to make the code do anything. I take it that this is a \"module\", and that some modules are \"programs\" in Haskell, but I don't understand why this module has a function called \"main\" (I thought it would also have to be called \"Main\" to be a program, but I tried changing it and it failed to compile). If it is not a program, then what I am supposed to do with a module sitting all by itself? Am I supposed to import it into ghci and then type > main? If so, I tried but I can't make it happen. </p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1471735460, "post_id": 39042634, "comment_id": 65468565, "body": "Thanks. I&#39;ve included this option in my <a href=\"https://github.com/stla/ghcitohtml\" rel=\"nofollow noreferrer\">ghcitohtml</a> tool :)"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 21, "last_activity_date": 1471620581, "last_edit_date": 1471620581, "creation_date": 1471620062, "answer_id": 39042634, "question_id": 39041851, "link": "https://stackoverflow.com/questions/39041851/increase-the-width-of-ghci/39042634#39042634", "title": "Increase the &quot;width&quot; of ghci", "body": "<p>There are three options that control <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flags.html\">pretty printing:</a></p>\n\n<pre><code>-dppr-debug         Turn on debug printing (more verbose)\n-dppr-user-length   Set the depth for printing expressions in error msgs    \n-dppr-cols\u27e8N\u27e9       Set the width of debugging output. For example -dppr-cols200\n</code></pre>\n\n<p>You're looking for <code>-dppr-cols</code>. Its default value is <code>100</code>. You can set it to any other value, either when you call GHCi or with <code>:set</code>.</p>\n\n<h1>Comparison of the the options</h1>\n\n<h2>Without <code>-dppr-cols</code></h2>\n\n<pre><code>$ ghci NewType_makeLenses.hs\n[1 of 1] Compiling Main             ( NewType_makeLenses.hs, interpreted )  \nOk, modules loaded: Main.                                                   \n&gt; :i bar                                                                    \nbar :: Lens' (Foo a0) Int       -- Defined at NewType_makeLenses.hs:9:1     \n&gt; :i baz                                                                    \nbaz :: Lens (Foo a0) (Foo a1) a0 a1                                         \n        -- Defined at NewType_makeLenses.hs:10:1   \n</code></pre>\n\n<h2>With <code>-dppr-cols140</code></h2>\n\n<pre><code>$ ghci -dppr-cols140 NewType_makeLenses.hs\n[1 of 1] Compiling Main             ( NewType_makeLenses.hs, interpreted )\nOk, modules loaded: Main.\n&gt; :i bar\nbar :: Lens' (Foo a0) Int       -- Defined at NewType_makeLenses.hs:9:1\n&gt; :i baz\nbaz :: Lens (Foo a0) (Foo a1) a0 a1     -- Defined at NewType_makeLenses.hs:10:1\n</code></pre>\n\n<h2>With <code>:set -dppr-cols140</code></h2>\n\n<pre><code>$ ghci NewType_makeLenses.hs\n[1 of 1] Compiling Main             ( NewType_makeLenses.hs, interpreted )\nOk, modules loaded: Main.\n&gt; :set -dppr-cols140\n&gt; :i bar\nbar :: Lens' (Foo a0) Int       -- Defined at NewType_makeLenses.hs:9:1\n&gt; :i baz\nbaz :: Lens (Foo a0) (Foo a1) a0 a1     -- Defined at NewType_makeLenses.hs:10:1\n</code></pre>\n\n<h1>Bonus: how did I find this?</h1>\n\n<p>I didn't look into the flags, instead, I looked into GHC's source code:</p>\n\n<pre><code>$ git clone --depth=1 https://github.com/ghc/ghc.git &amp;&amp; cd ghc\n</code></pre>\n\n<p>Next, I look for a string that starts with <code>\"Defined</code>:</p>\n\n<pre><code>$ grep -C2 \"\\\"Defined\" -r . --exclude-dir=testsuite\n./compiler/basicTypes/Name.hs-ppr_z_occ_name occ = ztext (zEncodeFS (occNameFS occ))\n./compiler/basicTypes/Name.hs-\n./compiler/basicTypes/Name.hs:-- Prints (if mod information is available) \"Defined at &lt;loc&gt;\" or\n./compiler/basicTypes/Name.hs:--  \"Defined in &lt;mod&gt;\" information for a Name.\n./compiler/basicTypes/Name.hs-pprDefinedAt :: Name -&gt; SDoc\n./compiler/basicTypes/Name.hs:pprDefinedAt name = text \"Defined\" &lt;+&gt; pprNameDefnLoc name\n./compiler/basicTypes/Name.hs-\n./compiler/basicTypes/Name.hs-pprNameDefnLoc :: Name -&gt; SDoc\n</code></pre>\n\n<p><code>SDoc</code> seems interesting.</p>\n\n<pre><code>$ grep \"data SDoc\" -r . --exclude-dir=testsuite\n./compiler/utils/Outputable.hs:data SDocContext = SDC\n./compiler/utils/Outputable.hs-boot:data SDoc\n</code></pre>\n\n<p><code>Outputable.hs</code> includes <code>printForUser</code>, which uses <code>pprCol dflags</code> together with <code>printDoc</code> from <code>Pretty</code>. <code>printDoc</code> is defined as</p>\n\n<pre><code>printDoc :: Mode -&gt; Int -&gt; Handle -&gt; Doc -&gt; IO ()\n-- printDoc adds a newline to the end\nprintDoc mode cols hdl doc = printDoc_ mode cols hdl (doc $$ text \"\")\n</code></pre>\n\n<p>and <code>pprCol</code> is defined in <code>compiler/main/DynFlags.hs</code>, where it corresponds to <code>-dppr-cols</code>. You can just <code>grep</code> your way through GHC :).</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 3, "accepted_answer_id": 39042634, "answer_count": 1, "score": 16, "last_activity_date": 1471620581, "creation_date": 1471617714, "question_id": 39041851, "link": "https://stackoverflow.com/questions/39041851/increase-the-width-of-ghci", "title": "Increase the &quot;width&quot; of ghci", "body": "<p>When an output line is too long in GHCI, it is broken:</p>\n\n<pre><code>&gt; :i bar\nbar :: Lens' (Foo a0) Int   -- Defined at NewType_makeLenses.hs:7:1\n&gt; :i baz\nbaz :: Lens (Foo a0) (Foo a1) a0 a1\n    -- Defined at NewType_makeLenses.hs:7:1\n</code></pre>\n\n<p>Is there a way to set the maximal length of the lines?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": false, "score": 0, "last_activity_date": 1471593806, "creation_date": 1471593806, "answer_id": 39034010, "question_id": 39033380, "link": "https://stackoverflow.com/questions/39033380/using-char-does-not-compile-without-flexiblecontexts/39034010#39034010", "title": "Using Char does not compile without FlexibleContexts", "body": "<p>Just a thought based on <strong>my understanding</strong> - when you pass in a <code>Char</code> value, it is already a 'specialised' type. On the other hand, since you pass in numbers without explicitly typing, I believe that could be interpreted as passing a more general type i.e. <code>(Num a) =&gt; a</code>. That is why GHC complains for explicit <code>Char</code> literal, but not for the numbers.</p>\n\n<p>Basing this off my understanding of the documentation <a href=\"https://prime.haskell.org/wiki/FlexibleContexts\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>Haskell computes a type for each variable bound by let or where, and then generalizes this type. In Haskell 98, the allowed contexts are restricted, so contexts are reduced using instance declarations (and duplicate assertions and those implied by class contexts are removed) until either they are in the allowed form or no instance is applicable, in which case an error is reported.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 10, "last_activity_date": 1471595956, "last_edit_date": 1471595956, "creation_date": 1471593877, "answer_id": 39034032, "question_id": 39033380, "link": "https://stackoverflow.com/questions/39033380/using-char-does-not-compile-without-flexiblecontexts/39034032#39034032", "title": "Using Char does not compile without FlexibleContexts", "body": "<p>The reason is actually in the error message.</p>\n\n<pre><code>Non type-variable argument in the constraint: \n  MArray a0 Char m (Use FlexibleContexts to permit this)\n</code></pre>\n\n<p>When you use the literals <code>'_'</code> and <code>'1'</code>, Haskell infers that their type is <code>Char</code>, then it runs up against the most typical problem that you get with constraints that are <code>MultiParamTypeClasses</code> - constraints arguments aren't all type variables, yet that is what the Haskell report requires them to be. The signature Haskell <em>wants</em> to infer is something like</p>\n\n<pre><code>drawLine :: MArray a Char m =&gt; ...\n</code></pre>\n\n<p>This wasn't a problem before <code>MultiParamTypeClasses</code> since all classes before had only one argument. Then, if that argument was not a type variable, all you had to do was check that that instance was derivable and if it <em>was</em> a type variable, you'd keep it as a constraint. With <code>MultiParamTypeClasses</code> you often end up with in-between cases - some of the arguments are instantiated, some aren't. <a href=\"https://prime.haskell.org/wiki/FlexibleContexts\"><code>FlexibleContexts</code></a> lets you have this sort of mixture (and even some more). This is a safe extension (which I would love to see be part of Haskell 2020).</p>\n\n<h2>But what about <code>Int</code>? Why doesn't it give me the same error?</h2>\n\n<p>It actually isn't directly about <code>Int</code>. When Haskell sees the literals <code>0</code> and <code>1</code>, since numeric literals are overloaded, it only decides on a general type: <code>Num a =&gt; a</code>. That means that the constraint Haskell infers is just</p>\n\n<pre><code>drawLine :: (Num n, MArray a n m) =&gt; ...\n</code></pre>\n\n<p>And this doesn't even need <code>FlexibleInstances</code> since all constraints have arguments that are type variables.</p>\n"}], "owner": {"reputation": 155, "user_id": 3887909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af799135f35b0844ee98fa86d00b9d39?s=128&d=identicon&r=PG&f=1", "display_name": "XperianX", "link": "https://stackoverflow.com/users/3887909/xperianx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 39034032, "answer_count": 2, "score": 5, "last_activity_date": 1471595956, "creation_date": 1471591662, "question_id": 39033380, "link": "https://stackoverflow.com/questions/39033380/using-char-does-not-compile-without-flexiblecontexts", "title": "Using Char does not compile without FlexibleContexts", "body": "<pre><code>sierpinski :: Int -&gt; Array (Int,Int) Char\nsierpinski l = runSTArray $ do\n  arr &lt;- newArray ((1,1),(63,32)) '_'\n  let drawLine x y len = forM_ [-len..len] $ \\s -&gt; writeArray arr (x+s,y-len) '1' --this part does not compile without FlexibleContexts \\\\* Non type-variable argument in the constraint: MArray a0 Char m (Use FlexibleContexts to permit this)\n  let rek n x y h | n == 0 = forM_ [0..h-1] (drawLine x y)\n                  | otherwise = do\n                    rek (n-1) x y (div h 2)\n                    rek (n-1) (x + div h 2) (y - div h 2) (div h 2)\n                    rek (n-1) (x - div h 2) (y - div h 2) (div h 2)\n  rek l 32 32 32\n  return arr\n</code></pre>\n\n<p>However changing array type from Char to Int is okay</p>\n\n<pre><code>sierpinski :: Int -&gt; Array (Int,Int) Int\nsierpinski l = runSTArray $ do\n  arr &lt;- newArray ((1,1),(63,32)) 0\n  let drawLine x y len = forM_ [-len..len] $ \\s -&gt; writeArray arr (x+s,y-len) 1 --now ok\n  let rek n x y h | n == 0 = forM_ [0..h-1] (drawLine x y)\n                  | otherwise = do\n                    rek (n-1) x y (div h 2)\n                    rek (n-1) (x + div h 2) (y - div h 2) (div h 2)\n                    rek (n-1) (x - div h 2) (y - div h 2) (div h 2)\n  rek l 32 32 32\n  return arr\n</code></pre>\n\n<p>Can someone clarify why is this happening?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1471577191, "post_id": 39030452, "comment_id": 65411603, "body": "What does &quot;warped characters&quot; mean? As someone who doesn&#39;t read chinese, I look at that page and I see stuff that looks like chinese, so I don&#39;t know what issue you are trying to fix."}, {"owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1471577940, "post_id": 39030452, "comment_id": 65411805, "body": "@amalloy,those are not chinese.see this article: <a href=\"http://kunststube.net/encoding/\" rel=\"nofollow noreferrer\">kunststube.net/encoding</a> ,i mean &quot;encoding error&quot;. which file in the repo <a href=\"https://phabricator.chromabits.com/diffusion/B/blog\" rel=\"nofollow noreferrer\">phabricator.chromabits.com/diffusion/B/blog</a> should i edit to use utf-8 encoding ?"}], "answers": [{"comments": [{"owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "edited": false, "score": 0, "creation_date": 1471607754, "post_id": 39036131, "comment_id": 65426243, "body": "&#39;A simple bandaid fix for this would be to simply state the encoding in the html header:  &lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt; &lt;/head&gt; that will fix it for that page at least. &#39; -this does works.thank u"}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 2, "last_activity_date": 1471600688, "creation_date": 1471600688, "answer_id": 39036131, "question_id": 39030452, "link": "https://stackoverflow.com/questions/39030452/how-to-fix-the-warped-characters-issue-in-a-haskell-project/39036131#39036131", "title": "how to fix the &quot;warped characters&quot; issue in a haskell project?", "body": "<p>Your website is encoded in UTF-8, and does in fact contain proper chinese text. Your problem is that the website doesn't advertise that it is encoded that way, therefore any browser you'll use will simply take an educated guess (which will often be wrong). For example, Chrome on Windows 10 picks Windows-1252 as the character encoding for me, which is of course wrong. A browser on linux might default to UTF-8 instead, so a user like that might not see anything wrong.</p>\n\n<p>A simple bandaid fix for this would be to simply state the encoding in the html header:</p>\n\n<pre><code>&lt;head&gt;\n   &lt;meta charset=\"utf-8\"&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>that will fix it for that page at least. Going forward you should set up your webserver to send the correct encoding in the HTTP header (it's part of the Content-Type header field, see <a href=\"https://www.w3.org/International/articles/http-charset/index\" rel=\"nofollow\">here</a> for details).</p>\n\n<p>You can also tell your browser to use a particular encoding for a website to diagnose issues like this.</p>\n"}], "owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1472177345, "answer_count": 1, "score": -1, "last_activity_date": 1471600688, "creation_date": 1471575555, "question_id": 39030452, "link": "https://stackoverflow.com/questions/39030452/how-to-fix-the-warped-characters-issue-in-a-haskell-project", "closed_reason": "Needs details or clarity", "title": "how to fix the &quot;warped characters&quot; issue in a haskell project?", "body": "<p>i cloned this haskell-based blog project:</p>\n\n<p>git clone <a href=\"https://phabricator.chromabits.com/diffusion/B/blog\" rel=\"nofollow\">https://phabricator.chromabits.com/diffusion/B/blog</a> blog-by-chromabits</p>\n\n<p>i setup a blog successfully: <a href=\"http://cb.smt.biz.st\" rel=\"nofollow\">http://cb.smt.biz.st</a> ,but a post written in chinese has \"warped characters\",the post is <a href=\"http://cb.smt.biz.st/posts/2016/08/13/test-1/\" rel=\"nofollow\">http://cb.smt.biz.st/posts/2016/08/13/test-1/</a> ,</p>\n\n<p>how to fix this \"warped characters\" issue?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1471574171, "post_id": 39030173, "comment_id": 65410924, "body": "There&#39;s a lot of stuff we could explain here, maybe you&#39;d like to be a bit more precise about what you don&#39;t understand? Also, it helps if you start by explaining what you <i>do</i> understand..."}, {"owner": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471577381, "post_id": 39030173, "comment_id": 65411655, "body": "I understand the first line, for the second one, I think it is taking elt, mapping it from tail to head, if the mod result is equal to zero, then it zips particular element to a list."}, {"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471577867, "post_id": 39030173, "comment_id": 65411787, "body": "Here&#39;s a solution with a closely related approach: <code>nths n= catMaybes.zipWith($)(tail.cycle$Just:replicate(n-1)(const Nothing))</code>. Feel free to compare and contrast - and then tell us what&#39;s missing. If this is a homework assignment, feel free to use it at your own peril. I&#39;ll even throw in a golfed version of yet another related approach. Have fun. <code>\\n-&gt;concat.zipWith($)(cycle$([2..n]&gt;&gt;[const[]])++[(:[])])</code>"}, {"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 2, "creation_date": 1471578424, "post_id": 39030173, "comment_id": 65411887, "body": "More general tip: Try copying your code (without type signature) into your interpreter. Add a <code>:t</code> in front of it to get it to tell you the type. Then start removing stuff and see how the type changes. That gives you a rough idea what&#39;s what. If some part is harder to understand remove everything around it and keep trying. Interaction with the type checker is your most important tool."}], "answers": [{"tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 3, "last_activity_date": 1471635201, "last_edit_date": 1471635201, "creation_date": 1471607242, "answer_id": 39038321, "question_id": 39030173, "link": "https://stackoverflow.com/questions/39030173/every-n-th-element-of-a-list-in-the-form-of-a-list/39038321#39038321", "title": "Every n-th element of a list in the form of a list", "body": "<p>It's easy to use pattern matching to 'select every nth element' for particular cases of n:</p>\n\n<pre><code>every2nd (first:second:rest) = second : every2nd rest\nevery2nd _ = []\n-- &gt;&gt;&gt; every2nd [1..12]\n-- [2,4,6,8,10,12]\n\nevery3rd (first:second:third:rest) = third : every3rd rest\nevery3rd _ = []\n-- &gt;&gt;&gt; every3rd [1..13]\n-- [3,6,9,12]\n\nevery4th (first:second:third:fourth:rest) = fourth : every4th rest\nevery4th _ = []\n-- &gt;&gt;&gt; every4th [1..12]\n-- [4,8,12]\n</code></pre>\n\n<p>For the general case, though, we're out of luck, at least with that particular approach. Patterns like those above will need some definite length to be definite patterns. The composed function you mention starts from the thought that we do know how to find every nth member of <code>[1..]</code>, namely if it's a multiple of n</p>\n\n<pre><code>multiple n m = m `mod` n == 0\n-- &gt;&gt;&gt; filter (multiple 3) [1..12]\n-- [3,6,9,12]\n</code></pre>\n\n<p>So the solution you are trying to understand zips <code>[1..]</code> with the list</p>\n\n<pre><code>index xs = zip [1..] xs\n-- &gt;&gt;&gt; index [1..5]\n-- [(1,1),(2,2),(3,3),(4,4),(5,5)]\n-- &gt;&gt;&gt; index \"hello\"\n-- [(1,'h'),(2,'e'),(3,'l'),(4,'l'),(5,'o')]\n</code></pre>\n\n<p>Then it filters out just those pairs whose first element is a multiple of n</p>\n\n<pre><code>every_nth_with_index n xs = filter (\\(m,a) -&gt; multiple n m) (index xs)\n-- &gt;&gt;&gt; every_nth_with_index 3 [1..12]\n-- [(3,3),(6,6),(9,9),(12,12)]\n-- &gt;&gt;&gt; every_nth_with_index 3 \"stackoverflow.com\"\n-- [(3,'a'),(6,'o'),(9,'r'),(12,'o'),(15,'c')]\n</code></pre>\n\n<p>Then it gets rid of the ancillary construction, leaving us with just the second element of each pair:</p>\n\n<pre><code>every_nth n xs = map snd (every_nth_with_index n xs)\n-- &gt;&gt;&gt; every_nth 3 [1..12]\n-- [3,6,9,12]\n-- &gt;&gt;&gt; every_nth 3 \"stackoverflow.com\"\n-- \"aoroc\"\n</code></pre>\n\n<p>Retracinging our steps we see that this is the same as </p>\n\n<pre><code>everyNth elt = map snd . filter (\\(lst,y) -&gt; (mod lst elt) == 0) . zip [1..] \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471616322, "post_id": 39040160, "comment_id": 65432188, "body": "As a bonus, this way is efficient!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471617322, "post_id": 39040160, "comment_id": 65432915, "body": "One gripe: pattern matching never fails here. See my answer."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471617655, "post_id": 39040160, "comment_id": 65433180, "body": "This improves the combinator approach to be similarly efficient, at least in the composition I checked ... <code>everyNth n = map snd . filter fst . zip (circ n) where circ n = drop  1 $ cycle (True : replicate (n-1) False)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471618613, "post_id": 39040160, "comment_id": 65433824, "body": "@Michael, that&#39;s a nice use of fusion! Unfortunately, I suspect you&#39;ll start to run into a bit of trouble once <code>n</code> gets large enough that the cycle size is comparable to the CPU cache size."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471621031, "post_id": 39040160, "comment_id": 65435328, "body": "@dfeuer oh I see, yes ... I was testing with <code>n=2</code>. At say  <code>n = 2000000</code> mine takes almost three times as much time."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1471619671, "last_edit_date": 1471619671, "creation_date": 1471612870, "answer_id": 39040160, "question_id": 39030173, "link": "https://stackoverflow.com/questions/39030173/every-n-th-element-of-a-list-in-the-form-of-a-list/39040160#39040160", "title": "Every n-th element of a list in the form of a list", "body": "<p>With a little cheating, you can define <code>everyNth</code> using pattern matching. Really, we're abstracting out the part that makes pattern matching difficult, as pointed out in Michael's answer.</p>\n\n<pre><code>everyNth n lst = e (shorten lst)\n                 where shorten = drop (n-1) -- here's the cheat\n                       e [] = []\n                       e (first:rest) = first : e (shorten rest)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471621267, "post_id": 39041479, "comment_id": 65435505, "body": "Is the first match equivalent to <code>go !k [] = []</code>?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1471626609, "post_id": 39041479, "comment_id": 65438481, "body": "Off topic (there&#39;s no pattern matching) I think the following reads quite nicely <code>everyNth n = map head . takeWhile (not . null) . iterate (drop n)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1471631701, "post_id": 39041479, "comment_id": 65441093, "body": "@Cirdec, I don&#39;t much care for unnecessary partial functions, and I am a fan of list fusion. I don&#39;t know if there&#39;s a particularly pretty way to get the fusion. You could limit yourself to total functions if we had <code>takeWhileJust :: (a -&gt; Maybe b) -&gt; [a] -&gt; [b]</code> with <code>takeWhileJust f (x : xs) | Just y &lt;- f x = y : takeWhileJust f xs; takeWhileJust _ _ = []</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471631781, "post_id": 39041479, "comment_id": 65441137, "body": "@chepner, yes. I just didn&#39;t want to bother with extensions for this."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1471617217, "last_edit_date": 1495540295, "creation_date": 1471616714, "answer_id": 39041479, "question_id": 39030173, "link": "https://stackoverflow.com/questions/39030173/every-n-th-element-of-a-list-in-the-form-of-a-list/39041479#39041479", "title": "Every n-th element of a list in the form of a list", "body": "<p>The notorious fold fan strikes again.</p>\n\n<pre><code>everyNth n xs = foldr go (`seq` []) xs n where\n  go x r 0 = x : r (n - 1)\n  go _ r k = r (k - 1)\n</code></pre>\n\n<p>This is very similar to <a href=\"https://stackoverflow.com/a/39040160/1477667\">chepner's approach</a> but it integrates the dropping into the recursion. Rewritten without the fold, it's pure pattern matching:</p>\n\n<pre><code>everyNth n = go n where\n  go k [] = k `seq` []\n  go 0 (x : xs) = x : go (n - 1) xs\n  go k (_ : xs) = go (k - 1) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1471626476, "creation_date": 1471626476, "answer_id": 39044429, "question_id": 39030173, "link": "https://stackoverflow.com/questions/39030173/every-n-th-element-of-a-list-in-the-form-of-a-list/39044429#39044429", "title": "Every n-th element of a list in the form of a list", "body": "<p>If you have never seen Haskell before then this takes a bit of explaining.</p>\n\n<pre><code>everyNth :: Int -&gt; [t] -&gt; [t]\neveryNth elt = map snd . filter (\\(lst,y) -&gt; (mod lst elt) == 0) . zip [1..] \n</code></pre>\n\n<p>First, note that the type has two arguments, but the definition has only one. This is because the value returned by <code>everyNth</code> is in fact another function. <code>elt</code> is the Int, and the expression in the second line creates a new function that does the job.</p>\n\n<p>Second, note the \".\" operators. This is an operator that joins two functions together. It is defined like this:</p>\n\n<pre><code>(f . g) x = f (g x)\n</code></pre>\n\n<p>Here is an equivalent version of the definition with the second argument made explicit:</p>\n\n<pre><code>everyNth elt xs = map snd (filter (\\(lst y) -&gt; (mod lst elt) == 0) (zip xs))\n</code></pre>\n\n<p>When you see a bunch of functions in a chain linked by \".\" operators you need to read it from right to left. In my second version pay attention to the bracket nesting. <code>zip [1..] xs</code> is the inner-most expression, so it gets evaluated first. It turns a list like <code>[\"foo\", \"bar\"]</code> into <code>[(1, \"foo\"),(2, \"bar\")]</code>. Then this is filtered to find entries where the number is a multiple of <code>elt</code>. Finally the <code>map snd</code> strips the numbers back out to return just the required entries.</p>\n"}], "owner": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1471635201, "creation_date": 1471573173, "last_edit_date": 1471592512, "question_id": 39030173, "link": "https://stackoverflow.com/questions/39030173/every-n-th-element-of-a-list-in-the-form-of-a-list", "title": "Every n-th element of a list in the form of a list", "body": "<p>I went through a post for this problem but I do not understand it. Could someone please explain it?</p>\n\n<p>Q: Find every n-th element of the list in the form of a list start from the n-th element itself.</p>\n\n<pre><code>everyNth :: Int -&gt; [t] -&gt; [t]\neveryNth elt = map snd . filter (\\(lst,y) -&gt; (mod lst elt) == 0) . zip [1..] \n</code></pre>\n\n<p>Also, please explain how pattern matching can be used for this problem. That is using</p>\n\n<pre><code>[]-&gt;[]\n</code></pre>\n"}, {"tags": ["haskell", "generics", "rust", "typeclass", "traits"], "comments": [{"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 1, "creation_date": 1471576202, "post_id": 39028392, "comment_id": 65411353, "body": "<a href=\"http://meta.stackexchange.com/q/39223/281829\">One question per question, please</a>."}, {"owner": {"reputation": 10655, "user_id": 4529124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4P3eZ.png?s=128&g=1", "display_name": "Chris Emerson", "link": "https://stackoverflow.com/users/4529124/chris-emerson"}, "edited": false, "score": 1, "creation_date": 1471594554, "post_id": 39028392, "comment_id": 65418176, "body": "Your Rust definition of <code>empty</code> is more like <code>a -&gt; ()</code> in Haskell. Better would be <code>fn empty() -&gt; Self;</code> ."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1471603374, "post_id": 39028392, "comment_id": 65423511, "body": "I have a feeling you&#39;re using Haskell&#39;s classes inappropriately. Type classes are not like OO classes; they&#39;re more like interfaces. Unless you have a requirement to abstract over various different implementations of <code>Hashset</code> I&#39;d just define a plain old type: <code>data Hashset a = ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "is_accepted": false, "score": 1, "last_activity_date": 1471575973, "last_edit_date": 1495539865, "creation_date": 1471575973, "answer_id": 39030500, "question_id": 39028392, "link": "https://stackoverflow.com/questions/39028392/bounded-trait-parameter-with-supertrait-in-rust/39030500#39030500", "title": "Bounded trait parameter with supertrait in Rust", "body": "<blockquote>\n  <p>is it possible to both constrain the associated type and use a supertrait?</p>\n</blockquote>\n\n<p>Sure, I'm not sure why you didn't just combine the two syntaxes:</p>\n\n<pre><code>trait Hashset&lt;E&gt;: HasEmpty\n    where E: Hashable\n{\n    fn size(&amp;self) -&gt; i32;\n}\n</code></pre>\n\n<p>However, you should know that <code>E</code> is <strong>not</strong> an associated type, it's just a generic type. See <a href=\"https://stackoverflow.com/q/32059370/155423\">When is it appropriate to use an associated type versus a generic type?</a> for more info.</p>\n\n<p>An associated type would be:</p>\n\n<pre><code>trait Hashset: HasEmpty {\n    type E: Hashable;\n    fn size(&amp;self) -&gt; i32;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6380165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nvTQw.jpg?s=128&g=1", "display_name": "donkey_hotei", "link": "https://stackoverflow.com/users/6380165/donkey-hotei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1471576066, "creation_date": 1471558914, "last_edit_date": 1471576066, "question_id": 39028392, "link": "https://stackoverflow.com/questions/39028392/bounded-trait-parameter-with-supertrait-in-rust", "title": "Bounded trait parameter with supertrait in Rust", "body": "<p>I am new to both Haskell and Rust and am attempting to translate Haskell code into Rust so as to compare the features that support genericity. However, it seems I either need help with syntax or some fundamental concepts in Rust.</p>\n\n<p>I have this code in Haskell:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class HasEmpty a where\n    empty :: a\n    isEmpty :: a -&gt; Bool\n\nclass Hashable a where\n    hash :: a -&gt; Int\n\nclass (HasEmpty x, Hashable (Element x))\n        =&gt; Hashset x where\n    type Element x\n    size :: x -&gt; Int\n</code></pre>\n\n<p>The important part is at the bottom where we define a type class named <code>Hashset</code> which takes a single parameter <code>x</code> and sub-classes <code>HasEmpty</code>. The body of the type class defines an associated type, which is required to be <code>Hashable</code>, and an associated method <code>size</code>.</p>\n\n<p>How can I do the same thing in Rust? Here is what I've written thus far:</p>\n\n<pre><code>trait HasEmpty {\n    fn empty(&amp;self);\n    fn is_empty(&amp;self) -&gt; bool;\n}\n\ntrait Hashable {\n    fn hash(&amp;self) -&gt; u32;\n}\n\ntrait Hashset&lt;E&gt;\n    where E: Hashable\n{\n    fn size(&amp;self) -&gt; i32;\n}\n</code></pre>\n\n<p>This compiles and allows me to say that the associated type <code>E</code> is   Hashable, but how can I 'inherit' the 'trait methods' of <code>HasEmpty</code> by using it as a supertrait? I know this is possible by saying:</p>\n\n<pre><code>trait Hashset: HasEmpty {\n    fn size(&amp;self) -&gt; i32;\n}\n</code></pre>\n\n<p>but is it possible to both constrain the associated type and use a supertrait? Perhaps I am asking the wrong question.</p>\n"}, {"tags": ["haskell", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 2, "creation_date": 1471574734, "post_id": 39029281, "comment_id": 65411034, "body": "Ah, that makes sense. Would there be an analogous operation for pushouts in relational languages?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1471749880, "post_id": 39029281, "comment_id": 65470638, "body": "Isn&#39;t the fundamental problem that Haskell lacks a way to express that particular diagrams commute, rather than anything to do with subsets? I wonder if <code>TypeInType</code> gives us enough power to talk about these ideas, painfully, at the type level."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 11, "last_activity_date": 1471565176, "creation_date": 1471565176, "answer_id": 39029281, "question_id": 39028347, "link": "https://stackoverflow.com/questions/39028347/is-this-an-accurate-example-of-a-haskell-pullback/39029281#39029281", "title": "Is this an accurate example of a Haskell Pullback?", "body": "<p>I'm not sure Haskell functions are the best context\nin which to talk about pull-backs.</p>\n\n<p>The pull-back of <em>A</em> -> <em>B</em> and <em>C</em> -> <em>B</em> can be identified with a subset of <em>A</em> x <em>C</em>,\nand subset relationships are not directly expressible in Haskell's\ntype system. In your specific example the pull-back would be\nthe single element (1, True) because <em>x</em> = 1 and <em>b</em> = True are\nthe only values for which <em>f</em>(<em>x</em>) = <em>g</em>(<em>b</em>).</p>\n\n<p>Some good \"practical\" examples of pull-backs may be found\nstarting on page 41 of <a href=\"http://math.mit.edu/~dspivak/CT4S.pdf\">Category Theory for Scientists</a>\nby David I. Spivak.</p>\n\n<p>Relational joins are the archetypal example of pull-backs\nwhich occur in computer science.  The query:</p>\n\n<pre><code>SELECT ...\nFROM A, B\nWHERE A.x = B.y\n</code></pre>\n\n<p>selects pairs of rows (<em>a</em>,<em>b</em>) where <em>a</em> is a row from table A\nand <em>b</em> is a row from table B and where some function of <em>a</em>\nequals some other function of <em>b</em>. In this case the functions\nbeing pulled back are <em>f(a) = a.x</em> and <em>g(b) = b.y</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 2, "creation_date": 1471719416, "post_id": 39049277, "comment_id": 65464764, "body": "your blog is a treasure trove, and I am especially loving Cat. Theory for Programmers. Thank you, and I&#39;ll be obsessing over it for weeks to come until I can competently catch up to Free/Forgetful Adjunctions. Can&#39;t wait for Monads! :)"}], "tags": [], "owner": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "is_accepted": false, "score": 9, "last_activity_date": 1471652154, "creation_date": 1471652154, "answer_id": 39049277, "question_id": 39028347, "link": "https://stackoverflow.com/questions/39028347/is-this-an-accurate-example-of-a-haskell-pullback/39049277#39049277", "title": "Is this an accurate example of a Haskell Pullback?", "body": "<p>Another interesting example of a pullback is type unification in type inference. You get type constraints from several places where a variable is used, and you want to find the tightest unifying constraint. I mention this example in <a href=\"https://bartoszmilewski.com/2015/04/15/limits-and-colimits/\" rel=\"noreferrer\">my blog</a>.</p>\n"}], "owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 1, "accepted_answer_id": 39029281, "answer_count": 2, "score": 9, "last_activity_date": 1471652154, "creation_date": 1471558686, "question_id": 39028347, "link": "https://stackoverflow.com/questions/39028347/is-this-an-accurate-example-of-a-haskell-pullback", "title": "Is this an accurate example of a Haskell Pullback?", "body": "<p>I'm still trying to grasp an intuition of <strong>pullbacks</strong> (from category theory), limits, and universal properties, and I'm not quite catching their usefulness, so maybe you could help shed some insight on that as well as verifying my trivial example?</p>\n\n<p>The following is intentionally verbose, the pullback should be <code>(p, p1, p2)</code>, and <code>(q, q1, q2)</code> is one example of a non-universal object to \"test\" the pullback against to see if things commute properly.</p>\n\n<pre><code>-- MY DIAGRAM, A -&gt; B &lt;- C\ntype A = Int\ntype C = Bool\ntype B = (A, C)\nf :: A -&gt; B\nf x = (x, True)\ng :: C -&gt; B\ng x = (1, x)\n\n-- PULLBACK, (p, p1, p2)\ntype PL = Int\ntype PR = Bool\ntype P = (PL, PR)\np = (1, True) :: P\np1 = fst\np2 = snd\n-- (g . p2) p == (f . p1) p\n\n-- TEST CASE\ntype QL = Int\ntype QR = Bool\ntype Q = (QL, QR)\nq = (152, False) :: Q\nq1 :: Q -&gt; A\nq1 = ((+) 1) . fst\nq2 :: Q -&gt; C\nq2 = ((||) True) . snd\n\nu :: Q -&gt; P\nu (_, _) = (1, True)\n-- (p2 . u == q2) &amp;&amp; (p1 . u = q1)\n</code></pre>\n\n<p>I was just trying to come up with an example that fit the definition, but it doesn't seem particularly useful. When would I \"look for\" a pull back, or use one?</p>\n"}, {"tags": ["haskell", "hmatrix"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471558334, "post_id": 39028176, "comment_id": 65407247, "body": "Note that Double is a specific instance of Num. <code>Matrix Double</code> is another specific instance of Num, but subtraction requires both arguments to be of the same type."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1471558490, "post_id": 39028176, "comment_id": 65407300, "body": "Notice that <code>3</code> actually has the type <code>Matrix Double</code> in your example. Numbers are overloaded in Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 0, "creation_date": 1471558468, "post_id": 39028227, "comment_id": 65407295, "body": "I&#39;m inferring from your words that what&#39;s actually happening when the compiler encounters <code>m - 3</code> is that it converts the 3 to a Matrix Double of ostensibly the same dimension as the matrix on the left, then performs the math on matrices? (Your point about not being able to subtract scalars from matrices runs sort of counter to the standard practice in many linear algebra packages of allowing just that.)"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 3, "creation_date": 1471558661, "post_id": 39028227, "comment_id": 65407351, "body": "@nclark: That&#39;s exactly what happens. <code>3</code> has the type <code>Num a =&gt; a</code>, based on the <code>fromInteger</code> function. <code>Matrix</code> has a <code>Num</code> instance that implements <code>fromInteger</code> as appropriate."}, {"owner": {"reputation": 461, "user_id": 6026302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b2a57659daba9701e24faec9fa37321?s=128&d=identicon&r=PG&f=1", "display_name": "villou24", "link": "https://stackoverflow.com/users/6026302/villou24"}, "edited": false, "score": 0, "creation_date": 1471558708, "post_id": 39028227, "comment_id": 65407373, "body": "Yep, exactly. It uses the <code>fromInteger</code> method from the <code>Num</code> class to do that, so your expression becomes <code>m - fromInteger 3</code>. In the case of <code>hmatrix</code>, I think <code>fromInteger n</code> is defined as the matrix where every element equals <code>n</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "edited": false, "score": 0, "creation_date": 1471599273, "post_id": 39028227, "comment_id": 65421060, "body": "@nclark: actually, not quite. It converts <code>3</code> to a 1 &#215; 1 matrix with the only value 3; then the subtraction operator pretends to expand that to an <i>n</i> &#215; <i>n</i> diagonal matrix to take away from <code>m</code>. This is much the same thing Matlab does and isn&#39;t as inefficient as actually generating an <i>n</i> &#215; <i>n</i> diagonal matrix, though frankly I consider it semantically rubbish."}], "tags": [], "owner": {"reputation": 461, "user_id": 6026302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b2a57659daba9701e24faec9fa37321?s=128&d=identicon&r=PG&f=1", "display_name": "villou24", "link": "https://stackoverflow.com/users/6026302/villou24"}, "is_accepted": true, "score": 7, "last_activity_date": 1471558388, "last_edit_date": 1471558388, "creation_date": 1471558025, "answer_id": 39028227, "question_id": 39028176, "link": "https://stackoverflow.com/questions/39028176/why-does-fail-to-typecheck-when-i-place-a-double-matrix-on-the-left-and-a-do/39028227#39028227", "title": "Why does (-) fail to typecheck when I place a Double Matrix on the left and a Double on the right?", "body": "<p>What happens when you do <code>m - 3</code> with <code>m :: Matrix Double</code> is that <code>3 :: Matrix Double</code>. The fact that <code>Matrix Double</code> is an instance of <code>Num</code> means that the compilers knows how to translate the litteral <code>3</code>. However when you do <code>m - (3 :: Double)</code>, you get a type error because <code>(-) :: (Num a) =&gt; a -&gt; a -&gt; a</code>, so the type of the element you subtract must be instances of <code>Num</code> and match. Hence you can subtract two <code>Double</code>s, two <code>Matrix Double</code>s but not  a <code>Matrix Double</code> and a <code>Double</code>.</p>\n\n<p>After all, this seems fairly logical to me, it doesn't make sense to subtract a matrix and a scalar.</p>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 5, "last_activity_date": 1471578982, "creation_date": 1471578982, "answer_id": 39030875, "question_id": 39028176, "link": "https://stackoverflow.com/questions/39028176/why-does-fail-to-typecheck-when-i-place-a-double-matrix-on-the-left-and-a-do/39030875#39030875", "title": "Why does (-) fail to typecheck when I place a Double Matrix on the left and a Double on the right?", "body": "<p>This is a common misunderstanding of people new to Haskell's style of typeclass based overloading, especially those who are used to the subclass-based overloading used in popular OO languages.</p>\n\n<p>The subtraction operator has type <code>Num a =&gt; a -&gt; a -&gt; a</code>; so it takes two arguments of any type that is in the type class <code>Num</code>. It <strong>seems</strong> like what is happening when you do <code>m - 3</code> is that the subtraction operator is accepting a <code>Matrix Double</code> on the left and some simple numeric type on the right. But that is actually incorrect.</p>\n\n<p>When a type signature like <code>Num a =&gt; a -&gt; a -&gt; a</code> uses the same type variable multiple times, you can pick any type you like (subject to the contstraints before the <code>=&gt;</code>: <code>Num a</code> in this case) to use for <code>a</code> but it has to be <strong>the exact same type</strong> everywhere that <code>a</code> appears. <code>Matrix Double -&gt; Double -&gt; ???</code> is not a valid instantiation of the type <code>Num a =&gt; a -&gt; a -&gt; a</code> (and if it were, how would you know what it returned?).</p>\n\n<p>The reason <code>m - 3</code> works is that <em>because</em> both arguments have to be the same type, and <code>m</code> is definitely of type <code>Matrix Double</code>, the compiler sees that <code>3</code> must also be of type <code>Matrix Double</code>. So instead of using the <code>3</code> appearing in the source text to build a <code>Double</code> (or <code>Integer</code>, or one of many other numeric types), it uses the source text <code>3</code> to build a <code>Matrix Double</code>. Effectively the type inference has changed the way the compiler <em>reads</em> the source code text <code>3</code>.</p>\n\n<p>But if you use <code>m' = m - (3::Double)</code> then you're not letting it just figure out what type <code>3</code> must have to make the use of the subtraction operator valid, you're telling it that this <code>3</code> is specifically a <code>Double</code>. There's no way <em>both</em> facts to be true (your <code>:: Double</code> assertion and the requirement that the subtraction operator gets two arguments of the same type), so you get a type error.</p>\n"}], "owner": {"reputation": 955, "user_id": 817658, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9a03bfe9e020bce25a7fac210bdeff84?s=128&d=identicon&r=PG", "display_name": "nclark", "link": "https://stackoverflow.com/users/817658/nclark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 39028227, "answer_count": 2, "score": 1, "last_activity_date": 1471578982, "creation_date": 1471557730, "question_id": 39028176, "link": "https://stackoverflow.com/questions/39028176/why-does-fail-to-typecheck-when-i-place-a-double-matrix-on-the-left-and-a-do", "title": "Why does (-) fail to typecheck when I place a Double Matrix on the left and a Double on the right?", "body": "<p>Since hmatrix provides an instance of Num for Matrix types, I can express element-wise subtraction like:</p>\n\n<pre><code>m = (2&gt;&lt;2)[1..] :: Double Matrix\nm' = m - 3\n</code></pre>\n\n<p>That works great, as <code>3</code> is a <code>Num</code>, and results in a matrix created by subtracting 3 from each element of <code>m</code>.</p>\n\n<p>Why does this not also work:</p>\n\n<pre><code>m' = m - (3::Double)\n</code></pre>\n\n<p>The error I'm getting is: </p>\n\n<pre><code>Couldn't match expected type \u2018Matrix Double\u2019\n            with actual type \u2018Double\u2019\nIn the second argument of \u2018(-)\u2019, namely \u2018(3 :: Double)\u2019\nIn the expression: m - (3 :: Double)\n</code></pre>\n\n<p>I expected the compiler to understand that a <code>Double</code> is also a <code>Num</code>. Why is that seemingly not the case?</p>\n"}, {"tags": ["haskell", "ghcjs"], "comments": [{"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 1, "creation_date": 1471538105, "post_id": 39023287, "comment_id": 65397174, "body": "Are you using Reflex FRP <i>in normal Haskell</i>, or were you thinking of compiling your program to JavaScript?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1471538909, "post_id": 39023287, "comment_id": 65397682, "body": "All the recent uses on github do <code>import GHCJS.DOM.Document </code>"}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 0, "creation_date": 1471539903, "post_id": 39023287, "comment_id": 65398338, "body": "@TikhonJelvis, I plan to compile it to JS, but it will be nice to have ghci access during dev for debugging in repl, if possible."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471539944, "post_id": 39023287, "comment_id": 65398360, "body": "@Michael, yep, I tried that as well. It doesn&#39;t work either because that module doesn&#39;t export it any more."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1471541663, "post_id": 39023287, "comment_id": 65399347, "body": "@Michael, it is now renamed to <code>getElementById</code>. So, that will work. You can post it as an answer if you will like to."}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "is_accepted": true, "score": 0, "last_activity_date": 1471959167, "creation_date": 1471959167, "answer_id": 39102701, "question_id": 39023287, "link": "https://stackoverflow.com/questions/39023287/importing-documentcreateelement-function-from-webkit/39102701#39102701", "title": "Importing documentCreateElement function from Webkit", "body": "<p><code>documentGetElementById</code> has been renamed to <code>getElementById</code> after <code>ghcjs-dom</code> refactoring. So, an import like below would work:</p>\n\n<pre><code>*Main&gt; import Graphics.UI.Gtk.WebKit.DOM.Document\n*Main Graphics.UI.Gtk.WebKit.DOM.Document&gt; :t getElementById \ngetElementById\n  :: (DocumentClass self, System.Glib.UTFString.GlibString string,\n      MonadIO m) =&gt;\n     self -&gt; string -&gt; m (Maybe Graphics.UI.Gtk.WebKit.Types.Element)\n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 39102701, "answer_count": 1, "score": 1, "last_activity_date": 1471959167, "creation_date": 1471537854, "question_id": 39023287, "link": "https://stackoverflow.com/questions/39023287/importing-documentcreateelement-function-from-webkit", "title": "Importing documentCreateElement function from Webkit", "body": "<p>I am trying to import <code>documentGetElementById</code> function for use in <code>Reflex FRP</code>. I tried the import below but can't find the function (which according to hackage should be there):</p>\n\n<pre><code>GHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( Test.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; import Graphics.UI.Gtk.WebKit.DOM.Document\n*Main Graphics.UI.Gtk.WebKit.DOM.Document&gt; :t documentGetElementById\n&lt;interactive&gt;:1:1: error:\n   Variable not in scope: documentGetElementById\n</code></pre>\n\n<p>I will appreciate help with resolving this. I am running latest Reflex platform build with <code>ghc 8.0.1</code> on mac where webkit works now. I see the same problem on Linux as well. So, it doesn't seem to be platform-specific.</p>\n\n<p>I also did <a href=\"https://github.com/ghcjs/ghcjs-dom/search?utf8=%E2%9C%93&amp;q=documentGetElementById\" rel=\"nofollow\">github code search</a> on <code>ghcjs-dom</code> but <code>documentGetElementById</code> doesn't show up. So, perhaps it has been moved somewhere else?</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "reverse"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1471533415, "post_id": 39021799, "comment_id": 65394144, "body": "Point-free, this is just <code>rev = reverse . map reverse</code>"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1471535042, "post_id": 39021799, "comment_id": 65395314, "body": "Btw the natural way to write <code>reverse</code> by pattern matching is to use a helper function and an accumulating list; first <code>rev ls = loop [] ls</code> then <code>loop acc [] = acc; loop acc (a:as) = loop (a:acc) ls</code>"}], "answers": [{"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1471709210, "post_id": 39021874, "comment_id": 65461333, "body": "It doesn&#39;t matter whether you reverse the inner or outer lists first."}, {"owner": {"reputation": 461, "user_id": 6026302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b2a57659daba9701e24faec9fa37321?s=128&d=identicon&r=PG&f=1", "display_name": "villou24", "link": "https://stackoverflow.com/users/6026302/villou24"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1471825378, "post_id": 39021874, "comment_id": 65488363, "body": "@Ingo You&#39;re correct, that was just a convenient way of talking to make the solution clearer and the thought process clearer ;) But I&#39;ll add a precision"}], "tags": [], "owner": {"reputation": 461, "user_id": 6026302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b2a57659daba9701e24faec9fa37321?s=128&d=identicon&r=PG&f=1", "display_name": "villou24", "link": "https://stackoverflow.com/users/6026302/villou24"}, "is_accepted": true, "score": 7, "last_activity_date": 1471825694, "last_edit_date": 1471825694, "creation_date": 1471533429, "answer_id": 39021874, "question_id": 39021799, "link": "https://stackoverflow.com/questions/39021799/reversing-a-list-in-another-list-in-haskell/39021874#39021874", "title": "Reversing a list in another list in Haskell", "body": "<p>We have to reverse the inner lists and the outter list. To reverse the inner lists, you can use <code>map</code> to apply <code>reverse</code> on each element of the list: <code>map reverse [[3,4,5],[7,5,2]] == [[5,4,3],[2,5,7]]</code>. Then just reverse the result again <code>reverse $ map reverse [[3,4,5],[7,5,2]] == [[2,5,7],[5,4,3]]</code>.</p>\n\n<p>A function that does that is just a composition of <code>reverse</code> and <code>map reverse</code>, so <code>rev = reverse . map reverse</code>.</p>\n\n<p>Here we first reverse the inner lists and then the outter list, but the order doesn't matter and we can do it the other way around: <code>rev = map reverse . reverse</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1471826943, "creation_date": 1471826943, "answer_id": 39070105, "question_id": 39021799, "link": "https://stackoverflow.com/questions/39021799/reversing-a-list-in-another-list-in-haskell/39070105#39070105", "title": "Reversing a list in another list in Haskell", "body": "<p>The most natural approach is certainly either <code>map reverse . reverse</code> or <code>reverse . map reverse</code>. It's probably most efficient, however, to interleave the operations explicitly:</p>\n\n<pre><code>revrev :: [[a]] -&gt; [[a]]\nrevrev = foldl (\\ acc xs -&gt; reverse xs : acc) []\n</code></pre>\n\n<p>If you want to play code golf, you can write this as</p>\n\n<pre><code>revrev=foldl(flip((:).reverse))[]\n</code></pre>\n\n<p>but don't do that.</p>\n"}], "owner": {"reputation": 28, "user_id": 6277589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c6182b527a071df46fe56db994d078?s=128&d=identicon&r=PG&f=1", "display_name": "ZCoder", "link": "https://stackoverflow.com/users/6277589/zcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 39021874, "answer_count": 2, "score": 0, "last_activity_date": 1471826943, "creation_date": 1471533203, "question_id": 39021799, "link": "https://stackoverflow.com/questions/39021799/reversing-a-list-in-another-list-in-haskell", "title": "Reversing a list in another list in Haskell", "body": "<p>I'm quite new to Haskell and I'm trying to reverse a list. At the same time I want to reverse the lists in that list. So for example:</p>\n\n<pre><code>Prelude&gt; rev [[3,4,5],[7,5,2]]\n[[2,5,7],[5,4,3]]\n</code></pre>\n\n<p>I know that the following code reverses a list:</p>\n\n<pre><code>rev :: [[a]] -&gt; [[a]]\nrev [[]] = [[]]\nrev [[x]] = [[x]]\nrev xs = last xs : reverse (init xs)\n</code></pre>\n\n<p>I have been struggling for  while, I have made some additions to the code but it still isn't working and I'm stuck.</p>\n\n<pre><code>rev :: [[a]] -&gt; [[a]]\nrev [[]] = [[]]\nrev [[x]] = [[x]]\nrev xs = last xs : reverse (init xs)\nrev [xs] = last [xs] : reverse (init [xs])\n</code></pre>\n\n<p>I'd appreciate any help. Thanks in advance.</p>\n"}, {"tags": ["haskell", "generics", "types"], "comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1471530576, "post_id": 39020787, "comment_id": 65392143, "body": "I assume this is so you can have optional arguments to a function. I would instead have it take an A and provide a default A that the caller can pass to your function after optionally modifying it using record update syntax."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471530916, "post_id": 39020787, "comment_id": 65392396, "body": "The B data type is used as isomorphism to yaml config file, where some options could be missing. But program should work with easy and safe A type. B shouldn&#39;t be used for anything except converting it to A."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471531762, "post_id": 39020787, "comment_id": 65393034, "body": "You could use <a href=\"https://hackage.haskell.org/package/yaml-0.8.18.1/docs/Data-Yaml.html#v:.-33--61-\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/yaml-0.8.18.1/docs/&hellip;</a> or <a href=\"https://hackage.haskell.org/package/yaml-config-0.4.0/docs/Data-Yaml-Config.html#v:lookupDefault\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/yaml-config-0.4.0/docs/&hellip;</a> or <a href=\"https://hackage.haskell.org/package/config-value-0.5/docs/Config-Lens.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/config-value-0.5/docs/&hellip;</a> instead? ._."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471533186, "post_id": 39020787, "comment_id": 65393991, "body": "The first thing is compile-time, so I couldn&#39;t use different default configs for example. The second thing produces a lot of code on every use of config. And lenses are complicated and it will take a lot of time to understand them and there are advices not to use them from many haskell developers."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1471533929, "post_id": 39020787, "comment_id": 65394552, "body": "Also Yaml.Config is read-only."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471534869, "post_id": 39020787, "comment_id": 65395196, "body": "I guess this is the same as asking if there is a type-level <code>fmap</code> function, that maps a type constructor over a (product) type? Something like <code>data B = TypeFMap Maybe A</code>."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1471537406, "post_id": 39020787, "comment_id": 65396762, "body": "@chepner, not exactly. This could be achieved by Template Haskell in compile-time. What I need is a real-time functions to convert value from one type to another. I can do it by hand, but I don&#39;t want to duplicate same field declarations four times. I need <code>f x = B {c = Just $ a x, d = Just $ b x}</code> and same <code>g</code> but generated automatically using generics."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1471542610, "creation_date": 1471542610, "answer_id": 39024578, "question_id": 39020787, "link": "https://stackoverflow.com/questions/39020787/is-there-a-way-to-apply-maybe-constructor-to-each-field-of-record-with-generics/39024578#39024578", "title": "Is there a way to apply Maybe constructor to each field of record with generics?", "body": "<p>How about:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\ndata R f = R { a :: f Int, b :: f String, c :: f Char }\n\nnewtype I a = I { unI :: a }\n\nfromMaybeI :: I a -&gt; Maybe a -&gt; I a\nfromMaybeI a Nothing = a\nfromMaybeI _ (Just a) = I a\n\nfromMaybeR :: R I -&gt; R Maybe -&gt; R I\nfromMaybeR ri rm =\n  R (go a) (go b) (go c)\n  where\n    go :: (forall f. R f -&gt; f a)  -&gt; I a\n    go x = fromMaybeI (x ri) (x rm)\n</code></pre>\n\n<p><code>R Maybe</code> is the record with Maybe values, <code>R I</code> is the record with concrete values.</p>\n\n<p>Using RankNTypes reduces the amount of boilerplate code in <code>fromMaybeR</code>.</p>\n\n<p>One downside is that you have use <code>I</code> and <code>unI</code> to construct and\naccess the field values.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 6, "last_activity_date": 1471556199, "last_edit_date": 1495535552, "creation_date": 1471555531, "answer_id": 39027753, "question_id": 39020787, "link": "https://stackoverflow.com/questions/39020787/is-there-a-way-to-apply-maybe-constructor-to-each-field-of-record-with-generics/39027753#39027753", "title": "Is there a way to apply Maybe constructor to each field of record with generics?", "body": "<p>This can be done with <a href=\"http://hackage.haskell.org/package/generics-sop-0.2.2.0\" rel=\"nofollow noreferrer\">generics-sop</a>, a library that extends the default Generics machinery of GHC.</p>\n\n<p>\"generics-sop\" can take a regular record and deduce a generic representation for it. This representation has a type parameter that wraps every field, and the library allows Applicative <a href=\"http://hackage.haskell.org/package/generics-sop-0.2.2.0/docs/Generics-SOP.html#v:hsequence\" rel=\"nofollow noreferrer\">sequence-like</a> operations across the record fields.</p>\n\n<pre><code>{-# language TypeOperators #-}\n{-# language DeriveGeneric #-}\n{-# language TypeFamilies #-}\n{-# language DataKinds #-}\n\nimport qualified GHC.Generics as GHC\nimport Generics.SOP\n\ndata A = A {a :: Int, b :: String} deriving (Show,GHC.Generic)\n\ninstance Generic A -- this Generic is from generics-sop\n\ndefaulty :: (Generic a, Code a ~ '[ xs ]) =&gt; NP Maybe xs -&gt; a -&gt; a \ndefaulty maybes r = case (from r) of\n    SOP (Z np) -&gt; let result = hliftA2 (\\m i -&gt; maybe i I m) maybes np\n                  in  to (SOP (Z result))\n\nmain :: IO ()\nmain = do\n   print $ defaulty (Nothing :* Just \"bar\" :* Nil) (A 99 \"foo\") \n</code></pre>\n\n<p><code>Nothing :* Just \"bar\" :* Nil</code> is a generic representation that matches the list of fields in the original record definition. Notice that each field in the representation is wrapped in <code>Maybe</code>.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/38248692/whats-a-better-way-of-managing-large-haskell-records/38251692#38251692\">here</a> for another example of generics-sop.</p>\n"}], "owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 39027753, "answer_count": 2, "score": 4, "last_activity_date": 1471556199, "creation_date": 1471530396, "question_id": 39020787, "link": "https://stackoverflow.com/questions/39020787/is-there-a-way-to-apply-maybe-constructor-to-each-field-of-record-with-generics", "title": "Is there a way to apply Maybe constructor to each field of record with generics?", "body": "<p>I have two data types and the second one is the copy of first, but with Maybe on each field.</p>\n\n<pre><code>data A = {a :: Int, b :: String}\ndata B = {c :: Maybe Int, d :: Maybe String}\n</code></pre>\n\n<p>Is there a way to make a functions</p>\n\n<pre><code>f :: A -&gt; B\ng :: B -&gt; A -&gt; A\n</code></pre>\n\n<p>without any knowledge about fields itself? (if value of first argument is nothing <code>g</code> will take default value from second argument)</p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "io-monad", "lifting"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 14, "creation_date": 1471522720, "post_id": 39017900, "comment_id": 65386386, "body": "That&#39;s not really compatible. In <code>String -&gt; IO String</code>, the IO computation can depend on the argument, in <code>IO (String -&gt; String)</code> it cannot."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1471526049, "post_id": 39017900, "comment_id": 65388745, "body": "@Bergi stated it perfectly. This is the key difference between Applicative and Monad."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1471537876, "post_id": 39020559, "comment_id": 65397050, "body": "If there is a predetermined set of strings, it probably makes sense to make a small custom type with one value per string in the set. Then the universe package can give you <a href=\"http://hackage.haskell.org/package/universe-1.0/docs/Data-Universe-Instances-Reverse.html#t:Traversable\" rel=\"nofollow noreferrer\"><code>sequenceA :: (Foo -&gt; IO String) -&gt; IO (Foo -&gt; String)</code></a>, which has the behavior you describe of creating a <code>Map</code> and indexing into it."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1471529788, "last_edit_date": 1495542175, "creation_date": 1471529788, "answer_id": 39020559, "question_id": 39017900, "link": "https://stackoverflow.com/questions/39017900/transformation-of-a-io-b-to-io-a-b/39020559#39020559", "title": "Transformation of (a -&gt; IO b) to IO (a -&gt; b)", "body": "<p>Indeed this is not possible. Consider the function:</p>\n\n<pre><code>import Acme.Missiles\n\nboo :: String -&gt; IO String\nboo \"cute\" = return \"Who's a nice kitty?\"\nboo \"evil\" = launchMissiles &gt;&gt; return \"HTML tags lea\u0360ki\u0327n\u0358g fr\u0336o\u0328m \u0321yo\u200b\u035fur eye\u0362s\u0338 \u031bl\u0315ik\u034fe liq\u200buid pain\"\n</code></pre>\n\n<p>Now, if it were possible to transform this to <code>IO (String -&gt; String)</code>, it would have to execute <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags\">all possible <code>IO</code> actions for any input</a> before returning the pure <code>String -&gt; String</code> function. IOW, even if you only planned to use the function for kitten-watching purposes, it would entail nuclear holocaust.</p>\n\n<p>Nevertheless, it may well be possible to do this <em>for your specific application</em>. In particular, if you know the function will only ever be called for a predetermined set of strings, you can pre-query them from <code>IO</code> and store the results in a map, which can then be indexed purely.</p>\n\n<pre><code>import qualified Data.Map as Map\n\npuh :: IO (String -&gt; String)\npuh = fmap ((Map.!) . Map.fromList) . forM [\"cute\"] $ \\q -&gt; do\n       res &lt;- boo q\n       return (q, res)\n</code></pre>\n\n<p>Of course, this may not be feasible performance-wise.</p>\n"}], "owner": {"reputation": 3874, "user_id": 3699131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mCbVB.jpg?s=128&g=1", "display_name": "F. B&#246;ller", "link": "https://stackoverflow.com/users/3699131/f-b%c3%b6ller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 39020559, "answer_count": 1, "score": 4, "last_activity_date": 1471529788, "creation_date": 1471522293, "question_id": 39017900, "link": "https://stackoverflow.com/questions/39017900/transformation-of-a-io-b-to-io-a-b", "title": "Transformation of (a -&gt; IO b) to IO (a -&gt; b)", "body": "<p>I have several data types in an IO context like:</p>\n\n<pre><code>a :: IO String\nb :: IO FilePath\nc :: String -&gt; IO String\n</code></pre>\n\n<p>I want to put them all together in one data object like:</p>\n\n<pre><code>data Configdata = Configdata String FilePath (String -&gt; String)\n</code></pre>\n\n<p>So I don't have to get each value for its own out of the IO context, but just out of <code>IO Configdata</code>.</p>\n\n<p>The critical point where I don't have a solution is how I can transform <code>String -&gt; IO String</code> to <code>IO (String -&gt; String)</code>.\nHoogle doesn't give me any functions which are capable of doing this.</p>\n\n<p>I am not sure if it's maybe even not possible, since the input of the function is possibly infinite.</p>\n\n<p>Does someone have a solution or an explanation why it's not possible?\nI know that using a list instead of a function is an option, but I would prefer using a function if possible.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1471542782, "post_id": 39017480, "comment_id": 65399957, "body": "Might as well even reuse a single <code>MVar</code>. <code>do { v &lt;- newEmptyMVar; forkIO (foo &gt;&gt; putMVar v ()); forkIO (bar &gt;&gt; putMVar v ()); takeMVar v; takeMVar v }</code>"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1471594166, "post_id": 39017480, "comment_id": 65417993, "body": "You could also do that, yes. It maybe slightly increases the changes of writing the wrong number of <code>takeMVar</code> calls, or making it less obvious why there&#39;s that number of them, but for just <i>two</i> threads it&#39;s probably fine."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 5, "last_activity_date": 1471521033, "creation_date": 1471521033, "answer_id": 39017480, "question_id": 39017422, "link": "https://stackoverflow.com/questions/39017422/how-to-stop-main-from-terminating/39017480#39017480", "title": "How to stop main from terminating", "body": "<p>One thing you could do is to use an <code>MVar ()</code> as a simple semaphore. Something like</p>\n\n<pre><code>main = do\n  vFoo &lt;- newEmptyMVar\n  vBar &lt;- newEmptyMVar\n  forkIO (foo vFoo)\n  forkIO (bar vBar)\n  takeMVar vFoo\n  takeMVar vBar\n\nfoo vFoo = do\n  ...whatever...\n  putMVar vFoo ()\n\nbar vBar = do\n  ...whatever...\n  putMVar vBar ()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13987, "user_id": 1870, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/p3ITH.jpg?s=128&g=1", "display_name": "Mo.", "link": "https://stackoverflow.com/users/1870/mo"}, "is_accepted": false, "score": 1, "last_activity_date": 1471521196, "creation_date": 1471521196, "answer_id": 39017543, "question_id": 39017422, "link": "https://stackoverflow.com/questions/39017422/how-to-stop-main-from-terminating/39017543#39017543", "title": "How to stop main from terminating", "body": "<p>You could call <code>getChar</code> so your main thread waits for input. This would also give you a convenient way to really exit the program. Or if you don't want that, just recur on the <code>getChar</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": true, "score": 10, "last_activity_date": 1471523887, "creation_date": 1471523887, "answer_id": 39018466, "question_id": 39017422, "link": "https://stackoverflow.com/questions/39017422/how-to-stop-main-from-terminating/39018466#39018466", "title": "How to stop main from terminating", "body": "<p>The <code>async</code> package nicely wraps this up as <code>concurrently foo bar</code>.</p>\n\n<p>Here's a self-contained <code>stack</code> shebang script.</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n    --resolver lts-6.12\n    --install-ghc\n    runghc\n    --package async\n-}\n\nimport Control.Concurrent\nimport Control.Concurrent.Async\n\nforever :: String -&gt; Int -&gt; IO ()\nforever msg delay = loop\n  where\n    loop = do\n      putStrLn msg\n      threadDelay (delay * 1000)\n      loop\n\nfoo = forever \"foo\" 3000\nbar = forever \"bar\" 5000\n\nmain = foo `concurrently` bar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": false, "score": 1, "last_activity_date": 1471719447, "creation_date": 1471719447, "answer_id": 39057690, "question_id": 39017422, "link": "https://stackoverflow.com/questions/39017422/how-to-stop-main-from-terminating/39057690#39057690", "title": "How to stop main from terminating", "body": "<p>Depending on what behavior you want in the case that one of the two threads fails, this could be a good case for the <a href=\"https://hackage.haskell.org/package/async\" rel=\"nofollow\">async</a> package.</p>\n\n<p>Functions like <code>race</code> and <code>concurrently</code> might be particularly relevant to what you're doing.</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 2, "accepted_answer_id": 39018466, "answer_count": 4, "score": 3, "last_activity_date": 1471719447, "creation_date": 1471520832, "question_id": 39017422, "link": "https://stackoverflow.com/questions/39017422/how-to-stop-main-from-terminating", "title": "How to stop main from terminating", "body": "<p>I have this code:</p>\n\n<pre><code>main = do\n    _ &lt;- forkIO foo\n    _ &lt;- forkIO bar\n    return ()\n</code></pre>\n\n<p>Functions <code>foo</code> and <code>bar</code> start, but terminate as soon as <code>main</code> terminates. How can I keep <code>main</code> running indefinitely, but not doing much?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1471543726, "post_id": 39016615, "comment_id": 65400459, "body": "&quot;Is it a compilation flag or something ?&quot; - probably. This seems like a <code>stack</code> issue, which settings is it passing to ghc?"}], "answers": [{"tags": [], "owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1471986533, "last_edit_date": 1495541311, "creation_date": 1471986533, "answer_id": 39110702, "question_id": 39016615, "link": "https://stackoverflow.com/questions/39016615/recordwildcards-crashes-at-runtime-in-yesod-app/39110702#39110702", "title": "Recordwildcards crashes at runtime in yesod app", "body": "<p>According to changelog in GHC, \"that not a bug, it's a feature\": <a href=\"https://ghc.haskell.org/trac/ghc/ticket/5334\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/5334</a></p>\n\n<p>You can change this behavior by changing type of your fields to strict (prepend a <code>!</code> to type name - like <code>!Int</code>) - however, then you lose laziness (more about effects of strict types: <a href=\"https://stackoverflow.com/questions/8576795/advantages-of-strict-fields-in-data-types\">Advantages of strict fields in data types</a>)</p>\n\n<p>Of course, you can also make it an error by slamming in <code>-Werror</code> compilation option, but then you need to be very strict about your code (no unused imports, no unused variables, even when unpacking a record etc.), or get rid of <code>-Wall</code> and turn on only warnings you perceive as important.</p>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 39110702, "answer_count": 1, "score": 1, "last_activity_date": 1472065717, "creation_date": 1471518424, "last_edit_date": 1472065717, "question_id": 39016615, "link": "https://stackoverflow.com/questions/39016615/recordwildcards-crashes-at-runtime-in-yesod-app", "title": "Recordwildcards crashes at runtime in yesod app", "body": "<p>I ran into the following error which is quite surprising. I added a field to the <code>AppSettings</code> in a Yesod app (using the Yesod scaffholding) and to my surprise, everything compiled even though I didn't do anything else (I was expecting to have to add somewhere a default value to the construction of <code>AppSettings</code>, but not). I got a runtime error instead telling me that a field was missing. \nIt appears that the only construction to <code>AppSetting</code> uses the <code>RecordWildCards</code> extension and looks like <code>AppSettings{..}</code>. Not defining the new field didn't generate an error but a warning (I didn't see it, because I was running test in continuous mode using <code>stack test --file-watch</code>). How is that possible ?\nI try to reproduce the problem in a simple file and I get an error not a warning. So why do I get a warning for Yesod ? Is it a compilation flag or something ?</p>\n\n<h1>Edit</h1>\n\n<p>This is not specific to Yesod. I've made the test again with a simple file and it generates a warning not an error.</p>\n"}, {"tags": ["list", "haskell", "list-comprehension", "lazy-evaluation"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1471518447, "post_id": 39016542, "comment_id": 65383536, "body": "This is a good explanation on how to desugar the list comprehension syntax: <a href=\"http://stackoverflow.com/a/8029698/1013393\">stackoverflow.com/a/8029698/1013393</a>"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 6, "last_activity_date": 1471518800, "creation_date": 1471518800, "answer_id": 39016736, "question_id": 39016542, "link": "https://stackoverflow.com/questions/39016542/how-does-haskell-create-a-new-list-from-another-list/39016736#39016736", "title": "How does haskell create a new list from another list?", "body": "<p>Because it \"inserts\" them at list's tail <em>(while the list is being built),</em> not head (cf. \"tail recursion modulo cons\"):</p>\n\n<pre><code>[a | a &lt;- [1..10]]     ==\n[a | a &lt;- (1:[2..10])] ==      -- [a | a &lt;- ([1] ++ [2..10])]\n1 : [a | a &lt;- [2..10]]         -- [1] ++ [a | a &lt;- [2..10]]\n</code></pre>\n\n<p>This is because</p>\n\n<pre><code>[a | a &lt;- (xs ++ ys)]  ==  [a | a &lt;- xs] ++ [a | a &lt;- ys]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[a | a &lt;- ys]  ==  ys\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "is_accepted": false, "score": 6, "last_activity_date": 1471518829, "creation_date": 1471518829, "answer_id": 39016750, "question_id": 39016542, "link": "https://stackoverflow.com/questions/39016542/how-does-haskell-create-a-new-list-from-another-list/39016750#39016750", "title": "How does haskell create a new list from another list?", "body": "<p>The way you are thinking about list comprehensions is not quite correct. When you see a comprehension</p>\n\n<pre><code>y &lt;- [f a | a &lt;- x]\n</code></pre>\n\n<p>you shouldn't think about the successive result being added to the front of an (initially empty) result list.</p>\n\n<p>Instead, think of each <code>f a</code> being added to the front of the result of running the list comprehension on the rest of <code>x</code>. That is,</p>\n\n<pre><code>[f a | a &lt;- x:xs] == f x : [f a | a &lt;- xs]\n</code></pre>\n\n<p>This is a recursive approach - by assuming that the result list exists for the tail of the list, you can add the next result to the front of it.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1471541627, "last_edit_date": 1471541627, "creation_date": 1471528813, "answer_id": 39020209, "question_id": 39016542, "link": "https://stackoverflow.com/questions/39016542/how-does-haskell-create-a-new-list-from-another-list/39020209#39020209", "title": "How does haskell create a new list from another list?", "body": "<p>It's instructive to look at exactly how list comprehensions desugar to monadic computations, rather than use the intuition for how they work.</p>\n\n<pre><code>[a | a &lt;- [1..3]] == do {a &lt;- [1..3]; return a}   -- desugared comprehension\n                  == [1..3] &gt;&gt;= return a          -- desugared do\n                  == concat (map return [1..3])   -- definition of &gt;&gt;=\n                  == concat [[1], [2], [3]]       -- defintiion of return\n                  == [1,2,3]                      -- definition of concat\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 4783340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fca6f1178b84e8293ff05526491c36d0?s=128&d=identicon&r=PG&f=1", "display_name": "Arpan Biswas", "link": "https://stackoverflow.com/users/4783340/arpan-biswas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2085, "favorite_count": 1, "accepted_answer_id": 39016736, "answer_count": 3, "score": 3, "last_activity_date": 1471541627, "creation_date": 1471518132, "last_edit_date": 1471519271, "question_id": 39016542, "link": "https://stackoverflow.com/questions/39016542/how-does-haskell-create-a-new-list-from-another-list", "title": "How does haskell create a new list from another list?", "body": "<p>Suppose we have a list</p>\n\n<pre><code>x = [1..10]\n</code></pre>\n\n<p>and we intend to create another list y using this in this manner :</p>\n\n<pre><code>y= [a|a&lt;-x]\n</code></pre>\n\n<p>So while creating the list <code>y</code> from <code>x</code>, it accesses each element of <code>x</code>( from 1 to 10) and inserts it in <code>y</code> in the same order. As a list in haskell is singly linked list, we can insert a new element only at its head. So first it inserts 1 to <code>[]</code> &amp; we have <code>[1]</code>. Then it inserts 2 to its head &amp; so we have <code>[2,1]</code>. Then it inserts 3 &amp; we have <code>[3,2,1]</code> &amp; so on. So ultimately we should get <code>y</code> as <code>[10,9..1]</code>. But instead we get <code>y</code> as <code>[1..10]</code>. Why is that so?</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 2, "last_activity_date": 1471516554, "creation_date": 1471516554, "answer_id": 39016000, "question_id": 39013381, "link": "https://stackoverflow.com/questions/39013381/cabal-not-finding-sources/39016000#39016000", "title": "Cabal not finding sources", "body": "<p>I'm a little bit confused about the precise sequence of renames you've done, but anyway... Looking at your first attempt, I see a file that says</p>\n\n<pre><code>module Data.SemVer.Range.Types where\n</code></pre>\n\n<p>However, the filename is is <code>src/Data/SemVer/Types.hs</code>, which doesn't match. And that would be why it doesn't work; file path doesn't match module path.</p>\n\n<p>If you had created a folder named <code>Range</code> and moved the files in there, that should work.</p>\n"}], "owner": {"reputation": 271, "user_id": 3424658, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ade88c8691b78a46653a89f8d0ef233?s=128&d=identicon&r=PG", "display_name": "ThomasC__", "link": "https://stackoverflow.com/users/3424658/thomasc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 1, "accepted_answer_id": 39016000, "answer_count": 1, "score": 1, "last_activity_date": 1471516554, "creation_date": 1471509066, "question_id": 39013381, "link": "https://stackoverflow.com/questions/39013381/cabal-not-finding-sources", "title": "Cabal not finding sources", "body": "<p>While playing with <a href=\"https://hackage.haskell.org/package/semver\" rel=\"nofollow\">semver</a> and <a href=\"https://hackage.haskell.org/package/semver-range\" rel=\"nofollow\">semver-range</a> I was stuck because of conflicting modules name.</p>\n\n<p>As a temporary fix, I forked the semver-range repo to rename modules (the first attempt is available <a href=\"https://github.com/ThomasCrvsr/semver-range/tree/weird-cabal-stuff\" rel=\"nofollow\">here</a>). I renamed each modules <code>Data.SemVer*</code> by <code>Data.SemVer.Range*</code>.</p>\n\n<p>I didn't change the folder structure, just the cabal file :</p>\n\n<pre><code>Exposed-modules:     Data.SemVer.Range\nother-modules:       Data.SemVer.Range.Parser\n                   , Data.SemVer.Range.Types\n</code></pre>\n\n<p>Trying to build the project I have the following error message :</p>\n\n<pre><code>Building semver-range-0.2.0...\nPreprocessing library semver-range-0.2.0...\ncabal: can't find source for Data/SemVer/Range in src, dist/build/autogen\n</code></pre>\n\n<p>I made a second attempt (available <a href=\"https://github.com/ThomasCrvsr/semver-range/tree/master\" rel=\"nofollow\">here</a>). I renamed every module <code>Data.SemVer*</code> with <code>Data.SemVerRange*</code></p>\n\n<p>I also changed the cabal file and renamed <code>src/Data/SemVer.hs</code> to <code>src/Data/SemVerRange.hs</code>.</p>\n\n<p>This second attempt worked fine but I'm curious what did I do wrong in the first try.</p>\n\n<p>Did I miss something obvious ?</p>\n"}, {"tags": ["haskell", "recursion", "typeclass"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1471508306, "post_id": 39013007, "comment_id": 65377242, "body": "The <code>n</code> in <code>(undefined :: n)</code> isn&#39;t the same <code>n</code> as in <code>(Nat n) =&gt; Nat (Succ n)</code>. However, if you turn on <code>-XScopedTypeVariables</code> (or add <code>{-# LANGUAGE ScopedTypeVariables #-}</code> to the top of your file), they will be the same and everything compiles just fine."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1471508499, "post_id": 39013007, "comment_id": 65377353, "body": "of course, thank you for the explanation ! would you mind putting this as an answer ?"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1471509483, "creation_date": 1471509483, "answer_id": 39013522, "question_id": 39013007, "link": "https://stackoverflow.com/questions/39013007/recursive-instances-in-haskell/39013522#39013522", "title": "recursive instances in haskell", "body": "<p>The problem pertains to the scope of the variable <code>n</code>. In particular, the <code>n</code> in <code>(undefined :: n)</code> isn't the same <code>n</code> as in <code>(Nat n) =&gt; Nat (Succ n)</code>. If you would like to change this, you can enable  <a href=\"https://wiki.haskell.org/Scoped_type_variables\"><code>-XScopedTypeVariables</code></a> (or add <code>{-# LANGUAGE ScopedTypeVariables #-}</code> to the top of your file), and then the two <code>n</code>s will be the same and everything compiles.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 1, "accepted_answer_id": 39013522, "answer_count": 1, "score": 2, "last_activity_date": 1471509483, "creation_date": 1471507846, "question_id": 39013007, "link": "https://stackoverflow.com/questions/39013007/recursive-instances-in-haskell", "title": "recursive instances in haskell", "body": "<p>When using the following code, I get the error message below for the recursive usage of <code>toInt</code> </p>\n\n<pre><code>module Intro0 where\ndata Zero\ndata Succ n\n\nclass Nat n where\n  toInt :: n -&gt; Int\ninstance Nat Zero where\n  toInt _ = 0\ninstance (Nat n) =&gt; Nat (Succ n) where\n  toInt _ = (1::Int) + toInt (undefined :: n)\n</code></pre>\n\n<p>I would have imagined finding toInt is trivial as it is specified in the context of the recursive instance, but I get a unification problem</p>\n\n<pre><code>Could not deduce (Nat n0) arising from a use of \u2018toInt\u2019\n    from the context (Nat n)\n      bound by the instance declaration\n      at EPhantomTypes.hs:10:10-32\n    The type variable \u2018n0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Nat n =&gt; Nat (Succ n)\n        -- Defined at EPhantomTypes.hs:10:10\n      instance Nat Zero\n        -- Defined at EPhantomTypes.hs:8:10\n    In the second argument of \u2018(+)\u2019, namely \u2018toInt (undefined :: n)\u2019\n    In the expression: (1 :: Int) + toInt (undefined :: n)\n    In an equation for \u2018toInt\u2019:\n        toInt _ = (1 :: Int) + toInt (undefined :: n)\n</code></pre>\n\n<p>I am not sure why this is. It looks trivial but I am not sure what to do with this.</p>\n\n<p>Obviously <code>n</code> and <code>n0</code> should be the same but even using </p>\n\n<pre><code>instance forall n . (Nat n) =&gt; Nat (Succ n) where\n</code></pre>\n\n<p>leads to the same error message</p>\n"}, {"tags": ["haskell", "pattern-matching", "rational-number", "rational-numbers"], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "edited": false, "score": 0, "creation_date": 1471506891, "post_id": 39012521, "comment_id": 65376463, "body": "This is neat as heck, and I&#39;ll probably accept it.  But it doesn&#39;t quite answer the question of why I can&#39;t pattern-match on (%).  I&#39;m not particularly familiar with the internals of pattern-matching, so it may be that there&#39;s a simple answer I&#39;m not seeing."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "edited": false, "score": 0, "creation_date": 1471507186, "post_id": 39012521, "comment_id": 65376639, "body": "Right, I added that to the top."}, {"owner": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "edited": false, "score": 0, "creation_date": 1471507914, "post_id": 39012521, "comment_id": 65377025, "body": "Oh, I see.  I guess I didn&#39;t realize that <code>(%)</code> wasn&#39;t actually a constructor, but you can just look at its <code>:info</code> and it&#39;s clearly not one.    The finite-decimal-fractions approach is a clever use of the default <code>Fractional a</code> type for decimals, which I&#39;d forgotten about.  I&#39;m not sure I quite understand the smart pattern synonym answer - I use dinosaur Haskell - but it looks like I&#39;ve got some reading to do.  Thanks a bunch for the amazing answer!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1471506904, "last_edit_date": 1471506904, "creation_date": 1471506216, "answer_id": 39012521, "question_id": 39012408, "link": "https://stackoverflow.com/questions/39012408/pattern-matching-on-rationals-in-haskell/39012521#39012521", "title": "Pattern-matching on Rationals in Haskell", "body": "<p>You can in general not pattern match on functions. That would require computing the inverse, which usually doesn't even exist. You can only match on <em>constructors</em> like <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:Just\" rel=\"noreferrer\"><code>Just</code></a> or <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#v:-58--43-\" rel=\"noreferrer\"><code>:+</code></a>: these are recognisable from ordinary functions / infix operators by starting with an uppercase character or a colon.</p>\n\n<p>You <em>can</em> pattern match on rationals.</p>\n\n<pre><code>import GHC.Real (:%)\n\ntest2 :: Rational -&gt; Int\ntest2 = case x of\n    0 -&gt; 0\n    1 :% 2 -&gt; 1\n    _ -&gt; 2\n</code></pre>\n\n<p>The reason, I suppose, why it's not really recommended to use <code>:%</code> (and it's hence only exported from an internal module, not from <code>Data.Ratio</code>) is that <code>Ratio</code> values are always supposed to be minimal, but <code>:%</code> as a plain constructor doesn't ensure this:</p>\n\n<pre><code>Prelude Data.Ratio GHC.Real&gt; 4%2\n2 % 1\nPrelude Data.Ratio GHC.Real&gt; 4:%2\n4 % 2\n</code></pre>\n\n<p>In particular, if you'd then actually pattern-match on such an unnormalised fraction, you couldn't be sure to succeed.</p>\n\n<p>In cases like <code>1%2</code>, you can circumvent the problem by pattern matching on a decimal fraction (finite decimal fractions are unique):</p>\n\n<pre><code>test2 :: Rational -&gt; Int\ntest2 = case x of\n    0   -&gt; 0\n    0.5 -&gt; 1\n    _   -&gt; 2\n</code></pre>\n\n<p>Of course, this is perhaps not that nice. In modern Haskell, one could theoretically re-define <code>:%</code> as a smart pattern synonym:</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms, ViewPatterns #-}\nimport Data.Ratio\n\nnumDenum :: Integral a =&gt; Ratio a -&gt; (a,a)\nnumDenum x = (numerator x, denominator x)\n\npattern (:%) :: () =&gt; Integral a =&gt; a -&gt; a -&gt; Ratio a\npattern a:%b &lt;- (numDenum -&gt; (a,b))\n where a:%b = a%b\n</code></pre>\n\n<p>which could then be used as in your original example.</p>\n\n<p>... but frankly, it's probably better to just use <code>numerator</code> and <code>denominator</code>as they are.</p>\n"}, {"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1471580843, "creation_date": 1471580843, "answer_id": 39031126, "question_id": 39012408, "link": "https://stackoverflow.com/questions/39012408/pattern-matching-on-rationals-in-haskell/39031126#39031126", "title": "Pattern-matching on Rationals in Haskell", "body": "<p>You can also use guards to do a very similar thing.  You can use arbitrary Bool expressions, so you have the <code>(%)</code> and every other pure function available.</p>\n\n<pre><code>test3 :: Rational -&gt; Int\ntest3 x | x == 0 = 0\n        | x == 1 % 2 = 1\n        | otherwise = 2\n</code></pre>\n\n<p>They work in a case statement too.</p>\n\n<pre><code>test3a :: Rational -&gt; Int\ntest3a y = case y of\n    x | x == 0 -&gt; 0\n      | x == 1 % 2 -&gt; 1\n      | otherwise -&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 1, "accepted_answer_id": 39012521, "answer_count": 2, "score": 3, "last_activity_date": 1471580843, "creation_date": 1471505790, "question_id": 39012408, "link": "https://stackoverflow.com/questions/39012408/pattern-matching-on-rationals-in-haskell", "title": "Pattern-matching on Rationals in Haskell", "body": "<p>The following function is pretty straightforward:</p>\n\n<pre><code>test :: Int -&gt; Int\ntest x = case x of\n    0 -&gt; 0\n    1 -&gt; 1\n    _ -&gt; 2\n</code></pre>\n\n<p>and indeed, <code>test 0 == 0</code>, <code>test 1 == 1</code>, and <code>test 77 == 2</code>.</p>\n\n<p>The following function is <em>almost</em> as straightforward:</p>\n\n<pre><code>import Data.Ratio\n\ntest2 :: Rational -&gt; Int\ntest2 = case x of\n    0 -&gt; 0\n    1 % 2 -&gt; 1\n    _ -&gt; 2\n</code></pre>\n\n<p>Loading this code in GHCi gives an error <code>Parse error in pattern: 1 % 2</code>.</p>\n\n<p>What gives?  Why can't I pattern-match on rational numbers?  I can solve the real-world problem this example came from with guards, but I'm curious why pattern-matching doesn't work.</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1471503058, "post_id": 39011106, "comment_id": 65374459, "body": "Could you give us the output of <code>stack exec &quot;echo $path&quot; </code>?"}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1471508855, "post_id": 39011106, "comment_id": 65377538, "body": "That command doesn&#39;t quite work but let me try something"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1471516375, "post_id": 39011106, "comment_id": 65382292, "body": "I think this incorrect - you are starting a bash and therefore you load stuff from the global and local bash config. but I checked - there is a <code>stack path</code> command that should list the interesting stuff."}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1471521931, "post_id": 39011106, "comment_id": 65385831, "body": "Well it wasn&#39;t clear what you mean by <code>stack exec &quot;echo $path&quot;</code> :). I&#39;ll add the output from <code>stack path</code> too."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1471526578, "post_id": 39011106, "comment_id": 65389117, "body": "hmm - <code>&#47;usr&#47;bin&#47;</code> is in your path - can you try <code>stack exec -- happy -v</code> - I am usually using the system ghc, but I don&#39;t know whether this is related to the problem"}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1471569457, "post_id": 39011106, "comment_id": 65409954, "body": "Okay, I&#39;ve updated with <code>happy -V</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1471569542, "post_id": 39019781, "comment_id": 65409969, "body": "Installing <code>happy</code> via <code>stack</code> didn&#39;t resolve my problem. It installed the same version of <code>happy</code> into ~/.local/bin."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1471570465, "post_id": 39019781, "comment_id": 65410141, "body": "Try method #2. On my system I have happy installed in ~/.stack/snapshots/$ARCH/$RESOLVER/bin  for various values of $RESOLVER (e.g. lts-4.2, lts-6.0, ...) What version of stack are you running?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1471570534, "post_id": 39019781, "comment_id": 65410155, "body": "Also just try copying a happy binary into ~/.stack/snapshots/.../lts-4.2/bin"}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1471570840, "post_id": 39019781, "comment_id": 65410218, "body": "Yep, trying method #2 now. In the meantime, I have found a solution of adding <code>build-tools: alex, happy</code> to the .cabal file for the executable that needs it but I&#39;m looking for a better solution."}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1471585114, "post_id": 39019781, "comment_id": 65413458, "body": "Argh! Now I cannot even reproduce the problem. Thanks for your help though!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1471527669, "creation_date": 1471527669, "answer_id": 39019781, "question_id": 39011106, "link": "https://stackoverflow.com/questions/39011106/stack-cabal-cannot-find-happy/39019781#39019781", "title": "Stack/Cabal cannot find happy", "body": "<p>Two things to try:</p>\n\n<ol>\n<li><p>Install happy via stack using the resolver for the project:</p>\n\n<pre><code>stack install happy --resolver lts-4.2\n</code></pre></li>\n</ol>\n\n<p>When I built parconc-examples with resolver lts-4.2 I found that it\nwas using the happy binary in the lts-4.2 snapshot directory even though\nI had it installed elsewhere in my PATH.</p>\n\n<ol start=\"2\">\n<li><p>Use this Setup.hs program:</p>\n\n<pre><code>import Distribution.Simple\nimport System.Environment\n\nmain = do\n  args &lt;- getArgs\n  let args' = if elem \"configure\" args\n                then args ++ [ \"--with-happy=/usr/bin/happy\" ]\n                else args\n  defaultMainWithArgs args'\n</code></pre></li>\n</ol>\n\n<p>And also be sure to change the <code>build-type:</code> in parconc-examples.cabal to <code>Custom</code>. Completely remove the .stack-work directory to make sure everything gets rebuilt with the new Setup program.</p>\n"}], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 1, "accepted_answer_id": 39019781, "answer_count": 1, "score": 1, "last_activity_date": 1471579942, "creation_date": 1471501038, "last_edit_date": 1471569426, "question_id": 39011106, "link": "https://stackoverflow.com/questions/39011106/stack-cabal-cannot-find-happy", "title": "Stack/Cabal cannot find happy", "body": "<p>I'm trying to build <a href=\"https://github.com/simonmar/parconc-examples\" rel=\"nofollow\">the code from PCPH</a> using Haskell Stack. However, I'm getting an error about Cabal not finding <code>happy</code>. I <em>have</em> installed <code>alex</code> and <code>happy</code> though (they're in <code>/usr/bin</code>).</p>\n\n<pre><code>setup-Simple-Cabal-1.22.5.0-ghc-7.10.3: The program 'happy' is required but it\ncould not be found\n\n--  While building package parconc-examples-0.4.3 using:\n</code></pre>\n\n<p>Here's what stack thinks my <code>PATH</code> is:</p>\n\n<pre><code>$ stack exec bash\n$ echo $PATH | tr : '\\n'\n/home/steshaw/Projects/parconc-examples/.stack-work/install/x86_64-linux/lts-4.2/7.10.3/bin\n/home/steshaw/Projects/shelly/dotfiles/.stack/snapshots/x86_64-linux/lts-4.2/7.10.3/bin\n/home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux/ghc-7.10.3/bin\n/home/steshaw/.nix-profile/bin\n/home/steshaw/.nix-profile/sbin\n/usr/local/sbin\n/usr/local/bin\n/home/steshaw/Projects/shelly/bin\n/usr/local/sbin\n/usr/local/bin\n/usr/sbin\n/usr/bin\n/sbin\n/bin\n/usr/games\n/usr/local/games\n/snap/bin\n</code></pre>\n\n<p>Here's the output from <code>stack path</code>:</p>\n\n<pre><code>stack-root: /home/steshaw/Projects/shelly/dotfiles/.stack\nproject-root: /home/steshaw/Projects/parconc-examples\nconfig-location: /home/steshaw/Projects/parconc-examples/stack.yaml\nbin-path: /home/steshaw/Projects/shelly/dotfiles/.stack/snapshots/x86_64-linux/lts-4.2/7.10.3/bin:/home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux/ghc-7.10.3/bin:/home/steshaw/.nix-profile/bin:/home/steshaw/.nix-profile/sbin:/usr/local/sbin:/usr/local/bin:/home/steshaw/Projects/shelly/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\nprograms: /home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux\ncompiler-exe: /home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux/ghc-7.10.3/bin/ghc\ncompiler-bin: /home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux/ghc-7.10.3/bin\nlocal-bin: /home/steshaw/.local/bin\nextra-include-dirs: \nextra-library-dirs: \nsnapshot-pkg-db: /home/steshaw/Projects/shelly/dotfiles/.stack/snapshots/x86_64-linux/lts-4.2/7.10.3/pkgdb\nlocal-pkg-db: /home/steshaw/Projects/parconc-examples/.stack-work/install/x86_64-linux/lts-4.2/7.10.3/pkgdb\nglobal-pkg-db: /home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux/ghc-7.10.3/lib/ghc-7.10.3/package.conf.d\nghc-package-path: /home/steshaw/Projects/parconc-examples/.stack-work/install/x86_64-linux/lts-4.2/7.10.3/pkgdb:/home/steshaw/Projects/shelly/dotfiles/.stack/snapshots/x86_64-linux/lts-4.2/7.10.3/pkgdb:/home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux/ghc-7.10.3/lib/ghc-7.10.3/package.conf.d\nsnapshot-install-root: /home/steshaw/Projects/shelly/dotfiles/.stack/snapshots/x86_64-linux/lts-4.2/7.10.3\nlocal-install-root: /home/steshaw/Projects/parconc-examples/.stack-work/install/x86_64-linux/lts-4.2/7.10.3\nsnapshot-doc-root: /home/steshaw/Projects/shelly/dotfiles/.stack/snapshots/x86_64-linux/lts-4.2/7.10.3/doc\nlocal-doc-root: /home/steshaw/Projects/parconc-examples/.stack-work/install/x86_64-linux/lts-4.2/7.10.3/doc\ndist-dir: .stack-work/dist/x86_64-linux/Cabal-1.22.5.0\nlocal-hpc-root: /home/steshaw/Projects/parconc-examples/.stack-work/install/x86_64-linux/lts-4.2/7.10.3/hpc\nlocal-bin-path: /home/steshaw/.local/bin\nghc-paths: /home/steshaw/Projects/shelly/dotfiles/.stack/programs/x86_64-linux\n</code></pre>\n\n<p>Here's the version of happy that stack finds on my path:</p>\n\n<pre><code>$ stack exec -- happy -V\nHappy Version 1.19.5 Copyright (c) 1993-1996 Andy Gill, Simon Marlow (c) 1997-2005 Simon Marlow\n\nHappy is a Yacc for Haskell, and comes with ABSOLUTELY NO WARRANTY.\nThis program is free software; you can redistribute it and/or modify\nit under the terms given in the file 'LICENSE' distributed with\nthe Happy sources.\n</code></pre>\n\n<p>I'm on Ubuntu 16.04.1 LTS (x86_64).</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 2, "creation_date": 1471483439, "post_id": 39008260, "comment_id": 65368842, "body": "Tips: take a look at <code>Data.List.findIndex</code> for a nicer way to write <code>hexChar</code>. If this is not an exercise there&#39;s also <code>Numeric.readHex</code>."}, {"owner": {"reputation": 732, "user_id": 4036668, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/uXyvB.jpg?s=128&g=1", "display_name": "Anton Savelyev", "link": "https://stackoverflow.com/users/4036668/anton-savelyev"}, "reply_to_user": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471483902, "post_id": 39008260, "comment_id": 65368957, "body": "Thanks. Yea, this isn&#39;t an exercise. Just a codeeval challenge."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1471486535, "post_id": 39008260, "comment_id": 65369629, "body": "... aren&#39;t those exercises?"}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1471482052, "post_id": 39008275, "comment_id": 65368501, "body": "To avoid the call to <code>reverse</code>, try writing it using tail recursion using an accumulator - e.g. <a href=\"http://www.siddharta.me/2006/04/recursion-part-2-tail-recursion.html\" rel=\"nofollow noreferrer\">siddharta.me/2006/04/recursion-part-2-tail-recursion.html</a>"}, {"owner": {"reputation": 732, "user_id": 4036668, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/uXyvB.jpg?s=128&g=1", "display_name": "Anton Savelyev", "link": "https://stackoverflow.com/users/4036668/anton-savelyev"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1471483599, "post_id": 39008275, "comment_id": 65368880, "body": "@ErikR got it. Thanks for the idea.      hex2dec acc [] = acc      hex2dec acc (x:xs) = hex2dec (acc * 16 + hexChar x) xs"}], "tags": [], "owner": {"reputation": 732, "user_id": 4036668, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/uXyvB.jpg?s=128&g=1", "display_name": "Anton Savelyev", "link": "https://stackoverflow.com/users/4036668/anton-savelyev"}, "is_accepted": true, "score": 2, "last_activity_date": 1471481264, "last_edit_date": 1471481264, "creation_date": 1471480859, "answer_id": 39008275, "question_id": 39008260, "link": "https://stackoverflow.com/questions/39008260/why-do-i-get-an-incorrect-result-when-trying-to-convert-from-hex-to-dec-in-haske/39008275#39008275", "title": "Why do I get an incorrect result when trying to convert from Hex to Dec in Haskell?", "body": "<p>I had to change \"hex2dec\" to \"go\".</p>\n\n<pre><code>hex2dec :: String -&gt; Integer\nhex2dec str = go (reverse str)\n      where go []     = 0\n            go (x:xs) = hexChar x + 16 * go xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1471492391, "last_edit_date": 1471492391, "creation_date": 1471491245, "answer_id": 39009563, "question_id": 39008260, "link": "https://stackoverflow.com/questions/39008260/why-do-i-get-an-incorrect-result-when-trying-to-convert-from-hex-to-dec-in-haske/39009563#39009563", "title": "Why do I get an incorrect result when trying to convert from Hex to Dec in Haskell?", "body": "<p>Notice that your functions are partial; not all <code>Char</code> values are valid hex digits. Instead, define a new type to represent them:</p>\n\n<pre><code>data Hex = H0 | H1 | H2 | H3\n         | H4 | H5 | H6 | H7\n         | H8 | H9 | HA | HB\n         | HC | HD | HE | HF deriving (Enum)\n</code></pre>\n\n<p>Deriving an <code>Enum</code> instance gives you <code>hexChar</code> (let's call it <code>hexInt</code>) for nearly for free; we switch from <code>Int</code> to <code>Integer</code> here.</p>\n\n<pre><code>hexInt :: Hex -&gt; Integer\nhexInt = fromIntegral . fromEnum\n</code></pre>\n\n<p>With this in place, you can use Horner's Rule to reduce a list of <code>Hex</code> values to an <code>Integer</code>. </p>\n\n<pre><code>hex2dec :: [Hex] -&gt; Integer\nhex2dec = foldr (\\d acc -&gt; hexInt d + 16*acc) 0\n</code></pre>\n\n<hr>\n\n<p>To generalize this from <code>[Hex]</code> to <code>String</code>, we first define a function to convert a <code>Char</code> to a <code>Maybe Hex</code></p>\n\n<pre><code>import Data.List\n\ncharToHex :: Char -&gt; Maybe Hex\ncharToHex c = fmap toEnum $ c `elemIndex` \"0123456789abcdef\"\n-- elemIndex returns a Maybe Int \"between\" Just 0 and Just 15;\n-- fmap toEnum converts that to a Maybe Hex.\n</code></pre>\n\n<p>If you wanted to be explicit, <code>charToHex</code> is of course simply</p>\n\n<pre><code>charToHex '0' = Just H0\n-- ...\ncharToHex 'f' = Just H15\ncharToHex _ = Nothing\n</code></pre>\n\n<p>Then we want a function that can handle any failures while mapping <code>charToHex</code> over a <code>String</code>.</p>\n\n<pre><code>str2dec :: String -&gt; Maybe Integer\nstr2dec = fmap hex2dec . traverse charToHex\n</code></pre>\n\n<p>where <code>traverse charToHex :: String -&gt; Maybe [Hex]</code> returns <code>Nothing</code> if any call to <code>charToHex</code> on the input string returns <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 732, "user_id": 4036668, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/uXyvB.jpg?s=128&g=1", "display_name": "Anton Savelyev", "link": "https://stackoverflow.com/users/4036668/anton-savelyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 39008275, "answer_count": 2, "score": 2, "last_activity_date": 1493764891, "creation_date": 1471480738, "last_edit_date": 1493764891, "question_id": 39008260, "link": "https://stackoverflow.com/questions/39008260/why-do-i-get-an-incorrect-result-when-trying-to-convert-from-hex-to-dec-in-haske", "title": "Why do I get an incorrect result when trying to convert from Hex to Dec in Haskell?", "body": "<p><strong>Solved</strong></p>\n\n<p>My function isn't working properly. When I do hex2dec \"100\" or \"10000\" it gives me 16 instead of the correct 256. When I do hex2dec \"101\" it gives me 17 instead of the correct 257. </p>\n\n<pre><code>hex2dec :: String -&gt; Integer\nhex2dec str = go (reverse str)\n      where go []     = 0\n            go (x:xs) = hexChar x + 16 * hex2dec xs\n\nhexChar :: Char -&gt; Integer\nhexChar c\n      | c == '0' = 0\n      | c == '1' = 1\n      | c == '2' = 2\n      | c == '3' = 3\n      | c == '4' = 4\n      | c == '5' = 5\n      | c == '6' = 6\n      | c == '7' = 7\n      | c == '8' = 8\n      | c == '9' = 9\n      | c == 'a' = 10\n      | c == 'b' = 11\n      | c == 'c' = 12\n      | c == 'd' = 13\n      | c == 'e' = 14\n      | c == 'f' = 15\n      | otherwise     = 0\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1099, "user_id": 6513157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d45981b71a14222513f57e8566e4b8b?s=128&d=identicon&r=PG&f=1", "display_name": "R B", "link": "https://stackoverflow.com/users/6513157/r-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1471492995, "creation_date": 1471492995, "answer_id": 39009803, "question_id": 39008115, "link": "https://stackoverflow.com/questions/39008115/makes-several-queries-at-the-same-in-a-server-a-get-the-first-response/39009803#39009803", "title": "Makes several queries at the same in a server a get the first response", "body": "<p>I'm not sure if there's a library function to do this, but here's a sketch of a solution using &ldquo;<a href=\"http://hackage.haskell.org/package/async\" rel=\"nofollow\">async</a>&rdquo; that assumes uninteresting answers will raise an exception.</p>\n\n<pre><code>racing :: [Async a] -&gt; IO a\nracing actions = do\n    first &lt;- waitAnyCatch actions\n    case first of\n      (action, Left  _) -&gt; racing (delete action actions)\n      (action, Right a) -&gt; mapM_ cancel (delete action actions) &gt;&gt; return a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1471550465, "post_id": 39016598, "comment_id": 65404018, "body": "What if one request completes but doesn&#39;t have &quot;Ok&quot; in the body?"}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1471571383, "post_id": 39016598, "comment_id": 65410320, "body": "If you don&#39;t get an &quot;Ok&quot;, you can <code>throwIO &quot;failed&quot;</code>."}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1471571888, "post_id": 39016598, "comment_id": 65410419, "body": "Ah, sorry, simply throwing an exception to indicate that you didn&#39;t get an &quot;Ok&quot; does not work as all threads get automatically cancelled."}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1471574663, "post_id": 39016598, "comment_id": 65411020, "body": "I got a working code example using @danidiaz&#39;s <code>conceit</code> package."}], "tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": false, "score": 2, "last_activity_date": 1471956528, "last_edit_date": 1471956528, "creation_date": 1471518358, "answer_id": 39016598, "question_id": 39008115, "link": "https://stackoverflow.com/questions/39008115/makes-several-queries-at-the-same-in-a-server-a-get-the-first-response/39016598#39016598", "title": "Makes several queries at the same in a server a get the first response", "body": "<p>Here's an example that uses <code>wreq</code> to send POST requests and async to run them in parallel and return the first one to complete (cancelling the others).</p>\n\n<p>Note, this example is executable via a <code>stack</code> shebang.</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n    --resolver lts-6.12\n    --install-ghc\n    runghc\n    --package aeson\n    --package conceit\n    --package lens\n    --package lens-aeson\n    --package wreq\n-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Concurrent.Conceit\nimport Control.Lens\nimport Data.Aeson\nimport Data.Aeson.Lens (key)\nimport Data.Maybe (maybe)\nimport Data.Foldable\nimport Network.Wreq\n\necho :: Integer -&gt; IO (Either Value String)\necho i = do\n  r &lt;- post \"http://httpbin.org/post\" (toJSON i)\n  if i &gt;= 3 &amp;&amp; i &lt;= 8 then pure $ Right \"simulate failure\"\n  else pure $ maybe (Right \"Malformed response\") Left (r ^? responseBody . key \"json\")\n\nmain = do\n  first &lt;- mapConceit echo [1..10]\n  print first\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1471550737, "last_edit_date": 1471550737, "creation_date": 1471550207, "answer_id": 39026537, "question_id": 39008115, "link": "https://stackoverflow.com/questions/39008115/makes-several-queries-at-the-same-in-a-server-a-get-the-first-response/39026537#39026537", "title": "Makes several queries at the same in a server a get the first response", "body": "<p>The <a href=\"http://hackage.haskell.org/package/async\" rel=\"nofollow\">async</a> package provides useful functions that return the result of the first concurrent action that completes (<a href=\"http://hackage.haskell.org/package/async-2.1.0/docs/Control-Concurrent-Async.html#v:race\" rel=\"nofollow\"><code>race</code></a>) or wait for all the actions to complete and return the aggregate result (<a href=\"http://hackage.haskell.org/package/async-2.1.0/docs/Control-Concurrent-Async.html#v:concurrently\" rel=\"nofollow\"><code>concurrently</code></a>, <code>mapConcurrently</code>).</p>\n\n<p>However, this tidbit in your question:</p>\n\n<blockquote>\n  <p>And stay with the first answer that has a certain pattern (e.g The\n  page shows Ok).</p>\n</blockquote>\n\n<p>complicates things a little, because when one of your POST request completes, it can either trigger the cancellation of the others (if Ok is found) or not trigger it (if Ok is not found).</p>\n\n<p>I had a similar problem, and didn't find a <em>direct</em> way of doing this with the \"async\" package that didn't involve throwing exceptions.</p>\n\n<p>I ended up creating the <a href=\"http://hackage.haskell.org/package/conceit\" rel=\"nofollow\">conceit</a> package to handle this. You can use the <a href=\"http://hackage.haskell.org/package/conceit-0.4.0.0/docs/Control-Concurrent-Conceit.html#v:mapConceit\" rel=\"nofollow\"><code>mapConceit</code></a> function:</p>\n\n<pre><code>mapConceit :: Traversable t =&gt; (a -&gt; IO (Either e b)) -&gt; t a -&gt; IO (Either e (t b))\n</code></pre>\n\n<p>Where <code>t a</code> will be your list of urls, <code>e</code> the result when Ok is found in the page, and <code>b</code> the result when it isn't. If any of the concurrent <code>IO</code> actions returns with <code>Left e</code>, the others will be immediately cancelled and the composite action will return with <code>Left e</code>. </p>\n\n<p>An alternative is to use <code>mapConcurrently</code> from \"async\", and when the Ok is found, throw an custom exception carrying your result value. But I don't like to use exceptions for returning results.</p>\n"}], "owner": {"reputation": 1713, "user_id": 1121552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tX32x.png?s=128&g=1", "display_name": "jonaprieto", "link": "https://stackoverflow.com/users/1121552/jonaprieto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1471956528, "creation_date": 1471479448, "last_edit_date": 1471484399, "question_id": 39008115, "link": "https://stackoverflow.com/questions/39008115/makes-several-queries-at-the-same-in-a-server-a-get-the-first-response", "title": "Makes several queries at the same in a server a get the first response", "body": "<p>I would like to make several queries (send POST request) at the same time.\nAnd stay with the first answer that has a certain pattern (e.g The page shows Ok).</p>\n\n<p>The web page that I'm trying to consult could take so much time to respond depends on the data sent. Therefore, I am interested in those requests that give me an answer first. The rest request I should finish them.</p>\n\n<p>How can I do such a thing in Haskell?</p>\n"}]