[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1489613068, "post_id": 42820603, "comment_id": 72753677, "body": "Possibly related question that you might find interesting: given that <code>undefined :: a</code>, why does <code>undefined :: Num a =&gt; a</code> work? There are certainly <code>a</code>s that are not <code>Num</code>s."}, {"owner": {"reputation": 3905, "user_id": 189699, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/kklyO.jpg?s=128&g=1", "display_name": "protoboolean", "link": "https://stackoverflow.com/users/189699/protoboolean"}, "edited": false, "score": 0, "creation_date": 1553429818, "post_id": 42820603, "comment_id": 97373587, "body": "One can see that &#39;every Fractional is also a Num&#39; by running: <code>Prelude&gt; :info Fractional</code> which results in: <code>class Num a =&gt; Fractional a where [\u2026omitted\u2026]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1489614741, "post_id": 42820679, "comment_id": 72754458, "body": "So the types of foo and bar unify and we can share the typeclass dictionary?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 1, "creation_date": 1489615841, "post_id": 42820679, "comment_id": 72754979, "body": "@Taren Yes, the types of <code>foo</code> and <code>bar</code> unify. No, GHC can&#39;t share the typeclass dictionary: it must supply a <code>Num</code> dictionary to one and a <code>Fractional</code> dictionary to the other. But the <code>Fractional</code> dictionary contains a <code>Num</code> dictionary, and that part at least is shared."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1540288175, "last_edit_date": 1540288175, "creation_date": 1489612030, "answer_id": 42820679, "question_id": 42820603, "link": "https://stackoverflow.com/questions/42820603/why-can-a-num-act-like-a-fractional/42820679#42820679", "title": "Why can a Num act like a Fractional?", "body": "<p>The type <code>a</code> in <code>baz :: Fractional a =&gt; a</code> is chosen by whoever calls <code>baz</code>. It is their responsibility to guarantee that their choice of <code>a</code> type is in the <code>Fractional</code> class. Since <code>Fractional</code> is a subclass of <code>Num</code>, the type <code>a</code> must therefore be also a <code>Num</code>. Hence, <code>baz</code> can use both <code>foo</code> and <code>bar</code>.</p>\n\n<p>In other words, because of the subclass relation, the signature</p>\n\n<pre><code>baz :: Fractional a =&gt; a\n</code></pre>\n\n<p>is essentially equivalent to</p>\n\n<pre><code>baz :: (Fractional a, Num a) =&gt; a\n</code></pre>\n\n<p>Your second example is actually of the same kind as the first one, it does not matter which one between <code>foo, bar</code> is the function and which one is the argument. You might also consider this:</p>\n\n<pre><code>foo :: Fractional a =&gt; a\nfoo = undefined\n\nbar :: Num a =&gt; a\nbar = undefined\n\nbaz :: Fractional a =&gt; a\nbaz = foo + bar -- Works\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1498174813, "post_id": 42821578, "comment_id": 76404702, "body": "Sorry for the late reply. This is a lot to digest. I think your answer is the key to understanding all this. Can you explain where <code>forall a .</code> comes from all of a sudden? You just added it there. In particular, can there be anything <i>other than</i> <code>forall a .</code> there?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 1, "creation_date": 1498176829, "post_id": 42821578, "comment_id": 76405145, "body": "@haskellHQ Right, bare Haskell implicitly universally quantifies any free type variables -- that is, it implicitly puts <code>forall a b c. ...</code> in front of every type, mentioning all the variables in the type in the <code>forall</code>. While Haskell itself doesn&#39;t allow any other quantifiers in that position, there are languages that have a dual <code>exists</code> quantifier; and also <code>forall</code>&#39;s can go in other places with some extensions, as in <code>Int -&gt; (forall a. a -&gt; a) -&gt; Int</code> or similar."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1498176691, "last_edit_date": 1498176691, "creation_date": 1489615600, "answer_id": 42821578, "question_id": 42820603, "link": "https://stackoverflow.com/questions/42820603/why-can-a-num-act-like-a-fractional/42821578#42821578", "title": "Why can a Num act like a Fractional?", "body": "<p>chi's answer gives a great high-level explanation of what's happening. I thought it might also be fun to give a slightly more low-level (but also more mechanical) way to understand this, so that you might be able to approach other similar problems, turn a crank, and get the right answer. I'm going to talk about types as a sort of protocol between the user of the value of that type and the implementer.</p>\n\n<ul>\n<li>For <code>forall a. t</code>, the caller gets to choose a type, then they continue with protocol <code>t</code> (where <code>a</code> has been replaced with the caller's choice everywhere in <code>t</code>).</li>\n<li>For <code>Foo a =&gt; t</code>, the caller must provide proof to the implementer that <code>a</code> is an instance of <code>Foo</code>. Then they continue with protocol <code>t</code>.</li>\n<li>For <code>t1 -&gt; t2</code>, the caller gets to choose a value of type <code>t1</code> (e.g. by running protocol <code>t1</code> with the roles of implementer and caller switched). Then they continue with protocol <code>t2</code>.</li>\n<li>For any type <code>t</code> (that is, at any time), the implementer can cut the protocol short by just producing a value of the appropriate type. If none of the rules above apply (e.g. if we have reached a base type like <code>Int</code> or a bare type variable like <code>a</code>), the implementer <em>must</em> do so.</li>\n</ul>\n\n<p>Now let's give some distinct names to your terms so we can differentiate them:</p>\n\n<pre><code>valFrac :: forall a. Fractional a =&gt;      a\nvalNum  :: forall a. Num        a =&gt;      a\nidFrac  :: forall a. Fractional a =&gt; a -&gt; a\nidNum   :: forall a. Num        a =&gt; a -&gt; a\n</code></pre>\n\n<p>We also have two definitions we want to explore:</p>\n\n<pre><code>applyIdNum :: forall a. Fractional a =&gt; a\napplyIdNum = idNum valFrac\n\napplyIdFrac :: forall a. Fractional a =&gt; a\napplyIdFrac = idFrac valNum\n</code></pre>\n\n<p>Let's talk about <code>applyIdNum</code> first. The protocol says:</p>\n\n<ol>\n<li>Caller chooses a type <code>a</code>.</li>\n<li>Caller proves it is <code>Fractional</code>.</li>\n<li>Implementer provides a value of type <code>a</code>.</li>\n</ol>\n\n<p>The implementation says:</p>\n\n<ol>\n<li><p>Implementer starts the <code>idNum</code> protocol as the caller. So, she must:</p>\n\n<ol>\n<li>Choose a type <code>a</code>. She quietly makes the same choice as <em>her</em> caller did.</li>\n<li>Prove that <code>a</code> is an instance of <code>Num</code>. This is no problem, because she actually knows that <code>a</code> is <code>Fractional</code>, and this implies <code>Num</code>.</li>\n<li>Provide a value of type <code>a</code>. Here she chooses <code>valFrac</code>. To be complete, she must then show that <code>valFrac</code> has the type <code>a</code>.</li>\n</ol></li>\n<li><p>So the implementer now runs the <code>valFrac</code> protocol. She:</p>\n\n<ol>\n<li>Chooses a type <code>a</code>. Here she quietly chooses the type that <code>idNum</code> is expecting, which happens to coincidentally be the same as the type that her caller chose for <code>a</code>.</li>\n<li>Prove that <code>a</code> is an instance of <code>Fractional</code>. She uses the same proof her caller did.</li>\n<li>The implementer of <code>valFrac</code> then promises to provide a value of type <code>a</code>, as needed.</li>\n</ol></li>\n</ol>\n\n<p>For completeness, here is the analogous discussion for <code>applyIdFrac</code>. The protocol says:</p>\n\n<ol>\n<li>Caller chooses a type <code>a</code>.</li>\n<li>Caller proves that <code>a</code> is <code>Fractional</code>.</li>\n<li>Implementer must provide a value of type <code>a</code>.</li>\n</ol>\n\n<p>The implementation says:</p>\n\n<ol>\n<li><p>Implementer will execute the <code>idFrac</code> protocol. So, she must:</p>\n\n<ol>\n<li>Choose a type. Here she quietly chooses whatever her caller chose.</li>\n<li>Prove that <code>a</code> is <code>Fractional</code>. She passes on her caller's proof of this.</li>\n<li>Choose a value of type <code>a</code>. She will execute the <code>valNum</code> protocol to do this; and we must check that this produces a value of type <code>a</code>.</li>\n</ol></li>\n<li><p>During the execution of the <code>valNum</code> protocol, she:</p>\n\n<ol>\n<li>Chooses a type. Here she chooses the type that <code>idFrac</code> expects, namely <code>a</code>; this also happens to be the type her caller chose.</li>\n<li>Prove that <code>Num a</code> holds. This she can do, because her caller supplied a proof that <code>Fractional a</code>, and you can extract a proof of <code>Num a</code> from a proof of <code>Fractional a</code>.</li>\n<li>The implementer of <code>valNum</code> then provides a value of type <code>a</code>, as needed.</li>\n</ol></li>\n</ol>\n\n<p>With all the details on the field, we can now try to zoom out and see the big picture. Both <code>applyIdNum</code> and <code>applyIdFrac</code> have the same type, namely <code>forall a. Fractional a =&gt; a</code>. So the implementer in both cases gets to assume that <code>a</code> is an instance of <code>Fractional</code>. But since all <code>Fractional</code> instances are <code>Num</code> instances, this means the implementer gets to assume both <code>Fractional</code> and <code>Num</code> apply. This makes it easy to use functions or values that assume either constraint in the implementation.</p>\n\n<p>P.S. I repeatedly used the adverb \"quietly\" for choices of types needed during the <code>forall a. t</code> protocol. This is because Haskell tries very hard to hide these choices from the user. But you can make them explicit if you like with the <code>TypeApplications</code> extension; choosing type <code>t</code> in protocol <code>f</code> uses the syntax <code>f @t</code>. Instance proofs are still silently managed on your behalf, though.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1489618364, "creation_date": 1489618364, "answer_id": 42822222, "question_id": 42820603, "link": "https://stackoverflow.com/questions/42820603/why-can-a-num-act-like-a-fractional/42822222#42822222", "title": "Why can a Num act like a Fractional?", "body": "<blockquote>\n  <p>Works as expected because every <code>Fractional</code> is also a <code>Num</code>.</p>\n</blockquote>\n\n<p>That is correct, but it's important to be precise about what this means. It means this: every <strong>type</strong> in the <code>Fractional</code> class is also in the <code>Num</code> class. It does <em>not</em> mean what someone with an OO or dynamic background might understand: \u201cevery <strong>value</strong> in a <code>Num</code> type is also in a <code>Fractional</code> type\u201d. If this were the case, then your reasoning would make sense: then the <code>Num</code> value <code>bar</code> would be insufficiently general to be used in the <code>foo</code> function. <br>...or actually it wouldn't be, because in an OO language the number hierarchy would work in the other direction \u2013 other languages usually allow you to cast any numerical value to a fractional one, but the other direction would in these languages incur round, which reasonably strongly typed ones won't automatically do!</p>\n\n<p>In Haskell, you need to worry about none of this, because there are <em>never</em> any implicit type conversions. <code>bar</code> and <code>foo</code> work on the exact same type, that this type happens a variable <code>a</code> is secondary. Now, both <code>bar</code> and <code>foo</code> constrain this single type in different ways, but because it's the same type that's constrained you simply get a combination <code>(Num a, Fractional a)</code> of both constraints, which due to <code>Num a =&gt; Fractional a</code> is equivalent to <code>Fractional a</code> alone.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "accepted_answer_id": 42821578, "answer_count": 3, "score": 3, "last_activity_date": 1553429747, "creation_date": 1489611684, "last_edit_date": 1553429747, "question_id": 42820603, "link": "https://stackoverflow.com/questions/42820603/why-can-a-num-act-like-a-fractional", "title": "Why can a Num act like a Fractional?", "body": "<p>As expected, this works fine:</p>\n\n<pre><code>valFrac :: Fractional a =&gt; a\nvalFrac = undefined\n\nfNum :: Num a =&gt; a -&gt; a\nfNum a = undefined\n\nresFrac :: Fractional a =&gt; a\nresFrac = fNum valFrac -- Works as expected because every\n                       -- Fractional is also a Num.\n                       -- So as expected, we can pass\n                       -- a Fractional argument into\n                       -- a Num parameter.\n</code></pre>\n\n<p>On the other hand, the following works too. I don't understand why.</p>\n\n<pre><code>fFrac :: Fractional a =&gt; a -&gt; a\nfFrac a = undefined\n\nvalNum :: Num a =&gt; a\nvalNum = undefined\n\nvalFrac :: Fractional a =&gt; a\nvalFrac = fFrac valNum -- Works unexpectedly! There are\n                       -- Nums that are not Fractionals.\n                       -- So why can I pass a Num argument\n                       -- into a Fractional parameter?\n</code></pre>\n\n<p>The question is in the comments. Can you explain?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1489606957, "post_id": 42819189, "comment_id": 72750238, "body": "In what way would <code>newtype</code> be more opaque than <code>data</code>?"}, {"owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1489607255, "post_id": 42819189, "comment_id": 72750419, "body": "Admittedly I&#39;m not totally sure, but for example, couldn&#39;t a user of the Queue module do something along the lines of (assuming <code>q</code> is a Queue with some stuff in it): <code>let v = head (tail (head q))</code> and thus muck with the internals of the &quot;ADT&quot; themselves?"}, {"owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1489607309, "post_id": 42819189, "comment_id": 72750461, "body": "Whereas using <code>newtype</code> would hide the implementation details?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1489607552, "post_id": 42819189, "comment_id": 72750597, "body": "They can&#39;t do <code>head q</code> because <code>head</code> expects a list, but <code>q</code> is a <code>Queue</code>. They could do <code>case q of Queue front back -&gt; head front</code>, but they can still do that if you use a <code>newtype</code>. The way to avoid this would be to not export <code>Queue</code>&#39;s constructor."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1489607884, "post_id": 42819189, "comment_id": 72750806, "body": "You could use <code>newtype Queue a = Queue ([a],[a])</code>, but that would gain nothing compared with the <code>data</code> type you already have. What makes a type transparent of opaque is whether you export the (value) constructor from its module or not. <code>module Foo (Queue())</code> only exports the type."}, {"owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "edited": false, "score": 0, "creation_date": 1581865852, "post_id": 42819189, "comment_id": 106571424, "body": "I think it&#39;s cool that this question was downvoted. Never change, Stack Overflow."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1580221071, "last_edit_date": 1580221071, "creation_date": 1489619467, "answer_id": 42822438, "question_id": 42819189, "link": "https://stackoverflow.com/questions/42819189/haskell-multiple-parameters-with-newtype/42822438#42822438", "title": "Haskell: &quot;multiple&quot; parameters with `newtype`", "body": "<p>This question seems to have been a case of the XY problem, so I'll try to both address the actual problem and answer the question you asked.</p>\n\n<h2>When I define a <code>data</code> type with one constructor that takes two lists, can the user treat it as a tuple of lists?</h2>\n\n<p>No. A <code>data</code> definition creates its own distinct type (unlike a <code>type</code> definition, which just creates an alias).</p>\n\n<h2>Are there any other issues with <code>data</code> with regard to opaqueness?</h2>\n\n<p>If you export the constructors of your data type, the user can use them through pattern matching to get at the lists that make up your queue. To prevent this, you should not export your constructors.</p>\n\n<h2>What's the difference between a <code>newtype</code> and a <code>data</code> type?</h2>\n\n<p>A <code>newtype</code> is basically a restricted version of a <code>data</code> type that can be compiled more efficiently. The restrictions are that it can only have one constructor and that that constructor can only have one parameter.</p>\n\n<p>There is a semantic difference between the two regarding laziness and non-termination (a data type can <em>contain</em> bottom, a <em>newtype</em> can only be bottom), but for the most part this does not matter and people simply use <code>newtype</code> whenever the restrictions are met to get better performance.</p>\n\n<h2>Does using <code>newtype</code> make a type more opaque?</h2>\n\n<p>No, <code>newtype</code>s behave exactly the same as <code>data</code> type (modulo the laziness difference mentioned above). The same thing I said about the opaqueness of <code>data</code> types also applies to <code>newtype</code>s.</p>\n\n<h2>Can a <code>newtype</code> have multiple parameters?</h2>\n\n<p>No, but it can have one parameter that is a tuple. You could define it like this:</p>\n\n<pre><code>data Queue a = Queue ([a], [a]) deriving Show\n</code></pre>\n\n<p>However there's very little reason why one would ever do that. The reason why you'd use a <code>newtype</code> over a <code>data</code> type is performance: You want to safe one level of indirection. However using a tuple just reintroduces the indirection you just saved, so it ends up exactly the same, performance wise.</p>\n"}], "owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "accepted_answer_id": 42822438, "answer_count": 1, "score": -1, "last_activity_date": 1580221071, "creation_date": 1489606688, "question_id": 42819189, "link": "https://stackoverflow.com/questions/42819189/haskell-multiple-parameters-with-newtype", "title": "Haskell: &quot;multiple&quot; parameters with `newtype`", "body": "<p>Disclaimer: I am very new to Haskell</p>\n\n<p>I am trying to build an opaque, polymorphic queue ADT in haskell based on <a href=\"http://www.randomhacks.net.s3-website-us-east-1.amazonaws.com/2007/02/08/haskell-queues-without-pointers/\" rel=\"nofollow noreferrer\">this</a> design:</p>\n\n<pre><code>module Queue (Queue, empty, isEmpty, frontOf, enqueue, dequeue) where\n\ndata Queue a = Queue [a] [a] deriving Show\n\nenqueue :: Queue a -&gt; a -&gt; Queue a\nenqueue (Queue xs ys) y     = Queue xs (y:ys)\n\ndequeue :: Queue a -&gt; Maybe (Queue a)\ndequeue (Queue [] [])       = Nothing\ndequeue (Queue [] ys)       = dequeue (Queue (reverse ys) [])\ndequeue (Queue (x:xs) ys)   = Just (Queue xs ys)\n</code></pre>\n\n<p>But I am trying to make it truly opaque using <code>newtype</code>:</p>\n\n<pre><code>module Queue (Queue, empty, isEmpty, frontOf, enqueue, dequeue) where\n\nenqueue :: Queue a -&gt; a -&gt; Queue a\ndequeue :: Queue a -&gt; Maybe (Queue a)\n\nnewtype Queue a = Qimp ???\n\n...function implementations\n</code></pre>\n\n<p>So my Question is, what do I put in place of <code>???</code>. </p>\n\n<p>I've tried this:</p>\n\n<pre><code>newtype Queue a = Qimp ([] [])\n</code></pre>\n\n<p>But this seems to break the logic in my functions, for reasons that are probably obvious to a trained eye (but not obvious to me).</p>\n\n<p>I seem to be in a pickle because my original implementation used two lists to implement a queue efficiently, but <code>newtype</code> requires exactly one parameter in the constructor. Is there a common/standard way to simulate multiple constructor parameters in a use of <code>newtype</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 5, "creation_date": 1489604480, "post_id": 42818488, "comment_id": 72748784, "body": "<i>Why</i> do you think you can&#39;t use <code>map</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1489610070, "post_id": 42818541, "comment_id": 72752020, "body": "Do consider the level of the students you are answering.  It seems this student has never even seen a lambda; this is a pretty advanced answer considering. (composition, HOFs, sections...)"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1489610309, "post_id": 42818541, "comment_id": 72752170, "body": "@luqui, I tried to start with the simplest example and then moved to something a bit more complicated, <i>while explaining how that code works</i>. BTW, thanks for calling my answer &#39;pretty advanced&#39; as I just started learning Haskell about a month ago :D Looks like I&#39;m doing not terribly bad."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489612238, "post_id": 42818541, "comment_id": 72753221, "body": "The list-comprehension solution is perfectly readable and lovely. The point-free thing is &quot;advanced&quot; in that it shows you have some mastery of a useful technique, but it is probably best not applied here."}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 0, "last_activity_date": 1489605349, "last_edit_date": 1489605349, "creation_date": 1489604508, "answer_id": 42818541, "question_id": 42818488, "link": "https://stackoverflow.com/questions/42818488/how-apply-more-complex-operations-on-every-element-of-a-list/42818541#42818541", "title": "How apply more complex operations on every element of a list?", "body": "<p>Use list comprehensions:</p>\n\n<pre><code>[(3 * x) `rem` 16 | x &lt;- data_source]\n</code></pre>\n\n<p>You can also try this, although it may seem not so readable, but it involves <code>map</code>:</p>\n\n<pre><code>map ((flip rem) 16) $ map (3*) data_source\n</code></pre>\n\n<hr>\n\n<p>Here's how it works:</p>\n\n<ul>\n<li><code>map (3*) data_source</code> multiplies each element of <code>data_source</code> by 3, pretty straightforward</li>\n<li><code>map ((flip rem) 16) $ stuff</code> applies the function <code>((flip rem) 16)</code> to each element of <code>stuff</code>\n\n<ul>\n<li><code>(flip rem) 16</code> is a function of one argument <code>x</code> that computes the value of <code>rem x 16</code></li>\n</ul></li>\n</ul>\n\n<p>Now, you could've used <code>rem 16</code> instead of that <code>flip</code>ping business, but in that case the function'll return <code>rem 16 x</code> instead, which isn't what you want.</p>\n\n<hr>\n\n<p>You can also use this, which looks a bit cleaner than the second version:</p>\n\n<pre><code>map (((flip rem) 16) . (3*)) data_source\n</code></pre>\n\n<p>The dot (<code>.</code>), as in <code>function1 . function2</code> creates a composite function which works like the following: <code>function1 $ function2 x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 4, "last_activity_date": 1489604548, "creation_date": 1489604548, "answer_id": 42818552, "question_id": 42818488, "link": "https://stackoverflow.com/questions/42818488/how-apply-more-complex-operations-on-every-element-of-a-list/42818552#42818552", "title": "How apply more complex operations on every element of a list?", "body": "<p>You can definitely use <code>map</code>, you just need to define the function you want to map over the list.</p>\n\n<pre><code>fancypants x = (3*x) `rem` 16\n\nghci&gt; map fancypants [0,1,2,3,4,5,6]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7717015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e0a62a098f09502f29673ab0fbf216?s=128&d=identicon&r=PG&f=1", "display_name": "EMPires", "link": "https://stackoverflow.com/users/7717015/empires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489605349, "creation_date": 1489604340, "question_id": 42818488, "link": "https://stackoverflow.com/questions/42818488/how-apply-more-complex-operations-on-every-element-of-a-list", "title": "How apply more complex operations on every element of a list?", "body": "<p>I need to apply a operation on each element of a list. The operation is \"y = (3*x) rem 16\". In this case I (think I) can't use the map function.</p>\n\n<p>Ex:</p>\n\n<pre><code>x = [0 1 2 3 4 5 6]\n\ny = [0 3 6 9 12 15 2]\n</code></pre>\n\n<p>I am new in funcional programming, especially haskell, so i'm having some trouble with that.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13863, "user_id": 6162307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6y4Ix.jpg?s=128&g=1", "display_name": "Ma0", "link": "https://stackoverflow.com/users/6162307/ma0"}, "edited": false, "score": 0, "creation_date": 1489590338, "post_id": 42813540, "comment_id": 72739216, "body": "<i>all</i> prime numbers?"}, {"owner": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "reply_to_user": {"reputation": 13863, "user_id": 6162307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6y4Ix.jpg?s=128&g=1", "display_name": "Ma0", "link": "https://stackoverflow.com/users/6162307/ma0"}, "edited": false, "score": 0, "creation_date": 1489590485, "post_id": 42813540, "comment_id": 72739335, "body": "@Ev.Kounis it should do"}], "answers": [{"comments": [{"owner": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "edited": false, "score": 0, "creation_date": 1489591346, "post_id": 42813858, "comment_id": 72740062, "body": "This is because mod is an infix operator? I&#39;m pretty new to haskell so..."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "edited": false, "score": 0, "creation_date": 1489591502, "post_id": 42813858, "comment_id": 72740215, "body": "@Cjen1 no. <code>mod</code> is a function. You can use backticks to make it an infix one."}, {"owner": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "edited": false, "score": 0, "creation_date": 1489592278, "post_id": 42813858, "comment_id": 72740837, "body": "Yeah sorry that was what I meant"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1489591593, "last_edit_date": 1489591593, "creation_date": 1489591185, "answer_id": 42813858, "question_id": 42813540, "link": "https://stackoverflow.com/questions/42813540/occurs-check-cannot-construct-the-infinte-type/42813858#42813858", "title": "Occurs check: cannot construct the infinte type", "body": "<pre><code>x mod i\n</code></pre>\n\n<p>is not what you intended. You want to use</p>\n\n<pre><code>x `mod` i\n</code></pre>\n\n<p>The problem with the first is that since both <code>i</code> and <code>x</code> are from the list, they must have the same type. Let's call that type  <code>X</code>. What is <code>X</code>? Well, since we use <code>x mod</code>, it should start with <code>mod</code>'s type:</p>\n\n<pre><code>type X = (Integer -&gt; Integer -&gt; Integer) -&gt; \u2026\n</code></pre>\n\n<p>Since the other \"parameter\" is <code>i</code>, which has the same type as <code>x</code>, we end up with:</p>\n\n<pre><code>type X = (Integer -&gt; Integer -&gt; Integer) -&gt; X -&gt; \u2026\n</code></pre>\n\n<p>which is an infinite type.</p>\n\n<p>So the proper solution would be</p>\n\n<pre><code>primes remNum =\n  let i = head remNum\n  in i : primes (filter (\\(x) -&gt; x `mod` i /= 0) (tail remNum))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>primes remNum =\n  let i = head remNum\n  in i : primes (filter (\\(x) -&gt; mod x i /= 0) (tail remNum))\n</code></pre>\n\n<p>or (with pattern matching)</p>\n\n<pre><code>primes (i:remNums) = x : primes (filter (\\x -&gt; mod x i /= 0) remNums)\n</code></pre>\n"}], "owner": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 42813858, "answer_count": 1, "score": 1, "last_activity_date": 1489591593, "creation_date": 1489590288, "last_edit_date": 1489590473, "question_id": 42813540, "link": "https://stackoverflow.com/questions/42813540/occurs-check-cannot-construct-the-infinte-type", "title": "Occurs check: cannot construct the infinte type", "body": "<p>I'm trying to construct a list of all prime numbers using the sieve method:</p>\n\n<pre><code>primes remNum =\n  let i = head remNum\n  in i : primes (filter (\\(x) -&gt; x mod i /= 0) (tail remNum))\n</code></pre>\n\n<p>The error that I'm getting is:</p>\n\n<pre><code>* Occurs check: cannot construct the infinite type:\n    t ~ (a -&gt; a -&gt; a) -&gt; t -&gt; a1\n  Expected type: [t]\n    Actual type: [(a -&gt; a -&gt; a) -&gt; t -&gt; a1]\n* In the first argument of `head', namely `remNum'\n  In the expression: head remNum\n  In an equation for `i': i = head remNum\n* Relevant bindings include\n    i :: t (bound at lib.hs:30:7)\n    remNum :: [(a -&gt; a -&gt; a) -&gt; t -&gt; a1] (bound at lib.hs:29:8)\n    primes :: [(a -&gt; a -&gt; a) -&gt; t -&gt; a1] -&gt; [t] (bound at lib.hs:29:1)\n</code></pre>\n\n<p>I don't understand why remNum is bound to <code>[(a-&gt; a -&gt; a) -&gt; t -&gt; a1]</code> while <code>i</code> is bound to <code>t</code>, since surely <code>head :: [a] -&gt; a</code> would imply <code>remNum::[t]</code>?</p>\n\n<p>So the idea with this is that it is supplied a lazy list of all numbers and then essentially maintains a list of removed values.</p>\n\n<p>It would be called:</p>\n\n<pre><code>numsFrom n = n : numsFrom (n + 1)\nprimes numsFrom 2\n</code></pre>\n"}, {"tags": ["ubuntu", "haskell", "ghc", "gloss"], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "is_accepted": false, "score": 0, "last_activity_date": 1489587019, "creation_date": 1489587019, "answer_id": 42812201, "question_id": 42811210, "link": "https://stackoverflow.com/questions/42811210/ghc-sudden-error-lglu-lgl/42812201#42812201", "title": "ghc sudden error: -lGLU, -lGL", "body": "<p>I fixed this by installing</p>\n\n<pre><code>sudo apt-get install freeglut3-dev\n</code></pre>\n\n<p>I am still not sure what caused the problem but my guess is that there was some graphics issue especially through virtual machine that suddenly became an issue once I used gloss more intensively.</p>\n"}], "owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489587019, "creation_date": 1489584523, "question_id": 42811210, "link": "https://stackoverflow.com/questions/42811210/ghc-sudden-error-lglu-lgl", "title": "ghc sudden error: -lGLU, -lGL", "body": "<p>I am running <code>Ubuntu 16.04</code> in virtualbox on windows 10. I am working with <code>gloss</code> in haskell <code>ghc</code> and I compiled many files with the <code>gloss</code> package without an issue. Then suddenly for no apparent reason, I am getting errors compiling things that used to work. I did not do anything weird as far as I'm aware so I have no idea what is going on. But now I get errors when compiling</p>\n\n<pre><code>$ghc Hello\nLinking Hello ...\n/usr/bin/ld: cannot find -lGLU\n/usr/bin/ld: cannot find -lGL\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>If I try to run a file I compiled previously without recompiling, I get</p>\n\n<pre><code>$./Clock\nClock: user error (unknown GLUT entry glutInit)\n</code></pre>\n\n<p>I don't know what could have caused this. What is the proper way to fix this?</p>\n\n<p>EDIT: I installed </p>\n\n<pre><code>sudo apt-get install libgl1-mesa-dev libglu1-mesa-dev  mesa-common-dev\n</code></pre>\n\n<p>and it now compiles but I still get the same error when trying to run. I am running linux virtual machine in windows.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489581915, "post_id": 42810012, "comment_id": 72732409, "body": "<code>print ((stuff here) :: Maybe Int)</code> should also work."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 3, "last_activity_date": 1489592468, "last_edit_date": 1489592468, "creation_date": 1489581529, "answer_id": 42810012, "question_id": 42809198, "link": "https://stackoverflow.com/questions/42809198/no-instance-for-show-b0-arising-from-a-use-of-print-the-type-variable-b0-i/42810012#42810012", "title": "No instance for (Show b0) arising from a use of `print&#39; The type variable `b0&#39; is ambiguous", "body": "<p>The problem lies in the last <code>print</code> line. Basically, you are applying a function <code>String -&gt; b</code> by using <code>&lt;*&gt;</code>. It just so happens that you use <code>Nothing</code> to wrap the function, so there is no function in the end. The result of the application is some <code>Maybe b</code> where <code>b</code> is arbitrary, but only those <code>a</code>s that are instances of <code>Show</code> produce instances for <code>Maybe a</code>. But remember you have an arbitrary <code>b</code>, which need not be an instance of <code>Show</code>. The <code>print</code> however requires its argument to be an instance of <code>Show</code>. Since you cannot prove <code>b</code> to be instance of <code>Show</code> neither can you prove <code>Maybe b</code> to be an instance of <code>Show</code>, thus <code>print</code> does not apply to the value of type <code>Maybe b</code>.</p>\n\n<p>To make it go away you must specify what exact type of function you meant to be contained. So that the result has some known type:</p>\n\n<pre><code>(Nothing :: Maybe (String -&gt; Int)) &lt;*&gt; ...\n</code></pre>\n\n<p>or you could just provide the type for the whole expression that is passed as input of the <code>print</code>:</p>\n\n<pre><code>print (... :: Maybe Int)\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 42810012, "answer_count": 1, "score": 0, "last_activity_date": 1489592468, "creation_date": 1489579324, "question_id": 42809198, "link": "https://stackoverflow.com/questions/42809198/no-instance-for-show-b0-arising-from-a-use-of-print-the-type-variable-b0-i", "title": "No instance for (Show b0) arising from a use of `print&#39; The type variable `b0&#39; is ambiguous", "body": "<p>I'm trying to go through the Applicative example from Learn You a Haskell for Great Good! book.</p>\n\n<p>my code is here:</p>\n\n<pre><code>class (Functor f) =&gt; Applicative f where  \n    pure :: a -&gt; f a  \n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance Applicative Maybe where  \n    pure = Just  \n    Nothing &lt;*&gt; _ = Nothing  \n    (Just f) &lt;*&gt; something = fmap f something  \n\nmain = do \n    print $ Just (+3) &lt;*&gt; Just 9 \n    print $ pure (+3) &lt;*&gt; Just 10\n    print $ pure (+3) &lt;*&gt; Just 9 \n    print $ Just (++\"hahah\") &lt;*&gt; Nothing  \n    print $ Nothing &lt;*&gt; Just \"woot\"\n</code></pre>\n\n<p>and I got this error message:</p>\n\n<pre><code>No instance for (Show b0) arising from a use of `print'\nThe type variable `b0' is ambiguous\nPossible fix: add a type signature that fixes these type variable(s)\nNote: there are several potential instances:\n  instance Show Double -- Defined in `GHC.Float'\n  instance Show Float -- Defined in `GHC.Float'\n  instance (Integral a, Show a) =&gt; Show (GHC.Real.Ratio a)\n    -- Defined in `GHC.Real'\n  ...plus 23 others\nIn the expression: print\nIn a stmt of a 'do' block: print $ Nothing &lt;*&gt; Just \"woot\"\nIn the expression:\n  do { print $ Just (+ 3) &lt;*&gt; Just 9;\n       print $ pure (+ 3) &lt;*&gt; Just 10;\n       print $ pure (+ 3) &lt;*&gt; Just 9;\n       print $ Just (++ \"hahah\") &lt;*&gt; Nothing;\n       .... }\n</code></pre>\n\n<p>Why does it fail and how can I fix this?</p>\n"}, {"tags": ["haskell", "gloss"], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "is_accepted": false, "score": 0, "last_activity_date": 1489594205, "last_edit_date": 1495541366, "creation_date": 1489593043, "answer_id": 42814660, "question_id": 42809003, "link": "https://stackoverflow.com/questions/42809003/haskell-gloss-example-skeleton/42814660#42814660", "title": "Haskell gloss example/skeleton", "body": "<p>I eventually found some good examples:</p>\n\n<p><a href=\"http://andrew.gibiansky.com/blog/haskell/haskell-gloss/#_gloss\" rel=\"nofollow noreferrer\">http://andrew.gibiansky.com/blog/haskell/haskell-gloss/#_gloss</a></p>\n\n<p><a href=\"https://functional-programming.it.jyu.fi/master/pages/ProjectAsteroids.md\" rel=\"nofollow noreferrer\">https://functional-programming.it.jyu.fi/master/pages/ProjectAsteroids.md</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/35507997/reading-user-mouseclick-position-in-haskells-gloss\">Reading user mouseclick position in haskells gloss</a></p>\n"}], "owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 712, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489594205, "creation_date": 1489578818, "last_edit_date": 1495542724, "question_id": 42809003, "link": "https://stackoverflow.com/questions/42809003/haskell-gloss-example-skeleton", "title": "Haskell gloss example/skeleton", "body": "<p>I am trying to use the gloss package in Haskell to make a game but find everything I read too simplistic or hard to read. I have seen</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26120076/what-would-be-a-typical-game-skeleton-in-haskell\">What would be a typical game skeleton in Haskell</a></p>\n\n<p>which is a little useful but I am hoping for a little more information. Could someone provide any resources online with a slightly more complicated game with interacting elements. Code examples would be helpful too. I would like to have</p>\n\n<pre><code>main :: IO () \nmain = do \n...play...\n</code></pre>\n\n<p>somewhere also with event handling/rendering and keyboard commands.</p>\n"}, {"tags": ["haskell", "unicode"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489601105, "post_id": 42805215, "comment_id": 72746750, "body": "Is your terminal ok, that is, can you <code>echo &#215;</code> and get correct output?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1489605692, "post_id": 42805215, "comment_id": 72749497, "body": "Try &quot;print someText&quot;. This will print the escaped version so you can see what code points are in it. Unicode from outside the ASCII set will show up as backslashed octal codes. E.g. print &quot;&#234;&quot; will emit &quot;\\234&quot;."}, {"owner": {"reputation": 216, "user_id": 2469967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jy0ME.png?s=128&g=1", "display_name": "Debjit", "link": "https://stackoverflow.com/users/2469967/debjit"}, "edited": false, "score": 0, "creation_date": 1489642869, "post_id": 42805215, "comment_id": 72763013, "body": "Yes, <code>echo &#215;</code> work on my terminal and <code>print &quot;&#215;&quot;</code> in GHCi prints <code>&quot;\\215&quot;</code> which is correct I suppose."}], "owner": {"reputation": 216, "user_id": 2469967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jy0ME.png?s=128&g=1", "display_name": "Debjit", "link": "https://stackoverflow.com/users/2469967/debjit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489646107, "creation_date": 1489568612, "last_edit_date": 1489646107, "question_id": 42805215, "link": "https://stackoverflow.com/questions/42805215/maintain-unicode-characters-while-running-external-programs-in-haskell", "title": "Maintain Unicode characters while running external programs in Haskell", "body": "<p>I am trying to run an external command by passing it Lazy Text in stdin. The text contains unicode characters but they are not showing up correctly in the output. Below is a minimal example with the external command as <code>tee</code>. For shell utilities I am using the <a href=\"https://hackage.haskell.org/package/shellmate-0.3.2/docs/Control-Shell.html\" rel=\"nofollow noreferrer\">shellmate</a> package</p>\n\n<pre><code>Sh.shell $ do\n  hStdIn &lt;- Sh.getStdIn\n  hStdOut &lt;- Sh.getStdOut\n  Sh.liftIO $ IO.hSetEncoding hStdIn IO.utf8\n  Sh.liftIO $ IO.hSetEncoding hStdOut IO.utf8\n  Sh.echo_ someText Sh.|&gt; Sh.run \"tee\" []\n</code></pre>\n\n<p>If <code>someText</code> is <code>\u00d7</code> in the output I see <code>\ufffd</code>.</p>\n\n<p>I also tried converting the text to <code>ByteString</code> using the <a href=\"https://hackage.haskell.org/package/text-1.2.2.1/docs/Data-Text-Lazy-Encoding.html#v:encodeUtf8\" rel=\"nofollow noreferrer\"><code>encodeUtf8</code></a> function and then converting to String.</p>\n\n<pre><code>import Data.ByteString.UTF8 (toString, fromString)\nimport Data.Text.Encoding (encodeUtf8, decodeUtf8)\nimport Data.Text.Lazy (toStrict, fromStrict)\n\nSh.echo_ (toString . encodeUtf8 . toStrict (someText))\n  Sh.|&gt; Sh.run \"tee\" []\n</code></pre>\n\n<p>and decoding as</p>\n\n<pre><code>(fromStrict . decodeUtf8 . fromString) c\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>I was unable to fix this with shellmate, so started using <code>System.Process</code>.</p>\n\n<pre><code>import qualified System.IO as IO\n\n(Just inp, Just outp, _, phandle) &lt;-\n  P.createProcess\n    (P.proc \"tee\" [])\n    { P.std_out = P.CreatePipe, P.std_in = P.CreatePipe }\n\nIO.hSetEncoding inp IO.utf8\nIO.hSetEncoding outp IO.utf8\n\nIO.hPutStr inp someText\n\noutputText &lt;- IO.hGetContents outp\n</code></pre>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1489555933, "post_id": 42801681, "comment_id": 72717080, "body": "You need to be clearer than &quot;it does not work&quot;. What happens? Where do <i>you</i> think the problem lies? etc..."}], "answers": [{"tags": [], "owner": {"reputation": 23884, "user_id": 3705127, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b03aedaddfa4dc1c2b331f318a724ec7?s=128&d=identicon&r=PG&f=1", "display_name": "sprinter", "link": "https://stackoverflow.com/users/3705127/sprinter"}, "is_accepted": true, "score": 2, "last_activity_date": 1489555964, "creation_date": 1489555964, "answer_id": 42801774, "question_id": 42801681, "link": "https://stackoverflow.com/questions/42801681/how-do-i-use-map-to-create-a-list-of-circles/42801774#42801774", "title": "How do I use map to create a list of circles?", "body": "<p>It looks as though you have misunderstood how <code>map</code> works. You provide a function and a list and it maps all elements in the list using the function.</p>\n\n<p>In your case the list is <code>[1..n]</code> and the function is 'create a circle using the radius'. So I expect your definition should be using a statement like</p>\n\n<pre><code>map (\\r -&gt; (Circle point r col)) [1..n]\n</code></pre>\n\n<p>This is using lambda syntax which you might not be familiar with. If not either look it up or use a 'let' statement instead.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489608418, "creation_date": 1489608418, "answer_id": 42819694, "question_id": 42801681, "link": "https://stackoverflow.com/questions/42801681/how-do-i-use-map-to-create-a-list-of-circles/42819694#42819694", "title": "How do I use map to create a list of circles?", "body": "<p>A list comprehension would be fairly close to your attempt</p>\n\n<pre><code>[Circle point (x * (400/n)) col | x &lt;- [1..n] ]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6864253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a48dddb5e6e42f169e91704abac0d6?s=128&d=identicon&r=PG&f=1", "display_name": "torjussa", "link": "https://stackoverflow.com/users/6864253/torjussa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 42801774, "answer_count": 2, "score": -2, "last_activity_date": 1522155158, "creation_date": 1489555478, "last_edit_date": 1522155158, "question_id": 42801681, "link": "https://stackoverflow.com/questions/42801681/how-do-i-use-map-to-create-a-list-of-circles", "title": "How do I use map to create a list of circles?", "body": "<p>I am trying to create a function which takes in <em>color</em> and <em>number</em> and returns a list of <em>Circle</em> objects (point, radius, color) with changing radius like this:</p>\n\n<pre><code>[Circle point 1*(400/n) col, Circle point 2*(400/n) col, ..., Circle point n*(400/n) col]\n</code></pre>\n\n<p>Being new to Haskell, I am struggling with maps and the concept of adding to a list, but I tried with the following simple approach:</p>\n\n<pre><code>getCircles :: Color -&gt; Float -&gt; [PictureObject]\ngetCircles col n = [Circle point (map [1,2..n] * (400/n)) col]\n</code></pre>\n\n<p>Needless to say, it does not work.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1489554075, "post_id": 42801417, "comment_id": 72716529, "body": "You need to indent the cases further than <code>case</code>."}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489554291, "post_id": 42801417, "comment_id": 72716595, "body": "not just further than the line that the case statement is on?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1489554927, "post_id": 42801417, "comment_id": 72716769, "body": "The why is &quot;because that&#39;s the language definition.&quot;  If you want to ask why is the language defined that way, it&#39;s to avoid parse ambiguities."}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1489557150, "post_id": 42801417, "comment_id": 72717523, "body": "@ThomasM.DuBuisson Oh I mean I thought that the compiler only cared whether some block was indented with respect to another, not how much it was indented; except in the case where a block must be in the same column as a word on the previous line; but that doesn&#39;t seem to be the case here. I understand every language choice has a reason, I simply ask how the distinction in this case fits into that. If you have a link, I&#39;d be happy to read up."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1489564422, "creation_date": 1489564422, "answer_id": 42803895, "question_id": 42801417, "link": "https://stackoverflow.com/questions/42801417/error-parsing-case-expression/42803895#42803895", "title": "Error parsing case expression", "body": "<p>This is described in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-210002.7\" rel=\"nofollow noreferrer\">2.7</a> and <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3\" rel=\"nofollow noreferrer\">10.3</a>. Basically, the rule for <code>let \u2026</code> in a <code>do</code> block* is that all bindings have to be indented the same way:</p>\n\n<pre><code>let a = \u2026\n    b = \u2026\n    c = \u2026\n</code></pre>\n\n<p>Furthermore, the \"\u2026\" have to be <em>more</em> indented than the layout list. For example, the following is a syntax error:</p>\n\n<pre><code>let a =\n    10\nin a\n</code></pre>\n\n<p>In order to create a new layout-list, we need to indent it further (see note 1 in section 10.3), which is why </p>\n\n<pre><code>let a =\n     10\nin a\n</code></pre>\n\n<p>is completely fine. The same holds for your <code>case</code>. All of the cases have to be further indented than <code>f</code> due to the off-side rule.</p>\n\n<p><sup>* that rule actually holds** for more, i.e. for <code>let</code>, <code>where</code>, <code>do</code> and <code>of</code>.</sup><br>\n<sup>** well, as long as you don't introduce additional braces</sup></p>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 42803895, "answer_count": 1, "score": 0, "last_activity_date": 1489564422, "creation_date": 1489553883, "last_edit_date": 1489559112, "question_id": 42801417, "link": "https://stackoverflow.com/questions/42801417/error-parsing-case-expression", "title": "Error parsing case expression", "body": "<p>I am getting this compile error:</p>\n\n<pre><code>Files.hs:47:17: parse error on input \u2018-&gt;\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>In the following section of code:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    args &lt;- getArgs\n    let f = case args of\n        (\"W\":_) -&gt; eoltoW\n        --      ^  here's 47:17\n        (\"U\":_) -&gt; eoltoU\n        _       -&gt; fail \"2 - 3 arguments required\"\n    case args of\n        [_,i,o] -&gt; editWith f i o\n        [_,i]   -&gt; catWith  f i\n        [_]     -&gt; fail \"2 - 3 arguments required\"\n</code></pre>\n\n<p>While I understand the logic could use some tidying up, I do not see where I am going wrong with case syntax. I figure it might be some weird interaction with <code>do</code> and <code>let</code>, but I can't find any clue as to how to correct it.</p>\n\n<p>Note, I have ensured that I only use spaces for indentation</p>\n\n<h2>Edit:</h2>\n\n<p>It seems that adding a single space further of indentation (as below) is sufficient to prevent the error, but I am unclear as to why.</p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    let f = case args of\n         (\"W\":_) -&gt; eoltoW\n         --      ^  here's 47:17\n         (\"U\":_) -&gt; eoltoU\n         _       -&gt; fail \"2 - 3 arguments required\"\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "anonymous-function"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1489544835, "post_id": 42800037, "comment_id": 72714299, "body": "<code>(\\x y -&gt; (insert x y))</code> is equivalent to <code>insert</code>."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1489545102, "creation_date": 1489545102, "answer_id": 42800091, "question_id": 42800037, "link": "https://stackoverflow.com/questions/42800037/using-anonymous-functions-in-haskell-cis194-week-2-exercise-2/42800091#42800091", "title": "Using anonymous functions in Haskell CIS194 Week 2 Exercise 2", "body": "<p>Parentheses do not indicate function calls; they simply affect operator precedence. Function application is represented by juxtaposition (which can be thought of as the operator with highest precedence).</p>\n\n<p>This line</p>\n\n<pre><code>build messages = reduce (\\x y -&gt; (insert x y)) tail(messages) (Node Leaf head(messages) Leaf)\n</code></pre>\n\n<p>should first be shortened to </p>\n\n<pre><code>build messages = reduce insert tail(messages) (Node Leaf head(messages) Leaf)\n</code></pre>\n\n<p>which makes it easier to see the correct way to parenthesize:</p>\n\n<pre><code>build messages = reduce insert (tail messages) (Node Leaf (head messages) Leaf)\n</code></pre>\n\n<p>This is, however, better written using pattern matching than using <code>head</code> and <code>tail</code>:</p>\n\n<pre><code>build (x:xs) = reduce insert xs (Node Leaf x Leaf)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7712235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258b265cc0a5f3e71537b13f0ab29fe9?s=128&d=identicon&r=PG&f=1", "display_name": "user7712235", "link": "https://stackoverflow.com/users/7712235/user7712235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 42800091, "answer_count": 1, "score": 3, "last_activity_date": 1489545102, "creation_date": 1489544704, "question_id": 42800037, "link": "https://stackoverflow.com/questions/42800037/using-anonymous-functions-in-haskell-cis194-week-2-exercise-2", "title": "Using anonymous functions in Haskell CIS194 Week 2 Exercise 2", "body": "<p>I am trying to learn haskell through the \"CIS 194: Introduction to Haskell 2013\" course and have run into a snag with exercise 2 in the second week. I am trying to define my build function using an auxiliary recursive function</p>\n\n<pre><code>reduce :: (a -&gt; b -&gt; b) -&gt; [a] -&gt; b -&gt; b\nreduce _ [] x = x\nreduce f (x:xs) y  = reduce f xs (f x y)\n</code></pre>\n\n<p>The goal of this function is to recursively apply a function on the list [a] to the b. This is because I want to recursively insert a list of LogMessage's into a MessageTree</p>\n\n<pre><code>build :: [LogMessage] -&gt; MessageTree\nbuild [] = Node Leaf (Unknown \"\") Leaf\nbuild messages =\n    reduce (\\x y -&gt; (insert x y)) tail(messages) (Node Leaf head(messages) Leaf)\n</code></pre>\n\n<p>but when I try and compile this, I am receiving a long list of compilation errors:</p>\n\n<pre><code>LogAnalysis.hs:42:22:\n    Couldn't match expected type `t0 -&gt; MessageTree'\n                with actual type `MessageTree'\n    In the return type of a call of `insert'\n    Probable cause: `insert' is applied to too many arguments\n    In the expression: (insert x y)\n    In the first argument of `reduce', namely `(\\ x y -&gt; (insert x y))'\n\nLogAnalysis.hs:42:31:\n    Couldn't match expected type `MessageTree'\n                with actual type `t0 -&gt; MessageTree'\n    In the second argument of `insert', namely `y'\n    In the expression: (insert x y)\n    In the first argument of `reduce', namely `(\\ x y -&gt; (insert x y))'\n\nLogAnalysis.hs:42:35:\n    Couldn't match expected type `[LogMessage]'\n                with actual type `[a0] -&gt; [a0]'\n    In the second argument of `reduce', namely `tail'\n    In the expression:\n      reduce\n        (\\ x y -&gt; (insert x y))\n        tail\n        (messages)\n        (Node Leaf head (messages) Leaf)\n    In an equation for `build':\n        build messages\n          = reduce\n              (\\ x y -&gt; (insert x y))\n              tail\n              (messages)\n              (Node Leaf head (messages) Leaf)\n\nLogAnalysis.hs:42:40:\n    Couldn't match expected type `t0 -&gt; MessageTree'\n                with actual type `[LogMessage]'\n    In the third argument of `reduce', namely `(messages)'\n    In the expression:\n      reduce\n        (\\ x y -&gt; (insert x y))\n        tail\n        (messages)\n        (Node Leaf head (messages) Leaf)\n    In an equation for `build':\n        build messages\n          = reduce\n              (\\ x y -&gt; (insert x y))\n              tail\n              (messages)\n              (Node Leaf head (messages) Leaf)\n\nLogAnalysis.hs:42:51:\n    Couldn't match expected type `MessageTree -&gt; t0'\n                with actual type `MessageTree'\n    The function `Node' is applied to four arguments,\n    but its type `MessageTree\n              -&gt; LogMessage -&gt; MessageTree -&gt; MessageTree'\n    has only three\n    In the fourth argument of `reduce', namely\n      `(Node Leaf head (messages) Leaf)'\n    In the expression:\n      reduce\n        (\\ x y -&gt; (insert x y))\n        tail\n        (messages)\n        (Node Leaf head (messages) Leaf)\n\nLogAnalysis.hs:42:61:\n    Couldn't match expected type `LogMessage'\n            with actual type `[a1] -&gt; a1'\n    In the second argument of `Node', namely `head'\n    In the fourth argument of `reduce', namely\n      `(Node Leaf head (messages) Leaf)'\n    In the expression:\n      reduce\n        (\\ x y -&gt; (insert x y))\n        tail\n        (messages)\n        (Node Leaf head (messages) Leaf)\n\nLogAnalysis.hs:42:66:\n    Couldn't match expected type `MessageTree'\n            with actual type `[LogMessage]'\n    In the third argument of `Node', namely `(messages)'\n    In the fourth argument of `reduce', namely\n      `(Node Leaf head (messages) Leaf)'\n    In the expression:\n      reduce\n        (\\ x y -&gt; (insert x y))\n        tail\n        (messages)\n        (Node Leaf head (messages) Leaf)\nFailed, modules loaded: Log.\n</code></pre>\n\n<p>For reference, here is my insert function, which compiles correctly</p>\n\n<pre><code>insert :: LogMessage -&gt; MessageTree -&gt; MessageTree\ninsert (Unknown _) tree = tree\ninsert _ tree@(Node _ (Unknown _) _) = tree\ninsert message Leaf = Node Leaf message Leaf\ninsert message@(LogMessage _ timeStampMessage _) (Node left m@(LogMessage _ timeStampTree _) right)\n    | timeStampMessage &lt; timeStampTree  = Node (insert message left) m right\n    | timeStampMessage &gt; timeStampTree  = Node left m (insert message right)\n    | timeStampMessage == timeStampTree = Node left message right\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489544254, "post_id": 42799919, "comment_id": 72714166, "body": "Hint: what should be the type of the result of your <code>left</code> function, and what does the type signature you wrote say about it?"}, {"owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489544483, "post_id": 42799919, "comment_id": 72714209, "body": "I&#39;m trying get the left side of the tree, so I receive a tree and return the left-child that is another tree"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1489545362, "post_id": 42799919, "comment_id": 72714430, "body": "If you just want <code>left</code> to return the left subtree, you don&#39;t need to use <code>show</code> in it -- <code>show</code> produces a <code>String</code>."}, {"owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489546846, "post_id": 42799919, "comment_id": 72714780, "body": "I didn&#39;t understand... why not? And if I want print the tree?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1489549078, "post_id": 42799919, "comment_id": 72715321, "body": "Returning the tree is not the same thing as printing it. You only need <code>show</code> if you want to print the tree; in that case, the return type of <code>left</code> should be <code>String</code>, and not <code>Tree a</code> (and it also would probably be a good idea to give a more specific name to your function, such as <code>printLeft</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1489633838, "creation_date": 1489633838, "answer_id": 42824599, "question_id": 42799919, "link": "https://stackoverflow.com/questions/42799919/how-can-i-call-a-show-instace-to-print-a-binary-tree/42824599#42824599", "title": "How can I call a show instace to print a binary tree?", "body": "<p>Your types and values are mismatched. Your function <code>left :: Tree a -&gt; Tree a</code> says it returns a <code>Tree a</code>, but the function body <code>show e</code> returns a <code>String</code> (because <code>show :: Show a =&gt; Tree a -&gt; String</code>).</p>\n\n<p>If you want a function that prints the tree to stdout, you need to have a function that does IO, and a <code>Show</code> constraint so that the elements of the tree are known to be instances of <code>Show</code>, so its type would need to be: <code>left :: Show a =&gt; Tree a -&gt; IO ()</code> and the body would be: <code>left (Nod x e d) = print e</code> (<code>print :: Show a =&gt; a -&gt; IO ()</code>)</p>\n\n<p>If you want a function that takes a tree and returns the left side of it as a <code>String</code>, you need to change the result type of the function to <code>String</code>, and add the aforementioned <code>Show</code> constraint: <code>left :: Show a =&gt; Tree a -&gt; String</code>, and the body would be exactly as you have it.</p>\n\n<p>If you want a function that takes a tree and returns the left side of it <em>as a Tree</em>, you should keep the type signature you have, but remove the <code>show</code> from the body (since you aren't converting to a <code>String</code>): <code>left (Nod x e d) = e</code></p>\n"}], "owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489633838, "creation_date": 1489543789, "question_id": 42799919, "link": "https://stackoverflow.com/questions/42799919/how-can-i-call-a-show-instace-to-print-a-binary-tree", "title": "How can I call a show instace to print a binary tree?", "body": "<p>I'm trying construct a function to print a binary tree, so I did this:</p>\n\n<pre><code>instance Show a =&gt; Show (Tree a) where\n  show Null = \"_\"\n  show (Nod x e d) = \"(\" ++ show x ++ \" \" ++ show e ++ \" \" ++ show d ++ \")\"\n\n\nleft :: Tree a -&gt; Tree a\nleft (Nod x e d) = show e\n</code></pre>\n\n<p>but I'm receiving this message:</p>\n\n<blockquote>\n<pre><code>Couldn't match type `[Char]' with `Tree a'\nExpected type: Tree a\n  Actual type: String\nIn the return type of a call of `show'\nIn the expression: show e\nIn an equation for `left': left (Nod x e d) = show e Failed, modules loaded: none.\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1489534912, "post_id": 42798257, "comment_id": 72711751, "body": "Adding an item to the end of a list is a fine exercise, but usually you shouldn&#39;t do it in real Haskell programs. It&#39;s expensive, and indicates you are building your list in the wrong order. There is usually a better approach."}, {"owner": {"reputation": 83, "user_id": 7318595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lGy5r.jpg?s=128&g=1", "display_name": "Darius", "link": "https://stackoverflow.com/users/7318595/darius"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489536631, "post_id": 42798257, "comment_id": 72712231, "body": "It`s only an exercise for college :)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1489533301, "creation_date": 1489533301, "answer_id": 42798280, "question_id": 42798257, "link": "https://stackoverflow.com/questions/42798257/add-a-element-at-the-end-of-list-in-haskell/42798280#42798280", "title": "Add a element at the end of list in Haskell", "body": "<p>Compare:</p>\n\n<pre><code>func a (x:xs) = x : func a (x:xs)\n        --      ^^^^^^^^^^^^^^^^^  returns a list\nfunc a [] = a\n        --  ^  returns a non-list\n</code></pre>\n\n<p>Hence the type error. You probably want <code>[a]</code> or <code>a : []</code> instead.</p>\n\n<p>(Further, the recursive call is wrong, since you pass again the whole list <code>x:xs</code> in it. The list should get smaller else you will never reach the base case.)</p>\n"}, {"tags": [], "owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "is_accepted": true, "score": 5, "last_activity_date": 1489535589, "last_edit_date": 1489535589, "creation_date": 1489534403, "answer_id": 42798479, "question_id": 42798257, "link": "https://stackoverflow.com/questions/42798257/add-a-element-at-the-end-of-list-in-haskell/42798479#42798479", "title": "Add a element at the end of list in Haskell", "body": "<p>You need to understand that what's happening with your definitions of the functions on the left side of the equals sign is \"pattern matching\".</p>\n\n<p>With the following statement, you're basically saying</p>\n\n<pre><code>func a [] = a\n...\n</code></pre>\n\n<p>I want first to accept an element of any type, i.e. <code>a</code>, as first parameter, and an empty list as the second parameter, i.e. <code>[]</code>. If that's the case, you want to return <code>a</code>. The problem is, you want to return a list <code>[a]</code> (you will see later in this answer why).</p>\n\n<p>With the second part of your function definition (this means that the first \"pattern\" has not matched against your inputs) you're saying: I accept an element of any type, i.e. <code>a</code>, and a non-empty list, i.e. <code>(x:xs)</code>. <code>(x:xs)</code> is a way to say: ok, I have a list and <code>x</code> is the first element of that list. The rest of the list I call <code>xs</code>, which could be empty; in that case, your original list would be a list of size one, i.e. just <code>[x]</code>.</p>\n\n<pre><code>...\nfunc a (x:xs) = x : func a (x:xs)\n</code></pre>\n\n<p>What you return if the pattern is matched is</p>\n\n<pre><code>... = x : func a (x:xs)\n</code></pre>\n\n<p>which means that you're taking the first element of the list passed as the second parameter (i.e. <code>x</code>) and prepending it to the result of <code>func a (x:xs)</code>. </p>\n\n<p>Given this description of your problem, here's a possible solution:</p>\n\n<pre><code>func a [] = [a]\nfunc a (x:xs) = x : func a xs\n</code></pre>\n\n<p>I would like to note two things here. In the first pattern, i.e <code>func a [] = [a]</code>, I return a list, i.e. <code>[a]</code>. In the second pattern, I pass <code>xs</code> to <code>func</code>, i.e. <code>func a xs</code>. In both cases I return a list!</p>\n\n<p>Why does this work? Lets have a look at an example. Let's say you call <code>func</code> like <code>func 3 [1, 2]</code>. Then this is what would happen.</p>\n\n<p>Since <code>[1, 2]</code> is not an empty list, you do not match against the first pattern, so let's see the second; yes, we match against the second. Now we have that <code>a = 3</code>, <code>x = 1</code> (the start of the list) and <code>xs = [2]</code>. So we then have <code>1 : func 3 [2]</code>. So we recurse! We now have <code>a = 3</code> (same as before), <code>x = 2</code> and <code>xs = []</code> (i.e. an empty list). So we proceed with the function body and we do <code>2 : func 3 []</code>. Finally, <code>func 3 []</code> matches against the first pattern, and you return <code>[3]</code>. But to what? Well, to <code>2 : [3]</code>, which returns to what? To <code>1 : 2 : [3]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14961085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a894aa3f66ea0b7c7a136d8d22c253?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Toma", "link": "https://stackoverflow.com/users/14961085/filip-toma"}, "is_accepted": false, "score": 0, "last_activity_date": 1610045683, "creation_date": 1610045683, "answer_id": 65618337, "question_id": 42798257, "link": "https://stackoverflow.com/questions/42798257/add-a-element-at-the-end-of-list-in-haskell/65618337#65618337", "title": "Add a element at the end of list in Haskell", "body": "<p>How about a simple, non-recursive approach:</p>\n<pre><code>func num xs = xs ++ [num]\n</code></pre>\n<p>Or if you insist on recursion:</p>\n<pre><code>func num []     = [num]\nfunc num (x:xs) = x : func num xs\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7318595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lGy5r.jpg?s=128&g=1", "display_name": "Darius", "link": "https://stackoverflow.com/users/7318595/darius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24527, "favorite_count": 0, "accepted_answer_id": 42798479, "answer_count": 3, "score": 2, "last_activity_date": 1610045683, "creation_date": 1489533157, "question_id": 42798257, "link": "https://stackoverflow.com/questions/42798257/add-a-element-at-the-end-of-list-in-haskell", "title": "Add a element at the end of list in Haskell", "body": "<p>i'm a beginner in Haskell and i'm trying to add an element at the end of a list.</p>\n\n<p>I enter a list like [1,2,3,4] and a number 10. I want an output like this [1,2,3,4,10].</p>\n\n<p>My code:</p>\n\n<pre><code>func a [] = a\nfunc a (x:xs) = x : func a (x:xs)\n</code></pre>\n\n<p>But i'm getting that error:</p>\n\n<pre><code>Non type-variable argument in the constraint: Num [a]\n(Use FlexibleContexts to permit this)\nWhen checking that \u2018it\u2019 has the inferred type\nit :: forall a. (Num a, Num [a]) =&gt; [a]\n</code></pre>\n\n<p>Can anyone help with a explanation ?</p>\n"}, {"tags": ["haskell", "dictionary", "syntax", "extract", "record"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489532863, "post_id": 42798187, "comment_id": 72711104, "body": "Look up destructuring. You can bind all the record fields in the parameter list of the function using it."}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1489538558, "last_edit_date": 1489538558, "creation_date": 1489533292, "answer_id": 42798277, "question_id": 42798187, "link": "https://stackoverflow.com/questions/42798187/how-to-extract-multiple-values-from-a-record-haskell/42798277#42798277", "title": "How to extract multiple values from a record haskell", "body": "<p>If I understand what you are asking correctly, you just need to create the right function to map with</p>\n\n<pre><code>renderPerson :: Person -&gt; String\nrenderPerson p = \"First name: \" ++ fname p ++ \"\\nLast name: \" ++ lname p\n</code></pre>\n\n<p>then map with that:</p>\n\n<pre><code>map renderPerson listOfPerson\n</code></pre>\n\n<p>which will give you a list of <code>String</code>s.</p>\n\n<p>But maybe you wanted a list of tuples instead?</p>\n\n<pre><code>personTuple :: Person -&gt; (String, String, Int)\npersonTuple p = (fname p, lname p, age p)\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>map personTuple listOfPerson\n</code></pre>\n\n<p>which will give you a <code>[(String, String, Int)]</code>.  There are a variety of syntactic-sugary ways to do this, such as:</p>\n\n<ul>\n<li><em>lambda</em>: <code>map (\\p -&gt; (fname p, lname p, age p)) listOfPerson</code></li>\n<li><em>record wildcards</em> (requires <code>RecordWildCards</code> extension): <code>personTuple Person{..} = (fname, lname, age)</code></li>\n<li><em>applicative</em>: <code>map ((,,) &lt;$&gt; fname &lt;*&gt; lname &lt;*&gt; age) listOfPerson</code></li>\n</ul>\n\n<p>but it's all the same in the end.</p>\n"}], "owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 1, "accepted_answer_id": 42798277, "answer_count": 1, "score": 2, "last_activity_date": 1489538558, "creation_date": 1489532784, "last_edit_date": 1489533486, "question_id": 42798187, "link": "https://stackoverflow.com/questions/42798187/how-to-extract-multiple-values-from-a-record-haskell", "title": "How to extract multiple values from a record haskell", "body": "<p>Currently, I am using list comprehension to go through a list of my custom data type</p>\n\n<pre><code>data Person = Person{ fname :: String\n                    , lname :: String\n                    , age :: Int\n                    , siblings :: [String]\n                    }\n</code></pre>\n\n<p>The issue is currently I am doing \n<code>[\"First name: \" ++ fname z ++ \"\\n\" ++ \"Last name: \" ++  lname z]</code> where each <code>z</code> is a <code>Person</code> from a list of <code>Person</code>. </p>\n\n<p>I've tried using something like</p>\n\n<pre><code>fas :: [Person] -&gt; [String]\nfas listOfPerson = map fname listOfPerson\n</code></pre>\n\n<p>but how can I use map to get multiple fields from the record?\nfrom what I understand map takes a function and a list and applies that function to every element in the list, making a new list. Because I want the output to be a single list, I only need to call <code>map</code> once, or somehow combine multiple map calls into a single list where all the information is in order?</p>\n\n<p>e.g something like this?</p>\n\n<pre><code>fas :: [Person] -&gt; [String]\nfas listOfPerson = map (fname, lname, age) listOfPerson\n</code></pre>\n\n<p>thank you </p>\n"}, {"tags": ["haskell", "types", "type-conversion", "typeclass"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1489529452, "post_id": 42796649, "comment_id": 72709652, "body": "Please post the exact code that lead to this error. Don&#39;t take shortcuts during minimization and guess which code. Verify, by putting it in a separate file and checking that it does, indeed, give you the error you expect."}, {"owner": {"reputation": 1360, "user_id": 1594886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cda9c379816b5fa2094c09c3853168?s=128&d=identicon&r=PG", "display_name": "tauli", "link": "https://stackoverflow.com/users/1594886/tauli"}, "edited": false, "score": 0, "creation_date": 1489534834, "post_id": 42796649, "comment_id": 72711726, "body": "You can probably just remove the type signature from you function and ask ghc for the most general type by using ghci, loading your program and typing <code>:t readList</code>"}, {"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1489538534, "post_id": 42796649, "comment_id": 72712746, "body": "edited question to include more code as the original set was not, in fact, a minimal reproducible example"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1489555378, "post_id": 42796649, "comment_id": 72716907, "body": "@AbrahamP You still have not succeeded in providing the code that matches the presented error."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489570427, "post_id": 42796649, "comment_id": 72724302, "body": "There&quot;s simply no way to not care what type it is."}], "answers": [{"comments": [{"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1489578541, "post_id": 42805703, "comment_id": 72730014, "body": "but what about Characters, or custom comparable things? Say I wanted a function that could read both:  &#39;a b c d e f&#39; into [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;] and &#39;1 2 3 4 5&#39; into [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;]"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 1, "creation_date": 1489597199, "post_id": 42805703, "comment_id": 72744417, "body": "This answer addresses the syntax error in the presented code.  However, the presented code does not match the question or the error message.  @AbrahamP You simply can not read any type of data to be determined at run-time.  Types must be statically known at compile time."}, {"owner": {"reputation": 343, "user_id": 5085294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TOFvi.png?s=128&g=1", "display_name": "Christof Schramm", "link": "https://stackoverflow.com/users/5085294/christof-schramm"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1489607372, "post_id": 42805703, "comment_id": 72750498, "body": "@Thomas you are of course right. But in the specific code of the question, the above modification will still work out fine. I&#39;ll edit the answer to include your remark."}], "tags": [], "owner": {"reputation": 343, "user_id": 5085294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TOFvi.png?s=128&g=1", "display_name": "Christof Schramm", "link": "https://stackoverflow.com/users/5085294/christof-schramm"}, "is_accepted": false, "score": 0, "last_activity_date": 1489607567, "last_edit_date": 1489607567, "creation_date": 1489570110, "answer_id": 42805703, "question_id": 42796649, "link": "https://stackoverflow.com/questions/42796649/read-list-of-unknown-type-from-user-input-haskell/42805703#42805703", "title": "Read list of unknown type from user input Haskell:", "body": "<p>What you did wrong is in this line:</p>\n\n<pre><code>readList :: (Read a, Int a) -&gt; IO [a]\n</code></pre>\n\n<p>What you probably want to get at with <code>(Read a, Int a)</code> is a type class constranit for the type <code>a</code>, meaning you want it to be readable and you want it to be some sort of integer.</p>\n\n<p>Firstly you wrote your constraint wrong. A typeclass constraint is given before a <code>=&gt;</code> not a <code>-&gt;</code>. Secondly <code>Int</code> is not a type class. Maybe try using <code>Integral</code>?</p>\n\n<p>So your type signature should look like this:</p>\n\n<pre><code>readList :: (Read a, Integral a) =&gt; IO [a]\n</code></pre>\n\n<p><strong>EDIT:</strong> A caveat is, however, that the <code>a</code> in the type signature has to be decided at compile time. In the first example in your question it would work out because the type of <code>printNaive</code> fixes <code>a</code> to be <code>Int</code>. That is not generally the case, however.</p>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494273994, "creation_date": 1489525960, "last_edit_date": 1494273994, "question_id": 42796649, "link": "https://stackoverflow.com/questions/42796649/read-list-of-unknown-type-from-user-input-haskell", "title": "Read list of unknown type from user input Haskell:", "body": "<p>Say I have the following function:</p>\n\n<pre><code>readList :: IO [Int]\nreadList = do\n  putStrLn \"Please enter the list as a string\"\n  putStrLn \"Example: input of '1 2 3 4 5' will map to [1,2,3,4,5]\"\n  line &lt;- getLine\n  return $ map read $ words line\n\n printNaive :: [Int] -&gt; IO ()                                                                                                                                                         \n printNaive xs = putStrLn \"The maximum surpasser count is:\" &gt;&gt; putStrLn \"0\"\n\n main :: IO ()\n main = readList &gt;&gt;= printNaive\n</code></pre>\n\n<p>This function works as expected. Now lets say I was going to extend this code to be more generic, and read in a line of any type of thing as a list:</p>\n\n<pre><code>readList :: (Read a, Int a) -&gt; IO [a]\nreadList = do\n  putStrLn \"Please enter the list as a string\"\n  putStrLn \"Example: input of '1 2 3 4 5' will map to [1,2,3,4,5]\"\n  line &lt;- getLine\n  return $ map read $ words line\n\n printNaive :: (Eq a) =&gt; [a] -&gt; IO ()                                                                                                                                                         \n printNaive xs = putStrLn \"The maximum surpasser count is:\" &gt;&gt; putStrLn \"0\"\n\n main :: IO ()\n main = readList &gt;&gt;= printNaive\n</code></pre>\n\n<p>This fails with:</p>\n\n<pre><code> Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018Lib.readList\u2019\n      prevents the constraint \u2018(Read a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance Read Ordering -- Defined in \u2018GHC.Read\u2019\n        instance Read Integer -- Defined in \u2018GHC.Read\u2019\n        instance Read a =&gt; Read (Maybe a) -- Defined in \u2018GHC.Read\u2019\n        ...plus 22 others\n        ...plus four instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n</code></pre>\n\n<p>How would I go about writing this code, given I really don't care what type of thing it is as long as it conforms to <code>Eq</code>. </p>\n\n<p>Additionally, say I wanted to provide a facility to specify what type the list is going to contain.  (through another getLine say).</p>\n\n<p>How would I extract a type from <code>getLine</code>, and how would I then cast every element in the <code>map read $ words line</code> to that particular type.</p>\n"}, {"tags": ["haskell", "memory", "memory-leaks", "profiling"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1489508829, "post_id": 42791389, "comment_id": 72697293, "body": "Run under <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\">valgrind</a> ? See also: <a href=\"http://stackoverflow.com/q/24939604/253056\">this question</a>."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 1, "creation_date": 1489521951, "post_id": 42791389, "comment_id": 72705602, "body": "Take a look at weigh package: <a href=\"https://www.stackage.org/package/weigh\" rel=\"nofollow noreferrer\">stackage.org/package/weigh</a>"}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1489532358, "post_id": 42791389, "comment_id": 72710887, "body": "Is there a reason you cannot compile your program with profiling enabled? It might be easier to overcome that issue, rather than figuring out a different way of looking for space leaks."}, {"owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "edited": false, "score": 1, "creation_date": 1489627126, "post_id": 42791389, "comment_id": 72758618, "body": "The main reason I&#39;m running into this is that one of the packages I depend on indirectly (<code>ghc-heap-view</code>, IIRC) can&#39;t be compiled with profiling."}], "owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1489508768, "creation_date": 1489508768, "question_id": 42791389, "link": "https://stackoverflow.com/questions/42791389/what-can-i-do-to-debug-memory-usage-without-compiling-with-profiling", "title": "What can I do to debug memory usage without compiling with profiling?", "body": "<p>Let's say for some reason I can't recompile my program with profiling. What can I do to try to pinpoint the source of memory overconsumption? I've run with RTS <code>-S</code>and determined that memory usage is steadily growing beyond what is expected.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489504089, "post_id": 42789595, "comment_id": 72693596, "body": "Why use <code>Err</code>? That&#39;s what <code>Maybe</code> is for, and you have a whole library to help you if you use it."}, {"owner": {"reputation": 1, "user_id": 7150966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4773ec0c50ec1823e575de6ded5aff6f?s=128&d=identicon&r=PG&f=1", "display_name": "NoahSM1993", "link": "https://stackoverflow.com/users/7150966/noahsm1993"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489504593, "post_id": 42789595, "comment_id": 72693989, "body": "I&#39;m new to Haskell and wish to practice using polymorphic types"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489504864, "post_id": 42789595, "comment_id": 72694204, "body": "Oh, ok. Just know your Err type is a minimal version of Haskell&#39;s Maybe. In &quot;real code&quot; opt to use Maybe instead."}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1489512503, "post_id": 42789595, "comment_id": 72699897, "body": "You want to return an error when n is negative and when n is bigger than the lenght of the array, right? So you can star considering those cases"}], "answers": [{"tags": [], "owner": {"reputation": 1360, "user_id": 1594886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cda9c379816b5fa2094c09c3853168?s=128&d=identicon&r=PG", "display_name": "tauli", "link": "https://stackoverflow.com/users/1594886/tauli"}, "is_accepted": false, "score": 0, "last_activity_date": 1489534532, "creation_date": 1489534532, "answer_id": 42798503, "question_id": 42789595, "link": "https://stackoverflow.com/questions/42789595/haskell-splitat-function-using-error-handler/42798503#42798503", "title": "Haskell splitAt function using Error Handler", "body": "<p>This is how i would implement this. The Functor instance is for convenience to avoid something like <code>case ... of</code> in the <code>splitAt</code> function, and would work exactly the same with <code>Maybe</code>. Since your version of <code>splitAt</code> can return different values you can't simply modify the example with the <code>where</code> you posted since modifying the pattern match to something like <code>Good (zs',zs'') = ...</code> would raise an exception in case a <code>Bad</code> was returned and vice versa. </p>\n\n<pre><code>  data Err e = Bad|Good e deriving (Eq, Show)\n\n  instance Functor Err where\n    fmap _ Bad      = Bad\n    fmap f (Good a) = Good (f a)\n\n  splitAt' 0 zs = Good ([],zs)\n  splitAt' n [] = Bad\n  splitAt' n (z:zs) \n    | n &gt; 0     = fmap (\\(zs',zs'') -&gt; (z:zs',zs'')) (splitAt' (n-1) zs)\n    | otherwise = Bad\n</code></pre>\n\n<p>I hope this helps. Feel free to ask if something is unclear.</p>\n"}], "owner": {"reputation": 1, "user_id": 7150966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4773ec0c50ec1823e575de6ded5aff6f?s=128&d=identicon&r=PG&f=1", "display_name": "NoahSM1993", "link": "https://stackoverflow.com/users/7150966/noahsm1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489534532, "creation_date": 1489503969, "question_id": 42789595, "link": "https://stackoverflow.com/questions/42789595/haskell-splitat-function-using-error-handler", "title": "Haskell splitAt function using Error Handler", "body": "<p>I am attempting to write a function in Haskell that splits a list into two at the point after the nth element. </p>\n\n<p>I have the following code so far: </p>\n\n<pre><code>data Err e = Bad|Good e\n\nsplitAt:: Int -&gt; [a] -&gt; Err(([a],[a]))\nsplitAt 0 zs = Good(([], zs))\nsplitAt n _ = Bad\n</code></pre>\n\n<p>I am not sure how to apply the error message to the following case:</p>\n\n<pre><code>splitAt n (z:zs) | n &gt; 0 = (z:zs', zs'') where (zs', zs'') = split (n-1) zs\n</code></pre>\n\n<p>The function should also return the error message \"Bad\" if the number is greater than the length of the list, or if the number is negative. E.g</p>\n\n<pre><code>splitAt 6 [1,2,3,] = Bad\nsplitAt (-3) [1,2,3] = Bad\n</code></pre>\n\n<p>Any advice would be greatly appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489501769, "post_id": 42788586, "comment_id": 72691664, "body": "Please write questions in a readable and comprehensible manner. Read the StackOverflow  help for some guidance."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7709373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ab9227f49b7e6224e34156fda26070?s=128&d=identicon&r=PG&f=1", "display_name": "javaNinja", "link": "https://stackoverflow.com/users/7709373/javaninja"}, "edited": false, "score": 0, "creation_date": 1489522335, "post_id": 42791121, "comment_id": 72705814, "body": "yes i was using length . filter earlier but i was told not to use it and try and do it with non haskell library functions supposably and thanks for the help :)"}], "tags": [], "owner": {"reputation": 271, "user_id": 2458612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e41d9638641eea1f41208113670289?s=128&d=identicon&r=PG", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/2458612/gerhard"}, "is_accepted": false, "score": 2, "last_activity_date": 1489841453, "last_edit_date": 1489841453, "creation_date": 1489508083, "answer_id": 42791121, "question_id": 42788586, "link": "https://stackoverflow.com/questions/42788586/whats-the-advantage-of-using-guards-in-haskell/42791121#42791121", "title": "whats the advantage of using guards in Haskell?", "body": "<p>A guard is haskell's most general <strong>conditional statement</strong>, like if/then/else in other languages.</p>\n\n<p>Your code shows a straight forward implementation of counting contents of a list equal to a given parameter. This is a good example to learn how haskell's recursion works.</p>\n\n<p>An alternative implementation would be</p>\n\n<pre><code>count_instances :: Int -&gt; [Int] -&gt; Int\ncount_instances i = length . filter (==i)\n</code></pre>\n\n<p>that reuses already existing functions from the Prelude module. This is shorter and probably more readable.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489522576, "post_id": 42792121, "comment_id": 72705978, "body": "Minor point: there&#39;s no need to increase the indentation of the last if-then-else chain. Such chain is a relatively common pattern in many imperative languages, and is frequently written without the staircase indentation. Being a common idiom (elsewhere), it&#39;s not terribly unreadable if indented simply."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1489510787, "creation_date": 1489510787, "answer_id": 42792121, "question_id": 42788586, "link": "https://stackoverflow.com/questions/42788586/whats-the-advantage-of-using-guards-in-haskell/42792121#42792121", "title": "whats the advantage of using guards in Haskell?", "body": "<p>A guard can be a way to write only one half of an <code>if-then-else</code> expression; you can omit the <code>else</code> and have a partial function.</p>\n\n<pre><code>-- Leave the function undefined for x /= y\nfoo x y | x == y = ...\n</code></pre>\n\n<p>You can do the same with a <code>case</code> statement, but it's more verbose</p>\n\n<pre><code>foo x y = case x == y of\n          True -&gt; ...\n</code></pre>\n\n<p>It's also easier to list several unrelated conditions as a set of alternatives than it is with a nested <code>if-then-else</code> or <code>case</code> expressions.</p>\n\n<pre><code>foo x y | p1 x y = ...\nfoo x y | p2 x y = ...\nfoo x y | p3 x y = ...\nfoo x y = ...\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>foo x y = if p1 x y then ... \n          else (if p2 x y then ...\n                else (if p3 x y then ... else ...))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489523002, "post_id": 42795684, "comment_id": 72706242, "body": "Interesting. For what is worth, in my own coding style, I forbid myself using <code>where</code> after guards (or anything else which spans over multiple lines), since I find such code harder to read -- perhaps I am too used to look <i>up</i> to see where an identifier was defined. So, I consider the ability of using a <code>where</code> after guards a disadvantage :-P"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489523458, "post_id": 42795684, "comment_id": 72706511, "body": "@chi while I respect your favorite choice, I recommend reading SJP&#39;s paper where he introduces and motivates guards. Even if you don&#39;t like it, you cannot but admit that a where clause can reduce code duplication and is soetimes the only way to do so. Also, better editor support can help with the &quot;where is it defined&quot; problem."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489527331, "post_id": 42795684, "comment_id": 72708635, "body": "Well, sometimes I use <code>let</code> followed by <code>case</code>+guards. Multi-way <code>if</code> is newer, but I should consider using it more. I know my choice is not as popular as the style above. I wish SPJ went for <code>where</code> before guards :) or some other &quot;define before you use&quot; syntax. Should an occasion arise where there&#39;s no other reasonably simple alternative, I&#39;ll probably use <code>where</code> after guards, I guess. I&#39;m not extremely dogmatic about it, but enough so to look hard for alternatives."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489535339, "post_id": 42795684, "comment_id": 72711868, "body": "You could obtain a similar effect by pulling the shared recursive call out of the guard and into common code, which may be more palatable to you? <code>count_instances x (t:ts) = count_instances x ts + this where {this | x == t = 1 | otherwise = 0}</code>"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 2, "last_activity_date": 1489522411, "creation_date": 1489522411, "answer_id": 42795684, "question_id": 42788586, "link": "https://stackoverflow.com/questions/42788586/whats-the-advantage-of-using-guards-in-haskell/42795684#42795684", "title": "whats the advantage of using guards in Haskell?", "body": "<p>Patterns with guards are probably the most concise way to write code that otherwise would require nested case/if expressions.</p>\n\n<p>Not the least advantage is that a <strong>where</strong> clause applies to all the guards right hand sides. This is why your example could be even more concise:</p>\n\n<pre><code>count_instances :: (Int)-&gt;([Int])-&gt;Int \ncount_instances x [] = 0 \ncount_instances x (t:ts) \n    | x==t = 1+rest \n    | otherwise = rest\n    where rest = count_instances x ts\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7709373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ab9227f49b7e6224e34156fda26070?s=128&d=identicon&r=PG&f=1", "display_name": "javaNinja", "link": "https://stackoverflow.com/users/7709373/javaninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1489841453, "creation_date": 1489501394, "last_edit_date": 1489510090, "question_id": 42788586, "link": "https://stackoverflow.com/questions/42788586/whats-the-advantage-of-using-guards-in-haskell", "title": "whats the advantage of using guards in Haskell?", "body": "<pre><code>count_instances :: (Int)-&gt;([Int])-&gt;Int \ncount_instances x [] = 0 \ncount_instances x (t:ts) \n    | x==t = 1+(count_instances x ts) \n    | otherwise = count_instances x ts\n</code></pre>\n\n<p>i just want to know whats so good about using guards in this Question ?</p>\n"}, {"tags": ["haskell", "range"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489522262, "post_id": 42788070, "comment_id": 72705764, "body": "IMO, <i>step</i> is better. Using <i>then</i> sometimes can lead to unpleasant surprises when floating points are involved: <a href=\"http://stackoverflow.com/questions/42773864/function-returns-zero-if-parameter-has-more-than-7-zeros\" title=\"function returns zero if parameter has more than 7 zeros\">stackoverflow.com/questions/42773864/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1489500929, "post_id": 42788231, "comment_id": 72690971, "body": "Another really key point is that it&#39;s not restricted to numeric types."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1489501315, "last_edit_date": 1489501315, "creation_date": 1489500488, "answer_id": 42788231, "question_id": 42788070, "link": "https://stackoverflow.com/questions/42788070/why-does-haskells-range-syntax-use-first-and-then-rather-than-first-and-step/42788231#42788231", "title": "Why Does Haskell&#39;s Range Syntax use First and Then rather than First and Step?", "body": "<p>I agree, IMO start-step-end would have been the better convention. However, start-then-end is more commonly found in pure maths contexts, and that's Haskell's heritage.</p>\n\n<p>Note that you can very easily achieve by hand</p>\n\n<ul>\n<li><p>Start-step-end:</p>\n\n<pre><code>takeWhile (&lt;end+step/2) $ iterate (+step) start\n</code></pre></li>\n<li><p>Start-step-count:</p>\n\n<pre><code>take count $ iterate (+step) start\n</code></pre></li>\n</ul>\n\n<p>Whereas start-then-end requires to first compute the step by hand</p>\n\n<pre><code>let step = then - start\nin takeWhile (&lt; end+step/2) $ iterate (+step) start\n</code></pre>\n\n<p>so it kind of makes sense to add syntactic sugar / standard functions for the expression that's harder to implement manually.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489521905, "post_id": 42788505, "comment_id": 72705575, "body": "Agreed, even if I believe <code>Enum</code> types should be isomorphic to a segment of <code>Int</code>, since we have <code>toEnum &#47; fromEnum</code>, so an <code>Int</code> stepping should be well defined. Making floating point types to be <code>Enum</code>s looks as a mistake to me. (Or, alternatively, those two functions should be moved to another class)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489532695, "post_id": 42788505, "comment_id": 72711037, "body": "@chi Yeah, there are definitely times I want a type to be enumerable but don&#39;t have a good isomorphism to Int. I&#39;d rather <code>toEnum</code> / <code>fronEnum</code> were in a different class; you can&#39;t really use them sensibly while being polymorphic in Enum, you have to know more about the specific type in use. But mostly I find I only use Enum stuff when I do know what I&#39;m working with, so it&#39;s not really critical."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 8, "last_activity_date": 1489501178, "creation_date": 1489501178, "answer_id": 42788505, "question_id": 42788070, "link": "https://stackoverflow.com/questions/42788070/why-does-haskells-range-syntax-use-first-and-then-rather-than-first-and-step/42788505#42788505", "title": "Why Does Haskell&#39;s Range Syntax use First and Then rather than First and Step?", "body": "<p>Note that e.g. Python's range specifier is a <em>function</em>:</p>\n\n<pre><code>&gt;&gt;&gt; range(1, 12, 2)\n[1, 3, 5, 7, 9, 11]\n</code></pre>\n\n<p>Haskell is aiming to provide syntax that literally looks like you might write out the list for another human, writing <code>..</code> instead of the \"obvious\" pattern:</p>\n\n<pre><code>ghci&gt; [1, 3 .. 11]\n[1,3,5,7,9,11]\n</code></pre>\n\n<p>Another point (raised by Carl in a comment on leftaroundabout's answer) is that the sequence syntax can be used on non-numeric types, where there isn't such an easy way of writing a \"step\":</p>\n\n<pre><code>ghci&gt; ['a', 'f' .. 'z']\n\"afkpuz\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489521812, "post_id": 42790853, "comment_id": 72705516, "body": "An alternative would be to say <code>[&#39;A&#39;..&#39;Z&#39;, succ . succ . succ]</code> for ` [&#39;A&#39;, &#39;D&#39; .. &#39;Z&#39;]` but it is of course harder to read and can more easily be written with <code>iterate</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489522084, "post_id": 42790853, "comment_id": 72705666, "body": "<code>Enum</code> is really weird, since <code>toEnum  . (+ k) . fromEnum</code> is well typed, hence an <code>Int</code> stepping seems always reasonable. Floating point types, IMO should not have been made into <code>Enum</code> (or otherwise the <code>toEnum,fromEnum</code> should belong to another class)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489536957, "post_id": 42790853, "comment_id": 72712322, "body": "@chi <code>toEnum . (+k) . fromEnum</code> may be well-typed; but that doesn&#39;t mean it expresses all the behaviors you want. For that reason, I think this answer&#39;s example of <code>Float</code>/<code>Double</code> is a good one: there are steps that are currently supported that do not fit into your proposed pattern."}], "tags": [], "owner": {"reputation": 40039, "user_id": 699224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4feb08afcd7c57acb72bd49fc2bf834d?s=128&d=identicon&r=PG", "display_name": "DNA", "link": "https://stackoverflow.com/users/699224/dna"}, "is_accepted": false, "score": 5, "last_activity_date": 1489527290, "last_edit_date": 1489527290, "creation_date": 1489507264, "answer_id": 42790853, "question_id": 42788070, "link": "https://stackoverflow.com/questions/42788070/why-does-haskells-range-syntax-use-first-and-then-rather-than-first-and-step/42790853#42790853", "title": "Why Does Haskell&#39;s Range Syntax use First and Then rather than First and Step?", "body": "<p>Just building on what Ben and Carl said:</p>\n\n<p>the functions defined in Enum are polymorphic, e.g.</p>\n\n<pre><code>\u03bb&gt; :t enumFromThenTo\nenumFromThenTo :: Enum a =&gt; a -&gt; a -&gt; a -&gt; [a]\n</code></pre>\n\n<p>and by defining them as \"first, second, last\", we can use the same polymorphic type parameter <code>a</code> for all the arguments!</p>\n\n<p>If we defined them as \"first, last, step\", then the <code>step</code> parameter might have a different type from the other two.</p>\n\n<ul>\n<li>For an integer sequence, the step is also an integer - no problem.</li>\n<li>For a character sequence, the step is again an integer - so maybe we could fix the type of <code>step</code> to be some integral type? (But which one?)</li>\n<li>But no - for a float sequence, the step also needs to be a float!</li>\n</ul>\n\n<p>So we'd need (I think!) to add another type variable to the Enum typeclass, which would make it a lot more complex, and (probably - haven't checked) needs a GHC extension rather than standard Haskell.</p>\n"}], "owner": {"reputation": 926, "user_id": 1486968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvBqy.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/1486968/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 42788505, "answer_count": 3, "score": 7, "last_activity_date": 1489527290, "creation_date": 1489500085, "last_edit_date": 1489509540, "question_id": 42788070, "link": "https://stackoverflow.com/questions/42788070/why-does-haskells-range-syntax-use-first-and-then-rather-than-first-and-step", "title": "Why Does Haskell&#39;s Range Syntax use First and Then rather than First and Step?", "body": "<p>I've just started learning Haskell, and was surprised by the behaviour of ranges.</p>\n\n<p>I am aware that <code>[1, 2 .. 10]</code> is syntactic sugar for <code>enumFromThenTo 1 2 10</code>. </p>\n\n<p>From other programming languages, (for instance Python) I'm used to ranges being specified with <em>first</em>, <em>last</em> and <em>step</em> arguments, such that Haskell's <em>then</em> is equivalent to <em>first+step</em> in Python.</p>\n\n<p>Why does Haskell use <em>then</em>, rather than <em>step</em> to define the spacing between values in the sequence?</p>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489495695, "post_id": 42786408, "comment_id": 72686882, "body": "<code>fas database = map title database</code> or just <code>fas = map title</code> would be preferable to a list comprehension here."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "edited": false, "score": 1, "creation_date": 1489495756, "post_id": 42786450, "comment_id": 72686923, "body": "&quot;Why? Because you map every film to its title.&quot; - This made perfect sense, thank you SO MUCH!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1489496101, "last_edit_date": 1489496101, "creation_date": 1489495633, "answer_id": 42786450, "question_id": 42786408, "link": "https://stackoverflow.com/questions/42786408/haskell-couldnt-match-type-char-with-char-list-comprehension/42786450#42786450", "title": "Haskell Couldn&#39;t match type \u2018[Char]\u2019 with \u2018Char\u2019 list comprehension", "body": "<p>If I understand what you want to do correctly, the signature should be:</p>\n\n<pre><code>fas:: [Film] -> <b>[</b>String<b>]</b></code></pre>\n\n<p>Indeed, a <strong>list of strings</strong>.</p>\n\n<p>Why? Because you map <strong>every</strong> film to its title. Now since a <strong>title is a <code>String</code></strong>, the result is a list of <code>String</code>s.</p>\n\n<p>The <strong>compiler is actually complaining in the other way than you interpret it</strong>: since <code>type String = [Char]</code>, you wrote implicitly:</p>\n\n<pre><code>fas :: [Film] -&gt; [Char] -- incorrect\n</code></pre>\n\n<p>whereas it should be:</p>\n\n<pre><code>fas :: [Film] -&gt; [[Char]]\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 42786450, "answer_count": 1, "score": 1, "last_activity_date": 1489496101, "creation_date": 1489495509, "last_edit_date": 1489495672, "question_id": 42786408, "link": "https://stackoverflow.com/questions/42786408/haskell-couldnt-match-type-char-with-char-list-comprehension", "title": "Haskell Couldn&#39;t match type \u2018[Char]\u2019 with \u2018Char\u2019 list comprehension", "body": "<p>So I'm trying to go through a list of films and output the title of each film, the compiler is saying that is couldn't match type <code>[Char]</code> with <code>Char</code>.\nThe thing is I want <code>[Char]</code> (A string) and not <code>Char</code>?? I'm confused as to why it wants a character and not a string?</p>\n\n<pre><code>fas:: [Film] -&gt; String\nfas database = [title x | x &lt;- database]\n\ntest.hs:55:27: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019\n      Expected type: Char\n        Actual type: String\n    \u2022 In the expression: title x\n      In the expression: [title x | x &lt;- database]\n      In an equation for \u2018fas\u2019:\n\n          fas database = [title x | x &lt;- database]\n</code></pre>\n\n<p>Any help would be greatly appreciated, I've probably worded this poorly which hasn't helped me when trying to search other people have the same problem :/</p>\n\n<p>regards, a novice</p>\n"}, {"tags": ["haskell", "design-patterns", "interface"], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1489492441, "post_id": 42785133, "comment_id": 72684648, "body": "a little typo, it&#39;s supposed to be <code>instance Translation Spanish where</code> instead of <code>instance Spanish Translation where</code>"}, {"owner": {"reputation": 311, "user_id": 3750254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ec61965b80e6551eaba49bdc62dba5?s=128&d=identicon&r=PG&f=1", "display_name": "inktrap", "link": "https://stackoverflow.com/users/3750254/inktrap"}, "edited": false, "score": 0, "creation_date": 1489576979, "post_id": 42785133, "comment_id": 72729007, "body": "@FrankSchmitt As I wrote in a comment on Lee&#39;s answer: That would have been my answer, if I had read the literature as attentively as you did. Thank you, I appreciate it! However, I am going to accept Lee&#39;s answer because \u201cType classes are for overloading, not data abstraction.\u201d"}], "tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": false, "score": 2, "last_activity_date": 1489526591, "last_edit_date": 1489526591, "creation_date": 1489491922, "answer_id": 42785133, "question_id": 42784928, "link": "https://stackoverflow.com/questions/42784928/what-is-the-haskell-equivalent-of-an-interface/42785133#42785133", "title": "What is the haskell equivalent of an interface?", "body": "<p>That would be typeclasses. From <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">Learn You a Haskell</a>: \n\"Typeclasses are more like interfaces. \"</p>\n\n<p>You'd define your own typeclass (untested):</p>\n\n<pre><code>  class Translation a where\n    translateToken :: a -&gt; String -&gt; String\n    translatePhrase :: a -&gt; String -&gt; String\n</code></pre>\n\n<p>and implement it as</p>\n\n<pre><code>  instance Translation Spanish where\n     translateToken = spanishTranslateToken\n     translatePhrase = spanishTranslatePhrase\n</code></pre>\n\n<p>See also <a href=\"http://book.realworldhaskell.org/read/using-typeclasses.html\" rel=\"nofollow noreferrer\">Real Word Haskell on typeclasses</a></p>\n"}, {"comments": [{"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 1, "creation_date": 1489494403, "post_id": 42785156, "comment_id": 72685960, "body": "Not my downvote, but what do you mean by &quot;[classes] generally don&#39;t have implementations (with the exception of generic defaults)&quot;? Do you mean that many implementations are automatically derived versus written by hand?"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 0, "creation_date": 1489498357, "post_id": 42785156, "comment_id": 72688924, "body": "I mean classes only define the type of the function, they don&#39;t define the function itself. This is unlike C++ classes which often but not always have both types and implementations"}], "tags": [], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "is_accepted": false, "score": -3, "last_activity_date": 1489492009, "creation_date": 1489492009, "answer_id": 42785156, "question_id": 42784928, "link": "https://stackoverflow.com/questions/42784928/what-is-the-haskell-equivalent-of-an-interface/42785156#42785156", "title": "What is the haskell equivalent of an interface?", "body": "<p>A <code>class</code>, sometimes referred to as a \"type class\". Don't get this confused with your usual OO-classes though, Haskell classes don't have data, and generally don't have implementations (with the exception of generic defaults).</p>\n"}, {"comments": [{"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 1, "creation_date": 1489495433, "post_id": 42785160, "comment_id": 72686697, "body": "I&#39;m curious, why type with records as opposed to a typeclass?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 7, "creation_date": 1489497514, "post_id": 42785160, "comment_id": 72688227, "body": "@MichalCharemza Because when you use a type class <code>C</code> used as a Java interface, you will soon be tripped by the fact that <code>C</code> is not a type, and start defining an existential type around <code>C</code> like <code>data T = forall t. C t =&gt; T t</code>. And this is a well-known Haskell <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">anti-pattern</a>. Note: I mostly agree with Luke Palmer in that this is often overkill, and does not gain anything w.r.t. using a basic record with functions. In some specific cases, however, I do think the &quot;antipattern&quot; is justified."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 2, "creation_date": 1489497533, "post_id": 42785160, "comment_id": 72688241, "body": "@MichalCharemza - I think this approach is simpler since you don&#39;t need to create a new type for each translation instance (i.e. <code>SpanishTranslation</code>, <code>RussianTranslation</code>). Another advantage is you can put records into collections and manipulate them all together which is awkward with type classes. I also think this is closer to the use of interfaces in OO language where behaviour is coupled to the receiver rather than a type."}, {"owner": {"reputation": 311, "user_id": 3750254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ec61965b80e6551eaba49bdc62dba5?s=128&d=identicon&r=PG&f=1", "display_name": "inktrap", "link": "https://stackoverflow.com/users/3750254/inktrap"}, "edited": false, "score": 0, "creation_date": 1489566424, "post_id": 42785160, "comment_id": 72721836, "body": "I don&#39;t know if this anti-pattern is relevant for me. If I would like to get a list of the different tranlastions I could create a type that lists them explicitly, right? If type classes define a behaviour and I should not use them, what else are they good for?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 311, "user_id": 3750254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ec61965b80e6551eaba49bdc62dba5?s=128&d=identicon&r=PG&f=1", "display_name": "inktrap", "link": "https://stackoverflow.com/users/3750254/inktrap"}, "edited": false, "score": 0, "creation_date": 1489573217, "post_id": 42785160, "comment_id": 72726299, "body": "@inktrap - What would the type of your list be? With this solution it would be <code>[Model]</code> - if you use typeclasses you will need to use existential types to put <code>SpanishTranslation</code>, <code>RussianTranslation</code> etc. into the same list which is much more complicated. Type classes are for overloading, not data abstraction."}, {"owner": {"reputation": 311, "user_id": 3750254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ec61965b80e6551eaba49bdc62dba5?s=128&d=identicon&r=PG&f=1", "display_name": "inktrap", "link": "https://stackoverflow.com/users/3750254/inktrap"}, "edited": false, "score": 0, "creation_date": 1489576939, "post_id": 42785160, "comment_id": 72728982, "body": "@Lee  \t Alright, so I can overload an operator or a function, that makes sense. So isn&#39;t the literature misleading when they compare typeclasses to interfaces? I myself would have answered it like Frank Schmitt, had I read the stuff he read more attentively \u2026 and I have a follow up question regarding your answer (which I am going to append to my question)."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 311, "user_id": 3750254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ec61965b80e6551eaba49bdc62dba5?s=128&d=identicon&r=PG&f=1", "display_name": "inktrap", "link": "https://stackoverflow.com/users/3750254/inktrap"}, "edited": false, "score": 0, "creation_date": 1489577876, "post_id": 42785160, "comment_id": 72729566, "body": "@inktrap - Yes I think it is misleading to compare OO interfaces and type classes. Type classes are implicit function parameters resolved based on the type. OO interfaces couple the dictionary to the identity of the reciever and are used for information hiding. You should probably move your edit into a new question so it will get more attention."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 15, "last_activity_date": 1489492022, "creation_date": 1489492022, "answer_id": 42785160, "question_id": 42784928, "link": "https://stackoverflow.com/questions/42784928/what-is-the-haskell-equivalent-of-an-interface/42785160#42785160", "title": "What is the haskell equivalent of an interface?", "body": "<p>You can create a type containing the functions you want e.g.</p>\n\n<pre><code>data Model = Model { translateToken :: String -&gt; String,\n                     translatePhrase :: String -&gt; String }\n</code></pre>\n\n<p>then create values for Spanish and Russian.</p>\n"}], "owner": {"reputation": 311, "user_id": 3750254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ec61965b80e6551eaba49bdc62dba5?s=128&d=identicon&r=PG&f=1", "display_name": "inktrap", "link": "https://stackoverflow.com/users/3750254/inktrap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 2, "accepted_answer_id": 42785160, "answer_count": 3, "score": 4, "last_activity_date": 1489575948, "creation_date": 1489491368, "last_edit_date": 1489575948, "question_id": 42784928, "link": "https://stackoverflow.com/questions/42784928/what-is-the-haskell-equivalent-of-an-interface", "title": "What is the haskell equivalent of an interface?", "body": "<p>I would like to implement modules that are guaranteed to export a similar set of functions.</p>\n\n<p>For the sake of an example: Suppose I want to translate a word. Every word is mapped from the source language (let's say <code>English</code>) to the target language (let's say <code>Spanish</code> and <code>Russian</code>).</p>\n\n<p>My main application would import the models for Spanish and Russian and chooses a default model, Russian. I would like to guarantee, that each model has:</p>\n\n<ul>\n<li>a function <code>translateToken :: String -&gt; String</code></li>\n<li>a function <code>translatePhrase :: String -&gt; String</code></li>\n</ul>\n\n<p>in which the specific behaviour is implemented.</p>\n\n<p>How do I do this?</p>\n\n<p><strong>Edit</strong>, regarding Lee's answer:\n<em>How do i create data types with record syntax that contain functions that use guards?</em></p>\n\n<pre><code>-- let's suppose I want to use a function with guards in a record.\n-- how can and should i define that?\n\ndata Model  = Model { translateToken :: String -&gt; String}\n\n-- idea 1) should I define the functions separately, like this?\n-- how do I do this in a way that does not clutter the module?\nf l\n  | l == \"foo\" = \"bar\"\n\nmain :: IO ()\nmain = print $ translateToken x \"foo\"\n  where\n    x = Model {translateToken=f}\n    -- idea 2) define the function when creating the record,\n    -- despite the syntax error, this seems messy:\n    -- x = Model {name=(f l | l == \"foo\" = \"bar\")}\n\n-- idea 3) update the record later\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens", "arrows", "lenses"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1489508718, "post_id": 42784819, "comment_id": 72697207, "body": "This seems to answer your question: <a href=\"http://stackoverflow.com/questions/17528119/combining-lenses\">stackoverflow.com/questions/17528119/combining-lenses</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489513388, "post_id": 42784819, "comment_id": 72700522, "body": "Were you using a tuple instead of <code>Foo</code>, you could do something like <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Traversal.html#v:both\" rel=\"nofollow noreferrer\"><code>(1,2) &amp; both .~ 10</code></a> to set both elements of the tuple to <code>10</code>."}, {"owner": {"reputation": 17430, "user_id": 309483, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d797538504a367f277d19bd8369e9a19?s=128&d=identicon&r=PG", "display_name": "Janus Troelsen", "link": "https://stackoverflow.com/users/309483/janus-troelsen"}, "edited": false, "score": 0, "creation_date": 1606275243, "post_id": 42784819, "comment_id": 114912841, "body": "You can combine setters like <code>bar %~ f</code> using <a href=\"https://wiki.haskell.org/Compose\" rel=\"nofollow noreferrer\">compose</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1489497861, "creation_date": 1489497861, "answer_id": 42787247, "question_id": 42784819, "link": "https://stackoverflow.com/questions/42784819/is-there-a-direct-way-to-combine-setters-for-multiple-record-fields-to-a-single/42787247#42787247", "title": "Is there a direct way to combine setters for multiple record fields to a single setter?", "body": "<p>I've had this problem before and have a solution that works for two lenses by combining them into a Traversal:</p>\n\n<pre><code>fields2 :: Lens' s a -&gt; Lens' s a -&gt; Traversal' s a\nfields2 f1 f2 f s = (\\v1 v2 -&gt; s &amp; f1 .~ v1 &amp; f2 .~ v2) &lt;$&gt; f (s ^. f1) &lt;*&gt; f (s ^. f2)\n\nbarbaz = fields2 bar baz\n</code></pre>\n\n<p>This can than be used like:</p>\n\n<pre><code>foo &amp; barbaz %~ f\n</code></pre>\n\n<p>It's a little dirty and doesn't scale but it works for me :D If someone posts a nicer answer I'll be very happy!</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1490401815, "last_edit_date": 1495540922, "creation_date": 1489510145, "answer_id": 42791906, "question_id": 42784819, "link": "https://stackoverflow.com/questions/42784819/is-there-a-direct-way-to-combine-setters-for-multiple-record-fields-to-a-single/42791906#42791906", "title": "Is there a direct way to combine setters for multiple record fields to a single setter?", "body": "<p><em>lens</em> doesn't a ready-made combinator for that, presumably beacuase you can get illegal setters (or lenses) if the focuses of the components overlap.</p>\n\n<pre><code>data Trio a = Trio a a a\n    deriving (Show)\n\noneTwo :: Setter' (Trio a) (a, a)\noneTwo = sets $ \\f (Trio x y z) -&gt; let (x', y') = f (x, y) in Trio x' y' z\n\ntwoThree :: Setter' (Trio a) (a, a)\ntwoThree = sets $ \\f (Trio x y z) -&gt; let (y', z') = f (y, z) in Trio x y' z'\n\ncheating :: Setter' (Trio a) (a, a)\ncheating = sets $ \\f x -&gt; x &amp; oneTwo %~ f &amp; twoThree %~ f\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; Trio 1 1 1 &amp; cheating %~ bimap (2*) (2*) &amp; cheating %~ bimap (3+) (3+)\nTrio 5 10 5\nGHCi&gt; Trio 1 1 1 &amp; cheating %~ (bimap (2*) (2*) &lt;&amp;&gt; bimap (3+) (3+))\nTrio 5 13 5\n</code></pre>\n\n<p>In your case, the nicest alternative to building the setter/traversal by hand (as you <a href=\"https://stackoverflow.com/a/42787247/2751851\">and Cristoph Hegemann</a> are doing) seems to be <code>liftA2 (&gt;=&gt;) :: ASetter' s a -&gt; ASetter' s a -&gt; ASetter' s a</code>, as suggested elsewhere by <a href=\"https://stackoverflow.com/a/17529470/2751851\">bennofs</a> (thanks Shersh for the link). If you happen to have a lens to a homogeneous pair (or some other <code>Bitraversable</code>) lying around, you can get the traversal out of it with <code>both</code>:</p>\n\n<pre><code>data Foo = Foo\n   { _bar, _baz :: Int\n   } deriving (Show)\nmakeLenses ''Foo\n\nbarBaz :: Iso' Foo (Int, Int)\nbarBaz = iso ((,) &lt;$&gt; view bar &lt;*&gt; view baz) (Foo &lt;$&gt; fst &lt;*&gt; snd)\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; Foo 1 2 &amp; barBaz . both %~ (2*)\nFoo {_bar = 2, _baz = 4}\n</code></pre>\n\n<p>Yet another possibility is exploiting <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/src/Data.Data.Lens.html\" rel=\"nofollow noreferrer\"><code>Data.Data.Lens</code></a> to get a traversal of all fields of a certain type:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\n\nimport Control.Lens\nimport Data.Data.Lens\nimport Data.Data\n\ndata Foo = Foo\n   { _bar, _baz :: Int\n   } deriving (Show, Data, Typeable)\nmakeLenses ''Foo\n\nbarBaz :: Traversal' Foo Int\nbarBaz = template\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; Foo 1 2 &amp; barBaz %~ (2*)\nFoo {_bar = 2, _baz = 4}\n</code></pre>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1490401815, "creation_date": 1489491050, "question_id": 42784819, "link": "https://stackoverflow.com/questions/42784819/is-there-a-direct-way-to-combine-setters-for-multiple-record-fields-to-a-single", "title": "Is there a direct way to combine setters for multiple record fields to a single setter?", "body": "<pre><code>import Control.Lens\nimport Control.Lens.TH\n\ndata Foo = Foo {\n    _bar, _baz :: Int\n   }\nmakeLenses ''Foo\n</code></pre>\n\n<p>Now if I want to modify both int fields, I can do</p>\n\n<pre><code>barbaz :: Setter' Foo Int\nbarbaz = sets $ \\foo f -&gt; foo &amp; bar %~ f\n                              &amp; baz %~ f\n</code></pre>\n\n<p>but this seems like a pretty ugly manual way to do it.</p>\n\n<p>Can the same be achieved directly with lens/arrow combinators?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 0, "creation_date": 1489497587, "post_id": 42785461, "comment_id": 72688283, "body": "@Daniel&#39;s answer is way simpler if he already has a list comprehension imho"}], "tags": [], "owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "is_accepted": true, "score": 1, "last_activity_date": 1489493783, "last_edit_date": 1489493783, "creation_date": 1489492861, "answer_id": 42785461, "question_id": 42784807, "link": "https://stackoverflow.com/questions/42784807/how-to-remove-certain-coordinates-from-a-list/42785461#42785461", "title": "How to remove certain coordinates from a list", "body": "<p>You should use filter.</p>\n\n<p>The following predicate is <code>True</code> for non-diagonal elements:</p>\n\n<pre><code> predicate (x,y)=x/=y\n</code></pre>\n\n<p>Then you can define your filter:</p>\n\n<pre><code>gridFilter g=filter predicate g\n</code></pre>\n\n<p>Run it with:</p>\n\n<pre><code>gridFilter $ grid 2\n</code></pre>\n\n<p>Yields:</p>\n\n<pre><code>[(0,1),(0,2),(1,0),(1,2),(2,0),(2,1)]\n</code></pre>\n\n<p>Of course you can also make it a one-liner:</p>\n\n<pre><code>gridFiltered=filter (\\(x,y)-&gt;x/=y) $ grid 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489497917, "post_id": 42786156, "comment_id": 72688580, "body": "Haskell uses <code>&#47;=</code> instead of <code>!=</code> like most languages use. (I have no idea why Haskell did not copy C here while doing so for e.g. <code>&amp;&amp;</code>,<code>||</code> and <code>==</code>)"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489517193, "post_id": 42786156, "comment_id": 72702811, "body": "@chi, exactly, i just missed that, thanks for fixing it."}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1489497737, "last_edit_date": 1489497737, "creation_date": 1489494821, "answer_id": 42786156, "question_id": 42784807, "link": "https://stackoverflow.com/questions/42784807/how-to-remove-certain-coordinates-from-a-list/42786156#42786156", "title": "How to remove certain coordinates from a list", "body": "<p>Your function was good enough, just add a filter on it:</p>\n\n<pre><code>grid :: Int -&gt; [(Int,Int)]\ngrid n = [(x,y) | x &lt;- [0..n], y &lt;- [0..n], x /= y]\n</code></pre>\n\n<p>using a filter (<code>x /= y</code>) in the list comprehensions is pretty simple and describes what you try to accomplish.</p>\n"}], "owner": {"reputation": 37, "user_id": 7104069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a02754f873e92142273b1dfee4fd6c5?s=128&d=identicon&r=PG&f=1", "display_name": "loxi95", "link": "https://stackoverflow.com/users/7104069/loxi95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 42785461, "answer_count": 2, "score": 1, "last_activity_date": 1489497737, "creation_date": 1489491031, "last_edit_date": 1489494514, "question_id": 42784807, "link": "https://stackoverflow.com/questions/42784807/how-to-remove-certain-coordinates-from-a-list", "title": "How to remove certain coordinates from a list", "body": "<p>I'm new to Haskell and was trying to make a grid function which returns all the coordinates in the grid as a list. I want to filter this list to remove any coordinates where <code>x = y</code> given <code>[(x,y)]</code> (essentially getting rid of all the diagonal coordinates in the grid) but I'm not sure how to do it. Any help/pointers would be appreciated. </p>\n\n<pre><code>grid :: Int -&gt; [(Int,Int)]\ngrid n = [(x,y) | x &lt;- [0..n], y &lt;- [0..n]]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1489483144, "post_id": 42781727, "comment_id": 72677951, "body": "<code>item</code> is a <code>Parser</code>. I think you need to <code>parse item &quot;123&quot;</code> rather than just do <code>item &quot;123&quot;</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489486213, "post_id": 42781727, "comment_id": 72680101, "body": "<code>p&#39;</code> is of the <code>Parser (Char,Char)</code> type, which is a <code>newtype</code>, so it is considered a separate type from the function type you expect, even it is isomorphic to it. You can use <code>parse p&#39;</code> to recover the function you want, as MathematicalOrchid pointed out."}], "answers": [{"tags": [], "owner": {"reputation": 271, "user_id": 2458612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e41d9638641eea1f41208113670289?s=128&d=identicon&r=PG", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/2458612/gerhard"}, "is_accepted": true, "score": 0, "last_activity_date": 1489502649, "creation_date": 1489502649, "answer_id": 42789060, "question_id": 42781727, "link": "https://stackoverflow.com/questions/42781727/why-does-this-haskell-code-failed/42789060#42789060", "title": "Why does this haskell code failed", "body": "<p><code>newtype</code> requires a constructor, <code>type</code> does not. If we want to replace <code>type</code> by <code>newtype</code>, we need to add a constructor, <code>P</code> for example, to any usage of our <code>Parser</code> type; in order to resolve <code>Parser</code>, we implement <code>parse</code>.</p>\n\n<p>Starting from your second example code, we will get</p>\n\n<pre><code>newtype Parser a = P (String -&gt; [(a, String)])\n\nparse :: Parser a -&gt; String -&gt; [(a,String)]\nparse (P p) inp = p inp \n\nitem :: Parser Char\nitem = P (\\inp -&gt; case inp of\n                [] -&gt; []\n                (x:xs) -&gt; [(x,xs)])\n\nmain = print (parse item \"12345\")\n</code></pre>\n\n<p>Now let's implement your special parser <code>p</code>. In order to use <code>do</code>, we implement the Monad instance.</p>\n\n<p>We add to our code:</p>\n\n<pre><code>instance Monad Parser where\n  -- (&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\n  p &gt;&gt;= f = P (\\inp -&gt; case parse p inp of\n                       []        -&gt; []\n                       [(v,out)] -&gt; parse (f v) out)\n  -- return :: a -&gt; Parser a\n  return v = P (\\inp -&gt; [(v, inp)])\n\np :: Parser (Char, Char)\np = do  \n  x &lt;- item\n  item\n  y &lt;- item\n  return (x, y)\n</code></pre>\n\n<p>Our <code>main</code> command becomes:</p>\n\n<pre><code>main = print (parse p \"12345\")\n</code></pre>\n\n<p>In my opinion, the error messages in ghc are rather extensive, but one has to read very carefully; one also has to be very careful with using data types.</p>\n"}], "owner": {"reputation": 849, "user_id": 3316009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q0EyA.jpg?s=128&g=1", "display_name": "calvin", "link": "https://stackoverflow.com/users/3316009/calvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 42789060, "answer_count": 1, "score": 1, "last_activity_date": 1489502649, "creation_date": 1489482391, "last_edit_date": 1489482467, "question_id": 42781727, "link": "https://stackoverflow.com/questions/42781727/why-does-this-haskell-code-failed", "title": "Why does this haskell code failed", "body": "<p>First of all I don't exactly understand the error message, so I can only use a ambiguous question title</p>\n\n<p>This code is from Chapter 8 of Channel 9 lecture about <em>programming in haskell</em>\n<a href=\"https://i.stack.imgur.com/VNvj2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VNvj2.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was trying to run this code by GHC and I wrote</p>\n\n<pre><code>-- Functional parsing library from chapter 13 of Programming in Haskell,\n-- Graham Hutton, Cambridge University Press, 2016.\n\nmodule Parsing (module Parsing, module Control.Applicative) where\nimport Data.Typeable\nimport Control.Applicative\nimport Data.Char\n\n-- Basic definitions\n\nnewtype Parser a = P (String -&gt; [(a,String)])\n\nparse :: Parser a -&gt; String -&gt; [(a,String)]\nparse (P p) inp = p inp\n\nitem :: Parser Char\nitem = P (\\inp -&gt; case inp of\n                     []     -&gt; []\n                     (x:xs) -&gt; [(x,xs)])\n\n-- Sequencing parsers\n\ninstance Functor Parser where\n   -- fmap :: (a -&gt; b) -&gt; Parser a -&gt; Parser b\n   fmap g p = P (\\inp -&gt; case parse p inp of\n                            []        -&gt; []\n                            [(v,out)] -&gt; [(g v, out)])\n\ninstance Applicative Parser where\n   -- pure :: a -&gt; Parser a\n   pure v = P (\\inp -&gt; [(v,inp)])\n\n   -- &lt;*&gt; :: Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b\n   pg &lt;*&gt; px = P (\\inp -&gt; case parse pg inp of\n                             []        -&gt; []\n                             [(g,out)] -&gt; parse (fmap g px) out)\n\ninstance Monad Parser where\n   -- (&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\n   p &gt;&gt;= f = P (\\inp -&gt; case parse p inp of\n                           []        -&gt; []\n                           [(v,out)] -&gt; parse (f v) out)\n\n-- Making choices\n\ninstance Alternative Parser where\n   -- empty :: Parser a\n   empty = P (\\inp -&gt; [])\n\n   -- (&lt;|&gt;) :: Parser a -&gt; Parser a -&gt; Parser a\n   p &lt;|&gt; q = P (\\inp -&gt; case parse p inp of\n                           []        -&gt; parse q inp\n                           [(v,out)] -&gt; [(v,out)])\n\nreturn' :: a -&gt; Parser a\nreturn' v = \\inp -&gt; [(v, inp)]\n\np' :: Parser (Char, Char)\np' = do \n    x &lt;- item\n    item\n    y &lt;- item\n    return' (x, y)\n\nmain = print (p' \"123\")\n</code></pre>\n\n<p>The code consists a lot of code I copied from given demo code Parsing.hs, and a <code>p'</code> function same as the slide</p>\n\n<p>Running this code causes an error</p>\n\n<pre><code>4.hs:63:15: error:\n? Couldn't match expected type \u2018[Char] -&gt; a0\u2019\n              with actual type \u2018Parser (Char, Char)\u2019\n? The function \u2018p'\u2019 is applied to one argument,\n  but its type \u2018Parser (Char, Char)\u2019 has none\n  In the first argument of \u2018print\u2019, namely \u2018(p' \"123\")\u2019\n  In the expression: print (p' \"123\")\n</code></pre>\n\n<p>It seems there's some thing wrong with the type, and I tried</p>\n\n<pre><code>main = print (item \"123\")\n</code></pre>\n\n<p>neither did it work</p>\n\n<p>However when I simply remove the definition of <code>Parser</code>, and replaced them with definition mentioned in previous slide</p>\n\n<pre><code>type Parser a = String -&gt; [(a, String)]\n\nitem :: Parser Char\nitem = \\inp -&gt; case inp of\n                    [] -&gt; []\n                    (x:xs) -&gt; [(x,xs)]\n\nreturn' :: a -&gt; Parser a\nreturn' v = \\inp -&gt; [(v, inp)]\n\nmain = print (item \"123\")\n</code></pre>\n\n<p>and it just worked with output <code>[('1',\"23\")]</code>, and I got confused here.</p>\n\n<p>BTW, I found that in the comment section a leomm asked the same question as me, and he figured this out later. However I just can't work this out.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489486477, "post_id": 42780191, "comment_id": 72680323, "body": "For this simple task, the reader monad seems to make everything more cumbersome. Only in more complex examples it can save you from the hassle of passing around the environment every time. By the way, I think your monadic definition can be simplified to <code>calculateR = asks eInt</code> or <code>calculateR = eInt &lt;$&gt; ask</code> to reduce the syntactic overhead"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1516380921, "post_id": 42780757, "comment_id": 83677616, "body": "This demonstrates that a contrived example can actually be very helpful. +1"}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 17, "last_activity_date": 1489480330, "last_edit_date": 1489480330, "creation_date": 1489479017, "answer_id": 42780757, "question_id": 42780191, "link": "https://stackoverflow.com/questions/42780191/what-is-the-advantage-of-using-the-reader-monad-over-passing-the-value-directly/42780757#42780757", "title": "What is the advantage of using the reader monad over passing the value directly?", "body": "<p>The advantage comes when you want to compose two functions.</p>\n\n<pre><code>f :: a -&gt; Reader Env b\ng :: b -&gt; Reader Env c\n\ng &lt;=&lt; f\n</code></pre>\n\n<p>or in the <code>do</code> notation</p>\n\n<pre><code>\\a -&gt; do\n    b &lt;- f a\n    g b\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>f :: a -&gt; Env -&gt; b\ng :: b -&gt; Env -&gt; c\n\n\\a e -&gt; g (f a e) e\n</code></pre>\n\n<p>in the latter you have to keep passing the environment around by yourself, while the monad instance provides you with a composition that does it for you. The manual composition will quickly become unnecessarily verbose and complex as more functions are involved.</p>\n\n<p>Reader then provides you with <code>local</code> too.</p>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 6, "last_activity_date": 1489493249, "creation_date": 1489493249, "answer_id": 42785594, "question_id": 42780191, "link": "https://stackoverflow.com/questions/42780191/what-is-the-advantage-of-using-the-reader-monad-over-passing-the-value-directly/42785594#42785594", "title": "What is the advantage of using the reader monad over passing the value directly?", "body": "<p>In my experience it's most useful when either:</p>\n\n<ol>\n<li><p>You have a bunch of functions with deeply needed call graphs, and some stuff deep on the call graph needs the environment but lots of intermediate functions don't. Then the reader monad handles all the plumbing for you. Especially when you're using a monad transformer stack anyway (especially especially with a type or newtype alias for your stack) so you were already writing in monadic style; in that case you can probably realise late that you need the environment, change the definition of the monad stack, change the entry point to pass the environment, change the use sites to refer to it, and not have to touch the code of any intermediate functions (maybe not even their types if you had a name for the stack).</p></li>\n<li><p>You're providing an interface where lots of client code will pass functions to you, and you want them to have the ability to access the environment, but expect that many of them won't actually need it. Again, the benefits are greater when you already had a monad transformer stack you can just bolt a reader into; existing client code was already in monadic style and may work unchanged by just ignoring the environment, while new functions can be written that use it.</p></li>\n</ol>\n\n<p>But for anything small enough to fit into a stack overflow post, ordinary functions are almost always more appropriate.</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 3, "accepted_answer_id": 42780757, "answer_count": 2, "score": 8, "last_activity_date": 1489493249, "creation_date": 1489476924, "last_edit_date": 1489478866, "question_id": 42780191, "link": "https://stackoverflow.com/questions/42780191/what-is-the-advantage-of-using-the-reader-monad-over-passing-the-value-directly", "title": "What is the advantage of using the reader monad over passing the value directly?", "body": "<p>I am trying to understand when to use the reader monad, but I haven\u2019t found a good usage example. I am pretty sure I have limited knowledge on this topic.</p>\n\n<p>Consider this example code:</p>\n\n<pre><code>import Control.Monad.Reader\n\ndata Env = Env\n         { eInt :: Int\n         , eStr :: String\n         }\n\ncalculateR :: Reader Env Int\ncalculateR = do\n    e &lt;- ask\n    return $ eInt e\n\ncalculate :: Env -&gt; Int\ncalculate = eInt\n\nmain :: IO ()\nmain = do\n    let env = Env { eInt = 1, eStr = \"hello\"}\n    let a = runReader calculateR env\n    let b = calculate env\n    print (a,b)\n</code></pre>\n\n<p>If I want to pass around the global <code>Env</code> to be able to access it from any function, should I use the reader monad for this purpose?</p>\n\n<p>In comparison to just passing the <code>Env</code> directly to the function, is there any benefit?</p>\n\n<p>If I understand correctly, both <code>calculate</code> and <code>calculateR</code> are pure (in the sense that they won't be able to make any change to <code>env</code>), and both have <code>Env</code> in their type signature telling that they might read the value form <code>env</code> to use in their computation.</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1489477777, "post_id": 42780170, "comment_id": 72674922, "body": "Simply prepend <code>~&#47;.local&#47;bin</code> to your PATH."}, {"owner": {"reputation": 63, "user_id": 5115600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e8b0378526af27a2a21004839cc?s=128&d=identicon&r=PG&f=1", "display_name": "sudha", "link": "https://stackoverflow.com/users/5115600/sudha"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1489486288, "post_id": 42780170, "comment_id": 72680154, "body": "Thank you! It seems to work now without doing it, I closed the terminal after <code>stack upgrade</code> and opened a new terminal."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1489491097, "post_id": 42780170, "comment_id": 72683651, "body": "Instead of closing and opening a new terminal you can enter this to refresh your environment <code>. ~&#47;.profile</code>."}], "owner": {"reputation": 63, "user_id": 5115600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e60e8b0378526af27a2a21004839cc?s=128&d=identicon&r=PG&f=1", "display_name": "sudha", "link": "https://stackoverflow.com/users/5115600/sudha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489476852, "creation_date": 1489476852, "question_id": 42780170, "link": "https://stackoverflow.com/questions/42780170/how-to-upgrade-stack-version-0-1-10-to-1-3-2-in-linux", "title": "How to upgrade stack version 0.1.10 to 1.3.2 in Linux", "body": "<p>Executing command <code>stack upgrade</code> stores stack version 1.3 in the directory <code>~/.local/bin</code>. How should I make this as default stack in the machine. <code>stack upgrade --git</code> doesn't help too.</p>\n\n<p>This is my path -\n<code>bash: /home/sudha/bin:/home/sudha/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games: No such file or directory</code></p>\n"}, {"tags": ["list", "haskell", "tuples", "data-conversion"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "edited": false, "score": 0, "creation_date": 1489472819, "post_id": 42779059, "comment_id": 72672449, "body": "is there a way then to convert the ints inside the tuples into strings?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "edited": false, "score": 1, "creation_date": 1489473594, "post_id": 42779059, "comment_id": 72672771, "body": "You can use <code>show</code> to convert an int to string, e.g. <code>map (\\(a,b,c) -&gt; [a,show b, show c])</code> but I&#39;m unsure about why do you want to convert everything to string. A list of tuples is generally easier to work with than a list of lists of strings."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1489472650, "creation_date": 1489472650, "answer_id": 42779059, "question_id": 42779022, "link": "https://stackoverflow.com/questions/42779022/haskell-converting-a-list-of-tuples-into-a-list-of-lists/42779059#42779059", "title": "Haskell: converting a list of tuples into a list of lists", "body": "<p>You can not perform that conversion. Lists, unlike tuples are homogeneous: they contain values of the same type, only. </p>\n\n<p>There's no such a list as <code>[\"book\",1,0]</code>, since it contains both strings and numbers. That list can not have type <code>[String]</code>, nor type <code>[Int]</code>, for instance.</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1489494825, "creation_date": 1489494825, "answer_id": 42786158, "question_id": 42779022, "link": "https://stackoverflow.com/questions/42779022/haskell-converting-a-list-of-tuples-into-a-list-of-lists/42786158#42786158", "title": "Haskell: converting a list of tuples into a list of lists", "body": "<p>In addition to @chi's answer, you may also try a sum of <code>Int</code> and <code>String</code>, called <code>Either Int String</code>.</p>\n\n<pre><code>concatMap\n  (\\(s, x, y) -&gt; [Right s, Left x, Left y])\n  [(\"book\", 1, 0), (\"book\", 2, 0), (\"title\", 2, 1)]\n= [Right \"book\", Left 1, Left 0, Right \"book\",\n  Left 2, Left 0, Right \"title\", Left 2, Left 1]\n</code></pre>\n\n<p>If the numbers are to be associated with the string, however, the list of tuples is a superior structure.</p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 6222757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48fdecaf00efb53f6ed0ee200fa9ba2b?s=128&d=identicon&r=PG&f=1", "display_name": "evzh", "link": "https://stackoverflow.com/users/6222757/evzh"}, "is_accepted": false, "score": 0, "last_activity_date": 1489638056, "creation_date": 1489638056, "answer_id": 42825242, "question_id": 42779022, "link": "https://stackoverflow.com/questions/42779022/haskell-converting-a-list-of-tuples-into-a-list-of-lists/42825242#42825242", "title": "Haskell: converting a list of tuples into a list of lists", "body": "<p>If you are sure that your tuple is of type <code>(String, Int, Int)</code> then you just write</p>\n\n<pre><code>tupleToList :: (String, Int, Int) -&gt; [String]\ntupleToList (a,b,c) = [a, show b, show c]\n</code></pre>\n\n<p>and map it over what you have, <code>[(String, Int, Int)]</code>.</p>\n\n<p>More generally, </p>\n\n<pre><code>tupleToList :: (Show a, Show b) =&gt; (String, a, b) -&gt; [String]\ntupleToList (a,b,c) = [a, show b, show c]\n</code></pre>\n\n<p>which allows you to insert any displayable thing in 2nd and 3rd place of the input tuple, but not being <em>more general</em>: for example, you can not have</p>\n\n<ul>\n<li><p>Unfixed length of tuple, like <code>(a,b,c)</code> mixing with <code>(a,b,c,d)</code></p></li>\n<li><p>Switching the <code>show</code> objects, like <code>(String, a, b)</code> mixing <code>(b, String, a)</code></p></li>\n</ul>\n\n<p>-- I mean, how would you store the different tuples in a list in the first place?</p>\n\n<p>In case of that you really want, there is something called <a href=\"https://wiki.haskell.org/Heterogenous_collections\" rel=\"nofollow noreferrer\">Heterogenous list</a> which is never recommended and you cannot really get much out of it.</p>\n"}], "owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 42779059, "answer_count": 3, "score": 0, "last_activity_date": 1508237992, "creation_date": 1489472529, "last_edit_date": 1508237992, "question_id": 42779022, "link": "https://stackoverflow.com/questions/42779022/haskell-converting-a-list-of-tuples-into-a-list-of-lists", "title": "Haskell: converting a list of tuples into a list of lists", "body": "<p>I have a list of tuples:</p>\n\n<pre><code>  [(\"book\", 1,0), (\"book\", 2,0), (\"title\", 2,1)]\n</code></pre>\n\n<p>that I wanted to convert into a list of lists with the ints converted to Strings as well: </p>\n\n<pre><code>[[\"book, \"1\",\"0\"], [\"book , \"2\", \"0\"]...]\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>map(\\(a, b, c) -&gt; [a, b, c])myList\n</code></pre>\n\n<p>but I get the following error message: </p>\n\n<pre><code>* No instance for (Num [Char]) arising from a use of `myList'\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1489475131, "post_id": 42778550, "comment_id": 72673486, "body": "What is <code>Path</code>? What is <code>Point</code>? What is a <code>PictureObject</code>? What is <code>Vector</code>? Why is this tagged <a href=\"https://stackoverflow.com/questions/tagged/dictionary\">dictionary</a>? And what is your actual question?"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489476008, "post_id": 42779731, "comment_id": 72673955, "body": "<code>(map (\\p -&gt; movePoint p vec) points)</code> seems more likely to me."}, {"owner": {"reputation": 1, "user_id": 6864253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a48dddb5e6e42f169e91704abac0d6?s=128&d=identicon&r=PG&f=1", "display_name": "torjussa", "link": "https://stackoverflow.com/users/6864253/torjussa"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489481069, "post_id": 42779731, "comment_id": 72676636, "body": "That did it @Daniel Wagner"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 1, "last_activity_date": 1489475410, "creation_date": 1489475410, "answer_id": 42779731, "question_id": 42778550, "link": "https://stackoverflow.com/questions/42778550/mapping-list-with-function-in-haskell/42779731#42779731", "title": "Mapping list with function in Haskell", "body": "<p>My crystal ball tells me, that you just need <code>(map movePoint (points vec))</code> instead of <code>map (movePoint (points vec))</code> in the last line.</p>\n"}], "owner": {"reputation": 1, "user_id": 6864253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a48dddb5e6e42f169e91704abac0d6?s=128&d=identicon&r=PG&f=1", "display_name": "torjussa", "link": "https://stackoverflow.com/users/6864253/torjussa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489480114, "creation_date": 1489470239, "last_edit_date": 1489480114, "question_id": 42778550, "link": "https://stackoverflow.com/questions/42778550/mapping-list-with-function-in-haskell", "title": "Mapping list with function in Haskell", "body": "<p>I am new to Haskell and I'm trying to change the position of a drawn path.</p>\n\n<pre><code>let redPath =  Path[Point 420 750, Point 420 550] red Solid\n\ndrawPicture 10 [redPath, movePictureObject (Vector 100 100)\nredPath]\n</code></pre>\n\n<p>The functions movePictureObject and movePoint should change every point of the path with a given  vector (100,100). </p>\n\n<pre><code>movePoint :: Point -&gt; Vector -&gt; Point\nmovePoint (Point x y) (Vector xv yv)\n  = Point (x + xv) (y + yv)\n\nmovePictureObject :: Vector -&gt; PictureObject -&gt;PictureObject\nmovePictureObject vec (Path points colour lineStyle) \n  = Path map (movePoint (points vec)) red Solid\n</code></pre>\n\n<p>I am not sure of how to use the map function properly, I have read several posts here and watched other tutorials.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["list", "haskell", "numbers"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "edited": false, "score": 0, "creation_date": 1489470055, "post_id": 42778192, "comment_id": 72671466, "body": "as a follow up question. I tried to convert the list of tuples into a list of lists like this: map (&#40;a, b, c) -&gt; [a, b, c]) [(&quot;book&quot;,1, 0)....] And I get the following error msg:  No instance for (Num [Char]) arising from a use of ....The numbers cause the problem because with tuples of strings only, the conversion works fine. Any idea why? Thanks again"}, {"owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "reply_to_user": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "edited": false, "score": 0, "creation_date": 1489475544, "post_id": 42778192, "comment_id": 72673681, "body": "Lists in haskell are homogenous and don&#39;t support mixing of different types."}], "tags": [], "owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "is_accepted": true, "score": 2, "last_activity_date": 1489468440, "creation_date": 1489468440, "answer_id": 42778192, "question_id": 42777536, "link": "https://stackoverflow.com/questions/42777536/haskell-numbering-items-inside-a-list/42778192#42778192", "title": "Haskell: numbering items inside a list", "body": "<p>You can use an auxiliary function to keep track of the counting variables:</p>\n\n<pre><code>number xs = number' 0 0 xs\nnumber' n m (x:xs) | x == \"book\" = (x,n+1,0) : number' (n+1) 0 xs\nnumber' n m (x:xs) | otherwise = (x,n,m+1) : number' n (m+1) xs\nnumber' _ _ [] = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1489496780, "creation_date": 1489496780, "answer_id": 42786858, "question_id": 42777536, "link": "https://stackoverflow.com/questions/42777536/haskell-numbering-items-inside-a-list/42786858#42786858", "title": "Haskell: numbering items inside a list", "body": "<p>There are many functions for accumulating over lists. In this case, we want something like <code>map</code> except we need to carry along information from the previous elements. A function that does this is <code>scanl :: (s -&gt; a -&gt; s) -&gt; s -&gt; [a] -&gt; [s]</code>.</p>\n\n<p>You are better accumulating a pair of integers than a float. Floats are imprecise and so you'll likely end up with something other than you wanted. Lets say <code>s = (Int, Int)</code> and create the step function.</p>\n\n<pre><code>step :: (Int, Int) -&gt; String -&gt; (Int, Int)\nstep (a, b) s@\"book\"   = (a + 1, 0    )\nstep (a, b) s@\"title\"  = (a    , b + 1)\nstep (a, b) s@\"author\" = (a    , b + 1)\nstep x      _          = x\n</code></pre>\n\n<p>When we see <code>\"book\"</code> we add <code>1</code> to the left integer and set the right integer to <code>0</code>. When we see <code>\"title\"</code> or <code>\"author\"</code> we add <code>1</code> to the right integer and leave the left integer the same. Otherwise, we leave both integers the same. You can modify this as needed.</p>\n\n<pre><code>scanl step (0, 0) myList\n= [(0,0),(1,0),(2,0),(2,1),(2,2),(2,3),(3,0),(3,1),(4,0),(4,1)]\n</code></pre>\n\n<p>We need to do two final things. First, <code>scanl</code> produces the initial state as a first element but we do not want it. This is easily dropped with <code>tail</code> or <code>drop 1</code> (<code>tail</code> is okay because <code>scanl</code> always produces a non-empty list, but many would prefer to see <code>drop 1</code> anyways). Secondly, we want to augment each tuple with the appropriate string.</p>\n\n<pre><code>zipWith (\\s (a, b) -&gt; (s, a, b)) &lt;*&gt; drop 1 . scanl step (0, 0)\n</code></pre>\n\n<p>If you are not familiar with <code>&lt;*&gt;</code> it is <code>(&lt;*&gt;) f g x = f x (g x)</code> (in this case). We could have also written:</p>\n\n<pre><code>\\xs -&gt; zipWith (\\s (a, b) -&gt; (s, a, b)) xs ((drop 1 . scanl step (0, 0)) xs)\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 42778192, "answer_count": 2, "score": 0, "last_activity_date": 1489496780, "creation_date": 1489463897, "question_id": 42777536, "link": "https://stackoverflow.com/questions/42777536/haskell-numbering-items-inside-a-list", "title": "Haskell: numbering items inside a list", "body": "<p>I am trying to number items inside a list according to their order relative to a preceding element, like \"book\" in the list below.</p>\n\n<pre><code>  myList=[\"book\",\"book\",\"title\",\"author\",\"title\",\"book\",\"title\",\"book\", \"author\"]\n</code></pre>\n\n<p>I would like to have:</p>\n\n<pre><code>[book 1, book 2, title 2.1, author 2.1, title 2.2, book 3, title 3.1, book 4, author 4.1]\n</code></pre>\n\n<p>The count restarts at 1 for \"title\" and \"author\" after a new \"book\" is met.\nI can eazily number the books but I don't know how to number the other items depending on the book number.</p>\n\n<p>so I tried to combine a zip in a list comprehension, like this:</p>\n\n<pre><code>zip [fst (head (zip[1..][x | x &lt;- myList, x==\"book\"]))..][x | x &lt;- myList, x==\"title\" || x==\"author\"]\n</code></pre>\n\n<p>but what I got is:</p>\n\n<pre><code> [(1,\"title\"),(2,\"author\"),(3,\"title\"),(4,\"title\"),(5,\"author\")]\n</code></pre>\n\n<p>It doesn't matter if the result is a tuple or a list.</p>\n\n<p>I'd really appreciate your help.</p>\n\n<p>Thanks,\nomar</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489459251, "post_id": 42776824, "comment_id": 72668699, "body": "Thank you, but I still run into an error when I change up the brackets, namely this: Couldn&#39;t match type \u2018StmtT\u2019 with \u2018[ProgT]\u2019 Expected type: [ProgT]         Actual type: ProgT     \u2022 In the second argument of \u2018(:)\u2019, namely         \u2018changeName x y (Seq moreStatements)\u2019"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489459984, "post_id": 42776824, "comment_id": 72668864, "body": "@RosaryLightningX I&#39;ve edited my answer to address that too, although its technically a totally separate error that was just masked by the first one."}, {"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489460012, "post_id": 42776824, "comment_id": 72668869, "body": "ah, yes, changing the method certainly helped--now the pattern matching compiles correctly.  I did not think of using map at all vs head and tail, thanks so much for the insight."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 1, "last_activity_date": 1489459839, "last_edit_date": 1489459839, "creation_date": 1489459027, "answer_id": 42776824, "question_id": 42776781, "link": "https://stackoverflow.com/questions/42776781/haskell-pattern-matching-error-with-data-constructor/42776824#42776824", "title": "Haskell pattern matching error with data constructor", "body": "<pre><code>changeName x y (Seq (oneStatement:moreStatements)) = Seq(changeName x y oneStatement:changeName x y Seq(moreStatements))\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>changeName x y (Seq (oneStatement:moreStatements)) = Seq (changeName x y oneStatement : changeName x y (Seq moreStatements))\n</code></pre>\n\n<p>Specifically the problem is that the last part where you have <code>changeName x y Seq(moreStatements)</code> is seen as applying <code>changeName</code> to 4 arguments:</p>\n\n<ol>\n<li><code>x</code></li>\n<li><code>y</code></li>\n<li><code>Seq</code></li>\n<li><code>(moreStatements)</code></li>\n</ol>\n\n<p><code>Seq(moreStatements)</code> doesn't mean \"apply <code>Seq</code> to <code>moreStatements</code>, as it would in a language with C-like syntax, but is rather just the terms <code>Seq</code> <code>(moreStatements)</code> next to each other, completely equivalent to if you had written <code>Seq moreStatements</code> because the parentheses are not needed to group a single identifier. If <code>Seq</code> was the \"head\" of that sub-expression it would do what you want, but it follows on <code>changeName x y</code>, so that is applied to <code>Seq</code>, and then to <code>moreStatements</code>, which doesn't fit the type of <code>changeName</code>.</p>\n\n<p>(Note that this is pretty much exactly what the error message said)</p>\n\n<hr>\n\n<p>Your second error is that <code>changeNames</code> has type <code>String -&gt; String -&gt; ProgT -&gt; ProgT</code> (and remember <code>ProgT = StmtT</code>). But you use the result of <code>changeName</code> on the right side of <code>:</code>, as if it returned a <strong>list</strong> of something.</p>\n\n<p>Probably you need to instead <code>changeName</code> over the list, rather than applying it to the head and to the tail? In fact you wouldn't even need to pattern match on the list then, you could just:</p>\n\n<pre><code>changeName x y (Seq statements) = Seq (map (changeName x y) statements)\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 42776824, "answer_count": 1, "score": 0, "last_activity_date": 1489460346, "creation_date": 1489458619, "last_edit_date": 1489460346, "question_id": 42776781, "link": "https://stackoverflow.com/questions/42776781/haskell-pattern-matching-error-with-data-constructor", "title": "Haskell pattern matching error with data constructor", "body": "<p>I have the following code in Haskell:</p>\n\n<pre><code>module testData where\n\nimport SImpL\nchangeName :: String -&gt; String -&gt; ProgT -&gt; ProgT\n...\nchangeName x y (Seq []) = Seq[]\nchangeName x y (Seq (oneStatement:moreStatements)) = Seq (changeName x y oneStatement : changeName x y (Seq moreStatements))\n</code></pre>\n\n<p>The definition of ProgT is defined in the module SImpL:</p>\n\n<pre><code>data StmtT = Assign NameT AExprT |   \n             If BExprT StmtT StmtT | \n             While BExprT StmtT | \n             Seq [StmtT] -- If the list is empty, this is a statement that does nothing.    \n             deriving (Show,Eq)\n\ntype ProgT = StmtT \n</code></pre>\n\n<p>Put simply, Seq[StmtT] is a list of Assign, If or While statements defined in the constructor.  <strong><em>The function changeName checks if there are variables in ALL statements that equal to x, and replaces it with y.</em></strong>  When I run the code, I get the following error:</p>\n\n<blockquote>\n  <p>Assignment3.hs:12:89: error:\n      \u2022 Couldn't match type \u2018StmtT\u2019 with \u2018[ProgT]\u2019\n        Expected type: [ProgT]\n          Actual type: ProgT\n      \u2022 In the second argument of \u2018(:)\u2019, namely\n          \u2018changeName x y (Seq moreStatements)\u2019\n        In the first argument of \u2018Seq\u2019, namely\n          \u2018(changeName x y oneStatement\n            : changeName x y (Seq moreStatements))\u2019\n        In the expression:\n          Seq\n            (changeName x y oneStatement : changeName x y (Seq moreStatements))</p>\n</blockquote>\n\n<p>Based on the error message, the problem is in the last line:</p>\n\n<p>changeName x y (Seq (oneStatement:moreStatements)) = Seq(changeName x y oneStatement:<strong>changeName x y (Seq moreStatements)</strong>)</p>\n\n<p>I can see why it would throw the error, but I have to recurse through each statement to change every variable in the statements.  Apologies if this is trivial, but I don't know I could recurse through Seq[StmtT] types without the error.</p>\n\n<p><em>note:</em> I don't think it matters what the other data types are (i.e. BExprT), just in case here is more of the module:</p>\n\n<pre><code>module SImpL where\n\ndata AExprT = ALit ValT -- a literal value (an Int)\n              | AName NameT -- a variable name (a String)\n              | Add AExprT AExprT -- one arithmetic expression added to another\n              | Sub AExprT AExprT -- one arithmetic expression subtracted from another\n              | Mult AExprT AExprT -- one arithmetic expression multiplied by another\n              deriving (Show,Eq)\n\ndata BExprT = BLit Bool -- a literal value (True or False)\n              | Eq AExprT AExprT -- an equality test between two arithmetic expressions\n              | Less AExprT AExprT -- a \"less than\" test between two arithmetic expressions\n              | Greater AExprT AExprT -- a \"greater than\" test between two arithmetic expressions\n              | Not BExprT -- the negation of a boolean expression\n              | And BExprT BExprT -- the \"and\" of two boolean expressions\n              | Or BExprT BExprT -- the \"or\" of two boolean expressions\n              deriving (Show,Eq)\n\ntype ValT = Integer\n\ntype NameT = String \n\ndata StmtT = Assign NameT AExprT |   \n             If BExprT StmtT StmtT | \n             While BExprT StmtT | \n             Seq [StmtT] -- If the list is empty, this is a statement that does nothing.    \n             deriving (Show,Eq)  \n\nIf BExprT StmtT StmtT | \n             While BExprT StmtT | \n             Seq [StmtT] -- If the list is empty, this is a statement that does nothing.    \n             deriving (Show,Eq)\n\ntype ProgT = StmtT \n\ntype StateT = [(NameT, ValT)]\n</code></pre>\n\n<p><strong>EDIT:</strong> @Ben Using map helped get around the error (since the function does not return a list now).  </p>\n"}, {"tags": ["haskell", "types", "syntax"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1489451111, "post_id": 42775562, "comment_id": 72666696, "body": "What two primes will add up to 1?"}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 0, "creation_date": 1489457392, "post_id": 42775562, "comment_id": 72668236, "body": "See <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#kinds-and-some-type-foo\" rel=\"nofollow noreferrer\">learnyouahaskell.com/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489460631, "post_id": 42775562, "comment_id": 72669014, "body": "@chepner 3 and -2, naturally."}], "answers": [{"tags": [], "owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "is_accepted": false, "score": 4, "last_activity_date": 1489449702, "creation_date": 1489449702, "answer_id": 42775601, "question_id": 42775562, "link": "https://stackoverflow.com/questions/42775562/syntax-for-functions-that-take-in-or-return-functions-in-haskell/42775601#42775601", "title": "Syntax for functions that take in or return functions in Haskell", "body": "<p>Your problem isn't one of formatting. <code>Int a</code> and <code>Int b</code> are ill-kinded. <code>Int</code> can't be applied because it isn't a (type-level) function. You just want <code>Int -&gt; [(Int, Int)]</code>.</p>\n"}], "owner": {"reputation": 155, "user_id": 7659347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vhPYA.png?s=128&g=1", "display_name": "Eben Cowley", "link": "https://stackoverflow.com/users/7659347/eben-cowley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489456717, "creation_date": 1489449516, "last_edit_date": 1489456717, "question_id": 42775562, "link": "https://stackoverflow.com/questions/42775562/syntax-for-functions-that-take-in-or-return-functions-in-haskell", "title": "Syntax for functions that take in or return functions in Haskell", "body": "<p>I'm learning Haskell via Learn You a Haskell and I'm pretty sure he went over this at some point but I can't figure out where. Say I want to have a function return a pair, list of pairs, or general tuple. How is the type signature for this written? For example, for some given even number I want to return the list of unique pairs of primes that add up to it. I have a function <code>isPrime</code> that tells whether or not an <code>Int</code> is a prime. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>pairs :: Int -&gt; [(Int a, Int b)]\npairs n\n  | n &lt; 4 = []\n  | odd n = []\n  | otherwise = [(a, b) | a &lt; b, isPrime a, isPrime b, a+b == 1]\n</code></pre>\n\n<p>When I try to compile this, I get the error saying \"Int has too few arguments.\" So I tried the following syntax instead:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>pairs :: Int -&gt; [((Int a), (Int b))]\n</code></pre>\n\n<p>But I got the same error. So in general how does typesetting functions involving pairs work?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489447514, "post_id": 42775163, "comment_id": 72665729, "body": "As a footnote...I&#39;ll keep looking at it nonstop and come back if I actually figure it out, but I&#39;ve been staring at this for hours..."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489448581, "post_id": 42775299, "comment_id": 72665977, "body": "Thanks, I think I understand your code and the first deconstruction part, but I&#39;m not sure what changeNameExpr x y b does.  Could you elaborate on why it&#39;s not sufficient to return Assign y b?"}, {"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489450083, "post_id": 42775299, "comment_id": 72666413, "body": "Ah, I think I understand now, thanks for the clarification.  Do we have to include Show and Eq cases in &#39;changeNameExpr&#39; since they are derived?"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489450267, "post_id": 42775299, "comment_id": 72666476, "body": "<code>changeNameExpr</code> as a function does not rely on anything, since the types are all concrete and thus the only relevant <code>Eq</code> is present (for <code>String</code>). Don&#39;t forget to close the question, once satisfied."}, {"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "edited": false, "score": 0, "creation_date": 1489450807, "post_id": 42775299, "comment_id": 72666611, "body": "Definitely, this solution helped greatly with understanding the project, thanks so much."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 2, "last_activity_date": 1489449328, "last_edit_date": 1489449328, "creation_date": 1489448035, "answer_id": 42775299, "question_id": 42775163, "link": "https://stackoverflow.com/questions/42775163/reformatting-a-haskell-data-constructor-type-program-and-reformatting-it/42775299#42775299", "title": "Reformatting a Haskell data constructor type program and reformatting it", "body": "<p>You are required to make a function that deconstructs a term, and if one of its components needs replacing, construct a new term.</p>\n\n<pre><code>changeNameStmt x y (Assign a b) | x == a = Assign y (changeNameExpr x y b)\n                                | otherwise = Assign a (changeNameExpr x y b)\n...\n</code></pre>\n\n<p>Since <code>Expr</code> may also refer to variables, it is necessary to recurse into it and replace all occurences there.</p>\n\n<pre><code>changeNameExpr x y (Name n) | x == n = Name y\n...\nchangeNameExpr x y (Add a b) = Add (changeNameExpr x y a) (changeNameExpr x y b)\n</code></pre>\n\n<p>Do this for all types that are involved in statements. You can define a class and make the types instances of it, if you want a polymorphic <code>changeName</code>.</p>\n"}], "owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 42775299, "answer_count": 1, "score": 0, "last_activity_date": 1489449328, "creation_date": 1489447180, "last_edit_date": 1489447903, "question_id": 42775163, "link": "https://stackoverflow.com/questions/42775163/reformatting-a-haskell-data-constructor-type-program-and-reformatting-it", "title": "Reformatting a Haskell data constructor type program and reformatting it", "body": "<p>We are given code in a SImpL.hs file that contains the following data constructors and types:</p>\n\n<pre><code>module SImpL where\n\ndata AExprT = ALit ValT -- a literal value (an Int)\n              | AName NameT -- a variable name (a String)\n              | Add AExprT AExprT -- one arithmetic expression added to another\n              | Sub AExprT AExprT -- one arithmetic expression subtracted from another\n              | Mult AExprT AExprT -- one arithmetic expression multiplied by another\n              deriving (Show,Eq)\n\ndata BExprT = BLit Bool -- a literal value (True or False)\n              | Eq AExprT AExprT -- an equality test between two arithmetic expressions\n              | Less AExprT AExprT -- a \"less than\" test between two arithmetic expressions\n              | Greater AExprT AExprT -- a \"greater than\" test between two arithmetic expressions\n              | Not BExprT -- the negation of a boolean expression\n              | And BExprT BExprT -- the \"and\" of two boolean expressions\n              | Or BExprT BExprT -- the \"or\" of two boolean expressions\n              deriving (Show,Eq)\n\ntype ValT = Integer\n\ntype NameT = String \n\ndata StmtT = Assign NameT AExprT |   \n             If BExprT StmtT StmtT | \n             While BExprT StmtT | \n             Seq [StmtT] -- If the list is empty, this is a statement that does nothing.    \n             deriving (Show,Eq)  \n\nIf BExprT StmtT StmtT | \n             While BExprT StmtT | \n             Seq [StmtT] -- If the list is empty, this is a statement that does nothing.    \n             deriving (Show,Eq)\n\ntype ProgT = StmtT \n\ntype StateT = [(NameT, ValT)]\n</code></pre>\n\n<p>We are asked to do this task:</p>\n\n<blockquote>\n  <p>Write a function called changeName which will take a SImpL program (a\n  value of type StmtT) and return a copy of this program with one of the\n  variable names changed.   This function should take three parameters:\n  two Strings and a SImpL program.  The strings represent variables\n  names.  Your function should return a copy of the program with all\n  instances of the first string replaced by the second string.  For\n  example, using a Java-like notation, if myProgram represents this\n  program:</p>\n</blockquote>\n\n<pre><code>x = 3\ny = 14\nz = 0\nwhile (x &lt; y)\n   z = z + x*y\n   x = x + 1\nanswer = z + y\n</code></pre>\n\n<blockquote>\n  <p>the result of changeName \"x\" \"number\" myProgram should be a\n  representation of this program:</p>\n</blockquote>\n\n<pre><code>number = 3\ny = 14\nz = 0\nwhile (number  &lt; y)\n    z = z + number *y\n    number = number  + 1\nanswer = z + y\n</code></pre>\n\n<blockquote>\n  <p>Your changeName function will need to have a case for each kind of\n  statement in the SImpL language and you will need a helper function to\n  change the names of variables inside expressions.</p>\n</blockquote>\n\n<p>The pseudo-code I've worked up to is here below:</p>\n\n<pre><code>module Assignment3 where\n\nimport SImpL\n\nchangeName :: String -&gt; String -&gt; StmtT -&gt; StmtT\nchangeName val1 val2 (Assign NameT AExprT) = ...\nchangeName val1 val2 (If BExprT StmtT StmtT) = ...\nchangeName val1 val2 (While BExprT StmtT) = ...\nchangeName val1 val2 (Seq [StmtT]) = ...\n</code></pre>\n\n<p>While I think I understand the basic gist of this, I am quite lost on the actual implementation of code.  For example if you run this code:</p>\n\n<pre><code>changeName \"x\" \"num\" testMyProgram...\n</code></pre>\n\n<p>where testMyProgram is simply</p>\n\n<pre><code>Assign \"x\" (ALit 3)\n</code></pre>\n\n<p>I do not know how to get Haskell to return a line of StmtT code, such as:</p>\n\n<pre><code>Assign \"num\" (ALit 3)\n</code></pre>\n\n<p>I'm pretty sure this is what the instructor wants from the instructions. </p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1489444477, "post_id": 42774477, "comment_id": 72664629, "body": "Have you tried simply specifying the package versions in the <code>--package</code> flags? E.g. <code>--package MissingH-X.Y.Z</code>."}, {"owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 2, "creation_date": 1489474853, "post_id": 42774477, "comment_id": 72673346, "body": "Yes, I get <code>Plan construction failed.</code> The <code>dictionaries</code> package is not in stackage."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1543421838, "post_id": 42774477, "comment_id": 93916470, "body": "any update on this ? I was wondering the same"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 1, "creation_date": 1543681973, "post_id": 42774477, "comment_id": 94010034, "body": "this works <code>stack runghc --resolver lts-12.20 --package raven-haskell-0.1.2.0 .&#47;using-sentry.hs</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "is_accepted": true, "score": 2, "last_activity_date": 1543682532, "creation_date": 1543682532, "answer_id": 53572916, "question_id": 42774477, "link": "https://stackoverflow.com/questions/42774477/haskell-stack-script-extra-deps/53572916#53572916", "title": "Haskell stack script extra deps", "body": "<p>It is possible to specify extra packages on the commande line using e.g.</p>\n\n<pre><code>stack runghc --resolver lts-12.20 --package raven-haskell-0.1.2.0 ./using-sentry.hs\n</code></pre>\n\n<p>it does not work with shebang style, inside the file AFAICT</p>\n"}, {"tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 1, "last_activity_date": 1589307606, "creation_date": 1589307606, "answer_id": 61759159, "question_id": 42774477, "link": "https://stackoverflow.com/questions/42774477/haskell-stack-script-extra-deps/61759159#61759159", "title": "Haskell stack script extra deps", "body": "<p>When using shebang style, you can (now at least) do <code>--extra-dep mypackage-1.3.3.7</code> within the script.</p>\n\n<p>Credit to @lyxia for pointing me to this (and more generally that I should check <code>stack script --help</code>).</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 3, "accepted_answer_id": 53572916, "answer_count": 2, "score": 8, "last_activity_date": 1589307606, "creation_date": 1489443623, "question_id": 42774477, "link": "https://stackoverflow.com/questions/42774477/haskell-stack-script-extra-deps", "title": "Haskell stack script extra deps", "body": "<p>In a normal stack project, I can add extra-deps in the stack.yaml file:</p>\n\n<pre><code>extra-deps:\n- text-1.2.2.0\n- unm-hip-0.3.1.6\n- safe-exceptions-0.1.4.0\n- quickcheck-properties-0.1\n- time-interval-0.1.1\n- time-units-1.0.0\n- snowball-1.0.0.1\n- dictionaries-0.1.0.0\nresolver: lts-8.3\n\nallow-newer: true\n</code></pre>\n\n<p>But how do I do this in a script?</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n    --resolver lts-8.5\n    --install-ghc\n    runghc\n    --package MissingH\n    --package process\n    --package attoparsec\n    --package split\n    --package dictionaries\n    --package bytestring\n-}\n</code></pre>\n"}, {"tags": ["haskell", "gearman"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1489671449, "post_id": 42774191, "comment_id": 72780474, "body": "I got some help by <a href=\"https://mail.haskell.org/pipermail/beginners/2017-March/017435.html\" rel=\"nofollow noreferrer\">haskell beginners mailinglist</a>. I&#39;ll provide an answer to my own question soon."}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1490646495, "post_id": 42774191, "comment_id": 73196235, "body": "<a href=\"https://github.com/p-alik/hgearman-client/blob/upstream/demos/submit-job.hs\" rel=\"nofollow noreferrer\">here</a> is a submit job example"}], "answers": [{"tags": [], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "is_accepted": true, "score": 0, "last_activity_date": 1492425042, "last_edit_date": 1492425042, "creation_date": 1491252570, "answer_id": 43194007, "question_id": 42774191, "link": "https://stackoverflow.com/questions/42774191/how-does-hgearman-client-work/43194007#43194007", "title": "how does hgearman-client work?", "body": "<p>Below is my implementation of Gearman Client:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\nimport Control.Exception (Exception, IOException, catch, throwIO)\nimport qualified Data.ByteString.Char8 as B\nimport Data.Typeable     (Typeable)\nimport qualified Network.Gearman.Client as C\nimport Network.Gearman.Internal (Function, GearmanClient, GearmanError, Port, withGearman)\nimport Network.Socket (HostName)\n\ndata ConnectException = ConnectException HostName Port IOException\n    deriving (Show, Typeable)\ninstance Exception ConnectException\n\nmain :: IO ()\nmain = do\n  c &lt;- C.connectGearman (B.pack \"client-id\") host port `catch` \\e -&gt; throwIO (ConnectException host port e)\n  either (error . B.unpack) return c\n    &gt;&gt;= submitFooJob\n    &gt;&gt;= either(error . B.unpack) (putStrLn . B.unpack)\n  return ()\n    where\n      host = \"localhost\"::HostName\n      port =  4730::Port\n      submitFooJob :: GearmanClient -&gt; IO (Either GearmanError B.ByteString)\n      submitFooJob gc = withGearman gc $ C.submitJob (B.pack \"foo\"::Function) (B.pack \"bar\")\n</code></pre>\n"}], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43194007, "answer_count": 1, "score": 0, "last_activity_date": 1492425042, "creation_date": 1489442358, "question_id": 42774191, "link": "https://stackoverflow.com/questions/42774191/how-does-hgearman-client-work", "title": "how does hgearman-client work?", "body": "<p>Unfortunately the package <a href=\"https://hackage.haskell.org/package/hgearman-0.1.0.2/docs/Network-Gearman-Client.html\" rel=\"nofollow noreferrer\">hgearman</a> does not provide any test or example and I can't work it out for myself how should be combined <code>connectGearman</code> and <code>submitJob</code> to put a job to the <a href=\"http://gearman.org/\" rel=\"nofollow noreferrer\">gearman job server</a>.</p>\n\n<p>The result of <code>connectGearman</code> is:</p>\n\n<pre><code>ghci&gt; conn &lt;- connectGearman (B.pack \"x\") (\"localhost\"::HostName) (4730::Port)\nghci&gt; :t conn\nconn :: Either GearmanError GearmanClient\n</code></pre>\n\n<p>but <code>submitJob</code> uses private function <a href=\"https://github.com/jperson/hgearman-client/blob/master/Network/Gearman/Client.hs#L63\" rel=\"nofollow noreferrer\"><code>submit</code></a> which deals with <code>StateT</code>. So I can only guess the result of <code>connectGearman</code> should be wrapped into <a href=\"https://github.com/jperson/hgearman-client/blob/master/Network/Gearman/Internal.hs#L27\" rel=\"nofollow noreferrer\"><code>S.StateT GearmanClient IO</code></a> without faintest idea how to do that.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1489442169, "post_id": 42774128, "comment_id": 72663662, "body": "Might be worth explaining <code>[y,y-1 .. 1]</code> being <code>[]</code>. Section <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1310006.3.4\" rel=\"nofollow noreferrer\">6.3.4 The Enum Class</a> goes into some detail. I wasn&#39;t aware of all this behavior."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489442322, "post_id": 42774128, "comment_id": 72663742, "body": "@Alec Indeed, I think I also figured it out right now! Added."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1489442741, "last_edit_date": 1489442741, "creation_date": 1489442059, "answer_id": 42774128, "question_id": 42773864, "link": "https://stackoverflow.com/questions/42773864/function-returns-zero-if-parameter-has-more-than-7-zeros/42774128#42774128", "title": "Function returns zero if parameter has more than 7 zeros", "body": "<p>Here's why:</p>\n\n<pre><code>&gt; let y :: Float ; y = fromInteger (100000000 :: Integer)\n&gt; y == y-1\nTrue\n&gt; [y, y-1 .. 1]\n[]\n</code></pre>\n\n<p>Basically, a <code>Float</code> can not count from 10^8 downwards to 1, with unit steps. </p>\n\n<p>Rounding errors make <code>y</code> and <code>y-1</code> the same number, hence the notation <code>[y,y-1 .. 1]</code> is interpreted as an <em>increasing</em> sequence, like e.g. <code>[10,10 .. 1]</code>. Since the starting value is already over <code>1</code>, no element gets put in the output list.</p>\n\n<p>Quoting from the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1310006.3.4\" rel=\"nofollow noreferrer\">Haskell 2010 report</a>:</p>\n\n<blockquote>\n  <p>The sequence <code>enumFromThenTo e1 e2 e3</code> is the list <code>[e1,e1 + i,e1 + 2i,\u2026e3]</code>, where the increment, <code>i</code>, is <code>e2 \u2212 e1</code>. If the increment is\n  positive or zero, the list terminates when the next element would be\n  greater than <code>e3</code>; the list is empty if <code>e1  &gt;  e3</code>. If the increment is\n  negative, the list terminates when the next element would be less than\n  <code>e3</code>; the list is empty if <code>e1  &lt;  e3</code>.</p>\n</blockquote>\n\n<p>Arguably, Haskell should have different notations for increasing and decreasing ranges. For <code>[y, y-1 .. 1]</code>, I guess <code>repeat y</code> would be a less surprising output than <code>[]</code>.</p>\n"}], "owner": {"reputation": 438, "user_id": 6371869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mUzus.jpg?s=128&g=1", "display_name": "Shadasviar", "link": "https://stackoverflow.com/users/6371869/shadasviar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 42774128, "answer_count": 1, "score": 1, "last_activity_date": 1610504418, "creation_date": 1489441022, "last_edit_date": 1610504418, "question_id": 42773864, "link": "https://stackoverflow.com/questions/42773864/function-returns-zero-if-parameter-has-more-than-7-zeros", "title": "Function returns zero if parameter has more than 7 zeros", "body": "<p>I wrote a haskell function which counts pi number with precision given as parameter:</p>\n<pre><code>mojePi :: Integer -&gt; Float\nmojePi x = sqrt $ 6 * mySum x\n    where\n        mySum 1 = 1\n        mySum x = sum $ map (1/) $ map (**2) [y,y-1..1]\n            where\n                y = fromInteger x\n</code></pre>\n<p>If I run this function with <code>10000000</code>(7 zeros) it works fine, but with <code>100000000</code>(8 zeros) and more it immediately returns <code>0</code>.\nWhy does it happen?</p>\n"}, {"tags": ["haskell", "syntax", "type-kinds"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "is_accepted": false, "score": 3, "last_activity_date": 1489439231, "last_edit_date": 1489439231, "creation_date": 1489439160, "answer_id": 42773425, "question_id": 42773217, "link": "https://stackoverflow.com/questions/42773217/what-does-weird-notation-after-type-class-declaration-mean/42773425#42773425", "title": "What does weird notation after type class declaration mean", "body": "<p>The asterisk <code>*</code> is the Haskell symbol for <em>kinds</em>, the \"types of types\".</p>\n\n<pre><code>Prelude&gt; :k Int\nInt :: *\nPrelude&gt; :k Maybe\nMaybe :: * -&gt; *\nPrelude&gt; :k []\n[] :: * -&gt; *\nPrelude&gt; :k Maybe Int\nMaybe Int :: *\n</code></pre>\n\n<p>The <code>Functor</code> class is defined for type constructors of kind <code>* -&gt; *</code>, which take one type and return a type.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "closed_date": 1489445369, "answer_count": 1, "score": 3, "last_activity_date": 1489456791, "creation_date": 1489438418, "last_edit_date": 1489456791, "question_id": 42773217, "link": "https://stackoverflow.com/questions/42773217/what-does-weird-notation-after-type-class-declaration-mean", "closed_reason": "Duplicate", "title": "What does weird notation after type class declaration mean", "body": "<p>In <code>ghci</code> <code>:i Functor</code> gives me:</p>\n\n<pre><code>class Functor (f :: * -&gt; *) where\n  fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n  ...\n</code></pre>\n\n<p>What does <code>(f :: * -&gt; *)</code> mean? It looks as if <code>f</code> needs to be a function, but that doesn't make sense.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1489438885, "post_id": 42772646, "comment_id": 72662085, "body": "Very minor simplification you might like: <code>if foo then True else False</code> = <code>foo</code>."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 3, "last_activity_date": 1489436880, "creation_date": 1489436880, "answer_id": 42772834, "question_id": 42772646, "link": "https://stackoverflow.com/questions/42772646/haskell-execute-io-action-and-extract-value-inside-list-comprehension/42772834#42772834", "title": "Haskell: execute IO action and extract value inside list comprehension", "body": "<p>You can use the <code>sequence</code> method from <code>Traversable</code>:</p>\n\n<pre><code>sequence :: (Traversable t, Monad m) =&gt; t (m a) -&gt; m (t a)\n</code></pre>\n\n<p>In your case, it will have the type:</p>\n\n<pre><code>sequence :: [IO Bool] -&gt; IO [Bool]\n</code></pre>\n"}], "owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 42772834, "answer_count": 1, "score": 1, "last_activity_date": 1489436880, "creation_date": 1489436180, "question_id": 42772646, "link": "https://stackoverflow.com/questions/42772646/haskell-execute-io-action-and-extract-value-inside-list-comprehension", "title": "Haskell: execute IO action and extract value inside list comprehension", "body": "<p>I am trying to generate a list of randomized boolean values based on a moving threshold.</p>\n\n<p>This is my code. The function at issue is <code>isActionRandom</code>:</p>\n\n<pre><code>randomBool :: Int -&gt; IO Bool\nrandomBool p = do n &lt;- randomRIO(1,100)\n              return (if n &gt; p then True else False)\n\nisActionRandom :: Float -&gt; Int -&gt; Int -&gt; Int -&gt; IO [Bool]\nisActionRandom eps n m step = [ randomBool (floor (eps-(0.01*y) * 100))\n                            | x &lt;- [1..(n*m)]\n                            , y &lt;- floor(x/(m*step))]\n</code></pre>\n\n<p><code>isActionRandom</code> does not compile because the list created is type <code>[IO Bool]</code> and not <code>IO [Bool]</code> as I intended. How do I \"extract\" the boolean value from the IO function at each iteration, and build a list of the intended type?</p>\n"}, {"tags": ["algorithm", "haskell", "recursion", "artificial-intelligence", "dpll"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489438351, "post_id": 42772275, "comment_id": 72661808, "body": "I&#39;m not yet sure I understand the problem. What does &quot;it will always return integer value from the moment the recursion started&quot; mean?"}, {"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489439979, "post_id": 42772275, "comment_id": 72662673, "body": "In one possible solution I used (True,Int) tuple to return node counter. As DPLL function reached OR statement and after applying recursion n times until Model satisfied Sentence, function evaluates the OR statement at the same level as the initial ORed recursion started ultimately returning counter from that particular level of recursion. I hope you can understand the problem now. Thank you."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489440515, "post_id": 42772275, "comment_id": 72662895, "body": "So, are you asking how to merge the two <code>Int</code>s returned from the two calls to <code>dpll&#39;</code> in the <code>v:vs</code> case of <code>recurUsingHeuristicFunction</code>? If so, why is <code>(+)</code> not the right way to merge them?"}, {"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489440615, "post_id": 42772275, "comment_id": 72662937, "body": "If you think that using tuple (Bool,Int) would solve the problem then yes. In my attempt to solve it I was basically unable to retrieve counter values from lower levels of recursion in OR statement."}, {"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489440930, "post_id": 42772275, "comment_id": 72663079, "body": "I tried increasing the counter by one on each recursive call but it always returns the counter value from the level at which OR statement was first evaluated (just after all pure symbols and unit clauses were used)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1489440948, "post_id": 42772275, "comment_id": 72663086, "body": "You should include an MWE: the smallest complete snippet of code that exhibits the behavior you don&#39;t like, together with a description of how to run it, what you expect to happen, and what happens instead."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489438489, "post_id": 42772610, "comment_id": 72661875, "body": "The second solution is really interesting but unfortunately I&#39;m allowed to use only basic libraries (see updated question, sorry for confusion). Could you give me an example on how the first solution works? Thanks"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489441060, "post_id": 42772610, "comment_id": 72663133, "body": "Just turn your pure function from <code>a -&gt; ... -&gt; b</code> into a function <code>a -&gt; ... -&gt; Int -&gt; (b, Int)</code> like <code>f a = expression</code> becomes <code>f a c = (expression, if ... then c + 1 else c)</code> then you will need to extract the new state when ever you need to pass it to some callee. At some point you will want your function to return <code>(Bool, Int)</code> where the <code>Int</code> is the current state. :) if however your state changes only along one recursion path then you can simply extend your function with an argument expressing the current count and add that number to output on the base case of your recursion."}, {"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489442260, "post_id": 42772610, "comment_id": 72663715, "body": "I think this is in some sense similar to what I was trying to do (see second code snippet). I would really appreciate if you can take a look at my &#39;solution&#39; and somehow show me what&#39;s wrong with it. Thanks!"}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1489441683, "last_edit_date": 1489441683, "creation_date": 1489436038, "answer_id": 42772610, "question_id": 42772275, "link": "https://stackoverflow.com/questions/42772275/dpll-algorithm-and-number-of-visited-nodes/42772610#42772610", "title": "DPLL algorithm and number of visited nodes", "body": "<p>Basically what you described as your solution in imperative language can be modeled by passing around a counting variable, adding the variable to the result at the time you return it (the bottom of recursion that reaches satisfiable assignment), i.e. for a function <code>a -&gt; b</code> you would create a new function <code>a -&gt; Int -&gt; (b, Int)</code>. The <code>Int</code> argument is the current state of the counter, the result is enriched with the updated state of the counter.</p>\n\n<p>This can further be re-expressed elegantly using the <a href=\"https://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-State-Lazy.html\" rel=\"nofollow noreferrer\">state monad</a>. A very nice tutorial on haskell in general and state monad is <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#state\" rel=\"nofollow noreferrer\">here</a>. Basically the transformation of <code>a -&gt; b</code> to <code>a -&gt; Int -&gt; (b, Int)</code> can be seen as transformation of <code>a -&gt; b</code> into <code>a -&gt; State Int b</code> by simply given a nicer name to the function <code>Int -&gt; (b, Int)</code>. There is a very nice <a href=\"https://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/\" rel=\"nofollow noreferrer\">blog</a> that explains where these nice abstractions come from in a very accessible way.</p>\n\n<pre><code>import Control.Monad.Trans.StateT\n\ntype Count = Int\n\ndpllM :: (Node -&gt; Variable) -&gt; Sentence -&gt; [Variable] -&gt; Model -&gt; State Count Bool\ndpllM heurFun sentence vars model | ... = do\n    -- do your thing\n    modify (+1)\n    -- do your thing\n\ndpll' :: (Node -&gt; Variable) -&gt; Sentence -&gt; [Variable] -&gt; Model -&gt; Bool\ndpll' heurFun sentence vars model = runState (dpllM heurFun sentence vars model) 0\n</code></pre>\n\n<hr>\n\n<p>Maybe you want something like</p>\n\n<pre><code>f :: A -&gt; Int -&gt; (Bool, Int)\nf a c =\n    let a' = ...\n        a'' = ...\n        (b', c') = f a' c in f a'' c'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489443374, "post_id": 42774158, "comment_id": 72664185, "body": "It works! Great. Thank you. However, It adds a huge overhead. Version without the counter solves one of my test problems in 4s while version with the counter solves exactly the same problem in 22s. What might be the problem?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489443746, "post_id": 42774158, "comment_id": 72664330, "body": "@jdet My blind stab would be to add <code>~</code> to the patterns (or use <code>let</code> instead of <code>case</code>), as in <code>case dpll&#39;&#39; ... of ~(result, counter) -&gt; ...</code>. A second try would be to force <code>counter</code> more carefully when it&#39;s an argument. But a real (experimentally-tested, rather than off-the-cuff) answer requires you taking the time to turn this into a real question."}, {"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489444230, "post_id": 42774158, "comment_id": 72664530, "body": "I think it might be case that now DPLL must evaluate both sides of OR statement while It could terminate early in the previous implementation as soon as lhs evaluated to True. I&#39;ll try to solve it on my own. However, thank you for your help Daniel. I really appreciate it."}, {"owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "edited": false, "score": 0, "creation_date": 1489444520, "post_id": 42774158, "comment_id": 72664640, "body": "Simple if statement solved the problem. Thanks again Daniel!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1489442199, "creation_date": 1489442199, "answer_id": 42774158, "question_id": 42772275, "link": "https://stackoverflow.com/questions/42772275/dpll-algorithm-and-number-of-visited-nodes/42774158#42774158", "title": "DPLL algorithm and number of visited nodes", "body": "<p>You can retrieve the counter from the recursive call using <code>case</code> or similar.</p>\n\n<pre><code>recurUsingHeuristicFunction = case vars of\n    v:vs -&gt; case dpll'' heurFun sentence (vars \\\\ [heurVar]) (AS (heurVar,True):model) (counter + 1) of\n        (result, counter') -&gt; case dpll'' heurFun sentence (vars \\\\ [heurVar]) (AS (heurVar,False):model) counter' of\n            (result', counter'') -&gt; (result || result', counter'')\n    []   -&gt; (False,counter)\n</code></pre>\n\n<p>This is a manual implementation of the <code>State</code> monad. However, it's not clear to me why you are passing in a counter at all. Just return it. Then it is the simpler <code>Writer</code> monad instead. The code for this helper would look something like this:</p>\n\n<pre><code>recurUsingHeuristicFunction = case vars of\n    v:vs -&gt; case dpll'' heurFun sentence (vars \\\\ [heurVar]) (AS (heurVar,True):model) of\n        (result, counter) -&gt; case dpll'' heurFun sentence (vars \\\\ [heurVar]) (AS (heurVar,False):model) of\n            (result', counter') -&gt; (result || result', counter + counter' + 1)\n    []   -&gt; (False,0)\n</code></pre>\n\n<p>Other results would be similar -- returning <code>0</code> instead of <code>counter</code> and <code>1</code> instead of <code>counter+1</code> -- and the call to the function would be simpler, with one fewer argument to worry about setting up correctly.</p>\n"}], "owner": {"reputation": 15, "user_id": 7388053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971a64c6854f8446d1784dd8ecd0d463?s=128&d=identicon&r=PG&f=1", "display_name": "jdet", "link": "https://stackoverflow.com/users/7388053/jdet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 42774158, "answer_count": 2, "score": 0, "last_activity_date": 1580476322, "creation_date": 1489434794, "last_edit_date": 1580476322, "question_id": 42772275, "link": "https://stackoverflow.com/questions/42772275/dpll-algorithm-and-number-of-visited-nodes", "title": "DPLL algorithm and number of visited nodes", "body": "<p>I'm implementing DPLL algorithm that counts the number of visited nodes. I managed to implement DPLL that doesn't count visited nodes but I can't think of any solutions to the problem of counting. The main problem is that as the algorithm finds satisfying valuation and returns True, the recursion rolls up and returns counter from the moment the recursion started. In any imperative language I would just use global variable and increment it as soon as function is invoked, but it is not the case in Haskell.</p>\n\n<p>The code I pasted here does not represent my attempts to solve the counting problem, it is just my solution without it. I tried to use tuples such as (True,Int) but it will always return integer value from the moment the recursion started.</p>\n\n<p>This is my implementation where (Node -> Variable) is a heuristic function, Sentence is list of clauses in CNF to be satisfied, [Variable] is a list of Literals not assigned and Model is just a truth valuation.</p>\n\n<pre><code>dpll' :: (Node -&gt; Variable) -&gt; Sentence -&gt; [Variable] -&gt; Model -&gt; Bool\ndpll' heurFun sentence vars model\n  | satisfiesSentence model sentence  = True\n  | falsifiesSentence model sentence  = False\n  | otherwise         = applyRecursion\n    where\n      applyRecursion\n        | pureSymbol /= Nothing = recurOnPureSymbol\n        | unitSymbol /= Nothing = recurOnUnitSymbol\n        | otherwise             = recurUsingHeuristicFunction\n          where\n            pureSymbol  = findPureSymbol vars sentence model\n            unitSymbol  = findUnitClause sentence model\n            heurVar = heurFun (sentence,(vars,model))\n            recurOnPureSymbol =\n              dpll' heurFun sentence (vars \\\\ [getVar pureSymbol]) ((formAssignment pureSymbol):model)\n            recurOnUnitSymbol =\n              dpll' heurFun sentence (vars \\\\ [getVar unitSymbol]) ((formAssignment unitSymbol):model)\n            recurUsingHeuristicFunction = case vars of\n              (v:vs) -&gt;     (dpll' heurFun sentence (vars \\\\ [heurVar]) ((AS (heurVar,True)):model)\n                        ||   dpll' heurFun sentence (vars \\\\ [heurVar]) ((AS (heurVar,False)):model))\n              []     -&gt;     False\n</code></pre>\n\n<p>I would really appreciate any advice on how to count the visited nodes. Thank you.</p>\n\n<p>EDIT:</p>\n\n<p>The only libraries I'm allowed to use are System.Random, Data.Maybe and Data.List.</p>\n\n<p>EDIT:</p>\n\n<p>One possible solution I tried to implement is to use a tuple (Bool,Int) as a return value from DPPL function. The code looks like:</p>\n\n<pre><code>dpll'' :: (Node -&gt; Variable) -&gt; Sentence -&gt; [Variable] -&gt; Model -&gt; Int -&gt; (Bool,Int)\ndpll'' heurFun sentence vars model counter\n  | satisfiesSentence model sentence  = (True,counter)\n  | falsifiesSentence model sentence  = (False,counter)\n  | otherwise         = applyRecursion\n  where\n    applyRecursion\n      | pureSymbol /= Nothing = recurOnPureSymbol\n      | unitSymbol /= Nothing = recurOnUnitSymbol\n      | otherwise             = recurUsingHeuristicFunction\n      where\n        pureSymbol  = findPureSymbol vars sentence model\n        unitSymbol  = findUnitClause sentence model\n        heurVar = heurFun (sentence,(vars,model))\n        recurOnPureSymbol =\n          dpll'' heurFun sentence (vars \\\\ [getVar pureSymbol]) ((formAssignment pureSymbol):model) (counter + 1)\n        recurOnUnitSymbol =\n          dpll'' heurFun sentence (vars \\\\ [getVar unitSymbol]) ((formAssignment unitSymbol):model) (counter + 1)\n        recurUsingHeuristicFunction = case vars of\n          (v:vs)    -&gt;    ((fst $ dpll'' heurFun sentence (vars \\\\ [heurVar]) ((AS (heurVar,True)):model) (counter + 1))\n                      ||  (fst $ dpll'' heurFun sentence (vars \\\\ [heurVar]) ((AS (heurVar,False)):model) (counter + 1)),counter)\n          []        -&gt; (False,counter)\n</code></pre>\n\n<p>The basic idea of this approach is to increment the counter at each recursive call. However, the problem with this approach is that I have no idea how to retrieve counter from recursive calls in OR statement. I'm not even sure if this is possible in Haskell.</p>\n"}, {"tags": ["c", "performance", "haskell", "fibonacci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1489431367, "post_id": 42771348, "comment_id": 72658101, "body": "Don&#39;t use <code>ghci</code> for benchmarking: compile with <code>ghc</code> optimized and run that program..."}, {"owner": {"reputation": 97941, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 4, "creation_date": 1489431624, "post_id": 42771348, "comment_id": 72658240, "body": "I believe <code>fib_seq(42)</code> overflows c integer. You get a fast, wrong value (not to mention <b>undefined behaviour</b>) with larger values."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1489431639, "post_id": 42771348, "comment_id": 72658248, "body": "Furthermore in Haskell you <b>construct a list</b>. That is another task than calculating the <i>i</i>-th number."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1489431747, "post_id": 42771348, "comment_id": 72658319, "body": "&quot;[The] C code and Haskell code I wrote both do the same exact steps&quot; -- they don&#39;t; for one, as Willem Van Onsem points out, there aren&#39;t lists anywhere in your C code. You may find <a href=\"http://stackoverflow.com/q/42754808/2751851\">this question asked yesteday</a> relevant."}, {"owner": {"reputation": 139, "user_id": 7704753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74ddd9ab1a9c707fb630b67b190b68b?s=128&d=identicon&r=PG&f=1", "display_name": "sigsegv", "link": "https://stackoverflow.com/users/7704753/sigsegv"}, "reply_to_user": {"reputation": 97941, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1489431774, "post_id": 42771348, "comment_id": 72658330, "body": "@pmg I not going for 42 fibonacci numbers, I limit myself to 40. So, I don&#39;t have the overflow."}, {"owner": {"reputation": 139, "user_id": 7704753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74ddd9ab1a9c707fb630b67b190b68b?s=128&d=identicon&r=PG&f=1", "display_name": "sigsegv", "link": "https://stackoverflow.com/users/7704753/sigsegv"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489432051, "post_id": 42771348, "comment_id": 72658472, "body": "@duplode Aren&#39;t they the same, in C I am printing and in Haskell, I am just adding to the end of the list. In Haskell I am not doing recursion twice, (as other people on internet do and hence get directed to memoization) it&#39;s just one time recursion and adding to the list, like in C - one time recursion and print.  Also, are you saying that if I used a list in C, C will be as slow as Haskell?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489432569, "post_id": 42771348, "comment_id": 72658736, "body": "See also <a href=\"http://stackoverflow.com/tags/haskell/info\">the section on performance in the tag wiki</a> which covers everything relevant here."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1489432836, "post_id": 42771348, "comment_id": 72658901, "body": "@Ayatana I&#39;m not making any claims about C. I just meant to point out that they aren&#39;t <i>literally</i> the same steps, and that the correspondence between them might not be quite as straightforward as your question suggests. (Cf. Daniel Wagner&#39;s answer.)"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1489437562, "post_id": 42771348, "comment_id": 72661411, "body": "@Ayatana: &quot;just adding to the end of the list&quot; may involve quite a bit of memory management.  Doing dynamic memory management in C will slow the C version down a bit.  Maybe not enough to be measurable without a lot of samples, but a bit.  As Daniel Wagner shows, algorithm and tool choice matter a <i>lot</i>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 17, "last_activity_date": 1489432630, "last_edit_date": 1489432630, "creation_date": 1489432273, "answer_id": 42771623, "question_id": 42771348, "link": "https://stackoverflow.com/questions/42771348/why-is-haskell-so-slow-compared-to-c-for-fibonacci-sequence/42771623#42771623", "title": "Why is Haskell so slow compared to C for Fibonacci sequence?", "body": "<p>The following program, compiled with <code>ghc -O2 test.hs</code>, is +/-2% the speed of the C code you posted, compiled with <code>gcc -O2 test.c</code>.</p>\n\n<pre><code>fib_seq :: Int -&gt; Int\nfib_seq 1 = 1\nfib_seq 2 = 1\nfib_seq n = fib_seq (n-1) + fib_seq (n-2)\n\nmain = mapM_ (print . fib_seq) [40,39..1]\n</code></pre>\n\n<p>Some comments:</p>\n\n<ol>\n<li>Unlike you, I implemented the exact same logic. I doubt this is the real difference, though; see the remaining comments for much more likely causes.</li>\n<li>I specified the same types as C uses for the arithmetic. You didn't, which is likely to run into two problems: using <code>Integer</code> instead of <code>Int</code> for largenum arithmetic, and having a class-polymorphic type instead of a monomorphic one adding overhead on every function call.</li>\n<li>I compiled. ghci is built to be interactive as quickly as possible, not to produce quick code.</li>\n<li>I don't have the right version of llvm installed at the moment, but it will often crunch through heavily-numeric code like this much better than ghc's own codegen. I wouldn't be too surprised if it ended up being faster than gcc.</li>\n</ol>\n\n<p>Of course using one of the many well-known better algorithms for fibonacci is going to trump all this nonsense.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7713935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d095fbcb383dd79cee776e7f5f8c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/7713935/oliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1489573038, "last_edit_date": 1489573038, "creation_date": 1489571770, "answer_id": 42806302, "question_id": 42771348, "link": "https://stackoverflow.com/questions/42771348/why-is-haskell-so-slow-compared-to-c-for-fibonacci-sequence/42806302#42806302", "title": "Why is Haskell so slow compared to C for Fibonacci sequence?", "body": "<p>Guess what happens if \"fib_seq (n-1)\" is evaluated twice on each recursion.\nAnd then try this:</p>\n\n<pre><code>fib_seq 1 = 1:[]\nfib_seq 2 = 1:1:[]\nfib_seq n = sum(take 2 f):f\n            where f = fib_seq (n-1)\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 7704753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74ddd9ab1a9c707fb630b67b190b68b?s=128&d=identicon&r=PG&f=1", "display_name": "sigsegv", "link": "https://stackoverflow.com/users/7704753/sigsegv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1489573038, "creation_date": 1489431332, "last_edit_date": 1489439916, "question_id": 42771348, "link": "https://stackoverflow.com/questions/42771348/why-is-haskell-so-slow-compared-to-c-for-fibonacci-sequence", "title": "Why is Haskell so slow compared to C for Fibonacci sequence?", "body": "<p>I am just beginner in Haskell. And I writing a code to display the N numbers in the Fibonacci sequence. Here is my code in Haskell,</p>\n\n<pre><code>fib_seq 1 = 1:[]\nfib_seq 2 = 1:1:[]\nfib_seq n = sum(take 2 (fib_seq (n-1))):fib_seq (n-1)\n</code></pre>\n\n<p>When I run this code for higher numbers like <code>fib_seq 40</code> in GHCI, it takes a long time to evaluate it and my computer hangs and I have to interrupt. However, when I write the same exact logic in C, (I just print instead of saving it in the list),</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint fib_seq (int n){\n    if(n==1)        return 1;\n    else if(n==2)   return 1;\n    else            return fib_seq(n-1)+fib_seq(n-2);   }\n\n\nvoid print_fib(int n){\n    if(n==0)    return;\n    else        printf(\"%i \", fib_seq(n));\n                print_fib(n-1);     }\n\nint main(int argn, char* argc){\n    print_fib(40);\n    return 0;     }\n</code></pre>\n\n<p>The code is very fast. Takes about 1 second to run when compiled with GCC. Is Haskell supposed to be this slow than C? I have looked up other answers on the internet and they say something about memoization. I am beginning Haskell and I don't know what that means. What I am saying is that the C code and Haskell code I wrote both do the same exact steps and Haskell is so much slower than C, it hangs my GHCI. A 1-2 seconds difference is something I will never worry about, and if C also had taken the same exact time as Haskell, I would also not worry about. But Haskell crashing and C doing it in 1 seconds is unacceptable.</p>\n"}, {"tags": ["haskell", "monoids"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1489430012, "post_id": 42770703, "comment_id": 72657389, "body": "The behavior you are (probably) thinking of is encoded in <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Applicative.html#t:Alternative\" rel=\"nofollow noreferrer\"><code>Alternative</code></a>. <code>empty :: Maybe Bool</code> is <code>Nothing</code> and <code>(&lt;|&gt;)</code> takes the first non-<code>Nothing</code> value."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 10246, "user_id": 762363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cec6320f5a5a8253b3dbfbb8177e001?s=128&d=identicon&r=PG", "display_name": "Tarmil", "link": "https://stackoverflow.com/users/762363/tarmil"}, "edited": false, "score": 0, "creation_date": 1489431311, "post_id": 42770909, "comment_id": 72658065, "body": "@Tarmil (For completeness, the other two monoids on <code>Bool</code> are <code>(&#47;=)&#47;False</code> and <code>(==)&#47;True</code>, which are basically <code>Sum Word1</code> with the two possible representations of <code>Word1</code> as <code>Bool</code>.)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1489439449, "post_id": 42770909, "comment_id": 72662401, "body": "These are also called the XOR and XNOR monoids, for obvious reasons. (Obvious if you know what XOR and XNOR are, at least.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1489430689, "last_edit_date": 1489430689, "creation_date": 1489429826, "answer_id": 42770909, "question_id": 42770703, "link": "https://stackoverflow.com/questions/42770703/why-does-mempty-evaluate-the-content-of-the-monoid/42770909#42770909", "title": "Why does mempty evaluate the content of the Monoid", "body": "<p>For lists, <code>[a]</code> is a <code>Monoid</code> <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-240\" rel=\"nofollow noreferrer\">no matter what</a>:</p>\n\n<pre><code>instance {- no requirements on a here! =&gt; -} Monoid [a] where\n    ...\n</code></pre>\n\n<p>So <code>String</code> is a monoid without further inspection of the properties of <code>Char</code>. But <code>Maybe a</code> is <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-314\" rel=\"nofollow noreferrer\">only an instance of <code>Monoid</code> if <code>a</code> is</a>:</p>\n\n<pre><code>instance Monoid a =&gt; Monoid (Maybe a) where\n    ...\n</code></pre>\n\n<p>So for <code>Maybe Bool</code> to be a monoid, we must check that <code>Bool</code> is a monoid. This fully explains your error message.</p>\n\n<p>Followup question number one: why does <code>a</code> need to be a <code>Monoid</code>? That is so that we can write <code>mappend</code>:</p>\n\n<pre><code>    Just m1 `mappend` Just m2 = Just (m1 `mappend` m2)\n</code></pre>\n\n<p>Of course, you really only need <code>Semigroup</code> for that; but this subtle difference is irrelevant because <code>Bool</code> isn't a <code>Semigroup</code>, either.</p>\n\n<p>Followup question number two: why isn't <code>Bool</code> a <code>Monoid</code>? Because there are several good instances, and it's not clear which to \"bless\" as the official instance. So the instances are attached to <code>newtype</code>s over <code>Bool</code>; the two most common are <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:Any\" rel=\"nofollow noreferrer\"><code>Any</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:All\" rel=\"nofollow noreferrer\"><code>All</code></a>.</p>\n\n<p>Followup question number three: what are your alternatives? You might like <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:First\" rel=\"nofollow noreferrer\"><code>First</code></a> or <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:Last\" rel=\"nofollow noreferrer\"><code>Last</code></a> for the monoids that keep the first (resp. last) <code>Just</code> they see. There is also the standard instance and an instance where <code>mempty = pure mempty; mappend = liftA2 mappend</code> though I don't know a standard place for this.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1489430850, "last_edit_date": 1495540427, "creation_date": 1489430424, "answer_id": 42771079, "question_id": 42770703, "link": "https://stackoverflow.com/questions/42770703/why-does-mempty-evaluate-the-content-of-the-monoid/42771079#42771079", "title": "Why does mempty evaluate the content of the Monoid", "body": "<p>This is the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-314\" rel=\"nofollow noreferrer\"><code>Monoid</code> instance for <code>Maybe</code></a>:</p>\n\n<pre><code>instance Monoid a =&gt; Monoid (Maybe a) where\n  mempty = Nothing\n  Nothing `mappend` m = m\n  m `mappend` Nothing = m\n  Just m1 `mappend` Just m2 = Just (m1 `mappend` m2)\n</code></pre>\n\n<p>It requires the underlying type to have a <code>Monoid</code> instance because its own <code>mappend</code> delegates to that of the underlying type. Note that this <code>Monoid</code> constraint is unnecessarily restrictive, as the underlying <code>mempty</code> isn't actually used. A more appropriate take on that is provided as <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Semigroup.html#t:Option\" rel=\"nofollow noreferrer\"><code>Option</code> in <code>Data.Semigroup</code></a> (a <code>Semigroup</code> is a <code>Monoid</code> without <code>mempty</code>):</p>\n\n<pre><code>-- Paraphrasing the relevant bits of the source.\ninstance Semigroup a =&gt; Semigroup (Maybe a) where\n  Nothing &lt;&gt; b       = b\n  a       &lt;&gt; Nothing = a\n  Just a  &lt;&gt; Just b  = Just (a &lt;&gt; b)\n\nnewtype Option a = Option { getOption :: Maybe a }\n\ninstance Semigroup a =&gt; Semigroup (Option a) where\n  Option ma &lt;&gt; Option mb = Option (ma &lt;&gt; mb)\n\ninstance Semigroup a =&gt; Monoid (Option a) where\n  mempty = Option Nothing\n  mappend = (&lt;&gt;)\n</code></pre>\n\n<p>If you want a <code>Monoid</code> for <code>Maybe</code> that doesn't care about the underlying type, have a look at the newtype wrappers provided by <code>Data.Monoid</code>: <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:First\" rel=\"nofollow noreferrer\"><code>First</code></a> (or <code>Alt Maybe</code>) for the left-biased one and <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:Last\" rel=\"nofollow noreferrer\"><code>Last</code></a> (or <code>Dual (Alt Maybe)</code>) for the right-biased one.</p>\n\n<pre><code>-- For instance, this is the First monoid:\nnewtype First a = First { getFirst :: Maybe a }\n\ninstance Monoid (First a) where\n        mempty = First Nothing\n        First Nothing `mappend` r = r\n        l `mappend` _             = l\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; import Data.Monoid\nGHCi&gt; First Nothing &lt;&gt; First Nothing\nFirst {getFirst = Nothing}\nGHCi&gt; First (Just 3) &lt;&gt; First Nothing\nFirst {getFirst = Just 3}\nGHCi&gt; First Nothing &lt;&gt; First (Just 3)\nFirst {getFirst = Just 3}\nGHCi&gt; First (Just 3) &lt;&gt; First (Just 4)\nFirst {getFirst = Just 3}\nGHCi&gt; Last (Just 3) &lt;&gt; Last (Just 4)\nLast {getLast = Just 4}\nGHCi&gt; Alt (Just 3) &lt;&gt; Alt (Just 4)\nAlt {getAlt = Just 3}\nGHCi&gt; Dual (Alt (Just 3)) &lt;&gt; Dual (Alt (Just 4))\nDual {getDual = Alt {getAlt = Just 4}}\n</code></pre>\n\n<p>(By the way, <code>Alt</code> delegates <code>mempty</code> and <code>mappend</code> to the <code>Alternative</code> instance of <code>Maybe</code>, which is equivalent to what Alec suggests <a href=\"https://stackoverflow.com/questions/42770703/why-does-mempty-evaluate-the-content-of-the-monoid#comment72657389_42770703\">in a comment</a>.)</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489430850, "creation_date": 1489429059, "question_id": 42770703, "link": "https://stackoverflow.com/questions/42770703/why-does-mempty-evaluate-the-content-of-the-monoid", "title": "Why does mempty evaluate the content of the Monoid", "body": "<p>Why does</p>\n\n<pre><code>(mempty :: String)\n</code></pre>\n\n<p>work, but</p>\n\n<pre><code>(mempty :: Maybe Bool)\n</code></pre>\n\n<p>gives me an error about <code>Bool</code> not having a type class of <code>Monoid</code>, but why does it even matter, it's wrapped in Maybe anyway?</p>\n"}, {"tags": ["haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1489413935, "post_id": 42765318, "comment_id": 72646309, "body": "What type is <code>sumDig</code> supposed to have?"}, {"owner": {"reputation": 581, "user_id": 4129131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ARzEX.jpg?s=128&g=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4129131/philippe"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1489414047, "post_id": 42765318, "comment_id": 72646386, "body": "an Int I suppose"}], "answers": [{"comments": [{"owner": {"reputation": 1466, "user_id": 5320300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ktwDF.jpg?s=128&g=1", "display_name": "Simon Baars", "link": "https://stackoverflow.com/users/5320300/simon-baars"}, "edited": false, "score": 0, "creation_date": 1536836061, "post_id": 42765723, "comment_id": 91571260, "body": "This <code>div</code> function, does it <code>floor</code>, <code>ceiling</code> or <code>round</code>? How to change this behaviour?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 1466, "user_id": 5320300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ktwDF.jpg?s=128&g=1", "display_name": "Simon Baars", "link": "https://stackoverflow.com/users/5320300/simon-baars"}, "edited": false, "score": 0, "creation_date": 1536839686, "post_id": 42765723, "comment_id": 91573362, "body": "@SimonBaars From the linked documentation, &quot;<i>integer division truncated toward negative infinity</i>&quot;"}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 7, "last_activity_date": 1489414262, "creation_date": 1489414262, "answer_id": 42765723, "question_id": 42765318, "link": "https://stackoverflow.com/questions/42765318/no-instance-for-realfrac-int-arising-from-a-use-of/42765723#42765723", "title": "No instance for (RealFrac Int) arising from a use of &#39; ... &#39;", "body": "<p>Drop the fractionals altogether and use only <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:div\" rel=\"noreferrer\"><code>div</code></a> for integer division:</p>\n\n<pre><code>sumDig n = if n &lt; 10 then n -- n consists of only one digit\n           else sumDig (n `div` 10) + (n `mod` 10)\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 4129131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ARzEX.jpg?s=128&g=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4129131/philippe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1410, "favorite_count": 0, "accepted_answer_id": 42765723, "answer_count": 1, "score": 1, "last_activity_date": 1489619344, "creation_date": 1489413076, "last_edit_date": 1489619344, "question_id": 42765318, "link": "https://stackoverflow.com/questions/42765318/no-instance-for-realfrac-int-arising-from-a-use-of", "title": "No instance for (RealFrac Int) arising from a use of &#39; ... &#39;", "body": "<p>The following program is supposed to check whether the input n is divisible by the sum of digits in n</p>\n\n<pre><code>module Harshad where\n\nisHarshad :: Int -&gt; Bool\nisHarshad n = (mod n (sumDig n)) == 0)\n where \n  sumDig n \n   | (floor (n / 10) == 0) = n -- n consists of only one digit\n   | otherwise = sumDig (floor (n / 10)) + floor (10*(n - floor (n / 10)))\n</code></pre>\n\n<p>I get the following compile error : \n* No instance for (RealFrac Int) arising from a use of `sumDig'</p>\n\n<p>even after trying to add various conversions I'm still stuck.</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1489411815, "post_id": 42764847, "comment_id": 72644817, "body": "Problem is that the library usually generates random values. So it is possible it will take <i>ages</i> before you find a value that satisfies the condition. Furthermore if the test itself is not true. It will never end generating values."}, {"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1489412042, "post_id": 42764847, "comment_id": 72644982, "body": "Yes, but it can still be useful if you&#39;re confident that there are many test cases that satisfy the condition. I&#39;m looking for a property that will stop generating values as soon as the condition is satisfied once."}, {"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489412110, "post_id": 42764847, "comment_id": 72645020, "body": "That would allow us to write, for example, propositions like &quot;There exists an n such that the property is true for all m &gt; n&quot;."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489412148, "post_id": 42764847, "comment_id": 72645041, "body": "But say you have a property: <code>length a &lt; 0</code>. So the length should be less than <code>0</code>. It is clear it will never be satisfied. So the tests will get stuck into an infinite loop where they will keep generating lists in the hope one of them will have a lenght less than <code>0</code>. Now you cannot make a distinction between: &quot;not satisfied because the condition is rare&quot;, or &quot;unsatisifiable&quot;."}, {"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1489413052, "post_id": 42764847, "comment_id": 72645712, "body": "Why not stop generating cases after 100 tries like with forAll? The same argument could be used against <code>forAll</code> anyway: you cannot make a distinction between &quot;satisfied because the counter example is rare&quot; and &quot;true&quot;."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489413161, "post_id": 42764847, "comment_id": 72645781, "body": "yeah but the outcome is different: if a counterexample is rare: the program will report &quot;satisfied&quot;, whereas if an example in an exists is rare, it will report &quot;false&quot;. QuickCheck is optimistic: there is no guarantee - as with all unit tests - that a program is correct if the tests are satisifed. It however makes you more certain."}, {"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489413963, "post_id": 42764847, "comment_id": 72646329, "body": "I don&#39;t get it. I need a &quot;there exists&quot; quantifier that generates tests until one passes and reports &quot;satisfied&quot; or &quot;false/not satisfied&quot; if a max number of tests are reached. I know that quickCheck can&#39;t work well with rare examples or counter examples, but it&#39;s useful anyway. I don&#39;t really understand if you&#39;re telling me &quot;it&#39;s impossible with quickCheck as it is&quot;. Is this so? Or are you arguing about whether it&#39;s a good thing to do?"}], "answers": [{"comments": [{"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 1, "creation_date": 1489412601, "post_id": 42765024, "comment_id": 72645369, "body": "I&#39;ve thought about that, but how do you take the negation of <code>forAll ...</code> in quickCheck? I&#39;ve already tried <code>not (forAll gen prop)</code> but <code>forAll</code> returns a Property ant <code>not</code> expects a Bool."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 1, "creation_date": 1489415150, "post_id": 42765024, "comment_id": 72647211, "body": "@GuillaumeCh&#233;rel You should be able to implement it using <code>mapResult</code>: <a href=\"https://hackage.haskell.org/package/QuickCheck-2.9.2/docs/src/Test-QuickCheck-Property.html#mapResult\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/QuickCheck-2.9.2/docs/src/&hellip;</a>."}], "tags": [], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "is_accepted": false, "score": 1, "last_activity_date": 1489412205, "creation_date": 1489412205, "answer_id": 42765024, "question_id": 42764847, "link": "https://stackoverflow.com/questions/42764847/is-there-a-there-exists-quantifier-in-quickcheck/42765024#42765024", "title": "Is there a &quot;there exists&quot; quantifier in QuickCheck?", "body": "<p>I don't know if something like this exist in QuickCheck. Also not convinced it would be helpful, but that's another matter. Since we have:</p>\n\n<pre><code>\u2203 x . P x &lt;=&gt; \u00ac \u00ac \u2203 x . P x &lt;=&gt; \u00ac \u2200 x . \u00ac P x\n</code></pre>\n\n<p>I suppose you could set it up so your test-case tests the negation and if it fails it means you have your existential. HTH.</p>\n"}, {"comments": [{"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 1, "creation_date": 1489587583, "post_id": 42766295, "comment_id": 72736957, "body": "Your third suggestion is close to what I&#39;m looking for. But in order to combine it with <code>forAll</code>, for example to write <code>exists gen1 $ \\a -&gt; forAll gen2 ...</code>, exists would have to have signature <code>(Testable prop) =&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property</code>. I&#39;ve trouble finding out how to do this reading QuickCheck&#39;s source code. Would you know how to do it?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 0, "creation_date": 1489667452, "post_id": 42766295, "comment_id": 72777527, "body": "I guess my example relies a lot on the property being simply boolean. If you have an abstract <code>prop</code> you can use <code>.||.</code> or <code>disjoin</code>, which ends up resembling what I suggested in the second example about not calling <code>counterexample</code>."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 1, "creation_date": 1489667807, "post_id": 42766295, "comment_id": 72777821, "body": "<code>once $ disjoin $ replicate 10000 $ do { a &lt;- gen ; return (prop a) }</code>But as I said, it silences exceptions. It turns out you can use <code>mapResult</code> as suggested by Alexey Romanov to check for exceptions raised at the end of <code>disjoin</code>."}, {"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 0, "creation_date": 1490204014, "post_id": 42766295, "comment_id": 73012057, "body": "Your last suggestion seems to work but takes a long time and fills the console with empty lines. I&#39;ve spent days on it but I still can&#39;t figure out how to do this properly. Could you rewrite your 3rd suggestion in your post so that it works with a Testable prop instead of a Bool? The whole problem I can&#39;t solve is how to check if <code>prop a</code> is a success of a failure."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "edited": false, "score": 0, "creation_date": 1490222543, "post_id": 42766295, "comment_id": 73022069, "body": "I appended something that seems to work, still with <code>disjoin</code>. Unfortunately I couldn&#39;t figure out a good way based on a pure generator (mainly because I&#39;m not familiar enough with the internals of <code>Property</code>). Somehow <code>once</code> doesn&#39;t  have the effect I expected. Sorry if that answer is still unsatisfactory."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 10, "last_activity_date": 1490222132, "last_edit_date": 1592644375, "creation_date": 1489415815, "answer_id": 42766295, "question_id": 42764847, "link": "https://stackoverflow.com/questions/42764847/is-there-a-there-exists-quantifier-in-quickcheck/42766295#42766295", "title": "Is there a &quot;there exists&quot; quantifier in QuickCheck?", "body": "<p>Testing existence by enumeration would be more reliable: <a href=\"http://hackage.haskell.org/package/smallcheck\" rel=\"nofollow noreferrer\">SmallCheck</a>, <a href=\"http://hackage.haskell.org/package/leancheck\" rel=\"nofollow noreferrer\">LeanCheck</a>, <a href=\"http://hackage.haskell.org/package/testing-feat\" rel=\"nofollow noreferrer\">FEAT</a>.</p>\n<p>If you must use random generation there are some indirect ways in QuickCheck.</p>\n<hr />\n<p><a href=\"http://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck.html#v:expectFailure\" rel=\"nofollow noreferrer\"><code>expectFailure</code></a> seems like a good candidate for negation. However it isn't quite it, as it isn't involutive so you must negate the property in other ways, like <code>not</code>, if your property is in fact boolean.</p>\n<pre><code>exists :: Gen a -&gt; (a -&gt; Bool) -&gt; Property\nexists gen prop = once $ expectFailure (forAll gen (not . prop))\n</code></pre>\n<p>This counts crashing as a failure though, which thus makes the test pass even though you might not expect it.</p>\n<hr />\n<p>Existential quantification is kind of a disjunction, and QuickCheck has <a href=\"http://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck.html#v:disjoin\" rel=\"nofollow noreferrer\"><code>disjoin</code></a>. Just make a huge enough disjunction.</p>\n<pre><code>exists :: Gen a -&gt; (a -&gt; Property) -&gt; Property\nexists gen prop = once $ disjoin $ replicate 10000 $ forAll gen prop\n</code></pre>\n<p>But you get spammed with counterexamples when no good example is found.\nMaybe it is better to rewrite the logic of <code>forAll</code> yourself to avoid the call to <code>counterexample</code>.</p>\n<hr />\n<p>More simply you can always write your own property as a generator to get the proper quantification.</p>\n<pre><code>exists :: Gen a -&gt; (a -&gt; Bool) -&gt; Property\nexists gen prop = property (exists' 1000 gen prop)\n\nexists' :: Int -&gt; Gen a -&gt; (a -&gt; Bool) -&gt; Gen Bool\nexists' 0 _ _ = return False\nexists' n gen prop = do\n  a &lt;- gen\n  if prop a\n    then return True\n    else exists' (n - 1) gen prop\n</code></pre>\n<p>Doing this manually also has the property that if <code>prop</code> unexpectedly crashes, it is immediately reported as a failure, as opposed to the previous methods.</p>\n<hr />\n<h2>EDIT</h2>\n<p>So if you only have a <code>(a -&gt; Property)</code> instead of <code>(a -&gt; Bool)</code> it seems much trickier to achieve a good result, because it's non-trivial to check whether a property succeeded. A proper way would be to mess with the internals of QuickCheck, probably something similar to <code>disjoin</code>. Here is a quick hack</p>\n<ul>\n<li><p>Use <code>mapResult</code> to silence the output of <code>disjoin</code> when no (counter)example was found.</p>\n</li>\n<li><p>Override the size parameter because if your witnesses are non-trivial, they will not be found if the size is too small or too large.</p>\n</li>\n</ul>\n<p></p>\n<pre><code>import Test.QuickCheck\nimport Test.QuickCheck.Property as P\n\n-- Retry n times.\nexists :: Testable prop =&gt; Int -&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property\nexists n gen prop =\n  mapResult (\\r -&gt; r {P.reason = &quot;No witness found.&quot;, P.callbacks = []}) $\n  once $\n  disjoin $\n  replicate n $ do\n    a &lt;- gen\n    return (prop a)\n\nmain = quickCheck $ exists 100\n  (resize 5 arbitrary)\n  (\\x -&gt; (x :: Integer) == 2)\n</code></pre>\n"}], "owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 1, "accepted_answer_id": 42766295, "answer_count": 2, "score": 8, "last_activity_date": 1490222132, "creation_date": 1489411686, "question_id": 42764847, "link": "https://stackoverflow.com/questions/42764847/is-there-a-there-exists-quantifier-in-quickcheck", "title": "Is there a &quot;there exists&quot; quantifier in QuickCheck?", "body": "<p>There is the <code>forAll</code> quantifier that returns a property which checks if all test cases pass. Is there a way to define a  \"there exists\" quantifier that returns a property which checks it at least one test case passes?</p>\n"}, {"tags": ["haskell", "newtype"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1489413609, "last_edit_date": 1489413609, "creation_date": 1489413194, "answer_id": 42765353, "question_id": 42764432, "link": "https://stackoverflow.com/questions/42764432/do-newtypes-incur-no-cost-even-when-you-cannot-pattern-match-on-them/42765353#42765353", "title": "Do newtypes incur no cost even when you cannot pattern-match on them?", "body": "<p>On their own, <code>newtypes</code> are cost-free. Applying their constructor, or pattern matching on them has zero cost.</p>\n\n<p>When used as parameter for other types e.g. <code>[T]</code> the representation of <code>[T]</code> is precisely the same as the one for <code>[T']</code> if <code>T</code> is a <code>newtype for</code>T`. So, there's no loss in performance.</p>\n\n<p>However, there are two main caveats I can see.</p>\n\n<h1><code>newtype</code>s and instances</h1>\n\n<p>First, <code>newtype</code> is frequently used to introduce new <code>instance</code>s of type classes. Clearly, when these are user-defined, there's no guarantee that they have the same cost as the original instances. E.g., when using</p>\n\n<pre><code>newtype Op a = Op a\ninstance Ord a =&gt; Ord (Op a) where\n    compare (Op x) (Op y) = compare y x\n</code></pre>\n\n<p>comparing two <code>Op Int</code> will cost slightly more than comparing <code>Int</code>, since the arguments need to be swapped. (I am neglecting optimizations here, which might make this cost free when they trigger.)</p>\n\n<h1><code>newtypes</code> used as type arguments</h1>\n\n<p>The second point is more subtle. Consider the following two implementations of the identity <code>[Int] -&gt; [Int]</code></p>\n\n<pre><code>id1, id2 :: [Int] -&gt; [Int]\nid1 xs = xs\nid2 xs = map (\\x-&gt;x) xs\n</code></pre>\n\n<p>The first one has constant cost. The second has a linear cost (assuming no optimization triggers). A smart programmer should prefer the first implementation, which is also simpler to write.</p>\n\n<p>Suppose now we introduce <code>newtypes</code> on the argument type, only:</p>\n\n<pre><code>id1, id2 :: [Op Int] -&gt; [Int]\nid1 xs = xs                    -- error!\nid2 xs = map (\\(Op x)-&gt;x) xs\n</code></pre>\n\n<p>We can no longer use the constant cost implementation because of a type error. The linear cost implementation still works, and is the only option.</p>\n\n<p>Now, this is quite bad. The input representation for <code>[Op Int]</code> is exactly, bit by bit, the same for <code>[Int]</code>. Yet, the type system forbids us to perform the identity in an efficient way!</p>\n\n<p>To overcome this issue, <a href=\"http://www.cis.upenn.edu/~eir/papers/2014/coercible/coercible-ext.pdf\" rel=\"noreferrer\">safe coercions</a> where introduced in Haskell.</p>\n\n<pre><code>id3 :: [Op Int] -&gt; [Int]\nid3 = coerce\n</code></pre>\n\n<p>The magic <code>coerce</code> function, under certain hypotheses, removes or inserts <code>newtype</code>s as needed to make type match, even <em>inside</em> other types, as for <code>[Op Int]</code> above. Further, it is a zero-cost function.</p>\n\n<p>Note that <code>coerce</code> works only under certain conditions (the compiler checks for them). One of these is that the <code>newtype</code> constructor must be visible: if a module does not export <code>Op :: a -&gt; Op a</code> you can not coerce <code>Op Int</code> to <code>Int</code> or vice versa. Indeed, if a module exports the type but not the constructor, it would be wrong to make the constructor accessible anyway through <code>coerce</code>. This makes the \"smart constructors\" idiom still safe: modules can still enforce complex invariants through opaque types.</p>\n"}, {"comments": [{"owner": {"reputation": 796, "user_id": 672098, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/df506e61c4f7bb05009fcb7f22ee81e2?s=128&d=identicon&r=PG", "display_name": "Arek&#39; Fu", "link": "https://stackoverflow.com/users/672098/arek-fu"}, "edited": false, "score": 0, "creation_date": 1489441206, "post_id": 42765360, "comment_id": 72663191, "body": "But I still would be able to store <code>Speed</code> values in an unboxed array by defining the appropriate <code>UArr.Unbox</code> instance, right?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 796, "user_id": 672098, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/df506e61c4f7bb05009fcb7f22ee81e2?s=128&d=identicon&r=PG", "display_name": "Arek&#39; Fu", "link": "https://stackoverflow.com/users/672098/arek-fu"}, "edited": false, "score": 0, "creation_date": 1489441672, "post_id": 42765360, "comment_id": 72663433, "body": "Sure, yes. In fact, you can most always ensure that the instances are in sync by using <code>-XGeneralizedNewtypeDeriving</code>. Just, often the <i>purpose</i> of newtypes is to have different instances, so the this is a bit defeating the point."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1489414042, "last_edit_date": 1489414042, "creation_date": 1489413210, "answer_id": 42765360, "question_id": 42764432, "link": "https://stackoverflow.com/questions/42764432/do-newtypes-incur-no-cost-even-when-you-cannot-pattern-match-on-them/42765360#42765360", "title": "Do newtypes incur no cost even when you cannot pattern-match on them?", "body": "<p>It doesn't matter <em>how deeply buried</em> a newtype is in a stack of (<em>fully</em>) parametric types. At runtime, the values <code>v :: Speed</code> and <code>w :: Double</code> are completely indistinguishable \u2013 the wrapper is erased by the compiler, so even <code>v</code> is really just a pointer to a single 64-bit floating-point number in memory. Whether that pointer is stored in a list or tree or whatever doesn't make a difference either. <code>getSpeed</code> is a no-op and will not appear at runtime in any way at all.</p>\n\n<p>So what do I mean by \u201c<strong>fully</strong> parametric\u201d? The thing is, newtypes <em>can</em> obviously make a difference at compile time, via the type system. In particular, they can guide instance resolution, so a newtype that invokes a different class method may certainly have worse (or, just as easily, <em>better</em>!) performance than the wrapped type. For example,</p>\n\n<pre><code>class Integral n =&gt; Fibonacci n where\n  fib :: n -&gt; Integer\n\ninstance Fibonacci Int where\n  fib = (fibs !!)\n   where fibs = [ if i&lt;2 then 1\n                         else fib (i-2) + fib (i-1)\n                | i&lt;-[0::Int ..] ]\n</code></pre>\n\n<p>this implementation is pretty slow, because it uses a lazy list (and performs lookups in it over and over again) for memoisation. On the other hand,</p>\n\n<pre><code>import qualified Data.Vector as Arr\n\n-- | A number between 0 and 753\nnewtype SmallInt = SmallInt { getSmallInt :: Int }\n\ninstance Fibonacci SmallInt where\n  fib = (fibs Arr.!) . getSmallInt\n   where fibs = Arr.generate 754 $\n           \\i -&gt; if i&lt;2 then 1\n                        else fib (SmallInt $ i-2) + fib (SmallInt $ i-1)\n</code></pre>\n\n<p>This <code>fib</code> is much faster, because thanks to the input being limited to a small range, it is feasible to strictly allocate <em>all</em> of the results and store them in a fast <em>O</em> (1) lookup array, not needing the spine-laziness.</p>\n\n<p>This of course applies again regardless of what structure you store the numbers in. But the different performance only comes about because different method instantiations are called \u2013 at runtime this means simply, completely different functions.</p>\n\n<p>Now, a <em>fully parametric</em> type constructor must be able to store values of <em>any</em> type. In particular, it cannot impose any class restrictions on the contained data, and hence also not call any class methods. Therefore this kind of performance difference can not happen if you're just dealing with generic <code>[a]</code> lists or <code>Map Int a</code> maps. It can, however, occur when you're dealing with GADTs. In this case, even the actual memory layout might be completely differet, for instance with</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nimport qualified Data.Vector as Arr\nimport qualified Data.Vector.Unboxed as UArr\n\ndata Array a where\n   BoxedArray :: Arr.Vector a -&gt; Array a\n   UnboxArray :: UArr.Unbox a =&gt; UArr.Vector a -&gt; Array a\n</code></pre>\n\n<p>might allow you to store <code>Double</code> values more efficiently than <code>Speed</code> values, because the former can be stored in a cache-optimised unboxed array. This is only possible because the <code>UnboxArray</code> constructor is <em>not</em> fully parametric.</p>\n"}], "owner": {"reputation": 796, "user_id": 672098, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/df506e61c4f7bb05009fcb7f22ee81e2?s=128&d=identicon&r=PG", "display_name": "Arek&#39; Fu", "link": "https://stackoverflow.com/users/672098/arek-fu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 42765353, "answer_count": 2, "score": 2, "last_activity_date": 1489414042, "creation_date": 1489410375, "question_id": 42764432, "link": "https://stackoverflow.com/questions/42764432/do-newtypes-incur-no-cost-even-when-you-cannot-pattern-match-on-them", "title": "Do newtypes incur no cost even when you cannot pattern-match on them?", "body": "<h2>Context</h2>\n\n<p>Most Haskell tutorials I know (e.g. <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#the-newtype-keyword\" rel=\"nofollow noreferrer\">LYAH</a>) introduce newtypes as a cost-free idiom that allows enforcing more type safety. For instance, this code will type-check:</p>\n\n<pre><code>type Speed = Double\ntype Length = Double\n\ncomputeTime :: Speed -&gt; Length -&gt; Double\ncomputeTime v l = l / v\n</code></pre>\n\n<p>but this won't:</p>\n\n<pre><code>newtype Speed = Speed { getSpeed :: Double }\nnewtype Length = Length { getLength :: Double }\n\n-- wrong!\ncomputeTime :: Speed -&gt; Length -&gt; Double\ncomputeTime v l = l / v\n</code></pre>\n\n<p>and this will:</p>\n\n<pre><code>-- right\ncomputeTime :: Speed -&gt; Length -&gt; Double\ncomputeTime (Speed v) (Length l) = l / v\n</code></pre>\n\n<p>In this particular example, the compiler knows that <code>Speed</code> is just a <code>Double</code>, so the pattern-matching is moot and will not generate any executable code.</p>\n\n<h2>Question</h2>\n\n<p>Are newtypes still cost-free when they appear as arguments of parametric types? For instance, consider a list of newtypes:</p>\n\n<pre><code>computeTimes :: [Speed] -&gt; Length -&gt; [Double]\ncomputeTimes vs l = map (\\v -&gt; getSpeed v / l) vs\n</code></pre>\n\n<p>I could also pattern-match on speed in the lambda:</p>\n\n<pre><code>computeTimes' :: [Speed] -&gt; Length -&gt; [Double]\ncomputeTimes' vs l = map (\\(Speed v) -&gt; v / l) vs\n</code></pre>\n\n<p>In either case, for some reason, I feel that real work is getting done! I start to feel even more uncomfortable when the newtype is buried within a deep tree of nested parametric datatypes, e.g. <code>Map Speed [Set Speed]</code>; in this situation, it may be difficult or impossible to pattern-match on the newtype, and one would have to resort to accessors like <code>getSpeed</code>.</p>\n\n<h2>TL;DR</h2>\n\n<p>Will the use of a newtype <em>never ever</em> incur a cost, even when the newtype appears as a (possibly deeply-buried) argument of another parametric type?</p>\n"}, {"tags": ["haskell", "repa"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489405659, "post_id": 42759719, "comment_id": 72640813, "body": "The thing is, repa <code>Array U</code> is basically just a newtype wrapper around an <code>UV.Vector</code> anyway, so I don&#39;t reckon there&#39;s much of a better solution."}, {"owner": {"reputation": 11764, "user_id": 494373, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yAS3h.png?s=128&g=1", "display_name": "Rob Agar", "link": "https://stackoverflow.com/users/494373/rob-agar"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489420224, "post_id": 42759719, "comment_id": 72651209, "body": "Ah right, thanks @leftaroundabout.  Add an answer if you like so I can accept it"}], "owner": {"reputation": 11764, "user_id": 494373, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yAS3h.png?s=128&g=1", "display_name": "Rob Agar", "link": "https://stackoverflow.com/users/494373/rob-agar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489395561, "creation_date": 1489395561, "question_id": 42759719, "link": "https://stackoverflow.com/questions/42759719/vector-of-vectors-to-2d-repa-array", "title": "Vector of Vectors to 2D Repa Array", "body": "<p>What is the cleanest way to turn a <a href=\"http://hackage.haskell.org/package/vector-0.12.0.0/docs/Data-Vector.html\" rel=\"nofollow noreferrer\">Vector</a> of vectors of unboxed doubles into a <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html\" rel=\"nofollow noreferrer\">repa</a> <code>Array U DIM2 Double</code>?</p>\n\n<p>The most obvious way is to concatenate all the unboxed vectors into one and pass it to <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa-Repr-Unboxed.html#v:fromUnboxed\" rel=\"nofollow noreferrer\">fromUnboxed</a>, but that feels a bit clumsy.  Is there a better alternative?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489395559, "post_id": 42759624, "comment_id": 72634919, "body": "I&#39;m confused - what is wrong with just <code>show</code> and <code>read</code>?"}, {"owner": {"reputation": 2052, "user_id": 3176495, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/64fe67b095e1b41c34bbea6916cd2540?s=128&d=identicon&r=PG&f=1", "display_name": "user66875", "link": "https://stackoverflow.com/users/3176495/user66875"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489395783, "post_id": 42759624, "comment_id": 72635046, "body": "Sorry for not mentioning: I need to convert strings like <code>Hello</code> to its integer representation, not just strings like &#39;123&#39;"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1489399014, "post_id": 42759624, "comment_id": 72636998, "body": "Which <code>chunksOf</code> do you use?"}, {"owner": {"reputation": 2052, "user_id": 3176495, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/64fe67b095e1b41c34bbea6916cd2540?s=128&d=identicon&r=PG&f=1", "display_name": "user66875", "link": "https://stackoverflow.com/users/3176495/user66875"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1489399288, "post_id": 42759624, "comment_id": 72637128, "body": "@Zeta I&#39;m using <code>chunksOf</code> from Data.Text"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1489400094, "post_id": 42759624, "comment_id": 72637566, "body": "Well, there&#39;s your problem. A <code>Text</code> isn&#39;t a <code>String</code>."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1489400487, "creation_date": 1489400487, "answer_id": 42761220, "question_id": 42759624, "link": "https://stackoverflow.com/questions/42759624/chunksof-and-string-datatype/42761220#42761220", "title": "chunksOf and string datatype", "body": "<p>You get that error because <code>chunksOf</code> has the wrong type:</p>\n\n<pre><code>chunksOf 2 :: Text -&gt; [Text]\n</code></pre>\n\n<p>Either use <code>chunksOf</code> from <code>Data.List.Split</code> or write your own:</p>\n\n<pre><code>chunksOf :: Int -&gt; [a] -&gt; [a]\nchunksOf _ [] = []\nchunksOf k xs = let (as, bs) = splitAt k xs \n                in as : chunksOf k bs\n</code></pre>\n\n<p>That being said, your function won't work. <code>ord 'o'</code> is <code>111</code>, a three digit number. I would write simpler variants:</p>\n\n<pre><code>encodeInts :: String -&gt; [Int]\nencodeInts = map ord\n\ndecodeInts :: [Int] -&gt; String\ndecodeInts = map chr\n</code></pre>\n\n<p>After all, the process to get <code>[Int]</code> from <code>Integer</code> is ambigous, even with                fixed lengths, since the first character might have an <code>ord</code> less than 100.</p>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 6165079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f16b76fbe5a1972323696457c211571b?s=128&d=identicon&r=PG", "display_name": "Marvin Sielenkemper", "link": "https://stackoverflow.com/users/6165079/marvin-sielenkemper"}, "is_accepted": false, "score": 1, "last_activity_date": 1489401067, "creation_date": 1489401067, "answer_id": 42761413, "question_id": 42759624, "link": "https://stackoverflow.com/questions/42759624/chunksof-and-string-datatype/42761413#42761413", "title": "chunksOf and string datatype", "body": "<p>If you only have ASCII (or at least no unicode) and no zero <code>Char</code>s in your string, you can use this</p>\n\n<pre><code>encodeInts :: String -&gt; Integer\nencodeInts = foldr (\\c n -&gt; n * 256 + toInteger (ord c)) 0\ndecodeInts :: Integer -&gt; String\ndecodeInts = map (chr . fromInteger) $ takeWhile (&gt; 0) $ map (`mod` 256) $ iterate (`div` 256)\n</code></pre>\n"}], "owner": {"reputation": 2052, "user_id": 3176495, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/64fe67b095e1b41c34bbea6916cd2540?s=128&d=identicon&r=PG&f=1", "display_name": "user66875", "link": "https://stackoverflow.com/users/3176495/user66875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 42761220, "answer_count": 2, "score": 1, "last_activity_date": 1489401067, "creation_date": 1489395253, "last_edit_date": 1489399260, "question_id": 42759624, "link": "https://stackoverflow.com/questions/42759624/chunksof-and-string-datatype", "title": "chunksOf and string datatype", "body": "<p>I'm in need of a function to convert a string like 'Hello World' from the console to an Integer , and convert the Integer back to a string.</p>\n\n<pre><code>import Data.Text (Text, chunksOf)\n\nencodeInts :: String -&gt; Integer\nencodeInts = read . concatMap show . map ord . show\ndecodeInts :: Integer -&gt; String\ndecodeInts = read . map chr . map read . chunksOf 2 . show\n</code></pre>\n\n<p>The encoding works, in <code>decodInts</code>  however, I'm getting:</p>\n\n<blockquote>\n<pre><code>* Couldn't match type `Text' with `[Char]'\n  Expected type: Integer -&gt; [String]\n    Actual type: Integer -&gt; [Text]\n* In the second argument of `(.)', namely `chunksOf 2 . show'\n  In the second argument of `(.)', namely\n    `map read . chunksOf 2 . show'\n  In the second argument of `(.)', namely\n    `map chr . map read . chunksOf 2 . show'\n</code></pre>\n  \n  <p>and</p>\n\n<pre><code>* Couldn't match type `[Char]' with `Text'\n  Expected type: Integer -&gt; Text\n    Actual type: Integer -&gt; String\n* In the second argument of `(.)', namely `show'\n  In the second argument of `(.)', namely `chunksOf 2 . show'\n  In the second argument of `(.)', namely\n    `map read . chunksOf 2 . show' Failed, modules loaded: none. Prelude&gt;\n</code></pre>\n</blockquote>\n\n<p>I have already tried using <code>{-# LANGUAGE OverloadedStrings #-}</code></p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489405265, "post_id": 42756545, "comment_id": 72640556, "body": "You aren&#39;t trying to generate JSON manually, are you?"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 2, "last_activity_date": 1489380325, "creation_date": 1489380325, "answer_id": 42756790, "question_id": 42756545, "link": "https://stackoverflow.com/questions/42756545/how-can-you-combine-elements-of-a-list-in-sets-of-3-in-haskell/42756790#42756790", "title": "How can you combine elements of a list in sets of 3 in Haskell?", "body": "<p>You can do it directly using recursion:</p>\n\n<pre><code>processIn3s :: (a -&gt; a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\nprocessIn3s f (x:y:z:rest) = f x y z : processIn3s f rest\nprocessIn3s _ _ = []\n</code></pre>\n\n<p>The idea is that <strong>if</strong> the list can be decomposed into</p>\n\n<pre><code>x:y:z:rest\n</code></pre>\n\n<p>which can be read as</p>\n\n<pre><code>x:(y:(z:rest)))\n</code></pre>\n\n<p>i.e. a list that is the cons (<code>:</code>) of <code>x</code> and <code>y:(z:rest)</code> etc,</p>\n\n<p><strong>then</strong> we can pass the first three elements <code>x</code>, <code>y</code> and <code>z</code> into a tertiary function <code>f :: a -&gt; a -&gt; a -&gt; b</code> that consumes all three elements to come up with the first result; and recurse on the remaining list.</p>\n"}, {"tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": false, "score": 2, "last_activity_date": 1489380651, "creation_date": 1489380651, "answer_id": 42756846, "question_id": 42756545, "link": "https://stackoverflow.com/questions/42756545/how-can-you-combine-elements-of-a-list-in-sets-of-3-in-haskell/42756846#42756846", "title": "How can you combine elements of a list in sets of 3 in Haskell?", "body": "<p>From <a href=\"https://stackoverflow.com/a/12876438/7208029\">another answer</a>, you can get them into groups of three using this function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>groupsOf :: Int -&gt; [a] -&gt; [[a]]\ngroupsOf _ [] = []\ngroupsOf n l\n  | n &gt; 0 = (take n l) : (groupsOf n (drop n l))\n  | otherwise = error \"Negative n\"\n</code></pre>\n\n<p>You can then use <code>Data.List.intercalate</code> like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map (intercalate \"\\n \") . groupsOf 3 $ [\"prop1\", \"prop2\", \"prop3\", \"prop1\", \"prop2\", \"prop3\"]\n</code></pre>\n\n<p>This produces:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[\"prop1\\n prop2\\n prop3\", \"prop1\\n prop2\\n prop3\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 754, "user_id": 2140910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CtvpI.jpg?s=128&g=1", "display_name": "Bjartur Thorlacius", "link": "https://stackoverflow.com/users/2140910/bjartur-thorlacius"}, "edited": false, "score": 0, "creation_date": 1489395426, "post_id": 42758767, "comment_id": 72634843, "body": "But then, how would you intercalate newlines within chunks?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489405204, "post_id": 42758767, "comment_id": 72640520, "body": "This should be a comment on Chai&#39;s answer, not a separate answer."}], "tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": false, "score": 2, "last_activity_date": 1489391760, "creation_date": 1489391760, "answer_id": 42758767, "question_id": 42756545, "link": "https://stackoverflow.com/questions/42756545/how-can-you-combine-elements-of-a-list-in-sets-of-3-in-haskell/42758767#42758767", "title": "How can you combine elements of a list in sets of 3 in Haskell?", "body": "<p>Chai's answer is correct, but instead of writing the function <code>groupsOf</code> yourself, you can just use <code>chunksOf</code> from <code>Data.List.Split</code>.</p>\n"}], "owner": {"reputation": 679, "user_id": 5947872, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh6.googleusercontent.com/-jgsMcinw23E/AAAAAAAAAAI/AAAAAAAAACQ/SWL6aicRz2A/photo.jpg?sz=128", "display_name": "Dylan Harness", "link": "https://stackoverflow.com/users/5947872/dylan-harness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489391760, "creation_date": 1489378663, "question_id": 42756545, "link": "https://stackoverflow.com/questions/42756545/how-can-you-combine-elements-of-a-list-in-sets-of-3-in-haskell", "title": "How can you combine elements of a list in sets of 3 in Haskell?", "body": "<p>I have a list of strings describing entities like this</p>\n\n<pre><code>[\"prop1\", \"prop2\", \"prop3\", \"prop1\", \"prop2\", \"prop3\", ... ]\n</code></pre>\n\n<p>Where prop1-3 are the properties of an entity, and the next 3 are the properties of the next entity. I can't figure out a way to group all 3 things together into a list of concatenated strings, </p>\n\n<pre><code>[ \"prop1\\n prop2\\n prop3\", \"prop1\\n prop2\\n prop3\", \"prop1\\n prop2\\n prop3\"]\n</code></pre>\n\n<p>or a list of dictionaries, </p>\n\n<pre><code>[{\n     1: \"prop1\",\n     2: \"prop2\",\n     3: \"prop3\"\n}, {...}]\n</code></pre>\n\n<p>or some such thing.</p>\n\n<p>I'm used to working with loops and am kind of confused when I don't have access to that control flow.</p>\n"}, {"tags": ["algorithm", "performance", "haskell"], "comments": [{"owner": {"reputation": 1526, "user_id": 4969140, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6s6x0.jpg?s=128&g=1", "display_name": "Adrian Ja\u0142oszewski", "link": "https://stackoverflow.com/users/4969140/adrian-ja%c5%82oszewski"}, "reply_to_user": {"reputation": 1128, "user_id": 4324738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-zgDQzIeGkS4/AAAAAAAAAAI/AAAAAAAAABM/HOiasxujJrQ/photo.jpg?sz=128", "display_name": "Suresh A", "link": "https://stackoverflow.com/users/4324738/suresh-a"}, "edited": false, "score": 2, "creation_date": 1489364403, "post_id": 42754808, "comment_id": 72625848, "body": "I can compute the 1000th element in under one second using it, so it can&#39;t be exponential."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 3, "creation_date": 1489366013, "post_id": 42754808, "comment_id": 72626220, "body": "Yes, the random access introduces an additional factor of n, but you don&#39;t need random access here. You just need access to the two previous elements. In Haskell this kind of thing can be accomplished by zipping a list with its tail. You could also use lazy arrays instead of lists, which give you O(1) random access while keeping the structure of the recursive formula, with the downside that you have to specify the number of elements you want since there&#39;s no such thing as an infinite array."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 1128, "user_id": 4324738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-zgDQzIeGkS4/AAAAAAAAAAI/AAAAAAAAABM/HOiasxujJrQ/photo.jpg?sz=128", "display_name": "Suresh A", "link": "https://stackoverflow.com/users/4324738/suresh-a"}, "edited": false, "score": 2, "creation_date": 1489366024, "post_id": 42754808, "comment_id": 72626221, "body": "@Surace There already is a data structure here (the list). This code is not exponential, it&#39;s quadratic as Adrian suspects."}], "answers": [{"comments": [{"owner": {"reputation": 1526, "user_id": 4969140, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6s6x0.jpg?s=128&g=1", "display_name": "Adrian Ja\u0142oszewski", "link": "https://stackoverflow.com/users/4969140/adrian-ja%c5%82oszewski"}, "edited": false, "score": 1, "creation_date": 1489385130, "post_id": 42757372, "comment_id": 72630557, "body": "This is the problem - it would be O(n) in C, C++, Java and so on, but not in languages which have O(n) list access. You could get similar performance issues using Javas <code>LinkedList</code>"}], "tags": [], "owner": {"reputation": 628, "user_id": 5882770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12feed8b016e52d78275f8729a64a03?s=128&d=identicon&r=PG&f=1", "display_name": "Shakhawat Hossain", "link": "https://stackoverflow.com/users/5882770/shakhawat-hossain"}, "is_accepted": false, "score": -3, "last_activity_date": 1489384532, "creation_date": 1489384532, "answer_id": 42757372, "question_id": 42754808, "link": "https://stackoverflow.com/questions/42754808/time-complexity-of-memoized-fibonacci/42757372#42757372", "title": "Time complexity of memoized fibonacci", "body": "<p>if you use memoized fibonacci the time complexity should be <code>O(n).</code> because in any index i <code>fib(i)</code> calculate only once. it's a beauty of dynamic programming.</p>\n"}, {"tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": false, "score": 2, "last_activity_date": 1489392118, "creation_date": 1489392118, "answer_id": 42758845, "question_id": 42754808, "link": "https://stackoverflow.com/questions/42754808/time-complexity-of-memoized-fibonacci/42758845#42758845", "title": "Time complexity of memoized fibonacci", "body": "<p>This runs in O(n) time.</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\nfibonacci = (fibs !!)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1489407503, "creation_date": 1489407503, "answer_id": 42763484, "question_id": 42754808, "link": "https://stackoverflow.com/questions/42754808/time-complexity-of-memoized-fibonacci/42763484#42763484", "title": "Time complexity of memoized fibonacci", "body": "<blockquote>\n  <p>Is it O(n^2) because of the list lookups in Haskell?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>If yes, then is there a way to somehow make it O(n) like in languages with where the lookup operation is O(1)?</p>\n</blockquote>\n\n<p>The most trivial way would be to use lazy arrays, which do have O(1) random access. This means, you'll have to specify an array size, so you no longer have an infinite sequence, but you have that same limitation in other languages. For example, you could do it like this using <code>Data.Vector</code>:</p>\n\n<pre><code>import Data.Vector\n\nfibsUpto100 :: Vector Integer\nfibsUpto100 = generate 100 fib\n    where fib 0 = 0\n          fib 1 = 1\n          fib n = fibsUpto100 ! (n-1) + fibsUpto100 ! (n-2)\n</code></pre>\n\n<p>Due to laziness nothing will be calculated until an element of the vector is evaluated, at which point all the previous elements of the vector (that haven't been evaluated before) are also evaluated. Once evaluated, each value is stored in the vector, so nothing is evaluated more than once.</p>\n\n<p>Of course it would be nicer to have an infinite list of numbers. One way to achieve this is to translate the standard O(n) way of calculating the nth Fibonacci number (using a while loop that keeps track of the current and previous element) to a recursive Haskell function and then adjusting that to store each element in a list.</p>\n\n<p>The basic translation of the while loop would be:</p>\n\n<pre><code>fib 0 = 0\nfib n = fibHelper n 0 1\n  where\n    fibHelper 0 _ current = current\n    fibHelper n previous current =\n        fibHelper (n-1) current (current + previous)\n</code></pre>\n\n<p>Adjusting this to keep a list, we get:</p>\n\n<pre><code>fibs = 0 : genFibs 0 1\n  where\n    genFibs previous current =\n        current : genFibs current (current + previous)\n</code></pre>\n\n<p>Another, more concise\u00b9 way to achieve the same thing would be to define the list using its own tail. That is we want each element of the list to be the previous element + the element before that and we implement this by taking the list and its tail, adding them together and feeding the result back into the list. This leads to the following definition:</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\n</code></pre>\n\n<p>Here 0 and 1 are the first and second element respectively and then the remaining elements are in the list produced by <code>zipWith (+) fibs (tail fibs)</code>. The first element of that list (i.e. the third element of the entire list) would be the first element of <code>fibs</code> + the first element of <code>tail fibs</code>, so <code>0 + 1 = 1</code>, the next element would be <code>1 + 1 = 2</code> and so on. So this definition does in fact produce the Fibonacci sequence.</p>\n\n<hr>\n\n<p>\u00b9 Albeit perhaps less understandable to people not too used to tie recursive knots in their heads.</p>\n"}], "owner": {"reputation": 1526, "user_id": 4969140, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6s6x0.jpg?s=128&g=1", "display_name": "Adrian Ja\u0142oszewski", "link": "https://stackoverflow.com/users/4969140/adrian-ja%c5%82oszewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "accepted_answer_id": 42763484, "answer_count": 3, "score": 6, "last_activity_date": 1489407503, "creation_date": 1489364040, "question_id": 42754808, "link": "https://stackoverflow.com/questions/42754808/time-complexity-of-memoized-fibonacci", "title": "Time complexity of memoized fibonacci", "body": "<p>I recently came across this Haskell memoized fibonacci implementation:</p>\n\n<pre><code>fibonacci :: Int -&gt; Integer\nfibonacci = (map fib [0 ..] !!)\n  where fib 0 = 0\n        fib 1 = 1\n        fib n = fibonacci (n - 1) + fibonacci (n - 2)\n</code></pre>\n\n<p>I'm wondering about the time complexity for generating the nth fibonacci number the first time. Is it O(n^2) because of the list lookups in Haskell? If yes, then is there a way to somehow make it O(n) like in languages with where the lookup operation is O(1)?</p>\n"}, {"tags": ["haskell", "random", "quickcheck", "hspec"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489361406, "post_id": 42753658, "comment_id": 72625219, "body": "You could use debug.trace as a quick and dirty solution"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489361497, "post_id": 42753658, "comment_id": 72625239, "body": "Could you give a bit more explanation of why you intend to do this?"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1489398836, "creation_date": 1489398836, "answer_id": 42760720, "question_id": 42753658, "link": "https://stackoverflow.com/questions/42753658/random-tests-generated-by-haskell-hspec-property/42760720#42760720", "title": "Random tests generated by Haskell HSpec property", "body": "<p>No. Hspec's runner disables any QuickCheck output. Also, the random tests will provide a lot of noise. However, there's a workaround:</p>\n\n<pre><code>import Test.Hspec\nimport Test.QuickCheck\nimport Test.QuickCheck.Test (isSuccess)\n\nverboseProperty :: Testable prop =&gt; prop -&gt; Expectation\nverboseProperty p = verboseCheckResult p &gt;&gt;= (`shouldBe` True) . isSuccess\n\nmain = hspec $ describe \"head\" $\n  it \"returns the first element of an *arbitrary* list\" $\n    verboseProperty $ \\x xs -&gt; head (x:xs) == (x :: Int)\n</code></pre>\n\n<p>However, the formatting will differ:</p>\n\n<pre><code>returns the first element of an *arbitrary* list\nPassed:  \n0\n[]\nPassed: \n1\n[-1]\nPassed:  \n2\n[-2]\nPassed:  \n3\n[]\nPassed:  \n0\n[]\nPassed:  \n1\n[2,-5,5,5]\nPassed:  \n0\n[-3,-1,-5,3]\n\u2026\n</code></pre>\n\n<p>There are of course more drawbacks, but that might be an easy way out. But <em>passing</em> tests aren't that interesting, it's the counter-examples that are more important&mdash;which are shown by default.</p>\n"}, {"tags": [], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "is_accepted": false, "score": 1, "last_activity_date": 1523468363, "last_edit_date": 1523468363, "creation_date": 1523467994, "answer_id": 49781268, "question_id": 42753658, "link": "https://stackoverflow.com/questions/42753658/random-tests-generated-by-haskell-hspec-property/49781268#49781268", "title": "Random tests generated by Haskell HSpec property", "body": "<p>With the new version of HSpec (>= 2.5.0) you just have to write it this way:</p>\n\n<pre><code>it \"returns the first element of an *arbitrary* list\" $\n  verbose $ \\x xs -&gt; head (x:xs) == (x :: Int)\n</code></pre>\n\n<p>Look at the discussion here: <a href=\"https://github.com/hspec/hspec/issues/257\" rel=\"nofollow noreferrer\">https://github.com/hspec/hspec/issues/257</a></p>\n"}], "owner": {"reputation": 111, "user_id": 4586632, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ef8a257abcede4daee9fba747dad5cc?s=128&d=identicon&r=PG&f=1", "display_name": "brander", "link": "https://stackoverflow.com/users/4586632/brander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1523468363, "creation_date": 1489355677, "question_id": 42753658, "link": "https://stackoverflow.com/questions/42753658/random-tests-generated-by-haskell-hspec-property", "title": "Random tests generated by Haskell HSpec property", "body": "<p>I am running tests with Hspec and Quickcheck <a href=\"http://hspec.github.io/\" rel=\"nofollow noreferrer\">http://hspec.github.io/</a></p>\n\n<p>The provided example to execute a random test case is     </p>\n\n<pre><code>it \"returns the first element of an *arbitrary* list\" $\n      property $ \\x xs -&gt; head (x:xs) == (x :: Int)\n</code></pre>\n\n<p>With associated output:</p>\n\n<pre><code>returns the first element of an *arbitrary* list \n</code></pre>\n\n<p>How can I see the actual run-time values generated for the test?  So given above example, sample desired output would include values passed for x and xs with something like:</p>\n\n<pre><code>returns the first element of an *arbitrary* list \n    \\x xy head (x:xs) == (x :: Int) with x = 'a' and xs = \"bc\" holds \n</code></pre>\n"}, {"tags": ["haskell", "asynchronous", "stream"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1489345684, "post_id": 42751175, "comment_id": 72619876, "body": "You could certainly build a thin abstraction around <code>WhateverChanYouLike (FancyEnvelope a)</code> that would allow you to communicate &quot;last element&quot; or &quot;cancel&quot; to consumers. I don&#39;t have a sense of what the consumer API you want would look like though. There&#39;s also <code>pipes-concurrency</code> which I haven&#39;t gotten to use."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1489352504, "post_id": 42751175, "comment_id": 72622433, "body": "I&#39;d go for <code>pipes</code> with <code>pipes-concurrency</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1489355626, "post_id": 42751175, "comment_id": 72623420, "body": "Also, any FRP library with an <code>Event</code>-like type would do the job"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489342248, "creation_date": 1489342248, "question_id": 42751175, "link": "https://stackoverflow.com/questions/42751175/abstraction-for-asynchronous-streamed-results", "title": "Abstraction for asynchronous streamed results", "body": "<p>When doing an asynchronous call, there are multiple ways of passing back the result. A nice abstraction is [<code>Async</code>], which allows retrieval of the output value, abandoning (<a href=\"https://hackage.haskell.org/package/async-2.1.1/docs/Control-Concurrent-Async.html#v:cancel\" rel=\"nofollow noreferrer\"><code>cancel</code></a>), error checking, combining values together etc.</p>\n\n<p>Is there a similar, nice abstraction for returning an asynchronous stream of results? That is, the called service asynchronously sends multiple values, followed by the final result? Something similar to gRPC's <a href=\"http://www.grpc.io/docs/tutorials/basic/c.html#streaming-rpcs\" rel=\"nofollow noreferrer\">server-side streaming</a>.</p>\n\n<p>While <em>stm</em> offers channels, queues, etc., they're meant to be infinite, without means for finishing / cancelling.</p>\n\n<p>Probably the closest abstraction that comes to my mind is <a href=\"https://hackage.haskell.org/package/conduit-1.2.9/docs/Data-Conduit.html#t:ConduitM\" rel=\"nofollow noreferrer\"><code>ConduitM Void o IO r</code></a>, but this is meant for synchronous computations. Probably it'd be possible to wrap an internal channel in it too to make it asynchronous, but <em>conduit</em> seems to be quite a heavy dependency for such purpose.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 2, "creation_date": 1489342941, "post_id": 42751202, "comment_id": 72618897, "body": "Or you can use <code>unwords</code> which is in Prelude."}, {"owner": {"reputation": 47, "user_id": 7699349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/366e6c514b0f542fe75e20e7222e115f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/7699349/bob"}, "edited": false, "score": 0, "creation_date": 1489398520, "post_id": 42751202, "comment_id": 72636708, "body": "Thanks for your suggestions. I knew about the functions filter and intercalate or unwords, but my problem is that I must apply them to a list of lists. Since there are no instructions like while or for in Haskell, I have no idea how I can pass through the list and apply the functions to each element. For example, I can not use unwords([[&quot;I&quot;, &quot;want&quot;, &quot;to&quot;, &quot;break&quot;, &quot;free&quot;, &quot;tonight&quot;], [&quot;want&quot;, &quot;I&quot;, &quot;to&quot;, &quot;break&quot;, &quot;free&quot;,&quot;tonight&quot;]]) to obtain the list [&quot;I want to break free tonight&quot;, &quot;want I to break free tonight&quot;]."}, {"owner": {"reputation": 845, "user_id": 260307, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1c1745cafe7a2ff1ffddb287eb71e812?s=128&d=identicon&r=PG", "display_name": "Blaise Pascal", "link": "https://stackoverflow.com/users/260307/blaise-pascal"}, "edited": false, "score": 0, "creation_date": 1549055662, "post_id": 42751202, "comment_id": 95781097, "body": "In the off chance that this is still a concern, the function you want (to pass through the list and apply a function to each element) is &quot;map&quot;. It takes a function and a list and applies that function to each element in the list, returning a new list.  In your case, you&#39;d do   map unwords [[&quot;I&quot;, &quot;want&quot;, &quot;to&quot;, &quot;break&quot;, &quot;free&quot;, &quot;tonight&quot;], [&quot;want&quot;, &quot;I&quot;, &quot;to&quot;, &quot;break&quot;, &quot;free&quot;, &quot;tonight&quot;]]  to get [&quot;I want to break free tonight&quot;, &quot;want I to break free tonight&quot;]"}], "tags": [], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "is_accepted": false, "score": 1, "last_activity_date": 1489342400, "creation_date": 1489342400, "answer_id": 42751202, "question_id": 42751130, "link": "https://stackoverflow.com/questions/42751130/rotations-of-a-list-in-haskell/42751202#42751202", "title": "Rotations of a list in Haskell", "body": "<p>You want the function <code>intercalate :: [a] -&gt; [[a]] -&gt; [a]</code> in <code>Data.List</code>.</p>\n\n<p>From the hackage docs:</p>\n\n<blockquote>\n  <p>intercalate :: [a] -> [[a]] -> [a]</p>\n  \n  <p>intercalate xs xss is equivalent to (concat (intersperse xs xss)). It\n  inserts the list xs in between the lists in xss and concatenates the\n  result.</p>\n</blockquote>\n\n<p>In <code>ghci</code></p>\n\n<pre><code>&gt; import Data.List\n&gt; intercalate \" \" [\"want\", \"I\", \"to\", \"break\", \"free\", \"tonight\"] \n&gt; \"want I to break free tonight\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 3, "last_activity_date": 1489342755, "creation_date": 1489342755, "answer_id": 42751282, "question_id": 42751130, "link": "https://stackoverflow.com/questions/42751130/rotations-of-a-list-in-haskell/42751282#42751282", "title": "Rotations of a list in Haskell", "body": "<blockquote>\n  <p>Running this code\u2026</p>\n</blockquote>\n\n<p>The code doesn't run.  It has type errors.</p>\n\n<p>First of all, let's fix the formatting so it's easier to read, and remove the extra parentheses</p>\n\n<pre><code>rotate :: [l] -&gt; [l]\nrotate [] = []\nrotate (x:xs) = (x:xs) ++ head (x:xs)\n\nrotate1 :: [a] -&gt; [[a]]\nrotate1 xs = take (length xs) (iterate rotate xs)\n\nmain = print $ rotate1 (words \"I want to break free tonight\")\n</code></pre>\n\n<p>This is weird:</p>\n\n<pre><code>rotate (x:xs) = (x:xs) ++ head (x:xs)\n</code></pre>\n\n<p>First of all, <code>x:xs</code> is the entire list, and <code>x</code> is the head of the list.  For example, <code>rotate [1, 2, 3]</code> becomes:</p>\n\n<pre><code>rotate [1, 2, 3] = let x = 1\n                       xs = [2, 3]\n                   in (x:xs) ++ head (x:xs)\n\nrotate [1, 2, 3] = (1:[2, 3]) ++ head (1:[2, 3])\nrotate [1, 2, 3] = [1, 2, 3] ++ head [1, 2, 3]\nrotate [1, 2, 3] = [1, 2, 3] ++ 1\n                   -- type error\n</code></pre>\n\n<p>But <code>++</code> needs a list on both sides.  What you probably want here is:</p>\n\n<pre><code>rotate (x:xs) = xs ++ [x]\n</code></pre>\n\n<p>Which gives us:</p>\n\n<pre><code>rotate [1, 2, 3] = let x = 1\n                       xs = [2, 3]\n                   in xs ++ [x]\nrotate [1, 2, 3] = [2, 3] ++ [1]\nrotate [1, 2, 3] = [2, 3, 1]\n</code></pre>\n\n<p>This is the same as:</p>\n\n<pre><code>rotate x = tail x ++ [head x]\n</code></pre>\n\n<p>For the rest of your problem\u2026 the filter should be straightforward since there is a <code>filter</code> function which does exactly what you need, and the <code>unwords</code> function turns lists of words back into strings.</p>\n"}], "owner": {"reputation": 47, "user_id": 7699349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/366e6c514b0f542fe75e20e7222e115f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/7699349/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489343393, "creation_date": 1489341947, "last_edit_date": 1489343393, "question_id": 42751130, "link": "https://stackoverflow.com/questions/42751130/rotations-of-a-list-in-haskell", "title": "Rotations of a list in Haskell", "body": "<p>I want to obtain a list of some of the rotations of the following string \"I want to break free tonight\". The constraint is that a rotation can not begin with the words \"to\" or \"tonight\". So the list of rotations is <code>[\"I want to break free today\", \"want to break free tonight I\", \"break free tonight I want to\", \"free tonight I want to break\"]</code>. </p>\n\n<p>I wrote the following functions:</p>\n\n<pre><code>rotate :: [l] -&gt; [l]\nrotate [] = []\nrotate (x:xs) = (x:xs) ++ head(x:xs)\n\nrotate1 :: [a] -&gt; [[a]]\nrotate1 xs = take (length xs) (iterate rotate xs)\n\nmain = do\nprint $ rotate1(words(\"I want to break free tonight\"))\n</code></pre>\n\n<p>Running this code, I obtained all possible rotations, but they form a list of lists having elements like <code>[\"want\", \"I\", \"to\", \"break\", \"free\", \"tonight\"]</code> which is different from the string <code>\"want I to break free tonight\"</code>. Also, I would want to see how I can drop the rotations that begin with the words <code>\"to\"</code>, <code>\"tonight\"</code>. I tried to use the filter function for the second part but I did not manage to solve the problem. Any help/hint is appreciated. I notice that I am a beginner in Haskell. </p>\n"}, {"tags": ["haskell", "data-structures", "filter"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 4817532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J9x2IROrVFs/AAAAAAAAAAI/AAAAAAAAABA/Lct15HbADb0/photo.jpg?sz=128", "display_name": "Negar Alinaghi", "link": "https://stackoverflow.com/users/4817532/negar-alinaghi"}, "edited": false, "score": 0, "creation_date": 1489335296, "post_id": 42749749, "comment_id": 72615989, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1489336922, "last_edit_date": 1489336922, "creation_date": 1489335063, "answer_id": 42749749, "question_id": 42749131, "link": "https://stackoverflow.com/questions/42749131/how-to-filter-a-tree-based-on-a-certain-condition-in-haskell/42749749#42749749", "title": "How to filter a tree based on a certain condition in Haskell?", "body": "<p>Part of the problem is that you simply don't have a way to represent an empty tree.</p>\n\n<pre><code>-- Get rid of unnecessary tuple\ndata Tree a = Empty \n            | Leaf a \n            | T (Tree a) (Tree a) deriving (Show, Eq, Ord)\n\n-- A filtered empty tree is still empty\nfilterT p Empty = Empty\n-- A leaf either stays the same or becomes empty\nfilterT p (Leaf x) | p x = Leaf x\n                   | otherwise = Empty\n-- Any other tree is just the result of filtering each child\nfilterT p (T left right) = T (filterT p left) (filterT p right)\n</code></pre>\n\n<p>This isn't a great fix; it still leaves you with multiple ways of representing essentially the same tree, since <code>Empty</code> and <code>T Empty Empty</code> aren't significantly different. You could write <em>another</em> function which \"prunes\" such trees.</p>\n\n<pre><code>prune :: Tree a -&gt; Tree a\nprune (T Empty Empty) = Empty\nprune x = x\n</code></pre>\n\n<p>which can be incorporated into your <code>filterT</code> function like so:</p>\n\n<pre><code>filterT _ Empty = Empty\nfilterT p (Leaf x) | p x = Leaf x\n                   | otherwise = Empty\nfilterT p (T left right) = let prune (T Empty Empty) = Empty\n                               prune x = x\n                          in prune $ T (filterT p left) (filterT p right)\n</code></pre>\n\n<p>You might also extend <code>prune</code> to contract single-leaf trees to a single leaf (should <code>Tree (Leaf 3) Empty</code> and <code>Leaf 3</code> be considered the same tree?), as in</p>\n\n<pre><code>filterT' _ Empty = Empty\nfilterT' p (Leaf x) | p x = Leaf x\n                    | otherwise = Empty\nfilterT' p (T left right) = let prune (T Empty Empty) = Empty\n                                prune (T (Leaf x) Empty)) = Leaf x\n                                prune (T Empty (Leaf x)) = Leaf x\n                                prune x = x\n                            in prune $ T (filterT p left) (filterT p right)\n</code></pre>\n\n<p>Finally, whether or not you use <code>prune</code> will depend on whether the filtered tree should preserve the structure of the original; maybe you want to distinguish between a leaf and a node that used to have two children, for example.</p>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1489337042, "last_edit_date": 1489337042, "creation_date": 1489335950, "answer_id": 42749902, "question_id": 42749131, "link": "https://stackoverflow.com/questions/42749131/how-to-filter-a-tree-based-on-a-certain-condition-in-haskell/42749902#42749902", "title": "How to filter a tree based on a certain condition in Haskell?", "body": "<p>There is a possibility that no item in the entire tree satisfies the condition. Then you will have an <em>empty</em> tree. So you have to either expand the definition of tree to:</p>\n\n<pre><code>data Tree a = Empty | Leaf a | Node (Tree a) (Tree a)\n</code></pre>\n\n<p>that is, include the case for an <code>Empty</code> tree or change the signature of <code>filterT</code> to:</p>\n\n<pre><code>filterT :: (a -&gt; Bool) -&gt; Tree a -&gt; Maybe (Tree a)\n</code></pre>\n\n<p>so that make it possible to return <code>Nothing</code>.</p>\n\n<p>Going with the 2nd approach <sup>(1)</sup>, a possibility would be to derive a <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\"><code>Foldable</code></a> instance and define the filter function in terms of right fold:</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) (Tree a)\n  deriving Show\n\ninstance Foldable Tree where\n  foldr f z (Leaf x)   = f x z\n  foldr f z (Node l r) = foldr f (foldr f z r) l\n\nfilterT :: (a -&gt; Bool) -&gt; Tree a -&gt; Maybe (Tree a)\nfilterT f = foldr go Nothing\n  where\n  go x z = if not (f x) then z else Just $ case z of\n    Nothing -&gt; Leaf x\n    Just tr -&gt; Node (Leaf x) tr\n</code></pre>\n\n<hr>\n\n<p><sub>\n1. because it keeps the data type simpler and avoids redundant <code>Node Empty Empty</code> values.\n</sub></p>\n"}], "owner": {"reputation": 157, "user_id": 4817532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J9x2IROrVFs/AAAAAAAAAAI/AAAAAAAAABA/Lct15HbADb0/photo.jpg?sz=128", "display_name": "Negar Alinaghi", "link": "https://stackoverflow.com/users/4817532/negar-alinaghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1489337042, "creation_date": 1489331969, "question_id": 42749131, "link": "https://stackoverflow.com/questions/42749131/how-to-filter-a-tree-based-on-a-certain-condition-in-haskell", "title": "How to filter a tree based on a certain condition in Haskell?", "body": "<p>I have defined a tree data type as follow:</p>\n\n<pre><code>data Tree a = T (Tree a, Tree a) | Leaf a deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>and I want to filter this tree based on a certain condition. The function I tried to write is: </p>\n\n<pre><code>filterT :: (a -&gt; Bool) -&gt; Tree a -&gt; Tree a\nfilterT c (T(Leaf x,T(t1,t2))) = if c x \n                                then (T(Leaf x, T(filterT c t1, filterT c t2)))\n                                else T(filterT c t1,filterT c t2)\n</code></pre>\n\n<p>this function is not working properly due to the fact that the function has nothing to return in the case where none of the two leaf values (at the end) satisfies the condition. I would be grateful if you could help.</p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 1, "creation_date": 1489323994, "post_id": 42747681, "comment_id": 72612188, "body": "You certainly can, but this defeats the purpose of having a single interface (which is what typeclasses enable), don&#39;t you think?"}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1489324174, "post_id": 42747681, "comment_id": 72612247, "body": "Of course, using the built-in Functor is not mandatory. But you will lose many benefits of the standard Functor if you don&#39;t use it."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1489324090, "creation_date": 1489324090, "answer_id": 42747794, "question_id": 42747681, "link": "https://stackoverflow.com/questions/42747681/functor-and-type-classes/42747794#42747794", "title": "Functor and type classes", "body": "<p>Sure you can do this. It's just kinda reinventing the wheel. The advantage of standard classes is that everybody will make their types instances of them if appropriate, so if you write a function that can operate on a generic <code>Functor f</code> then it'll work with a <em>huge</em> number of different type constructors <code>f</code> from hundreds of libraries. If you change the function to require <code>MyDataFunctor f</code> instead, it'll do exactly the same thing, but <em>only</em> with your own type <code>MyData</code>.</p>\n\n<p>The only sensible reason you might want to write your own class is if you want <em>different</em> behaviour.</p>\n"}], "owner": {"reputation": 308, "user_id": 4179776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-wqk14GQWaLA/AAAAAAAAAAI/AAAAAAAAARM/3nqY7GWkbTk/photo.jpg?sz=128", "display_name": "Vonfry", "link": "https://stackoverflow.com/users/4179776/vonfry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 42747794, "answer_count": 1, "score": 0, "last_activity_date": 1489324090, "creation_date": 1489323441, "last_edit_date": 1489323528, "question_id": 42747681, "link": "https://stackoverflow.com/questions/42747681/functor-and-type-classes", "title": "Functor and type classes", "body": "<p>I'm a new of Haskell. I've understand what is functor and category.</p>\n\n<p>But I have another question. Must I use a functor with <code>Functor</code> type class? </p>\n\n<p>I think I can also define another type class to do the same as <code>Functor</code>?</p>\n\n<p>Both of them can do the same.</p>\n\n<pre><code>instance Functor MyData where\n    fmap f (MyData a) = MyData (f a)\n</code></pre>\n\n<p>And</p>\n\n<pre><code>class MyDataFunctor f where\n   fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance MyDataFunctor MyData where\n   fmap f (MyData a) = MyData (f a)\n</code></pre>\n"}, {"tags": ["performance", "haskell", "fold"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1489322588, "post_id": 42747159, "comment_id": 72611765, "body": "Probably GHC is optimizing <code>foldl</code> to something closer to <code>foldl&#39;</code> in this specific case. Apart from that, the rest should be expected behavior: <code>foldl&#39;</code> should run in constant space, while <code>foldr</code> should allocate a huge amount of thunks since <code>(+)</code> is strict."}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 260401, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/21fc27a2ac6cd9094a423997f0344a0b?s=128&d=identicon&r=PG", "display_name": "framp", "link": "https://stackoverflow.com/users/260401/framp"}, "edited": false, "score": 0, "creation_date": 1489324415, "post_id": 42747565, "comment_id": 72612322, "body": "Thanks ThreeFx (and chi), this makes a lot of sense"}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": true, "score": 5, "last_activity_date": 1489324101, "last_edit_date": 1489324101, "creation_date": 1489322830, "answer_id": 42747565, "question_id": 42747159, "link": "https://stackoverflow.com/questions/42747159/foldl-memory-performance-in-ghc-8-0-x/42747565#42747565", "title": "Foldl memory performance in GHC 8.0.x", "body": "<h3><code>foldl</code> and <code>foldl'</code></h3>\n\n<p>In this case, GHC sees that <code>foldl</code> can be made strict and essentially rewrites it to utilise <code>foldl'</code>. See below how GHC optimizes the <code>foldl</code> construct.</p>\n\n<p>Note that this only applies because you compiled with optimizations <code>-O</code>. Without optimizations the <code>foldl</code> programs consumes all my memory and crashes.</p>\n\n<hr>\n\n<p>Looking at the output of <code>ghc -O -fforce-recomp -ddump-simpl foldl.hs</code> we can see that GHC eliminates the huge list used entirely and optimizes the expression to a tail recursive function:</p>\n\n<pre><code>Rec {\n-- RHS size: {terms: 20, types: 5, coercions: 0, joins: 0/0}\nMain.main_go [Occ=LoopBreaker] :: Integer -&gt; Integer -&gt; Integer\n[GblId, Arity=2, Str=&lt;S,U&gt;&lt;S,1*U&gt;]\nMain.main_go\n  = \\ (x_a36m :: Integer) (eta_B1 :: Integer) -&gt;\n      case integer-gmp-1.0.0.1:GHC.Integer.Type.gtInteger#\n             x_a36m lim_r4Yv\n      of wild_a36n\n      { __DEFAULT -&gt;\n      case GHC.Prim.tagToEnum# @ Bool wild_a36n of {\n        False -&gt;\n          Main.main_go\n            (integer-gmp-1.0.0.1:GHC.Integer.Type.plusInteger\n               x_a36m 1)\n            (integer-gmp-1.0.0.1:GHC.Integer.Type.plusInteger eta_B1 x_a36m);\n        True -&gt; eta_B1\n      }\n      }\nend Rec }\n</code></pre>\n\n<p>Which explains why it runs with constant memory usage.</p>\n\n<h3>Why does <code>foldr</code> need that much memory?</h3>\n\n<p><code>foldr</code> builds up a lot of thunks, which are essentially unfinished computations which will hold the correct value eventually. Essentially, when trying to evaluate the <code>foldr</code> expression, this happens:</p>\n\n<pre><code>foldr (+) 0 [1..100]\n== (+) 1 $ foldr 0 [2..100]\n== (+) 1 $ (+) 2 $ foldr [3..100]\n...\n== (+) 1 $ (+) 2 $ .. $ (+) 99 $ (+) 100 0 -- at this point there are 100\n== (+) 1 $ (+) 2 $ .. $ (+) 99 $ 100       -- unevaluated computations, which\n== (+) 1 $ (+) 2 $ .. $ (+) 199            -- take up a lot of memory\n...\n== (+) 1 $ 5049\n== 5050\n</code></pre>\n\n<p>The limit of <code>100000000000000000000</code> is just big for the thunks to take up more space than your RAM and you program crashes.</p>\n"}], "owner": {"reputation": 675, "user_id": 260401, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/21fc27a2ac6cd9094a423997f0344a0b?s=128&d=identicon&r=PG", "display_name": "framp", "link": "https://stackoverflow.com/users/260401/framp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 42747565, "answer_count": 1, "score": 1, "last_activity_date": 1489324101, "creation_date": 1489320335, "question_id": 42747159, "link": "https://stackoverflow.com/questions/42747159/foldl-memory-performance-in-ghc-8-0-x", "title": "Foldl memory performance in GHC 8.0.x", "body": "<p>I got into a weird issue while checking memory usage of some code I was working on.</p>\n\n<p>Using <code>foldl</code> to sum the elements of a very big list, I get a constant memory usage.</p>\n\n<p>Using <code>foldl'</code> I get a constant memory usage as well (as expected).</p>\n\n<p>Using <code>foldr</code> the memory grows and bring my system to knees (no stack overflow exception as I would expect).</p>\n\n<p>The minimum code needed to trigger it is:\n<code>\nmain = print $ foldx (+) 0 [1..100000000000000000000]\n</code></p>\n\n<p>where foldx is <code>foldl</code>, <code>foldr</code> or <code>foldl'</code></p>\n\n<p>I was under the impression (as per <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl&#39;\" rel=\"nofollow noreferrer\">Foldr Foldl Foldl'</a>) that the opposite would have been true.</p>\n\n<p>I setup a repo with the aforementioned code: \n<a href=\"https://github.com/framp/hs-fold-perf-test\" rel=\"nofollow noreferrer\">https://github.com/framp/hs-fold-perf-test</a></p>\n\n<p>What's going on here? Is it GHC 8.0.x being too smart?\nI'm on macOS Sierra</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1489319922, "post_id": 42746990, "comment_id": 72611028, "body": "A use case not present in the answer @Thilo linked, is <a href=\"https://hackage.haskell.org/package/xml-conduit\" rel=\"nofollow noreferrer\"><code>xml-conduit</code></a>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1489321225, "post_id": 42746990, "comment_id": 72611380, "body": "This (Elm) presentation has a nice use case for zippers: <a href=\"https://www.youtube.com/watch?v=IcgmSRJHu_8\" rel=\"nofollow noreferrer\">youtube.com/watch?v=IcgmSRJHu_8</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489328568, "post_id": 42746990, "comment_id": 72613669, "body": "I found <a href=\"http://blog.ezyang.com/2010/04/you-could-have-invented-zippers/\" rel=\"nofollow noreferrer\">blog.ezyang.com/2010/04/you-could-have-invented-zippers</a> useful: updating an immutable tree with bidirectional nodes requires rewriting the entire tree. Updating an immutable tree represented as a zipper only requires updating one node."}], "owner": {"reputation": 315, "user_id": 6072024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce38027df652b54943b3cdcfdbc105d?s=128&d=identicon&r=PG&f=1", "display_name": "Imraan Khan", "link": "https://stackoverflow.com/users/6072024/imraan-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1489345750, "answer_count": 0, "score": 0, "last_activity_date": 1489319109, "creation_date": 1489319109, "question_id": 42746990, "link": "https://stackoverflow.com/questions/42746990/when-and-why-would-i-use-zipper-data-structure", "closed_reason": "Duplicate", "title": "When and Why would I use Zipper Data structure", "body": "<p>Im new to Haskell. I was reading through the Zipper data structure from learnyouahaskell.com . I am simply not able to understand when and why would I use a Zipper for trees or lists or anything</p>\n"}, {"tags": ["haskell", "functional-programming", "fold"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1489360446, "post_id": 42746164, "comment_id": 72624981, "body": "You can also think of <code>foldr k z xs</code> as replacing all the <code>:</code> in <code>xs</code> with <code>k</code>, and <code>[]</code> with <code>z</code>. So <code>foldr (:) [3, 4] [1, 2]</code> takes <code>1 : 2 : []</code> and replaces <code>[]</code> with <code>[3, 4]</code>, giving <code>1 : 2 : [3, 4]</code> = <code>[1, 2, 3, 4]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": true, "score": 4, "last_activity_date": 1489314127, "creation_date": 1489314127, "answer_id": 42746224, "question_id": 42746164, "link": "https://stackoverflow.com/questions/42746164/how-does-this-implementation-by-foldr-work/42746224#42746224", "title": "How does this `++` implementation by `foldr` work?", "body": "<p>IMO, your reasoning is correct - there's an error in the video:</p>\n\n<pre><code>xs ++ ys = ...\n= (++) ys xs = ...\n</code></pre>\n\n<p>should really be</p>\n\n<pre><code>xs ++ ys = ...\n= (++) xs ys = ...\n</code></pre>\n\n<p>If you look at the comments to the <a href=\"https://channel9.msdn.com/Series/C9-Lectures-Erik-Meijer-Functional-Programming-Fundamentals/C9-Lectures-Dr-Erik-Meijer-Functional-Programming-Fundamentals-Chapter-7-of-13\" rel=\"nofollow noreferrer\">video</a>, you'll notice that <a href=\"https://channel9.msdn.com/Series/C9-Lectures-Erik-Meijer-Functional-Programming-Fundamentals/C9-Lectures-Dr-Erik-Meijer-Functional-Programming-Fundamentals-Chapter-7-of-13#c633936524210000000\" rel=\"nofollow noreferrer\">Tom Lokhorst pointed out this error (among several others)</a>.</p>\n"}], "owner": {"reputation": 849, "user_id": 3316009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q0EyA.jpg?s=128&g=1", "display_name": "calvin", "link": "https://stackoverflow.com/users/3316009/calvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 42746224, "answer_count": 1, "score": 3, "last_activity_date": 1489329494, "creation_date": 1489313757, "last_edit_date": 1489329494, "question_id": 42746164, "link": "https://stackoverflow.com/questions/42746164/how-does-this-implementation-by-foldr-work", "title": "How does this `++` implementation by `foldr` work?", "body": "<p>I am learning Haskell with <em>programming in haskell</em> from Channel 9 Lectures. In chapter 7, the professor implemented his own <code>++</code> operator using <code>foldr</code> by</p>\n\n<pre><code>(++ ys) = foldr (:) ys\n</code></pre>\n\n<p>and his reasoning is</p>\n\n<pre><code>  xs ++ ys = foldr (:) ys xs\n= (++) ys xs = foldr (:) ys xs\n= (++ ys) = foldr (:) ys\n</code></pre>\n\n<p>Here is the blackboard</p>\n\n<p><a href=\"https://i.stack.imgur.com/i4JAY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i4JAY.png\" alt=\"enter image description here\"></a></p>\n\n<p>I got confused here why <code>xs ++ ys</code> functions the same as <code>(++) ys xs</code>. And I let <code>xs = [1,2,3]</code> and <code>ys = [4,5,6]</code> and run them by runhaskell, they just produce different answers:</p>\n\n<pre><code>&gt; main = print $ [1,2,3] ++ [4,5,6]\n[1,2,3,4,5,6]\n&gt; main = print $ foldr (:) [4,5,6] [1,2,3]\n[1,2,3,4,5,6]\n&gt; main = print $ (++) [4,5,6] [1,2,3] \n[4,5,6,1,2,3]\n</code></pre>\n\n<p>So what did the professor actually mean in his reasoning?</p>\n\n<p>By the way, I am trying to induce by myself like the following:</p>\n\n<pre><code>  xs ++ ys = foldr (:) ys xs\n= (++) xs ys = foldr(:) ys xs\n</code></pre>\n\n<p><code>foldr(:) ys xs</code> at the right part of the equation means for each <code>y</code> in this <code>Foldable</code> <code>ys</code>, apply <code>:</code> to <code>y</code> and <code>xs</code>, which is actually what's done on the left side. Is my reasoning right? </p>\n"}, {"tags": ["linux", "haskell", "ghci", "haskell-platform", "winghci"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489313297, "post_id": 42745890, "comment_id": 72609062, "body": "Maybe you should migrate this to AskUbuntu. The haskell-platform is present on <a href=\"http://packages.ubuntu.com/search?keywords=haskell-platform&amp;searchon=names&amp;suite=all&amp;section=all\" rel=\"nofollow noreferrer\">several</a> ubuntu versions. Ubuntu 14 is a bit oldish and only has GHC 7.6.3."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489313407, "post_id": 42745890, "comment_id": 72609101, "body": "If you really need 8.0.2, install zesty, or (probably easier) install it manually from the ghc website."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489313421, "post_id": 42745890, "comment_id": 72609105, "body": "8.0.2? That&#39;s not even in Ubuntu 16.10. @chi <a href=\"https://www.haskell.org/downloads/linux\" rel=\"nofollow noreferrer\">hvr packages</a> are usually good enough to get started. (The PPA includes 8.0.2 as well as the 8.2 &quot;preview&quot;)"}, {"owner": {"reputation": 19, "user_id": 7697837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70687d9d1d6ed132a54ac7338fb5d62b?s=128&d=identicon&r=PG&f=1", "display_name": "B.Bouchra", "link": "https://stackoverflow.com/users/7697837/b-bouchra"}, "edited": false, "score": 0, "creation_date": 1489314976, "post_id": 42745890, "comment_id": 72609559, "body": "Thank you very much it&#39;s probably the version that cause the problem so  i will try with GHC 7.6.3 because i tried hvr packages and  it doesn&#39;t work too."}], "owner": {"reputation": 19, "user_id": 7697837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70687d9d1d6ed132a54ac7338fb5d62b?s=128&d=identicon&r=PG&f=1", "display_name": "B.Bouchra", "link": "https://stackoverflow.com/users/7697837/b-bouchra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1489311901, "creation_date": 1489311901, "question_id": 42745890, "link": "https://stackoverflow.com/questions/42745890/ghci-haskell-programming-in-linux", "title": "ghci haskell programming in linux", "body": "<p>i'm trying to install GHCi version 8.0.2 on linux ubunto 14.10 i'm using a virtual machine vmware 12.5  thought i followed the steps of installation of the site of haskell platform but i have always the same error:</p>\n\n<p>hp@ubuntu:~$ sudo apt-get install haskell-platform</p>\n\n<p>[sudo] password for hp: </p>\n\n<p>Reading package lists... Done</p>\n\n<p>Building dependency tree </p>\n\n<p>Reading state information... Done</p>\n\n<p>E: Unable to locate package haskell-platform</p>\n\n<p>Is there any solution? what should i do ?? </p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1489287904, "post_id": 42743230, "comment_id": 72604021, "body": "From my answer to the question you linked: &quot;If you want to order the result by first occurrence, you can use zip before the sort to add an index to each element, then, after grouping, sort again by that index and then remove the index&quot;"}, {"owner": {"reputation": 13788, "user_id": 3222797, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/H5JG2.png?s=128&g=1", "display_name": "gobrewers14", "link": "https://stackoverflow.com/users/3222797/gobrewers14"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1489288279, "post_id": 42743230, "comment_id": 72604089, "body": "Hmmm.... I should read more carefully.  Thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 13788, "user_id": 3222797, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/H5JG2.png?s=128&g=1", "display_name": "gobrewers14", "link": "https://stackoverflow.com/users/3222797/gobrewers14"}, "edited": false, "score": 0, "creation_date": 1489291968, "post_id": 42743505, "comment_id": 72604738, "body": "Thanks, this is a great solution, although I&#39;d rather avoid maps for this particular problem."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1489290801, "last_edit_date": 1489290801, "creation_date": 1489290332, "answer_id": 42743505, "question_id": 42743230, "link": "https://stackoverflow.com/questions/42743230/count-elements-in-a-list-while-preserving-order/42743505#42743505", "title": "Count elements in a list while preserving order", "body": "<p>You could use <a href=\"http://hackage.haskell.org/package/ordered-containers-0.1.0/docs/Data-Map-Ordered.html\" rel=\"noreferrer\"><code>Data.Map.Ordered</code></a>.</p>\n\n<pre><code>import Data.Map.Ordered (OMap)\nimport qualified Data.Map.Ordered as OMap\n\n-- insert L L With\n--        ^ ^\n--        |  `----- insert combined elements on the left of the sequence\n--        `-------- insert new      elements on the left of the sequence\ninsertLLWith :: Ord k =&gt; (v -&gt; v -&gt; v) -&gt; (k, v) -&gt; OMap k v -&gt; OMap k v\ninsertLLWith f (k, v) m = case OMap.lookup k m of\n    Nothing -&gt; (k, v) OMap.|&lt; m\n    Just v' -&gt; (k, f v v') OMap.|&lt; m\n</code></pre>\n\n<p>Armed with <code>insertLLWith</code> (which should probably go into the library with a few variants -- it seems generally useful!), we can write a fairly straightforward fold:</p>\n\n<pre><code>multisetFromList :: Ord a =&gt; [a] -&gt; OMap a Int\nmultisetFromList = foldr (\\x -&gt; insertLLWith (+) (x, 1)) OMap.empty\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; multisetFromList [4,4,4,2,2,2,2,1,1,3]\nfromList [(4,3),(2,4),(1,2),(3,1)]\n&gt; multisetFromList [2,1,2] -- works with ungrouped lists, too\nfromList [(2,2),(1,1)]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13788, "user_id": 3222797, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/H5JG2.png?s=128&g=1", "display_name": "gobrewers14", "link": "https://stackoverflow.com/users/3222797/gobrewers14"}, "edited": false, "score": 0, "creation_date": 1489292750, "post_id": 42743605, "comment_id": 72604861, "body": "Thanks, I appreciate the response.  All of these are very helpful."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": false, "score": 1, "last_activity_date": 1489291373, "creation_date": 1489291373, "answer_id": 42743605, "question_id": 42743230, "link": "https://stackoverflow.com/questions/42743230/count-elements-in-a-list-while-preserving-order/42743605#42743605", "title": "Count elements in a list while preserving order", "body": "<p>As sepp2k commented, you could sort by index after grouping by element. I like to express this with generalized list comprehensions.</p>\n\n<pre><code>{-# LANGUAGE TransformListComp #-}\nimport GHC.Exts\ncountOccurrences :: (Ord a) =&gt; [a] -&gt; [(a, Int)]\ncountOccurrences list =\n    [ (the x, length x)\n    | (i, x) &lt;- zip [0..] list\n    , then group by x using groupWith\n    , then sortWith by minimum i\n    ]\n</code></pre>\n\n<p>Other alternatives include updating the counter list as you go</p>\n\n<pre><code>countOccurrences :: (Eq a) =&gt; [a] -&gt; [(a, Int)]\ncountOccurrences = foldl incrementCount [] where\n    incrementCount [] x = [(x, 1)]\n    incrementCount (count@(y, n):counts) x \n      | x == y = (y, n+1):counts\n      | otherwise = count:incrementCount counts x \n</code></pre>\n\n<p>or generating a list with all the partial counts, then filtering down to the final count</p>\n\n<pre><code>import Data.Function\nimport Data.List\ncountOccurrences :: (Eq a) =&gt; [a] -&gt; [(a, Int)]\ncountOccurrences = nubBy ((==) `on` fst) . foldr addCount [] where\n    addCount x counts = (x, maybe 1 succ $ lookup x counts) : counts\n</code></pre>\n\n<p>although neither is very efficient.</p>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1489293350, "creation_date": 1489293350, "answer_id": 42743802, "question_id": 42743230, "link": "https://stackoverflow.com/questions/42743230/count-elements-in-a-list-while-preserving-order/42743802#42743802", "title": "Count elements in a list while preserving order", "body": "<p>An alternative would be two right folds:</p>\n\n<pre><code>import Prelude hiding (lookup)\nimport Data.Map (empty, lookup, delete, insertWith)\n\ncount :: (Foldable t, Ord k, Num a) =&gt; t k -&gt; [(k, a)]\ncount xs = foldr go (const []) xs $ foldr (\\k -&gt; insertWith (+) k 1) empty xs\n  where\n  go x f m = case lookup x m of\n    Nothing -&gt; f m\n    Just i  -&gt; (x, i): f (delete x m)\n</code></pre>\n\n<p>then,</p>\n\n<pre><code>\\&gt; count [4,2,4,4,2,1,2,2,1,3]\n[(4,3),(2,4),(1,2),(3,1)]\n</code></pre>\n"}], "owner": {"reputation": 13788, "user_id": 3222797, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/H5JG2.png?s=128&g=1", "display_name": "gobrewers14", "link": "https://stackoverflow.com/users/3222797/gobrewers14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 42743505, "answer_count": 3, "score": 1, "last_activity_date": 1489293437, "creation_date": 1489287604, "last_edit_date": 1495542322, "question_id": 42743230, "link": "https://stackoverflow.com/questions/42743230/count-elements-in-a-list-while-preserving-order", "title": "Count elements in a list while preserving order", "body": "<p>I am wondering if there is a way to count the distinct elements in a list and group the counts into tuples, for example</p>\n\n<pre><code>[4,4,4,2,2,2,2,1,1,3]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[4,2,4,4,2,1,2,2,1,3]\n</code></pre>\n\n<p>would yield</p>\n\n<pre><code>[(4,3),(2,4),(1,2),(3,1)]\n</code></pre>\n\n<p>while preserving the order of the original list.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3710976/counting-unique-elements-in-a-list\">This question</a> mentions preserving the order in the comments, <s> but never addresses the issue.</s></p>\n\n<p>Here is my attempt thus far:</p>\n\n<pre><code>import Data.List (nub)\n\ncountOccurance :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\ncountOccurance x = length . filter (==x)\n\nnaiveCounter :: (Eq a) =&gt; [a] -&gt; [(a, Int)]\nnaiveCounter l = map (\\x -&gt; (x, countOccurance x l)) $ nub l\n</code></pre>\n\n<p>but this seems quite inefficient.  Is there a way to construct this more efficiently (for instance, by traversing the list only one time)?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "llvm", "cabal", "conditional-compilation"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1489288404, "post_id": 42742998, "comment_id": 72604109, "body": "How is the user choosing the compilation method? Usually that is done with a cabal flag."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1489335426, "post_id": 42742998, "comment_id": 72616022, "body": "@crockeea oh, hm. You mean as the library author I would make a new flag <code>usellvm</code> and I&#39;d conditionally set <code>ghc-options: -fllvm</code>? I think on the few occasions where I&#39;ve wanted to try compiling all my dependencies with llvm I&#39;ve done <code>cabal install --only-dependencies --ghc-options=-fllvm</code>, but maybe that didn&#39;t really do the trick. In any case I&#39;d like this to work regardless of how the user chose the compilation method."}], "answers": [{"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 1, "last_activity_date": 1489339121, "creation_date": 1489339121, "answer_id": 42750576, "question_id": 42742998, "link": "https://stackoverflow.com/questions/42742998/cabal-compilation-conditional-on-compiling-with-llvm-or-not/42750576#42750576", "title": "Cabal compilation conditional on compiling with llvm or not", "body": "<p>Ah, I forgot to check the GHC docs. GHC defines a macro <code>__GLASGOW_HASKELL_LLVM__</code> which is defined when <code>-fllvm</code> was specified (and can be used to check llvm version as well):</p>\n\n<p><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html#options-affecting-the-c-pre-processor\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html#options-affecting-the-c-pre-processor</a></p>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 42750576, "answer_count": 1, "score": 1, "last_activity_date": 1489339121, "creation_date": 1489285273, "question_id": 42742998, "link": "https://stackoverflow.com/questions/42742998/cabal-compilation-conditional-on-compiling-with-llvm-or-not", "title": "Cabal compilation conditional on compiling with llvm or not", "body": "<p>In a library I'm writing I need to use <code>CPP</code> to choose between two blocks of code depending on whether my user is compiling with LLVM or the native code gen. Is there a way to detect this in the <code>.cabal</code> file and do something like</p>\n\n<pre><code>library\n  -- not real:\n  if backend(llvm)\n      CPP-Options:     -DUSING_LLVM\n</code></pre>\n\n<p>Or maybe it's even possible to detect arbitrary flags passed to GHC (instead of just <code>-fllvm</code>)?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": false, "score": 2, "last_activity_date": 1489282407, "last_edit_date": 1489282407, "creation_date": 1489281868, "answer_id": 42742657, "question_id": 42742594, "link": "https://stackoverflow.com/questions/42742594/couldnt-match-expected-type-integer-with-actual-type-integer/42742657#42742657", "title": "Couldn&#39;t match expected type \u2018[Integer]\u2019 with actual type \u2018Integer\u2019", "body": "<pre><code>fibs :: [Integer]\ntake 50 fibs :: [Integer]\n\nx &lt;- take 50 fibs\nx :: Integer\n\nlast :: [a] -&gt; a\nlast x :: ???\n</code></pre>\n\n<p>Your list comprehension will typecheck if you remove <code>last</code>. I think what you meant to write is something more like</p>\n\n<pre><code>[ x | x &lt;- takeWhile (&lt;= 4*10^6) $ take 50 fibs, x `mod` 2 == 0 ]\n</code></pre>\n\n<p>though.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 2002447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91b3672c5dff6d7130b6bc92d0f4f2d?s=128&d=identicon&r=PG", "display_name": "mduprey", "link": "https://stackoverflow.com/users/2002447/mduprey"}, "edited": false, "score": 0, "creation_date": 1489283998, "post_id": 42742667, "comment_id": 72603288, "body": "Awesome. My problem was thinking of <code>x</code> as a list. Appreciate the thoughtful explanation and bonus alternatives."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1489282334, "last_edit_date": 1489282334, "creation_date": 1489281946, "answer_id": 42742667, "question_id": 42742594, "link": "https://stackoverflow.com/questions/42742594/couldnt-match-expected-type-integer-with-actual-type-integer/42742667#42742667", "title": "Couldn&#39;t match expected type \u2018[Integer]\u2019 with actual type \u2018Integer\u2019", "body": "<blockquote>\n<pre><code>sum [ x | x &lt;- take 50 fibs, x `mod` 2 == 0, last x &lt;= 4*10^6 ]\n</code></pre>\n</blockquote>\n\n<p><code>take 50 fibs</code> is a list of <code>Integer</code> (<code>[Integer]</code>), and <code>x</code> is an element of that list (thus an <code>Integer</code>). <code>last</code> is a function which takes a list...</p>\n\n<pre><code>GHCi&gt; :t last\nlast :: [a] -&gt; a\n</code></pre>\n\n<p>... but you are passing an <code>Integer</code> to it. You don't need <code>last</code> to filter the elements in the list comprehension; just use:</p>\n\n<pre><code>sum [ x | x &lt;- take 50 fibs, x `mod` 2 == 0, x &lt;= 4*10^6 ]\n</code></pre>\n\n<p>By the way, given that you know that the numbers in <code>fibs</code> always increase, you can write your expression as:</p>\n\n<pre><code>-- (&lt;= 4*10^6) is shorthand for (\\x -&gt; x &lt;= 4*10^6)\nsum [ x | x &lt;- takeWhile (&lt;= 4*10^6) fibs, x `mod` 2 == 0 ]\n-- Three equivalent alternatives:\n(sum . takeWhile (&lt;= 4*10^6)) [ x | x &lt;-  fibs, x `mod` 2 == 0 ]\n(sum . takeWhile (&lt;= 4*10^6) . filter (\\x -&gt; x `mod` 2 == 0)) fibs\n(sum . takeWhile (&lt;= 4*10^6) . filter ((== 0) . (`mod` 2))) fibs\n</code></pre>\n\n<p>That way you don't need the arbitrary limit of 50 elements.</p>\n"}], "owner": {"reputation": 99, "user_id": 2002447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91b3672c5dff6d7130b6bc92d0f4f2d?s=128&d=identicon&r=PG", "display_name": "mduprey", "link": "https://stackoverflow.com/users/2002447/mduprey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 0, "accepted_answer_id": 42742667, "answer_count": 2, "score": 2, "last_activity_date": 1489283623, "creation_date": 1489281325, "last_edit_date": 1495540440, "question_id": 42742594, "link": "https://stackoverflow.com/questions/42742594/couldnt-match-expected-type-integer-with-actual-type-integer", "title": "Couldn&#39;t match expected type \u2018[Integer]\u2019 with actual type \u2018Integer\u2019", "body": "<p>I am working on creating a list of all the even numbers in the Fibonacci series which are less than or equal to 4,000,000. In Haskell, I've defined the Fibonacci series as:</p>\n\n<pre><code>fibs = 1 : 2 : next fibs\n  where\n    next (a : t@(b:_)) = (a+b) : next t\n</code></pre>\n\n<p>and am using the following list comprehension to construct my set:</p>\n\n<pre><code>[ x | x &lt;- take 50 fibs, x `mod` 2 == 0, last x &lt;= 4*10^6 ]\n</code></pre>\n\n<p>However, GHC is throwing a <code>Couldn't match expected type \u2018[Integer]\u2019 with actual type \u2018Integer\u2019</code> error.</p>\n\n<p>I understand that the predicate, <code>last x &lt;= 4*10^6</code>, is responsible for the error. Inspired by hammar's answer <a href=\"https://stackoverflow.com/a/16492431/2002447\">here</a>, my initial reaction was to ensure that <code>4*10^6</code> was the right type, so I tried rephrasing the predicate as <code>last x &lt;= toInteger 4*10^6</code> to no avail; same error. I also thought that maybe I needed to specify <code>4*10^6</code> as a singleton (i.e. <code>[4*10^6]</code>), but no luck there either.</p>\n\n<p>I'm struggling to understand what is exactly going on and how best to resolve the issue.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1289, "user_id": 2379903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ee17b19924a4e62661b710523ba060?s=128&d=identicon&r=PG", "display_name": "Art Yerkes", "link": "https://stackoverflow.com/users/2379903/art-yerkes"}, "edited": false, "score": 1, "creation_date": 1489280031, "post_id": 42742399, "comment_id": 72602599, "body": "For the two parameter case, prelude has <code>flip</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1289, "user_id": 2379903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ee17b19924a4e62661b710523ba060?s=128&d=identicon&r=PG", "display_name": "Art Yerkes", "link": "https://stackoverflow.com/users/2379903/art-yerkes"}, "edited": false, "score": 0, "creation_date": 1489291296, "post_id": 42742399, "comment_id": 72604616, "body": "To make @ArtYerkes comment explicit, <code>map (flip divide 3) temp</code> does what you want."}], "answers": [{"tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 1, "last_activity_date": 1489279415, "creation_date": 1489279415, "answer_id": 42742421, "question_id": 42742399, "link": "https://stackoverflow.com/questions/42742399/changing-parameter-order-of-the-function-given-to-map/42742421#42742421", "title": "Changing parameter order of the function given to map", "body": "<p>Just make the function parameter an explicit lambda instead of a partially applied function:</p>\n\n<pre><code>map (\\n -&gt; divide n 3) temp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1360, "user_id": 1594886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cda9c379816b5fa2094c09c3853168?s=128&d=identicon&r=PG", "display_name": "tauli", "link": "https://stackoverflow.com/users/1594886/tauli"}, "is_accepted": true, "score": 2, "last_activity_date": 1489279971, "last_edit_date": 1489279971, "creation_date": 1489279479, "answer_id": 42742426, "question_id": 42742399, "link": "https://stackoverflow.com/questions/42742399/changing-parameter-order-of-the-function-given-to-map/42742426#42742426", "title": "Changing parameter order of the function given to map", "body": "<p>You can either use <code>divide</code> as an infix-operator by enclosing it in backtics like this</p>\n\n<pre><code>map (`divide` 3) temp\n</code></pre>\n\n<p>or, if you run into a more complicated case in the future, write a lambda (anonymous function)</p>\n\n<pre><code>map (\\x -&gt; divide x 3) temp\n</code></pre>\n\n<p>You may also want to take a look at this more detailed explanation <a href=\"https://wiki.haskell.org/Anonymous_function\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Anonymous_function</a></p>\n"}], "owner": {"reputation": 523, "user_id": 4803964, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/89fe55f09d40e619e4b2cacabe163040?s=128&d=identicon&r=PG&f=1", "display_name": "rohaldb", "link": "https://stackoverflow.com/users/4803964/rohaldb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 42742426, "answer_count": 2, "score": 0, "last_activity_date": 1489280687, "creation_date": 1489279206, "last_edit_date": 1489280687, "question_id": 42742399, "link": "https://stackoverflow.com/questions/42742399/changing-parameter-order-of-the-function-given-to-map", "title": "Changing parameter order of the function given to map", "body": "<p>Say for example we had a function </p>\n\n<pre><code>divide :: Float -&gt; Float -&gt; Float\ndivide x y = x / y\n</code></pre>\n\n<p>And a list <code>let list = [1,2,3]</code></p>\n\n<p>I know i can apply the divide function to the list like so: <code>map (divide 3) temp</code></p>\n\n<p>But what if I wanted to swap the order of the parameters passed to the <code>divide</code> method, so that each element of the list is divided by 3, rather than 3 being divided by the element.</p>\n\n<p>Something like the following <code>map (divide temp) 3</code>.</p>\n\n<p>Additionally, what if <code>divide</code> had 3 parameters and each element of the list needed to be the middle parameter. How would one do this?</p>\n"}, {"tags": ["haskell", "typechecking", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 3, "creation_date": 1489268731, "post_id": 42740960, "comment_id": 72599759, "body": "How about <a href=\"https://wiki.haskell.org/Scoped_type_variables\" rel=\"nofollow noreferrer\">ScopedTypeVariables</a>?"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1489268946, "answer_count": 0, "score": 2, "last_activity_date": 1489269315, "creation_date": 1489268377, "last_edit_date": 1489268731, "question_id": 42740960, "link": "https://stackoverflow.com/questions/42740960/how-to-i-tell-the-type-checker-a-type-signature-in-binding-matches-the-top-level", "closed_reason": "Duplicate", "title": "How to I tell the type checker a type signature in binding matches the top level type signature?", "body": "<p><strong>Background</strong></p>\n\n<p>I like to add type signatures to my <code>where</code> and <code>let</code> bindings some times as it helps me remember what I need my results to be and what my inputs are.  It also helps the type checker give me a clear error message when I get it wrong.  However, it has been causing me problems recently:</p>\n\n<p><strong>Given</strong></p>\n\n<p>This is an admittedly contrived minimum example:</p>\n\n<pre><code>data Foo a = Foo a | NotFoo                  -- 3 \n                                             -- 4 \ndata Bar a = Bar a                           -- 5 \n                                             -- 6 \nfunct :: Bar a -&gt; (a -&gt; Foo a) -&gt; Bar a      -- 7 \nfunct (Bar x) fn = loop (Bar x, Foo x)       -- 8 \n  where                                      -- 9 \n    loop :: (Bar a,Foo a) -&gt; Bar a           -- 10\n    loop (x, (Foo y)) = loop (Bar y, fn y)   -- 11\n    loop (x, NotFoo) = x                     -- 12\n</code></pre>\n\n<p>GHC spits back an error:</p>\n\n<pre><code>min_test.hs:11:41: error:\n    * Couldn't match expected type `a' with actual type `a1'\n      `a1' is a rigid type variable bound by\n        the type signature for:\n          loop :: forall a1. (Bar a1, Foo a1) -&gt; Bar a1\n        at min_test.hs:10:13\n      `a' is a rigid type variable bound by\n        the type signature for:\n          funct :: forall a. Bar a -&gt; (a -&gt; Foo a) -&gt; Bar a\n        at min_test.hs:7:10\n    * In the first argument of `fn', namely `y'\n      In the expression: fn y\n      In the first argument of `loop', namely `(Bar y, fn y)'\n    * Relevant bindings include\n        y :: a1 (bound at min_test.hs:11:19)\n        x :: Bar a1 (bound at min_test.hs:11:11)\n        loop :: (Bar a1, Foo a1) -&gt; Bar a1 (bound at min_test.hs:11:5)\n        fn :: a -&gt; Foo a (bound at min_test.hs:8:15)\n        funct :: Bar a -&gt; (a -&gt; Foo a) -&gt; Bar a (bound at min_test.hs:8:1)\n</code></pre>\n\n<p><em>TL;DR</em> = GHC cannot infer that the <code>a</code> in the type signature on line 7 is the same as the <code>a</code> in the type signature on line 11.</p>\n\n<p>If I comment out line 11 everyone is happy.</p>\n\n<p><strong>Question</strong></p>\n\n<p>Is there a way to place write a type signature for <code>loop</code> in such a way that GHC / Haskell knows that it is the same <code>a</code> in both places?</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489265325, "post_id": 42739584, "comment_id": 72598638, "body": "Why wouldn&#39;t it? As you&#39;ve pointed out, this is &quot;easy to get around&quot;, and neither type (the original or your modification) for <code>(&#47;&#47;&gt;)</code> is a subtype of the other, so your modification does not generalize the old function, nor is it a specialization. In other words, there are type-correct programs using <code>(&#47;&#47;&gt;)</code> which would not typecheck with your modification, and vice-versa. So why is your version &#39;better&#39;? (As far as pipe laws go, I don&#39;t know enough about pipes to know if your function is indeed law abiding - hopefully someone else can verify that fact for you)"}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489265784, "post_id": 42739584, "comment_id": 72598790, "body": "If you look at the diagram <a href=\"https://hackage.haskell.org/package/pipes-4.3.2/docs/Pipes-Core.html#g:3\" rel=\"nofollow noreferrer\">here</a> you can see that the x&#39; and x type variables of g aren&#39;t actually used. I can&#39;t come up with any extra programs that this would allow for which couldn&#39;t be easily converted but maybe I am just missing something obvious. Although of course changing it now might be problematic?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489266408, "post_id": 42739584, "comment_id": 72599012, "body": "The type variables <i>are</i> used, by the type system (of Haskell, over which <code>pipes</code> has no control). It is the values &#39;represented&#39; by those type parameters which are unused. I also cannot come up with any such programs, but the fact stands, that since neither type is subtype of the other, there do <i>exist</i> such programs, even if they are wildly complicated, impractical, what have you. ..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1489266413, "post_id": 42739584, "comment_id": 72599014, "body": "... But the question still stands - why is your version better? It is not a strict generalization - so what does it offer that the original doesn&#39;t? Ignoring that making such a change in a long-existing library would be catastrophic to users of the library - even if you had the opportunity to rewrite pipes from the ground up, what would be the motivation to use your version over the current one?"}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489267637, "post_id": 42739584, "comment_id": 72599400, "body": "With the library version g can only take a single value when called and return a single value when finished. This version starts the same but is also allowed to further communicate. Turns out that makes it impossible to write producer1 //&gt; producer2 with my function if producer2 is explicitly defined as <code>Producer a m r</code>, though. Since the entire point of the combinator is to chain producers that seems like a deal breaker. Still kind of wish pipes would ship with some combinators for bidirectional pipes, though. Thanks for your comments!"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1489362617, "last_edit_date": 1489362617, "creation_date": 1489359442, "answer_id": 42754216, "question_id": 42739584, "link": "https://stackoverflow.com/questions/42739584/pipes-unfolds-composition/42754216#42754216", "title": "Pipes unfolds composition", "body": "<p>I believe the relevant part of <a href=\"https://hackage.haskell.org/package/pipes-4.3.2/docs/Pipes-Core.html#v:-47--47--62-\" rel=\"nofollow noreferrer\"><code>(//&gt;)</code>'s contract</a> is...</p>\n\n<blockquote>\n  <p><code>(p //&gt; f)</code> replaces each <code>respond</code> in <code>p</code> with <code>f</code>.</p>\n</blockquote>\n\n<p>... which implies that <code>f</code> will handle all values received from <code>p</code> in the same manner. That, however, is exactly what your combinator circumvents -- in your example, you alternate between sets of messages as you go through the elements of <code>each [1..10]</code>. To further illustrate the point, here is a slightly modified version of your code (in particular, I have picked a different name for your combinator, and used plain old <code>(//&gt;)</code> immediately after <code>each [1..10]</code>, as your combinator behaves the same in that case):</p>\n\n<pre><code>infixl 4 //&gt;*\n(//&gt;*) :: Monad m =&gt;\n    Proxy x' x b' b m r -&gt; (b -&gt; Proxy b' b c' c m b') -&gt; Proxy x' x c' c m r\np //&gt;* f = p &gt;&gt;~ go\n    where go x = f x &gt;&gt;= request &gt;&gt;= go\n\nsrc :: Monad m =&gt; Producer Int m ()\nsrc = each [1..10]\n\n-- The types of lhs and rhs are more restrictive than yours, but for this\n-- usage pattern (and with the adjustments I made) that is not a problem. \nlhs :: Show a =&gt; a -&gt; Server String String IO ()\nlhs = \\i -&gt; do\n    r &lt;- respond $ \"response nr. \" ++ show i\n    lift . putStrLn $ \"lhs: \" ++ r\n\nrhs :: String -&gt; Client String String IO String\nrhs x = do\n    lift . putStrLn $ \"rhs 0: Will this happen for every value?\"\n    lift . putStrLn $ \"rhs 1: \" ++ x\n    y &lt;- request \"yield manually to upstream!\"\n    lift . putStrLn $ \"rhs 2: \" ++ y\n    return \"return to upstream\"\n</code></pre>\n\n<p>The answer to the question I slipped in at the beginning of <code>rhs</code>...</p>\n\n<pre><code>GHCi&gt; runEffect $ (src //&gt; lhs) //&gt;* rhs\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 1\nlhs: yield manually to upstream!\nrhs 2: response nr. 2\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 3\nlhs: yield manually to upstream!\nrhs 2: response nr. 4\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 5\nlhs: yield manually to upstream!\nrhs 2: response nr. 6\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 7\nlhs: yield manually to upstream!\nrhs 2: response nr. 8\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 9\nlhs: yield manually to upstream!\nrhs 2: response nr. 10\nlhs: return to upstream\n</code></pre>\n\n<p>... is no. Contrast that with what happens when I wire your functions using <code>(//&gt;)</code> as the outermost combinator, like this:</p>\n\n<pre><code>GHCi&gt; runEffect $ src //&gt; (\\x -&gt; lhs x //&gt;* rhs)\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 1\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 2\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 3\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 4\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 5\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 6\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 7\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 8\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 9\nlhs: yield manually to upstream!\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 10\nlhs: yield manually to upstream!\n</code></pre>\n\n<p>Instead of setting a server that will give at most ten responses (<code>src //&gt; lhs</code>), here every value gives rise to a single-response server, whose response is handled by the <code>rhs</code> client. Given that there is no second response to be gotten out of the server, the code in <code>rhs</code> after the <code>request</code> is never ran. As a consequence, the values from <code>src</code> are handled uniformly. To further emphasise that, note that using your combinator to do that is unnecessary: <code>src //&gt; (lhs &gt;~&gt; void . rhs)</code> does the same thing.</p>\n\n<p>(Another thing to note is that, if we change back the types of <code>lhs</code> and <code>rhs</code> to what you had them to be at first, we can write the pipeline just above as <code>src //&gt;* (\\x -&gt; lhs x //&gt;* rhs)</code>. However, that is not the same as <code>(src //&gt;* lhs) //&gt;* rhs</code>. That is an associativity failure, and so your combinator does not give rise to a category.)</p>\n\n<p>It also helps to clarify what is going on to replace your combinator with <code>(&gt;&gt;~)</code> (something that I'm sure you have tried in your tests):</p>\n\n<pre><code>GHCi&gt; runEffect $ (src //&gt; lhs) &gt;&gt;~ void . rhs\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 1\nlhs: yield manually to upstream!\nrhs 2: response nr. 2\n</code></pre>\n\n<p><code>src //&gt; lhs</code> offers up to ten responses; <code>rhs</code>, however, only makes two requests, and so the other eight responses are left unused. To me, that suggests your combinator is best expressed as a way to make a client carry on requesting indefinitely:</p>\n\n<pre><code>-- requestForever :: Monad m =&gt; (b -&gt; Client b' b m b') -&gt; b -&gt; Client b' b m r\nrequestForever :: Monad m =&gt; \n    (b -&gt; Proxy b' b c' c m b') -&gt; b -&gt; Proxy b' b c' c m r\nrequestForever f = go\n    where go x = f x &gt;&gt;= request &gt;&gt;= go\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; runEffect $ (src //&gt; lhs) &gt;&gt;~ requestForever rhs\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 1\nlhs: yield manually to upstream!\nrhs 2: response nr. 2\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 3\nlhs: yield manually to upstream!\nrhs 2: response nr. 4\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 5\nlhs: yield manually to upstream!\nrhs 2: response nr. 6\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 7\nlhs: yield manually to upstream!\nrhs 2: response nr. 8\nlhs: return to upstream\nrhs 0: Will this happen for every value?\nrhs 1: response nr. 9\nlhs: yield manually to upstream!\nrhs 2: response nr. 10\nlhs: return to upstream\n</code></pre>\n"}], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 42754216, "answer_count": 1, "score": 3, "last_activity_date": 1489362617, "creation_date": 1489260343, "last_edit_date": 1489359513, "question_id": 42739584, "link": "https://stackoverflow.com/questions/42739584/pipes-unfolds-composition", "title": "Pipes unfolds composition", "body": "<p>I am currently in the process of learning pipes. While playing around with bidirectional pipes I noticed that unfold composition looks pretty similar:</p>\n\n<pre><code>(//&gt;) :: Monad m =&gt; Proxy x' x b' b m r -&gt; (b -&gt; Proxy x' x c' c m b') -&gt; Proxy x' x c' c m r\n-- instead of:\n(//&gt;) :: Monad m =&gt; Proxy x' x b' b m r -&gt; (b -&gt; Proxy b' b c' c m b') -&gt; Proxy x' x c' c m r\n</code></pre>\n\n<p>But we have to share the x' and x types because of the way we <a href=\"https://hackage.haskell.org/package/pipes-4.3.2/docs/src/Pipes-Core.html#%2F%2F%3E\" rel=\"nofollow noreferrer\">wire up</a> the continuation:</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; Proxy a' a b' b m r -&gt; (r -&gt; Proxy a' a b' b m r') -&gt; Proxy a' a b' b m r'\ncase p0 of\n    Request x' fx  -&gt; Request x' (\\x -&gt; go (fx x))\n    Respond b  fb' -&gt; fb b &gt;&gt;= \\b' -&gt; (fb' b')\n    ...\n</code></pre>\n\n<p>But that's pretty easy to get around:</p>\n\n<pre><code>import Pipes\nimport Pipes.Core hiding ((//&gt;))\n\nmain :: IO ()\nmain = runEffect $ lhs //&gt; rhs\n\ninfixl 4 //&gt;\n(//&gt;) :: Monad m =&gt; Proxy x' x b' b m r -&gt; (b -&gt; Proxy b' b c' c m b') -&gt; Proxy x' x c' c m r\np //&gt; f = p &gt;&gt;~ go\n    where go x = go =&lt;&lt; request =&lt;&lt; f x\n\nlhs :: Proxy x' x String String IO ()\nlhs = each [1..10::Int] //&gt; \\i -&gt; do\n    r &lt;- respond $ \"response nr. \" ++ show i\n    lift . putStrLn $ \"lhs: \" ++ show r\n\nrhs :: String -&gt; Proxy String String  x x' IO String\nrhs x = do\n    lift . putStrLn $ \"rhs 1: \" ++ show x\n    y &lt;- request \"yield manually to upstream!\"\n    lift . putStrLn $ \"rhs 2: \" ++ show y\n    return \"return to upstream\"\n</code></pre>\n\n<p>With the expected output:</p>\n\n<pre><code>rhs 1: \"response nr. 1\"\nlhs: \"yield manually to upstream!\"\nrhs 2: \"response nr. 2\"\nlhs: \"return to upstream\"\nrhs 1: \"response nr. 3\"\nlhs: \"yield manually to upstream!\"\nrhs 2: \"response nr. 4\"\nlhs: \"return to upstream\"\nrhs 1: \"response nr. 5\"\nlhs: \"yield manually to upstream!\"\nrhs 2: \"response nr. 6\"\nlhs: \"return to upstream\"\nrhs 1: \"response nr. 7\"\nlhs: \"yield manually to upstream!\"\nrhs 2: \"response nr. 8\"\nlhs: \"return to upstream\"\nrhs 1: \"response nr. 9\"\nlhs: \"yield manually to upstream!\"\nrhs 2: \"response nr. 10\"\nlhs: \"return to upstream\"\n</code></pre>\n\n<p>Best I can tell this doesn't break any laws either.</p>\n\n<p>So finally here is my question: Why does Pipes use the current definition?</p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489258185, "post_id": 42739092, "comment_id": 72596298, "body": "Please include the error message in your question as text (and not as an image)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489265854, "post_id": 42739092, "comment_id": 72598820, "body": "You are using the variable <code>toggleFadeSet</code> in a <code>where</code> block, but that variable does not take scope over that <code>where</code> block. In particular, <code>do {x &lt;- ..; ..} where .. = .. x ..</code> is not valid, because <code>x</code> is only in scope within the do block. The solution is to move the part of the <code>where</code> block mentioning <code>toggleFadeSet</code> into a <code>let</code> inside the <code>do</code> block; i.e. <code>do { x &lt; ..; let .. = .. x ..; .. }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 0, "last_activity_date": 1489266626, "creation_date": 1489266626, "answer_id": 42740680, "question_id": 42739092, "link": "https://stackoverflow.com/questions/42739092/how-to-override-xmonad-hooks-fadeinactive-for-some-tiles/42740680#42740680", "title": "How to override XMonad.Hooks.FadeInactive for some tiles?", "body": "<p>You are binding <code>toggleFadeSet</code> in the <code>main</code> do-block:</p>\n\n<pre><code>toggleFadeSet &lt;- newIORef S.empty\n</code></pre>\n\n<p><code>toggleFadeSet</code>, however, is only in scope in the body of the do-block, and not in the where block beneath it; so when you try to use it (in what I presume is the line 70 mentioned by the error message)...</p>\n\n<pre><code>myKeys = [ ((mod4Mask,                 xK_b           ), spawn \"qupzilla\")\n         -- etc.\n         , ((mod4Mask, xK_f), withFocused $ io . modifyIORef toggleFadeSet . toggleFadeOut)\n</code></pre>\n\n<p>... you get a \"variable not in scope\" error. To fix it, you can either move the definition of <code>myKeys</code> to a <code>let</code> within the do-block. Another option is leaving <code>myKeys</code> where it is, but turning it into a function, to which you pass the <code>IORef</code>:</p>\n\n<pre><code>main = do\n  xmproc &lt;- spawnPipe \"xmobar\"\n  toggleFadeSet &lt;- newIORef S.empty\n  xmonad $ defaultConfig\n    { terminal = \"xfce4-terminal\"\n    -- etc.\n    } `additionalKeys` myKeys toggleFadeSet\n  where\n      -- keybindings\n      myKeys toggleFadeSet = \n          [ ((mod4Mask,                 xK_b           ), spawn \"qupzilla\")\n          , ((mod4Mask,                 xK_r           ), spawn \"emacs\")\n          , ((mod4Mask,                 xK_u           ), scratchpad)\n          , ((mod4Mask,                 xK_y           ), focusUrgent)\n          , ((mod4Mask .|. controlMask, xK_space       ), myLayoutPrompt)\n          , ((mod4Mask, xK_f), withFocused $ io . modifyIORef toggleFadeSet . toggleFadeOut)\n          ]\n      -- etc.\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7695762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210178533238108/picture?type=large", "display_name": "N3phr_is", "link": "https://stackoverflow.com/users/7695762/n3phr-is"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 42740680, "answer_count": 1, "score": 0, "last_activity_date": 1489266859, "creation_date": 1489257454, "last_edit_date": 1489266859, "question_id": 42739092, "link": "https://stackoverflow.com/questions/42739092/how-to-override-xmonad-hooks-fadeinactive-for-some-tiles", "title": "How to override XMonad.Hooks.FadeInactive for some tiles?", "body": "<p>I'm trying to implement this code into my xmonad.hs, so i get selective fadeout for inactive tiles but dont know any haskell, so this has been all trial and error...</p>\n\n<pre><code>import XMonad\nimport XMonad.Hooks.FadeInactive\nimport Control.Monad (filterM,liftM, join)\nimport Data.IORef\nimport Data.List\nimport qualified Data.Set as S\nimport qualified XMonad.StackSet as W\nimport XMonad.Util.EZConfig(additionalKeys,removeKeys)\n\nmyFadeHook toggleFadeSet = fadeOutLogHook $ fadeIf (testCondition toggleFadeSet) 0.7\ndoNotFadeOutWindows = title =? \"Call with \" &lt;||&gt; className =? \"QupZilla\" &lt;||&gt; className =? \"qpdfview\"\n\ntestCondition :: IORef (S.Set Window) -&gt; Query Bool\ntestCondition floats =\n    liftM not doNotFadeOutWindows &lt;&amp;&amp;&gt; isUnfocused\n    &lt;&amp;&amp;&gt; (join . asks $ \\w -&gt; liftX . io $ S.notMember w `fmap` readIORef floats)\n\ntoggleFadeOut :: Window -&gt; S.Set Window -&gt; S.Set Window\ntoggleFadeOut w s | w `S.member` s = S.delete w s\n                  | otherwise = S.insert w s\n\n\nmain = do\n  toggleFadeSet &lt;- newIORef S.empty\n  xmonad $ defaultConfig\n  {\n  logHook = myFadeHook toggleFadeSet\n  , modMask = mod4Mask\n  } `additionalKeys`\n  [\n  ((mod4Mask, xK_f), withFocused $ io . modifyIORef toggleFadeSet . toggleFadeOut\n  ]\n</code></pre>\n\n<p>Which looks like this now:</p>\n\n<pre><code>import           XMonad                          hiding ((|||))\nimport           XMonad.Hooks.FadeInactive\nimport           XMonad.Hooks.DynamicLog\nimport           XMonad.Hooks.ManageDocks\nimport           XMonad.Hooks.UrgencyHook\nimport           XMonad.Layout.Accordion\nimport           XMonad.Layout.DecorationMadness\nimport           XMonad.Layout.Fullscreen\nimport           XMonad.Layout.Grid\nimport           XMonad.Layout.LayoutCombinators\nimport           XMonad.Layout.NoBorders\nimport           XMonad.Layout.PerWorkspace\nimport           XMonad.Layout.Renamed\nimport           XMonad.Layout.Tabbed\nimport           XMonad.Layout.Spacing\nimport           XMonad.Prompt\nimport           XMonad.Prompt.Input\nimport qualified XMonad.StackSet                 as W\nimport           XMonad.Util.EZConfig(additionalKeys,removeKeys)\nimport           XMonad.Util.Scratchpad\nimport           XMonad.Util.Run(spawnPipe)\nimport           System.IO\nimport           Control.Monad (filterM,liftM, join)\nimport           Data.IORef\nimport           Data.List\nimport qualified Data.Set as S\nimport qualified XMonad.StackSet as W\nimport           Data.Ratio                      ((%))\n\nmyFadeHook toggleFadeSet = fadeOutLogHook $ fadeIf (testCondition toggleFadeSet) 0.7\ndoNotFadeOutWindows = title =? \"Call with \" &lt;||&gt; className =? \"QupZilla\" &lt;||&gt; className =? \"qpdfview\"\n\ntestCondition :: IORef (S.Set Window) -&gt; Query Bool\ntestCondition floats =\n    liftM not doNotFadeOutWindows &lt;&amp;&amp;&gt; isUnfocused\n    &lt;&amp;&amp;&gt; (join . asks $ \\w -&gt; liftX . io $ S.notMember w `fmap` readIORef floats)\n\ntoggleFadeOut :: Window -&gt; S.Set Window -&gt; S.Set Window\ntoggleFadeOut w s | w `S.member` s = S.delete w s\n                  | otherwise = S.insert w s\n\nmain :: IO ()\n\nmain = do\n  xmproc &lt;- spawnPipe \"xmobar\"\n  toggleFadeSet &lt;- newIORef S.empty\n  xmonad $ defaultConfig\n    { terminal = \"xfce4-terminal\"\n    , modMask = mod4Mask\n    , borderWidth = 0\n    , focusedBorderColor = \"#56F48B\"\n    , layoutHook = myLayoutHook\n    , manageHook = manageHook defaultConfig &lt;+&gt; myManageHook\n    , handleEventHook = mconcat\n                  [ docksEventHook\n                  , handleEventHook defaultConfig ]\n    , logHook = myFadeHook toggleFadeSet\n          &lt;+&gt; dynamicLogWithPP xmobarPP\n                        { ppOutput = hPutStrLn xmproc\n                        , ppTitle = xmobarColor \"#56F48B\" \"\" . shorten 50\n                        }\n    } `additionalKeys` myKeys\n  where\n      -- keybindings\n      myKeys = [ ((mod4Mask,                 xK_b           ), spawn \"qupzilla\")\n               , ((mod4Mask,                 xK_r           ), spawn \"emacs\")\n               , ((mod4Mask,                 xK_u           ), scratchpad)\n               , ((mod4Mask,                 xK_y           ), focusUrgent)\n               , ((mod4Mask .|. controlMask, xK_space       ), myLayoutPrompt)\n               , ((mod4Mask, xK_f), withFocused $ io . modifyIORef toggleFadeSet . toggleFadeOut)\n               ]\n      scratchpad = scratchpadSpawnActionTerminal \"xfce4-terminal\"\n\n      -- layouts\n      myLayoutHook = avoidStrutsOn [U] $\n                     smartBorders $\n                     smartSpacingWithEdge 2 $\n                     tall ||| wide ||| full ||| circle ||| sTabbed ||| acc\n      tall   = renamed [Replace \"tall\"] $ Tall 1 0.03 0.5\n      wide   = renamed [Replace \"wide\"] $ Mirror tall\n      full   = renamed [Replace \"full\"] $ Full\n      circle = renamed [Replace \"circle\"] $ circleSimpleDefaultResizable\n      sTabbed = renamed [Replace \"tabbed\"] $ simpleTabbed\n      acc = renamed [Replace \"accordion\"] $ Accordion\n\n      -- layout prompt (w/ auto-completion and all layouts)\n      myLayoutPrompt = inputPromptWithCompl myXPConfig \"Layout\"\n                       (mkComplFunFromList' allLayouts)\n                       ?+ (sendMessage . JumpToLayout)\n      myXPConfig = defaultXPConfig { autoComplete = Just 1000 }\n      allLayouts = [\"tall\", \"wide\", \"circle\", \"full\", \"tabbed\", \"accordion\"]\n\n      -- manageHook\n      myManageHook =     manageDocks\n                     &lt;+&gt; floatHook\n                     &lt;+&gt; fullscreenManageHook\n                     &lt;+&gt; scratchpadManageHookDefault\n  -- Inspect with xprop: appName is the first element in WM_CLASS, while\n  -- className is the second.\n  floatHook = composeAll [ appName =? \"gimp-2.8\"    --&gt; doFloat\n                         , className =? \"qupzilla\" --&gt; doF (W.shift \"1\")\n                         ]\n</code></pre>\n\n<p>Now when i compile i just get this error, any idea how i can fix this is much appreciated :)</p>\n\n<pre><code>Error detected while loading xmonad configuration file: /home/n3p/.xmonad/xmonad.hs\n\nxmonad.hs:70:68: error:\n  * Variable not in scope: toggleFadeSet :: IORef (S.Set Window)\n  * Perhaps you meant 'toggleFadeOut' (line 39)\n\nPlease check the file for errors.\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1489249880, "post_id": 42737578, "comment_id": 72593298, "body": "Are you sure you&#39;ve posted the whole code? There&#39;s no line 12 in the piece you&#39;ve shown. Also, it compiles fine for me."}, {"owner": {"reputation": 1627, "user_id": 5964853, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/502f299d16be599d15334e99a5581705?s=128&d=identicon&r=PG&f=1", "display_name": "Srinivas", "link": "https://stackoverflow.com/users/5964853/srinivas"}, "reply_to_user": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1489250809, "post_id": 42737578, "comment_id": 72593653, "body": "Thanks for looking. This is the whole code. My standard practice is always write the file name as a comment in the first line. Maybe I might have missed a space or something. I will check."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489251202, "post_id": 42737578, "comment_id": 72593818, "body": "In the Markdown for this post (click <a href=\"https://stackoverflow.com/posts/42737578/edit\">edit</a>) there is a tab in the line with <code>then</code>. I suggest you duble-check whether it was there in your original file."}, {"owner": {"reputation": 1627, "user_id": 5964853, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/502f299d16be599d15334e99a5581705?s=128&d=identicon&r=PG&f=1", "display_name": "Srinivas", "link": "https://stackoverflow.com/users/5964853/srinivas"}, "edited": false, "score": 0, "creation_date": 1489251458, "post_id": 42737578, "comment_id": 72593925, "body": "Thanks for the catch. You were right. I removed the tab and it works fine. I find Notepad ++ irritating that it inserts tabs in the code. May I ask, what editors you use for Haskell programs?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489252175, "post_id": 42737578, "comment_id": 72594204, "body": "According to <a href=\"http://stackoverflow.com/q/8197812/2751851\">this Q&amp;A</a>, you can configure Notepad++ so that it doesn&#39;t insert tabs any more. (To answer your question: I have used Vim for a long while, though now I&#39;m leaning towards Emacs -- so that I can use <a href=\"https://commercialhaskell.github.io/intero/\" rel=\"nofollow noreferrer\">Intero</a> -- with Evil and evil-god-state -- so that it outwardly feels like Vim.)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489255130, "post_id": 42737578, "comment_id": 72595236, "body": "I think you will find anything from sublime, atom.io, vim, emacs being used in the community (ocasionally intellij + plugin, and eclipse, leksah), but most use either vim or emacs I think"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1489257662, "post_id": 42737578, "comment_id": 72596136, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces\" title=\"why shouldnt i mix tabs and spaces\">stackoverflow.com/questions/35855170/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2044, "user_id": 6733371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a4c02ed1ce17fd1f60579e73384d310?s=128&d=identicon&r=PG&f=1", "display_name": "qfwfq", "link": "https://stackoverflow.com/users/6733371/qfwfq"}, "is_accepted": true, "score": 0, "last_activity_date": 1489260506, "last_edit_date": 1495540925, "creation_date": 1489260506, "answer_id": 42739625, "question_id": 42737578, "link": "https://stackoverflow.com/questions/42737578/trouble-shooting-an-haskell-pgm/42739625#42739625", "title": "Trouble shooting an Haskell pgm", "body": "<p>The markdown shows that you have a tab in the <code>then</code> line instead of spaces, and spaces elsewhere. This will cause a parsing error in Haskell. <a href=\"https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces?noredirect=1&amp;lq=1\">This question</a> has more information on the topic.</p>\n"}], "owner": {"reputation": 1627, "user_id": 5964853, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/502f299d16be599d15334e99a5581705?s=128&d=identicon&r=PG&f=1", "display_name": "Srinivas", "link": "https://stackoverflow.com/users/5964853/srinivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1490769959, "accepted_answer_id": 42739625, "answer_count": 1, "score": -1, "last_activity_date": 1489260506, "creation_date": 1489249387, "question_id": 42737578, "link": "https://stackoverflow.com/questions/42737578/trouble-shooting-an-haskell-pgm", "closed_reason": "Not suitable for this site", "title": "Trouble shooting an Haskell pgm", "body": "<p>Can anyone please help me to trouble shoot this error</p>\n\n<pre><code>import System.Environment\nimport System.IO\nimport System.Directory\n\nmain = do\n         (fileName:_) &lt;- getArgs\n         fileExists &lt;- doesFileExists fileName\n         if fileExists \n             then do contents &lt;- readFile fileName\n                     putStrLn $ \"The file has \" ++ show (length (lines contents)) ++ \" lines.\"\n             else do putStrLn \"File does not exist\"\n</code></pre>\n\n<p>I get a </p>\n\n<pre><code>doesFileExistsException.hs:12:22: error:\nparse error on input `putStrLn'\n</code></pre>\n\n<p>error message. I made sure that there are no tabs in the file. Please let me know what is causing this error.</p>\n\n<p>THanks</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1489247636, "post_id": 42737198, "comment_id": 72592494, "body": "Your function is <code>\\f g -&gt; (id &amp;&amp;&amp; g) . f</code> -- functions have an <code>Arrow</code> instance, so if you are only dealing with plain functions you don&#39;t need <code>arr</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1489257772, "post_id": 42737198, "comment_id": 72596169, "body": "Or <code>\\f g -&gt; ((,) &lt;*&gt; g) . f</code>. Which can be spelled as <code>flip $ (.) . ap (,)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489256791, "post_id": 42738421, "comment_id": 72595830, "body": "Some more regolfing: (1) <code>composePreservingOutputs</code> can also be written as <code>\\f g -&gt; fmap f . ((,) &lt;*&gt; id) . g</code>, taking advantage of the fact that the  <code>Monad</code> and <code>Applicative</code> instances for functions do essentially the same thing. (2) Having the <code>Applicative</code> expression swallow the <code>fmap</code> on the tuple leads to <code>((,) &lt;*&gt; f) . g</code> (that also can be done with the <code>(&gt;&gt;=)</code> version, but an extra <code>flip</code> is necessary). (3) Adding a redundant <code>(&lt;$&gt; id)</code> leads to <code>((,) &lt;$&gt; id &lt;*&gt; f) . g</code> (a.k.a. <code>liftA2 (,) id f . g</code>), which makes the fact that this is another way to spell <code>(id &amp;&amp;&amp; f) . g</code> more evident."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489257505, "post_id": 42738421, "comment_id": 72596093, "body": "Nice. I started playing around with an applicative approach, but gave up to avoid burning my entire day on this one problem :)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1489253810, "creation_date": 1489253810, "answer_id": 42738421, "question_id": 42737198, "link": "https://stackoverflow.com/questions/42737198/is-there-a-known-composition-function-for-the-type-signature-a-b-b-c/42738421#42738421", "title": "Is there a known composition function for the type signature (a -&gt; b) -&gt; (b -&gt; c) -&gt; (a -&gt; (b, c))?", "body": "<p>With no additional imports, you can use</p>\n\n<pre><code>doubleThenIncrement = fmap increment . (id &gt;&gt;= (,)) . double\n</code></pre>\n\n<p>This function first doubles its argument, then uses the <code>Monad</code> instance of functions to use return value of <code>double</code> as <em>both</em> arguments for the <code>(,)</code> function, then applies <code>increment</code> to the <em>second</em> of the elements in the resulting tuple.</p>\n\n<p>With one import, you can simplify the middle part a little:</p>\n\n<pre><code>import Control.Monad\ndoubleThenIncrement = fmap increment . join (,) . double\n</code></pre>\n\n<p>(For functions, the implementation of <code>join</code> is effectively <code>join f = \\x -&gt; f x x</code>. We call <code>(,)</code> using the result of <code>double</code> for both arguments. <code>join (,) . double</code> is <code>\\x -&gt; (,) (double x) (double x)</code> is <code>(double x, double x)</code>.)</p>\n\n<p>You can define a function that takes <code>increment</code> and <code>double</code> as arguments to return <code>doubleThenIncrement</code>:</p>\n\n<pre><code>&gt; let composePreservingOutputs f g = fmap f . join (,) . g\n&gt; composePreservingOutputs increment double $ 2\n(4,5)\n</code></pre>\n\n<hr>\n\n<p>In all its horrific point-free glory, it would be</p>\n\n<pre><code>-- Courtesy of pointfree.io\ncomposePreservingOutputs = (. (join (,) .)) . (.) . fmap\n</code></pre>\n\n<hr>\n\n<p>(Or, you could just write</p>\n\n<pre><code>composePreservingOutputs f g x = (f x, g (f x))\n</code></pre>\n\n<p>but where's the fun in that?)</p>\n"}, {"tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": false, "score": 1, "last_activity_date": 1489255624, "last_edit_date": 1489255624, "creation_date": 1489254528, "answer_id": 42738549, "question_id": 42737198, "link": "https://stackoverflow.com/questions/42737198/is-there-a-known-composition-function-for-the-type-signature-a-b-b-c/42738549#42738549", "title": "Is there a known composition function for the type signature (a -&gt; b) -&gt; (b -&gt; c) -&gt; (a -&gt; (b, c))?", "body": "<p>It's tricky to come up with general solution for what you want in Haskell because the intermediate values need to be of the same type.</p>\n\n<p>The pattern of logging out intermediate values is something that the <code>Writer</code> monad is suited to. The restriction here is that the \"written\" values must implement the <code>Monoid</code> typeclass. I suspect this is OK in your case if you are just using this for debugging, i.e. you can convert the values to <code>String</code>, which is a <code>Monoid</code>.</p>\n\n<p>I would define a function <code>writeParam f x = (show x, f x)</code> if you like arrows) which you can wrap all your functions in. Functions which return tuples <code>Monoid a =&gt; ((,) a)</code> are actually a simple implementation of the writer monad, so you can then compose these functions with regular monad composition like so:</p>\n\n<pre><code>doubleThenIncrement :: (Num n, Show n) =&gt; n -&gt; (String, n)\ndoubleThenIncrement = writeParam double &gt;=&gt; writeParam increment\n</code></pre>\n\n<p>By the way, if you like arrows, you could also define <code>writeParam</code> as <code>writeParam = (show &amp;&amp;&amp;)</code> or even just <code>writeParam = (id &amp;&amp;&amp;)</code> if you want to be more generic. Although IMO this is less clear.</p>\n"}], "owner": {"reputation": 11, "user_id": 5801727, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RlSWCorHI_s/AAAAAAAAAAI/AAAAAAAAAKo/qbcMURYToec/photo.jpg?sz=128", "display_name": "Fernando V&#237;a Canel", "link": "https://stackoverflow.com/users/5801727/fernando-v%c3%ada-canel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489255624, "creation_date": 1489247311, "question_id": 42737198, "link": "https://stackoverflow.com/questions/42737198/is-there-a-known-composition-function-for-the-type-signature-a-b-b-c", "title": "Is there a known composition function for the type signature (a -&gt; b) -&gt; (b -&gt; c) -&gt; (a -&gt; (b, c))?", "body": "<p>I've been working for a while in an algorithm that requires composing it's function parts so that the return value of the composition contains the output of both functions. For example (in JavaScript):</p>\n\n<pre><code>const double = x =&gt; x * 2\nconst increment = x =&gt; x + 1\n\nconst doubleThenIncrement = composeConservingOutputs(increment, double)\n\ndoubleThenIncrement(2) // =&gt; [4, 5]\n</code></pre>\n\n<p>I've been wondering if this is a known composition pattern. In <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Arrow.html\" rel=\"nofollow noreferrer\">Haskell</a>, this seems to be achievable in a clean way piping the output of one arrow to the fanout of the other arrow and id:</p>\n\n<pre><code>import Control.Arrow \n\ndouble = (*) 2\nincrement = (+) 1\n\ndoubleThenIncrement = arr double &gt;&gt;&gt; (arr id &amp;&amp;&amp; arr increment)\n</code></pre>\n\n<p>but I couldn't find if this composition is a common/known pattern or not. </p>\n\n<p>I find this useful because it allows to very easily inspect the output of the intermediate functions for debugging, which made me think this is probably a thing already.</p>\n\n<p>A <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a%20-%3E%20b%29%20-%3E%20%28b%20-%3E%20c%29%20-%3E%20%28a%20-%3E%20%28b%2C%20c%29%29\" rel=\"nofollow noreferrer\">Hoogle search for the pattern (a -> b) -> (b -> c) -> (a -> (b, c))</a> proves unfruitful.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "equality", "enumerable"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489244485, "post_id": 42736553, "comment_id": 72591373, "body": "I guess all the standard instances of <code>Enum</code> are also instances of <code>Eq</code> -- I can&#39;t think why that should not be the case."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489244509, "post_id": 42736553, "comment_id": 72591384, "body": "I don&#39;t quite understand your question - do you want an example where it would be useful?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489244700, "post_id": 42736553, "comment_id": 72591447, "body": "I once created a data-type for terminal-colors and used the from/toEnum functions to create the terminal escape code, since Eq was not needed anywhere I didn&#39;t derive it. If for some reasons you don&#39;t want equality in production code you can put orphan instances in your testing code - where you most definitely need Eq"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489244837, "post_id": 42736553, "comment_id": 72591485, "body": "@epsilonhalbe But you could have, and it would have made an awful lot of sense"}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1489245470, "post_id": 42736553, "comment_id": 72591702, "body": "I guess, there is no such use case. Even <code>Data.Void</code> has an Eq instance."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1489260057, "creation_date": 1489260057, "answer_id": 42739519, "question_id": 42736553, "link": "https://stackoverflow.com/questions/42736553/enum-types-that-are-not-equality-comparable/42739519#42739519", "title": "Enum types that are not equality comparable", "body": "<p>Only <code>Enum</code> would not be enough to provide equality tests, since <code>Int</code> is bounded. Let's say we had the following function, which you probably had in mind.</p>\n\n<pre><code>eqEnum :: Enum a =&gt; a -&gt; a -&gt; Bool\neqEnum x y = fromEnum x == fromEnum y\n</code></pre>\n\n<p>Now we can generate two <code>Integer</code> that don't coincide:</p>\n\n<pre><code>ghci&gt; eqEnum 0 (2 + 2 * toEnum (maxBound :: Int))\nTrue\n</code></pre>\n\n<p>We can also check <code>Double</code>:</p>\n\n<pre><code>ghci&gt; eqEnum 3.0 pi\nTrue\n</code></pre>\n\n<p>Well, whoops. <code>Enum</code> doesn't give rise to a correct <code>Eq</code> instance. We can even go a little bit further and create an instance of <code>Enum</code> for a type that cannot have an <code>Eq</code> instance:</p>\n\n<pre><code>newtype Foo = Foo { unFoo :: Integer -&gt; Integer }\n\ninstance Enum Foo where\n  fromEnum (Foo f) = fromEnum $ f 0\n  toEnum   n       = Foo (+ toInteger n)\n  succ             = Foo . succ . unFoo -- not necessary\n  pred             = Foo . pred . unFoo -- not necessary\n</code></pre>\n\n<p>We can use that bogus instance to enumerate the family of functions <code>F_n(x) = x + n</code>:</p>\n\n<pre><code>&gt; map ((\\f -&gt; unFoo f 0) . toEnum) [0..100]\n[0,1,2,...,100]\n</code></pre>\n\n<p>However, whether two <code>Foo</code> functions are the same cannot be decided. And, as it is with <code>Double</code>, there are many <code>Foo</code> values that aren't actually recoverable with <code>toEnum . fromEnum</code>:</p>\n\n<pre><code>ghci&gt; toEnum . fromEnum $ pi :: Double\n3.0\nghci&gt; let f = toEnum . fromEnum $ Foo (const 0) :: Foo\nghci&gt; unFoo f 0\n0 \nghci&gt; unFoo f 1 -- not constant anymore\n1\n</code></pre>\n\n<p>The basic problem is that <code>Enum</code> has no laws. You need to convert from and to <code>Int</code>. But in the end, that's not very surprising, giving that they were <a href=\"https://www.cs.auckland.ac.nz/references/haskell/haskell-intro-html/stdclasses.html\" rel=\"nofollow noreferrer\">originally meant for <code>[x..y]</code></a> (aka <code>enumFromTo x y</code>).</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489260057, "creation_date": 1489243670, "question_id": 42736553, "link": "https://stackoverflow.com/questions/42736553/enum-types-that-are-not-equality-comparable", "title": "Enum types that are not equality comparable", "body": "<p>Enum represents types that can be mapped to or from integers. </p>\n\n<p>Integers can be tested for equality. </p>\n\n<p>Is there an instance of Enum which doesn't want Eq?</p>\n"}, {"tags": ["haskell", "logging", "apache-chainsaw"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1489238263, "post_id": 42735454, "comment_id": 72589403, "body": "It&#39;s not really clear what your question is."}, {"owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1489252393, "post_id": 42735454, "comment_id": 72594295, "body": "@ChrisStryczynski I updated to make it more clear."}], "owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489252351, "creation_date": 1489236865, "last_edit_date": 1489252351, "question_id": 42735454, "link": "https://stackoverflow.com/questions/42735454/haskell-log-viewer", "title": "Haskell log viewer", "body": "<p>I implemented logging in my program using <a href=\"https://hackage.haskell.org/package/hslogger-1.2.10/docs/System-Log-Handler-Log4jXML.html\" rel=\"nofollow noreferrer\">HSLogger</a>.\nI use <a href=\"http://logging.apache.org/chainsaw/\" rel=\"nofollow noreferrer\">Chainsaw</a> to view the logs.\nA first concern is that the logs are not updated in real time when I use the option \"Open remote log4J File\".</p>\n\n<p>Other concerns is that HSLogger supports only Log4J, which seems deprecated now.\nChainsaw official version dates back to 2007.</p>\n\n<p>All in all, what is the current story for logging and viewing logs in Haskell?</p>\n"}, {"tags": ["python", "haskell", "sublimetext3", "read-eval-print-loop"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489239110, "post_id": 42735282, "comment_id": 72589648, "body": "do you know of ghc-mod - it should already provide some form of autocompletion, also there is ndmitchell&#39;s ghcid project, which you should look up. for sublime i found <a href=\"https://github.com/SublimeHaskell/SublimeHaskell\" rel=\"nofollow noreferrer\">github.com/SublimeHaskell/SublimeHaskell</a> that already provides auto-completion"}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489245372, "post_id": 42735282, "comment_id": 72591668, "body": "I plan to use intero for that, but this is just my little side project + SublimeHaskell is not very good in my opinion. @epsilonhalbe"}], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489235756, "creation_date": 1489235756, "question_id": 42735282, "link": "https://stackoverflow.com/questions/42735282/how-to-run-external-console-app-from-python-and-communicate-with-it-in-the-backg", "title": "How to run external console app from python and communicate with it in the background", "body": "<p>I'm trying to develop simple SublimeText plugin for Haskell auto completion and type information.</p>\n\n<p>The way I'd like to achieve that is by using haskells repl and communicating with it through stdin / out, but I'd like to keep repl running in the background (don't want console window visible during development).</p>\n\n<p>So.. the question is essentially <strong>how can I run repl as background process and pass some text to it and read its response?</strong></p>\n"}, {"tags": ["haskell", "casting"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 6, "creation_date": 1489208070, "post_id": 42731472, "comment_id": 72582028, "body": "You may compute a new value from an existing one.  If you wish to compute the floor or ceiling of a float to acquire an integral then call <code>floor</code> or <code>ceiling</code>."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 2, "creation_date": 1489217701, "post_id": 42731472, "comment_id": 72583949, "body": "There are very different concepts hiding behind the words &quot;type casting&quot; in Java. What you want to do is rather to convert a numeric value."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1489222775, "post_id": 42731472, "comment_id": 72585084, "body": "You can <a href=\"https://www.haskell.org/hoogle/?hoogle=%28Floating+a%2C+Integral+b%29+%3D%3E+a+-%3E+b\" rel=\"nofollow noreferrer\">search using Hoogle</a> which results in <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:ceiling\" rel=\"nofollow noreferrer\"><code>ceiling</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:floor\" rel=\"nofollow noreferrer\"><code>floor</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:round\" rel=\"nofollow noreferrer\"><code>round</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:truncate\" rel=\"nofollow noreferrer\"><code>truncate</code></a>... all part of the Prelude."}], "answers": [{"comments": [{"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489245640, "post_id": 42733352, "comment_id": 72591759, "body": "@chi, <code>ceiling</code>, <code>floor</code>, <code>truncate</code> and <code>fromIntegral</code> are mentioned in the answer, so not quite sure why you brought them up. As to <code>GHC.*</code> modules, I&#39;d agree with you, those should be used as a last resort. Reason why I mentioned those, because, at first, I mistakenly read that <code>Float</code> to <code>Double</code> conversion was desired, and the only function that I am aware of which is capable of doing that is <code>float2Double</code> from <code>GHC.Float</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489251458, "post_id": 42733352, "comment_id": 72593926, "body": "Oops. I probably read this too quickly. You are right. The only alternative to <code>float2Double</code> I know is <code>fromRational . toRational</code>, but it&#39;s a bit ugly, and it relies on GHC to optimize this to avoid the intermediate rational representation."}], "tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 2, "last_activity_date": 1489229188, "last_edit_date": 1489229188, "creation_date": 1489223115, "answer_id": 42733352, "question_id": 42731472, "link": "https://stackoverflow.com/questions/42731472/how-does-type-casting-work-in-haskell/42733352#42733352", "title": "How does type casting work in Haskell?", "body": "<p>Converting floating point numbers with ghc is possible with:</p>\n\n<pre><code>\u03bb&gt; :m GHC.Float\n\u03bb&gt; :t float2Double\nfloat2Double :: Float -&gt; Double\n\u03bb&gt; :t double2Float\ndouble2Float :: Double -&gt; Float\n\u03bb&gt; :t double2Int\ndouble2Int :: Double -&gt; Int\n\u03bb&gt; :t float2Int\nfloat2Int :: Float -&gt; Int\n\u03bb&gt; :t int2Double\nint2Double :: Int -&gt; Double\n\u03bb&gt; :t int2Float\nint2Float :: Int -&gt; Float\n</code></pre>\n\n<p>But for floating point numbers to ints I'd recommend using <code>ceiling</code>, <code>round</code> and <code>floor</code>, and <code>fromIntegral</code> for backwads conversion.</p>\n\n<p><strong>Edit</strong>: after reading the question more carefully, @Chris Martin's answer is the correct one:</p>\n\n<pre><code>\u03bb&gt; :t truncate\ntruncate :: (Integral b, RealFrac a) =&gt; a -&gt; b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 7, "last_activity_date": 1489226000, "last_edit_date": 1489226000, "creation_date": 1489225669, "answer_id": 42733711, "question_id": 42731472, "link": "https://stackoverflow.com/questions/42731472/how-does-type-casting-work-in-haskell/42733711#42733711", "title": "How does type casting work in Haskell?", "body": "<blockquote>\n  <p>I want to be able to be able to truncate <code>float</code> or <code>double</code></p>\n</blockquote>\n\n<p>Delightfully, the function that truncates fractionals to integrals is named \"truncate\".</p>\n\n<p><a href=\"https://www.stackage.org/haddock/lts-8.4/base-4.9.1.0/Prelude.html#v:truncate\" rel=\"noreferrer\">https://www.stackage.org/haddock/lts-8.4/base-4.9.1.0/Prelude.html#v:truncate</a></p>\n\n<pre><code>\u03bb&gt; truncate 5.583\n5\n</code></pre>\n\n<p>Its type is</p>\n\n<pre><code>truncate :: (Real a, Fractional a, Integral b) =&gt; a -&gt; b\n</code></pre>\n\n<p>This is just an ordinary function. Haskell does not have any language feature (or kludge, if you will) akin to type casting in Java.</p>\n"}], "owner": {"reputation": 155, "user_id": 7659347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vhPYA.png?s=128&g=1", "display_name": "Eben Cowley", "link": "https://stackoverflow.com/users/7659347/eben-cowley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 42733711, "answer_count": 2, "score": 4, "last_activity_date": 1489229188, "creation_date": 1489207847, "last_edit_date": 1489226144, "question_id": 42731472, "link": "https://stackoverflow.com/questions/42731472/how-does-type-casting-work-in-haskell", "title": "How does type casting work in Haskell?", "body": "<p>I want to be able to be able to truncate a <code>float</code> or <code>double</code> in a similar way you would in Java: <code>(int)5.583</code>, for example.</p>\n\n<p>I've done some research and, to my knowledge, there's nothing imported in Prelude for this. So I'm wondering how I would construct a function that does it. I thought maybe if I did <code>show 5.583</code> and then took a substring up to the decimal point and then converted that to an <code>Int</code>, but that seems like it would be terribly inefficient when using only recursion. So is there a more simple way to go about it?</p>\n"}, {"tags": ["parsing", "haskell", "conduit", "attoparsec"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1489226057, "post_id": 42731065, "comment_id": 72585843, "body": "What do you <i>do</i> with the data after you parsed it? Hold the entire thing in memory, or...? Have you profiled the code to see whether it&#39;s actually the parser that&#39;s holding on to the memory?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1489238452, "post_id": 42731065, "comment_id": 72589461, "body": "To amplify on what @MathematicalOrchid says, its possible that the caller of the parser is the one doing the retaining. If you sum a lazy list of N integers GHC will do in constant memory, but if you sum it and then divide by the length then GHC will retain the entire list so it can compute the length after its finished doing the sum. Maybe you are doing something similar."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1489238499, "post_id": 42731065, "comment_id": 72589478, "body": "I had a space leak with Conduit. Maybe something similar is going on. See <a href=\"http://stackoverflow.com/questions/24786039/why-does-this-cause-a-memory-leak-in-the-haskell-conduit-library\" title=\"why does this cause a memory leak in the haskell conduit library\">stackoverflow.com/questions/24786039/&hellip;</a> for details."}, {"owner": {"reputation": 1655, "user_id": 604955, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dee8e0c8c4b36334c2379c62b3e12054?s=128&d=identicon&r=PG", "display_name": "Charles Durham", "link": "https://stackoverflow.com/users/604955/charles-durham"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1489262932, "post_id": 42731065, "comment_id": 72597812, "body": "@MathematicalOrchid For test purposes I just pull it into IO and print the length of the vector. What I actually need to do is to convert this into normalized maps and intmaps to do lookups on the next file. I&#39;ve actually never profiled code in Haskell, I just found some resources in some comments on related questions suggested by stackoverflow."}, {"owner": {"reputation": 1655, "user_id": 604955, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dee8e0c8c4b36334c2379c62b3e12054?s=128&d=identicon&r=PG", "display_name": "Charles Durham", "link": "https://stackoverflow.com/users/604955/charles-durham"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1489263391, "post_id": 42731065, "comment_id": 72597974, "body": "@PaulJohnson Interesting, found this post <a href=\"http://www.well-typed.com/blog/2016/09/sharing-conduit/\" rel=\"nofollow noreferrer\">well-typed.com/blog/2016/09/sharing-conduit</a> on the bottom of the answers, still don&#39;t understand the problem well enough to know if it applies to me"}], "owner": {"reputation": 1655, "user_id": 604955, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dee8e0c8c4b36334c2379c62b3e12054?s=128&d=identicon&r=PG", "display_name": "Charles Durham", "link": "https://stackoverflow.com/users/604955/charles-durham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489203617, "creation_date": 1489203617, "question_id": 42731065, "link": "https://stackoverflow.com/questions/42731065/lazy-parsing-of-large-files-with-millions-of-data-points", "title": "Lazy parsing of large files with millions of data points", "body": "<p>I have a parser I'm trying to write and I've gone over multiple versions of it and I can't seem to keep the memory usage down. I'm trying to parse the wikipedia sql dumps and in this example take the page entries file and throw them all in one giant vector (13 million pages). I got this working before, but I sharded the file into smaller pieces and aggregated them from the filesystem. Anyway, below is my attempt to parse these files in one pass. I'm pulling out the lines <code>\"INSERT INTO ... (data),(data)..(data);\"</code>. I'm letting the other lines just fail in the parser and not yield values. The insert lines   average 1MB in size and 8k entries.</p>\n\n<p>I've tried what feels like a thousand versions of this with deepseqs and outputting lists of page entries per line instead of the vector I have now and using lineC with a partial parser instead of the linesUnboundedC. I assume there must be some high level concept I'm missing that is keeping the memory usage exponential. The file is 5GB and I'm easily blowing through 16GB of memory, but I can't seem to nail down a lazy thunk memory leak anywhere. I would assume that this code would be able to store each line independently and then move on without the extra memory to the next line, but I can't figure out what is wrong. I had no issue counting the amount of entries or using a more complex monoid to get data from the file using the same parser. </p>\n\n<p>Any help is much appreciated!</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Parser.Helper where\n\nimport Conduit\n\nimport Control.DeepSeq\nimport Control.Monad (void)\nimport Control.Monad.Primitive\n\nimport Data.Attoparsec.Text\nimport Data.Maybe (catMaybes)\nimport Data.Text (Text)\nimport qualified Data.Vector as V\nimport Data.Vector.Generic (Vector)\n\nimport System.IO (openFile,IOMode(..))\n\ndata Page = Page !Int !Text !Bool\n  deriving Show\n\ninstance NFData Page where\n  rnf (Page pid title isRedirect) = pid `seq` title `seq` isRedirect `seq` ()\n\nparseFile\n  :: (Foldable t, Vector v e)\n  =&gt; FilePath -&gt; Parser (t e) -&gt; IO [v e]\nparseFile fp parser =\n  do\n    handle &lt;- openFile fp ReadMode\n    runConduit $ sourceHandle handle\n      .| decodeUtf8LenientC\n      .| peekForeverE linesUnboundedC\n      .| vectors parser\n      .| sinkList\n\nvectors\n  :: (Foldable t, Vector v e, MonadBase base m, Control.Monad.Primitive.PrimMonad base)\n  =&gt; Parser (t e) -&gt; ConduitM Text (v e) m ()\nvectors parser =\n  do\n    vectorBuilderC (1024*1024)\n      (\\f -&gt;\n         peekForeverE $ do\n           ml &lt;- await\n           case ml of\n             Nothing -&gt; return ()\n             Just l -&gt;\n               case parseOnly parser l of\n                 Left _ -&gt; return ()\n                 Right v -&gt; mapM_ f v\n      )\n\nparsePageLine :: Parser (V.Vector Page)\nparsePageLine =\n  do\n    string \"INSERT INTO\" *&gt; skipWhile (/= '(')\n    V.fromList . catMaybes &lt;$&gt; sepBy' parsePageField (char ',') &lt;* char ';'\n\nparsePageField :: Parser (Maybe Page)\nparsePageField =\n  do\n    void $ char '('\n    pid &lt;- parseInt &lt;* char ','\n    namespace &lt;- parseInt &lt;* char ','\n    title &lt;- parseTextField &lt;* char ','\n    _ &lt;- skipField &lt;* char ','\n    _ &lt;- skipField &lt;* char ','\n    redirect &lt;- parseInt &lt;* char ','\n    void $ sepBy' skipField (char ',')\n    void $ char ')'\n    let ret = case namespace == 0 of\n          True -&gt; Just $ Page pid title (redirect == 1)\n          False -&gt; Nothing\n    return $ force ret\n\nparseTextField :: Parser Text\nparseTextField = char '\\'' *&gt; scan False f &lt;* char '\\''\n  where\n    f :: Bool -&gt; Char -&gt; Maybe Bool\n    f False '\\'' = Nothing\n    f False '\\\\' = Just True\n    f _ _ = Just False\n\nskipField :: Parser ()\nskipField = void $ scan False f\n  where\n    f :: Bool-&gt; Char -&gt; Maybe Bool\n    f False '\\\\' = Just True\n    f False ',' = Nothing\n    f False ')' = Nothing\n    f _ _ = Just False\n\nparseInt :: Parser Int\nparseInt = signed $ decimal\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1489193730, "post_id": 42730052, "comment_id": 72579569, "body": "Hint: <code>Empty</code> and <code>Full</code> are values, not functions you need to call (like in OOP)."}, {"owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1489193963, "post_id": 42730052, "comment_id": 72579638, "body": "Ok, then how to randomly get one of the values?"}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1489194259, "post_id": 42730052, "comment_id": 72579694, "body": "Use the <a href=\"http://hackage.haskell.org/package/random\" rel=\"nofollow noreferrer\"><code>random</code></a> package or alternatives. Excuse me for being so short on words, I&#39;d provide a bit more help but I have shortage of time."}, {"owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1489194880, "post_id": 42730052, "comment_id": 72579822, "body": "I am a Haskell beginner and <code>System.Random</code> has frustrated me with its <code>IO a</code> typing stuff - was hoping there was a built-in way."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1489195082, "post_id": 42730052, "comment_id": 72579864, "body": "Unfortunately there isn&#39;t a built-in way but <code>random</code> <i>is</i> idiomatic. <code>IO a</code> is important for Haskell&#39;s purity. Perhaps you can look up <i>why</i> we want a functionally pure language and you could learn to love it as the vast majority of Haskellers do (this is a big reason why a lot of us are even here, it&#39;s really a good thing)."}, {"owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1489195368, "post_id": 42730052, "comment_id": 72579917, "body": "I&#39;m on board with the Haskell train, I just don&#39;t understand how to get the behavior I need out of an <code>IO Int</code> for example. Fully aware this is a problem of my own understanding atm."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "edited": false, "score": 0, "creation_date": 1489195508, "post_id": 42730052, "comment_id": 72579945, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/137804/discussion-between-mastermastic-and-zzu\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1489207527, "creation_date": 1489207527, "answer_id": 42731441, "question_id": 42730052, "link": "https://stackoverflow.com/questions/42730052/haskell-get-one-of-alternative-type/42731441#42731441", "title": "Haskell: Get one of alternative type", "body": "<p>Just get a random bit and set the value to <code>Full</code> or <code>Empty</code> based on that bit. For example:</p>\n\n<pre><code>import System.Random\n</code></pre>\n\n<p>You seem to be talking about <code>System.Random</code>, but this sort of information should be included in the question.</p>\n\n<pre><code>data Cell = Full | Empty\n          deriving (Eq,Ord,Show,Enum)\n</code></pre>\n\n<p>I derived <code>Enum</code> for use with ranged randoms. Now we are going to define an instance for the <code>Random</code> class so you can use a couple of the common libraries to generate random values of type <code>Cell</code>.  The <code>Random</code> class requires we at least define <code>random</code> and <code>randomR</code> methods.</p>\n\n<pre><code>instance Random Cell where\n  random g = let (a,g') = random g\n                 val = if a then Full else Empty\n             in (val,g')\n  randomR (l,h) g = let (a,g') = randomR (fromEnum l, fromEnum h) g\n                    in (toEnum a, g')\n</code></pre>\n\n<p>Since your type is identical to <code>Bool</code> we can just generate a random bool (a bit) and select one of your two constructors.  The ranged randoms are a little more of a nuisance but we just generate an Int somewhere between the lower bound and upper bounds requested then acquire the constructor matching that Int value.</p>\n"}], "owner": {"reputation": 246, "user_id": 5831363, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3X8lG.jpg?s=128&g=1", "display_name": "zzu", "link": "https://stackoverflow.com/users/5831363/zzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489207527, "creation_date": 1489193368, "question_id": 42730052, "link": "https://stackoverflow.com/questions/42730052/haskell-get-one-of-alternative-type", "title": "Haskell: Get one of alternative type", "body": "<p>Say I have a type such as:</p>\n\n<pre><code>data Cell = Empty | Full\n</code></pre>\n\n<p>Does Haskell provide a simple way to nondeterministically call one or the other of these constructors? Basically I am trying to randomize which constructor gets called, e.g. <code>[CellOfSomeType | i &lt;- [1..somerange]]</code></p>\n"}, {"tags": ["list", "haskell", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 6860348, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ed7e687b609c4ab8f9b25a490d2ec67?s=128&d=identicon&r=PG&f=1", "display_name": "boss revs", "link": "https://stackoverflow.com/users/6860348/boss-revs"}, "edited": false, "score": 1, "creation_date": 1489189561, "post_id": 42729545, "comment_id": 72578605, "body": "The variables types have to be the same in an if-else statement? This language is so trippy"}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 241, "user_id": 6860348, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ed7e687b609c4ab8f9b25a490d2ec67?s=128&d=identicon&r=PG&f=1", "display_name": "boss revs", "link": "https://stackoverflow.com/users/6860348/boss-revs"}, "edited": false, "score": 1, "creation_date": 1489189959, "post_id": 42729545, "comment_id": 72578735, "body": "@bossrevs if-else is an expression that evaluates to a value. Many programming languages have the same semantics. Haskell might be &#39;strange&#39; in various ways, but this isn&#39;t one of them"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 241, "user_id": 6860348, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ed7e687b609c4ab8f9b25a490d2ec67?s=128&d=identicon&r=PG&f=1", "display_name": "boss revs", "link": "https://stackoverflow.com/users/6860348/boss-revs"}, "edited": false, "score": 1, "creation_date": 1489189988, "post_id": 42729545, "comment_id": 72578745, "body": "@bossrevs Sure. What should be the type of an expression like <code>if foo then True else LT</code> where the <code>then</code> and <code>else</code> clauses don&#39;t match? It&#39;s not limited to Haskell, either; it&#39;s just that in most other languages <code>if</code>/<code>then</code>/<code>else</code> is a statement, not an expression, and you can think of &quot;statement&quot; as its own type (and there is a default statement that does nothing inserted as an <code>else</code> branch if you don&#39;t specify one)."}, {"owner": {"reputation": 241, "user_id": 6860348, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ed7e687b609c4ab8f9b25a490d2ec67?s=128&d=identicon&r=PG&f=1", "display_name": "boss revs", "link": "https://stackoverflow.com/users/6860348/boss-revs"}, "edited": false, "score": 0, "creation_date": 1489190122, "post_id": 42729545, "comment_id": 72578779, "body": "Oh ofcourse, the function has only 1 return type. Opps. Thanks for your help"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 241, "user_id": 6860348, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ed7e687b609c4ab8f9b25a490d2ec67?s=128&d=identicon&r=PG&f=1", "display_name": "boss revs", "link": "https://stackoverflow.com/users/6860348/boss-revs"}, "edited": false, "score": 0, "creation_date": 1489245279, "post_id": 42729545, "comment_id": 72591629, "body": "@bossrevs Note that Haskell&#39;s if-then-else is similar to C/Java/... ternary operators <code>b ? x : y</code> , which require <code>x,y</code> to share the same type, like Haskell. So Haskell is actually not different from all the other languages in this aspect."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1489189359, "creation_date": 1489189359, "answer_id": 42729545, "question_id": 42729515, "link": "https://stackoverflow.com/questions/42729515/haskell-if-statement-is-not-working-properly/42729545#42729545", "title": "Haskell if statement is not working properly", "body": "<p>The types of the two expressions in the <code>then</code> and <code>else</code> clause must match. Since one side of the branch returns a list element, and the other side returns a string, ghci concludes that the list elements must be strings. But you specified <code>[2,3,4]</code>, whose elements are numbers. Hence the complaint: it doesn't know how to turn a number into a <code>String</code>.</p>\n\n<p>Consider returning a <code>Maybe</code> or <code>Either</code> value instead:</p>\n\n<pre><code>list numbers = if length numbers &gt; 3\n    then Right (numbers!!(length numbers - 3))\n    else Left \"length must be greater than 2\" -- sic: 3, not 2\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 6860348, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ed7e687b609c4ab8f9b25a490d2ec67?s=128&d=identicon&r=PG&f=1", "display_name": "boss revs", "link": "https://stackoverflow.com/users/6860348/boss-revs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 42729545, "answer_count": 1, "score": 0, "last_activity_date": 1489189359, "creation_date": 1489189141, "question_id": 42729515, "link": "https://stackoverflow.com/questions/42729515/haskell-if-statement-is-not-working-properly", "title": "Haskell if statement is not working properly", "body": "<p>Very simple code. It will get the third last item from a list.</p>\n\n<pre><code>list numbers = if length numbers &gt; 3\nthen numbers!!(length numbers - 3) \n\nelse \"length must be greater than 2\"\n</code></pre>\n\n<p>When i try to run it on the GHCI I keep getting this error however,</p>\n\n<p>*Main> list [2,3,4]</p>\n\n<pre><code>&lt;interactive&gt;:65:7: No instance for (Num [Char])\n arising from the literal     `2'\n Possible fix: add an instance declaration for (Num [Char])\nIn the expression: 2\nIn the first argument of `list', namely `[2, 3, 4]'\nIn the expression: list [2, 3, 4]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1489184082, "post_id": 42728521, "comment_id": 72576776, "body": "I think it would be best to start learning syntax at learnyouahaskell.com at least that is where I have started"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "edited": false, "score": 0, "creation_date": 1489184111, "post_id": 42728583, "comment_id": 72576790, "body": "Thanks a lot. But I don&#39;t understand the syntax Bool -&gt; Bool -&gt; Bool. Doesn&#39;t &quot;-&gt;&quot; mean return?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489184872, "post_id": 42728583, "comment_id": 72577073, "body": "the syntax means that everything before the last arrow <code>-&gt;</code> is argument -i.e. 2 x <code>Bool</code> and the one after the last arrow is the result type - in this case also <code>Bool</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1489184903, "post_id": 42728583, "comment_id": 72577085, "body": "@melpomene I think this is what the OP intended to write - it is a bit unclear though"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "edited": false, "score": 0, "creation_date": 1489237886, "post_id": 42728583, "comment_id": 72589263, "body": "@RyanZhao Strictly speaking, <code>-&gt;</code> itself is an operator; it maps a single argument type to a single return type. In this case, the argument type is <code>Bool</code>, and the return type is <i>another</i> function type, <code>Bool -&gt; Bool</code>. Haskell functions are <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">curried</a>."}], "tags": [], "owner": {"reputation": 357162, "user_id": 28804, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/015c999a9db79ffb3030b3cc207d0be8?s=128&d=identicon&r=PG", "display_name": "mipadi", "link": "https://stackoverflow.com/users/28804/mipadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1489183980, "last_edit_date": 1489183980, "creation_date": 1489183967, "answer_id": 42728583, "question_id": 42728521, "link": "https://stackoverflow.com/questions/42728521/assert-type-of-a-function-with-two-arguments/42728583#42728583", "title": "assert type of a function with two arguments", "body": "<p>You declare the type on a separate line, like this:</p>\n\n<pre><code>c :: Bool -&gt; Bool -&gt; Bool\nc a b = a &amp;&amp; b\n</code></pre>\n\n<p>Really, though, you could also skip the arguments:</p>\n\n<pre><code>c :: Bool -&gt; Bool -&gt; Bool\nc = (&amp;&amp;)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 4, "last_activity_date": 1489185621, "last_edit_date": 1489185621, "creation_date": 1489184995, "answer_id": 42728801, "question_id": 42728521, "link": "https://stackoverflow.com/questions/42728521/assert-type-of-a-function-with-two-arguments/42728801#42728801", "title": "assert type of a function with two arguments", "body": "<pre><code>c = a&amp;&amp;b (Bool a, Bool b) -&gt; Bool\n</code></pre>\n\n<p>This is a syntax error. <code>a &amp;&amp; b (Bool a, Bool b) -&gt; Bool</code> is treated as a single expression. If I were a compiler, I'd complain about <code>-&gt;</code> because that's not valid there. (Subsequent errors: A <code>Bool</code> constructor is not in scope and <code>b</code> is not a function.)</p>\n\n<p>If you want to express that <code>c</code> is a <code>Bool</code>:</p>\n\n<pre><code>c :: Bool\nc = a &amp;&amp; b\n</code></pre>\n\n<p>If you want to express that the expression <code>a&amp;&amp;b</code> has type <code>Bool</code>:</p>\n\n<pre><code>c = a &amp;&amp; b :: Bool\n</code></pre>\n\n<hr>\n\n<p>However, your title says \"<em>type of a function with two arguments</em>\" but your <code>c</code> isn't a function (it has no arguments). If you intended <code>a</code> and <code>b</code> to be arguments, it would look like:</p>\n\n<pre><code>c a b = a &amp;&amp; b\n</code></pre>\n\n<p>or</p>\n\n<pre><code>c = \\a b -&gt; a &amp;&amp; b\n</code></pre>\n\n<p>In this case a type signature would look like:</p>\n\n<pre><code>c :: Bool -&gt; Bool -&gt; Bool\n</code></pre>\n\n<p>This is because <code>-&gt;</code> in a type is right associative: <code>Bool -&gt; Bool -&gt; Bool</code> means <code>Bool -&gt; (Bool -&gt; Bool)</code>, i.e. <code>c</code> is a function taking a <code>Bool</code> and returning a function (which takes <code>Bool</code> and returns a <code>Bool</code>).</p>\n\n<hr>\n\n<p><code>c :: (Bool a, Bool b) -&gt; Bool</code> is wrong on multiple levels. The most immediate problem is that <code>Bool a</code> is the syntax for passing an argument to a parametrized type (as in <code>Maybe Int</code> or <code>Set String</code>), but <code>Bool</code> takes no arguments (and if it did, then <code>... -&gt; Bool</code> would be missing an argument).</p>\n\n<p>Second, types and expressions live in different \"worlds\". The variables <code>a</code> and <code>b</code> are type variables here. They're unrelated to <code>a</code> and <code>b</code> in the following expression.</p>\n\n<p>Third, <code>(X, Y)</code> is tuple syntax. It's possible to define <code>c</code> to take a single argument (which is a tuple of two <code>Bool</code>s):</p>\n\n<pre><code>c :: (Bool, Bool) -&gt; Bool\nc (a, b) = a &amp;&amp; b\n</code></pre>\n\n<p>... but this is not what's normally done in Haskell. The convention is to prefer curried functions (the functions-returning-functions thing described above), where you effectively have <code>Arg1 -&gt; Arg2 -&gt; Arg3 -&gt; ... -&gt; Result</code>.</p>\n"}], "owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 42728583, "answer_count": 2, "score": -1, "last_activity_date": 1489185621, "creation_date": 1489183697, "question_id": 42728521, "link": "https://stackoverflow.com/questions/42728521/assert-type-of-a-function-with-two-arguments", "title": "assert type of a function with two arguments", "body": "<p>Basically, I'm doing something like</p>\n\n<pre><code>c = a&amp;&amp;b\n</code></pre>\n\n<p>where both a, b are Bool.</p>\n\n<p>Here is what I wrote:</p>\n\n<pre><code>c = a&amp;&amp;b (Bool a, Bool b) -&gt; Bool\n</code></pre>\n\n<p>But obviously it doesn't work. Can anyone tells what's the problem?</p>\n"}, {"tags": ["function", "haskell", "types", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "is_accepted": true, "score": 2, "last_activity_date": 1489227065, "creation_date": 1489227065, "answer_id": 42733911, "question_id": 42727985, "link": "https://stackoverflow.com/questions/42727985/ghc-api-find-all-functions-and-their-types-in-scope/42733911#42733911", "title": "GHC API: Find all functions (and their types) in scope", "body": "<p>The GHC API is rather confusing, you have to get used to a lot of abbreviations, type-synonyms and a style-heterogenous codebase, but finding the the name and type of everything in scope should be possible.\nOtherwise GHC couldn't tell you that your function is not in scope if you make a typo.</p>\n\n<p>Indeed, once you have type-checked a module, all the relevant information is available.\nFirst you need all the <code>Name</code>s of your functions, which you can get with this code:</p>\n\n<pre><code>parsedModule &lt;- parseModule modSum\ntmod &lt;- typecheckModule parsedModule\nlet (tcenv, moddets) = tm_internals_ tmod\nlet names = concatMap (map gre_name) $ occEnvElts $ tcg_rdr_env tcenv\n</code></pre>\n\n<p>Then you need to lookup the <code>Names</code> to get <code>TyThing</code>s with <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/libraries/ghc-8.0.2/GHC.html#v:lookupName\" rel=\"nofollow noreferrer\"><code>lookupName</code></a>.\nYou'll get a <code>Maybe TyThing</code> (<code>Nothing</code> if the <code>Name</code> is not found), and when the name refers to a function, the <code>TyThing</code> will be <code>AnId i</code> where <code>i</code> is the thing you're looking for.\nAn <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/libraries/ghc-8.0.2/Var.html#t:Id\" rel=\"nofollow noreferrer\"><code>Id</code></a> is just a name with a type.\nYou can then get the type with <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/libraries/ghc-8.0.2/Var.html#v:varType\" rel=\"nofollow noreferrer\"><code>varType</code></a>.</p>\n\n<p>You could argue that all these types make this problem a lot harder, but they've made it possible for me to figure out what I need to do without looking into the code and with no documentation.</p>\n"}], "owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 42733911, "answer_count": 1, "score": 2, "last_activity_date": 1489227065, "creation_date": 1489181261, "question_id": 42727985, "link": "https://stackoverflow.com/questions/42727985/ghc-api-find-all-functions-and-their-types-in-scope", "title": "GHC API: Find all functions (and their types) in scope", "body": "<p>I'm trying to list (print) all functions (and their types) that are in scope for a given module.</p>\n\n<p>For example, I have this module:</p>\n\n<pre><code>{-# LANGUAGE NoImplicitPrelude #-}\n\nmodule Reverse where\n\nimport Prelude ((==), String)\n\nmyString :: String\nmyString = \"string\"\n</code></pre>\n\n<p>I'm trying to use the GHC API (8.0.2), but I can't seem to find where the information that I'm looking for is stored.\nI have managed to find all functions in scope, (but not with their types,) with this code:</p>\n\n<pre><code>import Data.IORef\n\nimport DynFlags\nimport GHC\nimport GHC.LanguageExtensions\nimport GHC.Paths (libdir)\nimport HscTypes\nimport NameEnv\nimport OccName\nimport Outputable\nimport RdrName\nimport TcRnTypes\n\n\nmain = runGhc (Just libdir) $ do\n        liftIO $ print sets\n        dflags &lt;- getSessionDynFlags\n        let compdflags =\n                (foldl xopt_set dflags [Cpp, ImplicitPrelude, MagicHash])\n        setSessionDynFlags compdflags\n        target &lt;- guessTarget \"Reverse.hs\" Nothing\n        setTargets [target]\n        load LoadAllTargets\n        modSum &lt;- getModSummary $ mkModuleName \"Reverse\"\n        parsedModule &lt;- parseModule modSum\n        tmod &lt;- typecheckModule parsedModule\n        let (tcenv, moddets) = tm_internals_ tmod\n        printO $ map (map gre_name) $ occEnvElts $ tcg_rdr_env tcenv\n\nprintO\n    :: (GhcMonad m, Outputable a)\n    =&gt; a -&gt; m ()\nprintO a = do\n    dfs &lt;- getProgramDynFlags\n    liftIO $ putStrLn $ showPpr dfs a\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>[[String], [==], [myString]]\n</code></pre>\n\n<p>Of course, this is only half of the way to the data I need.</p>\n"}, {"tags": ["haskell", "recursion-schemes"], "answers": [{"comments": [{"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1489175607, "post_id": 42726643, "comment_id": 72572857, "body": "I already figured that myself :) Is there sort of histomorphic anamorphism that provides me with all past values and not just one?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 7, "creation_date": 1489180479, "post_id": 42726643, "comment_id": 72575292, "body": "Ah, but it&#39;s not that you have one <i>past</i> value. You have one <i>future</i> value, but it&#39;s easy to express that data structure (the one-value-into-the-future sliding window) because of the peculiar symmetry of numbers: every number has <i>one</i> successor. In general, every substructure has lots of possible superstructures. If you want a type of &quot;values computed for stuff before x&quot;, that would be <i>dependent</i> on x. Twenty years ago, I lost months of my life to trying to generalise sliding-window fibonacci to course-of-values recursion, before I figured out that fibonacci is just a fluke."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 1, "last_activity_date": 1489175466, "creation_date": 1489175466, "answer_id": 42726643, "question_id": 42726378, "link": "https://stackoverflow.com/questions/42726378/corecursive-fibonacci-using-recursion-schemes/42726643#42726643", "title": "Corecursive fibonacci using recursion schemes", "body": "<p>Sure. Your <code>fibs</code> is readily translated into an <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:unfoldr\" rel=\"nofollow noreferrer\"><code>unfoldr</code></a>, which is just a slightly different way to spell <code>ana</code>.</p>\n\n<pre><code>fibs = unfoldr (\\(a, b) -&gt; Just (a, (b, a + b))) (1,1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "is_accepted": false, "score": 1, "last_activity_date": 1489212948, "last_edit_date": 1489212948, "creation_date": 1489205358, "answer_id": 42731252, "question_id": 42726378, "link": "https://stackoverflow.com/questions/42726378/corecursive-fibonacci-using-recursion-schemes/42731252#42731252", "title": "Corecursive fibonacci using recursion schemes", "body": "<p>Here is (sort of) what I wanted:</p>\n\n<pre><code>type L f a = f (Cofree f a)\n\nhistAna\n  :: (Functor f, Corecursive t) =&gt;\n     (f (Cofree g a) -&gt; Base t (L g a))\n     -&gt; (L g a -&gt; f a)\n     -&gt; L g a -&gt; t\nhistAna unlift psi = ana (unlift . lift) where\n    lift oldHist = (:&lt; oldHist) &lt;$&gt; psi oldHist\n</code></pre>\n\n<p><code>psi</code></p>\n\n<ul>\n<li>takes an \"old history\" as a seed,</li>\n<li>produces one level and seeds just like in normal <code>ana</code>,</li>\n<li>then the new seeds are appended to the \"old history\", so the <code>newHistory</code> becomes <code>newSeed :&lt; oldHistory</code></li>\n</ul>\n\n<p><code>unlift</code> produces current level from seed and history.</p>\n\n<pre><code>fibsListAna :: Num a =&gt; L Maybe a -&gt; [a]\nfibsListAna = histAna unlift psi where\n    psi (Just (x :&lt; Just (y :&lt; _))) = Just $ x + y\n    unlift x = case x of\n        Nothing -&gt; Nil\n        h@(Just (v :&lt; _)) -&gt; Cons v h\n\nr1 :: [Integer]\nr1 = take 10 $ toList $ fibsListAna $ Just (0 :&lt; Just (1 :&lt; Nothing))\n</code></pre>\n\n<p>Stream version can also be implemented (<code>Identity</code> and <code>(,) a</code> functors respectively should be used). The binary tree case works too, but it's not clear if it's of any use. Here is a degenerated case I wrote blindly just to satisfy the type checker:</p>\n\n<pre><code>fibsTreeAna :: Num a =&gt; L Fork a -&gt; Tree a\nfibsTreeAna = histAna unlift psi where\n    psi (Fork (a :&lt; _) (b :&lt; _)) = Fork a b\n    unlift x = case x of\n        h@(Fork (a :&lt; _) (b :&lt; _)) -&gt; NodeF (a + b) h h\n</code></pre>\n\n<p>It's not clear if we lose anything by replacing <code>Cofree</code> with lists:</p>\n\n<pre><code>histAna\n    :: (Functor f, Corecursive t) =&gt;\n       (f [a] -&gt; Base t [a])\n        -&gt; ([a] -&gt; f a)\n        -&gt; [a] -&gt; t\n  histAna unlift psi = ana (unlift . lift) where\n      lift oldHist = (: oldHist) &lt;$&gt; psi oldHist\n</code></pre>\n\n<p>In this case 'history' becomes just the path to the tree root filled by seeds.</p>\n\n<p>The list version turns out to be easily simplified by using different functor so seeding and filling the level can be accomplished in one place:</p>\n\n<pre><code>histAna psi = ana lift where\n      lift oldHist = (: oldHist) &lt;$&gt; psi oldHist\n\nfibsListAna :: Num a =&gt; [a]\nfibsListAna = histAna psi [0,1] where\n    psi (x : y : _) = Cons (x + y) (x + y)\n</code></pre>\n\n<p>The original code with <code>Cofree</code> can be simplified too:</p>\n\n<pre><code>histAna :: (Functor f, Corecursive t) =&gt; (L f a -&gt; Base t (f a)) -&gt; L f a -&gt; t\nhistAna psi = ana $ \\oldHist -&gt; fmap (:&lt; oldHist) &lt;$&gt; psi oldHist\n\nfibsListAna :: Num a =&gt; L Maybe a -&gt; [a]\nfibsListAna = histAna $ \\case\n    Just (x :&lt; Just (y :&lt; _)) -&gt; Cons (x + y) (Just (x + y))\n\nfibsStreamAna :: Num a =&gt; L Identity a -&gt; Stream a\nfibsStreamAna = histAna $ \\case\n    Identity (x :&lt; Identity (y :&lt; _)) -&gt; (x + y, Identity $ x + y)\n\nfibsTreeAna :: Num a =&gt; L Fork a -&gt; Tree a\nfibsTreeAna = histAna $ \\case\n    Fork (a :&lt; _) (b :&lt; _) -&gt; NodeF (a + b) (Fork a a) (Fork b b)\n</code></pre>\n"}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1489212948, "creation_date": 1489174475, "last_edit_date": 1489177311, "question_id": 42726378, "link": "https://stackoverflow.com/questions/42726378/corecursive-fibonacci-using-recursion-schemes", "title": "Corecursive fibonacci using recursion schemes", "body": "<p>There is an elegant derinition of list of fibonacci numbers:</p>\n\n<pre><code>fibs :: [Integer]\nfibs = fib 1 1 where\n  fib a b = a : fib b (a + b)\n</code></pre>\n\n<p>Can it be translated to use <code>recursion-schemes</code> library?</p>\n\n<p>The closest I could get is the following code that uses completely different approach:</p>\n\n<pre><code>fibN' :: Nat -&gt; Integer\nfibN' = histo $ \\case\n  (refix -&gt; x:y:_) -&gt; x + y\n  _ -&gt; 1\n</code></pre>\n\n<p>I can provide the rest of the code if necessary, but essentially I get the Nth fibonacci number by using a histomorphism of Nat = Fix Maybe. <code>Maybe (Cofree Maybe a)</code> turns out to be isomorphic to <code>[a]</code>, so <code>refix</code> can be thought just as a sort of <code>toList</code> to make the pattern shorter.</p>\n\n<p>Upd:</p>\n\n<p>I found shorter code but it only stores one value and in a non-generic way:</p>\n\n<pre><code>fib' :: (Integer, Integer) -&gt; [Integer]\nfib' = ana $ \\(x, y) -&gt; Cons x (y, x+y)\n</code></pre>\n\n<p>A non-generic way to store full history:</p>\n\n<pre><code>fib'' :: [Integer] -&gt; [Integer]\nfib'' = ana $ \\l@(x:y:_) -&gt; Cons x (x + y : l)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 1360, "user_id": 1594886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cda9c379816b5fa2094c09c3853168?s=128&d=identicon&r=PG", "display_name": "tauli", "link": "https://stackoverflow.com/users/1594886/tauli"}, "edited": false, "score": 2, "creation_date": 1489173845, "post_id": 42725607, "comment_id": 72571959, "body": "Not a straight answer to your problem, but in my experience you are better off using stack, esp. on windows. With stack you will not have to bother with this. <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/README</a>"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1489178916, "post_id": 42725607, "comment_id": 72574529, "body": "Use stack instead. It makes life much, much easier."}, {"owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "edited": false, "score": 1, "creation_date": 1489187000, "post_id": 42725607, "comment_id": 72577867, "body": "Thanks guys. I solved it. Seems it is the firewall problem. I closed the firewall and reinstalled again, then it works."}, {"owner": {"reputation": 10244, "user_id": 2157640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aoymS.png?s=128&g=1", "display_name": "Palec", "link": "https://stackoverflow.com/users/2157640/palec"}, "edited": false, "score": 0, "creation_date": 1493375231, "post_id": 42725607, "comment_id": 74401686, "body": "Related Q: <a href=\"http://stackoverflow.com/q/42555250/2157640\">stackoverflow.com/q/42555250/2157640</a>"}], "owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4830, "favorite_count": 3, "answer_count": 0, "score": 5, "last_activity_date": 1492631864, "creation_date": 1489171364, "question_id": 42725607, "link": "https://stackoverflow.com/questions/42725607/how-to-modify-cabal-config-file-on-windows", "title": "How to modify cabal config file on windows", "body": "<p>I am installing Haskell on my desktop, which is windows system. I follow the instruction. It says: Modify your cabal config file (you can verify the location by running \"cabal user-config init\") to contain the following lines:</p>\n\n<pre><code>extra-prog-path: C:\\Program Files\\Haskell Platform\\8.0.2\\msys\\usr\\bin\nextra-lib-dirs: C:\\Program Files\\Haskell Platform\\8.0.2\\mingw\\lib\nextra-include-dirs: C:\\Program Files\\Haskell Platform\\8.0.2\\mingw\\include\n</code></pre>\n\n<p>I tried to call \"cabal user-config init\" in command prompt, but it doesn't work. Anyone know where should I call \"cabal user-config init\"?</p>\n"}, {"tags": ["macos", "haskell", "sdl"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1489171357, "post_id": 42725565, "comment_id": 72570754, "body": "Can you give a reference to the source code of an app you aim to run with <code>runhaskell</code>?"}, {"owner": {"reputation": 1360, "user_id": 1594886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cda9c379816b5fa2094c09c3853168?s=128&d=identicon&r=PG", "display_name": "tauli", "link": "https://stackoverflow.com/users/1594886/tauli"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489173662, "post_id": 42725565, "comment_id": 72571879, "body": "literally any SDL-app I&#39;ve tried, e.g. <a href=\"https://github.com/haskell-game/sdl2/blob/master/examples/lazyfoo/Lesson01.hs\" rel=\"nofollow noreferrer\">github.com/haskell-game/sdl2/blob/master/examples/lazyfoo/&hellip;</a>"}], "owner": {"reputation": 1360, "user_id": 1594886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cda9c379816b5fa2094c09c3853168?s=128&d=identicon&r=PG", "display_name": "tauli", "link": "https://stackoverflow.com/users/1594886/tauli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489171234, "creation_date": 1489171234, "question_id": 42725565, "link": "https://stackoverflow.com/questions/42725565/haskell-sdl-app-on-macos-doesnt-recognize-keyboard-mouse-when-run-with-runhaske", "title": "Haskell SDL app on macOS doesn&#39;t recognize keyboard/mouse when run with runhaskell", "body": "<p>I'm running into a weird problem when running sdl-apps under macOS. Compiled apps run fine, but when i try to run the same code with runhaskell (or more specifically stack runghc) a window opens with no title bar and doesn't react to mouse or keyboard input. Doing the same under Windows or Linux works fine though.</p>\n\n<p>Is there anything like a command line argument or something that i can do about that or do i just have to live with this?</p>\n\n<p>SDL system librarys were installed via homebrew and the haskell libs via stack lts-8.3</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1489165459, "post_id": 42723689, "comment_id": 72567493, "body": "If that <i>was</i> a possible implementation, then there would be no need to define <code>smallest</code> at all \u2013 you could just just <code>min</code> right in place where you need to find the smallest number."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1489190512, "post_id": 42723756, "comment_id": 72578901, "body": "The infix version, <code>smallest a b c = a `min` b `min` c</code>, also looks pretty nice."}], "tags": [], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "is_accepted": false, "score": 10, "last_activity_date": 1489165405, "last_edit_date": 1489165405, "creation_date": 1489165038, "answer_id": 42723756, "question_id": 42723689, "link": "https://stackoverflow.com/questions/42723689/how-can-i-find-the-smallest-of-3-integers-in-haskell/42723756#42723756", "title": "How can I find the smallest of 3 integers in Haskell?", "body": "<p><code>min</code> function accepts two arguments, that's why your code doesn't compile. However, your can call <code>min</code> twice:</p>\n\n<pre><code>smallest :: Int -&gt; Int -&gt; Int -&gt; Int\nsmallest a b c = min a (min b c)\n</code></pre>\n\n<p>If you are unsatisfied with calling it twice and want a more concise solution, you can use <code>minimum</code> function. It accepts a list and returns its minimum value:</p>\n\n<pre><code>smallest :: Int -&gt; Int -&gt; Int -&gt; Int\nsmallest a b c = minimum [a, b, c]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 6, "creation_date": 1489165601, "post_id": 42723843, "comment_id": 72567582, "body": "<code>min a (min b c)</code> actually corresponds to <code>foldr1 min [a,b,c]</code>. With the left fold <code>foldl1</code>, it&#39;s <code>min (min a b) c</code>, which gives of course the same result."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489400444, "post_id": 42723843, "comment_id": 72637777, "body": "@leftaroundabout I have to admit I didn&#39;t really think about that since it&#39;s pretty obvious that both the left and right fold can be used here, but you&#39;re obviously right."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 5, "last_activity_date": 1489400456, "last_edit_date": 1489400456, "creation_date": 1489165274, "answer_id": 42723843, "question_id": 42723689, "link": "https://stackoverflow.com/questions/42723689/how-can-i-find-the-smallest-of-3-integers-in-haskell/42723843#42723843", "title": "How can I find the smallest of 3 integers in Haskell?", "body": "<p>@Zheka's code works fine for three numbers, and if you ever needed more, it's enough to notice that <code>min a (min b c)</code> looks just like a fold:</p>\n\n<pre><code>smallest a b c = foldl1 min [a, b, c]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 5494506, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69a5cc7faa3f78d07f0b7e6b6e642c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Gareev", "link": "https://stackoverflow.com/users/5494506/marat-gareev"}, "is_accepted": false, "score": 0, "last_activity_date": 1589304734, "creation_date": 1589304734, "answer_id": 61758184, "question_id": 42723689, "link": "https://stackoverflow.com/questions/42723689/how-can-i-find-the-smallest-of-3-integers-in-haskell/61758184#61758184", "title": "How can I find the smallest of 3 integers in Haskell?", "body": "<p>Pointfree style:</p>\n\n<pre><code>smallest :: Int -&gt; Int -&gt; Int -&gt; Int\nsmallest = (min .) . min\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2070, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1589304734, "creation_date": 1489164818, "last_edit_date": 1489191744, "question_id": 42723689, "link": "https://stackoverflow.com/questions/42723689/how-can-i-find-the-smallest-of-3-integers-in-haskell", "title": "How can I find the smallest of 3 integers in Haskell?", "body": "<p>As a beginner in Haskell I am trying to write a code to find the smallest number out of 3 integers. This is what I have so far. Can anyone push me in the right direction?</p>\n\n<pre><code>smallest :: Int -&gt; Int -&gt; Int -&gt; Int\nsmallest a b c = min a b c\n</code></pre>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489158263, "post_id": 42720699, "comment_id": 72562806, "body": "@Willem Van Onsem Thank you for your help so far, I am beginning to understand the problem better now. However, when I try the code which you have suggest, I still keep getting the error:  &quot;Non-exhaustive patterns in function giveRaise&quot;. As I am a beginner, I don&#39;t know what this means yet. My updated code so far is: giveRaise :: Char -&gt; Int -&gt; [(Char, String, Int)] -&gt; [(Char, String, Int)] giveRaise pa n ((pb, z, m):tail)  | pa == pb = (pb,z,m+n):tail  | otherwise = (pb,z,m):giveRaise pa n tail"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489158292, "post_id": 42720699, "comment_id": 72562827, "body": "Well the problem is what you do when the person cannot be found in the list?"}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489158852, "post_id": 42720699, "comment_id": 72563219, "body": "@WillemVanOnsem In the list of tuples given, the Tuple that we are changing will always be there. Does that help at all?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489158889, "post_id": 42720699, "comment_id": 72563240, "body": "can you give an example of a call where the person is in the list and it errors?"}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489159079, "post_id": 42720699, "comment_id": 72563368, "body": "Well in my original question, the list given has &quot;Al&quot; in it. His initial is A and I want to raise his number from 1000 to 1200"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489159146, "post_id": 42720699, "comment_id": 72563414, "body": "@SyedAhamad: well If I run the code in the answer, it generates the correct result..."}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489159909, "post_id": 42720699, "comment_id": 72563932, "body": "I still keep getting the same error when I apply your edited code. Could you confirm that you have been able to get the right output when you try the original question I posted? @WillemVanOnsem"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489160061, "post_id": 42720699, "comment_id": 72564035, "body": "yes <code>[(&#39;A&#39;,&quot;Al&quot;,1200),(&#39;B&#39;,&quot;Bob&quot;,1500)]</code>. Did you <i>reload</i> the file (enter <code>:r</code>)."}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489160446, "post_id": 42720699, "comment_id": 72564289, "body": "I did reload the file yes. When I try it, I just type in the following: *Main&gt; giveRaise &#39;A&#39; 200 [(&#39;A&#39;,&quot;Al&quot;,1200),(&#39;B&#39;,&quot;Bob&quot;,1500)]"}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489180725, "post_id": 42720917, "comment_id": 72575410, "body": "I think you should mention that if two persons have the same identifier <code>pb</code> in the list only the first (in list order) gets the raise."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489180853, "post_id": 42720917, "comment_id": 72575466, "body": "@epsilonhalbe: yeah good point. I added a note at the end of the answer."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1489180827, "last_edit_date": 1489180827, "creation_date": 1489156609, "answer_id": 42720917, "question_id": 42720699, "link": "https://stackoverflow.com/questions/42720699/how-can-i-update-a-specific-tuple-in-a-list-in-haskell/42720917#42720917", "title": "How can I update a specific tuple in a list in Haskell?", "body": "<p>You are going to modify an arbitrary element in the list so worst case you will have to <em>loop</em>. Since <em>recursion</em> is the way to loop in Haskell, it is weird that you write the <code>giveRaise</code> one clause. When using recursion you always have two types of clauses:</p>\n\n<ul>\n<li>a <em>base case</em>: we have found the person, and give them a raise; and</li>\n<li>a <em>recursive case</em>: we currently have not found the person yet, and thus keep looking for it.</li>\n</ul>\n\n<p>The base case is simple:</p>\n\n<pre><code>giveRaise <b>pa</b> n ((<b>pb</b>,z,m)<b>:tail) | pa == pb</b> = (pb,z,m+n)<b>:tail</b></code></pre>\n\n<p>In Prolog you can use the same variable in the <em>head</em> and <em>unification</em> (in Erlang, equality is checked) is done. That is not allowed in Haskell. In Haskell one uses <em>guards</em> (like <code>| pa == pb</code>) to determine if the two persons are the same.</p>\n\n<p>Now there is another option: <code>pa</code> is not <code>pb</code>. In the <code>otherwise</code> case, we perform recursion and search further in the list, so:</p>\n\n<pre><code>                               <b>| otherwise = (pb,z,m):giveRaise pa n tail</b></code></pre>\n\n<p>Or putting the together:</p>\n\n<pre><code>giveRaise <b>pa</b> n ((<b>pb</b>,z,m)<b>:tail) | pa == pb</b> = (pb,z,m+n)<b>:tail</b>\n                               <b>| otherwise = (pb,z,m):giveRaise pa n tail</b></code></pre>\n\n<p>There is finally a last case we have to take into account: what to do if we reach the end of the list and did not found the person? We can simply ignore that and return the empty list like:</p>\n\n<pre><code>giveRaise _ _ [] = []\n</code></pre>\n\n<p>or we can throw an <code>error</code>:</p>\n\n<pre><code>giveRaise _ _ [] = error \"Could not give a raise.\"\n</code></pre>\n\n<p>So we can implement it like:</p>\n\n<pre><code>giveRaise pa n ((pb,z,m):tail) | pa == pb = (pb,z,m+n):tail\n                               | otherwise = (pb,z,m):giveRaise pa n tail\n<b>giveRaise _ _ [] = error \"Could not give a raise.\"</b></code></pre>\n\n<p>Finally note that this function will <strong>only give a raise to the first person with the given identifier</strong>. <strong>Not all persons with that identifier</strong>. I however assumed that the identifiers are unique.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 3, "last_activity_date": 1489171709, "last_edit_date": 1489171709, "creation_date": 1489162934, "answer_id": 42723094, "question_id": 42720699, "link": "https://stackoverflow.com/questions/42720699/how-can-i-update-a-specific-tuple-in-a-list-in-haskell/42723094#42723094", "title": "How can I update a specific tuple in a list in Haskell?", "body": "<p>\"Do <em>something</em> to one element in a list\" is the same as \"do <em>something else</em> to every element in the list\", where <em>something else</em> does <em>something</em> when the element is the one you're looking for and <em>nothing</em> when it's not. In other words, it makes sense to structure this operation as a <code>map</code>.</p>\n\n<pre><code>giveRaise :: Char -&gt; Int -&gt; [(Char, String, Int)] -&gt; [(Char, String, Int)]\ngiveRaise x amt = map raise\n    where raise (y, n, salary)\n            | x == y    = (y, n, salary + amt)\n            | otherwise = (y, n, salary)\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 42720917, "answer_count": 2, "score": 2, "last_activity_date": 1489181254, "creation_date": 1489155969, "last_edit_date": 1489181254, "question_id": 42720699, "link": "https://stackoverflow.com/questions/42720699/how-can-i-update-a-specific-tuple-in-a-list-in-haskell", "title": "How can I update a specific tuple in a list in Haskell?", "body": "<p>I'm a beginner is Haskell and I'm trying to make a function which can give a raise to the salary of a person with a specific initial as seen below:</p>\n\n<pre><code>*Main&gt; giveRaise 'A' 200 [('A',\"Al\",1000),('B',\"Bob\",1500)]\n</code></pre>\n\n<p>Which would give an answer of this:</p>\n\n<pre><code>[('A',\"Al\",1200),('B',\"Bob\",1500)]\n</code></pre>\n\n<p>My code so far is this, but I keep getting an error when I try it to raise initial 'g' by n:</p>\n\n<pre><code>giveRaise :: Char -&gt; Int -&gt; [(Char, String, Int)] -&gt; [(Char, String, Int)]\ngiveRaise g n [(g, z, m)]\n = [(g, z, (m + n))]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1489163003, "post_id": 42720372, "comment_id": 72565943, "body": "you can think of a series with <code>a[n+1]=(a[n]+1)+(2*a[n])</code>, starting with <code>a[0]=0</code>, which is equivalent to <code>3a[n]+1</code>."}, {"owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1489172988, "post_id": 42720372, "comment_id": 72571546, "body": "@karakfa  Makes sense, thx =)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1489157268, "creation_date": 1489157268, "answer_id": 42721140, "question_id": 42720372, "link": "https://stackoverflow.com/questions/42720372/lazy-evaluation-in-haskell-with-zipwith-and-two-infinite-lists/42721140#42721140", "title": "Lazy evaluation in Haskell with zipWith and two infinite lists", "body": "<p>It roughly works like this</p>\n\n<pre><code>lazee = 0 : lazee1\nlazee1 = zipWith (+) (map (+1) lazee) (map (2*) lazee)\n</code></pre>\n\n<p>therefore</p>\n\n<pre><code>lazee = 0 : lazee1\nlazee1 = zipWith (+) (map (+1) (0:lazee1)) (map (2*) (0:lazee1))\n</code></pre>\n\n<p>but <code>map (+1) (0:lazee1)</code> is <code>1 : map (+1) lazee1</code>. Similarly for the other <code>map</code>. Therefore</p>\n\n<pre><code>lazee = 0 : lazee1\nlazee1 = zipWith (+) (1 : map (+1) lazee1) (0 : map (2*) lazee1)\n</code></pre>\n\n<p>Now <code>zipWith</code> knows the first elements, and can compute <code>(+) 1 0</code>. We get</p>\n\n<pre><code>lazee = 0 : lazee1\nlazee1 = 1 : lazee2\nlazee2 = zipWith (+) (map (+1) lazee1) (map (2*) lazee1)\n</code></pre>\n\n<p>Now repeat the same steps as above:</p>\n\n<pre><code>lazee2 = zipWith (+) (map (+1) (1:lazee2)) (map (2*) (1:lazee2))\n       = zipWith (+) (2 : map (+1) lazee2) (2 : map (2*) lazee2)\n       = 4 : zipWith (+) (map (+1) lazee2) (map (2*) lazee2)\n</code></pre>\n\n<p>And so on.</p>\n"}], "owner": {"reputation": 147, "user_id": 7031986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa54805ea5add8d5ba4ef94df6b674e?s=128&d=identicon&r=PG&f=1", "display_name": "RosaryLightning X", "link": "https://stackoverflow.com/users/7031986/rosarylightning-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 42721140, "answer_count": 1, "score": 0, "last_activity_date": 1489157268, "creation_date": 1489155037, "question_id": 42720372, "link": "https://stackoverflow.com/questions/42720372/lazy-evaluation-in-haskell-with-zipwith-and-two-infinite-lists", "title": "Lazy evaluation in Haskell with zipWith and two infinite lists", "body": "<p>Evaluating the Haskell code here:</p>\n\n<pre><code>lazee = 0 : zipWith (+) (map (+1) lazee) (map (2*) lazee)\n</code></pre>\n\n<p>and then calling <code>take 5 lazee</code> yields this result:</p>\n\n<pre><code>[0,1,4,13,40]\n</code></pre>\n\n<p>I don't understand the order in which the above functions are evaluated.  They are infinite lists and I have a bit of trouble wrapping my head around that.  Consequently I'm not sure how Haskell would have gotten this result.</p>\n"}, {"tags": ["haskell", "haskell-stack", "ghcjs"], "answers": [{"tags": [], "owner": {"reputation": 247, "user_id": 2104932, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bs98N.jpg?s=128&g=1", "display_name": "matchwood", "link": "https://stackoverflow.com/users/2104932/matchwood"}, "is_accepted": true, "score": 1, "last_activity_date": 1492104769, "creation_date": 1492104769, "answer_id": 43398424, "question_id": 42720347, "link": "https://stackoverflow.com/questions/42720347/how-to-configure-stack-for-most-recent-ghcjs-lts-build/43398424#43398424", "title": "How to configure stack for most recent ghcjs / lts build", "body": "<p>The short answer is that there is no straightforward way to do this. However, I have forked <a href=\"https://github.com/matchwood/ghcjs\" rel=\"nofollow noreferrer\">ghcjs</a>, <a href=\"https://github.com/matchwood/ghcjs-base\" rel=\"nofollow noreferrer\">ghcjs-base</a> and <a href=\"https://github.com/matchwood/ghcjs-boot\" rel=\"nofollow noreferrer\">ghcjs-boot</a>, altered a few patches and so forth and put together a working archive for use with stack. I've raised <a href=\"https://groups.google.com/forum/#!topic/haskell-stack/CMvbzhb2zdw\" rel=\"nofollow noreferrer\">a thread about this</a> in haskell-stack, but no response yet. </p>\n\n<p>For the time being, I have put up a git repo <a href=\"https://github.com/matchwood/ghcjs-stack-dist\" rel=\"nofollow noreferrer\">ghcjs-stack-dist</a> containing prepacked distributions of ghcjs ready for use with stack lts-8.0 and lts-8.5. Please see the repo readme for information on usage.</p>\n"}], "owner": {"reputation": 247, "user_id": 2104932, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bs98N.jpg?s=128&g=1", "display_name": "matchwood", "link": "https://stackoverflow.com/users/2104932/matchwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 1, "accepted_answer_id": 43398424, "answer_count": 1, "score": 8, "last_activity_date": 1492104769, "creation_date": 1489154969, "last_edit_date": 1489236675, "question_id": 42720347, "link": "https://stackoverflow.com/questions/42720347/how-to-configure-stack-for-most-recent-ghcjs-lts-build", "title": "How to configure stack for most recent ghcjs / lts build", "body": "<p>The stack docs gives example configurations for compiling with ghcjs <a href=\"https://docs.haskellstack.org/en/stable/ghcjs/\" rel=\"noreferrer\">https://docs.haskellstack.org/en/stable/ghcjs/</a> . But the latest example is with lts-7.19. I'd like to configure stack to use the latest ghcjs possible with the latest lts (currently 8.4). </p>\n\n<p>I understand that the ghcjs compiler is prepackaged for each lts and hosted by <a href=\"https://github.com/tolysz/\" rel=\"noreferrer\">https://github.com/tolysz/</a> , using <a href=\"https://github.com/tolysz/prepare-ghcjs\" rel=\"noreferrer\">https://github.com/tolysz/prepare-ghcjs</a> . I suppose my real question is: </p>\n\n<p>How can I find out what possible versions are available at ghcjs.tolysz.org (along with their sha1 hashes)?</p>\n\n<p>EDIT: \nSo far I have found that you can view untested builds here: <a href=\"http://tolysz.org/ghcjs/untested/\" rel=\"noreferrer\">http://tolysz.org/ghcjs/untested/</a> but they are indeed untested, and the ones I have tried do not work. I've tried building my own with prepare-ghcjs but with no success - recent changes in ghcjs have not yet been allowed for in prepare-ghcjs, so I'm trying to put something together there <a href=\"https://github.com/tolysz/prepare-ghcjs/issues/6\" rel=\"noreferrer\">https://github.com/tolysz/prepare-ghcjs/issues/6</a> . </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489144383, "post_id": 42716967, "comment_id": 72553945, "body": "An exception at runtime or compile time?"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489144438, "post_id": 42716967, "comment_id": 72553982, "body": "I don&#39;t really mind, it shouldn&#39;t happen. I&#39;ll implement all the combinations I need."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489144496, "post_id": 42716967, "comment_id": 72554021, "body": "Furthermore what is the most specific with two parameters: is <code>Animal a,Nut f</code> more specific than <code>Bird a, Fruit f</code>? The only thing that seems to make sense is a <i>Pareto front</i>, but that is only a partial ordering."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489144819, "post_id": 42716967, "comment_id": 72554231, "body": "Specifying by animal first is fine."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1489144856, "post_id": 42716967, "comment_id": 72554258, "body": "If you really want to go down the type class approach, this sounds like you want <code>MultiParamTypeClasses</code>, then <code>class AnimalFruit a f</code>. Then you can have overlapping instances."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489145526, "post_id": 42716967, "comment_id": 72554622, "body": "@Alec <code>class (Animal a, Fruit f) =&gt; AnimalFruit a f</code> lets me define instances for couples of types, like <code>instance AnimalFruit Int Int</code>. I need instances for couples of type subclasses instead."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 7, "creation_date": 1489156014, "post_id": 42716967, "comment_id": 72561248, "body": "I think you&#39;re misusing the class system. Just model <code>Animal</code> and <code>Food</code> as datatypes and define your <code>eat</code> function with pattern matching."}], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489144369, "creation_date": 1489144236, "last_edit_date": 1489144369, "question_id": 42716967, "link": "https://stackoverflow.com/questions/42716967/ad-hoc-polymorphism-on-two-typeclasses", "title": "Ad hoc polymorphism on two typeclasses", "body": "<p>Suppose I have two typeclass hierarchies that start with</p>\n\n<pre><code>class Animal a where ...\nclass Fruit f where ...\n</code></pre>\n\n<p>I'd like to define an ad hoc polymorphic function</p>\n\n<pre><code>eat :: (Animal a, Fruit f) =&gt; a -&gt; f -&gt; Int\n</code></pre>\n\n<p>that computes the amount of health an animal restores when it eats a fruit. By ad hoc, I mean I want to code specializations of <code>eat</code> for several combinations of type subclasses, for example</p>\n\n<pre><code>eat :: (Bird a, Nut f) =&gt; a -&gt; f -&gt; Int\neat b n = ...\n</code></pre>\n\n<p>When I call <code>eat x y</code>, I expect the compiler to execute the most specific known implementation of <code>eat</code> for the types of <code>x</code> and <code>y</code>. If no such typeclass combination is found, let it throw an exception.</p>\n\n<p>Is this possible in Haskell ?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 156696, "user_id": 813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/12ab1ed206c4093d0eb61843d86fa2aa?s=128&d=identicon&r=PG", "display_name": "Jeremy Ruten", "link": "https://stackoverflow.com/users/813/jeremy-ruten"}, "is_accepted": true, "score": 3, "last_activity_date": 1489132328, "creation_date": 1489132328, "answer_id": 42713044, "question_id": 42712945, "link": "https://stackoverflow.com/questions/42712945/usage-of-dollar-sign-in-putstrln-function/42713044#42713044", "title": "Usage of dollar sign in putStrLn function", "body": "<p><code>$</code> is an operator that passes the value on its right to the function on its left. Here's how it's implemented:</p>\n\n<pre><code>f $ x = f x\n</code></pre>\n\n<p>It's useful because it has a very low <em>operator precedence</em>, so that in your example, the <code>++</code> operators get applied first, resulting in a string that the <code>$</code> function takes and passes to <code>putStrLn</code>.</p>\n\n<p>Without <code>$</code> in your example, Haskell will try to evaluate the line in this order:</p>\n\n<pre><code>(putStrLn \"Total lines in the files are \") ++ show (totalLines) ++ \" lines\"\n</code></pre>\n\n<p>So it will try to print the first string, then take the result of <code>putStrLn</code> and concatenate it with the other strings, which results in an error since <code>putStrLn</code> doesn't return a string.</p>\n"}], "owner": {"reputation": 1627, "user_id": 5964853, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/502f299d16be599d15334e99a5581705?s=128&d=identicon&r=PG&f=1", "display_name": "Srinivas", "link": "https://stackoverflow.com/users/5964853/srinivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 42713044, "answer_count": 1, "score": 2, "last_activity_date": 1489132328, "creation_date": 1489131891, "question_id": 42712945, "link": "https://stackoverflow.com/questions/42712945/usage-of-dollar-sign-in-putstrln-function", "title": "Usage of dollar sign in putStrLn function", "body": "<p>This is a simple program I wrote.</p>\n\n<pre><code>import System.Environment\nimport System.IO\n\nmain = do\n  (fileName1:_) &lt;- getArgs\n  contents &lt;- readFile fileName1\n  let myList = lines contents\n      totalLines = length myList\n  putStrLn $ \"Total lines in the files are \" ++ show (totalLines) ++ \" lines\"\n</code></pre>\n\n<p>If I remove the dollar sign in the last line, Haskell complains that there is an error. Can anyone please explain me internally what happens with and without the dollar sign (or brackets).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "aeson", "servant"], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 1544008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c56aae0ef5e0981403733f7f248c1f?s=128&d=identicon&r=PG", "display_name": "ArthurVard", "link": "https://stackoverflow.com/users/1544008/arthurvard"}, "is_accepted": true, "score": 0, "last_activity_date": 1489132154, "creation_date": 1489132154, "answer_id": 42713012, "question_id": 42711313, "link": "https://stackoverflow.com/questions/42711313/using-a-custom-datatype-in-a-aeson-record/42713012#42713012", "title": "Using a custom datatype in a Aeson record", "body": "<p>First add <code>instance FromJSON UserLevel</code> as you derive it from Generic. For parsing <code>EmailAddress</code> type I use the <code>FromJSON</code> instance implementation from <a href=\"https://hackage.haskell.org/package/emailaddress-0.2.0.0/docs/src/Text-EmailAddress-Internal.html#line-92\" rel=\"nofollow noreferrer\">here</a> (remove type signature and replace <code>&lt;&gt;</code> by <code>++</code> )</p>\n\n<p>for this you need add these imports as well</p>\n\n<pre><code>import Data.Aeson.Types (Parser)\nimport Data.Text.Encoding (encodeUtf8)\n</code></pre>\n\n<p>And the whole code related json parsing</p>\n\n<pre><code>-- * user info\ndata UserLevel = Base | Admin\n  deriving (Eq, Show, Generic)\ninstance FromJSON UserLevel\n\ndata User\n  = User {\n    userId :: Integer,\n    userName :: String,\n    userEmail :: EmailAddress,\n    userLevel :: UserLevel\n  }\n  deriving (Eq, Show, Generic)\n\ninstance ToJSON User where\n    toJSON (User userId userName userEmail userLevel) =\n      object [\"userId\" .= userId, \"userName\" .= userName, \"userEmail\" .= show userEmail, \"userLevel\" .= show userLevel]\n\n\ninstance FromJSON EmailAddress where\n    parseJSON = withText \"EmailAddress\" $ \\t -&gt;\n                    case validate $ encodeUtf8 t of\n                        Left err -&gt; fail $ \"Failed to parse email address: $\n                        Right email -&gt; return email\n\ninstance FromJSON User where\n  parseJSON = withObject \"user\" $ \\o -&gt; do\n    userId    &lt;- o .: \"userId\"\n    userName  &lt;- o .: \"userName\"\n    userEmail &lt;- o .: \"userEmail\"  \n    userLevel &lt;- o .: \"userLevel\"\n    return User{..}\n\n{-- My prefer syntax for json parsing\ninstance FromJSON User where\n  parseJSON (Object o) =  \n   User &lt;$&gt;\n    o .: \"userId\"    &lt;*&gt;\n    o .: \"userName\"  &lt;*&gt;\n    o .: \"userEmail\" &lt;*&gt;\n    o .: \"userLevel\"\n--}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7452201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7MQyN.png?s=128&g=1", "display_name": "Carolyn Knight-Serrano", "link": "https://stackoverflow.com/users/7452201/carolyn-knight-serrano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 42713012, "answer_count": 1, "score": 0, "last_activity_date": 1489132154, "creation_date": 1489125612, "question_id": 42711313, "link": "https://stackoverflow.com/questions/42711313/using-a-custom-datatype-in-a-aeson-record", "title": "Using a custom datatype in a Aeson record", "body": "<p>Preface: I'm still quite a Haskell noob so forgive me if I'm missing something obvious. I'm trying to write aeson ToJSON and FromJSON instances for a record datatype with a field with a non-standard datatype (email address).</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE LambdaCase #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards #-}\n{-# LANGUAGE TypeOperators #-}\n\nmodule User where\n\nimport Control.Monad.Trans.Except\nimport Data.Aeson\nimport Data.ByteString.Char8 (pack)\nimport Data.Maybe\nimport GHC.Generics\nimport Servant\nimport Text.Email.Validate\n\ntype UserApi =\n  \"user\" :&gt; Get '[JSON] [User] :&lt;|&gt;\n  \"user\" :&gt; Capture \"userId\" Integer :&gt; Get '[JSON] User\n\nuserServer :: Server UserApi\nuserServer =\n  getUsers :&lt;|&gt;\n  getUserById\n\ngetUsers :: Handler [User]\ngetUsers = return [exampleUser]\n\ngetUserById :: Integer -&gt; Handler User\ngetUserById = \\ case\n  0 -&gt; return exampleUser\n  _ -&gt; throwE err404\n\nexampleUser :: User\nexampleUser = User 0 \"L. Smith\" (fromJust (emailAddress \"lsmith@example.com\")) Base\n\n-- * user info\ndata UserLevel = Base | Admin\n  deriving (Eq, Show, Generic)\n\ndata User\n  = User {\n    userId :: Integer,\n    userName :: String,\n    userEmail :: EmailAddress,\n    userLevel :: UserLevel\n  }\n  deriving (Eq, Show, Generic)\n\ninstance ToJSON User where\n    toJSON (User userId userName userEmail userLevel) =\n      object [\"userId\" .= userId, \"userName\" .= userName, \"userEmail\" .= show userEmail, \"userLevel\" .= show userLevel]\n\ninstance FromJSON User where\n  parseJSON = withObject \"user\" $ \\o -&gt; do\n    userId &lt;- o .: \"userId\"\n    userName &lt;- o .: \"userName\"\n    userEmail &lt;- do s &lt;- emailAddress (pack (o .: \"age\"))\n                    case s of\n                      Nothing -&gt; fail \"Invalid email address\"\n                      Just x -&gt; return x\n    userLevel &lt;- o .: \"userLevel\"\n    return User{..}\n</code></pre>\n\n<p>GHC outputs these errors:</p>\n\n<pre><code>/home/gigavinyl/Projects/ordermage/src/components/User.hs:59:26: error:\n    \u2022 Couldn't match type \u2018Maybe\u2019\n                     with \u2018aeson-0.11.2.1:Data.Aeson.Types.Internal.Parser\u2019\n      Expected type: aeson-0.11.2.1:Data.Aeson.Types.Internal.Parser\n                       EmailAddress\n        Actual type: Maybe EmailAddress\n    \u2022 In a stmt of a 'do' block: s &lt;- emailAddress (pack (o .: \"age\"))\n      In a stmt of a 'do' block:\n        userEmail &lt;- do { s &lt;- emailAddress (pack (o .: \"age\"));\n                          case s of {\n                            Nothing -&gt; fail \"Invalid email address\"\n                            Just x -&gt; return x } }\n      In the expression:\n        do { userId &lt;- o .: \"userId\";\n             userName &lt;- o .: \"userName\";\n             userEmail &lt;- do { s &lt;- emailAddress (pack (o .: \"age\"));\n                               case s of {\n                                 Nothing -&gt; ...\n                                 Just x -&gt; ... } };\n             userLevel &lt;- o .: \"userLevel\";\n             .... }\n\n/home/gigavinyl/Projects/ordermage/src/components/User.hs:59:46: error:\n    \u2022 Couldn't match type \u2018aeson-0.11.2.1:Data.Aeson.Types.Internal.Parser\n                             a0\u2019\n                     with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: aeson-0.11.2.1:Data.Aeson.Types.Internal.Parser a0\n    \u2022 In the first argument of \u2018pack\u2019, namely \u2018(o .: \"age\")\u2019\n      In the first argument of \u2018emailAddress\u2019, namely\n        \u2018(pack (o .: \"age\"))\u2019\n      In a stmt of a 'do' block: s &lt;- emailAddress (pack (o .: \"age\"))\n\n/home/gigavinyl/Projects/ordermage/src/components/User.hs:61:23: error:\n    \u2022 Couldn't match expected type \u2018EmailAddress\u2019\n                  with actual type \u2018Maybe t0\u2019\n    \u2022 In the pattern: Nothing\n      In a case alternative: Nothing -&gt; fail \"Invalid email address\"\n      In a stmt of a 'do' block:\n        case s of {\n          Nothing -&gt; fail \"Invalid email address\"\n          Just x -&gt; return x }\n\n/home/gigavinyl/Projects/ordermage/src/components/User.hs:62:23: error:\n    \u2022 Couldn't match expected type \u2018EmailAddress\u2019\n                  with actual type \u2018Maybe EmailAddress\u2019\n    \u2022 In the pattern: Just x\n      In a case alternative: Just x -&gt; return x\n      In a stmt of a 'do' block:\n        case s of {\n          Nothing -&gt; fail \"Invalid email address\"\n          Just x -&gt; return x }\n</code></pre>\n\n<p>How do I properly write these instances?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1489107231, "post_id": 42708132, "comment_id": 72538285, "body": "<code>nroot n x = x ** (1 &#47; n)</code>. Or, if you prefer: <code>nroot = flip (**) . recip</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489107246, "post_id": 42708132, "comment_id": 72538292, "body": "you can always use exponentiation with the reciprocal number - as <code>sqrt x = x^(1&#47;2)</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489107295, "post_id": 42708132, "comment_id": 72538306, "body": "damn you beat me @Alec - write that as an answer?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489107314, "post_id": 42708132, "comment_id": 72538315, "body": "@epsilonhalbe Beware of the three different exponentiation operators <code>**</code>, <code>^</code>, and <code>^^</code>!!"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489107437, "post_id": 42708132, "comment_id": 72538339, "body": "ah you are right - I was thinking in terms of mathematics and less &quot;haskell&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1560632919, "post_id": 42708306, "comment_id": 99802793, "body": "\u201cNote that the definition of an <code>n</code>th root is really just exponentiation by the reciprocal of <code>n</code>\u201d. Though this is <i>possible</i>, it&#39;s arguably not a very nice definition. In particular, it first requires you to define exponentiation with a rational number... but there&#39;s no direct way of doing this (without referring back to roots), you&#39;d need to define it first for <i>real</i> exponents by using an exponential/logarithm sandwich. No, mathematically, it actually makes sense to define \u207f\u221ay as the solution to y = x\u207f (which exists uniquely thanks to continuity and monotonicity)."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1560628450, "last_edit_date": 1560628450, "creation_date": 1489107600, "answer_id": 42708306, "question_id": 42708132, "link": "https://stackoverflow.com/questions/42708132/haskell-find-the-nth-root-of-a-float/42708306#42708306", "title": "Haskell: Find the nth root of a float", "body": "<p>Note that the definition of an <code>n</code>th root is really just exponentiation by the reciprocal of <code>n</code>. With that in mind, you are probably just best served writing <code>27 ** (1 / 3)</code> or <code>27 ** (recip 3)</code>. If you really want:</p>\n\n<pre><code>nroot :: (Integral a, Floating b) =&gt; a -&gt; b -&gt; b \nn `nroot` x = x ** (1 / fromIntegral n)\n</code></pre>\n\n<p>That said, beware of the <a href=\"https://stackoverflow.com/questions/40843813/converting-floating-to-integer/40843896#40843896\">three exponentiation operators that exist</a>! Only <code>**</code> works for you.</p>\n\n<hr>\n\n<p>I should probably add that <code>nroot :: (KnownTypeInt n, Floating a) =&gt; Proxy n -&gt; Quantity d a -&gt; Quantity (Root d n) a</code> is certainly <em>not</em> what you want. Note in particular that the root your are taking has to be a compile-time type level number.</p>\n"}], "owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2411, "favorite_count": 0, "accepted_answer_id": 42708306, "answer_count": 1, "score": 0, "last_activity_date": 1560628450, "creation_date": 1489106458, "question_id": 42708132, "link": "https://stackoverflow.com/questions/42708132/haskell-find-the-nth-root-of-a-float", "title": "Haskell: Find the nth root of a float", "body": "<p>Wondering if there's a way to compute the nth root of a float in Haskell.  I could try to write an algorithm but before I do, want to know if there's a module or canned function that I'm not finding.  I found this page:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/dimensional-1.0.1.0/docs/Numeric-Units-Dimensional.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/dimensional-1.0.1.0/docs/Numeric-Units-Dimensional.html</a></p>\n\n<p>which mentions an <code>nroot</code> function but can't tell how to get access to it.  It doesn't come in the standard library (when I try to run <code>nroot(3,27)</code> it tells me the function isn't in scope).  I tried importing Numeric.Units.Dimensional by entering <code>import Numeric.Units.Dimensional</code> but was told it couldn't find the module.  I may be misunderstanding how to load modules like this one.</p>\n"}, {"tags": ["loops", "haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489103518, "post_id": 42707591, "comment_id": 72537208, "body": "Is that the IO Monad you&#39;re using? That should be a pure function."}, {"owner": {"reputation": 149, "user_id": 5335302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/966601076714268/picture?type=large", "display_name": "user5335302", "link": "https://stackoverflow.com/users/5335302/user5335302"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489103753, "post_id": 42707591, "comment_id": 72537281, "body": "@Carcigenicate no i havenot used monad ? monad provides me the loop functionality directly??"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 3, "creation_date": 1489103839, "post_id": 42707591, "comment_id": 72537303, "body": "You&#39;re using <code>do</code> and <code>return</code>. What Monad is that for? Do you understand what <code>return</code> does in Haskell? It&#39;s <b>very</b> different from every other language. <code>return</code> is <b>not</b> used to return a value from a function."}, {"owner": {"reputation": 149, "user_id": 5335302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/966601076714268/picture?type=large", "display_name": "user5335302", "link": "https://stackoverflow.com/users/5335302/user5335302"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1489104834, "post_id": 42707591, "comment_id": 72537590, "body": "@nbro hope the question is clear now :)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489108880, "post_id": 42707591, "comment_id": 72538731, "body": "To flip the order of iteration, just swap <code>-- my stuff</code> and <code>repeatNTimes (n-1)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": false, "score": 1, "last_activity_date": 1489138442, "creation_date": 1489138442, "answer_id": 42714908, "question_id": 42707591, "link": "https://stackoverflow.com/questions/42707591/creating-a-for-loop-in-haskell/42714908#42714908", "title": "creating a for loop in Haskell", "body": "<p>You don't need loop when you have a list</p>\n\n<p>Use <code>map</code> and <code>mapM</code></p>\n\n<pre><code>isDivisible :: Int -&gt; Int -&gt; [String]\nisDivisible firstDivisor upperBound = map (isDivided firstDivisor) [1 .. upperBound]\n\nisDivided :: Int -&gt; Int -&gt; String\nisDivided 0 _ = \"Failed\"\nisDivided d x = if mod x d == 0\n                then \"Success\"\n                else \"Failed\"\n\nmain :: IO ()\nmain = do\n    input &lt;- getLine\n    let args = words input\n    let first_divisor = args !! 0\n    let upper_bound = args !! 1\n\n    let x = read first_divisor :: Int\n    let y = read upper_bound :: Int\n\n    let results = isDivisible  x y\n\n    mapM_ putStrLn results\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5335302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/966601076714268/picture?type=large", "display_name": "user5335302", "link": "https://stackoverflow.com/users/5335302/user5335302"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489138442, "creation_date": 1489102660, "last_edit_date": 1489104734, "question_id": 42707591, "link": "https://stackoverflow.com/questions/42707591/creating-a-for-loop-in-haskell", "title": "creating a for loop in Haskell", "body": "<p>I am learning functional programming Haskell. </p>\n\n<p>I have the requirement that I need to read an integer value and max value from the command line, and I need to determine if the integer value is in the range from <code>[1 to max value]</code>. I need to determine if any range's value is divided by the integer value. </p>\n\n<p>For example:</p>\n\n<pre><code>program 5 20\n</code></pre>\n\n<p>then I need to check if any value from <code>[1, 2, ..., 20]</code> is divisible by 5 in sorted order.</p>\n\n<p>How to write such function?</p>\n\n<p>I have read the argument as </p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    let first_divisor = args !! 0\n    let upper_bound = args !! 1\n\n    let x = read first_divisor :: Integer\n    let y = read upper_bound :: Integer\n\n\n    --print args\n    --putStrLn first_divisor\n    --putStrLn second_divisor\n    --putStrLn upper_bound\n    isDivisible  x y\n</code></pre>\n\n<p>I need to write this isDivisible function which loops from 1 to y and if rem of (1/x 2/x ....y/x), it prints success or failed.</p>\n\n<p>I have figured the loop as:</p>\n\n<pre><code>repeatNTimes 0  = return ()\nrepeatNTimes n  =\n do\n     -- my stuff\n\n  repeatNTimes (n-1) \n</code></pre>\n\n<p>However, this will iterate from n to 0, I want to iterate from 1 to 20.</p>\n\n<p>How can I do this in Haskell so that I can check my even odd value?</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1489102726, "post_id": 42707490, "comment_id": 72536934, "body": "You&#39;ll find some good information in the haskell tag&#39;s &quot;info&quot; section, one of which will point you to hoogle which you could use to answer your question"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1489102980, "post_id": 42707490, "comment_id": 72537035, "body": "Why do you think you have done it correctly for a single char? Have you tested it? You should be able to test it fairly easily by running <code>ghci nameofyourfile.hs</code> and then typing, say, <code>encodeChar &#39;a&#39; 5</code>"}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "edited": false, "score": 0, "creation_date": 1489103085, "post_id": 42707490, "comment_id": 72537064, "body": "Immibis, I have tested it and it seems to work. However, I get an error when just applying the map function like Alec suggested above.  *edit"}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "edited": false, "score": 0, "creation_date": 1489103416, "post_id": 42707490, "comment_id": 72537178, "body": "*edit - the code loaded without error when I opened the hs file but the function did not work itself. I apologise for the confusion, as I said before I only started coding this morning."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1489104512, "post_id": 42707490, "comment_id": 72537501, "body": "Oops! I&#39;m not surprised my comment didn&#39;t work - I&#39;m just surprised someone up voted it! <code>encode s y = map (`encodeChar` y) s</code> should though."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1489105769, "post_id": 42707490, "comment_id": 72537901, "body": "@SyedAhamed I don&#39;t think you have because your <code>encodeChar</code> only works for the letter x"}, {"owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1489137914, "post_id": 42707490, "comment_id": 72549777, "body": "@immibis could you please explain why my code only works for the letter x? How can I generalise this? And how could I apply this to a string?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1489139072, "post_id": 42707490, "comment_id": 72550553, "body": "@SyedAhamed Well you wrote <code>encodeChar &#39;x&#39; y = ...stuff...</code> which means that the stuff applies when the first argument is <code>&#39;x&#39;</code> (literally the letter x) and the second argument is <code>y</code> (which is a variable so it could be anything). Probably you meant <code>x</code> instead of <code>&#39;x&#39;</code>"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1489150161, "post_id": 42707490, "comment_id": 72557340, "body": "<a href=\"https://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself\" rel=\"nofollow noreferrer\">DRY</a>, If you have a function for an item, there usually be the way to apply function on collection of items. In this case it is <a href=\"https://www.stackage.org/haddock/lts-8.4/base-4.9.1.0/Prelude.html#v:map\" rel=\"nofollow noreferrer\">map</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1489136284, "creation_date": 1489136284, "answer_id": 42714171, "question_id": 42707490, "link": "https://stackoverflow.com/questions/42707490/how-can-i-convert-a-string-into-ascii-and-then-back-in-haskell/42714171#42714171", "title": "How can I convert a String into ASCII and then back in Haskell?", "body": "<p>To encode a string, an option is to proceed recursively. First, we choose how to encode the empty list <code>[]</code>. Then, assuming <code>encode xs y</code> does its job, we define what <code>encode (x:xs) y</code> should be. </p>\n\n<p>After some reflection we can see that <code>encode (x:xs) y</code> should be a string whose first character is the encoding of <code>x</code> using <code>y</code>, i.e. <code>encodeChar x y</code>, while the rest of the string (the tail) is the encoding of <code>xs</code> using <code>y</code>, i.e. the result of the recursive call.</p>\n\n<p>We then obtain:</p>\n\n<pre><code>encode :: String -&gt; Int -&gt; String\nencode []       y = []\nencode (x : xs) y = encodeChar x y : encode xs y\n</code></pre>\n\n<p>This kind of recursion is so common that there's a library function, <code>map</code>, which can perform it for us.</p>\n\n<p><code>map f [x1, .., xn]</code> returns <code>[f x1, .., f xn]</code>. Hence, we can map the <code>encodeChar</code> function over the whole string.</p>\n\n<pre><code>encode :: String -&gt; Int -&gt; String\nencode xs y = map (\\x -&gt; encodeChar x y) xs\n-- or, using more advanced functions\nencode xs y = map (flip encodeChar y) xs\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7687360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1407770822618320/picture?type=large", "display_name": "Syed Ahamed", "link": "https://stackoverflow.com/users/7687360/syed-ahamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 1, "accepted_answer_id": 42714171, "answer_count": 1, "score": 0, "last_activity_date": 1489136284, "creation_date": 1489102148, "last_edit_date": 1489102381, "question_id": 42707490, "link": "https://stackoverflow.com/questions/42707490/how-can-i-convert-a-string-into-ascii-and-then-back-in-haskell", "title": "How can I convert a String into ASCII and then back in Haskell?", "body": "<p>I am a beginner in Haskell (started this morning) and am trying to make a function to encrypt a string of characters by converting it to ASCII, adding a specified integer to the ASCII and then converting back into a String. I think I have correctly done this for a single character but I am stuck when it comes to the full String:</p>\n\n<pre><code>import Data.Char\n\nencodeChar :: Char -&gt; Int -&gt; Char\nencodeChar 'x' y = chr ((ord 'x') + y)\n\nencode :: String -&gt; Int -&gt; String\nencode (x : xs) y = chr ((ord (x : xs)) + y)\n</code></pre>\n"}, {"tags": ["json", "haskell", "serialization", "aeson"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1489106396, "post_id": 42707231, "comment_id": 72538075, "body": "If your attempt does not work - please describe what error/behaviour you are getting vs expecting"}], "answers": [{"comments": [{"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489108624, "post_id": 42708226, "comment_id": 72538653, "body": "This works, thanks! I Should probably ask another question, but still, can you explain how to use Alternative here? I mean if the string is <code>&quot;addTask&quot; </code> then return` addTask t` if it fails (for example it was <code>[&quot;removeTask&quot;, &quot;id&quot;]</code> try another parser etc. From the tutorials I probably can define a <code>Parser</code> that does so, but how to do that with this <code>parseJSON</code> - I&#39;m not sure."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489137131, "post_id": 42708226, "comment_id": 72549318, "body": "@user1685095 Updated"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1489137037, "last_edit_date": 1489137037, "creation_date": 1489107113, "answer_id": 42708226, "question_id": 42707231, "link": "https://stackoverflow.com/questions/42707231/how-to-parse-array-into-tuple-with-aeson/42708226#42708226", "title": "How to parse array into tuple with aeson?", "body": "<p>I would go on and parse the Array into a Tuple <code>(String,Task)</code> and then use simple pattern matching, you might need to specify the type of \"addTask\" if you are using <code>OverloadedStrings</code>, which can be done with <code>ScopedTypeVariables</code> (just add it to the left hand side of the <code>.. :: (String, Task) &lt;- parse..</code>).</p>\n\n<pre><code>instance FromJSON (Storage -&gt; Storage) where\n    parseJSON v = do (\"addTask\",t) &lt;- parseJSON v\n                     return $ addTask t\n</code></pre>\n\n<p>Note: I did not compile or test this code</p>\n\n<h2>Edit</h2>\n\n<p>Using alternative is really easy you just define two parsers and combine them</p>\n\n<pre><code>instance FromJSON (Storage -&gt; Storage) where\n    parseJSON v = let addP = do (\"addTask\",t) &lt;- parseJSON v\n                                return $ addTask t\n                      rmP = do (\"rmTask\",n) &lt;- parseJSON v\n                               return $ rmTask n\n                   in addP &lt;|&gt; rmP\n</code></pre>\n\n<p>I am assuming that <code>rmTask  :: Int -&gt; Change</code> otherwise cou can always <code>case</code> on the first element of the tuple.</p>\n"}], "owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 42708226, "answer_count": 1, "score": 1, "last_activity_date": 1489137037, "creation_date": 1489100792, "question_id": 42707231, "link": "https://stackoverflow.com/questions/42707231/how-to-parse-array-into-tuple-with-aeson", "title": "How to parse array into tuple with aeson?", "body": "<p>If I have an array <code>[\"addTask\", {\"id\": \"1\", \"description\": \"d\", \"dependsOn\": [], \"dependentTasks\": []}]</code>. </p>\n\n<pre><code>data Task = Task\n    { id :: String\n    , description :: String\n    , dependsOn :: [String]\n    , dependentTasks :: [String]\n    } deriving (Eq, Show, Generic, ToJSON, FromJSON)\ntype Change = Storage -&gt; Storage\naddTask :: Task -&gt; Change\naddTask (Task id desc dep dept) = insert id (Task id desc dep dept)\n</code></pre>\n\n<p>How can I create a parser that would produce a addTask from that?</p>\n\n<pre><code>instance FromJSON (Storage -&gt; Storage) where\n    parseJSON (Array v) = do\n        name &lt;- parseJSON $ v V.! 0 :: Just String\n        task &lt;- parseJSON $ v V.! 1 :: Just Task\n        return (addTask task)\n</code></pre>\n\n<p>This is my current attempt which doesn't work.</p>\n"}, {"tags": ["haskell", "memory-leaks", "hashtable"], "comments": [{"owner": {"reputation": 3943, "user_id": 1096710, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2eui8.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/1096710/chris"}, "edited": false, "score": 0, "creation_date": 1489096699, "post_id": 42705996, "comment_id": 72534362, "body": "Can you please list your imports? Which HashTable variant do you use and is Text strict or lazy?"}, {"owner": {"reputation": 3943, "user_id": 1096710, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2eui8.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/1096710/chris"}, "edited": false, "score": 0, "creation_date": 1489097565, "post_id": 42705996, "comment_id": 72534770, "body": "Also add the definition of <code>SexProbs</code> - unless the fields are strict, the <code>+1</code> will cause leaks."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1489102373, "post_id": 42705996, "comment_id": 72536807, "body": "How are you compiling?"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 0, "creation_date": 1489130545, "post_id": 42705996, "comment_id": 72545789, "body": "I am using CuckooHashTable from hashtables packages and strict Text. I omitted strictness annotation in SexProbs fields. Thank you for help."}], "answers": [{"tags": [], "owner": {"reputation": 3943, "user_id": 1096710, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2eui8.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/1096710/chris"}, "is_accepted": true, "score": 1, "last_activity_date": 1489144196, "creation_date": 1489144196, "answer_id": 42716950, "question_id": 42705996, "link": "https://stackoverflow.com/questions/42705996/memory-leak-while-using-text-keyed-hashtables/42716950#42716950", "title": "Memory leak while using text keyed hashtables", "body": "<p>The cause seems to be your <code>SexProbs</code> data type. It is probably defined with lazy fields, i.e. (assuming <code>Int</code> for the counters):</p>\n\n<pre><code>data SexProbs = SexProbs Int Int\n</code></pre>\n\n<p>Constructing a new value with <code>SexProbs (m+1) n</code> will <em>not</em> evaluate the addition, but place a thunk in heap memory. These accumulate and cause the space leak.</p>\n\n<p>To avoid this, force evaluation of the counters with <code>seq</code></p>\n\n<pre><code>let m' = m+1 in m' `seq` SexProbs m' n\n</code></pre>\n\n<p>or change your type definition to use strict fields:</p>\n\n<pre><code>data SexProbs = SexProbs !Int !Int\n</code></pre>\n"}], "owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 42716950, "answer_count": 1, "score": 0, "last_activity_date": 1489144196, "creation_date": 1489095721, "question_id": 42705996, "link": "https://stackoverflow.com/questions/42705996/memory-leak-while-using-text-keyed-hashtables", "title": "Memory leak while using text keyed hashtables", "body": "<p>I am writing Bayes naive classifier in Haskell using HashTable package. However when processing bigger corpus i have massive memory leak probably caused by big number of value updates. When loading already specified word counts it takes about 2GB of RAM, but when counting word occurances from corpus 8GB of ram is not enough and it just crashes. How can i prevent it? Code counting words looks like that:</p>\n\n<pre><code>chars :: T.Text\nchars = \"qwertyuiopasdfghjklzxcvbnm\u0119\u00f3\u0105\u015b\u0142\u017c\u017a\u0107\u0144\\t \"\n\nel :: Char -&gt; T.Text -&gt; Bool\nel = T.any . (==)\n\npreprocess :: T.Text -&gt; [T.Text]\npreprocess !line = T.words . T.map check . T.toLower $ line\n             where check !x = if x `el` chars then x else ' '\n\nloop :: Handle -&gt; Corpus -&gt; IO ()\nloop hdl dic =\n    hIsEOF hdl &gt;&gt;= \\x -&gt; if x\n        then return ()\n        else do\n          cl:dat &lt;- preprocess &lt;$&gt; TIO.hGetLine hdl\n          let ins !word =\n                        if (T.length word &lt;= 20) &amp;&amp; (T.length word &gt;= 4)\n                          then (H.lookup dic word &gt;&gt;=\n                                \\mprob -&gt; case mprob of\n                                   Just (SexProbs m f) -&gt; do\n                                     H.delete dic word\n                                     H.insert dic word $ if cl == \"m\" then SexProbs (m+1) f else SexProbs m (f+1)\n                                   Nothing -&gt; H.insert dic word $ if cl == \"m\" then SexProbs 1 0 else SexProbs 0 1)\n                          else return ()\n          mapM_ ins dat\n          loop hdl dic\n</code></pre>\n\n<p>Profiling suggest that the biggest source of allocation are preprocess and loop but i have no idea how to reduce memory usage.</p>\n"}, {"tags": ["haskell", "monad-transformers", "io-monad"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489092689, "post_id": 42702916, "comment_id": 72532250, "body": "This sounds like <a href=\"https://hackage.haskell.org/package/monad-unlift\" rel=\"nofollow noreferrer\"><i>monad-unlift</i></a> (cf. the readme there), except that I believe you would have to have your <code>ExceptT</code> layer swallowed (e.g. as <code>IO</code> exceptions) in order to use it."}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1489084342, "creation_date": 1489084342, "question_id": 42702916, "link": "https://stackoverflow.com/questions/42702916/logging-inside-a-forkio-catch-block", "title": "logging inside a forkIO/catch block", "body": "<p>I am building a servant app that generates reports using shake started by GETting a url. Up until the request to log stuff this has worked like a charm, but now I am hitting a problem.</p>\n\n<p>One handler <code>start</code> starts the generation of a report - since this might take quite some time - I return 200 immediately, and spawn a process to do the real work, logging is done by <a href=\"https://hackage.haskell.org/package/logging-effect\" rel=\"nofollow noreferrer\"><code>logging-effect</code></a>.</p>\n\n<p>A simplified version of my <code>start</code> handler looks like this</p>\n\n<pre><code>start :: IO () -&gt; App ()\nstart mkReport = do\n  logInfo $ PP.text \"Report generation started\"\n  _ &lt;- liftIO . forkIO $ catch mkReport caught\n  where caught e =  do logError $ PP.text \"Report generation crashed: \" &lt;&gt;\n                     {-^^^^^^^-} (PP.text . T.pack $ displayException e)\n                       cleanup\n  return ()\n</code></pre>\n\n<p><code>App</code> is an instance of <code>MonadLog (WithTimestamp (WithSeverity Doc))</code> - so <code>logInfo</code> works fine. \u2714</p>\n\n<p>To be precise <code>App</code> is the following newtype: </p>\n\n<pre><code>newtype App a =\n    App { _runApp :: ReaderT Environment (ExceptT ServantErr\n                     (LoggingT (WithTimestamp (WithSeverity Doc)) IO)) a\n        } deriving ( Functor, Applicative, Monad, MonadReader Environment,\n                   , MonadError ServantErr, MonadLog (WithTimestamp (WithSeverity Doc)))\n</code></pre>\n\n<p>But when I try to call <code>logError</code> inside the <code>caught</code> part - alongside the <code>cleanup</code> action which removes generated/temporary files I get a compiler error. \u2718</p>\n\n<pre><code>No instance for MonadLog (WithSeverity Doc) IO arising from a use of 'logError'...\n</code></pre>\n\n<p>And this is correct there is no such instance for <code>IO</code>, thank you ghc for telling me that and not crashing at runtime!</p>\n\n<p>These are the thoughts I am going through - maybe someone sees a false assumption:</p>\n\n<ul>\n<li>I have to use <code>forkIO</code> to fork the report generation?</li>\n<li>If there was something that works like <code>forkIOish :: MonadIO m =&gt; m () -&gt; m ThreadId</code> and <code>catchIsh :: (MonadIO m, Exception e) =&gt; m a -&gt; (e -&gt; m a) -&gt; m a</code>   would it help me? - I think yes - I could <code>liftIO</code> the cleanup and the mkReport part while calling <code>logError</code> inside <code>App</code> in my case.</li>\n<li>Is there a way to \"unlift\" properties of the monad transformer stack in the lifted parts?</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489087071, "post_id": 42702618, "comment_id": 72529462, "body": "There are many options. You could use <code>span</code> and explicit recursion to slice the &quot;errors&quot; section. Or you might want <code>groupBy</code> to roughly group your list as <code>[[param1],[err1,err2,err3],[param2],[err4],[param3]]</code> and then do more processing afterwards to sort that as wanted."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1489093693, "post_id": 42702618, "comment_id": 72532861, "body": "You should look at using a parsing library for this, for example <a href=\"https://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec.html\" rel=\"nofollow noreferrer\">Parsec</a> makes this kind of work a breeze"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1489151216, "post_id": 42702618, "comment_id": 72558016, "body": "This have some similarity with my question on Code Review, you might want to check <a href=\"http://codereview.stackexchange.com/questions/147874/kattis-speed-limit-read-irregular-input\">there</a>."}, {"owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "edited": false, "score": 0, "creation_date": 1489223540, "post_id": 42702618, "comment_id": 72585241, "body": "Thanks you everyone for your help !"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "edited": false, "score": 0, "creation_date": 1489224371, "post_id": 42714635, "comment_id": 72585436, "body": "I did not know the CIS194, which seems very interesting. Thanks for the code and for the link!"}, {"owner": {"reputation": 138, "user_id": 1544008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c56aae0ef5e0981403733f7f248c1f?s=128&d=identicon&r=PG", "display_name": "ArthurVard", "link": "https://stackoverflow.com/users/1544008/arthurvard"}, "reply_to_user": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "edited": false, "score": 0, "creation_date": 1489811476, "post_id": 42714635, "comment_id": 72846661, "body": "could you mark answer as useful or vote for that answer :)"}], "tags": [], "owner": {"reputation": 138, "user_id": 1544008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c56aae0ef5e0981403733f7f248c1f?s=128&d=identicon&r=PG", "display_name": "ArthurVard", "link": "https://stackoverflow.com/users/1544008/arthurvard"}, "is_accepted": true, "score": 1, "last_activity_date": 1539062991, "last_edit_date": 1539062991, "creation_date": 1489137732, "answer_id": 42714635, "question_id": 42702618, "link": "https://stackoverflow.com/questions/42702618/parsing-a-log-file-in-haskell/42714635#42714635", "title": "Parsing a log file in Haskell", "body": "<p>I modified my solution of <a href=\"http://www.cis.upenn.edu/~cis194/spring13/lectures.html\" rel=\"nofollow noreferrer\">CIS194</a>(Week 2). \n<br>Converting to binary Tree data structure and lazy reading from file will be good exercises for learning. </p>\n\n<pre><code>type Name = String\ntype Count = Int\ndata MessageType =  Param Name Count\n                 | Error String\n                 | Unknown String\n                   deriving (Show, Eq)\n\nparseMessage :: String -&gt; MessageType\nparseMessage line =\n    case  words line of\n      (\"parameter\":n:_:c:_) -&gt; Param n (read c)\n      (\"error\":msg)         -&gt; Error (unwords msg)\n      xs                    -&gt; Unknown $ unwords xs\n\ndata LogMessage = LogMessage Name Count [MessageType]\n               deriving (Show, Eq)\n\nparse :: String -&gt; [MessageType]\nparse = map parseMessage .  lines\n\nisError :: MessageType -&gt; Bool\nisError (Error _) = True\nisError _ = False\n\n\nisUnknown :: MessageType -&gt; Bool\nisUnknown  (Unknown _)  = True\nisUnknown _ = False\n\n(.||.) :: (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; (a -&gt; Bool)\n(.||.) f g a = (f a) || (g a)\n\ntoLogMsg :: [MessageType] -&gt; [LogMessage]\ntoLogMsg [] = []\ntoLogMsg (x:xs) =\n    case x of\n      Param n c -&gt;\n          LogMessage n c (takeWhile isError xs) : toLogMsg (dropWhile (isError .||. isUnknown) xs)\n      _         -&gt; toLogMsg $ dropWhile (isError .||. isUnknown) xs\n\n\n\nerrMsgList :: [MessageType] -&gt; [String]\nerrMsgList = foldr (\\(Error m) acc -&gt; m : acc) []\n\ntoTriple :: [LogMessage] -&gt; [(String, Count, [String])]\ntoTriple = foldl(\\acc (LogMessage n c xs) -&gt; (n, c, errMsgList xs) : acc) []\n\n\n\nmain :: IO ()\nmain = do\n       ts &lt;- toLogMsg . parse &lt;$&gt; readFile \"./src/2017/so-log.txt\"\n       mapM_ print ts\n       mapM_ print (toTriple ts)\n</code></pre>\n\n<p>Output of the sample you provide will be:</p>\n\n<pre><code>(\"an_other_parameter_name\",7,[\"bla bla1\",\"bla bla2\",\"bla bla3\",\"bla bla4\",\"bla bla5\",\"bla bla6\",\"bla bla7\"])\n(\"a_parameter_name\",5,[\"bla bla1\",\"bla bla2\",\"bla bla bla3\",\"bla bla bla4\",\"bla bla bla5\"])\n\n\nLogTriple \"a_parameter_name\" 5 [Error \"bla bla1\",Error \"bla bla2\",Error \"bla bla bla3\",Error \"bla bla bla4\",Error \"bla bla bla5\"]\nLogTriple \"an_other_parameter_name\" 7 [Error \"bla bla1\",Error \"bla bla2\",Error \"bla bla3\",Error \"bla bla4\",Error \"bla bla5\",Error \"bla bla6\",Error \"bla bla7\"]\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 42714635, "answer_count": 1, "score": 0, "last_activity_date": 1539062991, "creation_date": 1489083340, "question_id": 42702618, "link": "https://stackoverflow.com/questions/42702618/parsing-a-log-file-in-haskell", "title": "Parsing a log file in Haskell", "body": "<p>I need to parse a huge log file. And I would like to do it in Haskell for learning purpose (I am a beginner).\nThe layout of the log file is something like:</p>\n\n<pre><code>parameter a_parameter_name errors: 5\nerror bla bla1\nerror bla bla2\nerror bla bla bla3\nerror bla bla bla4\nerror bla bla bla5\nsome garbage line\nparameter an_other_parameter_name errors: 7\nerror bla bla1\nerror bla bla2\nerror bla bla3\nerror bla bla4\nerror bla bla5\nerror bla bla6\nerror bla bla7\n\nsome garbage line\nsome garbage line\nsome garbage line\n...\n</code></pre>\n\n<p>This log file contains 2 main line types:</p>\n\n<ol>\n<li>lines starting by \"parameter\";</li>\n<li>lines starting by \"error\".</li>\n</ol>\n\n<p>The \"error\" lines are related to the previous parameter line.\nThe other lines are not interesting.</p>\n\n<p>What I would like to do is to print out the parameters and their errors, ordered by the number of errors. So here I would like to get:</p>\n\n<pre><code>parameter an_other_parameter_name errors: 7\nerror bla bla1\nerror bla bla2\nerror bla bla3\nerror bla bla4\nerror bla bla5\nerror bla bla6\nerror bla bla7\nparameter a_parameter_name errors: 5\nerror bla bla1\nerror bla bla2\nerror bla bla bla3\nerror bla bla bla4\nerror bla bla bla5\n</code></pre>\n\n<p>With the following code, I get the list of interesting lines</p>\n\n<pre><code>import System.IO\nimport Data.List\n\ninteresting :: String -&gt; Bool\ninteresting s = isPrefixOf \"parameter\" s || isPrefixOf \"error\" s\n\nmain = do\n    logFile &lt;- openFile \"log.txt\" ReadMode\n    contents &lt;- hGetContents logFile\n    let interestingLines = filter interesting $ lines contents\n    print interestingLines\n    hClose logFile\n</code></pre>\n\n<p>From this list, I would like to construct a list of triples:\n[(parameter, errorsNb, [errors])], which I can sort and print out.\nBut I have no idea on how to group the error lines with their related parameter line. But perhaps it is not the correct approach ...\nAny help is welcome !</p>\n\n<p>Olivier</p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"comments": [{"owner": {"reputation": 2207, "user_id": 575152, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5e0170ce985a52a6af02b95baa38e1ae?s=128&d=identicon&r=PG", "display_name": "Savanni D&#39;Gerinel", "link": "https://stackoverflow.com/users/575152/savanni-dgerinel"}, "edited": false, "score": 0, "creation_date": 1489083084, "post_id": 42702399, "comment_id": 72527050, "body": "Oh, good point. I&#39;ve been conflating workflow with data type, and that&#39;s really not correct."}], "tags": [], "owner": {"reputation": 1485, "user_id": 306320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a40f031a3f886de3e4e5ad39dea0aa?s=128&d=identicon&r=PG", "display_name": "aredridel", "link": "https://stackoverflow.com/users/306320/aredridel"}, "is_accepted": true, "score": 1, "last_activity_date": 1489082621, "creation_date": 1489082621, "answer_id": 42702399, "question_id": 42702300, "link": "https://stackoverflow.com/questions/42702300/in-servant-how-can-i-select-my-exception-based-on-accept-header/42702399#42702399", "title": "In servant, how can I select my exception based on Accept header?", "body": "<p>Not exactly answering what you asked, but in the greater picture, this sounds like a use-case for two separate routes, with a common bit of implementation shared between them.</p>\n"}], "owner": {"reputation": 2207, "user_id": 575152, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5e0170ce985a52a6af02b95baa38e1ae?s=128&d=identicon&r=PG", "display_name": "Savanni D&#39;Gerinel", "link": "https://stackoverflow.com/users/575152/savanni-dgerinel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 42702399, "answer_count": 1, "score": 1, "last_activity_date": 1489082621, "creation_date": 1489082218, "question_id": 42702300, "link": "https://stackoverflow.com/questions/42702300/in-servant-how-can-i-select-my-exception-based-on-accept-header", "title": "In servant, how can I select my exception based on Accept header?", "body": "<p>For context, this is an authentication situation. In my application, if the client is not authenticated, then the app obviously needs to respond appropriately. The challenge comes up when I want to choose a different response based on the type of application calling into the server.</p>\n\n<p>Here is an example of a route:</p>\n\n<pre><code>server =    Header \"Cookie\" (AuthToken Unverified)\n         :&gt; \"api\" :&gt; \"history\" :&gt; Get '[HTML, JSON] HistoryPage\n</code></pre>\n\n<p>So, an HTML response would be for a CGI app. In general, it should either render an authentication page, or it should throw a 303 to direct the user to an authentication page.</p>\n\n<p>But a JSON response would be for a Javascript app, and there I want to simply return a 404, because the Javascript would have other ways of doing authentication.</p>\n\n<p>Here is my top-level handler:</p>\n\n<pre><code>newtype WebM a = WebM (ReaderT Context (ExceptT WebExc IO) a)\ndata WebExc = OtherExceptionTypes\n            | AppUnauthorized\n\nrunWeb :: Context -&gt; WebM :~&gt; Handler\nrunWeb ctx@Context{..} = Nat $ \\(WebM action) -&gt; withExceptT trExc $ runReaderT action ctx\n  where\n    trExc :: WebExc -&gt; ServantErr\n    trExc AppUnauthorized = err303 { .. }\n</code></pre>\n\n<p>I've tried creating my own Javascript content-type, but the MimeRenderer doesn't allow me to throw exceptions. The only idea I have so far is to capture the \"Accept\" header and throw either <code>303</code> or <code>404</code> from within the handler. But that is gross because the handler isn't supposed to know anything about the actual client app.</p>\n\n<p>Is there any cleaner way to handle this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1489084207, "post_id": 42702210, "comment_id": 72527682, "body": "Always use explicit type signatures, please."}, {"owner": {"reputation": 822, "user_id": 1281470, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5bf7fa14eee8258850f67fdb02e05c46?s=128&d=identicon&r=PG", "display_name": "FrankBr", "link": "https://stackoverflow.com/users/1281470/frankbr"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489085371, "post_id": 42702210, "comment_id": 72528404, "body": "What does it mean? Got it. I expect a function like this: Num t =&gt; (a, t) -&gt; (a, t) -&gt; [(a, t)]"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489086054, "post_id": 42702210, "comment_id": 72528852, "body": "Aha. That seems strange though, why would you call an <code>(a,t)</code> argument <code>lst</code>? I think you mean <code>(a,t) -&gt; [(a,t)] -&gt; [(a,t)]</code>. Anyway, please edit the signature into the question, and update the error message accordingly..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489086326, "post_id": 42702210, "comment_id": 72528993, "body": "You probably need <code>(== fst element).fst</code> instead of <code>(==element).fst</code>, since <code>element</code> is a pair. Explicitly adding types would help spotting this."}, {"owner": {"reputation": 822, "user_id": 1281470, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5bf7fa14eee8258850f67fdb02e05c46?s=128&d=identicon&r=PG", "display_name": "FrankBr", "link": "https://stackoverflow.com/users/1281470/frankbr"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489091882, "post_id": 42702210, "comment_id": 72531806, "body": "@leftaroundabout you&#39;re right. Edited question."}], "answers": [{"comments": [{"owner": {"reputation": 822, "user_id": 1281470, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5bf7fa14eee8258850f67fdb02e05c46?s=128&d=identicon&r=PG", "display_name": "FrankBr", "link": "https://stackoverflow.com/users/1281470/frankbr"}, "edited": false, "score": 0, "creation_date": 1489095963, "post_id": 42705940, "comment_id": 72534015, "body": "Thanks for nice explanation. Using pattern matching is much more ele"}, {"owner": {"reputation": 822, "user_id": 1281470, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5bf7fa14eee8258850f67fdb02e05c46?s=128&d=identicon&r=PG", "display_name": "FrankBr", "link": "https://stackoverflow.com/users/1281470/frankbr"}, "edited": false, "score": 0, "creation_date": 1489096306, "post_id": 42705940, "comment_id": 72534165, "body": "Thanks for nice explanation. I got the error I committed and understood how elegant is pattern matching in this case. And now I noticed that the function itself is wrong since I need to update the list with the tuple it it exists already instead of adding it again.  Thanks!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1489095559, "creation_date": 1489095559, "answer_id": 42705940, "question_id": 42702210, "link": "https://stackoverflow.com/questions/42702210/guards-and-where-haskell/42705940#42705940", "title": "Guards and where haskell", "body": "<p>The reason for that particular error is that <code>element</code> contains both a key and a value, but by <code>(==element) . fst</code> you try to compare only the key.</p>\n\n<p>The best way to actually get only at the key is to pattern match it right in the function argument. Note that you don't really need the <code>element</code> variable at all, nor the other arguments to the local functions:</p>\n\n<pre><code>update (key,y) lst\n  | hasElement  = addElement   -- comparing `==True` is a no-op!\n  | otherwise   = lst\n where hasElement = not . null $ filter ((==key).fst) lst\n       addElement = (key, y+1) : b\n</code></pre>\n\n<p>I'd question though if this behaviour of <code>addElement</code> is really what you want: you're not updating the existing element with a given key, but adding a new element with the same key?</p>\n\n<p>Also, the combination of <code>not</code>, <code>null</code> and <code>filter</code> is needlessly complicated. You can just use</p>\n\n<pre><code>       hasElement = any ((==key).fst) lst\n</code></pre>\n\n<p>Finally, the signature <code>Num a =&gt; ...</code> is actually not strong enough: you're comparing keys with <code>==</code>. That only works if the keys have an <code>Eq</code> instance. So, this is the correct signature:</p>\n\n<pre><code>(Eq a, Num t) =&gt; (a, t) -&gt; [(a, t)] -&gt; [(a, t)]\n</code></pre>\n"}], "owner": {"reputation": 822, "user_id": 1281470, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5bf7fa14eee8258850f67fdb02e05c46?s=128&d=identicon&r=PG", "display_name": "FrankBr", "link": "https://stackoverflow.com/users/1281470/frankbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 42705940, "answer_count": 1, "score": 0, "last_activity_date": 1489095559, "creation_date": 1489081897, "last_edit_date": 1489091836, "question_id": 42702210, "link": "https://stackoverflow.com/questions/42702210/guards-and-where-haskell", "title": "Guards and where haskell", "body": "<p>I have a very basic Haskell function. \nIt should prepend a tuple to list if not present returning it.\nAdded tuple needs to be edited before prepending.</p>\n\n<p>I expect a function whose type is this:</p>\n\n<pre><code>Num t =&gt; (a, t) -&gt; [(a, t)] -&gt; [(a, t)]\n</code></pre>\n\n<p>Function is this:</p>\n\n<pre><code>update x lst\n| hasElement x lst == True = addElement x lst\n| otherwise = lst\nwhere hasElement element list = not (null (filter ((==element).fst) list))\n      addElement a b = (fst a, (snd a) +1) : b\n</code></pre>\n\n<p>but I got an error when I try to load the module:</p>\n\n<pre><code>\u2022 Occurs check: cannot construct the infinite type: a ~ (a, t)\n  Expected type: [(a, t)]\n    Actual type: [((a, t), t)]\n\u2022 In the second argument of \u2018addElement\u2019, namely \u2018lst\u2019\n  In the expression: addElement x lst\n  In an equation for \u2018update\u2019:\n      update x lst\n        | hasElement x lst == True = addElement x lst\n        | otherwise = lst\n        where\n            hasElement element list\n              = not (null (filter ((== element) . fst) list))\n            addElement a b = (fst a, (snd a) + 1) : b\n\u2022 Relevant bindings include\n    lst :: [((a, t), t)] (bound at pip.hs:40:10)\n    x :: (a, t) (bound at pip.hs:40:8)\n    update :: (a, t) -&gt; [((a, t), t)] -&gt; [(a, t)]\n      (bound at pip.hs:40:1)\n</code></pre>\n\n<p>The <em>addElement</em> return type seems breaks all up since commenting it out makes the module work.</p>\n\n<p>Question is: what's wrong?\nTrying function alone seems working as I expect.</p>\n\n<p>Thanks, \nFB </p>\n"}, {"tags": ["json", "haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489081468, "post_id": 42701878, "comment_id": 72526142, "body": "You cannot <code>show</code> or serialize or compare or scrutinise functions."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489081616, "post_id": 42701878, "comment_id": 72526233, "body": "@n.m Hmm... Well I obviously can serialize a function application and deserialize by hand, right? So why this should be impossible  to do automatically? This is rather mechanic... You have a function name, you have it&#39;s arguments you know their types..."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489081879, "post_id": 42701878, "comment_id": 72526400, "body": "@n.m. You can&#39;t <code>show</code> function because of referential transparency etc. And what I want doesn&#39;t have to do anything with it. I want to see function name and it&#39;s arguments, that&#39;s all."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1489082107, "post_id": 42701878, "comment_id": 72526512, "body": "To be specific, you can serialize <code>1+1</code>, which is just <code>2</code>, but neither <code>(+)</code> nor <code>(+ 1)</code> which are both functions. <code>2</code> is not related to the type of either of these functions in any way."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489082210, "post_id": 42701878, "comment_id": 72526569, "body": "If you want to see a function name, serialize a name (a string). You cannot get a function name out of the function itself."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489082562, "post_id": 42701878, "comment_id": 72526747, "body": "@n.m. Okay, see my edit."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489084425, "post_id": 42701878, "comment_id": 72527815, "body": "Of course you can return some constant value as the result of <code>show somefunction</code>, such as <code>&quot;&lt;function&gt;&quot;</code> (the same for all functions) but this doesn&#39;t seem to be what you want. This constant string may be different for different function types and include some information about its inputs and outputs, such as their types. However you cannot serialize two different functions of the same type to two different strings."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489085970, "post_id": 42701878, "comment_id": 72528806, "body": "@n.m. &quot;You cannot serialize two different functions of the same type to two different strings&quot; is of course false (though admittedly rarely usefully so). But the real problem is that you cannot serialize two identical functions to two different strings; see my answer for details about why that causes a problem."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489090126, "post_id": 42701878, "comment_id": 72531100, "body": "@DanielWagner can you show <code>s:: (Integer-&gt;Integer)-&gt;String</code> such that <code>f == g</code> is equivalent to <code>s f == s g</code>? Your functions <code>foo</code> and <code>bar</code> could in principle be both serialized to <code>&quot;\\y-&gt;8+y&quot;</code> or equivalent, don&#39;t see a problem here."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489094585, "post_id": 42701878, "comment_id": 72533297, "body": "@n.m. &quot;Can you write <code>s :: (Integer -&gt; Integer) -&gt; String</code>?&quot; I think no with existing technology. &quot;You could serialize to <code>&quot;\\y-&gt;8+y&quot;</code>.&quot; I think a serious answer to this requires some deeper thought. What you can do depends a lot on your equational theory. Each additional equation requires additional normalization. Alpha equivalence requires a canonical choice for names in lambdas; beta equivalence requires evaluating before showing; you might want equations like <code>let x = foo; y = bar in x === let y = bar; x = foo in x</code> which would require a canonical <code>let</code> ordering (and naming!), etc."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1489097481, "post_id": 42701878, "comment_id": 72534740, "body": "<code>allIntegers = [0..]; serializeMe f = fmap f allIntegers</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1489127961, "post_id": 42701878, "comment_id": 72544538, "body": "@user2297560 yeah, I should have said finite string, infinite strings are not very practical to store."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489128059, "post_id": 42701878, "comment_id": 72544590, "body": "@DanielWagner of course <code>&quot;\\y-&gt;8+y&quot;</code> is not really doable with any technology, but at least there&#39;s no problem with referential transparency."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489182568, "post_id": 42701878, "comment_id": 72576160, "body": "@n.m. As I alluded to in my response last time you suggested it: referential transparency (or delta equivalence) is just one of many equational laws that Haskell respects. I don&#39;t know how much effort would be required to create something that respects all of the equational laws that people routinely rely on; though I&#39;d be just as interested as you to see a thorough treatment of this idea."}], "answers": [{"comments": [{"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489081876, "post_id": 42702173, "comment_id": 72526398, "body": "Yeah, that&#39;s an obvious solution, which I don&#39;t want. eval is just <code>apply</code>. I don&#39;t see why do I need this boilerplate code."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 3, "creation_date": 1489082057, "post_id": 42702173, "comment_id": 72526487, "body": "Call me crazy, but I prefer boilerplate over complicated one-off magical solutions. This is explicit and easy to understand."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489082163, "post_id": 42702173, "comment_id": 72526545, "body": "@user1685095 &quot;I don&#39;t see why do I need this boilerplate code&quot; -- Because you can&#39;t serialise a function, but you can serialise a suitable materialised representation of what it does."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489082177, "post_id": 42702173, "comment_id": 72526553, "body": "@user2297560. I don&#39;t see anything magical in serializing function object (and function in haskell is object, right? It&#39;s called Arrow or something like that)."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489082252, "post_id": 42702173, "comment_id": 72526589, "body": "@duplode Yeah, okay. Why can&#39;t I serialize function object? It has a type right? It&#39;s called Arrow or something like that, right? Why function object should be different from any other object?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489083190, "post_id": 42702173, "comment_id": 72527107, "body": "@user1685095 Showing some extra information about the function and its inputs and outputs is not the same as serialising it. Cf. <a href=\"http://stackoverflow.com/q/17785916/2751851\"><i>Can Haskell functions be serialized?</i></a>"}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489083300, "post_id": 42702173, "comment_id": 72527164, "body": "Yeah, okay. Can show function name and arguments that it&#39;s currently applied to?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489083369, "post_id": 42702173, "comment_id": 72527194, "body": "@user1685095 The question is what do you do with the function name once you deserialise it."}], "tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 2, "last_activity_date": 1489081819, "creation_date": 1489081819, "answer_id": 42702173, "question_id": 42701878, "link": "https://stackoverflow.com/questions/42701878/how-to-serialize-function-type-to-json-in-haskell/42702173#42702173", "title": "How to serialize function type to json in haskell?", "body": "<p>Make a data type for your functions and an evaluation function:</p>\n\n<pre><code>data TaskFunction = AddTask Task | RemoveTask String \n  deriving (Eq, Show, Generic, ToJSON, FromJSON)\n\neval :: TaskFunction -&gt; Storage -&gt; Storage\neval (AddTask t) = addTask t\neval (RemoveTask t) = removeTask t\n\nchanges = [AddTask (Task \"1\" \"Description\" [] []), RemoveTask \"1\"]\n\nmain = putStrLn . show $ foldl (\\s c -&gt; c s) s (eval &lt;$&gt; changes)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489085157, "post_id": 42702923, "comment_id": 72528261, "body": "I&#39;m sure my <code>Typeable</code> instance exists somewhere on Hackage. If somebody knows, please leave me a comment or go ahead and replace my example instance with a link to it directly."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489090971, "post_id": 42702923, "comment_id": 72531542, "body": "Thanks for the explanation, but maybe avoiding boilerplate is possible with template Haskell? If so, than how to do that with aeson?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489094721, "post_id": 42702923, "comment_id": 72533366, "body": "@user1685095 I encourage you to give it a shot and open a fresh question detailing where you get stuck. I also encourage you to carefully read through my links to make sure you don&#39;t duplicate work others have done already."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489128424, "post_id": 42702923, "comment_id": 72544757, "body": "Look, my question is specific. <a href=\"http://stackoverflow.com/q/42707231/1685095\">stackoverflow.com/q/42707231/1685095</a> why can&#39;t the approach from this answer be automated? With template Haskell or something. This should be possible."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489164341, "post_id": 42702923, "comment_id": 72566763, "body": "@user1685095 I&#39;m sorry you&#39;re frustrated. I understand that you think you have asked your question several times; but please accept that small variations in a question can lead to big variations in the correct answer, and that as a beginner it is not necessarily possible to predict when that will happen."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489164360, "post_id": 42702923, "comment_id": 72566782, "body": "@user1685095 Also, you seem to be under the mistaken impression that we will write your code for you with no effort on your part. That is a rude assumption on your part. If you want to explore using Template Haskell for this, great. We will help. But you have to put in a good faith effort yourself first and come to us prepared with a targeted, specific stumbling block."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1489165693, "post_id": 42702923, "comment_id": 72567636, "body": "I just thought that if serialization data types is this simple maybe template Haskell approach is also easy. About effort -&gt; I know basics about Haskell, monads etc, but things like Typable, Generics is very new to me. I have a specific problem to solve and I thought that I could learn by example from you guys instead of diving deep into all this right now."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1489086163, "last_edit_date": 1489086163, "creation_date": 1489084375, "answer_id": 42702923, "question_id": 42701878, "link": "https://stackoverflow.com/questions/42701878/how-to-serialize-function-type-to-json-in-haskell/42702923#42702923", "title": "How to serialize function type to json in haskell?", "body": "<p>Reading between the lines a bit, a recurring question here is, \"Why can't I serialize a function (easily)?\" The answer -- which several people have mentioned, but not explained clearly -- is that Haskell is dedicated to referential transparency. Referential transparency says that you can replace a definition with its defined value (and vice versa) without changing the meaning of the program.</p>\n\n<p>So now, let's suppose we had a hypothetical <code>serializeFunction</code>, which in the presence of this code:</p>\n\n<pre><code>foo x y = x + y + 3\n</code></pre>\n\n<p>Would have this behavior:</p>\n\n<pre><code>&gt; serializeFunction (foo 5)\n\"foo 5\"\n</code></pre>\n\n<p>I guess you wouldn't object too strenuously if I also claimed that in the presence of</p>\n\n<pre><code>bar x y = x + y + 3\n</code></pre>\n\n<p>we would \"want\" this behavior:</p>\n\n<pre><code>&gt; serializeFunction (bar 5)\n\"bar 5\"\n</code></pre>\n\n<p>And now we have a problem, because by referential transparency</p>\n\n<pre><code>  serializeFunction (foo 5)\n= { definition of foo }\n  serializeFunction (\\y -&gt; 5 + y + 3)\n= { definition of bar }\n  serializeFunction (bar 5)\n</code></pre>\n\n<p>but <code>\"foo 5\"</code> does not equal <code>\"bar 5\"</code>.</p>\n\n<p>The obvious followup question is: why do we demand referential transparency? There are at least two good reasons: first, it allows equational reasoning like above, hence eases the burden of refactoring; and second, it reduces the amount of runtime information that's needed, hence improving performance.</p>\n\n<p>Of course, if you can come up with a representation of functions that respects referential transparency, that poses no problems. Here are some ideas in that direction:</p>\n\n<ul>\n<li><p>printing the type of the function </p>\n\n<pre><code>instance (Typeable a, Typeable b) =&gt; Show (a -&gt; b) where\n    show = show . typeOf\n-- can only write a Read instance for trivial functions\n</code></pre></li>\n<li><p><a href=\"http://hackage.haskell.org/package/universe-reverse-instances-1.0/docs/src/Data-Universe-Instances-Show.html\" rel=\"nofollow noreferrer\">printing the input-output behavior</a> of the function (which can also <a href=\"http://hackage.haskell.org/package/universe-reverse-instances-1.0/docs/src/Data-Universe-Instances-Read.html\" rel=\"nofollow noreferrer\">be read back in</a>)</p></li>\n<li><p>creating a data type that combines a function with its name, and then printing that name</p>\n\n<pre><code>data Named a = Named String a\ninstance Show (Named a) where\n    show (Named n _) = n\n-- perhaps you could write an instance Read (Map String a -&gt; Named a)\n</code></pre>\n\n<p>(and see also <a href=\"http://hackage.haskell.org/package/distributed-process\" rel=\"nofollow noreferrer\">cloud haskell</a> for a more complete working of this idea)</p></li>\n<li><p>constructing an algebraic data type that can represent all the expressions you care about but contains only basic types that already have a <code>Show</code> instance and serializing that (e.g. as described in the other answer)</p></li>\n</ul>\n\n<p>But printing a bare function's name is in conflict with referential transparency.</p>\n"}], "owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489090916, "creation_date": 1489080819, "last_edit_date": 1592644375, "question_id": 42701878, "link": "https://stackoverflow.com/questions/42701878/how-to-serialize-function-type-to-json-in-haskell", "title": "How to serialize function type to json in haskell?", "body": "<pre><code>data Task = Task\n    { id :: String\n    , description :: String\n    , dependsOn :: [String]\n    , dependentTasks :: [String]\n    } deriving (Eq, Show, Generic, ToJSON, FromJSON)\n\ntype Storage = Map String Task\n\ns :: Storage\ns = empty\n\naddTask :: Task -&gt; Storage -&gt; Storage\naddTask (Task id desc dep dept) = insert id (Task id desc dep dept)\n\nremoveTask :: String -&gt; Storage -&gt; Storage\nremoveTask tid = delete tid\n\nchanges = [addTask (Task &quot;1&quot; &quot;Description&quot; [] []), removeTask &quot;1&quot;]\n\nmain = putStrLn . show $ foldl (\\s c -&gt; c s) s changes\n</code></pre>\n<p>Suppose I have the following code. I want to store <code>changes</code> list in a json file. But I don't know how to do that with Aeson, aside probably from writing a custom parser and there must be a better way to do that obviously. Like maybe using language extension to derive <code>(Generic, ToJSON, FromJSON)</code> for <code>addTask</code> and <code>removeTask</code> etc...</p>\n<p>EDIT. For all people that say &quot;You can't serialize function&quot;.</p>\n<p>Read the comments to an answer to this question.</p>\n<p><a href=\"https://stackoverflow.com/questions/10551210/instance-show-for-function\">Instance Show for function</a></p>\n<blockquote>\n<p>That said, it's not possible to define Show to actually give you more\n? detail about the function. \u2013 Louis Wasserman May 12 '12 at 14:51</p>\n<p>Sure it is. It can show the type (given via Typeable); or it can show some of the inputs and outputs (as is done in QuickCheck).</p>\n</blockquote>\n<p>EDIT2. Okay, I got that I can't have function name in serialization. But can this be done via template Haskell? I see that aeson supports serialization via template Haskell, but as newcomer to Haskell can't figure out how to do that.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1489084348, "post_id": 42700743, "comment_id": 72527765, "body": "This is not possible. Functions receive <i>values</i> as arguments, not expressions. 16 is a value. 12+4 is an expression, a way of computing 16. If you want to know how 16 was computed, you will have to instrument <code>+</code>, not the function called with the result of <code>+</code>."}, {"owner": {"reputation": 21, "user_id": 7685672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e414d5e7410d05a4f651ab83def38d?s=128&d=identicon&r=PG&f=1", "display_name": "user7685672", "link": "https://stackoverflow.com/users/7685672/user7685672"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489088813, "post_id": 42700743, "comment_id": 72530424, "body": "Haskell uses lazy evaluation. The parameter should be received as an expression and not evaluated until used."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489093124, "post_id": 42700743, "comment_id": 72532523, "body": "@user7685672 That&#39;s an implementation detail. Conceptually, the function doesn&#39;t have any access to the thunk, only what the thunk represents."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489096542, "post_id": 42700743, "comment_id": 72534283, "body": "It&#39;s not just an implementation detail, it&#39;s also inaccurate. Yes, there is non-strict evaluation. But you can&#39;t conclude from that that functions have access to expressions representing their arguments, only that the function gets something which may be a thunk or may be a fully-computed value. Importantly, a thunk doesn&#39;t imply any kind of textual or syntactic representation."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1489101766, "post_id": 42700743, "comment_id": 72536591, "body": "<code>putStrLn &quot;(12+4)&quot;</code>"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1489237963, "post_id": 42700743, "comment_id": 72589291, "body": "Sadly, it seems even the GHCi debugger can&#39;t do this. It can tell you which integers are evaluated and which are not, but it seems it cannot print the actual expression waiting to be evaluated."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7685672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e414d5e7410d05a4f651ab83def38d?s=128&d=identicon&r=PG&f=1", "display_name": "user7685672", "link": "https://stackoverflow.com/users/7685672/user7685672"}, "edited": false, "score": 0, "creation_date": 1489079264, "post_id": 42701016, "comment_id": 72524731, "body": "Thanks, that&#39;s useful, but if I call that function with (12+4), show n will still evaluate the parameter. I&#39;m looking to print out 12+4 literally to the terminal"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 21, "user_id": 7685672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e414d5e7410d05a4f651ab83def38d?s=128&d=identicon&r=PG&f=1", "display_name": "user7685672", "link": "https://stackoverflow.com/users/7685672/user7685672"}, "edited": false, "score": 0, "creation_date": 1489085979, "post_id": 42701016, "comment_id": 72528815, "body": "@user7685672 I see. The problem is that 12+4 gets evaluates to 16, and there&#39;s no way to distinguish between those integers."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1489078275, "creation_date": 1489078275, "answer_id": 42701016, "question_id": 42700743, "link": "https://stackoverflow.com/questions/42700743/how-can-i-print-the-parameters-of-a-function-before-evaluation-in-haskell/42701016#42701016", "title": "How can I print the parameters of a function before evaluation in Haskell?", "body": "<p>Pure functions can not print anything. To print something a function must return a value in the IO monad.</p>\n\n<p><em>However</em>, I guess that you want to print the arguments for debugging purposes, only. For this specific task, there's an utility function called <code>Debug.Trace.trace</code> which does just that.</p>\n\n<p>A typical usage is as follows:</p>\n\n<pre><code>import Debug.Trace\n\nfib :: Int -&gt; Int\nfib n | trace (\"fib input:\" ++ show n) False = undefined\nfib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>The first branch \"tricks\" GHC to evaluate <code>trace (\"fib input:\" ++ show n) False</code>, which returns <code>False</code> after printing some debug output. Because the guard is false, the <code>= undefined</code> part will be ignored.</p>\n\n<p>Do not use this feature for anything else than debugging.</p>\n\n<p>You might also want to take a look to the <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/ghci-debugger.html\" rel=\"nofollow noreferrer\">GHCi debugger</a> for more advanced debugging techniques.</p>\n"}], "owner": {"reputation": 21, "user_id": 7685672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e414d5e7410d05a4f651ab83def38d?s=128&d=identicon&r=PG&f=1", "display_name": "user7685672", "link": "https://stackoverflow.com/users/7685672/user7685672"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489078275, "creation_date": 1489077510, "question_id": 42700743, "link": "https://stackoverflow.com/questions/42700743/how-can-i-print-the-parameters-of-a-function-before-evaluation-in-haskell", "title": "How can I print the parameters of a function before evaluation in Haskell?", "body": "<p>Using a function like <code>show</code> will evaluate any expression given to it before printing. If I call <code>show (12+4)</code> the output will be <code>16</code>. How can I write a function that prints the output directly, ie when called with <code>12+4</code> will return <code>12+4</code> or <code>(12+4)</code></p>\n\n<p>Thanks </p>\n"}, {"tags": ["haskell", "webkit", "gtk3", "webkitgtk", "reflex"], "comments": [{"owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 1, "creation_date": 1489066244, "post_id": 42693385, "comment_id": 72515186, "body": "what version of webkit are you using?"}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 1, "creation_date": 1489136265, "post_id": 42693385, "comment_id": 72548778, "body": "I&#39;m using the Debian packages <i>libwebkitgtk3.0</i> <i>-common -amd64</i> and <i>-dev</i>. The Debain package version is 2.4.9. Haskell Cabal packages are <i>webkitgtk3-0.14.2.1</i> and <i>webkitgtk3-javascriptcore-0.13.2.0</i>."}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 1, "creation_date": 1489165155, "post_id": 42693385, "comment_id": 72567311, "body": "I have found another version number: When I access the server from the webkit client, the server says: <i>&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/538.15 (KHTML, like Gecko) Version/8.0 Safari/538.15 GHCJS&quot;</i>. So the Webkit version seems to be <b>538.15</b>."}, {"owner": {"reputation": 384, "user_id": 4098149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4eff262713ed007414ceb4e35f6b63f5?s=128&d=identicon&r=PG&f=1", "display_name": "Schoon", "link": "https://stackoverflow.com/users/4098149/schoon"}, "edited": false, "score": 0, "creation_date": 1540232858, "post_id": 42693385, "comment_id": 92780208, "body": "Did you find a solution? Having the same problem."}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 384, "user_id": 4098149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4eff262713ed007414ceb4e35f6b63f5?s=128&d=identicon&r=PG&f=1", "display_name": "Schoon", "link": "https://stackoverflow.com/users/4098149/schoon"}, "edited": false, "score": 0, "creation_date": 1540380538, "post_id": 42693385, "comment_id": 92841866, "body": "@Schoon: Unfortunately, the answer is &quot;No&quot;. However I have to say, the last year I didn&#39;t do any client server development"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1489056692, "creation_date": 1489056692, "last_edit_date": 1495541841, "question_id": 42693385, "link": "https://stackoverflow.com/questions/42693385/accessing-a-web-server-from-a-webkit-client-written-in-haskell-reflex-dom", "title": "Accessing a web server from a webkit client written in haskell reflex-dom", "body": "<p>This is a follow up question to <a href=\"https://stackoverflow.com/questions/42143155/acess-a-servant-server-with-a-reflex-dom-client\">Acess a servant server with a reflex-dom client</a>:</p>\n\n<p>If I run the client code in a web browser everything works fine.\nHowever if I run the client code in webkit under gtk3 (and Debian), I can see the request in the server, but the client doesn't receive any response.</p>\n\n<p>I assume, this is again some kind of a security or CORS problem. I found this post <a href=\"https://stackoverflow.com/questions/11252206/how-to-disable-web-security-cross-origin-reequest-in-webkit-gtk\">How to disable web security (cross origin reequest) in webkit gtk</a> from the year 2012 saying <em>not possible</em> due to this bug <a href=\"https://bugs.webkit.org/show_bug.cgi?id=58378\" rel=\"nofollow noreferrer\">https://bugs.webkit.org/show_bug.cgi?id=58378</a>. If I look at this bug, it says: <em>Status: RESOLVED FIXED</em>. The second answer of the mentiond SO post shows some settings in an unspecified file..</p>\n\n<p>My question is: <strong>Where</strong> (directory and file) do I have to specify <strong>what</strong>, to access a server from a WebkitGtk client.</p>\n"}, {"tags": ["list", "class", "haskell", "tuples"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1489059013, "post_id": 42692384, "comment_id": 72510511, "body": "Why do you have such a tuple in the first place? Tuples of size &gt;3 are usually a sign that you&#39;ve used them for something that should have better been done with e.g. records, or perhaps <i>nested 2-tuples</i>."}, {"owner": {"reputation": 41, "user_id": 7683414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9dfe8d516596861445012a2cfb1d8d?s=128&d=identicon&r=PG&f=1", "display_name": "km9c3uwc", "link": "https://stackoverflow.com/users/7683414/km9c3uwc"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1489167617, "post_id": 42692384, "comment_id": 72568786, "body": "It was not my decision. Can we map over the fields of a record easier than over the coordinates in a tuple?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489170690, "post_id": 42692384, "comment_id": 72570413, "body": "Not intrinsically, but you could perhaps make the record polymorphic in a way that naturally supports the type-changing map operation."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1489060065, "creation_date": 1489060065, "answer_id": 42694623, "question_id": 42692384, "link": "https://stackoverflow.com/questions/42692384/how-to-map-over-a-long-tuple-of-instances-of-the-same-class/42694623#42694623", "title": "How to map over a long tuple of instances of the same class?", "body": "<p>I would do something along the line of</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, DefaultSignatures #-}\n\nclass MultiC cs where\n  type MultiR cs :: *\n  type MultiR cs = R\n  multif :: cs -&gt; MultiR cs\n  default multif :: cs -&gt; R\n  multif = f\n\ninstance MultiC A\ninstance MultiC B\n-- ...\n\ninstance (MultiC x, MultiC y) =&gt; MultiC (x,y) where\n  type MultiR (x,y) = (MultiR x, MultiR y)\n  multif (x,y) = (multif x, multif y)\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>t :: ((A, (B, B)), ((A, B), (A, B)))\nt = ((A, (B, B)), ((A, B), (A, B)))\n\nl :: ((R, (R, R)), ((R, R), (R, R)))\nl = multif t\n</code></pre>\n\n<p>You could in principle also extend this to have (pseudocode)</p>\n\n<pre><code>instance (MultiC \u03b1, MultiC \u03b2, MultiC \u03b3 ... MultiC \u03c9)\n             =&gt; MultiC (\u03b1,\u03b2,\u03b3 ... \u03c9) where\n  type MultiC (\u03b1,\u03b2,\u03b3 ... \u03c9) = (MultiR \u03b1, MultiR \u03b2 ... MultiR \u03c9)\n  multif (\u03b1,\u03b2,\u03b3...\u03c9) = (multif \u03b1, multif \u03b2, multif \u03b3 ... multif \u03c9)\n</code></pre>\n\n<p>But as I commented, big flat tuples aren't really a good idea since Haskell has no proper way to abstract over them.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 4, "last_activity_date": 1489068373, "creation_date": 1489068373, "answer_id": 42697458, "question_id": 42692384, "link": "https://stackoverflow.com/questions/42692384/how-to-map-over-a-long-tuple-of-instances-of-the-same-class/42697458#42697458", "title": "How to map over a long tuple of instances of the same class?", "body": "<p>This is a pretty standard use case for generic programming. It's such a common use case that there are libraries to not have to write the generic implementation.</p>\n\n<h2><a href=\"http://hackage.haskell.org/package/one-liner\" rel=\"nofollow noreferrer\">one-liner</a></h2>\n\n<pre><code>import Generics.OneLiner\n\nl :: [R]\nl = gfoldMap (For :: For C) (pure . f) t :: [R]\n</code></pre>\n\n<p><code>gfoldMap</code> is a fold on the fields of a datatype, assuming they are all instances of a given typeclass allowing one to generically collect results, here this is <code>C</code>.</p>\n\n<pre><code>gfoldMap (For :: For C) :: (forall a. C a =&gt; a -&gt; [R]) -&gt; (A, B, B, A, B, A, B) -&gt; [R]\n</code></pre>\n\n<p>Be careful this requires instances of <code>Generic</code>, derived by the base package only up to 7-tuples.\nYou can define your own tuples for which you derive <code>Generic</code>.</p>\n\n<p>For various reasons, you may want to preserve the structure of your datatype rather than collecting results in a list. At the time of writing, <code>one-liner</code> is still a bit rigid in that respect, because it doesn't handle \"type-changing traversals\" (from <code>(A, B, B, A, B, A, B)</code> to <code>(R, R, R, R, R, R, R)</code>).</p>\n\n<hr>\n\n<h2><a href=\"https://hackage.haskell.org/package/product-profunctors\" rel=\"nofollow noreferrer\">product-profunctors</a></h2>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nimport Data.Profunctor\nimport Data.Profunctor.Product\nimport Data.Profunctor.Product.Default\n</code></pre>\n\n<p>We define a newtype to not pollute the environment with orphans.</p>\n\n<pre><code>newtype P a b = P { unP :: a -&gt; b } deriving\n  (Profunctor, ProductProfunctor)\n</code></pre>\n\n<p>We declare <code>f</code> as a <code>Default</code> way of mapping <code>A</code> and <code>B</code> to <code>R</code>.</p>\n\n<pre><code>instance Default P A R where def = P f\ninstance Default P B R where def = P f\n</code></pre>\n\n<p>The library implicitly extends this to tuples, mapping any tuple of <code>A</code> and <code>B</code> to a corresponding tuple of <code>R</code>.</p>\n\n<pre><code>-- Type signature required\nt'_ :: (R, R, R, R, R, R, R)\nt'_ = unP def t\n</code></pre>\n\n<p>You probably don't want to type the type signature. It can not be inferred because of type class shenanigans. However, it can be computed from the type of the input. You can thus define a type family (a type-level function) which replaces occurences of <code>A</code> and <code>B</code> with <code>R</code> in a tuple type. Actually, any type that looks like some <code>F a b c d e f</code> where <code>F</code> is a type constructor will be converted to <code>F R R R R R R</code>.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE UndecidableInstances #-}\n\ntype family Rify (a :: k) where\n  Rify (f a) = Rify f a\n  Rify a = a\n</code></pre>\n\n<p>Specialize <code>def</code> (which has a type-inference-unfriendly type) to use this family:</p>\n\n<pre><code>defP :: Default P a (Rify a) =&gt; P a (Rify a)\ndefP = def\n\n-- Type signature now optional\nt' :: (R, R, R, R, R, R, R)\nt' = unP defP t\n</code></pre>\n\n<hr>\n\n<h2>product-profunctors, bis</h2>\n\n<p>You can also get a list by picking the right profunctor.</p>\n\n<p>As its name implies, product-profunctors works with <code>ProductProfunctor</code> in a general way. This profunctor collects <code>R</code> values in a list. It's a profunctor equivalent of <code>Const [R]</code> in <code>Control.Applicative</code>.</p>\n\n<pre><code>newtype Q a b = Q { unQ :: a -&gt; [R] }\n\ninstance Profunctor Q where dimap f _ (Q q) = Q (q . f)\n\ninstance ProductProfunctor Q where\n  purePP _ = Q (const [])\n  Q x **** Q y = Q (\\a -&gt; x a ++ y a)\n\n  -- Older versions of product-profunctor use these two instead.\n  empty = Q (const [])\n  Q x ***! Q y = Q (\\(a, b) -&gt; x a ++ y b)\n\n-- or\n--\n-- newtype Q a b = Q (Star (Const [R]) a b)\n--   deriving (Profunctor, ProductProfunctor)\n--\n-- unQ :: Q a b -&gt; a -&gt; [R]\n</code></pre>\n\n<p>Define default actions.</p>\n\n<pre><code>instance Default Q A b where def = Q (pure . f)\ninstance Default Q B b where def = Q (pure . f)\n</code></pre>\n\n<p>And again, these are implicitly composed to \"traverse\" tuples.</p>\n\n<pre><code>-- The second parameter doesn't actually matter, but\n-- the type-checker doesn't know it so we put something for it\n-- to infer. Could be `Q a ()`, anything that's not ambiguous.\ndefQ :: Default Q a a =&gt; Q a a\ndefQ = def\n\nt'' :: [R]\nt'' = unQ defQ t\n</code></pre>\n\n<p>This is actually very similar to how <code>one-liner</code> works internally, though it uses its own flavour of <code>ProductProfunctor</code> at the moment.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1489093992, "last_edit_date": 1489093992, "creation_date": 1489093660, "answer_id": 42705416, "question_id": 42692384, "link": "https://stackoverflow.com/questions/42692384/how-to-map-over-a-long-tuple-of-instances-of-the-same-class/42705416#42705416", "title": "How to map over a long tuple of instances of the same class?", "body": "<p>In addition to the methods listed in Li-yao Xia's answer, here's a solution using <a href=\"http://hackage.haskell.org/package/generics-sop\" rel=\"nofollow noreferrer\">generics-sop</a>:</p>\n\n<pre><code>{-# language DeriveGeneric #-}\n{-# language FlexibleContexts #-}\n{-# language TypeFamilies #-}\n{-# language DataKinds #-}\n{-# language TypeApplications #-} -- for the Proxy\n\nimport Generics.SOP\n\ntTol :: (Generic r, All2 C (Code r)) =&gt; r -&gt; [R]\ntTol = hcollapse . hcliftA (Proxy @C) (\\(I a) -&gt; K (f a)) . from\n</code></pre>\n\n<p>This solution will work with tuples, records, and sum types, as long as the type has a <code>Generics.SOP.Generic</code> instance, and all the fields have a <code>C</code> instance.</p>\n"}], "owner": {"reputation": 41, "user_id": 7683414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9dfe8d516596861445012a2cfb1d8d?s=128&d=identicon&r=PG&f=1", "display_name": "km9c3uwc", "link": "https://stackoverflow.com/users/7683414/km9c3uwc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 42697458, "answer_count": 3, "score": 0, "last_activity_date": 1489093992, "creation_date": 1489054113, "question_id": 42692384, "link": "https://stackoverflow.com/questions/42692384/how-to-map-over-a-long-tuple-of-instances-of-the-same-class", "title": "How to map over a long tuple of instances of the same class?", "body": "<p>Assume that we have a class C in Haskell that has a function f that returns a result of type R.\nIf we are given a long tuple t of instances of the class C, then how can we nicely obtain a list (or at least a tuple) of results of f on the members of t?</p>\n\n<p>Note that the tuple is long, so solutions that include typing something per each member of the tuple are not perfect. We don't want to type that much.</p>\n\n<pre><code>-- GIVEN --\n\ndata R = R  -- more constructors here\n\nclass C a where\n  f :: a -&gt; R\n\ndata A = A\ninstance C A where\n  f _ = R  -- some fancy f here\n\ndata B = B\ninstance C B where\n  f _ = R  -- some fancy f here\n\n-- some other instances of C here\n\nt = (A, B, B, A, B, A, B) -- a long tuple of instances of C\n\n\n-- QUESTION: How to obtain l as below, but in the nicest way? --\n\nl :: [R]\nl = let (t1, t2, t3, t4, t5, t6, t7) = t\n    in [f t1, f t2, f t3, f t4, f t5, f t6, f t7]\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1489059017, "post_id": 42691533, "comment_id": 72510512, "body": "You can use the <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#ghc-variant\" rel=\"nofollow noreferrer\"><code>ghc-variant</code> option</a> or <code>--ghc-variant</code> flag. If you are on Windows and use <a href=\"https://raw.githubusercontent.com/fpco/stackage-content/master/stack/stack-setup-2.yaml\" rel=\"nofollow noreferrer\">the default stack-setup-2.yaml</a>, building with <code>--ghc-variant integersimple</code> should use a different GHC than if you use <code>--ghc-variant standard</code>."}, {"owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1489059955, "post_id": 42691533, "comment_id": 72511106, "body": "@sjakobi great, could you post this as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "is_accepted": true, "score": 7, "last_activity_date": 1489061395, "creation_date": 1489061395, "answer_id": 42695048, "question_id": 42691533, "link": "https://stackoverflow.com/questions/42691533/how-to-use-different-ghc-builds-with-stack/42695048#42695048", "title": "How to use different ghc builds with stack?", "body": "<p>You can use <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#ghc-variant\" rel=\"noreferrer\">the <code>ghc-variant</code> option</a> or <code>--ghc-variant</code> flag.</p>\n\n<p>If you are on Windows and use the default <a href=\"https://raw.githubusercontent.com/fpco/stackage-content/master/stack/stack-setup-2.yaml\" rel=\"noreferrer\">stack-setup-2.yaml</a>, building with <code>--ghc-variant integersimple</code> should use a different GHC than if you use <code>--ghc-variant standard</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "is_accepted": false, "score": 2, "last_activity_date": 1526586136, "creation_date": 1526586136, "answer_id": 50399409, "question_id": 42691533, "link": "https://stackoverflow.com/questions/42691533/how-to-use-different-ghc-builds-with-stack/50399409#50399409", "title": "How to use different ghc builds with stack?", "body": "<p>For people who want to try a different ghc version and not an entirely different build alltogether the <code>--compiler</code> flag is useful <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#compiler\" rel=\"nofollow noreferrer\">https://docs.haskellstack.org/en/stable/yaml_configuration/#compiler</a> </p>\n\n<p>Also take a look at this answer <a href=\"https://stackoverflow.com/a/35472448/1833322\">https://stackoverflow.com/a/35472448/1833322</a> which talks about the <code>--ghc-variant</code> flag</p>\n\n<p>And to be complete, here is the talk about the implementation of these flags:</p>\n\n<ul>\n<li><a href=\"https://github.com/commercialhaskell/stack/issues/530\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/530</a></li>\n<li><a href=\"https://github.com/commercialhaskell/stack/pull/816\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/pull/816</a></li>\n</ul>\n\n<p>This is useful to know since this stackoverflow question is the first page in google results.</p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "edited": false, "score": 0, "creation_date": 1591308314, "post_id": 53505494, "comment_id": 110015411, "body": "<code>macosx-custom-</code> if you&#39;re on mac."}], "tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": false, "score": 5, "last_activity_date": 1543341400, "creation_date": 1543341400, "answer_id": 53505494, "question_id": 42691533, "link": "https://stackoverflow.com/questions/42691533/how-to-use-different-ghc-builds-with-stack/53505494#53505494", "title": "How to use different ghc builds with stack?", "body": "<p>The other answers are good, but here's a complete example so that you don't have to puzzle it together from the provided links.</p>\n\n<p>Put this in your <code>stack.yaml</code> file:</p>\n\n<pre><code>resolver: lts-12.20\n\nsetup-info:\n  ghc:\n    linux64-custom-dwarf:\n      8.4.4:\n        url: \"https://downloads.haskell.org/~ghc/8.4.4/ghc-8.4.4-x86_64-deb9-linux-dwarf.tar.xz\"\n        sha256: f9cac6e402c71d7251f2e22f412fb4abd72c64f34481a1e548cd7f6ff2352a07\n\nghc-variant: dwarf\n</code></pre>\n\n<p>Here in the <code>setup-info</code> part I provide the path to the bindist, a checksum (optional but recommended for reproducibility), and then say that I want to use this custom ghc with <code>ghc-variant: dwarf</code> (it seems to turn the <code>dwarf</code> in there into <code>linux64-custom-dwarf</code> by appending the word to <code>linux64-custom-</code>).</p>\n\n<p>If you want to share the definition of that custom ghc across projects, you can also put the <code>setup-info</code> part into <code>$HOME/.stack/config.yaml</code>.</p>\n\n<hr>\n\n<p>Note for GHC hackers: If you want to hack on ghc itself and iterate quickly on your packages with frequently updated GHC, then <a href=\"https://github.com/commercialhaskell/stack/issues/725#issuecomment-364624897\" rel=\"noreferrer\">this approach</a> where you just override the GHC binary instead of declaring a fully built bindist is better (because you don't have to build a bindist every time you recompile).</p>\n"}, {"tags": [], "owner": {"reputation": 12367, "user_id": 531179, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36b013eaaf1270f35e5157a5ea00ac22?s=128&d=identicon&r=PG", "display_name": "ulidtko", "link": "https://stackoverflow.com/users/531179/ulidtko"}, "is_accepted": false, "score": 1, "last_activity_date": 1602786003, "creation_date": 1602786003, "answer_id": 64377562, "question_id": 42691533, "link": "https://stackoverflow.com/questions/42691533/how-to-use-different-ghc-builds-with-stack/64377562#64377562", "title": "How to use different ghc builds with stack?", "body": "<p>To whoever needs this again, I'll leave a recipe to install <strong>musl bindist</strong> using Stack (GHC 8.6.5 on Alpine) \u2014 as another example/variation of what OP has asked.</p>\n<p>First, locate a <em>bindist</em> (binary distribution) at e.g. <a href=\"https://github.com/commercialhaskell/ghc/releases\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/ghc/releases</a><br />\nI needed to pick the musl libc variant.</p>\n<p>Fill that into <code>setup-info</code> section in <code>~/.stack/config.yaml</code> and specify <code>ghc-variant</code>:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>setup-info:\n  ghc:\n    linux64-custom-musl-ncurses6:\n      8.6.5:\n        url: &quot;https://github.com/commercialhaskell/ghc/releases/download/ghc-8.6.5-release/ghc-8.6.5-x86_64-unknown-linux-musl.tar.xz&quot;\n        content-length: 140167348\n        sha1: 3ce575af840e886ba5d2641f68577ace38ac21c6\n        sha256: ec6d0417822c3bfafc7aea0b0402294901231bc5d72dd17a2b849e3f44850695\n\nghc-variant: musl\n</code></pre>\n<p>With that, installing the GHC variant is as simple as:</p>\n<pre><code>stack setup \\\n    --install-ghc \\\n    --resolver=$RESOLVER_CHOICE \\\n    --ghc-variant musl \\\n    8.6.5\n</code></pre>\n"}], "owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 0, "accepted_answer_id": 42695048, "answer_count": 4, "score": 9, "last_activity_date": 1602786003, "creation_date": 1489051807, "question_id": 42691533, "link": "https://stackoverflow.com/questions/42691533/how-to-use-different-ghc-builds-with-stack", "title": "How to use different ghc builds with stack?", "body": "<p>I would like to have different, non-ABI-compatible, builds of the same version of GHC, and use them in different projects.</p>\n\n<p>(In my case, the difference between the builds is integer-simple vs gmp.)</p>\n\n<p>The comments in <a href=\"https://github.com/commercialhaskell/stack/issues/399\" rel=\"noreferrer\">this issue</a> show how to add a custom flavor of ghc to <code>stack-setup-2.yaml</code>. But how do I specify which ghc build to use in each particular case or project?</p>\n\n<p>I.e. I am looking for one (better yet, both) of:</p>\n\n<ol>\n<li>The ability to specify in <code>stack.yaml</code> whether to use the integer-simple or gmp build.</li>\n<li>The ability to specify, at <code>stack build</code> time, which build to produce.</li>\n</ol>\n"}, {"tags": ["mongodb", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489063685, "post_id": 42690616, "comment_id": 72513567, "body": "The second error is simple - add <code>Field</code> to your import list. The first is not a complete error (aside: ghc gives very big errors, but if you actually read the entire thing, they are very precise and informative) so it&#39;s not really possible to tell where it came from, but I&#39;m guessing you want something like <code>lift getWetterDaten &gt;&gt;= insertMany &quot;daten&quot;</code>. Of course this reads the file every time you do an <code>insert</code>, which probably isn&#39;t what you want."}, {"owner": {"reputation": 101, "user_id": 5027049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd6bcb4294fed4ef681cc9a92af4260?s=128&d=identicon&r=PG&f=1", "display_name": "Ralli", "link": "https://stackoverflow.com/users/5027049/ralli"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489067685, "post_id": 42690616, "comment_id": 72516187, "body": "thank you, i tried liftM getWetterDaten &gt;&gt;= insertMany &quot;daten3&quot; but got errors: Couldn&#39;t match expected type \u2018Control.Monad.Trans.Reader.ReaderT                                 Database.MongoDB.Query.MongoContext IO [Document]\u2019             with actual type \u2018m0 a10 -&gt; m0 r0\u2019 Probable cause: \u2018liftM\u2019 is applied to too few arguments In the first argument of \u2018(&gt;&gt;=)\u2019, namely \u2018liftM getWetterDaten"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 5027049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd6bcb4294fed4ef681cc9a92af4260?s=128&d=identicon&r=PG&f=1", "display_name": "Ralli", "link": "https://stackoverflow.com/users/5027049/ralli"}, "is_accepted": false, "score": 0, "last_activity_date": 1489067500, "creation_date": 1489067500, "answer_id": 42697169, "question_id": 42690616, "link": "https://stackoverflow.com/questions/42690616/haskell-mongodb-insert-records-from-file/42697169#42697169", "title": "Haskell Mongodb insert records from file", "body": "<p>i found a solution that works by passing the data as parameter to insertData2:</p>\n\n<pre><code>  {-# LANGUAGE OverloadedStrings #-}\n  {-# LANGUAGE ExtendedDefaultRules #-}\n  module TestModule2 where\n\n  import Database.MongoDB    (Action, Document, Document, Value, access,\n                              close, connect, delete, exclude, find,\n                              host, insertMany, master, project, rest,\n                              select, sort, (=:))\n\n  main :: IO ()\n  main = do\n      wetterDaten &lt;- getWetterDaten\n      processMongo wetterDaten\n      return ()\n\n  processMongo :: [Document] -&gt; IO ()    \n  processMongo wetterDaten = do\n      pipe        &lt;- connect (host \"127.0.0.1\")\n      e           &lt;- access pipe master \"wetter2017\" (run wetterDaten)\n      close pipe\n      print e\n\n  run :: [Document] -&gt; Action IO ()\n  run wetterDaten = do\n      clearData\n      insertData \n      clearData2\n      insertData2 wetterDaten\n      return ()\n\n  clearData :: Action IO ()\n  clearData = delete (select [] \"daten\")\n\n  clearData2 :: Action IO ()\n  clearData2 = delete (select [] \"daten2\")\n\n  insertData :: Action IO [Value]\n  insertData   = do \n    insertMany \"daten\" testDaten\n\n  insertData2 :: [Document] -&gt; Action IO [Value]\n  insertData2 wetterDaten = do \n    insertMany \"daten2\" wetterDaten\n\n  testDaten :: [Document]\n  testDaten = [[\"data\" =: \"Zeile0\"],[\"data\" =: \"Zeile1\"],\n               [\"data\" =: \"Zeile2\"],[\"data\" =: \"Zeile3\"]]\n\n  getWetterDaten :: IO [Document]\n  getWetterDaten =  do\n    fileContents &lt;- fmap lines $ readFile \"data.txt\"\n    let wetterDaten  = map makeMongo fileContents\n    return wetterDaten\n\n  makeMongo :: String -&gt; Document\n  makeMongo x = [ \"data\"      =: x]\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5027049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd6bcb4294fed4ef681cc9a92af4260?s=128&d=identicon&r=PG&f=1", "display_name": "Ralli", "link": "https://stackoverflow.com/users/5027049/ralli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489067500, "creation_date": 1489049266, "last_edit_date": 1489052209, "question_id": 42690616, "link": "https://stackoverflow.com/questions/42690616/haskell-mongodb-insert-records-from-file", "title": "Haskell Mongodb insert records from file", "body": "<p>I try to write a program that reads a file and stores the information in a mongoldb collection. The program is based on a sample program for the mongodb driver.\nFor test I defined some constants in testdaten and the programs works with this data. When I try to insert the file data I get a type error:</p>\n\n<p>insertMany \"daten\" getWetterDaten\n  Couldn't match expected type <code>[Document]</code>\n            with actual type <code>IO [[Data.Bson.Field]]</code>\n  In the second argument of <code>insertMany</code>, namely <code>getWetterDaten</code>\n  In a stmt of a <code>do</code> block: <code>insertMany \"daten\" getWetterDaten</code> </p>\n\n<p>I know that the problem is that testdaten has <code>Type\ntestDaten :: [[Data.Bson.Field]]</code>\nand <code>getWetterDaten</code> has <code>Type\ngetWetterDaten :: IO [[Data.Bson.Field]]</code>,\nbut how can I solve this ?</p>\n\n<p>When I try to pass the data as a parameter to <code>insertData2</code> I get the message:</p>\n\n<pre><code>Couldn't match type \u2018Control.Monad.Trans.Reader.ReaderT\n                   Database.MongoDB.Query.MongoContext m1 [Value]\u2019\n</code></pre>\n\n<p>which is definitely far beyond my understanding of Haskell.</p>\n\n<p>Another observation is that if I try to include the type declaration\nI get an error message:  </p>\n\n<pre><code>Not in scope: type constructor or class `Data.Bson.Field`\n</code></pre>\n\n<p>What is the correct way to insert the file data into mongodb ?</p>\n\n<pre><code>  {-# LANGUAGE OverloadedStrings #-}\n  {-# LANGUAGE ExtendedDefaultRules #-}\n  module TestModule where\n\n  import Database.MongoDB    (Action, Document, Document, Value, access,\n                              close, connect, delete, exclude, find,\n                              host, insertMany, master, project, rest,\n                              select, sort, (=:))\n\n  main :: IO ()\n  main = do\n      wetterDaten &lt;- getWetterDaten\n      pipe        &lt;- connect (host \"127.0.0.1\")\n      e           &lt;- access pipe master \"wetter2017\" run\n      close pipe\n      print e\n\n  --run :: Action IO ()\n  run  = do\n      clearData\n      insertData \n      return ()\n\n  clearData :: Action IO ()\n  clearData = delete (select [] \"daten\")\n\n  --insertData :: Action IO [Value]\n  insertData   = do \n    **insertMany \"daten\" testDaten**\n\n  insertData2 :: Action IO [Value]\n  insertData2  = do \n    **insertMany \"daten\" getWetterDaten**\n\n  testDaten = [[\"data\" =: \"Zeile0\"],[\"data\" =: \"Zeile1\"],\n               [\"data\" =: \"Zeile2\"],[\"data\" =: \"Zeile3\"]]\n\n  getWetterDaten =  do\n    fileContents &lt;- fmap lines $ readFile \"data.txt\"\n    let wetterDaten  = map makeMongo fileContents\n    return wetterDaten\n\n  makeMongo x = [ \"data\"      =: x]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1489069104, "post_id": 42690603, "comment_id": 72517242, "body": "If you had tried <code>:t s1</code>, you&#39;d have seen that it has type <code>Object -&gt; Sentence</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5004, "user_id": 327815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2e18da0338911cd6ea464ff2613d1?s=128&d=identicon&r=PG", "display_name": "Jokester", "link": "https://stackoverflow.com/users/327815/jokester"}, "is_accepted": false, "score": 2, "last_activity_date": 1489049951, "last_edit_date": 1489049951, "creation_date": 1489049646, "answer_id": 42690728, "question_id": 42690603, "link": "https://stackoverflow.com/questions/42690603/do-data-constructors-support-currying/42690728#42690728", "title": "Do data constructors support currying?", "body": "<pre><code>     v this is name of a new type\ndata Sentence = Sentence Subject Verb Object\n                ^ and this is a function called \"value constructor\"\n                  (it may or may not have same name with the new type)\n</code></pre>\n\n<p>So the answer is yes, currying applies to the \"value constructor\" function as well.</p>\n"}, {"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": true, "score": 7, "last_activity_date": 1489051190, "creation_date": 1489051190, "answer_id": 42691298, "question_id": 42690603, "link": "https://stackoverflow.com/questions/42690603/do-data-constructors-support-currying/42691298#42691298", "title": "Do data constructors support currying?", "body": "<p>As Jokester noted, confusingly, there are two things both named \u201c<code>Sentence</code>\u201d here:</p>\n\n<ul>\n<li><code>Sentence</code> the type, and</li>\n<li><code>Sentence</code> the data constructor.</li>\n</ul>\n\n<p>Many data <em>constructors</em> are functions, because many data types store some stuff inside, and the only way they can do that is by asking for that stuff during construction.</p>\n\n<p>However, objects that have the <code>Sentence</code> <em>type</em> are not functions.  They are just ordinary values:</p>\n\n<pre><code>:t (Sentence \"he\" \"likes\" \"cake\")\n:: Sentence\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 1, "accepted_answer_id": 42691298, "answer_count": 2, "score": 0, "last_activity_date": 1490870641, "creation_date": 1489049219, "last_edit_date": 1489066324, "question_id": 42690603, "link": "https://stackoverflow.com/questions/42690603/do-data-constructors-support-currying", "title": "Do data constructors support currying?", "body": "<p>Everything in Haskell are functions like:</p>\n\n<pre><code>Prelude&gt; type Subject = String\nPrelude&gt; type Verb = String\nPrelude&gt; type Object = String\nPrelude&gt; data Sentence = Sentence Subject Verb Object deriving (Eq, Show)\nPrelude&gt; :t Sentence \nSentence :: Subject -&gt; Verb -&gt; Object -&gt; Sentence\n</code></pre>\n\n<p>The Sentence is a datatype but why it shows as a function? \nEven when I do substitute with a value, then it feels like a function.</p>\n\n<pre><code>s1 = Sentence \"dogs\" \"drool\"  \n</code></pre>\n\n<p>Does datatype support currying too?</p>\n"}]