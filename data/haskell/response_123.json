[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1495062405, "post_id": 44035927, "comment_id": 75098853, "body": "You can have functions with multiple arguments via type classes and a bit trickery see Development.Shake.cmd for example. Though I want to add a disclaimer - this is not beginner stuff, more an intermediate topic"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 6, "creation_date": 1495062990, "post_id": 44035927, "comment_id": 75099016, "body": "And as another disclaimer -- even in the circumstances where it is technically possible, it&#39;s not a thing Haskell developers really do, because it interferes with partial application, which we use <i>all the time</i>.  Also it&#39;s a pain."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495071496, "post_id": 44035927, "comment_id": 75101027, "body": "See also: <a href=\"https://byorgey.wordpress.com/2010/04/03/haskell-anti-pattern-incremental-ad-hoc-parameter-abstraction/\" rel=\"nofollow noreferrer\">Incremental ad-hoc parameter abstraction</a>."}], "answers": [{"tags": [], "owner": {"reputation": 872, "user_id": 8028053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15de9fe8c80dd7161db137e389b0e3d2?s=128&d=identicon&r=PG&f=1", "display_name": "fileyfood500", "link": "https://stackoverflow.com/users/8028053/fileyfood500"}, "is_accepted": false, "score": 1, "last_activity_date": 1495063448, "last_edit_date": 1495063448, "creation_date": 1495062324, "answer_id": 44036093, "question_id": 44035927, "link": "https://stackoverflow.com/questions/44035927/overloading-haskell-functions-to-have-different-number-of-arguments/44036093#44036093", "title": "Overloading Haskell functions to have different number of arguments", "body": "<p>No, it's not possible. In Haskell, the most recent definition of a function has precedence. So if you defined both versions of inc:</p>\n\n<pre><code>inc = (+) 1\ninc x = (+) x\n</code></pre>\n\n<p>Then the second definition would <em>shadow</em> the first definition. This means that if you call \"inc\", the second definition will now be used.</p>\n\n<p>However, you can still accomplish what you want with partial application.\nIf you make your 2 calls curried it will have the same effect. Like so:</p>\n\n<pre><code>map (inc 1) [1,2,3]\n</code></pre>\n\n<p>returns [2,3,4]</p>\n\n<pre><code>map (inc 2) [1,2,3]\n</code></pre>\n\n<p>returns [3,4,5]</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 8, "last_activity_date": 1495063466, "creation_date": 1495063466, "answer_id": 44036251, "question_id": 44035927, "link": "https://stackoverflow.com/questions/44035927/overloading-haskell-functions-to-have-different-number-of-arguments/44036251#44036251", "title": "Overloading Haskell functions to have different number of arguments", "body": "<p>First, the simple alternative is to just take a <code>Maybe</code> for this kind of \u201cdefault argument\u201d:</p>\n\n<pre><code>inc :: Num a =&gt; Maybe a -&gt; a -&gt; a\ninc Nothing x = 1 + x\ninc (Just i) x = i + x\n</code></pre>\n\n<p>Otherwise, yes it\u2019s possible, but it\u2019s probably not worthwhile. The technique is to make a typeclass with instances for a concrete type (the result of your operation) and functions (to accept more arguments).</p>\n\n<p>We introduce the class of types that can serve as the result of an increment:</p>\n\n<pre><code>class Inc i where\n  inc :: Integer -&gt; i\n</code></pre>\n\n<p>If the caller demands an integer, we increment by one:</p>\n\n<pre><code>instance Inc Integer where\n  inc = (+) 1\n</code></pre>\n\n<p>If the caller demands a function returning an integer, we increment by the argument of that function:</p>\n\n<pre><code>instance (Integral a) =&gt; Inc (a -&gt; Integer) where\n  inc x = (+) x . toInteger\n</code></pre>\n\n<p>Now these both work:</p>\n\n<pre><code>map inc [1, 2, 3]\nmap (inc 2) [1, 2, 3] :: [Integer]\n</code></pre>\n\n<p>But the type annotation is required unless the result is constrained to <code>[Integer]</code> by something that uses the result. And type inference gets still worse if you try to use a generic type such as <code>Num a =&gt; a</code> instead of the concrete <code>Integer</code>, or if you make it accept <em>any</em> number of arguments by replacing the instance for <code>(Integral a) =&gt; Inc (a -&gt; Integer)</code> with one for <code>(Integral a, Inc i) =&gt; Inc (a -&gt; i)</code>. On the other hand, you can just as well add instances for other concrete types such as <code>Int</code> and <code>Double</code>.</p>\n\n<p>I suppose my counter-question is: what problem are you actually trying to solve?</p>\n"}], "owner": {"reputation": 49, "user_id": 4440999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f38861f1f00af7a0074c6bc0d80840?s=128&d=identicon&r=PG&f=1", "display_name": "A. Dumais", "link": "https://stackoverflow.com/users/4440999/a-dumais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1052, "favorite_count": 0, "accepted_answer_id": 44036251, "answer_count": 2, "score": 2, "last_activity_date": 1495063466, "creation_date": 1495061288, "question_id": 44035927, "link": "https://stackoverflow.com/questions/44035927/overloading-haskell-functions-to-have-different-number-of-arguments", "title": "Overloading Haskell functions to have different number of arguments", "body": "<p>Is it possible to have two functions of the same name have a different number of arguments in Haskell? This is what I want to do:</p>\n\n<p><code>inc = (+) 1</code></p>\n\n<p><code>inc x = (+) x</code></p>\n\n<p>I want to be able to call my increment function with no arguments which defaults to incrementing by 1, or with an argument and have it increment by x.</p>\n\n<p>The I can do either of the following, for example:</p>\n\n<p><code>map(inc)[1,2,3]</code> --results in [2,3,4]</p>\n\n<p><code>map(inc 2)[1,2,3]</code> -- results in [3,4,5]</p>\n"}, {"tags": ["haskell", "types", "logic", "undefined"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495056804, "post_id": 44034591, "comment_id": 75096920, "body": "well <code>undefined</code> is sometimes defined as <code>undefined = undefined</code>... So it keeps evaluating.. So if you want to represent an endless loop, you can do this with <code>f = f</code>."}, {"owner": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495057374, "post_id": 44034591, "comment_id": 75097184, "body": "The evaluation of <code>undefined</code> is a Exception. I don&#39;t think that a endless loop and a Exception means the same. But someone could proof me wrong! :)"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 3, "creation_date": 1495060655, "post_id": 44034591, "comment_id": 75098327, "body": "@RafaelCastro: Haskell semantics are generally defined &quot;up to bottom&quot; (or &quot;up to \u22a5&quot;, with the symbol) \u2013 all &quot;bottom&quot;, which is to say nonterminating, values are considered the same.  (We let <code>IO</code> distinguish them in its usual impure ways.)"}, {"owner": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1495062039, "post_id": 44034591, "comment_id": 75098749, "body": "@AntalSpector-Zabusky Thank you for the information!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495099439, "post_id": 44034591, "comment_id": 75113118, "body": "&quot;Inhabited&quot;, always read &quot;... by something other than bottom&quot; and you&#39;re Ok."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1495099652, "post_id": 44034591, "comment_id": 75113269, "body": "A Haskell compiler can detect <i>some</i> infinite loops/recursions and turn them into exceptions, for pragmatic reasons. This doesn&#39;t affect Curry-Howard or any other theory in any way."}], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "edited": false, "score": 3, "creation_date": 1495059014, "post_id": 44035178, "comment_id": 75097791, "body": "I liked your answer, but I would like to know if there is any bad consequence. Say, if the type <code>a -&gt; b</code> has a term, what garante that the term is not unsafeCoerce? In a consistent logic that would never be asked!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "edited": false, "score": 0, "creation_date": 1495066513, "post_id": 44035178, "comment_id": 75099947, "body": "@RafaelCastro Hand-waving: a term of type <code>forall a b. a -&gt; b</code> is either <code>unsafeCoerce</code> (which we pretend doesn&#39;t exist) or some <code>\u22a5</code> such as <code>let x = x in x</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "edited": false, "score": 3, "creation_date": 1495099159, "post_id": 44035178, "comment_id": 75112896, "body": "@RafaelCastro I guess it depends on the definition of &quot;Haskell&quot;. If interpreted in very broad sense, including low level primitives, FFI, and a few other &quot;dangerous&quot; things, then we do lose type safety. I mean, FFI lets us send our data to C, cast them there to some other type, and get them back into Haskell. There&#39;s no guarantee if you include things like that. Even <code>unsafePerformIO</code> can be used to violate type safety. Usually, though, we pretend that these things are not part of Haskell."}, {"owner": {"reputation": 12050, "user_id": 502187, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/YdQfN.jpg?s=128&g=1", "display_name": "Mostowski Collapse", "link": "https://stackoverflow.com/users/502187/mostowski-collapse"}, "edited": false, "score": 0, "creation_date": 1550484184, "post_id": 44035178, "comment_id": 96271437, "body": "Whats your reference to &quot;Yes, the logic is inconsistent&quot;?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 12050, "user_id": 502187, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/YdQfN.jpg?s=128&g=1", "display_name": "Mostowski Collapse", "link": "https://stackoverflow.com/users/502187/mostowski-collapse"}, "edited": false, "score": 0, "creation_date": 1550487685, "post_id": 44035178, "comment_id": 96273438, "body": "@j4nbur53 None but, as the OP stated, <code>undefined :: a</code> proves every formula, so it follows immediately."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 12050, "user_id": 502187, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/YdQfN.jpg?s=128&g=1", "display_name": "Mostowski Collapse", "link": "https://stackoverflow.com/users/502187/mostowski-collapse"}, "edited": false, "score": 0, "creation_date": 1550488582, "post_id": 44035178, "comment_id": 96273947, "body": "@j4nbur53 I don&#39;t understand your point. Here we are discussing about the logic associated to the type system following Curry-Howard, so propositions are indeed types (and proofs are terms)."}, {"owner": {"reputation": 12050, "user_id": 502187, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/YdQfN.jpg?s=128&g=1", "display_name": "Mostowski Collapse", "link": "https://stackoverflow.com/users/502187/mostowski-collapse"}, "edited": false, "score": 0, "creation_date": 1550498166, "post_id": 44035178, "comment_id": 96279705, "body": "&quot;a&quot; is only a domain type, not a proposition type"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 16, "last_activity_date": 1495057947, "last_edit_date": 1495057947, "creation_date": 1495057139, "answer_id": 44035178, "question_id": 44034591, "link": "https://stackoverflow.com/questions/44034591/is-haskells-type-system-isomorphic-to-an-inconsistent-logic-system-if-so-what/44035178#44035178", "title": "Is Haskell&#39;s type system isomorphic to an inconsistent logic system? If so, what are the consequences?", "body": "<p>Yes, the logic is inconsistent.</p>\n\n<p>However, that does not mean that the type system is useless. For instance, the type system ensures we will never attempt to add integers and strings, or to project the first component out of a boolean. These usually are runtime type errors in some untyped languages.</p>\n\n<p>We still do have some runtime errors, like non-exhaustive pattern matching (which I'd personally ban from the language :-P), <code>error</code>, <code>undefined</code>, exceptions, and so on. But at least we do not have type related ones. We also have non-termination (through infinite recursion), which is a necessary evil in a Turing complete language, and which would cause the inconsistency anyway.</p>\n\n<p>Finally, I'd argue that Curry-Howard is useful even in such inconsistent setting. E.g. if I wanted to write <code>f :: Either a b -&gt; a</code>, I can immediately spot that this is not an intuitionistic theorem, hence <code>f</code> can only be realized using the above runtime errors, so it's probably a bad idea to begin with, and if I need such an <code>f</code>, I should reconsider my design.</p>\n\n<p>Would it be also useful to have a well defined \"total\" fragment of Haskell, with the same types, yet without the bad things mentioned above? Absolutely! For instance, it would allow to optimize any expression of type <code>()</code> to the value <code>()</code> -- after all it has to evaluate to that. Also, <code>e :: a :~: b</code> would similarly be optimized to something like <code>unsafeCoerce Refl</code>, making it possible to write \"proofs of equality between types\" which would only require O(1) runtime cost. Right now, unfortunately such proofs have to be evaluated at runtime, causing a silly overhead only to ensure the proof is a \"real\" one, and not e.g. a disguised <code>undefined</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "edited": false, "score": 0, "creation_date": 1495072972, "post_id": 44037134, "comment_id": 75101353, "body": "I was thinking to buy this book... one more reason. Your clarification about type safety being a much weaker condition was helpful. And you guessed right what I really wanted with my question about endless loop with no <code>undefined</code>."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 5, "creation_date": 1495082777, "post_id": 44037134, "comment_id": 75103704, "body": "<code>fib</code> and <code>repeat</code> are definitely not <code>\u22a5</code> from a formal perspective. I am less certain about <code>main</code>, but I don&#39;t think it is either."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1495097672, "post_id": 44037134, "comment_id": 75111829, "body": "@AlexeyRomanov Could you elaborate on that? I was under the impression that any term for which evaluation to NF fails to terminate is considered to be a <code>\u22a5</code>."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 6, "creation_date": 1495102562, "post_id": 44037134, "comment_id": 75115312, "body": "@TheOrgazoid For a strict language, yes; for Haskell, change NF to WHNF. As Antal Spector-Zabusky&#39;s comment to the question says, &quot;all &quot;bottom&quot;, which is to say nonterminating, values are considered the same&quot; but you can distinguish <code>fib</code> and <code>undefined</code> in pure Haskell (no <code>IO</code>, <code>seq</code>, etc.) e.g. by using <code>head</code>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 7, "last_activity_date": 1495098913, "last_edit_date": 1495098913, "creation_date": 1495070647, "answer_id": 44037134, "question_id": 44034591, "link": "https://stackoverflow.com/questions/44034591/is-haskells-type-system-isomorphic-to-an-inconsistent-logic-system-if-so-what/44037134#44037134", "title": "Is Haskell&#39;s type system isomorphic to an inconsistent logic system? If so, what are the consequences?", "body": "<blockquote>\n  <p>If Haskell's type system is a inconsistent proof system, then we can't trust it?</p>\n</blockquote>\n\n<p>As @chi alluded to, <em>type safety</em> is a much weaker condition than <em>logical consistency</em>. Quoting <a href=\"https://www.cis.upenn.edu/~bcpierce/tapl/\" rel=\"noreferrer\"><em>Types and Programming Languages</em></a> (a good read if you're interested in this sort of thing!),</p>\n\n<blockquote>\n  <h3>Safety = Progress + Preservation</h3>\n  \n  <p>[...]\n  What we want to know, then, is that well-typed terms do not get stuck. We show this in two steps, commonly known as the <em>progress</em> and <em>preservation</em> theorems.</p>\n  \n  <ul>\n  <li><em>Progress</em>: a well-typed term is not stuck (either it is a value or it can take a step according to the evaluation rules).</li>\n  <li><em>Preservation</em>: If a well-typed term takes a step of evaluation, then the resulting term is also well-typed.</li>\n  </ul>\n  \n  <p>These properties together tell us that a well-typed term can never reach a stuck state during evaluation.</p>\n</blockquote>\n\n<p>Note that this definition of type safety doesn't exclude the possibility that a well-typed term will loop for ever, or throw an exception. But those two rules do make the guarantee that if you've successfully obtained an <code>Int</code> then it <em>really is an <code>Int</code></em> and not a <code>Bool</code> or a <code>Spoon</code> or <code>Ennui</code>. (In Haskell this is somewhat complicated by laziness, but the basic idea remains true.) This is a very useful property, and programmers learn to rely upon it crucially in their daily workflow!</p>\n\n<p>Allow me a digression. Just as logically-inconsistent-but-still-type-safe systems are useful and trustworthy in practice, type-unsafe-but-still-statically-checked systems are also useful in practice (though some may balk at calling them \"trustworthy\"). Look to the JavaScript ecosystem, where \"gradually typed\" systems such as <a href=\"https://www.typescriptlang.org/\" rel=\"noreferrer\">TypeScript</a> and <a href=\"https://flow.org/\" rel=\"noreferrer\">Flow</a> are designed to provide an additional layer of support for working programmers - because VanillaJS is a nightmare in even medium-sized codebases - without making bold promises like progress and preservation. (I hear the Python and PHP communities are also gradually (ha ha) adopting types.) TypeScript still successfully catches a large proportion of the human errors I make while programming, and supports changing code in the small and the large, despite not being \"type safe\" in the formal sense.</p>\n\n<p>I guess my point is, the PL community has a tendency to place a great deal of emphasis on <em>proving</em> properties of systems (such as type safety), but that's often not how software engineers get their work done! The engineers I know care about whether a tool helps them write fewer bugs, not about whether it's been proven safe or consistent. I just think each group could learn a lot from the other! When the clever people in the ultra-typed community get together with the clever people in the untyped community to build tools for engineering, <a href=\"https://en.wikipedia.org/wiki/Generics_in_Java\" rel=\"noreferrer\">interesting things can happen</a>.</p>\n\n<blockquote>\n  <p>Would be possible to represent endless loop with no <code>undefined</code>?</p>\n</blockquote>\n\n<p>Sure. Lots of ways.</p>\n\n<pre><code>loop = loop\nfib = 1 : 1 : zipWith (+) fib (tail fib)\nrepeat x = unfoldr (const (Just x))\nmain = forever $ print \"cheese\"\n</code></pre>\n\n<p>From a formal perspective all of these terms are <code>\u22a5</code>, but in practice it matters very much which <code>\u22a5</code> you're running.</p>\n\n<p>If your question was really <em>does the ability to write looping terms imply inconsistency?</em> then the short answer is yes, viz <code>let x = x in x :: forall a. a</code>. That's why proof assistants like Agda typically feature a <em>termination checker</em> which examines the syntax of your program and rejects suspicious-looking usages of general recursion. The longer answer is <a href=\"https://pdfs.semanticscholar.org/e291/5b546b9039a8cf8f28e0b814f6502630239f.pdf\" rel=\"noreferrer\">no, not exactly</a> - you can embed the general-recursive parts of your program in a monad and then implement the semantics of that partiality monad with some external evaluator. (This is precisely the approach that Haskell takes to purity: put the impure parts in the <code>IO</code> monad and delegate execution to the runtime system.)</p>\n\n<p>In conclusion, yes, Haskell is inconsistent as a logic - every type is inhabited by an infinite family of <code>\u22a5</code>s with a variety of runtime behaviours, so you can easily \"prove\" any proposition. That (along with the overall clunkiness of dependent types) is why people don't use Haskell as a theorem prover. For engineering, though, the lesser guarantees of type safety are generally quite enough, and some of those <code>\u22a5</code>s are interesting!</p>\n"}], "owner": {"reputation": 519, "user_id": 2638146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/CGxGv.jpg?s=128&g=1", "display_name": "Rafael Castro", "link": "https://stackoverflow.com/users/2638146/rafael-castro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 2, "accepted_answer_id": 44035178, "answer_count": 2, "score": 12, "last_activity_date": 1495098913, "creation_date": 1495054337, "question_id": 44034591, "link": "https://stackoverflow.com/questions/44034591/is-haskells-type-system-isomorphic-to-an-inconsistent-logic-system-if-so-what", "title": "Is Haskell&#39;s type system isomorphic to an inconsistent logic system? If so, what are the consequences?", "body": "<p>In Haskell there is a term <code>undefined :: a</code>, which is said to be a term\nrepresentation of a bad computation or endless loop. Since <code>undefined</code> has\ntype <code>a</code>, them it's possible to create any syntactic correct type by \napplying type substitutions. So <code>undefined</code> has any type and the o inverse is also true: any type has <code>undefined</code>, which is the bottom value living inside of any type (including the <code>Void</code> type, right?).</p>\n\n<p>Curry-Howard isomorphism gives more than proposition as types, it also gives habited types as theorems.</p>\n\n<p>A logic system with all propositions as theorems is said to be inconsistent.</p>\n\n<p>So, Haskell's type system isomorphic to an inconsistent logic system?</p>\n\n<p>If so, what are the consequences?</p>\n\n<p>If Haskell's type system is a inconsistent proof system, them we can't trust it?</p>\n\n<p>Would be possible to represent endless loop with no <code>undefined</code>?</p>\n"}, {"tags": ["haskell", "vim"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1495053403, "post_id": 44033839, "comment_id": 75095356, "body": "I hate to point out the obvious, but if haskellmode is still running scripts you quite apparently didn&#39;t disable it correctly."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1495054208, "post_id": 44033839, "comment_id": 75095748, "body": "You might try asking at the <a href=\"https://vi.stackexchange.com/\">VI &amp; VIm SE</a>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1495058069, "creation_date": 1495058069, "answer_id": 44035375, "question_id": 44033839, "link": "https://stackoverflow.com/questions/44033839/loading-of-haskell-source-file-is-too-slow-in-vim/44035375#44035375", "title": "Loading of Haskell source file is too slow in vim", "body": "<p>Use <code>:PluginClean</code> to delete plugins after you comment them out of your <code>.vimrc</code>. See also <code>:help vundle</code> for further details.</p>\n"}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 44035375, "answer_count": 1, "score": 1, "last_activity_date": 1495058069, "creation_date": 1495051390, "question_id": 44033839, "link": "https://stackoverflow.com/questions/44033839/loading-of-haskell-source-file-is-too-slow-in-vim", "title": "Loading of Haskell source file is too slow in vim", "body": "<p>After waiting for a while (2 or 3 minutes) to open .hs file in vim, I am getting following errors:</p>\n\n<pre><code>Error detected while processing ~/.vim/bundle/haskellmode-vim/ftplugin/haskell_doc.vim:\nline  111:\nhaskell_doc.vim can't find locaton of html documentation (set g:haddock_docdir).\nghcmod: vimproc.vim is not installed!\n</code></pre>\n\n<p>I am getting these errors even though I disabled haskellmode, vimproc and ghcmod plugins. Here is a snippet from my .vimrc (I am using vundle plugin to load plugins into the vim):</p>\n\n<pre><code>\" Haskell plugins\n\" Plugin 'lukerandall/haskellmode-vim'\n\" Plugin 'eagletmt/ghcmod-vim'\nPlugin 'scrooloose/syntastic'\nPlugin 'eagletmt/neco-ghc'\n\"Plugin 'dag/vim2hs'\n\"Plugin 'Shougo/vimproc.vim'\n</code></pre>\n\n<p>Could you please help me figure out why my vim is so slow and throwing those errors? Thanks.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1495048268, "last_edit_date": 1495048268, "creation_date": 1495047646, "answer_id": 44032864, "question_id": 44032662, "link": "https://stackoverflow.com/questions/44032662/how-can-i-find-the-depth-of-an-branch-in-haskell/44032864#44032864", "title": "How can i find the depth of an branch in Haskell?", "body": "<p>It sounds as if you want to work out the solution for yourself, but here\u2019s a hint: have you written an in-order or depth-first traversal function yet?</p>\n\n<p>You can give your traversal function another parameter that remembers the depth.  Each recursive call increments it.  Instead of adding the contents of the node to the list, add the depth.</p>\n\n<p>If you haven\u2019t gotten to that yet, a good way to write that function is to add an accumulating parameter that constructs the list.  You start at the root with an empty list and depth 1, and each time you hit a leaf node, you append the current depth to the end of the list.  At a parent node, you concatenate the current depth with the lists you get back from calling the function on the daughters.</p>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 7291355, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ed78a444f6b132a5c6af56e3c51462cb?s=128&d=identicon&r=PG&f=1", "display_name": "Fl4mer", "link": "https://stackoverflow.com/users/7291355/fl4mer"}, "edited": false, "score": 0, "creation_date": 1495049588, "post_id": 44032955, "comment_id": 75093188, "body": "I know that i implement a recursive call wich calc n+1 and then recursive call with the xs list. But the exact call... I dont know"}, {"owner": {"reputation": 387, "user_id": 7291355, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ed78a444f6b132a5c6af56e3c51462cb?s=128&d=identicon&r=PG&f=1", "display_name": "Fl4mer", "link": "https://stackoverflow.com/users/7291355/fl4mer"}, "edited": false, "score": 0, "creation_date": 1495050122, "post_id": 44032955, "comment_id": 75093482, "body": "Can u help me ryachza ?"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 387, "user_id": 7291355, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ed78a444f6b132a5c6af56e3c51462cb?s=128&d=identicon&r=PG&f=1", "display_name": "Fl4mer", "link": "https://stackoverflow.com/users/7291355/fl4mer"}, "edited": false, "score": 1, "creation_date": 1495051231, "post_id": 44032955, "comment_id": 75094165, "body": "@Fl4mer Nykros answer is almost exactly what I had myself. Call <code>go (n+1)</code> with each element of <code>xs</code> and concatenate the results."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 387, "user_id": 7291355, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ed78a444f6b132a5c6af56e3c51462cb?s=128&d=identicon&r=PG&f=1", "display_name": "Fl4mer", "link": "https://stackoverflow.com/users/7291355/fl4mer"}, "edited": false, "score": 0, "creation_date": 1495901460, "post_id": 44032955, "comment_id": 75448593, "body": "@Fl4mer Happy to help. If my answer or any other one solved your issue, please mark it as accepted."}], "tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 1, "last_activity_date": 1495048016, "creation_date": 1495048016, "answer_id": 44032955, "question_id": 44032662, "link": "https://stackoverflow.com/questions/44032662/how-can-i-find-the-depth-of-an-branch-in-haskell/44032955#44032955", "title": "How can i find the depth of an branch in Haskell?", "body": "<p>I left the recursive call unimplemented perhaps this shell may help:</p>\n\n<pre><code>depths :: (Num b) =&gt; NBaum a -&gt; [b]\ndepths = go 1\n  where\n    go n (NBlatt _) = [n]\n    go n (NKnoten _ xs) = error \"depths.go: not implemented\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 0, "last_activity_date": 1495050988, "last_edit_date": 1495050988, "creation_date": 1495050198, "answer_id": 44033524, "question_id": 44032662, "link": "https://stackoverflow.com/questions/44032662/how-can-i-find-the-depth-of-an-branch-in-haskell/44033524#44033524", "title": "How can i find the depth of an branch in Haskell?", "body": "<p>Please, check it out. The idea is that the same function is applied to each of the substrees in the <code>NKnoten</code>, and the results are joined in a single list using <code>concat</code>.</p>\n\n<pre><code>depths :: (Num b) =&gt; NBaum a -&gt; [b]\ndepths = go 1\n  where\n    go n (NBlatt _) = [n]\n    go n (NKnoten _ xs) = concat (map (go (n+1)) xs)\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 7291355, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ed78a444f6b132a5c6af56e3c51462cb?s=128&d=identicon&r=PG&f=1", "display_name": "Fl4mer", "link": "https://stackoverflow.com/users/7291355/fl4mer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1495054004, "creation_date": 1495046864, "last_edit_date": 1495054004, "question_id": 44032662, "link": "https://stackoverflow.com/questions/44032662/how-can-i-find-the-depth-of-an-branch-in-haskell", "title": "How can i find the depth of an branch in Haskell?", "body": "<p>I want to implement a function that gives me the depth of every branch from a tree and pack the integers of the depth in a list.\nI know how I can find the maximum and the minimum, but I don't know how to find the other ones.</p>\n\n<p>My code with an example tree:</p>\n\n<p>Init my tree:</p>\n\n<pre><code>data NBaum a = NBlatt a | NKnoten a [NBaum a]\n  deriving(Eq,Show)\n</code></pre>\n\n<p>Example tree:</p>\n\n<pre><code>NKnoten \"Sonne\"[NKnoten \"Jupiter\" [NBlatt \"Io\", NBlatt \"Europa\", NBlatt \"Ganymed\", NBlatt \"Kallisto\"],NKnoten \"Mars\" [NBlatt \"Phobos\", NBlatt \"Deimos\"],NBlatt \"Merkur\", NBlatt \"Venus\", NKnoten \"Erde\" [NBlatt \"Mond\"]]\n</code></pre>\n\n<p>Maximum depth:</p>\n\n<pre><code>tdepth (NBlatt a) = 1\ntdepth (NKnoten _ b) = 1 + maximum [tdepth branch | branch &lt;- b]\n</code></pre>\n\n<p>Minimum depth:</p>\n\n<pre><code>tdepth (NBlatt a) = 1\ntdepth (NKnoten _ b) = 1 + minimum [tdepth branch | branch &lt;- b]\n</code></pre>\n\n<p>The solution for the example tree, which I will have: <code>[2,2,3,3,3,3,3,3,3]</code>. The elements of the lists can have another order.</p>\n"}, {"tags": ["haskell", "type-families"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 2, "creation_date": 1495029173, "post_id": 44025525, "comment_id": 75080043, "body": "As far as I can tell, that&#39;s as good as it gets."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495033571, "post_id": 44027404, "comment_id": 75083581, "body": "I find this to be less readable than the OP&#39;s, but +1 anyway since it&#39;s interesting."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 2, "last_activity_date": 1495030557, "creation_date": 1495030557, "answer_id": 44027404, "question_id": 44025525, "link": "https://stackoverflow.com/questions/44025525/how-do-i-simplify-this-type-level-function-that-compares-symbols/44027404#44027404", "title": "How do I simplify this type-level function that compares symbols?", "body": "<p>Sure, here it is as a single type family <code>Merge'</code> and a type synonym <code>Merge</code>:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE UndecidableInstances #-}\nmodule Merge where\n\nimport Data.Proxy\nimport GHC.TypeLits\n\ntype family Merge' (mord :: Maybe Ordering) (as :: [(Symbol,*)]) (bs :: [(Symbol,*)]) :: [(Symbol,*)] where\n  Merge' 'Nothing '[] bs = bs\n  Merge' 'Nothing as '[] = as\n  Merge' 'Nothing (('(k1, a)) : at) (('(k2, b)) : bt) = Merge' ('Just (CmpSymbol k1 k2)) (('(k1, a)) : at) (('(k2, b)) : bt)\n\n  Merge' ('Just 'LT) (a : as) (b : bs) = a : Merge' 'Nothing as (b : bs)\n  Merge' ('Just 'EQ) (a : as) (b : bs) = a : Merge' 'Nothing as bs\n  Merge' ('Just 'GT) (a : as) (b : bs) = b : Merge' 'Nothing (a : as) bs\n\ntype Merge as bs = Merge' 'Nothing as bs\n\ntest :: Proxy (Merge ['(\"A\", Int), '(\"Hello\", Maybe Char), '(\"Z\", Bool)] ['(\"Hello\", String), '(\"F\", ())])\ntest = Proxy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": true, "score": 2, "last_activity_date": 1495076808, "creation_date": 1495076808, "answer_id": 44037948, "question_id": 44025525, "link": "https://stackoverflow.com/questions/44025525/how-do-i-simplify-this-type-level-function-that-compares-symbols/44037948#44037948", "title": "How do I simplify this type-level function that compares symbols?", "body": "<p>I guess this may not be what you want, but you can promote a function to a closed type family using <code>Data.Promotion.TH</code> in <a href=\"http://hackage.haskell.org/package/singletons\" rel=\"nofollow noreferrer\">singletons</a> package. It's very handy to write this kind of type functions.</p>\n\n<pre><code>{-# LANGUAGE DataKinds, FlexibleContexts, GADTs, PolyKinds, ScopedTypeVariables,\n             TemplateHaskell, TypeFamilies, UndecidableInstances #-}\n\nimport Data.Proxy\nimport Data.Promotion.TH\nimport Data.Singletons.Prelude\n\npromote [d|\n    data KVPair k v = Pair k v\n\n    merge :: Ord k =&gt; [KVPair k a] -&gt; [KVPair k a] -&gt; [KVPair k a]\n    merge [] bs = bs\n    merge as [] = as\n    merge as@((Pair ka va):ass) bs@((Pair kb vb):bss) =\n        case compare ka kb of\n            LT -&gt; (Pair ka va):merge ass bs\n            EQ -&gt; (Pair ka va):merge ass bss\n            GT -&gt; (Pair kb vb):merge as bss\n  |]\n\ntest :: Proxy (Merge [Pair \"A\" Int, Pair \"Hello\" (Maybe Char), Pair \"Z\" Bool] [Pair \"Hello\" String, Pair \"F\" ()])\ntest = Proxy\n</code></pre>\n"}], "owner": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 44037948, "answer_count": 2, "score": 3, "last_activity_date": 1495076808, "creation_date": 1495025784, "question_id": 44025525, "link": "https://stackoverflow.com/questions/44025525/how-do-i-simplify-this-type-level-function-that-compares-symbols", "title": "How do I simplify this type-level function that compares symbols?", "body": "<p>I have some code where I need a type-level function that takes two lists of key-value pairs that are sorted on the keys and has each key only once and then merges them into one such list (preferring the first list if keys exist in both lists).</p>\n\n<p>After a lot of trial-and-error I finally managed to get the following working:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, KindSignatures, PolyKinds, TypeFamilies, TypeOperators, UndecidableInstances #-}\n\nimport Data.Proxy\nimport GHC.TypeLits\n\ndata KVPair s a = Pair s a\n\ntype family Merge (as :: [KVPair Symbol *]) (bs :: [KVPair Symbol *]) :: [KVPair Symbol *] where\n  Merge '[] bs = bs\n  Merge as '[] = as\n  Merge ((Pair k1 a) : as) ((Pair k2 b) : bs) = Merge' (CmpSymbol k1 k2) ((Pair k1 a) : as) ((Pair k2 b) : bs)\n\ntype family Merge' (ord :: Ordering) (as :: [k]) (bs :: [k]) :: [k] where\n  Merge' LT (a : as) (b : bs) = a : Merge as (b : bs)\n  Merge' EQ (a : as) (b : bs) = a : Merge as bs\n  Merge' GT (a : as) (b : bs) = b : Merge (a : as) bs\n\ntest :: Proxy (Merge [Pair \"A\" Int, Pair \"Hello\" (Maybe Char), Pair \"Z\" Bool] [Pair \"Hello\" String, Pair \"F\" ()])\ntest = Proxy\n</code></pre>\n\n<p>and when asking for the type of <code>test</code> in GHCi you get the expected:</p>\n\n<pre><code>*Main&gt; :t test\ntest\n  :: Proxy\n       '['Pair \"A\" Int, 'Pair \"Hello\" (Maybe Char), 'Pair \"F\" (),\n         'Pair \"Z\" Bool]\n</code></pre>\n\n<p>This uses two type families so that the second one can actually pattern-match on the ordering of the keys, but that seems a lot more complicated than it ought to be. Is there a way to get a similar situation going with just a single type family?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1495025561, "post_id": 44025232, "comment_id": 75077107, "body": "I&#39;m unclear on what you&#39;re asking here. &quot;In <code>f</code>, I&#39;d like to access to the Int in the last type argument of <code>StateT [Int] IO Int</code>&quot; - the last type argument is the <i>return type</i> of the monadic computation, not something you can access from within. Could you post some code you&#39;ve tried along with the error you&#39;re getting?"}, {"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1495028737, "post_id": 44025232, "comment_id": 75079699, "body": "Maybe you meant <code>f :: Int -&gt; StateT [Int] IO Int</code> ?"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1495031368, "post_id": 44025232, "comment_id": 75081809, "body": "There is no &quot;inner <code>a</code>, i.e. <code>55</code>&quot; until you run the calculation, except for the case where you know in advance that <code>x</code> is <code>return something</code>; in which case you should just pass <code>something</code> in the first place."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1495034873, "post_id": 44025232, "comment_id": 75084570, "body": "It&#39;s hard to get a starting point for an answer here since <code>f x</code> is ill-typed as others have pointed out"}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495105274, "post_id": 44029311, "comment_id": 75117104, "body": "Thanks for this helpful, detailed answer!"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 5, "last_activity_date": 1495035530, "creation_date": 1495035530, "answer_id": 44029311, "question_id": 44025232, "link": "https://stackoverflow.com/questions/44025232/getting-access-to-a-in-statet/44029311#44029311", "title": "Getting Access to &#39;a&#39; in StateT", "body": "<p>Ok, here's what say you want:</p>\n\n<pre><code>&gt;&gt;&gt; let x = return 55 ::  StateT [Int] IO Int\n&gt;&gt;&gt; runStateT (f x) [1,2,3]\n(56, [2,3])\n</code></pre>\n\n<p>So let's work backwards from that.</p>\n\n<p>From the use of <code>f</code>, we can infer its type - </p>\n\n<pre><code>f :: StateT [Int] IO Int -&gt; StateT [Int] IO Int\n</code></pre>\n\n<p>Note the difference from your given type for <code>f</code> in the question - namely <code>f</code> is a function between values of type <code>StateT [Int] IO Int</code>, not a value of that type.</p>\n\n<p>To define <code>f</code>, we need <code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>. This will allow us to take our input of type <code>StateT [Int] IO Int</code> and run some computation on the <code>Int</code> the input computes.</p>\n\n<pre><code>f x = x &gt;&gt;= \\i -&gt; state (splitAt 1) &gt;&gt;= \\[j] -&gt; return (i + j)\n</code></pre>\n\n<p>or, using do-notation:</p>\n\n<pre><code>f x = do\n  i &lt;- x\n  [j] &lt;- state (splitAt 1)\n  return (i + j)\n</code></pre>\n\n<p>Which gives us exactly the result we want.</p>\n\n<p>While this works, it's highly non-idiomatic. Rather than passing monadic values in as inputs to functions and binding them inside the function, it's far more common to define functions that take regular values and return monadic ones, using the bind operator (<code>&gt;&gt;=</code>) <em>outside</em>.</p>\n\n<p>So it'd be far more normal to define</p>\n\n<pre><code>shiftAdd :: Int -&gt; StateT [Int] IO Int\nshiftAdd i = do\n  [j] &lt;- state (splitAt 1)\n  return (i + j)\n</code></pre>\n\n<p>So now we can run not only</p>\n\n<pre><code>&gt;&gt;&gt; runStateT (shiftAdd 55) [1,2,3]\n(56,[2,3])\n</code></pre>\n\n<p>but also</p>\n\n<pre><code>&gt;&gt;&gt; runStateT (shiftAdd 55 &gt;&gt;= shiftAdd &gt;&gt;= shiftAdd)\n(61,[])\n</code></pre>\n\n<p>It's still not as idiomatic as it could be as:</p>\n\n<ul>\n<li>I made it unnecessarily partial by using <code>splitAt</code> (it'll throw an exception if the state list is empty)</li>\n<li>it's unnecessarily specific (doesn't use IO at all, but we can't use it with other base monads)</li>\n</ul>\n\n<p>Fixing that up gives us:</p>\n\n<pre><code>shiftAdd' :: (Monad m, Num a) =&gt; a -&gt; StateT [a] m a\nshiftAdd' i = state $ \\js -&gt; case js of\n  [] -&gt; (i, [])\n  j : js -&gt; (i + j, js)\n</code></pre>\n\n<p>Which works just fine:</p>\n\n<pre><code>&gt;&gt;&gt; runStateT (return 55 &gt;&gt;= shiftAdd') [1,2,3]\n(56,[2,3])\n&gt;&gt;&gt; runStateT (return 55 &gt;&gt;= shiftAdd' &gt;&gt;= shiftAdd' &gt;&gt;= shiftAdd') [1,2,3]\n(61,[])\n&gt;&gt;&gt; runStateT (return 55 &gt;&gt;= shiftAdd' &gt;&gt;= shiftAdd' &gt;&gt;= shiftAdd') []\n(55,[])\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 44029311, "answer_count": 1, "score": 0, "last_activity_date": 1495035530, "creation_date": 1495025011, "question_id": 44025232, "link": "https://stackoverflow.com/questions/44025232/getting-access-to-a-in-statet", "title": "Getting Access to &#39;a&#39; in StateT", "body": "<p>I'm trying to write a function with <code>StateT</code> only to learn more about it.</p>\n\n<p>In <code>f</code>, I'd like to access to the <code>Int</code> in the last type argument of <code>StateT [Int] IO Int</code>:</p>\n\n<pre><code>f :: StateT [Int] IO Int\nf = state $ \\xs -&gt; update (error \"I want a\") xs\n\nupdate :: Int -&gt; [Int] -&gt; (Int, [Int])      \nupdate x []     = (x, [])\nupdate x (y:ys) = (x+y, ys) \n</code></pre>\n\n<p>Here's how I'd like to call it:</p>\n\n<p><code>let x = return 55 ::  StateT [Int] IO Int</code></p>\n\n<p>Referencing <code>runStateT</code>:</p>\n\n<pre><code>*Main&gt; :t runStateT\nrunStateT :: StateT s m a -&gt; s -&gt; m (a, s)\n</code></pre>\n\n<p>I'd expect to run it:</p>\n\n<p><code>runStateT (f x) [1,2,3]</code></p>\n\n<p>to get the following from GHCI, i.e. the <code>IO (Int, [Int])</code> gets printed:</p>\n\n<pre><code>(56, [2,3])\n</code></pre>\n\n<p>since the inner <code>a</code>, i.e. <code>55</code>, <code>+ 1</code>, i.e. from <code>[1,2,3]</code>, returns <code>(56, [2,3])</code>.</p>\n\n<p>How can I write the above function, getting access to the <code>a</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495025408, "post_id": 44023915, "comment_id": 75076976, "body": "What is the expected behavior if you want to update a list where the index you look for is <code>Nothing_</code>?"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1495029519, "post_id": 44023915, "comment_id": 75080325, "body": "Let me intrude, did you choose the array representation or it was given? Any reason why you cant use Haskell&#39;s <code>Maybe</code>? It look&#39;s more like a <code>Map</code> than a <code>Array</code> because you dont store the size of the array anyware."}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1495027279, "post_id": 44025421, "comment_id": 75078489, "body": "Hey, thanks for you valuable explanations. Yet, after proof-reading your code and testing it, I have the same error I had :  <code>Couldn&#39;t match expected type \u2018Array_ a\u2019 with actual type \u2018[(Int, Maybe_ a)]\u2019</code> It&#39;s related to the last branch."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1495027448, "post_id": 44025421, "comment_id": 75078626, "body": "@PierreP.: oops, that was a reasoning error. Should be fixed."}, {"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1495027970, "post_id": 44025421, "comment_id": 75079073, "body": "Thanks. It works. Yet, could you explain me how you  fixed the reasoning error?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1495028234, "post_id": 44025421, "comment_id": 75079304, "body": "@PierreP.: well it is simply because you wrap your &quot;array&quot; in an <code>A</code> constructor, so in order to do the recursion, we first need to get the inner list out of the array, prepend the element, and then call the constructor again."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1495027367, "last_edit_date": 1495027367, "creation_date": 1495025507, "answer_id": 44025421, "question_id": 44023915, "link": "https://stackoverflow.com/questions/44023915/operation-on-newly-created-data-update-an-array/44025421#44025421", "title": "Operation on newly created data (update an array)", "body": "<p>First of all it is a bit <em>un-Haskell</em> to work with tuples, usually you define separate parameters, like:</p>\n\n<pre><code>update :: Int -&gt; Array_ a -&gt; a -&gt; Array_ a\n</code></pre>\n\n<p>So that you can easily work with an <code>update 5</code> function where you will later provide additional arguments.</p>\n\n<p>Nevertheless the problem is that in your last branch:</p>\n\n<pre><code>| i /= j = update i (A l) new_value\n</code></pre>\n\n<p>you thus perform a recursive call, but the result of that recursive call will be the <em>final</em> result. In order to solve this issue, you simply prepend the item that you inspected, and did not match the index. Since you do this for all index failure, all indices that do not match will be in the final result, so:</p>\n\n<pre><code>| i /= j = <b>(j, Just_ x) : </b>update i (A l) new_value.</code></pre>\n\n<p>So now we obtain:</p>\n\n<pre><code>update :: Int -&gt; Array_ a -&gt; a -&gt; Array_ a\nupdate i (A []) new_value = error( ( show i ) ++ \" is not an index\" )\nupdate i (A ((j, Just_ x):l)) new_value\n    | i == j = A ((j, Just_ new_value):l)\n    | i /= j = let A t = update i (A l) new_value in A ((j, Just_ x):t)\n</code></pre>\n\n<p>That being said there are still some things we can do to improve our function:</p>\n\n<ul>\n<li>variables we do not take into account are usually written with a wildcard,</li>\n<li>we can use an <em>alias</em> <code>@</code> to prevent us from repacking the head of the list.</li>\n<li>the compiler will probably error since you use <code>==</code> and <code>/=</code>. It is better to use <code>otherwise</code> (an alias of <code>True</code> in the last branch (this is more or less equivalent with <code>else</code> in Java).</li>\n<li>there are some additional beautifications you can obtain with <code>hlint</code>.</li>\n</ul>\n\n<p>If we take the above comments into account, an - in my opinion - more elegant function would be:</p>\n\n<pre><code>update :: Int -&gt; Array_ a -&gt; a -&gt; Array_ a\nupdate i (A []) _ = error $ show i ++ \" is not an index\"\nupdate i (A (h@(j,Just_):l)) new_value\n    | i == j = A ((j, Just_ new_value):l)\n    | otherwise = let A t = update i (A l) new_value in A (h:t)\n</code></pre>\n\n<p>Finally there is still a case unresolved: what to do if there are <code>Nothing_</code>s in your list. If you don't care whether the value is a <code>Just_ x</code> or a <code>Nothing_</code>, you can rewrite it like:</p>\n\n<pre><code>update :: Int -&gt; Array_ a -&gt; a -&gt; Array_ a\nupdate i (A []) _ = error $ show i ++ \" is not an index\"\nupdate i (A (h@(j,_):l)) new_value\n    | i == j = A ((j, Just_ new_value):l)\n    | otherwise = let A t = update i (A l) new_value in A (h:t)\n</code></pre>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 44025421, "answer_count": 1, "score": 0, "last_activity_date": 1495027367, "creation_date": 1495021445, "question_id": 44023915, "link": "https://stackoverflow.com/questions/44023915/operation-on-newly-created-data-update-an-array", "title": "Operation on newly created data (update an array)", "body": "<p>I've created the following data types.</p>\n\n<pre><code>{- Data declaration predefined in Haskell -}\ndata Maybe_ a = Nothing_ | Just_ a deriving( Show )\n\n{- Array declaration -}\ndata Array_ a = A [ ( Int, Maybe_ a ) ] deriving( Show )\n</code></pre>\n\n<p>Now, I'd like to create an update function that - given an index, an <code>Array_</code> and a new value - update the value of the array at the given index. </p>\n\n<p>Here's the signature of the function ...</p>\n\n<pre><code>update :: ( Int, Array_ a, a ) -&gt; Array_ a\n</code></pre>\n\n<p>... and here's the complete function</p>\n\n<pre><code>update :: ( Int, Array_ a, a ) -&gt; Array_ a\nupdate( i, A[], new_value ) = error( ( show i ) ++ \" is not an index\" )\nupdate( i, A( ( j, Just_ x ):l ), new_value )\n    | i == j = A( ( j, Just_ new_value ):l )\n    | i /= j = update ( i, A l, new_value )\n</code></pre>\n\n<p>The issue occurs at the last line of the function. <strong>It's a recursive call to the end of the list, but it doesn't keep the previously consider elements of the array.</strong></p>\n\n<p>I was thinking of using either the <code>++</code> operator or the <code>:</code> one, but both of the time I get an error. </p>\n\n<p><code>... i /= j = ( j, Just_ x ):update ( i, A l, new_value )</code></p>\n\n<p><code>... i /= j = A[( j, Just_ x )] ++ update ( i, A l, new_value )</code></p>\n\n<p>How can I handle this differently? </p>\n"}, {"tags": ["haskell", "dependent-type", "idris"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 7, "creation_date": 1495016496, "post_id": 44021114, "comment_id": 75070765, "body": "You can easily translate Idris&#39;s <code>Fin</code>: <code>data Fin n where { FZ :: Fin (S n) ; FS :: Fin n -&gt; Fin (S n) }</code>. If you&#39;re sure you need an efficient runtime representation then you basically have to do what you did in your question - stuff a machine <code>Int</code> into a <code>newtype</code> and use a phantom type for its size. To make up for the lack of GADT constructors you have to write higher order programs using <code>fold :: (forall n. r n -&gt; r (S n)) -&gt; (forall n. r (S n)) -&gt; Fin m -&gt; r m</code> (and implementing <code>fold</code> requires <code>unsafeCoerce</code>)."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 3, "creation_date": 1495036017, "post_id": 44021114, "comment_id": 75085401, "body": "The Orgazoid - you should upgrade that to an answer."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1495039369, "post_id": 44021114, "comment_id": 75087493, "body": "@rampion Good idea :)"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 2, "creation_date": 1495096349, "post_id": 44021114, "comment_id": 75110914, "body": "For what it&#39;s worth, the thing you write in your question is already offered as the <a href=\"http://hackage.haskell.org/package/finite-typelits\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/finite-typelits</a> library"}, {"owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1495100142, "post_id": 44021114, "comment_id": 75113628, "body": "@JustinL. thank you, that is probably the most useful to me right now."}], "answers": [{"comments": [{"owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "edited": false, "score": 0, "creation_date": 1495042105, "post_id": 44030376, "comment_id": 75089140, "body": "Is there a library that implements something like this?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "edited": false, "score": 0, "creation_date": 1495042205, "post_id": 44030376, "comment_id": 75089192, "body": "Not that I&#39;m aware of. DT programming in Haskell is still unusual (and painful) enough that we don&#39;t have a huge collection of mature libs. Maybe someone will arrive here with a suggestion..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "edited": false, "score": 0, "creation_date": 1495042364, "post_id": 44030376, "comment_id": 75089284, "body": "I&#39;m of the opinion that this sort of stuff is fun but usually not a good idea for production code. I think this opinion is reasonably widespread, which would partly explain the lack of community libraries."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "edited": false, "score": 0, "creation_date": 1495046014, "post_id": 44030376, "comment_id": 75091295, "body": "@user1747134 There&#39;s finite-typelits <a href=\"http://hackage.haskell.org/package/finite-typelits\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/finite-typelits</a> but I&#39;m not sure if it truly corresponds to Idris&#39; <code>Fin</code>. It is used in the package vector-sized <a href=\"http://hackage.haskell.org/package/vector-sized\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/vector-sized</a>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 5, "creation_date": 1495047612, "post_id": 44030376, "comment_id": 75092121, "body": "You can also use <code>PatternSynonyms</code> to make the constructor values above into two-way patterns - <code>pattern FZ :: Fin (S n) ; pattern FZ = Fin 0</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1495055455, "post_id": 44030376, "comment_id": 75096315, "body": "The safe way to do the dangerous optimization is to use <code>Natural</code> instead of <code>Int</code>. That avoids overflow trouble. If @rampion hadn&#39;t suggested pattern synonyms, I would have; it&#39;s the Right Way to offer an interface. Be sure to use a <code>COMPLETE</code> pragma with GHC 8.2 to let it know that <code>FZ</code> and <code>FS</code> cover all the cases."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1495064764, "post_id": 44030376, "comment_id": 75099463, "body": "@rampion @dfeuer Thanks, I didn&#39;t know you could give type signatures to pattern synonyms. Looks like they still don&#39;t behave like GADTs though? <code>pattern FS :: Fin n -&gt; Fin (S n) ; pattern FS f &lt;- (Fin . pred . unFin -&gt; f) where FS f = Fin (unFin f + 1)</code> gives a type error when you attempt to match <code>FS</code> on a value typed as <code>Fin n</code>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1495074166, "post_id": 44030376, "comment_id": 75101630, "body": "@The Organzoid - that&#39;s not a very good pattern for <code>FS</code> - it&#39;ll match <code>FZ</code> so <code>case FZ of { FS (Fin i) -&gt; i ; _ -&gt; 1 }</code> evaluates to -1. You want a conditional - <code>pattern FS f &lt;- (finPred -&gt; Just f) where FS = finSucc</code>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1495074392, "post_id": 44030376, "comment_id": 75101685, "body": "<a href=\"https://gist.github.com/rampion/e05fad464a0c5cd4916fc0c027bc8467\" rel=\"nofollow noreferrer\">here&#39;s a gist</a> though if you&#39;re on GHC 8.2+ you should definitely use a <code>COMPLETE</code> pragma."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 2, "creation_date": 1495074877, "post_id": 44030376, "comment_id": 75101770, "body": "@rampion, your gist doesn&#39;t actually get it quite right. We want matching on the patterns to reveal type information. With your code, we need the type information to use the patterns. For example, try writing a function <code>f :: Fin n -&gt; Int</code> that matches on the constructors; it will not typecheck, because it needs to know that <code>n</code> is a successor to use the patterns. See my answer."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495076010, "post_id": 44030376, "comment_id": 75102040, "body": "@dfeuer - that&#39;s a good point, but it&#39;s worth saying that this <code>Fin Z</code> is just a fancy name for <code>Void</code>, so stating <code>Fin (S n)</code> is just saying &quot;this is not <code>Void</code>&quot;"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1495076965, "post_id": 44030376, "comment_id": 75102243, "body": "@rampion, you get a bit more out of it than that. As you pattern match through <code>FS</code> constructors, you learn more and more about the <code>Fin</code> index. You can never pin it down entirely (without additional evidence), but you can bound it from below."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 12, "last_activity_date": 1495042005, "last_edit_date": 1495042005, "creation_date": 1495038757, "answer_id": 44030376, "question_id": 44021114, "link": "https://stackoverflow.com/questions/44021114/what-is-the-preferred-alternative-to-fin-from-idris-in-haskell/44030376#44030376", "title": "What is the preferred alternative to Fin from Idris in Haskell", "body": "<p>You can directly translate Idris's <code>Fin</code> into the usual Haskell mishmash of sort-of-dependently-typed features.</p>\n\n<pre><code>data Fin n where\n    FZ :: Fin (S n)\n    FS :: Fin n -&gt; Fin (S n)\n\n(!) :: Vec n a -&gt; Fin n -&gt; a\n(x :&gt; xs) ! FZ = x\n(x :&gt; xs) ! (FS f) = xs ! f\n</code></pre>\n\n<p>With <code>TypeInType</code> you can even have singleton <code>Fin</code>s!</p>\n\n<pre><code>data Finny n (f :: Fin n) where\n    FZy :: Finny (S n) FZ\n    FSy :: Finny n f -&gt; Finny (S n) (FS f)\n</code></pre>\n\n<p>This allows you to fake up <em>dependent quantification over runtime stuff</em>, eg,</p>\n\n<pre><code>type family Fin2Nat n (f :: Fin n) where\n    Fin2Nat (S _) FZ = Z\n    Fin2Nat (S n) (FS f) = S (Fin2Nat n f)\n\n-- tighten the upper bound on a given Fin as far as possible\ntighten :: Finny n f -&gt; Fin (S (Fin2Nat n f))\ntighten FZy = FZ\ntighten (FSy f) = FS (tighten f)\n</code></pre>\n\n<p>but, ugh, it kinda sucks to have to duplicate everything at the value and type level, and writing out all your kind variables (<code>n</code>) can get pretty tedious.</p>\n\n<hr>\n\n<p>If you're really sure you need an efficient runtime representation of <code>Fin</code>, you can do basically what you did in your question: stuff a machine <code>Int</code> into a <code>newtype</code> and use a phantom type for its size. But the onus is on you, the library implementer, to make sure the <code>Int</code> fits the bound!</p>\n\n<pre><code>newtype Fin n = Fin Int\n\n-- fake up the constructors\nfz :: Fin (S n)\nfz = Fin 0\nfs :: Fin n -&gt; Fin (S n)\nfs (Fin n) = Fin (n+1)\n</code></pre>\n\n<p>This version lacks real GADT constructors, so you can't manipulate type equalities using pattern matching. You have to do it yourself using <code>unsafeCoerce</code>. You can give clients a type-safe interface in the form of <code>fold</code>, but they have to be willing to write all their code in a higher-order style, and (since <code>fold</code> is a catamorphism) it becomes harder to look at more than one layer at a time.</p>\n\n<pre><code>-- the unsafeCoerce calls assert that m ~ S n\nfold :: (forall n. r n -&gt; r (S n)) -&gt; (forall n. r (S n)) -&gt; Fin m -&gt; r m\nfold k z (Fin 0) = unsafeCoerce z\nfold k z (Fin n) = unsafeCoerce $ k $ fold k z (Fin (n-1))\n</code></pre>\n\n<p>Oh, and you can't do type level computation (as we did with <code>Fin2Nat</code> above) with this representation of <code>Fin</code>, because type level <code>Int</code>s don't permit induction.</p>\n\n<p>For what it's worth, Idris's <code>Fin</code> is just as inefficient as the GADT one above. The docs contain <a href=\"https://github.com/idris-lang/Idris-dev/blob/29e271c8dd6af842817156cdb17e203e401b0899/libs/base/Data/Fin.idr#L8-L9\" rel=\"noreferrer\">the following caveat</a>:</p>\n\n<blockquote>\n  <p>It's probably not a good idea to use <code>Fin</code> for arithmetic, and they will be exceedingly inefficient at run time.</p>\n</blockquote>\n\n<p>I've heard noises about a future version of Idris being able to spot \"<code>Nat</code> with types\"-style datatypes (like <code>Fin</code>) and automatically erase the proofs and pack the values into machine integers, but as far as I know we're not there yet.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 6, "last_activity_date": 1495086798, "last_edit_date": 1495540510, "creation_date": 1495074656, "answer_id": 44037636, "question_id": 44021114, "link": "https://stackoverflow.com/questions/44021114/what-is-the-preferred-alternative-to-fin-from-idris-in-haskell/44037636#44037636", "title": "What is the preferred alternative to Fin from Idris in Haskell", "body": "<p>rampion <a href=\"https://stackoverflow.com/questions/44021114/what-is-the-preferred-alternative-to-fin-from-idris-in-haskell#comment75092121_44030376\">suggested</a> pattern synonyms, and I agreed, but it is admittedly not entirely trivial to work out how to structure their signatures properly. Thus I figured I'd write a proper answer to give the full code.</p>\n\n<p>First, the usual boilerplate:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE PatternSynonyms #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE ViewPatterns #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE Trustworthy #-}\n\nmodule FakeFin (Nat (..), Fin (FZ, FS), FinView (..), viewFin) where\nimport Numeric.Natural\nimport Unsafe.Coerce\n</code></pre>\n\n<p>Now the basic types:</p>\n\n<pre><code>data Nat = Z | S Nat\n\n-- Fin *must* be exported abstractly (or placed in an Unsafe\n-- module). Users can use its constructor to implement\n-- unsafeCoerce!\nnewtype Fin (n :: Nat) = Fin Natural\nderiving instance Show (Fin n)\n</code></pre>\n\n<p>It is much easier to work via a view type rather than directly, so let's define one:</p>\n\n<pre><code>data FinView n where\n  VZ :: FinView ('S n)\n  VS :: !(Fin n) -&gt; FinView ('S n)\nderiving instance Show (FinView n)\n</code></pre>\n\n<p>It is important to note that we could have defined <code>FinView</code> using explicit equality constraints, because we will have to think in those terms to give correct pattern signatures:</p>\n\n<pre><code>data FinView n where\n  VZ :: n ~ 'S m =&gt; FinView n\n  VS :: n ~ 'S m =&gt; !(Fin m) -&gt; FinView n\n</code></pre>\n\n<p>Now the actual view function:</p>\n\n<pre><code>viewFin :: Fin n -&gt; FinView n\nviewFin (Fin 0) = unsafeCoerce VZ\nviewFin (Fin n) = unsafeCoerce (VS (Fin (n - 1)))\n</code></pre>\n\n<p>The pattern signatures precisely mirror the signatures of the <code>FinView</code> constructors.</p>\n\n<pre><code>pattern FZ :: () =&gt; n ~ 'S m =&gt; Fin n\npattern FZ &lt;- (viewFin -&gt; VZ) where\n  FZ = Fin 0\n\npattern FS :: () =&gt; n ~ 'S m =&gt; Fin m -&gt; Fin n\npattern FS m &lt;- (viewFin -&gt; VS m) where\n  FS (Fin m) = Fin (1 + m)\n\n-- Let GHC know that users need only match on `FZ` and `FS`.\n-- This pragma only works for GHC 8.2 (and presumably future\n-- versions).\n{-# COMPLETE FZ, FS #-}\n</code></pre>\n\n<hr>\n\n<p>For completeness (because it took me rather more effort to write this than I expected), here's one way to write <code>unsafeCoerce</code> if this module accidentally exports the <code>Fin</code> data constructor. I imagine there are probably simpler ways.</p>\n\n<pre><code>import Data.Type.Equality\n\ntype family YahF n a b where\n  YahF 'Z a _ = a\n  YahF _ _ b = b\n\nnewtype Yah n a b = Yah (YahF n a b)\n\n{-# NOINLINE finZBad #-}\nfinZBad :: 'Z :~: n -&gt; Fin n -&gt; a -&gt; b\nfinZBad pf q =\n  case q of\n    FZ -&gt; blah (trans pf Refl)\n    FS _ -&gt; blah (trans pf Refl)\n  where\n    blah :: forall a b m. 'Z :~: 'S m -&gt; a -&gt; b\n    blah pf2 a = getB pf2 (Yah a)\n\n    {-# NOINLINE getB #-}\n    getB :: n :~: 'S m -&gt; Yah n a b -&gt; b\n    getB Refl (Yah b) = b\n\nmyUnsafeCoerce :: a -&gt; b\nmyUnsafeCoerce = finZBad Refl (Fin 0)\n</code></pre>\n\n<p><code>finZBad</code> is where all the action happens, but it doesn't do anything remotely improper! If someone really gives us a non-bottom value of type Fin 'Z, then something has already gone terribly wrong. The explicit type equality evidence here is necessary because if GHC sees code wanting <code>'Z ~ 'S m</code>, it will simply reject it out of hand; GHC doesn't really like hypothetical reasoning in constraints. The <code>NOINLINE</code> annotations are necessary because GHC's simplifier itself uses type information; handling evidence of things it knows very well are impossible confuses it terribly, with extremely arbitrary results. So we block it up and successfully implement The Evil Function.</p>\n"}], "owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 2, "accepted_answer_id": 44030376, "answer_count": 2, "score": 12, "last_activity_date": 1495086798, "creation_date": 1495014013, "last_edit_date": 1495039354, "question_id": 44021114, "link": "https://stackoverflow.com/questions/44021114/what-is-the-preferred-alternative-to-fin-from-idris-in-haskell", "title": "What is the preferred alternative to Fin from Idris in Haskell", "body": "<p>I would like to have a type which can contain values 0 to n, where n lives on the type level. </p>\n\n<p>I was trying something like:</p>\n\n<pre><code>import GHC.TypeLits\nimport Data.Proxy\n\nnewtype FiniteNat n = FiniteNat { toInteger :: Integer }\n\nsmartConstructFiniteNat :: (KnownNat n) =&gt; Proxy n -&gt; Integer -&gt; Maybe (FiniteNat (Proxy n))\nsmartConstructFiniteNat pn i \n  | 0 &lt;= i &amp;&amp; i &lt; n = Just (FiniteNat i)\n  | otherwise       = Nothing\n  where n = natVal pn\n</code></pre>\n\n<p>which works basically, but it's not really satisfying somehow. Is there a \"standard\" solution, or even a library to achieve this? There is a lot of fuss about dependenty typed list-lengths, but I was unable to find something exactly for this. Also - I assume using <code>GHC.TypeLits</code> is necessary, because my <code>n</code> can take on rather large values, so inductive definition would probably be very slow.</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1495050027, "last_edit_date": 1495050027, "creation_date": 1495013015, "answer_id": 44020704, "question_id": 44020154, "link": "https://stackoverflow.com/questions/44020154/how-to-convert-a-shell-line-to-text-in-haskell-turtle-library/44020704#44020704", "title": "How to Convert a `Shell Line` to `Text` in Haskell Turtle Library?", "body": "<p>You can't.  See <a href=\"https://hackage.haskell.org/package/turtle-1.3.3/docs/Turtle-Shell.html#t:Shell\" rel=\"nofollow noreferrer\">the definition of <code>Shell</code></a>*.</p>\n\n<pre><code>newtype Shell a = Shell { _foldIO :: forall r . FoldM IO a r -&gt; IO r }\n</code></pre>\n\n<p>You can only get <code>IO</code> thingies out of it. However you can probably get an <code>IO Text</code>, and since you're doing shell stuff I suspect you have an <code>IO</code> monad context hanging around.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/foldl-1.2.5/docs/src/Control-Foldl.html#FoldM\" rel=\"nofollow noreferrer\"><code>FoldM</code></a> is defined as*</p>\n\n<pre><code>data FoldM m a b =\n   -- FoldM step initial extract\n   forall x . FoldM (x -&gt; a -&gt; m x) (m x) (x -&gt; m b)\n</code></pre>\n\n<p>So if we can construct a <code>FoldM IO Line Text</code> then we can get what we need, I suspect.  Here's a guess (not typechecked, and this is getting kind of complicated so I'm probably making mistakes).</p>\n\n<pre><code>shellToText :: Shell Text -&gt; IO Text\nshellToText shell = foldIO shell foldm\n    where\n    foldm :: FoldM IO Line Text\n    foldm = FoldM (\\accum line -&gt; return (accum &lt;&gt; lineToText line)) -- Text -&gt; Line -&gt; IO Text\n                  (return Text.empty)                                -- IO Text\n                  return                                             -- Text -&gt; IO Text\n</code></pre>\n\n<p>This can probably be considerably simplified by using the <a href=\"https://hackage.haskell.org/package/foldl-1.2.5/docs/Control-Foldl.html#v:mconcat\" rel=\"nofollow noreferrer\">combinators in <code>Control.Foldl</code></a>, but I'll leave that as an exercise. </p>\n\n<p>(*) In case you're not familiar, the first <code>forall</code> indicates a <a href=\"https://wiki.haskell.org/Rank-N_types\" rel=\"nofollow noreferrer\">rank-2 type</a> and the second one indicates an <a href=\"https://wiki.haskell.org/Existential_type\" rel=\"nofollow noreferrer\">existential type</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6184042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c12751a3af1c6ab1b24d0556326edb?s=128&d=identicon&r=PG&f=1", "display_name": "michmach", "link": "https://stackoverflow.com/users/6184042/michmach"}, "is_accepted": false, "score": 4, "last_activity_date": 1503353387, "creation_date": 1503353387, "answer_id": 45806222, "question_id": 44020154, "link": "https://stackoverflow.com/questions/44020154/how-to-convert-a-shell-line-to-text-in-haskell-turtle-library/45806222#45806222", "title": "How to Convert a `Shell Line` to `Text` in Haskell Turtle Library?", "body": "<p><code>strict</code> function to the rescue:</p>\n\n<p><code>strict :: MonadIO io =&gt; Shell Line -&gt; io Text</code></p>\n\n<p>so, you can</p>\n\n<p><code>strict $ inshell \"echo a line of text.\" empty</code></p>\n\n<p>and get the output of the shell command in the IO Text monad.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1503353387, "creation_date": 1495011622, "question_id": 44020154, "link": "https://stackoverflow.com/questions/44020154/how-to-convert-a-shell-line-to-text-in-haskell-turtle-library", "title": "How to Convert a `Shell Line` to `Text` in Haskell Turtle Library?", "body": "<p>Consider <code>(inshell \"echo A line of text.\" empty)</code> has type <code>Shell Line</code>.</p>\n\n<p><strong>Question:</strong> How can one convert a value of this type to <code>Text</code>?</p>\n"}, {"tags": ["list", "haskell", "matrix", "transpose"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495000646, "post_id": 44016508, "comment_id": 75060581, "body": "For the sake of reference (I realise your goal is implementing it yourself): you want to <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html\" rel=\"nofollow noreferrer\"><code>transpose</code> the list of lists</a>."}, {"owner": {"reputation": 315, "user_id": 7940372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e5744471a061ee3bf3a29ce9bb5a4a7?s=128&d=identicon&r=PG&f=1", "display_name": "420fedoras", "link": "https://stackoverflow.com/users/7940372/420fedoras"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495006737, "post_id": 44016508, "comment_id": 75064081, "body": "This is entirely true, I didn&#39;t realise transpose did this at first, but @Ami Tavroy is using the exact method I wanted to understand more about. Thanks to you both!"}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 3, "last_activity_date": 1495001869, "creation_date": 1495001869, "answer_id": 44016959, "question_id": 44016508, "link": "https://stackoverflow.com/questions/44016508/find-all-first-then-all-second-then-all-third-etc-elements-of-lists-in-a-list/44016959#44016959", "title": "Find all first, then all second, then all third etc. elements of lists in a list", "body": "<blockquote>\n  <p>I see that</p>\n</blockquote>\n\n<pre><code>map (!! 1) matrix\n</code></pre>\n\n<blockquote>\n  <p>Will return a list of the second elements of the rows, ie the second column of the matrix; but I don't know how to extend this to all the columns of the matrix in a nice function.</p>\n</blockquote>\n\n<p>If this is the way you want to go, you could simply change this to</p>\n\n<pre><code>map (!!i) matrix\n</code></pre>\n\n<p>in</p>\n\n<pre><code>[map (!!i) matrix | i &lt;- [0.. length (matrix!!0) - 1]]\n</code></pre>\n\n<p>For example</p>\n\n<pre><code>Prelude&gt; let matrix = [[1,2,3],[4,5,6]]\nPrelude&gt; [map (!!i) matrix | i &lt;- [0.. length (matrix!!0) - 1]]\n[[1,4],[2,5],[3,6]]\n</code></pre>\n\n<hr>\n\n<p>Of course the problem with this is that the complexity is unnecessarily high, as the complexity of <code>!!</code> is linear in its argument. Instead, you could build a recursive function as follows:</p>\n\n<ul>\n<li><p>Suppose you split each of the elments of matrix to <code>head</code> and <code>tail</code>, respectively</p></li>\n<li><p>Where do the <code>head</code> of  all of the elements of fit in the transposed matrix?</p></li>\n<li><p>What happens if you now try the same thing on the <code>tail</code> of all of the elements?</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1495005156, "post_id": 44017598, "comment_id": 75063095, "body": "Nice. Out of curiosity, what would be the &quot;haskonic&quot; way of dealing with ragged matrices?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 3, "creation_date": 1495005743, "post_id": 44017598, "comment_id": 75063476, "body": "@AmiTavory Start by deciding what output you want for a ragged matrix, and then find a good implementation of that goal. That is, there are lots of reasonable ways to &quot;transpose&quot; a list of lists that&#39;s not a matrix, and you can&#39;t look for an idiomatic solution until you choose one of them."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 1, "creation_date": 1495007490, "post_id": 44017598, "comment_id": 75064542, "body": "@AmiTavory: I think the problem is indeed how you <i>define</i> a transpose of a ragged matrix. If you look columnwise to the matrix, then you see that there are gaps. How to handle these gaps?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 1, "creation_date": 1495037618, "post_id": 44017598, "comment_id": 75086507, "body": "why not like the built-in <code>transpose</code> does, by gluing them over:  <code>transp [] = [] ; transp xs = concatMap (take 1) xs : transp (filter (not.null) (map (drop 1) xs))</code>. @AmiTavory"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1495037946, "post_id": 44017598, "comment_id": 75086695, "body": "Thank you all for your answers on the comment."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1495010924, "last_edit_date": 1495010924, "creation_date": 1495003972, "answer_id": 44017598, "question_id": 44016508, "link": "https://stackoverflow.com/questions/44016508/find-all-first-then-all-second-then-all-third-etc-elements-of-lists-in-a-list/44017598#44017598", "title": "Find all first, then all second, then all third etc. elements of lists in a list", "body": "<p>If I understand it correctly, you want to calculate the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:transpose\" rel=\"nofollow noreferrer\"><code>transpose :: [[a]] -&gt; [[a]]</code></a> of the matrix:</p>\n\n<pre><code>import Data.List(transpose)\n\ncols :: [[a]] -&gt; [[a]]\ncols = transpose\n</code></pre>\n\n<p>You can implement this in an efficient way as follows:</p>\n\n<pre><code>cols :: [[a]] -&gt; [[a]]\ncols [] = []\ncols ([]:_) = []\ncols l = (map head l) : cols (map tail l)\n</code></pre>\n\n<p>This code works <strong>only for <em>rectangular</em> matrices</strong>. The code works as follows: if we give <code>cols</code> an empty list, or a list where the first <em>row</em> is empty, than we reached the end of the transpose, so we return an empty list.</p>\n\n<p>If on the other hand there is still a list, and the first row contains one element (and since the matrix is square so do the other), we first take the <code>head</code> of all the rows as the column, and then perform recursion on the <code>tail</code>s of the rows to calculate the remaining columns.</p>\n\n<p>The function works in <em>O(n)</em> with <em>n</em> the number of <em>elements</em> (not rows/columns) of the matrix. Or <em>O(r&times;c)</em> with <em>r</em> the number of rows and <em>c</em> the number of columns.</p>\n"}], "owner": {"reputation": 315, "user_id": 7940372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e5744471a061ee3bf3a29ce9bb5a4a7?s=128&d=identicon&r=PG&f=1", "display_name": "420fedoras", "link": "https://stackoverflow.com/users/7940372/420fedoras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 44016959, "answer_count": 2, "score": 4, "last_activity_date": 1495038024, "creation_date": 1494999830, "last_edit_date": 1495038024, "question_id": 44016508, "link": "https://stackoverflow.com/questions/44016508/find-all-first-then-all-second-then-all-third-etc-elements-of-lists-in-a-list", "title": "Find all first, then all second, then all third etc. elements of lists in a list", "body": "<p>Working with a self-made definition of a <em>(9x9)</em> matrix described as a list of lists of <code>Maybe Int</code>s. I want to create a function that returns the <em>9</em> columns of the matrix. I want to do this something like:</p>\n\n<pre><code>cols :: Matrix a -&gt; [Block a]\ncols matrix = map (!! n) matrix\n where\n  n = (the values 1 .. 9)\n</code></pre>\n\n<ul>\n<li><p>Matrix is described as <code>[Rows]</code> or <code>[[values]]</code></p></li>\n<li><p>Block is described as <code>[a]</code></p></li>\n</ul>\n\n<p>So I want the output to be a list of lists, where those lists are a list of the first elements of the rows, the second elements of the rows, etc etc.</p>\n\n<p>I see that</p>\n\n<pre><code>map (!! 1) matrix\n</code></pre>\n\n<p>will return a list of the second elements of the rows, ie the second column of the matrix; but I don't know how to extend this to all the columns of the matrix in a nice function.</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1494999253, "post_id": 44016237, "comment_id": 75059993, "body": "I get &quot;ambiguous redirect&quot; when trying this out."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1495011389, "post_id": 44016237, "comment_id": 75067226, "body": "Tells me the <code>TTY</code> environment variable isn&#39;t set.  You can find it with the <code>tty</code> command.  Anyway, seems like you found your answer already."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1494998549, "creation_date": 1494998549, "answer_id": 44016237, "question_id": 44015884, "link": "https://stackoverflow.com/questions/44015884/launching-programs-example-vim-from-haskell/44016237#44016237", "title": "Launching Programs (example: Vim) from Haskell", "body": "<p>You could try manually setting up I/O to the vty. E.g. in bash: <code>vim &lt; $TTY &gt; $TTY</code>. I guess turtle is doing that with its own file descriptors under the hood, based on the warning, so you should be able to manually set up those redirects (or just use the command I gave via <code>shell</code>). You just need to make sure you've got a <code>TTY</code> environment var around.</p>\n"}, {"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": true, "score": 4, "last_activity_date": 1494999325, "creation_date": 1494999325, "answer_id": 44016393, "question_id": 44015884, "link": "https://stackoverflow.com/questions/44015884/launching-programs-example-vim-from-haskell/44016393#44016393", "title": "Launching Programs (example: Vim) from Haskell", "body": "<p>You want to use functions from the <a href=\"http://hackage.haskell.org/package/process\" rel=\"nofollow noreferrer\">process</a> library, specifically <a href=\"http://hackage.haskell.org/package/process-1.6.0.0/docs/System-Process.html#v:createProcess\" rel=\"nofollow noreferrer\">createProcess</a> or <a href=\"http://hackage.haskell.org/package/process-1.6.0.0/docs/System-Process.html#v:runProcess\" rel=\"nofollow noreferrer\">runProcess</a>.</p>\n\n<p>Relevant turtle thread on the issue <a href=\"https://github.com/Gabriel439/Haskell-Turtle-Library/issues/29\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><a href=\"https://github.com/purescript/psc-package/blob/e57afd280fa46ff8ee8a4edcb6491db8a5668e0d/app/Main.hs#L268-L275\" rel=\"nofollow noreferrer\">Example usage</a>.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 44016393, "answer_count": 2, "score": 5, "last_activity_date": 1494999325, "creation_date": 1494996721, "question_id": 44015884, "link": "https://stackoverflow.com/questions/44015884/launching-programs-example-vim-from-haskell", "title": "Launching Programs (example: Vim) from Haskell", "body": "<p>Using the <code>Turtle</code> shell scripting library I am trying to launch a program, i.e:</p>\n\n<pre><code>shell \"vim\" empty\n</code></pre>\n\n<p>The problem is that this yields the warning <code>Warning: Input is not from a terminal</code> and causes Vim to lag for a few seconds before finally launching.</p>\n\n<p><strong>Questions:</strong></p>\n\n<ol>\n<li>Is <code>shell</code> the best Turtle function to launch an external program from haskell?</li>\n<li>If so, is there any way to get around errors like the above?</li>\n</ol>\n"}, {"tags": ["haskell", "haskell-turtle"], "answers": [{"tags": [], "owner": {"reputation": 41648, "user_id": 108359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a34d29224f05cd8bd1f480c89cf112?s=128&d=identicon&r=PG", "display_name": "Brian McKenna", "link": "https://stackoverflow.com/users/108359/brian-mckenna"}, "is_accepted": true, "score": 4, "last_activity_date": 1494991248, "creation_date": 1494991248, "answer_id": 44014957, "question_id": 44014926, "link": "https://stackoverflow.com/questions/44014926/preserving-bash-colors-when-shelling-out-commands-in-haskell/44014957#44014957", "title": "Preserving Bash Colors When Shelling out Commands in Haskell", "body": "<p>The \"auto\" part means ls will only use colour when it knows that stdout is a \"real\" terminal. If you change to \"always\" then it will always use colour:</p>\n\n<pre><code>stdout (inshell \"ls --color=always\" empty)\n</code></pre>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44014957, "answer_count": 1, "score": 1, "last_activity_date": 1494991248, "creation_date": 1494990938, "question_id": 44014926, "link": "https://stackoverflow.com/questions/44014926/preserving-bash-colors-when-shelling-out-commands-in-haskell", "title": "Preserving Bash Colors When Shelling out Commands in Haskell", "body": "<p>Running <code>ls --color=auto</code> in bash shows directories as blue on my machine. Yet running <code>stdout (inshell \"ls --color=auto\" empty)</code> in Turtle loses all said color data. Is there a way to preserve coloring data?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1494988704, "post_id": 44014536, "comment_id": 75057010, "body": "One of the <i>main points</i> of <code>stack</code> is that it pins all packages to a <i>single, precise</i> version, based on your current resolver. You can see the different resolvers on <a href=\"https://www.stackage.org\" rel=\"nofollow noreferrer\">Stackage</a>, which is the separate-but-related system that manages nightly and LTS snapshots. The snapshots are simply one-to-one package \u2192 version mappings, and they do not actually store the packages themselves. Packages are stored on <a href=\"https://hackage.haskell.org\" rel=\"nofollow noreferrer\">Hackage</a>, the same place <code>cabal-install</code> downloads packages from, and you can see all the versions of any package there."}, {"owner": {"reputation": 960, "user_id": 4501973, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-iS95NDhmU10/AAAAAAAAAAI/AAAAAAAAAHc/ShDWV7OPIi4/photo.jpg?sz=128", "display_name": "apricity", "link": "https://stackoverflow.com/users/4501973/apricity"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494991647, "post_id": 44014536, "comment_id": 75057706, "body": "Thanks Alexis, that helped me know where to look for a better grasp of stack. Would you have any idea why stack would still be installing tidal-0.1.0.0 after doing stack new --resolver nightly-2017-05-16 tidal, cd tidal, stack update, stack setup, stack install tidal? When I look under that nightly resolver on stackage, it contains tidal-0.9.4 which is the one I need."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494992039, "post_id": 44014536, "comment_id": 75057800, "body": "It\u2019s a little unclear to me what you\u2019re trying to do. Are you trying to install <code>tidal</code> as a library? Or are you trying to install a <code>tidal</code> binary and copy it somewhere into your <code>PATH</code>, somewhere outside of a Haskell project? I\u2019m not familiar with <code>tidal</code> itself, but the two use-cases are very different."}, {"owner": {"reputation": 960, "user_id": 4501973, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-iS95NDhmU10/AAAAAAAAAAI/AAAAAAAAAHc/ShDWV7OPIi4/photo.jpg?sz=128", "display_name": "apricity", "link": "https://stackoverflow.com/users/4501973/apricity"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494993482, "post_id": 44014536, "comment_id": 75058095, "body": "I&#39;m pretty sure I&#39;m trying to install it as a library in a project, because where I&#39;m running into trouble is when installing in the same project stack install tidal-midi which gives me a dependency error that tidal-0.1.0.0 must match &gt;=0.9.4. All the instructions I&#39;ve seen just use cabal install tidal, cabal install tidal-midi, but being new to Haskell I was under the impression that I should try and use stack instead of cabal to avoid dependency issues. This is probably the point where I should start reading some manuals since you asking for clarification leaves me a bit stumped."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1494993632, "post_id": 44014536, "comment_id": 75058147, "body": "If that\u2019s the case, you almost certainly don\u2019t want <code>stack install</code>. The <code>stack install</code> command is, in my opinion, poorly named, and it comes from the same tradition of <code>make install</code> meaning \u201ccopy a binary into my <code>PATH</code>\u201d, which is pretty gross. I would rather tools <i>not</i> copy binaries all over my filesystem, thank you very much. What you probably want is to add <code>tidal</code> and <code>tidal-midi</code> to the <code>build-depends</code> section of your <code>.cabal</code> file, then run <code>stack build</code> (or <code>stack build --file-watch</code> if you want automatic recompilation), and <code>stack</code> should figure out what to properly install."}], "owner": {"reputation": 960, "user_id": 4501973, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-iS95NDhmU10/AAAAAAAAAAI/AAAAAAAAAHc/ShDWV7OPIi4/photo.jpg?sz=128", "display_name": "apricity", "link": "https://stackoverflow.com/users/4501973/apricity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494995158, "creation_date": 1494988307, "last_edit_date": 1494995158, "question_id": 44014536, "link": "https://stackoverflow.com/questions/44014536/ask-haskell-stack-to-list-available-versions-of-a-package", "title": "Ask haskell stack to list available versions of a package", "body": "<p>Is there a way to list available versions of a given package from stack? For instance today if I run <code>stack install tidal</code> and then <code>stack list-dependencies</code> I see that tidal-0.1.0.0 was installed. I want to know if there are older versions of this package available. Relatedly where is the repo that stack points to for packages? Is it the same place cabal retrieves from?</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1494985001, "post_id": 44012108, "comment_id": 75056087, "body": "I don&#39;t know turtle, but I&#39;d just go through bash. <code>bash -c &#39;source &#47;a&#47;path&#47;to&#47;a&#47;file.sh; custom_bash_function&#39;</code>"}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1494991376, "post_id": 44012108, "comment_id": 75057646, "body": "and run @luqui &#39;s command via the <code>turtle</code> command <code>exec</code> or <code>shell</code>."}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494971071, "creation_date": 1494971071, "question_id": 44012108, "link": "https://stackoverflow.com/questions/44012108/using-haskells-turtle-to-call-a-custom-bash-function", "title": "Using Haskell&#39;s Turtle to Call a Custom Bash Function", "body": "<p>Using turtle, how does one run a custom bash command found in <code>/a/path/to/a/file.sh</code>? It would be the equivalent of <code>source /a/path/to/a/file.sh</code> and then calling <code>custom_bash_function</code>.</p>\n"}, {"tags": ["haskell", "permutation", "list-comprehension"], "comments": [{"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 2, "creation_date": 1494967379, "post_id": 44011087, "comment_id": 75050639, "body": "First your brackets don&#39;t appear to be matching. Second, are you purposefully naming your variables <code>fst</code> and <code>tail</code> or did you intend for these to be used as functions? What are you trying to do with this code? What are the requirements?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494968545, "post_id": 44011087, "comment_id": 75051253, "body": "It&#39;s not very clear to me what the specifications are. Please first state what you want to achieve, how you want to achieve it, is the second part."}, {"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1494969500, "post_id": 44011087, "comment_id": 75051704, "body": "I wanted to use them as functions. - I edited the question, so i hope it is more clear now"}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1495030581, "post_id": 44011087, "comment_id": 75081180, "body": "Since the code you gave doesn&#39;t compile, may I suggest that, as a general guide, you always have a version of your code that does compile. Then make a change and, once that compiles, go from there.  So, I&#39;d trim the expression you gave to <code>d = [(x,y,z) | x &lt;- [1..3], y &lt;- [1..3], z &lt;-[1..3]]</code>.  Examine that and play with it, change it, run it, &#39;til you understand what&#39;s going on there.  Then, to attack your requirement &quot;fst cannot be [1]&quot;... write this: ` d = [(x,y,z) | x &lt;- [1..3], y &lt;- [1..3], z &lt;-[1..3],x/=1]<code>.  Play with that, change the x to y, change the 1 to 2, add a </code>y/=1`, etc."}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1495107745, "creation_date": 1495107745, "answer_id": 44046795, "question_id": 44011087, "link": "https://stackoverflow.com/questions/44011087/conditions-in-a-list-comprehension-finding-possibilities/44046795#44046795", "title": "Conditions in a list comprehension , finding possibilities", "body": "<p>You could use something like this:</p>\n\n<pre><code>d = [(3, y, z) | y &lt;- [1..2], z &lt;-[1..2], y /= z, y /= 2]\n</code></pre>\n\n<p>which gives</p>\n\n<pre><code>[(3,1,2)]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<blockquote>\n  <p>First key cannot be placed as the first one. </p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Second key never can be placed before the first one. </p>\n</blockquote>\n\n<p>imply that <code>x</code> cannot be 1 or 2, and hence must be 3. This gives</p>\n\n<pre><code>[(3, y, z) | y &lt;- [1..2], z &lt;-[1..2]\n</code></pre>\n\n<p>Since </p>\n\n<blockquote>\n  <p>No keys can be tried more than once. </p>\n</blockquote>\n\n<p>we also have</p>\n\n<pre><code>, y != z\n</code></pre>\n\n<p>Finally </p>\n\n<blockquote>\n  <p>Second key never can be placed before the first one. </p>\n</blockquote>\n\n<p>gives</p>\n\n<p>, y /= 2]</p>\n\n<p>In fact, with some thought, you could argue that you can just write</p>\n\n<pre><code>d = [(3, 1, 2)]\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44046795, "answer_count": 1, "score": 1, "last_activity_date": 1495108751, "creation_date": 1494966860, "last_edit_date": 1495108751, "question_id": 44011087, "link": "https://stackoverflow.com/questions/44011087/conditions-in-a-list-comprehension-finding-possibilities", "title": "Conditions in a list comprehension , finding possibilities", "body": "<p>there are 3 keys and 3 locks, and i have to write a code to show the possible tries. Rules are: </p>\n\n<ul>\n<li>Second key never can be placed before the first one. </li>\n<li>No keys can be tried more than once. </li>\n<li>First key cannot be placed as the first one. </li>\n<li>and you can't place them in the order 3 - 2 - 1  </li>\n<li>and as a tip, this is given:  [(x,y,z) | x &lt;- [1..3], ]</li>\n</ul>\n\n<hr>\n\n<p>I want to change this code in a way that, instead of \" fst &lt;- [3] \" it says; \" fst cannot be [1] \"\nand I also want to add that 2 cannot come before 1. I tried it with (elemIndex 2 (x,y,z)) > (elemIndex 1 (x,y,z)) \n but it didn't work. I would appreciate for some ideas. </p>\n\n<pre><code>d = [(x,y,z) | x &lt;- [1..3], y &lt;- [1..3], z &lt;-[1..3], fst &lt;- [3] , tail &lt;- 1], x /= y, y /= z, x /= z]\n</code></pre>\n"}, {"tags": ["haskell", "line", "readfile"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1494971145, "post_id": 44011129, "comment_id": 75052323, "body": "Might as well remove the <code>do</code> notation here since we&#39;re already working mostly with function composition anyway: <code>applyOnFileLines filePath f = putStr =&lt;&lt; unlines . map f . lines &lt;$&gt; readFile filePath</code>. Also I think it would be better if <code>applyOnFileLines</code> took its arguments in the other order, <code>f</code> before <code>filePath</code>. Makes for clearer reading and better partial application."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1494973134, "post_id": 44011129, "comment_id": 75053147, "body": "Fair enough, I wrote it like this thinking it would be easier for OP. Otherwise if you like a more <i>point-free</i> style, something like this could work: <code>onLinesToFile func = (putStr . unlines . map func . lines =&lt;&lt;) . readFile</code>"}, {"owner": {"reputation": 17, "user_id": 6714847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe141942aa6370bd86ace6877745b6a?s=128&d=identicon&r=PG&f=1", "display_name": "hatem salama", "link": "https://stackoverflow.com/users/6714847/hatem-salama"}, "edited": false, "score": 0, "creation_date": 1494989110, "post_id": 44011129, "comment_id": 75057107, "body": "Thank u, but really i am not good in Haskell, please send me a file is ready to run including the function and  where to place it and how to call this function from another function"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 17, "user_id": 6714847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe141942aa6370bd86ace6877745b6a?s=128&d=identicon&r=PG&f=1", "display_name": "hatem salama", "link": "https://stackoverflow.com/users/6714847/hatem-salama"}, "edited": false, "score": 0, "creation_date": 1494990819, "post_id": 44011129, "comment_id": 75057526, "body": "@hatemsalama Nobody is going to do that. Stack Overflow is for getting help with specific, well-defined hurdles that are getting in your way of solving a problem. It is not a program-writing service where answerers will write your whole program for you. As for &quot;how to call this function from another function&quot;: it&#39;s not too much of a stretch to say that that&#39;s exactly what the type annotation is!"}, {"owner": {"reputation": 17, "user_id": 6714847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe141942aa6370bd86ace6877745b6a?s=128&d=identicon&r=PG&f=1", "display_name": "hatem salama", "link": "https://stackoverflow.com/users/6714847/hatem-salama"}, "edited": false, "score": 0, "creation_date": 1495007096, "post_id": 44011129, "comment_id": 75064300, "body": "I need help that &quot;how to call this function from another function?&quot;"}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": false, "score": 0, "last_activity_date": 1494967031, "creation_date": 1494967031, "answer_id": 44011129, "question_id": 44010647, "link": "https://stackoverflow.com/questions/44010647/haskell-readfile-from-file-line-by-line/44011129#44011129", "title": "haskell readFile from file line by line", "body": "<p>So <code>interact</code> is to do IO using <em>stdin</em> and <em>stdout</em>. If instead of <em>stdin</em> you want to use a file for input, that's fine you can use the <code>readFile</code> function as you are already doing:</p>\n\n\n\n<pre><code>applyOnFileLines :: FilePath -&gt; (String -&gt; String) -&gt; IO ()\napplyOnFileLines filePath func = do\n  file &lt;- readFile filePath\n  putStr . unlines\n         . map func\n         . lines\n         $ file\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6714847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe141942aa6370bd86ace6877745b6a?s=128&d=identicon&r=PG&f=1", "display_name": "hatem salama", "link": "https://stackoverflow.com/users/6714847/hatem-salama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1494967031, "creation_date": 1494965113, "last_edit_date": 1494966254, "question_id": 44010647, "link": "https://stackoverflow.com/questions/44010647/haskell-readfile-from-file-line-by-line", "title": "haskell readFile from file line by line", "body": "<p>Haskell programming\nhow to use readFile\nI use getLine but it should react with a user for each command\nBut i need to read lines from text file and process the input line</p>\n\n<pre><code>text &lt;- readFile \"input.txt\"\nlet linii = lines text\ninteract (unlines . (map calculate) . linii)\n</code></pre>\n"}, {"tags": ["haskell", "servant"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 2419193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3683adb83f1b539fc27d51d9c94ff36?s=128&d=identicon&r=PG", "display_name": "ismail", "link": "https://stackoverflow.com/users/2419193/ismail"}, "edited": false, "score": 0, "creation_date": 1495021423, "post_id": 44010473, "comment_id": 75074094, "body": "That was a very fast answer, thank you very much. The only thing I don&#39;t like about this method is that it spreads out the definition of the <code>API</code> type, but it does do what it is meant to do, and can be generalised for more complex stuff."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 4, "last_activity_date": 1494967350, "last_edit_date": 1494967350, "creation_date": 1494964510, "answer_id": 44010473, "question_id": 44007111, "link": "https://stackoverflow.com/questions/44007111/issues-using-pattern-matching-with-servant-client/44010473#44010473", "title": "Issues using pattern matching with servant-client", "body": "<p>Servant API definitions live at the type level. If we want to manipulate them, we need something like a function that transforms types (not values, types themselves) into other types. </p>\n\n<p>The closest thing to such a type-level function in Haskell is called a <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#closed-type-families\" rel=\"nofollow noreferrer\">closed type family</a>:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\ntype family PrependParam api where\n    PrependParam (a :&lt;|&gt; b) = PrependParam a :&lt;|&gt; PrependParam b\n    PrependParam leaf = QueryParam \"test\" Int :&gt; leaf\n\ntype API' = PrependParam API\n</code></pre>\n\n<p><code>:&lt;|&gt;</code> separates routes, while <code>:&gt;</code> separates components within a route. We are mapping over the tree of routes and adding a prefix to each one.</p>\n\n<p>We can check that it works from <em>ghci</em>, using the <code>kind!</code>command:</p>\n\n<pre><code>ghci&gt; :kind! API'\nAPI' :: *\n= (QueryParam \"test\" Int\n   :&gt; (\"position\"\n       :&gt; (Capture \"x\" Int :&gt; (Capture \"y\" Int :&gt; Get '[JSON] Position))))\n  :&lt;|&gt; ((QueryParam \"test\" Int\n         :&gt; (\"hello\"\n             :&gt; (QueryParam \"name\" String :&gt; Get '[JSON] HelloMessage)))\n        :&lt;|&gt; (QueryParam \"test\" Int\n              :&gt; (\"marketing\"\n                  :&gt; (ReqBody '[JSON] ClientInfo :&gt; Post '[JSON] Email))))\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 2419193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3683adb83f1b539fc27d51d9c94ff36?s=128&d=identicon&r=PG", "display_name": "ismail", "link": "https://stackoverflow.com/users/2419193/ismail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 1, "accepted_answer_id": 44010473, "answer_count": 1, "score": 2, "last_activity_date": 1494967350, "creation_date": 1494952871, "question_id": 44007111, "link": "https://stackoverflow.com/questions/44007111/issues-using-pattern-matching-with-servant-client", "title": "Issues using pattern matching with servant-client", "body": "<p>In the <a href=\"http://haskell-servant.readthedocs.io/en/stable/tutorial/Client.html\" rel=\"nofollow noreferrer\">Servant docs</a>, we have the following api:</p>\n\n<pre><code>type API = \"position\" :&gt; Capture \"x\" Int :&gt; Capture \"y\" Int :&gt; Get '[JSON] Position\n      :&lt;|&gt; \"hello\" :&gt; QueryParam \"name\" String :&gt; Get '[JSON] HelloMessage\n      :&lt;|&gt; \"marketing\" :&gt; ReqBody '[JSON] ClientInfo :&gt; Post '[JSON] Email\n</code></pre>\n\n<p>and we can define client functions like so:</p>\n\n<pre><code>api :: Proxy API\napi = Proxy\n\nposition :&lt;|&gt; hello :&lt;|&gt; marketing = client api\n</code></pre>\n\n<p>If our api type instead looked like:</p>\n\n<pre><code>type API = QueryParam \"test\" Int :&gt; (\n    \"position\" :&gt; Capture \"x\" Int :&gt; Capture \"y\" Int :&gt; Get '[JSON] Position\n      :&lt;|&gt; \"hello\" :&gt; QueryParam \"name\" String :&gt; Get '[JSON] HelloMessage\n      :&lt;|&gt; \"marketing\" :&gt; ReqBody '[JSON] ClientInfo :&gt; Post '[JSON] Email)\n</code></pre>\n\n<p>which is identical to the original api but with an additional \"test\" query parameter for all endpoints, how would we obtain our client functions? I have tried several variants of pattern matching, but to no avail.</p>\n\n<p>If all else, fails, the \"test\" query parameter could be repeated in the api type for each endpoint, but this is Haskell, we try to avoid repetition.</p>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495026680, "post_id": 44006327, "comment_id": 75078005, "body": "Minor style comment: you can avoid the antipattern <code>if condition then True else False</code>, it can be simplified to <code>condition</code>. E.g., one can write <code>filter (\\x -&gt; x&gt;=6) [1..10]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1494952301, "post_id": 44006488, "comment_id": 75042125, "body": "I think this looks better with point-free predicates too, but I suppose some might disagree: <code>f11 = filter ((&lt; 2) . length) . map (filter (&gt;= 6))</code>."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1494952369, "post_id": 44006488, "comment_id": 75042168, "body": "@amalloy love that. Even better"}, {"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1494953840, "post_id": 44006488, "comment_id": 75042979, "body": "Thanks. I just have to check what those &quot;dots&quot; do =)"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1494965987, "post_id": 44006488, "comment_id": 75049926, "body": "@Pelin, the dots mean fucntion composition its like adding 2 function behaviour into one."}, {"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1494966921, "post_id": 44006488, "comment_id": 75050418, "body": "Great! Thank you for the explanation @Daniel Sanchez"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1495038713, "post_id": 44006488, "comment_id": 75087159, "body": "@Pelin just for completeness, <code>((&lt; 2) . length)  xs</code> == <code>(&lt; 2) (length xs)</code> == <code>length xs &lt; 2</code>."}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 1, "last_activity_date": 1494952017, "last_edit_date": 1494952017, "creation_date": 1494950913, "answer_id": 44006488, "question_id": 44006327, "link": "https://stackoverflow.com/questions/44006327/filter-elements-from-nested-lists/44006488#44006488", "title": "Filter elements from nested lists", "body": "<p>You are getting it the other way around, check this:</p>\n\n<pre><code>f11 :: [[Int]] -&gt; [[Int]]\nf11  =  (filter \\x-&gt; length x &lt; 2) . (map (filter \\x -&gt; x &gt; 6))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 1, "last_activity_date": 1494952297, "last_edit_date": 1494952297, "creation_date": 1494951202, "answer_id": 44006581, "question_id": 44006327, "link": "https://stackoverflow.com/questions/44006327/filter-elements-from-nested-lists/44006581#44006581", "title": "Filter elements from nested lists", "body": "<p>It's a matter of taste, but, for readability, you might want to use intermediates:</p>\n\n<pre><code>f11 :: [[Int]] -&gt; [[Int]]\nf11 xs = \n    let \n        less6Cleared = map (filter (\\x -&gt; x &gt;= 6)) xs\n    in  \n        filter (\\x -&gt; length(x) &gt;= 2) less6Cleared                       \n</code></pre>\n\n<p>This says that <code>less6Cleared</code> is the list of lists whose all elements have been cleared of less than 6. You now apply a filter to <code>less6Cleared</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 1, "last_activity_date": 1495038626, "last_edit_date": 1495038626, "creation_date": 1494985232, "answer_id": 44014132, "question_id": 44006327, "link": "https://stackoverflow.com/questions/44006327/filter-elements-from-nested-lists/44014132#44014132", "title": "Filter elements from nested lists", "body": "<p>You can also use the <code>do</code> notation, thanks to lists' instance of <code>Monad</code>.</p>\n\n<pre><code>f11 xss = do\n    xs &lt;- xss\n    let ys = [x | x &lt;- xs, x &gt;= 6]\n    guard (length ys &lt;= 2)\n    return ys\n</code></pre>\n\n<p><code>do</code> notation for <em>lists</em> basically denotes a <code>foreach</code> loop. We extract each element <code>xs</code> from <code>xss</code>, then feed it through a list comprehension to filter out the elements less than 6, naming the result <code>ys</code>. Then <code>guard</code> filters out <code>ys</code> longer than 2.</p>\n"}, {"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 0, "last_activity_date": 1495054191, "last_edit_date": 1495054191, "creation_date": 1495053746, "answer_id": 44034442, "question_id": 44006327, "link": "https://stackoverflow.com/questions/44006327/filter-elements-from-nested-lists/44034442#44034442", "title": "Filter elements from nested lists", "body": "<p>If you want to go crazy with point free style and partial function application...</p>\n\n<pre><code>f11 :: [[Int]] -&gt; [[Int]]\nf11 = (filter $ (&gt;= 2) . length) . (map $ filter (&gt;= 6))\n</code></pre>\n\n<p>... but it might not be clearer, especially to those not used to it.</p>\n\n<p>Also I took your requirements of \"less than\" to be strict, so values of 6 are not deleted, and list of lengths of 2 are not deleted.</p>\n"}], "owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 1, "accepted_answer_id": 44014132, "answer_count": 4, "score": 4, "last_activity_date": 1495054191, "creation_date": 1494950458, "last_edit_date": 1494950609, "question_id": 44006327, "link": "https://stackoverflow.com/questions/44006327/filter-elements-from-nested-lists", "title": "Filter elements from nested lists", "body": "<p>I am having a hard time with understanding the logic behind functional programming. So, this should be something quite easy but not working for me. \nWhat i am trying to do is: \nA function with a parameter list, and a list is something like this: <code>[[1,2,3], [5,7,8,12,34], [2,4,6,8]]</code>\nand first i should delete the values less than 6 and then delete all the lists with less than 2 elements. My code is like this:  </p>\n\n<pre><code>f11 :: [[Int]] -&gt; [[Int]]\nf11 xs = ( filter (\\s -&gt; if a &lt;= 6 a then True else False )) (map (filter (\\x -&gt; length x &lt;= 2)) xs)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494944129, "post_id": 44003103, "comment_id": 75036278, "body": "Two objections: 1. The problem isn&#39;t fully specified. You give a relationship that maps three numbers to three numbers; it&#39;s relatively clear how to generalize it to map n numbers to n numbers, but then one of your input/output examples maps 6 numbers to 4 numbers. What? 2. You&#39;ve shown no effort of your own, and so we can&#39;t direct you to a specific mistake you&#39;ve made or misunderstanding you have."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494944146, "post_id": 44003103, "comment_id": 75036294, "body": "This looks like some kind of convolution. I am not sure what the logic is though. In your second example there is no obvious way to solve it with the relations given."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494953976, "post_id": 44003103, "comment_id": 75043060, "body": "Since this post has been put on hold and therefore won&#39;t accept my answer, here is the <a href=\"https://gist.github.com/basile-henry/6a2bbfd9800e6d8968e37d39915e29af\" rel=\"nofollow noreferrer\">gist</a> of it."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1494954478, "post_id": 44003103, "comment_id": 75043331, "body": "I think this is a good problem, although not well articulated."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8019814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02014cc6039e895ba48d29eb0f9328f?s=128&d=identicon&r=PG&f=1", "display_name": "Shafici", "link": "https://stackoverflow.com/users/8019814/shafici"}, "edited": false, "score": 0, "creation_date": 1494948331, "post_id": 44005382, "comment_id": 75039389, "body": "Yeah sir I am searching the inverse of that function, please can you help me about that?"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494953638, "post_id": 44005382, "comment_id": 75042862, "body": "Nice answer karakfa, I was working on a solution, which I have found. It is similar to your but not as concise. The post is however on hold and I can&#39;t post it. Way to waste time for nothing, thanks StackOverflow"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494953852, "post_id": 44005382, "comment_id": 75042986, "body": "Where is <code>split&#39;</code> defined?"}, {"owner": {"reputation": 7, "user_id": 8019814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02014cc6039e895ba48d29eb0f9328f?s=128&d=identicon&r=PG&f=1", "display_name": "Shafici", "link": "https://stackoverflow.com/users/8019814/shafici"}, "edited": false, "score": 0, "creation_date": 1494954307, "post_id": 44005382, "comment_id": 75043248, "body": "yeah sir thank you ,I can not find the definition of split&#39; so where did you define?"}, {"owner": {"reputation": 7, "user_id": 8019814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02014cc6039e895ba48d29eb0f9328f?s=128&d=identicon&r=PG&f=1", "display_name": "Shafici", "link": "https://stackoverflow.com/users/8019814/shafici"}, "edited": false, "score": 0, "creation_date": 1494954996, "post_id": 44005382, "comment_id": 75043621, "body": "sir karakfa thank you again but its giving an error in  go (n+1) (drop n x) please can you put the code completely at one time"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1494955180, "post_id": 44005382, "comment_id": 75043718, "body": "what is the error?"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494955256, "post_id": 44005382, "comment_id": 75043768, "body": "I have tested karakfa&#39;s code and it works!"}, {"owner": {"reputation": 7, "user_id": 8019814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02014cc6039e895ba48d29eb0f9328f?s=128&d=identicon&r=PG&f=1", "display_name": "Shafici", "link": "https://stackoverflow.com/users/8019814/shafici"}, "edited": false, "score": 0, "creation_date": 1494956117, "post_id": 44005382, "comment_id": 75044213, "body": "Thank you sir karakfa its correct I am very happy the way you analyzed and understood my rough question because I did not know how I can define it. Nowadays people they don&#39;t have patient but fortunately there are few understandable and you are one of them. I appreciate it. God bless you. basile-henry thank you, I have seen your answer I appreciate that."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 2, "last_activity_date": 1494954745, "last_edit_date": 1494954745, "creation_date": 1494947770, "answer_id": 44005382, "question_id": 44003103, "link": "https://stackoverflow.com/questions/44003103/adding-elements-of-a-list-in-a-given-way-in-haskell/44005382#44005382", "title": "adding elements of a list in a given way in haskell", "body": "<p>I think you're looking for the inverse of this function</p>\n\n<pre><code>conv = concat . f\n    where f [] = []\n          f (x:xs) = map (x+) xs : f xs\n\n&gt; conv [3,10,5]\n[13,8,15]\n\n&gt; conv [2,5,15,34]\n[7,17,36,20,39,49]\n</code></pre>\n\n<p>I came up something like this.  Note that for length less than 3 there can't be a unique solution, handle that case...</p>\n\n<pre><code>solve x = (reverse . (h :) . map (subtract h) . map head . split') rx\n        where rx@(a:b:c:_) = reverse x\n              h = (a+b-c) `div` 2\n\n&gt; solve [7,17,36,20,39,49]\n[2,5,15,34]\n\n&gt; solve [13,8,15]\n[3,10,5]\n</code></pre>\n\n<p>you can check whether</p>\n\n<pre><code>conv . solve = solve . conv = id\n</code></pre>\n\n<p>split' scrolled up on my screen, it's defined as</p>\n\n<pre><code>split' = go 1\n     where go _ [] = []\n           go n x = take n x : go (n+1) (drop n x)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8019814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02014cc6039e895ba48d29eb0f9328f?s=128&d=identicon&r=PG&f=1", "display_name": "Shafici", "link": "https://stackoverflow.com/users/8019814/shafici"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1494952855, "accepted_answer_id": 44005382, "answer_count": 1, "score": -8, "last_activity_date": 1494954745, "creation_date": 1494941872, "last_edit_date": 1494954058, "question_id": 44003103, "link": "https://stackoverflow.com/questions/44003103/adding-elements-of-a-list-in-a-given-way-in-haskell", "closed_reason": "Needs details or clarity", "title": "adding elements of a list in a given way in haskell", "body": "<p>Some one helped me the below function but I need its inverse that means the below output will be the input of my functionand the below input will be the output of my function</p>\n\n<pre><code>conv = concat . f\nwhere f [] = []\n      f (x:xs) = map (x+) xs : f xs\n\n &gt; conv [3,10,5]\n [13,8,15]\n\n&gt; conv [2,5,15,34]\n[7,17,36,20,39,49]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "fibonacci"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494948237, "post_id": 44002178, "comment_id": 75039319, "body": "C&#39;mon. Every Haskell programmer should know this page: <a href=\"https://www.willamette.edu/~fruehr/haskell/evolution.html\" rel=\"nofollow noreferrer\">willamette.edu/~fruehr/haskell/evolution.html</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494951969, "post_id": 44002178, "comment_id": 75041908, "body": "@EugeneSh. C&#39;mon, &quot;C&#39;mon&quot;?  This comment seems condescending."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494952144, "post_id": 44002178, "comment_id": 75042017, "body": "@luqui Isn&#39;t it depending on the facial expression?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1494953202, "post_id": 44002178, "comment_id": 75042623, "body": "I agree it&#39;s condescending. Especially coupled with &quot;every&quot; and &quot;should&quot;, it says that anyone who doesn&#39;t already know this page must not be a real Haskell programmer. But you can&#39;t be born knowing everything interesting: OP is one of <a href=\"https://xkcd.com/1053/\" rel=\"nofollow noreferrer\">today&#39;s lucky 10,000</a> and it&#39;s not nice to imply that he should have known it already."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494954655, "post_id": 44002178, "comment_id": 75043431, "body": "Oh man.. given that page I have linked to is <i>humorous</i>, and not really educational (well, somewhat), my saying was about the same that saying that &quot;to understand recursion one should understand recursion&quot; - not a very serious saying too. It is known by a term &quot;joke&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 4699448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770476e46e176f2560cd24d130a7129d?s=128&d=identicon&r=PG&f=1", "display_name": "James Wilson", "link": "https://stackoverflow.com/users/4699448/james-wilson"}, "edited": false, "score": 2, "creation_date": 1494940011, "post_id": 44002290, "comment_id": 75032967, "body": "thanks for the v clear explanation on why so slow - knew it was something like that, but the branching is really clear"}, {"owner": {"reputation": 611, "user_id": 4699448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770476e46e176f2560cd24d130a7129d?s=128&d=identicon&r=PG&f=1", "display_name": "James Wilson", "link": "https://stackoverflow.com/users/4699448/james-wilson"}, "edited": false, "score": 0, "creation_date": 1494947419, "post_id": 44002290, "comment_id": 75038751, "body": "I get how your solution works - why does <code>fib&#39;</code> store the values when mine didn&#39;t? Was I expecting too much from GHC?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 611, "user_id": 4699448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770476e46e176f2560cd24d130a7129d?s=128&d=identicon&r=PG&f=1", "display_name": "James Wilson", "link": "https://stackoverflow.com/users/4699448/james-wilson"}, "edited": false, "score": 0, "creation_date": 1494951642, "post_id": 44002290, "comment_id": 75041717, "body": "@JamesWilson, a lot of Haskell newbies expect GHC to be magic, which I blame on the fanboy press.  GHC is good in that you can abstract a <i>lot</i> and not have to pay the abstraction cost, but it&#39;s not going to change the asymptotics of the algorithm you use."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 611, "user_id": 4699448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770476e46e176f2560cd24d130a7129d?s=128&d=identicon&r=PG&f=1", "display_name": "James Wilson", "link": "https://stackoverflow.com/users/4699448/james-wilson"}, "edited": false, "score": 0, "creation_date": 1494951798, "post_id": 44002290, "comment_id": 75041813, "body": "@JamesWilson, the direct answer to your question is that <code>fib&#39;</code> stores its intermediate values in its two accumulator parameters.  Your implementation has no mechanism to store them.  You can explicitly memoize, though. <a href=\"https://wiki.haskell.org/Memoization\" rel=\"nofollow noreferrer\">wiki.haskell.org/Memoization</a>"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494972634, "post_id": 44002290, "comment_id": 75052975, "body": "@luqui sometimes the full laziness transformation actually does improve asymptotics. Of course, sometimes it makes them worse, too..."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1494943189, "last_edit_date": 1494943189, "creation_date": 1494939830, "answer_id": 44002290, "question_id": 44002178, "link": "https://stackoverflow.com/questions/44002178/how-to-make-this-fibonacci-function-faster/44002290#44002290", "title": "How to make this fibonacci function faster?", "body": "<p>The problem is that this will result in <strong>dramatic branching</strong>. Say you call <code>fibonacci 5</code>, then this will result in the following <em>call tree</em>:</p>\n\n<pre><code>fibonacci 5\n    fibonacci 4\n        fibonacci 3\n            fibonacci 2\n            fibonacci 1\n        fibonacci 2\n    fibonacci 3\n        fibonacci 2\n        fibonacci 1\n</code></pre>\n\n<p>As you can see <code>fibonacci 3</code> is called twice, <code>fibonacci 2</code> is called three times and <code>fibonacci 1</code> is called twice (in this very small example). There is a huge amount of overlap: you call the same function with the same arguments multiple times. This is of course inefficient: once you know that <code>fibonacci 3</code> is <code>3</code>, there is no need to calculate it a second time. Of course in this very small example that's not really an issue: calculating <code>fibonacci 3</code> is a matter of nanoseconds. But in case you have to calculate <code>fibonacci 100</code> multiple times, this will have a dramatic impact. The number of <em>redundant</em> calls also scales exponentially (so this is not some small problem that only has some impact in the margin).</p>\n\n<p>What you can do is work with <em>accumulator(s)</em>: variables you pass recursively and update accordingly. For fibonacci, there are two such variables, the <em>f(n-2)</em> and <em>f(n-1)</em>. You then each time calculate the sum of these two and <em>shift</em> so:</p>\n\n<pre><code>fibonacci :: Int -&gt; Int\nfibonacci 1 = a\nfibonacci 2 = b\nfibonacci n = fib' (n-2) a b\n    fib' 0 x y = x+y\n    fib' i x y = fib' (i-1) y (x+y)\n</code></pre>\n\n<p>In this case the call tree will look like:</p>\n\n<pre><code>fibonacci 5\n    fib' 3 1 2\n        fib' 2 2 3\n            fib' 1 3 5\n                fib' 0 5 8\n</code></pre>\n\n<p>This thus results into five calls (against nine calls for the original code). Of course the number of calls is not a guarantee on performance, since some methods do more work, but our approach scales <em>linearly</em> with <em>n</em> whereas the original approach scales <em>exponentially</em> with <em>n</em>. So even if the original method is thousands of times faster, eventually the difference in the number of calls will be that huge, that it will be outperformed.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1494964105, "last_edit_date": 1494964105, "creation_date": 1494963779, "answer_id": 44010255, "question_id": 44002178, "link": "https://stackoverflow.com/questions/44002178/how-to-make-this-fibonacci-function-faster/44010255#44010255", "title": "How to make this fibonacci function faster?", "body": "<p>You can wrap it up with memoization to eliminate redundant computations</p>\n\n<pre><code>fibonacci = (map fibm [0..] !!)\n    where fibm 1 = a\n          fibm 2 = b\n          fibm n = fibonacci (n-1) + fibonacci (n-2)\n</code></pre>\n\n<p>for your given <code>a</code> and <code>b</code> initial values. </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6070464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fz59LtYRRq0/AAAAAAAAAAI/AAAAAAAAArI/y2xOfIW7WYI/photo.jpg?sz=128", "display_name": "bbyalcinkaya", "link": "https://stackoverflow.com/users/6070464/bbyalcinkaya"}, "is_accepted": false, "score": 1, "last_activity_date": 1494977260, "last_edit_date": 1495542877, "creation_date": 1494977260, "answer_id": 44013187, "question_id": 44002178, "link": "https://stackoverflow.com/questions/44002178/how-to-make-this-fibonacci-function-faster/44013187#44013187", "title": "How to make this fibonacci function faster?", "body": "<p>You can use matrix multiplication to calculate fibonacci numbers in O(logN) time. Similar question is <a href=\"https://stackoverflow.com/questions/14661633/finding-out-nth-fibonacci-number-for-very-large-n\">here</a>. </p>\n"}], "owner": {"reputation": 611, "user_id": 4699448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770476e46e176f2560cd24d130a7129d?s=128&d=identicon&r=PG&f=1", "display_name": "James Wilson", "link": "https://stackoverflow.com/users/4699448/james-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "accepted_answer_id": 44002290, "answer_count": 3, "score": 2, "last_activity_date": 1495025387, "creation_date": 1494939536, "last_edit_date": 1494941010, "question_id": 44002178, "link": "https://stackoverflow.com/questions/44002178/how-to-make-this-fibonacci-function-faster", "title": "How to make this fibonacci function faster?", "body": "<p>This function to find the nth fibonacci works.</p>\n\n<pre><code>a = 1\nb = 2\n\nfibonacci :: Int -&gt; Int\nfibonacci 1 = a\nfibonacci 2 = b\nfibonacci n = (fibonacci (n-1)) + (fibonacci (n-2))\n</code></pre>\n\n<p>But it is slow. If I do <code>map fibonacci [1..]</code> it really slows down as the numbers come. I'm guessing this is overhead due to how much stack is being used and the sheer number of calculations - doing each one down to <code>a</code> and <code>b</code> rather than just adding the last two together.</p>\n\n<p>How can I improve it so it's much faster, but still use a functional programming style? (I'm a definite haskell and FP newbie!)\nI tried something in Python that was lightning by comparison.</p>\n\n<p>Tips are as welcome if not more welcome than working code!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 2, "creation_date": 1494939990, "post_id": 44002223, "comment_id": 75032950, "body": "Another point-free way, using Data.List.NonEmpty (now in base): <code>fmap maximum . nonEmpty</code>."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1494940288, "post_id": 44002223, "comment_id": 75033185, "body": "Nice one! :D I need to use <code>NonEmpty</code> more."}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": false, "score": 3, "last_activity_date": 1494940666, "last_edit_date": 1494940666, "creation_date": 1494939649, "answer_id": 44002223, "question_id": 44001843, "link": "https://stackoverflow.com/questions/44001843/safe-maximum-in-haskell-standard-library/44002223#44002223", "title": "Safe `maximum` in Haskell Standard Library?", "body": "<p>You could create your own:</p>\n\n\n\n<pre><code>maximumMaybe :: (Ord a, Foldable f) =&gt; f a -&gt; Maybe a\nmaximumMaybe xs\n  | null xs   = Nothing\n  | otherwise = Just $ maximum xs\n</code></pre>\n\n<p><strong>Previous Answer</strong> (not foldable):</p>\n\n\n\n<pre><code>maximumMaybe :: Ord a =&gt; [a] -&gt; Maybe a\nmaximumMaybe xs = listToMaybe xs *&gt; Just (maximum xs)\n</code></pre>\n\n<p>Or if you like <em>point-free</em> style:</p>\n\n\n\n<pre><code>maximumMaybe :: Ord a =&gt; [a] -&gt; Maybe a\nmaximumMaybe = (&lt;*) . Just . maximum &lt;*&gt; listToMaybe\n</code></pre>\n\n<p>Another, simpler, solution is:</p>\n\n\n\n<pre><code>maximumMaybe :: Ord a =&gt; [a] -&gt; Maybe a\nmaximumMaybe [] = Nothing\nmaximumMaybe xs = Just $ maximum xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1823, "user_id": 52142, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f97017e6dc7ba57d906bd5767a83d1f0?s=128&d=identicon&r=PG", "display_name": "Artur Gajowy", "link": "https://stackoverflow.com/users/52142/artur-gajowy"}, "edited": false, "score": 2, "creation_date": 1589759652, "post_id": 44002339, "comment_id": 109413490, "body": "The <code>Otpion</code> is no longer needed, the same result will be achieved by writing: <code>safeMaximum = fmap getMax . foldMap (Just . Max)</code>"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 5, "last_activity_date": 1589775188, "last_edit_date": 1589775188, "creation_date": 1494939943, "answer_id": 44002339, "question_id": 44001843, "link": "https://stackoverflow.com/questions/44001843/safe-maximum-in-haskell-standard-library/44002339#44002339", "title": "Safe `maximum` in Haskell Standard Library?", "body": "<p>You can code one up yourself for any <code>Foldable</code>, by applying <code>foldMap</code> to a suitable choice of <code>Monoid</code>.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Semigroup.html#t:Option\" rel=\"nofollow noreferrer\">The <code>Option</code> monoid</a> takes an existing <code>Semigroup</code> and lifts it into a <code>Monoid</code> by adjoining an empty element (<code>Option Nothing</code>), which'll be returned by <code>foldMap</code> if the input <code>Foldable</code> is empty. <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Semigroup.html#t:Max\" rel=\"nofollow noreferrer\">The <code>Max</code> newtype</a> lifts any instance of <code>Ord</code> into a <code>Semigroup</code> by making <code>&lt;&gt;</code> pick the larger of its arguments.</p>\n\n<p>So by <code>foldMap</code>ping the input <code>Foldable</code> through the composition of <code>Option</code> and <code>Max</code>, we get your desired behaviour.</p>\n\n<pre><code>safeMaximum :: (Foldable t, Ord a) =&gt; t a -&gt; Maybe a\nsafeMaximum = fmap getMax . getOption . foldMap (Option . Just . Max)\n\nghci&gt; safeMaximum \"wowzers\"\nJust 'z'\nghci&gt; safeMaximum \"\"\nNothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 6, "last_activity_date": 1494946354, "creation_date": 1494946354, "answer_id": 44004855, "question_id": 44001843, "link": "https://stackoverflow.com/questions/44001843/safe-maximum-in-haskell-standard-library/44004855#44004855", "title": "Safe `maximum` in Haskell Standard Library?", "body": "<p>For the sake of completeness: loosening your \"Standard Library\" requirement to \"some very commonly used library\", the <em>safe</em> package provides the <a href=\"https://hackage.haskell.org/package/safe-0.3.14/docs/Safe-Foldable.html\" rel=\"noreferrer\"><code>Safe.Foldable</code> module</a>, which includes a <code>maximumMay</code> function:</p>\n\n<pre><code>maximumMay :: (Foldable t, Ord a) =&gt; t a -&gt; Maybe a\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 44004855, "answer_count": 3, "score": 6, "last_activity_date": 1589775188, "creation_date": 1494938659, "question_id": 44001843, "link": "https://stackoverflow.com/questions/44001843/safe-maximum-in-haskell-standard-library", "title": "Safe `maximum` in Haskell Standard Library?", "body": "<p>Is there a safe equivalent of <code>maximum</code> in Haskell's Standard Library?</p>\n\n<pre><code>*Main Control.Monad.State Data.List&gt; maximum []\n*** Exception: Prelude.maximum: empty list\n</code></pre>\n\n<p>I tried to find one, <code>(Ord a, Foldable t) =&gt; t a -&gt; Maybe a</code> with <a href=\"https://www.haskell.org/hoogle/?hoogle=%28Ord+a%2C+Foldable+t%29+%3D%3E+t+a+-%3E+Maybe+a\" rel=\"noreferrer\">hoogle</a>, but found none.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494937844, "post_id": 44001523, "comment_id": 75031272, "body": "shouldn&#39;t it be <code>mapInput decodeUtf8 (pure . encodeUtf8)</code> ?"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494937917, "post_id": 44001523, "comment_id": 75031319, "body": "That would make sense! Will edit with your suggestion and wait for feedback from OP :)"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494938082, "post_id": 44001523, "comment_id": 75031452, "body": "@epsilonhalbe, actually from the type of <code>mapInput</code>, it might have to be swapped. I probably shouldn&#39;t be answering stuff about conduit when I barely know it myself... :/"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494941272, "post_id": 44001523, "comment_id": 75034019, "body": "@basilehenry - I had the same problem, you just beat me by a minute or so ;-)"}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": false, "score": 2, "last_activity_date": 1494938658, "last_edit_date": 1494938658, "creation_date": 1494937754, "answer_id": 44001523, "question_id": 44000862, "link": "https://stackoverflow.com/questions/44000862/convert-type-with-bytestring-to-text/44001523#44001523", "title": "Convert Type with ByteString to Text?", "body": "<p>I don't know <code>conduit</code> well enough but from reading the documentation I would try something along the line of:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Void          (Void)\nimport Data.Text          (Text)\nimport Data.Text.Encoding (encodeUtf8, decodeUtf8)\nimport Data.ByteString    (ByteString)\nimport Data.Conduit\n\ntype Helper a = ConduitM a Void (Control.Monad.Trans.Resource.Internal.ResourceT IO) ()\n\nf :: Helper ByteString -&gt; Helper Text\nf = mapInput encodeUtf8 (pure . decodeUtf8)\n</code></pre>\n\n<p>Using <a href=\"https://hackage.haskell.org/package/conduit-1.2.10/docs/Data-Conduit.html#v:mapInput\" rel=\"nofollow noreferrer\"><code>mapInput</code></a>, <a href=\"https://hackage.haskell.org/package/text-1.2.2.1/docs/Data-Text-Encoding.html#v:encodeUtf8\" rel=\"nofollow noreferrer\"><code>encodeUtf8</code></a> and <a href=\"https://hackage.haskell.org/package/text-1.2.2.1/docs/Data-Text-Encoding.html#v:decodeUtf8\" rel=\"nofollow noreferrer\"><code>decodeUtf8</code></a> </p>\n\n<p><strike>This is untested, tell me if it works for you! :-)</strike></p>\n\n<p>Just tested quickly in ghci, it seems to work. You might want some proper error handling for <code>decodeUtf8</code> though.</p>\n"}, {"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1494955462, "creation_date": 1494955462, "answer_id": 44007889, "question_id": 44000862, "link": "https://stackoverflow.com/questions/44000862/convert-type-with-bytestring-to-text/44007889#44007889", "title": "Convert Type with ByteString to Text?", "body": "<p>I'd recommend using the <a href=\"https://www.stackage.org/haddock/lts-8.13/conduit-combinators-1.1.1/Conduit.html#v:decodeUtf8C\" rel=\"nofollow noreferrer\"><code>decodeUtf8C</code> function</a> together with normal fusion (the <code>.|</code> operator). If your code looks like:</p>\n\n<pre><code>makesText .| needsByteString\n</code></pre>\n\n<p>Then you could rewrite it as:</p>\n\n<pre><code>makesText .| decodeUtf8C .| needsByteString\n</code></pre>\n\n<p>You can also choose to use <a href=\"https://www.stackage.org/haddock/lts-8.13/conduit-combinators-1.1.1/Conduit.html#v:decodeUtf8LenientC\" rel=\"nofollow noreferrer\"><code>decodeUtf8LenientC</code></a> if you want to ignore encoding errors.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 44007889, "answer_count": 2, "score": 1, "last_activity_date": 1494955462, "creation_date": 1494935984, "question_id": 44000862, "link": "https://stackoverflow.com/questions/44000862/convert-type-with-bytestring-to-text", "title": "Convert Type with ByteString to Text?", "body": "<p>Using <a href=\"https://hackage.haskell.org/package/conduit-1.2.10\" rel=\"nofollow noreferrer\">conduit</a>, my private repo code fails to compile:</p>\n\n<pre><code>  Expected type: ConduitM\n                   Text Void (Control.Monad.Trans.Resource.Internal.ResourceT IO) ()\n    Actual type: ConduitM\n                   ByteString\n                   Void\n                   (Control.Monad.Trans.Resource.Internal.ResourceT IO)\n                   ()\n</code></pre>\n\n<p>How can I define a function?</p>\n\n<pre><code>type Helper a = ConduitM a Void (Control.Monad.Trans.Resource.Internal.ResourceT IO ()\n\nf :: Helper ByteString -&gt; Helper Text\n</code></pre>\n"}, {"tags": ["algorithm", "haskell", "functional-programming", "backtracking"], "comments": [{"owner": {"reputation": 861, "user_id": 7779290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MgAkF.jpg?s=128&g=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/7779290/chirag"}, "edited": false, "score": 1, "creation_date": 1494932774, "post_id": 43999492, "comment_id": 75027656, "body": "Though I don&#39;t know haskell. But  <a href=\"https://puzzling.stackexchange.com/questions/3017/10-digit-number-where-first-n-digits-are-divisible-by-n\">This Link</a> might be helpful to you because it gives answer to same problem. There are multiple answers and both answer will help you because one is from algorithmic point of view and another is from programming point of view.."}, {"owner": {"reputation": 142, "user_id": 7679546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-uPtGwXnQN2g/AAAAAAAAAAI/AAAAAAAAAHg/fCv2_y0qkhE/photo.jpg?sz=128", "display_name": "arlan schouwstra", "link": "https://stackoverflow.com/users/7679546/arlan-schouwstra"}, "reply_to_user": {"reputation": 861, "user_id": 7779290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MgAkF.jpg?s=128&g=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/7779290/chirag"}, "edited": false, "score": 0, "creation_date": 1494933093, "post_id": 43999492, "comment_id": 75027871, "body": "Very helpful site! But not the same programming language."}, {"owner": {"reputation": 861, "user_id": 7779290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MgAkF.jpg?s=128&g=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/7779290/chirag"}, "edited": false, "score": 0, "creation_date": 1494933243, "post_id": 43999492, "comment_id": 75027972, "body": "Yeah, I know C but don&#39;t know haskel. So by interpreting that <code>C</code> code you&#39;ll have to convert it into haskel. Sorry For that."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 1, "creation_date": 1494966424, "post_id": 43999492, "comment_id": 75050138, "body": "(I&#39;d prefer distinction between <i>number</i> and <i>digit</i>, with a mention of <i>decimal</i>.)"}], "answers": [{"tags": [], "owner": {"reputation": 810, "user_id": 6454387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/836f5a3c702c54cee8bffccf5a61916c?s=128&d=identicon&r=PG&f=1", "display_name": "ljeabmreosn", "link": "https://stackoverflow.com/users/6454387/ljeabmreosn"}, "is_accepted": false, "score": 0, "last_activity_date": 1497480723, "creation_date": 1497480723, "answer_id": 44555929, "question_id": 43999492, "link": "https://stackoverflow.com/questions/43999492/haskell-backtracking-with-integer/44555929#44555929", "title": "haskell backtracking with integer", "body": "<p>Here is the solution:</p>\n\n<pre><code>module Main where\n\nimport Data.Maybe\nimport Data.Set (Set)\nimport qualified Data.Set as Set\n\nfindUniqueNumber :: Int -&gt; Int -&gt; Set Int -&gt; Maybe Int\nfindUniqueNumber currNum divisor remDigits\n  | divisor == 9 &amp;&amp; currNum `rem` divisor == 0 = Just currNum\n  | divisor &gt; 0 &amp;&amp; currNum `rem` divisor /= 0  = Nothing\n  | otherwise                                  =\n    case filter isJust posNums of\n       []             -&gt; Nothing\n       [uniqueNumber] -&gt; uniqueNumber\n    where\n        posNums   = map posAns (Set.toList remDigits)\n        posAns d' = findUniqueNumber (currNum * 10 + d') (divisor + 1) (Set.delete d' remDigits)\n\nmain :: IO ()\nmain = (print . fromJust) $ findUniqueNumber 0 0 (Set.fromList [1..9])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 7679546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-uPtGwXnQN2g/AAAAAAAAAAI/AAAAAAAAAHg/fCv2_y0qkhE/photo.jpg?sz=128", "display_name": "arlan schouwstra", "link": "https://stackoverflow.com/users/7679546/arlan-schouwstra"}, "is_accepted": true, "score": 0, "last_activity_date": 1497884265, "creation_date": 1497884265, "answer_id": 44633871, "question_id": 43999492, "link": "https://stackoverflow.com/questions/43999492/haskell-backtracking-with-integer/44633871#44633871", "title": "haskell backtracking with integer", "body": "<pre><code>uniekGetal :: [Int]\nuniekGetal = [val9 | \n        x1 &lt;- [1..9],\n        let val = x1,\n        x2 &lt;- [x| x &lt;- [1..9], x /= x1],\n        let val2 = val * 10 + x2,\n        mod val2 2 == 0,\n        x3 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2],\n        let val3 = val2 * 10 + x3,\n        mod val3 3 == 0,\n        x4 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2, x /= x3],\n        let val4 = val3 * 10 + x4,\n        mod val4 4 == 0,\n        x5 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2, x /= x3, x /= x4],\n        let val5 = val4 * 10 + x5,\n        mod val5 5 == 0,\n        x6 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2, x /= x3, x /= x4, x /= x5],\n        let val6 = val5 * 10 + x6,\n        mod val6 6 == 0,\n        x7 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2, x /= x3, x /= x4, x /= x5, x /= x6],\n        let val7 = val6 * 10 + x7,\n        mod val7 7 == 0,\n        x8 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2, x /= x3, x /= x4, x /= x5, x /= x6, x /= x7],\n        let val8 = val7 * 10 + x8,\n        mod val8 8 == 0,\n        x9 &lt;- [x| x &lt;- [1..9], x /= x1, x /= x2, x /= x3, x /= x4, x /= x5, x /= x6, x /= x7, x /= x8],\n        let val9 = val8 * 10 + x9,\n        mod val9 9 == 0]\n</code></pre>\n\n<p>this was the solution to my problem.</p>\n"}], "owner": {"reputation": 142, "user_id": 7679546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-uPtGwXnQN2g/AAAAAAAAAAI/AAAAAAAAAHg/fCv2_y0qkhE/photo.jpg?sz=128", "display_name": "arlan schouwstra", "link": "https://stackoverflow.com/users/7679546/arlan-schouwstra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "accepted_answer_id": 44633871, "answer_count": 2, "score": 0, "last_activity_date": 1497884265, "creation_date": 1494932087, "last_edit_date": 1494932760, "question_id": 43999492, "link": "https://stackoverflow.com/questions/43999492/haskell-backtracking-with-integer", "title": "haskell backtracking with integer", "body": "<p>I am a Haskell newbie. So, I would like to ask a simple question.</p>\n\n<p>I have to find with help of backtracking the (unique) number containing 9 numbers with the following characteristics:</p>\n\n<blockquote>\n  <p>The numbers 1/9 appear exactly once.</p>\n  \n  <p>The first k numbers of n are\n   divisible by k for k runs from 1/9</p>\n</blockquote>\n\n<p><strong>Example</strong></p>\n\n<p><code>n = 123456789\n1 (the first number of n) should be divisible by 1. true!\n2 (the first 2 numbers of n) should be divisible by 2. true!\n3 (the first 3 numbers of n) should be divisible by 3. true!\n4 (the first 4 numbers of n) should be divisible by 4. false!</code></p>\n\n<p>So, 123456789 <strong>is not</strong> the <strong>desired number</strong>.</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1494929756, "post_id": 43998326, "comment_id": 75025564, "body": "What about that script makes just <code>:load</code>ing into a normal GHCi session impossible?"}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1494970990, "post_id": 43998326, "comment_id": 75052268, "body": "@leftaroundabout: Nothing -- this is the solution."}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494928934, "creation_date": 1494928934, "question_id": 43998326, "link": "https://stackoverflow.com/questions/43998326/launching-ghci-with-a-turtle-script", "title": "Launching GHCi with a Turtle Script", "body": "<p>Suppose one has a turtle script, but doesn't want to run it. Is there a way to launch a stack ghci environment with all of the functions loaded from the script?</p>\n"}, {"tags": ["haskell", "configuration", "transparency", "x11", "xmonad"], "answers": [{"comments": [{"owner": {"reputation": 4043, "user_id": 6949852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uebCh.png?s=128&g=1", "display_name": "\u9673 \u529b", "link": "https://stackoverflow.com/users/6949852/%e9%99%b3-%e5%8a%9b"}, "edited": false, "score": 0, "creation_date": 1584420673, "post_id": 43998106, "comment_id": 107424289, "body": "Hi, i met <code>Not in scope: type constructor or class Word32&#39;</code>, where goes wrong?"}, {"owner": {"reputation": 1596, "user_id": 6605742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541e05b738eac1c7923d85279df2a4b3?s=128&d=identicon&r=PG&f=1", "display_name": "Silvan Mosberger", "link": "https://stackoverflow.com/users/6605742/silvan-mosberger"}, "reply_to_user": {"reputation": 4043, "user_id": 6949852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uebCh.png?s=128&g=1", "display_name": "\u9673 \u529b", "link": "https://stackoverflow.com/users/6949852/%e9%99%b3-%e5%8a%9b"}, "edited": false, "score": 0, "creation_date": 1584620575, "post_id": 43998106, "comment_id": 107495622, "body": "@\u9673\u529b Sounds like you need <code>import Data.Word</code>"}], "tags": [], "owner": {"reputation": 1596, "user_id": 6605742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541e05b738eac1c7923d85279df2a4b3?s=128&d=identicon&r=PG&f=1", "display_name": "Silvan Mosberger", "link": "https://stackoverflow.com/users/6605742/silvan-mosberger"}, "is_accepted": true, "score": 10, "last_activity_date": 1494928332, "creation_date": 1494928332, "answer_id": 43998106, "question_id": 43998105, "link": "https://stackoverflow.com/questions/43998105/making-every-window-transparent-with-xmonad/43998106#43998106", "title": "Making every window transparent with xmonad", "body": "<p>To do that, you need an event hook that sets the opacity property on creation of new windows. This is what I'm using (requires <code>xprop</code> to be on the path):</p>\n\n<pre><code>import XMonad\nimport Graphics.X11.Xlib\nimport Graphics.X11.Xlib.Extras\nimport Data.Monoid\n\nsetTransparentHook :: Event -&gt; X All\nsetTransparentHook ConfigureEvent{ev_event_type = createNotify, ev_window = id} = do\n  setOpacity id opacity\n  return (All True) where\n    opacityFloat = 0.9\n    opacity = floor $ fromIntegral (maxBound :: Word32) * opacityFloat\n    setOpacity id op = spawn $ \"xprop -id \" ++ show id ++ \" -f _NET_WM_WINDOW_OPACITY 32c -set _NET_WM_WINDOW_OPACITY \" ++ show op\nsetTransparentHook _ = return (All True)\n\nmain = xmonad $ def\n  { handleEventHook = setTransapentHook &lt;+&gt; handleEventHook def }\n</code></pre>\n\n<h3>Process</h3>\n\n<blockquote>\n  <p>Give a man a fish and you feed him for a day; teach a man to fish and you feed him for a lifetime.</p>\n</blockquote>\n\n<p>In the spirit of this quote I'm describing my process of coming up with this. Note that I have very limited experience with all of Haskell, xmonad and X11.</p>\n\n<p>The initial mindset was that I needed a script that sets the opacity on all windows (which turned out not to be exactly what I needed). I know that composite managers on linux do this kind of stuff (visual effects), so I check out the man page of compton (which I'm using) via <code>man compton</code>.</p>\n\n<p>Searching for \"opacity\", I see the <code>--opacity-rule</code> flag, which mentions that <code>compton-trans</code> is recommended for this instead, so I look at <a href=\"https://github.com/chjj/compton/blob/316eac0613bf342ff91cc645a6c3c80e6b9083fb/bin/compton-trans#L9-L25\" rel=\"noreferrer\">its source</a>. Trying out the script in the command line to discover that I need the window ID to set its opacity, so I look up how to do that.</p>\n\n<p>A solution was to use <code>xwininfo</code>. You can list all the windows using <code>xwininfo -tree -root</code>. I thought I needed to parse the output of that and was already looking up <code>awk</code> tutorials.</p>\n\n<p>Then I get the idea: \"Wait, what if I just set the opacity on window creation? Xmonad is a window manager, it should definitely have the window ID!\". So I look through <a href=\"http://hackage.haskell.org/package/xmonad-0.13/docs/XMonad-Core.html\" rel=\"noreferrer\">xmonad's config options</a> where I find the <code>handleEventHook</code> property. By clicking on the types <code>Event</code> and <code>All</code> I find out which imports I need (<code>Graphics.X11.Xlib.Extras</code> and <code>Data.Monoid</code>).</p>\n\n<p>Creating a skeleton for my event hook by coping the <a href=\"https://github.com/xmonad/xmonad/blob/10b843ad21614994b7e12fafaf300f4267aa9e40/src/XMonad/Config.hs#L118-L119\" rel=\"noreferrer\">default</a>:</p>\n\n<pre><code>import XMonad\nimport Graphics.X11.Xlib.Extras\nimport Data.Monoid\n\nmyEventHook :: Event -&gt; X All\nmyEventHook _ = return (All True)\n</code></pre>\n\n<p>Now some Haskell knowledge is needed, I want to do something when <code>Event</code> is a window creation event. Looking through the <a href=\"http://hackage.haskell.org/package/X11-1.8/docs/Graphics-X11-Xlib-Extras.html#t:Event\" rel=\"noreferrer\"><code>Event</code> docs</a> and a bit of probing, I found out I need the <code>ConfigureEvent</code> where <code>ev_event_type</code> is <code>createNotify</code> while <code>ev_window</code> is the created window ID. To use <code>createNotify</code> I also import <code>Graphics.X11.Xlib</code>:</p>\n\n<pre><code>import XMonad\nimport Graphics.X11.Xlib\nimport Graphics.X11.Xlib.Extras\nimport Data.Monoid\n\nmyEventHook :: Event -&gt; X All\nmyEventHook ConfigureEvent{ ev_event_type = createNotify, ev_window = id } = do\n  return (All True)\nmyEventHook _ = return (All True)\n</code></pre>\n\n<p>Now what do we actually want to do? We want to spawn a shell process with the <code>compton-trans</code> command. There is the simple function <code>spawn</code> used throughout xmonad:</p>\n\n<pre><code>myEventHook :: Event -&gt; X All\nmyEventHook ConfigureEvent{ ev_event_type = createNotify, ev_window = id } = do\n  spawn $ \"compton-trans -w \" ++ show id ++ \" 50\"\n  return (All True)\nmyEventHook _ = return (All True)\n</code></pre>\n\n<p>It worked! That's great but I noticed it being a bit slow and it still has the compton dependency which isn't really needed. So I look at the <code>compton-trans</code> source again, and see <a href=\"https://github.com/chjj/compton/blob/316eac0613bf342ff91cc645a6c3c80e6b9083fb/bin/compton-trans#L207-L208\" rel=\"noreferrer\">the last line that actually does the work</a> which just uses <code>xprop</code>! Now this is great because I don't need all the stuff of <code>compton-trans</code> which does some checks and is optimized for user convenience. Using some number conversion I came up with the final version as shown above. It may even be faster to use the direct path to the executable.</p>\n\n<p>I sometimes also used the <code>ghci ~/.xmonad/xmonad.hs</code> to check some types and <code>man xprop</code>/<code>man whatever</code> to check the documentation.</p>\n\n<p>I hope this helps fellow xmonads to getting started! If someone has some improvements, please let me know.</p>\n"}], "owner": {"reputation": 1596, "user_id": 6605742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541e05b738eac1c7923d85279df2a4b3?s=128&d=identicon&r=PG&f=1", "display_name": "Silvan Mosberger", "link": "https://stackoverflow.com/users/6605742/silvan-mosberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 43998106, "answer_count": 1, "score": 3, "last_activity_date": 1494928332, "creation_date": 1494928332, "question_id": 43998105, "link": "https://stackoverflow.com/questions/43998105/making-every-window-transparent-with-xmonad", "title": "Making every window transparent with xmonad", "body": "<p>I'd like every window to be transparent, I'm using xmonad and X11. I am not very familiar with any of Haskell, xmonad or X11.</p>\n\n<p>How can I configure xmonad for that? I don't even know how to even get started.</p>\n"}, {"tags": ["haskell", "functional-programming", "string-length", "imperative-programming"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1494929038, "post_id": 43997104, "comment_id": 75025089, "body": "what you intended is captured by <code>(fst . last . zip [0..] . tails)</code> (see <a href=\"http://stackoverflow.com/questions/11922134/how-to-increment-a-variable-in-functional-programming/11923567#11923567\">How to &quot;think functional&quot;</a>)."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1494931252, "post_id": 43997104, "comment_id": 75026554, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43932436/haskell-length-function-implementation\">Haskell Length function implementation</a>"}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1494932912, "post_id": 43997104, "comment_id": 75027746, "body": "What do you mean, &quot;it does not work&quot;? Does it crash? Does it produce wrong results?"}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 7919917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/240ead997dde6467ec7c20d03d3626af?s=128&d=identicon&r=PG&f=1", "display_name": "Coreeze", "link": "https://stackoverflow.com/users/7919917/coreeze"}, "edited": false, "score": 0, "creation_date": 1494942227, "post_id": 43997368, "comment_id": 75034792, "body": "Yeah, you are right. I knew it was to &quot;imperative&quot; but I could not quite get to the end in other way. I have already started the book."}], "tags": [], "owner": {"reputation": 704, "user_id": 7719864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yigmu.jpg?s=128&g=1", "display_name": "Robson", "link": "https://stackoverflow.com/users/7719864/robson"}, "is_accepted": false, "score": 5, "last_activity_date": 1494927563, "last_edit_date": 1494927563, "creation_date": 1494926527, "answer_id": 43997368, "question_id": 43997104, "link": "https://stackoverflow.com/questions/43997104/the-length-of-a-list-without-the-length-function-in-haskell/43997368#43997368", "title": "The length of a list without the &quot;length&quot; function in Haskell", "body": "<p>It looks you still think in an imperative way (not the functional way). For example:</p>\n\n<ul>\n<li>you try to change the value of a \"variable\" (i.e. <code>y++</code>)</li>\n<li>you try to use \"global variable\" (i.e. <code>y</code>) in the body of the <code>list</code> function</li>\n</ul>\n\n<p>Here is the possible solution to your problem:</p>\n\n<pre><code>main = print $ my_length [1..10]\n\nmy_length :: [Integer] -&gt; Integer\nmy_length [] = 0\nmy_length (_:xs) = 1 + my_length xs\n</code></pre>\n\n<p>You can also run this code here: <a href=\"http://ideone.com/mjUwL9\" rel=\"noreferrer\">http://ideone.com/mjUwL9</a>.</p>\n\n<p>Please also note that there is no need to require that your list consists of <code>Integer</code> values. In fact, you can create much more \"agnostic\" version of your function by using the following declaration:</p>\n\n<pre><code>my_length :: [a] -&gt; Integer\n</code></pre>\n\n<p>Implementation of this function doesn't rely on the type of items from the list, thus you can use it for a list of any type. In contrast, you couldn't be that much liberal for, for example, <code>my_sum</code> function (a potential function that calculates the sum of elements from the given list). In this situation, you should define that your list consists of some numerical type items.</p>\n\n<p>At the end, I'd like to suggest you a fantastic book about Haskell programming: <a href=\"http://learnyouahaskell.com/chapters\" rel=\"noreferrer\">http://learnyouahaskell.com/chapters</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 138, "user_id": 7919917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/240ead997dde6467ec7c20d03d3626af?s=128&d=identicon&r=PG&f=1", "display_name": "Coreeze", "link": "https://stackoverflow.com/users/7919917/coreeze"}, "edited": false, "score": 0, "creation_date": 1494942156, "post_id": 43997428, "comment_id": 75034744, "body": "Thank you! I knew that it was too &quot;imperative&quot;, but i could not quite get to the final one without doing it like this. Thanks once again!"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1494953601, "post_id": 43997428, "comment_id": 75042833, "body": "Of course since lists are indeed a monad you <i>can</i> frame <code>length</code> as a monadic operation: <code>length xs = sum $ do {xs; return 1}</code>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1494932593, "last_edit_date": 1494932593, "creation_date": 1494926678, "answer_id": 43997428, "question_id": 43997104, "link": "https://stackoverflow.com/questions/43997104/the-length-of-a-list-without-the-length-function-in-haskell/43997428#43997428", "title": "The length of a list without the &quot;length&quot; function in Haskell", "body": "<p>Your program looks quite \"<em>imperative</em>\": you define a variable <code>y</code>, and then somehow write a <code>do</code>, that calls (?) the <code>list</code> function (?) that automagically seems to \"return <code>y</code>\" and then you want to increment <code>y</code>.</p>\n\n<p>That's not how Haskell (and most functional and declarative) languages work:</p>\n\n<ul>\n<li>in a declarative language, you define a <em>variable</em> only once, after the value is set, there is usually no way to alter its value,</li>\n<li>in Haskell a <code>do</code> usually is used for monads, whereas the <code>length</code> is a <em>pure</em> function,</li>\n<li>the <code>let</code> is a syntax construction to define a variable within the scope of an expression,</li>\n<li>...</li>\n</ul>\n\n<p>In order to program Haskell (or any functional language), you need to \"think functional\": think how you would solve the problem in a <em>mathematical</em> way using <em>only functions</em>.</p>\n\n<p>In mathematics, you would say that the empty list <code>[]</code> clearly has length <code>0</code>. Furthermore in case the list is not empty, there is a first element (the \"head\") and remaining elements (the \"tail\"). In that case the result is one plus the length of the tail. We can convert that in a mathematical expression, like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bbb6c.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/bbb6c.gif\" alt=\"LaTeX\"></a></p>\n\n<p>Now we can easily translate that function into the following Haskell code:</p>\n\n<pre><code>ownLength :: [a] -&gt; Int\nownLength [] = 0\nownLength (_:xs) = 1 + ownLength xs\n</code></pre>\n\n<p>Now in Haskell, one usually also uses <em>accumulators</em> in order to perform <em>tail recursion</em>: you pass a parameter through the recursive calls and each time you <em>update</em> the variable. When you reach the end of your recursion, you return - sometimes after some post-processing - the accumulator.</p>\n\n<p>In this case the accumulator would be the so far seen length, so you could write:</p>\n\n<pre><code>ownLength :: [a] -&gt; Int\nownLength = ownLength' 0\n    where ownLength' a [] = a\n          ownLength' a (_:xs) = ownLength' (a+1) xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1494942660, "post_id": 44002412, "comment_id": 75035128, "body": "this simplifies to <a href=\"http://stackoverflow.com/a/43932632/849891\"><code>foldr (const (1+)) 0</code></a>."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1494940137, "creation_date": 1494940137, "answer_id": 44002412, "question_id": 43997104, "link": "https://stackoverflow.com/questions/43997104/the-length-of-a-list-without-the-length-function-in-haskell/44002412#44002412", "title": "The length of a list without the &quot;length&quot; function in Haskell", "body": "<p>Other answers have already beautifully explained the proper functional approach. It looks like an overkill but here is another way of implementing the <code>length</code> function by using only available higher order functions.</p>\n\n<pre><code>my_length :: [a] -&gt; Integer\nmy_length = foldr (flip $ const . (+1)) 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": false, "score": 1, "last_activity_date": 1530085509, "creation_date": 1530085509, "answer_id": 51057222, "question_id": 43997104, "link": "https://stackoverflow.com/questions/43997104/the-length-of-a-list-without-the-length-function-in-haskell/51057222#51057222", "title": "The length of a list without the &quot;length&quot; function in Haskell", "body": "<p>Probably the simplest way is to convert all elements to <code>1</code> and then to sum the new elements:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sum . map (const 1)\n</code></pre>\n\n<p>For added speed:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foldl' (+) 0 . map (const 1)\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 7919917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/240ead997dde6467ec7c20d03d3626af?s=128&d=identicon&r=PG&f=1", "display_name": "Coreeze", "link": "https://stackoverflow.com/users/7919917/coreeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13003, "favorite_count": 1, "accepted_answer_id": 43997428, "answer_count": 4, "score": 1, "last_activity_date": 1530085509, "creation_date": 1494925890, "last_edit_date": 1494928734, "question_id": 43997104, "link": "https://stackoverflow.com/questions/43997104/the-length-of-a-list-without-the-length-function-in-haskell", "title": "The length of a list without the &quot;length&quot; function in Haskell", "body": "<p>I want to see how long a list is, but without using the function <em><code>length</code></em>. I wrote this program and it does not work. Maybe you can tell me why? Thanks!</p>\n\n<pre><code>let y = 0\nmain = do\n  list (x:xs) = list (xs)\n  y++\n\nlist :: [Integer] -&gt; Integer\nlist [] = y\n</code></pre>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1494918519, "post_id": 43989702, "comment_id": 75017797, "body": "A side note: unlike <code>ListT</code>, the &quot;iterative monad transformer&quot; in module <code>Control.Monad.Trans.Iter</code> of the <code>free</code> package does let you compose effectful lists of actions &quot;in paralell&quot; using the <code>MonadPlus</code> instance. <a href=\"http://hackage.haskell.org/package/free-4.12.4/docs/Control-Monad-Trans-Iter.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/free-4.12.4/docs/&hellip;</a> <a href=\"https://gist.github.com/danidiaz/e9382127d1c4025b9845\" rel=\"nofollow noreferrer\">gist.github.com/danidiaz/e9382127d1c4025b9845</a>"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 9, "last_activity_date": 1494918602, "last_edit_date": 1494918602, "creation_date": 1494886948, "answer_id": 43989702, "question_id": 43989174, "link": "https://stackoverflow.com/questions/43989174/pipes-tutorial-listt-example/43989702#43989702", "title": "Pipes Tutorial: ListT example", "body": "<blockquote>\n  <p>When you run this (on GHCi), the first name you input will get bound\n  and only the second will change. I would expect that both producers\n  (defined by <code>Select input</code>) will take turns (maybe\n  non-deterministically) at reading the input.</p>\n</blockquote>\n\n<p><code>ListT</code> doesn't work that way. Instead, it is \"depth-first\". Every time it gets a first name, it starts reading the whole list of last names anew.</p>\n\n<p>The example doesn't do that, but each list of last names could depend on the first name that has been read previously. Like this:</p>\n\n<pre><code>input' :: String -&gt; Producer String IO ()\ninput' msg = \n    (forever $ do \n        liftIO $ putStr msg\n        r &lt;- liftIO $ getLine\n        yield r\n    ) &gt;-&gt; P.takeWhile (/= \"quit\")\n\nname' :: ListT IO String\nname' = do\n    firstName &lt;- Select input\n    lastName  &lt;- Select $ input' $ \"Enter a last name for \" ++ firstName ++ \": \"\n    return (firstName ++ \" \" ++ lastName)\n</code></pre>\n\n<blockquote>\n  <p>Entering quit one time will allow to re-bind the first name. Again, I\n  fail to see why firstName will get bound to the first value entered by\n  the user.</p>\n</blockquote>\n\n<p>If we are reading last names and encounter a quit command, that \"branch\" terminates and we go back to the level above, to read another first name from the list. The \"effectful list\" that reads the last names is only re-created after we have a first name to work with.</p>\n\n<blockquote>\n  <p>Entering <code>quit</code> twice in a row will terminate the program. However, I\n  would expect that <code>quit</code> only has to be entered twice to quit the\n  program (possibly alternating with other input).</p>\n</blockquote>\n\n<p>Notice that entering a single quit at the very beginning will also terminate the program, as we are \"closing\" the top-level list of first names.</p>\n\n<p>Basically, every time you enter a <code>quit</code> you close the current branch and go up a level in the \"search tree\". Every time you enter a first name you go down one level.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 5739278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29179e06448ab37f9d4bc759cfd16f34?s=128&d=identicon&r=PG&f=1", "display_name": "mbw", "link": "https://stackoverflow.com/users/5739278/mbw"}, "is_accepted": false, "score": 0, "last_activity_date": 1513432903, "creation_date": 1513432903, "answer_id": 47846463, "question_id": 43989174, "link": "https://stackoverflow.com/questions/43989174/pipes-tutorial-listt-example/47846463#47846463", "title": "Pipes Tutorial: ListT example", "body": "<p>To add to @danidiaz's great answer, you <em>can</em> get the behavior of <code>name</code> prompting for a <code>firstName</code> again, instead of just keep asking for <code>lastName</code>s.</p>\n\n<p>What you can do is make use of the <code>MonadZip</code> instance of <code>Monad m =&gt; ListT m</code>, particularly</p>\n\n<pre><code>mzip :: Monad m =&gt; ListT m a -&gt; ListT m b -&gt; ListT m (a, b).\n</code></pre>\n\n<p>Thus, you could define <code>name</code> as</p>\n\n<pre><code>name :: ListT IO String\nname = do\n  (firstName, lastName) &lt;- mzip (Select input) (Select input)\n  return (firstName ++ \" \" ++ lastName)\n</code></pre>\n\n<p>and you get your alternating behavior.</p>\n\n<p>As a nice aside, you can use the <code>MonadComprehensions</code> and <code>ParallelListComp</code> extensions as well. Using these, the two versions of <code>name</code> become</p>\n\n<pre><code>name  :: ListT IO String\nname  = [ firstName ++ \" \" ++ lastName | firstName &lt;- Select input\n                                       , lastName  &lt;- Select input ]\n\nname' :: ListT IO String\nname' = [ firstName ++ \" \" ++ lastName | firstName &lt;- Select input\n                                       | lastName  &lt;- Select input ]\n</code></pre>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 43989702, "answer_count": 2, "score": 6, "last_activity_date": 1513432903, "creation_date": 1494884146, "last_edit_date": 1503866923, "question_id": 43989174, "link": "https://stackoverflow.com/questions/43989174/pipes-tutorial-listt-example", "title": "Pipes Tutorial: ListT example", "body": "<p>I'm trying to make sense of one of the examples presented at the <a href=\"https://hackage.haskell.org/package/pipes-4.3.3/docs/Pipes-Tutorial.html\" rel=\"nofollow noreferrer\">pipes tutorial</a> concerning <code>ListT</code>:</p>\n\n<pre><code>import Pipes\nimport qualified Pipes.Prelude as P\n\ninput :: Producer String IO ()\ninput = P.stdinLn &gt;-&gt; P.takeWhile (/= \"quit\")\n\nname :: ListT IO String\nname = do\n    firstName &lt;- Select input\n    lastName  &lt;- Select input\n    return (firstName ++ \" \" ++ lastName)\n</code></pre>\n\n<p>If the example above is run, we get output like the following:</p>\n\n<pre><code>&gt;&gt;&gt; runEffect $ every name &gt;-&gt; P.stdoutLn\nDaniel&lt;Enter&gt;\nFischer&lt;Enter&gt;\nDaniel Fischer\nWagner&lt;Enter&gt;\nDaniel Wagner\nquit&lt;Enter&gt;\nDonald&lt;Enter&gt;\nStewart&lt;Enter&gt;\nDonald Stewart\nDuck&lt;Enter&gt;\nDonald Duck\nquit&lt;Enter&gt;\nquit&lt;Enter&gt;\n&gt;&gt;&gt; \n</code></pre>\n\n<p>It seems that:</p>\n\n<ol>\n<li>When you run this (on ghci), the first name you input will get bound and only the second will change. I would expect that both producers (defined by <code>Select input</code>) will take turns (maybe non-deterministically) at reading the input. </li>\n<li>Entering <code>quit</code> one time will allow to re-bind the first name. Again, I fail to see why <code>firstName</code> will get bound to the first value entered by the user.</li>\n<li>Entering <code>quit</code> twice in a row will terminate the program. However, I would expect that <code>quit</code> only has to be entered twice to quit the program (possibly alternating with other input).</li>\n</ol>\n\n<p>I'm missing something fundamental about the way the example above works, but I cannot see what.</p>\n"}, {"tags": ["haskell", "conditional-statements", "list-comprehension", "mod"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1494872712, "post_id": 43986351, "comment_id": 75001989, "body": "Have you looked up a tutorial? This is likely covered in <i>any</i> comprehension tutorial."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1494872843, "post_id": 43986351, "comment_id": 75002066, "body": "I&#39;m voting to close this question as off-topic because there&#39;s no clear effort or attempt.  StackOverflow is best seen as help with clear-cut bugs and not a from scratch code-writing service or substitute for a tutorial."}, {"owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "edited": false, "score": 0, "creation_date": 1494878729, "post_id": 43986351, "comment_id": 75005030, "body": "Sorry Thomas. I already tried to give my previous attempt, but the system gaved message : &quot;this post does not meet our quality standart&quot;."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1494928373, "post_id": 43986351, "comment_id": 75024610, "body": "if you didn&#39;t know about the existence of <code>mod</code>, you could&#39;ve coded it yourself with a list comprehension too! <code>mod n d == 0</code> === <code>last [n, n-d..0] == ??</code> so <code>[x | x &lt;- [1..] , odd x, x % 2 == 0]</code> === <code>[x | x &lt;- [1..] , odd x, last [n, n-d..0]==??]</code> === <code>[x | x &lt;- [1..] , odd x, y &lt;- [n, n-d..0], y==??]</code>."}, {"owner": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 0, "creation_date": 1495421844, "post_id": 43986351, "comment_id": 75228014, "body": "Here I had problems. Not exactly a helpful problem description. Read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "edited": false, "score": 0, "creation_date": 1494879087, "post_id": 43986706, "comment_id": 75005182, "body": "hi Karakfa, Thank you for the advice. [x | x &lt;- [1..], odd x, mod x 7==0, mod x 9 == 3 ] works. I didnt know that there are &quot;mod&quot; function in haskell. my previous attempt was : [x | x&lt;- [1..] , odd x, x / 2 == 0, (and here i had the main problems)]."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "edited": false, "score": 0, "creation_date": 1494885610, "post_id": 43986706, "comment_id": 75008109, "body": "@MNazar if you run into problems like you mentioned, why not include them? It makes a huge difference to see what you are struggling with, compared to asking a full fledged solution. I will be glad to help if i see something like your attempt plus the error ghc produces in a future question."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1494873928, "creation_date": 1494873928, "answer_id": 43986706, "question_id": 43986351, "link": "https://stackoverflow.com/questions/43986351/how-to-set-conditions-in-a-haskell-list-comprehension/43986706#43986706", "title": "How to set conditions in a Haskell List Comprehension", "body": "<p>just to get you started a partial answer</p>\n\n<pre><code>[x | x &lt;- [1..], odd x, mod x 7==?, ??? ]\n\n[21,147,273,399,525,651,777,903,1029,1155...]\n</code></pre>\n\n<p>it can't get simpler than this, just translate your verbal description to code, exactly one to one...</p>\n"}], "owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "closed_date": 1494877726, "answer_count": 1, "score": -6, "last_activity_date": 1494922214, "creation_date": 1494872492, "last_edit_date": 1494922214, "question_id": 43986351, "link": "https://stackoverflow.com/questions/43986351/how-to-set-conditions-in-a-haskell-list-comprehension", "closed_reason": "Not suitable for this site", "title": "How to set conditions in a Haskell List Comprehension", "body": "<p>Im trying to generate a list of all Numbers bigger than <em>0</em> with the following conditions: </p>\n\n<ul>\n<li>all elements are odd </li>\n<li>all elements divide trough 7 without remainder</li>\n<li>all elements divide trough 9 with remainder 3 </li>\n</ul>\n\n<p>e.g. <code>[21,147,273,399,...]</code></p>\n\n<p>I tried : <code>[x | x &lt;- [1..] , odd x, x / 2 == 0, ...</code> (and here I had  problems)</p>\n"}, {"tags": ["haskell", "syntax-highlighting", "pandoc", "pygments", "github-linguist"], "owner": {"reputation": 2090, "user_id": 1816995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/334c90f05a880876813421d9623e461e?s=128&d=identicon&r=PG", "display_name": "mpacer", "link": "https://stackoverflow.com/users/1816995/mpacer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "closed_date": 1494898995, "answer_count": 0, "score": 4, "last_activity_date": 1494870738, "creation_date": 1494870738, "question_id": 43985848, "link": "https://stackoverflow.com/questions/43985848/what-are-the-differences-between-skylighting-pygments-and-linguist", "closed_reason": "Needs more focus", "title": "What are the differences between skylighting, pygments and Linguist?", "body": "<p>Aside from being written in haskell, python and ruby, what are the main differences between <a href=\"https://github.com/jgm/skylighting\" rel=\"nofollow noreferrer\"><code>skylighting</code></a>, <a href=\"https://bitbucket.org/birkenfeld/pygments-main\" rel=\"nofollow noreferrer\"><code>pygments</code></a> and <a href=\"https://github.com/github/linguist\" rel=\"nofollow noreferrer\"><code>Linguist</code></a>?</p>\n\n<p>Do they vary widely in the language support? Do they have different internal structures? To what extent can they be used interchangeably? Are there any automatic tools for comparing the effects of their application (possibly in the vein of <a href=\"https://johnmacfarlane.net/babelmark2/\" rel=\"nofollow noreferrer\">babelmark</a> for markdown)? </p>\n\n<p>Is there a list of all the tools/organisations that these different tools are used? Pygments has a list of <a href=\"http://pygments.org/faq/#who-uses-pygments\" rel=\"nofollow noreferrer\">\"who uses pygments\"</a>, and it's clear that skylighting is used by pandoc and Linguist is used by GitHub, but are there other major tools that use these?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "tail-recursion"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1494866920, "post_id": 43984738, "comment_id": 74998789, "body": "Consider using pattern matching more than guards: <code>loop ([],m) = m; loop (x:xs,m) = ...</code>.  At any rate, your <code>null xs</code> case is where you ignore the last <code>x</code> value."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 5, "creation_date": 1494868984, "post_id": 43984738, "comment_id": 75000005, "body": "Incidentally, in your original <code>maxList</code>, the auxiliary definition of <code>iMaxList</code> serves no purpose: since <code>maxList l = iMaxList l</code> (and <code>iMaxList</code> doesn&#39;t ever refer to the original <code>l</code>), the two functions are identical. You might as well just add the pattern matches to <code>maxList</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 1, "last_activity_date": 1494890666, "last_edit_date": 1494890666, "creation_date": 1494870078, "answer_id": 43985684, "question_id": 43984738, "link": "https://stackoverflow.com/questions/43984738/update-a-function-to-include-tail-recursion/43985684#43985684", "title": "Update a function to include tail recursion", "body": "<p>I guess this is what your are searching for:</p>\n\n<pre><code>maxList' :: Ord a =&gt; [a] -&gt; a\nmaxList'     []   = error \"Empty List\"\nmaxList'    [x]   = x\nmaxList' (x:y:xs) = maxList' (max x y:xs)\n</code></pre>\n\n<p>The function uses the same list that is processing to store the biggest number found so far. It seems to comply with the tail recursion definition, ie: the recursive call is the very last thing in the computation of the function. </p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 1, "last_activity_date": 1495066679, "last_edit_date": 1495066679, "creation_date": 1494889672, "answer_id": 43990117, "question_id": 43984738, "link": "https://stackoverflow.com/questions/43984738/update-a-function-to-include-tail-recursion/43990117#43990117", "title": "Update a function to include tail recursion", "body": "<pre><code>listMax :: Ord a =&gt; [a] -&gt; a\nlistMax [] = error \"Tried to find maximum of an empty list.\"\nlistMax (x:xs) = listMax' xs x where\n  listMax' :: Ord a =&gt; [a] -&gt; a -&gt; a\n  listMax' [] y = y\n  listMax' (x:xs) y | x &gt; y     = listMax' xs x\n                    | otherwise = listMax' xs y\n</code></pre>\n\n<p>In this case, y is the accumulating parameter that holds the maximum value found so far.  Brief proof of correctness: the algorithm terminates because each tail-recursive call removes one element from the input list until it is empty.  The final value of <code>y</code> it returns is the maximum because, for every other element <code>x</code> in the input, either <code>y &gt; x</code> or <code>y &gt; z &gt; x</code> for some <code>z</code> after <code>x</code> and before <code>y</code>.  (This assumes that <code>&gt;</code> is transitive.)</p>\n\n<p>You could also write the helper function this way:</p>\n\n<pre><code>listMax' :: Ord a =&gt; [a] -&gt; a -&gt; a\nlistMax' [] y = y\nlistMax' (x:xs) y = listMax' xs (max x y)\n</code></pre>\n\n<p>And this implementation does the same thing:</p>\n\n<pre><code>listMax2 :: Ord a =&gt; [a] -&gt; a\nlistMax2 [] = error \"Tried to find maximum of an empty list.\"\nlistMax2 list = foldl1 max list\n</code></pre>\n\n<p>The <code>foldl1</code> function is a tail-recursive lazy evaluation from front to back, but the strict <code>foldl1'</code> version or <code>foldr1</code> might be more efficient in this case.  The first version is closer to strict evaluation than lazy.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 0, "last_activity_date": 1494948473, "last_edit_date": 1495540483, "creation_date": 1494942708, "answer_id": 44003419, "question_id": 43984738, "link": "https://stackoverflow.com/questions/43984738/update-a-function-to-include-tail-recursion/44003419#44003419", "title": "Update a function to include tail recursion", "body": "<p>Don't worry about it.</p>\n\n<p>I wrote the following in a file:</p>\n\n<pre><code>module MaxList (maxList) where\n\nimport Data.List\n\nmaxList :: Ord a =&gt; [a] -&gt; a\nmaxList = foldl1' max\n</code></pre>\n\n<p>Then I compiled it with <code>-O2 -ddump-simpl</code>, to have a look at the optimised Core. After a bit of cleaning up - GHC generates a lot of variables with names that are difficult to read - the generated code looks like this:</p>\n\n<pre><code>maxList [] = error \"empty list\"\nmaxList (x:xs) = go xs x\n    where go ys y =\n              case ys of\n                   [] -&gt; y;\n                   (z:zs) -&gt; case y of  -- force y to WHNF before continuing\n                                  _ -&gt; go zs (max y z)\n</code></pre>\n\n<p><code>go</code> is tail recursive. In fact it's the same as the code in <a href=\"https://stackoverflow.com/a/43990117/7951906\">@Davislor's answer</a>! I used <code>foldl1'</code> - a high-level control structure - and GHC generated exactly the code that you would've written by hand if you wanted to write a tail recursive loop.</p>\n\n<p>Haskell's philosophy is that you should use high-level tools like folds, unfolds, monads, classes, etc, and rely on the compiler to generate good code. There certainly is an art to writing code which GHC will do a good job of optimising - you don't always get it for free - but you usually shouldn't need to unroll high-level structures into low-level loops because GHC is good at that.</p>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 43990117, "answer_count": 3, "score": 1, "last_activity_date": 1495066679, "creation_date": 1494866353, "question_id": 43984738, "link": "https://stackoverflow.com/questions/43984738/update-a-function-to-include-tail-recursion", "title": "Update a function to include tail recursion", "body": "<p>I have the following function that determines the maximum element of a given list. </p>\n\n<pre><code>maxList :: Ord a =&gt; [a] -&gt; a\nmaxList l =\n    let iMaxList :: Ord a =&gt; [a] -&gt; a\n        iMaxList [] = error( \"Empty list\" )\n        iMaxList [x] = x\n        iMaxList ( x:xs )\n            | x &gt; t = x\n            | otherwise = t\n            where t = iMaxList xs\n    in iMaxList l\n</code></pre>\n\n<p>Yet, it doesn't use tail recursion and I'd like it to do so.\nI tried to use an accumulator to comply with the tail recursion principle in Haskell. </p>\n\n<pre><code>maxList :: Ord a =&gt; [a] -&gt; a\nmaxList ( x:xs ) = loop( xs, x )\n                  where loop( x:xs, m )\n                            | ( null xs ) = m\n                            | ( x &gt;= m ) = loop( xs, x )\n                            | otherwise = loop( xs, m )\n</code></pre>\n\n<p>Yet, it logically fails because of this guard <code>(null xs) = m</code>. Indeed, if we take the list <code>[1,2,3,4]</code>, <code>4</code>will never be evaluated.</p>\n\n<p>How can I fix that? </p>\n"}, {"tags": ["haskell", "functional-programming", "tail-recursion"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1494859192, "post_id": 43982278, "comment_id": 74993670, "body": "Are you mixing tabs &amp; spaces? Haskell hates that. Also this test <code>x:xs == []</code> is constant <code>False</code>. Probably not what you meant to write."}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 1, "creation_date": 1494865900, "post_id": 43982624, "comment_id": 74998284, "body": "Thanks, very detailed answer."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1494860621, "last_edit_date": 1494860621, "creation_date": 1494860084, "answer_id": 43982624, "question_id": 43982278, "link": "https://stackoverflow.com/questions/43982278/parsing-error-on-tail-recursion-haskell/43982624#43982624", "title": "Parsing error on tail recursion Haskell", "body": "<p>The <strong>syntactical error</strong>, is due to the fact that the spaces are not equal in the where clause: the <code>if</code> statement has less spaces than the <code>where</code> line. You can thus easily resolve it by writing a one-liner in the <code>where</code> clauses:</p>\n\n<pre><code>sum_list_tail :: [Int] -&gt; Int\nsum_list_tail ( x:xs ) = inc( x:xs, 0 )\n    where inc( x:xs, a ) = if ( x:xs == [] ) then a else inc( xs, a+x )\n</code></pre>\n\n<p>Nevertheless there is still a <strong>semantical error</strong>: the <strong><code>x:xs</code> cannot be equal to <code>[]</code>. So the <code>if</code> statement will always</strong> be false. You can solve this by working with <strong>pattern matching</strong>:</p>\n\n<pre><code>sum_list_tail :: [Int] -&gt; Int\nsum_list_tail ( x:xs ) = inc( x:xs, 0 )\n    where inc( [], a ) = a\n          inc ( x:xs, a ) = inc( xs, a+x )\n</code></pre>\n\n<p>Nevertheless, to me it does <em>not</em> feel very <em>Haskell-ish</em>. Usually you do not work with tuples, but with multiple arguments, like:</p>\n\n<pre><code>sum_list_tail :: [Int] -&gt; Int\nsum_list_tail ls = inc ls 0\n    where inc []     a = a\n          inc (x:xs) a = inc xs a+x\n</code></pre>\n\n<p>Furthermore there is already a <code>sum</code> defined: <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:sum\" rel=\"nofollow noreferrer\"><code>sum :: (Num a, Foldable t) =&gt; t a -&gt; a</code></a>.</p>\n\n<p>If you want to define a <code>sum</code>, you can also use for instance <code>foldl</code>:</p>\n\n<pre><code>sum_list_tail :: (Num b, Foldable t) =&gt; t b -&gt; b\nsum_list_tail = foldl (+) 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 7476826, "user_type": "registered", "profile_image": "https://graph.facebook.com/1209818619067432/picture?type=large", "display_name": "Guillem Marqu&#233;s de Trasobares", "link": "https://stackoverflow.com/users/7476826/guillem-marqu%c3%a9s-de-trasobares"}, "is_accepted": false, "score": 0, "last_activity_date": 1494985694, "creation_date": 1494985694, "answer_id": 44014187, "question_id": 43982278, "link": "https://stackoverflow.com/questions/43982278/parsing-error-on-tail-recursion-haskell/44014187#44014187", "title": "Parsing error on tail recursion Haskell", "body": "<p>The more natural recursion to solve this (if you are not familiar with foldr or foldl) would be this:</p>\n\n<pre><code>sum_list_tail :: [Int] -&gt; Int\nsum_list_tail  [] = 0 \nsum_list_tail (x:xs) = x+ sum_list_tail xs\n</code></pre>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 43982624, "answer_count": 2, "score": 0, "last_activity_date": 1494985694, "creation_date": 1494859089, "question_id": 43982278, "link": "https://stackoverflow.com/questions/43982278/parsing-error-on-tail-recursion-haskell", "title": "Parsing error on tail recursion Haskell", "body": "<p>I have the following code to compute the sum of all the elements of a list.</p>\n\n<pre><code>sum_list_tail :: [Int] -&gt; Int\nsum_list_tail ( x:xs ) = inc( x:xs, 0 )\n                            where inc( x:xs, a ) =\n                                if ( x:xs == [] ) then a\n                                    else inc( xs, a+x )\n</code></pre>\n\n<p>I try to use tail recursion to solve this problem. </p>\n\n<p>I have this error <code>parse error (possibly incorrect indentation or mismatched brackets)</code> occurring at this line <code>if ( x:xs == [] ) then a</code></p>\n\n<p>Can't find out what I'm doing wrong. </p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494855421, "post_id": 43981000, "comment_id": 74990967, "body": "Can you show the warnings you get. Why do you use <code>AATree</code> instead of <code>Tree</code> in your function signature?"}, {"owner": {"reputation": 77, "user_id": 2890171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17863b952c54566147edf8b30a0578d5?s=128&d=identicon&r=PG&f=1", "display_name": "mistysch", "link": "https://stackoverflow.com/users/2890171/mistysch"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494855769, "post_id": 43981000, "comment_id": 74991227, "body": "Sorry, the I copied the wrong code, I&#39;ve changed it, it was only a difference of aatree/tree though!"}, {"owner": {"reputation": 77, "user_id": 2890171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17863b952c54566147edf8b30a0578d5?s=128&d=identicon&r=PG&f=1", "display_name": "mistysch", "link": "https://stackoverflow.com/users/2890171/mistysch"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494855802, "post_id": 43981000, "comment_id": 74991252, "body": "warning is: warning: [-Wincomplete-patterns]     Pattern match(es) are non-exhaustive     In an equation for \u2018get\u2019: Patterns not matched: _ (Node _ _ _ )"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 2890171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17863b952c54566147edf8b30a0578d5?s=128&d=identicon&r=PG&f=1", "display_name": "mistysch", "link": "https://stackoverflow.com/users/2890171/mistysch"}, "edited": false, "score": 0, "creation_date": 1494856434, "post_id": 43981282, "comment_id": 74991679, "body": "Thank you! @Willem Van Onsem"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1494856934, "last_edit_date": 1494856934, "creation_date": 1494856194, "answer_id": 43981282, "question_id": 43981000, "link": "https://stackoverflow.com/questions/43981000/pattern-matching-warning-with-binary-tree/43981282#43981282", "title": "Pattern matching warning with binary tree", "body": "<p>There are two problems here. First of all, the datatype:</p>\n\n<pre><code>data Tree a = Nil | Node a (Tree left) (Tree right) deriving (Eq, Show, Read)\n--                               ^ left?     ^ right?\n</code></pre>\n\n<p>In your data definition, you make use of <strong><code>left</code> and <code>right</code></strong>, but those are <em>not</em> defined in the head of the data definition, therefore these are <strong>not type parameters</strong>. You probably wanted to say:</p>\n\n<pre><code>data Tree a =   Nil\n              | Node { value :: a, <b>left</b> :: Tree <b>a</b>, <b>right</b> :: Tree <b>a</b>}\n              deriving (Eq, Show, Read)</code></pre>\n\n<p>But now we still get an error:</p>\n\n<pre><code>hs.hs:5:1: Warning:\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018get\u2019: Patterns not matched: _ (Node _ _ _)\nOk, modules loaded: Main.\n</code></pre>\n\n<p>The problem here is that <strong>Haskell does not know that two values can only be <code>&lt;</code>, <code>==</code> or <code>&gt;</code>)</strong>.</p>\n\n<p>If you write an <code>instance</code> of <code>Ord</code>, then you have a \"contact\" that you will define a <em>total ordering</em>. In other words, for any two values <code>x</code> and <code>y</code>, it holds that <code>x &lt; y</code>, <code>x &gt; y</code> or <code>x == y</code>. The problem is however that Haskell does <em>not</em> know that. For Haskell any of the functions <code>(&lt;)</code>, <code>(==)</code> or <code>(&gt;)</code> can result in <code>True</code> or <code>False</code>. Therefore - since a compiler is <strong>always conservative</strong> - it considers the case where there are two values such that all <code>x &lt; y</code>, <code>x == y</code> and <code>x &gt; y</code> fail (say that you hypothetically would have written <code>foo x y</code>, <code>bar x y</code> and <code>qux x y</code> then this definitely could happens since those are three <em>blackbox</em> functions). You can resolve it by <strong>writing <code>otherwise</code></strong> in the last case:</p>\n\n<pre><code>get :: Ord a =&gt; a -&gt; Tree a -&gt; Maybe a\nget _ Nil = Nothing\nget x (Node v lt rt)\n    | x == v = Just x\n    | x &lt; v = get x lt\n    | <b>otherwise</b> = get x rt</code></pre>\n\n<p><code>otherwise</code> is an <em>alias</em> for <code>True</code> and therefore <em>there is no possibility</em> not to take that branch. So now the <em>conservative</em> compiler understands that, regardless what the values of <code>x</code> and <code>y</code> are, it will always take <em>some</em> branch, because if it does not take the first two, it will <em>certainly</em> take the last one.</p>\n\n<p>You may think that it is weird, but since the contracts are usually not specified in a formal language (only in the documentation, so a <em>natural</em> language), the compiler has <em>no</em> means to know that: you could as a programmer decide not to respect the contracts (but note that this is a <em>very</em> bad idea). Even if you write a formal contract usually as a programmer you still can decide not to respect it and furthermore a compiler cannot always do the required logical reasoning about the formal contracts.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1494882401, "creation_date": 1494882401, "answer_id": 43988817, "question_id": 43981000, "link": "https://stackoverflow.com/questions/43981000/pattern-matching-warning-with-binary-tree/43988817#43988817", "title": "Pattern matching warning with binary tree", "body": "<p>Willem Van Onsem has already explained the issue well. I only want to add that it <em>is</em> possible to perform a comparison between <code>x</code> and <code>v</code> in a very similar way to the posted code, whose branches are however found exhaustive by the compiler.</p>\n\n<p>Instead of</p>\n\n<pre><code>get :: Ord a =&gt; a -&gt; Tree a -&gt; Maybe a\nget _ Nil = Nothing\nget x (Node v lt rt)\n    | x == v = Just x\n    | x &lt; v = get x lt\n    | x &gt; v = get x rt\n</code></pre>\n\n<p>simply use</p>\n\n<pre><code>get :: Ord a =&gt; a -&gt; Tree a -&gt; Maybe a\nget _ Nil = Nothing\nget x (Node v lt rt) = case compare x v of\n    EQ -&gt; Just x\n    LT -&gt; get x lt\n    GT -&gt; get x rt\n</code></pre>\n\n<p>Indeed, <code>compare</code> is a function taking two arguments and returning a value in the enumerated type <code>Ordering</code>, which can only be <code>EQ</code> (equal), <code>LT</code> (less than), and <code>GT</code> (greater than). Since this is an algebraic type, GHC can see that all its constructors are handled by the <code>case</code>.</p>\n\n<p>Further, depending on the actual type <code>a</code>, using <code>compare</code> can be more efficient. E.g., when comparing two potentially long strings, it's suboptimal to traverse them twice (if not three times, in the original code): <code>compare</code> does only a single pass to both strings and determines which order relation holds.</p>\n"}], "owner": {"reputation": 77, "user_id": 2890171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17863b952c54566147edf8b30a0578d5?s=128&d=identicon&r=PG&f=1", "display_name": "mistysch", "link": "https://stackoverflow.com/users/2890171/mistysch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 43981282, "answer_count": 2, "score": 1, "last_activity_date": 1494882401, "creation_date": 1494855344, "last_edit_date": 1494855975, "question_id": 43981000, "link": "https://stackoverflow.com/questions/43981000/pattern-matching-warning-with-binary-tree", "title": "Pattern matching warning with binary tree", "body": "<p>I'm a beginner at Haskell and am having some trouble with understanding the warnings I get. I have implemented a binary tree, </p>\n\n<pre><code>data Tree a = Nil | Node a (Tree a) (Tree a) deriving (Eq, Show, \nRead)\n</code></pre>\n\n<p>and it works fine but I get incomplete patterns warning on this code </p>\n\n<pre><code>get :: Ord a =&gt; a -&gt; Tree a -&gt; Maybe a\nget _ Nil = Nothing\nget x (Node v lt rt)\n    | x == v = Just x\n    | x &lt; v = get x lt\n    | x &gt; v = get x rt\n</code></pre>\n\n<p>The pattern it wants me to match is <code>_ (Node _ _ _ )</code>. I'm not sure what this pattern means?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "tail-recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494848195, "post_id": 43978447, "comment_id": 74986058, "body": "You cannot use <code>Fractional f -&gt; Int i</code> since <code>Fractional</code> is a class, not a <code>data</code>. Do you by any chance mean <code>Fractional f =&gt; f -&gt; Int</code>?"}, {"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494848269, "post_id": 43978447, "comment_id": 74986101, "body": "Well I can use anything as long as it&#39;s the signature of a function that can computes the largest integer below any non-negative fractional number."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1494872814, "post_id": 43978447, "comment_id": 75002047, "body": "@PierreP. He means that the signature you gave is invalid Haskell. The Haskell compiler would reject that signature, because of the errors in it."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1494849475, "last_edit_date": 1494849475, "creation_date": 1494849064, "answer_id": 43978785, "question_id": 43978447, "link": "https://stackoverflow.com/questions/43978447/largest-integer-below-any-given-non-negative-fractional-number/43978785#43978785", "title": "Largest integer below any given non-negative fractional number", "body": "<p>Any <code>Fractional</code> has a class defintion, like:</p>\n\n<pre><code>class Num a =&gt; Fractional a where\n    fromRational :: Rational -&gt; a\n    -- ...\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>type Rational = Ratio Integer\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>(%) :: Integral a =&gt; a -&gt; a -&gt; Ratio a \n</code></pre>\n\n<p>I also assume that there is a type constraint such that we can <em>compare</em> two <code>f</code>s (of the <code>Fractional</code> instance). So what we can do is:</p>\n\n<ol>\n<li>start with an accumulator set to <code>0</code>,</li>\n<li>construct a <code>Rational</code> that has the value <em>accumulator+1</em>,</li>\n<li>cast that <code>Rational</code> to the <code>f</code> type,</li>\n<li>compare the constructed <code>f</code> with the given <code>f</code>,</li>\n<li>if the value is greater than the given one, then we return the accumulator,</li>\n<li>otherwise, we perform recursion by an incremented accumulator.</li>\n</ol>\n\n<p>So in code this would look like:</p>\n\n<pre><code>import Data.Ratio((%))\n\nlargest :: (Fractional a, Ord a) =&gt; a -&gt; Integer\nlargest v = largest' 0\n    where largest' x | fromRational (x1%1) &gt;= v = x -- increment is less than or equal, return x\n                     | otherwise = largest' x1 -- if smaller, recursion\n              where x1 = x+1 -- increment accumulator\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>*Main Data.Ratio&gt; largest (7%5)\n1\n*Main Data.Ratio&gt; largest (21%5)\n4\n*Main Data.Ratio&gt; largest (1%5)\n0\n</code></pre>\n\n<p>If you want more freedom about the return type (any <code>Num</code>, you can add <code>fromIntegral</code> in the basecase):</p>\n\n<pre><code>import Data.Ratio((%))\n\nlargest :: (Fractional a, Ord a<b>, Num b</b>) =&gt; a -&gt; <b>b</b>\nlargest v = largest' 0\n    where largest' x | fromRational (x1%1) &gt;= v = <b>fromIntegral</b> x -- increment is less than or equal, return x\n                     | otherwise = largest' x1 -- if smaller, recursion\n              where x1 = x+1 -- increment accumulator</code></pre>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 43978785, "answer_count": 1, "score": 0, "last_activity_date": 1494849475, "creation_date": 1494848106, "question_id": 43978447, "link": "https://stackoverflow.com/questions/43978447/largest-integer-below-any-given-non-negative-fractional-number", "title": "Largest integer below any given non-negative fractional number", "body": "<p>How could I, using tail recursion, <strong>find the largest interger below any non-negative fractional number</strong>?</p>\n\n<p>I have defined the function <code>largest :: Fractional f -&gt; Int i</code> but don't see how I can use tail recursion in this case.</p>\n"}, {"tags": ["haskell", "typeclass", "type-constructor"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1494847544, "post_id": 43977997, "comment_id": 74985691, "body": "For this specific case, couldn&#39;t you define <code>instance GetGLInfo ()</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1122, "user_id": 1157045, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7K8WL.png?s=128&g=1", "display_name": "tly", "link": "https://stackoverflow.com/users/1157045/tly"}, "edited": false, "score": 0, "creation_date": 1494931210, "post_id": 43978758, "comment_id": 75026521, "body": "I think I understand, do I need the RankNTypes language extension for your &quot;forall&quot; definitions ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1122, "user_id": 1157045, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7K8WL.png?s=128&g=1", "display_name": "tly", "link": "https://stackoverflow.com/users/1157045/tly"}, "edited": false, "score": 1, "creation_date": 1494933801, "post_id": 43978758, "comment_id": 75028355, "body": "@tly no, it has nothing to do with that, these are just <a href=\"https://wiki.haskell.org/Scoped_type_variables\" rel=\"nofollow noreferrer\">scoped type variables</a>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1494849002, "creation_date": 1494849002, "answer_id": 43978758, "question_id": 43977997, "link": "https://stackoverflow.com/questions/43977997/overlapping-instances-of-a-type-class-for-a-constructor/43978758#43978758", "title": "Overlapping instances of a type class for a constructor", "body": "<p>You must make the inductive instance actually distinguishable from the base case. Right now, <code>((Vec.:.) a ())</code> is merely a special case of <code>((Vec.:.) a b)</code>, which is what \u201coverlapping instance\u201d means. But you want the latter to only match if <code>b</code> is itself already non-zero-dimensional. Well, make that explicit:</p>\n\n<pre><code>instance (GetGLInfo a, GetGLInfo b, GetGLInfo xs) =&gt; GetGLInfo (a:.b:.xs) where\n  numComponents (_:.b:.xs)= 1 + numComponents (b:.xs)\n  bytesPerComponent = bytesPerComponent . Vec.head\n  openGLType = openGLType . Vec.head\n</code></pre>\n\n<p>Alternatively and in principle more elegant is what Alexey Romanov suggests: make the base case zero-dimensional. But apparently there is no <code>GL_VOID</code>, so not an option here.</p>\n\n<p>As a completely different approach, I would suggest only making your own class for scalars, and then generalising over arbitrary vector spaces:</p>\n\n<pre><code>import Data.VectorSpace\nimport Data.Basis\n\nclass GLScalar s where\n  scalar_bytesPerComponent :: Functor proxy =&gt; proxy s -&gt; Int\n  scalar_openGLType :: Functor proxy =&gt; proxy s -&gt; GL.GLenum\n\ninstance GLScalar Float\n\nbytesPerComponent :: \u2200 v proxy\n        . (VectorSpace v, GLScalar (Scalar v), Functor proxy)\n             =&gt; proxy v -&gt; Int\nbytesPerComponent _ = scalar_bytesPerComponent ([]::[Scalar v])\n\nnumComponents :: \u2200 v . HasBasis v =&gt; v -&gt; Int\nnumComponents = length . decompose\n</code></pre>\n"}], "owner": {"reputation": 1122, "user_id": 1157045, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7K8WL.png?s=128&g=1", "display_name": "tly", "link": "https://stackoverflow.com/users/1157045/tly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43978758, "answer_count": 1, "score": 0, "last_activity_date": 1494849002, "creation_date": 1494846732, "question_id": 43977997, "link": "https://stackoverflow.com/questions/43977997/overlapping-instances-of-a-type-class-for-a-constructor", "title": "Overlapping instances of a type class for a constructor", "body": "<p>I would like to create a type class <code>GetGLInfo</code> that holds some basic type information needed by multiple <code>OpenGL</code> functions:</p>\n\n<pre><code>class GetGLInfo v where\n    numComponents :: v -&gt; GL.GLint\n    bytesPerComponent :: v -&gt; Int\n    openGLType :: v -&gt; GL.GLenum\n</code></pre>\n\n<p>An easy instance is <code>Float</code>:</p>\n\n<pre><code>instance GetGLInfo Float where\n    numComponents _ = 1\n    bytesPerComponent = sizeOf\n    openGLType _ = GL.GL_FLOAT\n</code></pre>\n\n<p>I would like to create an instance of this class for the <a href=\"https://hackage.haskell.org/package/Vec-1.0.5/docs/Data-Vec.html\" rel=\"nofollow noreferrer\">Data.Vec</a> vector data type with the constructor <code>data a :. b</code>:</p>\n\n<pre><code>import qualified Data.Vec as Vec\ninstance GetGLInfo a =&gt; GetGLInfo ((Vec.:.) a ()) where\n    numComponents _ = 1\n    bytesPerComponent = (bytesPerComponent).(Vec.head)\n    openGLType = (openGLType).(Vec.head)\n\ninstance (GetGLInfo a, GetGLInfo b) =&gt; GetGLInfo ((Vec.:.) a b) where\n    numComponents (_ Vec.:. r)= 1 + (numComponents r)\n    bytesPerComponent = (bytesPerComponent).(Vec.head)\n    openGLType = (openGLType).(Vec.head)\n</code></pre>\n\n<p>I wouldve used <code>numComponents = Vec.length</code> but I got more type errors...</p>\n\n<p>When calling <code>openGLType</code> for a <code>Vec2</code> I get the following error:</p>\n\n<pre><code>let c = openGLType ((0.0 :. 1.0 :. ()) :: Vec2 Float)\nerror:\n* Overlapping instances for GetGLInfo (Float :. ())\n    arising from a use of `openGLType'\n  Matching instances:\n    instance GetGLInfo a =&gt; GetGLInfo (a :. ())\n      -- Defined in `GLTypeInfo'\n    instance (GetGLInfo a, GetGLInfo b) =&gt; GetGLInfo (a :. b)\n      -- Defined in `GLTypeInfo'\n* In the expression: openGLType ((0.0 :. 1.0 :. ()) :: Vec2 Float)\n  In an equation for `c':\n      c = openGLType ((0.0 :. 1.0 :. ()) :: Vec2 Float)\n</code></pre>\n\n<p>Why do my instances overlap here?\nIs there a easy way to create an instance of <code>(:.) a b</code> without an explicit instance for the base case <code>(:.) a ()</code>?</p>\n"}, {"tags": ["macos", "haskell", "sublimetext3"], "comments": [{"owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "edited": false, "score": 0, "creation_date": 1494849866, "post_id": 43977091, "comment_id": 74987134, "body": "you&#39;d better ask it in sublimehaskell&#39;s issues list: <a href=\"https://github.com/SublimeHaskell/SublimeHaskell/issues\" rel=\"nofollow noreferrer\">github.com/SublimeHaskell/SublimeHaskell/issues</a>"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494944425, "post_id": 43977091, "comment_id": 75036496, "body": "Have you installed hsdev?"}, {"owner": {"reputation": 1256, "user_id": 3116231, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ImKoG.jpg?s=128&g=1", "display_name": "zinyosrim", "link": "https://stackoverflow.com/users/3116231/zinyosrim"}, "edited": false, "score": 0, "creation_date": 1494947863, "post_id": 43977091, "comment_id": 75039053, "body": "no, do I need to? I just used sublime package install, as with other languages"}, {"owner": {"reputation": 1256, "user_id": 3116231, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ImKoG.jpg?s=128&g=1", "display_name": "zinyosrim", "link": "https://stackoverflow.com/users/3116231/zinyosrim"}, "reply_to_user": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 3, "creation_date": 1495010690, "post_id": 43977091, "comment_id": 75066695, "body": "@basile-henry installed hsdev with <code>cabal install hsdev</code> from command prompt, restarted sublime and got it working. thanks for the hint"}], "owner": {"reputation": 1256, "user_id": 3116231, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ImKoG.jpg?s=128&g=1", "display_name": "zinyosrim", "link": "https://stackoverflow.com/users/3116231/zinyosrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1494843974, "creation_date": 1494843974, "question_id": 43977091, "link": "https://stackoverflow.com/questions/43977091/sublimehaskell-error-message-on-mac", "title": "SublimeHaskell error message on Mac", "body": "<p>I'm gettingh following error message when I try to save a .hs file on Mac OS Sierra:</p>\n\n<p>check_lint.run_chain: Cannot execute command chain, hsdev not connected.</p>\n\n<p>I tried to </p>\n\n<ol>\n<li>reinstall the plugin</li>\n<li><p>Added following  to my subline user settings:</p>\n\n<pre><code> {\n     \"enable_hsdev\" : true,\n     \"enable_ghc_mod\" : true,\n     \"enable_hdevtools\": true,\n     \"add_to_PATH\": [\"$HOME/.local/bin\", \"$HOME/.cabal/bin\"]\n }\n</code></pre></li>\n</ol>\n\n<p>The syntax checking looks good, but I can't get rid of the message. Any ideas?</p>\n"}, {"tags": ["haskell", "instance", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1494883509, "post_id": 43975450, "comment_id": 75007282, "body": "N.B. <code>Forest a</code> is a type synonym for <code>[a]</code>, so technically the <code>Eq (Forest a)</code> constraint is not necessary, since <code>Eq a</code> already implies <code>Eq [a]</code>.  But this answer is clear given the question&#39;s parameters."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494883988, "post_id": 43975450, "comment_id": 75007480, "body": "@luqui: you are right. I did not know a forest was defined as <code>[Tree a]</code> (well it was possible some additional fields were added). I added your note to the answer together with some comment. Thanks!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494953163, "post_id": 43975450, "comment_id": 75042600, "body": "The last two instances lack <code>Eq</code> in <code>Eq (Tree a)</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495044958, "post_id": 43975450, "comment_id": 75090775, "body": "Thanks @chi for spotting that. Fixed."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1495044937, "last_edit_date": 1495540483, "creation_date": 1494839368, "answer_id": 43975450, "question_id": 43975200, "link": "https://stackoverflow.com/questions/43975200/how-to-instance-eq-without-deriving/43975450#43975450", "title": "how to instance Eq without deriving", "body": "<p>You <strong>can define an <code>instance</code> of <code>Eq</code></strong> on <code>Tree</code> or <code>Test</code>, but there are <em>some</em> problems with your definition.</p>\n\n<pre><code>instance Eq Test where\n    (Test a) == (Test b) = a == b\n</code></pre>\n\n<p>A first one is that <code>Test</code> in <code>Eq Test</code> is <strong>still parametrized</strong>. Indeed, you wrote <code>data Test <b>a</b> = ...</code> so that means that there is a <em>type</em> parameter. So you can specify it with:</p>\n\n<pre><code>instance Eq <b>(</b>Test <b>a)</b> where\n    (Test y) == (Test x) = x == y</code></pre>\n\n<p>Now you thus specified that <code>Eq</code> is defined over <code>Test a</code>. I also renamed <code>a</code> and <code>b</code> to <code>x</code> and <code>y</code>. This is not necessary since the \"type world\" and \"variable world\" are separated, but it makes things less confusing.</p>\n\n<p>But there is still a problem: you call <code>x == y</code>. But <strong>there is no guantee that <code>a</code> itself is an instance of <code>Eq</code></strong>. You thus need to work with a <em>type constraint</em>:</p>\n\n<pre><code>instance <b>Eq a =&gt;</b> Eq (Test a) where\n    (Test y) == (Test x) = x == y</code></pre>\n\n<p>Now you specify that <code>Test a</code> is an instance of <code>Eq</code> <em>if</em> <code>a</code> is an instance of <code>Eq</code> as well.</p>\n\n<p>For your <code>Tree</code> data structure, the <code>instance</code> of <code>Eq</code> should thus look like:</p>\n\n<pre><code>instance (Eq a, Eq (Forest a)) =&gt; Eq (Tree a) where\n    (Tree x1 y1) == (Tree x2 y2) = x1 == x2 &amp;&amp; y1 == y2\n</code></pre>\n\n<p>(of course I here define <em>how</em> two trees are equal, it is possible that you want to define the equality over two trees in a (semantically) different way, so you should not <em>per se</em> copy paste this code).</p>\n\n<p>Note that - like <a href=\"https://stackoverflow.com/questions/43975200/how-to-instance-eq-without-deriving/43975450?noredirect=1#comment75007282_43975450\">@luqui</a> says - if <code>type Forest a = [Tree a]</code>, then you can <em>omit</em> the <code>Eq (Forest a)</code> type constraint since <code>instance Eq a =&gt; Eq [a]</code> holds. So in that case it is:</p>\n\n<pre><code>instance Eq a =&gt; Eq (Tree a) where\n    (Tree x1 y1) == (Tree x2 y2) = x1 == x2 &amp;&amp; y1 == y2\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 4179776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-wqk14GQWaLA/AAAAAAAAAAI/AAAAAAAAARM/3nqY7GWkbTk/photo.jpg?sz=128", "display_name": "Vonfry", "link": "https://stackoverflow.com/users/4179776/vonfry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 1, "accepted_answer_id": 43975450, "answer_count": 1, "score": 3, "last_activity_date": 1495044937, "creation_date": 1494838631, "last_edit_date": 1494839074, "question_id": 43975200, "link": "https://stackoverflow.com/questions/43975200/how-to-instance-eq-without-deriving", "title": "how to instance Eq without deriving", "body": "<p>Sorry about my poor English. The title may not explain what I mean.</p>\n\n<p>In Data.Tree, <code>Tree</code> is defined as following:</p>\n\n<pre><code>-- | Multi-way trees, also known as /rose trees/.\ndata Tree a = Node {\n        rootLabel :: a,         -- ^ label value\n        subForest :: Forest a   -- ^ zero or more child trees\n    }\n#ifdef __GLASGOW_HASKELL__\n  deriving (Eq, Read, Show, Data)\n#else\n  deriving (Eq, Read, Show)\n#endif\n</code></pre>\n\n<p>It uses <code>deriving</code> to instance <code>==</code> and <code>/=</code> for <code>Tree</code>(date).</p>\n\n<p>Could I do the same thing without deriving? \nI try things like this:</p>\n\n<pre><code>data Test a = Test a\ninstance Eq Test where\n    (Test a) == (Test b) = a == b\n</code></pre>\n\n<p>But It throws an exception. I think the reason is about the types of a and b.</p>\n\n<p>And what can I do whether I want to define a custom action for my data with <code>==</code>.</p>\n\n<p>I know I can use <code>Functor</code> with <code>fmap</code> to do it. But I want to use <code>==</code> like <code>a == b</code> where <code>a = Test 1</code> and <code>b = Test \"a\"</code>. Is it possible?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494842534, "post_id": 43975083, "comment_id": 74982522, "body": "You&#39;re probably interested <a href=\"http://chrisdone.com/posts/data-typeable\" rel=\"nofollow noreferrer\">in this blog post</a>. It predates <code>Data.Coerce.coerce</code>, so some of the things might get done differently today."}], "answers": [{"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 7, "last_activity_date": 1494928743, "last_edit_date": 1494928743, "creation_date": 1494842037, "answer_id": 43976424, "question_id": 43975083, "link": "https://stackoverflow.com/questions/43975083/understanding-haskells-cast-operator/43976424#43976424", "title": "Understanding Haskell&#39;s Cast Operator", "body": "<blockquote>\n  <p>Is there an example of a usage of cast which genuinely \"changes\" the type of a value from one type to another?</p>\n</blockquote>\n\n<p>The simple answer is no. But, there may be a situation in which you do not know your type, since it is \"hidden\" by the quantifier \"exists\". Here's an example:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\nimport Data.Typeable\nimport Data.Maybe\n\ndata Foo = forall a . Typeable a =&gt; Foo a\n\nmain = print . catMaybes . map (\\(Foo x) -&gt; cast x :: Maybe Bool) $ xs\n  where\n    xs = [Foo True, Foo 'a', Foo \"str\", Foo False]\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>[True,False]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 5, "last_activity_date": 1494850371, "creation_date": 1494850371, "answer_id": 43979251, "question_id": 43975083, "link": "https://stackoverflow.com/questions/43975083/understanding-haskells-cast-operator/43979251#43979251", "title": "Understanding Haskell&#39;s Cast Operator", "body": "<p>The purpose of the <code>Typeable</code> class is to allow you to work with data when you don't know its exact type. The purpose of the <code>cast</code> operator is to check whether some data has a specific type, and if so, let you work with it as that type. It's all about doing stuff to <em>the type signature</em> of your data. The actual <em>value</em> does not change at all.</p>\n\n<p>If you want to change the <em>value</em> of some data, that's not a cast, that's a <em>conversion</em>. All sorts of functions out there to do that. E.g., <code>fromIntegral</code> turns something that's an instance of <code>Integral</code> into something else. (E.g., <code>Int</code> to <code>Double</code>.) That's not what <em>casting</em> is about though.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1494856857, "creation_date": 1494856857, "answer_id": 43981499, "question_id": 43975083, "link": "https://stackoverflow.com/questions/43975083/understanding-haskells-cast-operator/43981499#43981499", "title": "Understanding Haskell&#39;s Cast Operator", "body": "<p>Suppose you want to implement a function which acts as the identity function on all values, except for integers where it should act as the successor function.</p>\n\n<p>In an untyped language like Python, this is simple:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; def f(x):\n...   if type(x) == int:\n...     return x+1\n...   else:\n...     return x\n... \n&gt;&gt;&gt; f(42)\n43\n&gt;&gt;&gt; f(\"qwerty\")\n'qwerty'\n</code></pre>\n\n<p>Even in Java, this is doable, even if it requires some casting:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>static &lt;A&gt; A f(A a) {\n    if (a instanceof Integer)\n        return (A) (Integer) ((Integer) a + 1);\n    else\n        return a;\n}\n\npublic static void main (String[] args) throws java.lang.Exception\n{\n    System.out.println(\"&gt;&gt; \" + f(42));\n    System.out.println(\"&gt;&gt; \" + f(\"qwerty\"));\n}\n\n/*  Output:\n&gt;&gt; 43\n&gt;&gt; qwerty\n*/\n</code></pre>\n\n<p>What about Haskell?</p>\n\n<p>In Haskell, this can not be done. Any function of type <code>forall a. a -&gt; a</code> must either fail to terminate, or behave as the identity. This is a direct consequence of the <a href=\"http://homepages.inf.ed.ac.uk/wadler/topics/parametricity.html\" rel=\"nofollow noreferrer\">free theorem</a> associated to that type.</p>\n\n<p>However, if we can add a <code>Typeable</code> constraint on type <code>a</code>, then it becomes possible:</p>\n\n<pre><code>f :: forall a. Typeable a =&gt; a -&gt; a\nf x = case cast x :: Maybe Int of\n   Nothing -&gt; x\n   Just n  -&gt; case cast (n+1) :: Maybe a of\n      Nothing -&gt; x\n      Just y -&gt; y\n</code></pre>\n\n<p>The first <code>cast</code> converts <code>a</code> to <code>Int</code>, the second <code>cast</code> converts <code>a</code> back to <code>Int</code>.</p>\n\n<p>The code above is quite ugly, since we know that the second cast cannot fail, so there's no real need for the second cast. We can improve the code above with <code>eqT</code> and a type-equality GADT:</p>\n\n<pre><code>f :: forall a. Typeable a =&gt; a -&gt; a\nf x = case eqT :: Maybe (a :~: Int) of\n   Nothing   -&gt; x\n   Just Refl -&gt; x+1\n</code></pre>\n\n<p>Basically, <code>eqT</code> tells us whether two (<code>Typeable</code>) types are equal. Even better, after matching with <code>Just Refl</code>, the compiler also knows that they are equal, and allows us to use <code>Int</code> vales instead of <code>a</code> values, interchangeably, and with no casts.</p>\n\n<p>Indeed, thanks to GADTs, <code>:~:</code> and <code>eqT</code>, now most uses of <code>cast</code> are now\nobsolete. <code>cast</code> itself can be trivially implemented with <code>eqT</code>:</p>\n\n<pre><code>cast :: forall a. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b\ncast x = case eqT :: Maybe (a :~: b) of\n   Nothing   -&gt; Nothing\n   Just Refl -&gt; Just x\n</code></pre>\n\n<p>Conclusion: in Haskell, we get the best of both world. We do have parametricity guarantees (free theorems) for polymorphic types. We can also break those parametricity guarantees, and use \"ad hoc\" polymorphism, at the price of an additional <code>Typeable</code> constraint.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "answer_count": 3, "score": 10, "last_activity_date": 1494928743, "creation_date": 1494838319, "question_id": 43975083, "link": "https://stackoverflow.com/questions/43975083/understanding-haskells-cast-operator", "title": "Understanding Haskell&#39;s Cast Operator", "body": "<p>Assume that we have imported <code>Data.Typeable</code> which contains <code>cast :: (Typeable a, Typeable b) -&gt; a -&gt; Maybe b</code>.</p>\n\n<p>Consider that</p>\n\n<pre><code>&gt; cast 'n' :: Maybe Char\nJust 'n'\n</code></pre>\n\n<p>yet</p>\n\n<pre><code>&gt; cast 7 :: Maybe Char\nNothing\n</code></pre>\n\n<p>I understand the above, but it seems to be a trivial example. It doesn't reveal why someone would need to use the <code>cast</code> operator (as far as I can see). </p>\n\n<p><strong>Question:</strong> Is there an example of a usage of <code>cast</code> which genuinely \"changes\" the type of a value from one type to another? The closest example I can think of (which doesn't actually work in GHCi) would be changing the type of <code>7</code> from <code>Integer</code> to <code>Double</code>:</p>\n\n<pre><code>&gt; cast 7 :: Maybe Double\nJust '7' -- this doesn't work, as 7 is typed as a Integer above; instead GHCi returns Nothing\n</code></pre>\n"}, {"tags": ["c++", "haskell", "constants", "ffi"], "comments": [{"owner": {"reputation": 472, "user_id": 1992776, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/564eaaa89de37dbcc59c5f95f46f3f36?s=128&d=identicon&r=PG", "display_name": "army007", "link": "https://stackoverflow.com/users/1992776/army007"}, "edited": false, "score": 0, "creation_date": 1494853607, "post_id": 43974886, "comment_id": 74989661, "body": "Try changing the function signature in header file with <code>extern &quot;C&quot; HsInt32 foo(const HsPtr a1, HsInt32 a2);</code> manually."}, {"owner": {"reputation": 89, "user_id": 8013098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21d4ba8313bce9d8311b6ada8f1e34a?s=128&d=identicon&r=PG&f=1", "display_name": "sekoenig", "link": "https://stackoverflow.com/users/8013098/sekoenig"}, "reply_to_user": {"reputation": 472, "user_id": 1992776, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/564eaaa89de37dbcc59c5f95f46f3f36?s=128&d=identicon&r=PG", "display_name": "army007", "link": "https://stackoverflow.com/users/1992776/army007"}, "edited": false, "score": 1, "creation_date": 1494855125, "post_id": 43974886, "comment_id": 74990773, "body": "That would give the desired result.  However, since I am generating the header stubs as part of my make infrastructure, I&#39;d rather have a way to specify the annotation directly in the .hs file."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1527587961, "post_id": 43974886, "comment_id": 88172042, "body": "It really is annoying that we can&#39;t have proper const-pointers in FFI declarations. In Haskell! Have you considered filing a feature request on <a href=\"https://ghc.haskell.org/trac/ghc\" rel=\"nofollow noreferrer\">the GHC Trac</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1494892548, "post_id": 43990045, "comment_id": 75009917, "body": "Was <code>v2</code> meant to be <code>pv</code>, or vice versa?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1494893817, "post_id": 43990045, "comment_id": 75010236, "body": "Thanks!  It should be fixed now."}, {"owner": {"reputation": 89, "user_id": 8013098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21d4ba8313bce9d8311b6ada8f1e34a?s=128&d=identicon&r=PG&f=1", "display_name": "sekoenig", "link": "https://stackoverflow.com/users/8013098/sekoenig"}, "edited": false, "score": 1, "creation_date": 1494922551, "post_id": 43990045, "comment_id": 75020395, "body": "Indeed, I dislike the dirty const_cast, but I hid it now in a HaskellPointer() wrapper function. My hope is that perhaps in the future this could be removed -- at least na&#239;vely I&#39;d think that having something like a &quot;ConstPtr a&quot; type might be useful also for optimization purposes.  For now, thanks for digging up that currently there&#39;s no way to add the annotation on the Haskell side!"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1494893799, "last_edit_date": 1494893799, "creation_date": 1494889172, "answer_id": 43990045, "question_id": 43974886, "link": "https://stackoverflow.com/questions/43974886/const-annotation-for-haskell-ffi-exports/43990045#43990045", "title": "const annotation for Haskell FFI exports", "body": "<p>There is no facility in GHC for generating the C helper function with <code>const</code> annotations.  In particular, the relevant code in the GHC source is in <code>compiler/deSugar/DsForeign.hs</code> function <code>mkFExportCBits</code> which generates the C stub.  Each argument is given an unadorned C type consisting of the prefix \"Hs\" and the name of the constructor.  There's no way to add a <code>const</code> in there anywhere.</p>\n\n<p>There's not even a hope of getting GHC to use a user-defined C type, like <code>HsConstPtr</code> that you could use:  the permitted types for foreign arguments are restricted to those determined by the <code>boxedMarshalableTyCon</code> function in <code>compiler/typecheck/TcType.hs</code> (with associated definitions of the C types in <code>includes/HsFFI.h</code>).</p>\n\n<p>On the other hand, it's not clear why you can't just cast away the const in the wrapper you're writing anyway:</p>\n\n<pre><code>inline int foo_wrapper(const std::vector&lt;int&gt; &amp;v)\n{\n  std::vector&lt;int&gt; &amp;v2 = const_cast&lt;std::vector &lt;int&gt;&amp;&gt;(v);\n  return foo_haskell(v2.data(), v2.size());\n}\n</code></pre>\n\n<p>If that makes you feel dirty... well, programming is a dirty business, right?</p>\n"}], "owner": {"reputation": 89, "user_id": 8013098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21d4ba8313bce9d8311b6ada8f1e34a?s=128&d=identicon&r=PG&f=1", "display_name": "sekoenig", "link": "https://stackoverflow.com/users/8013098/sekoenig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1494893799, "creation_date": 1494837630, "question_id": 43974886, "link": "https://stackoverflow.com/questions/43974886/const-annotation-for-haskell-ffi-exports", "title": "const annotation for Haskell FFI exports", "body": "<p>I am exposing a Haskell function to C/C++ as</p>\n\n<pre><code>foreign export ccall foo :: Ptr CInt -&gt; CInt -&gt; IO CInt\n\nfoo ptr len = do\n  list &lt;- peekArray (fromIntegral len) ptr\n  -- run calculation based on list entries\n  return result\n</code></pre>\n\n<p>The signature of the exported function becomes</p>\n\n<pre><code>HsInt32 foo(HsPtr a1, HsInt32 a2);\n</code></pre>\n\n<p>However, since the array is not being modified, I would rather have this as</p>\n\n<pre><code>HsInt32 foo(const HsPtr a1, HsInt32 a2);\n</code></pre>\n\n<p>Is there a way to automatically add this annotation?</p>\n\n<p>(The motivation is that I want this to operate on an std::vector&lt; int > via</p>\n\n<pre><code>inline int foo(const std::vector&lt;int&gt; &amp;v)\n{\n  return foo(v.data(), v.size());\n}\n</code></pre>\n\n<p>without including a const_cast.)</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 12, "last_activity_date": 1494832003, "last_edit_date": 1494832003, "creation_date": 1494831304, "answer_id": 43973172, "question_id": 43972040, "link": "https://stackoverflow.com/questions/43972040/haskell-will-ghc-optimize-this/43973172#43973172", "title": "Haskell : Will GHC optimize this?", "body": "<p>You can ask these questions of ghc by running it with <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/users_guide/debugging.html\" rel=\"noreferrer\"><code>-ddump-simpl</code></a>. This will cause ghc to dump the \"core\" code that it compiles programs into. Core is an intermediate language between the part of the compiler that reasons about Haskell code and the part of the compiler that transforms that code into machine code.</p>\n\n<p>When I compiled the following with <code>-O2 -ddump-simpl</code> the results surprised me.</p>\n\n<pre><code>tupid1 :: (a, b) -&gt; (a, b)\ntupid1 = (\\(a, b) -&gt; (a, b))\n\ntupid2 :: (a, b) -&gt; (a, b)\ntupid2 = (\\(a, b) -&gt; (a, b)) . (\\(a, b) -&gt; (a, b))\n</code></pre>\n\n<p>The resulting core for <code>tupid1</code> makes a new specialized identity function.</p>\n\n<pre><code>-- RHS size: {terms: 4, types: 7, coercions: 0}\ntupid1 :: forall a_aqo b_aqp. (a_aqo, b_aqp) -&gt; (a_aqo, b_aqp)\n[GblId,\n Arity=1,\n Caf=NoCafRefs,\n Str=DmdType &lt;S,1*U(U,U)&gt;m,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=True)\n         Tmpl= \\ (@ a_ayd)\n                 (@ b_aye)\n                 (ds_dIl [Occ=Once] :: (a_ayd, b_aye)) -&gt;\n                 ds_dIl}]\ntupid1 = \\ (@ a_ayd) (@ b_aye) (ds_dIl :: (a_ayd, b_aye)) -&gt; ds_dIl\n</code></pre>\n\n<p>In core the polymorphic type arguments to functions are represented as explicit arguments. <code>tupid1</code> takes two of these type arguments, named <code>a_ayd</code> and <code>b_aye</code>, for the two type variables <code>a</code> and <code>b</code> in its signature. It also takes a term <code>ds_dIl</code> that has the type of a tuple of those two types (<code>ds_dIl :: (a_ayd, b_aye)</code>) and returns it unmodified.</p>\n\n<p>The surprising result is <code>tupid2</code> ...</p>\n\n<pre><code>-- RHS size: {terms: 1, types: 0, coercions: 0}\ntupid2 :: forall a_aqm b_aqn. (a_aqm, b_aqn) -&gt; (a_aqm, b_aqn)\n[GblId,\n Arity=1,\n Caf=NoCafRefs,\n Str=DmdType &lt;S,1*U(U,U)&gt;m,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=True)\n         Tmpl= \\ (@ a_axZ) (@ b_ay0) (x_aIw [Occ=Once] :: (a_axZ, b_ay0)) -&gt;\n                 x_aIw}]\ntupid2 = tupid1\n</code></pre>\n\n<p>... which ghc simplifies to <code>tupid1</code>! How it deduces that is beyond my immediate knowledge or ability to discover.</p>\n\n<hr>\n\n<p>The identity example for <code>Maybe</code></p>\n\n<pre><code>maybeid :: Maybe a -&gt; Maybe a\nmaybeid (Just x) = Just x\nmaybeid Nothing = Nothing\n</code></pre>\n\n<p>Is also simplified to an identity function with no pattern matching</p>\n\n<pre><code>-- RHS size: {terms: 3, types: 4, coercions: 0}\nmaybeid :: forall a_aqn. Maybe a_aqn -&gt; Maybe a_aqn\n[GblId,\n Arity=1,\n Caf=NoCafRefs,\n Str=DmdType &lt;S,1*U&gt;,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=True)\n         Tmpl= \\ (@ a_aqI) (ds_dIq [Occ=Once] :: Maybe a_aqI) -&gt; ds_dIq}]\nmaybeid = \\ (@ a_aqI) (ds_dIq :: Maybe a_aqI) -&gt; ds_dIq\n</code></pre>\n\n<p>The core for <code>map</code> for <code>Maybe</code> isn't interesting for this question</p>\n\n<pre><code>maybemap :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\nmaybemap f (Just x) = Just (f x)\nmaybemap _ Nothing = Nothing\n</code></pre>\n\n<p>But if it's composed with <code>maybeid</code></p>\n\n<pre><code>maybeidmap :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\nmaybeidmap f = maybeid . maybemap f\n</code></pre>\n\n<p>ghc simplifies it to <code>maybemap</code></p>\n\n<pre><code>-- RHS size: {terms: 1, types: 0, coercions: 0}\nmaybeidmap\n  :: forall a_aqp b_aqq.\n     (a_aqp -&gt; b_aqq) -&gt; Maybe a_aqp -&gt; Maybe b_aqq\n[GblId,\n Arity=2,\n Caf=NoCafRefs,\n Str=DmdType &lt;L,1*C1(U)&gt;&lt;S,1*U&gt;,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)\n         Tmpl= maybemap}]\nmaybeidmap = maybemap\n</code></pre>\n\n<p>And it does the same thing if <code>id</code> is composed with <code>f</code>.</p>\n\n<pre><code>maybemapid :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\nmaybemapid f = maybemap (id . f)\n</code></pre>\n\n<p>The composition with the identity function is removed and the whole function simplifies to <code>maybemap</code></p>\n\n<pre><code>-- RHS size: {terms: 1, types: 0, coercions: 0}\nmaybemapid\n  :: forall a_aqq b_aqr.\n     (a_aqq -&gt; b_aqr) -&gt; Maybe a_aqq -&gt; Maybe b_aqr\n[GblId,\n Arity=2,\n Caf=NoCafRefs,\n Str=DmdType &lt;L,1*C1(U)&gt;&lt;S,1*U&gt;,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)\n         Tmpl= \\ (@ a_ar2)\n                 (@ b_ar3)\n                 (f_aqL [Occ=Once!] :: a_ar2 -&gt; b_ar3)\n                 (eta_B1 [Occ=Once!] :: Maybe a_ar2) -&gt;\n                 case eta_B1 of _ [Occ=Dead] {\n                   Nothing -&gt; GHC.Base.Nothing @ b_ar3;\n                   Just x_aqJ [Occ=Once] -&gt; GHC.Base.Just @ b_ar3 (f_aqL x_aqJ)\n                 }}]\nmaybemapid = maybemap\n</code></pre>\n"}], "owner": {"reputation": 1069, "user_id": 5923374, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd4f47d4ba513ba8ed316520a12f94a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ford O.", "link": "https://stackoverflow.com/users/5923374/ford-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 43973172, "answer_count": 1, "score": 4, "last_activity_date": 1494832003, "creation_date": 1494825856, "last_edit_date": 1494827263, "question_id": 43972040, "link": "https://stackoverflow.com/questions/43972040/haskell-will-ghc-optimize-this", "title": "Haskell : Will GHC optimize this?", "body": "<p>Can GHC simplify <code>id = (\\(a, b) -&gt; (a, b)).(\\(a, b) -&gt; (a, b))</code> into <code>id = \\(a, b) -&gt; (a, b)</code>?</p>\n\n<p>What about more complicated case :</p>\n\n<pre><code>id (Just x) = Just x\nid Nothing = Nothing\n\nmap f (Just x) = Just (f x)\nmap _ Nothing  = Nothing\n</code></pre>\n\n<p>Will GHC simplify <code>id . map</code> into <code>map</code>?</p>\n\n<p>I tried to use plain beta reduction but it looks like these terms are irreducible because of the nasty pattern matching.</p>\n\n<p>Therefore I am curious how do GHC's optimization techniques deal with that.</p>\n"}, {"tags": ["haskell", "functional-programming", "function-composition"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1494817918, "post_id": 43971054, "comment_id": 74971967, "body": "You&#39;ve done nothing wrong as a beginner. The dreaded <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">monomorphism restriction</a> didn&#39;t like the type variable <code>a</code> (that you inferred correctly) and filled in the unit type."}, {"owner": {"reputation": 474, "user_id": 4829993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d3b5dfdad633eb7291270e093d5f814?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/4829993/henry"}, "edited": false, "score": 0, "creation_date": 1494818116, "post_id": 43971054, "comment_id": 74972014, "body": "Also a beginner in Haskell, why did it work for me? In GHCi <code>:t myShow</code> returned <code>myShow :: Show a =&gt; a -&gt; IO ()</code>"}, {"owner": {"reputation": 474, "user_id": 4829993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d3b5dfdad633eb7291270e093d5f814?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/4829993/henry"}, "edited": false, "score": 0, "creation_date": 1494818386, "post_id": 43971054, "comment_id": 74972061, "body": "Ah, believe it was because I had previously done <code>:set -XNoMonomorphismRestriction</code>. Although, I would have thought that would reset when I quit GHCi."}, {"owner": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1494818444, "post_id": 43971054, "comment_id": 74972070, "body": "@Bergi thanks for the link"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 474, "user_id": 4829993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d3b5dfdad633eb7291270e093d5f814?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/4829993/henry"}, "edited": false, "score": 3, "creation_date": 1494818653, "post_id": 43971054, "comment_id": 74972109, "body": "@name It might be due you and martin using different versions of GHC -- the monomorphism restriction is turned off by default in GHCi (but not elsewhere) since GHC 7.8.1."}, {"owner": {"reputation": 474, "user_id": 4829993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d3b5dfdad633eb7291270e093d5f814?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/4829993/henry"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494818868, "post_id": 43971054, "comment_id": 74972150, "body": "@duplode Thanks! On version 8.0.1, so that must be it."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1494819536, "post_id": 43971054, "comment_id": 74972270, "body": "By the way <code>putStrLn . show</code> is what <code>print</code> does."}], "owner": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1494818339, "answer_count": 0, "score": 1, "last_activity_date": 1494817722, "creation_date": 1494817722, "question_id": 43971054, "link": "https://stackoverflow.com/questions/43971054/haskell-function-composition-putstrln-show", "closed_reason": "Duplicate", "title": "Haskell function composition -- putStrLn . show", "body": "<p>So I've got two functions that based on their types, I feel like I should be able to combine with function composition.  </p>\n\n<pre><code>ghci&gt; :t show  \nshow :: Show a =&gt; a -&gt; String  \nghci&gt; :t putStrLn  \nputStrLn :: String -&gt; IO ()  \n</code></pre>\n\n<p>An initial attempt was successful,</p>\n\n<pre><code>ghci&gt; ( putStrLn . show ) \"Hello World!\"  \n\"Hello World!\"  \n</code></pre>\n\n<p>I figured I'd try defining a new function as that composition</p>\n\n<pre><code>ghci&gt; let myShow = putStrLn . show  \n</code></pre>\n\n<p>But it didn't work:</p>\n\n<pre><code>ghci&gt; myShow \"Hello World!\"  \n\n&lt;interactive&gt;:28:8:  \n    Couldn't match expected type `()' with actual type `[Char]'  \n    In the first argument of `myShow', namely `\"Hello World!\"'  \n    In the expression: myShow \"Hello World!\"  \n    In an equation for `it': it = myShow \"Hello World!\"  \n</code></pre>\n\n<p>Interestingly, the type of my <code>myShow</code> function became <code>() -&gt; IO ()</code> </p>\n\n<pre><code>ghci&gt; :t myShow   \nmyShow :: () -&gt; IO ()  \n</code></pre>\n\n<p>I had assumed that the type would have been <code>Show a =&gt; a -&gt; IO ()</code> .</p>\n\n<p>Does anyone know why this attempt at function composition failed? </p>\n\n<p>(I realize that this is probably a pretty basic question, but I'm just getting started with the language, so bear with me here)</p>\n"}, {"tags": ["parsing", "haskell", "dependent-type", "dynamic-typing"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1494808930, "post_id": 43969207, "comment_id": 74970223, "body": "&quot;Here I realize I cannot obtain a value of static type Lia IntegralSort. &quot; why not? It seems relatively straightforward to write a parser if the types are fixed. It becomes trickier if the output type depends on the input string, but it is still doable with existentials. <code>Data.Typeable</code> may help for your <code>Equals</code> example."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1494829705, "post_id": 43969207, "comment_id": 74975279, "body": "This is exactly what I am saying... I am interested in types that depend on input values, fixed types are obviously ok."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494851569, "post_id": 43969207, "comment_id": 74988274, "body": "Looking at your language it appears that you&#39;ll need to do some unification. (eg in the expression <code>Select arr ix</code>, if you know the type of <code>arr</code> you can infer the type of <code>ix</code>.) Implementing a unification algorithm and proving it correct in the type system is fun, but maybe a bit too big for a stack overflow answer, especially in clunky old Haskell."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1494851571, "post_id": 43969207, "comment_id": 74988275, "body": "If fixed types are ok, that seems to contradict the fact that you &quot;cannot obtain a value of static type <code>Lia IntegralSort</code>&quot;."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1494851901, "post_id": 43969207, "comment_id": 74988493, "body": "The direct answer to your question is to <a href=\"http://stackoverflow.com/questions/33408943/parsing-and-the-use-of-gadts/33411022#33411022\">use existential quantification in the return type of your type checking function</a>"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1494852497, "post_id": 43969207, "comment_id": 74988872, "body": "@Li-yaoXia poor wording on my side. Point was that I dont hope the code to guarrantee a <b>fixed type</b> simply because the input string <b>value</b> can be anything, i.e. by calling<code>parse :: String -&gt; FixedType</code> I impose the requirement on the return type instead of having that derived based on the actual value."}], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1494852999, "post_id": 43979849, "comment_id": 74989196, "body": "I was probably looking for the <code>Typeable</code> approach, hardwiring the type beats the extensibility of data types a la carte imho, thanks for the pointers."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1494885686, "post_id": 43979849, "comment_id": 75008142, "body": "The more I examine this answer the more I like it. However, I could still use some explanations. Assuming the <code>Typeable</code> approach, how would one parse e.g. <code>(a : (array int bool))</code> for example? I am trying to use <code>attoparsec</code> and can easily parse that string into <code>name :: String</code> and <code>sort :: Sort</code>, I have a hard time figuring how to build a <code>IFix f s</code> to be wrapped into <code>SomeExpr</code> that has the proper sort. As demonstrated, doing the same for <code>IntegralSort</code> and <code>BooleanSort</code> is straightforward."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1494889329, "post_id": 43979849, "comment_id": 75009188, "body": "You can track the sorts you parse at the type level with another GADT. <code>data SomeSort where SomeSort :: forall (s :: Sort). Typeable s =&gt; proxy s -&gt; SomeSort</code>. So when you parse a sort, return a value of type <code>SomeSort</code>."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1494896875, "post_id": 43979849, "comment_id": 75010915, "body": "Could you please be more specific? I have <code>data SortProxy (s :: Sort)</code>, <code>data SomeSort</code>, but when my grammar matches the index sort and the element sort, I have two instances of <code>SomeSort</code> but I seem to run into errors when trying to merge the proxies with <code>SortProxy i -&gt; SortProxy e -&gt; SortProxy (ArraySort i e)</code> since <code>SomeSort</code> quantifies over <code>s</code>. Could you maybe put together an example of code that given two <code>SomeSort</code> produces <code>SomeSort</code> that holds <code>ArraySort</code> of the two given sorts? I would really appreciate it, typeable seems to be too cryptic for me (the doc does not explain much)."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1494920130, "post_id": 43979849, "comment_id": 75018811, "body": "Thanks. Believe it or not, I tried almost exactly the same thing quite early on. What I didn&#39;t know was possible, however, was that you can give type signatures in pattern matches and further did not try using it with <code>ScopedTypeVariables</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1495129946, "post_id": 43979849, "comment_id": 75134370, "body": "@jakubdaniel, my personal experience suggests: 1. If I&#39;m using any other type system extension, I&#39;m almost certain to want <code>ScopedTypeVariables</code> to express what I need. 2. If I&#39;m not using any other type system extension, I&#39;m almost certain to want <code>ScopedTypeVariables</code> so I can write more type signatures to help me fix type errors when I goof up. 3. If I don&#39;t enable <code>ScopedTypeVariables</code>, I&#39;m likely to end up getting confused when I expect an instance head type variable to be in scope where it&#39;s not. So most of the time, I just enable <code>ScopedTypeVariables</code> before I start writing anything."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1494901185, "last_edit_date": 1494901185, "creation_date": 1494852043, "answer_id": 43979849, "question_id": 43969207, "link": "https://stackoverflow.com/questions/43969207/parsing-an-indexed-type/43979849#43979849", "title": "Parsing an Indexed Type", "body": "<pre><code>(.=.) :: EqualityF :&lt;: f =&gt; IFix f s -&gt; IFix f s -&gt; IFix f BoolSort\n(.=.) a b = inject (Equals a b)\n</code></pre>\n\n<p>You can use a GADT to hide the sort, allowing you to return values of sorts depending on the input. Pattern matching then allows you to recover the sort. </p>\n\n<pre><code>data Expr (f :: (Sort -&gt; *) -&gt; (Sort -&gt; *)) where\n  BoolExpr :: IFix f BoolSort -&gt; Expr f\n  IntExpr  :: IFix f IntegralSort -&gt; Expr f\n</code></pre>\n\n<p>Here is a simplistic parser of postfix expressions involving <code>+</code> and <code>=</code>.</p>\n\n<pre><code>parse :: (EqualityF :&lt;: f, ArithmeticF :&lt;: f) =&gt; String -&gt; [Expr f] -&gt; Maybe (Expr f)\n\nparse (c : s) stack | isDigit c =\n  parse s (IntExpr (cnst (digitToInt c)) : stack)\n\nparse ('+' : s) (IntExpr e1 : IntExpr e2 : stack) =\n  parse s (IntExpr (e1 .+. e2) : stack)\n\nparse ('=' : s) (IntExpr e1 : IntExpr e2 : stack) =\n  parse s (BoolExpr (e1 .=. e2) : stack)\n\nparse ('=' : s) (BoolExpr e1 : BoolExpr e2 : stack) =\n  parse s (BoolExpr (e1 .=. e2) : stack)\n\nparse [] [e] = Just e\nparse _ _ = Nothing\n</code></pre>\n\n<p>You might not like the duplicate cases for <code>=</code>. A more general framework is <code>Typeable</code>, allowing you to just test for the type equalities you need.</p>\n\n<pre><code>data SomeExpr (f :: (Sort -&gt; *) -&gt; Sort -&gt; *) where\n  SomeExpr :: Typeable s =&gt; IFix f s -&gt; SomeExpr f\n\n\nparseSome :: forall f. (EqualityF :&lt;: f, ArithmeticF :&lt;: f) =&gt; String -&gt; [SomeExpr f] -&gt; Maybe (Expr f)\n\nparseSome (c : s) stack | isDigit c =\n  parseSome s (SomeExpr (cnst (digitToInt c)) : stack)\n\nparseSome ('+' : s) (SomeExpr e1 : SomeExpr e2 : stack) = do\n  e1 &lt;- gcast e1\n  e2 &lt;- gcast e2\n  parseSome s (SomeExpr (e1 .+. e2) : stack)\n\nparseSome ('=' : s) (SomeExpr (e1 :: IFix f s1) : SomeExpr (e2 :: IFix f s2) : stack) = do\n  Refl &lt;- eqT :: Maybe (s1 :~: s2) \n  parseSome s (SomeExpr (e1 .=. e2) : stack)\n\nparseSome [] [e] = Just e\nparseSome _ _ = Nothing\n</code></pre>\n\n<hr>\n\n<h3>Edit</h3>\n\n<p>To parse sorts, you want to track them at the type level. Again, use an existential type.</p>\n\n<pre><code>data SomeSort where\n  SomeSort :: Typeable (s :: Sort) =&gt; proxy s -&gt; SomeSort\n</code></pre>\n\n<p>You can construct the sort of arrays this way:</p>\n\n<pre><code>-- \\i e -&gt; array i e\narraySort :: SomeSort -&gt; SomeSort -&gt; SomeSort\narraySort (SomeSort (Proxy :: Proxy i)) (SomeSort (Proxy :: Proxy e)) =\n  SomeSort (Proxy :: Proxy (ArraySort i e))\n</code></pre>\n\n<p>A potential problem with <code>Typeable</code> here is that it only allows you to test equality of types, when you may want only to check the head constructor: you can't ask \"is this type an <code>ArraySort</code>?\", but only \"is this type equal to <code>ArraySort IntSort BoolSort</code>?\" or some other full type.\nIn that case you need a GADT that reflects the structure of a sort.</p>\n\n<pre><code>-- \"Singleton type\"\ndata SSort (s :: Sort) where\n  SIntSort :: SSort IntSort\n  SBoolSort :: SSort BoolSort\n  SArraySort :: SSort i -&gt; SSort e -&gt; SSort (ArraySort i e)\n\ndata SomeSort where\n  SomeSort :: SSort s -&gt; SomeSort\n\narray :: SomeSort -&gt; SomeSort -&gt; SomeSort\narray (SomeSort i) (SomeSort e) = SomeSort (SArraySort i e)\n</code></pre>\n\n<p>The <code>singleton</code> package provides various facilities for defining and working with these singleton types, though it may be overkill for your use case.</p>\n"}], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 43979849, "answer_count": 1, "score": 1, "last_activity_date": 1494901185, "creation_date": 1494799211, "last_edit_date": 1494896977, "question_id": 43969207, "link": "https://stackoverflow.com/questions/43969207/parsing-an-indexed-type", "title": "Parsing an Indexed Type", "body": "<p>I just started exploring the possibilities of <a href=\"http://www.cs.ru.nl/~W.Swierstra/Publications/DataTypesALaCarte.pdf\" rel=\"nofollow noreferrer\">data types \u00e0 la carte</a> in combination with indexed types. My current experiment is a bit too large to include here, but can be found <a href=\"https://gist.github.com/jakubdaniel/6b67eb67b3bd7e2c284a5c68074ed7db\" rel=\"nofollow noreferrer\">here</a>. My example is mixing together an expression from different ingredients (arithmetic, functions, ...). The goal is to enforce only well-typed expressions. That is why an index is added to the expressions (the <code>Sort</code> type).</p>\n\n<p>I can build expressions like:</p>\n\n<pre><code>-- define expressions over variables and arithmetic (+, *, numeric constants)\ntype Lia = IFix (VarF :+: ArithmeticF)\n\n-- expression of integer type/sort\nt :: Lia IntegralSort\nt = var \"c\" .+. cnst 1\n</code></pre>\n\n<p>This is all good as long as I construct only fixed (static) expressions.</p>\n\n<p>Is there a way to read an expression from string/other representation (that obviously has to encode the sort) and produce a dynamic value that gets represented by these functors?</p>\n\n<p>For example, I would like to read <code>((c : Int) + (1 : Int))</code> and represent it somehow with <code>VarF</code> and <code>ArithmeticF</code>. Here I realize I cannot obtain a value of static type <code>Lia IntegralSort</code>. But suppose I have in addition:</p>\n\n<pre><code>data EqualityF a where\n    Equals :: forall s. a s -&gt; a s -&gt; EqualityF a BoolSort\n</code></pre>\n\n<p>I could expect there being a function that can read <code>String</code> into <code>Maybe (IFix (EqualityF :+: VarF :+: ...))</code>. Such a function would attempt to build representations for the LHS and RHS and if the sorts matched it could produce a result of statically known type <code>IFix (EqualityF :+: ...) BoolSort</code>. The problem is that the representation of LHS (and RHS) has no fixed static sort. Is what I am trying to do impossible with this representation I chose?</p>\n"}, {"tags": ["html", "haskell", "yesod", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 1892154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e325013114850388a2926f142961957?s=128&d=identicon&r=PG", "display_name": "Jakub", "link": "https://stackoverflow.com/users/1892154/jakub"}, "edited": false, "score": 0, "creation_date": 1501268718, "post_id": 43972578, "comment_id": 77722958, "body": "<code>do {html &lt;- defaultLayout widget; sendByEmail recipient html}</code>"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 2, "last_activity_date": 1494828791, "creation_date": 1494828791, "answer_id": 43972578, "question_id": 43969114, "link": "https://stackoverflow.com/questions/43969114/how-to-render-a-widget-just-a-single-time-independent-of-external-requests/43972578#43972578", "title": "How to render a Widget just a single time, independent of external requests?", "body": "<p>I suspect, you can turn <code>Widget</code> into <code>Handler</code> using <code>defaultLayout</code> or even <code>widgetToPageContent</code> and <code>withUrlRenderer</code> first, and then \"run\" it with this tiny helper:</p>\n\n<pre><code>handler :: Handler a -&gt; IO a\nhandler h = getAppSettings &gt;&gt;= makeFoundation &gt;&gt;= flip unsafeHandler h\n</code></pre>\n\n<p>You can also use <code>handler . runDB</code> to \"run\" DB actions this way.</p>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1494828791, "creation_date": 1494798484, "question_id": 43969114, "link": "https://stackoverflow.com/questions/43969114/how-to-render-a-widget-just-a-single-time-independent-of-external-requests", "title": "How to render a Widget just a single time, independent of external requests?", "body": "<p>Yesod makes it very simple to have web pages (built up from <code>Widget</code>s) rendered to HTML whenever they are requested externally through <code>warp</code>'s port. Why, that is of course precisely where we <em>usually</em> need the HTML.</p>\n\n<p>But what if I also need a copy of that HTML for \u201cinternal purposes\u201d, generated independently of the usual <code>Handler</code> setting? You'd think that <code>Widget</code> is essentially just a reader/writer combination, reading a <code>Yesod</code> and writing a tuple of HTML, CSS and JS results. <a href=\"http://hackage.haskell.org/package/yesod-core-1.4.32/docs/Yesod-Core-Widget.html#t:WidgetT\" rel=\"nofollow noreferrer\">The documentation itself</a> says \u201c...this is simply a <code>WriterT</code>...\u201d. Ok, but...</p>\n\n<pre><code>newtype WidgetT site m a = WidgetT\n    { unWidgetT :: HandlerData site (MonadRoute m) -&gt; m (a, GWData (Route site))\n    }\n</code></pre>\n\n<p>handlerdatasiteroutegwdataroute... ugh.</p>\n\n<p><em>How do I invoke this and get at the result HTML that would normally just be sent straight to the client</em>, without actually embedding the widget in any <code>Handler</code>?</p>\n\n<p>So, I basically want</p>\n\n<pre><code>runWidget :: Widget -&gt; MyYesod -&gt; IO Html\n</code></pre>\n\n<p>i.e.</p>\n\n<pre><code>             WidgetT MyYesod IO () -&gt; MyYesod -&gt; IO Html\n</code></pre>\n\n<p>Am I just missing some function that does this, or is there a problem \u2013 perhaps widgets are actually more powerful than I thought? If so, what would be the correct type to express just <em><code>Writer</code> of HTML and CSS together</em>?</p>\n"}, {"tags": ["haskell", "import"], "answers": [{"comments": [{"owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "edited": false, "score": 0, "creation_date": 1494779605, "post_id": 43966233, "comment_id": 74962599, "body": "Thanks. For some reason, this bit of information is not present on the Haskell Wiki and the other sources I looked at."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 3, "creation_date": 1494780711, "post_id": 43966233, "comment_id": 74962927, "body": "Also, just in case it throws anyone, let me add a disambiguation of some coincidentally-overlapping terminology: a <i>sum type</i> is one with multiple constructors, like <code>data Either a b = Left a | Right b</code>.  As it happens, the type <code>Sum</code> is <i>not</i> a sum type!  (It&#39;s <code>newtype Sum a = Sum { getSum :: a }</code>.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "edited": false, "score": 0, "creation_date": 1494781312, "post_id": 43966233, "comment_id": 74963124, "body": "@Tobia If you want the gory details: <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-1010005.3\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a>"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1494781392, "post_id": 43966233, "comment_id": 74963155, "body": "Antal Spector-Zabusky thanks for the disambiguation, in hindsight I should have probably seen that. I&#39;ll change it to <i>enum/sum type</i>."}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": true, "score": 5, "last_activity_date": 1494781415, "last_edit_date": 1494781415, "creation_date": 1494778977, "answer_id": 43966233, "question_id": 43966183, "link": "https://stackoverflow.com/questions/43966183/haskell-selective-import-only-working-partially/43966233#43966233", "title": "Haskell selective import only working partially", "body": "<p>You need to import the constructor for <code>Sum</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; import Data.Monoid (Sum(..), getSum)\n</code></pre>\n\n<p>This will import all the constructors (in the case of an <em>enum/sum type</em>), if you want to only import one constructor, you can do it like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; import Data.Monoid (Sum(Sum), getSum)\n</code></pre>\n"}], "owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 43966233, "answer_count": 1, "score": 0, "last_activity_date": 1494781415, "creation_date": 1494778643, "question_id": 43966183, "link": "https://stackoverflow.com/questions/43966183/haskell-selective-import-only-working-partially", "title": "Haskell selective import only working partially", "body": "<p>Apparently, this selective import only works partially:</p>\n\n<pre><code>\u03bb&gt; :m\n\u03bb&gt; import Data.Monoid (Sum, getSum)\n\u03bb&gt; :t getSum\ngetSum :: Sum a -&gt; a\n\u03bb&gt; :t Sum\n\n&lt;interactive&gt;:1:1: error:\n    \u2022 Data constructor not in scope: Sum\n    \u2022 Perhaps you meant variable \u2018sum\u2019 (imported from Prelude)\n</code></pre>\n\n<p>But a complete import does work:</p>\n\n<pre><code>\u03bb&gt; import Data.Monoid\n\u03bb&gt; :t Sum\nSum :: a -&gt; Sum a\n</code></pre>\n\n<p>Why can I import getSum but not Sum from Monoid?</p>\n\n<p>I'm using GHCi 8.0.2 installed with Stack.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2044, "user_id": 6733371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a4c02ed1ce17fd1f60579e73384d310?s=128&d=identicon&r=PG&f=1", "display_name": "qfwfq", "link": "https://stackoverflow.com/users/6733371/qfwfq"}, "edited": false, "score": 1, "creation_date": 1494789589, "post_id": 43965079, "comment_id": 74965738, "body": "Is Mac IDE a specific editor?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2044, "user_id": 6733371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a4c02ed1ce17fd1f60579e73384d310?s=128&d=identicon&r=PG&f=1", "display_name": "qfwfq", "link": "https://stackoverflow.com/users/6733371/qfwfq"}, "edited": false, "score": 2, "creation_date": 1494801438, "post_id": 43965079, "comment_id": 74968825, "body": "@jcolemang <a href=\"http://haskellformac.com/\" rel=\"nofollow noreferrer\">Haskell for Mac</a> is."}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1494895363, "post_id": 43990757, "comment_id": 75010573, "body": "Thank you. Given the above project, can I do anything to be able to use Haskell for Mac with my existing project?"}, {"owner": {"reputation": 166, "user_id": 1427628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e498b6d48c58989c740e5559f09a1372?s=128&d=identicon&r=PG", "display_name": "Manuel Chakravarty", "link": "https://stackoverflow.com/users/1427628/manuel-chakravarty"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495008526, "post_id": 43990757, "comment_id": 75065185, "body": "You can rename the directory to add the suffix <code>hsproj</code> and try to open it."}], "tags": [], "owner": {"reputation": 166, "user_id": 1427628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e498b6d48c58989c740e5559f09a1372?s=128&d=identicon&r=PG", "display_name": "Manuel Chakravarty", "link": "https://stackoverflow.com/users/1427628/manuel-chakravarty"}, "is_accepted": false, "score": 2, "last_activity_date": 1494894887, "creation_date": 1494894887, "answer_id": 43990757, "question_id": 43965079, "link": "https://stackoverflow.com/questions/43965079/open-existing-project-with-haskell-for-mac/43990757#43990757", "title": "&quot;Open Existing Project&quot; with Haskell for Mac?", "body": "<p>Haskell for Mac can currently (version 1.4) not import arbitrary existing Haskell projects. More details are in <a href=\"http://community.hfm.io/hc/en-us/articles/115007207807-How-can-I-import-an-existing-project-\" rel=\"nofollow noreferrer\">this knowledge base article</a>.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1494894887, "creation_date": 1494772324, "last_edit_date": 1494847161, "question_id": 43965079, "link": "https://stackoverflow.com/questions/43965079/open-existing-project-with-haskell-for-mac", "title": "&quot;Open Existing Project&quot; with Haskell for Mac?", "body": "<p>Given:</p>\n\n<pre><code>$ls \napp         cabal.config        publickey.txt       stack.yaml      test\nStore_Locations_Files   app-dev.cfg     privatekey.txt      src         \nstatic          myproject.cabal\n</code></pre>\n\n<p>How can I open this project with the <a href=\"http://haskellformac.com/\" rel=\"nofollow noreferrer\">Haskell for Mac IDE</a>?</p>\n\n<p>Similar to IDEA with Java, I can simply point to either a pom.xml or the folder containing it to open a project.</p>\n\n<p>Does this IDE provide it?</p>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1494773730, "post_id": 43964900, "comment_id": 74960517, "body": "Can&#39;t you just make a <code>NewExceptT</code> and <code>NewStateT</code> then give one (and only one) of the two instances <code>instance MonadState m =&gt; NewExceptT e m</code> or <code>instance MonadExcept m =&gt; NewStateT s m</code>?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1494774723, "post_id": 43964900, "comment_id": 74960855, "body": "@Thomas M. DuBuisson Yes; I was only wondering if it could be done in a more general way."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1498685122, "post_id": 43964900, "comment_id": 76606201, "body": "Here&#39;s a possible solution: <a href=\"https://pay.reddit.com/r/haskell/comments/6jk3vy/a_tale_of_two_brackets/djim0le/\" rel=\"nofollow noreferrer\">pay.reddit.com/r/haskell/comments/6jk3vy/a_tale_of_two_brack&zwnj;&#8203;ets/&hellip;</a>"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494771556, "creation_date": 1494771202, "last_edit_date": 1494771556, "question_id": 43964900, "link": "https://stackoverflow.com/questions/43964900/how-to-write-a-mtl-like-framework-that-is-sensitive-to-monad-composition-order", "title": "How to write a mtl-like framework that is sensitive to monad composition order?", "body": "<p><a href=\"http://hackage.haskell.org/package/mtl\" rel=\"nofollow noreferrer\">mtl</a> doesn't care that much about the order of the monads in the monad stack, as long as there is a viable implementation. For example:</p>\n\n<pre><code>foo :: (MonadError () m, MonadState Int m) =&gt; m ()\nfoo = (put 1 &gt;&gt; throwError ()) `catchError` return\n\nmain :: IO ()\nmain = do\n    print $ runExcept $ flip execStateT 0 $ foo -- returns Right 0\n    print $ flip execState 0 $ runExceptT $ foo -- returns 1\n</code></pre>\n\n<p>Suppose I wanted to create a mini-mtl framework (for the sake of simplicity, one which covered only <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html\" rel=\"nofollow noreferrer\"><code>ExceptT</code></a> and <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Strict.html\" rel=\"nofollow noreferrer\"><code>StateT</code></a>) that was sensitive to the order of composition, and let me express things like</p>\n\n<blockquote>\n  <p>this function requires an error effect with priority over the\n  state effect, but I'm letting you choose the exact error and state\n  implementations.</p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>this function requires a state effect with priority over the\n  error effect, but I'm letting you choose the exact error and state\n  implementations.</p>\n</blockquote>\n\n<p>in such a way that only the stacks with the correct order had the required instances.</p>\n\n<p>I don't know how to embed effect priority in the typeclass constraints. Would I need some kind of \"constraint transformer\" of kind <code>Constraint -&gt; Constraint</code>? Perhaps some constraint parameterized by a type-level list of constraints?</p>\n"}, {"tags": ["haskell", "ghci", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "is_accepted": false, "score": 0, "last_activity_date": 1494768282, "creation_date": 1494768282, "answer_id": 43964405, "question_id": 43964292, "link": "https://stackoverflow.com/questions/43964292/project-specific-ghci-init-file-permission-warnings/43964405#43964405", "title": "Project specific ghci init file permission warnings", "body": "<p>Sadly, I now find this is an issue that has been refused a fix:</p>\n\n<p><a href=\"https://ghc.haskell.org/trac/ghc/ticket/8248\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/8248</a></p>\n"}, {"comments": [{"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 0, "creation_date": 1494814899, "post_id": 43965018, "comment_id": 74971337, "body": "While I think that ghc should not dictate to me how I manage the security of my personal system, I now understand that ghci can run arbitrary shell commands with the &#39;!&#39; command, and these could be injected into a session unknowingly if a local .ghci is included with an external downloaded package. So the design decision is trying to avoid that risk. I agree that setting a more restrictive umask is the answer, but one tends not to do this automatically on a single user workstation."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1494771955, "creation_date": 1494771955, "answer_id": 43965018, "question_id": 43964292, "link": "https://stackoverflow.com/questions/43964292/project-specific-ghci-init-file-permission-warnings/43965018#43965018", "title": "Project specific ghci init file permission warnings", "body": "<blockquote>\n  <p>Why does adding a .ghci file cause this behaviour, and what is it exactly that ghci is worried about? Without a local directory .ghci file ghci does not protest about permissions.</p>\n</blockquote>\n\n<p>I guess that your <code>umask</code> is set so that all the newly created files, by default, are group writable. This allows any user in your system to write to it. Some GHCi commands allow to run any command at all. Hence, anyone who can write to your <code>.ghci</code> file will be able to essentially hijack your account as soon as you launch GHCi.</p>\n\n<p>GHCi tries to prevent this attack by refusing to interpret a file which is writable by others. Whether this should be the case is arguable. </p>\n\n<p>On one hand, changing the permissions is easy, and has to be done only once unless you regenerate your <code>.ghci</code>. Even if you regenerate it automatically, you can use a script which can do the <code>chmod</code> for you. Or, probably better, set your <code>umask</code> more strictly so that new files get strict permissions (I think you should use <code>umask 002</code>) -- this needs to be run once for every shell, only, or can be put in the shell init files.</p>\n\n<p>On the other hand, GHCi is being a bit cautious here, unlike most of unix which uses (used?) to give you all the rope you need to hang yourself, as the saying goes. Perhaps a flag <code>ghci --ignore-config-permissions</code> would be useful.</p>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494771955, "creation_date": 1494767544, "last_edit_date": 1494770226, "question_id": 43964292, "link": "https://stackoverflow.com/questions/43964292/project-specific-ghci-init-file-permission-warnings", "title": "Project specific ghci init file permission warnings", "body": "<p>With ghc 8.0.2 if I create a .ghci file mode 644 in my project directory on starting ghci this warning is issued:</p>\n\n<pre><code>*** WARNING: .ghci is writable by someone else, IGNORING!\nSuggested fix: execute 'chmod go-w .ghci'\n</code></pre>\n\n<p>On adopting this suggestion, when starting ghci we then get:</p>\n\n<pre><code>*** WARNING: . is writable by someone else, IGNORING!\nSuggested fix: execute 'chmod go-w .'\n</code></pre>\n\n<p>Adopting this suggestion makes the warnings go away. That's well and good, but this is tedious and annoying, especially since using stack the directory permissions created by default are not what ghci appears to want.</p>\n\n<p>Why does adding a .ghci file cause this behaviour, and what is it exactly that ghci is worried about? Without a local directory .ghci file ghci does not protest about permissions.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 20980, "user_id": 241990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/265f1d52e6e484c9abe60b4da20fb8ee?s=128&d=identicon&r=PG", "display_name": "Shaun the Sheep", "link": "https://stackoverflow.com/users/241990/shaun-the-sheep"}, "edited": false, "score": 2, "creation_date": 1494780951, "post_id": 43960597, "comment_id": 74963011, "body": "Why all the close/down votes? This is definitely not &quot;too broad&quot; and it&#39;s pretty clear what&#39;s being asked."}], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 7, "last_activity_date": 1494739139, "creation_date": 1494739139, "answer_id": 43960640, "question_id": 43960597, "link": "https://stackoverflow.com/questions/43960597/how-do-i-convert-a-string-to-a-list-of-maybe-int/43960640#43960640", "title": "How do I convert a string to a list of Maybe Int", "body": "<p>You can use <code>isDigit</code> to test whether <code>digitToInt</code> will succeed.</p>\n\n<pre><code>\u03bb&gt; fmap (\\c -&gt; if isDigit c then Just (digitToInt c) else Nothing) \"13.2..2\" :: [Maybe Int]\n[Just 1, Just 3, Nothing, Just 2, Nothing, Nothing, Just 2]\n</code></pre>\n\n<p>We can introduce a new function to clean this up a bit:</p>\n\n<pre><code>digitToIntMay :: Char -&gt; Maybe Int\ndigitToIntMay c = if isDigit c then Just (digitToInt c) else Nothing\n\n\u03bb&gt; fmap digitToIntMay \"13.2..2\" :: [Maybe Int]\n[Just 1, Just 3, Nothing, Just 2, Nothing, Nothing, Just 2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1494778044, "post_id": 43965884, "comment_id": 74962094, "body": "two answers ?!? why not the two merged into one ?"}, {"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1494778448, "post_id": 43965884, "comment_id": 74962220, "body": "@StephaneRolland Because they&#39;re different: they use different code, language features and have different pros/cons. For example, this one can throw exceptions, which the OP/voters might not find desirable. From what I can tell, multiple answers <i>is</i> acceptable <a href=\"https://meta.stackexchange.com/questions/25209/what-is-the-official-etiquette-on-answering-a-question-twice\" title=\"what is the official etiquette on answering a question twice\">meta.stackexchange.com/questions/25209/&hellip;</a>."}], "tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 1, "last_activity_date": 1494776843, "creation_date": 1494776843, "answer_id": 43965884, "question_id": 43960597, "link": "https://stackoverflow.com/questions/43960597/how-do-i-convert-a-string-to-a-list-of-maybe-int/43965884#43965884", "title": "How do I convert a string to a list of Maybe Int", "body": "<p>If you're certain the data coming is definitely a digit or <code>.</code> (or are happy with exceptions being thrown if the data is different), you can use pattern matching and <code>fmap</code></p>\n\n<pre><code>import Data.Char\n\nchatToMaybeInt :: Char -&gt; Maybe Int\nchatToMaybeInt '.' = Nothing\nchatToMaybeInt  x  = Just $ digitToInt x\n\nmain = putStrLn $ show $ fmap chatToMaybeInt \"13.2..2\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "edited": false, "score": 0, "creation_date": 1541072973, "post_id": 43965960, "comment_id": 93096849, "body": "Why would you use <code>fmap</code>? I&#39;m getting the same result using <code>map</code>."}], "tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": true, "score": 5, "last_activity_date": 1494777251, "creation_date": 1494777251, "answer_id": 43965960, "question_id": 43960597, "link": "https://stackoverflow.com/questions/43960597/how-do-i-convert-a-string-to-a-list-of-maybe-int/43965960#43965960", "title": "How do I convert a string to a list of Maybe Int", "body": "<p>If you would like all non digits to be converted to <code>Nothing</code>, you can use guards and <code>fmap</code></p>\n\n<pre><code>import Data.Char\n\ncharToMaybeInt :: Char -&gt; Maybe Int\ncharToMaybeInt  x \n | isDigit x = Just $ digitToInt x\n | otherwise = Nothing\n\nmain = putStrLn $ show $ fmap charToMaybeInt \"13.2..2\"\n</code></pre>\n\n<p>Using guards is, from my non-expert understanding, a bit more idiomatic than using <code>if</code>/<code>else</code>.</p>\n"}], "owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1470, "favorite_count": 0, "accepted_answer_id": 43965960, "answer_count": 3, "score": 3, "last_activity_date": 1494777251, "creation_date": 1494738601, "question_id": 43960597, "link": "https://stackoverflow.com/questions/43960597/how-do-i-convert-a-string-to-a-list-of-maybe-int", "title": "How do I convert a string to a list of Maybe Int", "body": "<p>How would I go about converting a string like this <code>\"13.2..2\"</code> to a list like this </p>\n\n<p><code>[Just 1, Just 3, Nothing, Just 2, Nothing, Nothing, Just 2]</code></p>\n\n<p>I have had a look at <code>digitToInt</code> but it does not take care of <code>Maybe Int</code>. Is there a way I could maybe modify <code>digitToInt</code> to handle <code>Maybe Int</code>? </p>\n"}, {"tags": ["haskell", "parallel-processing"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494728263, "post_id": 43959754, "comment_id": 74950420, "body": "You&#39;re just summing numbers. That&#39;s probably far too trivial to see any difference."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1494730300, "post_id": 43959754, "comment_id": 74950690, "body": "Try adding the <code>-threaded</code> flag to GHC, such that it actually uses the RTS that can use multiple system threads."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494746810, "post_id": 43959754, "comment_id": 74953298, "body": "@Carcigenicate Apparently it&#39;s non-trivial enough to take 30 seconds single-threaded. Seems reasonable to suppose you could halve that with two threads."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1494748776, "post_id": 43959754, "comment_id": 74953757, "body": "Please show the output of <code>.&#47;par +RTS -s -N</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 4, "last_activity_date": 1494756778, "last_edit_date": 1494756778, "creation_date": 1494755983, "answer_id": 43962620, "question_id": 43959754, "link": "https://stackoverflow.com/questions/43959754/par-having-no-effect/43962620#43962620", "title": "par having no effect", "body": "<p>IIUC, the combination of the comments by @Carl and @Zeta address this:</p>\n\n<pre><code> $ ghc -threaded -O2 par.hs &amp;&amp; time ./par \n 50000005000000\n\n real    0m2.303s\n user    0m2.124s\n sys     0m0.176s\n\n$ ghc par.hs &amp;&amp; ./par +RTS -N2\nLinking par ...\npar: the flag -N2 requires the program to be built with -threaded\npar:\npar: Usage: &lt;prog&gt; &lt;args&gt; [+RTS &lt;rtsopts&gt; | -RTS &lt;args&gt;] ... --RTS &lt;args&gt;\npar:\npar:    +RTS    Indicates run time system options follow\npar:    -RTS    Indicates program arguments follow\npar:   --RTS    Indicates that ALL subsequent arguments will be given to the\npar:            program (including any of these RTS flags)\n\n $ ghc -threaded -O2 par.hs &amp;&amp; time ./par +RTS -N2\n 50000005000000\n\n real    0m1.572s\n user    0m2.816s\n sys     0m0.296s\n</code></pre>\n\n<p>To see why, here are some excerpts from <a href=\"http://book.realworldhaskell.org/read/concurrent-and-multicore-programming.html#concurrent.strategies\" rel=\"nofollow noreferrer\">Real World Haskell</a></p>\n\n<blockquote>\n  <p>By default, GHC generates programs that use just one core, even when we write explicitly concurrent code. To use multiple cores, we must explicitly choose to do so. We make this choice at link time, when we are generating an executable program. ... If we pass the <code>-threaded</code> option to the compiler, it will link our program against the threaded runtime library.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>We can pass options to GHC's runtime system on the command line of our program. Before handing control to our code, the runtime scans the program's arguments for the special command line option +RTS. ... The threaded runtime accepts an option -N. This takes one argument, which specifies the number of cores that GHC's runtime system should use.</p>\n</blockquote>\n"}], "owner": {"reputation": 355, "user_id": 4348117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a88d7b140a8c1fec328e9d7ea4c0d0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Anastos", "link": "https://stackoverflow.com/users/4348117/mark-anastos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1494756778, "creation_date": 1494727947, "question_id": 43959754, "link": "https://stackoverflow.com/questions/43959754/par-having-no-effect", "title": "par having no effect", "body": "<p>I am having trouble getting parallel computation done in Haskell. I just tried a very simple computation in parallel and non-parallel forms, and the non-parallel one was a few seconds faster. Am I doing something wrong? Any ideas why this is the case? Thanks in advance.</p>\n\n<hr>\n\n<p>This is the parallel version of my test code:</p>\n\n<pre><code>-- par.hs\nimport Control.Parallel\na = sum [1, 3 ..  99999999]\nb = sum [2, 4 .. 100000000]\nmain = (a `par` b) `pseq` print (a + b)\n</code></pre>\n\n<p>and this is the non-parallel version:</p>\n\n<pre><code>-- nopar.hs\na = sum [1, 3 ..  99999999]\nb = sum [2, 4 .. 100000000]\nmain = print (a + b)\n</code></pre>\n\n<p>but when I tried it, parallelization had no, or even negative, effects:</p>\n\n<pre><code>\u279c  ghc par.hs\n[1 of 1] Compiling Main             ( par.hs, par.o )\nLinking par ...\n\u279c  ghc nopar.hs \n[1 of 1] Compiling Main             ( nopar.hs, nopar.o )\nLinking nopar ...\n\u279c  time ./par \n5000000050000000\n./par  35.02s user 12.83s system 92% cpu 51.501 total\n\u279c  time ./nopar \n5000000050000000\n./nopar  31.33s user 6.44s system 98% cpu 38.441 total \n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 2048514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/caf92a0dba8d5fbbb420ae01fcf14f25?s=128&d=identicon&r=PG", "display_name": "donnerluetjen", "link": "https://stackoverflow.com/users/2048514/donnerluetjen"}, "edited": false, "score": 0, "creation_date": 1494741507, "post_id": 43959074, "comment_id": 74952303, "body": "That works. Thank you. So if I declare it like this, then elements` sees only the list and not the deck anymore?"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 25, "user_id": 2048514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/caf92a0dba8d5fbbb420ae01fcf14f25?s=128&d=identicon&r=PG", "display_name": "donnerluetjen", "link": "https://stackoverflow.com/users/2048514/donnerluetjen"}, "edited": false, "score": 0, "creation_date": 1494755363, "post_id": 43959074, "comment_id": 74955379, "body": "When you write down <code>Deck = Deck [Objekt]</code> you are telling Haskell to create a <b>new</b> data type, whose elements are built using the <code>Deck:: [Object] -&gt; Deck</code> constructor function. If you meant to use deck as a synonym for [Object], then you should use <code>type Deck = [Object]</code>. Take a look at <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 2, "last_activity_date": 1494720103, "last_edit_date": 1494720103, "creation_date": 1494719562, "answer_id": 43959074, "question_id": 43959002, "link": "https://stackoverflow.com/questions/43959002/haskell-accessing-elements-of-a-custom-list-type/43959074#43959074", "title": "Haskell: Accessing Elements of a Custom List Type", "body": "<p>The problem is that the list of cards is inside the Deck constructor. You should use pattern matching to extract the list.</p>\n\n<p>You can define:</p>\n\n<pre><code>inDeck :: Objekt -&gt; Deck -&gt; Bool\ninDeck card (Deck cards) = card  `elem` cards\n</code></pre>\n\n<p>Then, you can ask:</p>\n\n<pre><code>inDeck (Objekt Hearts Seven) deck\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1494750103, "creation_date": 1494750103, "answer_id": 43961838, "question_id": 43959002, "link": "https://stackoverflow.com/questions/43959002/haskell-accessing-elements-of-a-custom-list-type/43961838#43961838", "title": "Haskell: Accessing Elements of a Custom List Type", "body": "<p><code>Deck</code> is a type which is different from a list type, yet it contains precisely a list. </p>\n\n<p>You can convert a list into a <code>Deck</code> with the value constructor:</p>\n\n<pre><code>Deck :: [Objekt] -&gt; Deck\n</code></pre>\n\n<p>This is what you have used in e.g. <code>let deck = Deck [....]</code>.</p>\n\n<p>You can convert a <code>Deck</code> back into a list with a small helper function which you can add to your file:</p>\n\n<pre><code>unDeck :: Deck -&gt; [Objekt]\nunDeck (Deck os) = os\n</code></pre>\n\n<p>After this, you can use <code>elem someObjekt (unDeck someDeck)</code>.</p>\n\n<p>Another option is using pattern matching, as Nykros pointed out. If you are learning Haskell, I'd recommend you get used to pattern matching, since it's very idiomatic in Haskell.</p>\n"}], "owner": {"reputation": 25, "user_id": 2048514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/caf92a0dba8d5fbbb420ae01fcf14f25?s=128&d=identicon&r=PG", "display_name": "donnerluetjen", "link": "https://stackoverflow.com/users/2048514/donnerluetjen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "accepted_answer_id": 43961838, "answer_count": 2, "score": 1, "last_activity_date": 1494750103, "creation_date": 1494718757, "question_id": 43959002, "link": "https://stackoverflow.com/questions/43959002/haskell-accessing-elements-of-a-custom-list-type", "title": "Haskell: Accessing Elements of a Custom List Type", "body": "<p>I am new to Haskell and I have a problem with accessing the elements of my custom type.</p>\n\n<p>I have these declarations:</p>\n\n<pre><code>import Data.Char\nimport Data.List\n\ndata Objekt = Objekt Suit Value\n  deriving(Eq,Show)\ndata Suit = Hearts | Spades | Diamonds | Clubs\n  deriving(Eq,Show)\ndata Value = Seven | Eight | Nine | Ten | Jack | Queen | King | Ace\n  deriving(Eq,Show)\n\ndata Deck = Deck [Objekt]\n  deriving(Eq,Show)\n</code></pre>\n\n<p>Now, I'm creating a deck like so:</p>\n\n<p><code>let deck = Deck [Objekt Hearts Seven, Objekt Clubs Queen]</code></p>\n\n<p>and then I want to examine the deck:</p>\n\n<p><code>elem (Objekt Hearts Seven) deck</code></p>\n\n<p>and I get an error:</p>\n\n<pre><code>*Main&gt; elem (Objekt Hearts Seven) deck\n\n&lt;interactive&gt;:8:28: error:\n    \u2022 Couldn't match expected type \u2018[Objekt]\u2019 with actual type \u2018Deck\u2019\n    \u2022 In the second argument of \u2018elem\u2019, namely \u2018deck\u2019\n      In the expression: elem (Objekt Hearts Seven) deck\n      In an equation for \u2018it\u2019: it = elem (Objekt Hearts Seven) deck\n</code></pre>\n\n<p>The Deck shows the following:</p>\n\n<pre><code>*Main&gt; deck\nDeck [Objekt Hearts Seven,Objekt Clubs Queen]\n*Main&gt; :t Deck\nDeck :: [Objekt] -&gt; Deck\n</code></pre>\n\n<p>No matter what I do (I tried using map or list comprehensions), I can't access the elements of the deck.\nI googled all day but I can't seem to find any example of custom list type and its accessing.</p>\n\n<p>Am I doing the declaration correctly?</p>\n\n<p>How can I test or extract the elements of my deck?</p>\n\n<p>Anyone have an idea?\nAny help would be appreciated...\nThank you</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1494714889, "post_id": 43958571, "comment_id": 74948182, "body": "Hint: don&#39;t use if/then/else at all.  Pattern matching is all you need."}, {"owner": {"reputation": 103, "user_id": 5946541, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hvLz9.jpg?s=128&g=1", "display_name": "R.Sama", "link": "https://stackoverflow.com/users/5946541/r-sama"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494715192, "post_id": 43958571, "comment_id": 74948268, "body": "@Carl Hmmm so, altHead [] = x //// altHead [a] = [a] ?"}, {"owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 1, "creation_date": 1494715205, "post_id": 43958571, "comment_id": 74948274, "body": "<code>(x:xs)</code> doesn&#39;t bind two arguments, it binds the head and tail of a <i>single</i> argument that must be a list."}, {"owner": {"reputation": 103, "user_id": 5946541, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hvLz9.jpg?s=128&g=1", "display_name": "R.Sama", "link": "https://stackoverflow.com/users/5946541/r-sama"}, "reply_to_user": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 0, "creation_date": 1494715493, "post_id": 43958571, "comment_id": 74948350, "body": "@Wyzard Aye, this is the conclusion I came to as well. Just wasn&#39;t sure how to include the first var in there too..."}, {"owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 0, "creation_date": 1494715545, "post_id": 43958571, "comment_id": 74948371, "body": "<code>altHead a (x:xs) =</code>"}, {"owner": {"reputation": 103, "user_id": 5946541, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hvLz9.jpg?s=128&g=1", "display_name": "R.Sama", "link": "https://stackoverflow.com/users/5946541/r-sama"}, "reply_to_user": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 0, "creation_date": 1494715683, "post_id": 43958571, "comment_id": 74948406, "body": "@Wyzard ok, let me try this and see if it works!"}], "answers": [{"comments": [{"owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 0, "creation_date": 1494715876, "post_id": 43958680, "comment_id": 74948441, "body": "The last line of the second example can also be written <code>altHead _ (x:_) = x</code>, since neither <code>a</code> nor <code>xs</code> are actually used."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "reply_to_user": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 0, "creation_date": 1494716048, "post_id": 43958680, "comment_id": 74948468, "body": "Yes, I just thought it helped readability/understanding to leave them as variable names.  (It also shows the <code>(x:xs)</code> pattern that the OP used.)"}, {"owner": {"reputation": 103, "user_id": 5946541, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hvLz9.jpg?s=128&g=1", "display_name": "R.Sama", "link": "https://stackoverflow.com/users/5946541/r-sama"}, "edited": false, "score": 1, "creation_date": 1494716081, "post_id": 43958680, "comment_id": 74948479, "body": "I think I now understand something I had fundamentally MISunderstood previously. Thanks for this, saw it just as I had finished my version, and it was a little bit off, but otherwise ok. Quick Q: I realise this isn&#39;t how typing would work normally, but is it possible for it to return the entire LIST if it&#39;s not empty, but otherwise only return x?"}, {"owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "edited": false, "score": 2, "creation_date": 1494716342, "post_id": 43958680, "comment_id": 74948532, "body": "You can&#39;t have a function that sometimes returns a list and sometimes returns a single value, because those are different types.  But you could change the signature to <code>a -&gt; [a] -&gt; [a]</code> and return <code>[a]</code> when the list is empty."}, {"owner": {"reputation": 103, "user_id": 5946541, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hvLz9.jpg?s=128&g=1", "display_name": "R.Sama", "link": "https://stackoverflow.com/users/5946541/r-sama"}, "edited": false, "score": 0, "creation_date": 1494716590, "post_id": 43958680, "comment_id": 74948578, "body": "Thank you, this is what I needed. Gonna learn me some more Haskell, cheers guys!"}, {"owner": {"reputation": 24660, "user_id": 225647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G7HMF.png?s=128&g=1", "display_name": "kiamlaluno", "link": "https://stackoverflow.com/users/225647/kiamlaluno"}, "edited": false, "score": 0, "creation_date": 1494865828, "post_id": 43958680, "comment_id": 74998239, "body": "Doesn&#39;t <code>altHead a (x:xs) = x</code> return <code>x</code> even when <code>xs</code> is not <code>null</code>?"}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "reply_to_user": {"reputation": 24660, "user_id": 225647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G7HMF.png?s=128&g=1", "display_name": "kiamlaluno", "link": "https://stackoverflow.com/users/225647/kiamlaluno"}, "edited": false, "score": 0, "creation_date": 1494881632, "post_id": 43958680, "comment_id": 75006439, "body": "@kiamlaluno Yes, however, the input list is not <code>null</code>, because it&#39;s not just <code>xs</code>, but <code>(x:xs)</code>.  If <code>xs == []</code> (the definition of <code>null</code>), then it would be <code>x:[] == [x]</code>.  When the input list is <code>null</code>, that&#39;s taken care of by the line <code>altHead a [] = a</code>."}], "tags": [], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "is_accepted": true, "score": 3, "last_activity_date": 1494715670, "creation_date": 1494715670, "answer_id": 43958680, "question_id": 43958571, "link": "https://stackoverflow.com/questions/43958571/passing-two-arguments-of-differing-types/43958680#43958680", "title": "Passing two arguments of differing types", "body": "<p>You want something like:</p>\n\n<pre><code>altHead :: a -&gt; [a] -&gt; a\naltHead a xs = if null xs then a else head xs\n</code></pre>\n\n<p>Or alternatively, using pattern matching on the list:</p>\n\n<pre><code>altHead :: a -&gt; [a] -&gt; a\naltHead a [] = a\naltHead a (x:xs) = x\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5946541, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hvLz9.jpg?s=128&g=1", "display_name": "R.Sama", "link": "https://stackoverflow.com/users/5946541/r-sama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 43958680, "answer_count": 1, "score": 0, "last_activity_date": 1494865652, "creation_date": 1494714650, "last_edit_date": 1494865652, "question_id": 43958571, "link": "https://stackoverflow.com/questions/43958571/passing-two-arguments-of-differing-types", "title": "Passing two arguments of differing types", "body": "<p>I want to create a function, let's call it altHead, that takes 2 variables and outputs a variable such that:</p>\n\n<pre><code>a -&gt; [a] -&gt; a\n</code></pre>\n\n<p>I want to call it like this:</p>\n\n<pre><code>altHead 3 [1,2,3,4]\n</code></pre>\n\n<p>What it should do is to look at the first variable, and the list. If the list is empty, then return the first var's value; otherwise, return the list.</p>\n\n<p>In this case, I've written the following code.</p>\n\n<pre><code>altHead :: a -&gt; [a] -&gt; a\naltHead (x:xs) = if null[xs] then [x] else [xs]\n</code></pre>\n\n<p>However, I believe x:xs only looks through the list.</p>\n\n<p>I'm a bit stuck as to how to change this so that it looks at the first value as well, and how to include the first value in the function.</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494712335, "post_id": 43958239, "comment_id": 74947588, "body": "By <code>(a b)</code> did you mean to write <code>(a,b)</code> or <code>a b</code>? Because <code>(a b)</code> defines a single parameter where <code>b</code> is a type parameter of <code>a</code>"}, {"owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494712474, "post_id": 43958239, "comment_id": 74947620, "body": "I wanted to define two parameters"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494712552, "post_id": 43958239, "comment_id": 74947638, "body": "Requiring two parameters seems unnecessary. You could just define a tree that takes one parameter, where the value is a tuple of two values."}, {"owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494712646, "post_id": 43958239, "comment_id": 74947673, "body": "Can you write down here an example? please"}], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494712310, "post_id": 43958280, "comment_id": 74947580, "body": "I thought that you wanted to calculate the distance, so I thought if you add it there, each time you add a node (if you create the function) you can auto calculate the distance, and when you want it, just get the value"}, {"owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 1, "creation_date": 1494712422, "post_id": 43958280, "comment_id": 74947609, "body": "Yes, I just wondered, why exactly in right subtree, but now it makes much more sense :]"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494712571, "post_id": 43958280, "comment_id": 74947656, "body": "Yes of course, I&#39;m glad to helped you, your question was interesting. can I know why are you using that data structure for?"}, {"owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494712839, "post_id": 43958280, "comment_id": 74947725, "body": "Yes, I am trying to write a program, which accepts as input a tree and program has to output a sorted list by distances from leaves."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494712916, "post_id": 43958280, "comment_id": 74947739, "body": "Cool, I think you are in the right way, the b parameter what&#39;s for?"}, {"owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494712919, "post_id": 43958280, "comment_id": 74947740, "body": "First program accept a tree. Then convert it to tree with values and distances and then I put it in to the list"}, {"owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494713190, "post_id": 43958280, "comment_id": 74947828, "body": "Well, I thought that b parameter would be for a distance. But your solution pass the distance to Int. So I will a little bit modify your solution"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "edited": false, "score": 0, "creation_date": 1494713425, "post_id": 43958280, "comment_id": 74947887, "body": "When you finish edit my answer so it will maybe help others! Thank you"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1494714005, "post_id": 43958280, "comment_id": 74948008, "body": "@DamianLattenero Generally people aren&#39;t aloud to make substantial edits to other peoples&#39; posts which put words in others&#39; mouth. Edits can change the format and wording of posts, but not the meaning. If you want your post to be a community effort and not your own, you should make your post a community wiki. Otherwise people should write their own answers if they want to make a meaningful addition."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494750098, "post_id": 43958280, "comment_id": 74954089, "body": "@chi yes! you are totally right! my wrong! Thank you so much"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 1, "last_activity_date": 1494860566, "last_edit_date": 1494860566, "creation_date": 1494711846, "answer_id": 43958280, "question_id": 43958239, "link": "https://stackoverflow.com/questions/43958239/haskell-tree-with-two-variables-in-each-node/43958280#43958280", "title": "Haskell - tree with two variables in each node", "body": "<p>I don't think so. Think at the Nil tree as a way to say \"stop here, there is no more leaves\", so there is no need to add data there, you can only say:</p>\n\n<pre><code>data Tree2 a b = Nil | T (Tree2 a Int) a Int (Tree2 a Int)\n</code></pre>\n\n<p>And calculates the distance in the right side each time a node is created.</p>\n\n<pre><code>getDistance :: Tree2 a Int -&gt; Int\ngetDistance Nil              = 0\ngetDistance (T _ _ n _) = n  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1494752384, "post_id": 43958288, "comment_id": 74954625, "body": "Actually, I think that probably <i>would</i> work. <code>a</code> would have to be instantiated to a type of kind <code>* -&gt; *</code>, which could be various useful things like <code>(,) Int</code>, Identity, <code>Maybe</code>, etc."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1494752861, "post_id": 43958288, "comment_id": 74954746, "body": "Are you sure for the tuple (,), is it not of kind * -&gt; * -&gt; * ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1494770894, "post_id": 43958288, "comment_id": 74959627, "body": "It is, but I wrote it partially applied to <code>Int</code>."}], "tags": [], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "is_accepted": false, "score": 0, "last_activity_date": 1504607276, "last_edit_date": 1504607276, "creation_date": 1494711913, "answer_id": 43958288, "question_id": 43958239, "link": "https://stackoverflow.com/questions/43958239/haskell-tree-with-two-variables-in-each-node/43958288#43958288", "title": "Haskell - tree with two variables in each node", "body": "<p>To make it compile blindly I would write it this way:</p>\n\n<pre><code>data Tree2 a b = Nil | T (Tree2 a b) (Tree2 a b)\n</code></pre>\n\n<p>this one :</p>\n\n<pre><code>Nil 0\n</code></pre>\n\n<p>does not make sense for me.</p>\n\n<p>so I would re-write it this way:</p>\n\n<pre><code>data Tree2 a = Nil | T a (Tree2 a) (Tree2 a)\n</code></pre>\n\n<p>If you really want to store two types a and b in your node: it becomes</p>\n\n<pre><code>data Tree2 a b = Nil | T a b (Tree2 a b) (Tree2 a b)\n</code></pre>\n\n<p>But your notation</p>\n\n<pre><code>(a b)\n</code></pre>\n\n<p>may not mean what you thought it mean. As the comment below remarks, in <code>(a b)</code> the <code>a</code> would be understood as a kind * -> * ( you can understand this like a type which expects another type.</p>\n\n<p>Give <code>a</code> being <code>[]</code> , and <code>b</code> being <code>Int</code>, <code>(a b)</code> would be understood as <code>[Int]</code>. Given <code>a</code> being <code>Maybe</code>, and <code>b</code> being <code>String</code>, <code>(a b)</code> would be understodd as <code>Maybe String</code>.\nAnd that would be the node value stored in your tree structure.  </p>\n"}, {"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": false, "score": 6, "last_activity_date": 1494713391, "last_edit_date": 1494713391, "creation_date": 1494712942, "answer_id": 43958388, "question_id": 43958239, "link": "https://stackoverflow.com/questions/43958239/haskell-tree-with-two-variables-in-each-node/43958388#43958388", "title": "Haskell - tree with two variables in each node", "body": "<p>Defining a tree that contains two values at each node is unnecessary, because you could just use a tree that contains one value at each node, but it consists of a tuple of two values.</p>\n\n<p>For example:</p>\n\n<pre><code>data Tree a = Nil | Node (Tree a) a (Tree a) deriving (Eq, Ord, Show, Read)\n\ntype Tree2 a b = Tree (a,b)\n</code></pre>\n\n<p>Now you've got a <code>Tree2</code> that possesses all of the characteristics of <code>Tree</code>, but requires 2 type parameters.</p>\n\n<p>An example of a function using it would be:</p>\n\n<pre><code>getDistance :: (Num b) =&gt; Tree2 a b -&gt; b\ngetDistance Nil              = 0\ngetDistance (Node _ (_,x) _) = x\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7418108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaf391443ff1ed669c14e044f53ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Muffy", "link": "https://stackoverflow.com/users/7418108/muffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 43958280, "answer_count": 3, "score": 2, "last_activity_date": 1504607276, "creation_date": 1494711552, "question_id": 43958239, "link": "https://stackoverflow.com/questions/43958239/haskell-tree-with-two-variables-in-each-node", "title": "Haskell - tree with two variables in each node", "body": "<p>I'm trying to define a tree, which has two values in each node. One represents value of the node and second means distance from a leaf.</p>\n\n<pre><code>data Tree2 a b = Nil 0  | T (Tree2 a b) (a b) (Tree2 a b) deriving (Eq,Ord,Show,Read)\n</code></pre>\n\n<p>Is the definition correct? Does \"Nil 0\" make sense? I am trying to say that, if the value isn't in a tree than the distance is 0.</p>\n"}, {"tags": ["haskell", "purescript"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1494710182, "post_id": 43957887, "comment_id": 74946985, "body": "Good luck with that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494749608, "post_id": 43957887, "comment_id": 74953962, "body": "folds can replace recursions which consume one list element each time in a natural way. Here, you are consuming three, so it&#39;s cumbersome to use  a fold for this. Finally: 1) did you realize that your program will crash unless the input list does not have a length which is a multiple of 3? 2) your function has the wrong type, it should return a triplet of strings."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 1, "creation_date": 1494770511, "post_id": 43957887, "comment_id": 74959522, "body": "thanks for clarifying when <code>fold</code> function can replace recursion, regarding the point <code>1</code>and <code>2</code> you are completely right, the real function signature is <code>[String] -&gt; Maybe [(String,String,String)]</code>, I have included this example to make it simpler. I think using this signature handle both points"}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1494710760, "creation_date": 1494710760, "answer_id": 43958138, "question_id": 43957887, "link": "https://stackoverflow.com/questions/43957887/transform-a-list-of-string-to-list-of-tuples-using-foldl-function/43958138#43958138", "title": "transform a list of string to list of tuples using foldl function", "body": "<blockquote>\n  <p>I want to write this function using <code>foldl</code> or <code>foldr</code></p>\n</blockquote>\n\n<p>This is somewhat ugly, but it technically solves it with <code>foldr</code> (it would be easy to adapt it to <code>foldl</code>):</p>\n\n<pre><code>fn :: String -&gt; [(Char, Char, Char)]                                                                                                                                                                    \nfn s = snd $ foldr toTriples ([], []) s where\n    toTriples :: Char -&gt; (String, [(Char, Char, Char)]) -&gt; (String, [(Char, Char, Char)])\n    toTriples c (cur, tups) | length cur &lt; 2 = (c:cur, tups)\n    toTriples c (cur, tups) = ([], (c, cur!!0, cur!!1):tups)\n</code></pre>\n\n<p>As the accumulator, it uses a pair of <code>cur</code>, the current part of the tuple being scanned, and <code>tups</code>, a list of tuples.</p>\n\n<ul>\n<li><p>If the length of <code>cur</code> is less than 2, it prepends the current character to it.</p></li>\n<li><p>If the length of <code>cur</code> is 2, it creates a tuple and prepends it to the list of tuples.</p></li>\n</ul>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 43958138, "answer_count": 1, "score": 1, "last_activity_date": 1494710760, "creation_date": 1494708821, "last_edit_date": 1494709670, "question_id": 43957887, "link": "https://stackoverflow.com/questions/43957887/transform-a-list-of-string-to-list-of-tuples-using-foldl-function", "title": "transform a list of string to list of tuples using foldl function", "body": "<p>I have the below function :</p>\n\n<pre><code>fn :: [String] -&gt; [(a,b,c)]\nfn lst = case lst of\n  [] -&gt; []\n  (a:b:c:xs) -&gt; (a,b,c) : fn xs\n</code></pre>\n\n<p>I want to write this function using <code>foldl</code> or <code>foldr</code> </p>\n"}, {"tags": ["haskell", "functional-programming", "coq", "agda", "idris"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494711182, "post_id": 43957592, "comment_id": 74947267, "body": "I&#39;d guess it is impossible to do that without dependent elimination. Church encodings in CoC only allow for non-dependent elimination, IIRC. Inductive types (as in CiC) of course do allow that. (Perhaps Self types also allow for a better encoding, featuring dependent elimination)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494711279, "post_id": 43957592, "comment_id": 74947292, "body": "@chi ... damn. But how would those help? I&#39;ve been thinking a lot about this and I&#39;m out of creativity."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494749166, "post_id": 43957592, "comment_id": 74953853, "body": "In dependent elimination, the &quot;return&quot; type <code>r</code> is not a type <code>*</code>, but a type family <code>r :: (x:a) -&gt; B x -&gt; *</code> allowing for the second projection to have the type you want. Check e.g. the HoTT book at pages 31-32 for some discussion on Sigma types, and dependent vs non dependent elimination."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494790459, "post_id": 43957592, "comment_id": 74965978, "body": "I really need to read the HoTT book, @chi. Do you, in particular, have anything else to suggest me to read when I have some free time? Given that you know more or less the things I ask."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494794410, "post_id": 43957592, "comment_id": 74967122, "body": "I wish there were a few comprehensive books/papers to summarize the main results of type theory -- the literature is too sparse :-( Anyway, I personally enjoyed the Martin-Lof ITT <a href=\"https://intuitionistic.files.wordpress.com/2010/07/martin-lof-tt.pdf\" rel=\"nofollow noreferrer\">notes</a> and the HoTT book. Also, <a href=\"https://www.youtube.com/playlist?list=PLGCr8P_YncjXRzdGq2SjKv5F2J8HUFeqN\" rel=\"nofollow noreferrer\">Robert Harper&#39;s videos</a> are nice. The Barendregt Typed Lambda Calculi book is also useful."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494801520, "post_id": 43957592, "comment_id": 74968838, "body": "@chi that is a serious problem! I can&#39;t wait for the killer DApp that makes to scientific knowledge what Youtube did to creative content. Wikipedia is more of an archive. An universal way to talk communicate maths as a whole, something easy to pick and share. Papers suck. Seriously, they such too much. It takes weeks to digest a paper that ultimately could be explained in a few sentences once &quot;decrypted&quot;. (Sighs.) Thanks for the recommendations."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494855215, "post_id": 43957592, "comment_id": 74990838, "body": "In theory, that&#39;s what survey papers are for: you take results from many papers and summarize the key points from each. In practice, there&#39;s too much material. Even books do not tell the whole tale. And, yes, sometimes you need to spend way too much time in technical details just to get the general idea. I am fine with needing a long time to digest some result, not so when I need a long time only to see if paper P is what I was looking for (especially when asking some expert on SE is faster :-( ... )"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494864997, "post_id": 43957592, "comment_id": 74997759, "body": "@chi <i>sighs</i> can I ask just one more question, promise? The reason I&#39;m looking for those things is that I need a simple core that is expressive enough to prove a lot of things. Reason is, I&#39;d compile it to JS and EVM (Ethereum) and, with this, be able to explore and learn the concept of proving things about my real-life programs. Existing langs (coq/idris/agda) doesn&#39;t work because they don&#39;t compile to those targets satisfactorily. CoC itself doesn&#39;t because it isn&#39;t expressive enough (induction, etc.). What would you do? I don&#39;t need a TT PHD right now. A core I can program is all I need!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494865905, "post_id": 43957592, "comment_id": 74998288, "body": "I can not really recommend a specific framework. Either you try to compile CiC, or use CoC+extra axioms for dependent elimination (or some variant of Martin-L&#246;f&#39;s ITT ... ?). Maybe you should try asking on CS or TCS, were more expert people can provide insights."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 2, "answer_count": 0, "score": 8, "last_activity_date": 1494706534, "creation_date": 1494706534, "question_id": 43957592, "link": "https://stackoverflow.com/questions/43957592/how-to-extract-the-second-element-of-sigma-on-the-calculus-of-constructions", "title": "How to extract the second element of Sigma on the Calculus of Constructions?", "body": "<p>I'm attempting to do that as follows:</p>\n\n<pre><code>\u03bb (A : *) -&gt;\n\u03bb (B : (A -&gt; *)) -&gt;\n\u03bb (t : (\u2200 (r : *) -&gt; (\u2200 (x : a) -&gt; (B x) -&gt; r)) -&gt; r) -&gt;\n(t (B (t A (\u03bb (x : A) -&gt; \u03bb (y : (B x)) -&gt; x)))\n    (\u03bb (x : A) -&gt; \u03bb (y : (B x)) -&gt; y))\n</code></pre>\n\n<p>Notice that, since the value returned by that function depends on a value inside the sigma itself, I need to extract that value. This code doesn't check, because, I believe, it fails to unify the type extracted from Sigma with the type inside it. </p>\n\n<p>Is there any workaround?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494716968, "post_id": 43957340, "comment_id": 74948634, "body": "You may want to use <code>numOfTimes &lt;- readLn</code> as a shorthand for chaining <code>read</code> with <code>getLine</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 0, "last_activity_date": 1494705824, "creation_date": 1494705824, "answer_id": 43957498, "question_id": 43957340, "link": "https://stackoverflow.com/questions/43957340/how-to-get-a-more-efficient-haskell-solution/43957498#43957498", "title": "how to get a more efficient haskell solution", "body": "<p>The trick to solving this problem has nothing to do with Haskell and everything to do with the format of the answer.</p>\n\n<p>The difficulty of the problem is that the size of the string roughly doubles each iteration. All the <code>'B'</code>s get doubled to <code>\"BA\"</code> and all the <code>'A'</code>s get turned into <code>'B'</code>s to eventually be doubled. Building this string in memory for large numbers is intractable. To solve the problem quickly you'll need to find a way to avoid building the string in memory. This is possible because the answer doesn't ask for the string, it asks for only two numbers: the number of letters <code>'A'</code> and the number of letters <code>'B'</code>.</p>\n\n<p>Before performing any steps the string consists of <code>1</code> <code>'A'</code> and <code>0</code> <code>'B'</code>s. Can you figure out from that how many <code>'A'</code>s  and <code>'B'</code>s there are after the first step?</p>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 2, "creation_date": 1494791201, "post_id": 43957505, "comment_id": 74966206, "body": "This is a good starting-point, but I would advise programmers to be able to prove that a method works. There can be a lot of patterns that hold for the first few test cases, then break."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1494832247, "post_id": 43957505, "comment_id": 74976508, "body": "@Davislor it&#39;s obvious. Though by inspecting sequence of results you can have some guesses which will help you construct proof."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1494833698, "post_id": 43957505, "comment_id": 74977235, "body": "A lot of things that are obvious aren\u2019t true. But the proof I give in my answer is indeed short and elementary."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1494838763, "post_id": 43957505, "comment_id": 74980058, "body": "@Davislor Sorry, I wasn&#39;t clear enough. By saying &#171;it&#39;s obvious&#187; I didn&#39;t mean the fact from problem in answer, I was saying about your statement: It&#39;s obvious that if you want to be ensure in some things you should prove them and not make heuristic guesses. I like your proof and upvoted it. Just saying that it may be easier to invent proof if you first see at sequence of numbers."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1494870382, "post_id": 43957505, "comment_id": 75000716, "body": "@Shersh Okay, then we agree. I appreciate that you\u2019re trying to give hints here, not a complete solution."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 0, "last_activity_date": 1494705865, "creation_date": 1494705865, "answer_id": 43957505, "question_id": 43957340, "link": "https://stackoverflow.com/questions/43957340/how-to-get-a-more-efficient-haskell-solution/43957505#43957505", "title": "how to get a more efficient haskell solution", "body": "<p>The problem is not in Haskell and not in the way how you treat <code>String</code> type. The problem is in <strong>using</strong> <code>String</code> type. This problem can solved efficiently w/o strings. Just write answers for <code>K</code> from <em>1</em> to <em>10</em>:</p>\n\n<pre><code>K = 1: 0, 1\nK = 2: 1, 1\nK = 3: 1, 2\nK = 4: 2, 3\nK = 5: 3, 5\nK = 6: 5, 8\nK = 7: 8, 13\nK = 8: 13, 21\nK = 9: 21, 34\nK = 10: 34, 55\n</code></pre>\n\n<p>So the answer is two consecutive numbers in this sequence:</p>\n\n<pre><code>0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, ...\n</code></pre>\n\n<p>Does this sequence of numbers look familiar to you? ;)</p>\n\n<p>There're a lot of solutions in Haskell for calculating this sequence fast.</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 0, "last_activity_date": 1494706319, "creation_date": 1494706319, "answer_id": 43957565, "question_id": 43957340, "link": "https://stackoverflow.com/questions/43957340/how-to-get-a-more-efficient-haskell-solution/43957565#43957565", "title": "how to get a more efficient haskell solution", "body": "<p>You can think this problem from a more mathematical side: If you have (number of As, number of Bs), the next you push the button, you will get (number of Bs, number of As + number of Bs).</p>\n\n<p>You can write this down in Haskell as:</p>\n\n<pre><code>step :: (Integer, Integer) -&gt; (Integer,Integer)  \nstep (a,b) = (b,b+a)\n\napplyStep :: Int -&gt; (Integer, Integer) -&gt; (Integer,Integer)\napplyStep 0 (a,b) = (a,b)\napplyStep n (a,b) = applyStep (n-1) (step (a,b))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 1, "last_activity_date": 1494788364, "last_edit_date": 1494788364, "creation_date": 1494787691, "answer_id": 43967628, "question_id": 43957340, "link": "https://stackoverflow.com/questions/43957340/how-to-get-a-more-efficient-haskell-solution/43967628#43967628", "title": "how to get a more efficient haskell solution", "body": "<p>Okay, let\u2019s see if we can eliminate all the window-dressing and express this in terms of primitive recursion.  We only care about the number of A\u2019s and B\u2019s: their order is irrelevant to the problem.  Furthermore, the number of A\u2019s and B\u2019s after each push depends only on the number of A\u2019s and B\u2019s there were before.  So let\u2019s call the number of A\u2019s at step <em>n</em> <em>a</em>(<em>n</em>) and the number of B\u2019s at step <em>n</em> <em>b</em>(<em>n</em>).</p>\n\n<p>Our base case is <em>a</em>(0) = 1, <em>b</em>(0) = 0.</p>\n\n<p>After a push of the button, every A in the previous string gets turned into a B, and every B gets turned into BA.  So, every A in the new string is the result of a B\u2192AB substitution, and every letter of the old string adds one B to the new string.</p>\n\n<p>This means that, when <em>n</em> > 0, <em>a</em>(<em>n</em>) = <em>b</em>(<em>n</em>-1) and <em>b</em>(<em>n</em>) = <em>a</em>(<em>n</em>-1) + <em>b</em>(<em>n</em>-1).  Now, for <em>n</em> > 1, we can substitute <em>a</em>(<em>n</em>-1) = <em>b</em>(<em>n</em>-2).  This gives us:</p>\n\n<p><em>a</em>(0) = 1, <em>b</em>(0) = 0</p>\n\n<p><em>a</em>(1) = 0, <em>b</em>(1) = 1</p>\n\n<p><em>a</em>(<em>n</em>) = <em>b</em>(<em>n</em>-1), <em>b</em>(<em>n</em>) = <em>b</em>(<em>n</em>-2) + <em>b</em>(<em>n</em>-1) | <em>n</em> > 1</p>\n\n<p>Does that definition of <em>b</em>&mdash;zero, then one, then the sum of the previous two values of <em>b</em>&mdash;remind you of any other sequence of numbers you\u2019ve encountered in a programming class?</p>\n"}], "owner": {"reputation": 25, "user_id": 7982127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48e52b08aa28eadcb7032e090896277?s=128&d=identicon&r=PG&f=1", "display_name": "Josh ", "link": "https://stackoverflow.com/users/7982127/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 43957505, "answer_count": 4, "score": 1, "last_activity_date": 1494788364, "creation_date": 1494704705, "question_id": 43957340, "link": "https://stackoverflow.com/questions/43957340/how-to-get-a-more-efficient-haskell-solution", "title": "how to get a more efficient haskell solution", "body": "<p>I've been trying to solve this problem over at kattis problems: <a href=\"https://open.kattis.com/problems/rijeci\" rel=\"nofollow noreferrer\">https://open.kattis.com/problems/rijeci</a><br>\nI have the solution below, but the system rejects my solution because it takes too long to complete larger inputs, I was wondering if there is a way to solve this problem more efficiently. Please don't assume I know about certain methods and such because I'm just starting out learning haskell, and functional programming for that matter. </p>\n\n<p>My Solution              </p>\n\n<pre><code>convertString :: String -&gt; String\nconvertString [] = []\nconvertString (x:xs)\n  | x == 'A'  = 'B': convertString xs\n  | otherwise = 'B':'A':convertString xs\n\nfinalString :: String -&gt; Integer -&gt; String\nfinalString letters numOfTimes\n  | numOfTimes &gt; 0   = finalString (convertString letters) (numOfTimes-1)\n  | otherwise = letters\n\ngetNumA :: String -&gt; Int\ngetNumB :: String -&gt; Int\n\ngetNumA = length . filter(=='A')\ngetNumB = length . filter(=='B')\n\nmain = do\n  inputLine &lt;- getLine\n  let numOfTimes = read (inputLine) :: Integer\n  let convertedString = (finalString \"A\" numOfTimes)\n  putStrLn ((show (getNumA convertedString)) ++ \" \" ++(show (getNumB convertedString)))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494704782, "post_id": 43957332, "comment_id": 74945604, "body": "Looks like because you said the first argument is a 2-tuple, then you tried to pattern match it with a list in the first definition. Tuples can&#39;t be empty iirc."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494704799, "post_id": 43957332, "comment_id": 74945609, "body": "The <code>test</code> function&#39;s first argument is a tuple and second is a list of tuples but your pattern matching is not correct."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494705717, "post_id": 43957332, "comment_id": 74945869, "body": "You say that the function returns an int, then you try to return a [] on that line, which isn&#39;t an int."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "edited": false, "score": 0, "creation_date": 1494705468, "post_id": 43957394, "comment_id": 74945793, "body": "Hey thanks, i removed it and i get this  &quot;Couldn&#39;t match expected type \u2018Int\u2019 with actual type \u2018[t0]\u2019&quot;"}, {"owner": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "edited": false, "score": 0, "creation_date": 1494705563, "post_id": 43957394, "comment_id": 74945820, "body": "i will add it as a modification"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "edited": false, "score": 0, "creation_date": 1494705599, "post_id": 43957394, "comment_id": 74945832, "body": "@ElBazzi And why do you even have the first argument? It&#39;s not doing anything."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "edited": false, "score": 1, "creation_date": 1494706000, "post_id": 43957394, "comment_id": 74945947, "body": "@ElBazzi Note the comment I added to the question. Really, each question should be a single question. If this answer solved your original question, mark it as solved by hitting the check mark, and upvote my answer if it helped you. If you need further help, you can open a new question, or contact me at the email address in my profile. I&#39;d encourage you to really read over the error messages though, as they&#39;re quite informative."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "edited": false, "score": 0, "creation_date": 1494708488, "post_id": 43957394, "comment_id": 74946572, "body": "@ElBazzi No problem."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 4, "last_activity_date": 1494813213, "last_edit_date": 1494813213, "creation_date": 1494705095, "answer_id": 43957394, "question_id": 43957332, "link": "https://stackoverflow.com/questions/43957332/couldnt-match-expected-type-int-int-with-actual-type-t0/43957394#43957394", "title": "Couldn&#39;t match expected type \u2018(Int, Int)\u2019 with actual type \u2018[t0]\u2019", "body": "<p>Your function signature says that the first argument should be a tuple of 2 ints, but then in your first pattern matching line:</p>\n\n<pre><code>test [] [] = []\n      ^\n</code></pre>\n\n<p>You try to match a tuple against a list. </p>\n\n<ol>\n<li><p>The types don't match, thus the error. </p></li>\n<li><p>A tuple will never be empty unless that's what type it is. Unlike lists, tuples can't be added to or removed from; they have a fixed size. </p></li>\n</ol>\n\n<p>If you said the tuple will have 2 values, it will always have 2 values. No need to check if it's empty. It looks like you can get rid of that line, since it's not doing anything legal or useful. </p>\n\n<p>Also note your naming is a little confusing. Typically, <code>x</code> and <code>xs</code> represent the head and tail of a collection. Tuples don't really have either, just different \"slots\". </p>\n"}], "owner": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 43957394, "answer_count": 1, "score": 0, "last_activity_date": 1494813213, "creation_date": 1494704633, "last_edit_date": 1494705657, "question_id": 43957332, "link": "https://stackoverflow.com/questions/43957332/couldnt-match-expected-type-int-int-with-actual-type-t0", "title": "Couldn&#39;t match expected type \u2018(Int, Int)\u2019 with actual type \u2018[t0]\u2019", "body": "<p>why is this giving me error? I am just trying this as a test to learn Haskell where i am just strapping off the tuples in the second input. Why does this not compile ? Thank you</p>\n\n<pre><code>test :: (Int,Int) -&gt; [(Int,Int)] -&gt; Int\ntest [] [] = []\ntest xs [] = []\ntest (x,xs) (y:ys)  =   test (x,xs) ys\n</code></pre>\n\n<p>Thank you @Carcigenicate for pointing out the first error. Now if we have</p>\n\n<pre><code>test :: (Int,Int) -&gt; [(Int,Int)] -&gt; Int\ntest xs [] = []\ntest (x,xs) (y:ys)  =   test (x,xs) ys \n</code></pre>\n\n<p>I get</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018[t0]\u2019\n\u2022 In the expression: []\n  In an equation for \u2018test\u2019: test xs [] = []\n</code></pre>\n"}, {"tags": ["json", "haskell", "wreq"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1494699615, "post_id": 43956321, "comment_id": 74944026, "body": "If you\u2019re sending JSON, your content type should be <code>application&#47;json</code>, not <code>application&#47;x-www-form-urlencoded</code>, which is a completely different encoding."}, {"owner": {"reputation": 10550, "user_id": 633094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8FbW8.jpg?s=128&g=1", "display_name": "munk", "link": "https://stackoverflow.com/users/633094/munk"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494700204, "post_id": 43956321, "comment_id": 74944196, "body": "@AlexisKing ultimately the application I&#39;m targeting with this request expects a urlencoded form. So maybe what I should be asking is how do I send url encoded data so it matches what python requests is sending?"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1494700342, "post_id": 43956321, "comment_id": 74944241, "body": "Yes, that sounds like the right question here. If the server expects form data, sending JSON isn\u2019t going to work."}], "answers": [{"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 1, "last_activity_date": 1494784942, "creation_date": 1494784942, "answer_id": 43967228, "question_id": 43956321, "link": "https://stackoverflow.com/questions/43956321/send-request-as-content-type-of-x-www-form-urlencoded-with-wreq/43967228#43967228", "title": "Send request as content type of x-www-form-urlencoded with wreq", "body": "<p>As per your discussion with @Alexis, your client seems to be sending JSON, while the server is expected urlencoded. The documentation of <a href=\"https://hackage.haskell.org/package/wreq-0.5.0.1/docs/Network-Wreq.html#g:4\" rel=\"nofollow noreferrer\"><code>Post</code></a> shows how to send urlencoded data, using the <a href=\"https://hackage.haskell.org/package/wreq-0.5.0.1/docs/Network-Wreq.html#v::-61-\" rel=\"nofollow noreferrer\"><code>:=</code></a> constructor. In this case this would be</p>\n\n<pre><code>postIt = post url [\"client_id\" := clientId, \"client_secret\" := clientSecret, \"grant_type\" := grantType]\n</code></pre>\n\n<p>I've given the example using <code>post</code> rather than <code>postWith</code> since the default appears to be that it uses <code>application/x-www-form-urlencoded</code>.</p>\n\n<hr>\n\n<p>There seems to be a slight complication with <code>OverloadedStrings</code>. To make a compilable program, I had to remove the AuthRequest module and explicitly give the types of the constants as below</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Network.Wreq\nimport Data.ByteString as B\n\nclientId = \"some_id\" :: ByteString\nclientSecret = \"some_secret\" :: ByteString\ngrantType = \"credentials\" :: ByteString\nurl = \"http://localhost:8080\"\n\npostIt = post url [\"client_id\" := clientId, \"client_secret\" := clientSecret, \"grant_type\" := grantType]\n\nmain = postIt\n</code></pre>\n"}], "owner": {"reputation": 10550, "user_id": 633094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8FbW8.jpg?s=128&g=1", "display_name": "munk", "link": "https://stackoverflow.com/users/633094/munk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520255915, "creation_date": 1494698441, "last_edit_date": 1520255915, "question_id": 43956321, "link": "https://stackoverflow.com/questions/43956321/send-request-as-content-type-of-x-www-form-urlencoded-with-wreq", "title": "Send request as content type of x-www-form-urlencoded with wreq", "body": "<p>I'm learning to use wreq this weekend and I've run into some strange behavior.</p>\n\n<p>I have a module <code>AuthRequest</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\nmodule AuthRequest where\n\nimport Data.Aeson\nimport GHC.Generics\nimport Data.Monoid\n\ndata AuthRequest = AuthRequest {\n    client_id :: String\n  , client_secret :: String\n  , grant_type :: String\n} deriving (Generic,  Show)\n\ninstance ToJSON AuthRequest where\n    toJSON (AuthRequest id_ secret grant) =\n      object [ \"client_id\" .= id_\n             , \"client_secret\" .= secret\n             , \"grant_type\" .= grant\n             ]\n    toEncoding(AuthRequest id_ secret grant) =\n      pairs (\"client_id\" .= id_ &lt;&gt; \"client_secret\" .= secret &lt;&gt; \"grant_type\" .= grant)\n</code></pre>\n\n<p>and a module <code>HttpDemo</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\nmodule HttpDemo where\n\nimport Control.Lens\nimport Network.Wreq\nimport AuthRequest\nimport Data.Aeson\n\nclientId = \"some_id\"\nclientSecret = \"some_secret\"\nurl = \"http://localhost:5000\"\n\nopts :: Options\nopts = defaults\n  &amp; header \"Content-Type\" .~ [\"application/x-www-form-urlencoded\"]\n\nreq :: AuthRequest\nreq = AuthRequest clientId clientSecret \"credentials\"\n\npostIt = postWith opts url (toJSON req)\n</code></pre>\n\n<p>On the other end, I have a simple python flask server that listens to this request with a breakpoint so I can see the value that comes through.</p>\n\n<p>When I look at the <code>request.form</code> on the server side, I see this: <code>ImmutableMultiDict([('{\"client_secret\":\"some_secret\",\"client_id\":\"some_id\",\"grant_type\":\"whatever\"}', '')])</code></p>\n\n<p>The key is what should be my post body!</p>\n\n<p>But if I make a similar request using the requests python library</p>\n\n<pre><code>requests.post('http://localhost:5000', data={'client_id': clientId, 'client_secret': clientSecret, 'grant_type': grant_type}, headers={'content-type': 'application/x-www-form-urlencoded'})\n</code></pre>\n\n<p>I see what I expect: <code>ImmutableMultiDict([('grant_type', 'whatever'), ('client_id', 'some_id'), ('client_secret', 'some_secret')])</code></p>\n\n<p>What I think I want is to send this request as <code>x-www-form-urlencoded</code>. I see there are some docs <a href=\"http://hackage.haskell.org/package/wreq-0.5.0.1/docs/Network-Wreq.html#g:18\" rel=\"nofollow noreferrer\">here</a> around this, but not clear on how to proceed. Maybe I need a FormValue instance? An example would be helpful.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 1, "creation_date": 1494696260, "post_id": 43955828, "comment_id": 74943045, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16888668/couldnt-match-expected-type-a-with-actual-type-a\">Couldn&#39;t match expected type `a&#39; with actual type `&#91;a&#93;&#39;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "edited": false, "score": 2, "creation_date": 1494697960, "post_id": 43955848, "comment_id": 74943538, "body": "@ElBazzi just for future reference - please include the actual error you get it is quite helpful for a) yourself b) the ones answering your question"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494699801, "post_id": 43955848, "comment_id": 74944078, "body": "Also <code>insertAt n x xs = x1 ++ x : x2</code> works just fine."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1494695456, "creation_date": 1494695456, "answer_id": 43955848, "question_id": 43955828, "link": "https://stackoverflow.com/questions/43955828/couldnt-match-expected-type-a-with-actual-type-a/43955848#43955848", "title": "Couldn&#39;t match expected type \u2018[a]\u2019 with actual type \u2018a\u2019", "body": "<p>you are mixing lists and list elements - you have to pack the element in a singleton list</p>\n\n<pre><code>insertAt :: Int -&gt; a -&gt; [a] -&gt; [a]\ninsertAt n x xs = x1 ++ [x] ++ x2\n    where (x1,x2) = splitAt n xs\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 7737119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XYJWD.jpg?s=128&g=1", "display_name": "Ahmad Bazzi", "link": "https://stackoverflow.com/users/7737119/ahmad-bazzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 43955848, "answer_count": 1, "score": 0, "last_activity_date": 1494866133, "creation_date": 1494695358, "last_edit_date": 1494866133, "question_id": 43955828, "link": "https://stackoverflow.com/questions/43955828/couldnt-match-expected-type-a-with-actual-type-a", "title": "Couldn&#39;t match expected type \u2018[a]\u2019 with actual type \u2018a\u2019", "body": "<p>why is this giving me error? </p>\n\n<pre><code>insertAt :: Int -&gt; a -&gt; [a] -&gt; [a]\ninsertAt n x xs = x1 ++ x ++ x2\n    where (x1,x2) = splitAt n xs\n</code></pre>\n"}, {"tags": ["haskell", "applicative", "purescript", "monoids"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494693104, "post_id": 43955347, "comment_id": 74942131, "body": "<code>Accy o</code> is a constant functor. <code>map</code>ing any function <code>f : a-&gt;b</code> would yield <code>map f :: Accy o a -&gt; Accy o b</code> which should ignore <code>f</code> completely, since there&#39;s no argument of type <code>a</code> around (only <code>o</code> is available)."}], "answers": [{"tags": [], "owner": {"reputation": 745, "user_id": 176108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c92fe969f853f47588c0683fafdd3e4?s=128&d=identicon&r=PG", "display_name": "Albtzrly", "link": "https://stackoverflow.com/users/176108/albtzrly"}, "is_accepted": false, "score": 3, "last_activity_date": 1494693131, "creation_date": 1494693131, "answer_id": 43955458, "question_id": 43955347, "link": "https://stackoverflow.com/questions/43955347/how-to-make-a-phantom-applicative-functor-in-purescript/43955458#43955458", "title": "How to make a phantom applicative functor in PureScript?", "body": "<p>I see my problem.  The map function is mapping over <code>Accy o</code> so the <code>a</code> in <code>map :: (a -&gt; b) -&gt; f a -&gt; f b</code> is the phantom type which is inaccessable.</p>\n\n<p>Looks like I need to disregard the f in the Functor instance.</p>\n\n<pre><code>instance mapaccy :: (Monoid o) =&gt; Functor (Accy o) where\n  map f (Accy { acc : a }) = Accy { acc : a }\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 176108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c92fe969f853f47588c0683fafdd3e4?s=128&d=identicon&r=PG", "display_name": "Albtzrly", "link": "https://stackoverflow.com/users/176108/albtzrly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1494693131, "creation_date": 1494692313, "question_id": 43955347, "link": "https://stackoverflow.com/questions/43955347/how-to-make-a-phantom-applicative-functor-in-purescript", "title": "How to make a phantom applicative functor in PureScript?", "body": "<p>I'm reading through <a href=\"http://www.staff.city.ac.uk/~ross/papers/Applicative.pdf\" rel=\"nofollow noreferrer\">this paper</a> and it says that Monoids are phantom applicative functors.</p>\n\n<p>I tried setting up a phantom type in purescript but I get a type error in the Functor instance.  My guess is the compiler doesn't know what the <code>a</code> is in <code>Accy o a</code> after doing the map.  How would I fix that?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Accy o a = Accy { acc :: o }\n\ninstance mapaccy :: (Monoid o) =&gt; Functor (Accy o) where\n  map f (Accy { acc : a }) = Accy { acc : (f a) }\n\ninstance maccy :: (Monoid o) =&gt; Apply (Accy o) where\n  apply (Accy { acc : f }) (Accy { acc : a }) = (Accy { acc : f &lt;&gt; a })\n\ninstance mpp :: (Monoid o) =&gt; Applicative (Accy o) where\n  pure _ = Accy { acc : mempty }\n\ninstance msemi :: (Monoid o) =&gt; Semigroup (Accy o a) where\n  append (Accy { acc : a }) (Accy { acc : b }) = Accy { acc : (a &lt;&gt; b) }\n\n\nmap f (Accy { acc : a }) = Accy { acc : (f a) }\n                                           ^\n  Could not match type      \n    o2      \n  with type      \n    a0      \n  while checking that type t1\n    is at least as general as type a0\n  while checking that expression a\n    has type a0\n  in value declaration mapaccy\n</code></pre>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494688164, "post_id": 43953811, "comment_id": 74940497, "body": "I am not aware of an automated way, though I believe this argument appeared on the Haskell caf&#233; ML a very long time ago. Anyway, to automate this you need some renaming to avoid clashes."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494702142, "post_id": 43953811, "comment_id": 74944840, "body": "It might be reasonably easy to implement this with <a href=\"http://hackage.haskell.org/package/haskell-names\" rel=\"nofollow noreferrer\"><code>haskell-names</code></a>."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1494716348, "post_id": 43953811, "comment_id": 74948534, "body": "I started some proof-of-conceot here: <a href=\"https://github.com/nomeata/hs-all-in-one\" rel=\"nofollow noreferrer\">github.com/nomeata/hs-all-in-one</a>."}], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1494682716, "creation_date": 1494682716, "question_id": 43953811, "link": "https://stackoverflow.com/questions/43953811/how-to-automatically-combine-multipe-haskell-modules-into-one", "title": "How to automatically combine multipe Haskell modules into one", "body": "<p>Assume I have a few Haskell modules, and I want to run them in an environment that requires the whole program to be entered as a single module (e.g. static analyzers, programming competition websites etc.). This might also be interesting for performance, to see if GHC does better when it sees all code of the application at once.</p>\n\n<p>Disregarding corner cases like differences in the set of language pragmas, or orphan instances, it seems plausible that there is a way to combine these modules into one (and I could probably do it by hand).</p>\n\n<p>But is there a better, automated way?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1494659415, "post_id": 43947972, "comment_id": 74932598, "body": "Yeaod&#39;s scaffolding s are a big beast and somehow the strength of it. If you are stripping everything you&#39;ll probably be better starting\u200b from scratch and only use the scaffolding as reference."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1494682629, "post_id": 43947972, "comment_id": 74938873, "body": "If you don&#39;t need anything of the scaffolded site, then don&#39;t use the scaffolded site instead of trying to strip everything you don&#39;t need away from it."}], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 2875269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Govpy.jpg?s=128&g=1", "display_name": "Vanitas", "link": "https://stackoverflow.com/users/2875269/vanitas"}, "edited": false, "score": 0, "creation_date": 1494672294, "post_id": 43951321, "comment_id": 74935786, "body": "While this doesn&#39;t really answer the question I feel like it&#39;s the most sane option to just go with warp, wai-route and persistent, hence why I accept it as the answer."}], "tags": [], "owner": {"reputation": 36, "user_id": 1122365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96cb4aebd82b601be565632fe8995c07?s=128&d=identicon&r=PG", "display_name": "jacksjy", "link": "https://stackoverflow.com/users/1122365/jacksjy"}, "is_accepted": true, "score": 1, "last_activity_date": 1494666846, "creation_date": 1494666846, "answer_id": 43951321, "question_id": 43947972, "link": "https://stackoverflow.com/questions/43947972/cant-configure-yesod-correctly-for-api/43951321#43951321", "title": "Can&#39;t configure Yesod correctly for API", "body": "<p>If you don't need any Session feature or must use Yesod. warp &amp; wai-route &amp; persistent can be a choice. Later you can easy go back to Yesod, once you get the idea, the mechanism behind is close. If you must use Yesod, erase the instance declaration you don't want in the Foundation.hs</p>\n"}], "owner": {"reputation": 735, "user_id": 2875269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Govpy.jpg?s=128&g=1", "display_name": "Vanitas", "link": "https://stackoverflow.com/users/2875269/vanitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 43951321, "answer_count": 1, "score": 0, "last_activity_date": 1494666846, "creation_date": 1494634108, "question_id": 43947972, "link": "https://stackoverflow.com/questions/43947972/cant-configure-yesod-correctly-for-api", "title": "Can&#39;t configure Yesod correctly for API", "body": "<p>I'm wishing to build an API using Haskell and Yesod.</p>\n\n<p>However I'm facing some problems.</p>\n\n<p>I've used <code>stack</code> to set up a new Haskell project with the <code>yesod-sqlite</code> template, went ahead and deleted the default Handlers, also removed anywhere they're mentioned in both <code>Application.hs</code> and my cabal file, but, unforunately they are also mentioned in <code>Foundation.hs</code> in a lot of places. for some reason the handlers are <strong>very</strong> embedded into Yesod, which I find strange.</p>\n\n<p>I don't need any static content or any templates or anything that results in HTML.\nI just want to return JSON, so I'm wondering if there's a way to ditch <code>Foundation.hs</code> safely, as it looks like it's responsible for the templating, or atleast a way to safely remove Handlers and disable the forced templating.</p>\n"}, {"tags": ["haskell", "blaze-html"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1494634960, "last_edit_date": 1592644375, "creation_date": 1494634960, "answer_id": 43948041, "question_id": 43947627, "link": "https://stackoverflow.com/questions/43947627/blaze-templating-attribute-with-no-value/43948041#43948041", "title": "Blaze Templating - Attribute with no value", "body": "<blockquote>\n<h2>Boolean attributes (<a href=\"http://w3c.github.io/html/infrastructure.html#sec-boolean-attributes\" rel=\"nofollow noreferrer\">HTML5 spec</a>)</h2>\n<p>If the attribute is present, its value must either be the empty string or a value that is an ASCII case-insensitive match for the attribute\u2019s canonical name, with no leading or trailing white space.</p>\n<h3>Examples</h3>\n<pre><code>&lt;label&gt;&lt;input type=checkbox checked name=cheese disabled&gt; Cheese&lt;/label&gt;\n&lt;label&gt;&lt;input type=checkbox checked=checked name=cheese disabled=disabled&gt; Cheese&lt;/label&gt;\n&lt;label&gt;&lt;input type='checkbox' checked name=cheese disabled=&quot;&quot;&gt; Cheese&lt;/label&gt;\n</code></pre>\n</blockquote>\n<p>See also <a href=\"http://www.w3.org/TR/html401/intro/sgmltut.html#h-3.3.4.2\" rel=\"nofollow noreferrer\">HTML4</a>.</p>\n<p>There is a <a href=\"https://github.com/jaspervdj/blaze-html/issues/80\" rel=\"nofollow noreferrer\">Github issue for blaze-html</a> about that.</p>\n<p>So <code>allowfullscreen=&quot;allowfullscreen&quot;</code> should work.</p>\n"}], "owner": {"reputation": 113, "user_id": 3067762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sSSpz.jpg?s=128&g=1", "display_name": "sportanova", "link": "https://stackoverflow.com/users/3067762/sportanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 43948041, "answer_count": 1, "score": 0, "last_activity_date": 1494635739, "creation_date": 1494630839, "last_edit_date": 1494635739, "question_id": 43947627, "link": "https://stackoverflow.com/questions/43947627/blaze-templating-attribute-with-no-value", "title": "Blaze Templating - Attribute with no value", "body": "<p>Using Blaze, how can I write an attribute with no value? As in an attribute that's just one string, with no <code>=</code>.</p>\n\n<p>For example, I want to add a YouTube embed in Blaze, but I don't know how to add the <code>allowfullscreen</code> part. The blaze-from-html tool just errors out and tells me that it's illegal in HTML5, and I'm not sure how to do it from the documentation. Here's how the HTML should look:</p>\n\n<pre><code>&lt;iframe width=\"560\" height=\"315\"\n    src=\"https://www.youtube.com/embed/T4r91mc8pbo\" \n    frameborder=\"0\" allowfullscreen&gt;\n&lt;/iframe&gt;\n</code></pre>\n\n<p>I've tried creating a custom element like</p>\n\n<pre><code>allowfullscreen :: AttributeValue -&gt; Attribute\nallowfullscreen = attribute \"allowfullscreen\" \" allowfullscreen\"\n</code></pre>\n\n<p>but it appends the equal sign anyway - <code>allowfullscreen\"=\"</code> and full screen is disallowed.</p>\n\n<p>I'm using blaze-html 0.8.1.1 and blaze-markup 0.7.0.3.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494620236, "post_id": 43945797, "comment_id": 74924440, "body": "If you are here... when tried to investigate this behavior I&#39;ve came across the fact that you can do <code>let 1=2</code> without any consequences. Can you explain this?"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494620415, "post_id": 43945797, "comment_id": 74924524, "body": "@Eugene: This has to do with laziness \u2013 as long as you never examine the value, the pattern match won&#39;t have a chance to fail.  So <code>let x@1 = 2 in x</code> will fail, as will <code>let !1 = 2 in ()</code>.  But with <code>let 1 = 2 in ()</code>, nothing will force Haskell to actually perform the requested pattern match."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494620566, "post_id": 43945797, "comment_id": 74924602, "body": "The last one is funny. Though I thought one can&#39;t have constants (and expressions) on the lhs"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1494620653, "post_id": 43945797, "comment_id": 74924649, "body": "Likewise let True = False in True?"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1494622463, "post_id": 43945797, "comment_id": 74925469, "body": "@Damian: Yeah, it&#39;s the same thing.  (Note that the <code>True</code> in the body of the let is <i>not</i> the same as the <code>True</code> in the pattern match!)  More questions in this vein are probably best asked as a new question :-)"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1494622850, "post_id": 43945797, "comment_id": 74925646, "body": "@AntalSpector-Zabusky, I can see! Maybe another day I come up with that one :D."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494622892, "post_id": 43945797, "comment_id": 74925655, "body": "@EugeneSh. Thanks a lot for the explaination, it was very revealing"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1494622940, "post_id": 43945797, "comment_id": 74925671, "body": "@DamianLattenero That wasn&#39;t me :)"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1494623067, "post_id": 43945797, "comment_id": 74925720, "body": "Sorry, hahaha I wanted to say @jberryman, but of course, this is his answer.... haha"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494623164, "post_id": 43945797, "comment_id": 74925754, "body": "@EugeneSh. See also: <a href=\"http://stackoverflow.com/q/33006500/2751851\"><i>About `let 5 = 10`</i></a>"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 8, "last_activity_date": 1494620013, "creation_date": 1494620013, "answer_id": 43945797, "question_id": 43945610, "link": "https://stackoverflow.com/questions/43945610/haskell-rare-pattern-matching/43945797#43945797", "title": "Haskell rare pattern matching", "body": "<p>In <code>let</code>s and top level expressions everything on the left-hand side of the <code>=</code> is in scope on the right-hand side. So you've created a looping \"bottom\" value. </p>\n\n<p>Notice this behaves the same way:</p>\n\n<pre><code>Prelude&gt; let s = (s::String)\nPrelude&gt; s\n\"\n</code></pre>\n\n<p>That's because (simplifying) <code>print</code> on <code>String</code> is defined something equivalent to:</p>\n\n<pre><code>printString chars = putChar '\"' &gt;&gt; mapM_ putChar chars\n</code></pre>\n\n<p>Because <code>chars</code> is a loop the <code>mapM_ putChar chars</code> appears to hang.</p>\n"}, {"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1494622952, "post_id": 43945871, "comment_id": 74925676, "body": "Wow, that&#39;s a perfect explanaition, even I could understand a little more this issue, thanks a lot! Nice to have big masters Hanging around here"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1494620339, "creation_date": 1494620339, "answer_id": 43945871, "question_id": 43945610, "link": "https://stackoverflow.com/questions/43945610/haskell-rare-pattern-matching/43945871#43945871", "title": "Haskell rare pattern matching", "body": "<p>The <code>@\"Hello\"</code> is irrelevant here, all it does is fix the type to <code>String</code>. You get the same behaviour with</p>\n\n<pre><code>s :: String\ns = s\n</code></pre>\n\n<p>Which is semantically equivalent to</p>\n\n<pre><code>s' :: String\ns' = undefined\n</code></pre>\n\n<p>which gives the result</p>\n\n<pre><code>Prelude&gt; s'\n\"*** Exception: Prelude.undefined\n</code></pre>\n\n<p>What I mean by \u201csemantically equivalent\u201d is, both <code>s</code> and <code>s'</code> are examples of <em>bottom values</em>, i.e. values from that \u201csin bin of error values any type contains, thanks to non-strictness\u201d. As soon as you hit a bottom value, the pure Haskell language is basically powerless and has give in to, well, <em>undefined</em>, \u201cimpure behaviour\u201d, like letting you wait forever or throwing an exception.</p>\n\n<p>However, again thanks to non-strictness, this needs not necessarily happen. When printing a value, the first thing that happens is, the <code>Show</code> instance is invoked and asked to produce a string. A Haskell string is a lazy list. And the <code>show</code> of <em>any</em> string begins with <code>\"</code>, therefore even if the string itself is utterly undefined, <code>show</code> will manage to produce that one character.</p>\n\n<p>We can observe this more sheltered with</p>\n\n<pre><code>Prelude&gt; head $ show s\n'\"'\n</code></pre>\n"}], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 43945871, "answer_count": 2, "score": 7, "last_activity_date": 1563326626, "creation_date": 1494619180, "last_edit_date": 1563326626, "question_id": 43945610, "link": "https://stackoverflow.com/questions/43945610/haskell-rare-pattern-matching", "title": "Haskell rare pattern matching", "body": "<p>In haskell, I can do:</p>\n\n<pre><code>s@\"Hello\" = s \n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>&gt;s\n&gt;\"\n</code></pre>\n\n<p>It begins to print the String but never ends, what is goin on?</p>\n"}, {"tags": ["haskell", "aes", "rijndael"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1494616381, "post_id": 43944647, "comment_id": 74922668, "body": "Can you produce a full, compiling, test case?  Fragments aren&#39;t very helpful here."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1494617553, "post_id": 43944647, "comment_id": 74923240, "body": "Happily! I&#39;ve added a minimal version that compiles and demonstrates the problem."}], "answers": [{"comments": [{"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1494625076, "post_id": 43945863, "comment_id": 74926492, "body": "Thanks for the tip on pattern matching... but could you elaborate on how I&#39;m supposed to redefine <code>xpndC</code>, if I&#39;ve already thrown away the column I&#39;m supposed to <code>xor</code> the 4th column with?   I would also love to use the <code>scanl</code>, but I can&#39;t figure out how to translate the C code for <code>schedule_core</code> into Haskell. I know it&#39;s asking a lot but I could I see these ideas in a bit more in context? I get the impression non-trivial refactoring is needed."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1494633904, "post_id": 43945863, "comment_id": 74928619, "body": "A fantastic answer - I especially appreciate the &#39;quick fix&#39; in addition to the explanation of the more elegant scan. Thanks!"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1494635210, "post_id": 43945863, "comment_id": 74928835, "body": "Glad you like it!"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1494650354, "post_id": 43945863, "comment_id": 74930981, "body": "Wow, major kudos for digging into some fairly complex code and debugging it"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1494628261, "last_edit_date": 1494628261, "creation_date": 1494620315, "answer_id": 43945863, "question_id": 43944647, "link": "https://stackoverflow.com/questions/43944647/whats-wrong-with-this-haskell-aes-key-expansion/43945863#43945863", "title": "What&#39;s wrong with this Haskell AES key expansion?", "body": "<p>You're missing a step.</p>\n\n<pre><code>xpndC ws = transpose [head ws, b, zipWith xor b c, last ws]\n</code></pre>\n\n<p>the fourth column should be the xor of the previous fourth column (which you've thrown away in the first pass) and the new third column.</p>\n\n<p>The fact that <code>xor x x = 0</code> somehow contributed to this mistake being noticeable only at the fifth iteration.</p>\n\n<hr>\n\n<p>Minor stylistic comments</p>\n\n<p>Pattern matching on a fixed structure is less awkward than <code>(!!)</code>.</p>\n\n<pre><code>xpndC :: [[Word8]] -&gt; [[Word8]]\nxpndC [a,b,c,d] = [a, b, zipWith xor b c, d]\n</code></pre>\n\n<p>Also note that steps <code>2b4</code> and <code>3</code> are actually a scan. Roughly, it ends up looking like this (with the name <code>schedule_core</code> borrowed from your last link):</p>\n\n<pre><code>new = tail $ scanl (zipWith xor) (schedule_core (last old)) old\n</code></pre>\n\n<hr>\n\n<h1>Edit: Fix</h1>\n\n<p>The solution is essentially to <em>not</em> throw away the last column. You can, as a quick fix, inject it in an additional pass this way:</p>\n\n<pre><code>keys = f 16 $ f 8 $ f 4 $ f 2 $ f 1 key\n where\n  f w n = xpndE (transpose n) . xpndC . xpndB . xpndA $ xpndD w n\n\nxpndE n [a,b,c,_] = transpose [a,b,c,zipWith xor c (last n)]\n\nxpndC = (...) {- remove transpose here -}\n</code></pre>\n\n<p>The <code>xpnd*</code> functions may be a bit too fine-grained, once you realize that the list is quite small. I would also factor <code>transpose</code> out, if you want to keep it at all.</p>\n\n<pre><code>keys = transpose $ f 16 $ f 8 $ f 4 $ f 2 $ f 1 $ transpose key\n  where\n    f rc [a, b, c, d] =\n      let e = schedule rc d\n          a' = zipWith xor a e\n          b' = zipWith xor b a'\n          c' = zipWith xor c b'\n          d' = zipWith xor c c'\n      in [a', b', c', d']  -- Here is where one may recognize `scanl` or a fold.\n</code></pre>\n\n<p>As for <code>schedule</code>, it's the function that takes the last column (<code>d</code> above, <code>last tW</code> below) and scrambles it (<code>e</code> above, <code>w'</code> below). You can extract it from your definition of <code>xpndD</code>:</p>\n\n<pre><code>xpndD rc ws = take 3 tW ++ [w']\n where\n  w' = zipWith xor (map sub w) [rc, 0, 0, 0]\n  tW = transpose ws\n  w  = take 4 $ tail $ cycle $ last tW\n</code></pre>\n\n<p>We get (modulo a purely cosmetic rewriting <code>take 4 $ tail $ cycle d = tail d ++ [head d]</code>):</p>\n\n<pre><code>schedule rc d = zipWith xor (map sub $ tail d ++ [head d]) [rc, 0, 0, 0]\n</code></pre>\n"}], "owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 43945863, "answer_count": 1, "score": 1, "last_activity_date": 1494628261, "creation_date": 1494614908, "last_edit_date": 1494617517, "question_id": 43944647, "link": "https://stackoverflow.com/questions/43944647/whats-wrong-with-this-haskell-aes-key-expansion", "title": "What&#39;s wrong with this Haskell AES key expansion?", "body": "<p>Following steps describing key expansion in <a href=\"http://www.moserware.com/2009/09/stick-figure-guide-to-advanced.html\" rel=\"nofollow noreferrer\">Jeff Moser's popular tutorial</a>, I've written this code for key expansion. Here is the entire file (which also computes the S-Box), so folks can compile and try it.</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport Control.Applicative (liftA2)\nimport Data.Bits (xor, shiftL, shiftR, (.|.), (.&amp;.))\nimport Data.List (transpose, sortBy)\nimport Data.Ord (comparing)\nimport Data.Word (Word8)\nimport Numeric (showHex)\n\nkeys = f 16 $ f 8 $ f 4 $ f 2 $ f 1 key\n where\n  f w n = xpndC . xpndB . xpndA $ xpndD w n\n\nxpndC   :: [[Word8]] -&gt; [[Word8]]\nxpndC ws = transpose [head ws, b, zipWith xor b c, last ws]\n where\n  (b,c) = (ws !! 1, ws !! 2)\n\nxpndB   :: [[Word8]] -&gt; [[Word8]]\nxpndB ws = a : zipWith xor a b : drop 2 ws\n where\n  (a,b) = (head ws, ws !! 1)\n\nxpndA   :: [[Word8]] -&gt; [[Word8]]\nxpndA ws = zipWith xor a d : tail ws\n where\n  (a,d) = (head ws, last ws)\n\nxpndD rc ws = take 3 tW ++ [w']\n where\n  w' = zipWith xor (map sub w) [rc, 0, 0, 0]\n  tW = transpose ws\n  w  = take 4 $ tail $ cycle $ last tW\n\n--------------------------------------------------------------\nsub w = get sbox (fromIntegral lo) $ fromIntegral hi\n where\n  (hi, lo) = nibs w\n\nget wss x y = (wss !! y) !! x\n\nprint' = print . w128 . concat . transpose\n where\n  w128 = concatMap (f . (`showHex` \"\"))\n  f w  = (length w &lt; 2) ? (' ':'0':w, ' ':w)\n\ngrid _ [] = []\ngrid n xs = take n xs : grid n (drop n xs)\n\nnibs w    = (shiftR (w .&amp;. 0xF0) 4, w .&amp;. 0x0F)\n(\u2295)       = xor\np ? (a,b) = if p then a else b; infix 2 ?\n\n---------------------------------------------------\nsbox :: [[Word8]]\nsbox = grid 16 $ map snd $ sortBy (comparing fst) $ sbx 1 1 []\n\nsbx :: Word8 -&gt; Word8 -&gt; [(Word8, Word8)] -&gt; [(Word8, Word8)]\nsbx p q ws\n  | length ws == 255 = (0, 0x63) : ws\n  | otherwise = sbx p' r $ (p', xf \u2295 0x63) : ws\n where\n  p' = p  \u2295  shiftL p  1 \u2295  ((p .&amp;. 0x80 /= 0) ? (0x1B, 0))\n  q1 = foldl (liftA2 (.) xor shiftL) q [1, 2, 4]\n  r  = q1 \u2295  ((q1 .&amp;. 0x80 /= 0) ? (0x09, 0))\n  xf = r  \u2295  rotl8 r 1 \u2295  rotl8 r 2 \u2295  rotl8 r 3 \u2295  rotl8 r 4\n\nrotl8 w n = (w `shiftL` n) .|. (w `shiftR` (8 - n))\n\nkey = [[0,0,0,0],\n       [0,0,0,0],\n       [0,0,0,0],\n       [0,0,0,0]] :: [[Word8]]\n</code></pre>\n\n<p>When I test this code against the all-zero test key, it matches the published expectation up to the fourth iteration: <code>ee 06 da 7b 87 6a 15 81 75 9e 42 b2 7e 91 ee 2b</code>.</p>\n\n<p>But when I try the next iteration: <code>keys = f 16 $ f 8 $ f 4 $ f 2 $ f 1</code>, \nthe last 32 bits of the result are wrong: <code>7f 2e 2b 88 f8 44 3e 09 8d da 7c bb 91 28 f1 f3</code>.</p>\n\n<p>The same behavior - last 32 bits wrong - happens when I use all 0xFF for the initial key. And in subsequent iterations, all the bits are wrong.</p>\n\n<p>If I use the test vector <code>00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f</code>, things go wrong much faster - I start getting wrong bits on the second iteration.</p>\n\n<p>What's going on here? I notice Mr. Moser wrote in part <em>2b : 4</em> to <code>xor</code> with the first column of the <em>previous round key</em> - but there is no previous round for the initial key, so this confused me. Is this what I've done wrong?</p>\n\n<p>For reference, <a href=\"http://www.samiam.org/key-schedule.html\" rel=\"nofollow noreferrer\">here are the test vectors.</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494625691, "post_id": 43944618, "comment_id": 74926685, "body": "If you have a <code>Base64</code> that <i>might</i> be present, why not use <code>Maybe Base64</code>? It doesn&#39;t add any additional overhead in the type signature as it would be hidden away in <code>data Session ... = MkSession ... (Maybe Base64) ...</code>. This is probably the most idiomatic solution for your specific case, but what is your general case where this doesn&#39;t work?"}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494626022, "post_id": 43944618, "comment_id": 74926790, "body": "My problem is that this doesn&#39;t add any typesafety over <code>error &quot;Keyfetch token missing&quot;</code>. If a function that requires it is called with Nothing there isn&#39;t any way to handle it. It is the equivalent of returning a Maybe for division because the developer might accidentally divide by zero."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494644755, "post_id": 43944618, "comment_id": 74930246, "body": "using a Maybe lets you define what the Nothing case means. If a function requires it is called with a <code>Just</code>, just use the type without a Maybe. If you decide to call it with a <code>Nothing</code>, you are forced to pattern match to make the types check."}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494659770, "post_id": 43944618, "comment_id": 74932675, "body": "This what I am currently doing for logging purposes but it doesn&#39;t add type safety. Lets look at the options. Value not required: Value isn&#39;t forced so we don&#39;t care whether it&#39;s missing. Value required&amp;there: We unwrap the maybe or use the possibly undefined value directly. Value required&amp;missing: Undefined is forced and crashes or we match Nothing and crash manually. See that Maybe doesn&#39;t add any safety over undefined in this case?"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494684326, "post_id": 43944618, "comment_id": 74939362, "body": "The type of a function that <i>needs</i> a <code>Base64</code> to work is <code>Base64 -&gt; &lt;whatever&gt;</code>. The type of a function that <i>optionally</i> needs a <code>Base64</code> to work is <code>Maybe Base64 -&gt; &lt;whatever&gt;</code>. The key is to <i>not crash manually</i>. If you don&#39;t want your program to crash, don&#39;t tell it to crash. You need to return an alternate value in case it is <code>Nothing</code>, or if the value in the <code>Just</code> is truly needed, then <code>Maybe Base64 -&gt; &lt;whatever&gt;</code> is <i>the wrong type</i> for your function."}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494684678, "post_id": 43944618, "comment_id": 74939463, "body": "As I tried to say, like, 4 times before: There is no alternative value I could give for Nothing. Getting in this situation is programmer error and there is no way to recover. Of course you would unwrap the maybe in the calling function but that just moves the potential crash somewhere else. Maybe is not enough to statically avoid this crash."}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1494693840, "post_id": 43955125, "comment_id": 74942338, "body": "Yeah, and that was basically what my question was about - I wasn&#39;t sure whether that additional complexity is worth it. For what its worth, <a href=\"https://gist.github.com/Tarmean/f3af813761dce27060195ebe8ccc169d\" rel=\"nofollow noreferrer\">this is how I tried to use this idea.</a>.  The type signatures ended up looking like <code>getAuthorization :: (IxMonadState m, MonadIO (m SessionWithoutToken SessionWithoutToken)) =&gt; m SessionWithToken SessionWithoutToken Auth</code>."}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 1, "last_activity_date": 1494691034, "creation_date": 1494691034, "answer_id": 43955125, "question_id": 43944618, "link": "https://stackoverflow.com/questions/43944618/encoding-protocol-in-types/43955125#43955125", "title": "Encoding protocol in types", "body": "<p>The solution here is to <strong>not lie with your types</strong>, and to use a restricted subset of Haskell which does not include bottom/undefined. </p>\n\n<p>What I mean by this is that your types should accurately represent what a value is. For example, your function <code>getAuthorization :: Session -&gt; IO Auth</code> is a lie because it says that</p>\n\n<pre><code>\u2200(s :: Session), (getAuthorization s :: IO Auth)\n</code></pre>\n\n<p>The important part is the \u2200 (forall). It tells you that <em>every single</em> <code>Session</code> maps to an <code>IO Auth</code>, which isn't true; <code>Session</code>s with a <code>_keyFetchToken</code> of <code>Nothing</code> do not map to a normal <code>IO Auth</code> value. (They map to <code>_|_</code>, which we are considering as not part of our restricted subset of Haskell)</p>\n\n<p>To fix this, you can more accurately model your <code>Session</code> as</p>\n\n<pre><code>data Session keyType = Session {..., _keyFetchToken :: keyType}\n</code></pre>\n\n<p>Now, <code>getAuthorization :: Session Base64 -&gt; IO Auth</code> is no longer lying; it will <em>always</em> map a <code>Session Base64</code> to an <code>IO Auth</code>. Now the problem is how to get a <code>Session Base64</code> from a <code>Session (Maybe Base64)</code>. This is the step that will force you to have a base case (recovery) for your <code>Nothing</code>. If having <code>Nothing</code> is <em>always an unrecoverable error</em>, then don't have <code>Nothing</code> in the first place, and just crash, since there is literally nothing else to do because the error is unrecoverable.</p>\n"}], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 43955125, "answer_count": 1, "score": 1, "last_activity_date": 1494691034, "creation_date": 1494614762, "last_edit_date": 1494685581, "question_id": 43944618, "link": "https://stackoverflow.com/questions/43944618/encoding-protocol-in-types", "title": "Encoding protocol in types", "body": "<p>While writing some web request code I noticed that I didn't have a clear understanding of how much strict typing is considered good practice in haskell.<br>\nFirst off examples:</p>\n\n<ul>\n<li>A session may contain a one use keyFetch token</li>\n<li>Hawk is used for message authentication but the message hash is encoded in hex or base64 depending on the endpoint</li>\n</ul>\n\n<p>Notably sum types don't solve either of these problems since a invalid state always means programmer error and the only way to handle this is crashing anyway. I see two ways to deal with this:</p>\n\n<ul>\n<li>Less typing - functions that require the keyFetch token are partial and error if it is missing, the message hash is encoded as ByteString without any newtype wrappers</li>\n<li>More typing - the Session/Authentication adt's are parametrized over their contained types. So <code>Session' () ...</code> is a session without keyFetch token, <code>Session' Base64 ...</code> is a session with one</li>\n</ul>\n\n<p>So obviously either of these approaches has drawbacks. It is pretty easy to forget some edge case or handle data wrongly without additional type checks.<br>\nHowever parametrizing types comes with some pretty heavy usability costs. Type aliases make the code itself look decent but they don't necessarily help with compiler errors. It would also be nice to put the session into a state monad but the changing type would require indexed monads plus RebindableSyntax which seems pretty heavy handed.</p>\n\n<p>This is roughly what the less typing version looks like:</p>\n\n<pre><code>fetchKey :: Base64 -&gt; IO PrivateKey\nfetchKey = undefined\n\ndata Session = Session\n             { _uid :: Base64\n             , _keyFetchToken :: Maybe Base64\n             -- ...\n             }\n\ngetAuthorization :: Session -&gt; IO Auth\ngetAuthorization session = case session ^. keyFetchToken of\n    Just token -&gt; ... (fetchKey token)\n    Nothing -&gt; throw MissingKeyFetchToken -- No way to recover\n</code></pre>\n\n<p>Question time: Is there a community consensus on how to deal with such slightly dynamic situations?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494612815, "post_id": 43944044, "comment_id": 74920838, "body": "Could you make your type an instance of <code>Data</code>?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1494613704, "post_id": 43944044, "comment_id": 74921342, "body": "You&#39;re making an assumption about operational aspects of the compiler implementation when you say that your example is &quot;linear&quot;. GHC for instance expands the case on tuple to nested cases, which in turn will be compiled to either a jump table or binary search"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1494613764, "post_id": 43944044, "comment_id": 74921382, "body": "It&#39;s linear in number of lines of code that must be written, without making any assumptions about GHC."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1494617504, "post_id": 43944044, "comment_id": 74923215, "body": "@amalloy ah yeah I guess that&#39;s a better interpretation of what op meant"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 4, "creation_date": 1494686085, "post_id": 43944044, "comment_id": 74939927, "body": "I guess you&#39;re trying to keep it simple, but it strikes me that returning a <code>Bool</code> from such a test is underpowered. It&#39;s interesting to consider how to extract from a positive outcome the useful information that the constructor arguments can be paired up."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 6, "creation_date": 1494613555, "post_id": 43944191, "comment_id": 74921268, "body": "<code>sameCons :: Data a =&gt; a -&gt; a -&gt; Bool; sameCons = (==) `on` toConstr</code>"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 6, "last_activity_date": 1494613153, "creation_date": 1494613153, "answer_id": 43944191, "question_id": 43944044, "link": "https://stackoverflow.com/questions/43944044/checking-that-two-values-have-the-same-head-constructor/43944191#43944191", "title": "Checking that two values have the same head constructor", "body": "<p>If you're willing to derive <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Data.html#t:Data\" rel=\"noreferrer\"><code>Data</code></a> then you're good to go.</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\n\nimport Data.Data\n\ndata E = A Int | B String | C deriving (Typeable, Data)\n\nsameCons :: E -&gt; E -&gt; Bool\nsameCons x y = toConstr x == toConstr y\n\nghci&gt; sameCons (A 1) (A 3)\nTrue\nghci&gt; sameCons (A 1) (C)\nFalse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 3, "last_activity_date": 1494615152, "creation_date": 1494615152, "answer_id": 43944711, "question_id": 43944044, "link": "https://stackoverflow.com/questions/43944044/checking-that-two-values-have-the-same-head-constructor/43944711#43944711", "title": "Checking that two values have the same head constructor", "body": "<p>You can also do this with <code>GHC.Generics</code>, but it's more boilerplate than The Orgazoid's answer.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TypeOperators #-}\n\nimport Data.Function (on)\nimport GHC.Generics\n\nclass GSameCons f where\n  gSameCons :: f p -&gt; f p -&gt; Bool\n\ninstance GSameCons f =&gt; GSameCons (D1 c f) where\n  gSameCons (M1 a) (M1 b) = gSameCons a b\n\ninstance (GSameCons f, GSameCons g) =&gt; GSameCons (f :+: g) where\n  gSameCons (L1 a) (L1 b) = gSameCons a b\n  gSameCons (R1 a) (R1 b) = gSameCons a b\n  gSameCons _ _ = False\n\ninstance GSameCons (C1 c f) where\n  gSameCons _ _ = True\n\ndata E = A Int | B String | C deriving Generic\n\nsameCons :: (GSameCons (Rep a), Generic a) =&gt; a -&gt; a -&gt; Bool\nsameCons = gSameCons `on` from\n\nmain = do\n  print (sameCons (A 1) (A 2))\n  print (sameCons (B \"\") C)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 0, "last_activity_date": 1546683836, "creation_date": 1546683836, "answer_id": 54051039, "question_id": 43944044, "link": "https://stackoverflow.com/questions/43944044/checking-that-two-values-have-the-same-head-constructor/54051039#54051039", "title": "Checking that two values have the same head constructor", "body": "<p>We ended up needing a datatype of constructor names anyway so here is our current solution which does not rely on <code>Data</code> or <code>GHC.Generics</code>:</p>\n\n<pre><code>data E = A Int | B String | C\ndata EName = A_ | B_ | C_ deriving (Eq)\n\neName :: E -&gt; EName\neName e = case e of\n  A{} -&gt; A_\n  B{} -&gt; B_\n  C{} -&gt; C_\n\nsameCons :: E -&gt; E -&gt; Bool\nsameCons = (==) `on` eName\n</code></pre>\n"}], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 2, "accepted_answer_id": 43944191, "answer_count": 3, "score": 6, "last_activity_date": 1546683836, "creation_date": 1494612611, "question_id": 43944044, "link": "https://stackoverflow.com/questions/43944044/checking-that-two-values-have-the-same-head-constructor", "title": "Checking that two values have the same head constructor", "body": "<p>I'd like to be able to write a function which checks that two values have been built using the same head constructor. This function:</p>\n\n<ul>\n<li><p>shouldn't be linear in the size of the datatype declaration</p></li>\n<li><p>should keep working if the datatype is extended</p></li>\n</ul>\n\n<p>e.g. this is not satisfactory (it is linear and the catchall will invalidate the function if I add any extra constructor):</p>\n\n<pre><code>data E = A Int | B String | C\n\nsameCons :: E -&gt; E -&gt; Bool\nsameCons t u = case (t, u) of\n  (A{}, A{}) -&gt; True\n  (B{}, B{}) -&gt; True\n  (C{}, C{}) -&gt; True\n  _          -&gt; False\n</code></pre>\n\n<p>In OCaml <a href=\"https://stackoverflow.com/questions/6522360/how-to-check-whether-two-values-are-created-with-the-same-constructor/6528149#6528149\">it is possible</a> to use unsafe functions from the <code>Obj</code> module to do exactly that. Can we do something similar in Haskell (a ghc-specific solution works too)?</p>\n"}, {"tags": ["haskell", "rank-n-types"], "answers": [{"comments": [{"owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "edited": false, "score": 0, "creation_date": 1494624298, "post_id": 43946358, "comment_id": 74926229, "body": "If my understanding is correct, <code>Maybe a</code> is a polymorphic type as well, so, taking the documentation example, <code>id (undefined :: Maybe a)</code> should be rejected as it calls for impredicative polymorphism, yet it&#39;s accepted (and we quite expect it to be accepted). Does the documentation miss some explanation on a subclass of polymorphic types that cause this, or am I missing something?"}, {"owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "edited": false, "score": 0, "creation_date": 1494624545, "post_id": 43946358, "comment_id": 74926319, "body": "Yes, after some further experiments <code>id (undefined :: (forall a. Maybe a) -&gt; Int)</code> gets rejected, while enabling <code>ImpredicativeTypes</code> makes the typechecker accept it. So I assume only Rank-N types for N &gt; 1 cause impredicative polymorphism. Is that reasonable?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "edited": false, "score": 2, "creation_date": 1494626429, "post_id": 43946358, "comment_id": 74926900, "body": "@0xd34df00d It&#39;s tricky, but in <code>id (undefined :: Maybe a)</code> the polymorphic type is first instantiated with a fresh type variable and then passed to <code>id</code>, so that impredicative polymorphism is not required. Or at least I&#39;d guess so -- check the Core if you want to be sure."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 2, "last_activity_date": 1494622675, "creation_date": 1494622675, "answer_id": 43946358, "question_id": 43943793, "link": "https://stackoverflow.com/questions/43943793/function-composition-and-foralled-types/43946358#43946358", "title": "Function composition and forall&#39;ed types", "body": "<blockquote>\n  <p>Instantiating polymorphic type variables with polymorphic types is called impredicative polymorphism. -- <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#impredicative-polymorphism\" rel=\"nofollow noreferrer\">GHC user guide</a></p>\n</blockquote>\n\n<p>As the error message indicates, GHC only allows a type variable to be instantiated with a monomorphic, rank 0 type. My guess is that type checking with impredicative polymorphism is trickier to implement than it may seem.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 6, "last_activity_date": 1494666554, "last_edit_date": 1494666554, "creation_date": 1494653907, "answer_id": 43949620, "question_id": 43943793, "link": "https://stackoverflow.com/questions/43943793/function-composition-and-foralled-types/43949620#43949620", "title": "Function composition and forall&#39;ed types", "body": "<p>Just to be clear, when you write:</p>\n\n<pre><code>_pa :: PA a -&gt; A a\n</code></pre>\n\n<p>The compiler expands the type synonyms and then moves the quantifiers and constraints upward, like so:</p>\n\n<pre><code>_pa\n  :: forall a.\n     (forall m1. Monad m1 =&gt; Foo a -&gt; m1 ())\n  -&gt; (forall m2. Monad m2 =&gt; Foo a -&gt; m2 ())\n\n_pa\n  :: forall m2 a. (Monad m2)\n  =&gt; (forall m1. Monad m1 =&gt; Foo a -&gt; m1 ())\n  -&gt; Foo a -&gt; m2 ()\n</code></pre>\n\n<p>So <code>_pa</code> has a rank-2 polymorphic type, because it has a forall nested to the left of a function arrow. Same goes for <code>_pfa</code>. They expect polymorphic functions as arguments.</p>\n\n<p>To answer the actual question, I\u2019ll first show you something strange. These both typecheck:</p>\n\n<pre><code>_pp :: PPFA a -&gt; A a\n_pp x = _pa $ _pfa x\n\n_pp :: PPFA a -&gt; A a\n_pp x = _pa (_pfa x)\n</code></pre>\n\n<p>This, however, does not:</p>\n\n<pre><code>apply :: (a -&gt; b) -&gt; a -&gt; b\napply f x = f x\n\n_pp :: PPFA a -&gt; A a\n_pp x = apply _pa (_pfa x)\n</code></pre>\n\n<p>Unintuitive, right? This is because the application operator <code>($)</code> is special-cased in the compiler to allow instantiating its type variables with polymorphic types, in order to support <code>runST $ do { \u2026 }</code> rather than <code>runST (do { \u2026 })</code>.</p>\n\n<p>Composition <code>(.)</code>, however, is not special-cased. So when you call <code>(.)</code> on <code>_pa</code> and <code>_pfa</code>, it instantiates their types first. Thus you end up trying to pass the <em>non-polymorphic</em> result of <code>_pfa</code>, of the type <code>(Foo a0 -&gt; m0 ()) -&gt; Foo a -&gt; m ()</code> mentioned in your error message, to the function <code>_pa</code>, but it expects a polymorphic argument of type <code>P a</code>, so you get a unification error.</p>\n\n<p><code>undefined :: a</code> doesn\u2019t typecheck because it tries to instantiate <code>a</code> with a polymorphic type, an instance of impredicative polymorphism. That\u2019s a hint as to what you should do\u2014the standard way of hiding impredicativity is with a <code>newtype</code> wrapper:</p>\n\n<pre><code>newtype A a = A { unA :: forall m. Monad m =&gt; Foo a -&gt; m () }\nnewtype PA a = PA { unPA :: forall m. Monad m =&gt; Foo a -&gt; m () }\nnewtype PPFA a = PPFA { unPPFA :: forall m. Monad m =&gt; Foo a -&gt; m () }\n</code></pre>\n\n<p>Now this definition compiles without error:</p>\n\n<pre><code>_pp :: PPFA a -&gt; A a\n_pp = _pa . _pfa\n</code></pre>\n\n<p>With the cost that you need to explicitly wrap and unwrap to tell GHC when to abstract and instantiate:</p>\n\n<pre><code>_pa :: PA a -&gt; A a\n_pa x = A (unPA x)\n</code></pre>\n"}], "owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 43949620, "answer_count": 2, "score": 6, "last_activity_date": 1494666554, "creation_date": 1494611546, "last_edit_date": 1494635764, "question_id": 43943793, "link": "https://stackoverflow.com/questions/43943793/function-composition-and-foralled-types", "title": "Function composition and forall&#39;ed types", "body": "<p>Let's say we have some code like this, which typechecks just fine:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE RankNTypes #-}\n\ndata Foo a\n\ntype A a = forall m. Monad m =&gt; Foo a -&gt; m ()\ntype PA a = forall m. Monad m =&gt; Foo a -&gt; m ()\ntype PPFA a = forall m. Monad m =&gt; Foo a -&gt; m ()\n\n_pfa :: PPFA a -&gt; PA a\n_pfa = _pfa\n\n_pa :: PA a -&gt; A a\n_pa = _pa\n\n_pp :: PPFA a -&gt; A a\n_pp x = _pa $ _pfa x\n\nmain :: IO ()\nmain = putStrLn \"yay\"\n</code></pre>\n\n<p>We note that <code>_pp x = _pa $ _pfa x</code> is too verbose, and we try to replace it with <code>_pp = _pa . _pfa</code>. Suddenly the code doesn't typecheck anymore, failing with error messages similar to</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Foo a0 -&gt; m0 ()\u2019 with \u2018PA a\u2019\n  Expected type: (Foo a0 -&gt; m0 ()) -&gt; Foo a -&gt; m ()\n    Actual type: PA a -&gt; A a\n</code></pre>\n\n<p>I guess this is due to <code>m</code> in the definition of type aliases being <code>forall</code>'d &mdash; indeed, replacing <code>m</code> with some exact type fixes the issue. But the question is: why does <code>forall</code> break things in this case?</p>\n\n<p>Bonus points for trying to figure out why replacing dummy recursive definitions of <code>_pfa</code> and <code>_pa</code> with usual <code>_pfa = undefined</code> results in GHC complaining about unification variables and impredicative polymorphism:</p>\n\n<pre><code>\u2022 Cannot instantiate unification variable \u2018a0\u2019\n  with a type involving foralls: PPFA a -&gt; Foo a -&gt; m ()\n    GHC doesn't yet support impredicative polymorphism\n\u2022 In the expression: undefined\n  In an equation for \u2018_pfa\u2019: _pfa = undefined\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "state-monad"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1494609802, "post_id": 43942629, "comment_id": 74919109, "body": "Did you import <code>Control.Monad.Trans.State</code>? Or <code>Control.Monad.State</code>? The first defines <code>get :: Monad m =&gt; StateT s m s</code>, the latter <code>get :: MonadState s m =&gt; m s</code>, and only the latter works in this context."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494610940, "post_id": 43942629, "comment_id": 74919769, "body": "Also, you want just <code>foo = get</code>. Putting in <code>return ()</code> throws away the state you got!"}, {"owner": {"reputation": 1082, "user_id": 4256283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2dc2b4976c7421d83d6f34770bc36046?s=128&d=identicon&r=PG&f=1", "display_name": "Jytug", "link": "https://stackoverflow.com/users/4256283/jytug"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494612646, "post_id": 43942629, "comment_id": 74920746, "body": "@Zeta yes, this seems to be the problem. Removing the <code>Trans</code> from the import does the trick, thanks!"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494619939, "post_id": 43942629, "comment_id": 74924308, "body": "Please add the <code>import \u2026</code> line to your question, as comments can get deleted at any time, and without the <code>import</code> it&#39;s not answerable."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494651697, "post_id": 43942629, "comment_id": 74931187, "body": "@Jytug, see also <a href=\"https://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Class.html#v:lift\" rel=\"nofollow noreferrer\"><code>lift</code></a> which is closer to what&#39;s really going on -- the <code>Control.Monad.State</code> thing is kind of a &quot;trick&quot;.  You use <code>lift</code> to get at the inner layers of a transformer stack, for example: <code>state &lt;- lift get</code>.  This works with both modules."}], "owner": {"reputation": 1082, "user_id": 4256283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2dc2b4976c7421d83d6f34770bc36046?s=128&d=identicon&r=PG&f=1", "display_name": "Jytug", "link": "https://stackoverflow.com/users/4256283/jytug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494607135, "creation_date": 1494607135, "question_id": 43942629, "link": "https://stackoverflow.com/questions/43942629/getting-state-in-a-stateful-monad-supporting-exceptions", "title": "Getting state in a stateful monad supporting exceptions", "body": "<p>I'm trying to figure out how to solve the following problem:\nI want a monad that behaves like <code>State</code> and <code>Except</code>, so I wrote something like this:</p>\n\n<pre><code>type ExceptStateM s m a = ExceptT String (StateT s m) a\n</code></pre>\n\n<p>Suppose we don't want to wrap another monad and the state is an <code>Int</code>, so we get a monad like this:</p>\n\n<pre><code>type MyMonad a = ExceptStateM Int Identity\n</code></pre>\n\n<p>What I'm wondering now is how to get the state from this monad, because the following code:</p>\n\n<pre><code>foo :: MyMonad Int\nfoo = do\n    state &lt;- get\n    return ()\n</code></pre>\n\n<p>doesn't compile, with the following error:</p>\n\n<pre><code>Couldn't match expected type \u2018ExceptT\n                                String (StateT Int Identity) t0\u2019\n            with actual type \u2018StateT s0 m0 s0\u2019\nIn a stmt of a 'do' block: state &lt;- get\nIn the expression:\n  do { state &lt;- get;\n       return () }\n</code></pre>\n\n<p>I would appreciate some hints on where to look</p>\n"}, {"tags": ["haskell", "dictionary", "input", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7984871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8ec6b3a36339d43c281417ed0f19f2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Tmr", "link": "https://stackoverflow.com/users/7984871/j-tmr"}, "edited": false, "score": 0, "creation_date": 1494614217, "post_id": 43943765, "comment_id": 74921631, "body": "Thanks, but I&#39;m getting the exception that the Index is too large whenever I try to translate a word. &quot;*** Exception: Prelude.!!: index too large&quot; I probably didn&#39;t implement your code correctly at what place should I put it? and is there maybe a way to do it with tuples so I don&#39;t need the !! Index?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 87, "user_id": 7984871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8ec6b3a36339d43c281417ed0f19f2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Tmr", "link": "https://stackoverflow.com/users/7984871/j-tmr"}, "edited": false, "score": 2, "creation_date": 1494616654, "post_id": 43943765, "comment_id": 74922792, "body": "Oh, it&#39;s reading some line that doesn&#39;t contain a tuple (perhaps the end line). I&#39;ll update."}, {"owner": {"reputation": 87, "user_id": 7984871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8ec6b3a36339d43c281417ed0f19f2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Tmr", "link": "https://stackoverflow.com/users/7984871/j-tmr"}, "edited": false, "score": 0, "creation_date": 1494621406, "post_id": 43943765, "comment_id": 74925008, "body": "Thanks alot now I&#39;ve got it."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1494616710, "last_edit_date": 1494616710, "creation_date": 1494611437, "answer_id": 43943765, "question_id": 43942490, "link": "https://stackoverflow.com/questions/43942490/haskell-trying-to-translate-an-input-word-from-a-given-dictionary/43943765#43943765", "title": "Haskell, trying to translate an input word from a given dictionary", "body": "<blockquote>\n  <p>I understand that elem is for Lists so I need an alternative</p>\n</blockquote>\n\n<p>You could use <a href=\"http://book.realworldhaskell.org/read/data-structures.html\" rel=\"nofollow noreferrer\"><code>Map.fromList</code></a> to create a balanced-tree dictionary - <a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Map.html\" rel=\"nofollow noreferrer\"><code>Data.Map</code></a>. Specifically, </p>\n\n<pre><code>import qualified Data.Map as Map \n\nmain = do\n    contents &lt;- readFile \"woerterbuch.txt\"\n    let ls = lines contents\n    let ws = fmap words ls\n    let m = Map.fromList [(t!!0, t!!1) | t &lt;- ws, length t == 2]           \n    ...\n</code></pre>\n\n<p>lets you use <code>m</code> as a dictionary.</p>\n"}], "owner": {"reputation": 87, "user_id": 7984871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8ec6b3a36339d43c281417ed0f19f2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Tmr", "link": "https://stackoverflow.com/users/7984871/j-tmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 43943765, "answer_count": 1, "score": 1, "last_activity_date": 1494616710, "creation_date": 1494606601, "last_edit_date": 1494608446, "question_id": 43942490, "link": "https://stackoverflow.com/questions/43942490/haskell-trying-to-translate-an-input-word-from-a-given-dictionary", "title": "Haskell, trying to translate an input word from a given dictionary", "body": "<p>Hey I'm just getting started with Haskell and I'm trying to write a programm that translates an input word by reading a .txt file that has some translations in it. Before that I've written a programm that lets a user put in translations.</p>\n\n<pre><code>import System.IO\n\nmain :: IO ()\nmain = do\n  putStrLn \"Type in an english word\"\n  d &lt;- getLine\n  if null d\n      then return ()\n      else do\n            putStrLn \"Type in a german translation\"\n            b &lt;- getLine\n            putStrLn (d ++ \" means in german \" ++ b)\n            appendFile \"woerterbuch.txt\" (\", \" ++ d ++ \" \" ++ b)\n            main\n</code></pre>\n\n<p>So now I've got the file woerterbuch.txt in which I have the english and german words listed like this: Hello Hallo, House Haus, ect.\nWhat I'm trying to do now is to get these words into Tuples so I can print the second (german) word if the user types in an english word.</p>\n\n<pre><code>import System.IO\n\n    main :: IO()\n    main = do\n      putStrLn \"Type in an english word\"\n      d &lt;- getLine\n      [contents] &lt;- readFile \"woerterbuch.txt\"\n      if d `elem` [contents]\n          then do\n            print contents\n          else do\n                  putStrLn \"There's no translation available!\"\n</code></pre>\n\n<p>This is what I've come up with after multiple tries, I understand that <code>elem</code> is for Lists so I need an alternative for my .txt file and then try to put out the second word of the tuple with the <code>snd</code> command.\nSo firstly how can I create the translations input as tuples and secondly how can I test if the asked word is in this list and then print out the second element of the tuple it is part of.\nAny help would be greatly appreciated.</p>\n"}, {"tags": ["haskell", "data-structures", "purely-functional", "difference-lists"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1494604737, "post_id": 43941551, "comment_id": 74916311, "body": "I&#39;d expect this would be impossible. To have a fast append at the front and at the end you need two pointers, roughly. in dlists, the pointer to the closure provides for the front, and the lambda-abstracted variable roughly provides the pointer to the end. If you only use node-based stuff, you have trees, at best, and you can&#39;t achieve the same performance, I guess. However, keep in mind that 2-3 finger trees have an impressively good amortized performance (see <code>Data.Sequence</code>)."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494605202, "post_id": 43941551, "comment_id": 74916590, "body": "@chi Thanks for the pointer of 2-3 finger trees! Will read up on them."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1494608595, "post_id": 43941551, "comment_id": 74918444, "body": "You actually can do this with a data structure: <code>data DList a = Empty | Single a | Append (DList a) (DList a)</code> will give the same asymoptotics for <code>cons</code>, <code>snoc</code>, <code>append</code>, and <code>toList</code>. I don&#39;t have time to write up a full answer now, though, and I&#39;m sure you could find a better representation if you desire."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494609134, "post_id": 43941551, "comment_id": 74918734, "body": "@carl Thanks, that sounds correct. Appreciate it."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494609555, "post_id": 43941551, "comment_id": 74918995, "body": "@Carl I don&#39;t think that&#39;s true. <code>toList</code>-ing a left-associative sequence of <code>Append</code>s will be just as slow as evaluating a left-associative sequence of <code>(++)</code>s."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494610533, "post_id": 43941551, "comment_id": 74919512, "body": "You can write an O(m + n) <code>toList</code> for that. You just need to never use <code>(++) </code>, which means traversing back-to-front with an accumulator."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494610799, "post_id": 43941551, "comment_id": 74919672, "body": "@Carl ...and then you&#39;ve written <code>DList</code> :)"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494610833, "post_id": 43941551, "comment_id": 74919703, "body": "You do need to work with CPS representation of the result to recover laziness in <code>toList</code>, though. So.. There is that."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494610905, "post_id": 43941551, "comment_id": 74919748, "body": "Well, no. You can write a non-lazy <code>toList</code> without ever touching a CPS representation. You only need CPS to recover laziness."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494610994, "post_id": 43941551, "comment_id": 74919806, "body": "@Carl I just meant &quot;right to left with an accumulator&quot; is exactly the evaluation strategy which <code>DList</code> implements"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494611780, "post_id": 43941551, "comment_id": 74920289, "body": "In the presence of laziness, <code>DList</code> uses a left-to-right evaluation strategy that uses an implicit continuation for the rest of the output instead of an accumulator."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494612738, "post_id": 43941551, "comment_id": 74920795, "body": "@TheOrgazoid Well, no, Carl&#39;s proposed tree-like <code>data DList a</code> isn&#39;t yet the real <code>DList</code>, because it hasn&#39;t yet had the deforestation optimization applied. (Which is a pretty good way to understand how <code>DList</code> came to be the way it is, actually: you start with Carl&#39;s implementation, then apply some optimizations.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1494619007, "post_id": 43941551, "comment_id": 74923913, "body": "@DanielWagner I&#39;ve added a simple solution with a similar, though different type than Carl&#39;s. the &quot;deforestation&quot; isn&#39;t done in full, but rather partially, minimally, only as much as needed to ensure the O(1) amortized access, whatever the sequence of appends a user performed to create the dlist thing."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1583227311, "post_id": 43941551, "comment_id": 107035746, "body": "find &quot;defunctionalized difference list&quot; <a href=\"https://cstheory.stackexchange.com/questions/2432/difference-lists-in-functional-programming\">here</a> and elsewhere."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494612636, "post_id": 43943108, "comment_id": 74920738, "body": "Does this actually answer the question somewhere?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494613380, "post_id": 43943108, "comment_id": 74921167, "body": "@DanielWagner If you interpret the question as &quot;Can I write a list-shaped datatype with efficient <i>left-nested</i> concatenation?&quot; then yes - that&#39;s <code>Snoc</code>. Granted, that&#39;s a rather generous interpretation of the question. So, um, no, not really. :)"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 3, "last_activity_date": 1494610512, "last_edit_date": 1494610512, "creation_date": 1494608978, "answer_id": 43943108, "question_id": 43941551, "link": "https://stackoverflow.com/questions/43941551/explicit-purely-functional-data-structure-for-difference-lists/43943108#43943108", "title": "Explicit Purely-Functional Data-Structure For Difference Lists", "body": "<p><code>(++)</code>'s notoriously bad asymptotics come about when you use it in a left-associative manner - that is, when <code>(++)</code>'s left argument is the result of another call to <code>(++)</code>. Right-associative expressions run efficiently, though.</p>\n\n<p>To put it more concretely: evaluating a left-nested append of <code>m</code> lists like</p>\n\n<pre><code>((ws ++ xs) ++ ys) ++ zs  -- m = 3 in this example\n</code></pre>\n\n<p>to WHNF requires you to force <code>m</code> thunks, because <code>(++)</code> is strict in its left argument.</p>\n\n<pre><code>case (\n    case (\n        case ws of { [] -&gt; xs ; (w:ws) -&gt; w:(ws ++ xs) }\n    ) of { [] -&gt; ys ; (x:xs) -&gt; x:(xs ++ ys) }\n) of { [] -&gt; zs ; (y:ys) -&gt; y:(ys ++ zs) }\n</code></pre>\n\n<p>In general, to fully evaluate <code>n</code> elements of such a list, this'll require forcing that stack of <code>m</code> thunks <code>n</code> times, for O(m*n) complexity. When the entire list is built from appends of singleton lists (ie <code>(([w] ++ [x]) ++ [y]) ++ [z]</code>), <code>m = n</code> so the cost is O(n<sup>2</sup>).</p>\n\n<p>Evaluating a right-nested append like</p>\n\n<pre><code>ws ++ (xs ++ (ys ++ zs))\n</code></pre>\n\n<p>to WHNF is much easier (O(1)):</p>\n\n<pre><code>case ws of\n    [] -&gt; xs ++ (ys ++ zs)\n    (w:ws) -&gt; w:(ws ++ (xs ++ (ys ++ zs)))\n</code></pre>\n\n<p>Evaluating <code>n</code> elements just requires evaluating <code>n</code> thunks, which is about as good as you can expect to do.</p>\n\n<hr>\n\n<p>Difference lists work by paying a small (O(m)) up-front cost to automatically <em>re-associate calls to <code>(++)</code></em>.</p>\n\n<pre><code>newtype DList a = DList ([a] -&gt; [a])\nfromList xs = DList (xs ++)\ntoList (DList f) = f []\n\ninstance Monoid (DList a) where\n    mempty = fromList []\n    DList f `mappend` DList g = DList (f . g)\n</code></pre>\n\n<p>Now a left-nested expression,</p>\n\n<pre><code>toList (((fromList ws &lt;&gt; fromList xs) &lt;&gt; fromList ys) &lt;&gt; fromList zs)\n</code></pre>\n\n<p>gets evaluated in a right-associative manner:</p>\n\n<pre><code>((((ws ++) . (xs ++)) . (ys ++)) . (zs ++)) []\n\n-- expand innermost (.)\n(((\\l0 -&gt; ws ++ (xs ++ l0)) . (ys ++)) . (zs ++)) []\n\n-- expand innermost (.)\n((\\l1 -&gt; (\\l0 -&gt; ws ++ (xs ++ l0)) (ys ++ l1)) . (zs ++)) []\n-- beta reduce\n((\\l1 -&gt; ws ++ (xs ++ (ys ++ l1))) . (zs ++)) []\n\n-- expand innermost (.)\n(\\l2 -&gt; (\\l1 -&gt; ws ++ (xs ++ (ys ++ l1))) (zs ++ l2)) []\n-- beta reduce\n(\\l2 -&gt; ws ++ (xs ++ (ys ++ (zs ++ l2)))) []\n-- beta reduce\nws ++ (xs ++ (ys ++ (zs ++ [])))\n</code></pre>\n\n<p>You perform O(m) steps to evaluate the composed function, then O(n) steps to evaluate the resulting expression, for a total complexity of O(m+n), which is asymptotically better than O(m*n). When the list is made up entirely of appends of singleton lists, <code>m = n</code> and you get O(2n) ~ O(n), which is asymptotically better than O(n<sup>2</sup>).</p>\n\n<p>This trick works for any <code>Monoid</code>.</p>\n\n<pre><code>newtype RMonoid m = RMonoid (m -&gt; m)  -- \"right-associative monoid\"\ntoRM m = RMonoid (m &lt;&gt;)\nfromRM (RMonoid f) = f mempty\ninstance Monoid m =&gt; Monoid (RMonoid m):\n    mempty = toRM mempty\n    RMonoid f `mappend` RMonoid g = RMonoid (f . g)\n</code></pre>\n\n<p>See also, for example, <a href=\"https://hackage.haskell.org/package/kan-extensions-5.0.2/docs/Control-Monad-Codensity.html\" rel=\"nofollow noreferrer\">the Codensity monad</a>, which applies this idea to monadic expressions built using <code>(&gt;&gt;=)</code> (rather than monoidal expressions built using <code>(&lt;&gt;)</code>).</p>\n\n<hr>\n\n<p>I hope I have convinced you that <code>(++)</code> only causes a problem when used in a left-associative fashion. Now, you can easily write a list-like data structure for which append is strict in its <em>right</em> argument, and left-associative appends are therefore not a problem.</p>\n\n<pre><code>data Snoc a = Nil | Snoc (Snoc a) a\n\nxs +++ Nil = xs\nxs +++ (Snoc ys y) = Snoc (xs +++ ys) y\n</code></pre>\n\n<p>We recover O(1) WHNF of left-nested appends,</p>\n\n<pre><code>((ws +++ xs) +++ ys) +++ zs\n\ncase zs of\n    Nil -&gt; (ws +++ xs) +++ ys\n    Snoc zs z -&gt; Snoc ((ws +++ xs) +++ ys) +++ zs) z\n</code></pre>\n\n<p>but at the expense of slow right-nested appends.</p>\n\n<pre><code>ws +++ (xs +++ (ys +++ zs))\n\ncase (\n    case (\n        case zs of { Nil -&gt; ys ; (Snoc zs z) -&gt; Snoc (ys +++ zs) z }\n    ) of { Nil -&gt; xs ; (Snoc ys y) -&gt; Snoc (xs +++ ys) y }\n) of { Nil -&gt; ws ; (Snoc xs x) -&gt; Snoc (ws +++ xs) y }\n</code></pre>\n\n<p>Then, of course, you end up writing a new type of difference list which reassociates appends to the left!</p>\n\n<pre><code>newtype LMonoid m = LMonoid (m -&gt; m)  -- \"left-associative monoid\"\ntoLM m = LMonoid (&lt;&gt; m)\nfromLM (LMonoid f) = f mempty\ninstance Monoid m =&gt; Monoid (LMonoid m):\n    mempty = toLM mempty\n    LMonoid f `mappend` LMonoid g = LMonoid (g . f)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1494619296, "post_id": 43945275, "comment_id": 74924038, "body": "Many thanks - this looks simple (in the positive sense) and good."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1494619424, "post_id": 43945275, "comment_id": 74924091, "body": "this just is doing exactly what is happening implicitly with the (.)-based dlists. Nothing more, nothing less. :)"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1494619464, "post_id": 43945275, "comment_id": 74924103, "body": "I expect you&#39;re right - still studying this language, though. Thanks for pointing this out."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1494619604, "post_id": 43945275, "comment_id": 74924173, "body": "do check out the linked answer, it&#39;s canonical. (and maybe, <i>its</i> linked questions)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1494619608, "post_id": 43945275, "comment_id": 74924175, "body": "Yes, your type is a bit simpler to work with, but I think Carl&#39;s mimics the <code>DList</code> representation a bit more closely. I&#39;ve added a note to my answer mentioning the deconstruction issue."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494622093, "post_id": 43945275, "comment_id": 74925317, "body": "FWIW, even the DList on Hackage doesn&#39;t claim <code>tail</code> is O(1)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494622186, "post_id": 43945275, "comment_id": 74925362, "body": "@DanielWagner &quot;<i>after which</i> it becomes...&quot; so, it is amortized, obviously."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1494622548, "post_id": 43945275, "comment_id": 74925511, "body": "@dfeuer the question is the efficiency and laziness of <code>fromList</code> + repeated appends in whatever order. which is trivially clear with this representation."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1494638647, "post_id": 43945275, "comment_id": 74929349, "body": "For what it&#39;s worth, I like this representation better than the one I suggested. :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1536853211, "post_id": 43945275, "comment_id": 91581795, "body": "and <code>last</code> can be implemented so that it successfully returns <code>0</code> for <code>Append (Append (List [1]) (List [2..])) (List [0])</code>. see also <a href=\"http://comonad.com/reader/2015/free-monoids-in-haskell/\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1571253015, "post_id": 43945275, "comment_id": 103182597, "body": "later note: of course <code>head</code> and <code>tail</code> should be done together, as <code>unCons :: Dlist a -&gt; Maybe (a, Dlist a)</code>, to get the rearranged tail at the same time as the head."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1597410070, "last_edit_date": 1597410070, "creation_date": 1494617773, "answer_id": 43945275, "question_id": 43941551, "link": "https://stackoverflow.com/questions/43941551/explicit-purely-functional-data-structure-for-difference-lists/43945275#43945275", "title": "Explicit Purely-Functional Data-Structure For Difference Lists", "body": "<p>As shown in <a href=\"https://stackoverflow.com/questions/13879260/why-are-difference-lists-more-efficient-than-regular-concatenation/13879693#13879693\">this answer</a> the trick is the rearrangement of <code>(.)</code> tree into the <code>($)</code> list on access.</p>\n<p>We can emulate this  with</p>\n<pre><code>data Dlist a = List [a]  \n             | Append (Dlist a) (Dlist a)\n</code></pre>\n<p>which will juggle the <code>Append</code> nodes, rotating the tree to the right, to push the leftmost node up so it becomes the uppermost-left, on the first access, after which the next <code>tail</code><sup>(**)</sup> operation becomes <em>O(1)</em>\u200a<sup>(*)</sup> :</p>\n<pre><code>let x = (List [1..10] `Append` List [11..20]) `Append` List [21..30]\n</code></pre>\n<p>and <code>tail x</code><sup>(**)</sup> is to produce</p>\n<pre><code>List [2..10] `Append` (List [11..20] `Append` List [21..30])\n</code></pre>\n<p><code>tail</code><sup>(**)</sup> should be trivial to implement. Of course if will only pattern match the leftmost <code>List</code> node's list (with <code>(x:xs)</code>) when that node is finally discovered, and won't touch contents of anything else inside the <code>Append</code> nodes as they are juggled. Laziness is thus naturally preserved.</p>\n<hr />\n<p><sup>(**)</sup> <em>2020 edit</em>: what this actually means is to have one <code>uncons :: Dlist a -&gt; (a, Dlist a)</code> operation producing the head and the new, rotated tail, simultaneously, so that <code>uncons</code> on the <em>new</em> tail is <em>O(1)</em>.<sup>(*)</sup></p>\n<hr />\n<p><sup>(*)</sup> <em>edit:</em> <em>O(1)</em> in case the leftmost <code>List</code> node's list isn't empty. Overall, taking into account the possible nested-on-the-left <code>Append</code> nodes that will have to be rearranged as <em>they</em> come to the fore after the first leftmost <code>List</code> node is exhausted, the access to all <em>n</em> elements of the result will be <em>O(n+m)</em>, where <em>m</em> is the number of empty lists.</p>\n<hr />\n<p><em>update:</em> A historical note: this is actually quite similar (if not exactly the same) as the efficient tree-fringe enumeration problem, dealt with in 1977 by John McCarthy, whose <a href=\"http://www.dreamsongs.com/10ideas.html\" rel=\"nofollow noreferrer\"><code>gopher</code></a> function did exactly the same kind of nodes re-arrangement (tree rotations to the right) as the proposed here <code>tail</code><sup>(**)</sup> would.</p>\n"}, {"comments": [{"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1494619320, "post_id": 43945416, "comment_id": 74924046, "body": "Many thanks - the relation to <code>Foldable</code> is especially interesting."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1546970021, "post_id": 43945416, "comment_id": 95026957, "body": "<a href=\"https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/54067493?noredirect=1#comment95026495_54067493\">turns out</a>, there&#39;s already something very similar, in <a href=\"http://hackage.haskell.org/package/EdisonCore-1.3.2.1/docs/Data-Edison-Seq-JoinList.html#t:Seq\" rel=\"nofollow noreferrer\">Data.Edison.Seq.JoinList</a> (FYI)."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1494713895, "last_edit_date": 1494713895, "creation_date": 1494618380, "answer_id": 43945416, "question_id": 43941551, "link": "https://stackoverflow.com/questions/43941551/explicit-purely-functional-data-structure-for-difference-lists/43945416#43945416", "title": "Explicit Purely-Functional Data-Structure For Difference Lists", "body": "<p>Carl hit it in his comment. We can write</p>\n\n<pre><code>data TList a = Nil | Single a | Node !(TList a) (TList a)\n\nsingleton :: a -&gt; TList a\nsingleton = Single\n\ninstance Monoid (TList a) where\n  mempty = Nil\n  mappend = Node\n</code></pre>\n\n<p>We could get <code>toList</code> by just deriving <code>Foldable</code>, but let's write it out instead to see just what's going on.</p>\n\n<pre><code>instance Foldable TList where\n  foldMap _ Nil = mempty\n  foldMap f (Single a) = f a\n  foldMap f (Node t u) = foldMap f t &lt;&gt; foldMap f u\n\n  toList as0 = go as0 [] where\n    go Nil k = k\n    go (Single a) k = a : k\n    go (Node l r) k = go l (go r k)\n</code></pre>\n\n<p><code>toList</code> is O(n), where n is the total number of internal nodes (i.e., the total number of <code>mappend</code> operations used to form the <code>TList</code>). This should be pretty clear: each <code>Node</code> is inspected exactly once. <code>mempty</code>, <code>mappend</code>, and <code>singleton</code> are each obviously O(1).</p>\n\n<p>This is exactly the same as for a <code>DList</code>:</p>\n\n<pre><code>newtype DList a = DList ([a] -&gt; [a])\nsingletonD :: a -&gt; DList a\nsingletonD a = DList (a:)\ninstance Monoid (DList a) where\n  mempty = DList id\n  mappend (DList f) (DList g) = DList (f . g)\ninstance Foldable DList where\n  foldr c n xs = foldr c n (toList xs)\n  toList (DList f) = f []\n</code></pre>\n\n<p>Why, operationally, is this the same? Because, as you indicate in your question, the functions are represented in memory as trees. And they're represented as trees that look a lot like <code>TList</code>s! <code>singletonD x</code> produces a closure containing a (boring) <code>(:)</code> and an exciting <code>x</code>. When applied, it does O(1) work. <code>mempty</code> just produces the <code>id</code> function, which when applied does O(1) work. <code>mappend as bs</code> produces a closure that, when applied, does O(1) work of its own, plus O(length as + length bs) work in its children.</p>\n\n<p>The <em>shapes</em> of the trees produced for <code>TList</code> and <code>DList</code> are actually the same. You should be able to convince yourself that they also have identical asymptotic performance when used incrementally: in each case, the program has to walk down the left spine of the tree to get to the first list element.</p>\n\n<hr>\n\n<p>Both <code>DList</code> and <code>TList</code> are equally okay when built up and then used only once. They're equally lousy when built once and converted to lists multiple times.</p>\n\n<p>As Will Ness showed with a similar type, the explicit tree representation is better if you want to add support for <em>deconstructing</em> the representation, as you can actually get your hands on the structure. <code>TList</code> can support a reasonably efficient <code>uncons</code> operation (that improves the structure as it works). To get efficient <code>unsnoc</code> as well, you'll need to use a fancier representation (a catenable deque). This implementation also has potentially wretched cache performance. You can switch to a cache-oblivious data structure, but it is practically guaranteed to be complicated.</p>\n"}], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 2, "answer_count": 3, "score": 5, "last_activity_date": 1597410070, "creation_date": 1494603358, "last_edit_date": 1494615850, "question_id": 43941551, "link": "https://stackoverflow.com/questions/43941551/explicit-purely-functional-data-structure-for-difference-lists", "title": "Explicit Purely-Functional Data-Structure For Difference Lists", "body": "<p>In Haskell, <a href=\"https://en.wikipedia.org/wiki/Difference_list\" rel=\"nofollow noreferrer\"><em>difference lists</em></a>, in the sense of</p>\n\n<blockquote>\n  <p>[a] representation of a list with an efficient concatenation operation</p>\n</blockquote>\n\n<p>seem to be <a href=\"http://www.cs.tufts.edu/~nr/cs257/archive/john-hughes/lists.pdf\" rel=\"nofollow noreferrer\">implemented in terms of function composition</a>. </p>\n\n<p>Functions and (dynamic) function compositions, though, must also be represented somehow in the computer's memory using data structures, which raises the question of how <a href=\"http://book.realworldhaskell.org/read/data-structures.html\" rel=\"nofollow noreferrer\">dlists</a> could be implemented in Haskell <em>without</em> using function compositions, but, rather, through some basic purely-functional node-based data structures. How could this be done with the same performance guarantees as those of function composition?</p>\n"}, {"tags": ["haskell", "search", "functional-programming", "heuristics"], "answers": [{"comments": [{"owner": {"reputation": 1092, "user_id": 2800708, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/Mc3Gf.jpg?s=128&g=1", "display_name": "user2800708", "link": "https://stackoverflow.com/users/2800708/user2800708"}, "edited": false, "score": 0, "creation_date": 1494602556, "post_id": 43939398, "comment_id": 74914917, "body": "The list monad and knights quest sections from your link are useful to me, thanks."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1494596925, "creation_date": 1494596925, "answer_id": 43939398, "question_id": 43938264, "link": "https://stackoverflow.com/questions/43938264/how-would-you-implement-a-heuristic-search-in-haskell/43939398#43939398", "title": "How would you implement a heuristic search in Haskell?", "body": "<p>I don't think it's necessarily very specific to FP or Haskell (unless you utilize lists as \"multiple possibility\" monads, as in <a href=\"http://learnyouahaskell.com/a-fistful-of-monads#the-list-monad\" rel=\"nofollow noreferrer\">Learn You A Haskell For Great Good</a>).</p>\n\n<p>One way to do it would be by writing a recursive function taking the following:</p>\n\n<ul>\n<li>the current state (that is the board configuration)</li>\n<li>possibly some path metadata, e.g., the number of steps from the initial configuration (which is just the recursion depth), or a memoization-map of all the states already considered</li>\n<li>possibly some decision, metadata, e.g., a pesudo-random number generator</li>\n</ul>\n\n<p>Within each recursive call, the function would take the state, and check if it is the required result. If not it would</p>\n\n<ul>\n<li><p>if it uses a memoization map, check if a choice was already considered</p></li>\n<li><p>If it uses a recursive-step count, check whether to pursue the choices further</p></li>\n<li><p>If it decides to recursively call itself on the possible choices emanating from this state (e.g., if there are different tiles which can be pushed into the hole), it could do so in the order based on the heuristic (or possibly pseudo-randomly based on the order based on the heuristic)</p></li>\n</ul>\n\n<p>The function would return whether it succeeded, and, if they are used, updated versions of the memoization map and/or pseudo-random number generator.</p>\n"}], "owner": {"reputation": 1092, "user_id": 2800708, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/Mc3Gf.jpg?s=128&g=1", "display_name": "user2800708", "link": "https://stackoverflow.com/users/2800708/user2800708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 43939398, "answer_count": 1, "score": 1, "last_activity_date": 1494602864, "creation_date": 1494593559, "last_edit_date": 1494602864, "question_id": 43938264, "link": "https://stackoverflow.com/questions/43938264/how-would-you-implement-a-heuristic-search-in-haskell", "title": "How would you implement a heuristic search in Haskell?", "body": "<p>In Haskell or some other functional programming language, how would you implement a heuristic search?</p>\n\n<p>Take as an example search space, the nine-puzzle, that is a 3x3 grid with 8 tiles and 1 hole, and you move tiles into the hole until you have correctly assembled a picture. The heuristic is the \"Manhattan heuristic\", which evaluates a board position adding up the distance each tile is from its target position, taking as the distance the number of squares horizontally plus the number of squares vertically each tile needs to be moved to get to the correct location.</p>\n\n<p>I have been reading John Hughes paper on pretty printing as I know that pretty printer back-tracks to find better solutions. I am trying to understand how to generalise a heuristic search along these lines.</p>\n\n<p>===</p>\n\n<p>Note that my ultimate aim here is not to write a solver for the 9-puzzle, but to learn some general techniques for writing efficient heuristic searches in FP languages. I am also interested to learn if there is code that can be generalised and re-used across a wider class of such problems, rather than solving any specific problem.</p>\n\n<p>For example, a search space can be characterised by a function that maps a State to a List of States together with some 'operation' that describes how one state is transitioned into another. There could also be a goal function, mapping a State to Bool, indicating when a goal State has been reached. And of course, the heuristic function mapping a State to a Number reflecting how well it is estimated to score. Other descriptions of the search are possible.</p>\n"}, {"tags": ["haskell", "reverse"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1494591973, "post_id": 43937704, "comment_id": 74907529, "body": "<code>[x]</code> is a list containing a single element (named <code>x</code>). <code>last [x]</code> is just <code>x</code> and <code>init [x]</code> is <code>[]</code>. So <code>last [x] : rev init [x]</code> is <code>x : rev []</code>, which is <code>x : []</code>, which is <code>[x]</code>. So your last line is equivalent to <code>rev [x] = [x]</code>. But your main problem is that you don&#39;t have a case for lists that have more than one element."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7951643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0821ad8a7faeb3c23eabbb838db5df7d?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Vogel", "link": "https://stackoverflow.com/users/7951643/markus-vogel"}, "edited": false, "score": 0, "creation_date": 1494592307, "post_id": 43937805, "comment_id": 74907763, "body": "This is what i was searching for! Thanks a lot!"}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "reply_to_user": {"reputation": 65, "user_id": 7951643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0821ad8a7faeb3c23eabbb838db5df7d?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Vogel", "link": "https://stackoverflow.com/users/7951643/markus-vogel"}, "edited": false, "score": 0, "creation_date": 1494592350, "post_id": 43937805, "comment_id": 74907798, "body": "You&#39;re welcome! Please remember to accept the answer (click the green tick) if you feel it answered your question well."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1494595790, "post_id": 43937805, "comment_id": 74910068, "body": "I don&#39;t think this even parses with <code>let</code> in it :S"}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1494595841, "post_id": 43937805, "comment_id": 74910101, "body": "Thank you for spotting the error. <code>let</code> is removed."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494597578, "post_id": 43937805, "comment_id": 74911352, "body": "I think this is not an efficient <code>reverse</code> function due to many calls of the expensive <code>last</code> function. I think <a href=\"http://stackoverflow.com/a/43937822/4543207\">Valy&#39;s answer</a> shows a better way of doing this job."}], "tags": [], "owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "is_accepted": true, "score": 2, "last_activity_date": 1494595829, "last_edit_date": 1494595829, "creation_date": 1494592115, "answer_id": 43937805, "question_id": 43937704, "link": "https://stackoverflow.com/questions/43937704/how-to-write-a-a-reverse-function-in-haskell/43937805#43937805", "title": "How to write a a reverse function in Haskell", "body": "<p>You almost had it.</p>\n\n<pre><code>rev :: [Int] -&gt; [Int]\nrev [] = []\nrev x = last x : rev (init x)\n</code></pre>\n\n<p>Explanation: [x] was a list containing x, whereas you want to operate directly with x</p>\n\n<p>ps. here's the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">documentation for Data.List</a>. And remember to <code>import Data.List</code></p>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 3587570, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001071662888/picture?type=large", "display_name": "Valy", "link": "https://stackoverflow.com/users/3587570/valy"}, "is_accepted": false, "score": 2, "last_activity_date": 1494592157, "creation_date": 1494592157, "answer_id": 43937822, "question_id": 43937704, "link": "https://stackoverflow.com/questions/43937704/how-to-write-a-a-reverse-function-in-haskell/43937822#43937822", "title": "How to write a a reverse function in Haskell", "body": "<p>Well, you could do something like this:</p>\n\n<pre><code>rev :: [Int] -&gt; [Int]\nrev [] = []\nrev (x:l) = (rev l) ++ [x]\n</code></pre>\n\n<p>The 3rd line takes the first element from the list and then creates a list containing only that element. This is appended to the result of the recursion <code>rev l</code> call.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1494605165, "creation_date": 1494605165, "answer_id": 43942128, "question_id": 43937704, "link": "https://stackoverflow.com/questions/43937704/how-to-write-a-a-reverse-function-in-haskell/43942128#43942128", "title": "How to write a a reverse function in Haskell", "body": "<p>If you want to do it efficiently, I'd recommend you use an accumulator:</p>\n\n<pre><code>rev :: [a] -&gt; [a]\nrev xs = go xs []\n   where\n   go :: [a] -&gt; [a] -&gt; [a]\n   go []     ys = ys\n   go (x:xs) ys = go xs (x:ys)\n</code></pre>\n\n<p>The function <code>go</code>, at each step, removes one element from the first list <code>xs</code> and prepends it to the second list <code>ys</code>. This is similar to popping from a stack and pushing to another stack -- which reverses the order.</p>\n\n<p>Since we only use a constant amount of time at each recursive call, we get O(n) complexity, where n is the list length.</p>\n\n<p>Instead, if at each recursive call we use <code>last</code> or append with <code>... ++ [x]</code>, we pay O(n) for each call, hence O(n^2) overall.</p>\n"}], "owner": {"reputation": 65, "user_id": 7951643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0821ad8a7faeb3c23eabbb838db5df7d?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Vogel", "link": "https://stackoverflow.com/users/7951643/markus-vogel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2272, "favorite_count": 0, "accepted_answer_id": 43937805, "answer_count": 3, "score": 0, "last_activity_date": 1494605165, "creation_date": 1494591785, "question_id": 43937704, "link": "https://stackoverflow.com/questions/43937704/how-to-write-a-a-reverse-function-in-haskell", "title": "How to write a a reverse function in Haskell", "body": "<p>So, I know, there is a built in function to reverse a list in Haskell, but I'm trying to write my own little function, just to practice some Haskell. I thought of the following code, which sadly is not working. Could you guys tell me what I did wrong?</p>\n\n<pre><code>    rev :: [Int] -&gt; [Int]\n    rev [] = []\n    rev [x] = last [x] : rev init [x]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 5, "creation_date": 1494576241, "post_id": 43932436, "comment_id": 74897380, "body": "&quot;<i>myLength1 is much more better to understand, and looks natural</i>&quot; - I would have said just that about <code>myLength</code> :-)"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1494576302, "post_id": 43932436, "comment_id": 74897423, "body": "<code>foldr</code> uses recursion as well, it&#39;s just an extra abstraction layer. They&#39;ll run at mostly the same speed."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1494576807, "post_id": 43932436, "comment_id": 74897715, "body": "I like <code>sum . map (const 1)</code>. Is that weird?"}, {"owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494576873, "post_id": 43932436, "comment_id": 74897746, "body": "@Zeta, that weird for me, can you explain it why it calculate list length?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1494578218, "post_id": 43932436, "comment_id": 74898539, "body": "It was a joke, but: <code>sum</code> sums all elements in the list, <code>map (const 1)</code> maps every element in the list to <code>1</code>. So if you had <code>map (const 1) [&quot;Hello&quot;, &quot;World&quot;]</code>, you had <code>[1, 1]</code> afterwards, and if you <code>sum</code> that, you get <code>2</code>."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494578442, "post_id": 43932436, "comment_id": 74898679, "body": "@Zeta @anru, <code>foldr (+1) 0</code> <code>==</code> <code>sum . map (const 1)</code>, cool stuff :D"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 1, "creation_date": 1494580311, "post_id": 43932436, "comment_id": 74899849, "body": "@DanielSanchez nope. <code>foldr (const (+1)) 0 == foldr (\\_ acc -&gt; acc + 1) 0 == sum . map (const 1)</code>. You have to discard the value of the list."}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 4, "last_activity_date": 1494576525, "creation_date": 1494576525, "answer_id": 43932632, "question_id": 43932436, "link": "https://stackoverflow.com/questions/43932436/haskell-length-function-implementation/43932632#43932632", "title": "Haskell Length function implementation", "body": "<p>Take in mind this \"pseudo implementation\" of <code>foldr</code>:</p>\n\n<pre><code>foldr :: function -&gt; initializer -&gt; [a] -&gt; b\nfoldr _ i [] = i\nfoldr f i (x:xs) = x `f` (foldr f i xs)\n</code></pre>\n\n<p>Now we have your code</p>\n\n<pre><code>myLength :: [a] -&gt; Integer\nmyLength  = foldr (\\x -&gt; (+) 1) 0\n\nmyLength1 :: [a] -&gt; Integer\nmyLength1 []     = 0\nmyLength1 (x:xs) = (+1) (myLength1 xs)\n</code></pre>\n\n<p>Since <code>foldr</code> is also recursive itself, your myLength1 and myLength will be almost the same but in the first case the recursive call is done by foldr instead of explicitly by yourself. They should run around the same time.</p>\n"}, {"tags": [], "owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "is_accepted": false, "score": 3, "last_activity_date": 1494583072, "creation_date": 1494583072, "answer_id": 43934808, "question_id": 43932436, "link": "https://stackoverflow.com/questions/43932436/haskell-length-function-implementation/43934808#43934808", "title": "Haskell Length function implementation", "body": "<p>Both functions do the same thing : foldr use recursion and will end up executing similarly to your directly recursive function. It could be argued that the foldr version is cleaner (once you're accustomed to them, higher order function are often more readable than direct recursion).</p>\n\n<p>But those two functions are pretty bad : they'll both end up building a big thunk (an unevaluated value) <code>1 + (1 + (1 + ... + 0)..))</code> which will take a lot of memory ( O(n) space ) and will slow evaluation. To avoid that you should start adding the 1s from the beginning of the list, like so :</p>\n\n<pre><code>betterLength xs = go 0 xs\n  where\n    go n [] = n\n    go n (_:xs) = n `seq` go (n+1) xs\n</code></pre>\n\n<p>The <code>seq</code> ensures that n is evaluated before the go function is called recursively and thus there is no accumulation of <code>+1</code>. With the <code>BangPatterns</code> extension, you can write this :</p>\n\n<pre><code>betterLength xs = go 0 xs\n  where\n    go n [] = n\n    go !n (_:xs) = go (n+1) xs\n</code></pre>\n\n<p>It is also possible to do this version with a fold :</p>\n\n<pre><code>betterLength = foldl' (\\n _ -&gt; n + 1) 0 \n</code></pre>\n\n<p>where the <code>foldl'</code> start from the <strong>l</strong>eft and is strict (<strong>'</strong>).</p>\n"}, {"tags": [], "owner": {"reputation": 386, "user_id": 1536235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ye5mV.jpg?s=128&g=1", "display_name": "blasrodri", "link": "https://stackoverflow.com/users/1536235/blasrodri"}, "is_accepted": false, "score": 0, "last_activity_date": 1538996349, "creation_date": 1538996349, "answer_id": 52700794, "question_id": 43932436, "link": "https://stackoverflow.com/questions/43932436/haskell-length-function-implementation/52700794#52700794", "title": "Haskell Length function implementation", "body": "<p>Using <code>foldr</code>, it can be implemented as: </p>\n\n<pre><code>length' xs = foldr (\\_ n -&gt; 1 + n) 0 xs\n</code></pre>\n\n<p>Explanation:</p>\n\n<p>The lambda function <code>(\\_ x -&gt; n + 1)</code> will increment the accumulator by one every time there is an element. For instance:</p>\n\n<pre><code>lenght' [1..4]\n</code></pre>\n\n<p>will be applied as:\n    <code>1 + ( 1 + ( 1 + ( 1 + 0)))</code></p>\n\n<p>Recall that <code>foldr</code> is defined like this:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldr f v [] = v\nfoldr f v (x:xs) = f x (foldr f v xs)\n</code></pre>\n"}], "owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3565, "favorite_count": 0, "accepted_answer_id": 43932632, "answer_count": 3, "score": 5, "last_activity_date": 1575242737, "creation_date": 1494575947, "last_edit_date": 1575242737, "question_id": 43932436, "link": "https://stackoverflow.com/questions/43932436/haskell-length-function-implementation", "title": "Haskell Length function implementation", "body": "<p>I am learning Haskell programming, and I am trying to understand how lists work, hence I attempted writing two possible <code>length</code> functions:</p>\n\n<pre><code>myLength :: [a] -&gt; Integer\nmyLength  = foldr (\\x -&gt; (+) 1) 0\n\nmyLength1 :: [a] -&gt; Integer\nmyLength1 []     = 0\nmyLength1 (x:xs) = (+1) (myLength1 xs)\n</code></pre>\n\n<p>Which one is better?</p>\n\n<p>From my point of view, <code>myLength1</code> is much easier to understand, and looks natural for operating on lists.</p>\n\n<p>On the other hand, <code>myLength</code> is shorter and it does not use recursion; does this imply <code>myLength</code> runs faster than  <code>myLength1</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "edited": false, "score": 0, "creation_date": 1494589710, "post_id": 43932384, "comment_id": 74906030, "body": "Is it possible to do something like <code>all (&gt;= Just 1 &amp;&amp; &lt;= Just 9) [Just 3, Just 6, Nothing, Nothing, Just 7]</code>  This doesn&#39;t seem to work on Prelude."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "edited": false, "score": 1, "creation_date": 1494589877, "post_id": 43932384, "comment_id": 74906131, "body": "You can use <code>all (\\x -&gt; x&gt;=Just 1 &amp;&amp; x&lt;=Just 9) ...</code> but remember that <code>Nothing</code> is the least, so it&#39;s not that useful. Use <code>catMaybes</code>, or (better) lift the predicate using <code>maybe</code> as Zeta showed: <code>all (maybe True (\\x -&gt; x&gt;=1 &amp;&amp; x&lt;=9)) ...</code>"}, {"owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "edited": false, "score": 0, "creation_date": 1494590170, "post_id": 43932384, "comment_id": 74906299, "body": "Thanks! It is useful because I&#39;m making a sudoku solver and there are no zeros in sudoku!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "edited": false, "score": 0, "creation_date": 1494605188, "post_id": 43932384, "comment_id": 74916586, "body": "@RQ14 &quot;This doesn&#39;t seem to work on Prelude&quot; -- <code>import Data.Maybe</code> will bring <code>catMaybes</code> in."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 23, "last_activity_date": 1494662238, "last_edit_date": 1495540037, "creation_date": 1494575792, "answer_id": 43932384, "question_id": 43932247, "link": "https://stackoverflow.com/questions/43932247/can-all-be-applied-to-a-list-of-maybe/43932384#43932384", "title": "Can &#39;all&#39; be applied to a list of Maybe?", "body": "<pre><code>&gt; all (&lt;= Just 9) [Just 3, Just 6, Nothing, Nothing, Just 7]\nTrue\n</code></pre>\n\n<p>This works because <code>Nothing</code> is less than any <code>Just x</code>.</p>\n\n<p>Alternatively, one can use <code>catMaybes :: [Maybe a] -&gt; [a]</code> from the <code>Data.Maybe</code> module to discard the <code>Nothing</code>s, and remove the <code>Just</code> wrappers, turning the list into a list of numbers, which can then be handled as usual:</p>\n\n<pre><code>&gt; all (&lt;= 9) $ catMaybes [Just 3, Just 6, Nothing, Nothing, Just 7]\nTrue\n</code></pre>\n\n<p>Another alternative: define your own predicate on <code>Maybe Int</code>.</p>\n\n<pre><code>let p :: Maybe Int -&gt; Bool\n    p Nothing = True\n    p (Just x) = x &lt;= 9\n in all p [Just 3, Just 6, Nothing, Nothing, Just 7]\n</code></pre>\n\n<p>Even better: define <code>p</code> using <code>maybe</code>, as <a href=\"https://stackoverflow.com/a/43932415/3234959\">Zeta suggests</a>.</p>\n\n<p>Yet another alternative, using a list comprehension and <code>and</code>:</p>\n\n<pre><code>and [ x &lt;= 9 | Just x &lt;- [Just 3, Just 6, Nothing, Nothing, Just 7] ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494589635, "post_id": 43932415, "comment_id": 74905986, "body": "Lifting the predicate with <code>maybe</code> would indeed be the best approach, IMO."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 13, "last_activity_date": 1494575883, "creation_date": 1494575883, "answer_id": 43932415, "question_id": 43932247, "link": "https://stackoverflow.com/questions/43932247/can-all-be-applied-to-a-list-of-maybe/43932415#43932415", "title": "Can &#39;all&#39; be applied to a list of Maybe?", "body": "<p>Sure. <code>maybe True (&lt; 9)</code>. <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:maybe\" rel=\"noreferrer\"><code>maybe default func</code></a> uses the given function <code>func</code> if you have <code>Just</code>, or the <code>default</code> if you have <code>Nothing</code>:</p>\n\n<pre><code>ghci&gt; all (maybe True (&lt; 9))  [Just 3, Just 6, Nothing, Nothing, Just 7]\nTrue\n</code></pre>\n\n<p>You can use that to write your <code>allMaybe</code> function:</p>\n\n<pre><code>allMaybe :: (a -&gt; Bool) -&gt; [Maybe a] -&gt; Bool\nallMaybe p = all (maybe True p)\n</code></pre>\n\n<p>Or we could \"lift\" your predicate to <code>Maybe</code>:</p>\n\n<pre><code>liftP :: (a -&gt; Bool) -&gt; Maybe a -&gt; Bool\nliftP _ Nothing  = True\nliftP p (Just x) = p x\n-- or simply \n-- liftP p = maybe True p\n\nallMaybe' p = all (liftP p)\n</code></pre>\n\n<p>But that only hides the underlying <code>maybe</code> away.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 14, "last_activity_date": 1494576040, "last_edit_date": 1495541899, "creation_date": 1494576040, "answer_id": 43932470, "question_id": 43932247, "link": "https://stackoverflow.com/questions/43932247/can-all-be-applied-to-a-list-of-maybe/43932470#43932470", "title": "Can &#39;all&#39; be applied to a list of Maybe?", "body": "<p>A slightly more esoteric solution than those by <a href=\"https://stackoverflow.com/a/43932384/2751851\">chi</a> and <a href=\"https://stackoverflow.com/a/43932415/2751851\">Zeta</a> would be using <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor-Compose.html\" rel=\"nofollow noreferrer\"><code>Compose</code></a> so that <code>all</code> sees the two layers as a single structure containing numbers:</p>\n\n<pre><code>GHCi&gt; import Data.Functor.Compose\nGHCi&gt; all (&lt;=9) $ Compose [Just 3, Just 6, Nothing, Nothing, Just 7]\nTrue\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 1, "accepted_answer_id": 43932384, "answer_count": 3, "score": 14, "last_activity_date": 1494662238, "creation_date": 1494575342, "last_edit_date": 1494576223, "question_id": 43932247, "link": "https://stackoverflow.com/questions/43932247/can-all-be-applied-to-a-list-of-maybe", "title": "Can &#39;all&#39; be applied to a list of Maybe?", "body": "<p>Is it possible to use <code>all</code> on a <code>[Maybe Int]</code> list?</p>\n\n<p>I know <code>all (&lt; 9) [2,4,6,8,10]</code> returns <code>False</code>, but that is using a list with just integers.</p>\n\n<p>I am trying to accomplish something similar except with a list that looks like this:<br>\n<code>[Just 3, Just 6, Nothing, Nothing, Just 7]</code></p>\n\n<p>I want <code>all (&lt;=9) [Just 3, Just 6, Nothing, Nothing, Just 7]</code> to return <code>True</code></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 6748751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879942233f1a467b2e158869153da800?s=128&d=identicon&r=PG&f=1", "display_name": "BinaryHexer", "link": "https://stackoverflow.com/users/6748751/binaryhexer"}, "edited": false, "score": 0, "creation_date": 1494603915, "post_id": 43936088, "comment_id": 74915783, "body": "Yeah, this works. What took me extra time though was figuring out that I need to import Data.default for def"}], "tags": [], "owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "is_accepted": true, "score": 1, "last_activity_date": 1494586905, "last_edit_date": 1494586905, "creation_date": 1494586594, "answer_id": 43936088, "question_id": 43931811, "link": "https://stackoverflow.com/questions/43931811/parsing-icalendar-format/43936088#43936088", "title": "Parsing iCalendar format", "body": "<p><code>DecodingFunctions</code> is supposed to contains a function to convert your <code>ByteString</code> (binary array) to a <code>Text</code> (representing a string of unicode characters) and one to do the same to a case-insensitive representation (for comparison purpose I suppose). If your iCalendar is \"normal\" and is encoded in utf-8, you can simply use the <a href=\"https://hackage.haskell.org/package/data-default-0.5.3/docs/Data-Default.html#t:Default\" rel=\"nofollow noreferrer\"><code>Default</code></a> instance of <code>DecodingFunctions</code> :</p>\n\n<pre><code>parseICalendar def logFile cal\n</code></pre>\n\n<p>(don't forget to import def from somewhere)</p>\n\n<p>If your iCalendar is not in Utf-8, you'll have to use a <code>decode...</code> function from <a href=\"https://hackage.haskell.org/package/text-1.2.1.1/docs/Data-Text-Lazy-Encoding.html\" rel=\"nofollow noreferrer\">Data.Text.Lazy.Encoding</a> and <code>mk</code> from <a href=\"https://hackage.haskell.org/package/case-insensitive-1.2.0.4/docs/Data-CaseInsensitive.html#t:CI\" rel=\"nofollow noreferrer\">Data.CaseInsensitive</a>. For Utf16 you would have :</p>\n\n<pre><code>decodings = DecodingFunctions decodeUtf16LE (mk . decodeUtf16LE)\n</code></pre>\n\n<p>with the right imports.</p>\n"}], "owner": {"reputation": 127, "user_id": 6748751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879942233f1a467b2e158869153da800?s=128&d=identicon&r=PG&f=1", "display_name": "BinaryHexer", "link": "https://stackoverflow.com/users/6748751/binaryhexer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 43936088, "answer_count": 1, "score": 1, "last_activity_date": 1494586905, "creation_date": 1494573998, "last_edit_date": 1494581787, "question_id": 43931811, "link": "https://stackoverflow.com/questions/43931811/parsing-icalendar-format", "title": "Parsing iCalendar format", "body": "<p>I need to parse iCalendar format, which is basically what is used by Google Calendar and almost all calendar apps.  </p>\n\n<p>I have found this package <a href=\"https://hackage.haskell.org/package/iCalendar\" rel=\"nofollow noreferrer\" title=\"iCalendar package\">iCalendar Hackage</a><br>\nBut I cannot figure out how to use the <code>parseICalendar</code> function in this package, if someone can tell me what I am doing wrong, it would be great.</p>\n\n<p>Mainly I cannot figure out how to construct an argument for the Type <code>DecodingFunctions</code></p>\n\n<pre><code>parseICalendar :: DecodingFunctions\n               -&gt; FilePath -- ^ Used in error messages.\n               -&gt; ByteString\n               -&gt; Either String ([VCalendar], [String])\n</code></pre>\n\n<p>My effort:  </p>\n\n<pre><code>module CalendarReader \n( getCalendar\n, getSummary\n) where\n\n{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified Data.ByteString.Lazy as B      -- package \"bytestring\"\nimport qualified Text.ICalendar as ICal         -- package \"iCalendar\"\nimport qualified Data.Map as Map                -- package \"containers\"\nimport Network.HTTP.Simple                      -- package \"http-conduit\"\n\n\nimport qualified Time                           -- local module\nimport Constants\n\ngetCalendar :: IO B.ByteString\ngetCalendar = do\n    request &lt;- parseRequest $ \"GET\" ++ calendarURL\n    response &lt;- httpLBS request\n    return $ getResponseBody response\n\ngetSummary :: B.ByteString -&gt; Time.DateTime -&gt; Int -&gt; String\ngetSummary cal dateTime dayOffset = summary\n  where\n    summary = \"Event Summary\"\n    ((ICal.VCalendar { ICal.vcEvents = vcEvents' }), _) = ICal.parseICalendar ?missingArgument? logFile cal\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 1, "creation_date": 1494550003, "post_id": 43927668, "comment_id": 74888377, "body": "How doesn&#39;t it work?"}, {"owner": {"reputation": 79, "user_id": 7833459, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3565f40d27ef550a4fa96512a5f00a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Chirica Andrei", "link": "https://stackoverflow.com/users/7833459/chirica-andrei"}, "reply_to_user": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 0, "creation_date": 1494550052, "post_id": 43927668, "comment_id": 74888388, "body": "It gives me this error :  aplicatie.hs:1:12: error:     \u2022 Expected a constraint, but \u2018[Int a]\u2019 has kind \u2018<i>\u2019     \u2022 In the type signature:         afisare :: [Int a] =&gt; [a] -&gt; b  aplicatie.hs:1:13: error:     \u2022 Expecting one fewer argument to \u2018Int\u2019       Expected kind \u2018</i> -&gt; <i>\u2019, but \u2018Int\u2019 has kind \u2018</i>\u2019     \u2022 In the type signature:         afisare :: [Int a] =&gt; [a] -&gt; b"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1494550242, "post_id": 43927668, "comment_id": 74888428, "body": "You should add that to the question."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7833459, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3565f40d27ef550a4fa96512a5f00a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Chirica Andrei", "link": "https://stackoverflow.com/users/7833459/chirica-andrei"}, "edited": false, "score": 0, "creation_date": 1494553159, "post_id": 43927916, "comment_id": 74889091, "body": "How should the final program look?Sorry but i am new in Haskell"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1494552313, "creation_date": 1494552313, "answer_id": 43927916, "question_id": 43927668, "link": "https://stackoverflow.com/questions/43927668/haskell-simple-show-the-elements-of-a-list-program/43927916#43927916", "title": "Haskell simple show the elements of a list program", "body": "<p>There are a few problems here.  First, constraints are written using parentheses, not brackets:</p>\n\n<pre><code>showw :: (Int a) =&gt; [a] -&gt; b\n</code></pre>\n\n<p>That gets rid of one error. </p>\n\n<p>Now I'm not sure what you're intending <code>(Int a)</code>, but <code>Int</code> isn't a typeclass so you can't use it like this.  Maybe you meant <code>a</code> is an <code>Int</code>, in which case we would not use a type variable at all and just use the <code>Int</code> type in its place:</p>\n\n<pre><code>showw :: [Int] -&gt; b\n</code></pre>\n\n<p>Now there's this <code>b</code> floating around all by its lonesome, and lonely type variables are generally a problem.  It says that <code>showw</code> can return <em>any type at all</em>, so if I said, hey, <code>showw</code>, here's <code>[1,2,3,4,5]</code>, give me back an <code>Elephant</code> it would have to return an elephant.</p>\n\n<p>Since you want to \"show\" the list, I assume you want to return a <code>String</code></p>\n\n<pre><code>showw :: [Int] -&gt; String\n</code></pre>\n\n<p>Which is a reasonable signature.   Now to the implementation:</p>\n\n<pre><code>show [] = 0\n</code></pre>\n\n<p>To show an empty list, you... give 0?  That doesn't make sense.  You probably want the empty string <code>\"\"</code>.</p>\n\n<p>And then this line:</p>\n\n<pre><code>showw (x:xs) = x ++ showw xs\n</code></pre>\n\n<p>in which you try to concatenate an <code>Int</code> (<code>x</code>) with a <code>String</code> (<code>showw xs</code>), which is not allowed.  You need to convert <code>x</code> to a string first, and I guess you should do that using the regular <code>show</code> function.</p>\n\n<p>That said, the <code>show</code> function can already show lists.  But I assume you're practicing.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1494552338, "post_id": 43927918, "comment_id": 74888874, "body": "Nice first sentence, bro"}], "tags": [], "owner": {"reputation": 322, "user_id": 2575380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c414a1105813c7f337b7f570c9fe67fe?s=128&d=identicon&r=PG", "display_name": "Ben Kugler", "link": "https://stackoverflow.com/users/2575380/ben-kugler"}, "is_accepted": true, "score": 1, "last_activity_date": 1494553114, "last_edit_date": 1494553114, "creation_date": 1494552323, "answer_id": 43927918, "question_id": 43927668, "link": "https://stackoverflow.com/questions/43927668/haskell-simple-show-the-elements-of-a-list-program/43927918#43927918", "title": "Haskell simple show the elements of a list program", "body": "<p>There are a few problems here.</p>\n\n<p>The first problem is in the type signature. Int is a type, but your syntax makes it look like a type class. If you have a function which takes a list of Ints and outputs some other value, it should look like this:</p>\n\n<pre><code>func :: [Int] -&gt; a\n</code></pre>\n\n<p>Of course, that only works if you mean to restrict the function to Ints. If you want to include other kinds of numbers, you <em>do</em> need to use a type class. If you wanted to use Num, for instance, the type signature would instead look like this:</p>\n\n<pre><code>func :: Num a =&gt; a -&gt; b\n</code></pre>\n\n<p>But even if you fix your type signature you're still going to get an error, because the return type of your function isn't consistent. <code>showw []</code> returns 0 (an Int), but <code>showw</code> on a non-empty list returns a list of values. You probably want <code>showw []</code> to return <code>[0]</code> or <code>[]</code> instead.</p>\n\n<p>And if you want to <em>show</em> these values, as in convert them to a string, you'll need to use a function to do that conversion. You would apply that function to <code>x</code> on the third line, and to the return value of <code>showw []</code>.</p>\n"}], "owner": {"reputation": 79, "user_id": 7833459, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3565f40d27ef550a4fa96512a5f00a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Chirica Andrei", "link": "https://stackoverflow.com/users/7833459/chirica-andrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 43927918, "answer_count": 2, "score": 0, "last_activity_date": 1494553114, "creation_date": 1494549790, "last_edit_date": 1494551618, "question_id": 43927668, "link": "https://stackoverflow.com/questions/43927668/haskell-simple-show-the-elements-of-a-list-program", "title": "Haskell simple show the elements of a list program", "body": "<p>I try to make a function in Haskell to show the elements of a list and it doesn't work. What do I do wrong?</p>\n\n<pre><code>showw :: [Int a]=&gt; [a] -&gt; b\nshoww []=0\nshoww (x:xs)= x ++ showw xs\n</code></pre>\n\n<p>It gives me this error : </p>\n\n<pre><code>aplicatie.hs:1:12: error: \n\u2022 Expected a constraint, but \u2018[Int a]\u2019 has kind \u2018*\u2019 \n\u2022 In the type signature: afisare :: [Int a] =&gt; [a] -&gt; b\naplicatie.hs:1:13: error: \n\u2022 Expecting one fewer argument to \u2018Int\u2019 Expected kind \u2018* -&gt; *\u2019, but \n  \u2018Int\u2019 has kind \u2018*\u2019 \n\u2022 In the type signature: afisare :: [Int a] =&gt; [a] -&gt; b\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1494543426, "post_id": 43926822, "comment_id": 74886876, "body": "What are you trying to accomplish, and what is your question?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1494543801, "post_id": 43926822, "comment_id": 74886985, "body": "Where is the error occurring?"}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 1, "last_activity_date": 1494544020, "last_edit_date": 1495540042, "creation_date": 1494544020, "answer_id": 43926938, "question_id": 43926822, "link": "https://stackoverflow.com/questions/43926822/maybe-int-type-error/43926938#43926938", "title": "Maybe Int type error", "body": "<p>I'm getting a slightly different error:</p>\n\n<pre><code>No instance for (Num (Maybe Int)) arising from a use of \u2018+\u2019\nIn the first argument of \u2018(&lt;)\u2019, namely\n  \u2018(Just (snd (rankC x) - fst (rankC x)) + rankP xs)\u2019\nIn the expression:\n  ((Just (snd (rankC x) - fst (rankC x)) + rankP xs) &lt; 0)\nIn the expression:\n  if ((Just (snd (rankC x) - fst (rankC x)) + rankP xs) &lt; 0) then\n      Nothing\n  else\n      Just (snd (rankC x) - fst (rankC x)) + (rankP xs)\n</code></pre>\n\n<p>However, note that in</p>\n\n<pre><code>(Just (snd(rankC x) - fst(rankC x)) + rankP xs) &lt; 0\n</code></pre>\n\n<p>you're trying to use <code>+</code> on two <code>Maybe Rank</code> objects, and compare the result with <code>&lt;</code> to 0. Neither of these can work.</p>\n\n<p>From your code, it looks like you're trying to \"extract\" the value of a <code>Maybe Rank</code>; see <a href=\"https://stackoverflow.com/questions/4940349/how-to-get-the-value-of-an-maybe-in-haskell\">this question</a> about that.</p>\n"}, {"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": true, "score": 0, "last_activity_date": 1494544874, "last_edit_date": 1494544874, "creation_date": 1494544042, "answer_id": 43926946, "question_id": 43926822, "link": "https://stackoverflow.com/questions/43926822/maybe-int-type-error/43926946#43926946", "title": "Maybe Int type error", "body": "<p>The problem is that you are attempting to do arithmetic with a <code>Maybe Rank</code> when you really need to extract the <code>Rank</code> from the <code>Maybe Rank</code> before doing any math. One way to do this is directly by hand:</p>\n\n<pre><code>rankP (x:xs) = if y == Nothing\n               then Nothing\n               else let Just y' = y in\n                    if snd(rankC x) - fst(rankC x) + y' &lt; 0\n                    then Nothing\n                    else Just (snd(rankC x) - fst(rankC x) + y')\n    where y = rankP xs\n</code></pre>\n\n<p>There are certainly more elegant ways to do this when you begin to understand the monadic properties of <code>Maybe</code>. I'm not there yet myself to give much help along those lines.</p>\n"}], "owner": {"reputation": 13, "user_id": 7999980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9Fdk.jpg?s=128&g=1", "display_name": "LWin", "link": "https://stackoverflow.com/users/7999980/lwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "closed_date": 1494548982, "accepted_answer_id": 43926946, "answer_count": 2, "score": 0, "last_activity_date": 1494544874, "creation_date": 1494543094, "question_id": 43926822, "link": "https://stackoverflow.com/questions/43926822/maybe-int-type-error", "closed_reason": "Duplicate", "title": "Maybe Int type error", "body": "<p>I'm getting a type error because I'm trying to recursively add a Maybe int int the function rankP seen bellow. Because the return type of rankP is Maybe Int, and the type of rankC is a tuple of Ints, it is telling me I cannot add Int with Maybe Int.</p>\n\n<pre><code>type Prog = [Cmd]\n\ndata Cmd = LD Int\n    | ADD\n    | MULT\n    | DUP\n    | INC\n    | SWAP\n    | POP Int\n    deriving Show       \ntype Stack = [Int]\ntype D = Stack -&gt; Maybe Stack\ntype Rank = Int\ntype CmdRank = (Int,Int)\n\n\nrankC :: Cmd -&gt; CmdRank\nrankC (LD _) = (0,1)\nrankC ADD = (2,1)\nrankC MULT = (2,1)\nrankC DUP = (1,2)\nrankC INC = (1,1)\nrankC SWAP = (2,2)\nrankC (POP x) = (x,0)\n\n\nrankP :: Prog -&gt; Maybe Rank\nrankP [] = Nothing\nrankP [x] = Just (snd(rankC x) - fst(rankC x))\nrankP (x:xs) = if ((Just (snd(rankC x) - fst(rankC x)) + rankP xs) &lt; 0) then Nothing\n                    else Just (snd(rankC x) - fst(rankC x)) + (rankP xs)\n</code></pre>\n\n<p>Here is the error I am receiving:</p>\n\n<pre><code>hw3.hs:43:64:\n    Couldn't match expected type `Int' with actual type `Maybe Rank'\n    In the return type of a call of `rankP'\n    In the first argument of `Just', namely `(rankP xs)'\n    In the second argument of `(+)', namely `Just (rankP xs)'\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494540154, "post_id": 43925945, "comment_id": 74885789, "body": "The second argument of <code>derN</code> seems to be keeping track of the degree of the &quot;current&quot; term, so as we chomp along the list, we increment the degree."}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 0, "last_activity_date": 1494540338, "creation_date": 1494540338, "answer_id": 43926316, "question_id": 43925945, "link": "https://stackoverflow.com/questions/43925945/derivation-function-in-haskell/43926316#43926316", "title": "derivation function in haskell", "body": "<p>Those are recursive calls. For instance, <code>derN (x:xs) 0 = derN xs 1</code> should be read as \"The derivative of a polynom, with <code>x</code> as a free member and <code>xs</code> as other coefficients, is the same as derivative of a polynom with coefficients <code>xs</code>, starting with power 1\".</p>\n\n<p>This procedure takes the list of coefficients of a polynom and builds the list of coefficients of its derivative, recursively traversing from the lowest power to the highest.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494551931, "creation_date": 1494551931, "answer_id": 43927871, "question_id": 43925945, "link": "https://stackoverflow.com/questions/43925945/derivation-function-in-haskell/43927871#43927871", "title": "derivation function in haskell", "body": "<p>Maybe it would help to work through an example. It looks like you have a definition like <code>type P = [Int]</code>, so I\u2019ll assume that. Let\u2019s take the polynomial 3x<sup>2</sup> + 5x + 7, which would be represented in this scheme as <code>[7, 5, 3]</code>.</p>\n\n<p>To compute the derivative of this polynomial, we start with <code>derPolynom</code>:</p>\n\n<pre><code>derPolinom [7, 5, 3]\n=\nderN [7, 5, 3] 0\n</code></pre>\n\n<p>So we just call <code>derN</code>. We find the first case that matches:</p>\n\n<pre><code>derN (x:xs) 0 = derN xs 1\n</code></pre>\n\n<p>Then <code>x</code> is <code>7</code> and <code>xs</code> is <code>[5, 3]</code>, so we substitute those values into the body:</p>\n\n<pre><code>derN [5, 3] 1\n</code></pre>\n\n<p>We\u2019ve arrived at another call, so we find the case that matches:</p>\n\n<pre><code>derN (x:xs) n = [n * x] ++ derN xs (n+1)\n</code></pre>\n\n<p>This time, <code>x</code> is <code>5</code>, <code>xs</code> is <code>[3]</code>, and <code>n</code> is <code>1</code>. Again substitute:</p>\n\n<pre><code>[1 * 5] ++ derN [3] (1 + 1)\n=\n[5] ++ derN [3] 2\n</code></pre>\n\n<p>Now we have another recursive call, which matches the same pattern, binding <code>x</code> = <code>3</code>, <code>xs</code> = <code>[]</code>, and <code>n</code> = <code>2</code>:</p>\n\n<pre><code>[5] ++ ([2 * 3] ++ derN [] (2 + 1))\n[5] ++ ([6] ++ derN [] 3)\n</code></pre>\n\n<p>Finally we\u2019ve reached the base case of the recursion:</p>\n\n<pre><code>derN [] n = []\n</code></pre>\n\n<p>So we perform our last substitution:</p>\n\n<pre><code>[5] ++ ([6] ++ [])\n</code></pre>\n\n<p>Then reduce to get an answer of <code>[5, 6]</code>, which represents the polynomial 6x + 5, which is indeed the derivative of 3x<sup>2</sup> + 5x + 7.</p>\n\n<p>You\u2019ll notice that we\u2019re only ever prepending single-element lists, so this line:</p>\n\n<pre><code>derN (x:xs) n = [n * x] ++ derN xs (n+1)\n</code></pre>\n\n<p>Could be simplified into this:</p>\n\n<pre><code>derN (x:xs) n = n * x : derN xs (n+1)\n</code></pre>\n\n<p>This whole function could also be written more simply using a higher-order function to avoid having to write out the recursion explicitly. We can use <code>drop</code> to remove the last coefficient and <code>zipWith (*) [1..]</code> to multiply each remaining number in the list by its 1-based index (which indicates the exponent).</p>\n\n<pre><code>derPolinom xs = zipWith (*) [1..] (drop 1 xs)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7699349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/366e6c514b0f542fe75e20e7222e115f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/7699349/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1494582874, "creation_date": 1494538492, "last_edit_date": 1494582874, "question_id": 43925945, "link": "https://stackoverflow.com/questions/43925945/derivation-function-in-haskell", "title": "derivation function in haskell", "body": "<p>I want actually undestand what is happening in this code. Can someone tell me what it's the main idea. I get that is derivation of a polynom. But I don't know what <code>derN xs 1 , derN xs (n+1) and derN xs 0</code> actually do</p>\n\n<pre><code>derN :: P -&gt; Int -&gt; P\nderN [] n = []\n\n\nderPolinom :: P -&gt; P\nderPolinom xs = derN xs 0\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1494540898, "post_id": 43925825, "comment_id": 74886040, "body": "What exactly are you asking?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1494541286, "post_id": 43925825, "comment_id": 74886191, "body": "I think it&#39;s a pretty reasonable question: &quot;what the heck is going on with this <code>case</code> expression which clearly does not conform to standard Haskell?&quot; If you know about <code>PatternGuards</code> then of course the answer is obvious, but if you don&#39;t know about it what more can you ask than &quot;huh?&quot;"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1494557353, "post_id": 43925825, "comment_id": 74890060, "body": "This may be more useful to people searching for what this syntax means if you edit the question title to something more descriptive like \u201cWhat does a left arrow mean in a guard?\u201d"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1494571615, "post_id": 43925825, "comment_id": 74894670, "body": "@JonPurdy You have the power to make that edit yourself, if you think it would be an improvement (and I think most folks would agree with you that it would be)."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 3, "last_activity_date": 1494541089, "creation_date": 1494541089, "answer_id": 43926464, "question_id": 43925825, "link": "https://stackoverflow.com/questions/43925825/haskell-case-statement-grammar/43926464#43926464", "title": "Haskell case statement grammar", "body": "<p>The guards in this <code>case</code> expression are making use of the <a href=\"https://www.schoolofhaskell.com/school/to-infinity-and-beyond/pick-of-the-week/guide-to-ghc-extensions/pattern-and-guard-extensions#patternguards\" rel=\"nofollow noreferrer\"><code>PatternGuards</code></a> extension, part of Haskell 2010 but not Haskell 98. The idea is that with this extension, your guards can do pattern-matching of their own, not just evaluate <code>Bool</code> expressions.</p>\n\n<p>So your <code>case</code> expression has two patterns:</p>\n\n<pre><code>[dir, mbytes]\n</code></pre>\n\n<p>and the wildcard pattern. If <code>[dir, mbytes]</code> does match with args, the pattern match still might not succeed: its guards need to apply. It has two guards:</p>\n\n<pre><code>[(bytes ,\"\")] &lt;- reads mbytes\n</code></pre>\n\n<p>which means that calling <code>reads mbytes</code> must match with <code>[(bytes, \"\")]</code>, and</p>\n\n<pre><code>bytes &gt;= 1\n</code></pre>\n\n<p>which is an ordinary boolean expression.</p>\n\n<p>If all of those pattern matches and guards succeed, then the first clause of the <code>case</code> is the one that is used; otherwise, we fall through to the default clause and print an error message.</p>\n"}], "owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 43926464, "answer_count": 1, "score": 1, "last_activity_date": 1494541089, "creation_date": 1494538011, "question_id": 43925825, "link": "https://stackoverflow.com/questions/43925825/haskell-case-statement-grammar", "title": "Haskell case statement grammar", "body": "<p>How to understand the <code>case args of</code> in the following code?</p>\n\n<pre><code>main :: IO ()\nmain = do\n  args &lt;- getArgs\n  case args of\n    [dir, mbytes] | [(bytes ,\"\")] &lt;- reads mbytes\n                   , bytes &gt;= 1 -&gt; findDuplicates dir bytes\n    (_) -&gt; do\n      name &lt;- getProgName\n      printf \"Something went wrong - please use ./%s &lt;dir&gt; &lt;bytes&gt;\\n\" name\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1494529273, "post_id": 43923515, "comment_id": 74880276, "body": "Hint: you need to write a function that takes a &quot;transformation&quot; function <code>(a -&gt; b)</code>, a &quot;predicate&quot; <code>(a -&gt; Bool)</code>, a list of <code>a</code>s, applies the &quot;transformation&quot; only to the members of <code>[a]</code> for which the predicate holds true, and returns a list of resulting <code>b</code>s. You have to apply <code>filter</code> first, and <code>map</code> after it."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494529352, "post_id": 43923515, "comment_id": 74880322, "body": "I would expect your function to actually have the type of <code>comp :: (a -&gt; a) -&gt; (int -&gt; bool) -&gt; [a] -&gt; [a]</code>. The identity function must return the same type as it was given. You need a function that modifies it&#39;s argument."}, {"owner": {"reputation": 51, "user_id": 7999252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2bbd56bc78309de048c0cca8f330cc?s=128&d=identicon&r=PG&f=1", "display_name": "leo23082014", "link": "https://stackoverflow.com/users/7999252/leo23082014"}, "edited": false, "score": 0, "creation_date": 1494530664, "post_id": 43923515, "comment_id": 74881067, "body": "thanks very much i was on the right track , i applied map first then filter"}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 51, "user_id": 7999252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2bbd56bc78309de048c0cca8f330cc?s=128&d=identicon&r=PG&f=1", "display_name": "leo23082014", "link": "https://stackoverflow.com/users/7999252/leo23082014"}, "edited": false, "score": 1, "creation_date": 1494533647, "post_id": 43923998, "comment_id": 74882764, "body": "@leo23082014, be kind to yourself &lt;3"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1494530826, "last_edit_date": 1494530826, "creation_date": 1494530632, "answer_id": 43923998, "question_id": 43923515, "link": "https://stackoverflow.com/questions/43923515/haskell-type-definition-is-wrong/43923998#43923998", "title": "Haskell type definition is wrong", "body": "<p>You almost got it, but you need to apply the filter before the map. In that way, the filter applies to <code>[a]</code> instead of <code>[b]</code>, and the predicate gets the right type.</p>\n\n<pre><code>&gt; compr identity booleans xs  = map identity (filter booleans xs)\n&gt; :t compr\ncompr :: (a -&gt; b) -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>By the way, I find the names you use for your variables to be misleading. For instance, the <code>identity</code> variable in the definition of <code>compr</code> has nothing to do with the <code>identity</code> function you declared before.</p>\n\n<p>I'd suggest you use more generic variable names instead, e.g.</p>\n\n<pre><code>&gt; compr f p xs  = map f (filter p xs)\n</code></pre>\n\n<p>where <code>f</code> stands for \"function\" and <code>p</code> for predicate.</p>\n"}, {"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1494534053, "post_id": 43924234, "comment_id": 74883014, "body": "<code>booleans = (== 1)</code> would be even simpler."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494534150, "post_id": 43924234, "comment_id": 74883085, "body": "@4castle totally"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494532688, "last_edit_date": 1494532688, "creation_date": 1494531637, "answer_id": 43924234, "question_id": 43923515, "link": "https://stackoverflow.com/questions/43923515/haskell-type-definition-is-wrong/43924234#43924234", "title": "Haskell type definition is wrong", "body": "<p>There is already a standard library function in Haskell called <code>id</code> (<code>id :: a -&gt; a</code>) to replace your <code>identity</code> function. So accordingly depending on how you will define your <code>booleans</code> function you might simplify your <code>comp</code> function as follows;</p>\n\n<pre><code>booleans x | x == 1    = True\n           | otherwise = False\n\ncompr :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ncompr =  filter booleans . map id\n\n*Main&gt; compr booleans [1,2,3,4]\n[1]\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7999252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2bbd56bc78309de048c0cca8f330cc?s=128&d=identicon&r=PG&f=1", "display_name": "leo23082014", "link": "https://stackoverflow.com/users/7999252/leo23082014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1494532688, "creation_date": 1494528818, "last_edit_date": 1494531715, "question_id": 43923515, "link": "https://stackoverflow.com/questions/43923515/haskell-type-definition-is-wrong", "title": "Haskell type definition is wrong", "body": "<p>I am just starting to learn Haskell and I have the assignment to use higher order functions to create a function with the following type definition</p>\n\n<pre><code>-- compr :: (a-&gt;b) -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>The function is not relevant, can be the simplest functions so my idea was like this:</p>\n\n<pre><code>identity x = x\nbooleans x | x == 1  = True\n           | x ==0 = False\n           | otherwise = False\n\ncompr identity booleans xs  =  filter booleans(map (identity) xs)\n</code></pre>\n\n<p>but this function has this type</p>\n\n<pre><code>compr :: (a-&gt;b) -&gt; (b -&gt; Bool) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>I have tried everything but with no positive results. I hope you can help me.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 5923374, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd4f47d4ba513ba8ed316520a12f94a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ford O.", "link": "https://stackoverflow.com/users/5923374/ford-o"}, "edited": false, "score": 0, "creation_date": 1494527990, "post_id": 43922044, "comment_id": 74879593, "body": "I think I have confused you a little bit. It is a package.yaml and my file looks a bit different."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 0, "last_activity_date": 1494523575, "creation_date": 1494523575, "answer_id": 43922044, "question_id": 43921828, "link": "https://stackoverflow.com/questions/43921828/stack-error-in-flags-key-manual-not-present/43922044#43922044", "title": "Stack : Error in $.flags._: key &quot;manual&quot; not present", "body": "<p>If this is the whole file, you must add (if you're using ghc-8.0.2) :</p>\n\n<pre><code>resolver: lts-8.3\n\nflags:\n  sandbox:\n    defer-type-errors: true\n</code></pre>\n\n<p>Name is not necesary.</p>\n"}, {"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1496190660, "creation_date": 1496190660, "answer_id": 44273888, "question_id": 43921828, "link": "https://stackoverflow.com/questions/43921828/stack-error-in-flags-key-manual-not-present/44273888#44273888", "title": "Stack : Error in $.flags._: key &quot;manual&quot; not present", "body": "<p>To tun on type-error deferral, teach Stack to compile with the flag inside <strong>stack.yaml</strong>, not package.yaml:</p>\n\n<pre><code>resolver: ...\npackages: ['.']\nghc-options:\n  sandbox: -fdefer-type-errors\nextra-deps: []\nflags: {}\nextra-package-dbs: []\n</code></pre>\n\n<p>The <code>flags</code> paragraph in package.yaml is meant to declare flags for <em>users of your package</em> to turn on or off. <a href=\"https://github.com/sol/hpack/blob/106a717d5f063ebb6c33e91e9c1e8a44d8baa167/test/Hpack/ConfigSpec.hs#L527\" rel=\"nofollow noreferrer\">See here for an example.</a> This is typically used for conditional compilation of optional features, like integration tests.</p>\n\n<p>To adjust the flags GHC will use at compiletime, use <code>ghc-options</code> in stack.yaml. (Confusingly enough, there is also a <code>flags</code> in <code>stack.yaml</code>.)</p>\n"}], "owner": {"reputation": 1069, "user_id": 5923374, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd4f47d4ba513ba8ed316520a12f94a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ford O.", "link": "https://stackoverflow.com/users/5923374/ford-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1496190660, "creation_date": 1494522824, "last_edit_date": 1494527908, "question_id": 43921828, "link": "https://stackoverflow.com/questions/43921828/stack-error-in-flags-key-manual-not-present", "title": "Stack : Error in $.flags._: key &quot;manual&quot; not present", "body": "<p>I tried to add flag to <code>package.yaml</code> file</p>\n\n<pre><code>name:                sandbox\nversion:             0.1.0.0\nhomepage:            https://github.com/githubuser/sandbox#readme\nlicense:             BSD3\nauthor:              Author name here\nmaintainer:          example@example.com\ncopyright:           2017 Author name here\ncategory:            Web\nextra-source-files:\n  - README.md\n\nflags : \n    sandbox:\n        defer-type-errors : true\n\ndependencies:\n  - base &gt;= 4.7 &amp;&amp; &lt; 5\n\nexecutables:\n  sandbox:\n    source-dirs:      src\n    main:             Main.hs\n    dependencies :    streaming\n</code></pre>\n\n<p>But I get following error : </p>\n\n<blockquote>\n  <p>....\\sandbox\\package.yaml: Error in $.flags.sandbox: key \"manual\" not present</p>\n</blockquote>\n"}, {"tags": ["haskell", "type-conversion"], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 5, "last_activity_date": 1494515994, "creation_date": 1494515994, "answer_id": 43919538, "question_id": 43919439, "link": "https://stackoverflow.com/questions/43919439/overflow-detecting-conversion-from-string-to-int-in-haskell/43919538#43919538", "title": "Overflow-detecting conversion from String to Int in Haskell", "body": "<p>You can convert it first to <code>Integer</code>, and perform the comparison: </p>\n\n<pre><code>&gt; (read \"123456789012345678901234567890\" :: Integer) &gt; toInteger(maxBound::Int)\nTrue\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2228481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adef3424fab06725cca75e1da2fb6429?s=128&d=identicon&r=PG", "display_name": "magicant", "link": "https://stackoverflow.com/users/2228481/magicant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1494520955, "accepted_answer_id": 43919538, "answer_count": 1, "score": 1, "last_activity_date": 1494515994, "creation_date": 1494515737, "question_id": 43919439, "link": "https://stackoverflow.com/questions/43919439/overflow-detecting-conversion-from-string-to-int-in-haskell", "closed_reason": "Duplicate", "title": "Overflow-detecting conversion from String to Int in Haskell", "body": "<p>The <code>read</code> function is useful for converting <code>String</code> to <code>Int</code>, but it does not support error handling. Especially, it silently returns an incorrect value when the string value is too large to be represented as <code>Int</code>:</p>\n\n<pre><code>&gt; read \"123456789012345678901234567890\" :: Int\n-4362896299872285998\n</code></pre>\n\n<p>How can I check if the string value is between <code>minBound :: Int</code> and <code>maxBound :: Int</code> and thus correctly converted to <code>Int</code>? Is there an overflow-detecting conversion function that returns <code>Maybe Int</code> or something?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 5955, "user_id": 1911042, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cf171dfe30dbc1104f2c6cf2ef83fb38?s=128&d=identicon&r=PG", "display_name": "cojoj", "link": "https://stackoverflow.com/users/1911042/cojoj"}, "edited": false, "score": 0, "creation_date": 1494519078, "post_id": 43919480, "comment_id": 74874544, "body": "All in all, you have to face everything by yourself, right?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 5955, "user_id": 1911042, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cf171dfe30dbc1104f2c6cf2ef83fb38?s=128&d=identicon&r=PG", "display_name": "cojoj", "link": "https://stackoverflow.com/users/1911042/cojoj"}, "edited": false, "score": 0, "creation_date": 1494521831, "post_id": 43919480, "comment_id": 74876194, "body": "@cojoj Well, in reality you don&#39;t need to switch <code>lts</code> often. There should be reasons for this, like you really need bugfixes. Though I agree that having some features like automatically bump-up your global <code>lts</code> and clean all garbage would be really nice! But you should consider that <code>stack</code> is very young tool comparing to build tools for other languages and comparing amount of effort, dependent on community and ecosystem size, put into it&#39;s development."}, {"owner": {"reputation": 5955, "user_id": 1911042, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cf171dfe30dbc1104f2c6cf2ef83fb38?s=128&d=identicon&r=PG", "display_name": "cojoj", "link": "https://stackoverflow.com/users/1911042/cojoj"}, "edited": false, "score": 0, "creation_date": 1494523965, "post_id": 43919480, "comment_id": 74877346, "body": "I&#39;m not expecting super awesome features out of the box. Having to handle everything manually gives you a clear vision of what you have to do in order to accomplish something, but in that case Stack&#39;s documentation lacks some really important entries.  And regarding amount of LTS&#39;... I&#39;m a new player and I already have 4 of them locally! Also, size of my <code>.stack</code> is already over 6 gigs..."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 5955, "user_id": 1911042, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cf171dfe30dbc1104f2c6cf2ef83fb38?s=128&d=identicon&r=PG", "display_name": "cojoj", "link": "https://stackoverflow.com/users/1911042/cojoj"}, "edited": false, "score": 1, "creation_date": 1494526420, "post_id": 43919480, "comment_id": 74878748, "body": "@cojoj You just probably shouldn&#39;t install a lot of <code>lts</code>&#39;. Try to stick to some one. I can expect huge number of locally installed packages when you&#39;re experimenting with different libraries."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1494515857, "creation_date": 1494515857, "answer_id": 43919480, "question_id": 43919260, "link": "https://stackoverflow.com/questions/43919260/updating-global-ghc-i-snapshot-in-stack/43919480#43919480", "title": "Updating global GHC/i snapshot in Stack", "body": "<p>There is no such command currently. So you can do <code>rm -rf ~/.stack</code> periodically if you change your <code>lts</code> often. There's an open issue about adding cleaning command that you want with discussion of its design: <a href=\"https://github.com/commercialhaskell/stack/issues/133\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/133</a></p>\n\n<p>But nobody implemented it yet.</p>\n"}], "owner": {"reputation": 5955, "user_id": 1911042, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cf171dfe30dbc1104f2c6cf2ef83fb38?s=128&d=identicon&r=PG", "display_name": "cojoj", "link": "https://stackoverflow.com/users/1911042/cojoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "accepted_answer_id": 43919480, "answer_count": 1, "score": 3, "last_activity_date": 1494515857, "creation_date": 1494515239, "question_id": 43919260, "link": "https://stackoverflow.com/questions/43919260/updating-global-ghc-i-snapshot-in-stack", "title": "Updating global GHC/i snapshot in Stack", "body": "<p>I'm quite new to whole Haskell ecosystem and TBH most of the time learning Haskell I've spent using <a href=\"http://haskellformac.com\" rel=\"nofollow noreferrer\">Haskell For Mac</a>. Right now I'm trying to tackle projects manually using <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">The Haskell Tool Stack</a> as everyone encourages this way of using Haskell.  </p>\n\n<p>Everything is pretty straightforward when it comes to using stack in Project's directory, I call <code>stack setup</code> and I'm ready to go with the resolver version generated or specified in <code>stack.yaml</code> (which usually is the latest version).  </p>\n\n<p>My concerns start when I want to use <code>stack ghci</code> outside of the project, because it uses <code>resolver</code> specified in <code>~/.stack/global-project/stack.yaml</code>. Of course I can manually change it to the <code>resolver</code> version I want, but what'd make me happy is if it can automatically update to the latest <code>resolver</code> when I call <code>stack upgrade</code> or something like this?  </p>\n\n<p>Continuing with this <em>upgrade</em>, can I somehow get rid of the old versions? Because size of <code>~/stack/</code> is easily getting <em>too big</em>. Let's say I want to achieve something like <code>stack resolver cleanup</code> and It'll only leave the latest version. I've seen some suggestions to remove whole <code>.stack</code> directory from time to time as a way of cleaning up, but this is rather <em>hardcore way</em>, isn't it?</p>\n"}, {"tags": ["haskell", "pattern-matching", "existential-type"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1494517771, "post_id": 43918789, "comment_id": 74873675, "body": "Welcome to StackOverflow! Your question was well posed, but make sure you search for existing questions before posting a new one."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494524766, "post_id": 43918789, "comment_id": 74877831, "body": "<code>let</code> and <code>where</code> involve lazy (AKA irrefutable) patterns, which do not force the argument (<code>x</code>, above). It would be very weird if laziness was lost only because there&#39;s a typeclass dictionary to unpack, especially because said dictionary does not explicitly occur in the code."}], "owner": {"reputation": 31, "user_id": 7998049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a963a750a68208a4c51245240c76e57?s=128&d=identicon&r=PG", "display_name": "Pavel Yakovlev", "link": "https://stackoverflow.com/users/7998049/pavel-yakovlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "closed_date": 1494524796, "answer_count": 0, "score": 1, "last_activity_date": 1494513989, "creation_date": 1494513989, "question_id": 43918789, "link": "https://stackoverflow.com/questions/43918789/what-is-wrong-with-pattern-matching-of-existential-types-in-haskell", "closed_reason": "Duplicate", "title": "What is wrong with pattern matching of existential types in Haskell?", "body": "<p>Why it is not possible to pattern match existential types in <code>let</code>/<code>where</code>, while it is doable in all other places?</p>\n\n<p><strong>TL;DR</strong> I have a funny error during <code>let</code> pattern matching of existential types:</p>\n\n<pre><code>error:\n\u2022 My brain just exploded\n  I can't handle pattern bindings for existential or GADT data constructors.\n  Instead, use a case-expression, or do-notation, to unpack the constructor.\n\u2022 In the pattern: MC q\n  In a pattern binding: MC q = x\n  In the expression: let MC q = x in bar q\n</code></pre>\n\n<p><strong>Details:</strong> let us start with some simple code:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\nclass MyClass a where\n  foo :: a -&gt; Int\n\ninstance MyClass Int where\n  foo = id\n\ninstance MyClass Char where\n  foo = const 4\n\ndata MC = forall a. MyClass a =&gt; MC a\n\nbar :: MyClass a =&gt; a -&gt; Int\nbar = (+1) . foo\n</code></pre>\n\n<p>This function runs great:</p>\n\n<pre><code>baz :: MC -&gt; Int\nbaz (MC q) = bar q\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>qux :: MC -&gt; Int\nqux x = case x of\n          MC q -&gt; bar q\n</code></pre>\n\n<p>even this:</p>\n\n<pre><code>import Control.Monad.Identity\n\nos\u0435 :: MC -&gt; Int\nose x = runIdentity $ do MC q &lt;- pure x\n                         pure $ bar q\n</code></pre>\n\n<p><strong>but</strong> these two fail:</p>\n\n<pre><code>rol :: MC -&gt; Int\nrol x = let MC q = x\n        in bar q\n\nzed :: MC -&gt; Int\nzed x = bar q\n  where MC q = x\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1494514413, "post_id": 43918438, "comment_id": 74871080, "body": "There&quot;s this nifty <code>+</code> operator that adds two numbers, but what if I want to sum up an entire list?"}], "answers": [{"tags": [], "owner": {"reputation": 770, "user_id": 2184057, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dd55ae653d431af09b6cca02cfcbec35?s=128&d=identicon&r=PG", "display_name": "user2184057", "link": "https://stackoverflow.com/users/2184057/user2184057"}, "is_accepted": false, "score": 1, "last_activity_date": 1494513677, "creation_date": 1494513677, "answer_id": 43918652, "question_id": 43918438, "link": "https://stackoverflow.com/questions/43918438/intersection-of-list-of-lists-haskell/43918652#43918652", "title": "Intersection of List of lists Haskell", "body": "<p>Easy approach pro tip:</p>\n\n<p>pro tip: </p>\n\n<p>Intersection of 2 lists is obvious.</p>\n\n<p>Intersection of 3 lists is intersection of 3rd list with intersection of first 2 lists. </p>\n\n<p>So what do you have to do is to remember your current intersection result and intersect it with next list until you run out of lists or till your intersection will be empty.</p>\n\n<p>Better approach in terms of complexity would be using merge sort like approach.</p>\n\n<p>Where your threat lists like elements of list and instead of comprehension use intersect on elements and return an intersection of them. </p>\n\n<p>Merge operation would be an intersection too.</p>\n\n<p>It's been a long time since i had anything to do with Haskell so unfortunately I won't be able to provide you with code sample. </p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494517514, "post_id": 43918708, "comment_id": 74873506, "body": "It&#39;s cool to see some faces from the JavaScript tag here doing <code>.reduce()</code> trick. Well... I guess <code>foldr1</code> is the MOAR (Mother of all Reduces&quot;). +"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494519361, "post_id": 43918708, "comment_id": 74874714, "body": "@Redu Haha, yep. I&#39;ve been learning Haskell in order to recognize when to use certain patterns in JavaScript. It&#39;s been quite a great lesson."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1494525983, "post_id": 43918708, "comment_id": 74878494, "body": "What is the monoid involved in your solution ? I cannot think of an <code>mempty</code> here."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1494527914, "post_id": 43918708, "comment_id": 74879547, "body": "@Jean-BaptistePotonnier There isn&#39;t a monoid being used here, just half of one. A fold can be done using the <code>mappend</code> portion of a monoid. My first sentence was just stating a useful intuition."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 1, "creation_date": 1494532683, "post_id": 43918708, "comment_id": 74882195, "body": "@Jean-BaptistePotonnier <code>Endo</code> seems a plausible candidate. Without the newtype wrappers, <code>mempty = id; mappend = (.)</code>. Applying <code>foldMap intersect</code> to the list <code>[x,y,z]</code> would then give you <code>intersect x . intersect y . intersect z</code>. It&#39;s only a few short steps from there to the actual desired function."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494561212, "post_id": 43918708, "comment_id": 74890929, "body": "Though <code>Endo</code> is kind of cheating, no?  There&#39;s a semigroup staring us in the face."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": false, "score": 4, "last_activity_date": 1494513792, "creation_date": 1494513792, "answer_id": 43918708, "question_id": 43918438, "link": "https://stackoverflow.com/questions/43918438/intersection-of-list-of-lists-haskell/43918708#43918708", "title": "Intersection of List of lists Haskell", "body": "<p>When you notice a function with the form <code>a -&gt; a -&gt; a</code>, you're possibly dealing with a function that can be used with a monoid, which means you can use folds.</p>\n\n<p>In your case, there isn't really a reasonable output for <code>intersection []</code>, so you should use a fold function that requires a non-empty input list, such as <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:foldr1\" rel=\"nofollow noreferrer\"><code>foldr1</code></a>.</p>\n\n<p>Therefore, an easy implementation would be:</p>\n\n<pre><code>intersection:: (Eq a) =&gt; [[a]] -&gt; [a]\nintersection = foldr1 intersect\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1494514753, "last_edit_date": 1494514753, "creation_date": 1494514127, "answer_id": 43918845, "question_id": 43918438, "link": "https://stackoverflow.com/questions/43918438/intersection-of-list-of-lists-haskell/43918845#43918845", "title": "Intersection of List of lists Haskell", "body": "<p>Intersection of two sets is <em>associative</em> (and <em>commutative</em>, but it is less important here). I.e.:</p>\n\n<pre><code>intersect(A, B, C) = intersect(intersect(A,B), C) = intersect(A, intersect(B, C))\n</code></pre>\n\n<p>It means that it doesn't matter in which order you do the intersection operation, the result won't change.</p>\n\n<p>So in Haskell you can utilize the <code>foldl1</code> function to apply the <code>intersect</code> function over all of the list:</p>\n\n<pre><code>&gt; import Data.List\n&gt; foldl1 intersect [[1,5,3,11],[1,5,2,11],[5,3,2,11]]\n[5,11]\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2569, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1494514753, "creation_date": 1494513176, "question_id": 43918438, "link": "https://stackoverflow.com/questions/43918438/intersection-of-list-of-lists-haskell", "title": "Intersection of List of lists Haskell", "body": "<p>I must write a function that returns the intersaction of more than 2 lists</p>\n\n<pre><code>Ex: intersection[[1,5,3,11],[1,5,2,11],[5,3,2,11]] = [5, 11]\nintersection:: (Eq a) =&gt; [[a]] -&gt; [a]\nintersection= undefined\n</code></pre>\n\n<p>I discovered that exists a function intersect :: Eq a => [a] -> [a] -> [a] ( but it's available only for 2 lists :) </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494513300, "post_id": 43918394, "comment_id": 74870102, "body": "and what is 0000?"}, {"owner": {"reputation": 1081, "user_id": 6764663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GlGjM.jpg?s=128&g=1", "display_name": "Tanuj Yadav", "link": "https://stackoverflow.com/users/6764663/tanuj-yadav"}, "edited": false, "score": 0, "creation_date": 1494513305, "post_id": 43918394, "comment_id": 74870107, "body": "why do u want that?"}, {"owner": {"reputation": 310, "user_id": 5031171, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce726f97c2ca1ca06d2dfe7ebb09ec80?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan B", "link": "https://stackoverflow.com/users/5031171/brendan-b"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494513416, "post_id": 43918394, "comment_id": 74870202, "body": "@Redu 0000 is an Int"}, {"owner": {"reputation": 310, "user_id": 5031171, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce726f97c2ca1ca06d2dfe7ebb09ec80?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan B", "link": "https://stackoverflow.com/users/5031171/brendan-b"}, "reply_to_user": {"reputation": 1081, "user_id": 6764663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GlGjM.jpg?s=128&g=1", "display_name": "Tanuj Yadav", "link": "https://stackoverflow.com/users/6764663/tanuj-yadav"}, "edited": false, "score": 0, "creation_date": 1494513486, "post_id": 43918394, "comment_id": 74870267, "body": "@Tanuj Yadav it is part of my planned solution to a CodeWars exercise"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 2, "creation_date": 1494514110, "post_id": 43918394, "comment_id": 74870814, "body": "0000 is not an Int!  If you want to preserve the size and values as number perhaps consider a list.  <code>map digitToInt &quot;0000&quot;</code>"}, {"owner": {"reputation": 310, "user_id": 5031171, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce726f97c2ca1ca06d2dfe7ebb09ec80?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan B", "link": "https://stackoverflow.com/users/5031171/brendan-b"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1494515128, "post_id": 43918394, "comment_id": 74871683, "body": "@karakfa Ah, I see. I didn&#39;t know this, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 6, "last_activity_date": 1494514474, "last_edit_date": 1494514474, "creation_date": 1494514174, "answer_id": 43918858, "question_id": 43918394, "link": "https://stackoverflow.com/questions/43918394/convert-string-of-zeroes-to-int-retaining-zeroes/43918858#43918858", "title": "Convert string of zeroes to Int (retaining zeroes)", "body": "<p>There is no <code>0000</code> of type <code>Int</code> which is different from <code>0</code>, so this isn't possible. This isn't specific to Haskell: you'll see the same in any other language with numeric types (i.e. basically any language at all). </p>\n\n<p>But when you say \"the result is <code>0</code>\", you should more correctly say that result is <em>printed as</em> <code>0</code>, and generally you will have functions which allow you to print the same value as <code>0000</code>, but again won't distinguish between <code>0</code> and <code>0000</code> integer values. </p>\n\n<p>If you want to preserve this information, you need a different type. Which one, depends on what exactly you need. E.g. it could be </p>\n\n<pre><code>data Digits = Digits [Int]\n</code></pre>\n\n<p>where each element of list is from <code>0</code> to <code>9</code> (or use <code>[Int]</code> directly). Or</p>\n\n<pre><code>data IntWithPaddingZeros = IntWithPaddingZeros { value :: Int, paddingZeros :: Int }\n</code></pre>\n\n<p>Etc.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1494516097, "last_edit_date": 1494516097, "creation_date": 1494515597, "answer_id": 43919375, "question_id": 43918394, "link": "https://stackoverflow.com/questions/43918394/convert-string-of-zeroes-to-int-retaining-zeroes/43919375#43919375", "title": "Convert string of zeroes to Int (retaining zeroes)", "body": "<p>You have to define a new data type like <code>MyInt</code> or say <code>Mint</code> and tell the compiler how to display it.</p>\n\n<pre><code>data Mint = M Int\ninstance Show Mint where\n  show (M n) = \"000\" ++ show n\n\n*Main&gt; M 7\n0007\n</code></pre>\n\n<p>This, of course, is a very simple example. You may come up with a more conceptual showing function which could deduce the number of zeroes to add if the integer is more than 1 digit.</p>\n\n<p>OK let's develop our showing function a little further...</p>\n\n<pre><code>data Mint = M Int\ninstance Show Mint where\n  show (M n) = replicate (3 - (round . (logBase 10) . fromIntegral) n ) '0' ++ show n\n\n*Main&gt; M 133\n0133\n*Main&gt; M 22\n0022\n*Main&gt; M 0\n0000\n*Main&gt; M 1453\n1453\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 5031171, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce726f97c2ca1ca06d2dfe7ebb09ec80?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan B", "link": "https://stackoverflow.com/users/5031171/brendan-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494516097, "creation_date": 1494513077, "question_id": 43918394, "link": "https://stackoverflow.com/questions/43918394/convert-string-of-zeroes-to-int-retaining-zeroes", "title": "Convert string of zeroes to Int (retaining zeroes)", "body": "<p>I wish to convert something like \"0000\" to 0000. </p>\n\n<p>When I use </p>\n\n<pre><code>read \"0000\" :: Int\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code>0\n</code></pre>\n\n<p>Many thanks!</p>\n"}, {"tags": ["parsing", "haskell", "autocomplete", "parsec"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1494515248, "post_id": 43917562, "comment_id": 74871784, "body": "You may want to take a look at <a href=\"https://www.haskell.org/happy/\" rel=\"nofollow noreferrer\">Happy</a>. It is an amazing parser generator. Not only does it support all of the standard parser generator features, but it is very well integrated with Haskell: it supports parametrized productions, type signatures (even with constraints), ADT tokens, and custom underlying parsing monad. It expects BNF (although with parametrized productions, you can make your own extended BNF)."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1494518291, "post_id": 43917562, "comment_id": 74874011, "body": "Seems like with bnf converter I can have almost what I want. I actually thought about expressing parse tree as tree with string labels and generating parser in runtime instead of compile time, but this also may work."}], "owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 777, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1494511068, "creation_date": 1494511068, "question_id": 43917562, "link": "https://stackoverflow.com/questions/43917562/generate-parser-from-ebnf", "title": "Generate parser from EBNF", "body": "<p>I want to create tools make developer work more easy (autocomplete, linting, refactoring etc).</p>\n\n<p>The first step would be to create a tool that can take grammar in some form (I'm thinking about EBNF) and create parser for it.\nThe most pleasant option is to use Parsec, but I've as it is top-down parser wouldn't it be less performant then bottom up one?\nAre there bottom-up parser generators for Haskell that can be created easily from BNF?</p>\n\n<p>Also how parse only part of file that changes as user changes the sources?</p>\n\n<pre><code>type Grammar = String\ntype Label = String\n\ndata ParseTree a = Node\n\u00a0 \u00a0 { label :: Label\n\u00a0 \u00a0 \u00a0 start :: Integer\n\u00a0 \u00a0 , childrens :: [ParseTree]\n\u00a0 \u00a0 } | Leaf {value :: a} deriving Show\n\nmkParser :: Grammar -&gt; Parser ParseTree\nmkParser = undefined\n</code></pre>\n\n<p>From ParseTree various data can be taken and stored persistently like function definition places, usages etc.\nNext step is type inference, but for that I believe someone should define for each language what are function and data types definitions.</p>\n\n<p>After that I think the algorithm would be language independent.</p>\n\n<p>And from that there would be able to give suggestions and autocompletion and linting.</p>\n\n<p>So is my train\u00a0 of thought is going into right direction? And what are the answers to a more concrete questions in the start?</p>\n"}, {"tags": ["algorithm", "haskell", "pretty-print"], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494516260, "post_id": 43916705, "comment_id": 74872598, "body": "Small remark: for headings you want to use <code># heading</code> instead of <code>** heading **</code>. The first will generate <code>&lt;h*&gt;</code> elements, which are semantically more fitting than <code>&lt;strong&gt;</code> elements."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494522473, "post_id": 43916705, "comment_id": 74876527, "body": "@Zeta Thanks! Did not know that."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494522778, "post_id": 43916705, "comment_id": 74876694, "body": "Since you&#39;ve just worked though chapter 5, would you say that it&#39;s out of date? Or still on-topic? <a href=\"https://stackoverflow.com/questions/23727768/which-parts-of-real-world-haskell-are-now-obsolete-or-considered-bad-practice/23733494#23733494\">Asking for this wiki answer</a>."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494522998, "post_id": 43916705, "comment_id": 74876817, "body": "@zeta I really have no idea, as I&#39;m not very proficient in Haskell, unfortunately."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494523222, "post_id": 43916705, "comment_id": 74876949, "body": "No problem. Maybe the remarks will come in handy if you follow RWH further."}, {"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 1, "creation_date": 1588428883, "post_id": 43916705, "comment_id": 108894209, "body": "Regarding lines like <i>the <code>Text</code> type contains</i>, they should be corrected, as <code>Text</code> (et similia) is a <i>value constructor</i>, whereas <code>Doc</code> is the <i>type constructor</i> (and the name of the <i>type</i> too). I&#39;m pretty new to Haskell, but I think the terminology in this answer could be improved (and made more in line with the book) to make it more useful for readers (like me)."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 2, "last_activity_date": 1494522455, "last_edit_date": 1494522455, "creation_date": 1494508907, "answer_id": 43916705, "question_id": 43916704, "link": "https://stackoverflow.com/questions/43916704/purpose-and-workings-of-doc-in-real-world-haskell-ch-5/43916705#43916705", "title": "Purpose And Workings of `Doc` In Real World Haskell, Ch 5", "body": "<p>I self-answered this question after spending a lot of time reading chapter 5 as well as <a href=\"http://belle.sourceforge.net/doc/hughes95design.pdf\" rel=\"nofollow noreferrer\">[Hughes 95]</a> and <a href=\"http://homepages.inf.ed.ac.uk/wadler/papers/prettier/prettier.pdf\" rel=\"nofollow noreferrer\">[Wadler 98]</a>, for the following reasons:</p>\n\n<ol>\n<li>The chapter simultaneously deals with many different points (e.g., JSON, pretty printing, hex formats, Haskell modules, the need for signatures, etc.). </li>\n<li>The chapter moves unexpectdly between very high level and low level questions, e.g., generic pretty printing, and escaping JSON strings; somewhat strangely, the discussion of escapting begins <em>after</em> the transition from JSON-specific printing, to generic pretty-printing.</li>\n<li>IIUC, [Wadler 98] presents a very elegant framework and solution, but its specific use here can be simplified to about <a href=\"http://rextester.com/HNVO8573\" rel=\"nofollow noreferrer\">20 lines of very straightforward code</a> (see <a href=\"http://rextester.com/BAH4825\" rel=\"nofollow noreferrer\">full version here</a>).</li>\n</ol>\n\n<h1>Purpose Of A Pretty Printing Library And <code>Doc</code></h1>\n\n<p>Many documents and data structures are (multiway) tree-like:</p>\n\n<ul>\n<li><p>JSON, <a href=\"https://en.wikipedia.org/wiki/YANG\" rel=\"nofollow noreferrer\"><em>YANG</em></a>, and basically any document with a hierarchal structure </p></li>\n<li><p>many <a href=\"https://www.cs.cmu.edu/~rwh/theses/okasaki.pdf\" rel=\"nofollow noreferrer\">purely functional data structures</a></p></li>\n</ul>\n\n<p>Therefore, it makes sense to factor out tree pretty-printing, from the actual source of the tree-like data. This factored out library will just contain methods to construct some abstract <code>Doc</code> from tree-like data, and pretty print this <code>Doc</code>. The point, therefore, is to service several types of sources at once. </p>\n\n<p>To simplify things, let's focus on a particularly simple source: </p>\n\n<pre><code>data Tree = Tree String [Tree]\n    deriving (Eq, Show)\n</code></pre>\n\n<p>which can be constructed like this, for example:</p>\n\n<pre><code>tree = \n    Tree \"a\" [\n        Tree \"b\" [\n            Tree \"c\" []],\n        Tree \"d\" [\n            Tree \"e\" [],\n            Tree \"f\" [],\n            Tree \"g\" [],\n            Tree \"h\" []\n        ],\n        Tree \"i\" []\n    ]\n</code></pre>\n\n<h1>Prettiness Criteria</h1>\n\n<p>Again, for a specific simple example, the criteria for \"prettiness\" is folding nested elements as much as possible, as long as the result does not exceed some specified length. So, for example, for the above <code>tree</code>, if we are given length 30, the prettiest output is defined to be </p>\n\n<pre><code>a[[c] d[e, f, g, h] i]\n</code></pre>\n\n<p>if we are given 20</p>\n\n<pre><code>a[\n    b[c]\n    d[e, f, g, h]\n    i\n]\n</code></pre>\n\n<p>and if we are given 8</p>\n\n<pre><code>a[\n    b[c]\n    d[\n        e,\n        f,\n        g,\n        h\n    ]\n    i\n]\n</code></pre>\n\n<h1>An Implementation Of <code>Doc</code></h1>\n\n<p>The following is a simplification of [Walder 98]. </p>\n\n<p>Any tree can be expressed by a combination of two types:</p>\n\n<ul>\n<li><p>a text node, containing a string</p></li>\n<li><p>a nest node, containing the indentation level, an opening string, child nodes, and a closing text node</p></li>\n</ul>\n\n<p>Additionally, any node can be folded or not. </p>\n\n<p>In order to represent this, we can use the following:</p>\n\n<pre><code>data Doc = \n      Text String Int \n    | Nest Int String [Doc] String Int\n    deriving (Eq, Show)\n</code></pre>\n\n<ul>\n<li><p>The <code>Text</code> type contains just  a <code>String</code> of the content</p></li>\n<li><p>The <code>Nest</code> type contains </p>\n\n<ul>\n<li><p>an <code>Int</code> indicating the indentation </p></li>\n<li><p>a <code>String</code> indicating the start element </p></li>\n<li><p>a <code>[Doc]</code> indicating child elements </p></li>\n<li><p>a <code>String</code> indicating the closing element  </p></li>\n<li><p>an <code>Int</code> indicating the total length of this node, should it be folded</p></li>\n</ul></li>\n</ul>\n\n<p>We can easily find the length a <code>Doc</code> will have, if folded, using this:</p>\n\n<pre><code>getDocFoldedLength :: Doc -&gt; Int\ngetDocFoldedLength (Text s) = length s\ngetDocFoldedLength (Nest _ _ _ _ l) = l\n</code></pre>\n\n<p>To create a <code>Nest</code>, we use the following:</p>\n\n<pre><code>nest :: Int -&gt; String -&gt; [Doc] -&gt; String -&gt; Doc\nnest indent open chs close = \n    Nest indent open chs close (length open + length chs - 1 + sum (map getDocFoldedLength chs) + length close) \n</code></pre>\n\n<p>Note that the folded-version length is calculated once, and then \"cached\". </p>\n\n<p>Getting the folded-version length of a <code>Doc</code> in <em>O(1)</em> is easy:</p>\n\n<pre><code>getDocFoldedLength :: Doc -&gt; Int\ngetDocFoldedLength (Text s) = length s\ngetDocFoldedLength (Nest _ _ _ _ l) = l\n</code></pre>\n\n<p>If we will decide to actually fold a <code>Doc</code>, we will also need the folded version of its content:</p>\n\n<pre><code>getDocFoldedString :: Doc -&gt; String\ngetDocFoldedString (Nest _ open cs close _) = open ++ intercalate \" \" (map getDocFoldedString cs) ++ close\ngetDocFoldedString (Text s) = s\n</code></pre>\n\n<p>Constructing a <code>Doc</code> from a tree can be done like this:</p>\n\n<pre><code>showTree :: Tree -&gt; Doc\nshowTree (Tree s ts) = if null chs then Text s else nest (1 + length s) (s ++ \"[\") chs \"]\" where\n    chs = intercalateDocs \",\" $ map showTree ts\n</code></pre>\n\n<p>where <code>intercalateDocs</code> is a utility function, intercalating commas between non-<code>Nest</code> <code>Docs</code>:</p>\n\n<pre><code>intercalateDocs :: String -&gt; [Doc] -&gt; [Doc]\nintercalateDocs _ l | length l &lt; 2 = l\nintercalateDocs delim (hd:tl) = case hd of \n    (Text s) -&gt; (Text (s ++ delim)):intercalateDocs delim tl\n    otherwise -&gt; hd:intercalateDocs delim tl\n</code></pre>\n\n<p>E.g., for <code>tree</code> above <code>showTree tree</code> gives</p>\n\n<pre><code>Nest 2 \"a[\" [Nest 2 \"b[\" [Text \"c\"] \"]\" 4,Nest 2 \"d[\" [Text \"e,\",Text \"f,\",Text \"g,\",Text \"h\"] \"]\" 13,Text \"i\"] \"]\" 23\n</code></pre>\n\n<p>Now for the heart of the matter, a <code>pretty</code> function, deciding which nested elements to fold. Since each <code>getDocElement</code> gives us the length of the folded-version of a <code>Doc</code>, we can efficiently decide whether to fold or not:</p>\n\n<pre><code>pretty :: Int -&gt; Doc -&gt; String\npretty w doc = pretty' 0 w doc where\n    pretty' i _ (Text s) = replicate i ' ' ++ s\n    pretty' i w (Nest j open cs close l) | i + j + l &lt;= w = \n        replicate i ' ' ++ open ++ intercalate \" \" (map getDocFoldedString cs) ++ close\n    pretty' i w (Nest j open cs close l) = \n        replicate i ' ' ++ open ++ \"\\n\" ++ intercalate \"\\n\" (map (pretty' (i + j) w) cs) ++ \"\\n\" ++ replicate i ' ' ++ close\n</code></pre>\n\n<p>The function <code>pretty' i w doc</code> transforms <code>doc</code> into a pretty form, assuming the current indentation is <code>i</code>, and the width is <code>w</code>. Specifically,</p>\n\n<ul>\n<li><p>it transforms any <code>Text</code> to its string</p></li>\n<li><p>it folds any <code>Nest</code> if it fits; if not, it calls itself recursively on the children.</p></li>\n</ul>\n\n<p>(See <a href=\"http://rextester.com/BAH4825\" rel=\"nofollow noreferrer\">full version here</a>.)</p>\n\n<h1>Differences From The Paper And Chapter</h1>\n\n<p>The papers use solutions that are more elegant and Haskell-Specific. The <code>Doc</code>'s algebraic data type includes also a \"horizontal concatenation\", that generates a sequence of documents depending on whether it (and the descendants) will be folded or not. A careful search doesn't generate all possible documents (whose number is exponential), but rather discards generating large numbers of layouts that cannot possibly be part of the optimal solution. The solution here achieves the same complexity by caching the folded length within each node, which is simpler.</p>\n\n<p>The chapter uses a slightly different API for compatibility with existing Haskell Pretty-Printing libraries. It organizes the code into modules. It also deals with practical JSON-specific problems such as escaping (which is unrelated to pretty printing).</p>\n"}], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 43916705, "answer_count": 1, "score": 3, "last_activity_date": 1494522455, "creation_date": 1494508907, "question_id": 43916704, "link": "https://stackoverflow.com/questions/43916704/purpose-and-workings-of-doc-in-real-world-haskell-ch-5", "title": "Purpose And Workings of `Doc` In Real World Haskell, Ch 5", "body": "<p><a href=\"http://book.realworldhaskell.org/read/writing-a-library-working-with-json-data.html\" rel=\"nofollow noreferrer\">Chapter 5 of Real World Haskell</a> introduces a pretty-printing library, specifically with an abstract <code>Doc</code>, in the context of pretty-printing <a href=\"http://www.json.org/\" rel=\"nofollow noreferrer\">JSON</a>:</p>\n\n<blockquote>\n  <p>Instead of rendering straight to a string, our Prettify module will use an abstract type that we'll call Doc. By basing our generic rendering library on an abstract type, we can choose an implementation that is flexible and efficient. If we decide to change the underlying code, our users will not be able to tell.</p>\n</blockquote>\n\n<p>However, (as several commentors wrote on this otherwise excellent book wrote), it's a bit hard to understand from this chapter why is <code>Doc</code> needed, or how exactly does it solve the problem. Specifically, in the context of a chapter focusing on modules, it's hard to understand the motivation given by</p>\n\n<blockquote>\n  <p>If we decide to change the underlying code, our users will not be able to tell.</p>\n</blockquote>\n\n<p>This, on its own, could be achieved by simply exporting a pretty printing function, and not exporting anything related to the implementation. Why is <code>Doc</code> needed, then, and how does it solve the problem?</p>\n"}, {"tags": ["haskell", "ghcjs"], "answers": [{"comments": [{"owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "edited": false, "score": 0, "creation_date": 1494956474, "post_id": 43951478, "comment_id": 75044431, "body": "can you be please more specific. I am a noob right now, so any help better would be appreciated !"}], "tags": [], "owner": {"reputation": 36, "user_id": 1122365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96cb4aebd82b601be565632fe8995c07?s=128&d=identicon&r=PG", "display_name": "jacksjy", "link": "https://stackoverflow.com/users/1122365/jacksjy"}, "is_accepted": false, "score": 0, "last_activity_date": 1494667718, "creation_date": 1494667718, "answer_id": 43951478, "question_id": 43915971, "link": "https://stackoverflow.com/questions/43915971/including-module-in-haskell-during-ghcjs-in-compile-time/43951478#43951478", "title": "Including module in haskell during ghcjs in compile time", "body": "<p>Use Cabal to manage your project, write dependency in build-dep session. Then install your project.</p>\n"}], "owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494667718, "creation_date": 1494507079, "last_edit_date": 1494508287, "question_id": 43915971, "link": "https://stackoverflow.com/questions/43915971/including-module-in-haskell-during-ghcjs-in-compile-time", "title": "Including module in haskell during ghcjs in compile time", "body": "<p>I want to compile a haskell code to javascript and have the following error during compiling.</p>\n\n<pre><code>&gt; ghcjs Main.hs \n\nMain.hs:2:8:\n    Could not find module \u2018Reflex.Dom\u2019\n    Use -v to see a list of the files searched for.\n\nMain.hs:4:8:\n    Could not find module \u2018Data.Matrix\u2019\n    Perhaps you meant Data.Ratio (from base-4.8.0.0)\n    Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>I am not using stack, and I wonder how should I provide with the libraries during compile time?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494506782, "post_id": 43915649, "comment_id": 74864767, "body": "Double check you don&#39;t have TAB characters in your source file."}, {"owner": {"reputation": 89, "user_id": 2047480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e91a18258d660cc9548e729d3a798049?s=128&d=identicon&r=PG", "display_name": "Tedy S.", "link": "https://stackoverflow.com/users/2047480/tedy-s"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494507622, "post_id": 43915649, "comment_id": 74865384, "body": "@chi so what should I have? 4 spaces for each tab?"}, {"owner": {"reputation": 89, "user_id": 2047480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e91a18258d660cc9548e729d3a798049?s=128&d=identicon&r=PG", "display_name": "Tedy S.", "link": "https://stackoverflow.com/users/2047480/tedy-s"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494507709, "post_id": 43915649, "comment_id": 74865446, "body": "Yep, that was it... so I had tabs from the beginning on the line until &quot;rest&quot;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1494507824, "post_id": 43915649, "comment_id": 74865548, "body": "Don&#39;t use tabs at all; the required amount of space is determined by the structure of the preceding line, not any fixed number of spaces."}], "owner": {"reputation": 89, "user_id": 2047480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e91a18258d660cc9548e729d3a798049?s=128&d=identicon&r=PG", "display_name": "Tedy S.", "link": "https://stackoverflow.com/users/2047480/tedy-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1494508217, "answer_count": 0, "score": 0, "last_activity_date": 1494506295, "creation_date": 1494506295, "question_id": 43915649, "link": "https://stackoverflow.com/questions/43915649/haskell-where-clause-multiple-variables", "closed_reason": "Duplicate", "title": "Haskell - where &quot;clause&quot; multiple variables", "body": "<p>I am trying to pick up some basic Haskell skills and wrote the following code:</p>\n\n<pre><code>pennypincherRec :: [Int] -&gt; Int\npennypincherRec (x : xs) | deducted &lt;= 19900 = deducted + rest\n                        | otherwise = rest\n                        where deducted = discount x\n                              rest = pennypincherRec xs\n</code></pre>\n\n<p>It works if I replace the \"rest\" with \"pennypincherRec xs\" and remove the last line.</p>\n\n<p>With the code above, it gives: parse error on input `rest'</p>\n\n<p>So how do I use the where clause for multiple variables?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494506338, "post_id": 43915516, "comment_id": 74864400, "body": "What do you mean with &quot;<i>delete those above</i>&quot;? The punctuations?"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494506519, "post_id": 43915516, "comment_id": 74864540, "body": "@Willem Van Onsem: The signs that return true in punct, yes"}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 1, "creation_date": 1494506589, "post_id": 43915516, "comment_id": 74864596, "body": "When you say &quot;it&#39;s not working&quot;, please specify what you mean. Since this code won&#39;t compile, you should say &quot;It doesn&#39;t compile&quot;, and give the error message."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1494507343, "post_id": 43915516, "comment_id": 74865174, "body": "What do you mean by <code>c isDigit</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 1, "creation_date": 1494508036, "post_id": 43915824, "comment_id": 74865724, "body": "thank you a lot. I didn&#39;t realise that I defined wrog punct because I don&#39;t know the synthax very well. Thank a lot again"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1494507824, "last_edit_date": 1494507824, "creation_date": 1494506749, "answer_id": 43915824, "question_id": 43915516, "link": "https://stackoverflow.com/questions/43915516/change-a-string-in-haskell/43915824#43915824", "title": "Change a String in Haskell", "body": "<p>The reason why it is <strong>not</strong> working is because your <code>map</code> maps <code>Char</code>s on <code>String</code>s (so <code>[Char]</code>s). As a result the output of the <code>map</code> would be <code>[String]</code>. Nevertheless if you want to <em>delete</em> those above, your function in the map does not throw the chars away.</p>\n\n<p>Furthermore you <code>punct</code> function is wrong. <code>isDigit</code>, etc. are functions. So you call it with <code>isDigit c</code>, not <code>c isDigit</code>:</p>\n\n<pre><code>punct :: Char -&gt; Bool\npunct c | c `elem` ['.', ',', '?', '!', ':', ';', '(', ')'] = True \n        | <b>isDigit c</b> = True  \n        | <b>isAlpha c</b> = True \n        | otherwise = False</code></pre>\n\n<p>Nevertheless, you can easily make this statement more compact and transform it into:</p>\n\n<pre><code>punct :: Char -&gt; Bool\npunct c = isDigit c <b>||</b> isDigit c <b>||</b> c `elem` ['.', ',', '?', '!', ':', ';', '(', ')']</code></pre>\n\n<p>There are two options here: (1) either you do a <em>post processing</em> where you filter out all the punctuations; or (2) in case you delete the punctuations, you actually do a <em>replacement</em> instead of <em>inserting</em> a space.</p>\n\n<p><strong>(1) Post processing</strong>:</p>\n\n<p>The post-processing is simply a <code>filter</code>:</p>\n\n<pre><code>post_format :: String -&gt; String\npost_format = filter (not . punct)\n</code></pre>\n\n<p>You better use post processing, if you still want to use the \"<em>original</em>\" <code>format</code> function.</p>\n\n<p><strong>(1) Replacement</strong>:</p>\n\n<p>In that case you could use a <code>helper</code> function:</p>\n\n<pre><code>helper :: Char -&gt; Char\nhelper x | punct x = ' '\n         | otherwise = x\n</code></pre>\n\n<p>Then <code>format</code> collapses to:</p>\n\n<pre><code>format :: String -&gt; String\nformat = map helper\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494509029, "post_id": 43916537, "comment_id": 74866574, "body": "Thank you for the explanation, I&#39;ve started to understand :)"}], "tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1494508401, "creation_date": 1494508401, "answer_id": 43916537, "question_id": 43915516, "link": "https://stackoverflow.com/questions/43915516/change-a-string-in-haskell/43916537#43916537", "title": "Change a String in Haskell", "body": "<p>Well, this code won't compile. Let's tackle why it won't compile one issue at a time:</p>\n\n<p>First off, in your <code>punct</code> function, this compilation error happens twice:</p>\n\n<pre><code>Foo.hs:7:11: error:\n    \u2022 Couldn't match expected type \u2018(Char -&gt; Bool) -&gt; Bool\u2019\n                  with actual type \u2018Char\u2019\n    \u2022 The function \u2018c\u2019 is applied to one argument,\n      but its type \u2018Char\u2019 has none\n      In the expression: c isDigit\n      In a stmt of a pattern guard for\n                     an equation for \u2018punct\u2019:\n        c isDigit\n</code></pre>\n\n<p>What the compiler is trying to tell you here is that you wrote \"call <code>c</code> as a function, passing it the argument <code>isDigit</code>\", when obviously you meant that the other way around. So first we swap those:</p>\n\n<pre><code>punct :: Char -&gt; Bool\npunct c | c `elem` ['.', ',', '?', '!', ':', ';', '(', ')'] = True \n        | isDigit c = True  \n        | isAlpha c = True \n        | otherwise = False\n</code></pre>\n\n<p>With that fixed, your first <code>format</code> function in fact compiles:</p>\n\n<pre><code>format1 :: String -&gt; String\nformat1 s = intercalate \"\" [if (punct c) then (c:\" \") else [c] | c &lt;- s]\n</code></pre>\n\n<p>And it also seems to work as advertised:</p>\n\n<pre><code>*Foo&gt; format1 \"a.b_c\"\n\"a . b _c \"\n</code></pre>\n\n<p>Okay, now what about that second <code>format</code> function? Well, at first it won't compile:</p>\n\n<pre><code>Foo.hs:18:12: error:\n    \u2022 Couldn't match type \u2018[Char] -&gt; [[Char]]\u2019 with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: [Char] -&gt; [[Char]]\n    \u2022 Probable cause: \u2018map\u2019 is applied to too few arguments\n      In the expression: map (\\ c -&gt; if punct c then (c : \" \") else [c])\n      In an equation for \u2018format\u2019:\n          format s = map (\\ c -&gt; if punct c then (c : \" \") else [c])\n</code></pre>\n\n<p>The compiler is telling you here (with the \"Probable cause\" message) that you forgot to use <code>s</code> on the right hand side, and should have written:</p>\n\n<pre><code>format s = map (\\c -&gt; if punct c then (c:\" \") else [c] ) s\n</code></pre>\n\n<p>But event that won't compile: (but the error message is different now)</p>\n\n<pre><code>Foo.hs:18:12: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019\n      Expected type: String\n        Actual type: [[Char]]\n    \u2022 In the expression:\n        map (\\ c -&gt; if punct c then (c : \" \") else [c]) s\n      In an equation for \u2018format\u2019:\n          format s = map (\\ c -&gt; if punct c then (c : \" \") else [c]) s\n</code></pre>\n\n<p>That's saying that your result should have been a <code>String</code> (that is, a list of <code>Char</code>, or <code>[Char]</code>), but instead was a list of <code>String</code>s (that is, a <code>[[Char]]</code>)</p>\n\n<p>This is because you turned each character into a string, instead of into a character. One way to fix this is to turn each character into a character:</p>\n\n<pre><code>format s = map (\\c -&gt; if punct c then ' ' else c ) s\n</code></pre>\n\n<p>Another way is to apply <code>intercalate \"\"</code> (or <code>concat</code>) as you did before to join the list of strings into a single string:</p>\n\n<pre><code>format s = intercalate \"\" $ map (\\c -&gt; if punct c then \" \" else [c] ) s\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1494508401, "creation_date": 1494505921, "question_id": 43915516, "link": "https://stackoverflow.com/questions/43915516/change-a-string-in-haskell", "title": "Change a String in Haskell", "body": "<p>I have this function that must check if a character from a string is a letter, a digit or a punctuation sign, case when it returns True otherwise False. But if I test it, it doesn't work.</p>\n\n<pre><code>punct :: Char -&gt; Bool\npunct c | c `elem` ['.', ',', '?', '!', ':', ';', '(', ')'] = True \n        | c isDigit = True  \n        | c isAlpha = True \n        | otherwise = False\n</code></pre>\n\n<p>This function adds a space after one of those above.</p>\n\n<pre><code>format :: String -&gt; String\nformat s = intercalate \"\" [if (punct c) then (c:\" \") else [c] | c &lt;- s]\n</code></pre>\n\n<p>After That I need to delete those above, checked at punct.\nActually I think that I can replace those from punct directly with space\nI've tried something like this:</p>\n\n<pre><code>format :: String -&gt; String\nformat s = map (\\c -&gt; if punct c then (c:\" \") else [c] )\n</code></pre>\n\n<p>But it's not working, any suggestions? I think i can use map and filter? Am I wrong?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494504358, "post_id": 43913107, "comment_id": 74862946, "body": "<code>stack clean &amp;&amp; stack build</code>? Although I&#39;m not sure at the moment, to be honest."}, {"owner": {"reputation": 20980, "user_id": 241990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/265f1d52e6e484c9abe60b4da20fb8ee?s=128&d=identicon&r=PG", "display_name": "Shaun the Sheep", "link": "https://stackoverflow.com/users/241990/shaun-the-sheep"}, "edited": false, "score": 1, "creation_date": 1494511922, "post_id": 43913107, "comment_id": 74868966, "body": "Not sure what you mean, or why you would want to use exactly the same directory for a new project. Stack caches dependencies for each LTS version (in <code>~&#47;.stack</code>, not the project directory), so you don&#39;t have to download them every time you start a new project. If you mean &quot;how do I setup a new project&quot;, then you can do that using <code>stack new</code>."}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": true, "score": 1, "last_activity_date": 1494652688, "last_edit_date": 1495540037, "creation_date": 1494513305, "answer_id": 43918496, "question_id": 43913107, "link": "https://stackoverflow.com/questions/43913107/how-to-clean-a-directory-made-using-stack-haskell-and-reuse-it/43918496#43918496", "title": "How to clean a directory made using stack (haskell) and reuse it?", "body": "<p>If you don't want stack to catch the new and shiny LTS version every time you create a new project, you should tell stack to use one LTS version you know is saved on your computer. For instance, the current LTS is 8.13. If you want to use 8.2, type:</p>\n\n<pre><code>stack new projectname --resolver=lts-8.2\n</code></pre>\n\n<p>More info here: <a href=\"https://stackoverflow.com/questions/33446558/understanding-haskells-stack-program-and-the-resolver-and-lts-version\">Understanding Haskell&#39;s stack program and the resolver and LTS version</a></p>\n"}], "owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 43918496, "answer_count": 1, "score": 0, "last_activity_date": 1494652688, "creation_date": 1494499315, "last_edit_date": 1494511148, "question_id": 43913107, "link": "https://stackoverflow.com/questions/43913107/how-to-clean-a-directory-made-using-stack-haskell-and-reuse-it", "title": "How to clean a directory made using stack (haskell) and reuse it?", "body": "<p>I am working with haskell using stack and each time I need to painfully download all dependencies for creating a new project. Sometimes I wanna overwrite the codes by starting afresh and deleting previous files as they might interfere and make use of default .yaml files. Is there any command that makes a directory made by stack reusable like starting afresh without downloading anything ?</p>\n"}, {"tags": ["haskell", "modulo"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1494503629, "last_edit_date": 1494503629, "creation_date": 1494496678, "answer_id": 43912189, "question_id": 43911960, "link": "https://stackoverflow.com/questions/43911960/haskell-filter-operation-with-modulo/43912189#43912189", "title": "Haskell filter operation with modulo", "body": "<p>What you have to understand is that Haskell has a \"very\" uniform syntax (not that much \"special\" cases). You call a function <code>f</code> with arguments <code>x y</code> with <code>f x y</code>. Now <code>mod</code> is just an ordinary function like all other functions. So you should call it with:</p>\n\n<pre><code>mod x 7\n</code></pre>\n\n<p>You can also use backtics to call a binary operator with the function in between like:</p>\n\n<pre><code>x `mod` 7\n</code></pre>\n\n<p>So you can fix the problem with:</p>\n\n<pre><code>multipleOf7 :: [Int] -&gt; [Int]\nmultipleOf7 x = filter (test) x\n   where test x = mod x 7 == 0</code></pre>\n\n<p>or more cleaner:</p>\n\n<pre><code>multipleOf7 :: [Int] -&gt; [Int]\nmultipleOf7 = filter test\n   where test <b>x</b> = <b>mod x 7</b> == 0</code></pre>\n\n<p>You can also rewrite the <code>test</code> function such that:</p>\n\n<pre><code>test = (0 ==) . flip mod 7\n</code></pre>\n\n<p>or make a shorter filter like:</p>\n\n<pre><code>multipleOf7 :: Integral b =&gt; [b] -&gt; [b]\nmultipleOf7 = filter ((0 ==) . flip mod 7)\n</code></pre>\n\n<p><em>(opinion)</em> In my personal opinion it is indeed weird at first to see <code>mod x 7</code>. But after a while you start to find this useful since it saves a lot of brain cycles not taking complicated syntax/grammar rules into account.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "edited": false, "score": 0, "creation_date": 1494498791, "post_id": 43912325, "comment_id": 74859067, "body": "Oh man, thanks! i knew the problem is just a little thing but I couldn&#39;t find it!"}], "tags": [], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "is_accepted": true, "score": 4, "last_activity_date": 1494527152, "last_edit_date": 1494527152, "creation_date": 1494497001, "answer_id": 43912325, "question_id": 43911960, "link": "https://stackoverflow.com/questions/43911960/haskell-filter-operation-with-modulo/43912325#43912325", "title": "Haskell filter operation with modulo", "body": "<p>You should have written mod using backquote</p>\n\n<pre><code>x `mod` 7 == 0\n</code></pre>\n\n<p>or use it normally</p>\n\n<pre><code>mod x 7 == 0\n</code></pre>\n\n<p>In haskell you can use any function as infix.\nIf you define a simple function like</p>\n\n<pre><code>myFunction x y = x * y\n</code></pre>\n\n<p>then if you want you can use it like:</p>\n\n<pre><code>z = 40 `myFunction` 50\n</code></pre>\n\n<p>if you want you can also define function with an infix style.</p>\n\n<pre><code>x `myFunction` y = x * y\n</code></pre>\n\n<p>that would be strictly the same, and you would still be able to call it the other way also:</p>\n\n<pre><code>z = myFunction 40 50 \n</code></pre>\n\n<p><HR></p>\n\n<p>Moreover, in the same spirit, you can easily define custom infix operators/symbols in Haskell. For example:</p>\n\n<pre><code>(-!!-&gt;) a b = (a,b)\n-- or identically, but no need for backticks for infix operators\na -!!-&gt; b = (a,b)\n</code></pre>\n\n<p>that can be used this way:</p>\n\n<pre><code>c = 1 -!!-&gt; 2\n-- and now c == (1,2)\n</code></pre>\n\n<p>but this should be used sparingly, choose your custom symbol carefully, and with the clear intent of readability IMHO.</p>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 1, "last_activity_date": 1494501229, "creation_date": 1494501229, "answer_id": 43913791, "question_id": 43911960, "link": "https://stackoverflow.com/questions/43911960/haskell-filter-operation-with-modulo/43913791#43913791", "title": "Haskell filter operation with modulo", "body": "<p>Since <code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> and in your case <em>a = Int</em>,</p>\n\n<pre><code>multipleOf7 :: [Int] -&gt; [Int]\nmultipleOf7 ns = filter f ns\n  where\n    f :: Int -&gt; Bool\n    f i = i `mod` 7 == 0\n</code></pre>\n\n<p>Like Willem Van Onsem, I would probably <a href=\"https://www.haskell.org/tutorial/numbers.html\" rel=\"nofollow noreferrer\">loosen the <em>Int</em> into an <em>Integral a => a</em></a>, since the library function <code>mod :: Integral a =&gt; a -&gt; a -&gt; a</code> is just as general. I would also parameterize the <em>7</em> into an <em>n</em>, <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\">ditch the <em>ns</em></a> and write the <em>f</em> as a lambda:</p>\n\n<pre><code>multipleOf :: Integral a =&gt; a -&gt; [a] -&gt; [a]\nmultipleOf n = filter (\\i -&gt; i `mod` n == 0)\n</code></pre>\n\n<p>Willem Van Onsem then rewrites it into <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow noreferrer\">pointfree style</a>:</p>\n\n<pre><code>multipleOf7 :: Integral a =&gt; [a] -&gt; [a]\nmultipleOf7 = filter ((0 ==) . flip mod 7)\n</code></pre>\n\n<p>Pointfree style is sometimes more readable. I'd argue that this isn't the case here. Another variation is available here,</p>\n\n<pre><code>multipleOf :: Integral a =&gt; a -&gt; [a] -&gt; [a]\nmultipleOf n = filter ((== 0) . (`mod` n))\n</code></pre>\n\n<p>Still, I like the first versions with <code>where</code> or a lambda better.</p>\n"}], "owner": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3427, "favorite_count": 2, "accepted_answer_id": 43912325, "answer_count": 3, "score": 3, "last_activity_date": 1542255276, "creation_date": 1494496121, "last_edit_date": 1542255276, "question_id": 43911960, "link": "https://stackoverflow.com/questions/43911960/haskell-filter-operation-with-modulo", "title": "Haskell filter operation with modulo", "body": "<p>I'm trying to use the \"filter\" from Haskell but I've got stuck.\nI wanna use the filter and modulo together in one function like this</p>\n\n<pre><code>multipleOf7 :: [Int] -&gt; [Int]\nmultipleOf7 x = filter (test) x \n   where test = x mod 7 == 0 \n</code></pre>\n\n<p>I also tried to use the <code>mod</code> but it doesn't work.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1494498049, "post_id": 43911886, "comment_id": 74858585, "body": "@Stephane Rolland: I&#39;ve added the explanation :)"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1494498670, "creation_date": 1494498670, "answer_id": 43912889, "question_id": 43911886, "link": "https://stackoverflow.com/questions/43911886/product-of-2-list-haskell/43912889#43912889", "title": "Product of 2 list haskell", "body": "<p>Well you can define a product yourself with <code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</code> like:</p>\n\n<pre><code>ownProduct :: Num b =&gt; [b] -&gt; b\nownProduct = foldl (*) 1\n</code></pre>\n\n<p>Because a <code>foldl</code> starts with the initial value (<code>1</code>) and applies that value to the first element of the list. The result of that operation is applied to the function again but now with the second element of that list and so on until we reach the end. So <code>foldl (*) 1 [x1,x2,...,xn]</code> is equal to <code>(((1*x1)*x2)*...)*xn</code>.</p>\n\n<p>Furthermore you can use a <code>zipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]</code> function to convert two streams (one of <code>a</code>s and one of <code>b</code>s) into a stream of <code>c</code> by applying the function <em>element-wise</em>.</p>\n\n<p>So you can implement it like:</p>\n\n<pre><code>twoListProduct :: Num b =&gt; [b] -&gt; [b] -&gt; b\ntwoListProduct x y = foldl (*) 1 $ zipWith helper x y\n    where helper xi yi = xi*xi - yi*yi + 2*xi*yi\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494503782, "creation_date": 1494503782, "answer_id": 43914729, "question_id": 43911886, "link": "https://stackoverflow.com/questions/43911886/product-of-2-list-haskell/43914729#43914729", "title": "Product of 2 list haskell", "body": "<p>You may also do as follows;</p>\n\n<pre><code>quadratics :: Num a =&gt; Int -&gt; [a] -&gt; [a] -&gt; a\nquadratics i ns ms = ((\\(f,s) -&gt; f*f + 2*f*s - s*s) . head . drop i . zip ns) ms\n\n*Main&gt; quadratics 0 [2,4,5,6,8] [7,3,4,59,0]\n-17\n*Main&gt; quadratics 3 [2,4,5,6,8] [7,3,4,59,0]\n-2737\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 1, "last_activity_date": 1494517810, "creation_date": 1494517810, "answer_id": 43920240, "question_id": 43911886, "link": "https://stackoverflow.com/questions/43911886/product-of-2-list-haskell/43920240#43920240", "title": "Product of 2 list haskell", "body": "<p>Allow me to reuse the excelent answer of @WillemVanOnsem in a more step-by-step aproach:</p>\n\n<p>First, you must join the two list somehow. zip :: [a] -> [b] -> [(a,b)] is a handy function for doing this, from two list it returns a list of pairs.</p>\n\n<pre><code>zip [2,4,5,6,8] [7,3,4,59,0] \n&gt; [(2,7),(4,3),(5,4),(6,59),(8,0)]\n</code></pre>\n\n<p>Now, you must do your work with the pairs. Lets define de function you must apply to a pair:</p>\n\n<pre><code>squareB :: (Integer,Integer) -&gt; Integer\nsquareB (x,y)  = x^2 - y^2 + 2*x*y\n</code></pre>\n\n<p>Lets use map for aplying the square of a binomial function to each pair: </p>\n\n<pre><code>multiplicands:: [Integer] -&gt; [Integer] -&gt; [Integer] \nmultiplicands xs1 xs2 = map squareB (zip xs1 xs2)\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>multiplicands  [2,4,5,6,8] [7,3,4,59,0]\n&gt;[-17,31,49,-2737,64]\n</code></pre>\n\n<p>Now, lets fold them from the left using (*) with base case 1, ie: (((1 * x1) * x2) .... xn):</p>\n\n<pre><code>solution :: [Integer] -&gt; [Integer] -&gt; Integer\nsolution xs1 xs2 = foldl (*) 1  (multiplicands xs1 xs2)\n</code></pre>\n\n<p>Lets check this function:</p>\n\n<pre><code>solution [2,4,5,6,8] [7,3,4,59,0]\n&gt; 452336326\n</code></pre>\n\n<p>with Willems' function:</p>\n\n<pre><code>twoListProduct [2,4,5,6,8] [7,3,4,59,0]\n&gt; 4523363264\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1494517810, "creation_date": 1494495941, "last_edit_date": 1494498335, "question_id": 43911886, "link": "https://stackoverflow.com/questions/43911886/product-of-2-list-haskell", "title": "Product of 2 list haskell", "body": "<p>I have 2 lists, x and y,  I must calculate the product of\n<code>(xi^2 - yi^2 + 2*xi*yi)</code> with <code>xi</code> from x<br>\nand <code>yi</code> from y</p>\n\n<pre><code> List x = [2,4,5,6,8] xi = 2/3/...\n List y = [7,3,4,59,0] yi = 7/3/4...\n</code></pre>\n\n<p>It's a bit tricky because I can use only functions <strong>without</strong> the <code>product</code> function without recursion and list comprehension.</p>\n\n<pre><code>prod :: [Int] -&gt; [Int] -&gt; Int\n</code></pre>\n\n<p>I would write the product function myself:</p>\n\n<pre><code>product :: [Integer] -&gt; Integer\nproduct []     = 1\nproduct i f = foldl (*) 1 [i..f]\n</code></pre>\n\n<p>But I don't know how to apply it to the both strings.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 6, "creation_date": 1494493077, "post_id": 43910856, "comment_id": 74854936, "body": "The error message just says that GHCi does not know how to print back the resulting list of functions. There&#39;s nothing wrong with the expression itself. You can still ask for the type of it with <code>:t</code>. That should work just fine."}, {"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 1, "creation_date": 1494493721, "post_id": 43910856, "comment_id": 74855434, "body": "Also, you can eta reduce the lambda: <code>map take [1..5]</code> works equally well."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1494493713, "creation_date": 1494493713, "answer_id": 43911113, "question_id": 43910856, "link": "https://stackoverflow.com/questions/43910856/how-to-make-a-list-of-partially-applied-functions-using-map/43911113#43911113", "title": "How to make a list of partially applied functions using map?", "body": "<p>First of all, your code works. But functions cannot get <code>show</code>n. Try <code>show id</code>, and you end up with a very similar error message.</p>\n\n<p>But before we delve into the application of your list of functions let us have a look at the types, just to check whether your logic is sound. For the sake of simplicity, we say that <code>1 :: Int</code>. Also, <code>\\x -&gt; take x</code> is just <code>take</code>, so we can reproduce your behaviour with <code>map take [1..5]</code>. Now we have the following participants in our little type turmoil: </p>\n\n<pre><code>map    :: (a -&gt; b           ) -&gt; [a]    -&gt; [b]\ntake   :: Int -&gt; ([c] -&gt; [c])                   -- explicit parentheses\n</code></pre>\n\n<p>Now we plug <code>take</code> into <code>map</code>. In our <code>map</code>, <code>a ~ Int</code> due to <code>take</code>'s first argument, and <code>b ~ [c] -&gt; [c]</code>. Therefore, we have</p>\n\n<pre><code>map take :: [Int] -&gt; [[c] -&gt; [c]]\n</code></pre>\n\n<p>Now we use <code>map take [1..5]</code>, which simply removes the type in our line above:</p>\n\n<pre><code>map take        :: [Int] -&gt; [[c] -&gt; [c]]\n[1..5]          :: [Int]\nmap take [1..5] ::          [[c] -&gt; [c]]\n</code></pre>\n\n<p>And we're done. We end up at exact the same type as in your error message. Does everything end up right? <strong><em>Yes. There's nothing wrong with your code.</em></strong> </p>\n\n<p>However, as already said, <code>[[c] -&gt; [c]]</code> cannot get shown. We have to apply those functions in your list:</p>\n\n<pre><code>Prelude&gt; map (\\f -&gt; f [1..10]) (map take [1..5])\n[[1],[1,2],[1,2,3],[1,2,3,4],[1,2,3,4,5]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "is_accepted": false, "score": 1, "last_activity_date": 1494493783, "creation_date": 1494493783, "answer_id": 43911136, "question_id": 43910856, "link": "https://stackoverflow.com/questions/43910856/how-to-make-a-list-of-partially-applied-functions-using-map/43911136#43911136", "title": "How to make a list of partially applied functions using map?", "body": "<p>@kosmikus answered your question in a comment, but here in case anyone is interested is what <code>:t</code> does in the in console.</p>\n\n<p>Here is the list of 5 functions that you wanted, typed directly:</p>\n\n<pre><code>Prelude&gt; :t [(take 1), (take 2), (take 3), (take 4), (take 5)]\n[(take 1), (take 2), (take 3), (take 4), (take 5)] :: [[a] -&gt; [a]]\n</code></pre>\n\n<p>Using your expression with <code>map</code>:</p>\n\n<pre><code>Prelude&gt; :t map (\\x -&gt; take x) [1..5]\nmap (\\x -&gt; take x) [1..5] :: [[a] -&gt; [a]]\n</code></pre>\n\n<p>Incidentally you can also say:</p>\n\n<pre><code>Prelude&gt; :t map take [1..5]\nmap take [1..5] :: [[a] -&gt; [a]]\n</code></pre>\n\n<p>What you can\u2019t do is render the value itself in the GHCI console, there\u2019s no way to show functions from lists to lists. The <code>:t</code> trick by @kosmikus is nice. That said, you <em>can</em> use your list of functions and see them in action. For example:</p>\n\n<pre><code>Prelude&gt; let takers = map take [1..5] in head(tail takers) [8,9,10,11]\n[8,9]\n</code></pre>\n\n<p>which applies the function <code>take 2</code> to the list <code>[8 9 10 11]</code>.</p>\n"}], "owner": {"reputation": 611, "user_id": 4699448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770476e46e176f2560cd24d130a7129d?s=128&d=identicon&r=PG&f=1", "display_name": "James Wilson", "link": "https://stackoverflow.com/users/4699448/james-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 43911113, "answer_count": 2, "score": 4, "last_activity_date": 1494493783, "creation_date": 1494492934, "question_id": 43910856, "link": "https://stackoverflow.com/questions/43910856/how-to-make-a-list-of-partially-applied-functions-using-map", "title": "How to make a list of partially applied functions using map?", "body": "<p>I'm trying to make a list of functions (for use with <code>zipwith</code> later on) so that I effectively have <code>[take 1,take 2,take 3]</code> so each element of the list should have type <code>[Int] -&gt; [Int]</code>.</p>\n\n<p>This is what I've tried, which feels like it ought to be right. I'm not sure why I'm getting the error message?</p>\n\n<pre><code>Prelude&gt; map (\\x -&gt; take x) [1..5]\n\n&lt;interactive&gt;:46:1:\n    No instance for (Show ([a0] -&gt; [a0]))\n      (maybe you haven't applied enough arguments to a function?)\n      arising from a use of \u2018print\u2019\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "hashmap"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 0, "last_activity_date": 1494494258, "last_edit_date": 1494494258, "creation_date": 1494493437, "answer_id": 43911020, "question_id": 43910790, "link": "https://stackoverflow.com/questions/43910790/haskell-how-to-get-specific-map-from-another-map/43911020#43911020", "title": "haskell - how to get specific map from another map", "body": "<p>There are a few problems here:</p>\n\n<ul>\n<li>you use <code>do</code> notation, which usually implies that you are specifying a <em>monad</em>.</li>\n<li>even if you want to use a monad, the <code>ret = ...</code> syntax is not the supposed way to do that, then it should have been <strong><code>ret &lt;- ...</code></strong>, with <code>...</code> a monad; and</li>\n<li>the name of a type should start with an <strong>uppercase</strong>, not a lowercase;</li>\n<li>the type should probably be <code>getMap :: M2 -&gt; Int -&gt; M1</code>.</li>\n</ul>\n\n<p>So a way to solve it is:</p>\n\n<pre><code>import Data.Map as M \n\ntype <b>M</b>1 = M.Map Int Int                         -- uppercase types\ntype <b>M</b>2 = M.Map Int <b>M</b>1                          -- uppercase types\n\ngetMap :: <b>M2</b> -&gt; Int -&gt; <b>M</b>1                       -- different type signature\ngetMap e k = <b>fromJust $ M.lookup (M.size e) e</b>   -- pure function</code></pre>\n\n<p>That being said, semantically, this does <em>not</em> make much sense: you fetch the <code>M.size</code> of the map and do not even use <code>k</code> (regardless what key you give, it will always return the same value int map, or error). I would think that you are looking for:</p>\n\n<pre><code>getMap :: M2 -&gt; Int -&gt; M1  \ngetMap e k = fromJust $ <b>M.lookup k e</b></code></pre>\n\n<p>Or an alternative version:</p>\n\n<pre><code>getMap :: M2 -&gt; Int -&gt; M1 \ngetMap = (fromJust .) . flip M.lookup\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7996240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be639e4cc31e39ce79e5e2daa03d04dc?s=128&d=identicon&r=PG&f=1", "display_name": "J.DOE", "link": "https://stackoverflow.com/users/7996240/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 43911020, "answer_count": 1, "score": 1, "last_activity_date": 1494494258, "creation_date": 1494492794, "last_edit_date": 1494493598, "question_id": 43910790, "link": "https://stackoverflow.com/questions/43910790/haskell-how-to-get-specific-map-from-another-map", "title": "haskell - how to get specific map from another map", "body": "<p>I want to write a function in Haskell which return specific map from map  </p>\n\n<p>I have:</p>\n\n<pre><code>import Data.Map as M  \n...  \ntype m1 = M.Map Int Int  \ntype m2 = M.Map Int m1 \n</code></pre>\n\n<p>And I'm trying something like this:</p>\n\n<pre><code>getMap :: m1 -&gt; Int -&gt; m1  \ngetMap e k = do  \nret = M.lookup (M.size e) e  \nreturn $ fromJust $ ret  \n</code></pre>\n\n<p>Unfortunately I haven't get <code>m1</code> type returned.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 2, "last_activity_date": 1494492641, "creation_date": 1494492641, "answer_id": 43910736, "question_id": 43910682, "link": "https://stackoverflow.com/questions/43910682/haskell-hgetcontents-error/43910736#43910736", "title": "Haskell hGetContents error", "body": "<p>Calling <code>hGetContents</code> puts the handle into a special \"semi-closed\" state. You cannot perform <em>any</em> explicit operations on it after that. In particular, you don't manually close it; it automatically gets closed in the background when you read to the end of the string. You can just remove that <code>hClose</code> and it will work.</p>\n\n<p>This is one of the pitfalls of lazy I/O, and one of the reasons people advise to avoid it; it makes the timing of your I/O operations kind of unpredictable.</p>\n"}], "owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 43910736, "answer_count": 1, "score": 0, "last_activity_date": 1494492641, "creation_date": 1494492475, "question_id": 43910682, "link": "https://stackoverflow.com/questions/43910682/haskell-hgetcontents-error", "title": "Haskell hGetContents error", "body": "<p>Is the following error due to lazy evaluation?</p>\n\n<pre><code>epubParsing :: FilePath -&gt; IO [String]\nepubParsing f = do\n  h &lt;- openFile f ReadMode\n  hSetEncoding h utf8\n  content &lt;- hGetContents h\n  hClose h\n  return . fromJust $ scrapeStringLike content paragraphS\n</code></pre>\n\n<p>I get an error: <code>hGetContents: illegal operation (delayed read on closed handle)</code>\nWhy?</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1494490396, "post_id": 43909924, "comment_id": 74853198, "body": "<code>format</code> is <code>concatMap f</code> for some <code>f</code>."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1494490767, "post_id": 43909924, "comment_id": 74853411, "body": "@Gurkenglas: thank you"}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1494490536, "creation_date": 1494490536, "answer_id": 43909995, "question_id": 43909924, "link": "https://stackoverflow.com/questions/43909924/insert-space-after-every-punctuation-sign-in-a-string-haskell/43909995#43909995", "title": "Insert space after every punctuation sign in a String Haskell", "body": "<p>Simple recursive option:</p>\n\n<pre><code>format :: String -&gt; String\nformat [] = []\nformat (x:xs) | checkpuntuationc x = x : ' ' : format xs\n              | otherwise          = x : format xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494491010, "post_id": 43910060, "comment_id": 74853553, "body": "@Amy Tavory: Thanks"}, {"owner": {"reputation": 2418, "user_id": 1232832, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c492983af89b49d44250c79579a2641?s=128&d=identicon&r=PG", "display_name": "Shou Ya", "link": "https://stackoverflow.com/users/1232832/shou-ya"}, "edited": false, "score": 0, "creation_date": 1494491320, "post_id": 43910060, "comment_id": 74853718, "body": "Instead of <code>intercalate &quot;&quot;</code> you can just use <code>concat</code>."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494494994, "post_id": 43910060, "comment_id": 74856364, "body": "@AmyTavory: If before I add space I must calculate the sum length of the crings that have punctuation signs?  only with function, do you have any idea about how to do it?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494495505, "post_id": 43910060, "comment_id": 74856769, "body": "@Madalina Not sure what you mean by &quot;strings that have punctuation signs&quot;. You have one string, and some characters <i>are</i> punctuations, no? Do you want to count how many characters are punctuation characters?"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494495637, "post_id": 43910060, "comment_id": 74856860, "body": "@AmyTavory: instead of String I have a list of stringssomething like  sumLength :: [String] -&gt; Int"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494497009, "post_id": 43910060, "comment_id": 74857879, "body": "@Madalina Edited the answer based on what I understood you&#39;re asking."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494497816, "post_id": 43910060, "comment_id": 74858430, "body": "@AmyTavory: sumLength [&quot;ana:&quot;,&quot;sdfghj&quot;,&quot;::&quot;] must return 6, now it return 12(all characters) + 3 (only punctuatin signs)= 15"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494498127, "post_id": 43910060, "comment_id": 74858645, "body": "@Madalina OK, so you meant something a bit different. See updated answer."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494498427, "post_id": 43910060, "comment_id": 74858841, "body": "@AmyTavory: Thank you, can you explain me a little what $ does? I cannot understand :) and i really want to be able to resolve this problems by myself"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494498840, "post_id": 43910060, "comment_id": 74859101, "body": "@Madalina You can think of it as a syntactic sugar for writing <code>f $ g x y</code> instead of <code>f (g x y)</code> (heuristically, it means something like apply it to the result of whatever comes to the right of <code>$</code>)."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494499116, "post_id": 43910060, "comment_id": 74859276, "body": "@AmyTavory: Thank you so much!"}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 2, "last_activity_date": 1494498101, "last_edit_date": 1494498101, "creation_date": 1494490741, "answer_id": 43910060, "question_id": 43909924, "link": "https://stackoverflow.com/questions/43909924/insert-space-after-every-punctuation-sign-in-a-string-haskell/43910060#43910060", "title": "Insert space after every punctuation sign in a String Haskell", "body": "<p>There's probably a more elegant way to do it, but </p>\n\n<pre><code>format :: String -&gt; String\nformat s = concat [if (checkpunctuation c) then (c:\" \") else [c] | c &lt;- s]\n</code></pre>\n\n<p>will work (thanks, @Shou Ya!).</p>\n\n<hr>\n\n<p><strong>Edit based on comment</strong></p>\n\n<p>To count the total length of post-formatted punctuation characters, you can use</p>\n\n<pre><code>sumLength :: [String] -&gt; Int \nsumLength strings = 2 * (sum $ fmap length (fmap (filter checkpunctuation) strings))\n</code></pre>\n\n<p>as the it is twice the sum of the number of punctuation characters.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1494492006, "last_edit_date": 1494492006, "creation_date": 1494491609, "answer_id": 43910375, "question_id": 43909924, "link": "https://stackoverflow.com/questions/43909924/insert-space-after-every-punctuation-sign-in-a-string-haskell/43910375#43910375", "title": "Insert space after every punctuation sign in a String Haskell", "body": "<p>Another option is to use <code>foldr</code> with a <code>helper</code> function:</p>\n\n<pre><code>helper :: Char -&gt; String -&gt; String\nhelper x xs | checkpunctuation x = x : ' ' : xs\n            | otherwise = x : xs\n</code></pre>\n\n<p>The helper checks if the first character is a punctuation. If so it inserts a space, otherwise it does not.</p>\n\n<p>and then define <code>format</code> as:</p>\n\n<pre><code>format :: String -&gt; String\nformat = foldr helper []\n</code></pre>\n\n<p>A sample call:</p>\n\n<pre><code>*Main&gt; format \"Hello? Goodbye! You say goodbye!! (and I say Hello)\"\n\"Hello?  Goodbye!  You say goodbye! !  ( and I say Hello) \"\n</code></pre>\n\n<p>This function works also on \"<em>infinite</em> strings\":</p>\n\n<pre><code>*Main&gt; take 50 $ format $ cycle \"Hello?Goodbye!\"\n\"Hello? Goodbye! Hello? Goodbye! Hello? Goodbye! He\"\n</code></pre>\n\n<p>So although we feed it a string that keeps <code>cycle</code>-ing, and thus never ends, we can derive the first 50 characters of the result.</p>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1494498101, "creation_date": 1494490329, "last_edit_date": 1494491940, "question_id": 43909924, "link": "https://stackoverflow.com/questions/43909924/insert-space-after-every-punctuation-sign-in-a-string-haskell", "title": "Insert space after every punctuation sign in a String Haskell", "body": "<p>I have this function that checks if a character is one of these punctuation signs.</p>\n\n<pre><code>checkpunctuation:: Char -&gt; Bool\ncheckpunctuationc = c `elem` ['.', ',', '?', '!', ':', ';', '(', ')']\n</code></pre>\n\n<p>I have to write another function that after every punctuation sign it adds a space</p>\n\n<pre><code>format :: String -&gt; String\n</code></pre>\n\n<p>I know how to add space after a given number of characthers but don't know how to add after specific characters.</p>\n"}, {"tags": ["oracle", "haskell", "odbc", "hdbc"], "answers": [{"comments": [{"owner": {"reputation": 1546, "user_id": 1775245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815d55c2926baa023b85c8cec9cd04c1?s=128&d=identicon&r=PG", "display_name": "Shawn Lu", "link": "https://stackoverflow.com/users/1775245/shawn-lu"}, "edited": false, "score": 1, "creation_date": 1495565094, "post_id": 43992061, "comment_id": 75303393, "body": "Thanks for the reply, the issue is persistent-odbc library still depends on HDBC-odbc, we still gonna ran into problem (3) in the question."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 1546, "user_id": 1775245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815d55c2926baa023b85c8cec9cd04c1?s=128&d=identicon&r=PG", "display_name": "Shawn Lu", "link": "https://stackoverflow.com/users/1775245/shawn-lu"}, "edited": false, "score": 0, "creation_date": 1499278017, "post_id": 43992061, "comment_id": 76842179, "body": "@ShawnLu Did you end up figuring this out? I am having difficulties trying to do the same thing. <a href=\"https://stackoverflow.com/questions/44932715/how-do-i-connect-haskell-hdbc-to-an-oracle-db-on-mac\" title=\"how do i connect haskell hdbc to an oracle db on mac\">stackoverflow.com/questions/44932715/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "is_accepted": false, "score": 0, "last_activity_date": 1494905726, "creation_date": 1494905726, "answer_id": 43992061, "question_id": 43908318, "link": "https://stackoverflow.com/questions/43908318/how-to-connect-to-oracle-db-in-haskell/43992061#43992061", "title": "How to connect to Oracle DB in Haskell", "body": "<p>Yes, <code>persistent</code> does support Oracle. <a href=\"https://github.com/gbwey/persistent-odbc\" rel=\"nofollow noreferrer\">https://github.com/gbwey/persistent-odbc</a></p>\n"}], "owner": {"reputation": 1546, "user_id": 1775245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815d55c2926baa023b85c8cec9cd04c1?s=128&d=identicon&r=PG", "display_name": "Shawn Lu", "link": "https://stackoverflow.com/users/1775245/shawn-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 792, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1602791853, "creation_date": 1494485184, "last_edit_date": 1602791853, "question_id": 43908318, "link": "https://stackoverflow.com/questions/43908318/how-to-connect-to-oracle-db-in-haskell", "title": "How to connect to Oracle DB in Haskell", "body": "<p>Can anyone share some tips on how to connect to Oracle DB using Haskell? I found it quite difficult. What I've done so far:</p>\n\n<p>(1) Checked out Persistent's documentation, on this page <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow noreferrer\">http://www.yesodweb.com/book/persistent</a> it mentions all the mainstream one but Oracle. </p>\n\n<p>(2) Got this book \"Developing Web Apps with Haskell and Yesod\", no mention of Oracle</p>\n\n<p>(3) Following <a href=\"http://book.realworldhaskell.org/read/using-databases.html\" rel=\"nofollow noreferrer\">http://book.realworldhaskell.org/read/using-databases.html</a> I checked out HDBC odbc, found this page <a href=\"https://hackage.haskell.org/package/HDBC-odbc\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/HDBC-odbc</a> the instruction in the bottom is hard to follow because some of the required binaries can't be found on homebrew on Mac.</p>\n\n<p>Just curious, how other engineers are connecting to Oracle using Haskell?</p>\n\n<p>I've asked this question on #haskell-beginners #haskell-web IRC channels, no feedback so far.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "parallel-processing"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1494477928, "post_id": 43904910, "comment_id": 74846658, "body": "A conjecture: <code>Integer</code> operations like multiplication and addition are slightly faster when the two operands are closer in size. Perhaps this happens more often when doing a divide-and-conquer (as in your second solution) than when operating front-to-back (as in your first solution)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494478407, "post_id": 43904910, "comment_id": 74846805, "body": "Quick update: in my tests, <code>fold (+) 0 [1&#47;x | x &lt;- [1..20000]] :: Rational</code> is indeed much faster when using <code>fold = foldb</code> than <code>fold = foldl&#39;</code>, where <code>foldb</code> is the &quot;tree-fold&quot; that repeatedly combines adjacent pairs until the list has only one element. (<code>foldb f z [] = z; foldb f z [x] = x; foldb f z xs = foldb f z (pairwise f xs); pairwise f (x:y:rest) = f x y : pairwise f rest; pairwise f other = other</code>)"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1494486630, "post_id": 43904910, "comment_id": 74850721, "body": "Get rid of the use of <code>length</code> in both examples.  It&#39;s slow and ugly."}, {"owner": {"reputation": 53, "user_id": 7994574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b56bb47526ed9b1d72c20a7bd284477?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy JD", "link": "https://stackoverflow.com/users/7994574/eddy-jd"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494500670, "post_id": 43904910, "comment_id": 74860355, "body": "@DanielWagner You&#39;re right that this explains the case in the code I posted. In fact, foldb runs significantly faster than a naive fold on my original code, although parAddFracs is still twice as fast as foldb when adding the elements of my ring (where the coefficients of my objects are never very large). Edit: Any idea why threading it seems to take up so much cpu, but doesn&#39;t increase in speed? I originally thought the overhead of creating the threads might negate the extra cpus, but the link I mentioned in the post seemed to get a hefty increase in speed when simply adding numbers."}, {"owner": {"reputation": 53, "user_id": 7994574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b56bb47526ed9b1d72c20a7bd284477?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy JD", "link": "https://stackoverflow.com/users/7994574/eddy-jd"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1494501363, "post_id": 43904910, "comment_id": 74860853, "body": "@augustss In the second example, could you provide a suggestion on how to split a list in half without using length? I understand how I can remove it in the first example."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494523933, "post_id": 43904910, "comment_id": 74877323, "body": "@EddyJD If your ring is commutative the approach I used in <code>pairwise</code> works for splitting a list in two without computing the length. e.g. something like <code>split [] = ([], []); split (x:xs) = let (ls, rs) = split xs in (x:rs, ls)</code>."}, {"owner": {"reputation": 53, "user_id": 7994574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b56bb47526ed9b1d72c20a7bd284477?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy JD", "link": "https://stackoverflow.com/users/7994574/eddy-jd"}, "edited": false, "score": 0, "creation_date": 1494530420, "post_id": 43904910, "comment_id": 74880921, "body": "This seems to run a fair bit slower than using length in my setting and runs just a little bit slower than using length in the posted code. Ugly or not, I&#39;ll need to keep it. I&#39;m still trying to figure out why parallelism here isn&#39;t speeding things up."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1494602935, "post_id": 43904910, "comment_id": 74915145, "body": "If splitting in half is important then a list is the wrong data structure."}], "owner": {"reputation": 53, "user_id": 7994574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b56bb47526ed9b1d72c20a7bd284477?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy JD", "link": "https://stackoverflow.com/users/7994574/eddy-jd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1494502194, "creation_date": 1494465126, "last_edit_date": 1495540960, "question_id": 43904910, "link": "https://stackoverflow.com/questions/43904910/drastically-different-run-times-for-folding-a-list", "title": "Drastically different run times for folding a list", "body": "<p>I'm adding up elements in a ring. For the purpose of this post, I'll use rational numbers:</p>\n\n<pre><code>intList n = map (\\x -&gt; [x]) [1 .. n]\n\ntoReciprocal xs = map (\\x -&gt; [[1], x]) xs\n\naddFrac [[a], [b]] [[c], [d]] = let num = a*d + b*c\n                                    denom = b*d\n                                    g = gcd num denom\n                                in [[num `div` g], [denom `div` g]]\n\naddFracs xs\n    | length xs == 1 = head xs\n    | otherwise = (head xs) `addFrac` (addFracs $ tail xs)\n\nmain = print $ addFracs $ toReciprocal $ intList 20000\n</code></pre>\n\n<p>I understand this is not how you would want to add rational numbers, but my ring is a little complicated and this is the simplest case that replicates the issue I'm seeing. The above code is really slow (~11.0 seconds on my dekstop), so motivated by this post (<a href=\"https://stackoverflow.com/questions/19117922/parallel-folding-in-haskell\">parallel &quot;Folding&quot; in Haskell</a>) I decided to try:</p>\n\n<pre><code>parAddFracs xs\n    | len == 1 = head xs\n    | otherwise = (ys `par` zs) `pseq` (ys `addFrac` zs)\n    where len = length xs\n          (ys', zs') = splitAt (len `div` 2) xs\n          ys = parAddFracs ys'\n          zs = parAddFracs zs'\n\nmain = print $ parAddFracs $ toReciprocal $ intList 20000\n</code></pre>\n\n<p>and this returns almost immediately (~0.1 seconds), even when I don't compile with -threaded.</p>\n\n<p>I tried increasing the number of fractions to 2000000</p>\n\n<pre><code>main = print $ parAddFracs $ toReciprocal $ intList 2000000\n</code></pre>\n\n<p>and compiling with -threaded, +RTS -N1 runs in ~17.8 seconds and +RTS -N4 runs in ~15.6 seconds. When running with +RTS -N4 I see the cpu usage is between ~120% and ~350%, but despite the increased cpu usage, there just seems to be very little improvement in running time.</p>\n\n<p><strong>Question 1:</strong> Why does using parAddFracs run so much faster (orders of magnitude) than addFracs, even when I'm not compiling with threading support?</p>\n\n<p>Edit: @DanielWagner points out that this speed difference is due to the difference in the order of evaluation between the two. I'm still unsure of the answer to Question 2.</p>\n\n<p><strong>Question 2:</strong> When compiling with threading support, why does moving from +RTS -N1 to +RTS -N4 seem to have little effect on the running time, even though it seems to have a great effect on the amount of processing power used?</p>\n\n<p>Thanks!</p>\n"}]